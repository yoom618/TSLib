Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.8132622241973877
Epoch: 1, Steps: 18 | Train Loss: 3.064 Vali Loss: 2.718 Vali Acc: 0.820 Test Loss: 2.718 Test Acc: 0.820
Validation loss decreased (inf --> -0.819973).  Saving model ...
Epoch: 2 cost time: 0.9250850677490234
Epoch: 2, Steps: 18 | Train Loss: 1.524 Vali Loss: 0.823 Vali Acc: 0.940 Test Loss: 0.823 Test Acc: 0.940
Validation loss decreased (-0.819973 --> -0.939992).  Saving model ...
Epoch: 3 cost time: 0.9438433647155762
Epoch: 3, Steps: 18 | Train Loss: 0.220 Vali Loss: 0.205 Vali Acc: 0.943 Test Loss: 0.205 Test Acc: 0.943
Validation loss decreased (-0.939992 --> -0.943331).  Saving model ...
Epoch: 4 cost time: 0.934920072555542
Epoch: 4, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.122 Vali Acc: 0.970 Test Loss: 0.122 Test Acc: 0.970
Validation loss decreased (-0.943331 --> -0.969999).  Saving model ...
Epoch: 5 cost time: 0.8934195041656494
Epoch: 5, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.108 Vali Acc: 0.980 Test Loss: 0.108 Test Acc: 0.980
Validation loss decreased (-0.969999 --> -0.979999).  Saving model ...
Epoch: 6 cost time: 0.9840872287750244
Epoch: 6, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 0.8847858905792236
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9143633842468262
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8912549018859863
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8333756923675537
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.8594465255737305
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.0262982845306396
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.9386336803436279
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.0133309364318848
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.9072632789611816
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.9224605560302734
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 2297913
model size : 8.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.7946159839630127
Epoch: 1, Steps: 18 | Train Loss: 3.141 Vali Loss: 2.937 Vali Acc: 0.483 Test Loss: 2.937 Test Acc: 0.483
Validation loss decreased (inf --> -0.483304).  Saving model ...
Epoch: 2 cost time: 1.0315136909484863
Epoch: 2, Steps: 18 | Train Loss: 2.246 Vali Loss: 1.775 Vali Acc: 0.927 Test Loss: 1.775 Test Acc: 0.927
Validation loss decreased (-0.483304 --> -0.926649).  Saving model ...
Epoch: 3 cost time: 0.8822650909423828
Epoch: 3, Steps: 18 | Train Loss: 0.856 Vali Loss: 0.437 Vali Acc: 0.967 Test Loss: 0.437 Test Acc: 0.967
Validation loss decreased (-0.926649 --> -0.966662).  Saving model ...
Epoch: 4 cost time: 0.9984714984893799
Epoch: 4, Steps: 18 | Train Loss: 0.166 Vali Loss: 0.157 Vali Acc: 0.967 Test Loss: 0.157 Test Acc: 0.967
Validation loss decreased (-0.966662 --> -0.966665).  Saving model ...
Epoch: 5 cost time: 0.9884672164916992
Epoch: 5, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
Validation loss decreased (-0.966665 --> -0.976666).  Saving model ...
Epoch: 6 cost time: 0.8975269794464111
Epoch: 6, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 7 cost time: 0.9181036949157715
Epoch: 7, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9129767417907715
Epoch: 8, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 0.9037489891052246
Epoch: 9, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 0.977231502532959
Epoch: 10, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 0.8742318153381348
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 0.9469733238220215
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 0.8805208206176758
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 0.9366893768310547
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 0.8872370719909668
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 0.9104619026184082
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 0.9113364219665527
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 0.9085285663604736
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 0.9016101360321045
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9464595317840576
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 0.8938755989074707
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 0.877913236618042
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8915674686431885
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 0.9582421779632568
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9027326107025146
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 0.9089305400848389
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.980513334274292
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.9740099906921387
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.8563756942749023
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.9193019866943359
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.817518949508667
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.8749125003814697
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.9365503787994385
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.8531858921051025
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.9084467887878418
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 2038841
model size : 7.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.669839859008789
Epoch: 1, Steps: 18 | Train Loss: 3.225 Vali Loss: 3.080 Vali Acc: 0.287 Test Loss: 3.080 Test Acc: 0.287
Validation loss decreased (inf --> -0.286636).  Saving model ...
Epoch: 2 cost time: 0.7983412742614746
Epoch: 2, Steps: 18 | Train Loss: 2.634 Vali Loss: 2.353 Vali Acc: 0.893 Test Loss: 2.353 Test Acc: 0.893
Validation loss decreased (-0.286636 --> -0.893310).  Saving model ...
Epoch: 3 cost time: 0.8950157165527344
Epoch: 3, Steps: 18 | Train Loss: 1.530 Vali Loss: 1.014 Vali Acc: 0.950 Test Loss: 1.014 Test Acc: 0.950
Validation loss decreased (-0.893310 --> -0.949990).  Saving model ...
Epoch: 4 cost time: 0.8489832878112793
Epoch: 4, Steps: 18 | Train Loss: 0.452 Vali Loss: 0.273 Vali Acc: 0.963 Test Loss: 0.273 Test Acc: 0.963
Validation loss decreased (-0.949990 --> -0.963331).  Saving model ...
Epoch: 5 cost time: 0.861116886138916
Epoch: 5, Steps: 18 | Train Loss: 0.085 Vali Loss: 0.155 Vali Acc: 0.970 Test Loss: 0.155 Test Acc: 0.970
Validation loss decreased (-0.963331 --> -0.969998).  Saving model ...
Epoch: 6 cost time: 0.914010763168335
Epoch: 6, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.131 Vali Acc: 0.977 Test Loss: 0.131 Test Acc: 0.977
Validation loss decreased (-0.969998 --> -0.976665).  Saving model ...
Epoch: 7 cost time: 0.8809080123901367
Epoch: 7, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 8 cost time: 0.9502615928649902
Epoch: 8, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.109 Vali Acc: 0.980 Test Loss: 0.109 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 0.9769124984741211
Epoch: 9, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 0.910092830657959
Epoch: 10, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 0.9270768165588379
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3097522258758545
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.573127269744873
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 1.6309008598327637
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 1.5536491870880127
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 1.634528636932373
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 1.4752817153930664
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 1.623976469039917
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 1.562096118927002
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 1.6512336730957031
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 1.2389910221099854
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 1.2497453689575195
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 1.182978630065918
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 1.5990397930145264
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 2.0383505821228027
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.4363174438476562
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.4410476684570312
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.5487165451049805
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 1.3910503387451172
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 1.5471301078796387
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 31 cost time: 1.539454698562622
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 32 cost time: 1.4948482513427734
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.4576339721679688
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 34 cost time: 1.842606544494629
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 35 cost time: 1.4214904308319092
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 36 cost time: 1.7349450588226318
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 37 cost time: 1.600860357284546
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.889758825302124
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.8440237045288086
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.714376449584961
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.4330928325653076
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.8703293800354004
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.7028064727783203
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 44 cost time: 1.8210010528564453
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.8064672946929932
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.4604668617248535
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.4871327877044678
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.374119520187378
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.3201990127563477
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 1.5284678936004639
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 1952537
model size : 7.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.0283355712890625
Epoch: 1, Steps: 18 | Train Loss: 3.170 Vali Loss: 3.067 Vali Acc: 0.330 Test Loss: 3.067 Test Acc: 0.330
Validation loss decreased (inf --> -0.329969).  Saving model ...
Epoch: 2 cost time: 1.5478928089141846
Epoch: 2, Steps: 18 | Train Loss: 2.659 Vali Loss: 2.412 Vali Acc: 0.843 Test Loss: 2.412 Test Acc: 0.843
Validation loss decreased (-0.329969 --> -0.843309).  Saving model ...
Epoch: 3 cost time: 1.4580492973327637
Epoch: 3, Steps: 18 | Train Loss: 1.709 Vali Loss: 1.256 Vali Acc: 0.937 Test Loss: 1.256 Test Acc: 0.937
Validation loss decreased (-0.843309 --> -0.936654).  Saving model ...
Epoch: 4 cost time: 1.6150739192962646
Epoch: 4, Steps: 18 | Train Loss: 0.647 Vali Loss: 0.400 Vali Acc: 0.957 Test Loss: 0.400 Test Acc: 0.957
Validation loss decreased (-0.936654 --> -0.956663).  Saving model ...
Epoch: 5 cost time: 1.4449987411499023
Epoch: 5, Steps: 18 | Train Loss: 0.145 Vali Loss: 0.175 Vali Acc: 0.967 Test Loss: 0.175 Test Acc: 0.967
Validation loss decreased (-0.956663 --> -0.966665).  Saving model ...
Epoch: 6 cost time: 1.4759390354156494
Epoch: 6, Steps: 18 | Train Loss: 0.040 Vali Loss: 0.145 Vali Acc: 0.970 Test Loss: 0.145 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969999).  Saving model ...
Epoch: 7 cost time: 1.2784464359283447
Epoch: 7, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.132 Vali Acc: 0.970 Test Loss: 0.132 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 8 cost time: 1.2535834312438965
Epoch: 8, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.118 Vali Acc: 0.970 Test Loss: 0.118 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 9 cost time: 1.4057846069335938
Epoch: 9, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.117 Vali Acc: 0.970 Test Loss: 0.117 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 10 cost time: 1.4539494514465332
Epoch: 10, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 1.4215779304504395
Epoch: 11, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 12 cost time: 1.5334734916687012
Epoch: 12, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4254364967346191
Epoch: 13, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 14 cost time: 1.4511611461639404
Epoch: 14, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 15 cost time: 1.5400285720825195
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 16 cost time: 1.500298023223877
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 17 cost time: 1.2472476959228516
Epoch: 17, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 18 cost time: 1.2741081714630127
Epoch: 18, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 19 cost time: 1.6887314319610596
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 20 cost time: 1.5077426433563232
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 21 cost time: 1.6701390743255615
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 22 cost time: 1.5807931423187256
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 23 cost time: 1.4174928665161133
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.3114640712738037
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.3288750648498535
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.264024257659912
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.308234691619873
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.3626558780670166
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.5598337650299072
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 30 cost time: 1.5647876262664795
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.8481724262237549
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.4817523956298828
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.4328007698059082
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.553060531616211
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.42433762550354
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.3828277587890625
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.121323585510254
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.1473510265350342
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.0671970844268799
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 40 cost time: 1.1836955547332764
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.3053841590881348
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.677365779876709
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.6851410865783691
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.4624302387237549
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.690572738647461
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.379009485244751
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.346329689025879
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 1.3027722835540771
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 1.168583631515503
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 1923865
model size : 7.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps22_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.3362064361572266
Epoch: 1, Steps: 18 | Train Loss: 3.186 Vali Loss: 3.099 Vali Acc: 0.213 Test Loss: 3.099 Test Acc: 0.213
Validation loss decreased (inf --> -0.213302).  Saving model ...
Epoch: 2 cost time: 1.4628145694732666
Epoch: 2, Steps: 18 | Train Loss: 2.727 Vali Loss: 2.539 Vali Acc: 0.810 Test Loss: 2.539 Test Acc: 0.810
Validation loss decreased (-0.213302 --> -0.809975).  Saving model ...
Epoch: 3 cost time: 1.495978593826294
Epoch: 3, Steps: 18 | Train Loss: 1.929 Vali Loss: 1.554 Vali Acc: 0.923 Test Loss: 1.554 Test Acc: 0.923
Validation loss decreased (-0.809975 --> -0.923318).  Saving model ...
Epoch: 4 cost time: 1.337507963180542
Epoch: 4, Steps: 18 | Train Loss: 0.898 Vali Loss: 0.557 Vali Acc: 0.953 Test Loss: 0.557 Test Acc: 0.953
Validation loss decreased (-0.923318 --> -0.953328).  Saving model ...
Epoch: 5 cost time: 1.2146227359771729
Epoch: 5, Steps: 18 | Train Loss: 0.244 Vali Loss: 0.227 Vali Acc: 0.960 Test Loss: 0.227 Test Acc: 0.960
Validation loss decreased (-0.953328 --> -0.959998).  Saving model ...
Epoch: 6 cost time: 1.236208200454712
Epoch: 6, Steps: 18 | Train Loss: 0.078 Vali Loss: 0.152 Vali Acc: 0.970 Test Loss: 0.152 Test Acc: 0.970
Validation loss decreased (-0.959998 --> -0.969998).  Saving model ...
Epoch: 7 cost time: 1.343820333480835
Epoch: 7, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.135 Vali Acc: 0.963 Test Loss: 0.135 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.431480884552002
Epoch: 8, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.118 Vali Acc: 0.973 Test Loss: 0.118 Test Acc: 0.973
Validation loss decreased (-0.969998 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 1.6021828651428223
Epoch: 9, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.346304178237915
Epoch: 10, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 1.6065688133239746
Epoch: 11, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 12 cost time: 1.585120439529419
Epoch: 12, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 13 cost time: 1.4507906436920166
Epoch: 13, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 14 cost time: 1.5325055122375488
Epoch: 14, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 15 cost time: 1.283400535583496
Epoch: 15, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.087627649307251
Epoch: 16, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.173295021057129
Epoch: 17, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 18 cost time: 1.3961646556854248
Epoch: 18, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 19 cost time: 1.3318486213684082
Epoch: 19, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 20 cost time: 1.324509620666504
Epoch: 20, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.4533839225769043
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.4023375511169434
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 23 cost time: 1.2898876667022705
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 24 cost time: 1.43650484085083
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 25 cost time: 1.371645450592041
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 26 cost time: 1.1167984008789062
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0371947288513184
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 28 cost time: 1.5817325115203857
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.4340991973876953
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.4677002429962158
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.853017807006836
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 32 cost time: 1.5057244300842285
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 33 cost time: 1.562859058380127
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 34 cost time: 1.4513084888458252
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 35 cost time: 1.3696870803833008
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 36 cost time: 1.3972783088684082
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.3890280723571777
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 38 cost time: 1.2153136730194092
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.5726161003112793
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.7030205726623535
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.4132425785064697
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 42 cost time: 1.547952651977539
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.4880421161651611
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.3157165050506592
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.4550504684448242
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 46 cost time: 1.5495140552520752
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973333).  Saving model ...
Epoch: 47 cost time: 1.2911317348480225
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.1356823444366455
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.2242789268493652
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.497774362564087
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps22_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9733333333333334
model parameter : 1895289
model size : 7.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps29_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.8649141788482666
Epoch: 1, Steps: 18 | Train Loss: 3.180 Vali Loss: 3.091 Vali Acc: 0.243 Test Loss: 3.091 Test Acc: 0.243
Validation loss decreased (inf --> -0.243302).  Saving model ...
Epoch: 2 cost time: 1.365720510482788
Epoch: 2, Steps: 18 | Train Loss: 2.799 Vali Loss: 2.627 Vali Acc: 0.763 Test Loss: 2.627 Test Acc: 0.763
Validation loss decreased (-0.243302 --> -0.763307).  Saving model ...
Epoch: 3 cost time: 1.052189588546753
Epoch: 3, Steps: 18 | Train Loss: 2.154 Vali Loss: 1.816 Vali Acc: 0.920 Test Loss: 1.816 Test Acc: 0.920
Validation loss decreased (-0.763307 --> -0.919982).  Saving model ...
Epoch: 4 cost time: 1.0924618244171143
Epoch: 4, Steps: 18 | Train Loss: 1.228 Vali Loss: 0.868 Vali Acc: 0.960 Test Loss: 0.868 Test Acc: 0.960
Validation loss decreased (-0.919982 --> -0.959991).  Saving model ...
Epoch: 5 cost time: 1.0689759254455566
Epoch: 5, Steps: 18 | Train Loss: 0.472 Vali Loss: 0.347 Vali Acc: 0.967 Test Loss: 0.347 Test Acc: 0.967
Validation loss decreased (-0.959991 --> -0.966663).  Saving model ...
Epoch: 6 cost time: 1.4162516593933105
Epoch: 6, Steps: 18 | Train Loss: 0.149 Vali Loss: 0.205 Vali Acc: 0.963 Test Loss: 0.205 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4162416458129883
Epoch: 7, Steps: 18 | Train Loss: 0.071 Vali Loss: 0.156 Vali Acc: 0.970 Test Loss: 0.156 Test Acc: 0.970
Validation loss decreased (-0.966663 --> -0.969998).  Saving model ...
Epoch: 8 cost time: 1.3743879795074463
Epoch: 8, Steps: 18 | Train Loss: 0.035 Vali Loss: 0.140 Vali Acc: 0.973 Test Loss: 0.140 Test Acc: 0.973
Validation loss decreased (-0.969998 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 1.5483856201171875
Epoch: 9, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.124 Vali Acc: 0.977 Test Loss: 0.124 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 10 cost time: 1.2218976020812988
Epoch: 10, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 1.2720074653625488
Epoch: 11, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.109 Vali Acc: 0.980 Test Loss: 0.109 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 1.6309545040130615
Epoch: 12, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3938305377960205
Epoch: 13, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 1.1652522087097168
Epoch: 14, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 1.0590100288391113
Epoch: 15, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4010305404663086
Epoch: 16, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 1.2100841999053955
Epoch: 17, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2439594268798828
Epoch: 18, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.4131929874420166
Epoch: 19, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.5708444118499756
Epoch: 20, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.5211856365203857
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.6554665565490723
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 1.6446757316589355
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.1547856330871582
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.9724445343017578
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.1032767295837402
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 1.209700345993042
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 1.4310436248779297
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 1.4421443939208984
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.3971447944641113
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.5328736305236816
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.2284245491027832
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 33 cost time: 1.2955090999603271
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.3900947570800781
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 35 cost time: 1.1428439617156982
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.234616756439209
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.5330543518066406
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 38 cost time: 1.3949170112609863
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.278395414352417
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.334059476852417
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.3125693798065186
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.4584684371948242
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.4126713275909424
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.5114123821258545
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.1799824237823486
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 1.226945161819458
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 1.5482172966003418
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps29_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 1866713
model size : 7.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps36_str18_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.648993730545044
Epoch: 1, Steps: 18 | Train Loss: 3.197 Vali Loss: 3.137 Vali Acc: 0.150 Test Loss: 3.137 Test Acc: 0.150
Validation loss decreased (inf --> -0.149969).  Saving model ...
Epoch: 2 cost time: 1.2067365646362305
Epoch: 2, Steps: 18 | Train Loss: 2.924 Vali Loss: 2.820 Vali Acc: 0.560 Test Loss: 2.820 Test Acc: 0.560
Validation loss decreased (-0.149969 --> -0.559972).  Saving model ...
Epoch: 3 cost time: 1.1768183708190918
Epoch: 3, Steps: 18 | Train Loss: 2.469 Vali Loss: 2.254 Vali Acc: 0.867 Test Loss: 2.254 Test Acc: 0.867
Validation loss decreased (-0.559972 --> -0.866644).  Saving model ...
Epoch: 4 cost time: 1.3481473922729492
Epoch: 4, Steps: 18 | Train Loss: 1.779 Vali Loss: 1.467 Vali Acc: 0.930 Test Loss: 1.467 Test Acc: 0.930
Validation loss decreased (-0.866644 --> -0.929985).  Saving model ...
Epoch: 5 cost time: 1.1387553215026855
Epoch: 5, Steps: 18 | Train Loss: 1.003 Vali Loss: 0.709 Vali Acc: 0.957 Test Loss: 0.709 Test Acc: 0.957
Validation loss decreased (-0.929985 --> -0.956660).  Saving model ...
Epoch: 6 cost time: 1.3049516677856445
Epoch: 6, Steps: 18 | Train Loss: 0.408 Vali Loss: 0.355 Vali Acc: 0.967 Test Loss: 0.355 Test Acc: 0.967
Validation loss decreased (-0.956660 --> -0.966663).  Saving model ...
Epoch: 7 cost time: 1.4794652462005615
Epoch: 7, Steps: 18 | Train Loss: 0.171 Vali Loss: 0.232 Vali Acc: 0.967 Test Loss: 0.232 Test Acc: 0.967
Validation loss decreased (-0.966663 --> -0.966664).  Saving model ...
Epoch: 8 cost time: 1.522918939590454
Epoch: 8, Steps: 18 | Train Loss: 0.087 Vali Loss: 0.182 Vali Acc: 0.970 Test Loss: 0.182 Test Acc: 0.970
Validation loss decreased (-0.966664 --> -0.969998).  Saving model ...
Epoch: 9 cost time: 1.6541268825531006
Epoch: 9, Steps: 18 | Train Loss: 0.047 Vali Loss: 0.152 Vali Acc: 0.980 Test Loss: 0.152 Test Acc: 0.980
Validation loss decreased (-0.969998 --> -0.979998).  Saving model ...
Epoch: 10 cost time: 1.6822059154510498
Epoch: 10, Steps: 18 | Train Loss: 0.038 Vali Loss: 0.139 Vali Acc: 0.977 Test Loss: 0.139 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.445997714996338
Epoch: 11, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.128 Vali Acc: 0.980 Test Loss: 0.128 Test Acc: 0.980
Validation loss decreased (-0.979998 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 1.5864596366882324
Epoch: 12, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.125 Vali Acc: 0.980 Test Loss: 0.125 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 1.7611682415008545
Epoch: 13, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.117 Vali Acc: 0.980 Test Loss: 0.117 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 1.6371300220489502
Epoch: 14, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.113 Vali Acc: 0.980 Test Loss: 0.113 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 1.5699615478515625
Epoch: 15, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.109 Vali Acc: 0.980 Test Loss: 0.109 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 1.6070845127105713
Epoch: 16, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 1.577876329421997
Epoch: 17, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 1.506270170211792
Epoch: 18, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 1.5466840267181396
Epoch: 19, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.408963680267334
Epoch: 20, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 1.203273057937622
Epoch: 21, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 1.32597017288208
Epoch: 22, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 1.2951045036315918
Epoch: 23, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 1.3225700855255127
Epoch: 24, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.5180022716522217
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 1.2551846504211426
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 1.0479600429534912
Epoch: 27, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.077836275100708
Epoch: 28, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 1.0297386646270752
Epoch: 29, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.3759591579437256
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 31 cost time: 1.3233954906463623
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.1182453632354736
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 33 cost time: 1.4535682201385498
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.5845425128936768
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.5741589069366455
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.510645866394043
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.386904001235962
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 38 cost time: 1.338036298751831
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.4144554138183594
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.271894931793213
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.2827322483062744
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.378054141998291
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.4618117809295654
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.7033329010009766
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.796537160873413
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 1.5175552368164062
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 1.6207284927368164
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps36_str18_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 1838137
model size : 7.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.7186334133148193
Epoch: 1, Steps: 18 | Train Loss: 3.012 Vali Loss: 2.680 Vali Acc: 0.853 Test Loss: 2.680 Test Acc: 0.853
Validation loss decreased (inf --> -0.853307).  Saving model ...
Epoch: 2 cost time: 1.5498731136322021
Epoch: 2, Steps: 18 | Train Loss: 1.449 Vali Loss: 0.748 Vali Acc: 0.953 Test Loss: 0.748 Test Acc: 0.953
Validation loss decreased (-0.853307 --> -0.953326).  Saving model ...
Epoch: 3 cost time: 1.367649793624878
Epoch: 3, Steps: 18 | Train Loss: 0.200 Vali Loss: 0.147 Vali Acc: 0.973 Test Loss: 0.147 Test Acc: 0.973
Validation loss decreased (-0.953326 --> -0.973332).  Saving model ...
Epoch: 4 cost time: 1.6018290519714355
Epoch: 4, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.118 Vali Acc: 0.973 Test Loss: 0.118 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 5 cost time: 1.8853483200073242
Epoch: 5, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 6 cost time: 1.5400996208190918
Epoch: 6, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.585425853729248
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.7337141036987305
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.571502685546875
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.5981700420379639
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.7200169563293457
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.8265321254730225
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.7210826873779297
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.4119722843170166
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 1.968404769897461
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.8226408958435059
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.8467590808868408
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.7621128559112549
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.5292699337005615
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 1.51125168800354
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 1.177664041519165
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 1.3987441062927246
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 1.613335371017456
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.144982099533081
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.2000319957733154
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.4601047039031982
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.5790436267852783
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.197821855545044
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 1.9275970458984375
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 30 cost time: 1.786515712738037
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 31 cost time: 1.592827558517456
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 32 cost time: 1.6443252563476562
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.6094717979431152
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.780806303024292
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.4223358631134033
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.306872844696045
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.8653209209442139
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.509094476699829
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 39 cost time: 1.9708576202392578
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 40 cost time: 1.8195881843566895
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.5376381874084473
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 2.0778868198394775
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 2.144735097885132
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.858130931854248
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 2.1185190677642822
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 2.3065874576568604
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 2.023946762084961
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 2.200382709503174
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 1.718923568725586
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 2289849
model size : 8.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.6652328968048096
Epoch: 1, Steps: 18 | Train Loss: 3.136 Vali Loss: 2.915 Vali Acc: 0.530 Test Loss: 2.915 Test Acc: 0.530
Validation loss decreased (inf --> -0.529971).  Saving model ...
Epoch: 2 cost time: 1.465250015258789
Epoch: 2, Steps: 18 | Train Loss: 2.221 Vali Loss: 1.717 Vali Acc: 0.937 Test Loss: 1.717 Test Acc: 0.937
Validation loss decreased (-0.529971 --> -0.936649).  Saving model ...
Epoch: 3 cost time: 2.167156934738159
Epoch: 3, Steps: 18 | Train Loss: 0.854 Vali Loss: 0.401 Vali Acc: 0.963 Test Loss: 0.401 Test Acc: 0.963
Validation loss decreased (-0.936649 --> -0.963329).  Saving model ...
Epoch: 4 cost time: 2.142573118209839
Epoch: 4, Steps: 18 | Train Loss: 0.134 Vali Loss: 0.163 Vali Acc: 0.970 Test Loss: 0.163 Test Acc: 0.970
Validation loss decreased (-0.963329 --> -0.969998).  Saving model ...
Epoch: 5 cost time: 2.202927827835083
Epoch: 5, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.127 Vali Acc: 0.970 Test Loss: 0.127 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969999).  Saving model ...
Epoch: 6 cost time: 2.154313325881958
Epoch: 6, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 2.084817409515381
Epoch: 7, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 8 cost time: 1.6746809482574463
Epoch: 8, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 1.6203320026397705
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 1.224480390548706
Epoch: 10, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4342269897460938
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 2.0511982440948486
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 2.111379623413086
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 1.7487075328826904
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 2.3788318634033203
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 2.067737340927124
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 1.5148191452026367
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.433748722076416
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 1.2533462047576904
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 20 cost time: 1.1593682765960693
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 21 cost time: 1.1859629154205322
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.6599113941192627
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 23 cost time: 1.5346083641052246
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.5433011054992676
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.0331368446350098
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.043692111968994
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 27 cost time: 2.0679259300231934
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 28 cost time: 1.6037194728851318
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 29 cost time: 1.7977216243743896
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.3992321491241455
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.4590964317321777
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.5678043365478516
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.6744041442871094
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.5626819133758545
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.4482464790344238
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.534088134765625
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.7825672626495361
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.595348834991455
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 2030777
model size : 7.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.6678974628448486
Epoch: 1, Steps: 18 | Train Loss: 3.199 Vali Loss: 3.078 Vali Acc: 0.207 Test Loss: 3.078 Test Acc: 0.207
Validation loss decreased (inf --> -0.206636).  Saving model ...
Epoch: 2 cost time: 1.5481951236724854
Epoch: 2, Steps: 18 | Train Loss: 2.595 Vali Loss: 2.341 Vali Acc: 0.840 Test Loss: 2.341 Test Acc: 0.840
Validation loss decreased (-0.206636 --> -0.839977).  Saving model ...
Epoch: 3 cost time: 1.5207233428955078
Epoch: 3, Steps: 18 | Train Loss: 1.518 Vali Loss: 0.996 Vali Acc: 0.940 Test Loss: 0.996 Test Acc: 0.940
Validation loss decreased (-0.839977 --> -0.939990).  Saving model ...
Epoch: 4 cost time: 1.5734913349151611
Epoch: 4, Steps: 18 | Train Loss: 0.436 Vali Loss: 0.260 Vali Acc: 0.960 Test Loss: 0.260 Test Acc: 0.960
Validation loss decreased (-0.939990 --> -0.959997).  Saving model ...
Epoch: 5 cost time: 1.6660847663879395
Epoch: 5, Steps: 18 | Train Loss: 0.104 Vali Loss: 0.165 Vali Acc: 0.947 Test Loss: 0.165 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2963347434997559
Epoch: 6, Steps: 18 | Train Loss: 0.040 Vali Loss: 0.117 Vali Acc: 0.973 Test Loss: 0.117 Test Acc: 0.973
Validation loss decreased (-0.959997 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 1.4693336486816406
Epoch: 7, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.111 Vali Acc: 0.970 Test Loss: 0.111 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1477863788604736
Epoch: 8, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.107 Vali Acc: 0.967 Test Loss: 0.107 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2385313510894775
Epoch: 9, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 1.761601448059082
Epoch: 10, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 1.8813929557800293
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 12 cost time: 1.6197092533111572
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 13 cost time: 1.88191556930542
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 14 cost time: 1.583763599395752
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 15 cost time: 1.569901704788208
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 16 cost time: 1.7210288047790527
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 1.582399606704712
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 1.2951645851135254
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 1.2792365550994873
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 1.177764892578125
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 1.3070120811462402
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 1.7553246021270752
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 1.4523489475250244
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 1.7017018795013428
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 1.759619951248169
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.777836561203003
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 1.3661887645721436
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 1.5969798564910889
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983333).  Saving model ...
Epoch: 29 cost time: 1.588928461074829
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 30 cost time: 1.576568603515625
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 31 cost time: 1.4535138607025146
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 32 cost time: 1.638399362564087
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 33 cost time: 1.8528380393981934
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.7332634925842285
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 35 cost time: 1.6863324642181396
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.6793005466461182
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.7680771350860596
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.3313286304473877
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 39 cost time: 1.4895477294921875
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.3591883182525635
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.408984661102295
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.289839506149292
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.5998075008392334
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.5662729740142822
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.2671210765838623
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.3246405124664307
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 47 cost time: 1.5538933277130127
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.5345494747161865
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.8186945915222168
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.8246796131134033
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 1944473
model size : 7.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.44865345954895
Epoch: 1, Steps: 18 | Train Loss: 3.164 Vali Loss: 3.071 Vali Acc: 0.333 Test Loss: 3.071 Test Acc: 0.333
Validation loss decreased (inf --> -0.333303).  Saving model ...
Epoch: 2 cost time: 1.8920695781707764
Epoch: 2, Steps: 18 | Train Loss: 2.651 Vali Loss: 2.437 Vali Acc: 0.797 Test Loss: 2.437 Test Acc: 0.797
Validation loss decreased (-0.333303 --> -0.796642).  Saving model ...
Epoch: 3 cost time: 1.5629124641418457
Epoch: 3, Steps: 18 | Train Loss: 1.717 Vali Loss: 1.282 Vali Acc: 0.923 Test Loss: 1.282 Test Acc: 0.923
Validation loss decreased (-0.796642 --> -0.923321).  Saving model ...
Epoch: 4 cost time: 1.594010829925537
Epoch: 4, Steps: 18 | Train Loss: 0.639 Vali Loss: 0.392 Vali Acc: 0.960 Test Loss: 0.392 Test Acc: 0.960
Validation loss decreased (-0.923321 --> -0.959996).  Saving model ...
Epoch: 5 cost time: 1.4053642749786377
Epoch: 5, Steps: 18 | Train Loss: 0.147 Vali Loss: 0.180 Vali Acc: 0.967 Test Loss: 0.180 Test Acc: 0.967
Validation loss decreased (-0.959996 --> -0.966665).  Saving model ...
Epoch: 6 cost time: 1.3902010917663574
Epoch: 6, Steps: 18 | Train Loss: 0.043 Vali Loss: 0.148 Vali Acc: 0.967 Test Loss: 0.148 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 7 cost time: 1.0700607299804688
Epoch: 7, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.127 Vali Acc: 0.973 Test Loss: 0.127 Test Acc: 0.973
Validation loss decreased (-0.966665 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 1.0205280780792236
Epoch: 8, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.120 Vali Acc: 0.973 Test Loss: 0.120 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 1.4432919025421143
Epoch: 9, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 1.6228060722351074
Epoch: 10, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 1.5695114135742188
Epoch: 11, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 1.4906001091003418
Epoch: 12, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 1.7486522197723389
Epoch: 13, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 1.6374831199645996
Epoch: 14, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 1.567774772644043
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 1.5868175029754639
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 1.2971227169036865
Epoch: 17, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3478057384490967
Epoch: 18, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.8491439819335938
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 1.6255435943603516
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 1.8481004238128662
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 1.9079251289367676
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.7581608295440674
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.8885293006896973
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.8608877658843994
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.315223217010498
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 1.1828510761260986
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 28 cost time: 0.9432337284088135
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.099729299545288
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.3493962287902832
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.561340570449829
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 32 cost time: 1.8007559776306152
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 33 cost time: 1.676313877105713
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.7103760242462158
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.7765626907348633
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.3832042217254639
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.4993987083435059
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.4596447944641113
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 39 cost time: 1.6417837142944336
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.4665300846099854
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.6828842163085938
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.7064838409423828
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.6784694194793701
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.948209285736084
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.675171136856079
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.3307247161865234
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 1.0702540874481201
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 1.2529942989349365
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 1915801
model size : 7.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps22_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.731546401977539
Epoch: 1, Steps: 18 | Train Loss: 3.223 Vali Loss: 3.110 Vali Acc: 0.217 Test Loss: 3.110 Test Acc: 0.217
Validation loss decreased (inf --> -0.216636).  Saving model ...
Epoch: 2 cost time: 1.3976094722747803
Epoch: 2, Steps: 18 | Train Loss: 2.788 Vali Loss: 2.578 Vali Acc: 0.787 Test Loss: 2.578 Test Acc: 0.787
Validation loss decreased (-0.216636 --> -0.786641).  Saving model ...
Epoch: 3 cost time: 1.4643149375915527
Epoch: 3, Steps: 18 | Train Loss: 1.979 Vali Loss: 1.592 Vali Acc: 0.927 Test Loss: 1.592 Test Acc: 0.927
Validation loss decreased (-0.786641 --> -0.926651).  Saving model ...
Epoch: 4 cost time: 1.39664626121521
Epoch: 4, Steps: 18 | Train Loss: 0.931 Vali Loss: 0.571 Vali Acc: 0.957 Test Loss: 0.571 Test Acc: 0.957
Validation loss decreased (-0.926651 --> -0.956661).  Saving model ...
Epoch: 5 cost time: 1.398644208908081
Epoch: 5, Steps: 18 | Train Loss: 0.255 Vali Loss: 0.235 Vali Acc: 0.957 Test Loss: 0.235 Test Acc: 0.957
Validation loss decreased (-0.956661 --> -0.956664).  Saving model ...
Epoch: 6 cost time: 1.5310511589050293
Epoch: 6, Steps: 18 | Train Loss: 0.081 Vali Loss: 0.154 Vali Acc: 0.970 Test Loss: 0.154 Test Acc: 0.970
Validation loss decreased (-0.956664 --> -0.969998).  Saving model ...
Epoch: 7 cost time: 1.651947021484375
Epoch: 7, Steps: 18 | Train Loss: 0.034 Vali Loss: 0.134 Vali Acc: 0.973 Test Loss: 0.134 Test Acc: 0.973
Validation loss decreased (-0.969998 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 1.54909086227417
Epoch: 8, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.131 Vali Acc: 0.970 Test Loss: 0.131 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.662179946899414
Epoch: 9, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.118 Vali Acc: 0.973 Test Loss: 0.118 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 1.546308994293213
Epoch: 10, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 1.8189878463745117
Epoch: 11, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 12 cost time: 1.5852746963500977
Epoch: 12, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 13 cost time: 1.7023451328277588
Epoch: 13, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5934174060821533
Epoch: 14, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 15 cost time: 1.408855676651001
Epoch: 15, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 16 cost time: 1.2872960567474365
Epoch: 16, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 17 cost time: 1.2396280765533447
Epoch: 17, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 18 cost time: 1.3199987411499023
Epoch: 18, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 19 cost time: 1.205439567565918
Epoch: 19, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 20 cost time: 1.2140312194824219
Epoch: 20, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 21 cost time: 1.2958130836486816
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2653617858886719
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 23 cost time: 1.6437432765960693
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 24 cost time: 1.3159897327423096
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 25 cost time: 1.3032023906707764
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.3705060482025146
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.5405895709991455
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 28 cost time: 1.6236238479614258
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 29 cost time: 1.5329725742340088
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 30 cost time: 1.4544970989227295
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.452423095703125
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.419907569885254
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 33 cost time: 1.472050428390503
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.2864658832550049
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 35 cost time: 1.2475244998931885
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.2120683193206787
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.426729440689087
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.3441593647003174
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.3712882995605469
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 40 cost time: 1.4200716018676758
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 41 cost time: 1.3559491634368896
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.5228700637817383
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.5702245235443115
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.2088840007781982
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.297255277633667
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 46 cost time: 1.2214140892028809
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.3656926155090332
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.2652950286865234
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 49 cost time: 1.1357979774475098
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.1667022705078125
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps22_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9733333333333334
model parameter : 1887225
model size : 7.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps29_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.753033399581909
Epoch: 1, Steps: 18 | Train Loss: 3.194 Vali Loss: 3.117 Vali Acc: 0.190 Test Loss: 3.117 Test Acc: 0.190
Validation loss decreased (inf --> -0.189969).  Saving model ...
Epoch: 2 cost time: 1.567214012145996
Epoch: 2, Steps: 18 | Train Loss: 2.808 Vali Loss: 2.657 Vali Acc: 0.757 Test Loss: 2.657 Test Acc: 0.757
Validation loss decreased (-0.189969 --> -0.756640).  Saving model ...
Epoch: 3 cost time: 1.4648280143737793
Epoch: 3, Steps: 18 | Train Loss: 2.159 Vali Loss: 1.852 Vali Acc: 0.913 Test Loss: 1.852 Test Acc: 0.913
Validation loss decreased (-0.756640 --> -0.913315).  Saving model ...
Epoch: 4 cost time: 1.3906707763671875
Epoch: 4, Steps: 18 | Train Loss: 1.259 Vali Loss: 0.891 Vali Acc: 0.933 Test Loss: 0.891 Test Acc: 0.933
Validation loss decreased (-0.913315 --> -0.933324).  Saving model ...
Epoch: 5 cost time: 1.6488375663757324
Epoch: 5, Steps: 18 | Train Loss: 0.490 Vali Loss: 0.344 Vali Acc: 0.967 Test Loss: 0.344 Test Acc: 0.967
Validation loss decreased (-0.933324 --> -0.966663).  Saving model ...
Epoch: 6 cost time: 1.3187227249145508
Epoch: 6, Steps: 18 | Train Loss: 0.147 Vali Loss: 0.198 Vali Acc: 0.967 Test Loss: 0.198 Test Acc: 0.967
Validation loss decreased (-0.966663 --> -0.966665).  Saving model ...
Epoch: 7 cost time: 1.2830486297607422
Epoch: 7, Steps: 18 | Train Loss: 0.069 Vali Loss: 0.155 Vali Acc: 0.973 Test Loss: 0.155 Test Acc: 0.973
Validation loss decreased (-0.966665 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 1.6458983421325684
Epoch: 8, Steps: 18 | Train Loss: 0.036 Vali Loss: 0.133 Vali Acc: 0.973 Test Loss: 0.133 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 1.4901151657104492
Epoch: 9, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 1.44618558883667
Epoch: 10, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 1.4922175407409668
Epoch: 11, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.110 Vali Acc: 0.980 Test Loss: 0.110 Test Acc: 0.980
Validation loss decreased (-0.973332 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 1.2960193157196045
Epoch: 12, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 1.2612342834472656
Epoch: 13, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4169855117797852
Epoch: 14, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 1.6572129726409912
Epoch: 15, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 1.421886682510376
Epoch: 16, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.6599667072296143
Epoch: 17, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 1.4738867282867432
Epoch: 18, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 1.4502222537994385
Epoch: 19, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 1.7447233200073242
Epoch: 20, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 1.47306489944458
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 1.449340581893921
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 1.8019757270812988
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 1.6330742835998535
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.6276342868804932
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.2105560302734375
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 1.2708401679992676
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 1.5845699310302734
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 1.2665469646453857
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.5696406364440918
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.3586761951446533
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 32 cost time: 1.614762783050537
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 33 cost time: 1.5824921131134033
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 34 cost time: 1.4498770236968994
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 35 cost time: 1.2028627395629883
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.443936824798584
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 37 cost time: 1.386723518371582
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 38 cost time: 1.299858808517456
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.2303383350372314
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.3153936862945557
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.4627788066864014
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 42 cost time: 1.5792102813720703
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 43 cost time: 1.5507221221923828
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.6258437633514404
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.3679237365722656
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.3211967945098877
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.607811689376831
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 48 cost time: 1.394383192062378
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 49 cost time: 1.3850071430206299
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.5542912483215332
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps29_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 1858649
model size : 7.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps36_str18_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.4283058643341064
Epoch: 1, Steps: 18 | Train Loss: 3.183 Vali Loss: 3.139 Vali Acc: 0.207 Test Loss: 3.139 Test Acc: 0.207
Validation loss decreased (inf --> -0.206635).  Saving model ...
Epoch: 2 cost time: 1.6267120838165283
Epoch: 2, Steps: 18 | Train Loss: 2.922 Vali Loss: 2.809 Vali Acc: 0.563 Test Loss: 2.809 Test Acc: 0.563
Validation loss decreased (-0.206635 --> -0.563305).  Saving model ...
Epoch: 3 cost time: 1.6866366863250732
Epoch: 3, Steps: 18 | Train Loss: 2.472 Vali Loss: 2.234 Vali Acc: 0.827 Test Loss: 2.234 Test Acc: 0.827
Validation loss decreased (-0.563305 --> -0.826644).  Saving model ...
Epoch: 4 cost time: 1.4370946884155273
Epoch: 4, Steps: 18 | Train Loss: 1.796 Vali Loss: 1.438 Vali Acc: 0.923 Test Loss: 1.438 Test Acc: 0.923
Validation loss decreased (-0.826644 --> -0.923319).  Saving model ...
Epoch: 5 cost time: 1.4107446670532227
Epoch: 5, Steps: 18 | Train Loss: 0.970 Vali Loss: 0.676 Vali Acc: 0.967 Test Loss: 0.676 Test Acc: 0.967
Validation loss decreased (-0.923319 --> -0.966660).  Saving model ...
Epoch: 6 cost time: 1.7308173179626465
Epoch: 6, Steps: 18 | Train Loss: 0.399 Vali Loss: 0.319 Vali Acc: 0.970 Test Loss: 0.319 Test Acc: 0.970
Validation loss decreased (-0.966660 --> -0.969997).  Saving model ...
Epoch: 7 cost time: 1.442962884902954
Epoch: 7, Steps: 18 | Train Loss: 0.158 Vali Loss: 0.207 Vali Acc: 0.973 Test Loss: 0.207 Test Acc: 0.973
Validation loss decreased (-0.969997 --> -0.973331).  Saving model ...
Epoch: 8 cost time: 1.28420090675354
Epoch: 8, Steps: 18 | Train Loss: 0.076 Vali Loss: 0.165 Vali Acc: 0.977 Test Loss: 0.165 Test Acc: 0.977
Validation loss decreased (-0.973331 --> -0.976665).  Saving model ...
Epoch: 9 cost time: 1.438584566116333
Epoch: 9, Steps: 18 | Train Loss: 0.046 Vali Loss: 0.140 Vali Acc: 0.983 Test Loss: 0.140 Test Acc: 0.983
Validation loss decreased (-0.976665 --> -0.983332).  Saving model ...
Epoch: 10 cost time: 1.0565719604492188
Epoch: 10, Steps: 18 | Train Loss: 0.031 Vali Loss: 0.124 Vali Acc: 0.980 Test Loss: 0.124 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0946969985961914
Epoch: 11, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.116 Vali Acc: 0.987 Test Loss: 0.116 Test Acc: 0.987
Validation loss decreased (-0.983332 --> -0.986666).  Saving model ...
Epoch: 12 cost time: 1.3037183284759521
Epoch: 12, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.108 Vali Acc: 0.987 Test Loss: 0.108 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 13 cost time: 1.1670200824737549
Epoch: 13, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.104 Vali Acc: 0.987 Test Loss: 0.104 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 14 cost time: 1.2906084060668945
Epoch: 14, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.098 Vali Acc: 0.983 Test Loss: 0.098 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3217597007751465
Epoch: 15, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.094 Vali Acc: 0.983 Test Loss: 0.094 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.196239709854126
Epoch: 16, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.092 Vali Acc: 0.983 Test Loss: 0.092 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.1976518630981445
Epoch: 17, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.091 Vali Acc: 0.983 Test Loss: 0.091 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.6222059726715088
Epoch: 18, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.1931354999542236
Epoch: 19, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.223931074142456
Epoch: 20, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.2080318927764893
Epoch: 21, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.4373373985290527
Epoch: 22, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.4372756481170654
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.987 Test Loss: 0.084 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 24 cost time: 1.5914487838745117
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.987 Test Loss: 0.084 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.265855312347412
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.987 Test Loss: 0.084 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.3260748386383057
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.641282558441162
Epoch: 27, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.2225379943847656
Epoch: 28, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.0771067142486572
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.987 Test Loss: 0.083 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 30 cost time: 1.1322994232177734
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.9974405765533447
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.511418342590332
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.50669527053833
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.987 Test Loss: 0.082 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 34 cost time: 1.3051061630249023
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.399249792098999
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.987 Test Loss: 0.082 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 36 cost time: 1.4901494979858398
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.3301708698272705
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.2999238967895508
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.4910948276519775
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.2859869003295898
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.987 Test Loss: 0.082 Test Acc: 0.987
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.1990914344787598
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.3136184215545654
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.3497629165649414
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.2951595783233643
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 1.2408134937286377
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.987 Test Loss: 0.081 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 46 cost time: 1.289454698562622
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.3442273139953613
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.3032546043395996
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.2638349533081055
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 1.4197998046875
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps36_str18_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9866666666666667
model parameter : 1830073
model size : 7.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.914616107940674
Epoch: 1, Steps: 18 | Train Loss: 2.338 Vali Loss: 0.805 Vali Acc: 0.933 Test Loss: 0.805 Test Acc: 0.933
Validation loss decreased (inf --> -0.933325).  Saving model ...
Epoch: 2 cost time: 2.8566815853118896
Epoch: 2, Steps: 18 | Train Loss: 0.123 Vali Loss: 0.155 Vali Acc: 0.957 Test Loss: 0.155 Test Acc: 0.957
Validation loss decreased (-0.933325 --> -0.956665).  Saving model ...
Epoch: 3 cost time: 2.2692697048187256
Epoch: 3, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.141 Vali Acc: 0.970 Test Loss: 0.141 Test Acc: 0.970
Validation loss decreased (-0.956665 --> -0.969999).  Saving model ...
Epoch: 4 cost time: 2.4517428874969482
Epoch: 4, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.162 Vali Acc: 0.970 Test Loss: 0.162 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.3834664821624756
Epoch: 5, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.151 Vali Acc: 0.963 Test Loss: 0.151 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.9070777893066406
Epoch: 6, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.145 Vali Acc: 0.967 Test Loss: 0.145 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.4222800731658936
Epoch: 7, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.128 Vali Acc: 0.967 Test Loss: 0.128 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.6677703857421875
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.124 Vali Acc: 0.970 Test Loss: 0.124 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 9 cost time: 2.54787015914917
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.123 Vali Acc: 0.970 Test Loss: 0.123 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 10 cost time: 2.294888734817505
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.121 Vali Acc: 0.970 Test Loss: 0.121 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 11 cost time: 2.3088369369506836
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.970 Test Loss: 0.120 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 12 cost time: 2.628836154937744
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.970 Test Loss: 0.120 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 13 cost time: 2.4362831115722656
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.970 Test Loss: 0.119 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 14 cost time: 2.614396572113037
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.970 Test Loss: 0.118 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 15 cost time: 2.8694517612457275
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.970 Test Loss: 0.118 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 16 cost time: 2.9395194053649902
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.970 Test Loss: 0.117 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 17 cost time: 2.187084436416626
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.970 Test Loss: 0.117 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 18 cost time: 2.1794402599334717
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.970 Test Loss: 0.117 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 19 cost time: 2.8252227306365967
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.970 Test Loss: 0.116 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 20 cost time: 2.698080539703369
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.970 Test Loss: 0.116 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 21 cost time: 2.9417078495025635
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 22 cost time: 2.569143056869507
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 23 cost time: 2.704047441482544
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.9832887649536133
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.4240846633911133
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.4847166538238525
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.0245935916900635
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 28 cost time: 2.6978142261505127
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.0216941833496094
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.970 Test Loss: 0.116 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.8145995140075684
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 31 cost time: 2.2685723304748535
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 32 cost time: 1.722560167312622
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.0916354656219482
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 2.085883617401123
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 35 cost time: 2.6417806148529053
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.6059370040893555
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 37 cost time: 2.92997407913208
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 2.290330648422241
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.9912700653076172
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 2.3529298305511475
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 2.764514207839966
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 2.431889057159424
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 2.561607599258423
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 2.3987298011779785
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 2.2920196056365967
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 2.0559377670288086
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 8399001
model size : 32.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.528135299682617
Epoch: 1, Steps: 18 | Train Loss: 2.668 Vali Loss: 1.723 Vali Acc: 0.920 Test Loss: 1.723 Test Acc: 0.920
Validation loss decreased (inf --> -0.919983).  Saving model ...
Epoch: 2 cost time: 2.1401374340057373
Epoch: 2, Steps: 18 | Train Loss: 0.418 Vali Loss: 0.174 Vali Acc: 0.957 Test Loss: 0.174 Test Acc: 0.957
Validation loss decreased (-0.919983 --> -0.956665).  Saving model ...
Epoch: 3 cost time: 2.1848835945129395
Epoch: 3, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.110 Vali Acc: 0.967 Test Loss: 0.110 Test Acc: 0.967
Validation loss decreased (-0.956665 --> -0.966666).  Saving model ...
Epoch: 4 cost time: 1.8819403648376465
Epoch: 4, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.118 Vali Acc: 0.970 Test Loss: 0.118 Test Acc: 0.970
Validation loss decreased (-0.966666 --> -0.969999).  Saving model ...
Epoch: 5 cost time: 2.112457752227783
Epoch: 5, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 6 cost time: 2.05232310295105
Epoch: 6, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 2.198028326034546
Epoch: 7, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 8 cost time: 2.1529924869537354
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 2.203568696975708
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 2.24958872795105
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 1.765190601348877
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 1.4760048389434814
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 1.379037857055664
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.026860475540161
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 1.3607118129730225
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 1.6402866840362549
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 1.5781152248382568
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 1.8579890727996826
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 2.281399726867676
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 2.0817973613739014
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 2.533874273300171
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 2.1288983821868896
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 1.8735706806182861
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.4464333057403564
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.3533990383148193
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 1.419830560684204
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.9901113510131836
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.138378620147705
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.8304078578948975
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.7705731391906738
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.979532241821289
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 2.2149736881256104
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.996800184249878
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.8705816268920898
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 2.0388407707214355
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 36 cost time: 1.7425644397735596
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 37 cost time: 1.9223158359527588
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.7910816669464111
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.6277258396148682
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.8413827419281006
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.6404790878295898
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 2.2188589572906494
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.983 Test Loss: 0.097 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 43 cost time: 2.1276068687438965
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.983 Test Loss: 0.098 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 2.0612118244171143
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.983 Test Loss: 0.097 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 45 cost time: 2.4985086917877197
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.983 Test Loss: 0.097 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.812366008758545
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.983 Test Loss: 0.097 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.6589386463165283
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.983 Test Loss: 0.097 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.6683502197265625
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.983 Test Loss: 0.098 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 1.8677771091461182
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.983 Test Loss: 0.097 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 2.029484272003174
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.983 Test Loss: 0.098 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 7362713
model size : 28.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.2362232208251953
Epoch: 1, Steps: 18 | Train Loss: 2.885 Vali Loss: 2.229 Vali Acc: 0.907 Test Loss: 2.229 Test Acc: 0.907
Validation loss decreased (inf --> -0.906644).  Saving model ...
Epoch: 2 cost time: 1.8065557479858398
Epoch: 2, Steps: 18 | Train Loss: 0.904 Vali Loss: 0.345 Vali Acc: 0.927 Test Loss: 0.345 Test Acc: 0.927
Validation loss decreased (-0.906644 --> -0.926663).  Saving model ...
Epoch: 3 cost time: 2.0077762603759766
Epoch: 3, Steps: 18 | Train Loss: 0.073 Vali Loss: 0.134 Vali Acc: 0.967 Test Loss: 0.134 Test Acc: 0.967
Validation loss decreased (-0.926663 --> -0.966665).  Saving model ...
Epoch: 4 cost time: 1.6865334510803223
Epoch: 4, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.124 Vali Acc: 0.970 Test Loss: 0.124 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969999).  Saving model ...
Epoch: 5 cost time: 1.9304649829864502
Epoch: 5, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.117 Vali Acc: 0.970 Test Loss: 0.117 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 6 cost time: 1.8305809497833252
Epoch: 6, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 1.7681248188018799
Epoch: 7, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 2.081266403198242
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 1.6443042755126953
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 1.6585078239440918
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 1.761840581893921
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 12 cost time: 1.5691287517547607
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 13 cost time: 2.227444648742676
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 14 cost time: 1.8567452430725098
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 15 cost time: 1.6752877235412598
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 16 cost time: 1.6374094486236572
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 17 cost time: 1.6715025901794434
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 18 cost time: 1.9176650047302246
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 19 cost time: 2.0301129817962646
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 20 cost time: 1.8878769874572754
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 21 cost time: 1.7982163429260254
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.6587865352630615
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.7346925735473633
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.4385828971862793
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.8758244514465332
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.718064785003662
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.7206439971923828
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.059333086013794
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.778637409210205
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 30 cost time: 1.8139269351959229
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.4323885440826416
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.6486339569091797
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 33 cost time: 1.853825569152832
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 34 cost time: 1.8759980201721191
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 35 cost time: 1.940927267074585
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.93326735496521
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 2.1179418563842773
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 38 cost time: 1.545058012008667
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 2.009998083114624
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.6839354038238525
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.5025217533111572
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.6818671226501465
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.512970209121704
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.9245407581329346
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.962916374206543
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 1.6375982761383057
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 2.123934268951416
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 7017497
model size : 26.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.371431589126587
Epoch: 1, Steps: 18 | Train Loss: 3.033 Vali Loss: 2.537 Vali Acc: 0.840 Test Loss: 2.537 Test Acc: 0.840
Validation loss decreased (inf --> -0.839975).  Saving model ...
Epoch: 2 cost time: 2.205731153488159
Epoch: 2, Steps: 18 | Train Loss: 1.285 Vali Loss: 0.563 Vali Acc: 0.967 Test Loss: 0.563 Test Acc: 0.967
Validation loss decreased (-0.839975 --> -0.966661).  Saving model ...
Epoch: 3 cost time: 1.9581148624420166
Epoch: 3, Steps: 18 | Train Loss: 0.131 Vali Loss: 0.131 Vali Acc: 0.973 Test Loss: 0.131 Test Acc: 0.973
Validation loss decreased (-0.966661 --> -0.973332).  Saving model ...
Epoch: 4 cost time: 1.4843947887420654
Epoch: 4, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.115 Vali Acc: 0.967 Test Loss: 0.115 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1323559284210205
Epoch: 5, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 6 cost time: 1.3980600833892822
Epoch: 6, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 7 cost time: 1.6096022129058838
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 8 cost time: 1.590362548828125
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 1.6385283470153809
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 1.958277940750122
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 1.7388653755187988
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 2.036203145980835
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 1.4482121467590332
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 1.9187524318695068
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 2.151561975479126
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 1.4235765933990479
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 1.7492501735687256
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 1.425034761428833
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 1.464338779449463
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 1.56675386428833
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 1.506760835647583
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 1.5846922397613525
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.8733668327331543
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.7703876495361328
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.0874905586242676
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.666459083557129
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.9694759845733643
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.7099072933197021
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.4240095615386963
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.561061143875122
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.6697056293487549
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 6845209
model size : 26.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps22_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.6121432781219482
Epoch: 1, Steps: 18 | Train Loss: 2.975 Vali Loss: 2.524 Vali Acc: 0.833 Test Loss: 2.524 Test Acc: 0.833
Validation loss decreased (inf --> -0.833308).  Saving model ...
Epoch: 2 cost time: 1.367875337600708
Epoch: 2, Steps: 18 | Train Loss: 1.383 Vali Loss: 0.692 Vali Acc: 0.953 Test Loss: 0.692 Test Acc: 0.953
Validation loss decreased (-0.833308 --> -0.953326).  Saving model ...
Epoch: 3 cost time: 1.7517931461334229
Epoch: 3, Steps: 18 | Train Loss: 0.184 Vali Loss: 0.142 Vali Acc: 0.973 Test Loss: 0.142 Test Acc: 0.973
Validation loss decreased (-0.953326 --> -0.973332).  Saving model ...
Epoch: 4 cost time: 2.1084554195404053
Epoch: 4, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.9100916385650635
Epoch: 5, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 6 cost time: 1.633570671081543
Epoch: 6, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 1.6377408504486084
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 1.7699885368347168
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 1.5363829135894775
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 2.1027345657348633
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 1.9540729522705078
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.055184841156006
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 2.371170997619629
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 2.5937740802764893
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 2.205502986907959
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.1979570388793945
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.743699550628662
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 1.7956793308258057
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 1.7869274616241455
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 2.192169666290283
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.7387173175811768
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 2.204043388366699
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.3555984497070312
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.0211360454559326
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 1.7342238426208496
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 1.9318768978118896
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 1.9959025382995605
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.0787532329559326
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.2124335765838623
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.375169515609741
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 2.561483383178711
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 2.1656620502471924
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.6705060005187988
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.9615752696990967
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.6174042224884033
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 2.3597335815429688
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps22_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 6730905
model size : 25.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps29_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.9946489334106445
Epoch: 1, Steps: 18 | Train Loss: 3.044 Vali Loss: 2.685 Vali Acc: 0.727 Test Loss: 2.685 Test Acc: 0.727
Validation loss decreased (inf --> -0.726640).  Saving model ...
Epoch: 2 cost time: 1.9381446838378906
Epoch: 2, Steps: 18 | Train Loss: 1.764 Vali Loss: 1.074 Vali Acc: 0.950 Test Loss: 1.074 Test Acc: 0.950
Validation loss decreased (-0.726640 --> -0.949989).  Saving model ...
Epoch: 3 cost time: 1.701343059539795
Epoch: 3, Steps: 18 | Train Loss: 0.371 Vali Loss: 0.222 Vali Acc: 0.947 Test Loss: 0.222 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.630342721939087
Epoch: 4, Steps: 18 | Train Loss: 0.050 Vali Loss: 0.121 Vali Acc: 0.967 Test Loss: 0.121 Test Acc: 0.967
Validation loss decreased (-0.949989 --> -0.966665).  Saving model ...
Epoch: 5 cost time: 1.8831982612609863
Epoch: 5, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
Validation loss decreased (-0.966665 --> -0.973332).  Saving model ...
Epoch: 6 cost time: 1.7639555931091309
Epoch: 6, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 1.870795726776123
Epoch: 7, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 2.1320128440856934
Epoch: 8, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 1.5959889888763428
Epoch: 9, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 1.7327818870544434
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2270481586456299
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.3205673694610596
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.5609984397888184
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.7562801837921143
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.010817766189575
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.8905365467071533
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.8428738117218018
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.9351606369018555
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.7345972061157227
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 1.3303442001342773
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 1.5527143478393555
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.3539540767669678
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.819246768951416
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.9524424076080322
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.7561726570129395
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.9043216705322266
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.763963222503662
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 28 cost time: 1.537339687347412
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 1.6372599601745605
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.218778133392334
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.3086249828338623
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.2886497974395752
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.3551785945892334
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.4558501243591309
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.6604914665222168
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.4936480522155762
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.8288793563842773
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.8870549201965332
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps29_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 6616601
model size : 25.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps36_str18_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.8632068634033203
Epoch: 1, Steps: 18 | Train Loss: 3.057 Vali Loss: 2.765 Vali Acc: 0.690 Test Loss: 2.765 Test Acc: 0.690
Validation loss decreased (inf --> -0.689972).  Saving model ...
Epoch: 2 cost time: 1.696364402770996
Epoch: 2, Steps: 18 | Train Loss: 2.012 Vali Loss: 1.404 Vali Acc: 0.953 Test Loss: 1.404 Test Acc: 0.953
Validation loss decreased (-0.689972 --> -0.953319).  Saving model ...
Epoch: 3 cost time: 1.5181503295898438
Epoch: 3, Steps: 18 | Train Loss: 0.624 Vali Loss: 0.306 Vali Acc: 0.957 Test Loss: 0.306 Test Acc: 0.957
Validation loss decreased (-0.953319 --> -0.956664).  Saving model ...
Epoch: 4 cost time: 1.5135481357574463
Epoch: 4, Steps: 18 | Train Loss: 0.082 Vali Loss: 0.140 Vali Acc: 0.970 Test Loss: 0.140 Test Acc: 0.970
Validation loss decreased (-0.956664 --> -0.969999).  Saving model ...
Epoch: 5 cost time: 1.3285470008850098
Epoch: 5, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 6 cost time: 1.148526668548584
Epoch: 6, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 1.450969934463501
Epoch: 7, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 1.754800796508789
Epoch: 8, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 1.70280122756958
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 1.9206953048706055
Epoch: 10, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 1.8606007099151611
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 1.5742132663726807
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.470435380935669
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.298966646194458
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.6240103244781494
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 1.57285737991333
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4114768505096436
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 1.5703635215759277
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 1.6264398097991943
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 1.7754080295562744
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 1.3582344055175781
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.423102617263794
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.5756151676177979
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.748690128326416
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.4279043674468994
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 1.3830711841583252
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 1.4533748626708984
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.534313440322876
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.5819454193115234
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.9460794925689697
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.5769286155700684
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.6576616764068604
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.9308481216430664
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 2.0579686164855957
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.8267474174499512
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.887702226638794
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps36_str18_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 6559897
model size : 25.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.959798574447632
Epoch: 1, Steps: 18 | Train Loss: 2.735 Vali Loss: 1.791 Vali Acc: 0.923 Test Loss: 1.791 Test Acc: 0.923
Validation loss decreased (inf --> -0.923315).  Saving model ...
Epoch: 2 cost time: 2.068117141723633
Epoch: 2, Steps: 18 | Train Loss: 0.530 Vali Loss: 0.214 Vali Acc: 0.967 Test Loss: 0.214 Test Acc: 0.967
Validation loss decreased (-0.923315 --> -0.966665).  Saving model ...
Epoch: 3 cost time: 2.052008867263794
Epoch: 3, Steps: 18 | Train Loss: 0.036 Vali Loss: 0.125 Vali Acc: 0.970 Test Loss: 0.125 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969999).  Saving model ...
Epoch: 4 cost time: 1.682295560836792
Epoch: 4, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.133 Vali Acc: 0.953 Test Loss: 0.133 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7369189262390137
Epoch: 5, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 6 cost time: 2.0383732318878174
Epoch: 6, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 1.411947250366211
Epoch: 7, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
Validation loss decreased (-0.973332 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 1.552332878112793
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.0094802379608154
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 2.0021238327026367
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 1.7787878513336182
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 1.596207618713379
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 1.7259671688079834
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 1.6768007278442383
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 1.77297043800354
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.755448818206787
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.4636611938476562
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 1.367173194885254
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 1.7112362384796143
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 2.109311580657959
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 1.6740412712097168
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.6751410961151123
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 1.9620120525360107
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.559523105621338
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.5634615421295166
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 1.6324090957641602
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.470682144165039
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.4880321025848389
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.8686375617980957
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.9021363258361816
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.7109153270721436
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.4871978759765625
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.9681978225708008
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.6675045490264893
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.1586666107177734
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.983 Test Loss: 0.096 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 36 cost time: 1.4647963047027588
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.983 Test Loss: 0.096 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.9098868370056152
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.983 Test Loss: 0.096 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.7270877361297607
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.983 Test Loss: 0.096 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.7161028385162354
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.983 Test Loss: 0.096 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.951695442199707
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.983 Test Loss: 0.096 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.8482141494750977
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.983 Test Loss: 0.096 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.7082016468048096
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.983 Test Loss: 0.096 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.9592325687408447
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.983 Test Loss: 0.096 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.9213924407958984
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.983 Test Loss: 0.096 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 1.5360124111175537
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.983 Test Loss: 0.096 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 2708569
model size : 10.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.72310733795166
Epoch: 1, Steps: 18 | Train Loss: 3.001 Vali Loss: 2.473 Vali Acc: 0.857 Test Loss: 2.473 Test Acc: 0.857
Validation loss decreased (inf --> -0.856642).  Saving model ...
Epoch: 2 cost time: 1.5190584659576416
Epoch: 2, Steps: 18 | Train Loss: 1.308 Vali Loss: 0.620 Vali Acc: 0.953 Test Loss: 0.620 Test Acc: 0.953
Validation loss decreased (-0.856642 --> -0.953327).  Saving model ...
Epoch: 3 cost time: 1.1697018146514893
Epoch: 3, Steps: 18 | Train Loss: 0.164 Vali Loss: 0.135 Vali Acc: 0.977 Test Loss: 0.135 Test Acc: 0.977
Validation loss decreased (-0.953327 --> -0.976665).  Saving model ...
Epoch: 4 cost time: 1.3221137523651123
Epoch: 4, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 5 cost time: 1.3214941024780273
Epoch: 5, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 6 cost time: 1.2337260246276855
Epoch: 6, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.983 Test Loss: 0.096 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 7 cost time: 1.5243430137634277
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.983 Test Loss: 0.092 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 8 cost time: 1.444516897201538
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.983 Test Loss: 0.090 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 9 cost time: 1.1779937744140625
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 10 cost time: 1.1381385326385498
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 11 cost time: 1.7195813655853271
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.7412030696868896
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.5637292861938477
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.755481481552124
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.4798755645751953
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.4408979415893555
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.5298552513122559
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.7331292629241943
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.6791753768920898
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.7148418426513672
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 2190425
model size : 8.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.9520952701568604
Epoch: 1, Steps: 18 | Train Loss: 3.083 Vali Loss: 2.731 Vali Acc: 0.730 Test Loss: 2.731 Test Acc: 0.730
Validation loss decreased (inf --> -0.729973).  Saving model ...
Epoch: 2 cost time: 0.9989626407623291
Epoch: 2, Steps: 18 | Train Loss: 1.819 Vali Loss: 1.159 Vali Acc: 0.950 Test Loss: 1.159 Test Acc: 0.950
Validation loss decreased (-0.729973 --> -0.949988).  Saving model ...
Epoch: 3 cost time: 0.9814364910125732
Epoch: 3, Steps: 18 | Train Loss: 0.409 Vali Loss: 0.240 Vali Acc: 0.960 Test Loss: 0.240 Test Acc: 0.960
Validation loss decreased (-0.949988 --> -0.959998).  Saving model ...
Epoch: 4 cost time: 0.996849536895752
Epoch: 4, Steps: 18 | Train Loss: 0.054 Vali Loss: 0.129 Vali Acc: 0.967 Test Loss: 0.129 Test Acc: 0.967
Validation loss decreased (-0.959998 --> -0.966665).  Saving model ...
Epoch: 5 cost time: 0.8869709968566895
Epoch: 5, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.114 Vali Acc: 0.970 Test Loss: 0.114 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969999).  Saving model ...
Epoch: 6 cost time: 0.9245185852050781
Epoch: 6, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
Validation loss decreased (-0.969999 --> -0.976666).  Saving model ...
Epoch: 7 cost time: 1.0712010860443115
Epoch: 7, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.130460262298584
Epoch: 8, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1220273971557617
Epoch: 9, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.0055391788482666
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.218433141708374
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.4381873607635498
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.5558600425720215
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 1.3608274459838867
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 1.0610032081604004
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 1.1766388416290283
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 1.350555658340454
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 1.290015459060669
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 1.3003060817718506
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 1.2913565635681152
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1881330013275146
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.1341800689697266
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.1734309196472168
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.400141716003418
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 1.1270935535430908
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 1.0836985111236572
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1095349788665771
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.577110767364502
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.32350492477417
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.2398972511291504
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.3623883724212646
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.497648000717163
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.312772512435913
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.2760114669799805
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.1103594303131104
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 2017817
model size : 7.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.6234688758850098
Epoch: 1, Steps: 18 | Train Loss: 3.117 Vali Loss: 2.855 Vali Acc: 0.577 Test Loss: 2.855 Test Acc: 0.577
Validation loss decreased (inf --> -0.576638).  Saving model ...
Epoch: 2 cost time: 1.3639826774597168
Epoch: 2, Steps: 18 | Train Loss: 2.123 Vali Loss: 1.591 Vali Acc: 0.920 Test Loss: 1.591 Test Acc: 0.920
Validation loss decreased (-0.576638 --> -0.919984).  Saving model ...
Epoch: 3 cost time: 1.2707300186157227
Epoch: 3, Steps: 18 | Train Loss: 0.713 Vali Loss: 0.376 Vali Acc: 0.960 Test Loss: 0.376 Test Acc: 0.960
Validation loss decreased (-0.919984 --> -0.959996).  Saving model ...
Epoch: 4 cost time: 1.2027029991149902
Epoch: 4, Steps: 18 | Train Loss: 0.109 Vali Loss: 0.148 Vali Acc: 0.967 Test Loss: 0.148 Test Acc: 0.967
Validation loss decreased (-0.959996 --> -0.966665).  Saving model ...
Epoch: 5 cost time: 1.218977928161621
Epoch: 5, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.118 Vali Acc: 0.967 Test Loss: 0.118 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 6 cost time: 1.1620357036590576
Epoch: 6, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
Validation loss decreased (-0.966665 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 1.0588140487670898
Epoch: 7, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0740902423858643
Epoch: 8, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.3209218978881836
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.1939802169799805
Epoch: 10, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.2015023231506348
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.1774718761444092
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 13 cost time: 1.303696632385254
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.11275053024292
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 15 cost time: 0.9514813423156738
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9669942855834961
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 17 cost time: 1.0802526473999023
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 18 cost time: 1.3094244003295898
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2236719131469727
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 20 cost time: 1.3561530113220215
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 21 cost time: 1.2358229160308838
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1530230045318604
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.284153699874878
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.3656151294708252
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.380335807800293
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 26 cost time: 1.0331368446350098
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0059611797332764
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 28 cost time: 1.1647577285766602
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 29 cost time: 1.2958018779754639
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.1942417621612549
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.0191247463226318
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 32 cost time: 1.2685692310333252
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.0755107402801514
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.943932056427002
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.9336991310119629
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.130279302597046
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.0062544345855713
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 38 cost time: 1.0635695457458496
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 39 cost time: 1.34157133102417
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.1912360191345215
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.28714919090271
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.2611327171325684
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.337296724319458
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 44 cost time: 1.096928596496582
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 45 cost time: 1.2100050449371338
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 46 cost time: 0.9329874515533447
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.9039950370788574
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.0457990169525146
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.1158668994903564
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 1.133131742477417
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 1931673
model size : 7.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps22_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.255336284637451
Epoch: 1, Steps: 18 | Train Loss: 3.136 Vali Loss: 2.922 Vali Acc: 0.483 Test Loss: 2.922 Test Acc: 0.483
Validation loss decreased (inf --> -0.483304).  Saving model ...
Epoch: 2 cost time: 0.957996129989624
Epoch: 2, Steps: 18 | Train Loss: 2.299 Vali Loss: 1.845 Vali Acc: 0.900 Test Loss: 1.845 Test Acc: 0.900
Validation loss decreased (-0.483304 --> -0.899982).  Saving model ...
Epoch: 3 cost time: 1.2346534729003906
Epoch: 3, Steps: 18 | Train Loss: 0.997 Vali Loss: 0.569 Vali Acc: 0.953 Test Loss: 0.569 Test Acc: 0.953
Validation loss decreased (-0.899982 --> -0.953328).  Saving model ...
Epoch: 4 cost time: 1.3644509315490723
Epoch: 4, Steps: 18 | Train Loss: 0.213 Vali Loss: 0.196 Vali Acc: 0.960 Test Loss: 0.196 Test Acc: 0.960
Validation loss decreased (-0.953328 --> -0.959998).  Saving model ...
Epoch: 5 cost time: 1.0976972579956055
Epoch: 5, Steps: 18 | Train Loss: 0.045 Vali Loss: 0.124 Vali Acc: 0.970 Test Loss: 0.124 Test Acc: 0.970
Validation loss decreased (-0.959998 --> -0.969999).  Saving model ...
Epoch: 6 cost time: 1.2735569477081299
Epoch: 6, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 1.2008583545684814
Epoch: 7, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 8 cost time: 1.2637321949005127
Epoch: 8, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1115989685058594
Epoch: 9, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 0.9819934368133545
Epoch: 10, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 1.340212345123291
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 1.356940746307373
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 1.2847931385040283
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 1.2405259609222412
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 1.1892168521881104
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 1.2144567966461182
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 1.3142766952514648
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1791508197784424
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.2720587253570557
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.191823959350586
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.31419038772583
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 1.2471370697021484
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.3935503959655762
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.41105055809021
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.195540428161621
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.289228916168213
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.376173973083496
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.2866995334625244
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.0603363513946533
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.1877858638763428
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.229712724685669
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps22_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 1874521
model size : 7.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps29_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.602430582046509
Epoch: 1, Steps: 18 | Train Loss: 3.131 Vali Loss: 2.946 Vali Acc: 0.460 Test Loss: 2.946 Test Acc: 0.460
Validation loss decreased (inf --> -0.459971).  Saving model ...
Epoch: 2 cost time: 1.3551385402679443
Epoch: 2, Steps: 18 | Train Loss: 2.488 Vali Loss: 2.097 Vali Acc: 0.897 Test Loss: 2.097 Test Acc: 0.897
Validation loss decreased (-0.459971 --> -0.896646).  Saving model ...
Epoch: 3 cost time: 1.0823605060577393
Epoch: 3, Steps: 18 | Train Loss: 1.382 Vali Loss: 0.891 Vali Acc: 0.960 Test Loss: 0.891 Test Acc: 0.960
Validation loss decreased (-0.896646 --> -0.959991).  Saving model ...
Epoch: 4 cost time: 1.046921730041504
Epoch: 4, Steps: 18 | Train Loss: 0.408 Vali Loss: 0.262 Vali Acc: 0.970 Test Loss: 0.262 Test Acc: 0.970
Validation loss decreased (-0.959991 --> -0.969997).  Saving model ...
Epoch: 5 cost time: 1.1154005527496338
Epoch: 5, Steps: 18 | Train Loss: 0.103 Vali Loss: 0.155 Vali Acc: 0.970 Test Loss: 0.155 Test Acc: 0.970
Validation loss decreased (-0.969997 --> -0.969998).  Saving model ...
Epoch: 6 cost time: 1.1731736660003662
Epoch: 6, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
Validation loss decreased (-0.969998 --> -0.976666).  Saving model ...
Epoch: 7 cost time: 1.1475703716278076
Epoch: 7, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 8 cost time: 1.2603323459625244
Epoch: 8, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 1.480895757675171
Epoch: 9, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1405823230743408
Epoch: 10, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.2069296836853027
Epoch: 11, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.2122166156768799
Epoch: 12, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.0805373191833496
Epoch: 13, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.0220293998718262
Epoch: 14, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.160151720046997
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.42167067527771
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.1974549293518066
Epoch: 17, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.3257060050964355
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps29_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 1817369
model size : 6.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps36_str18_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.445673942565918
Epoch: 1, Steps: 18 | Train Loss: 3.171 Vali Loss: 2.993 Vali Acc: 0.310 Test Loss: 2.993 Test Acc: 0.310
Validation loss decreased (inf --> -0.309970).  Saving model ...
Epoch: 2 cost time: 1.3225929737091064
Epoch: 2, Steps: 18 | Train Loss: 2.630 Vali Loss: 2.327 Vali Acc: 0.837 Test Loss: 2.327 Test Acc: 0.837
Validation loss decreased (-0.309970 --> -0.836643).  Saving model ...
Epoch: 3 cost time: 1.3224449157714844
Epoch: 3, Steps: 18 | Train Loss: 1.735 Vali Loss: 1.260 Vali Acc: 0.947 Test Loss: 1.260 Test Acc: 0.947
Validation loss decreased (-0.836643 --> -0.946654).  Saving model ...
Epoch: 4 cost time: 1.1680750846862793
Epoch: 4, Steps: 18 | Train Loss: 0.673 Vali Loss: 0.410 Vali Acc: 0.967 Test Loss: 0.410 Test Acc: 0.967
Validation loss decreased (-0.946654 --> -0.966663).  Saving model ...
Epoch: 5 cost time: 1.1719028949737549
Epoch: 5, Steps: 18 | Train Loss: 0.176 Vali Loss: 0.189 Vali Acc: 0.967 Test Loss: 0.189 Test Acc: 0.967
Validation loss decreased (-0.966663 --> -0.966665).  Saving model ...
Epoch: 6 cost time: 1.2967631816864014
Epoch: 6, Steps: 18 | Train Loss: 0.051 Vali Loss: 0.147 Vali Acc: 0.970 Test Loss: 0.147 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969999).  Saving model ...
Epoch: 7 cost time: 1.0946547985076904
Epoch: 7, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.121 Vali Acc: 0.970 Test Loss: 0.121 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 8 cost time: 1.1043615341186523
Epoch: 8, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.111 Vali Acc: 0.970 Test Loss: 0.111 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 9 cost time: 1.0813250541687012
Epoch: 9, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 1.140989065170288
Epoch: 10, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0249834060668945
Epoch: 11, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 12 cost time: 1.132338047027588
Epoch: 12, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 13 cost time: 1.1436328887939453
Epoch: 13, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1116540431976318
Epoch: 14, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 15 cost time: 1.1925981044769287
Epoch: 15, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 16 cost time: 1.1073408126831055
Epoch: 16, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 17 cost time: 1.0339739322662354
Epoch: 17, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 18 cost time: 0.9986534118652344
Epoch: 18, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 19 cost time: 0.9412381649017334
Epoch: 19, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0194175243377686
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 21 cost time: 0.9630551338195801
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 22 cost time: 1.2645180225372314
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 23 cost time: 1.1995244026184082
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 24 cost time: 1.0934011936187744
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 25 cost time: 1.187401533126831
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 26 cost time: 1.3257074356079102
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 27 cost time: 1.3707520961761475
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0274176597595215
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.118751049041748
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.2287468910217285
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.3378081321716309
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 32 cost time: 1.424431324005127
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 33 cost time: 1.3818035125732422
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.0843617916107178
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.0272178649902344
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.9983770847320557
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 37 cost time: 1.1721904277801514
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 38 cost time: 1.0151612758636475
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.9965262413024902
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.2339272499084473
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.129901647567749
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 42 cost time: 1.1650633811950684
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.1938211917877197
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.4663541316986084
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.4480881690979004
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.1587669849395752
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.160170078277588
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.3629307746887207
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 1.1245012283325195
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 1.2461707592010498
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps36_str18_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 1789017
model size : 6.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.280513286590576
Epoch: 1, Steps: 18 | Train Loss: 2.928 Vali Loss: 2.381 Vali Acc: 0.900 Test Loss: 2.381 Test Acc: 0.900
Validation loss decreased (inf --> -0.899976).  Saving model ...
Epoch: 2 cost time: 0.7970528602600098
Epoch: 2, Steps: 18 | Train Loss: 1.255 Vali Loss: 0.644 Vali Acc: 0.963 Test Loss: 0.644 Test Acc: 0.963
Validation loss decreased (-0.899976 --> -0.963327).  Saving model ...
Epoch: 3 cost time: 0.8033130168914795
Epoch: 3, Steps: 18 | Train Loss: 0.175 Vali Loss: 0.164 Vali Acc: 0.963 Test Loss: 0.164 Test Acc: 0.963
Validation loss decreased (-0.963327 --> -0.963332).  Saving model ...
Epoch: 4 cost time: 1.1176364421844482
Epoch: 4, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
Validation loss decreased (-0.963332 --> -0.973332).  Saving model ...
Epoch: 5 cost time: 0.8336548805236816
Epoch: 5, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 6 cost time: 1.0708577632904053
Epoch: 6, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0199494361877441
Epoch: 7, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.188788890838623
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.1057226657867432
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 1.147402048110962
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 0.8264720439910889
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 1.2284071445465088
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9638175964355469
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 0.9977304935455322
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 1.0775730609893799
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3778605461120605
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.18400239944458
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 1.1689159870147705
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2411048412322998
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 1.358043909072876
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 1.1339688301086426
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1496613025665283
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.1283764839172363
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.0289368629455566
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 0.8801701068878174
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 0.9466032981872559
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.4540445804595947
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.8351223468780518
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.0329782962799072
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 30 cost time: 0.9668858051300049
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.1599020957946777
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.025609016418457
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.0749595165252686
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.8051824569702148
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 35 cost time: 1.3002300262451172
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.0890719890594482
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.1368632316589355
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.2375068664550781
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.198632001876831
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.944852352142334
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.0749337673187256
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.1538803577423096
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 1.0001578330993652
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 1.0087175369262695
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 981561
model size : 3.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.276445150375366
Epoch: 1, Steps: 18 | Train Loss: 3.078 Vali Loss: 2.807 Vali Acc: 0.527 Test Loss: 2.807 Test Acc: 0.527
Validation loss decreased (inf --> -0.526639).  Saving model ...
Epoch: 2 cost time: 1.040905237197876
Epoch: 2, Steps: 18 | Train Loss: 2.099 Vali Loss: 1.574 Vali Acc: 0.917 Test Loss: 1.574 Test Acc: 0.917
Validation loss decreased (-0.526639 --> -0.916651).  Saving model ...
Epoch: 3 cost time: 1.0534536838531494
Epoch: 3, Steps: 18 | Train Loss: 0.760 Vali Loss: 0.455 Vali Acc: 0.960 Test Loss: 0.455 Test Acc: 0.960
Validation loss decreased (-0.916651 --> -0.959995).  Saving model ...
Epoch: 4 cost time: 1.2277038097381592
Epoch: 4, Steps: 18 | Train Loss: 0.138 Vali Loss: 0.183 Vali Acc: 0.960 Test Loss: 0.183 Test Acc: 0.960
Validation loss decreased (-0.959995 --> -0.959998).  Saving model ...
Epoch: 5 cost time: 0.8998591899871826
Epoch: 5, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.120 Vali Acc: 0.973 Test Loss: 0.120 Test Acc: 0.973
Validation loss decreased (-0.959998 --> -0.973332).  Saving model ...
Epoch: 6 cost time: 0.8278090953826904
Epoch: 6, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 1.0411262512207031
Epoch: 7, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 1.058098554611206
Epoch: 8, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 0.9099216461181641
Epoch: 9, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 0.9265756607055664
Epoch: 10, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0244550704956055
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 12 cost time: 0.8313465118408203
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 13 cost time: 0.9162659645080566
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 14 cost time: 0.8925905227661133
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 15 cost time: 1.081709861755371
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 16 cost time: 0.9413473606109619
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 17 cost time: 0.9138815402984619
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 18 cost time: 0.8487260341644287
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 19 cost time: 0.7548823356628418
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 20 cost time: 0.837125301361084
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 21 cost time: 0.781048059463501
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 22 cost time: 0.8408119678497314
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 23 cost time: 0.841118574142456
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.842538595199585
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.0055618286132812
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 26 cost time: 1.167651891708374
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 27 cost time: 0.8937132358551025
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8940813541412354
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 29 cost time: 1.0245015621185303
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 30 cost time: 0.8898138999938965
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 31 cost time: 0.9045379161834717
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.1202855110168457
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.9392077922821045
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.943742036819458
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.9619886875152588
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.1012237071990967
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.9091870784759521
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.0123276710510254
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 39 cost time: 1.093794822692871
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.1501874923706055
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.9721567630767822
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 42 cost time: 0.9174907207489014
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.1220016479492188
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 44 cost time: 0.8814353942871094
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.8084473609924316
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 46 cost time: 0.8086512088775635
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.0670619010925293
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.8719532489776611
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.9887399673461914
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 50 cost time: 1.0713129043579102
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 722489
model size : 2.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.3642702102661133
Epoch: 1, Steps: 18 | Train Loss: 3.168 Vali Loss: 2.985 Vali Acc: 0.437 Test Loss: 2.985 Test Acc: 0.437
Validation loss decreased (inf --> -0.436637).  Saving model ...
Epoch: 2 cost time: 0.9614048004150391
Epoch: 2, Steps: 18 | Train Loss: 2.552 Vali Loss: 2.225 Vali Acc: 0.923 Test Loss: 2.225 Test Acc: 0.923
Validation loss decreased (-0.436637 --> -0.923311).  Saving model ...
Epoch: 3 cost time: 1.0852766036987305
Epoch: 3, Steps: 18 | Train Loss: 1.540 Vali Loss: 1.061 Vali Acc: 0.953 Test Loss: 1.061 Test Acc: 0.953
Validation loss decreased (-0.923311 --> -0.953323).  Saving model ...
Epoch: 4 cost time: 1.1218457221984863
Epoch: 4, Steps: 18 | Train Loss: 0.489 Vali Loss: 0.337 Vali Acc: 0.963 Test Loss: 0.337 Test Acc: 0.963
Validation loss decreased (-0.953323 --> -0.963330).  Saving model ...
Epoch: 5 cost time: 1.0833823680877686
Epoch: 5, Steps: 18 | Train Loss: 0.109 Vali Loss: 0.171 Vali Acc: 0.970 Test Loss: 0.171 Test Acc: 0.970
Validation loss decreased (-0.963330 --> -0.969998).  Saving model ...
Epoch: 6 cost time: 1.0327510833740234
Epoch: 6, Steps: 18 | Train Loss: 0.034 Vali Loss: 0.133 Vali Acc: 0.977 Test Loss: 0.133 Test Acc: 0.977
Validation loss decreased (-0.969998 --> -0.976665).  Saving model ...
Epoch: 7 cost time: 1.0553596019744873
Epoch: 7, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.121 Vali Acc: 0.977 Test Loss: 0.121 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 8 cost time: 1.150522232055664
Epoch: 8, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 1.0057554244995117
Epoch: 9, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 0.9664924144744873
Epoch: 10, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 0.9090862274169922
Epoch: 11, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 1.0784428119659424
Epoch: 12, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 0.8959853649139404
Epoch: 13, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 1.0431311130523682
Epoch: 14, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 0.8903603553771973
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 1.0257580280303955
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 0.8355340957641602
Epoch: 17, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 1.006648063659668
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0649945735931396
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 0.8661046028137207
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 0.8980543613433838
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.983 Test Loss: 0.090 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 22 cost time: 0.8974394798278809
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.983 Test Loss: 0.090 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 23 cost time: 1.183474063873291
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.983 Test Loss: 0.090 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 24 cost time: 1.0855987071990967
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 25 cost time: 0.9917840957641602
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.107252597808838
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.983 Test Loss: 0.090 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.1033105850219727
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.983 Test Loss: 0.090 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.0155634880065918
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.0970861911773682
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 30 cost time: 1.1093220710754395
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 31 cost time: 1.0616464614868164
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.9913244247436523
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 33 cost time: 0.9104828834533691
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 34 cost time: 1.1110997200012207
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.9625117778778076
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.929558277130127
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.9121863842010498
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.0047681331634521
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.983 Test Loss: 0.090 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.8704679012298584
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.8915293216705322
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.029857873916626
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.8137753009796143
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.914020299911499
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 636185
model size : 2.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.695882797241211
Epoch: 1, Steps: 18 | Train Loss: 3.142 Vali Loss: 3.038 Vali Acc: 0.243 Test Loss: 3.038 Test Acc: 0.243
Validation loss decreased (inf --> -0.243303).  Saving model ...
Epoch: 2 cost time: 1.422476053237915
Epoch: 2, Steps: 18 | Train Loss: 2.668 Vali Loss: 2.435 Vali Acc: 0.830 Test Loss: 2.435 Test Acc: 0.830
Validation loss decreased (-0.243303 --> -0.829976).  Saving model ...
Epoch: 3 cost time: 1.4501712322235107
Epoch: 3, Steps: 18 | Train Loss: 1.833 Vali Loss: 1.456 Vali Acc: 0.950 Test Loss: 1.456 Test Acc: 0.950
Validation loss decreased (-0.829976 --> -0.949985).  Saving model ...
Epoch: 4 cost time: 1.162430763244629
Epoch: 4, Steps: 18 | Train Loss: 0.842 Vali Loss: 0.560 Vali Acc: 0.950 Test Loss: 0.560 Test Acc: 0.950
Validation loss decreased (-0.949985 --> -0.949994).  Saving model ...
Epoch: 5 cost time: 1.0418651103973389
Epoch: 5, Steps: 18 | Train Loss: 0.229 Vali Loss: 0.235 Vali Acc: 0.963 Test Loss: 0.235 Test Acc: 0.963
Validation loss decreased (-0.949994 --> -0.963331).  Saving model ...
Epoch: 6 cost time: 1.1763944625854492
Epoch: 6, Steps: 18 | Train Loss: 0.079 Vali Loss: 0.158 Vali Acc: 0.967 Test Loss: 0.158 Test Acc: 0.967
Validation loss decreased (-0.963331 --> -0.966665).  Saving model ...
Epoch: 7 cost time: 1.2798471450805664
Epoch: 7, Steps: 18 | Train Loss: 0.031 Vali Loss: 0.134 Vali Acc: 0.977 Test Loss: 0.134 Test Acc: 0.977
Validation loss decreased (-0.966665 --> -0.976665).  Saving model ...
Epoch: 8 cost time: 1.1683919429779053
Epoch: 8, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.128 Vali Acc: 0.980 Test Loss: 0.128 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 1.1177351474761963
Epoch: 9, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.119 Vali Acc: 0.980 Test Loss: 0.119 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 0.9616515636444092
Epoch: 10, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.115 Vali Acc: 0.980 Test Loss: 0.115 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 1.0079364776611328
Epoch: 11, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 0.9505960941314697
Epoch: 12, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.108 Vali Acc: 0.980 Test Loss: 0.108 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 0.9799621105194092
Epoch: 13, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 1.0376942157745361
Epoch: 14, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 1.0782604217529297
Epoch: 15, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 0.9531059265136719
Epoch: 16, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9710626602172852
Epoch: 17, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.1944632530212402
Epoch: 18, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 1.3714427947998047
Epoch: 19, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.099 Vali Acc: 0.983 Test Loss: 0.099 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 20 cost time: 1.1598854064941406
Epoch: 20, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9976582527160645
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.2372462749481201
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.2623248100280762
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.944328784942627
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.9351410865783691
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.0010607242584229
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.8999752998352051
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.8350327014923096
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.9261956214904785
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 593113
model size : 2.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps22_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.097501516342163
Epoch: 1, Steps: 18 | Train Loss: 3.187 Vali Loss: 3.066 Vali Acc: 0.227 Test Loss: 3.066 Test Acc: 0.227
Validation loss decreased (inf --> -0.226636).  Saving model ...
Epoch: 2 cost time: 0.9103097915649414
Epoch: 2, Steps: 18 | Train Loss: 2.770 Vali Loss: 2.549 Vali Acc: 0.813 Test Loss: 2.549 Test Acc: 0.813
Validation loss decreased (-0.226636 --> -0.813308).  Saving model ...
Epoch: 3 cost time: 0.8017258644104004
Epoch: 3, Steps: 18 | Train Loss: 2.046 Vali Loss: 1.704 Vali Acc: 0.920 Test Loss: 1.704 Test Acc: 0.920
Validation loss decreased (-0.813308 --> -0.919983).  Saving model ...
Epoch: 4 cost time: 0.8542084693908691
Epoch: 4, Steps: 18 | Train Loss: 1.092 Vali Loss: 0.793 Vali Acc: 0.937 Test Loss: 0.793 Test Acc: 0.937
Validation loss decreased (-0.919983 --> -0.936659).  Saving model ...
Epoch: 5 cost time: 1.015146017074585
Epoch: 5, Steps: 18 | Train Loss: 0.380 Vali Loss: 0.312 Vali Acc: 0.970 Test Loss: 0.312 Test Acc: 0.970
Validation loss decreased (-0.936659 --> -0.969997).  Saving model ...
Epoch: 6 cost time: 1.3330070972442627
Epoch: 6, Steps: 18 | Train Loss: 0.117 Vali Loss: 0.189 Vali Acc: 0.963 Test Loss: 0.189 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1206471920013428
Epoch: 7, Steps: 18 | Train Loss: 0.053 Vali Loss: 0.150 Vali Acc: 0.967 Test Loss: 0.150 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9758913516998291
Epoch: 8, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.133 Vali Acc: 0.970 Test Loss: 0.133 Test Acc: 0.970
Validation loss decreased (-0.969997 --> -0.969999).  Saving model ...
Epoch: 9 cost time: 0.9458656311035156
Epoch: 9, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 1.0744130611419678
Epoch: 10, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9941089153289795
Epoch: 11, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 0.7934718132019043
Epoch: 12, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 0.9557747840881348
Epoch: 13, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 1.0488433837890625
Epoch: 14, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 0.932405948638916
Epoch: 15, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 0.8319292068481445
Epoch: 16, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.054335117340088
Epoch: 17, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 1.1545805931091309
Epoch: 18, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 1.0285558700561523
Epoch: 19, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 1.022838830947876
Epoch: 20, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 1.2864048480987549
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 1.0913166999816895
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 0.9999909400939941
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 1.0058159828186035
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 0.9457871913909912
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 0.9850385189056396
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 0.9389863014221191
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 28 cost time: 1.0133676528930664
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 1.2499549388885498
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 30 cost time: 0.982032299041748
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8982808589935303
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 32 cost time: 1.0257656574249268
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 33 cost time: 0.9938926696777344
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 34 cost time: 0.920987606048584
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.8869948387145996
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.1410667896270752
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 37 cost time: 1.085069179534912
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.1355159282684326
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 39 cost time: 1.179589033126831
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.0880706310272217
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 41 cost time: 1.049102783203125
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 42 cost time: 1.049541711807251
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 43 cost time: 1.1601874828338623
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.9331798553466797
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 45 cost time: 0.87339186668396
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 46 cost time: 0.8827128410339355
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.923161506652832
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.8640487194061279
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.8401801586151123
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.8673996925354004
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps22_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 564537
model size : 2.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps29_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.2612533569335938
Epoch: 1, Steps: 18 | Train Loss: 3.174 Vali Loss: 3.073 Vali Acc: 0.190 Test Loss: 3.073 Test Acc: 0.190
Validation loss decreased (inf --> -0.189969).  Saving model ...
Epoch: 2 cost time: 0.8508765697479248
Epoch: 2, Steps: 18 | Train Loss: 2.838 Vali Loss: 2.668 Vali Acc: 0.643 Test Loss: 2.668 Test Acc: 0.643
Validation loss decreased (-0.189969 --> -0.643307).  Saving model ...
Epoch: 3 cost time: 0.775599479675293
Epoch: 3, Steps: 18 | Train Loss: 2.289 Vali Loss: 2.026 Vali Acc: 0.843 Test Loss: 2.026 Test Acc: 0.843
Validation loss decreased (-0.643307 --> -0.843313).  Saving model ...
Epoch: 4 cost time: 0.8650906085968018
Epoch: 4, Steps: 18 | Train Loss: 1.550 Vali Loss: 1.203 Vali Acc: 0.940 Test Loss: 1.203 Test Acc: 0.940
Validation loss decreased (-0.843313 --> -0.939988).  Saving model ...
Epoch: 5 cost time: 0.9183721542358398
Epoch: 5, Steps: 18 | Train Loss: 0.744 Vali Loss: 0.547 Vali Acc: 0.963 Test Loss: 0.547 Test Acc: 0.963
Validation loss decreased (-0.939988 --> -0.963328).  Saving model ...
Epoch: 6 cost time: 0.8210601806640625
Epoch: 6, Steps: 18 | Train Loss: 0.289 Vali Loss: 0.278 Vali Acc: 0.963 Test Loss: 0.278 Test Acc: 0.963
Validation loss decreased (-0.963328 --> -0.963331).  Saving model ...
Epoch: 7 cost time: 0.867271900177002
Epoch: 7, Steps: 18 | Train Loss: 0.115 Vali Loss: 0.190 Vali Acc: 0.967 Test Loss: 0.190 Test Acc: 0.967
Validation loss decreased (-0.963331 --> -0.966665).  Saving model ...
Epoch: 8 cost time: 1.028944969177246
Epoch: 8, Steps: 18 | Train Loss: 0.071 Vali Loss: 0.153 Vali Acc: 0.973 Test Loss: 0.153 Test Acc: 0.973
Validation loss decreased (-0.966665 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 1.076869010925293
Epoch: 9, Steps: 18 | Train Loss: 0.035 Vali Loss: 0.132 Vali Acc: 0.977 Test Loss: 0.132 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 10 cost time: 0.9144773483276367
Epoch: 10, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.121 Vali Acc: 0.977 Test Loss: 0.121 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 11 cost time: 1.0707662105560303
Epoch: 11, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 1.0418074131011963
Epoch: 12, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 0.9277961254119873
Epoch: 13, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 1.2036662101745605
Epoch: 14, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 0.9887118339538574
Epoch: 15, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0945067405700684
Epoch: 16, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 1.0011887550354004
Epoch: 17, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9017329216003418
Epoch: 18, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.0121359825134277
Epoch: 19, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.8173220157623291
Epoch: 20, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.8273932933807373
Epoch: 21, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.8630502223968506
Epoch: 22, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.1773381233215332
Epoch: 23, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.2065584659576416
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.0088613033294678
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.0334033966064453
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps29_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 535961
model size : 2.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps36_str18_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.0626144409179688
Epoch: 1, Steps: 18 | Train Loss: 3.181 Vali Loss: 3.110 Vali Acc: 0.217 Test Loss: 3.110 Test Acc: 0.217
Validation loss decreased (inf --> -0.216636).  Saving model ...
Epoch: 2 cost time: 1.1228818893432617
Epoch: 2, Steps: 18 | Train Loss: 2.948 Vali Loss: 2.826 Vali Acc: 0.527 Test Loss: 2.826 Test Acc: 0.527
Validation loss decreased (-0.216636 --> -0.526638).  Saving model ...
Epoch: 3 cost time: 1.0516846179962158
Epoch: 3, Steps: 18 | Train Loss: 2.539 Vali Loss: 2.345 Vali Acc: 0.837 Test Loss: 2.345 Test Acc: 0.837
Validation loss decreased (-0.526638 --> -0.836643).  Saving model ...
Epoch: 4 cost time: 1.0108139514923096
Epoch: 4, Steps: 18 | Train Loss: 1.922 Vali Loss: 1.652 Vali Acc: 0.933 Test Loss: 1.652 Test Acc: 0.933
Validation loss decreased (-0.836643 --> -0.933317).  Saving model ...
Epoch: 5 cost time: 1.0786521434783936
Epoch: 5, Steps: 18 | Train Loss: 1.177 Vali Loss: 0.923 Vali Acc: 0.950 Test Loss: 0.923 Test Acc: 0.950
Validation loss decreased (-0.933317 --> -0.949991).  Saving model ...
Epoch: 6 cost time: 1.117971420288086
Epoch: 6, Steps: 18 | Train Loss: 0.538 Vali Loss: 0.454 Vali Acc: 0.970 Test Loss: 0.454 Test Acc: 0.970
Validation loss decreased (-0.949991 --> -0.969995).  Saving model ...
Epoch: 7 cost time: 0.9411191940307617
Epoch: 7, Steps: 18 | Train Loss: 0.249 Vali Loss: 0.275 Vali Acc: 0.973 Test Loss: 0.275 Test Acc: 0.973
Validation loss decreased (-0.969995 --> -0.973331).  Saving model ...
Epoch: 8 cost time: 0.818065881729126
Epoch: 8, Steps: 18 | Train Loss: 0.112 Vali Loss: 0.201 Vali Acc: 0.973 Test Loss: 0.201 Test Acc: 0.973
Validation loss decreased (-0.973331 --> -0.973331).  Saving model ...
Epoch: 9 cost time: 0.8688204288482666
Epoch: 9, Steps: 18 | Train Loss: 0.066 Vali Loss: 0.166 Vali Acc: 0.977 Test Loss: 0.166 Test Acc: 0.977
Validation loss decreased (-0.973331 --> -0.976665).  Saving model ...
Epoch: 10 cost time: 0.847550630569458
Epoch: 10, Steps: 18 | Train Loss: 0.049 Vali Loss: 0.150 Vali Acc: 0.977 Test Loss: 0.150 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 11 cost time: 0.7881090641021729
Epoch: 11, Steps: 18 | Train Loss: 0.034 Vali Loss: 0.136 Vali Acc: 0.977 Test Loss: 0.136 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 12 cost time: 0.850989580154419
Epoch: 12, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.126 Vali Acc: 0.980 Test Loss: 0.126 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 0.9642517566680908
Epoch: 13, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.121 Vali Acc: 0.977 Test Loss: 0.121 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9133565425872803
Epoch: 14, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.783236026763916
Epoch: 15, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.109 Vali Acc: 0.980 Test Loss: 0.109 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 0.9061381816864014
Epoch: 16, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.105 Vali Acc: 0.983 Test Loss: 0.105 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 17 cost time: 1.0032360553741455
Epoch: 17, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.103 Vali Acc: 0.983 Test Loss: 0.103 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 18 cost time: 0.9404342174530029
Epoch: 18, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8626453876495361
Epoch: 19, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8142664432525635
Epoch: 20, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.097 Vali Acc: 0.983 Test Loss: 0.097 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 21 cost time: 0.9419848918914795
Epoch: 21, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.095 Vali Acc: 0.983 Test Loss: 0.095 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 22 cost time: 0.851407527923584
Epoch: 22, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8873364925384521
Epoch: 23, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.7759099006652832
Epoch: 24, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.9589862823486328
Epoch: 25, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.092 Vali Acc: 0.983 Test Loss: 0.092 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 26 cost time: 1.2381541728973389
Epoch: 26, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.983 Test Loss: 0.090 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 27 cost time: 0.7732408046722412
Epoch: 27, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.091 Vali Acc: 0.983 Test Loss: 0.091 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.837273359298706
Epoch: 28, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.983 Test Loss: 0.090 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.115112543106079
Epoch: 29, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.983 Test Loss: 0.090 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 30 cost time: 1.02217435836792
Epoch: 30, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 31 cost time: 0.8882241249084473
Epoch: 31, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 32 cost time: 0.9467349052429199
Epoch: 32, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 33 cost time: 0.7547423839569092
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.9506263732910156
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 35 cost time: 0.9086480140686035
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 36 cost time: 1.1118478775024414
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 37 cost time: 1.163947343826294
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 38 cost time: 1.0824050903320312
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.3087000846862793
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.1234681606292725
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 41 cost time: 1.1263117790222168
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.089294195175171
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 43 cost time: 0.7993357181549072
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 44 cost time: 0.7972855567932129
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 45 cost time: 0.7741634845733643
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.7466421127319336
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.6741118431091309
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.6733577251434326
Epoch: 48, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.6965508460998535
Epoch: 49, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 50 cost time: 0.7941854000091553
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps36_str18_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 521785
model size : 2.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.073264122009277
Epoch: 1, Steps: 18 | Train Loss: 2.336 Vali Loss: 0.835 Vali Acc: 0.917 Test Loss: 0.835 Test Acc: 0.917
Validation loss decreased (inf --> -0.916658).  Saving model ...
Epoch: 2 cost time: 2.9793787002563477
Epoch: 2, Steps: 18 | Train Loss: 0.135 Vali Loss: 0.167 Vali Acc: 0.943 Test Loss: 0.167 Test Acc: 0.943
Validation loss decreased (-0.916658 --> -0.943332).  Saving model ...
Epoch: 3 cost time: 2.994258403778076
Epoch: 3, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.244 Vali Acc: 0.937 Test Loss: 0.244 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.776761531829834
Epoch: 4, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.256 Vali Acc: 0.940 Test Loss: 0.256 Test Acc: 0.940
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.5278356075286865
Epoch: 5, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.219 Vali Acc: 0.943 Test Loss: 0.219 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.3734376430511475
Epoch: 6, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.139 Vali Acc: 0.963 Test Loss: 0.139 Test Acc: 0.963
Validation loss decreased (-0.943332 --> -0.963332).  Saving model ...
Epoch: 7 cost time: 2.1388559341430664
Epoch: 7, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.963 Test Loss: 0.176 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.5494561195373535
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.967 Test Loss: 0.182 Test Acc: 0.967
Validation loss decreased (-0.963332 --> -0.966665).  Saving model ...
Epoch: 9 cost time: 2.27275013923645
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.967 Test Loss: 0.180 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 10 cost time: 3.0539488792419434
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.967 Test Loss: 0.176 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 11 cost time: 2.9545443058013916
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.967 Test Loss: 0.174 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 12 cost time: 3.1451213359832764
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.172 Vali Acc: 0.970 Test Loss: 0.172 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969998).  Saving model ...
Epoch: 13 cost time: 2.25994873046875
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.172 Vali Acc: 0.970 Test Loss: 0.172 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 14 cost time: 2.3890652656555176
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.970 Test Loss: 0.170 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 15 cost time: 2.5084569454193115
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.970 Test Loss: 0.169 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 16 cost time: 2.602445363998413
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.970 Test Loss: 0.169 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 17 cost time: 2.597799777984619
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.970 Test Loss: 0.168 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 18 cost time: 2.4755630493164062
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.970 Test Loss: 0.167 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 19 cost time: 2.5069169998168945
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.970 Test Loss: 0.167 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 20 cost time: 2.1370468139648438
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.166 Vali Acc: 0.970 Test Loss: 0.166 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 21 cost time: 2.635997772216797
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.165 Vali Acc: 0.970 Test Loss: 0.165 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 22 cost time: 2.4904353618621826
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.165 Vali Acc: 0.970 Test Loss: 0.165 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 23 cost time: 2.867230176925659
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.165 Vali Acc: 0.970 Test Loss: 0.165 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 24 cost time: 2.3411171436309814
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.164 Vali Acc: 0.970 Test Loss: 0.164 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 25 cost time: 2.894279718399048
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.163 Vali Acc: 0.970 Test Loss: 0.163 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 26 cost time: 2.207777738571167
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.163 Vali Acc: 0.970 Test Loss: 0.163 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 27 cost time: 2.770138740539551
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.163 Vali Acc: 0.970 Test Loss: 0.163 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 28 cost time: 2.8308868408203125
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.160 Vali Acc: 0.970 Test Loss: 0.160 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 29 cost time: 3.0478339195251465
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.160 Vali Acc: 0.970 Test Loss: 0.160 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 30 cost time: 2.761932849884033
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.159 Vali Acc: 0.970 Test Loss: 0.159 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 31 cost time: 2.745664358139038
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.159 Vali Acc: 0.970 Test Loss: 0.159 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.7602391242980957
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.158 Vali Acc: 0.970 Test Loss: 0.158 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 33 cost time: 2.2365171909332275
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.159 Vali Acc: 0.970 Test Loss: 0.159 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.250831365585327
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.158 Vali Acc: 0.970 Test Loss: 0.158 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 35 cost time: 2.5768659114837646
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.158 Vali Acc: 0.970 Test Loss: 0.158 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 36 cost time: 2.304094076156616
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.158 Vali Acc: 0.970 Test Loss: 0.158 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 2.4596476554870605
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.156 Vali Acc: 0.970 Test Loss: 0.156 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 38 cost time: 2.5022220611572266
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.156 Vali Acc: 0.970 Test Loss: 0.156 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 2.3147268295288086
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.156 Vali Acc: 0.970 Test Loss: 0.156 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 40 cost time: 1.7874548435211182
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.156 Vali Acc: 0.970 Test Loss: 0.156 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.6666929721832275
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.156 Vali Acc: 0.970 Test Loss: 0.156 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 2.131190061569214
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.155 Vali Acc: 0.970 Test Loss: 0.155 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 43 cost time: 2.1941494941711426
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.155 Vali Acc: 0.970 Test Loss: 0.155 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 44 cost time: 2.6626226902008057
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.155 Vali Acc: 0.970 Test Loss: 0.155 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 45 cost time: 2.4806082248687744
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.154 Vali Acc: 0.970 Test Loss: 0.154 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 46 cost time: 2.609560012817383
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.154 Vali Acc: 0.970 Test Loss: 0.154 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 47 cost time: 2.1795947551727295
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.154 Vali Acc: 0.970 Test Loss: 0.154 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 3.1086268424987793
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.154 Vali Acc: 0.970 Test Loss: 0.154 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 49 cost time: 2.557992935180664
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.154 Vali Acc: 0.970 Test Loss: 0.154 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 2.784104108810425
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.154 Vali Acc: 0.970 Test Loss: 0.154 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.97
model parameter : 8385177
model size : 32.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.0057032108306885
Epoch: 1, Steps: 18 | Train Loss: 2.758 Vali Loss: 1.795 Vali Acc: 0.930 Test Loss: 1.795 Test Acc: 0.930
Validation loss decreased (inf --> -0.929982).  Saving model ...
Epoch: 2 cost time: 1.8403129577636719
Epoch: 2, Steps: 18 | Train Loss: 0.437 Vali Loss: 0.180 Vali Acc: 0.963 Test Loss: 0.180 Test Acc: 0.963
Validation loss decreased (-0.929982 --> -0.963332).  Saving model ...
Epoch: 3 cost time: 1.702077865600586
Epoch: 3, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.137 Vali Acc: 0.960 Test Loss: 0.137 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9515750408172607
Epoch: 4, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
Validation loss decreased (-0.963332 --> -0.973332).  Saving model ...
Epoch: 5 cost time: 1.8011484146118164
Epoch: 5, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.71327543258667
Epoch: 6, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.5262553691864014
Epoch: 7, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.572340965270996
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 1.782585620880127
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 1.6582603454589844
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
Validation loss decreased (-0.973332 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 1.7318482398986816
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 1.8282365798950195
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 1.66310453414917
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6207809448242188
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.4719254970550537
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.7980191707611084
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.005526542663574
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 1.7106711864471436
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 2.000316858291626
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.6305756568908691
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 1.6963682174682617
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 1.3994121551513672
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.631105661392212
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.6661663055419922
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.677900791168213
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.9300808906555176
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.7407584190368652
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.5884041786193848
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.4803266525268555
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.382615327835083
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.2709381580352783
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 7348889
model size : 28.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.096345901489258
Epoch: 1, Steps: 18 | Train Loss: 2.906 Vali Loss: 2.240 Vali Acc: 0.900 Test Loss: 2.240 Test Acc: 0.900
Validation loss decreased (inf --> -0.899978).  Saving model ...
Epoch: 2 cost time: 1.6600279808044434
Epoch: 2, Steps: 18 | Train Loss: 0.862 Vali Loss: 0.314 Vali Acc: 0.950 Test Loss: 0.314 Test Acc: 0.950
Validation loss decreased (-0.899978 --> -0.949997).  Saving model ...
Epoch: 3 cost time: 1.4031729698181152
Epoch: 3, Steps: 18 | Train Loss: 0.072 Vali Loss: 0.193 Vali Acc: 0.940 Test Loss: 0.193 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4331152439117432
Epoch: 4, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
Validation loss decreased (-0.949997 --> -0.973332).  Saving model ...
Epoch: 5 cost time: 1.5138885974884033
Epoch: 5, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 6 cost time: 1.729414463043213
Epoch: 6, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 7 cost time: 1.796166181564331
Epoch: 7, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 8 cost time: 2.1043410301208496
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 1.7978556156158447
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 1.5248546600341797
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 1.4282269477844238
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 1.5676078796386719
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.8972744941711426
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 1.850008249282837
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.937992811203003
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.8145978450775146
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.48661470413208
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 1.2774097919464111
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 1.3972761631011963
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.6882877349853516
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.7602794170379639
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.045565605163574
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.6300253868103027
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.5289275646209717
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.5743238925933838
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.8049893379211426
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.072751522064209
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.963045597076416
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 2.315310478210449
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.983 Test Loss: 0.101 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 30 cost time: 2.2293598651885986
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.983 Test Loss: 0.101 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 31 cost time: 2.175468921661377
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.983 Test Loss: 0.102 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.9988727569580078
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.983 Test Loss: 0.102 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.0145785808563232
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.983 Test Loss: 0.102 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 2.050445795059204
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.3952112197875977
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.4424488544464111
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.3523521423339844
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.983 Test Loss: 0.103 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.2118971347808838
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.983 Test Loss: 0.103 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.4646389484405518
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.983 Test Loss: 0.103 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.3144564628601074
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.983 Test Loss: 0.103 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 7003673
model size : 26.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.884556770324707
Epoch: 1, Steps: 18 | Train Loss: 2.939 Vali Loss: 2.459 Vali Acc: 0.877 Test Loss: 2.459 Test Acc: 0.877
Validation loss decreased (inf --> -0.876642).  Saving model ...
Epoch: 2 cost time: 1.8165175914764404
Epoch: 2, Steps: 18 | Train Loss: 1.164 Vali Loss: 0.480 Vali Acc: 0.967 Test Loss: 0.480 Test Acc: 0.967
Validation loss decreased (-0.876642 --> -0.966662).  Saving model ...
Epoch: 3 cost time: 1.5065257549285889
Epoch: 3, Steps: 18 | Train Loss: 0.102 Vali Loss: 0.123 Vali Acc: 0.970 Test Loss: 0.123 Test Acc: 0.970
Validation loss decreased (-0.966662 --> -0.969999).  Saving model ...
Epoch: 4 cost time: 1.575605869293213
Epoch: 4, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 5 cost time: 1.380671739578247
Epoch: 5, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6049997806549072
Epoch: 6, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 1.7052371501922607
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 1.7201292514801025
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 1.6350302696228027
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 1.7872262001037598
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 1.4364984035491943
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 1.490792989730835
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 1.8941113948822021
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 1.9802732467651367
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7517883777618408
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.8192713260650635
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.7471139430999756
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.536691665649414
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.720776081085205
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.9050257205963135
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.718508243560791
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.4595484733581543
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.5528221130371094
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 6831385
model size : 26.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps22_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.8219895362854004
Epoch: 1, Steps: 18 | Train Loss: 3.025 Vali Loss: 2.558 Vali Acc: 0.823 Test Loss: 2.558 Test Acc: 0.823
Validation loss decreased (inf --> -0.823308).  Saving model ...
Epoch: 2 cost time: 1.2400238513946533
Epoch: 2, Steps: 18 | Train Loss: 1.430 Vali Loss: 0.665 Vali Acc: 0.970 Test Loss: 0.665 Test Acc: 0.970
Validation loss decreased (-0.823308 --> -0.969993).  Saving model ...
Epoch: 3 cost time: 1.802588939666748
Epoch: 3, Steps: 18 | Train Loss: 0.182 Vali Loss: 0.129 Vali Acc: 0.977 Test Loss: 0.129 Test Acc: 0.977
Validation loss decreased (-0.969993 --> -0.976665).  Saving model ...
Epoch: 4 cost time: 1.701747179031372
Epoch: 4, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3198695182800293
Epoch: 5, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.101 Vali Acc: 0.967 Test Loss: 0.101 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.4654242992401123
Epoch: 6, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.376387596130371
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 8 cost time: 1.98702073097229
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 1.6350698471069336
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 1.7290608882904053
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 1.6035311222076416
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 1.5644986629486084
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 1.954435110092163
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6006920337677002
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.3500208854675293
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 1.2527811527252197
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 1.3915066719055176
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 1.4680018424987793
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 1.436049222946167
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 1.9142851829528809
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983333).  Saving model ...
Epoch: 21 cost time: 1.3981211185455322
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.8594884872436523
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.4634759426116943
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 24 cost time: 1.6511118412017822
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 25 cost time: 1.7434873580932617
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.7394962310791016
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.8455471992492676
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.461503267288208
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.380265712738037
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.3234937191009521
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.2407944202423096
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.6733639240264893
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.46974515914917
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.7321484088897705
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps22_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 6717081
model size : 25.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps29_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.89321231842041
Epoch: 1, Steps: 18 | Train Loss: 3.069 Vali Loss: 2.690 Vali Acc: 0.760 Test Loss: 2.690 Test Acc: 0.760
Validation loss decreased (inf --> -0.759973).  Saving model ...
Epoch: 2 cost time: 1.7375259399414062
Epoch: 2, Steps: 18 | Train Loss: 1.767 Vali Loss: 1.088 Vali Acc: 0.930 Test Loss: 1.088 Test Acc: 0.930
Validation loss decreased (-0.759973 --> -0.929989).  Saving model ...
Epoch: 3 cost time: 2.0261881351470947
Epoch: 3, Steps: 18 | Train Loss: 0.383 Vali Loss: 0.206 Vali Acc: 0.967 Test Loss: 0.206 Test Acc: 0.967
Validation loss decreased (-0.929989 --> -0.966665).  Saving model ...
Epoch: 4 cost time: 1.496889591217041
Epoch: 4, Steps: 18 | Train Loss: 0.048 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
Validation loss decreased (-0.966665 --> -0.976666).  Saving model ...
Epoch: 5 cost time: 1.5975892543792725
Epoch: 5, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4536404609680176
Epoch: 6, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.2334904670715332
Epoch: 7, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.4764177799224854
Epoch: 8, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.6130290031433105
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 1.7572484016418457
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 1.7333776950836182
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 1.7984254360198975
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 1.6582973003387451
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 1.7785124778747559
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 1.266261100769043
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 1.3367059230804443
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 1.3514223098754883
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.7112188339233398
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.6013290882110596
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.7430450916290283
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.0382049083709717
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.8864033222198486
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.7076694965362549
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.6542446613311768
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.7318246364593506
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.598069667816162
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps29_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 6602777
model size : 25.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps36_str18_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.7042150497436523
Epoch: 1, Steps: 18 | Train Loss: 3.131 Vali Loss: 2.821 Vali Acc: 0.537 Test Loss: 2.821 Test Acc: 0.537
Validation loss decreased (inf --> -0.536638).  Saving model ...
Epoch: 2 cost time: 1.645122766494751
Epoch: 2, Steps: 18 | Train Loss: 2.053 Vali Loss: 1.449 Vali Acc: 0.917 Test Loss: 1.449 Test Acc: 0.917
Validation loss decreased (-0.536638 --> -0.916652).  Saving model ...
Epoch: 3 cost time: 1.6769182682037354
Epoch: 3, Steps: 18 | Train Loss: 0.634 Vali Loss: 0.321 Vali Acc: 0.957 Test Loss: 0.321 Test Acc: 0.957
Validation loss decreased (-0.916652 --> -0.956663).  Saving model ...
Epoch: 4 cost time: 1.7855994701385498
Epoch: 4, Steps: 18 | Train Loss: 0.099 Vali Loss: 0.139 Vali Acc: 0.967 Test Loss: 0.139 Test Acc: 0.967
Validation loss decreased (-0.956663 --> -0.966665).  Saving model ...
Epoch: 5 cost time: 1.7392375469207764
Epoch: 5, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.110 Vali Acc: 0.970 Test Loss: 0.110 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969999).  Saving model ...
Epoch: 6 cost time: 1.6089065074920654
Epoch: 6, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 1.212923526763916
Epoch: 7, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 8 cost time: 1.2351067066192627
Epoch: 8, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 1.350966453552246
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 1.361196756362915
Epoch: 10, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 1.459284782409668
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5646307468414307
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 1.5608160495758057
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 1.5291557312011719
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2922468185424805
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 1.2029478549957275
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.374337911605835
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.372746229171753
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 1.4411113262176514
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 1.504462718963623
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 1.617009162902832
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.5177185535430908
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.401566743850708
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.4141583442687988
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.4359872341156006
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.6458020210266113
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.5897417068481445
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.7758550643920898
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.7934396266937256
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.3502604961395264
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 31 cost time: 1.1053709983825684
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.2786822319030762
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 33 cost time: 1.3054230213165283
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.3573329448699951
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.5544404983520508
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.4941387176513672
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 37 cost time: 1.5766189098358154
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.6636457443237305
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.3922135829925537
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.6428077220916748
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 41 cost time: 1.496232032775879
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.7801485061645508
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.555582046508789
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.5744342803955078
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.6878299713134766
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.396606683731079
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.6281166076660156
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.4920196533203125
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.315192461013794
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 1.4830658435821533
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps36_str18_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 6546073
model size : 25.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.8975770473480225
Epoch: 1, Steps: 18 | Train Loss: 2.784 Vali Loss: 1.842 Vali Acc: 0.937 Test Loss: 1.842 Test Acc: 0.937
Validation loss decreased (inf --> -0.936648).  Saving model ...
Epoch: 2 cost time: 1.2390916347503662
Epoch: 2, Steps: 18 | Train Loss: 0.564 Vali Loss: 0.224 Vali Acc: 0.960 Test Loss: 0.224 Test Acc: 0.960
Validation loss decreased (-0.936648 --> -0.959998).  Saving model ...
Epoch: 3 cost time: 1.0856637954711914
Epoch: 3, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.125 Vali Acc: 0.967 Test Loss: 0.125 Test Acc: 0.967
Validation loss decreased (-0.959998 --> -0.966665).  Saving model ...
Epoch: 4 cost time: 1.1052465438842773
Epoch: 4, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
Validation loss decreased (-0.966665 --> -0.973332).  Saving model ...
Epoch: 5 cost time: 1.3996596336364746
Epoch: 5, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.355334758758545
Epoch: 6, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 1.5073356628417969
Epoch: 7, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 8 cost time: 1.4188718795776367
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 1.4190187454223633
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 1.4917168617248535
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 1.2405180931091309
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3704571723937988
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2627437114715576
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.3086094856262207
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.2942273616790771
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.23042893409729
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.138136863708496
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.2109010219573975
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.3714003562927246
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.3035728931427002
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 2701657
model size : 10.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.517670154571533
Epoch: 1, Steps: 18 | Train Loss: 2.958 Vali Loss: 2.465 Vali Acc: 0.830 Test Loss: 2.465 Test Acc: 0.830
Validation loss decreased (inf --> -0.829975).  Saving model ...
Epoch: 2 cost time: 1.2664518356323242
Epoch: 2, Steps: 18 | Train Loss: 1.290 Vali Loss: 0.623 Vali Acc: 0.953 Test Loss: 0.623 Test Acc: 0.953
Validation loss decreased (-0.829975 --> -0.953327).  Saving model ...
Epoch: 3 cost time: 1.172267198562622
Epoch: 3, Steps: 18 | Train Loss: 0.158 Vali Loss: 0.134 Vali Acc: 0.973 Test Loss: 0.134 Test Acc: 0.973
Validation loss decreased (-0.953327 --> -0.973332).  Saving model ...
Epoch: 4 cost time: 0.986335277557373
Epoch: 4, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 5 cost time: 1.0071444511413574
Epoch: 5, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 6 cost time: 1.0619282722473145
Epoch: 6, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 1.3035154342651367
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1788897514343262
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 1.3322348594665527
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 1.2291977405548096
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 1.2602410316467285
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.383033275604248
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2762415409088135
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.0309743881225586
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.9591660499572754
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.2003345489501953
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.0660583972930908
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.1664838790893555
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.1592962741851807
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.2858030796051025
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 2183513
model size : 8.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.5097203254699707
Epoch: 1, Steps: 18 | Train Loss: 3.086 Vali Loss: 2.709 Vali Acc: 0.723 Test Loss: 2.709 Test Acc: 0.723
Validation loss decreased (inf --> -0.723306).  Saving model ...
Epoch: 2 cost time: 1.2793917655944824
Epoch: 2, Steps: 18 | Train Loss: 1.766 Vali Loss: 1.115 Vali Acc: 0.953 Test Loss: 1.115 Test Acc: 0.953
Validation loss decreased (-0.723306 --> -0.953322).  Saving model ...
Epoch: 3 cost time: 1.2772600650787354
Epoch: 3, Steps: 18 | Train Loss: 0.390 Vali Loss: 0.223 Vali Acc: 0.963 Test Loss: 0.223 Test Acc: 0.963
Validation loss decreased (-0.953322 --> -0.963331).  Saving model ...
Epoch: 4 cost time: 1.1806700229644775
Epoch: 4, Steps: 18 | Train Loss: 0.052 Vali Loss: 0.124 Vali Acc: 0.963 Test Loss: 0.124 Test Acc: 0.963
Validation loss decreased (-0.963331 --> -0.963332).  Saving model ...
Epoch: 5 cost time: 1.3223438262939453
Epoch: 5, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
Validation loss decreased (-0.963332 --> -0.969999).  Saving model ...
Epoch: 6 cost time: 1.026792049407959
Epoch: 6, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.969999 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 1.054006814956665
Epoch: 7, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 1.1193532943725586
Epoch: 8, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 9 cost time: 1.12322998046875
Epoch: 9, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 10 cost time: 1.069737434387207
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2779722213745117
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0230121612548828
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 13 cost time: 1.2642359733581543
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 14 cost time: 1.0530569553375244
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 15 cost time: 0.9764533042907715
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 16 cost time: 1.055229663848877
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 17 cost time: 1.0727870464324951
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3162503242492676
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.1714508533477783
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.1618435382843018
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.2409799098968506
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 22 cost time: 1.1941845417022705
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2081069946289062
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.0633397102355957
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.0996100902557373
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.1345000267028809
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 27 cost time: 1.3379731178283691
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.3319978713989258
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.1248767375946045
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.1090478897094727
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 31 cost time: 1.0107781887054443
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983333).  Saving model ...
Epoch: 32 cost time: 1.1608223915100098
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 33 cost time: 0.9757719039916992
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.1233253479003906
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.3071556091308594
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.2828483581542969
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.257176399230957
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.3108034133911133
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.1590657234191895
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.1640534400939941
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.129439353942871
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.9911956787109375
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 2010905
model size : 7.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.1181232929229736
Epoch: 1, Steps: 18 | Train Loss: 3.093 Vali Loss: 2.838 Vali Acc: 0.627 Test Loss: 2.838 Test Acc: 0.627
Validation loss decreased (inf --> -0.626638).  Saving model ...
Epoch: 2 cost time: 0.9344301223754883
Epoch: 2, Steps: 18 | Train Loss: 2.099 Vali Loss: 1.560 Vali Acc: 0.937 Test Loss: 1.560 Test Acc: 0.937
Validation loss decreased (-0.626638 --> -0.936651).  Saving model ...
Epoch: 3 cost time: 0.9118356704711914
Epoch: 3, Steps: 18 | Train Loss: 0.721 Vali Loss: 0.372 Vali Acc: 0.963 Test Loss: 0.372 Test Acc: 0.963
Validation loss decreased (-0.936651 --> -0.963330).  Saving model ...
Epoch: 4 cost time: 1.197385549545288
Epoch: 4, Steps: 18 | Train Loss: 0.118 Vali Loss: 0.164 Vali Acc: 0.967 Test Loss: 0.164 Test Acc: 0.967
Validation loss decreased (-0.963330 --> -0.966665).  Saving model ...
Epoch: 5 cost time: 1.1390204429626465
Epoch: 5, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.120 Vali Acc: 0.970 Test Loss: 0.120 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969999).  Saving model ...
Epoch: 6 cost time: 1.3035507202148438
Epoch: 6, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 1.385768175125122
Epoch: 7, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 1.2086141109466553
Epoch: 8, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 1.3809633255004883
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2176058292388916
Epoch: 10, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.2717456817626953
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 1.2062478065490723
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 1.1478476524353027
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2133655548095703
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 1.2941319942474365
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 1.2993888854980469
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 1.287757158279419
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 1.1929144859313965
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 1.2638459205627441
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 1.3592493534088135
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 1.2405095100402832
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 1.1824893951416016
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 1.1163299083709717
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 1.1273999214172363
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.6446616649627686
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.3512356281280518
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.2150835990905762
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.2707064151763916
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.263002872467041
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 1.3832132816314697
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.8472518920898438
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.3836793899536133
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.1831965446472168
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 34 cost time: 1.218120813369751
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 35 cost time: 1.2808506488800049
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.6112866401672363
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.5214259624481201
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.1754560470581055
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.0694327354431152
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.995405912399292
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.0582420825958252
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.233837366104126
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 1.0955755710601807
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 1.070434331893921
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 1924761
model size : 7.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps22_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.734443187713623
Epoch: 1, Steps: 18 | Train Loss: 3.096 Vali Loss: 2.897 Vali Acc: 0.547 Test Loss: 2.897 Test Acc: 0.547
Validation loss decreased (inf --> -0.546638).  Saving model ...
Epoch: 2 cost time: 1.426633596420288
Epoch: 2, Steps: 18 | Train Loss: 2.274 Vali Loss: 1.795 Vali Acc: 0.917 Test Loss: 1.795 Test Acc: 0.917
Validation loss decreased (-0.546638 --> -0.916649).  Saving model ...
Epoch: 3 cost time: 1.2490818500518799
Epoch: 3, Steps: 18 | Train Loss: 0.961 Vali Loss: 0.519 Vali Acc: 0.973 Test Loss: 0.519 Test Acc: 0.973
Validation loss decreased (-0.916649 --> -0.973328).  Saving model ...
Epoch: 4 cost time: 1.2483248710632324
Epoch: 4, Steps: 18 | Train Loss: 0.188 Vali Loss: 0.166 Vali Acc: 0.967 Test Loss: 0.166 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.032848596572876
Epoch: 5, Steps: 18 | Train Loss: 0.039 Vali Loss: 0.132 Vali Acc: 0.967 Test Loss: 0.132 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.129380702972412
Epoch: 6, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
Validation loss decreased (-0.973328 --> -0.976666).  Saving model ...
Epoch: 7 cost time: 0.997779130935669
Epoch: 7, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 8 cost time: 1.184910774230957
Epoch: 8, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 1.2651000022888184
Epoch: 9, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 0.9549505710601807
Epoch: 10, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 1.0171663761138916
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 1.2110445499420166
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.983 Test Loss: 0.090 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 13 cost time: 1.1503925323486328
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 14 cost time: 1.3144631385803223
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 15 cost time: 1.295987606048584
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 16 cost time: 1.111271619796753
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 17 cost time: 1.175947666168213
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 18 cost time: 1.0695743560791016
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.164276123046875
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 20 cost time: 1.3077361583709717
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2380924224853516
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.1247894763946533
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.225165605545044
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 24 cost time: 1.0353240966796875
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.1072638034820557
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 26 cost time: 1.0290124416351318
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1901850700378418
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.1277101039886475
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.2723309993743896
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.2991936206817627
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 31 cost time: 1.2235958576202393
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 32 cost time: 1.1038999557495117
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.1921753883361816
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.3141028881072998
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.2058825492858887
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.2040472030639648
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.182373285293579
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.1274454593658447
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.0992770195007324
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.2716283798217773
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.181152582168579
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps22_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 1867609
model size : 7.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps29_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.4807820320129395
Epoch: 1, Steps: 18 | Train Loss: 3.101 Vali Loss: 2.926 Vali Acc: 0.440 Test Loss: 2.926 Test Acc: 0.440
Validation loss decreased (inf --> -0.439971).  Saving model ...
Epoch: 2 cost time: 1.071660041809082
Epoch: 2, Steps: 18 | Train Loss: 2.427 Vali Loss: 2.069 Vali Acc: 0.873 Test Loss: 2.069 Test Acc: 0.873
Validation loss decreased (-0.439971 --> -0.873313).  Saving model ...
Epoch: 3 cost time: 1.1471803188323975
Epoch: 3, Steps: 18 | Train Loss: 1.325 Vali Loss: 0.920 Vali Acc: 0.963 Test Loss: 0.920 Test Acc: 0.963
Validation loss decreased (-0.873313 --> -0.963324).  Saving model ...
Epoch: 4 cost time: 1.4724197387695312
Epoch: 4, Steps: 18 | Train Loss: 0.421 Vali Loss: 0.297 Vali Acc: 0.960 Test Loss: 0.297 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5139119625091553
Epoch: 5, Steps: 18 | Train Loss: 0.092 Vali Loss: 0.158 Vali Acc: 0.963 Test Loss: 0.158 Test Acc: 0.963
Validation loss decreased (-0.963324 --> -0.963332).  Saving model ...
Epoch: 6 cost time: 1.4200737476348877
Epoch: 6, Steps: 18 | Train Loss: 0.034 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
Validation loss decreased (-0.963332 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 1.4706909656524658
Epoch: 7, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.117 Vali Acc: 0.970 Test Loss: 0.117 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3828990459442139
Epoch: 8, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 1.4397084712982178
Epoch: 9, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 1.4285719394683838
Epoch: 10, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 1.3206238746643066
Epoch: 11, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.246795415878296
Epoch: 12, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.0919857025146484
Epoch: 13, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.9669544696807861
Epoch: 14, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.0482077598571777
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.077768325805664
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.0352678298950195
Epoch: 17, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.145883321762085
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.0680058002471924
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.1914517879486084
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps29_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 1810457
model size : 6.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps36_str18_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.4007222652435303
Epoch: 1, Steps: 18 | Train Loss: 3.148 Vali Loss: 2.992 Vali Acc: 0.340 Test Loss: 2.992 Test Acc: 0.340
Validation loss decreased (inf --> -0.339970).  Saving model ...
Epoch: 2 cost time: 1.035801887512207
Epoch: 2, Steps: 18 | Train Loss: 2.650 Vali Loss: 2.324 Vali Acc: 0.837 Test Loss: 2.324 Test Acc: 0.837
Validation loss decreased (-0.339970 --> -0.836643).  Saving model ...
Epoch: 3 cost time: 1.076282262802124
Epoch: 3, Steps: 18 | Train Loss: 1.754 Vali Loss: 1.291 Vali Acc: 0.950 Test Loss: 1.291 Test Acc: 0.950
Validation loss decreased (-0.836643 --> -0.949987).  Saving model ...
Epoch: 4 cost time: 1.140026569366455
Epoch: 4, Steps: 18 | Train Loss: 0.729 Vali Loss: 0.454 Vali Acc: 0.967 Test Loss: 0.454 Test Acc: 0.967
Validation loss decreased (-0.949987 --> -0.966662).  Saving model ...
Epoch: 5 cost time: 1.1324365139007568
Epoch: 5, Steps: 18 | Train Loss: 0.206 Vali Loss: 0.199 Vali Acc: 0.967 Test Loss: 0.199 Test Acc: 0.967
Validation loss decreased (-0.966662 --> -0.966665).  Saving model ...
Epoch: 6 cost time: 1.200202465057373
Epoch: 6, Steps: 18 | Train Loss: 0.066 Vali Loss: 0.148 Vali Acc: 0.960 Test Loss: 0.148 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.30283784866333
Epoch: 7, Steps: 18 | Train Loss: 0.031 Vali Loss: 0.122 Vali Acc: 0.977 Test Loss: 0.122 Test Acc: 0.977
Validation loss decreased (-0.966665 --> -0.976665).  Saving model ...
Epoch: 8 cost time: 1.002781867980957
Epoch: 8, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 0.9619636535644531
Epoch: 9, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 1.0563063621520996
Epoch: 10, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2813053131103516
Epoch: 11, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1221811771392822
Epoch: 12, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 1.2319228649139404
Epoch: 13, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 1.385422945022583
Epoch: 14, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1609530448913574
Epoch: 15, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 1.1837506294250488
Epoch: 16, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 1.154810905456543
Epoch: 17, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 0.9850857257843018
Epoch: 18, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 0.9577679634094238
Epoch: 19, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 0.9351391792297363
Epoch: 20, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 1.1499791145324707
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 1.156275749206543
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2365467548370361
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 1.2378807067871094
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.1107470989227295
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 1.269681692123413
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 1.196002721786499
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.1486248970031738
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.08443284034729
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 30 cost time: 1.038114070892334
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.2167179584503174
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.0568547248840332
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 33 cost time: 0.9937496185302734
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 34 cost time: 1.1045541763305664
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.104766845703125
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.239166259765625
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.1257855892181396
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.083359956741333
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.938859224319458
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.9758505821228027
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.2986164093017578
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.118901252746582
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 43 cost time: 1.161010980606079
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 44 cost time: 1.076641321182251
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.1365134716033936
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.9930341243743896
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.0477581024169922
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 48 cost time: 0.9219551086425781
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.8429722785949707
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.9000382423400879
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps36_str18_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 1782105
model size : 6.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.2916691303253174
Epoch: 1, Steps: 18 | Train Loss: 2.989 Vali Loss: 2.398 Vali Acc: 0.870 Test Loss: 2.398 Test Acc: 0.870
Validation loss decreased (inf --> -0.869976).  Saving model ...
Epoch: 2 cost time: 1.1416542530059814
Epoch: 2, Steps: 18 | Train Loss: 1.291 Vali Loss: 0.653 Vali Acc: 0.963 Test Loss: 0.653 Test Acc: 0.963
Validation loss decreased (-0.869976 --> -0.963327).  Saving model ...
Epoch: 3 cost time: 0.8977105617523193
Epoch: 3, Steps: 18 | Train Loss: 0.199 Vali Loss: 0.160 Vali Acc: 0.973 Test Loss: 0.160 Test Acc: 0.973
Validation loss decreased (-0.963327 --> -0.973332).  Saving model ...
Epoch: 4 cost time: 0.9235258102416992
Epoch: 4, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.134 Vali Acc: 0.963 Test Loss: 0.134 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.888700008392334
Epoch: 5, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.117 Vali Acc: 0.970 Test Loss: 0.117 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.088505744934082
Epoch: 6, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 1.1283674240112305
Epoch: 7, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 1.1127052307128906
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 0.9861042499542236
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 0.886289119720459
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 1.033545732498169
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 12 cost time: 1.0891036987304688
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 13 cost time: 1.0110955238342285
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 14 cost time: 0.9868040084838867
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 15 cost time: 0.857046365737915
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1216402053833008
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 17 cost time: 1.0836727619171143
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 18 cost time: 1.0820066928863525
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 1.0441880226135254
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0517425537109375
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.0300474166870117
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 0.9966170787811279
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9156935214996338
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.8762354850769043
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.98451828956604
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.1292641162872314
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 1.0760524272918701
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.1194028854370117
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 1.198636531829834
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 1.1892874240875244
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 31 cost time: 1.1313154697418213
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.1349196434020996
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.96695876121521
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.9579036235809326
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.1235628128051758
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.1752772331237793
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.0182456970214844
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.0534007549285889
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.0108027458190918
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.1786282062530518
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 978105
model size : 3.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.3872718811035156
Epoch: 1, Steps: 18 | Train Loss: 3.104 Vali Loss: 2.793 Vali Acc: 0.583 Test Loss: 2.793 Test Acc: 0.583
Validation loss decreased (inf --> -0.583305).  Saving model ...
Epoch: 2 cost time: 0.9747025966644287
Epoch: 2, Steps: 18 | Train Loss: 2.097 Vali Loss: 1.565 Vali Acc: 0.957 Test Loss: 1.565 Test Acc: 0.957
Validation loss decreased (-0.583305 --> -0.956651).  Saving model ...
Epoch: 3 cost time: 1.128446340560913
Epoch: 3, Steps: 18 | Train Loss: 0.785 Vali Loss: 0.446 Vali Acc: 0.957 Test Loss: 0.446 Test Acc: 0.957
Validation loss decreased (-0.956651 --> -0.956662).  Saving model ...
Epoch: 4 cost time: 0.9343760013580322
Epoch: 4, Steps: 18 | Train Loss: 0.142 Vali Loss: 0.181 Vali Acc: 0.963 Test Loss: 0.181 Test Acc: 0.963
Validation loss decreased (-0.956662 --> -0.963332).  Saving model ...
Epoch: 5 cost time: 0.9955055713653564
Epoch: 5, Steps: 18 | Train Loss: 0.036 Vali Loss: 0.123 Vali Acc: 0.970 Test Loss: 0.123 Test Acc: 0.970
Validation loss decreased (-0.963332 --> -0.969999).  Saving model ...
Epoch: 6 cost time: 1.0591747760772705
Epoch: 6, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.118 Vali Acc: 0.973 Test Loss: 0.118 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 0.8571834564208984
Epoch: 7, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 0.8668606281280518
Epoch: 8, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 0.8577854633331299
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 0.8844635486602783
Epoch: 10, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 0.7356429100036621
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 12 cost time: 0.8415348529815674
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 13 cost time: 0.9003739356994629
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 14 cost time: 0.7991809844970703
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 15 cost time: 0.759690523147583
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 16 cost time: 0.7635407447814941
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9816586971282959
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 18 cost time: 1.101761817932129
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 19 cost time: 0.8736963272094727
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 20 cost time: 0.8898041248321533
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 21 cost time: 0.976158857345581
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 22 cost time: 0.9516723155975342
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 23 cost time: 0.9007782936096191
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 24 cost time: 0.9568514823913574
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 25 cost time: 0.8606979846954346
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 26 cost time: 0.7886390686035156
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9011075496673584
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 28 cost time: 0.9272201061248779
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 29 cost time: 0.9665846824645996
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9899907112121582
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.0083832740783691
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.9064924716949463
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.9551651477813721
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.9820928573608398
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 35 cost time: 0.861058235168457
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 36 cost time: 0.8934910297393799
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 37 cost time: 0.8376975059509277
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.9381811618804932
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.922405481338501
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.9676179885864258
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.9455680847167969
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.8816323280334473
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.9055805206298828
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.9381611347198486
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.8511250019073486
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 0.8220705986022949
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9733333333333334
model parameter : 719033
model size : 2.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.211024284362793
Epoch: 1, Steps: 18 | Train Loss: 3.128 Vali Loss: 2.980 Vali Acc: 0.360 Test Loss: 2.980 Test Acc: 0.360
Validation loss decreased (inf --> -0.359970).  Saving model ...
Epoch: 2 cost time: 0.964928388595581
Epoch: 2, Steps: 18 | Train Loss: 2.519 Vali Loss: 2.192 Vali Acc: 0.880 Test Loss: 2.192 Test Acc: 0.880
Validation loss decreased (-0.359970 --> -0.879978).  Saving model ...
Epoch: 3 cost time: 0.8341290950775146
Epoch: 3, Steps: 18 | Train Loss: 1.476 Vali Loss: 1.040 Vali Acc: 0.950 Test Loss: 1.040 Test Acc: 0.950
Validation loss decreased (-0.879978 --> -0.949990).  Saving model ...
Epoch: 4 cost time: 0.8990199565887451
Epoch: 4, Steps: 18 | Train Loss: 0.467 Vali Loss: 0.341 Vali Acc: 0.960 Test Loss: 0.341 Test Acc: 0.960
Validation loss decreased (-0.949990 --> -0.959997).  Saving model ...
Epoch: 5 cost time: 0.9458277225494385
Epoch: 5, Steps: 18 | Train Loss: 0.101 Vali Loss: 0.172 Vali Acc: 0.970 Test Loss: 0.172 Test Acc: 0.970
Validation loss decreased (-0.959997 --> -0.969998).  Saving model ...
Epoch: 6 cost time: 0.8031280040740967
Epoch: 6, Steps: 18 | Train Loss: 0.048 Vali Loss: 0.142 Vali Acc: 0.973 Test Loss: 0.142 Test Acc: 0.973
Validation loss decreased (-0.969998 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 0.8291966915130615
Epoch: 7, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.122 Vali Acc: 0.977 Test Loss: 0.122 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 8 cost time: 0.9329104423522949
Epoch: 8, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0906529426574707
Epoch: 9, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1796071529388428
Epoch: 10, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 1.092719554901123
Epoch: 11, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 0.9328453540802002
Epoch: 12, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 0.8137612342834473
Epoch: 13, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 1.1266818046569824
Epoch: 14, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 0.9789323806762695
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.983 Test Loss: 0.095 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 16 cost time: 1.1841039657592773
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.983 Test Loss: 0.094 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 17 cost time: 0.9234871864318848
Epoch: 17, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.983 Test Loss: 0.093 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 18 cost time: 1.0530266761779785
Epoch: 18, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3133950233459473
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.02604079246521
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.983 Test Loss: 0.091 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 21 cost time: 1.0043680667877197
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.983 Test Loss: 0.091 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 22 cost time: 0.8936755657196045
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0658297538757324
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.7700960636138916
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.8794040679931641
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.9125545024871826
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.9931399822235107
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.983 Test Loss: 0.091 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 28 cost time: 0.9224450588226318
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.983 Test Loss: 0.090 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 29 cost time: 0.8346254825592041
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.7993113994598389
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.8310778141021729
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.8845410346984863
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.983 Test Loss: 0.090 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.9802811145782471
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.983 Test Loss: 0.090 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.0239102840423584
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.983 Test Loss: 0.090 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.8751766681671143
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 36 cost time: 0.9426758289337158
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.983 Test Loss: 0.090 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.8242826461791992
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.983 Test Loss: 0.090 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.9441657066345215
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.983 Test Loss: 0.090 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.8954570293426514
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.983 Test Loss: 0.090 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.051713228225708
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.983 Test Loss: 0.090 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.2519080638885498
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.983 Test Loss: 0.090 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.0025243759155273
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.983 Test Loss: 0.090 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.0432028770446777
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.983 Test Loss: 0.090 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.0075397491455078
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.983 Test Loss: 0.090 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.9480881690979004
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 632729
model size : 2.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.0773940086364746
Epoch: 1, Steps: 18 | Train Loss: 3.170 Vali Loss: 3.061 Vali Acc: 0.273 Test Loss: 3.061 Test Acc: 0.273
Validation loss decreased (inf --> -0.273303).  Saving model ...
Epoch: 2 cost time: 0.8840806484222412
Epoch: 2, Steps: 18 | Train Loss: 2.704 Vali Loss: 2.477 Vali Acc: 0.743 Test Loss: 2.477 Test Acc: 0.743
Validation loss decreased (-0.273303 --> -0.743309).  Saving model ...
Epoch: 3 cost time: 1.072974681854248
Epoch: 3, Steps: 18 | Train Loss: 1.871 Vali Loss: 1.522 Vali Acc: 0.913 Test Loss: 1.522 Test Acc: 0.913
Validation loss decreased (-0.743309 --> -0.913318).  Saving model ...
Epoch: 4 cost time: 0.9928808212280273
Epoch: 4, Steps: 18 | Train Loss: 0.897 Vali Loss: 0.614 Vali Acc: 0.950 Test Loss: 0.614 Test Acc: 0.950
Validation loss decreased (-0.913318 --> -0.949994).  Saving model ...
Epoch: 5 cost time: 0.9512448310852051
Epoch: 5, Steps: 18 | Train Loss: 0.265 Vali Loss: 0.260 Vali Acc: 0.967 Test Loss: 0.260 Test Acc: 0.967
Validation loss decreased (-0.949994 --> -0.966664).  Saving model ...
Epoch: 6 cost time: 0.7961664199829102
Epoch: 6, Steps: 18 | Train Loss: 0.085 Vali Loss: 0.167 Vali Acc: 0.970 Test Loss: 0.167 Test Acc: 0.970
Validation loss decreased (-0.966664 --> -0.969998).  Saving model ...
Epoch: 7 cost time: 1.0119943618774414
Epoch: 7, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.142 Vali Acc: 0.973 Test Loss: 0.142 Test Acc: 0.973
Validation loss decreased (-0.969998 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 1.0116610527038574
Epoch: 8, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.129 Vali Acc: 0.980 Test Loss: 0.129 Test Acc: 0.980
Validation loss decreased (-0.973332 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 0.8918333053588867
Epoch: 9, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.122 Vali Acc: 0.980 Test Loss: 0.122 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 0.9067108631134033
Epoch: 10, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 1.1345391273498535
Epoch: 11, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.115 Vali Acc: 0.980 Test Loss: 0.115 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0688107013702393
Epoch: 12, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 0.8517277240753174
Epoch: 13, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 0.8964874744415283
Epoch: 14, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 0.9818174839019775
Epoch: 15, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 0.8685920238494873
Epoch: 16, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8186161518096924
Epoch: 17, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 0.8876030445098877
Epoch: 18, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 0.8616328239440918
Epoch: 19, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 0.8677926063537598
Epoch: 20, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 0.7469124794006348
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 0.8110382556915283
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 0.836738109588623
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8223376274108887
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.9913525581359863
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 0.9159584045410156
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 0.8606696128845215
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 0.8756730556488037
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 0.9547884464263916
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 0.9100568294525146
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 31 cost time: 1.1113393306732178
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 32 cost time: 0.8976199626922607
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 33 cost time: 1.0015997886657715
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 34 cost time: 1.0654377937316895
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.9786460399627686
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.2466671466827393
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.0065338611602783
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.8402619361877441
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 39 cost time: 0.928678035736084
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 40 cost time: 1.0820412635803223
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 41 cost time: 0.9914202690124512
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.0813260078430176
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.9455211162567139
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.824566125869751
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.8514597415924072
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.8844611644744873
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.8390400409698486
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 0.8103775978088379
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 0.8063709735870361
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 0.8538627624511719
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 589657
model size : 2.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps22_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.1985039710998535
Epoch: 1, Steps: 18 | Train Loss: 3.192 Vali Loss: 3.077 Vali Acc: 0.137 Test Loss: 3.077 Test Acc: 0.137
Validation loss decreased (inf --> -0.136636).  Saving model ...
Epoch: 2 cost time: 0.9517147541046143
Epoch: 2, Steps: 18 | Train Loss: 2.767 Vali Loss: 2.544 Vali Acc: 0.810 Test Loss: 2.544 Test Acc: 0.810
Validation loss decreased (-0.136636 --> -0.809975).  Saving model ...
Epoch: 3 cost time: 0.8841953277587891
Epoch: 3, Steps: 18 | Train Loss: 2.021 Vali Loss: 1.666 Vali Acc: 0.933 Test Loss: 1.666 Test Acc: 0.933
Validation loss decreased (-0.809975 --> -0.933317).  Saving model ...
Epoch: 4 cost time: 0.8025672435760498
Epoch: 4, Steps: 18 | Train Loss: 1.087 Vali Loss: 0.749 Vali Acc: 0.967 Test Loss: 0.749 Test Acc: 0.967
Validation loss decreased (-0.933317 --> -0.966659).  Saving model ...
Epoch: 5 cost time: 0.866269588470459
Epoch: 5, Steps: 18 | Train Loss: 0.371 Vali Loss: 0.302 Vali Acc: 0.967 Test Loss: 0.302 Test Acc: 0.967
Validation loss decreased (-0.966659 --> -0.966664).  Saving model ...
Epoch: 6 cost time: 1.0692784786224365
Epoch: 6, Steps: 18 | Train Loss: 0.118 Vali Loss: 0.175 Vali Acc: 0.967 Test Loss: 0.175 Test Acc: 0.967
Validation loss decreased (-0.966664 --> -0.966665).  Saving model ...
Epoch: 7 cost time: 0.8654356002807617
Epoch: 7, Steps: 18 | Train Loss: 0.050 Vali Loss: 0.146 Vali Acc: 0.970 Test Loss: 0.146 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969999).  Saving model ...
Epoch: 8 cost time: 0.9334855079650879
Epoch: 8, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.132 Vali Acc: 0.970 Test Loss: 0.132 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 9 cost time: 0.9416933059692383
Epoch: 9, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.120 Vali Acc: 0.973 Test Loss: 0.120 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 0.9615726470947266
Epoch: 10, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 0.8949122428894043
Epoch: 11, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0278379917144775
Epoch: 12, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 0.8779664039611816
Epoch: 13, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 1.0100767612457275
Epoch: 14, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 0.9462673664093018
Epoch: 15, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 0.8018646240234375
Epoch: 16, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 0.7289023399353027
Epoch: 17, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 0.8062338829040527
Epoch: 18, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 0.7706124782562256
Epoch: 19, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.811314582824707
Epoch: 20, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 0.8835947513580322
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 0.8749043941497803
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 1.0424048900604248
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 1.1022450923919678
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9367401599884033
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 0.9984138011932373
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9706904888153076
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 1.0762825012207031
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.0665993690490723
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 1.0545668601989746
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 31 cost time: 0.9821066856384277
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 32 cost time: 0.9842069149017334
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.8697984218597412
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.9042458534240723
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.9785435199737549
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.9245939254760742
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.9312546253204346
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.8815209865570068
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 39 cost time: 0.9202032089233398
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 40 cost time: 1.038794994354248
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 41 cost time: 0.7988805770874023
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.8534250259399414
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 43 cost time: 1.1241769790649414
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 44 cost time: 0.8927080631256104
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.0655412673950195
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.000049114227295
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.9677064418792725
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.9868688583374023
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.99070143699646
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 1.1228384971618652
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps22_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 561081
model size : 2.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps29_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.253079414367676
Epoch: 1, Steps: 18 | Train Loss: 3.209 Vali Loss: 3.100 Vali Acc: 0.070 Test Loss: 3.100 Test Acc: 0.070
Validation loss decreased (inf --> -0.069969).  Saving model ...
Epoch: 2 cost time: 0.8184041976928711
Epoch: 2, Steps: 18 | Train Loss: 2.876 Vali Loss: 2.700 Vali Acc: 0.647 Test Loss: 2.700 Test Acc: 0.647
Validation loss decreased (-0.069969 --> -0.646640).  Saving model ...
Epoch: 3 cost time: 0.899104118347168
Epoch: 3, Steps: 18 | Train Loss: 2.305 Vali Loss: 2.062 Vali Acc: 0.887 Test Loss: 2.062 Test Acc: 0.887
Validation loss decreased (-0.646640 --> -0.886646).  Saving model ...
Epoch: 4 cost time: 0.9487953186035156
Epoch: 4, Steps: 18 | Train Loss: 1.568 Vali Loss: 1.246 Vali Acc: 0.937 Test Loss: 1.246 Test Acc: 0.937
Validation loss decreased (-0.886646 --> -0.936654).  Saving model ...
Epoch: 5 cost time: 0.9787392616271973
Epoch: 5, Steps: 18 | Train Loss: 0.782 Vali Loss: 0.579 Vali Acc: 0.960 Test Loss: 0.579 Test Acc: 0.960
Validation loss decreased (-0.936654 --> -0.959994).  Saving model ...
Epoch: 6 cost time: 0.8003947734832764
Epoch: 6, Steps: 18 | Train Loss: 0.301 Vali Loss: 0.290 Vali Acc: 0.963 Test Loss: 0.290 Test Acc: 0.963
Validation loss decreased (-0.959994 --> -0.963330).  Saving model ...
Epoch: 7 cost time: 0.8585686683654785
Epoch: 7, Steps: 18 | Train Loss: 0.117 Vali Loss: 0.200 Vali Acc: 0.970 Test Loss: 0.200 Test Acc: 0.970
Validation loss decreased (-0.963330 --> -0.969998).  Saving model ...
Epoch: 8 cost time: 0.795058012008667
Epoch: 8, Steps: 18 | Train Loss: 0.068 Vali Loss: 0.163 Vali Acc: 0.973 Test Loss: 0.163 Test Acc: 0.973
Validation loss decreased (-0.969998 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 0.7459337711334229
Epoch: 9, Steps: 18 | Train Loss: 0.039 Vali Loss: 0.146 Vali Acc: 0.967 Test Loss: 0.146 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8417251110076904
Epoch: 10, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.130 Vali Acc: 0.970 Test Loss: 0.130 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0459413528442383
Epoch: 11, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 0.9296913146972656
Epoch: 12, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 1.0163147449493408
Epoch: 13, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0939161777496338
Epoch: 14, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.868769645690918
Epoch: 15, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 0.9404079914093018
Epoch: 16, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 0.8660178184509277
Epoch: 17, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 0.8539626598358154
Epoch: 18, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 0.9148550033569336
Epoch: 19, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 0.7664999961853027
Epoch: 20, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 0.8168890476226807
Epoch: 21, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 0.8131868839263916
Epoch: 22, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 0.8218216896057129
Epoch: 23, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 0.7762949466705322
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 0.7363924980163574
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 0.8629052639007568
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 1.0723209381103516
Epoch: 27, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9863591194152832
Epoch: 28, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 0.8213319778442383
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.864429235458374
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 31 cost time: 0.9658887386322021
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 32 cost time: 0.7421660423278809
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 33 cost time: 0.8291366100311279
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 34 cost time: 0.7663915157318115
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 35 cost time: 1.069627046585083
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 36 cost time: 0.8752140998840332
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.9235126972198486
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.9726793766021729
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.9400219917297363
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.902944803237915
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 41 cost time: 0.867149829864502
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 42 cost time: 0.8184852600097656
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 43 cost time: 1.092820644378662
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 44 cost time: 1.0197257995605469
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.9135003089904785
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 46 cost time: 0.8690135478973389
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.8891696929931641
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.8550636768341064
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.8384149074554443
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.9256629943847656
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps29_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 532505
model size : 2.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps36_str18_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.1499500274658203
Epoch: 1, Steps: 18 | Train Loss: 3.231 Vali Loss: 3.143 Vali Acc: 0.163 Test Loss: 3.143 Test Acc: 0.163
Validation loss decreased (inf --> -0.163302).  Saving model ...
Epoch: 2 cost time: 1.131929874420166
Epoch: 2, Steps: 18 | Train Loss: 3.004 Vali Loss: 2.865 Vali Acc: 0.533 Test Loss: 2.865 Test Acc: 0.533
Validation loss decreased (-0.163302 --> -0.533305).  Saving model ...
Epoch: 3 cost time: 0.7928590774536133
Epoch: 3, Steps: 18 | Train Loss: 2.610 Vali Loss: 2.398 Vali Acc: 0.827 Test Loss: 2.398 Test Acc: 0.827
Validation loss decreased (-0.533305 --> -0.826643).  Saving model ...
Epoch: 4 cost time: 0.9010136127471924
Epoch: 4, Steps: 18 | Train Loss: 2.023 Vali Loss: 1.716 Vali Acc: 0.897 Test Loss: 1.716 Test Acc: 0.897
Validation loss decreased (-0.826643 --> -0.896650).  Saving model ...
Epoch: 5 cost time: 0.9842407703399658
Epoch: 5, Steps: 18 | Train Loss: 1.265 Vali Loss: 0.964 Vali Acc: 0.937 Test Loss: 0.964 Test Acc: 0.937
Validation loss decreased (-0.896650 --> -0.936657).  Saving model ...
Epoch: 6 cost time: 0.8275771141052246
Epoch: 6, Steps: 18 | Train Loss: 0.598 Vali Loss: 0.460 Vali Acc: 0.970 Test Loss: 0.460 Test Acc: 0.970
Validation loss decreased (-0.936657 --> -0.969995).  Saving model ...
Epoch: 7 cost time: 0.7161495685577393
Epoch: 7, Steps: 18 | Train Loss: 0.244 Vali Loss: 0.277 Vali Acc: 0.973 Test Loss: 0.277 Test Acc: 0.973
Validation loss decreased (-0.969995 --> -0.973331).  Saving model ...
Epoch: 8 cost time: 0.8079233169555664
Epoch: 8, Steps: 18 | Train Loss: 0.119 Vali Loss: 0.198 Vali Acc: 0.973 Test Loss: 0.198 Test Acc: 0.973
Validation loss decreased (-0.973331 --> -0.973331).  Saving model ...
Epoch: 9 cost time: 0.8468291759490967
Epoch: 9, Steps: 18 | Train Loss: 0.073 Vali Loss: 0.165 Vali Acc: 0.973 Test Loss: 0.165 Test Acc: 0.973
Validation loss decreased (-0.973331 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 0.9333682060241699
Epoch: 10, Steps: 18 | Train Loss: 0.048 Vali Loss: 0.145 Vali Acc: 0.977 Test Loss: 0.145 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 11 cost time: 0.7463769912719727
Epoch: 11, Steps: 18 | Train Loss: 0.031 Vali Loss: 0.131 Vali Acc: 0.977 Test Loss: 0.131 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 12 cost time: 0.8927559852600098
Epoch: 12, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.120 Vali Acc: 0.983 Test Loss: 0.120 Test Acc: 0.983
Validation loss decreased (-0.976665 --> -0.983332).  Saving model ...
Epoch: 13 cost time: 0.8743197917938232
Epoch: 13, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.115 Vali Acc: 0.983 Test Loss: 0.115 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 14 cost time: 0.863067626953125
Epoch: 14, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8089938163757324
Epoch: 15, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.108 Vali Acc: 0.980 Test Loss: 0.108 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8890781402587891
Epoch: 16, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.8350076675415039
Epoch: 17, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.7879776954650879
Epoch: 18, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.8671810626983643
Epoch: 19, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.047989845275879
Epoch: 20, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.8669252395629883
Epoch: 21, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.095 Vali Acc: 0.983 Test Loss: 0.095 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 22 cost time: 0.969261884689331
Epoch: 22, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.091261625289917
Epoch: 23, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.0002069473266602
Epoch: 24, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.005866289138794
Epoch: 25, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.9186830520629883
Epoch: 26, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.9076006412506104
Epoch: 27, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.983 Test Loss: 0.090 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 28 cost time: 0.9535496234893799
Epoch: 28, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.983 Test Loss: 0.091 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.8225135803222656
Epoch: 29, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.983 Test Loss: 0.090 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 30 cost time: 0.8439006805419922
Epoch: 30, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 31 cost time: 0.9681212902069092
Epoch: 31, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.8863959312438965
Epoch: 32, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.006584882736206
Epoch: 33, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.009413242340088
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.9646604061126709
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.9066236019134521
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.7440693378448486
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.9089741706848145
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.7887864112854004
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.7485029697418213
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps36_str18_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 518329
model size : 2.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 4.408298492431641
Epoch: 1, Steps: 18 | Train Loss: 1.613 Vali Loss: 0.434 Vali Acc: 0.897 Test Loss: 0.434 Test Acc: 0.897
Validation loss decreased (inf --> -0.896662).  Saving model ...
Epoch: 2 cost time: 3.15291166305542
Epoch: 2, Steps: 18 | Train Loss: 0.142 Vali Loss: 0.209 Vali Acc: 0.940 Test Loss: 0.209 Test Acc: 0.940
Validation loss decreased (-0.896662 --> -0.939998).  Saving model ...
Epoch: 3 cost time: 2.9710350036621094
Epoch: 3, Steps: 18 | Train Loss: 0.060 Vali Loss: 0.268 Vali Acc: 0.943 Test Loss: 0.268 Test Acc: 0.943
Validation loss decreased (-0.939998 --> -0.943331).  Saving model ...
Epoch: 4 cost time: 2.636814594268799
Epoch: 4, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.400 Vali Acc: 0.917 Test Loss: 0.400 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.21405291557312
Epoch: 5, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.399 Vali Acc: 0.913 Test Loss: 0.399 Test Acc: 0.913
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.721245050430298
Epoch: 6, Steps: 18 | Train Loss: 0.152 Vali Loss: 0.470 Vali Acc: 0.900 Test Loss: 0.470 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.7678933143615723
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.375 Vali Acc: 0.940 Test Loss: 0.375 Test Acc: 0.940
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.7059743404388428
Epoch: 8, Steps: 18 | Train Loss: 0.038 Vali Loss: 0.776 Vali Acc: 0.890 Test Loss: 0.776 Test Acc: 0.890
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.762500524520874
Epoch: 9, Steps: 18 | Train Loss: 0.406 Vali Loss: 1.797 Vali Acc: 0.797 Test Loss: 1.797 Test Acc: 0.797
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.7772419452667236
Epoch: 10, Steps: 18 | Train Loss: 0.471 Vali Loss: 1.717 Vali Acc: 0.823 Test Loss: 1.717 Test Acc: 0.823
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.134307622909546
Epoch: 11, Steps: 18 | Train Loss: 0.195 Vali Loss: 0.974 Vali Acc: 0.900 Test Loss: 0.974 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.371757745742798
Epoch: 12, Steps: 18 | Train Loss: 0.108 Vali Loss: 0.532 Vali Acc: 0.933 Test Loss: 0.532 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.3265280723571777
Epoch: 13, Steps: 18 | Train Loss: 0.053 Vali Loss: 0.889 Vali Acc: 0.887 Test Loss: 0.889 Test Acc: 0.887
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9433333333333334
model parameter : 9107737
model size : 34.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.4706263542175293
Epoch: 1, Steps: 18 | Train Loss: 2.013 Vali Loss: 0.439 Vali Acc: 0.897 Test Loss: 0.439 Test Acc: 0.897
Validation loss decreased (inf --> -0.896662).  Saving model ...
Epoch: 2 cost time: 1.1696481704711914
Epoch: 2, Steps: 18 | Train Loss: 0.055 Vali Loss: 0.170 Vali Acc: 0.960 Test Loss: 0.170 Test Acc: 0.960
Validation loss decreased (-0.896662 --> -0.959998).  Saving model ...
Epoch: 3 cost time: 1.1228811740875244
Epoch: 3, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.121 Vali Acc: 0.963 Test Loss: 0.121 Test Acc: 0.963
Validation loss decreased (-0.959998 --> -0.963332).  Saving model ...
Epoch: 4 cost time: 1.5284078121185303
Epoch: 4, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.134 Vali Acc: 0.960 Test Loss: 0.134 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.533635139465332
Epoch: 5, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.169 Vali Acc: 0.967 Test Loss: 0.169 Test Acc: 0.967
Validation loss decreased (-0.963332 --> -0.966665).  Saving model ...
Epoch: 6 cost time: 1.6194407939910889
Epoch: 6, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.122 Vali Acc: 0.973 Test Loss: 0.122 Test Acc: 0.973
Validation loss decreased (-0.966665 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 1.3868000507354736
Epoch: 7, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 1.4917869567871094
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 1.3930938243865967
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 1.1158215999603271
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 0.9352996349334717
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 12 cost time: 1.1511216163635254
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 13 cost time: 0.9327614307403564
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 0.9937648773193359
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 0.945185661315918
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 0.9975109100341797
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 1.003068208694458
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 1.5647525787353516
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 1.6092360019683838
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 1.648285150527954
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 1.5970511436462402
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.5633916854858398
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 1.4850528240203857
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.1869375705718994
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.2443733215332031
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 1.5910022258758545
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 1.3894879817962646
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.4573686122894287
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 1.3283791542053223
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.983 Test Loss: 0.098 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 30 cost time: 1.5134472846984863
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.983 Test Loss: 0.098 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 31 cost time: 1.5589916706085205
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.983 Test Loss: 0.098 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 32 cost time: 1.3053832054138184
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.983 Test Loss: 0.097 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 33 cost time: 1.07155179977417
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.983 Test Loss: 0.097 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 34 cost time: 1.4554991722106934
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.983 Test Loss: 0.097 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 35 cost time: 1.2373073101043701
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.983 Test Loss: 0.097 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 36 cost time: 1.5266177654266357
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.983 Test Loss: 0.097 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 37 cost time: 1.4674043655395508
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.983 Test Loss: 0.097 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 38 cost time: 1.4442648887634277
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.983 Test Loss: 0.097 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 39 cost time: 1.119227647781372
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.983 Test Loss: 0.097 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.1174046993255615
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.983 Test Loss: 0.097 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.2030160427093506
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.983 Test Loss: 0.097 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.4062249660491943
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.983 Test Loss: 0.097 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 43 cost time: 1.3441078662872314
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.983 Test Loss: 0.097 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.516207218170166
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.987 Test Loss: 0.097 Test Acc: 0.987
Validation loss decreased (-0.983332 --> -0.986666).  Saving model ...
Epoch: 45 cost time: 1.4392547607421875
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.983 Test Loss: 0.097 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.32796311378479
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.987 Test Loss: 0.097 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.3038897514343262
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.987 Test Loss: 0.097 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 48 cost time: 1.372537612915039
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.987 Test Loss: 0.097 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.2068753242492676
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.987 Test Loss: 0.097 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.5902674198150635
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.987 Test Loss: 0.097 Test Acc: 0.987
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9866666666666667
model parameter : 7035161
model size : 26.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.6062190532684326
Epoch: 1, Steps: 18 | Train Loss: 2.298 Vali Loss: 0.681 Vali Acc: 0.943 Test Loss: 0.681 Test Acc: 0.943
Validation loss decreased (inf --> -0.943327).  Saving model ...
Epoch: 2 cost time: 1.2883031368255615
Epoch: 2, Steps: 18 | Train Loss: 0.120 Vali Loss: 0.115 Vali Acc: 0.970 Test Loss: 0.115 Test Acc: 0.970
Validation loss decreased (-0.943327 --> -0.969999).  Saving model ...
Epoch: 3 cost time: 1.3394932746887207
Epoch: 3, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.120 Vali Acc: 0.957 Test Loss: 0.120 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5183849334716797
Epoch: 4, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.135 Vali Acc: 0.953 Test Loss: 0.135 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3574743270874023
Epoch: 5, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.104 Vali Acc: 0.967 Test Loss: 0.104 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.2748546600341797
Epoch: 6, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 7 cost time: 1.320265531539917
Epoch: 7, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 1.503951072692871
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 1.282867670059204
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 1.290548324584961
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 1.160285234451294
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 1.4361438751220703
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 1.3183550834655762
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 1.3535192012786865
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 1.1247296333312988
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1531407833099365
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 1.1183605194091797
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 1.0574588775634766
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 1.1280410289764404
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 1.671483039855957
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.4804065227508545
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.4812886714935303
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.8863441944122314
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.663348913192749
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.5376501083374023
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.6177091598510742
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.5960330963134766
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.359931230545044
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.3999302387237549
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 6344729
model size : 24.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.6951706409454346
Epoch: 1, Steps: 18 | Train Loss: 2.426 Vali Loss: 0.980 Vali Acc: 0.927 Test Loss: 0.980 Test Acc: 0.927
Validation loss decreased (inf --> -0.926657).  Saving model ...
Epoch: 2 cost time: 1.3728446960449219
Epoch: 2, Steps: 18 | Train Loss: 0.176 Vali Loss: 0.172 Vali Acc: 0.953 Test Loss: 0.172 Test Acc: 0.953
Validation loss decreased (-0.926657 --> -0.953332).  Saving model ...
Epoch: 3 cost time: 1.3889472484588623
Epoch: 3, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.953332 --> -0.979999).  Saving model ...
Epoch: 4 cost time: 1.2638521194458008
Epoch: 4, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 5 cost time: 1.3892760276794434
Epoch: 5, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 6 cost time: 1.5503895282745361
Epoch: 6, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.113 Vali Acc: 0.967 Test Loss: 0.113 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4592006206512451
Epoch: 7, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.4759628772735596
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.5841197967529297
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.8274922370910645
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.7338800430297852
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.5602426528930664
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.4865493774414062
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.24180269241333
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.4384124279022217
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 6000153
model size : 22.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps22_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.8950912952423096
Epoch: 1, Steps: 18 | Train Loss: 2.569 Vali Loss: 1.302 Vali Acc: 0.930 Test Loss: 1.302 Test Acc: 0.930
Validation loss decreased (inf --> -0.929987).  Saving model ...
Epoch: 2 cost time: 1.363124132156372
Epoch: 2, Steps: 18 | Train Loss: 0.295 Vali Loss: 0.190 Vali Acc: 0.963 Test Loss: 0.190 Test Acc: 0.963
Validation loss decreased (-0.929987 --> -0.963331).  Saving model ...
Epoch: 3 cost time: 1.1917040348052979
Epoch: 3, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.115 Vali Acc: 0.970 Test Loss: 0.115 Test Acc: 0.970
Validation loss decreased (-0.963331 --> -0.969999).  Saving model ...
Epoch: 4 cost time: 1.4428212642669678
Epoch: 4, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.137 Vali Acc: 0.957 Test Loss: 0.137 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6587152481079102
Epoch: 5, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 6 cost time: 1.3951971530914307
Epoch: 6, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 7 cost time: 1.561981439590454
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 8 cost time: 1.689544916152954
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 1.3652844429016113
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 1.380225419998169
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 1.5424003601074219
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 1.4552152156829834
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2923059463500977
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 1.316643476486206
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 1.595099687576294
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 1.6305851936340332
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 1.4366986751556396
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 1.6355020999908447
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 1.4798896312713623
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 1.489598274230957
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 1.4477534294128418
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.3490052223205566
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.1463005542755127
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.0488054752349854
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 1.5459141731262207
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 1.6312637329101562
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 1.3644373416900635
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 28 cost time: 1.4549508094787598
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 1.5339350700378418
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 30 cost time: 1.4084179401397705
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 31 cost time: 1.447115421295166
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.5443029403686523
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 33 cost time: 1.6038200855255127
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 34 cost time: 1.302466869354248
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 35 cost time: 1.5626637935638428
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 36 cost time: 1.8238449096679688
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.4417824745178223
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.301701307296753
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.4599299430847168
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.3637745380401611
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.601151704788208
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.1824851036071777
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.6494207382202148
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.6118779182434082
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 1.7086460590362549
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps22_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 5713945
model size : 21.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps29_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.9464287757873535
Epoch: 1, Steps: 18 | Train Loss: 2.795 Vali Loss: 1.773 Vali Acc: 0.883 Test Loss: 1.773 Test Acc: 0.883
Validation loss decreased (inf --> -0.883316).  Saving model ...
Epoch: 2 cost time: 1.7756097316741943
Epoch: 2, Steps: 18 | Train Loss: 0.593 Vali Loss: 0.307 Vali Acc: 0.950 Test Loss: 0.307 Test Acc: 0.950
Validation loss decreased (-0.883316 --> -0.949997).  Saving model ...
Epoch: 3 cost time: 1.736213207244873
Epoch: 3, Steps: 18 | Train Loss: 0.053 Vali Loss: 0.124 Vali Acc: 0.973 Test Loss: 0.124 Test Acc: 0.973
Validation loss decreased (-0.949997 --> -0.973332).  Saving model ...
Epoch: 4 cost time: 1.3386099338531494
Epoch: 4, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.116 Vali Acc: 0.967 Test Loss: 0.116 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5255827903747559
Epoch: 5, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.6207904815673828
Epoch: 6, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 1.7467806339263916
Epoch: 7, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 1.4418871402740479
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 1.2090001106262207
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 1.422574758529663
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3196237087249756
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 1.4167804718017578
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.983 Test Loss: 0.091 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 13 cost time: 1.5167341232299805
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.749720573425293
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.184178113937378
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 16 cost time: 1.3005213737487793
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.567884922027588
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.734712839126587
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.725548267364502
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.7402701377868652
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.8986217975616455
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.9412798881530762
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.4838030338287354
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.5420198440551758
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.6109445095062256
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps29_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 5485337
model size : 20.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps36_str18_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.3535823822021484
Epoch: 1, Steps: 18 | Train Loss: 2.822 Vali Loss: 1.805 Vali Acc: 0.937 Test Loss: 1.805 Test Acc: 0.937
Validation loss decreased (inf --> -0.936649).  Saving model ...
Epoch: 2 cost time: 1.3192875385284424
Epoch: 2, Steps: 18 | Train Loss: 0.638 Vali Loss: 0.329 Vali Acc: 0.940 Test Loss: 0.329 Test Acc: 0.940
Validation loss decreased (-0.936649 --> -0.939997).  Saving model ...
Epoch: 3 cost time: 1.2796883583068848
Epoch: 3, Steps: 18 | Train Loss: 0.070 Vali Loss: 0.120 Vali Acc: 0.973 Test Loss: 0.120 Test Acc: 0.973
Validation loss decreased (-0.939997 --> -0.973332).  Saving model ...
Epoch: 4 cost time: 1.9381849765777588
Epoch: 4, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
Validation loss decreased (-0.973332 --> -0.979999).  Saving model ...
Epoch: 5 cost time: 1.3068962097167969
Epoch: 5, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3824868202209473
Epoch: 6, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.3615455627441406
Epoch: 7, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.5653345584869385
Epoch: 8, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.3300435543060303
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.306086540222168
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.481367826461792
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.4779014587402344
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.6266822814941406
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.4982445240020752
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps36_str18_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 5429529
model size : 20.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.2346155643463135
Epoch: 1, Steps: 18 | Train Loss: 1.954 Vali Loss: 0.388 Vali Acc: 0.927 Test Loss: 0.388 Test Acc: 0.927
Validation loss decreased (inf --> -0.926663).  Saving model ...
Epoch: 2 cost time: 1.9572057723999023
Epoch: 2, Steps: 18 | Train Loss: 0.045 Vali Loss: 0.164 Vali Acc: 0.953 Test Loss: 0.164 Test Acc: 0.953
Validation loss decreased (-0.926663 --> -0.953332).  Saving model ...
Epoch: 3 cost time: 1.9786231517791748
Epoch: 3, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.140 Vali Acc: 0.967 Test Loss: 0.140 Test Acc: 0.967
Validation loss decreased (-0.953332 --> -0.966665).  Saving model ...
Epoch: 4 cost time: 2.0230960845947266
Epoch: 4, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.126 Vali Acc: 0.967 Test Loss: 0.126 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 5 cost time: 1.7951033115386963
Epoch: 5, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
Validation loss decreased (-0.966665 --> -0.976666).  Saving model ...
Epoch: 6 cost time: 1.7032854557037354
Epoch: 6, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 1.747070074081421
Epoch: 7, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 1.7096178531646729
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 1.5476508140563965
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 2.141554355621338
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 1.8144779205322266
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 1.7928285598754883
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 1.734532117843628
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 2.2970962524414062
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 1.8623313903808594
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 1.9816055297851562
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 1.961059331893921
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 1.61159348487854
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 1.4099464416503906
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 1.6878814697265625
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 1.9446570873260498
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 1.9499428272247314
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 1.8466660976409912
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 1.9449410438537598
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 1.7586922645568848
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 1.5322034358978271
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 1.4861743450164795
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 2.029209852218628
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 2.0586929321289062
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 1.8791499137878418
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 31 cost time: 2.003751277923584
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 32 cost time: 1.840087890625
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 33 cost time: 1.64603590965271
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.734673261642456
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 35 cost time: 2.054030179977417
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 36 cost time: 1.6239852905273438
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 37 cost time: 1.5778887271881104
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 38 cost time: 1.5862767696380615
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 39 cost time: 1.626542568206787
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 40 cost time: 1.5405833721160889
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 41 cost time: 1.4319798946380615
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 42 cost time: 1.462031364440918
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 43 cost time: 1.972921371459961
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 44 cost time: 1.9179630279541016
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 45 cost time: 1.920198678970337
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 46 cost time: 1.7970225811004639
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.8754265308380127
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 48 cost time: 2.1162703037261963
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 2.056297540664673
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 50 cost time: 1.9751567840576172
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 3374233
model size : 12.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.9239544868469238
Epoch: 1, Steps: 18 | Train Loss: 2.358 Vali Loss: 0.978 Vali Acc: 0.933 Test Loss: 0.978 Test Acc: 0.933
Validation loss decreased (inf --> -0.933324).  Saving model ...
Epoch: 2 cost time: 0.636430025100708
Epoch: 2, Steps: 18 | Train Loss: 0.180 Vali Loss: 0.148 Vali Acc: 0.963 Test Loss: 0.148 Test Acc: 0.963
Validation loss decreased (-0.933324 --> -0.963332).  Saving model ...
Epoch: 3 cost time: 0.8335990905761719
Epoch: 3, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.963332 --> -0.976666).  Saving model ...
Epoch: 4 cost time: 1.1942377090454102
Epoch: 4, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.057325839996338
Epoch: 5, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 6 cost time: 1.0362591743469238
Epoch: 6, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 7 cost time: 1.0000579357147217
Epoch: 7, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.973 Test Loss: 0.080 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.271132469177246
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.973 Test Loss: 0.079 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1502180099487305
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 1.0170657634735107
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 0.7210772037506104
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 0.9924802780151367
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 0.8814589977264404
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 0.7061526775360107
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 0.9536068439483643
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1102781295776367
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0090155601501465
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.8593766689300537
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.9646713733673096
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 1.0695602893829346
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 0.9290714263916016
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9921736717224121
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.987372875213623
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.980729341506958
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 1.0349862575531006
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.1083664894104004
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.1593120098114014
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.1471269130706787
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.033677101135254
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.233269453048706
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.2001140117645264
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.9683182239532471
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.91298508644104
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.1523935794830322
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 2337945
model size : 8.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.143169403076172
Epoch: 1, Steps: 18 | Train Loss: 2.575 Vali Loss: 1.453 Vali Acc: 0.910 Test Loss: 1.453 Test Acc: 0.910
Validation loss decreased (inf --> -0.909985).  Saving model ...
Epoch: 2 cost time: 0.9745020866394043
Epoch: 2, Steps: 18 | Train Loss: 0.357 Vali Loss: 0.219 Vali Acc: 0.960 Test Loss: 0.219 Test Acc: 0.960
Validation loss decreased (-0.909985 --> -0.959998).  Saving model ...
Epoch: 3 cost time: 0.8525638580322266
Epoch: 3, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
Validation loss decreased (-0.959998 --> -0.969999).  Saving model ...
Epoch: 4 cost time: 0.8785510063171387
Epoch: 4, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.969999 --> -0.976666).  Saving model ...
Epoch: 5 cost time: 0.9639713764190674
Epoch: 5, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 6 cost time: 0.92531418800354
Epoch: 6, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 0.8179535865783691
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 1.1887333393096924
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2563881874084473
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.101172924041748
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.1254873275756836
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.0785179138183594
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.0644805431365967
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.208305835723877
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.9250190258026123
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.0165503025054932
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.9244918823242188
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 0.8705768585205078
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 0.808107852935791
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 0.8702151775360107
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 1.0798981189727783
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1183576583862305
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.9168763160705566
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 1.0953764915466309
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.1164121627807617
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.9475910663604736
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 0.9360182285308838
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 1.2673664093017578
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.8822274208068848
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.8522815704345703
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 31 cost time: 0.9169762134552002
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 32 cost time: 0.8417301177978516
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 33 cost time: 0.684788703918457
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.710669755935669
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.7395668029785156
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.9208564758300781
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 37 cost time: 0.783653736114502
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.0624563694000244
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 39 cost time: 1.154832363128662
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.9934368133544922
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 41 cost time: 1.0414869785308838
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 42 cost time: 1.0031850337982178
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.121588945388794
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.9485352039337158
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 45 cost time: 0.9441895484924316
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 46 cost time: 1.0276405811309814
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 47 cost time: 0.9911160469055176
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.0123610496520996
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 49 cost time: 1.0069475173950195
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.1848068237304688
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 1992729
model size : 7.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.090178966522217
Epoch: 1, Steps: 18 | Train Loss: 2.717 Vali Loss: 1.830 Vali Acc: 0.880 Test Loss: 1.830 Test Acc: 0.880
Validation loss decreased (inf --> -0.879982).  Saving model ...
Epoch: 2 cost time: 0.803729772567749
Epoch: 2, Steps: 18 | Train Loss: 0.580 Vali Loss: 0.292 Vali Acc: 0.963 Test Loss: 0.292 Test Acc: 0.963
Validation loss decreased (-0.879982 --> -0.963330).  Saving model ...
Epoch: 3 cost time: 0.8617212772369385
Epoch: 3, Steps: 18 | Train Loss: 0.056 Vali Loss: 0.137 Vali Acc: 0.970 Test Loss: 0.137 Test Acc: 0.970
Validation loss decreased (-0.963330 --> -0.969999).  Saving model ...
Epoch: 4 cost time: 0.8196461200714111
Epoch: 4, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.122 Vali Acc: 0.970 Test Loss: 0.122 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 5 cost time: 0.77655029296875
Epoch: 5, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 6 cost time: 0.7768845558166504
Epoch: 6, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 0.8339605331420898
Epoch: 7, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 1.118497371673584
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 1.0556938648223877
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 0.9163119792938232
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 0.957007884979248
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 0.973841667175293
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.849949836730957
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 0.840874433517456
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 0.8498392105102539
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9871461391448975
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 0.9854133129119873
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.954369068145752
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.0390098094940186
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.0881283283233643
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.9196655750274658
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 0.7955493927001953
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0473480224609375
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 0.9527626037597656
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 0.9250235557556152
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 1.0809106826782227
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0589406490325928
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 28 cost time: 0.9535188674926758
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 0.8820359706878662
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9727578163146973
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.0082406997680664
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 32 cost time: 0.9311187267303467
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 33 cost time: 0.889660120010376
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 34 cost time: 0.9205191135406494
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 35 cost time: 0.9055676460266113
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 36 cost time: 0.8428375720977783
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.9438180923461914
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 38 cost time: 0.939521074295044
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 39 cost time: 1.0531842708587646
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 40 cost time: 0.986558198928833
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.1018872261047363
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 42 cost time: 1.0355544090270996
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.891596794128418
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.072645664215088
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.0151045322418213
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.9967911243438721
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.0084192752838135
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.1328976154327393
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 1.0025031566619873
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 0.9792494773864746
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 1820441
model size : 6.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps22_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.16603684425354
Epoch: 1, Steps: 18 | Train Loss: 2.841 Vali Loss: 2.093 Vali Acc: 0.830 Test Loss: 2.093 Test Acc: 0.830
Validation loss decreased (inf --> -0.829979).  Saving model ...
Epoch: 2 cost time: 0.7808113098144531
Epoch: 2, Steps: 18 | Train Loss: 0.916 Vali Loss: 0.479 Vali Acc: 0.963 Test Loss: 0.479 Test Acc: 0.963
Validation loss decreased (-0.829979 --> -0.963329).  Saving model ...
Epoch: 3 cost time: 0.909674882888794
Epoch: 3, Steps: 18 | Train Loss: 0.126 Vali Loss: 0.159 Vali Acc: 0.970 Test Loss: 0.159 Test Acc: 0.970
Validation loss decreased (-0.963329 --> -0.969998).  Saving model ...
Epoch: 4 cost time: 0.7183995246887207
Epoch: 4, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.134 Vali Acc: 0.967 Test Loss: 0.134 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8043477535247803
Epoch: 5, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969999).  Saving model ...
Epoch: 6 cost time: 0.8134760856628418
Epoch: 6, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 7 cost time: 0.9901165962219238
Epoch: 7, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 8 cost time: 1.0042672157287598
Epoch: 8, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 9 cost time: 0.8619112968444824
Epoch: 9, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 10 cost time: 0.9421594142913818
Epoch: 10, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.969999 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 1.068251371383667
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 0.8806509971618652
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 0.9913947582244873
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 1.0480902194976807
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 0.9115126132965088
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 0.9839620590209961
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 1.0366218090057373
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 1.0611319541931152
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 0.8959782123565674
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 0.777012825012207
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 0.9105653762817383
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1199157238006592
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.9700412750244141
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.0546109676361084
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.1196274757385254
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.9749295711517334
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.0399386882781982
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.9185404777526855
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.8061761856079102
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 0.6989271640777588
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.7452921867370605
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.9005155563354492
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.9198133945465088
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.9075527191162109
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.9349761009216309
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.9980812072753906
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.1818842887878418
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.003556728363037
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.0119009017944336
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps22_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 1677337
model size : 6.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps29_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.0446550846099854
Epoch: 1, Steps: 18 | Train Loss: 2.996 Vali Loss: 2.410 Vali Acc: 0.763 Test Loss: 2.410 Test Acc: 0.763
Validation loss decreased (inf --> -0.763309).  Saving model ...
Epoch: 2 cost time: 0.8882946968078613
Epoch: 2, Steps: 18 | Train Loss: 1.356 Vali Loss: 0.818 Vali Acc: 0.953 Test Loss: 0.818 Test Acc: 0.953
Validation loss decreased (-0.763309 --> -0.953325).  Saving model ...
Epoch: 3 cost time: 0.934586763381958
Epoch: 3, Steps: 18 | Train Loss: 0.307 Vali Loss: 0.259 Vali Acc: 0.963 Test Loss: 0.259 Test Acc: 0.963
Validation loss decreased (-0.953325 --> -0.963331).  Saving model ...
Epoch: 4 cost time: 0.9535036087036133
Epoch: 4, Steps: 18 | Train Loss: 0.062 Vali Loss: 0.155 Vali Acc: 0.973 Test Loss: 0.155 Test Acc: 0.973
Validation loss decreased (-0.963331 --> -0.973332).  Saving model ...
Epoch: 5 cost time: 0.8657891750335693
Epoch: 5, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.130 Vali Acc: 0.973 Test Loss: 0.130 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 6 cost time: 0.8766555786132812
Epoch: 6, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 0.9762237071990967
Epoch: 7, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 0.9669160842895508
Epoch: 8, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 1.0069832801818848
Epoch: 9, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9532251358032227
Epoch: 10, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 1.0190465450286865
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 0.9587357044219971
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 0.8274152278900146
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 0.9311325550079346
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 1.0976336002349854
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 1.0218620300292969
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 1.118354320526123
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 1.0593156814575195
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 1.0197575092315674
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 1.0708067417144775
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 0.9813766479492188
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 1.1211433410644531
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 0.8630590438842773
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 0.8949873447418213
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 0.9518213272094727
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7764232158660889
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 0.675241231918335
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 0.8582439422607422
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 1.0787320137023926
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 0.7661144733428955
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 31 cost time: 0.7491245269775391
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 32 cost time: 0.9444131851196289
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 33 cost time: 0.998070478439331
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 34 cost time: 0.928337574005127
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 35 cost time: 0.9008691310882568
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 36 cost time: 0.9284403324127197
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 37 cost time: 1.0181877613067627
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.7885844707489014
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 39 cost time: 0.7297444343566895
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.0249159336090088
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 41 cost time: 1.094299554824829
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.860619068145752
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.8188116550445557
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.933239221572876
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.9321174621582031
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.8639075756072998
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.8031020164489746
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 0.7279179096221924
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 0.9337642192840576
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 0.8835725784301758
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps29_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 1563033
model size : 6.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps36_str18_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.3640120029449463
Epoch: 1, Steps: 18 | Train Loss: 3.058 Vali Loss: 2.462 Vali Acc: 0.587 Test Loss: 2.462 Test Acc: 0.587
Validation loss decreased (inf --> -0.586642).  Saving model ...
Epoch: 2 cost time: 0.954007625579834
Epoch: 2, Steps: 18 | Train Loss: 1.496 Vali Loss: 0.918 Vali Acc: 0.953 Test Loss: 0.918 Test Acc: 0.953
Validation loss decreased (-0.586642 --> -0.953324).  Saving model ...
Epoch: 3 cost time: 0.9284853935241699
Epoch: 3, Steps: 18 | Train Loss: 0.387 Vali Loss: 0.284 Vali Acc: 0.973 Test Loss: 0.284 Test Acc: 0.973
Validation loss decreased (-0.953324 --> -0.973330).  Saving model ...
Epoch: 4 cost time: 0.8003902435302734
Epoch: 4, Steps: 18 | Train Loss: 0.084 Vali Loss: 0.146 Vali Acc: 0.980 Test Loss: 0.146 Test Acc: 0.980
Validation loss decreased (-0.973330 --> -0.979999).  Saving model ...
Epoch: 5 cost time: 0.7816827297210693
Epoch: 5, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.120 Vali Acc: 0.977 Test Loss: 0.120 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8540832996368408
Epoch: 6, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.8210139274597168
Epoch: 7, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.8130924701690674
Epoch: 8, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.9823331832885742
Epoch: 9, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.7402992248535156
Epoch: 10, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.9916379451751709
Epoch: 11, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.8845386505126953
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.1027090549468994
Epoch: 13, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.9017226696014404
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps36_str18_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 1535129
model size : 5.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.6007328033447266
Epoch: 1, Steps: 18 | Train Loss: 2.398 Vali Loss: 0.961 Vali Acc: 0.923 Test Loss: 0.961 Test Acc: 0.923
Validation loss decreased (inf --> -0.923324).  Saving model ...
Epoch: 2 cost time: 1.254629135131836
Epoch: 2, Steps: 18 | Train Loss: 0.168 Vali Loss: 0.162 Vali Acc: 0.967 Test Loss: 0.162 Test Acc: 0.967
Validation loss decreased (-0.923324 --> -0.966665).  Saving model ...
Epoch: 3 cost time: 1.086702823638916
Epoch: 3, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
Validation loss decreased (-0.966665 --> -0.973332).  Saving model ...
Epoch: 4 cost time: 1.1573784351348877
Epoch: 4, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.159 Vali Acc: 0.953 Test Loss: 0.159 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0828821659088135
Epoch: 5, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.128 Vali Acc: 0.963 Test Loss: 0.128 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9367902278900146
Epoch: 6, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.160 Vali Acc: 0.947 Test Loss: 0.160 Test Acc: 0.947
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9652590751647949
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.112 Vali Acc: 0.963 Test Loss: 0.112 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.1717312335968018
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.1198742389678955
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.098832607269287
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.16795015335083
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 1.2486546039581299
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 0.794013500213623
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9391465187072754
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.956000804901123
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.8429045677185059
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 0.8102893829345703
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 0.7439463138580322
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 1.2008819580078125
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2775492668151855
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 1.2042138576507568
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1961593627929688
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 1.2796258926391602
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 1.1707432270050049
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0019538402557373
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 0.9364936351776123
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 0.9992814064025879
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8819959163665771
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 1.022444248199463
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 1.1415271759033203
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 31 cost time: 1.1027567386627197
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.9772469997406006
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.034252643585205
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.141768217086792
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.0756261348724365
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 36 cost time: 0.890812873840332
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 37 cost time: 1.0922036170959473
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 38 cost time: 1.1417057514190674
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.0643625259399414
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 40 cost time: 1.2052490711212158
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 41 cost time: 1.3739066123962402
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 42 cost time: 1.0354244709014893
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.9282660484313965
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.9478287696838379
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.1485810279846191
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.8454077243804932
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.8826053142547607
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.0441076755523682
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 1.1839556694030762
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 1.0784492492675781
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 1392217
model size : 5.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.0902297496795654
Epoch: 1, Steps: 18 | Train Loss: 2.784 Vali Loss: 1.805 Vali Acc: 0.867 Test Loss: 1.805 Test Acc: 0.867
Validation loss decreased (inf --> -0.866649).  Saving model ...
Epoch: 2 cost time: 0.6668615341186523
Epoch: 2, Steps: 18 | Train Loss: 0.597 Vali Loss: 0.312 Vali Acc: 0.957 Test Loss: 0.312 Test Acc: 0.957
Validation loss decreased (-0.866649 --> -0.956664).  Saving model ...
Epoch: 3 cost time: 0.7098183631896973
Epoch: 3, Steps: 18 | Train Loss: 0.052 Vali Loss: 0.136 Vali Acc: 0.973 Test Loss: 0.136 Test Acc: 0.973
Validation loss decreased (-0.956664 --> -0.973332).  Saving model ...
Epoch: 4 cost time: 0.8319334983825684
Epoch: 4, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.126 Vali Acc: 0.963 Test Loss: 0.126 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7403473854064941
Epoch: 5, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.973332 --> -0.979999).  Saving model ...
Epoch: 6 cost time: 0.8464395999908447
Epoch: 6, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 0.8075916767120361
Epoch: 7, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 0.894197940826416
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 0.7483196258544922
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 0.7987067699432373
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 0.831200361251831
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 0.7138595581054688
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 0.6213722229003906
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 0.7183544635772705
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 0.8110413551330566
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 0.8462400436401367
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 0.7877020835876465
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 0.8867826461791992
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 0.8992323875427246
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 0.9488391876220703
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 0.8642499446868896
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 0.6866819858551025
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 0.7567310333251953
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 0.7057421207427979
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 0.7437245845794678
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 0.7348308563232422
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 0.8499658107757568
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.08878755569458
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.8342800140380859
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.8411104679107666
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.8676912784576416
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.8395476341247559
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.731372594833374
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 34 cost time: 0.736976146697998
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.8354814052581787
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 36 cost time: 0.6309711933135986
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 37 cost time: 0.8973739147186279
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 38 cost time: 0.8529505729675293
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.744727373123169
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 40 cost time: 0.746326208114624
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.9152238368988037
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.7033538818359375
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 43 cost time: 0.8508319854736328
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.9334099292755127
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.790764331817627
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.6157307624816895
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 47 cost time: 0.6943259239196777
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.728644609451294
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.6955041885375977
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 50 cost time: 0.5777640342712402
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 874073
model size : 3.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.0621330738067627
Epoch: 1, Steps: 18 | Train Loss: 2.888 Vali Loss: 2.230 Vali Acc: 0.840 Test Loss: 2.230 Test Acc: 0.840
Validation loss decreased (inf --> -0.839978).  Saving model ...
Epoch: 2 cost time: 0.7290503978729248
Epoch: 2, Steps: 18 | Train Loss: 1.068 Vali Loss: 0.603 Vali Acc: 0.967 Test Loss: 0.603 Test Acc: 0.967
Validation loss decreased (-0.839978 --> -0.966661).  Saving model ...
Epoch: 3 cost time: 0.681706428527832
Epoch: 3, Steps: 18 | Train Loss: 0.167 Vali Loss: 0.196 Vali Acc: 0.977 Test Loss: 0.196 Test Acc: 0.977
Validation loss decreased (-0.966661 --> -0.976665).  Saving model ...
Epoch: 4 cost time: 0.7645888328552246
Epoch: 4, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.135 Vali Acc: 0.977 Test Loss: 0.135 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 5 cost time: 0.7467336654663086
Epoch: 5, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 6 cost time: 0.6842949390411377
Epoch: 6, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 7 cost time: 0.8372523784637451
Epoch: 7, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 8 cost time: 0.701033353805542
Epoch: 8, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 0.7222046852111816
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 0.7902765274047852
Epoch: 10, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 0.9289689064025879
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 0.8637211322784424
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 0.7709546089172363
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 0.7524197101593018
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7693808078765869
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9087798595428467
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.8355131149291992
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.719170093536377
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.6765310764312744
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.727367639541626
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.6504626274108887
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.7309348583221436
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.7814676761627197
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 701465
model size : 2.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.158677816390991
Epoch: 1, Steps: 18 | Train Loss: 2.994 Vali Loss: 2.541 Vali Acc: 0.660 Test Loss: 2.541 Test Acc: 0.660
Validation loss decreased (inf --> -0.659975).  Saving model ...
Epoch: 2 cost time: 0.6936275959014893
Epoch: 2, Steps: 18 | Train Loss: 1.450 Vali Loss: 0.946 Vali Acc: 0.943 Test Loss: 0.946 Test Acc: 0.943
Validation loss decreased (-0.659975 --> -0.943324).  Saving model ...
Epoch: 3 cost time: 0.6628856658935547
Epoch: 3, Steps: 18 | Train Loss: 0.350 Vali Loss: 0.280 Vali Acc: 0.963 Test Loss: 0.280 Test Acc: 0.963
Validation loss decreased (-0.943324 --> -0.963331).  Saving model ...
Epoch: 4 cost time: 0.7479457855224609
Epoch: 4, Steps: 18 | Train Loss: 0.064 Vali Loss: 0.158 Vali Acc: 0.973 Test Loss: 0.158 Test Acc: 0.973
Validation loss decreased (-0.963331 --> -0.973332).  Saving model ...
Epoch: 5 cost time: 0.7845602035522461
Epoch: 5, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.139 Vali Acc: 0.967 Test Loss: 0.139 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.708838701248169
Epoch: 6, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.122 Vali Acc: 0.973 Test Loss: 0.122 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 0.6432681083679199
Epoch: 7, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.115 Vali Acc: 0.980 Test Loss: 0.115 Test Acc: 0.980
Validation loss decreased (-0.973332 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 0.5821661949157715
Epoch: 8, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.109 Vali Acc: 0.980 Test Loss: 0.109 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 0.692441463470459
Epoch: 9, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 0.6307408809661865
Epoch: 10, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 0.7544362545013428
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 0.6753301620483398
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 0.6817450523376465
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 0.6881937980651855
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 0.7450084686279297
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 0.8266105651855469
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 0.683558464050293
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 0.7121474742889404
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 0.7301104068756104
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 0.7997655868530273
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 0.7377750873565674
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 0.7444040775299072
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 0.7179567813873291
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8082458972930908
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 0.6013097763061523
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 0.6362166404724121
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 0.5980615615844727
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 0.9411194324493408
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.755018949508667
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 0.7383122444152832
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 31 cost time: 0.6272239685058594
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 32 cost time: 0.8982057571411133
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 33 cost time: 0.7249047756195068
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 34 cost time: 0.7069625854492188
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 35 cost time: 0.8055956363677979
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 36 cost time: 0.8859734535217285
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 37 cost time: 0.6435511112213135
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 38 cost time: 0.6357307434082031
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 39 cost time: 0.7636735439300537
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 40 cost time: 0.782620906829834
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 41 cost time: 0.6845719814300537
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 42 cost time: 0.665963888168335
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 43 cost time: 0.6984989643096924
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 44 cost time: 0.7930524349212646
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.6428420543670654
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.7744247913360596
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.7751266956329346
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.8271183967590332
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.7159678936004639
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.5868346691131592
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 615321
model size : 2.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps22_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.9064958095550537
Epoch: 1, Steps: 18 | Train Loss: 3.038 Vali Loss: 2.673 Vali Acc: 0.530 Test Loss: 2.673 Test Acc: 0.530
Validation loss decreased (inf --> -0.529973).  Saving model ...
Epoch: 2 cost time: 0.8257453441619873
Epoch: 2, Steps: 18 | Train Loss: 1.833 Vali Loss: 1.313 Vali Acc: 0.937 Test Loss: 1.313 Test Acc: 0.937
Validation loss decreased (-0.529973 --> -0.936654).  Saving model ...
Epoch: 3 cost time: 0.8996305465698242
Epoch: 3, Steps: 18 | Train Loss: 0.619 Vali Loss: 0.454 Vali Acc: 0.967 Test Loss: 0.454 Test Acc: 0.967
Validation loss decreased (-0.936654 --> -0.966662).  Saving model ...
Epoch: 4 cost time: 0.6936118602752686
Epoch: 4, Steps: 18 | Train Loss: 0.161 Vali Loss: 0.227 Vali Acc: 0.967 Test Loss: 0.227 Test Acc: 0.967
Validation loss decreased (-0.966662 --> -0.966664).  Saving model ...
Epoch: 5 cost time: 0.6941826343536377
Epoch: 5, Steps: 18 | Train Loss: 0.047 Vali Loss: 0.154 Vali Acc: 0.977 Test Loss: 0.154 Test Acc: 0.977
Validation loss decreased (-0.966664 --> -0.976665).  Saving model ...
Epoch: 6 cost time: 0.6795587539672852
Epoch: 6, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.129 Vali Acc: 0.977 Test Loss: 0.129 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 7 cost time: 0.6406266689300537
Epoch: 7, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.126 Vali Acc: 0.970 Test Loss: 0.126 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6383953094482422
Epoch: 8, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.119 Vali Acc: 0.970 Test Loss: 0.119 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8768553733825684
Epoch: 9, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.116 Vali Acc: 0.967 Test Loss: 0.116 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.5787763595581055
Epoch: 10, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.7694830894470215
Epoch: 11, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.7977395057678223
Epoch: 12, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 0.782768964767456
Epoch: 13, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7833490371704102
Epoch: 14, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6945071220397949
Epoch: 15, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.6169910430908203
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.5742876529693604
Epoch: 17, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.7065713405609131
Epoch: 18, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.5550966262817383
Epoch: 19, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.5735564231872559
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.7520236968994141
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.6955876350402832
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps22_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 543769
model size : 2.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps29_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.8829164505004883
Epoch: 1, Steps: 18 | Train Loss: 3.125 Vali Loss: 2.829 Vali Acc: 0.340 Test Loss: 2.829 Test Acc: 0.340
Validation loss decreased (inf --> -0.339972).  Saving model ...
Epoch: 2 cost time: 0.737072229385376
Epoch: 2, Steps: 18 | Train Loss: 2.114 Vali Loss: 1.728 Vali Acc: 0.883 Test Loss: 1.728 Test Acc: 0.883
Validation loss decreased (-0.339972 --> -0.883316).  Saving model ...
Epoch: 3 cost time: 0.6064057350158691
Epoch: 3, Steps: 18 | Train Loss: 1.030 Vali Loss: 0.783 Vali Acc: 0.953 Test Loss: 0.783 Test Acc: 0.953
Validation loss decreased (-0.883316 --> -0.953326).  Saving model ...
Epoch: 4 cost time: 0.7592055797576904
Epoch: 4, Steps: 18 | Train Loss: 0.363 Vali Loss: 0.368 Vali Acc: 0.963 Test Loss: 0.368 Test Acc: 0.963
Validation loss decreased (-0.953326 --> -0.963330).  Saving model ...
Epoch: 5 cost time: 0.8050079345703125
Epoch: 5, Steps: 18 | Train Loss: 0.124 Vali Loss: 0.224 Vali Acc: 0.970 Test Loss: 0.224 Test Acc: 0.970
Validation loss decreased (-0.963330 --> -0.969998).  Saving model ...
Epoch: 6 cost time: 0.769118070602417
Epoch: 6, Steps: 18 | Train Loss: 0.054 Vali Loss: 0.183 Vali Acc: 0.967 Test Loss: 0.183 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0076797008514404
Epoch: 7, Steps: 18 | Train Loss: 0.032 Vali Loss: 0.164 Vali Acc: 0.970 Test Loss: 0.164 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 8 cost time: 0.7186503410339355
Epoch: 8, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.148 Vali Acc: 0.977 Test Loss: 0.148 Test Acc: 0.977
Validation loss decreased (-0.969998 --> -0.976665).  Saving model ...
Epoch: 9 cost time: 0.6360585689544678
Epoch: 9, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.135 Vali Acc: 0.973 Test Loss: 0.135 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5870962142944336
Epoch: 10, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.127 Vali Acc: 0.977 Test Loss: 0.127 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 11 cost time: 0.701995849609375
Epoch: 11, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.123 Vali Acc: 0.977 Test Loss: 0.123 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 12 cost time: 0.6173245906829834
Epoch: 12, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 13 cost time: 0.6796293258666992
Epoch: 13, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 0.6598701477050781
Epoch: 14, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 0.890310525894165
Epoch: 15, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 0.8245306015014648
Epoch: 16, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 0.7608788013458252
Epoch: 17, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 0.7295553684234619
Epoch: 18, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 0.7440328598022461
Epoch: 19, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 0.7221639156341553
Epoch: 20, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 0.6414272785186768
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 0.7085576057434082
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 0.7818574905395508
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 0.6247785091400146
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 0.8352453708648682
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 0.9298467636108398
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 0.8808941841125488
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 0.8329665660858154
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 0.8079898357391357
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 0.8252451419830322
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 31 cost time: 0.9965271949768066
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 32 cost time: 0.8618831634521484
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 33 cost time: 0.7986404895782471
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 34 cost time: 0.779834508895874
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 35 cost time: 0.7255020141601562
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.8346855640411377
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.9954965114593506
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.8207488059997559
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 39 cost time: 0.8486318588256836
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.6797037124633789
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 41 cost time: 0.6670241355895996
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 42 cost time: 0.7378816604614258
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 43 cost time: 0.662851095199585
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.6634879112243652
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.6858618259429932
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 46 cost time: 0.6379392147064209
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.8374679088592529
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.6681733131408691
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 49 cost time: 0.6896159648895264
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.7119450569152832
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps29_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 486617
model size : 1.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps36_str18_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.963998556137085
Epoch: 1, Steps: 18 | Train Loss: 3.090 Vali Loss: 2.815 Vali Acc: 0.347 Test Loss: 2.815 Test Acc: 0.347
Validation loss decreased (inf --> -0.346639).  Saving model ...
Epoch: 2 cost time: 0.7789466381072998
Epoch: 2, Steps: 18 | Train Loss: 2.203 Vali Loss: 1.767 Vali Acc: 0.897 Test Loss: 1.767 Test Acc: 0.897
Validation loss decreased (-0.346639 --> -0.896649).  Saving model ...
Epoch: 3 cost time: 0.8861138820648193
Epoch: 3, Steps: 18 | Train Loss: 1.134 Vali Loss: 0.836 Vali Acc: 0.950 Test Loss: 0.836 Test Acc: 0.950
Validation loss decreased (-0.896649 --> -0.949992).  Saving model ...
Epoch: 4 cost time: 0.6648952960968018
Epoch: 4, Steps: 18 | Train Loss: 0.430 Vali Loss: 0.382 Vali Acc: 0.970 Test Loss: 0.382 Test Acc: 0.970
Validation loss decreased (-0.949992 --> -0.969996).  Saving model ...
Epoch: 5 cost time: 0.84651780128479
Epoch: 5, Steps: 18 | Train Loss: 0.162 Vali Loss: 0.245 Vali Acc: 0.963 Test Loss: 0.245 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7212846279144287
Epoch: 6, Steps: 18 | Train Loss: 0.075 Vali Loss: 0.186 Vali Acc: 0.973 Test Loss: 0.186 Test Acc: 0.973
Validation loss decreased (-0.969996 --> -0.973331).  Saving model ...
Epoch: 7 cost time: 0.8210034370422363
Epoch: 7, Steps: 18 | Train Loss: 0.042 Vali Loss: 0.158 Vali Acc: 0.973 Test Loss: 0.158 Test Acc: 0.973
Validation loss decreased (-0.973331 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 0.8613040447235107
Epoch: 8, Steps: 18 | Train Loss: 0.031 Vali Loss: 0.146 Vali Acc: 0.973 Test Loss: 0.146 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 0.8148386478424072
Epoch: 9, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.133 Vali Acc: 0.977 Test Loss: 0.133 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 10 cost time: 0.840446949005127
Epoch: 10, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.126 Vali Acc: 0.977 Test Loss: 0.126 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 11 cost time: 0.9329419136047363
Epoch: 11, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.122 Vali Acc: 0.973 Test Loss: 0.122 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.749152421951294
Epoch: 12, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.117 Vali Acc: 0.973 Test Loss: 0.117 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8427221775054932
Epoch: 13, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 0.7008671760559082
Epoch: 14, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 0.9321613311767578
Epoch: 15, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 0.728801965713501
Epoch: 16, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9470632076263428
Epoch: 17, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 1.0098481178283691
Epoch: 18, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 1.0333616733551025
Epoch: 19, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 0.8157021999359131
Epoch: 20, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 0.7901666164398193
Epoch: 21, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 0.7522954940795898
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6455404758453369
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.6591277122497559
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.8527548313140869
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 0.6535236835479736
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 0.6743814945220947
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 28 cost time: 0.6750447750091553
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7519397735595703
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 30 cost time: 0.8249976634979248
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 31 cost time: 0.8103148937225342
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 32 cost time: 0.8338239192962646
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 33 cost time: 0.8164396286010742
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 34 cost time: 0.7185556888580322
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.7080972194671631
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.6337809562683105
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.7398295402526855
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 38 cost time: 0.7669293880462646
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 39 cost time: 0.805849552154541
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.8159410953521729
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.8614323139190674
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 42 cost time: 0.7002184391021729
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.8689045906066895
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.7737834453582764
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.6979892253875732
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 46 cost time: 0.7119526863098145
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.8075602054595947
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.8382482528686523
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.7520897388458252
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.8874087333679199
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps36_str18_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 472665
model size : 1.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.8749890327453613
Epoch: 1, Steps: 18 | Train Loss: 2.786 Vali Loss: 1.763 Vali Acc: 0.917 Test Loss: 1.763 Test Acc: 0.917
Validation loss decreased (inf --> -0.916649).  Saving model ...
Epoch: 2 cost time: 0.6196415424346924
Epoch: 2, Steps: 18 | Train Loss: 0.581 Vali Loss: 0.308 Vali Acc: 0.957 Test Loss: 0.308 Test Acc: 0.957
Validation loss decreased (-0.916649 --> -0.956664).  Saving model ...
Epoch: 3 cost time: 0.5865616798400879
Epoch: 3, Steps: 18 | Train Loss: 0.072 Vali Loss: 0.152 Vali Acc: 0.957 Test Loss: 0.152 Test Acc: 0.957
Validation loss decreased (-0.956664 --> -0.956665).  Saving model ...
Epoch: 4 cost time: 0.857419490814209
Epoch: 4, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.105 Vali Acc: 0.983 Test Loss: 0.105 Test Acc: 0.983
Validation loss decreased (-0.956665 --> -0.983332).  Saving model ...
Epoch: 5 cost time: 0.7597751617431641
Epoch: 5, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5973255634307861
Epoch: 6, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.6479055881500244
Epoch: 7, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.742379903793335
Epoch: 8, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.6172735691070557
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.6839909553527832
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.8136730194091797
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.8077538013458252
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.8005251884460449
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.8524646759033203
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 622393
model size : 2.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.9669549465179443
Epoch: 1, Steps: 18 | Train Loss: 2.980 Vali Loss: 2.419 Vali Acc: 0.730 Test Loss: 2.419 Test Acc: 0.730
Validation loss decreased (inf --> -0.729976).  Saving model ...
Epoch: 2 cost time: 0.9624912738800049
Epoch: 2, Steps: 18 | Train Loss: 1.400 Vali Loss: 0.859 Vali Acc: 0.943 Test Loss: 0.859 Test Acc: 0.943
Validation loss decreased (-0.729976 --> -0.943325).  Saving model ...
Epoch: 3 cost time: 0.8430027961730957
Epoch: 3, Steps: 18 | Train Loss: 0.312 Vali Loss: 0.272 Vali Acc: 0.963 Test Loss: 0.272 Test Acc: 0.963
Validation loss decreased (-0.943325 --> -0.963331).  Saving model ...
Epoch: 4 cost time: 0.5761785507202148
Epoch: 4, Steps: 18 | Train Loss: 0.061 Vali Loss: 0.166 Vali Acc: 0.967 Test Loss: 0.166 Test Acc: 0.967
Validation loss decreased (-0.963331 --> -0.966665).  Saving model ...
Epoch: 5 cost time: 0.735252857208252
Epoch: 5, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.132 Vali Acc: 0.973 Test Loss: 0.132 Test Acc: 0.973
Validation loss decreased (-0.966665 --> -0.973332).  Saving model ...
Epoch: 6 cost time: 0.7685954570770264
Epoch: 6, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 0.766895055770874
Epoch: 7, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 0.7094149589538574
Epoch: 8, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 0.7072651386260986
Epoch: 9, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 0.7911882400512695
Epoch: 10, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 0.7040221691131592
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 0.7725555896759033
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 0.7655065059661865
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5954015254974365
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.643200159072876
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.5937685966491699
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 0.5279693603515625
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 0.6200404167175293
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 0.5408155918121338
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 0.5751237869262695
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 0.966555118560791
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9279370307922363
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 0.7942063808441162
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 0.8227734565734863
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 1.0172374248504639
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7906947135925293
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 0.7327454090118408
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 0.7052755355834961
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 1.0002541542053223
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 0.7886242866516113
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 31 cost time: 0.7835187911987305
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 32 cost time: 0.9200584888458252
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 33 cost time: 0.6874992847442627
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.7187206745147705
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.6434144973754883
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 36 cost time: 0.8413577079772949
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 37 cost time: 0.8691227436065674
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 38 cost time: 0.7817096710205078
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 39 cost time: 0.8666946887969971
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 40 cost time: 0.7547092437744141
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.8492076396942139
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 42 cost time: 0.934884786605835
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.6570525169372559
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 44 cost time: 0.6190736293792725
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.671823263168335
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.6220617294311523
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 47 cost time: 0.6437573432922363
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 48 cost time: 0.7608835697174072
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 49 cost time: 0.7745568752288818
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 50 cost time: 0.6852920055389404
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 363321
model size : 1.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.8944954872131348
Epoch: 1, Steps: 18 | Train Loss: 3.086 Vali Loss: 2.722 Vali Acc: 0.460 Test Loss: 2.722 Test Acc: 0.460
Validation loss decreased (inf --> -0.459973).  Saving model ...
Epoch: 2 cost time: 0.6702640056610107
Epoch: 2, Steps: 18 | Train Loss: 1.897 Vali Loss: 1.436 Vali Acc: 0.930 Test Loss: 1.436 Test Acc: 0.930
Validation loss decreased (-0.459973 --> -0.929986).  Saving model ...
Epoch: 3 cost time: 0.669058084487915
Epoch: 3, Steps: 18 | Train Loss: 0.740 Vali Loss: 0.553 Vali Acc: 0.963 Test Loss: 0.553 Test Acc: 0.963
Validation loss decreased (-0.929986 --> -0.963328).  Saving model ...
Epoch: 4 cost time: 0.6592142581939697
Epoch: 4, Steps: 18 | Train Loss: 0.198 Vali Loss: 0.259 Vali Acc: 0.970 Test Loss: 0.259 Test Acc: 0.970
Validation loss decreased (-0.963328 --> -0.969997).  Saving model ...
Epoch: 5 cost time: 0.6814885139465332
Epoch: 5, Steps: 18 | Train Loss: 0.062 Vali Loss: 0.176 Vali Acc: 0.980 Test Loss: 0.176 Test Acc: 0.980
Validation loss decreased (-0.969997 --> -0.979998).  Saving model ...
Epoch: 6 cost time: 0.8194653987884521
Epoch: 6, Steps: 18 | Train Loss: 0.031 Vali Loss: 0.151 Vali Acc: 0.977 Test Loss: 0.151 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7550060749053955
Epoch: 7, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.134 Vali Acc: 0.980 Test Loss: 0.134 Test Acc: 0.980
Validation loss decreased (-0.979998 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 0.6573009490966797
Epoch: 8, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.125 Vali Acc: 0.980 Test Loss: 0.125 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 0.6974232196807861
Epoch: 9, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.121 Vali Acc: 0.980 Test Loss: 0.121 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 0.8231658935546875
Epoch: 10, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 0.7766196727752686
Epoch: 11, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.110 Vali Acc: 0.980 Test Loss: 0.110 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 0.8005707263946533
Epoch: 12, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 0.8208363056182861
Epoch: 13, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 0.8206539154052734
Epoch: 14, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 0.6834926605224609
Epoch: 15, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 0.6163568496704102
Epoch: 16, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 0.6299891471862793
Epoch: 17, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 0.5811471939086914
Epoch: 18, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 0.5581259727478027
Epoch: 19, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 0.6056411266326904
Epoch: 20, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 0.6607069969177246
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 0.6189546585083008
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 0.6888360977172852
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 0.6091344356536865
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 0.804053544998169
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 0.5758702754974365
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 0.5902953147888184
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 0.7831380367279053
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 0.730837345123291
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 0.6096103191375732
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 31 cost time: 0.6950323581695557
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 32 cost time: 0.9581067562103271
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.9331774711608887
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 34 cost time: 0.6171238422393799
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 35 cost time: 0.7416751384735107
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 36 cost time: 0.592059850692749
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 37 cost time: 0.7683238983154297
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 38 cost time: 0.6431021690368652
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.6143178939819336
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 40 cost time: 0.7615611553192139
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 41 cost time: 0.5893445014953613
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 42 cost time: 0.5851964950561523
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 43 cost time: 0.5257270336151123
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 44 cost time: 0.6656548976898193
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 45 cost time: 0.7419931888580322
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 46 cost time: 0.6846451759338379
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.6763560771942139
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.6204113960266113
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.6511545181274414
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.6961109638214111
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 277017
model size : 1.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.0476324558258057
Epoch: 1, Steps: 18 | Train Loss: 3.104 Vali Loss: 2.857 Vali Acc: 0.370 Test Loss: 2.857 Test Acc: 0.370
Validation loss decreased (inf --> -0.369971).  Saving model ...
Epoch: 2 cost time: 0.7485859394073486
Epoch: 2, Steps: 18 | Train Loss: 2.210 Vali Loss: 1.819 Vali Acc: 0.910 Test Loss: 1.819 Test Acc: 0.910
Validation loss decreased (-0.369971 --> -0.909982).  Saving model ...
Epoch: 3 cost time: 0.79490065574646
Epoch: 3, Steps: 18 | Train Loss: 1.096 Vali Loss: 0.847 Vali Acc: 0.967 Test Loss: 0.847 Test Acc: 0.967
Validation loss decreased (-0.909982 --> -0.966658).  Saving model ...
Epoch: 4 cost time: 0.7619402408599854
Epoch: 4, Steps: 18 | Train Loss: 0.391 Vali Loss: 0.380 Vali Acc: 0.967 Test Loss: 0.380 Test Acc: 0.967
Validation loss decreased (-0.966658 --> -0.966663).  Saving model ...
Epoch: 5 cost time: 0.650341272354126
Epoch: 5, Steps: 18 | Train Loss: 0.134 Vali Loss: 0.236 Vali Acc: 0.977 Test Loss: 0.236 Test Acc: 0.977
Validation loss decreased (-0.966663 --> -0.976664).  Saving model ...
Epoch: 6 cost time: 0.7662801742553711
Epoch: 6, Steps: 18 | Train Loss: 0.054 Vali Loss: 0.191 Vali Acc: 0.970 Test Loss: 0.191 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7100458145141602
Epoch: 7, Steps: 18 | Train Loss: 0.034 Vali Loss: 0.164 Vali Acc: 0.973 Test Loss: 0.164 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8578097820281982
Epoch: 8, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.150 Vali Acc: 0.973 Test Loss: 0.150 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.7910542488098145
Epoch: 9, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.141 Vali Acc: 0.973 Test Loss: 0.141 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.6514997482299805
Epoch: 10, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.134 Vali Acc: 0.977 Test Loss: 0.134 Test Acc: 0.977
Validation loss decreased (-0.976664 --> -0.976665).  Saving model ...
Epoch: 11 cost time: 0.5967304706573486
Epoch: 11, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.127 Vali Acc: 0.977 Test Loss: 0.127 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 12 cost time: 0.6742746829986572
Epoch: 12, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.123 Vali Acc: 0.977 Test Loss: 0.123 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 13 cost time: 0.6461219787597656
Epoch: 13, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.117 Vali Acc: 0.980 Test Loss: 0.117 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 0.7736682891845703
Epoch: 14, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.113 Vali Acc: 0.980 Test Loss: 0.113 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 0.6739230155944824
Epoch: 15, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.109 Vali Acc: 0.980 Test Loss: 0.109 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 0.6557066440582275
Epoch: 16, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6012165546417236
Epoch: 17, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7305481433868408
Epoch: 18, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.666154146194458
Epoch: 19, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.8379867076873779
Epoch: 20, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.7218437194824219
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.7251524925231934
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.6452972888946533
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.617274284362793
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.6822383403778076
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 233945
model size : 0.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps22_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.9922685623168945
Epoch: 1, Steps: 18 | Train Loss: 3.196 Vali Loss: 2.952 Vali Acc: 0.253 Test Loss: 2.952 Test Acc: 0.253
Validation loss decreased (inf --> -0.253304).  Saving model ...
Epoch: 2 cost time: 0.580866813659668
Epoch: 2, Steps: 18 | Train Loss: 2.478 Vali Loss: 2.107 Vali Acc: 0.837 Test Loss: 2.107 Test Acc: 0.837
Validation loss decreased (-0.253304 --> -0.836646).  Saving model ...
Epoch: 3 cost time: 0.5561201572418213
Epoch: 3, Steps: 18 | Train Loss: 1.532 Vali Loss: 1.204 Vali Acc: 0.937 Test Loss: 1.204 Test Acc: 0.937
Validation loss decreased (-0.836646 --> -0.936655).  Saving model ...
Epoch: 4 cost time: 0.5634253025054932
Epoch: 4, Steps: 18 | Train Loss: 0.740 Vali Loss: 0.603 Vali Acc: 0.953 Test Loss: 0.603 Test Acc: 0.953
Validation loss decreased (-0.936655 --> -0.953327).  Saving model ...
Epoch: 5 cost time: 0.553400993347168
Epoch: 5, Steps: 18 | Train Loss: 0.292 Vali Loss: 0.342 Vali Acc: 0.963 Test Loss: 0.342 Test Acc: 0.963
Validation loss decreased (-0.953327 --> -0.963330).  Saving model ...
Epoch: 6 cost time: 0.719656229019165
Epoch: 6, Steps: 18 | Train Loss: 0.126 Vali Loss: 0.232 Vali Acc: 0.970 Test Loss: 0.232 Test Acc: 0.970
Validation loss decreased (-0.963330 --> -0.969998).  Saving model ...
Epoch: 7 cost time: 0.707921028137207
Epoch: 7, Steps: 18 | Train Loss: 0.068 Vali Loss: 0.194 Vali Acc: 0.967 Test Loss: 0.194 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7047605514526367
Epoch: 8, Steps: 18 | Train Loss: 0.047 Vali Loss: 0.167 Vali Acc: 0.970 Test Loss: 0.167 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 9 cost time: 0.7669045925140381
Epoch: 9, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.155 Vali Acc: 0.967 Test Loss: 0.155 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.703338623046875
Epoch: 10, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.142 Vali Acc: 0.970 Test Loss: 0.142 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969999).  Saving model ...
Epoch: 11 cost time: 0.7409231662750244
Epoch: 11, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.133 Vali Acc: 0.970 Test Loss: 0.133 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 12 cost time: 0.8214640617370605
Epoch: 12, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.125 Vali Acc: 0.970 Test Loss: 0.125 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 13 cost time: 0.7643616199493408
Epoch: 13, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.118 Vali Acc: 0.970 Test Loss: 0.118 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 14 cost time: 0.626157283782959
Epoch: 14, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.116 Vali Acc: 0.970 Test Loss: 0.116 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 15 cost time: 0.6093306541442871
Epoch: 15, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.110 Vali Acc: 0.970 Test Loss: 0.110 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 16 cost time: 0.8184709548950195
Epoch: 16, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 17 cost time: 0.6880805492401123
Epoch: 17, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 18 cost time: 0.6968202590942383
Epoch: 18, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 19 cost time: 0.9074866771697998
Epoch: 19, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 20 cost time: 0.7489733695983887
Epoch: 20, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 21 cost time: 0.6346137523651123
Epoch: 21, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 22 cost time: 0.8725564479827881
Epoch: 22, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 23 cost time: 0.6558969020843506
Epoch: 23, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 24 cost time: 0.6754655838012695
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.970 Test Loss: 0.091 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 25 cost time: 0.6843807697296143
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.970 Test Loss: 0.091 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 26 cost time: 0.8034956455230713
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.970 Test Loss: 0.089 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 27 cost time: 0.6425085067749023
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.970 Test Loss: 0.089 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 28 cost time: 0.6643378734588623
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.970 Test Loss: 0.087 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 29 cost time: 0.6262950897216797
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.970 Test Loss: 0.087 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 30 cost time: 0.6553122997283936
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.970 Test Loss: 0.087 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 31 cost time: 0.8109591007232666
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.970 Test Loss: 0.086 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 32 cost time: 0.7320237159729004
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.970 Test Loss: 0.086 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 33 cost time: 0.6661362648010254
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.970 Test Loss: 0.086 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.5654881000518799
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.970 Test Loss: 0.086 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.5539321899414062
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.970 Test Loss: 0.085 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 36 cost time: 0.6396310329437256
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.970 Test Loss: 0.085 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 37 cost time: 0.6395320892333984
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.970 Test Loss: 0.084 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 38 cost time: 0.7100710868835449
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.970 Test Loss: 0.085 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.6654460430145264
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.970 Test Loss: 0.085 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.7436110973358154
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.970 Test Loss: 0.084 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 41 cost time: 0.7127377986907959
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.970 Test Loss: 0.084 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 42 cost time: 0.7621819972991943
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.970 Test Loss: 0.084 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.5936136245727539
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.970 Test Loss: 0.083 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 44 cost time: 0.6723966598510742
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.970 Test Loss: 0.083 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 45 cost time: 0.7652416229248047
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.970 Test Loss: 0.083 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.6750693321228027
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.970 Test Loss: 0.084 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.7936916351318359
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.970 Test Loss: 0.083 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 48 cost time: 0.7711043357849121
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.970 Test Loss: 0.083 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.6536076068878174
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.970 Test Loss: 0.084 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.651453971862793
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.970 Test Loss: 0.084 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps22_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.97
model parameter : 198169
model size : 0.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps29_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.890141248703003
Epoch: 1, Steps: 18 | Train Loss: 3.231 Vali Loss: 3.043 Vali Acc: 0.160 Test Loss: 3.043 Test Acc: 0.160
Validation loss decreased (inf --> -0.159970).  Saving model ...
Epoch: 2 cost time: 0.6084644794464111
Epoch: 2, Steps: 18 | Train Loss: 2.675 Vali Loss: 2.434 Vali Acc: 0.640 Test Loss: 2.434 Test Acc: 0.640
Validation loss decreased (-0.159970 --> -0.639976).  Saving model ...
Epoch: 3 cost time: 0.6986911296844482
Epoch: 3, Steps: 18 | Train Loss: 1.973 Vali Loss: 1.686 Vali Acc: 0.910 Test Loss: 1.686 Test Acc: 0.910
Validation loss decreased (-0.639976 --> -0.909983).  Saving model ...
Epoch: 4 cost time: 0.7273139953613281
Epoch: 4, Steps: 18 | Train Loss: 1.235 Vali Loss: 1.043 Vali Acc: 0.953 Test Loss: 1.043 Test Acc: 0.953
Validation loss decreased (-0.909983 --> -0.953323).  Saving model ...
Epoch: 5 cost time: 0.69832444190979
Epoch: 5, Steps: 18 | Train Loss: 0.638 Vali Loss: 0.614 Vali Acc: 0.960 Test Loss: 0.614 Test Acc: 0.960
Validation loss decreased (-0.953323 --> -0.959994).  Saving model ...
Epoch: 6 cost time: 0.6678392887115479
Epoch: 6, Steps: 18 | Train Loss: 0.325 Vali Loss: 0.390 Vali Acc: 0.963 Test Loss: 0.390 Test Acc: 0.963
Validation loss decreased (-0.959994 --> -0.963329).  Saving model ...
Epoch: 7 cost time: 0.8020319938659668
Epoch: 7, Steps: 18 | Train Loss: 0.166 Vali Loss: 0.286 Vali Acc: 0.973 Test Loss: 0.286 Test Acc: 0.973
Validation loss decreased (-0.963329 --> -0.973330).  Saving model ...
Epoch: 8 cost time: 0.6525740623474121
Epoch: 8, Steps: 18 | Train Loss: 0.100 Vali Loss: 0.232 Vali Acc: 0.977 Test Loss: 0.232 Test Acc: 0.977
Validation loss decreased (-0.973330 --> -0.976664).  Saving model ...
Epoch: 9 cost time: 0.5821893215179443
Epoch: 9, Steps: 18 | Train Loss: 0.069 Vali Loss: 0.199 Vali Acc: 0.973 Test Loss: 0.199 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6528942584991455
Epoch: 10, Steps: 18 | Train Loss: 0.053 Vali Loss: 0.181 Vali Acc: 0.977 Test Loss: 0.181 Test Acc: 0.977
Validation loss decreased (-0.976664 --> -0.976665).  Saving model ...
Epoch: 11 cost time: 0.5864276885986328
Epoch: 11, Steps: 18 | Train Loss: 0.037 Vali Loss: 0.164 Vali Acc: 0.977 Test Loss: 0.164 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 12 cost time: 0.7144341468811035
Epoch: 12, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.152 Vali Acc: 0.977 Test Loss: 0.152 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 13 cost time: 0.627314567565918
Epoch: 13, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.141 Vali Acc: 0.977 Test Loss: 0.141 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 14 cost time: 0.7196786403656006
Epoch: 14, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.134 Vali Acc: 0.977 Test Loss: 0.134 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 15 cost time: 0.6763384342193604
Epoch: 15, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.127 Vali Acc: 0.977 Test Loss: 0.127 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 16 cost time: 0.5931196212768555
Epoch: 16, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.125 Vali Acc: 0.977 Test Loss: 0.125 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 17 cost time: 0.6171813011169434
Epoch: 17, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.120 Vali Acc: 0.973 Test Loss: 0.120 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7220134735107422
Epoch: 18, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 0.6792056560516357
Epoch: 19, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 0.6697385311126709
Epoch: 20, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 0.5982811450958252
Epoch: 21, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.5258934497833252
Epoch: 22, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 0.6415061950683594
Epoch: 23, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.5359170436859131
Epoch: 24, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.7167701721191406
Epoch: 25, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.7588143348693848
Epoch: 26, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.6231451034545898
Epoch: 27, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 28 cost time: 0.591425895690918
Epoch: 28, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6804215908050537
Epoch: 29, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 0.6831941604614258
Epoch: 30, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.5757303237915039
Epoch: 31, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.6588935852050781
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.6760940551757812
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.5636131763458252
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.6611378192901611
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.7493922710418701
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.5702316761016846
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.6747448444366455
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.7494401931762695
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps29_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 169593
model size : 0.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps36_str18_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.8250930309295654
Epoch: 1, Steps: 18 | Train Loss: 3.212 Vali Loss: 3.071 Vali Acc: 0.150 Test Loss: 3.071 Test Acc: 0.150
Validation loss decreased (inf --> -0.149969).  Saving model ...
Epoch: 2 cost time: 0.5801374912261963
Epoch: 2, Steps: 18 | Train Loss: 2.724 Vali Loss: 2.528 Vali Acc: 0.533 Test Loss: 2.528 Test Acc: 0.533
Validation loss decreased (-0.149969 --> -0.533308).  Saving model ...
Epoch: 3 cost time: 0.7720518112182617
Epoch: 3, Steps: 18 | Train Loss: 2.041 Vali Loss: 1.836 Vali Acc: 0.827 Test Loss: 1.836 Test Acc: 0.827
Validation loss decreased (-0.533308 --> -0.826648).  Saving model ...
Epoch: 4 cost time: 0.6398215293884277
Epoch: 4, Steps: 18 | Train Loss: 1.345 Vali Loss: 1.183 Vali Acc: 0.953 Test Loss: 1.183 Test Acc: 0.953
Validation loss decreased (-0.826648 --> -0.953321).  Saving model ...
Epoch: 5 cost time: 0.6093471050262451
Epoch: 5, Steps: 18 | Train Loss: 0.782 Vali Loss: 0.714 Vali Acc: 0.960 Test Loss: 0.714 Test Acc: 0.960
Validation loss decreased (-0.953321 --> -0.959993).  Saving model ...
Epoch: 6 cost time: 0.5706007480621338
Epoch: 6, Steps: 18 | Train Loss: 0.387 Vali Loss: 0.444 Vali Acc: 0.967 Test Loss: 0.444 Test Acc: 0.967
Validation loss decreased (-0.959993 --> -0.966662).  Saving model ...
Epoch: 7 cost time: 0.5750038623809814
Epoch: 7, Steps: 18 | Train Loss: 0.209 Vali Loss: 0.321 Vali Acc: 0.967 Test Loss: 0.321 Test Acc: 0.967
Validation loss decreased (-0.966662 --> -0.966663).  Saving model ...
Epoch: 8 cost time: 0.6171224117279053
Epoch: 8, Steps: 18 | Train Loss: 0.124 Vali Loss: 0.255 Vali Acc: 0.967 Test Loss: 0.255 Test Acc: 0.967
Validation loss decreased (-0.966663 --> -0.966664).  Saving model ...
Epoch: 9 cost time: 0.5535154342651367
Epoch: 9, Steps: 18 | Train Loss: 0.081 Vali Loss: 0.218 Vali Acc: 0.970 Test Loss: 0.218 Test Acc: 0.970
Validation loss decreased (-0.966664 --> -0.969998).  Saving model ...
Epoch: 10 cost time: 0.556196928024292
Epoch: 10, Steps: 18 | Train Loss: 0.060 Vali Loss: 0.193 Vali Acc: 0.967 Test Loss: 0.193 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5818428993225098
Epoch: 11, Steps: 18 | Train Loss: 0.045 Vali Loss: 0.171 Vali Acc: 0.973 Test Loss: 0.171 Test Acc: 0.973
Validation loss decreased (-0.969998 --> -0.973332).  Saving model ...
Epoch: 12 cost time: 0.6032440662384033
Epoch: 12, Steps: 18 | Train Loss: 0.034 Vali Loss: 0.159 Vali Acc: 0.973 Test Loss: 0.159 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 13 cost time: 0.6193773746490479
Epoch: 13, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.147 Vali Acc: 0.973 Test Loss: 0.147 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 14 cost time: 0.643524169921875
Epoch: 14, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.137 Vali Acc: 0.973 Test Loss: 0.137 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 15 cost time: 0.6595351696014404
Epoch: 15, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.133 Vali Acc: 0.970 Test Loss: 0.133 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8115749359130859
Epoch: 16, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.125 Vali Acc: 0.970 Test Loss: 0.125 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.8644006252288818
Epoch: 17, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.120 Vali Acc: 0.970 Test Loss: 0.120 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.7983474731445312
Epoch: 18, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.115 Vali Acc: 0.970 Test Loss: 0.115 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.7700228691101074
Epoch: 19, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 20 cost time: 0.9417345523834229
Epoch: 20, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7181296348571777
Epoch: 21, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7163476943969727
Epoch: 22, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.852252721786499
Epoch: 23, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.8426704406738281
Epoch: 24, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.6072468757629395
Epoch: 25, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 26 cost time: 0.7957170009613037
Epoch: 26, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 27 cost time: 0.669457197189331
Epoch: 27, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 28 cost time: 0.7842526435852051
Epoch: 28, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.8550598621368408
Epoch: 29, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 30 cost time: 0.7602205276489258
Epoch: 30, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 31 cost time: 0.7538604736328125
Epoch: 31, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 32 cost time: 0.7514500617980957
Epoch: 32, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 33 cost time: 0.7354063987731934
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.7344369888305664
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 35 cost time: 0.7459611892700195
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 36 cost time: 0.792396068572998
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.7311630249023438
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.679980993270874
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.9237873554229736
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.695868968963623
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.8764622211456299
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.8562548160552979
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.670438289642334
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.6060540676116943
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.6943686008453369
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps36_str18_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9733333333333334
model parameter : 162617
model size : 0.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.3740580081939697
Epoch: 1, Steps: 18 | Train Loss: 3.044 Vali Loss: 2.717 Vali Acc: 0.823 Test Loss: 2.717 Test Acc: 0.823
Validation loss decreased (inf --> -0.823306).  Saving model ...
Epoch: 2 cost time: 1.2309298515319824
Epoch: 2, Steps: 18 | Train Loss: 1.572 Vali Loss: 0.831 Vali Acc: 0.947 Test Loss: 0.831 Test Acc: 0.947
Validation loss decreased (-0.823306 --> -0.946658).  Saving model ...
Epoch: 3 cost time: 1.0260577201843262
Epoch: 3, Steps: 18 | Train Loss: 0.224 Vali Loss: 0.169 Vali Acc: 0.967 Test Loss: 0.169 Test Acc: 0.967
Validation loss decreased (-0.946658 --> -0.966665).  Saving model ...
Epoch: 4 cost time: 1.094409704208374
Epoch: 4, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.120 Vali Acc: 0.970 Test Loss: 0.120 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969999).  Saving model ...
Epoch: 5 cost time: 1.129164218902588
Epoch: 5, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
Validation loss decreased (-0.969999 --> -0.976666).  Saving model ...
Epoch: 6 cost time: 1.1615471839904785
Epoch: 6, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 1.020031452178955
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 1.000293254852295
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1651902198791504
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.459409475326538
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.2677347660064697
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.3264188766479492
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.5082316398620605
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.264620065689087
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.407658338546753
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.0986199378967285
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 1.162919282913208
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 1.0459449291229248
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 1.2874584197998047
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3140530586242676
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.1887788772583008
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.2921981811523438
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.403913974761963
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.3546671867370605
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.3198297023773193
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.2793633937835693
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.3300011157989502
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.451993465423584
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 1443129
model size : 5.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.3294291496276855
Epoch: 1, Steps: 18 | Train Loss: 3.134 Vali Loss: 2.910 Vali Acc: 0.590 Test Loss: 2.910 Test Acc: 0.590
Validation loss decreased (inf --> -0.589971).  Saving model ...
Epoch: 2 cost time: 1.0388758182525635
Epoch: 2, Steps: 18 | Train Loss: 2.279 Vali Loss: 1.749 Vali Acc: 0.927 Test Loss: 1.749 Test Acc: 0.927
Validation loss decreased (-0.589971 --> -0.926649).  Saving model ...
Epoch: 3 cost time: 0.9307892322540283
Epoch: 3, Steps: 18 | Train Loss: 0.884 Vali Loss: 0.431 Vali Acc: 0.970 Test Loss: 0.431 Test Acc: 0.970
Validation loss decreased (-0.926649 --> -0.969996).  Saving model ...
Epoch: 4 cost time: 1.1433804035186768
Epoch: 4, Steps: 18 | Train Loss: 0.153 Vali Loss: 0.155 Vali Acc: 0.963 Test Loss: 0.155 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0817573070526123
Epoch: 5, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.120 Vali Acc: 0.973 Test Loss: 0.120 Test Acc: 0.973
Validation loss decreased (-0.969996 --> -0.973332).  Saving model ...
Epoch: 6 cost time: 1.0970566272735596
Epoch: 6, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 1.1614952087402344
Epoch: 7, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 8 cost time: 1.4128808975219727
Epoch: 8, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 1.221724033355713
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.313164234161377
Epoch: 10, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 1.0701134204864502
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 0.937241792678833
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 1.0185809135437012
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 0.9152395725250244
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 1.0634407997131348
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 1.0854220390319824
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.187957525253296
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.1929054260253906
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.0151054859161377
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 1.0559935569763184
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 1.011695146560669
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2451934814453125
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.179389476776123
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 1.118483543395996
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 1.2899525165557861
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 1.2497272491455078
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 1.08870530128479
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 1.1294631958007812
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9003555774688721
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.0423848628997803
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.9935979843139648
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.0622727870941162
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.157320499420166
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.3317532539367676
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.2961225509643555
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.2933833599090576
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.114595890045166
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 1184057
model size : 4.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.490943670272827
Epoch: 1, Steps: 18 | Train Loss: 3.192 Vali Loss: 3.058 Vali Acc: 0.323 Test Loss: 3.058 Test Acc: 0.323
Validation loss decreased (inf --> -0.323303).  Saving model ...
Epoch: 2 cost time: 1.1553943157196045
Epoch: 2, Steps: 18 | Train Loss: 2.641 Vali Loss: 2.351 Vali Acc: 0.843 Test Loss: 2.351 Test Acc: 0.843
Validation loss decreased (-0.323303 --> -0.843310).  Saving model ...
Epoch: 3 cost time: 1.2807683944702148
Epoch: 3, Steps: 18 | Train Loss: 1.593 Vali Loss: 1.063 Vali Acc: 0.923 Test Loss: 1.063 Test Acc: 0.923
Validation loss decreased (-0.843310 --> -0.923323).  Saving model ...
Epoch: 4 cost time: 1.4337048530578613
Epoch: 4, Steps: 18 | Train Loss: 0.494 Vali Loss: 0.281 Vali Acc: 0.970 Test Loss: 0.281 Test Acc: 0.970
Validation loss decreased (-0.923323 --> -0.969997).  Saving model ...
Epoch: 5 cost time: 1.0600612163543701
Epoch: 5, Steps: 18 | Train Loss: 0.098 Vali Loss: 0.148 Vali Acc: 0.967 Test Loss: 0.148 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0849738121032715
Epoch: 6, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
Validation loss decreased (-0.969997 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 1.2123332023620605
Epoch: 7, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 1.1388015747070312
Epoch: 8, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 1.250436544418335
Epoch: 9, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 1.2938694953918457
Epoch: 10, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 1.2376582622528076
Epoch: 11, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 12 cost time: 1.2556896209716797
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 13 cost time: 1.1149685382843018
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 14 cost time: 1.1522879600524902
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 15 cost time: 1.0425653457641602
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 16 cost time: 1.256080150604248
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 17 cost time: 1.2618417739868164
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 1.2380485534667969
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 1.3911268711090088
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.28399658203125
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.272761344909668
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.198124885559082
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 1.094245433807373
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 1.253143548965454
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 1.2838737964630127
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0527455806732178
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.2180066108703613
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.1146862506866455
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 1.1996307373046875
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 1.0526807308197021
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.1396698951721191
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.1855359077453613
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.169426441192627
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.2895305156707764
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.1509463787078857
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.1883790493011475
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.3038253784179688
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 38 cost time: 1.2315027713775635
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 39 cost time: 1.1865277290344238
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 40 cost time: 1.017627477645874
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 41 cost time: 1.234337568283081
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 42 cost time: 1.1947262287139893
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.0697550773620605
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 44 cost time: 1.261216402053833
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 45 cost time: 1.127103567123413
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 46 cost time: 1.2582266330718994
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 47 cost time: 1.314591407775879
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 48 cost time: 1.0437726974487305
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.0615103244781494
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.0553624629974365
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 1097753
model size : 4.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.226762294769287
Epoch: 1, Steps: 18 | Train Loss: 3.167 Vali Loss: 3.075 Vali Acc: 0.287 Test Loss: 3.075 Test Acc: 0.287
Validation loss decreased (inf --> -0.286636).  Saving model ...
Epoch: 2 cost time: 1.1940033435821533
Epoch: 2, Steps: 18 | Train Loss: 2.693 Vali Loss: 2.439 Vali Acc: 0.850 Test Loss: 2.439 Test Acc: 0.850
Validation loss decreased (-0.286636 --> -0.849976).  Saving model ...
Epoch: 3 cost time: 1.159834623336792
Epoch: 3, Steps: 18 | Train Loss: 1.748 Vali Loss: 1.283 Vali Acc: 0.940 Test Loss: 1.283 Test Acc: 0.940
Validation loss decreased (-0.849976 --> -0.939987).  Saving model ...
Epoch: 4 cost time: 1.1639609336853027
Epoch: 4, Steps: 18 | Train Loss: 0.669 Vali Loss: 0.392 Vali Acc: 0.963 Test Loss: 0.392 Test Acc: 0.963
Validation loss decreased (-0.939987 --> -0.963329).  Saving model ...
Epoch: 5 cost time: 1.1441400051116943
Epoch: 5, Steps: 18 | Train Loss: 0.160 Vali Loss: 0.190 Vali Acc: 0.963 Test Loss: 0.190 Test Acc: 0.963
Validation loss decreased (-0.963329 --> -0.963331).  Saving model ...
Epoch: 6 cost time: 1.1885299682617188
Epoch: 6, Steps: 18 | Train Loss: 0.044 Vali Loss: 0.137 Vali Acc: 0.973 Test Loss: 0.137 Test Acc: 0.973
Validation loss decreased (-0.963331 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 1.3316185474395752
Epoch: 7, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.130 Vali Acc: 0.967 Test Loss: 0.130 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2508370876312256
Epoch: 8, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 1.2000269889831543
Epoch: 9, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 1.185788631439209
Epoch: 10, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 1.1982405185699463
Epoch: 11, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 12 cost time: 1.2716329097747803
Epoch: 12, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 13 cost time: 1.2680613994598389
Epoch: 13, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 14 cost time: 1.2787213325500488
Epoch: 14, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 1.2422029972076416
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 1.1520776748657227
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 1.1411237716674805
Epoch: 17, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 1.3522834777832031
Epoch: 18, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 1.3071367740631104
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 1.4867992401123047
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.3793952465057373
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.3126134872436523
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.4182112216949463
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.3322110176086426
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.341243028640747
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 1.4652276039123535
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.4165799617767334
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 1.2553234100341797
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.2885963916778564
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 1.2986507415771484
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.0590622425079346
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.2153112888336182
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.155815601348877
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.9821102619171143
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.2460079193115234
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.1748178005218506
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.2576813697814941
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.3163578510284424
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.3463196754455566
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 1069081
model size : 4.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps22_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.60147762298584
Epoch: 1, Steps: 18 | Train Loss: 3.156 Vali Loss: 3.082 Vali Acc: 0.253 Test Loss: 3.082 Test Acc: 0.253
Validation loss decreased (inf --> -0.253303).  Saving model ...
Epoch: 2 cost time: 1.3962056636810303
Epoch: 2, Steps: 18 | Train Loss: 2.732 Vali Loss: 2.545 Vali Acc: 0.770 Test Loss: 2.545 Test Acc: 0.770
Validation loss decreased (-0.253303 --> -0.769975).  Saving model ...
Epoch: 3 cost time: 1.345191240310669
Epoch: 3, Steps: 18 | Train Loss: 2.000 Vali Loss: 1.608 Vali Acc: 0.920 Test Loss: 1.608 Test Acc: 0.920
Validation loss decreased (-0.769975 --> -0.919984).  Saving model ...
Epoch: 4 cost time: 1.2858858108520508
Epoch: 4, Steps: 18 | Train Loss: 1.003 Vali Loss: 0.620 Vali Acc: 0.963 Test Loss: 0.620 Test Acc: 0.963
Validation loss decreased (-0.919984 --> -0.963327).  Saving model ...
Epoch: 5 cost time: 1.124894380569458
Epoch: 5, Steps: 18 | Train Loss: 0.289 Vali Loss: 0.228 Vali Acc: 0.963 Test Loss: 0.228 Test Acc: 0.963
Validation loss decreased (-0.963327 --> -0.963331).  Saving model ...
Epoch: 6 cost time: 1.1168696880340576
Epoch: 6, Steps: 18 | Train Loss: 0.079 Vali Loss: 0.153 Vali Acc: 0.967 Test Loss: 0.153 Test Acc: 0.967
Validation loss decreased (-0.963331 --> -0.966665).  Saving model ...
Epoch: 7 cost time: 1.087867259979248
Epoch: 7, Steps: 18 | Train Loss: 0.034 Vali Loss: 0.125 Vali Acc: 0.973 Test Loss: 0.125 Test Acc: 0.973
Validation loss decreased (-0.966665 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 1.3421070575714111
Epoch: 8, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 1.2449085712432861
Epoch: 9, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.118 Vali Acc: 0.973 Test Loss: 0.118 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 1.2597296237945557
Epoch: 10, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 1.4431633949279785
Epoch: 11, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 12 cost time: 1.1900224685668945
Epoch: 12, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 13 cost time: 1.2839338779449463
Epoch: 13, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 14 cost time: 1.2979867458343506
Epoch: 14, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 15 cost time: 1.2471742630004883
Epoch: 15, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 16 cost time: 1.2981088161468506
Epoch: 16, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 17 cost time: 1.3434040546417236
Epoch: 17, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 18 cost time: 1.3549275398254395
Epoch: 18, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 19 cost time: 1.3881938457489014
Epoch: 19, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 20 cost time: 1.367039442062378
Epoch: 20, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 21 cost time: 1.2950539588928223
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 22 cost time: 1.2016558647155762
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 23 cost time: 1.2307441234588623
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.2131540775299072
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.2289793491363525
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.1604359149932861
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 27 cost time: 1.234616756439209
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.2644729614257812
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.3238615989685059
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 30 cost time: 1.305974006652832
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.2923738956451416
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 32 cost time: 1.2880432605743408
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.1736202239990234
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.2210092544555664
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.1746251583099365
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.174281120300293
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.2948977947235107
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.430940866470337
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.0751357078552246
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.9862711429595947
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.145961046218872
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps22_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9733333333333334
model parameter : 1040505
model size : 4.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps29_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.301304578781128
Epoch: 1, Steps: 18 | Train Loss: 3.197 Vali Loss: 3.111 Vali Acc: 0.173 Test Loss: 3.111 Test Acc: 0.173
Validation loss decreased (inf --> -0.173302).  Saving model ...
Epoch: 2 cost time: 1.1932432651519775
Epoch: 2, Steps: 18 | Train Loss: 2.879 Vali Loss: 2.705 Vali Acc: 0.693 Test Loss: 2.705 Test Acc: 0.693
Validation loss decreased (-0.173302 --> -0.693306).  Saving model ...
Epoch: 3 cost time: 1.2798781394958496
Epoch: 3, Steps: 18 | Train Loss: 2.277 Vali Loss: 1.997 Vali Acc: 0.910 Test Loss: 1.997 Test Acc: 0.910
Validation loss decreased (-0.693306 --> -0.909980).  Saving model ...
Epoch: 4 cost time: 1.2840726375579834
Epoch: 4, Steps: 18 | Train Loss: 1.417 Vali Loss: 1.051 Vali Acc: 0.943 Test Loss: 1.051 Test Acc: 0.943
Validation loss decreased (-0.909980 --> -0.943323).  Saving model ...
Epoch: 5 cost time: 1.4185466766357422
Epoch: 5, Steps: 18 | Train Loss: 0.581 Vali Loss: 0.394 Vali Acc: 0.963 Test Loss: 0.394 Test Acc: 0.963
Validation loss decreased (-0.943323 --> -0.963329).  Saving model ...
Epoch: 6 cost time: 1.3312833309173584
Epoch: 6, Steps: 18 | Train Loss: 0.187 Vali Loss: 0.225 Vali Acc: 0.967 Test Loss: 0.225 Test Acc: 0.967
Validation loss decreased (-0.963329 --> -0.966664).  Saving model ...
Epoch: 7 cost time: 1.3062562942504883
Epoch: 7, Steps: 18 | Train Loss: 0.073 Vali Loss: 0.168 Vali Acc: 0.963 Test Loss: 0.168 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3922526836395264
Epoch: 8, Steps: 18 | Train Loss: 0.043 Vali Loss: 0.143 Vali Acc: 0.970 Test Loss: 0.143 Test Acc: 0.970
Validation loss decreased (-0.966664 --> -0.969999).  Saving model ...
Epoch: 9 cost time: 1.340541124343872
Epoch: 9, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.126 Vali Acc: 0.970 Test Loss: 0.126 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 10 cost time: 1.2557635307312012
Epoch: 10, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.117 Vali Acc: 0.970 Test Loss: 0.117 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 11 cost time: 1.104989767074585
Epoch: 11, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.114 Vali Acc: 0.970 Test Loss: 0.114 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 12 cost time: 1.1297016143798828
Epoch: 12, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.114 Vali Acc: 0.970 Test Loss: 0.114 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3683292865753174
Epoch: 13, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 14 cost time: 1.2765600681304932
Epoch: 14, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 15 cost time: 1.2957241535186768
Epoch: 15, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 16 cost time: 1.4919612407684326
Epoch: 16, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 17 cost time: 1.3267178535461426
Epoch: 17, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 18 cost time: 1.3778929710388184
Epoch: 18, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 19 cost time: 1.4613327980041504
Epoch: 19, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2479476928710938
Epoch: 20, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.2958011627197266
Epoch: 21, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.244694471359253
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.182039737701416
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.390732765197754
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.3316123485565186
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.286546230316162
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.1953988075256348
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.1662240028381348
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps29_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9733333333333334
model parameter : 1011929
model size : 3.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps36_str18_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.3433799743652344
Epoch: 1, Steps: 18 | Train Loss: 3.211 Vali Loss: 3.168 Vali Acc: 0.083 Test Loss: 3.168 Test Acc: 0.083
Validation loss decreased (inf --> -0.083302).  Saving model ...
Epoch: 2 cost time: 1.279202938079834
Epoch: 2, Steps: 18 | Train Loss: 2.989 Vali Loss: 2.892 Vali Acc: 0.490 Test Loss: 2.892 Test Acc: 0.490
Validation loss decreased (-0.083302 --> -0.489971).  Saving model ...
Epoch: 3 cost time: 1.1209259033203125
Epoch: 3, Steps: 18 | Train Loss: 2.580 Vali Loss: 2.403 Vali Acc: 0.790 Test Loss: 2.403 Test Acc: 0.790
Validation loss decreased (-0.489971 --> -0.789976).  Saving model ...
Epoch: 4 cost time: 1.1726086139678955
Epoch: 4, Steps: 18 | Train Loss: 1.988 Vali Loss: 1.672 Vali Acc: 0.907 Test Loss: 1.672 Test Acc: 0.907
Validation loss decreased (-0.789976 --> -0.906650).  Saving model ...
Epoch: 5 cost time: 1.3725805282592773
Epoch: 5, Steps: 18 | Train Loss: 1.184 Vali Loss: 0.859 Vali Acc: 0.943 Test Loss: 0.859 Test Acc: 0.943
Validation loss decreased (-0.906650 --> -0.943325).  Saving model ...
Epoch: 6 cost time: 1.2692608833312988
Epoch: 6, Steps: 18 | Train Loss: 0.513 Vali Loss: 0.393 Vali Acc: 0.967 Test Loss: 0.393 Test Acc: 0.967
Validation loss decreased (-0.943325 --> -0.966663).  Saving model ...
Epoch: 7 cost time: 1.3264379501342773
Epoch: 7, Steps: 18 | Train Loss: 0.202 Vali Loss: 0.247 Vali Acc: 0.967 Test Loss: 0.247 Test Acc: 0.967
Validation loss decreased (-0.966663 --> -0.966664).  Saving model ...
Epoch: 8 cost time: 1.3494007587432861
Epoch: 8, Steps: 18 | Train Loss: 0.105 Vali Loss: 0.193 Vali Acc: 0.967 Test Loss: 0.193 Test Acc: 0.967
Validation loss decreased (-0.966664 --> -0.966665).  Saving model ...
Epoch: 9 cost time: 1.288827896118164
Epoch: 9, Steps: 18 | Train Loss: 0.062 Vali Loss: 0.162 Vali Acc: 0.977 Test Loss: 0.162 Test Acc: 0.977
Validation loss decreased (-0.966665 --> -0.976665).  Saving model ...
Epoch: 10 cost time: 1.209198236465454
Epoch: 10, Steps: 18 | Train Loss: 0.043 Vali Loss: 0.150 Vali Acc: 0.973 Test Loss: 0.150 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2226808071136475
Epoch: 11, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.132 Vali Acc: 0.980 Test Loss: 0.132 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 1.0122997760772705
Epoch: 12, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.120 Vali Acc: 0.980 Test Loss: 0.120 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 1.175814151763916
Epoch: 13, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 1.2896099090576172
Epoch: 14, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 1.3291621208190918
Epoch: 15, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 1.3615851402282715
Epoch: 16, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 1.3185055255889893
Epoch: 17, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 1.2730772495269775
Epoch: 18, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 1.1150479316711426
Epoch: 19, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 1.1438350677490234
Epoch: 20, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.053299903869629
Epoch: 21, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 1.0901098251342773
Epoch: 22, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 1.1801118850708008
Epoch: 23, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 1.2383308410644531
Epoch: 24, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 1.2094078063964844
Epoch: 25, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.3065602779388428
Epoch: 26, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 1.0926871299743652
Epoch: 27, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 1.1648311614990234
Epoch: 28, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 1.029757022857666
Epoch: 29, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.2640163898468018
Epoch: 30, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 31 cost time: 1.152782678604126
Epoch: 31, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.2400670051574707
Epoch: 32, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.4163403511047363
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.4329004287719727
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 35 cost time: 1.3296639919281006
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 36 cost time: 1.1668410301208496
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 37 cost time: 1.238997220993042
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 38 cost time: 1.4716370105743408
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 39 cost time: 1.1882648468017578
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.1365325450897217
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 41 cost time: 1.1611356735229492
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 42 cost time: 1.1498234272003174
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.2842073440551758
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.3105218410491943
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.19521164894104
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.983 Test Loss: 0.090 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 46 cost time: 1.0339643955230713
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.0724151134490967
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.983 Test Loss: 0.091 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.2645130157470703
Epoch: 48, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.2551207542419434
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 1.3077056407928467
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps36_str18_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 983353
model size : 3.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.560753345489502
Epoch: 1, Steps: 18 | Train Loss: 3.076 Vali Loss: 2.735 Vali Acc: 0.820 Test Loss: 2.735 Test Acc: 0.820
Validation loss decreased (inf --> -0.819973).  Saving model ...
Epoch: 2 cost time: 1.4318270683288574
Epoch: 2, Steps: 18 | Train Loss: 1.571 Vali Loss: 0.871 Vali Acc: 0.950 Test Loss: 0.871 Test Acc: 0.950
Validation loss decreased (-0.819973 --> -0.949991).  Saving model ...
Epoch: 3 cost time: 1.4931237697601318
Epoch: 3, Steps: 18 | Train Loss: 0.236 Vali Loss: 0.167 Vali Acc: 0.960 Test Loss: 0.167 Test Acc: 0.960
Validation loss decreased (-0.949991 --> -0.959998).  Saving model ...
Epoch: 4 cost time: 1.4242169857025146
Epoch: 4, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.132 Vali Acc: 0.970 Test Loss: 0.132 Test Acc: 0.970
Validation loss decreased (-0.959998 --> -0.969999).  Saving model ...
Epoch: 5 cost time: 1.472829818725586
Epoch: 5, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.125 Vali Acc: 0.970 Test Loss: 0.125 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 6 cost time: 1.3549444675445557
Epoch: 6, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 1.1142709255218506
Epoch: 7, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 1.178863525390625
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 1.1861045360565186
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 1.4703223705291748
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 1.352069616317749
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 12 cost time: 1.5120797157287598
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.360224962234497
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.3221769332885742
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 15 cost time: 1.368880033493042
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2523777484893799
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 17 cost time: 1.4271047115325928
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 18 cost time: 1.2577309608459473
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 1.3660054206848145
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 1.357738733291626
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 1.3931872844696045
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 1.387394905090332
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.3096344470977783
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 1.221191644668579
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.260312557220459
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.5226738452911377
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.5340452194213867
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.4637088775634766
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.352954387664795
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.494663953781128
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.3682770729064941
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.2959942817687988
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.364105463027954
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 1435065
model size : 5.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.2371461391448975
Epoch: 1, Steps: 18 | Train Loss: 3.117 Vali Loss: 2.925 Vali Acc: 0.580 Test Loss: 2.925 Test Acc: 0.580
Validation loss decreased (inf --> -0.579971).  Saving model ...
Epoch: 2 cost time: 1.210634708404541
Epoch: 2, Steps: 18 | Train Loss: 2.284 Vali Loss: 1.760 Vali Acc: 0.930 Test Loss: 1.760 Test Acc: 0.930
Validation loss decreased (-0.579971 --> -0.929982).  Saving model ...
Epoch: 3 cost time: 0.9872381687164307
Epoch: 3, Steps: 18 | Train Loss: 0.905 Vali Loss: 0.447 Vali Acc: 0.963 Test Loss: 0.447 Test Acc: 0.963
Validation loss decreased (-0.929982 --> -0.963329).  Saving model ...
Epoch: 4 cost time: 1.352085828781128
Epoch: 4, Steps: 18 | Train Loss: 0.169 Vali Loss: 0.157 Vali Acc: 0.967 Test Loss: 0.157 Test Acc: 0.967
Validation loss decreased (-0.963329 --> -0.966665).  Saving model ...
Epoch: 5 cost time: 1.3931117057800293
Epoch: 5, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
Validation loss decreased (-0.966665 --> -0.976665).  Saving model ...
Epoch: 6 cost time: 1.3326013088226318
Epoch: 6, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3311035633087158
Epoch: 7, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.4860827922821045
Epoch: 8, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.3637588024139404
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 1.452277421951294
Epoch: 10, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2823553085327148
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.3583638668060303
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 1.317960500717163
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.305990219116211
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 1.4194254875183105
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 1.2090530395507812
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 1.3760454654693604
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 1.1338911056518555
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 1.2436881065368652
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 0.9108376502990723
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 1.441695213317871
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.4605653285980225
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.443495512008667
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.4541864395141602
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.3049285411834717
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 1.471327543258667
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.3640058040618896
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 28 cost time: 1.3374621868133545
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.4357779026031494
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.382856845855713
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.3787720203399658
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.3795597553253174
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.3438894748687744
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.459641456604004
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.1539857387542725
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.9252169132232666
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.264826774597168
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 1175993
model size : 4.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.666853666305542
Epoch: 1, Steps: 18 | Train Loss: 3.186 Vali Loss: 3.064 Vali Acc: 0.287 Test Loss: 3.064 Test Acc: 0.287
Validation loss decreased (inf --> -0.286636).  Saving model ...
Epoch: 2 cost time: 1.5388851165771484
Epoch: 2, Steps: 18 | Train Loss: 2.639 Vali Loss: 2.355 Vali Acc: 0.877 Test Loss: 2.355 Test Acc: 0.877
Validation loss decreased (-0.286636 --> -0.876643).  Saving model ...
Epoch: 3 cost time: 1.5064623355865479
Epoch: 3, Steps: 18 | Train Loss: 1.590 Vali Loss: 1.071 Vali Acc: 0.953 Test Loss: 1.071 Test Acc: 0.953
Validation loss decreased (-0.876643 --> -0.953323).  Saving model ...
Epoch: 4 cost time: 1.467695951461792
Epoch: 4, Steps: 18 | Train Loss: 0.515 Vali Loss: 0.294 Vali Acc: 0.967 Test Loss: 0.294 Test Acc: 0.967
Validation loss decreased (-0.953323 --> -0.966664).  Saving model ...
Epoch: 5 cost time: 1.5479097366333008
Epoch: 5, Steps: 18 | Train Loss: 0.107 Vali Loss: 0.159 Vali Acc: 0.967 Test Loss: 0.159 Test Acc: 0.967
Validation loss decreased (-0.966664 --> -0.966665).  Saving model ...
Epoch: 6 cost time: 1.4544880390167236
Epoch: 6, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.130 Vali Acc: 0.973 Test Loss: 0.130 Test Acc: 0.973
Validation loss decreased (-0.966665 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 1.452165126800537
Epoch: 7, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 1.5305535793304443
Epoch: 8, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 1.4535901546478271
Epoch: 9, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 1.4535813331604004
Epoch: 10, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 1.39754056930542
Epoch: 11, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 1.2767443656921387
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 1.0584595203399658
Epoch: 13, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 0.9933211803436279
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 1.0299837589263916
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 1.2119112014770508
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 1.3547799587249756
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 1.5061264038085938
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 1.4749219417572021
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.5774338245391846
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 1.4522461891174316
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.4956812858581543
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.5354206562042236
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 1.418302059173584
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 1.468360424041748
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.4013006687164307
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 1.2203140258789062
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.331383228302002
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.265965223312378
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.2427983283996582
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.265005350112915
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.1992840766906738
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.0668745040893555
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.4043946266174316
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.370607852935791
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 36 cost time: 1.511026382446289
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 37 cost time: 1.4281113147735596
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 38 cost time: 1.5560650825500488
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.4484055042266846
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.2619526386260986
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.307751178741455
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.186063289642334
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 43 cost time: 1.2993757724761963
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.2754380702972412
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.2401564121246338
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.388338565826416
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 47 cost time: 1.2849795818328857
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.4263718128204346
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.1991395950317383
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.20591139793396
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 1089689
model size : 4.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.5857481956481934
Epoch: 1, Steps: 18 | Train Loss: 3.202 Vali Loss: 3.074 Vali Acc: 0.287 Test Loss: 3.074 Test Acc: 0.287
Validation loss decreased (inf --> -0.286636).  Saving model ...
Epoch: 2 cost time: 1.4238827228546143
Epoch: 2, Steps: 18 | Train Loss: 2.697 Vali Loss: 2.451 Vali Acc: 0.843 Test Loss: 2.451 Test Acc: 0.843
Validation loss decreased (-0.286636 --> -0.843309).  Saving model ...
Epoch: 3 cost time: 1.378669023513794
Epoch: 3, Steps: 18 | Train Loss: 1.781 Vali Loss: 1.300 Vali Acc: 0.950 Test Loss: 1.300 Test Acc: 0.950
Validation loss decreased (-0.843309 --> -0.949987).  Saving model ...
Epoch: 4 cost time: 1.3960061073303223
Epoch: 4, Steps: 18 | Train Loss: 0.660 Vali Loss: 0.375 Vali Acc: 0.970 Test Loss: 0.375 Test Acc: 0.970
Validation loss decreased (-0.949987 --> -0.969996).  Saving model ...
Epoch: 5 cost time: 1.4246256351470947
Epoch: 5, Steps: 18 | Train Loss: 0.148 Vali Loss: 0.169 Vali Acc: 0.967 Test Loss: 0.169 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4131383895874023
Epoch: 6, Steps: 18 | Train Loss: 0.044 Vali Loss: 0.133 Vali Acc: 0.977 Test Loss: 0.133 Test Acc: 0.977
Validation loss decreased (-0.969996 --> -0.976665).  Saving model ...
Epoch: 7 cost time: 1.5474560260772705
Epoch: 7, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.117 Vali Acc: 0.980 Test Loss: 0.117 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 1.3936967849731445
Epoch: 8, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 1.3699452877044678
Epoch: 9, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 1.3760738372802734
Epoch: 10, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 1.3359930515289307
Epoch: 11, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 1.4116382598876953
Epoch: 12, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 1.0099682807922363
Epoch: 13, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 1.0397794246673584
Epoch: 14, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 1.1581542491912842
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 1.1210603713989258
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 1.3780975341796875
Epoch: 17, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 1.214170217514038
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.265801191329956
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.3663828372955322
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 1.3522663116455078
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.5489110946655273
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 1.4075238704681396
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 1.374366044998169
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.3499162197113037
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.349086046218872
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 1.3337035179138184
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 1.3928332328796387
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.499502182006836
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 1.423067331314087
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.302912950515747
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.135120153427124
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.0554144382476807
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.073824167251587
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.3090193271636963
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.3656587600708008
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.3121538162231445
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.4507243633270264
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.5774755477905273
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 1061017
model size : 4.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps22_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.5009937286376953
Epoch: 1, Steps: 18 | Train Loss: 3.182 Vali Loss: 3.101 Vali Acc: 0.177 Test Loss: 3.101 Test Acc: 0.177
Validation loss decreased (inf --> -0.176636).  Saving model ...
Epoch: 2 cost time: 1.2514190673828125
Epoch: 2, Steps: 18 | Train Loss: 2.772 Vali Loss: 2.585 Vali Acc: 0.797 Test Loss: 2.585 Test Acc: 0.797
Validation loss decreased (-0.176636 --> -0.796641).  Saving model ...
Epoch: 3 cost time: 1.233206033706665
Epoch: 3, Steps: 18 | Train Loss: 2.026 Vali Loss: 1.647 Vali Acc: 0.917 Test Loss: 1.647 Test Acc: 0.917
Validation loss decreased (-0.796641 --> -0.916650).  Saving model ...
Epoch: 4 cost time: 1.431201696395874
Epoch: 4, Steps: 18 | Train Loss: 1.002 Vali Loss: 0.623 Vali Acc: 0.953 Test Loss: 0.623 Test Acc: 0.953
Validation loss decreased (-0.916650 --> -0.953327).  Saving model ...
Epoch: 5 cost time: 1.4169070720672607
Epoch: 5, Steps: 18 | Train Loss: 0.294 Vali Loss: 0.229 Vali Acc: 0.967 Test Loss: 0.229 Test Acc: 0.967
Validation loss decreased (-0.953327 --> -0.966664).  Saving model ...
Epoch: 6 cost time: 1.2133636474609375
Epoch: 6, Steps: 18 | Train Loss: 0.081 Vali Loss: 0.152 Vali Acc: 0.970 Test Loss: 0.152 Test Acc: 0.970
Validation loss decreased (-0.966664 --> -0.969998).  Saving model ...
Epoch: 7 cost time: 1.05289888381958
Epoch: 7, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.127 Vali Acc: 0.970 Test Loss: 0.127 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969999).  Saving model ...
Epoch: 8 cost time: 1.057058572769165
Epoch: 8, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.117 Vali Acc: 0.973 Test Loss: 0.117 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 1.2324860095977783
Epoch: 9, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 1.1817264556884766
Epoch: 10, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 1.3892168998718262
Epoch: 11, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 12 cost time: 1.4588463306427002
Epoch: 12, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 13 cost time: 1.422877550125122
Epoch: 13, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 14 cost time: 1.4081640243530273
Epoch: 14, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 15 cost time: 1.3453001976013184
Epoch: 15, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 16 cost time: 1.3790283203125
Epoch: 16, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 17 cost time: 1.4021036624908447
Epoch: 17, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 18 cost time: 1.4281320571899414
Epoch: 18, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 19 cost time: 1.5140900611877441
Epoch: 19, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 20 cost time: 1.3904838562011719
Epoch: 20, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 21 cost time: 1.5128896236419678
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.457866907119751
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 23 cost time: 1.434661626815796
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 24 cost time: 1.1625275611877441
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 25 cost time: 1.0960183143615723
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.077409267425537
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 27 cost time: 1.2939209938049316
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.2989733219146729
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 29 cost time: 1.3287463188171387
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.3784027099609375
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.2812600135803223
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 32 cost time: 1.3937644958496094
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.4836974143981934
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 34 cost time: 1.3910319805145264
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 35 cost time: 1.4385206699371338
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.3056654930114746
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.3625974655151367
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.4668619632720947
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973333).  Saving model ...
Epoch: 39 cost time: 1.4170355796813965
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
Validation loss decreased (-0.973333 --> -0.973333).  Saving model ...
Epoch: 40 cost time: 1.4097719192504883
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.0410585403442383
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.0371747016906738
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.1574106216430664
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.2417488098144531
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.2573812007904053
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.3933522701263428
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.5277762413024902
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 1.3984787464141846
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 1.49839186668396
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
Validation loss decreased (-0.973333 --> -0.973333).  Saving model ...
Epoch: 50 cost time: 1.350719690322876
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
Validation loss decreased (-0.973333 --> -0.973333).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps22_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9733333333333334
model parameter : 1032441
model size : 4.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps29_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.7984426021575928
Epoch: 1, Steps: 18 | Train Loss: 3.206 Vali Loss: 3.106 Vali Acc: 0.167 Test Loss: 3.106 Test Acc: 0.167
Validation loss decreased (inf --> -0.166636).  Saving model ...
Epoch: 2 cost time: 1.2803301811218262
Epoch: 2, Steps: 18 | Train Loss: 2.841 Vali Loss: 2.685 Vali Acc: 0.653 Test Loss: 2.685 Test Acc: 0.653
Validation loss decreased (-0.166636 --> -0.653306).  Saving model ...
Epoch: 3 cost time: 1.2366983890533447
Epoch: 3, Steps: 18 | Train Loss: 2.263 Vali Loss: 1.950 Vali Acc: 0.890 Test Loss: 1.950 Test Acc: 0.890
Validation loss decreased (-0.653306 --> -0.889980).  Saving model ...
Epoch: 4 cost time: 1.1423349380493164
Epoch: 4, Steps: 18 | Train Loss: 1.375 Vali Loss: 1.002 Vali Acc: 0.937 Test Loss: 1.002 Test Acc: 0.937
Validation loss decreased (-0.889980 --> -0.936657).  Saving model ...
Epoch: 5 cost time: 0.8738958835601807
Epoch: 5, Steps: 18 | Train Loss: 0.566 Vali Loss: 0.392 Vali Acc: 0.963 Test Loss: 0.392 Test Acc: 0.963
Validation loss decreased (-0.936657 --> -0.963329).  Saving model ...
Epoch: 6 cost time: 1.0276355743408203
Epoch: 6, Steps: 18 | Train Loss: 0.175 Vali Loss: 0.227 Vali Acc: 0.967 Test Loss: 0.227 Test Acc: 0.967
Validation loss decreased (-0.963329 --> -0.966664).  Saving model ...
Epoch: 7 cost time: 1.323519229888916
Epoch: 7, Steps: 18 | Train Loss: 0.079 Vali Loss: 0.164 Vali Acc: 0.970 Test Loss: 0.164 Test Acc: 0.970
Validation loss decreased (-0.966664 --> -0.969998).  Saving model ...
Epoch: 8 cost time: 1.3047378063201904
Epoch: 8, Steps: 18 | Train Loss: 0.040 Vali Loss: 0.148 Vali Acc: 0.970 Test Loss: 0.148 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969999).  Saving model ...
Epoch: 9 cost time: 1.3748023509979248
Epoch: 9, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.129 Vali Acc: 0.973 Test Loss: 0.129 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 1.1714658737182617
Epoch: 10, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.119 Vali Acc: 0.970 Test Loss: 0.119 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.252471923828125
Epoch: 11, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2741758823394775
Epoch: 12, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.2696607112884521
Epoch: 13, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.2736473083496094
Epoch: 14, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.3211770057678223
Epoch: 15, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.3541669845581055
Epoch: 16, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.3276817798614502
Epoch: 17, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.3135673999786377
Epoch: 18, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.4096813201904297
Epoch: 19, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps29_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9733333333333334
model parameter : 1003865
model size : 3.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps36_str18_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.303999900817871
Epoch: 1, Steps: 18 | Train Loss: 3.214 Vali Loss: 3.145 Vali Acc: 0.137 Test Loss: 3.145 Test Acc: 0.137
Validation loss decreased (inf --> -0.136635).  Saving model ...
Epoch: 2 cost time: 1.2250635623931885
Epoch: 2, Steps: 18 | Train Loss: 2.965 Vali Loss: 2.851 Vali Acc: 0.547 Test Loss: 2.851 Test Acc: 0.547
Validation loss decreased (-0.136635 --> -0.546638).  Saving model ...
Epoch: 3 cost time: 1.3823425769805908
Epoch: 3, Steps: 18 | Train Loss: 2.569 Vali Loss: 2.333 Vali Acc: 0.823 Test Loss: 2.333 Test Acc: 0.823
Validation loss decreased (-0.546638 --> -0.823310).  Saving model ...
Epoch: 4 cost time: 1.301856517791748
Epoch: 4, Steps: 18 | Train Loss: 1.930 Vali Loss: 1.599 Vali Acc: 0.923 Test Loss: 1.599 Test Acc: 0.923
Validation loss decreased (-0.823310 --> -0.923317).  Saving model ...
Epoch: 5 cost time: 1.1874053478240967
Epoch: 5, Steps: 18 | Train Loss: 1.133 Vali Loss: 0.832 Vali Acc: 0.943 Test Loss: 0.832 Test Acc: 0.943
Validation loss decreased (-0.923317 --> -0.943325).  Saving model ...
Epoch: 6 cost time: 1.26377534866333
Epoch: 6, Steps: 18 | Train Loss: 0.492 Vali Loss: 0.386 Vali Acc: 0.963 Test Loss: 0.386 Test Acc: 0.963
Validation loss decreased (-0.943325 --> -0.963329).  Saving model ...
Epoch: 7 cost time: 1.1734223365783691
Epoch: 7, Steps: 18 | Train Loss: 0.197 Vali Loss: 0.238 Vali Acc: 0.977 Test Loss: 0.238 Test Acc: 0.977
Validation loss decreased (-0.963329 --> -0.976664).  Saving model ...
Epoch: 8 cost time: 1.2794935703277588
Epoch: 8, Steps: 18 | Train Loss: 0.102 Vali Loss: 0.187 Vali Acc: 0.973 Test Loss: 0.187 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4260265827178955
Epoch: 9, Steps: 18 | Train Loss: 0.057 Vali Loss: 0.162 Vali Acc: 0.973 Test Loss: 0.162 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.3847253322601318
Epoch: 10, Steps: 18 | Train Loss: 0.036 Vali Loss: 0.144 Vali Acc: 0.980 Test Loss: 0.144 Test Acc: 0.980
Validation loss decreased (-0.976664 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 1.4068021774291992
Epoch: 11, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.132 Vali Acc: 0.980 Test Loss: 0.132 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 1.2708048820495605
Epoch: 12, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.125 Vali Acc: 0.980 Test Loss: 0.125 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 1.3266689777374268
Epoch: 13, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.118 Vali Acc: 0.980 Test Loss: 0.118 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 1.3285293579101562
Epoch: 14, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.117 Vali Acc: 0.980 Test Loss: 0.117 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 1.3653507232666016
Epoch: 15, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.110 Vali Acc: 0.980 Test Loss: 0.110 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 1.1741454601287842
Epoch: 16, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 1.0055842399597168
Epoch: 17, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 1.0309123992919922
Epoch: 18, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 1.2306609153747559
Epoch: 19, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 1.2018418312072754
Epoch: 20, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 1.1628086566925049
Epoch: 21, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.292952299118042
Epoch: 22, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 1.3503410816192627
Epoch: 23, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 1.323392391204834
Epoch: 24, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.983 Test Loss: 0.096 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 25 cost time: 1.239438772201538
Epoch: 25, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.983 Test Loss: 0.096 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 26 cost time: 1.1608741283416748
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.983 Test Loss: 0.095 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 27 cost time: 1.1803600788116455
Epoch: 27, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.983 Test Loss: 0.094 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 28 cost time: 1.2720046043395996
Epoch: 28, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.983 Test Loss: 0.094 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 29 cost time: 1.2460317611694336
Epoch: 29, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.983 Test Loss: 0.094 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 30 cost time: 1.310042142868042
Epoch: 30, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.983 Test Loss: 0.094 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.3454515933990479
Epoch: 31, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.983 Test Loss: 0.094 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.407240629196167
Epoch: 32, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.0028505325317383
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.1628806591033936
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.983 Test Loss: 0.093 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 35 cost time: 1.0856883525848389
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.983 Test Loss: 0.092 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 36 cost time: 1.2661409378051758
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.983 Test Loss: 0.092 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 37 cost time: 1.3814985752105713
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.983 Test Loss: 0.092 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.3298745155334473
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.983 Test Loss: 0.092 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 39 cost time: 1.2722620964050293
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.983 Test Loss: 0.093 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.2395179271697998
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.983 Test Loss: 0.094 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.1870875358581543
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.983 Test Loss: 0.093 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.297081708908081
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.983 Test Loss: 0.093 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.2651441097259521
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.983 Test Loss: 0.093 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.2292132377624512
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.983 Test Loss: 0.093 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.2312355041503906
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.983 Test Loss: 0.093 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.3085548877716064
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.983 Test Loss: 0.093 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 1.2887096405029297
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.983 Test Loss: 0.092 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 1.245162010192871
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.983 Test Loss: 0.092 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps36_str18_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 975289
model size : 3.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.151801109313965
Epoch: 1, Steps: 18 | Train Loss: 2.396 Vali Loss: 0.860 Vali Acc: 0.920 Test Loss: 0.860 Test Acc: 0.920
Validation loss decreased (inf --> -0.919991).  Saving model ...
Epoch: 2 cost time: 2.0360910892486572
Epoch: 2, Steps: 18 | Train Loss: 0.137 Vali Loss: 0.178 Vali Acc: 0.947 Test Loss: 0.178 Test Acc: 0.947
Validation loss decreased (-0.919991 --> -0.946665).  Saving model ...
Epoch: 3 cost time: 2.237387180328369
Epoch: 3, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.151 Vali Acc: 0.963 Test Loss: 0.151 Test Acc: 0.963
Validation loss decreased (-0.946665 --> -0.963332).  Saving model ...
Epoch: 4 cost time: 2.0438122749328613
Epoch: 4, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.176 Vali Acc: 0.963 Test Loss: 0.176 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.163393020629883
Epoch: 5, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.953 Test Loss: 0.202 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.02765154838562
Epoch: 6, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.248 Vali Acc: 0.937 Test Loss: 0.248 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.171128749847412
Epoch: 7, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.227 Vali Acc: 0.943 Test Loss: 0.227 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.8694612979888916
Epoch: 8, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.215 Vali Acc: 0.937 Test Loss: 0.215 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.062913656234741
Epoch: 9, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.388 Vali Acc: 0.930 Test Loss: 0.388 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.872511625289917
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.960 Test Loss: 0.198 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.2033302783966064
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.963 Test Loss: 0.190 Test Acc: 0.963
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.0579285621643066
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.960 Test Loss: 0.192 Test Acc: 0.960
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.0517611503601074
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.963 Test Loss: 0.185 Test Acc: 0.963
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9633333333333334
model parameter : 5311641
model size : 20.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.520916223526001
Epoch: 1, Steps: 18 | Train Loss: 2.708 Vali Loss: 1.751 Vali Acc: 0.930 Test Loss: 1.751 Test Acc: 0.930
Validation loss decreased (inf --> -0.929982).  Saving model ...
Epoch: 2 cost time: 1.664783000946045
Epoch: 2, Steps: 18 | Train Loss: 0.452 Vali Loss: 0.229 Vali Acc: 0.927 Test Loss: 0.229 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5547022819519043
Epoch: 3, Steps: 18 | Train Loss: 0.043 Vali Loss: 0.225 Vali Acc: 0.937 Test Loss: 0.225 Test Acc: 0.937
Validation loss decreased (-0.929982 --> -0.936664).  Saving model ...
Epoch: 4 cost time: 1.703944444656372
Epoch: 4, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.139 Vali Acc: 0.967 Test Loss: 0.139 Test Acc: 0.967
Validation loss decreased (-0.936664 --> -0.966665).  Saving model ...
Epoch: 5 cost time: 1.5399582386016846
Epoch: 5, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.138 Vali Acc: 0.960 Test Loss: 0.138 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5169928073883057
Epoch: 6, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
Validation loss decreased (-0.966665 --> -0.976666).  Saving model ...
Epoch: 7 cost time: 1.508836030960083
Epoch: 7, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.110 Vali Acc: 0.980 Test Loss: 0.110 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 1.5738773345947266
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.673699140548706
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.5674309730529785
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.6783151626586914
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.970 Test Loss: 0.111 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.5287480354309082
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.970 Test Loss: 0.111 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.5228571891784668
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.3848185539245605
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.3391427993774414
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.5972867012023926
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.65132737159729
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 4275353
model size : 16.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.8037893772125244
Epoch: 1, Steps: 18 | Train Loss: 2.897 Vali Loss: 2.284 Vali Acc: 0.880 Test Loss: 2.284 Test Acc: 0.880
Validation loss decreased (inf --> -0.879977).  Saving model ...
Epoch: 2 cost time: 1.692704677581787
Epoch: 2, Steps: 18 | Train Loss: 0.892 Vali Loss: 0.341 Vali Acc: 0.937 Test Loss: 0.341 Test Acc: 0.937
Validation loss decreased (-0.879977 --> -0.936663).  Saving model ...
Epoch: 3 cost time: 1.6617543697357178
Epoch: 3, Steps: 18 | Train Loss: 0.062 Vali Loss: 0.132 Vali Acc: 0.967 Test Loss: 0.132 Test Acc: 0.967
Validation loss decreased (-0.936663 --> -0.966665).  Saving model ...
Epoch: 4 cost time: 1.547990322113037
Epoch: 4, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.118 Vali Acc: 0.967 Test Loss: 0.118 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 5 cost time: 1.5874075889587402
Epoch: 5, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.117 Vali Acc: 0.967 Test Loss: 0.117 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 6 cost time: 1.5750088691711426
Epoch: 6, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.118 Vali Acc: 0.970 Test Loss: 0.118 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969999).  Saving model ...
Epoch: 7 cost time: 1.507338047027588
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 1.4119353294372559
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 1.3578505516052246
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5510704517364502
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0442826747894287
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.0734434127807617
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.147782325744629
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.1043121814727783
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.9818868637084961
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 1.4069249629974365
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 1.581397533416748
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 1.6256687641143799
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.7223527431488037
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 1.67793869972229
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 1.802469253540039
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.7005717754364014
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 1.7351453304290771
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 1.7306418418884277
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 1.4492576122283936
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.2834501266479492
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.245734691619873
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.4454221725463867
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.6877450942993164
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.6872096061706543
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.6556932926177979
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.6989998817443848
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.762847900390625
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.6775481700897217
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 3930137
model size : 15.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.618307113647461
Epoch: 1, Steps: 18 | Train Loss: 3.022 Vali Loss: 2.508 Vali Acc: 0.867 Test Loss: 2.508 Test Acc: 0.867
Validation loss decreased (inf --> -0.866642).  Saving model ...
Epoch: 2 cost time: 1.593740463256836
Epoch: 2, Steps: 18 | Train Loss: 1.286 Vali Loss: 0.558 Vali Acc: 0.967 Test Loss: 0.558 Test Acc: 0.967
Validation loss decreased (-0.866642 --> -0.966661).  Saving model ...
Epoch: 3 cost time: 1.573939561843872
Epoch: 3, Steps: 18 | Train Loss: 0.141 Vali Loss: 0.138 Vali Acc: 0.970 Test Loss: 0.138 Test Acc: 0.970
Validation loss decreased (-0.966661 --> -0.969999).  Saving model ...
Epoch: 4 cost time: 1.5321869850158691
Epoch: 4, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 5 cost time: 1.48946213722229
Epoch: 5, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 6 cost time: 1.506209135055542
Epoch: 6, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 7 cost time: 1.4143903255462646
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4880073070526123
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.5472080707550049
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.270197868347168
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.4776451587677002
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.5622196197509766
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.6508047580718994
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 1.523007869720459
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5173053741455078
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.6284852027893066
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.4897947311401367
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.478665828704834
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.4502367973327637
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.4569897651672363
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.5510246753692627
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.329585075378418
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.31388258934021
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 3757849
model size : 14.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps22_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.512491464614868
Epoch: 1, Steps: 18 | Train Loss: 2.994 Vali Loss: 2.549 Vali Acc: 0.830 Test Loss: 2.549 Test Acc: 0.830
Validation loss decreased (inf --> -0.829975).  Saving model ...
Epoch: 2 cost time: 1.4376599788665771
Epoch: 2, Steps: 18 | Train Loss: 1.425 Vali Loss: 0.697 Vali Acc: 0.953 Test Loss: 0.697 Test Acc: 0.953
Validation loss decreased (-0.829975 --> -0.953326).  Saving model ...
Epoch: 3 cost time: 1.5033862590789795
Epoch: 3, Steps: 18 | Train Loss: 0.196 Vali Loss: 0.163 Vali Acc: 0.957 Test Loss: 0.163 Test Acc: 0.957
Validation loss decreased (-0.953326 --> -0.956665).  Saving model ...
Epoch: 4 cost time: 1.467613697052002
Epoch: 4, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
Validation loss decreased (-0.956665 --> -0.973332).  Saving model ...
Epoch: 5 cost time: 1.3912532329559326
Epoch: 5, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 6 cost time: 1.3447811603546143
Epoch: 6, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 7 cost time: 1.2440762519836426
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0776073932647705
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0915114879608154
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.412585973739624
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.453730583190918
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.5110516548156738
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 1.3224709033966064
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4783847332000732
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.3258006572723389
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.3702478408813477
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.4615435600280762
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.3711917400360107
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 1.4423105716705322
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2310092449188232
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.309894323348999
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.272087812423706
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.2199821472167969
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.3789162635803223
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.2886953353881836
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.4016287326812744
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.2873809337615967
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.4874212741851807
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps22_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 3643545
model size : 13.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps29_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.3481686115264893
Epoch: 1, Steps: 18 | Train Loss: 3.051 Vali Loss: 2.680 Vali Acc: 0.687 Test Loss: 2.680 Test Acc: 0.687
Validation loss decreased (inf --> -0.686640).  Saving model ...
Epoch: 2 cost time: 1.422849178314209
Epoch: 2, Steps: 18 | Train Loss: 1.818 Vali Loss: 1.105 Vali Acc: 0.957 Test Loss: 1.105 Test Acc: 0.957
Validation loss decreased (-0.686640 --> -0.956656).  Saving model ...
Epoch: 3 cost time: 0.9882245063781738
Epoch: 3, Steps: 18 | Train Loss: 0.415 Vali Loss: 0.219 Vali Acc: 0.963 Test Loss: 0.219 Test Acc: 0.963
Validation loss decreased (-0.956656 --> -0.963331).  Saving model ...
Epoch: 4 cost time: 1.5697951316833496
Epoch: 4, Steps: 18 | Train Loss: 0.049 Vali Loss: 0.128 Vali Acc: 0.970 Test Loss: 0.128 Test Acc: 0.970
Validation loss decreased (-0.963331 --> -0.969999).  Saving model ...
Epoch: 5 cost time: 1.7006006240844727
Epoch: 5, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.116 Vali Acc: 0.970 Test Loss: 0.116 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 6 cost time: 1.7829070091247559
Epoch: 6, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 7 cost time: 1.5720562934875488
Epoch: 7, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 1.632042407989502
Epoch: 8, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 1.4956965446472168
Epoch: 9, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 1.8493196964263916
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 1.7802305221557617
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 12 cost time: 1.7951490879058838
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 2.021847724914551
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 1.6045176982879639
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4158127307891846
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 1.8857855796813965
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 1.855785846710205
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 1.915846347808838
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.150434732437134
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 1.938647747039795
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 1.8549656867980957
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 2.1620800495147705
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 2.0376930236816406
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.8149793148040771
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 1.963235855102539
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.7555880546569824
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.5240483283996582
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.7544429302215576
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.3877248764038086
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.908827304840088
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 2.1645796298980713
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 32 cost time: 2.0747220516204834
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.7352147102355957
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.9654183387756348
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 2.212907314300537
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.8397645950317383
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.9053337574005127
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 2.1304662227630615
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.9926106929779053
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.8160731792449951
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.890376091003418
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps29_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 3529241
model size : 13.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps36_str18_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.887410879135132
Epoch: 1, Steps: 18 | Train Loss: 3.043 Vali Loss: 2.757 Vali Acc: 0.770 Test Loss: 2.757 Test Acc: 0.770
Validation loss decreased (inf --> -0.769972).  Saving model ...
Epoch: 2 cost time: 1.9709134101867676
Epoch: 2, Steps: 18 | Train Loss: 2.015 Vali Loss: 1.401 Vali Acc: 0.950 Test Loss: 1.401 Test Acc: 0.950
Validation loss decreased (-0.769972 --> -0.949986).  Saving model ...
Epoch: 3 cost time: 1.8243889808654785
Epoch: 3, Steps: 18 | Train Loss: 0.616 Vali Loss: 0.307 Vali Acc: 0.960 Test Loss: 0.307 Test Acc: 0.960
Validation loss decreased (-0.949986 --> -0.959997).  Saving model ...
Epoch: 4 cost time: 1.7443351745605469
Epoch: 4, Steps: 18 | Train Loss: 0.102 Vali Loss: 0.138 Vali Acc: 0.960 Test Loss: 0.138 Test Acc: 0.960
Validation loss decreased (-0.959997 --> -0.959999).  Saving model ...
Epoch: 5 cost time: 1.915130615234375
Epoch: 5, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.116 Vali Acc: 0.970 Test Loss: 0.116 Test Acc: 0.970
Validation loss decreased (-0.959999 --> -0.969999).  Saving model ...
Epoch: 6 cost time: 2.067208766937256
Epoch: 6, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 7 cost time: 1.77767014503479
Epoch: 7, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 8 cost time: 1.7194721698760986
Epoch: 8, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.969999 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 1.7383713722229004
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5780503749847412
Epoch: 10, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.414973258972168
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.6138160228729248
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.7831952571868896
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.970 Test Loss: 0.090 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.6897125244140625
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.970 Test Loss: 0.091 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.9120748043060303
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.8926897048950195
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.7147421836853027
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.7031662464141846
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps36_str18_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 3472537
model size : 13.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.7730815410614014
Epoch: 1, Steps: 18 | Train Loss: 2.835 Vali Loss: 1.856 Vali Acc: 0.877 Test Loss: 1.856 Test Acc: 0.877
Validation loss decreased (inf --> -0.876648).  Saving model ...
Epoch: 2 cost time: 1.0154659748077393
Epoch: 2, Steps: 18 | Train Loss: 0.580 Vali Loss: 0.222 Vali Acc: 0.970 Test Loss: 0.222 Test Acc: 0.970
Validation loss decreased (-0.876648 --> -0.969998).  Saving model ...
Epoch: 3 cost time: 0.9873816967010498
Epoch: 3, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.129 Vali Acc: 0.963 Test Loss: 0.129 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2767860889434814
Epoch: 4, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.118 Vali Acc: 0.967 Test Loss: 0.118 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3656861782073975
Epoch: 5, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969999).  Saving model ...
Epoch: 6 cost time: 1.373713493347168
Epoch: 6, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 1.6371290683746338
Epoch: 7, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 1.6310443878173828
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 1.4590611457824707
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 1.3720648288726807
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 1.6932902336120605
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 1.683974027633667
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 1.3724689483642578
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 1.2276513576507568
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 1.4827792644500732
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 1.4196672439575195
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.225543737411499
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.2158334255218506
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 1.332047939300537
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0626194477081299
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.3448081016540527
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.5248544216156006
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 1.5499587059020996
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 1.3880133628845215
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 1.6290004253387451
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 1.5808300971984863
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 1.3544237613677979
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 28 cost time: 1.479598045349121
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 1.6481297016143799
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.3871803283691406
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.3526568412780762
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.4493317604064941
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.0269193649291992
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.109656572341919
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.4793717861175537
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 36 cost time: 1.404590368270874
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 37 cost time: 1.1771535873413086
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.402723789215088
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.5880649089813232
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.2883222103118896
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.3693525791168213
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.622030258178711
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.643125295639038
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.4231572151184082
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 1.3709962368011475
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 1.525313377380371
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 1902169
model size : 7.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.2142651081085205
Epoch: 1, Steps: 18 | Train Loss: 2.991 Vali Loss: 2.461 Vali Acc: 0.873 Test Loss: 2.461 Test Acc: 0.873
Validation loss decreased (inf --> -0.873309).  Saving model ...
Epoch: 2 cost time: 1.2315454483032227
Epoch: 2, Steps: 18 | Train Loss: 1.328 Vali Loss: 0.638 Vali Acc: 0.960 Test Loss: 0.638 Test Acc: 0.960
Validation loss decreased (-0.873309 --> -0.959994).  Saving model ...
Epoch: 3 cost time: 1.312403917312622
Epoch: 3, Steps: 18 | Train Loss: 0.170 Vali Loss: 0.161 Vali Acc: 0.970 Test Loss: 0.161 Test Acc: 0.970
Validation loss decreased (-0.959994 --> -0.969998).  Saving model ...
Epoch: 4 cost time: 1.1627800464630127
Epoch: 4, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.123 Vali Acc: 0.970 Test Loss: 0.123 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969999).  Saving model ...
Epoch: 5 cost time: 1.1814186573028564
Epoch: 5, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 6 cost time: 1.3716580867767334
Epoch: 6, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 7 cost time: 1.1999223232269287
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 8 cost time: 1.0877721309661865
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 1.2180218696594238
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 0.9957478046417236
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 0.9914402961730957
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 1.220207929611206
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 1.2263245582580566
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 1.1967647075653076
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 1.2382330894470215
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 1.2527587413787842
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.185741901397705
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 1.302659273147583
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2072553634643555
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1787898540496826
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 1.357579231262207
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2879016399383545
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.2509267330169678
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 1.1952004432678223
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 1.0911328792572021
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.179448127746582
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.1387684345245361
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.182382345199585
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.3002731800079346
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.1617157459259033
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.242567777633667
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.4011471271514893
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.1182582378387451
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.1963963508605957
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 1384025
model size : 5.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.1169865131378174
Epoch: 1, Steps: 18 | Train Loss: 3.066 Vali Loss: 2.707 Vali Acc: 0.787 Test Loss: 2.707 Test Acc: 0.787
Validation loss decreased (inf --> -0.786640).  Saving model ...
Epoch: 2 cost time: 1.0277230739593506
Epoch: 2, Steps: 18 | Train Loss: 1.818 Vali Loss: 1.162 Vali Acc: 0.953 Test Loss: 1.162 Test Acc: 0.953
Validation loss decreased (-0.786640 --> -0.953322).  Saving model ...
Epoch: 3 cost time: 1.0417487621307373
Epoch: 3, Steps: 18 | Train Loss: 0.408 Vali Loss: 0.242 Vali Acc: 0.967 Test Loss: 0.242 Test Acc: 0.967
Validation loss decreased (-0.953322 --> -0.966664).  Saving model ...
Epoch: 4 cost time: 1.0051865577697754
Epoch: 4, Steps: 18 | Train Loss: 0.051 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
Validation loss decreased (-0.966664 --> -0.976665).  Saving model ...
Epoch: 5 cost time: 1.150266408920288
Epoch: 5, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.110 Vali Acc: 0.967 Test Loss: 0.110 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1450161933898926
Epoch: 6, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1528379917144775
Epoch: 7, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 8 cost time: 1.2031958103179932
Epoch: 8, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 1.0088255405426025
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 1.0712168216705322
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 1.2022323608398438
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 1.0010251998901367
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 1.0260496139526367
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 1.2791142463684082
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0596380233764648
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 0.8853034973144531
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 1.0306179523468018
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 0.862464427947998
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 1.1453516483306885
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 1.310619592666626
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1686022281646729
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.1021313667297363
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.167262315750122
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.2729089260101318
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 1.1845707893371582
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.068385124206543
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.1916923522949219
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.127993106842041
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 1.1350281238555908
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 1.224459171295166
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.1872296333312988
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.9551336765289307
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.963162899017334
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.0033082962036133
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.160837173461914
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.2371854782104492
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.209265947341919
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.1574983596801758
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 39 cost time: 1.2177155017852783
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.162398099899292
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 41 cost time: 1.0890216827392578
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.1541411876678467
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 43 cost time: 1.2260808944702148
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 44 cost time: 1.1800878047943115
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.1246895790100098
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.2892587184906006
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.134354829788208
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.9052319526672363
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.983 Test Loss: 0.090 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.0516009330749512
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.989525556564331
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 1211417
model size : 4.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.6331756114959717
Epoch: 1, Steps: 18 | Train Loss: 3.097 Vali Loss: 2.841 Vali Acc: 0.580 Test Loss: 2.841 Test Acc: 0.580
Validation loss decreased (inf --> -0.579972).  Saving model ...
Epoch: 2 cost time: 0.7679293155670166
Epoch: 2, Steps: 18 | Train Loss: 2.141 Vali Loss: 1.575 Vali Acc: 0.947 Test Loss: 1.575 Test Acc: 0.947
Validation loss decreased (-0.579972 --> -0.946651).  Saving model ...
Epoch: 3 cost time: 1.2116737365722656
Epoch: 3, Steps: 18 | Train Loss: 0.748 Vali Loss: 0.383 Vali Acc: 0.963 Test Loss: 0.383 Test Acc: 0.963
Validation loss decreased (-0.946651 --> -0.963330).  Saving model ...
Epoch: 4 cost time: 1.0812466144561768
Epoch: 4, Steps: 18 | Train Loss: 0.119 Vali Loss: 0.141 Vali Acc: 0.973 Test Loss: 0.141 Test Acc: 0.973
Validation loss decreased (-0.963330 --> -0.973332).  Saving model ...
Epoch: 5 cost time: 1.0605392456054688
Epoch: 5, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 6 cost time: 1.235818862915039
Epoch: 6, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 7 cost time: 1.108306884765625
Epoch: 7, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.082697868347168
Epoch: 8, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1364893913269043
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.3052394390106201
Epoch: 10, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.1908249855041504
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.0882394313812256
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 1.2545692920684814
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 1.2251286506652832
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0385828018188477
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 0.8582499027252197
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 1.0155179500579834
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1034455299377441
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 1.050382137298584
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 1.1791176795959473
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 1.1083598136901855
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 1.077260971069336
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 1.2444508075714111
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 1.0497384071350098
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 1.1103432178497314
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 1.0719454288482666
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1376152038574219
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.034857988357544
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.9960410594940186
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.0018806457519531
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.9762561321258545
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 32 cost time: 0.8676567077636719
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 33 cost time: 1.286566972732544
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.1524453163146973
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.1135587692260742
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.2601096630096436
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.1144464015960693
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.0287115573883057
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.0251774787902832
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.2027122974395752
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.111579179763794
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.0793142318725586
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 1125273
model size : 4.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps22_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.2446184158325195
Epoch: 1, Steps: 18 | Train Loss: 3.136 Vali Loss: 2.900 Vali Acc: 0.537 Test Loss: 2.900 Test Acc: 0.537
Validation loss decreased (inf --> -0.536638).  Saving model ...
Epoch: 2 cost time: 1.204275369644165
Epoch: 2, Steps: 18 | Train Loss: 2.344 Vali Loss: 1.846 Vali Acc: 0.927 Test Loss: 1.846 Test Acc: 0.927
Validation loss decreased (-0.536638 --> -0.926648).  Saving model ...
Epoch: 3 cost time: 1.1079435348510742
Epoch: 3, Steps: 18 | Train Loss: 1.029 Vali Loss: 0.569 Vali Acc: 0.963 Test Loss: 0.569 Test Acc: 0.963
Validation loss decreased (-0.926648 --> -0.963328).  Saving model ...
Epoch: 4 cost time: 1.0625550746917725
Epoch: 4, Steps: 18 | Train Loss: 0.233 Vali Loss: 0.182 Vali Acc: 0.963 Test Loss: 0.182 Test Acc: 0.963
Validation loss decreased (-0.963328 --> -0.963332).  Saving model ...
Epoch: 5 cost time: 1.0702571868896484
Epoch: 5, Steps: 18 | Train Loss: 0.041 Vali Loss: 0.125 Vali Acc: 0.973 Test Loss: 0.125 Test Acc: 0.973
Validation loss decreased (-0.963332 --> -0.973332).  Saving model ...
Epoch: 6 cost time: 0.9815163612365723
Epoch: 6, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 7 cost time: 0.9072372913360596
Epoch: 7, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 0.9205052852630615
Epoch: 8, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 0.9078555107116699
Epoch: 9, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 0.9291234016418457
Epoch: 10, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 1.0128304958343506
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 0.9501855373382568
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 1.0691025257110596
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 1.1635842323303223
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1186370849609375
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 1.1139023303985596
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 1.271660327911377
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 1.1131901741027832
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1402523517608643
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 1.2116150856018066
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9950261116027832
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 1.0535187721252441
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.1311523914337158
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 0.8603091239929199
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 0.882634162902832
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0181772708892822
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.1215758323669434
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.1320569515228271
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.1997137069702148
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.0951361656188965
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.0150539875030518
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.1010358333587646
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.1929490566253662
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.0472512245178223
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps22_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 1068121
model size : 4.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps29_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.2100205421447754
Epoch: 1, Steps: 18 | Train Loss: 3.153 Vali Loss: 2.978 Vali Acc: 0.323 Test Loss: 2.978 Test Acc: 0.323
Validation loss decreased (inf --> -0.323304).  Saving model ...
Epoch: 2 cost time: 1.0867609977722168
Epoch: 2, Steps: 18 | Train Loss: 2.493 Vali Loss: 2.148 Vali Acc: 0.867 Test Loss: 2.148 Test Acc: 0.867
Validation loss decreased (-0.323304 --> -0.866645).  Saving model ...
Epoch: 3 cost time: 1.1770999431610107
Epoch: 3, Steps: 18 | Train Loss: 1.410 Vali Loss: 0.965 Vali Acc: 0.940 Test Loss: 0.965 Test Acc: 0.940
Validation loss decreased (-0.866645 --> -0.939990).  Saving model ...
Epoch: 4 cost time: 1.0833277702331543
Epoch: 4, Steps: 18 | Train Loss: 0.461 Vali Loss: 0.295 Vali Acc: 0.963 Test Loss: 0.295 Test Acc: 0.963
Validation loss decreased (-0.939990 --> -0.963330).  Saving model ...
Epoch: 5 cost time: 1.0655882358551025
Epoch: 5, Steps: 18 | Train Loss: 0.104 Vali Loss: 0.161 Vali Acc: 0.967 Test Loss: 0.161 Test Acc: 0.967
Validation loss decreased (-0.963330 --> -0.966665).  Saving model ...
Epoch: 6 cost time: 1.1129798889160156
Epoch: 6, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
Validation loss decreased (-0.966665 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 1.0686919689178467
Epoch: 7, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 8 cost time: 1.1221563816070557
Epoch: 8, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.159067153930664
Epoch: 9, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1366124153137207
Epoch: 10, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.1192042827606201
Epoch: 11, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.0129907131195068
Epoch: 12, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.0062251091003418
Epoch: 13, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.8558223247528076
Epoch: 14, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.9171082973480225
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.973 Test Loss: 0.081 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.1505582332611084
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 0.9746644496917725
Epoch: 17, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 1.089176893234253
Epoch: 18, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.078 Vali Acc: 0.973 Test Loss: 0.078 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1660995483398438
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.973 Test Loss: 0.078 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.007089614868164
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.973 Test Loss: 0.078 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.036628007888794
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.973 Test Loss: 0.077 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.054856300354004
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.973 Test Loss: 0.076 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.1798973083496094
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.973 Test Loss: 0.075 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.076328992843628
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.973 Test Loss: 0.075 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.9968883991241455
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.973 Test Loss: 0.075 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.1645894050598145
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.973 Test Loss: 0.074 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.9738175868988037
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 28 cost time: 0.982975959777832
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.973 Test Loss: 0.075 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9998517036437988
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.973 Test Loss: 0.073 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.2117316722869873
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.977 Test Loss: 0.071 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 31 cost time: 1.1340391635894775
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.2124590873718262
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.1652843952178955
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.0329327583312988
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.1951994895935059
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.99534010887146
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.973 Test Loss: 0.073 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.0310554504394531
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.973 Test Loss: 0.073 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.131385087966919
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.977 Test Loss: 0.072 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.0692317485809326
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.973 Test Loss: 0.072 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.9526686668395996
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.973 Test Loss: 0.072 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps29_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 1010969
model size : 3.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps36_str18_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.333815813064575
Epoch: 1, Steps: 18 | Train Loss: 3.159 Vali Loss: 3.013 Vali Acc: 0.290 Test Loss: 3.013 Test Acc: 0.290
Validation loss decreased (inf --> -0.289970).  Saving model ...
Epoch: 2 cost time: 1.2556087970733643
Epoch: 2, Steps: 18 | Train Loss: 2.659 Vali Loss: 2.358 Vali Acc: 0.860 Test Loss: 2.358 Test Acc: 0.860
Validation loss decreased (-0.289970 --> -0.859976).  Saving model ...
Epoch: 3 cost time: 1.1288015842437744
Epoch: 3, Steps: 18 | Train Loss: 1.787 Vali Loss: 1.307 Vali Acc: 0.933 Test Loss: 1.307 Test Acc: 0.933
Validation loss decreased (-0.859976 --> -0.933320).  Saving model ...
Epoch: 4 cost time: 1.0887959003448486
Epoch: 4, Steps: 18 | Train Loss: 0.740 Vali Loss: 0.455 Vali Acc: 0.963 Test Loss: 0.455 Test Acc: 0.963
Validation loss decreased (-0.933320 --> -0.963329).  Saving model ...
Epoch: 5 cost time: 1.1713666915893555
Epoch: 5, Steps: 18 | Train Loss: 0.196 Vali Loss: 0.203 Vali Acc: 0.963 Test Loss: 0.203 Test Acc: 0.963
Validation loss decreased (-0.963329 --> -0.963331).  Saving model ...
Epoch: 6 cost time: 1.111119270324707
Epoch: 6, Steps: 18 | Train Loss: 0.062 Vali Loss: 0.133 Vali Acc: 0.977 Test Loss: 0.133 Test Acc: 0.977
Validation loss decreased (-0.963331 --> -0.976665).  Saving model ...
Epoch: 7 cost time: 1.1488890647888184
Epoch: 7, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.113 Vali Acc: 0.980 Test Loss: 0.113 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 1.2445194721221924
Epoch: 8, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.099257230758667
Epoch: 9, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9916284084320068
Epoch: 10, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.053926944732666
Epoch: 11, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.8912391662597656
Epoch: 12, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.065744400024414
Epoch: 13, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.1889781951904297
Epoch: 14, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.0168211460113525
Epoch: 15, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.9397537708282471
Epoch: 16, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.9569122791290283
Epoch: 17, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps36_str18_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 982617
model size : 3.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.427062511444092
Epoch: 1, Steps: 18 | Train Loss: 2.959 Vali Loss: 2.374 Vali Acc: 0.820 Test Loss: 2.374 Test Acc: 0.820
Validation loss decreased (inf --> -0.819976).  Saving model ...
Epoch: 2 cost time: 0.8379621505737305
Epoch: 2, Steps: 18 | Train Loss: 1.273 Vali Loss: 0.662 Vali Acc: 0.953 Test Loss: 0.662 Test Acc: 0.953
Validation loss decreased (-0.819976 --> -0.953327).  Saving model ...
Epoch: 3 cost time: 0.9716556072235107
Epoch: 3, Steps: 18 | Train Loss: 0.175 Vali Loss: 0.167 Vali Acc: 0.970 Test Loss: 0.167 Test Acc: 0.970
Validation loss decreased (-0.953327 --> -0.969998).  Saving model ...
Epoch: 4 cost time: 1.0687150955200195
Epoch: 4, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.131 Vali Acc: 0.973 Test Loss: 0.131 Test Acc: 0.973
Validation loss decreased (-0.969998 --> -0.973332).  Saving model ...
Epoch: 5 cost time: 0.910036563873291
Epoch: 5, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 6 cost time: 1.0135188102722168
Epoch: 6, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 7 cost time: 1.1011321544647217
Epoch: 7, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 8 cost time: 0.9568777084350586
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 1.0477807521820068
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 1.115091323852539
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9339940547943115
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 0.8653221130371094
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 1.0173697471618652
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 0.7928988933563232
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 0.7999978065490723
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8914444446563721
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.870877742767334
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.9601998329162598
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 1.0763399600982666
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 0.8975036144256592
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9461817741394043
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.9647765159606934
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 1.0931496620178223
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 0.9418895244598389
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0007708072662354
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.0981807708740234
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.9862995147705078
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.8428583145141602
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.9850573539733887
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.8515169620513916
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.044219970703125
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.1224942207336426
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.9856576919555664
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 762681
model size : 2.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.038205862045288
Epoch: 1, Steps: 18 | Train Loss: 3.081 Vali Loss: 2.767 Vali Acc: 0.623 Test Loss: 2.767 Test Acc: 0.623
Validation loss decreased (inf --> -0.623306).  Saving model ...
Epoch: 2 cost time: 0.9582452774047852
Epoch: 2, Steps: 18 | Train Loss: 2.077 Vali Loss: 1.540 Vali Acc: 0.933 Test Loss: 1.540 Test Acc: 0.933
Validation loss decreased (-0.623306 --> -0.933318).  Saving model ...
Epoch: 3 cost time: 1.0141658782958984
Epoch: 3, Steps: 18 | Train Loss: 0.764 Vali Loss: 0.439 Vali Acc: 0.963 Test Loss: 0.439 Test Acc: 0.963
Validation loss decreased (-0.933318 --> -0.963329).  Saving model ...
Epoch: 4 cost time: 0.8200514316558838
Epoch: 4, Steps: 18 | Train Loss: 0.135 Vali Loss: 0.168 Vali Acc: 0.980 Test Loss: 0.168 Test Acc: 0.980
Validation loss decreased (-0.963329 --> -0.979998).  Saving model ...
Epoch: 5 cost time: 0.7002928256988525
Epoch: 5, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.123 Vali Acc: 0.977 Test Loss: 0.123 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8579661846160889
Epoch: 6, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
Validation loss decreased (-0.979998 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 0.9186279773712158
Epoch: 7, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 0.9870514869689941
Epoch: 8, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 1.0249946117401123
Epoch: 9, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 1.0295429229736328
Epoch: 10, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 0.9444875717163086
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 0.9227778911590576
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 0.8680458068847656
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 0.8808591365814209
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 0.7571940422058105
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 0.7049059867858887
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 0.858057975769043
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 0.7110564708709717
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 0.8459758758544922
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 0.7048702239990234
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.941093921661377
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 1.0398681163787842
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 0.9000425338745117
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 0.9336543083190918
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.1128110885620117
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 0.9231035709381104
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 0.9361846446990967
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 0.9036188125610352
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.039747714996338
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.9187159538269043
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.8709793090820312
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.8954179286956787
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.7129840850830078
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.8934996128082275
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.8644602298736572
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.9113519191741943
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.9983847141265869
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 503609
model size : 1.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.1401920318603516
Epoch: 1, Steps: 18 | Train Loss: 3.152 Vali Loss: 2.986 Vali Acc: 0.390 Test Loss: 2.986 Test Acc: 0.390
Validation loss decreased (inf --> -0.389970).  Saving model ...
Epoch: 2 cost time: 0.8601329326629639
Epoch: 2, Steps: 18 | Train Loss: 2.603 Vali Loss: 2.265 Vali Acc: 0.907 Test Loss: 2.265 Test Acc: 0.907
Validation loss decreased (-0.389970 --> -0.906644).  Saving model ...
Epoch: 3 cost time: 0.7393221855163574
Epoch: 3, Steps: 18 | Train Loss: 1.623 Vali Loss: 1.167 Vali Acc: 0.953 Test Loss: 1.167 Test Acc: 0.953
Validation loss decreased (-0.906644 --> -0.953322).  Saving model ...
Epoch: 4 cost time: 0.8580210208892822
Epoch: 4, Steps: 18 | Train Loss: 0.577 Vali Loss: 0.382 Vali Acc: 0.963 Test Loss: 0.382 Test Acc: 0.963
Validation loss decreased (-0.953322 --> -0.963330).  Saving model ...
Epoch: 5 cost time: 0.7908847332000732
Epoch: 5, Steps: 18 | Train Loss: 0.150 Vali Loss: 0.191 Vali Acc: 0.970 Test Loss: 0.191 Test Acc: 0.970
Validation loss decreased (-0.963330 --> -0.969998).  Saving model ...
Epoch: 6 cost time: 0.7335045337677002
Epoch: 6, Steps: 18 | Train Loss: 0.042 Vali Loss: 0.145 Vali Acc: 0.970 Test Loss: 0.145 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969999).  Saving model ...
Epoch: 7 cost time: 1.01961088180542
Epoch: 7, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.123 Vali Acc: 0.973 Test Loss: 0.123 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 1.0518834590911865
Epoch: 8, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 1.0293936729431152
Epoch: 9, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 0.96142578125
Epoch: 10, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 1.1294972896575928
Epoch: 11, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 1.042748212814331
Epoch: 12, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 1.0092496871948242
Epoch: 13, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 1.0301158428192139
Epoch: 14, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 1.0266950130462646
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 1.0050032138824463
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 0.8534436225891113
Epoch: 17, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 1.046642780303955
Epoch: 18, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 0.7710015773773193
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 0.8117969036102295
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 0.8937380313873291
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.983 Test Loss: 0.090 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 22 cost time: 0.8866100311279297
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8779399394989014
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 24 cost time: 1.0145604610443115
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9933590888977051
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.9337430000305176
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.0016405582427979
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.0975308418273926
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.9090135097503662
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.882561445236206
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.0017735958099365
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.9221277236938477
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.7447938919067383
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 417305
model size : 1.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.057859420776367
Epoch: 1, Steps: 18 | Train Loss: 3.176 Vali Loss: 3.049 Vali Acc: 0.217 Test Loss: 3.049 Test Acc: 0.217
Validation loss decreased (inf --> -0.216636).  Saving model ...
Epoch: 2 cost time: 0.9580321311950684
Epoch: 2, Steps: 18 | Train Loss: 2.701 Vali Loss: 2.456 Vali Acc: 0.800 Test Loss: 2.456 Test Acc: 0.800
Validation loss decreased (-0.216636 --> -0.799975).  Saving model ...
Epoch: 3 cost time: 0.9115808010101318
Epoch: 3, Steps: 18 | Train Loss: 1.904 Vali Loss: 1.510 Vali Acc: 0.933 Test Loss: 1.510 Test Acc: 0.933
Validation loss decreased (-0.799975 --> -0.933318).  Saving model ...
Epoch: 4 cost time: 0.9247045516967773
Epoch: 4, Steps: 18 | Train Loss: 0.879 Vali Loss: 0.607 Vali Acc: 0.970 Test Loss: 0.607 Test Acc: 0.970
Validation loss decreased (-0.933318 --> -0.969994).  Saving model ...
Epoch: 5 cost time: 1.0052173137664795
Epoch: 5, Steps: 18 | Train Loss: 0.266 Vali Loss: 0.259 Vali Acc: 0.967 Test Loss: 0.259 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9705674648284912
Epoch: 6, Steps: 18 | Train Loss: 0.079 Vali Loss: 0.172 Vali Acc: 0.970 Test Loss: 0.172 Test Acc: 0.970
Validation loss decreased (-0.969994 --> -0.969998).  Saving model ...
Epoch: 7 cost time: 1.0645298957824707
Epoch: 7, Steps: 18 | Train Loss: 0.036 Vali Loss: 0.138 Vali Acc: 0.973 Test Loss: 0.138 Test Acc: 0.973
Validation loss decreased (-0.969998 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 1.177647352218628
Epoch: 8, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.124 Vali Acc: 0.977 Test Loss: 0.124 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 9 cost time: 0.9036357402801514
Epoch: 9, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 10 cost time: 0.8923561573028564
Epoch: 10, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 0.8684592247009277
Epoch: 11, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 1.0033929347991943
Epoch: 12, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 1.019282341003418
Epoch: 13, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 0.933525800704956
Epoch: 14, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 0.923891544342041
Epoch: 15, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 0.9492261409759521
Epoch: 16, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 0.880997896194458
Epoch: 17, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 0.8412525653839111
Epoch: 18, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 1.0915899276733398
Epoch: 19, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 0.9948368072509766
Epoch: 20, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 0.9730985164642334
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1033451557159424
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 0.8480515480041504
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 0.8737750053405762
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 0.8130614757537842
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 0.9081404209136963
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 0.9313633441925049
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 1.0496201515197754
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 0.8674798011779785
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9097554683685303
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.9683239459991455
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 32 cost time: 0.9302918910980225
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.9870257377624512
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 34 cost time: 0.9462850093841553
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 35 cost time: 1.0656507015228271
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 36 cost time: 0.9968264102935791
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 37 cost time: 0.8081521987915039
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.9369664192199707
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 39 cost time: 0.7563776969909668
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.0975415706634521
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.9704954624176025
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.9439132213592529
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 43 cost time: 0.9688401222229004
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 44 cost time: 1.0863115787506104
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.9925312995910645
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.9532375335693359
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.1207213401794434
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.9411466121673584
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.993208646774292
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 1.0809597969055176
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 374233
model size : 1.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps22_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.9279751777648926
Epoch: 1, Steps: 18 | Train Loss: 3.169 Vali Loss: 3.050 Vali Acc: 0.257 Test Loss: 3.050 Test Acc: 0.257
Validation loss decreased (inf --> -0.256636).  Saving model ...
Epoch: 2 cost time: 0.9177663326263428
Epoch: 2, Steps: 18 | Train Loss: 2.758 Vali Loss: 2.540 Vali Acc: 0.813 Test Loss: 2.540 Test Acc: 0.813
Validation loss decreased (-0.256636 --> -0.813308).  Saving model ...
Epoch: 3 cost time: 0.9224390983581543
Epoch: 3, Steps: 18 | Train Loss: 2.051 Vali Loss: 1.695 Vali Acc: 0.940 Test Loss: 1.695 Test Acc: 0.940
Validation loss decreased (-0.813308 --> -0.939983).  Saving model ...
Epoch: 4 cost time: 0.9890391826629639
Epoch: 4, Steps: 18 | Train Loss: 1.127 Vali Loss: 0.793 Vali Acc: 0.967 Test Loss: 0.793 Test Acc: 0.967
Validation loss decreased (-0.939983 --> -0.966659).  Saving model ...
Epoch: 5 cost time: 0.8852522373199463
Epoch: 5, Steps: 18 | Train Loss: 0.408 Vali Loss: 0.322 Vali Acc: 0.963 Test Loss: 0.322 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9018368721008301
Epoch: 6, Steps: 18 | Train Loss: 0.133 Vali Loss: 0.187 Vali Acc: 0.970 Test Loss: 0.187 Test Acc: 0.970
Validation loss decreased (-0.966659 --> -0.969998).  Saving model ...
Epoch: 7 cost time: 0.8674125671386719
Epoch: 7, Steps: 18 | Train Loss: 0.057 Vali Loss: 0.152 Vali Acc: 0.970 Test Loss: 0.152 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 8 cost time: 1.0789427757263184
Epoch: 8, Steps: 18 | Train Loss: 0.031 Vali Loss: 0.132 Vali Acc: 0.977 Test Loss: 0.132 Test Acc: 0.977
Validation loss decreased (-0.969998 --> -0.976665).  Saving model ...
Epoch: 9 cost time: 0.9284627437591553
Epoch: 9, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.121 Vali Acc: 0.977 Test Loss: 0.121 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 10 cost time: 0.9410908222198486
Epoch: 10, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 11 cost time: 0.9583745002746582
Epoch: 11, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 0.8399298191070557
Epoch: 12, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 0.8641567230224609
Epoch: 13, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 0.6537003517150879
Epoch: 14, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 0.8883311748504639
Epoch: 15, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 0.945404052734375
Epoch: 16, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 0.8275964260101318
Epoch: 17, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 0.9446969032287598
Epoch: 18, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 0.8990285396575928
Epoch: 19, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 0.8012363910675049
Epoch: 20, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 0.9679272174835205
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 0.9325203895568848
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 0.9971683025360107
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 1.0155794620513916
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 0.866194486618042
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 0.8247122764587402
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.983 Test Loss: 0.090 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 27 cost time: 0.7692418098449707
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 28 cost time: 0.8696184158325195
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.8232147693634033
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.9019880294799805
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 31 cost time: 1.0354151725769043
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 32 cost time: 0.9359524250030518
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 33 cost time: 0.8251786231994629
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.0629808902740479
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 35 cost time: 0.9411211013793945
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.9445526599884033
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 37 cost time: 0.9765608310699463
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 38 cost time: 0.9839639663696289
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 39 cost time: 0.9517018795013428
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 40 cost time: 0.9211938381195068
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.0348186492919922
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.9618885517120361
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 43 cost time: 0.84112548828125
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.7973179817199707
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.731295108795166
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.8374614715576172
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.730665922164917
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.728071928024292
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.8253331184387207
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.8126339912414551
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps22_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 345657
model size : 1.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps29_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.0151851177215576
Epoch: 1, Steps: 18 | Train Loss: 3.193 Vali Loss: 3.089 Vali Acc: 0.160 Test Loss: 3.089 Test Acc: 0.160
Validation loss decreased (inf --> -0.159969).  Saving model ...
Epoch: 2 cost time: 0.7946040630340576
Epoch: 2, Steps: 18 | Train Loss: 2.847 Vali Loss: 2.689 Vali Acc: 0.653 Test Loss: 2.689 Test Acc: 0.653
Validation loss decreased (-0.159969 --> -0.653306).  Saving model ...
Epoch: 3 cost time: 0.7176666259765625
Epoch: 3, Steps: 18 | Train Loss: 2.318 Vali Loss: 2.040 Vali Acc: 0.890 Test Loss: 2.040 Test Acc: 0.890
Validation loss decreased (-0.653306 --> -0.889980).  Saving model ...
Epoch: 4 cost time: 0.8448221683502197
Epoch: 4, Steps: 18 | Train Loss: 1.548 Vali Loss: 1.224 Vali Acc: 0.947 Test Loss: 1.224 Test Acc: 0.947
Validation loss decreased (-0.889980 --> -0.946654).  Saving model ...
Epoch: 5 cost time: 0.751265287399292
Epoch: 5, Steps: 18 | Train Loss: 0.786 Vali Loss: 0.565 Vali Acc: 0.960 Test Loss: 0.565 Test Acc: 0.960
Validation loss decreased (-0.946654 --> -0.959994).  Saving model ...
Epoch: 6 cost time: 0.9969851970672607
Epoch: 6, Steps: 18 | Train Loss: 0.301 Vali Loss: 0.284 Vali Acc: 0.967 Test Loss: 0.284 Test Acc: 0.967
Validation loss decreased (-0.959994 --> -0.966664).  Saving model ...
Epoch: 7 cost time: 0.9179282188415527
Epoch: 7, Steps: 18 | Train Loss: 0.120 Vali Loss: 0.195 Vali Acc: 0.967 Test Loss: 0.195 Test Acc: 0.967
Validation loss decreased (-0.966664 --> -0.966665).  Saving model ...
Epoch: 8 cost time: 0.8549661636352539
Epoch: 8, Steps: 18 | Train Loss: 0.064 Vali Loss: 0.159 Vali Acc: 0.973 Test Loss: 0.159 Test Acc: 0.973
Validation loss decreased (-0.966665 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 0.8380169868469238
Epoch: 9, Steps: 18 | Train Loss: 0.037 Vali Loss: 0.141 Vali Acc: 0.970 Test Loss: 0.141 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9614479541778564
Epoch: 10, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.128 Vali Acc: 0.973 Test Loss: 0.128 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 0.8630983829498291
Epoch: 11, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 12 cost time: 0.8789894580841064
Epoch: 12, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 13 cost time: 0.9712395668029785
Epoch: 13, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 14 cost time: 0.85015869140625
Epoch: 14, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 15 cost time: 0.8833537101745605
Epoch: 15, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 16 cost time: 0.9403305053710938
Epoch: 16, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 17 cost time: 0.8423430919647217
Epoch: 17, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 18 cost time: 0.7985625267028809
Epoch: 18, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 19 cost time: 0.819188117980957
Epoch: 19, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 20 cost time: 0.7886660099029541
Epoch: 20, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 21 cost time: 0.7190055847167969
Epoch: 21, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 22 cost time: 0.8669970035552979
Epoch: 22, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8316812515258789
Epoch: 23, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 24 cost time: 0.8531992435455322
Epoch: 24, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 25 cost time: 0.9603540897369385
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 26 cost time: 0.8223154544830322
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 27 cost time: 0.9977264404296875
Epoch: 27, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 28 cost time: 0.9012532234191895
Epoch: 28, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 29 cost time: 0.7795510292053223
Epoch: 29, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 30 cost time: 0.9467217922210693
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 31 cost time: 0.9330661296844482
Epoch: 31, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.8151068687438965
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.7268221378326416
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.7502741813659668
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 35 cost time: 0.7263593673706055
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 36 cost time: 0.6625123023986816
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 37 cost time: 0.8507342338562012
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.8987607955932617
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 39 cost time: 0.9926693439483643
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 40 cost time: 0.8317296504974365
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.9758658409118652
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 42 cost time: 0.9585299491882324
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 43 cost time: 0.9218165874481201
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 44 cost time: 0.8302116394042969
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 45 cost time: 0.8977043628692627
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.883587121963501
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.8911488056182861
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 48 cost time: 0.7973849773406982
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 49 cost time: 0.9652674198150635
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.739389181137085
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps29_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9733333333333334
model parameter : 317081
model size : 1.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps36_str18_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.0371789932250977
Epoch: 1, Steps: 18 | Train Loss: 3.188 Vali Loss: 3.112 Vali Acc: 0.183 Test Loss: 3.112 Test Acc: 0.183
Validation loss decreased (inf --> -0.183302).  Saving model ...
Epoch: 2 cost time: 1.0164506435394287
Epoch: 2, Steps: 18 | Train Loss: 2.959 Vali Loss: 2.834 Vali Acc: 0.597 Test Loss: 2.834 Test Acc: 0.597
Validation loss decreased (-0.183302 --> -0.596638).  Saving model ...
Epoch: 3 cost time: 0.8444139957427979
Epoch: 3, Steps: 18 | Train Loss: 2.572 Vali Loss: 2.362 Vali Acc: 0.847 Test Loss: 2.362 Test Acc: 0.847
Validation loss decreased (-0.596638 --> -0.846643).  Saving model ...
Epoch: 4 cost time: 0.906285285949707
Epoch: 4, Steps: 18 | Train Loss: 1.960 Vali Loss: 1.676 Vali Acc: 0.897 Test Loss: 1.676 Test Acc: 0.897
Validation loss decreased (-0.846643 --> -0.896650).  Saving model ...
Epoch: 5 cost time: 0.8354644775390625
Epoch: 5, Steps: 18 | Train Loss: 1.248 Vali Loss: 0.953 Vali Acc: 0.927 Test Loss: 0.953 Test Acc: 0.927
Validation loss decreased (-0.896650 --> -0.926657).  Saving model ...
Epoch: 6 cost time: 0.9072062969207764
Epoch: 6, Steps: 18 | Train Loss: 0.583 Vali Loss: 0.475 Vali Acc: 0.953 Test Loss: 0.475 Test Acc: 0.953
Validation loss decreased (-0.926657 --> -0.953329).  Saving model ...
Epoch: 7 cost time: 1.027008295059204
Epoch: 7, Steps: 18 | Train Loss: 0.246 Vali Loss: 0.278 Vali Acc: 0.967 Test Loss: 0.278 Test Acc: 0.967
Validation loss decreased (-0.953329 --> -0.966664).  Saving model ...
Epoch: 8 cost time: 0.915114164352417
Epoch: 8, Steps: 18 | Train Loss: 0.125 Vali Loss: 0.213 Vali Acc: 0.963 Test Loss: 0.213 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8262858390808105
Epoch: 9, Steps: 18 | Train Loss: 0.079 Vali Loss: 0.181 Vali Acc: 0.973 Test Loss: 0.181 Test Acc: 0.973
Validation loss decreased (-0.966664 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 0.8210873603820801
Epoch: 10, Steps: 18 | Train Loss: 0.051 Vali Loss: 0.164 Vali Acc: 0.973 Test Loss: 0.164 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 0.6948196887969971
Epoch: 11, Steps: 18 | Train Loss: 0.035 Vali Loss: 0.149 Vali Acc: 0.973 Test Loss: 0.149 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 12 cost time: 0.7176783084869385
Epoch: 12, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.142 Vali Acc: 0.970 Test Loss: 0.142 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8384914398193359
Epoch: 13, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.133 Vali Acc: 0.973 Test Loss: 0.133 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 14 cost time: 0.8712632656097412
Epoch: 14, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.128 Vali Acc: 0.973 Test Loss: 0.128 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 15 cost time: 0.7941367626190186
Epoch: 15, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.124 Vali Acc: 0.973 Test Loss: 0.124 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 16 cost time: 0.9807958602905273
Epoch: 16, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 17 cost time: 0.8844780921936035
Epoch: 17, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 18 cost time: 0.8695831298828125
Epoch: 18, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 19 cost time: 1.0361409187316895
Epoch: 19, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.117 Vali Acc: 0.973 Test Loss: 0.117 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 20 cost time: 0.8130478858947754
Epoch: 20, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 21 cost time: 0.8523476123809814
Epoch: 21, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.114 Vali Acc: 0.970 Test Loss: 0.114 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0200507640838623
Epoch: 22, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.8521244525909424
Epoch: 23, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 24 cost time: 0.9575672149658203
Epoch: 24, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 25 cost time: 0.9806466102600098
Epoch: 25, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 26 cost time: 0.6854763031005859
Epoch: 26, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 27 cost time: 0.8041374683380127
Epoch: 27, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 28 cost time: 0.7954792976379395
Epoch: 28, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 29 cost time: 0.6918084621429443
Epoch: 29, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 30 cost time: 0.8963422775268555
Epoch: 30, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 31 cost time: 1.0107085704803467
Epoch: 31, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 32 cost time: 0.8654789924621582
Epoch: 32, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 33 cost time: 0.8457999229431152
Epoch: 33, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 34 cost time: 0.9134752750396729
Epoch: 34, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.8526675701141357
Epoch: 35, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.7116789817810059
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.8407247066497803
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.9191248416900635
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 39 cost time: 0.7719502449035645
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.9496078491210938
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.8487813472747803
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.7457175254821777
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.7473771572113037
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.7590293884277344
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.8486330509185791
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 46 cost time: 0.6218442916870117
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.6992373466491699
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.6326158046722412
Epoch: 48, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.6322216987609863
Epoch: 49, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 50 cost time: 0.7287089824676514
Epoch: 50, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps36_str18_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9733333333333334
model parameter : 302905
model size : 1.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.373464822769165
Epoch: 1, Steps: 18 | Train Loss: 2.365 Vali Loss: 0.823 Vali Acc: 0.943 Test Loss: 0.823 Test Acc: 0.943
Validation loss decreased (inf --> -0.943325).  Saving model ...
Epoch: 2 cost time: 2.006013870239258
Epoch: 2, Steps: 18 | Train Loss: 0.179 Vali Loss: 0.132 Vali Acc: 0.957 Test Loss: 0.132 Test Acc: 0.957
Validation loss decreased (-0.943325 --> -0.956665).  Saving model ...
Epoch: 3 cost time: 2.2476589679718018
Epoch: 3, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.117 Vali Acc: 0.973 Test Loss: 0.117 Test Acc: 0.973
Validation loss decreased (-0.956665 --> -0.973332).  Saving model ...
Epoch: 4 cost time: 2.0563788414001465
Epoch: 4, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.344 Vali Acc: 0.923 Test Loss: 0.344 Test Acc: 0.923
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.877713680267334
Epoch: 5, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.150 Vali Acc: 0.957 Test Loss: 0.150 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.5698614120483398
Epoch: 6, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.132 Vali Acc: 0.970 Test Loss: 0.132 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.7774457931518555
Epoch: 7, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.136 Vali Acc: 0.963 Test Loss: 0.136 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.815613031387329
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.131 Vali Acc: 0.967 Test Loss: 0.131 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.118333578109741
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.124 Vali Acc: 0.967 Test Loss: 0.124 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.9676299095153809
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.122 Vali Acc: 0.970 Test Loss: 0.122 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.0532844066619873
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.970 Test Loss: 0.119 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.8981950283050537
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 13 cost time: 2.0083835124969482
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 1.9645073413848877
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5896756649017334
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.6447489261627197
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 2.1996660232543945
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.980 Test Loss: 0.113 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 1.913607120513916
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.980 Test Loss: 0.113 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 1.9833683967590332
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 1.825439691543579
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 1.749438762664795
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 1.6921076774597168
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 1.7251813411712646
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.980 Test Loss: 0.110 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 1.7623322010040283
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.980 Test Loss: 0.110 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 1.6232702732086182
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.980 Test Loss: 0.110 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 1.9208204746246338
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.109 Vali Acc: 0.980 Test Loss: 0.109 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 2.0068700313568115
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.109 Vali Acc: 0.980 Test Loss: 0.109 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 1.9682157039642334
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.109 Vali Acc: 0.980 Test Loss: 0.109 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 2.1622140407562256
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.109 Vali Acc: 0.980 Test Loss: 0.109 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 1.95052170753479
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.109 Vali Acc: 0.980 Test Loss: 0.109 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 31 cost time: 1.9716079235076904
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.108 Vali Acc: 0.980 Test Loss: 0.108 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 32 cost time: 1.9799299240112305
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.108 Vali Acc: 0.980 Test Loss: 0.108 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 33 cost time: 1.7204301357269287
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.108 Vali Acc: 0.980 Test Loss: 0.108 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 34 cost time: 1.785158395767212
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.108 Vali Acc: 0.980 Test Loss: 0.108 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 35 cost time: 1.899782419204712
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.108 Vali Acc: 0.980 Test Loss: 0.108 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 36 cost time: 1.924356460571289
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.108 Vali Acc: 0.980 Test Loss: 0.108 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 37 cost time: 2.194981813430786
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.108 Vali Acc: 0.980 Test Loss: 0.108 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 38 cost time: 1.9681575298309326
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.108 Vali Acc: 0.980 Test Loss: 0.108 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.9467921257019043
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.108 Vali Acc: 0.980 Test Loss: 0.108 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 40 cost time: 1.9448189735412598
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.108 Vali Acc: 0.983 Test Loss: 0.108 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 41 cost time: 1.9337570667266846
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.108 Vali Acc: 0.983 Test Loss: 0.108 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 42 cost time: 1.8484890460968018
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.983 Test Loss: 0.107 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 43 cost time: 1.5696649551391602
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.983 Test Loss: 0.107 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 44 cost time: 1.799041509628296
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.983 Test Loss: 0.107 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 45 cost time: 1.8498475551605225
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.983 Test Loss: 0.107 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.9865472316741943
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.983 Test Loss: 0.107 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 2.0972201824188232
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.983 Test Loss: 0.107 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.9504122734069824
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.983 Test Loss: 0.107 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 2.110675573348999
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.983 Test Loss: 0.107 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 2.01601243019104
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.983 Test Loss: 0.107 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 5297817
model size : 20.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.750046968460083
Epoch: 1, Steps: 18 | Train Loss: 2.759 Vali Loss: 1.806 Vali Acc: 0.943 Test Loss: 1.806 Test Acc: 0.943
Validation loss decreased (inf --> -0.943315).  Saving model ...
Epoch: 2 cost time: 1.741394281387329
Epoch: 2, Steps: 18 | Train Loss: 0.462 Vali Loss: 0.201 Vali Acc: 0.953 Test Loss: 0.201 Test Acc: 0.953
Validation loss decreased (-0.943315 --> -0.953331).  Saving model ...
Epoch: 3 cost time: 1.6431846618652344
Epoch: 3, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.111 Vali Acc: 0.970 Test Loss: 0.111 Test Acc: 0.970
Validation loss decreased (-0.953331 --> -0.969999).  Saving model ...
Epoch: 4 cost time: 1.7434659004211426
Epoch: 4, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
Validation loss decreased (-0.969999 --> -0.976666).  Saving model ...
Epoch: 5 cost time: 1.7460994720458984
Epoch: 5, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 6 cost time: 1.2927875518798828
Epoch: 6, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 7 cost time: 1.1445326805114746
Epoch: 7, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 8 cost time: 1.0138123035430908
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 1.3077168464660645
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 1.6763505935668945
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 1.6461756229400635
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 1.705456018447876
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6174168586730957
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 1.5795080661773682
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 1.5636518001556396
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 1.3669216632843018
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 1.3843355178833008
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 1.4633655548095703
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.6257259845733643
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.504943609237671
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 21 cost time: 1.7227869033813477
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 22 cost time: 1.5249178409576416
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 23 cost time: 1.6055707931518555
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.513737440109253
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.6549406051635742
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.3106162548065186
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.253091812133789
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.4556901454925537
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.4907035827636719
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.677760362625122
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.600273609161377
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.779815673828125
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 4261529
model size : 16.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.655397891998291
Epoch: 1, Steps: 18 | Train Loss: 2.966 Vali Loss: 2.305 Vali Acc: 0.913 Test Loss: 2.305 Test Acc: 0.913
Validation loss decreased (inf --> -0.913310).  Saving model ...
Epoch: 2 cost time: 1.513847827911377
Epoch: 2, Steps: 18 | Train Loss: 0.992 Vali Loss: 0.345 Vali Acc: 0.967 Test Loss: 0.345 Test Acc: 0.967
Validation loss decreased (-0.913310 --> -0.966663).  Saving model ...
Epoch: 3 cost time: 1.4767017364501953
Epoch: 3, Steps: 18 | Train Loss: 0.064 Vali Loss: 0.134 Vali Acc: 0.963 Test Loss: 0.134 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3543753623962402
Epoch: 4, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.115 Vali Acc: 0.970 Test Loss: 0.115 Test Acc: 0.970
Validation loss decreased (-0.966663 --> -0.969999).  Saving model ...
Epoch: 5 cost time: 1.5117464065551758
Epoch: 5, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.110 Vali Acc: 0.970 Test Loss: 0.110 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 6 cost time: 1.4484195709228516
Epoch: 6, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 7 cost time: 1.525508165359497
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 8 cost time: 1.4137332439422607
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 9 cost time: 1.3345773220062256
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 1.3227043151855469
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 1.4746460914611816
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 12 cost time: 1.4923429489135742
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 13 cost time: 1.537384033203125
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 14 cost time: 1.4470791816711426
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 1.5035936832427979
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.560971975326538
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 1.4656763076782227
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 1.424006700515747
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.259598970413208
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1440794467926025
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.4063475131988525
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.4472172260284424
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.4326894283294678
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 1.3712568283081055
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 1.425539255142212
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.7009623050689697
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.588921070098877
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.4178595542907715
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.341881275177002
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.51483154296875
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.4886815547943115
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.4961028099060059
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.6404228210449219
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.4889047145843506
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 3916313
model size : 15.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.551551342010498
Epoch: 1, Steps: 18 | Train Loss: 2.978 Vali Loss: 2.501 Vali Acc: 0.833 Test Loss: 2.501 Test Acc: 0.833
Validation loss decreased (inf --> -0.833308).  Saving model ...
Epoch: 2 cost time: 1.5640618801116943
Epoch: 2, Steps: 18 | Train Loss: 1.285 Vali Loss: 0.572 Vali Acc: 0.970 Test Loss: 0.572 Test Acc: 0.970
Validation loss decreased (-0.833308 --> -0.969994).  Saving model ...
Epoch: 3 cost time: 1.4128520488739014
Epoch: 3, Steps: 18 | Train Loss: 0.151 Vali Loss: 0.198 Vali Acc: 0.947 Test Loss: 0.198 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5002665519714355
Epoch: 4, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
Validation loss decreased (-0.969994 --> -0.973332).  Saving model ...
Epoch: 5 cost time: 1.4627962112426758
Epoch: 5, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 6 cost time: 1.4678268432617188
Epoch: 6, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 7 cost time: 1.431647777557373
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 8 cost time: 1.4238028526306152
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.349299669265747
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 1.2074618339538574
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 1.5800864696502686
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 1.430410385131836
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 1.5776152610778809
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 1.4314148426055908
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 1.5587098598480225
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4454774856567383
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.4557907581329346
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.5324790477752686
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.2377617359161377
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.2663671970367432
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.4693052768707275
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.5011589527130127
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.3088526725769043
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.6254382133483887
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 3744025
model size : 14.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps22_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.55441951751709
Epoch: 1, Steps: 18 | Train Loss: 3.048 Vali Loss: 2.584 Vali Acc: 0.797 Test Loss: 2.584 Test Acc: 0.797
Validation loss decreased (inf --> -0.796641).  Saving model ...
Epoch: 2 cost time: 0.9253926277160645
Epoch: 2, Steps: 18 | Train Loss: 1.502 Vali Loss: 0.743 Vali Acc: 0.960 Test Loss: 0.743 Test Acc: 0.960
Validation loss decreased (-0.796641 --> -0.959993).  Saving model ...
Epoch: 3 cost time: 0.9690685272216797
Epoch: 3, Steps: 18 | Train Loss: 0.197 Vali Loss: 0.156 Vali Acc: 0.970 Test Loss: 0.156 Test Acc: 0.970
Validation loss decreased (-0.959993 --> -0.969998).  Saving model ...
Epoch: 4 cost time: 0.937952995300293
Epoch: 4, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.115 Vali Acc: 0.967 Test Loss: 0.115 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8778612613677979
Epoch: 5, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
Validation loss decreased (-0.969998 --> -0.973332).  Saving model ...
Epoch: 6 cost time: 0.8894104957580566
Epoch: 6, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8931493759155273
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7986781597137451
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.2831666469573975
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 1.2634360790252686
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 1.2572031021118164
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 1.3094637393951416
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 1.3656697273254395
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 1.3092615604400635
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 1.3362658023834229
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 1.267012357711792
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 1.1465356349945068
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 1.0092334747314453
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0804016590118408
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 1.2579808235168457
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.3248910903930664
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.1871097087860107
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.3155803680419922
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.2000386714935303
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.3121709823608398
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.2490332126617432
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 1.3259072303771973
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.134962797164917
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 1.2339720726013184
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.1935060024261475
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.3115973472595215
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.341294288635254
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.1951777935028076
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.1574337482452393
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.166304349899292
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.142944097518921
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 37 cost time: 1.1950955390930176
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.033374309539795
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.1987087726593018
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.1156346797943115
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.346461296081543
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.2004196643829346
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.329610824584961
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.2325983047485352
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 1.2995145320892334
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 1.3191883563995361
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps22_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 3629721
model size : 13.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps29_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.3176751136779785
Epoch: 1, Steps: 18 | Train Loss: 3.075 Vali Loss: 2.709 Vali Acc: 0.780 Test Loss: 2.709 Test Acc: 0.780
Validation loss decreased (inf --> -0.779973).  Saving model ...
Epoch: 2 cost time: 1.3236088752746582
Epoch: 2, Steps: 18 | Train Loss: 1.805 Vali Loss: 1.101 Vali Acc: 0.953 Test Loss: 1.101 Test Acc: 0.953
Validation loss decreased (-0.779973 --> -0.953322).  Saving model ...
Epoch: 3 cost time: 1.2036128044128418
Epoch: 3, Steps: 18 | Train Loss: 0.382 Vali Loss: 0.212 Vali Acc: 0.960 Test Loss: 0.212 Test Acc: 0.960
Validation loss decreased (-0.953322 --> -0.959998).  Saving model ...
Epoch: 4 cost time: 1.2834889888763428
Epoch: 4, Steps: 18 | Train Loss: 0.046 Vali Loss: 0.117 Vali Acc: 0.973 Test Loss: 0.117 Test Acc: 0.973
Validation loss decreased (-0.959998 --> -0.973332).  Saving model ...
Epoch: 5 cost time: 1.248471975326538
Epoch: 5, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4257047176361084
Epoch: 6, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 1.3547990322113037
Epoch: 7, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.973332 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 1.4312725067138672
Epoch: 8, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 1.1777055263519287
Epoch: 9, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 1.2486424446105957
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 1.3849451541900635
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.393918514251709
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2416727542877197
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 1.3611915111541748
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 1.276853084564209
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3324992656707764
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.2473764419555664
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.3112707138061523
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.087160587310791
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 1.240821123123169
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 1.2698652744293213
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.3997776508331299
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 1.3416063785552979
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.4928267002105713
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 1.2805843353271484
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.425994873046875
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.3100569248199463
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.4856188297271729
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.3563952445983887
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.1525957584381104
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.0846047401428223
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.981665849685669
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.1765940189361572
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.1321139335632324
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps29_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 3515417
model size : 13.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps36_str18_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.3093245029449463
Epoch: 1, Steps: 18 | Train Loss: 3.115 Vali Loss: 2.815 Vali Acc: 0.677 Test Loss: 2.815 Test Acc: 0.677
Validation loss decreased (inf --> -0.676639).  Saving model ...
Epoch: 2 cost time: 1.216569423675537
Epoch: 2, Steps: 18 | Train Loss: 2.091 Vali Loss: 1.464 Vali Acc: 0.943 Test Loss: 1.464 Test Acc: 0.943
Validation loss decreased (-0.676639 --> -0.943319).  Saving model ...
Epoch: 3 cost time: 1.1596026420593262
Epoch: 3, Steps: 18 | Train Loss: 0.679 Vali Loss: 0.329 Vali Acc: 0.967 Test Loss: 0.329 Test Acc: 0.967
Validation loss decreased (-0.943319 --> -0.966663).  Saving model ...
Epoch: 4 cost time: 1.3658995628356934
Epoch: 4, Steps: 18 | Train Loss: 0.109 Vali Loss: 0.166 Vali Acc: 0.957 Test Loss: 0.166 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2682113647460938
Epoch: 5, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
Validation loss decreased (-0.966663 --> -0.969999).  Saving model ...
Epoch: 6 cost time: 1.4633891582489014
Epoch: 6, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 7 cost time: 1.2794787883758545
Epoch: 7, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 8 cost time: 1.2377879619598389
Epoch: 8, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 9 cost time: 1.1869173049926758
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 10 cost time: 1.2924790382385254
Epoch: 10, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 11 cost time: 1.353086233139038
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.969999 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 1.260627269744873
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 1.1520628929138184
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 1.3737549781799316
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 1.381502628326416
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2978310585021973
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.2462027072906494
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.2948617935180664
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.353701114654541
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.2843616008758545
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.3652281761169434
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 1.2144649028778076
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 1.1830708980560303
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 1.1041436195373535
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 1.1668791770935059
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.2552344799041748
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 1.281567096710205
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.313460111618042
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.3639132976531982
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.270240068435669
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.3159635066986084
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.2883343696594238
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 33 cost time: 1.195840835571289
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.101217269897461
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.0079703330993652
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.2739813327789307
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.3911373615264893
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.1468708515167236
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.2455670833587646
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.1601200103759766
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.2642605304718018
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.243375539779663
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 43 cost time: 1.344994068145752
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.0256149768829346
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.9631960391998291
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.0598926544189453
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.2315759658813477
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.19140625
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 1.242833137512207
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 1.3147618770599365
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps36_str18_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 3458713
model size : 13.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.116492748260498
Epoch: 1, Steps: 18 | Train Loss: 2.797 Vali Loss: 1.830 Vali Acc: 0.923 Test Loss: 1.830 Test Acc: 0.923
Validation loss decreased (inf --> -0.923315).  Saving model ...
Epoch: 2 cost time: 1.006870985031128
Epoch: 2, Steps: 18 | Train Loss: 0.566 Vali Loss: 0.209 Vali Acc: 0.963 Test Loss: 0.209 Test Acc: 0.963
Validation loss decreased (-0.923315 --> -0.963331).  Saving model ...
Epoch: 3 cost time: 0.9346344470977783
Epoch: 3, Steps: 18 | Train Loss: 0.036 Vali Loss: 0.157 Vali Acc: 0.950 Test Loss: 0.157 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.125359058380127
Epoch: 4, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
Validation loss decreased (-0.963331 --> -0.973332).  Saving model ...
Epoch: 5 cost time: 1.1757948398590088
Epoch: 5, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 6 cost time: 1.169649600982666
Epoch: 6, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1562867164611816
Epoch: 7, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 1.1910028457641602
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 1.1518325805664062
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 1.2179200649261475
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 0.9934298992156982
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 0.9692611694335938
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 1.1951422691345215
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 1.1600472927093506
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 1.1474266052246094
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 1.2331368923187256
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 1.1796045303344727
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1512041091918945
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.2724997997283936
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.1382288932800293
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.2639179229736328
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.078718900680542
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 1.0018973350524902
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 1.0428273677825928
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.1333317756652832
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.0788214206695557
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.2611143589019775
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.2561054229736328
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.2771034240722656
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.1772470474243164
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.241511583328247
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.918569803237915
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.9499258995056152
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 1895257
model size : 7.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.1591551303863525
Epoch: 1, Steps: 18 | Train Loss: 3.013 Vali Loss: 2.477 Vali Acc: 0.820 Test Loss: 2.477 Test Acc: 0.820
Validation loss decreased (inf --> -0.819975).  Saving model ...
Epoch: 2 cost time: 0.997229814529419
Epoch: 2, Steps: 18 | Train Loss: 1.329 Vali Loss: 0.628 Vali Acc: 0.953 Test Loss: 0.628 Test Acc: 0.953
Validation loss decreased (-0.819975 --> -0.953327).  Saving model ...
Epoch: 3 cost time: 1.0173382759094238
Epoch: 3, Steps: 18 | Train Loss: 0.171 Vali Loss: 0.144 Vali Acc: 0.967 Test Loss: 0.144 Test Acc: 0.967
Validation loss decreased (-0.953327 --> -0.966665).  Saving model ...
Epoch: 4 cost time: 0.8787517547607422
Epoch: 4, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
Validation loss decreased (-0.966665 --> -0.973332).  Saving model ...
Epoch: 5 cost time: 0.9038362503051758
Epoch: 5, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
Validation loss decreased (-0.973332 --> -0.979999).  Saving model ...
Epoch: 6 cost time: 0.8534340858459473
Epoch: 6, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 1.085646152496338
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 1.1056764125823975
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 1.1257011890411377
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 1.1600441932678223
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 1.0748577117919922
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 1.169712781906128
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 1.135049819946289
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 1.1251628398895264
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 0.9264638423919678
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 0.9252610206604004
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8887546062469482
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9508461952209473
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 1.03836989402771
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9279248714447021
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.9928879737854004
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.1331515312194824
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 1.0360820293426514
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0944693088531494
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.7880373001098633
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.9094665050506592
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.9527695178985596
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.01827073097229
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.1045010089874268
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.119614839553833
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.0006911754608154
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.1623103618621826
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 1377113
model size : 5.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.288034677505493
Epoch: 1, Steps: 18 | Train Loss: 3.038 Vali Loss: 2.684 Vali Acc: 0.777 Test Loss: 2.684 Test Acc: 0.777
Validation loss decreased (inf --> -0.776640).  Saving model ...
Epoch: 2 cost time: 0.9639296531677246
Epoch: 2, Steps: 18 | Train Loss: 1.779 Vali Loss: 1.111 Vali Acc: 0.937 Test Loss: 1.111 Test Acc: 0.937
Validation loss decreased (-0.776640 --> -0.936656).  Saving model ...
Epoch: 3 cost time: 0.9680445194244385
Epoch: 3, Steps: 18 | Train Loss: 0.386 Vali Loss: 0.224 Vali Acc: 0.973 Test Loss: 0.224 Test Acc: 0.973
Validation loss decreased (-0.936656 --> -0.973331).  Saving model ...
Epoch: 4 cost time: 0.9677503108978271
Epoch: 4, Steps: 18 | Train Loss: 0.043 Vali Loss: 0.123 Vali Acc: 0.970 Test Loss: 0.123 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9623358249664307
Epoch: 5, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
Validation loss decreased (-0.973331 --> -0.973332).  Saving model ...
Epoch: 6 cost time: 1.099125862121582
Epoch: 6, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 1.0051403045654297
Epoch: 7, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 1.0700764656066895
Epoch: 8, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 1.0131924152374268
Epoch: 9, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 0.9166035652160645
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 0.8497509956359863
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8360228538513184
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 0.9836571216583252
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 0.9783608913421631
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 0.977799654006958
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 0.8591005802154541
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 0.9165840148925781
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8760154247283936
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 0.9249794483184814
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 1.0188143253326416
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 0.8124227523803711
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 0.7134964466094971
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 0.867476224899292
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 0.8145525455474854
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 0.7720992565155029
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.820004940032959
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.747288703918457
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.7570087909698486
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.8010003566741943
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.8281800746917725
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.9193243980407715
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.0153295993804932
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.978684663772583
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.060760498046875
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 35 cost time: 0.9175798892974854
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.9852960109710693
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 37 cost time: 0.94765305519104
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 38 cost time: 1.0065479278564453
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.0220770835876465
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.8487153053283691
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.8816287517547607
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.9236752986907959
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.9734010696411133
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.0753300189971924
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.9474339485168457
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 1.0436091423034668
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 1.0224614143371582
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 1204505
model size : 4.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.9352784156799316
Epoch: 1, Steps: 18 | Train Loss: 3.061 Vali Loss: 2.828 Vali Acc: 0.650 Test Loss: 2.828 Test Acc: 0.650
Validation loss decreased (inf --> -0.649972).  Saving model ...
Epoch: 2 cost time: 0.9213171005249023
Epoch: 2, Steps: 18 | Train Loss: 2.103 Vali Loss: 1.579 Vali Acc: 0.960 Test Loss: 1.579 Test Acc: 0.960
Validation loss decreased (-0.649972 --> -0.959984).  Saving model ...
Epoch: 3 cost time: 0.861893892288208
Epoch: 3, Steps: 18 | Train Loss: 0.730 Vali Loss: 0.384 Vali Acc: 0.963 Test Loss: 0.384 Test Acc: 0.963
Validation loss decreased (-0.959984 --> -0.963329).  Saving model ...
Epoch: 4 cost time: 0.8223965167999268
Epoch: 4, Steps: 18 | Train Loss: 0.117 Vali Loss: 0.149 Vali Acc: 0.970 Test Loss: 0.149 Test Acc: 0.970
Validation loss decreased (-0.963329 --> -0.969999).  Saving model ...
Epoch: 5 cost time: 0.8989293575286865
Epoch: 5, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.120 Vali Acc: 0.970 Test Loss: 0.120 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 6 cost time: 0.8712160587310791
Epoch: 6, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
Validation loss decreased (-0.969999 --> -0.976666).  Saving model ...
Epoch: 7 cost time: 0.9201750755310059
Epoch: 7, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 8 cost time: 0.887568473815918
Epoch: 8, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 0.891101598739624
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 0.8626339435577393
Epoch: 10, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 0.947868824005127
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 0.8082394599914551
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 0.8087267875671387
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 0.7059056758880615
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 0.9002237319946289
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 0.8935718536376953
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8869407176971436
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8815476894378662
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.8432140350341797
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 0.8174636363983154
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 0.9384262561798096
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9954907894134521
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.8712501525878906
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.8563470840454102
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.8170654773712158
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.7834677696228027
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.9146542549133301
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.9923624992370605
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.9385843276977539
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.933610200881958
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 1118361
model size : 4.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps22_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.9345595836639404
Epoch: 1, Steps: 18 | Train Loss: 3.105 Vali Loss: 2.895 Vali Acc: 0.550 Test Loss: 2.895 Test Acc: 0.550
Validation loss decreased (inf --> -0.549971).  Saving model ...
Epoch: 2 cost time: 0.7632381916046143
Epoch: 2, Steps: 18 | Train Loss: 2.312 Vali Loss: 1.843 Vali Acc: 0.910 Test Loss: 1.843 Test Acc: 0.910
Validation loss decreased (-0.549971 --> -0.909982).  Saving model ...
Epoch: 3 cost time: 0.9550316333770752
Epoch: 3, Steps: 18 | Train Loss: 1.030 Vali Loss: 0.579 Vali Acc: 0.957 Test Loss: 0.579 Test Acc: 0.957
Validation loss decreased (-0.909982 --> -0.956661).  Saving model ...
Epoch: 4 cost time: 0.8435595035552979
Epoch: 4, Steps: 18 | Train Loss: 0.204 Vali Loss: 0.187 Vali Acc: 0.963 Test Loss: 0.187 Test Acc: 0.963
Validation loss decreased (-0.956661 --> -0.963331).  Saving model ...
Epoch: 5 cost time: 0.9721195697784424
Epoch: 5, Steps: 18 | Train Loss: 0.039 Vali Loss: 0.127 Vali Acc: 0.973 Test Loss: 0.127 Test Acc: 0.973
Validation loss decreased (-0.963331 --> -0.973332).  Saving model ...
Epoch: 6 cost time: 0.8467183113098145
Epoch: 6, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.116 Vali Acc: 0.970 Test Loss: 0.116 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9661765098571777
Epoch: 7, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 8 cost time: 0.897862434387207
Epoch: 8, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 1.0398836135864258
Epoch: 9, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 0.924506664276123
Epoch: 10, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 0.9090094566345215
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 0.8606951236724854
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 0.8024160861968994
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 0.788914680480957
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0241358280181885
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 0.9382331371307373
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 0.9412841796875
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9660811424255371
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9719712734222412
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 0.9626922607421875
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 0.9343502521514893
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 0.9283745288848877
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 0.9571623802185059
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 0.999506950378418
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9013502597808838
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 0.7789962291717529
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.7965850830078125
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.000520944595337
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.9352827072143555
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.0093607902526855
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.9887416362762451
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.9744563102722168
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.9342367649078369
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.0484683513641357
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.926121711730957
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps22_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 1061209
model size : 4.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps29_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.86741304397583
Epoch: 1, Steps: 18 | Train Loss: 3.130 Vali Loss: 2.953 Vali Acc: 0.400 Test Loss: 2.953 Test Acc: 0.400
Validation loss decreased (inf --> -0.399970).  Saving model ...
Epoch: 2 cost time: 1.001521110534668
Epoch: 2, Steps: 18 | Train Loss: 2.474 Vali Loss: 2.122 Vali Acc: 0.873 Test Loss: 2.122 Test Acc: 0.873
Validation loss decreased (-0.399970 --> -0.873312).  Saving model ...
Epoch: 3 cost time: 0.9765925407409668
Epoch: 3, Steps: 18 | Train Loss: 1.412 Vali Loss: 0.969 Vali Acc: 0.940 Test Loss: 0.969 Test Acc: 0.940
Validation loss decreased (-0.873312 --> -0.939990).  Saving model ...
Epoch: 4 cost time: 0.9814286231994629
Epoch: 4, Steps: 18 | Train Loss: 0.452 Vali Loss: 0.312 Vali Acc: 0.963 Test Loss: 0.312 Test Acc: 0.963
Validation loss decreased (-0.939990 --> -0.963330).  Saving model ...
Epoch: 5 cost time: 0.9133415222167969
Epoch: 5, Steps: 18 | Train Loss: 0.106 Vali Loss: 0.160 Vali Acc: 0.970 Test Loss: 0.160 Test Acc: 0.970
Validation loss decreased (-0.963330 --> -0.969998).  Saving model ...
Epoch: 6 cost time: 0.8812143802642822
Epoch: 6, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.123 Vali Acc: 0.970 Test Loss: 0.123 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969999).  Saving model ...
Epoch: 7 cost time: 0.9440157413482666
Epoch: 7, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.110 Vali Acc: 0.970 Test Loss: 0.110 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 8 cost time: 0.7036960124969482
Epoch: 8, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 0.802626371383667
Epoch: 9, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 0.847083568572998
Epoch: 10, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 1.086838960647583
Epoch: 11, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.047893762588501
Epoch: 12, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.0522570610046387
Epoch: 13, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.0859501361846924
Epoch: 14, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.0338387489318848
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 1.0079445838928223
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.081 Vali Acc: 0.973 Test Loss: 0.081 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9849889278411865
Epoch: 17, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 0.9490556716918945
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.973 Test Loss: 0.081 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9559781551361084
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 0.9294085502624512
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.973 Test Loss: 0.080 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9367682933807373
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 0.8235592842102051
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7957022190093994
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.9901871681213379
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.9924681186676025
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 1.0220134258270264
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 0.9808285236358643
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9415433406829834
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.0695750713348389
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.0441310405731201
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.0048713684082031
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 32 cost time: 0.9611935615539551
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.9075195789337158
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 34 cost time: 0.7956728935241699
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 35 cost time: 0.9122030735015869
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.9273722171783447
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.914592981338501
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.011929988861084
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.9218118190765381
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.9527580738067627
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.967228889465332
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.9367196559906006
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.8994450569152832
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.8776485919952393
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.977 Test Loss: 0.074 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps29_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 1004057
model size : 3.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps36_str18_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.1456220149993896
Epoch: 1, Steps: 18 | Train Loss: 3.159 Vali Loss: 3.026 Vali Acc: 0.277 Test Loss: 3.026 Test Acc: 0.277
Validation loss decreased (inf --> -0.276636).  Saving model ...
Epoch: 2 cost time: 0.9434499740600586
Epoch: 2, Steps: 18 | Train Loss: 2.659 Vali Loss: 2.375 Vali Acc: 0.797 Test Loss: 2.375 Test Acc: 0.797
Validation loss decreased (-0.276636 --> -0.796643).  Saving model ...
Epoch: 3 cost time: 0.9878418445587158
Epoch: 3, Steps: 18 | Train Loss: 1.767 Vali Loss: 1.339 Vali Acc: 0.927 Test Loss: 1.339 Test Acc: 0.927
Validation loss decreased (-0.796643 --> -0.926653).  Saving model ...
Epoch: 4 cost time: 0.9987442493438721
Epoch: 4, Steps: 18 | Train Loss: 0.751 Vali Loss: 0.479 Vali Acc: 0.957 Test Loss: 0.479 Test Acc: 0.957
Validation loss decreased (-0.926653 --> -0.956662).  Saving model ...
Epoch: 5 cost time: 0.9492630958557129
Epoch: 5, Steps: 18 | Train Loss: 0.208 Vali Loss: 0.207 Vali Acc: 0.963 Test Loss: 0.207 Test Acc: 0.963
Validation loss decreased (-0.956662 --> -0.963331).  Saving model ...
Epoch: 6 cost time: 1.0191071033477783
Epoch: 6, Steps: 18 | Train Loss: 0.065 Vali Loss: 0.141 Vali Acc: 0.977 Test Loss: 0.141 Test Acc: 0.977
Validation loss decreased (-0.963331 --> -0.976665).  Saving model ...
Epoch: 7 cost time: 0.7927141189575195
Epoch: 7, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.124 Vali Acc: 0.973 Test Loss: 0.124 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.892078161239624
Epoch: 8, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8589465618133545
Epoch: 9, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.9748635292053223
Epoch: 10, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.017284870147705
Epoch: 11, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.963322639465332
Epoch: 12, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 0.9754607677459717
Epoch: 13, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 0.9647510051727295
Epoch: 14, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9046263694763184
Epoch: 15, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9478054046630859
Epoch: 16, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.9217233657836914
Epoch: 17, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.9514656066894531
Epoch: 18, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.0538482666015625
Epoch: 19, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.8241269588470459
Epoch: 20, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.8959815502166748
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.847261905670166
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.0514466762542725
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps36_str18_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 975705
model size : 3.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.8794350624084473
Epoch: 1, Steps: 18 | Train Loss: 2.960 Vali Loss: 2.367 Vali Acc: 0.900 Test Loss: 2.367 Test Acc: 0.900
Validation loss decreased (inf --> -0.899976).  Saving model ...
Epoch: 2 cost time: 0.7344727516174316
Epoch: 2, Steps: 18 | Train Loss: 1.243 Vali Loss: 0.646 Vali Acc: 0.960 Test Loss: 0.646 Test Acc: 0.960
Validation loss decreased (-0.899976 --> -0.959994).  Saving model ...
Epoch: 3 cost time: 0.7444908618927002
Epoch: 3, Steps: 18 | Train Loss: 0.180 Vali Loss: 0.178 Vali Acc: 0.967 Test Loss: 0.178 Test Acc: 0.967
Validation loss decreased (-0.959994 --> -0.966665).  Saving model ...
Epoch: 4 cost time: 0.6925365924835205
Epoch: 4, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.131 Vali Acc: 0.960 Test Loss: 0.131 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8509149551391602
Epoch: 5, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
Validation loss decreased (-0.966665 --> -0.973332).  Saving model ...
Epoch: 6 cost time: 0.9350705146789551
Epoch: 6, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 7 cost time: 0.8471028804779053
Epoch: 7, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 8 cost time: 0.9313454627990723
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 0.8278284072875977
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8269970417022705
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 0.8009305000305176
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 0.970592737197876
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 0.8034040927886963
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 0.7982697486877441
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 0.7406854629516602
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7435870170593262
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 0.7900619506835938
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 0.8438930511474609
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 0.948345422744751
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 0.8660345077514648
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 0.8770015239715576
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8903312683105469
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.848372220993042
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.8677611351013184
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.8741958141326904
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.8174898624420166
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 0.625056266784668
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 0.7854845523834229
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 0.7387392520904541
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 0.8568193912506104
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8738017082214355
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.8280293941497803
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.8130013942718506
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 34 cost time: 0.7930400371551514
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.7677168846130371
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 36 cost time: 0.7554581165313721
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.809302568435669
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.7990250587463379
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.8375883102416992
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.723806619644165
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.7118439674377441
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.6715667247772217
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.8487222194671631
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.8152744770050049
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.9037351608276367
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 759225
model size : 2.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.6924927234649658
Epoch: 1, Steps: 18 | Train Loss: 3.095 Vali Loss: 2.781 Vali Acc: 0.583 Test Loss: 2.781 Test Acc: 0.583
Validation loss decreased (inf --> -0.583306).  Saving model ...
Epoch: 2 cost time: 0.719351053237915
Epoch: 2, Steps: 18 | Train Loss: 2.117 Vali Loss: 1.576 Vali Acc: 0.937 Test Loss: 1.576 Test Acc: 0.937
Validation loss decreased (-0.583306 --> -0.936651).  Saving model ...
Epoch: 3 cost time: 0.7005858421325684
Epoch: 3, Steps: 18 | Train Loss: 0.798 Vali Loss: 0.473 Vali Acc: 0.957 Test Loss: 0.473 Test Acc: 0.957
Validation loss decreased (-0.936651 --> -0.956662).  Saving model ...
Epoch: 4 cost time: 0.8144776821136475
Epoch: 4, Steps: 18 | Train Loss: 0.151 Vali Loss: 0.176 Vali Acc: 0.970 Test Loss: 0.176 Test Acc: 0.970
Validation loss decreased (-0.956662 --> -0.969998).  Saving model ...
Epoch: 5 cost time: 0.8373334407806396
Epoch: 5, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.127 Vali Acc: 0.980 Test Loss: 0.127 Test Acc: 0.980
Validation loss decreased (-0.969998 --> -0.979999).  Saving model ...
Epoch: 6 cost time: 0.7876591682434082
Epoch: 6, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8209576606750488
Epoch: 7, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8304719924926758
Epoch: 8, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.8031840324401855
Epoch: 9, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.8512320518493652
Epoch: 10, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.7448611259460449
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.7726497650146484
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.8126378059387207
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.6577973365783691
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.764026403427124
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 500153
model size : 1.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.7934153079986572
Epoch: 1, Steps: 18 | Train Loss: 3.124 Vali Loss: 2.955 Vali Acc: 0.450 Test Loss: 2.955 Test Acc: 0.450
Validation loss decreased (inf --> -0.449970).  Saving model ...
Epoch: 2 cost time: 0.7211189270019531
Epoch: 2, Steps: 18 | Train Loss: 2.534 Vali Loss: 2.179 Vali Acc: 0.900 Test Loss: 2.179 Test Acc: 0.900
Validation loss decreased (-0.449970 --> -0.899978).  Saving model ...
Epoch: 3 cost time: 0.7568073272705078
Epoch: 3, Steps: 18 | Train Loss: 1.482 Vali Loss: 1.030 Vali Acc: 0.960 Test Loss: 1.030 Test Acc: 0.960
Validation loss decreased (-0.899978 --> -0.959990).  Saving model ...
Epoch: 4 cost time: 0.7882988452911377
Epoch: 4, Steps: 18 | Train Loss: 0.496 Vali Loss: 0.347 Vali Acc: 0.960 Test Loss: 0.347 Test Acc: 0.960
Validation loss decreased (-0.959990 --> -0.959997).  Saving model ...
Epoch: 5 cost time: 0.8212473392486572
Epoch: 5, Steps: 18 | Train Loss: 0.107 Vali Loss: 0.182 Vali Acc: 0.970 Test Loss: 0.182 Test Acc: 0.970
Validation loss decreased (-0.959997 --> -0.969998).  Saving model ...
Epoch: 6 cost time: 0.6459290981292725
Epoch: 6, Steps: 18 | Train Loss: 0.035 Vali Loss: 0.141 Vali Acc: 0.970 Test Loss: 0.141 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969999).  Saving model ...
Epoch: 7 cost time: 0.7589936256408691
Epoch: 7, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.122 Vali Acc: 0.977 Test Loss: 0.122 Test Acc: 0.977
Validation loss decreased (-0.969999 --> -0.976665).  Saving model ...
Epoch: 8 cost time: 0.6336209774017334
Epoch: 8, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.115 Vali Acc: 0.980 Test Loss: 0.115 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 0.777256965637207
Epoch: 9, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 0.7349894046783447
Epoch: 10, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7816908359527588
Epoch: 11, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7021729946136475
Epoch: 12, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.8148150444030762
Epoch: 13, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.7880527973175049
Epoch: 14, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 0.7938299179077148
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 0.8154759407043457
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 0.7096662521362305
Epoch: 17, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 0.7513437271118164
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 0.7655642032623291
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 0.6335659027099609
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 0.5844674110412598
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 0.6603293418884277
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 0.7454140186309814
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 0.6742863655090332
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 0.7386929988861084
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 0.69240403175354
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 0.7213320732116699
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 0.6920249462127686
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 0.7304205894470215
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 0.8061103820800781
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.7747399806976318
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.7450380325317383
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 33 cost time: 0.7300300598144531
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 34 cost time: 0.6561930179595947
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 35 cost time: 0.6749148368835449
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.8084876537322998
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.767509937286377
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 38 cost time: 0.7372989654541016
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 39 cost time: 0.8038206100463867
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.7456498146057129
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.7129037380218506
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.6968884468078613
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 43 cost time: 0.6876592636108398
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.8178486824035645
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.7851426601409912
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.7277705669403076
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.6922311782836914
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.7064332962036133
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.6253452301025391
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.7624661922454834
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 413849
model size : 1.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.9079210758209229
Epoch: 1, Steps: 18 | Train Loss: 3.212 Vali Loss: 3.065 Vali Acc: 0.250 Test Loss: 3.065 Test Acc: 0.250
Validation loss decreased (inf --> -0.249969).  Saving model ...
Epoch: 2 cost time: 0.7655870914459229
Epoch: 2, Steps: 18 | Train Loss: 2.736 Vali Loss: 2.491 Vali Acc: 0.787 Test Loss: 2.491 Test Acc: 0.787
Validation loss decreased (-0.249969 --> -0.786642).  Saving model ...
Epoch: 3 cost time: 0.6958589553833008
Epoch: 3, Steps: 18 | Train Loss: 1.930 Vali Loss: 1.555 Vali Acc: 0.893 Test Loss: 1.555 Test Acc: 0.893
Validation loss decreased (-0.786642 --> -0.893318).  Saving model ...
Epoch: 4 cost time: 0.6740477085113525
Epoch: 4, Steps: 18 | Train Loss: 0.922 Vali Loss: 0.625 Vali Acc: 0.953 Test Loss: 0.625 Test Acc: 0.953
Validation loss decreased (-0.893318 --> -0.953327).  Saving model ...
Epoch: 5 cost time: 0.6617581844329834
Epoch: 5, Steps: 18 | Train Loss: 0.274 Vali Loss: 0.260 Vali Acc: 0.963 Test Loss: 0.260 Test Acc: 0.963
Validation loss decreased (-0.953327 --> -0.963331).  Saving model ...
Epoch: 6 cost time: 0.814445972442627
Epoch: 6, Steps: 18 | Train Loss: 0.077 Vali Loss: 0.168 Vali Acc: 0.970 Test Loss: 0.168 Test Acc: 0.970
Validation loss decreased (-0.963331 --> -0.969998).  Saving model ...
Epoch: 7 cost time: 0.7368965148925781
Epoch: 7, Steps: 18 | Train Loss: 0.035 Vali Loss: 0.143 Vali Acc: 0.973 Test Loss: 0.143 Test Acc: 0.973
Validation loss decreased (-0.969998 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 0.75634765625
Epoch: 8, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.129 Vali Acc: 0.977 Test Loss: 0.129 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 9 cost time: 0.8108654022216797
Epoch: 9, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7563395500183105
Epoch: 10, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7842288017272949
Epoch: 11, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.851494550704956
Epoch: 12, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 0.7538599967956543
Epoch: 13, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 0.8247256278991699
Epoch: 14, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 0.8523452281951904
Epoch: 15, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 0.74025559425354
Epoch: 16, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 0.7223973274230957
Epoch: 17, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 0.7237472534179688
Epoch: 18, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 0.794170618057251
Epoch: 19, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7539708614349365
Epoch: 20, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 0.8215043544769287
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 0.7987880706787109
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7314059734344482
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 0.735314130783081
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 0.8309793472290039
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.765195369720459
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.8259618282318115
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 0.7627151012420654
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 0.7121684551239014
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 0.8442366123199463
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8173527717590332
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.7115845680236816
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 33 cost time: 0.8071093559265137
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 34 cost time: 0.7007837295532227
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.8417928218841553
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.7786293029785156
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.8200609683990479
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.7355496883392334
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.8078527450561523
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.8160586357116699
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.7031702995300293
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.6929647922515869
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.7688512802124023
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 370777
model size : 1.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps22_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.7316021919250488
Epoch: 1, Steps: 18 | Train Loss: 3.231 Vali Loss: 3.093 Vali Acc: 0.177 Test Loss: 3.093 Test Acc: 0.177
Validation loss decreased (inf --> -0.176636).  Saving model ...
Epoch: 2 cost time: 0.7488408088684082
Epoch: 2, Steps: 18 | Train Loss: 2.828 Vali Loss: 2.583 Vali Acc: 0.757 Test Loss: 2.583 Test Acc: 0.757
Validation loss decreased (-0.176636 --> -0.756641).  Saving model ...
Epoch: 3 cost time: 0.7083296775817871
Epoch: 3, Steps: 18 | Train Loss: 2.129 Vali Loss: 1.744 Vali Acc: 0.907 Test Loss: 1.744 Test Acc: 0.907
Validation loss decreased (-0.756641 --> -0.906649).  Saving model ...
Epoch: 4 cost time: 0.7085282802581787
Epoch: 4, Steps: 18 | Train Loss: 1.210 Vali Loss: 0.825 Vali Acc: 0.950 Test Loss: 0.825 Test Acc: 0.950
Validation loss decreased (-0.906649 --> -0.949992).  Saving model ...
Epoch: 5 cost time: 0.6329998970031738
Epoch: 5, Steps: 18 | Train Loss: 0.433 Vali Loss: 0.326 Vali Acc: 0.960 Test Loss: 0.326 Test Acc: 0.960
Validation loss decreased (-0.949992 --> -0.959997).  Saving model ...
Epoch: 6 cost time: 0.7042555809020996
Epoch: 6, Steps: 18 | Train Loss: 0.134 Vali Loss: 0.191 Vali Acc: 0.967 Test Loss: 0.191 Test Acc: 0.967
Validation loss decreased (-0.959997 --> -0.966665).  Saving model ...
Epoch: 7 cost time: 0.7249617576599121
Epoch: 7, Steps: 18 | Train Loss: 0.060 Vali Loss: 0.146 Vali Acc: 0.973 Test Loss: 0.146 Test Acc: 0.973
Validation loss decreased (-0.966665 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 0.7408654689788818
Epoch: 8, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.134 Vali Acc: 0.973 Test Loss: 0.134 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 0.7040715217590332
Epoch: 9, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.122 Vali Acc: 0.973 Test Loss: 0.122 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 0.7641777992248535
Epoch: 10, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 0.7401363849639893
Epoch: 11, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 12 cost time: 0.7162923812866211
Epoch: 12, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 13 cost time: 0.8163149356842041
Epoch: 13, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 14 cost time: 0.7107937335968018
Epoch: 14, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 15 cost time: 0.7442054748535156
Epoch: 15, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 16 cost time: 0.7295200824737549
Epoch: 16, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 17 cost time: 0.6865918636322021
Epoch: 17, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 18 cost time: 0.623985767364502
Epoch: 18, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 19 cost time: 0.6587393283843994
Epoch: 19, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 0.7584497928619385
Epoch: 20, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 0.7251460552215576
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 0.7282595634460449
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 0.702678918838501
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6966109275817871
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 0.8038177490234375
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 0.6593506336212158
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 0.7346456050872803
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 28 cost time: 0.6840806007385254
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7407984733581543
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 30 cost time: 0.6860983371734619
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 31 cost time: 0.6238222122192383
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.6399474143981934
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.7951176166534424
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 34 cost time: 0.7194309234619141
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.7532613277435303
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 36 cost time: 0.7510092258453369
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 37 cost time: 0.6928117275238037
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.7236077785491943
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.7160592079162598
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.7433030605316162
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.670940637588501
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.7523162364959717
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.6866908073425293
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.7061007022857666
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.7222452163696289
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 0.740973949432373
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 47 cost time: 0.7894458770751953
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.7697253227233887
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.7993030548095703
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 50 cost time: 0.7459180355072021
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps22_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 342201
model size : 1.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps29_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.8706560134887695
Epoch: 1, Steps: 18 | Train Loss: 3.224 Vali Loss: 3.115 Vali Acc: 0.210 Test Loss: 3.115 Test Acc: 0.210
Validation loss decreased (inf --> -0.209969).  Saving model ...
Epoch: 2 cost time: 0.7643299102783203
Epoch: 2, Steps: 18 | Train Loss: 2.895 Vali Loss: 2.732 Vali Acc: 0.587 Test Loss: 2.732 Test Acc: 0.587
Validation loss decreased (-0.209969 --> -0.586639).  Saving model ...
Epoch: 3 cost time: 0.7409999370574951
Epoch: 3, Steps: 18 | Train Loss: 2.363 Vali Loss: 2.115 Vali Acc: 0.877 Test Loss: 2.115 Test Acc: 0.877
Validation loss decreased (-0.586639 --> -0.876646).  Saving model ...
Epoch: 4 cost time: 0.7456531524658203
Epoch: 4, Steps: 18 | Train Loss: 1.628 Vali Loss: 1.323 Vali Acc: 0.933 Test Loss: 1.323 Test Acc: 0.933
Validation loss decreased (-0.876646 --> -0.933320).  Saving model ...
Epoch: 5 cost time: 0.8377711772918701
Epoch: 5, Steps: 18 | Train Loss: 0.838 Vali Loss: 0.639 Vali Acc: 0.967 Test Loss: 0.639 Test Acc: 0.967
Validation loss decreased (-0.933320 --> -0.966660).  Saving model ...
Epoch: 6 cost time: 0.7456104755401611
Epoch: 6, Steps: 18 | Train Loss: 0.333 Vali Loss: 0.312 Vali Acc: 0.967 Test Loss: 0.312 Test Acc: 0.967
Validation loss decreased (-0.966660 --> -0.966664).  Saving model ...
Epoch: 7 cost time: 0.7666211128234863
Epoch: 7, Steps: 18 | Train Loss: 0.141 Vali Loss: 0.206 Vali Acc: 0.970 Test Loss: 0.206 Test Acc: 0.970
Validation loss decreased (-0.966664 --> -0.969998).  Saving model ...
Epoch: 8 cost time: 0.7766232490539551
Epoch: 8, Steps: 18 | Train Loss: 0.070 Vali Loss: 0.164 Vali Acc: 0.977 Test Loss: 0.164 Test Acc: 0.977
Validation loss decreased (-0.969998 --> -0.976665).  Saving model ...
Epoch: 9 cost time: 0.8125827312469482
Epoch: 9, Steps: 18 | Train Loss: 0.043 Vali Loss: 0.145 Vali Acc: 0.977 Test Loss: 0.145 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 10 cost time: 0.7253983020782471
Epoch: 10, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.132 Vali Acc: 0.977 Test Loss: 0.132 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 11 cost time: 0.7279078960418701
Epoch: 11, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.119 Vali Acc: 0.977 Test Loss: 0.119 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 12 cost time: 0.7157135009765625
Epoch: 12, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.115 Vali Acc: 0.980 Test Loss: 0.115 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 0.6906299591064453
Epoch: 13, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.109 Vali Acc: 0.980 Test Loss: 0.109 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 0.7273764610290527
Epoch: 14, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 0.6393344402313232
Epoch: 15, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6104357242584229
Epoch: 16, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7283380031585693
Epoch: 17, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.6974790096282959
Epoch: 18, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.6695561408996582
Epoch: 19, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 0.6331725120544434
Epoch: 20, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 0.6700592041015625
Epoch: 21, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 0.6189596652984619
Epoch: 22, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 0.8193838596343994
Epoch: 23, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 0.771228551864624
Epoch: 24, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 0.7945513725280762
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 0.7044074535369873
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 0.7344424724578857
Epoch: 27, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 0.7106320858001709
Epoch: 28, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 0.7832322120666504
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 0.7618513107299805
Epoch: 30, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 31 cost time: 0.7714831829071045
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 32 cost time: 0.6782593727111816
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.6763331890106201
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.6788930892944336
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 35 cost time: 0.7816627025604248
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.7929685115814209
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 37 cost time: 0.7456295490264893
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 38 cost time: 0.8128576278686523
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.7683336734771729
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 40 cost time: 0.6800360679626465
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 41 cost time: 0.7553756237030029
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.7633171081542969
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 43 cost time: 0.7488300800323486
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.7217516899108887
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 45 cost time: 0.6637692451477051
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 46 cost time: 0.6540169715881348
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 47 cost time: 0.669788122177124
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.8066768646240234
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 49 cost time: 0.6887338161468506
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.7691450119018555
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps29_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 313625
model size : 1.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps36_str18_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.6442351341247559
Epoch: 1, Steps: 18 | Train Loss: 3.192 Vali Loss: 3.122 Vali Acc: 0.163 Test Loss: 3.122 Test Acc: 0.163
Validation loss decreased (inf --> -0.163302).  Saving model ...
Epoch: 2 cost time: 0.7756438255310059
Epoch: 2, Steps: 18 | Train Loss: 2.962 Vali Loss: 2.839 Vali Acc: 0.547 Test Loss: 2.839 Test Acc: 0.547
Validation loss decreased (-0.163302 --> -0.546638).  Saving model ...
Epoch: 3 cost time: 0.7465777397155762
Epoch: 3, Steps: 18 | Train Loss: 2.547 Vali Loss: 2.347 Vali Acc: 0.837 Test Loss: 2.347 Test Acc: 0.837
Validation loss decreased (-0.546638 --> -0.836643).  Saving model ...
Epoch: 4 cost time: 0.7178025245666504
Epoch: 4, Steps: 18 | Train Loss: 1.958 Vali Loss: 1.662 Vali Acc: 0.900 Test Loss: 1.662 Test Acc: 0.900
Validation loss decreased (-0.836643 --> -0.899983).  Saving model ...
Epoch: 5 cost time: 0.6849751472473145
Epoch: 5, Steps: 18 | Train Loss: 1.199 Vali Loss: 0.919 Vali Acc: 0.940 Test Loss: 0.919 Test Acc: 0.940
Validation loss decreased (-0.899983 --> -0.939991).  Saving model ...
Epoch: 6 cost time: 0.7162637710571289
Epoch: 6, Steps: 18 | Train Loss: 0.554 Vali Loss: 0.451 Vali Acc: 0.947 Test Loss: 0.451 Test Acc: 0.947
Validation loss decreased (-0.939991 --> -0.946662).  Saving model ...
Epoch: 7 cost time: 0.7658994197845459
Epoch: 7, Steps: 18 | Train Loss: 0.235 Vali Loss: 0.272 Vali Acc: 0.970 Test Loss: 0.272 Test Acc: 0.970
Validation loss decreased (-0.946662 --> -0.969997).  Saving model ...
Epoch: 8 cost time: 0.7279295921325684
Epoch: 8, Steps: 18 | Train Loss: 0.114 Vali Loss: 0.207 Vali Acc: 0.963 Test Loss: 0.207 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7331140041351318
Epoch: 9, Steps: 18 | Train Loss: 0.072 Vali Loss: 0.170 Vali Acc: 0.967 Test Loss: 0.170 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7281625270843506
Epoch: 10, Steps: 18 | Train Loss: 0.047 Vali Loss: 0.153 Vali Acc: 0.970 Test Loss: 0.153 Test Acc: 0.970
Validation loss decreased (-0.969997 --> -0.969998).  Saving model ...
Epoch: 11 cost time: 0.7559318542480469
Epoch: 11, Steps: 18 | Train Loss: 0.035 Vali Loss: 0.136 Vali Acc: 0.970 Test Loss: 0.136 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969999).  Saving model ...
Epoch: 12 cost time: 0.6453771591186523
Epoch: 12, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.127 Vali Acc: 0.973 Test Loss: 0.127 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 13 cost time: 0.6479222774505615
Epoch: 13, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.119 Vali Acc: 0.977 Test Loss: 0.119 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 14 cost time: 0.6833341121673584
Epoch: 14, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 0.7120778560638428
Epoch: 15, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 0.6987428665161133
Epoch: 16, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 0.7322924137115479
Epoch: 17, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7319400310516357
Epoch: 18, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7577030658721924
Epoch: 19, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.7461557388305664
Epoch: 20, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.7174072265625
Epoch: 21, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.7207736968994141
Epoch: 22, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.7681291103363037
Epoch: 23, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.7084424495697021
Epoch: 24, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.6710190773010254
Epoch: 25, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.6766886711120605
Epoch: 26, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps36_str18_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 299449
model size : 1.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.619364023208618
Epoch: 1, Steps: 18 | Train Loss: 1.688 Vali Loss: 0.290 Vali Acc: 0.903 Test Loss: 0.290 Test Acc: 0.903
Validation loss decreased (inf --> -0.903330).  Saving model ...
Epoch: 2 cost time: 1.5467264652252197
Epoch: 2, Steps: 18 | Train Loss: 0.037 Vali Loss: 0.196 Vali Acc: 0.953 Test Loss: 0.196 Test Acc: 0.953
Validation loss decreased (-0.903330 --> -0.953331).  Saving model ...
Epoch: 3 cost time: 1.6463251113891602
Epoch: 3, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.335 Vali Acc: 0.933 Test Loss: 0.335 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3237996101379395
Epoch: 4, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.325 Vali Acc: 0.923 Test Loss: 0.325 Test Acc: 0.923
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2791345119476318
Epoch: 5, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.428 Vali Acc: 0.903 Test Loss: 0.428 Test Acc: 0.903
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.232872486114502
Epoch: 6, Steps: 18 | Train Loss: 0.078 Vali Loss: 0.525 Vali Acc: 0.897 Test Loss: 0.525 Test Acc: 0.897
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.7249071598052979
Epoch: 7, Steps: 18 | Train Loss: 0.234 Vali Loss: 1.322 Vali Acc: 0.823 Test Loss: 1.322 Test Acc: 0.823
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.68571138381958
Epoch: 8, Steps: 18 | Train Loss: 0.264 Vali Loss: 1.184 Vali Acc: 0.877 Test Loss: 1.184 Test Acc: 0.877
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.648818016052246
Epoch: 9, Steps: 18 | Train Loss: 0.119 Vali Loss: 0.945 Vali Acc: 0.893 Test Loss: 0.945 Test Acc: 0.893
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.6128156185150146
Epoch: 10, Steps: 18 | Train Loss: 0.258 Vali Loss: 1.579 Vali Acc: 0.853 Test Loss: 1.579 Test Acc: 0.853
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.704030990600586
Epoch: 11, Steps: 18 | Train Loss: 0.048 Vali Loss: 1.043 Vali Acc: 0.907 Test Loss: 1.043 Test Acc: 0.907
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.6854512691497803
Epoch: 12, Steps: 18 | Train Loss: 0.061 Vali Loss: 1.329 Vali Acc: 0.907 Test Loss: 1.329 Test Acc: 0.907
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9533333333333334
model parameter : 6656281
model size : 25.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.9762287139892578
Epoch: 1, Steps: 18 | Train Loss: 1.986 Vali Loss: 0.390 Vali Acc: 0.947 Test Loss: 0.390 Test Acc: 0.947
Validation loss decreased (inf --> -0.946663).  Saving model ...
Epoch: 2 cost time: 1.0466856956481934
Epoch: 2, Steps: 18 | Train Loss: 0.055 Vali Loss: 0.232 Vali Acc: 0.937 Test Loss: 0.232 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9952166080474854
Epoch: 3, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.142 Vali Acc: 0.957 Test Loss: 0.142 Test Acc: 0.957
Validation loss decreased (-0.946663 --> -0.956665).  Saving model ...
Epoch: 4 cost time: 1.0566773414611816
Epoch: 4, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.132 Vali Acc: 0.960 Test Loss: 0.132 Test Acc: 0.960
Validation loss decreased (-0.956665 --> -0.959999).  Saving model ...
Epoch: 5 cost time: 1.0258240699768066
Epoch: 5, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
Validation loss decreased (-0.959999 --> -0.973332).  Saving model ...
Epoch: 6 cost time: 1.0214438438415527
Epoch: 6, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 7 cost time: 1.0477361679077148
Epoch: 7, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.916085958480835
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9233927726745605
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.9296343326568604
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.0008723735809326
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.012744665145874
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.0779361724853516
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.0328261852264404
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.0159296989440918
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.989173412322998
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 4583705
model size : 17.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.9567687511444092
Epoch: 1, Steps: 18 | Train Loss: 2.186 Vali Loss: 0.688 Vali Acc: 0.913 Test Loss: 0.688 Test Acc: 0.913
Validation loss decreased (inf --> -0.913326).  Saving model ...
Epoch: 2 cost time: 0.9651679992675781
Epoch: 2, Steps: 18 | Train Loss: 0.103 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
Validation loss decreased (-0.913326 --> -0.969999).  Saving model ...
Epoch: 3 cost time: 0.9435439109802246
Epoch: 3, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 4 cost time: 0.9278345108032227
Epoch: 4, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.103 Vali Acc: 0.983 Test Loss: 0.103 Test Acc: 0.983
Validation loss decreased (-0.969999 --> -0.983332).  Saving model ...
Epoch: 5 cost time: 1.0057342052459717
Epoch: 5, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.983 Test Loss: 0.101 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 6 cost time: 0.9813418388366699
Epoch: 6, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9771502017974854
Epoch: 7, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9172837734222412
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.8319518566131592
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.688281774520874
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.8707437515258789
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.9979264736175537
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.971604585647583
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.9591219425201416
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.933701753616333
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 3893273
model size : 14.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.789900779724121
Epoch: 1, Steps: 18 | Train Loss: 2.377 Vali Loss: 0.997 Vali Acc: 0.923 Test Loss: 0.997 Test Acc: 0.923
Validation loss decreased (inf --> -0.923323).  Saving model ...
Epoch: 2 cost time: 0.7065474987030029
Epoch: 2, Steps: 18 | Train Loss: 0.161 Vali Loss: 0.151 Vali Acc: 0.967 Test Loss: 0.151 Test Acc: 0.967
Validation loss decreased (-0.923323 --> -0.966665).  Saving model ...
Epoch: 3 cost time: 0.9749617576599121
Epoch: 3, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.109 Vali Acc: 0.983 Test Loss: 0.109 Test Acc: 0.983
Validation loss decreased (-0.966665 --> -0.983332).  Saving model ...
Epoch: 4 cost time: 0.9609379768371582
Epoch: 4, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.100 Vali Acc: 0.983 Test Loss: 0.100 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 5 cost time: 1.015113115310669
Epoch: 5, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.946850061416626
Epoch: 6, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.897130012512207
Epoch: 7, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.928865909576416
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.9063303470611572
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.9867386817932129
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.72463059425354
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.822749137878418
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.8182051181793213
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.965972900390625
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 3548697
model size : 13.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps22_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.9797899723052979
Epoch: 1, Steps: 18 | Train Loss: 2.520 Vali Loss: 1.313 Vali Acc: 0.923 Test Loss: 1.313 Test Acc: 0.923
Validation loss decreased (inf --> -0.923320).  Saving model ...
Epoch: 2 cost time: 1.0071120262145996
Epoch: 2, Steps: 18 | Train Loss: 0.289 Vali Loss: 0.189 Vali Acc: 0.963 Test Loss: 0.189 Test Acc: 0.963
Validation loss decreased (-0.923320 --> -0.963331).  Saving model ...
Epoch: 3 cost time: 0.8574798107147217
Epoch: 3, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.118 Vali Acc: 0.970 Test Loss: 0.118 Test Acc: 0.970
Validation loss decreased (-0.963331 --> -0.969999).  Saving model ...
Epoch: 4 cost time: 0.9273021221160889
Epoch: 4, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
Validation loss decreased (-0.969999 --> -0.979999).  Saving model ...
Epoch: 5 cost time: 0.9853017330169678
Epoch: 5, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 6 cost time: 1.0234975814819336
Epoch: 6, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 0.9804201126098633
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 1.0053365230560303
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 1.054572582244873
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 0.9879295825958252
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 0.977738618850708
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 0.9795210361480713
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 0.9218506813049316
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 0.9015638828277588
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 0.8912820816040039
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0298755168914795
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 1.0213518142700195
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 0.9449563026428223
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 1.0225498676300049
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9874064922332764
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.9657247066497803
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 0.9792380332946777
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 1.0141167640686035
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 0.9366741180419922
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 0.8421230316162109
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 0.8737339973449707
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0035150051116943
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 0.9710681438446045
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9762606620788574
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.9855797290802002
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.9823741912841797
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.9969048500061035
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.0143568515777588
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.0177369117736816
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.001317024230957
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 36 cost time: 0.8772540092468262
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.8644599914550781
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 38 cost time: 1.0139329433441162
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 39 cost time: 0.987534761428833
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 40 cost time: 0.9331061840057373
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.9343202114105225
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.942410945892334
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.9246530532836914
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.0269529819488525
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 45 cost time: 1.0104649066925049
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.6852078437805176
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.9110825061798096
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.8921260833740234
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.9091336727142334
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.6458401679992676
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps22_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 3262489
model size : 12.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps29_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.8239569664001465
Epoch: 1, Steps: 18 | Train Loss: 2.752 Vali Loss: 1.706 Vali Acc: 0.873 Test Loss: 1.706 Test Acc: 0.873
Validation loss decreased (inf --> -0.873316).  Saving model ...
Epoch: 2 cost time: 0.8232042789459229
Epoch: 2, Steps: 18 | Train Loss: 0.567 Vali Loss: 0.284 Vali Acc: 0.963 Test Loss: 0.284 Test Acc: 0.963
Validation loss decreased (-0.873316 --> -0.963330).  Saving model ...
Epoch: 3 cost time: 0.8963267803192139
Epoch: 3, Steps: 18 | Train Loss: 0.054 Vali Loss: 0.156 Vali Acc: 0.957 Test Loss: 0.156 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8936202526092529
Epoch: 4, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
Validation loss decreased (-0.963330 --> -0.976666).  Saving model ...
Epoch: 5 cost time: 0.8712823390960693
Epoch: 5, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8577330112457275
Epoch: 6, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 7 cost time: 0.8785386085510254
Epoch: 7, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 8 cost time: 0.7914679050445557
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 0.749392032623291
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 0.8677611351013184
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 0.9261269569396973
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 0.8680315017700195
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 0.8620095252990723
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 0.8902599811553955
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 0.8927421569824219
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 0.9329555034637451
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 0.693601131439209
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 0.7494549751281738
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 0.8076756000518799
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 0.8640210628509521
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 0.8909578323364258
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9578020572662354
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.865731954574585
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.8743321895599365
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 0.9212954044342041
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 0.8556003570556641
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 0.8247199058532715
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 28 cost time: 0.752173662185669
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 0.8493423461914062
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 0.8212144374847412
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8799235820770264
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.90081787109375
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.8374991416931152
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.9309673309326172
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 35 cost time: 0.8806531429290771
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 36 cost time: 0.9272377490997314
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 37 cost time: 0.8325083255767822
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.781416654586792
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.9167346954345703
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 40 cost time: 0.863234281539917
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 41 cost time: 0.8679358959197998
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 42 cost time: 0.8678412437438965
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.9216692447662354
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 44 cost time: 0.8945238590240479
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.8940045833587646
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.950584888458252
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.7931544780731201
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.838820219039917
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.8770701885223389
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 50 cost time: 0.8913164138793945
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps29_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 3033881
model size : 11.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps36_str18_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.8285446166992188
Epoch: 1, Steps: 18 | Train Loss: 2.738 Vali Loss: 1.816 Vali Acc: 0.880 Test Loss: 1.816 Test Acc: 0.880
Validation loss decreased (inf --> -0.879982).  Saving model ...
Epoch: 2 cost time: 0.7554676532745361
Epoch: 2, Steps: 18 | Train Loss: 0.646 Vali Loss: 0.339 Vali Acc: 0.953 Test Loss: 0.339 Test Acc: 0.953
Validation loss decreased (-0.879982 --> -0.953330).  Saving model ...
Epoch: 3 cost time: 0.9062840938568115
Epoch: 3, Steps: 18 | Train Loss: 0.087 Vali Loss: 0.126 Vali Acc: 0.970 Test Loss: 0.126 Test Acc: 0.970
Validation loss decreased (-0.953330 --> -0.969999).  Saving model ...
Epoch: 4 cost time: 0.9507193565368652
Epoch: 4, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.969999 --> -0.976666).  Saving model ...
Epoch: 5 cost time: 0.9540138244628906
Epoch: 5, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9476847648620605
Epoch: 6, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9279377460479736
Epoch: 7, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 8 cost time: 1.0105555057525635
Epoch: 8, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 0.9782919883728027
Epoch: 9, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8743300437927246
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.865135908126831
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.9514062404632568
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.9764981269836426
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 0.9440803527832031
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 0.9163520336151123
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 0.9287121295928955
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 0.9386265277862549
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 1.0123052597045898
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 0.7056136131286621
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.792550802230835
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 0.8978769779205322
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 0.9557216167449951
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 0.9182426929473877
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9878299236297607
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 0.919236421585083
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 0.9660139083862305
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 0.9389393329620361
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 0.9555633068084717
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 0.8441829681396484
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 0.7736525535583496
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 31 cost time: 0.9008281230926514
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 32 cost time: 0.9255023002624512
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.9395170211791992
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 34 cost time: 0.9584372043609619
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 35 cost time: 0.9298086166381836
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 36 cost time: 0.969702959060669
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.007619857788086
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 38 cost time: 0.8771052360534668
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983333).  Saving model ...
Epoch: 39 cost time: 0.7814385890960693
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.9444150924682617
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.9490952491760254
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.9279606342315674
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.00571870803833
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 44 cost time: 0.9288406372070312
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.9376215934753418
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.9290776252746582
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 47 cost time: 0.9362404346466064
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 48 cost time: 0.8403868675231934
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.7672984600067139
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.9361953735351562
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps36_str18_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 2978073
model size : 11.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.679978609085083
Epoch: 1, Steps: 18 | Train Loss: 1.998 Vali Loss: 0.412 Vali Acc: 0.910 Test Loss: 0.412 Test Acc: 0.910
Validation loss decreased (inf --> -0.909996).  Saving model ...
Epoch: 2 cost time: 0.687415599822998
Epoch: 2, Steps: 18 | Train Loss: 0.088 Vali Loss: 0.153 Vali Acc: 0.957 Test Loss: 0.153 Test Acc: 0.957
Validation loss decreased (-0.909996 --> -0.956665).  Saving model ...
Epoch: 3 cost time: 0.6884915828704834
Epoch: 3, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.165 Vali Acc: 0.960 Test Loss: 0.165 Test Acc: 0.960
Validation loss decreased (-0.956665 --> -0.959998).  Saving model ...
Epoch: 4 cost time: 0.9340991973876953
Epoch: 4, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.175 Vali Acc: 0.950 Test Loss: 0.175 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9169590473175049
Epoch: 5, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.148 Vali Acc: 0.967 Test Loss: 0.148 Test Acc: 0.967
Validation loss decreased (-0.959998 --> -0.966665).  Saving model ...
Epoch: 6 cost time: 1.0112056732177734
Epoch: 6, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.180 Vali Acc: 0.973 Test Loss: 0.180 Test Acc: 0.973
Validation loss decreased (-0.966665 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 0.9151773452758789
Epoch: 7, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.361 Vali Acc: 0.940 Test Loss: 0.361 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9722557067871094
Epoch: 8, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.205 Vali Acc: 0.963 Test Loss: 0.205 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8690550327301025
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.258 Vali Acc: 0.950 Test Loss: 0.258 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.0069727897644043
Epoch: 10, Steps: 18 | Train Loss: 0.053 Vali Loss: 0.723 Vali Acc: 0.873 Test Loss: 0.723 Test Acc: 0.873
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.6978960037231445
Epoch: 11, Steps: 18 | Train Loss: 0.053 Vali Loss: 0.962 Vali Acc: 0.883 Test Loss: 0.962 Test Acc: 0.883
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.7249338626861572
Epoch: 12, Steps: 18 | Train Loss: 0.121 Vali Loss: 0.564 Vali Acc: 0.933 Test Loss: 0.564 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.7558257579803467
Epoch: 13, Steps: 18 | Train Loss: 0.061 Vali Loss: 0.520 Vali Acc: 0.927 Test Loss: 0.520 Test Acc: 0.927
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.9889543056488037
Epoch: 14, Steps: 18 | Train Loss: 0.050 Vali Loss: 0.507 Vali Acc: 0.930 Test Loss: 0.507 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.0330665111541748
Epoch: 15, Steps: 18 | Train Loss: 0.119 Vali Loss: 0.614 Vali Acc: 0.910 Test Loss: 0.614 Test Acc: 0.910
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.105684518814087
Epoch: 16, Steps: 18 | Train Loss: 0.037 Vali Loss: 0.818 Vali Acc: 0.907 Test Loss: 0.818 Test Acc: 0.907
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9733333333333334
model parameter : 2738329
model size : 10.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.7635512351989746
Epoch: 1, Steps: 18 | Train Loss: 2.457 Vali Loss: 0.991 Vali Acc: 0.920 Test Loss: 0.991 Test Acc: 0.920
Validation loss decreased (inf --> -0.919990).  Saving model ...
Epoch: 2 cost time: 0.787285327911377
Epoch: 2, Steps: 18 | Train Loss: 0.167 Vali Loss: 0.150 Vali Acc: 0.963 Test Loss: 0.150 Test Acc: 0.963
Validation loss decreased (-0.919990 --> -0.963332).  Saving model ...
Epoch: 3 cost time: 0.8622112274169922
Epoch: 3, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.963332 --> -0.976666).  Saving model ...
Epoch: 4 cost time: 0.7847244739532471
Epoch: 4, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.085 Vali Acc: 0.970 Test Loss: 0.085 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8233585357666016
Epoch: 5, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.970 Test Loss: 0.085 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8759698867797852
Epoch: 6, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 0.7850475311279297
Epoch: 7, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 0.8150677680969238
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 0.8149170875549316
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7213907241821289
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7087042331695557
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.7036929130554199
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.781203031539917
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.8698198795318604
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.857987642288208
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.8575990200042725
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.8442168235778809
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.7957499027252197
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 1702041
model size : 6.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.8013713359832764
Epoch: 1, Steps: 18 | Train Loss: 2.733 Vali Loss: 1.542 Vali Acc: 0.900 Test Loss: 1.542 Test Acc: 0.900
Validation loss decreased (inf --> -0.899985).  Saving model ...
Epoch: 2 cost time: 0.7961292266845703
Epoch: 2, Steps: 18 | Train Loss: 0.383 Vali Loss: 0.228 Vali Acc: 0.963 Test Loss: 0.228 Test Acc: 0.963
Validation loss decreased (-0.899985 --> -0.963331).  Saving model ...
Epoch: 3 cost time: 0.8522439002990723
Epoch: 3, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
Validation loss decreased (-0.963331 --> -0.973332).  Saving model ...
Epoch: 4 cost time: 0.7880854606628418
Epoch: 4, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 5 cost time: 0.7918415069580078
Epoch: 5, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 6 cost time: 0.7682144641876221
Epoch: 6, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 0.8182690143585205
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7008359432220459
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 0.6725823879241943
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 0.7071559429168701
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 0.707369327545166
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 0.7579238414764404
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 0.7639551162719727
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 0.873408317565918
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8240656852722168
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8299686908721924
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 0.8117976188659668
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 0.8418595790863037
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8022079467773438
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7660341262817383
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.6859407424926758
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 0.7503032684326172
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 0.7405588626861572
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7931356430053711
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.8174333572387695
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 0.7826905250549316
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 0.7885520458221436
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 28 cost time: 0.7212822437286377
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 0.7502992153167725
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.8150246143341064
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 31 cost time: 0.6287119388580322
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 32 cost time: 0.6046407222747803
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 33 cost time: 0.5572404861450195
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.6872372627258301
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.730642557144165
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.7419464588165283
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.7772691249847412
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.7571687698364258
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 39 cost time: 0.7886531352996826
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 40 cost time: 0.7965555191040039
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 41 cost time: 0.722050666809082
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 42 cost time: 0.5894505977630615
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 43 cost time: 0.6038227081298828
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.5878057479858398
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.7693307399749756
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.7702453136444092
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.8058154582977295
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.8123733997344971
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.7775886058807373
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.8416492938995361
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 1356825
model size : 5.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.7454147338867188
Epoch: 1, Steps: 18 | Train Loss: 2.778 Vali Loss: 1.874 Vali Acc: 0.890 Test Loss: 1.874 Test Acc: 0.890
Validation loss decreased (inf --> -0.889981).  Saving model ...
Epoch: 2 cost time: 0.7233371734619141
Epoch: 2, Steps: 18 | Train Loss: 0.596 Vali Loss: 0.310 Vali Acc: 0.960 Test Loss: 0.310 Test Acc: 0.960
Validation loss decreased (-0.889981 --> -0.959997).  Saving model ...
Epoch: 3 cost time: 0.7328975200653076
Epoch: 3, Steps: 18 | Train Loss: 0.056 Vali Loss: 0.130 Vali Acc: 0.970 Test Loss: 0.130 Test Acc: 0.970
Validation loss decreased (-0.959997 --> -0.969999).  Saving model ...
Epoch: 4 cost time: 0.7627336978912354
Epoch: 4, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 5 cost time: 0.8129472732543945
Epoch: 5, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 6 cost time: 0.8414440155029297
Epoch: 6, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 0.6875724792480469
Epoch: 7, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 0.71164870262146
Epoch: 8, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 0.7301979064941406
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 0.7610318660736084
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 0.846977949142456
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 12 cost time: 0.825575590133667
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 13 cost time: 0.7891068458557129
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 14 cost time: 0.8255748748779297
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 15 cost time: 0.7357497215270996
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 16 cost time: 0.7788083553314209
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 17 cost time: 0.7917027473449707
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 18 cost time: 0.7722115516662598
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6986358165740967
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 20 cost time: 0.7145810127258301
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 21 cost time: 0.793524980545044
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 22 cost time: 0.7993977069854736
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 23 cost time: 0.7709596157073975
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7592158317565918
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.818587064743042
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.8308641910552979
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 27 cost time: 0.7505698204040527
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973333).  Saving model ...
Epoch: 28 cost time: 0.7301766872406006
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
Validation loss decreased (-0.973333 --> -0.973333).  Saving model ...
Epoch: 29 cost time: 0.8190836906433105
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.973333 --> -0.976666).  Saving model ...
Epoch: 30 cost time: 0.6437101364135742
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.594731330871582
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.5532164573669434
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.7654504776000977
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 34 cost time: 0.7274875640869141
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.793419361114502
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.8446614742279053
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.7979962825775146
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.8034675121307373
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 39 cost time: 0.6954073905944824
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 40 cost time: 0.7612299919128418
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 41 cost time: 0.5864026546478271
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 42 cost time: 0.5746488571166992
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.5817852020263672
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 44 cost time: 0.7019729614257812
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.7812755107879639
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.8170149326324463
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 47 cost time: 0.7735824584960938
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.8195557594299316
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 49 cost time: 0.7459309101104736
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 50 cost time: 0.7579445838928223
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 1184537
model size : 4.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps22_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.7044727802276611
Epoch: 1, Steps: 18 | Train Loss: 2.840 Vali Loss: 2.130 Vali Acc: 0.820 Test Loss: 2.130 Test Acc: 0.820
Validation loss decreased (inf --> -0.819979).  Saving model ...
Epoch: 2 cost time: 0.7495007514953613
Epoch: 2, Steps: 18 | Train Loss: 0.921 Vali Loss: 0.504 Vali Acc: 0.963 Test Loss: 0.504 Test Acc: 0.963
Validation loss decreased (-0.819979 --> -0.963328).  Saving model ...
Epoch: 3 cost time: 0.7569334506988525
Epoch: 3, Steps: 18 | Train Loss: 0.144 Vali Loss: 0.175 Vali Acc: 0.963 Test Loss: 0.175 Test Acc: 0.963
Validation loss decreased (-0.963328 --> -0.963332).  Saving model ...
Epoch: 4 cost time: 0.7244918346405029
Epoch: 4, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.127 Vali Acc: 0.973 Test Loss: 0.127 Test Acc: 0.973
Validation loss decreased (-0.963332 --> -0.973332).  Saving model ...
Epoch: 5 cost time: 0.7140522003173828
Epoch: 5, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 6 cost time: 0.738276481628418
Epoch: 6, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 0.7367980480194092
Epoch: 7, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 0.568244457244873
Epoch: 8, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 0.5885171890258789
Epoch: 9, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 0.6234743595123291
Epoch: 10, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 0.7035262584686279
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 0.6927721500396729
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 0.7163283824920654
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 0.769726037979126
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 0.7046775817871094
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 0.7634403705596924
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 0.7199745178222656
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 0.729931116104126
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 0.7106599807739258
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 0.5558879375457764
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 0.5603907108306885
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 0.5832316875457764
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 0.6780300140380859
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 0.7424757480621338
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 0.6994037628173828
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 0.8050248622894287
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 0.6937427520751953
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 28 cost time: 0.7063925266265869
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 0.6690945625305176
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.6847250461578369
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 31 cost time: 0.7576138973236084
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 32 cost time: 0.7350382804870605
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 33 cost time: 0.629279613494873
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 34 cost time: 0.636528730392456
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 35 cost time: 0.5733957290649414
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 36 cost time: 0.4868626594543457
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.5353727340698242
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.5773899555206299
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 39 cost time: 0.4746377468109131
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 40 cost time: 0.47385573387145996
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 41 cost time: 0.488269567489624
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 42 cost time: 0.5318961143493652
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 43 cost time: 0.6550946235656738
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 44 cost time: 0.7066981792449951
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.701662540435791
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.6636426448822021
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 47 cost time: 0.7048099040985107
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 48 cost time: 0.6794836521148682
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.6645016670227051
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.7487401962280273
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps22_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 1041433
model size : 4.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps29_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.691854476928711
Epoch: 1, Steps: 18 | Train Loss: 3.011 Vali Loss: 2.453 Vali Acc: 0.703 Test Loss: 2.453 Test Acc: 0.703
Validation loss decreased (inf --> -0.703309).  Saving model ...
Epoch: 2 cost time: 0.6541645526885986
Epoch: 2, Steps: 18 | Train Loss: 1.404 Vali Loss: 0.854 Vali Acc: 0.960 Test Loss: 0.854 Test Acc: 0.960
Validation loss decreased (-0.703309 --> -0.959991).  Saving model ...
Epoch: 3 cost time: 0.6897556781768799
Epoch: 3, Steps: 18 | Train Loss: 0.298 Vali Loss: 0.262 Vali Acc: 0.967 Test Loss: 0.262 Test Acc: 0.967
Validation loss decreased (-0.959991 --> -0.966664).  Saving model ...
Epoch: 4 cost time: 0.6387186050415039
Epoch: 4, Steps: 18 | Train Loss: 0.063 Vali Loss: 0.156 Vali Acc: 0.973 Test Loss: 0.156 Test Acc: 0.973
Validation loss decreased (-0.966664 --> -0.973332).  Saving model ...
Epoch: 5 cost time: 0.6041004657745361
Epoch: 5, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.130 Vali Acc: 0.973 Test Loss: 0.130 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 6 cost time: 0.7721006870269775
Epoch: 6, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.120 Vali Acc: 0.973 Test Loss: 0.120 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 0.7296686172485352
Epoch: 7, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 8 cost time: 0.7566332817077637
Epoch: 8, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 0.6936476230621338
Epoch: 9, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 0.6867539882659912
Epoch: 10, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7220911979675293
Epoch: 11, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 0.7244057655334473
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 0.7509150505065918
Epoch: 13, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 0.6539294719696045
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6579053401947021
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 0.7899227142333984
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 0.7300677299499512
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 0.6996369361877441
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 0.6895902156829834
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 0.7519330978393555
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 0.7729685306549072
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 0.6969232559204102
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 0.5438711643218994
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 0.6287446022033691
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 0.6281833648681641
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 0.7520711421966553
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.7649343013763428
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 28 cost time: 0.7237987518310547
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 0.6847867965698242
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 30 cost time: 0.7210893630981445
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 31 cost time: 0.7757110595703125
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 32 cost time: 0.7578048706054688
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 33 cost time: 0.6594831943511963
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 34 cost time: 0.6602861881256104
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 35 cost time: 0.7732834815979004
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 36 cost time: 0.7029721736907959
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.7155740261077881
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 38 cost time: 0.7104568481445312
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.7255313396453857
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 40 cost time: 0.740546464920044
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 41 cost time: 0.7420215606689453
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.73720383644104
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.6074142456054688
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.6254606246948242
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 45 cost time: 0.733532190322876
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.7445125579833984
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 47 cost time: 0.7515110969543457
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 48 cost time: 0.7114031314849854
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 49 cost time: 0.7207226753234863
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 50 cost time: 0.7450404167175293
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps29_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 927129
model size : 3.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps36_str18_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.719660758972168
Epoch: 1, Steps: 18 | Train Loss: 3.020 Vali Loss: 2.473 Vali Acc: 0.687 Test Loss: 2.473 Test Acc: 0.687
Validation loss decreased (inf --> -0.686642).  Saving model ...
Epoch: 2 cost time: 0.7614781856536865
Epoch: 2, Steps: 18 | Train Loss: 1.461 Vali Loss: 0.933 Vali Acc: 0.943 Test Loss: 0.933 Test Acc: 0.943
Validation loss decreased (-0.686642 --> -0.943324).  Saving model ...
Epoch: 3 cost time: 0.7445006370544434
Epoch: 3, Steps: 18 | Train Loss: 0.367 Vali Loss: 0.293 Vali Acc: 0.970 Test Loss: 0.293 Test Acc: 0.970
Validation loss decreased (-0.943324 --> -0.969997).  Saving model ...
Epoch: 4 cost time: 0.6445777416229248
Epoch: 4, Steps: 18 | Train Loss: 0.086 Vali Loss: 0.163 Vali Acc: 0.967 Test Loss: 0.163 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6961619853973389
Epoch: 5, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.131 Vali Acc: 0.970 Test Loss: 0.131 Test Acc: 0.970
Validation loss decreased (-0.969997 --> -0.969999).  Saving model ...
Epoch: 6 cost time: 0.6298432350158691
Epoch: 6, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.117 Vali Acc: 0.980 Test Loss: 0.117 Test Acc: 0.980
Validation loss decreased (-0.969999 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 0.6918320655822754
Epoch: 7, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7078146934509277
Epoch: 8, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7430484294891357
Epoch: 9, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.6874520778656006
Epoch: 10, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.7275400161743164
Epoch: 11, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.7076492309570312
Epoch: 12, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.730140209197998
Epoch: 13, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.7357707023620605
Epoch: 14, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.7222678661346436
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.6939558982849121
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps36_str18_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 899225
model size : 3.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.511291742324829
Epoch: 1, Steps: 18 | Train Loss: 2.437 Vali Loss: 0.953 Vali Acc: 0.913 Test Loss: 0.953 Test Acc: 0.913
Validation loss decreased (inf --> -0.913324).  Saving model ...
Epoch: 2 cost time: 0.6356170177459717
Epoch: 2, Steps: 18 | Train Loss: 0.186 Vali Loss: 0.152 Vali Acc: 0.957 Test Loss: 0.152 Test Acc: 0.957
Validation loss decreased (-0.913324 --> -0.956665).  Saving model ...
Epoch: 3 cost time: 0.6031360626220703
Epoch: 3, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.110 Vali Acc: 0.967 Test Loss: 0.110 Test Acc: 0.967
Validation loss decreased (-0.956665 --> -0.966666).  Saving model ...
Epoch: 4 cost time: 0.6082429885864258
Epoch: 4, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
Validation loss decreased (-0.966666 --> -0.973332).  Saving model ...
Epoch: 5 cost time: 0.7053329944610596
Epoch: 5, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 6 cost time: 0.7376072406768799
Epoch: 6, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 7 cost time: 0.7297475337982178
Epoch: 7, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 0.7495737075805664
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 0.6518406867980957
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7057168483734131
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.6659519672393799
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 0.6458170413970947
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5961661338806152
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6897556781768799
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 0.6960108280181885
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6670455932617188
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7030203342437744
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 0.713890790939331
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7657201290130615
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7304463386535645
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.7153232097625732
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.6510744094848633
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 0.6508998870849609
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7079534530639648
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.6986348628997803
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.6840097904205322
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.7028670310974121
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.6442642211914062
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.7132415771484375
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.6812162399291992
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.5558774471282959
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.5638031959533691
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 33 cost time: 0.5245482921600342
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.6873791217803955
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.7347371578216553
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.6687374114990234
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.6674008369445801
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.6693003177642822
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.6960198879241943
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.6171176433563232
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.620532751083374
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.5801968574523926
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 1221721
model size : 4.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.7119088172912598
Epoch: 1, Steps: 18 | Train Loss: 2.781 Vali Loss: 1.810 Vali Acc: 0.887 Test Loss: 1.810 Test Acc: 0.887
Validation loss decreased (inf --> -0.886649).  Saving model ...
Epoch: 2 cost time: 0.484283447265625
Epoch: 2, Steps: 18 | Train Loss: 0.624 Vali Loss: 0.337 Vali Acc: 0.943 Test Loss: 0.337 Test Acc: 0.943
Validation loss decreased (-0.886649 --> -0.943330).  Saving model ...
Epoch: 3 cost time: 0.5455887317657471
Epoch: 3, Steps: 18 | Train Loss: 0.059 Vali Loss: 0.131 Vali Acc: 0.977 Test Loss: 0.131 Test Acc: 0.977
Validation loss decreased (-0.943330 --> -0.976665).  Saving model ...
Epoch: 4 cost time: 0.587714433670044
Epoch: 4, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.109 Vali Acc: 0.980 Test Loss: 0.109 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 5 cost time: 0.6187245845794678
Epoch: 5, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 6 cost time: 0.6763010025024414
Epoch: 6, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6689260005950928
Epoch: 7, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.6267457008361816
Epoch: 8, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.6383388042449951
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.6160304546356201
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.6449267864227295
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.5330362319946289
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 0.549091100692749
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 0.5486807823181152
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 0.6609513759613037
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 0.7349536418914795
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 0.6946961879730225
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 0.7246873378753662
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 0.6388270854949951
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 0.7588880062103271
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6752886772155762
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 0.5452010631561279
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 0.6402430534362793
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 0.6384234428405762
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 0.6452867984771729
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 0.716728687286377
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 0.6314218044281006
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7647128105163574
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.650367021560669
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.7186551094055176
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.7202358245849609
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.573563814163208
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 33 cost time: 0.640282154083252
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.6498045921325684
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 35 cost time: 0.7023270130157471
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.6822638511657715
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 37 cost time: 0.6345522403717041
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.6477525234222412
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 39 cost time: 0.7328798770904541
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.6892445087432861
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.5948045253753662
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 42 cost time: 0.5587172508239746
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 43 cost time: 0.6097719669342041
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 44 cost time: 0.572641134262085
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 45 cost time: 0.542672872543335
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 46 cost time: 0.5913550853729248
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.6621584892272949
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.5865175724029541
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.5864346027374268
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.5647144317626953
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 703577
model size : 2.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.5913732051849365
Epoch: 1, Steps: 18 | Train Loss: 2.951 Vali Loss: 2.285 Vali Acc: 0.817 Test Loss: 2.285 Test Acc: 0.817
Validation loss decreased (inf --> -0.816644).  Saving model ...
Epoch: 2 cost time: 0.6213059425354004
Epoch: 2, Steps: 18 | Train Loss: 1.113 Vali Loss: 0.639 Vali Acc: 0.957 Test Loss: 0.639 Test Acc: 0.957
Validation loss decreased (-0.816644 --> -0.956660).  Saving model ...
Epoch: 3 cost time: 0.6232850551605225
Epoch: 3, Steps: 18 | Train Loss: 0.201 Vali Loss: 0.192 Vali Acc: 0.980 Test Loss: 0.192 Test Acc: 0.980
Validation loss decreased (-0.956660 --> -0.979998).  Saving model ...
Epoch: 4 cost time: 0.5804753303527832
Epoch: 4, Steps: 18 | Train Loss: 0.031 Vali Loss: 0.132 Vali Acc: 0.977 Test Loss: 0.132 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5576450824737549
Epoch: 5, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.5641975402832031
Epoch: 6, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.5967493057250977
Epoch: 7, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.6262457370758057
Epoch: 8, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.6888375282287598
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.6068565845489502
Epoch: 10, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.6457128524780273
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.6236429214477539
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.62172532081604
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979998 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 0.5136058330535889
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 0.5286753177642822
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 0.5905919075012207
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 0.6081039905548096
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 0.5425558090209961
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6136491298675537
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 0.5773875713348389
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 0.6514792442321777
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 0.6704072952270508
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 0.6657571792602539
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 0.6078090667724609
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 0.6003012657165527
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 0.608745813369751
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 0.5824272632598877
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 0.6238372325897217
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6185367107391357
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.6292243003845215
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 31 cost time: 0.6157798767089844
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 32 cost time: 0.7073924541473389
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 33 cost time: 0.6466724872589111
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 34 cost time: 0.6560349464416504
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 35 cost time: 0.48096489906311035
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 36 cost time: 0.52250075340271
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.5603878498077393
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.5999202728271484
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.6655368804931641
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 40 cost time: 0.6266992092132568
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 41 cost time: 0.6125156879425049
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 42 cost time: 0.6079471111297607
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 43 cost time: 0.6386356353759766
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 44 cost time: 0.6276898384094238
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 45 cost time: 0.6068387031555176
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 46 cost time: 0.5443134307861328
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 47 cost time: 0.548086404800415
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.5327436923980713
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.626030683517456
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.6482505798339844
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 530969
model size : 2.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.5926382541656494
Epoch: 1, Steps: 18 | Train Loss: 2.926 Vali Loss: 2.470 Vali Acc: 0.757 Test Loss: 2.470 Test Acc: 0.757
Validation loss decreased (inf --> -0.756642).  Saving model ...
Epoch: 2 cost time: 0.5265645980834961
Epoch: 2, Steps: 18 | Train Loss: 1.386 Vali Loss: 0.888 Vali Acc: 0.963 Test Loss: 0.888 Test Acc: 0.963
Validation loss decreased (-0.756642 --> -0.963324).  Saving model ...
Epoch: 3 cost time: 0.6054975986480713
Epoch: 3, Steps: 18 | Train Loss: 0.311 Vali Loss: 0.262 Vali Acc: 0.970 Test Loss: 0.262 Test Acc: 0.970
Validation loss decreased (-0.963324 --> -0.969997).  Saving model ...
Epoch: 4 cost time: 0.6503078937530518
Epoch: 4, Steps: 18 | Train Loss: 0.061 Vali Loss: 0.164 Vali Acc: 0.977 Test Loss: 0.164 Test Acc: 0.977
Validation loss decreased (-0.969997 --> -0.976665).  Saving model ...
Epoch: 5 cost time: 0.6232349872589111
Epoch: 5, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.130 Vali Acc: 0.977 Test Loss: 0.130 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 6 cost time: 0.6203858852386475
Epoch: 6, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.120 Vali Acc: 0.977 Test Loss: 0.120 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 7 cost time: 0.666114330291748
Epoch: 7, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 8 cost time: 0.6244208812713623
Epoch: 8, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 0.6216187477111816
Epoch: 9, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 0.5973851680755615
Epoch: 10, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 0.5652098655700684
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 0.5058941841125488
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 0.5157570838928223
Epoch: 13, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 0.5433712005615234
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 0.5405368804931641
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 0.5193338394165039
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 0.4912760257720947
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 0.4570646286010742
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 0.4502601623535156
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 0.5977609157562256
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 0.6533346176147461
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 0.5920228958129883
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 0.5345861911773682
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 0.5859925746917725
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 0.5682516098022461
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 0.5719575881958008
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 0.6205058097839355
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 28 cost time: 0.5230672359466553
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 0.5325758457183838
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 30 cost time: 0.5130510330200195
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 31 cost time: 0.5408663749694824
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 32 cost time: 0.5616977214813232
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 33 cost time: 0.572838544845581
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.7164888381958008
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 35 cost time: 0.577617883682251
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 36 cost time: 0.5817043781280518
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.6886777877807617
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 38 cost time: 0.5513830184936523
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 39 cost time: 0.5758781433105469
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 40 cost time: 0.662299394607544
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 41 cost time: 0.5880167484283447
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 42 cost time: 0.5587363243103027
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 43 cost time: 0.5254552364349365
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 44 cost time: 0.582643985748291
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.6331334114074707
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 46 cost time: 0.5992739200592041
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 47 cost time: 0.627265214920044
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 48 cost time: 0.5252063274383545
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 49 cost time: 0.5281088352203369
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.5671901702880859
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 444825
model size : 1.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps22_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.456282138824463
Epoch: 1, Steps: 18 | Train Loss: 3.046 Vali Loss: 2.624 Vali Acc: 0.557 Test Loss: 2.624 Test Acc: 0.557
Validation loss decreased (inf --> -0.556640).  Saving model ...
Epoch: 2 cost time: 0.4882516860961914
Epoch: 2, Steps: 18 | Train Loss: 1.789 Vali Loss: 1.255 Vali Acc: 0.933 Test Loss: 1.255 Test Acc: 0.933
Validation loss decreased (-0.556640 --> -0.933321).  Saving model ...
Epoch: 3 cost time: 0.5355415344238281
Epoch: 3, Steps: 18 | Train Loss: 0.591 Vali Loss: 0.433 Vali Acc: 0.963 Test Loss: 0.433 Test Acc: 0.963
Validation loss decreased (-0.933321 --> -0.963329).  Saving model ...
Epoch: 4 cost time: 0.666886568069458
Epoch: 4, Steps: 18 | Train Loss: 0.157 Vali Loss: 0.209 Vali Acc: 0.977 Test Loss: 0.209 Test Acc: 0.977
Validation loss decreased (-0.963329 --> -0.976665).  Saving model ...
Epoch: 5 cost time: 0.6322195529937744
Epoch: 5, Steps: 18 | Train Loss: 0.047 Vali Loss: 0.159 Vali Acc: 0.977 Test Loss: 0.159 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 6 cost time: 0.5696048736572266
Epoch: 6, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.135 Vali Acc: 0.977 Test Loss: 0.135 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 7 cost time: 0.5816669464111328
Epoch: 7, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.129 Vali Acc: 0.977 Test Loss: 0.129 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 8 cost time: 0.5600001811981201
Epoch: 8, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.120 Vali Acc: 0.977 Test Loss: 0.120 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 9 cost time: 0.6272072792053223
Epoch: 9, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 0.6575868129730225
Epoch: 10, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 0.4665241241455078
Epoch: 11, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 0.5306141376495361
Epoch: 12, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 0.5149979591369629
Epoch: 13, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 0.602912425994873
Epoch: 14, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 0.6831793785095215
Epoch: 15, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 0.581397533416748
Epoch: 16, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 0.6350522041320801
Epoch: 17, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 0.564866304397583
Epoch: 18, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 0.6050906181335449
Epoch: 19, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 0.5624983310699463
Epoch: 20, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 0.53013014793396
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 0.5583877563476562
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 0.6065075397491455
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 0.5844547748565674
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 0.6446685791015625
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 0.6329097747802734
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 0.6213486194610596
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6670341491699219
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 0.5356760025024414
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 30 cost time: 0.5506305694580078
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 31 cost time: 0.5278663635253906
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 32 cost time: 0.5523266792297363
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 33 cost time: 0.6244807243347168
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 34 cost time: 0.7146458625793457
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 35 cost time: 0.6095499992370605
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.6114070415496826
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.6144001483917236
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 38 cost time: 0.6614716053009033
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 39 cost time: 0.5865421295166016
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 40 cost time: 0.5863449573516846
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 41 cost time: 0.565925121307373
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 42 cost time: 0.5477399826049805
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 43 cost time: 0.6501619815826416
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 44 cost time: 0.6540346145629883
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.5970611572265625
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 46 cost time: 0.5884678363800049
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 47 cost time: 0.5283100605010986
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.5956790447235107
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 49 cost time: 0.5681121349334717
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 50 cost time: 0.5340847969055176
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps22_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 373273
model size : 1.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps29_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.550755500793457
Epoch: 1, Steps: 18 | Train Loss: 3.123 Vali Loss: 2.809 Vali Acc: 0.383 Test Loss: 2.809 Test Acc: 0.383
Validation loss decreased (inf --> -0.383305).  Saving model ...
Epoch: 2 cost time: 0.6025354862213135
Epoch: 2, Steps: 18 | Train Loss: 2.170 Vali Loss: 1.727 Vali Acc: 0.900 Test Loss: 1.727 Test Acc: 0.900
Validation loss decreased (-0.383305 --> -0.899983).  Saving model ...
Epoch: 3 cost time: 0.4576282501220703
Epoch: 3, Steps: 18 | Train Loss: 1.053 Vali Loss: 0.779 Vali Acc: 0.967 Test Loss: 0.779 Test Acc: 0.967
Validation loss decreased (-0.899983 --> -0.966659).  Saving model ...
Epoch: 4 cost time: 0.5121486186981201
Epoch: 4, Steps: 18 | Train Loss: 0.381 Vali Loss: 0.352 Vali Acc: 0.970 Test Loss: 0.352 Test Acc: 0.970
Validation loss decreased (-0.966659 --> -0.969996).  Saving model ...
Epoch: 5 cost time: 0.5684814453125
Epoch: 5, Steps: 18 | Train Loss: 0.136 Vali Loss: 0.218 Vali Acc: 0.973 Test Loss: 0.218 Test Acc: 0.973
Validation loss decreased (-0.969996 --> -0.973331).  Saving model ...
Epoch: 6 cost time: 0.5977649688720703
Epoch: 6, Steps: 18 | Train Loss: 0.057 Vali Loss: 0.172 Vali Acc: 0.980 Test Loss: 0.172 Test Acc: 0.980
Validation loss decreased (-0.973331 --> -0.979998).  Saving model ...
Epoch: 7 cost time: 0.6220364570617676
Epoch: 7, Steps: 18 | Train Loss: 0.034 Vali Loss: 0.148 Vali Acc: 0.977 Test Loss: 0.148 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5892171859741211
Epoch: 8, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.136 Vali Acc: 0.977 Test Loss: 0.136 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.6164557933807373
Epoch: 9, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.124 Vali Acc: 0.977 Test Loss: 0.124 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.5967638492584229
Epoch: 10, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.6260626316070557
Epoch: 11, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.6215002536773682
Epoch: 12, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.5777723789215088
Epoch: 13, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.5351076126098633
Epoch: 14, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.5586087703704834
Epoch: 15, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.5880162715911865
Epoch: 16, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps29_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 316121
model size : 1.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps36_str18_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.5574719905853271
Epoch: 1, Steps: 18 | Train Loss: 3.161 Vali Loss: 2.808 Vali Acc: 0.400 Test Loss: 2.808 Test Acc: 0.400
Validation loss decreased (inf --> -0.399972).  Saving model ...
Epoch: 2 cost time: 0.5002305507659912
Epoch: 2, Steps: 18 | Train Loss: 2.234 Vali Loss: 1.756 Vali Acc: 0.917 Test Loss: 1.756 Test Acc: 0.917
Validation loss decreased (-0.399972 --> -0.916649).  Saving model ...
Epoch: 3 cost time: 0.5731852054595947
Epoch: 3, Steps: 18 | Train Loss: 1.155 Vali Loss: 0.840 Vali Acc: 0.957 Test Loss: 0.840 Test Acc: 0.957
Validation loss decreased (-0.916649 --> -0.956658).  Saving model ...
Epoch: 4 cost time: 0.633897066116333
Epoch: 4, Steps: 18 | Train Loss: 0.465 Vali Loss: 0.402 Vali Acc: 0.970 Test Loss: 0.402 Test Acc: 0.970
Validation loss decreased (-0.956658 --> -0.969996).  Saving model ...
Epoch: 5 cost time: 0.603823184967041
Epoch: 5, Steps: 18 | Train Loss: 0.171 Vali Loss: 0.238 Vali Acc: 0.973 Test Loss: 0.238 Test Acc: 0.973
Validation loss decreased (-0.969996 --> -0.973331).  Saving model ...
Epoch: 6 cost time: 0.5878806114196777
Epoch: 6, Steps: 18 | Train Loss: 0.084 Vali Loss: 0.186 Vali Acc: 0.973 Test Loss: 0.186 Test Acc: 0.973
Validation loss decreased (-0.973331 --> -0.973331).  Saving model ...
Epoch: 7 cost time: 0.6131725311279297
Epoch: 7, Steps: 18 | Train Loss: 0.046 Vali Loss: 0.158 Vali Acc: 0.973 Test Loss: 0.158 Test Acc: 0.973
Validation loss decreased (-0.973331 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 0.6355173587799072
Epoch: 8, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.143 Vali Acc: 0.973 Test Loss: 0.143 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 0.615013599395752
Epoch: 9, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.132 Vali Acc: 0.973 Test Loss: 0.132 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 0.6016199588775635
Epoch: 10, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.121 Vali Acc: 0.977 Test Loss: 0.121 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 11 cost time: 0.5839850902557373
Epoch: 11, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 0.5174553394317627
Epoch: 12, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 0.5109753608703613
Epoch: 13, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 0.6115972995758057
Epoch: 14, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 0.5896024703979492
Epoch: 15, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 0.6126887798309326
Epoch: 16, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 0.5871765613555908
Epoch: 17, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 0.5432682037353516
Epoch: 18, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 0.5655419826507568
Epoch: 19, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 0.5997352600097656
Epoch: 20, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 0.5671472549438477
Epoch: 21, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 0.5473067760467529
Epoch: 22, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 0.651442289352417
Epoch: 23, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.5823502540588379
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.6308760643005371
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 0.6111478805541992
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5961267948150635
Epoch: 27, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.5812649726867676
Epoch: 28, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983333).  Saving model ...
Epoch: 29 cost time: 0.5644066333770752
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.5941660404205322
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.5757293701171875
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.5819149017333984
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 33 cost time: 0.5971620082855225
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 34 cost time: 0.5842421054840088
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 35 cost time: 0.6735250949859619
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.6083416938781738
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 37 cost time: 0.5517947673797607
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.5700960159301758
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.6103787422180176
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.5178542137145996
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.5547318458557129
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.5009336471557617
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 43 cost time: 0.5115020275115967
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.5008895397186279
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.5425701141357422
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.5632152557373047
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.5512995719909668
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.5593342781066895
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.5974888801574707
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.5699901580810547
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps36_str18_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 302169
model size : 1.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.7264602184295654
Epoch: 1, Steps: 18 | Train Loss: 2.791 Vali Loss: 1.748 Vali Acc: 0.870 Test Loss: 1.748 Test Acc: 0.870
Validation loss decreased (inf --> -0.869983).  Saving model ...
Epoch: 2 cost time: 0.5485625267028809
Epoch: 2, Steps: 18 | Train Loss: 0.604 Vali Loss: 0.321 Vali Acc: 0.953 Test Loss: 0.321 Test Acc: 0.953
Validation loss decreased (-0.869983 --> -0.953330).  Saving model ...
Epoch: 3 cost time: 0.523582935333252
Epoch: 3, Steps: 18 | Train Loss: 0.068 Vali Loss: 0.156 Vali Acc: 0.960 Test Loss: 0.156 Test Acc: 0.960
Validation loss decreased (-0.953330 --> -0.959998).  Saving model ...
Epoch: 4 cost time: 0.5173330307006836
Epoch: 4, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.129 Vali Acc: 0.963 Test Loss: 0.129 Test Acc: 0.963
Validation loss decreased (-0.959998 --> -0.963332).  Saving model ...
Epoch: 5 cost time: 0.5763471126556396
Epoch: 5, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
Validation loss decreased (-0.963332 --> -0.969999).  Saving model ...
Epoch: 6 cost time: 0.5513038635253906
Epoch: 6, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 0.5805909633636475
Epoch: 7, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 0.6067409515380859
Epoch: 8, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 0.5505225658416748
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5710065364837646
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 0.5413651466369629
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 0.5900537967681885
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 0.5241830348968506
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 0.4414703845977783
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 0.4596590995788574
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 0.5885515213012695
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 0.5826120376586914
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 0.5527710914611816
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 0.4848470687866211
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 0.5382280349731445
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 0.5962374210357666
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 0.5408852100372314
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5397586822509766
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 0.5085887908935547
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 0.506105899810791
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.5733897686004639
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 0.5522465705871582
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.5623586177825928
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 0.6176590919494629
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 30 cost time: 0.5767905712127686
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 31 cost time: 0.593994140625
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 32 cost time: 0.5915985107421875
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 33 cost time: 0.5662438869476318
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.4903411865234375
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 35 cost time: 0.4596090316772461
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.5444655418395996
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.5390682220458984
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.5351042747497559
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.5303394794464111
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.5820708274841309
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.5790481567382812
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.5172288417816162
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.5062716007232666
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 44 cost time: 0.5520405769348145
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 45 cost time: 0.48002028465270996
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 46 cost time: 0.5175786018371582
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.4596095085144043
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.5330049991607666
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.5846514701843262
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.5696010589599609
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 574009
model size : 2.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.4975061416625977
Epoch: 1, Steps: 18 | Train Loss: 3.031 Vali Loss: 2.414 Vali Acc: 0.743 Test Loss: 2.414 Test Acc: 0.743
Validation loss decreased (inf --> -0.743309).  Saving model ...
Epoch: 2 cost time: 0.5953323841094971
Epoch: 2, Steps: 18 | Train Loss: 1.423 Vali Loss: 0.865 Vali Acc: 0.957 Test Loss: 0.865 Test Acc: 0.957
Validation loss decreased (-0.743309 --> -0.956658).  Saving model ...
Epoch: 3 cost time: 0.6363937854766846
Epoch: 3, Steps: 18 | Train Loss: 0.339 Vali Loss: 0.280 Vali Acc: 0.963 Test Loss: 0.280 Test Acc: 0.963
Validation loss decreased (-0.956658 --> -0.963331).  Saving model ...
Epoch: 4 cost time: 0.5378785133361816
Epoch: 4, Steps: 18 | Train Loss: 0.071 Vali Loss: 0.155 Vali Acc: 0.970 Test Loss: 0.155 Test Acc: 0.970
Validation loss decreased (-0.963331 --> -0.969998).  Saving model ...
Epoch: 5 cost time: 0.4554119110107422
Epoch: 5, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.126 Vali Acc: 0.973 Test Loss: 0.126 Test Acc: 0.973
Validation loss decreased (-0.969998 --> -0.973332).  Saving model ...
Epoch: 6 cost time: 0.5104296207427979
Epoch: 6, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.118 Vali Acc: 0.973 Test Loss: 0.118 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 0.5052282810211182
Epoch: 7, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 8 cost time: 0.452894926071167
Epoch: 8, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 0.4743773937225342
Epoch: 9, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 0.49783849716186523
Epoch: 10, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 0.5672686100006104
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 0.5803720951080322
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 0.556344747543335
Epoch: 13, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 0.570563554763794
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 0.5849230289459229
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 0.5508954524993896
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 0.5638656616210938
Epoch: 17, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 0.47703027725219727
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 0.5035438537597656
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 0.5213773250579834
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 0.5627009868621826
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.5806281566619873
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.5049135684967041
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 0.5236315727233887
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.5690934658050537
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 0.5708916187286377
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 0.5126743316650391
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 28 cost time: 0.5118911266326904
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 0.5029420852661133
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 30 cost time: 0.4826009273529053
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 31 cost time: 0.5401208400726318
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.5088515281677246
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 33 cost time: 0.49402689933776855
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 34 cost time: 0.5487189292907715
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 35 cost time: 0.5411350727081299
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 36 cost time: 0.5228660106658936
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 37 cost time: 0.5397017002105713
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 38 cost time: 0.5572540760040283
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.5441625118255615
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.48640918731689453
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.4370543956756592
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.5464832782745361
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.5857236385345459
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 44 cost time: 0.5729148387908936
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 45 cost time: 0.6184341907501221
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 46 cost time: 0.5116331577301025
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 47 cost time: 0.5580036640167236
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 48 cost time: 0.5457820892333984
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 49 cost time: 0.4304533004760742
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 50 cost time: 0.480118989944458
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 314937
model size : 1.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.4623618125915527
Epoch: 1, Steps: 18 | Train Loss: 3.161 Vali Loss: 2.747 Vali Acc: 0.403 Test Loss: 2.747 Test Acc: 0.403
Validation loss decreased (inf --> -0.403306).  Saving model ...
Epoch: 2 cost time: 0.5839664936065674
Epoch: 2, Steps: 18 | Train Loss: 1.936 Vali Loss: 1.461 Vali Acc: 0.923 Test Loss: 1.461 Test Acc: 0.923
Validation loss decreased (-0.403306 --> -0.923319).  Saving model ...
Epoch: 3 cost time: 0.5203671455383301
Epoch: 3, Steps: 18 | Train Loss: 0.768 Vali Loss: 0.561 Vali Acc: 0.960 Test Loss: 0.561 Test Acc: 0.960
Validation loss decreased (-0.923319 --> -0.959994).  Saving model ...
Epoch: 4 cost time: 0.4818906784057617
Epoch: 4, Steps: 18 | Train Loss: 0.210 Vali Loss: 0.258 Vali Acc: 0.977 Test Loss: 0.258 Test Acc: 0.977
Validation loss decreased (-0.959994 --> -0.976664).  Saving model ...
Epoch: 5 cost time: 0.48624420166015625
Epoch: 5, Steps: 18 | Train Loss: 0.066 Vali Loss: 0.183 Vali Acc: 0.980 Test Loss: 0.183 Test Acc: 0.980
Validation loss decreased (-0.976664 --> -0.979998).  Saving model ...
Epoch: 6 cost time: 0.5368194580078125
Epoch: 6, Steps: 18 | Train Loss: 0.031 Vali Loss: 0.154 Vali Acc: 0.983 Test Loss: 0.154 Test Acc: 0.983
Validation loss decreased (-0.979998 --> -0.983332).  Saving model ...
Epoch: 7 cost time: 0.5377585887908936
Epoch: 7, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.138 Vali Acc: 0.980 Test Loss: 0.138 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5208723545074463
Epoch: 8, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.126 Vali Acc: 0.980 Test Loss: 0.126 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.5297741889953613
Epoch: 9, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.121 Vali Acc: 0.980 Test Loss: 0.121 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.5382606983184814
Epoch: 10, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.5622501373291016
Epoch: 11, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.5392260551452637
Epoch: 12, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.109 Vali Acc: 0.980 Test Loss: 0.109 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.5189485549926758
Epoch: 13, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.4965476989746094
Epoch: 14, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.5059611797332764
Epoch: 15, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.5955295562744141
Epoch: 16, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 228633
model size : 0.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.5914294719696045
Epoch: 1, Steps: 18 | Train Loss: 3.273 Vali Loss: 2.961 Vali Acc: 0.260 Test Loss: 2.961 Test Acc: 0.260
Validation loss decreased (inf --> -0.259970).  Saving model ...
Epoch: 2 cost time: 0.5064780712127686
Epoch: 2, Steps: 18 | Train Loss: 2.323 Vali Loss: 1.928 Vali Acc: 0.840 Test Loss: 1.928 Test Acc: 0.840
Validation loss decreased (-0.259970 --> -0.839981).  Saving model ...
Epoch: 3 cost time: 0.5341165065765381
Epoch: 3, Steps: 18 | Train Loss: 1.215 Vali Loss: 0.921 Vali Acc: 0.950 Test Loss: 0.921 Test Acc: 0.950
Validation loss decreased (-0.839981 --> -0.949991).  Saving model ...
Epoch: 4 cost time: 0.47071099281311035
Epoch: 4, Steps: 18 | Train Loss: 0.456 Vali Loss: 0.419 Vali Acc: 0.957 Test Loss: 0.419 Test Acc: 0.957
Validation loss decreased (-0.949991 --> -0.956662).  Saving model ...
Epoch: 5 cost time: 0.5518178939819336
Epoch: 5, Steps: 18 | Train Loss: 0.148 Vali Loss: 0.252 Vali Acc: 0.967 Test Loss: 0.252 Test Acc: 0.967
Validation loss decreased (-0.956662 --> -0.966664).  Saving model ...
Epoch: 6 cost time: 0.5321354866027832
Epoch: 6, Steps: 18 | Train Loss: 0.064 Vali Loss: 0.188 Vali Acc: 0.973 Test Loss: 0.188 Test Acc: 0.973
Validation loss decreased (-0.966664 --> -0.973331).  Saving model ...
Epoch: 7 cost time: 0.4930107593536377
Epoch: 7, Steps: 18 | Train Loss: 0.038 Vali Loss: 0.163 Vali Acc: 0.977 Test Loss: 0.163 Test Acc: 0.977
Validation loss decreased (-0.973331 --> -0.976665).  Saving model ...
Epoch: 8 cost time: 0.5318291187286377
Epoch: 8, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.149 Vali Acc: 0.970 Test Loss: 0.149 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.564124345779419
Epoch: 9, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.142 Vali Acc: 0.973 Test Loss: 0.142 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.5095114707946777
Epoch: 10, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.132 Vali Acc: 0.973 Test Loss: 0.132 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.5005433559417725
Epoch: 11, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.124 Vali Acc: 0.970 Test Loss: 0.124 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.5075123310089111
Epoch: 12, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.120 Vali Acc: 0.970 Test Loss: 0.120 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.4453291893005371
Epoch: 13, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 0.5495166778564453
Epoch: 14, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 0.5109083652496338
Epoch: 15, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5106794834136963
Epoch: 16, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.584099531173706
Epoch: 17, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.5305535793304443
Epoch: 18, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.5911176204681396
Epoch: 19, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.585517406463623
Epoch: 20, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.4573483467102051
Epoch: 21, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.4869954586029053
Epoch: 22, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 0.5089733600616455
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.4806504249572754
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.44379496574401855
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.44226837158203125
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 0.48737001419067383
Epoch: 27, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 0.4789109230041504
Epoch: 28, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.45313334465026855
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 0.4685068130493164
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 31 cost time: 0.4843909740447998
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 32 cost time: 0.4762406349182129
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 33 cost time: 0.4602792263031006
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 34 cost time: 0.5996115207672119
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 35 cost time: 0.5984141826629639
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 36 cost time: 0.5465960502624512
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 37 cost time: 0.48989129066467285
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 38 cost time: 0.6129982471466064
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.4939079284667969
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 40 cost time: 0.6296412944793701
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 41 cost time: 0.5028238296508789
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.5086100101470947
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.5338618755340576
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 44 cost time: 0.5783720016479492
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.5465056896209717
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.6203889846801758
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 47 cost time: 0.6542272567749023
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.5370674133300781
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 49 cost time: 0.66410231590271
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 50 cost time: 0.4595832824707031
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 185561
model size : 0.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps22_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.5791900157928467
Epoch: 1, Steps: 18 | Train Loss: 3.192 Vali Loss: 2.978 Vali Acc: 0.237 Test Loss: 2.978 Test Acc: 0.237
Validation loss decreased (inf --> -0.236637).  Saving model ...
Epoch: 2 cost time: 0.4323883056640625
Epoch: 2, Steps: 18 | Train Loss: 2.473 Vali Loss: 2.132 Vali Acc: 0.800 Test Loss: 2.132 Test Acc: 0.800
Validation loss decreased (-0.236637 --> -0.799979).  Saving model ...
Epoch: 3 cost time: 0.5441656112670898
Epoch: 3, Steps: 18 | Train Loss: 1.516 Vali Loss: 1.224 Vali Acc: 0.940 Test Loss: 1.224 Test Acc: 0.940
Validation loss decreased (-0.799979 --> -0.939988).  Saving model ...
Epoch: 4 cost time: 0.5160973072052002
Epoch: 4, Steps: 18 | Train Loss: 0.711 Vali Loss: 0.603 Vali Acc: 0.963 Test Loss: 0.603 Test Acc: 0.963
Validation loss decreased (-0.939988 --> -0.963327).  Saving model ...
Epoch: 5 cost time: 0.5406136512756348
Epoch: 5, Steps: 18 | Train Loss: 0.294 Vali Loss: 0.330 Vali Acc: 0.977 Test Loss: 0.330 Test Acc: 0.977
Validation loss decreased (-0.963327 --> -0.976663).  Saving model ...
Epoch: 6 cost time: 0.5559380054473877
Epoch: 6, Steps: 18 | Train Loss: 0.131 Vali Loss: 0.236 Vali Acc: 0.973 Test Loss: 0.236 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5626246929168701
Epoch: 7, Steps: 18 | Train Loss: 0.074 Vali Loss: 0.194 Vali Acc: 0.980 Test Loss: 0.194 Test Acc: 0.980
Validation loss decreased (-0.976663 --> -0.979998).  Saving model ...
Epoch: 8 cost time: 0.6208188533782959
Epoch: 8, Steps: 18 | Train Loss: 0.047 Vali Loss: 0.167 Vali Acc: 0.983 Test Loss: 0.167 Test Acc: 0.983
Validation loss decreased (-0.979998 --> -0.983332).  Saving model ...
Epoch: 9 cost time: 0.4968440532684326
Epoch: 9, Steps: 18 | Train Loss: 0.034 Vali Loss: 0.153 Vali Acc: 0.983 Test Loss: 0.153 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 10 cost time: 0.6060974597930908
Epoch: 10, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.141 Vali Acc: 0.983 Test Loss: 0.141 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 11 cost time: 0.5671899318695068
Epoch: 11, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.132 Vali Acc: 0.983 Test Loss: 0.132 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 12 cost time: 0.466052770614624
Epoch: 12, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.126 Vali Acc: 0.983 Test Loss: 0.126 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 13 cost time: 0.5586071014404297
Epoch: 13, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.120 Vali Acc: 0.983 Test Loss: 0.120 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 14 cost time: 0.5803143978118896
Epoch: 14, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.116 Vali Acc: 0.983 Test Loss: 0.116 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 15 cost time: 0.5598313808441162
Epoch: 15, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.112 Vali Acc: 0.983 Test Loss: 0.112 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 16 cost time: 0.5363020896911621
Epoch: 16, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.107 Vali Acc: 0.983 Test Loss: 0.107 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 17 cost time: 0.5295331478118896
Epoch: 17, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.105 Vali Acc: 0.983 Test Loss: 0.105 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 18 cost time: 0.5498511791229248
Epoch: 18, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.103 Vali Acc: 0.983 Test Loss: 0.103 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 19 cost time: 0.5590674877166748
Epoch: 19, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.100 Vali Acc: 0.983 Test Loss: 0.100 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 20 cost time: 0.6040573120117188
Epoch: 20, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.097 Vali Acc: 0.983 Test Loss: 0.097 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 21 cost time: 0.5246877670288086
Epoch: 21, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.096 Vali Acc: 0.983 Test Loss: 0.096 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 22 cost time: 0.48088908195495605
Epoch: 22, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.093 Vali Acc: 0.983 Test Loss: 0.093 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 23 cost time: 0.49037861824035645
Epoch: 23, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.092 Vali Acc: 0.983 Test Loss: 0.092 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 24 cost time: 0.49455881118774414
Epoch: 24, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.983 Test Loss: 0.090 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 25 cost time: 0.5573749542236328
Epoch: 25, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 26 cost time: 0.5533542633056641
Epoch: 26, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 27 cost time: 0.5607197284698486
Epoch: 27, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 28 cost time: 0.55776047706604
Epoch: 28, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 29 cost time: 0.5374469757080078
Epoch: 29, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 30 cost time: 0.5522687435150146
Epoch: 30, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 31 cost time: 0.56504225730896
Epoch: 31, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 32 cost time: 0.5388612747192383
Epoch: 32, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 33 cost time: 0.4613494873046875
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983333).  Saving model ...
Epoch: 34 cost time: 0.5738935470581055
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 35 cost time: 0.5685386657714844
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 36 cost time: 0.52366042137146
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 37 cost time: 0.4637024402618408
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 38 cost time: 0.5739665031433105
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 39 cost time: 0.5130100250244141
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 40 cost time: 0.5085959434509277
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 41 cost time: 0.5544064044952393
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.5095412731170654
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.5404059886932373
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 44 cost time: 0.5620169639587402
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.5930724143981934
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.5870871543884277
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 47 cost time: 0.5512335300445557
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 48 cost time: 0.5822179317474365
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.5866086483001709
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 50 cost time: 0.5770442485809326
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps22_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 149785
model size : 0.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps29_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.4067740440368652
Epoch: 1, Steps: 18 | Train Loss: 3.178 Vali Loss: 2.986 Vali Acc: 0.177 Test Loss: 2.986 Test Acc: 0.177
Validation loss decreased (inf --> -0.176637).  Saving model ...
Epoch: 2 cost time: 0.5697281360626221
Epoch: 2, Steps: 18 | Train Loss: 2.678 Vali Loss: 2.401 Vali Acc: 0.687 Test Loss: 2.401 Test Acc: 0.687
Validation loss decreased (-0.176637 --> -0.686643).  Saving model ...
Epoch: 3 cost time: 0.5572693347930908
Epoch: 3, Steps: 18 | Train Loss: 1.947 Vali Loss: 1.667 Vali Acc: 0.890 Test Loss: 1.667 Test Acc: 0.890
Validation loss decreased (-0.686643 --> -0.889983).  Saving model ...
Epoch: 4 cost time: 0.566962718963623
Epoch: 4, Steps: 18 | Train Loss: 1.210 Vali Loss: 1.014 Vali Acc: 0.953 Test Loss: 1.014 Test Acc: 0.953
Validation loss decreased (-0.889983 --> -0.953323).  Saving model ...
Epoch: 5 cost time: 0.4805564880371094
Epoch: 5, Steps: 18 | Train Loss: 0.635 Vali Loss: 0.591 Vali Acc: 0.963 Test Loss: 0.591 Test Acc: 0.963
Validation loss decreased (-0.953323 --> -0.963327).  Saving model ...
Epoch: 6 cost time: 0.49259519577026367
Epoch: 6, Steps: 18 | Train Loss: 0.318 Vali Loss: 0.375 Vali Acc: 0.963 Test Loss: 0.375 Test Acc: 0.963
Validation loss decreased (-0.963327 --> -0.963330).  Saving model ...
Epoch: 7 cost time: 0.5289924144744873
Epoch: 7, Steps: 18 | Train Loss: 0.168 Vali Loss: 0.284 Vali Acc: 0.967 Test Loss: 0.284 Test Acc: 0.967
Validation loss decreased (-0.963330 --> -0.966664).  Saving model ...
Epoch: 8 cost time: 0.558664083480835
Epoch: 8, Steps: 18 | Train Loss: 0.108 Vali Loss: 0.234 Vali Acc: 0.973 Test Loss: 0.234 Test Acc: 0.973
Validation loss decreased (-0.966664 --> -0.973331).  Saving model ...
Epoch: 9 cost time: 0.5538699626922607
Epoch: 9, Steps: 18 | Train Loss: 0.070 Vali Loss: 0.205 Vali Acc: 0.973 Test Loss: 0.205 Test Acc: 0.973
Validation loss decreased (-0.973331 --> -0.973331).  Saving model ...
Epoch: 10 cost time: 0.5613985061645508
Epoch: 10, Steps: 18 | Train Loss: 0.054 Vali Loss: 0.182 Vali Acc: 0.973 Test Loss: 0.182 Test Acc: 0.973
Validation loss decreased (-0.973331 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 0.548445463180542
Epoch: 11, Steps: 18 | Train Loss: 0.042 Vali Loss: 0.167 Vali Acc: 0.977 Test Loss: 0.167 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 12 cost time: 0.5342681407928467
Epoch: 12, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.155 Vali Acc: 0.977 Test Loss: 0.155 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 13 cost time: 0.5715930461883545
Epoch: 13, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.148 Vali Acc: 0.973 Test Loss: 0.148 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.544548511505127
Epoch: 14, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.140 Vali Acc: 0.973 Test Loss: 0.140 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.49799442291259766
Epoch: 15, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.133 Vali Acc: 0.973 Test Loss: 0.133 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.47202301025390625
Epoch: 16, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.129 Vali Acc: 0.973 Test Loss: 0.129 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.5753297805786133
Epoch: 17, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.123 Vali Acc: 0.973 Test Loss: 0.123 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.5531423091888428
Epoch: 18, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 19 cost time: 0.5049729347229004
Epoch: 19, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 0.46288514137268066
Epoch: 20, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 0.5385940074920654
Epoch: 21, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 0.5432596206665039
Epoch: 22, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 0.5599589347839355
Epoch: 23, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 0.4997732639312744
Epoch: 24, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 0.4811389446258545
Epoch: 25, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 0.5196361541748047
Epoch: 26, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 0.44806885719299316
Epoch: 27, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 28 cost time: 0.5856490135192871
Epoch: 28, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 0.5460770130157471
Epoch: 29, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 30 cost time: 0.5421655178070068
Epoch: 30, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 31 cost time: 0.5189926624298096
Epoch: 31, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.5352585315704346
Epoch: 32, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 33 cost time: 0.5420119762420654
Epoch: 33, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 34 cost time: 0.5608537197113037
Epoch: 34, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 35 cost time: 0.4760310649871826
Epoch: 35, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.5122439861297607
Epoch: 36, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.5567595958709717
Epoch: 37, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.5420970916748047
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.4865396022796631
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.5523600578308105
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.5372750759124756
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.569530725479126
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.5083506107330322
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 44 cost time: 0.5333113670349121
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 45 cost time: 0.44737768173217773
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 46 cost time: 0.4410841464996338
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 47 cost time: 0.5052106380462646
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 48 cost time: 0.490541934967041
Epoch: 48, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.4957895278930664
Epoch: 49, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.4865267276763916
Epoch: 50, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps29_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 121209
model size : 0.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps36_str18_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.4381115436553955
Epoch: 1, Steps: 18 | Train Loss: 3.215 Vali Loss: 3.071 Vali Acc: 0.147 Test Loss: 3.071 Test Acc: 0.147
Validation loss decreased (inf --> -0.146636).  Saving model ...
Epoch: 2 cost time: 0.5601725578308105
Epoch: 2, Steps: 18 | Train Loss: 2.759 Vali Loss: 2.515 Vali Acc: 0.530 Test Loss: 2.515 Test Acc: 0.530
Validation loss decreased (-0.146636 --> -0.529975).  Saving model ...
Epoch: 3 cost time: 0.5512194633483887
Epoch: 3, Steps: 18 | Train Loss: 2.096 Vali Loss: 1.820 Vali Acc: 0.817 Test Loss: 1.820 Test Acc: 0.817
Validation loss decreased (-0.529975 --> -0.816648).  Saving model ...
Epoch: 4 cost time: 0.5507476329803467
Epoch: 4, Steps: 18 | Train Loss: 1.370 Vali Loss: 1.177 Vali Acc: 0.927 Test Loss: 1.177 Test Acc: 0.927
Validation loss decreased (-0.816648 --> -0.926655).  Saving model ...
Epoch: 5 cost time: 0.5143206119537354
Epoch: 5, Steps: 18 | Train Loss: 0.773 Vali Loss: 0.695 Vali Acc: 0.957 Test Loss: 0.695 Test Acc: 0.957
Validation loss decreased (-0.926655 --> -0.956660).  Saving model ...
Epoch: 6 cost time: 0.5530903339385986
Epoch: 6, Steps: 18 | Train Loss: 0.404 Vali Loss: 0.443 Vali Acc: 0.967 Test Loss: 0.443 Test Acc: 0.967
Validation loss decreased (-0.956660 --> -0.966662).  Saving model ...
Epoch: 7 cost time: 0.5435028076171875
Epoch: 7, Steps: 18 | Train Loss: 0.215 Vali Loss: 0.319 Vali Acc: 0.963 Test Loss: 0.319 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.49135422706604004
Epoch: 8, Steps: 18 | Train Loss: 0.129 Vali Loss: 0.260 Vali Acc: 0.970 Test Loss: 0.260 Test Acc: 0.970
Validation loss decreased (-0.966662 --> -0.969997).  Saving model ...
Epoch: 9 cost time: 0.4721641540527344
Epoch: 9, Steps: 18 | Train Loss: 0.091 Vali Loss: 0.224 Vali Acc: 0.970 Test Loss: 0.224 Test Acc: 0.970
Validation loss decreased (-0.969997 --> -0.969998).  Saving model ...
Epoch: 10 cost time: 0.5274853706359863
Epoch: 10, Steps: 18 | Train Loss: 0.068 Vali Loss: 0.194 Vali Acc: 0.977 Test Loss: 0.194 Test Acc: 0.977
Validation loss decreased (-0.969998 --> -0.976665).  Saving model ...
Epoch: 11 cost time: 0.5049996376037598
Epoch: 11, Steps: 18 | Train Loss: 0.051 Vali Loss: 0.175 Vali Acc: 0.973 Test Loss: 0.175 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.524024486541748
Epoch: 12, Steps: 18 | Train Loss: 0.039 Vali Loss: 0.162 Vali Acc: 0.977 Test Loss: 0.162 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 13 cost time: 0.5354671478271484
Epoch: 13, Steps: 18 | Train Loss: 0.032 Vali Loss: 0.152 Vali Acc: 0.973 Test Loss: 0.152 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.56778883934021
Epoch: 14, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.143 Vali Acc: 0.977 Test Loss: 0.143 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 15 cost time: 0.5722246170043945
Epoch: 15, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.136 Vali Acc: 0.977 Test Loss: 0.136 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 16 cost time: 0.5186223983764648
Epoch: 16, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.129 Vali Acc: 0.977 Test Loss: 0.129 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 17 cost time: 0.5892763137817383
Epoch: 17, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.124 Vali Acc: 0.977 Test Loss: 0.124 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 18 cost time: 0.524895191192627
Epoch: 18, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.475177526473999
Epoch: 19, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 0.46294212341308594
Epoch: 20, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 0.5632181167602539
Epoch: 21, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 0.5310437679290771
Epoch: 22, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 0.507648229598999
Epoch: 23, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 0.5252687931060791
Epoch: 24, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 0.5442368984222412
Epoch: 25, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 0.5718402862548828
Epoch: 26, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 0.5275630950927734
Epoch: 27, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 28 cost time: 0.5043902397155762
Epoch: 28, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 0.5064964294433594
Epoch: 29, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 30 cost time: 0.5251314640045166
Epoch: 30, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.5097286701202393
Epoch: 31, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.657219648361206
Epoch: 32, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.5140993595123291
Epoch: 33, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 34 cost time: 0.5388591289520264
Epoch: 34, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 35 cost time: 0.5590040683746338
Epoch: 35, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.5572500228881836
Epoch: 36, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.5418694019317627
Epoch: 37, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.5095629692077637
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.5041177272796631
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.5043244361877441
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 41 cost time: 0.5222735404968262
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.5729889869689941
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.5383591651916504
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.5846061706542969
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.5645427703857422
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.5413036346435547
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.5548226833343506
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 0.48509645462036133
Epoch: 48, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 0.474151611328125
Epoch: 49, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 0.5401430130004883
Epoch: 50, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps36_str18_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 114233
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.72340989112854
Epoch: 1, Steps: 18 | Train Loss: 3.116 Vali Loss: 2.770 Vali Acc: 0.697 Test Loss: 2.770 Test Acc: 0.697
Validation loss decreased (inf --> -0.696639).  Saving model ...
Epoch: 2 cost time: 0.9100079536437988
Epoch: 2, Steps: 18 | Train Loss: 1.726 Vali Loss: 0.959 Vali Acc: 0.950 Test Loss: 0.959 Test Acc: 0.950
Validation loss decreased (-0.696639 --> -0.949990).  Saving model ...
Epoch: 3 cost time: 0.9412100315093994
Epoch: 3, Steps: 18 | Train Loss: 0.283 Vali Loss: 0.165 Vali Acc: 0.967 Test Loss: 0.165 Test Acc: 0.967
Validation loss decreased (-0.949990 --> -0.966665).  Saving model ...
Epoch: 4 cost time: 0.9662919044494629
Epoch: 4, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.115 Vali Acc: 0.970 Test Loss: 0.115 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969999).  Saving model ...
Epoch: 5 cost time: 0.960524320602417
Epoch: 5, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.120 Vali Acc: 0.967 Test Loss: 0.120 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9886777400970459
Epoch: 6, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 0.8526155948638916
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 0.8648135662078857
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 0.8867578506469727
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 1.0782525539398193
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 0.9303526878356934
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 12 cost time: 0.9699571132659912
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9434115886688232
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 14 cost time: 0.8251161575317383
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 0.8122050762176514
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.943763256072998
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9578800201416016
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 0.9838387966156006
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 0.9890503883361816
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9372789859771729
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 0.8954215049743652
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 0.8558530807495117
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8379499912261963
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.9834263324737549
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.9162576198577881
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.9099576473236084
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.9076666831970215
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.9546732902526855
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.8501698970794678
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.9365139007568359
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.9798657894134521
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 1015737
model size : 3.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.828153371810913
Epoch: 1, Steps: 18 | Train Loss: 3.119 Vali Loss: 2.934 Vali Acc: 0.570 Test Loss: 2.934 Test Acc: 0.570
Validation loss decreased (inf --> -0.569971).  Saving model ...
Epoch: 2 cost time: 0.8897883892059326
Epoch: 2, Steps: 18 | Train Loss: 2.329 Vali Loss: 1.865 Vali Acc: 0.920 Test Loss: 1.865 Test Acc: 0.920
Validation loss decreased (-0.569971 --> -0.919981).  Saving model ...
Epoch: 3 cost time: 0.9696609973907471
Epoch: 3, Steps: 18 | Train Loss: 1.001 Vali Loss: 0.501 Vali Acc: 0.963 Test Loss: 0.501 Test Acc: 0.963
Validation loss decreased (-0.919981 --> -0.963328).  Saving model ...
Epoch: 4 cost time: 1.0163159370422363
Epoch: 4, Steps: 18 | Train Loss: 0.185 Vali Loss: 0.161 Vali Acc: 0.967 Test Loss: 0.161 Test Acc: 0.967
Validation loss decreased (-0.963328 --> -0.966665).  Saving model ...
Epoch: 5 cost time: 0.9916505813598633
Epoch: 5, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.123 Vali Acc: 0.973 Test Loss: 0.123 Test Acc: 0.973
Validation loss decreased (-0.966665 --> -0.973332).  Saving model ...
Epoch: 6 cost time: 0.9578328132629395
Epoch: 6, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 7 cost time: 0.8362741470336914
Epoch: 7, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 8 cost time: 0.9253363609313965
Epoch: 8, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.093 Vali Acc: 0.983 Test Loss: 0.093 Test Acc: 0.983
Validation loss decreased (-0.976666 --> -0.983332).  Saving model ...
Epoch: 9 cost time: 0.8950686454772949
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.091 Vali Acc: 0.983 Test Loss: 0.091 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 10 cost time: 0.9081604480743408
Epoch: 10, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.983 Test Loss: 0.090 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 11 cost time: 1.0051264762878418
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9170947074890137
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.0260014533996582
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.0427722930908203
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.9232797622680664
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.844426155090332
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.9614253044128418
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.9766061305999756
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.8864848613739014
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.9880695343017578
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 756665
model size : 2.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.8232953548431396
Epoch: 1, Steps: 18 | Train Loss: 3.163 Vali Loss: 3.073 Vali Acc: 0.260 Test Loss: 3.073 Test Acc: 0.260
Validation loss decreased (inf --> -0.259969).  Saving model ...
Epoch: 2 cost time: 0.9661595821380615
Epoch: 2, Steps: 18 | Train Loss: 2.653 Vali Loss: 2.403 Vali Acc: 0.897 Test Loss: 2.403 Test Acc: 0.897
Validation loss decreased (-0.259969 --> -0.896643).  Saving model ...
Epoch: 3 cost time: 0.9391214847564697
Epoch: 3, Steps: 18 | Train Loss: 1.678 Vali Loss: 1.150 Vali Acc: 0.953 Test Loss: 1.150 Test Acc: 0.953
Validation loss decreased (-0.896643 --> -0.953322).  Saving model ...
Epoch: 4 cost time: 0.920203685760498
Epoch: 4, Steps: 18 | Train Loss: 0.562 Vali Loss: 0.319 Vali Acc: 0.970 Test Loss: 0.319 Test Acc: 0.970
Validation loss decreased (-0.953322 --> -0.969997).  Saving model ...
Epoch: 5 cost time: 0.891326904296875
Epoch: 5, Steps: 18 | Train Loss: 0.111 Vali Loss: 0.167 Vali Acc: 0.973 Test Loss: 0.167 Test Acc: 0.973
Validation loss decreased (-0.969997 --> -0.973332).  Saving model ...
Epoch: 6 cost time: 0.9207947254180908
Epoch: 6, Steps: 18 | Train Loss: 0.034 Vali Loss: 0.135 Vali Acc: 0.973 Test Loss: 0.135 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 0.9697411060333252
Epoch: 7, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.120 Vali Acc: 0.980 Test Loss: 0.120 Test Acc: 0.980
Validation loss decreased (-0.973332 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 1.0670788288116455
Epoch: 8, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.98982834815979
Epoch: 9, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9100584983825684
Epoch: 10, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9236340522766113
Epoch: 11, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.9609272480010986
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.9470882415771484
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.7990946769714355
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 0.8120217323303223
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 0.7671613693237305
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 0.9508111476898193
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 1.0023479461669922
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 1.063204288482666
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 0.9897546768188477
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 0.9322171211242676
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 0.8808028697967529
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 0.9341645240783691
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0089235305786133
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.0030264854431152
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 0.9711697101593018
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9451448917388916
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 1.007612705230713
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 0.9265167713165283
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9264328479766846
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.0046381950378418
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.9815578460693359
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.9562802314758301
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.9053962230682373
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 35 cost time: 0.8707976341247559
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.9130833148956299
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 37 cost time: 0.8943824768066406
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.9760491847991943
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.9454894065856934
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.0107824802398682
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.9066662788391113
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.9597625732421875
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.8504598140716553
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.9107553958892822
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.8996124267578125
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 1.0728743076324463
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 670361
model size : 2.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.6265695095062256
Epoch: 1, Steps: 18 | Train Loss: 3.174 Vali Loss: 3.091 Vali Acc: 0.243 Test Loss: 3.091 Test Acc: 0.243
Validation loss decreased (inf --> -0.243302).  Saving model ...
Epoch: 2 cost time: 0.9753005504608154
Epoch: 2, Steps: 18 | Train Loss: 2.742 Vali Loss: 2.538 Vali Acc: 0.790 Test Loss: 2.538 Test Acc: 0.790
Validation loss decreased (-0.243302 --> -0.789975).  Saving model ...
Epoch: 3 cost time: 0.967832088470459
Epoch: 3, Steps: 18 | Train Loss: 1.890 Vali Loss: 1.461 Vali Acc: 0.937 Test Loss: 1.461 Test Acc: 0.937
Validation loss decreased (-0.789975 --> -0.936652).  Saving model ...
Epoch: 4 cost time: 1.0188064575195312
Epoch: 4, Steps: 18 | Train Loss: 0.824 Vali Loss: 0.459 Vali Acc: 0.963 Test Loss: 0.459 Test Acc: 0.963
Validation loss decreased (-0.936652 --> -0.963329).  Saving model ...
Epoch: 5 cost time: 1.0463106632232666
Epoch: 5, Steps: 18 | Train Loss: 0.185 Vali Loss: 0.184 Vali Acc: 0.970 Test Loss: 0.184 Test Acc: 0.970
Validation loss decreased (-0.963329 --> -0.969998).  Saving model ...
Epoch: 6 cost time: 0.913952112197876
Epoch: 6, Steps: 18 | Train Loss: 0.052 Vali Loss: 0.146 Vali Acc: 0.973 Test Loss: 0.146 Test Acc: 0.973
Validation loss decreased (-0.969998 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 0.8996407985687256
Epoch: 7, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.120 Vali Acc: 0.977 Test Loss: 0.120 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 8 cost time: 1.0015478134155273
Epoch: 8, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 0.9180905818939209
Epoch: 9, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 1.0424938201904297
Epoch: 10, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 0.9195184707641602
Epoch: 11, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 0.9817309379577637
Epoch: 12, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 0.9696593284606934
Epoch: 13, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9606852531433105
Epoch: 14, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 0.9151406288146973
Epoch: 15, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 1.023848056793213
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8941218852996826
Epoch: 17, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 1.0041532516479492
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 1.0465781688690186
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0446302890777588
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 0.8553600311279297
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9366414546966553
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0186257362365723
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.0381217002868652
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.9857869148254395
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.0048370361328125
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.0224354267120361
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.0187466144561768
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.8985316753387451
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 30 cost time: 1.0306437015533447
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.9127278327941895
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.8766739368438721
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.0288941860198975
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.8925149440765381
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.9791183471679688
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.9210569858551025
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.9473440647125244
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.8950254917144775
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.0721290111541748
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 641689
model size : 2.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps22_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.043017864227295
Epoch: 1, Steps: 18 | Train Loss: 3.201 Vali Loss: 3.129 Vali Acc: 0.150 Test Loss: 3.129 Test Acc: 0.150
Validation loss decreased (inf --> -0.149969).  Saving model ...
Epoch: 2 cost time: 0.9294087886810303
Epoch: 2, Steps: 18 | Train Loss: 2.854 Vali Loss: 2.670 Vali Acc: 0.720 Test Loss: 2.670 Test Acc: 0.720
Validation loss decreased (-0.149969 --> -0.719973).  Saving model ...
Epoch: 3 cost time: 1.027270793914795
Epoch: 3, Steps: 18 | Train Loss: 2.163 Vali Loss: 1.820 Vali Acc: 0.893 Test Loss: 1.820 Test Acc: 0.893
Validation loss decreased (-0.719973 --> -0.893315).  Saving model ...
Epoch: 4 cost time: 0.969794511795044
Epoch: 4, Steps: 18 | Train Loss: 1.194 Vali Loss: 0.772 Vali Acc: 0.950 Test Loss: 0.772 Test Acc: 0.950
Validation loss decreased (-0.893315 --> -0.949992).  Saving model ...
Epoch: 5 cost time: 0.9222774505615234
Epoch: 5, Steps: 18 | Train Loss: 0.371 Vali Loss: 0.263 Vali Acc: 0.967 Test Loss: 0.263 Test Acc: 0.967
Validation loss decreased (-0.949992 --> -0.966664).  Saving model ...
Epoch: 6 cost time: 0.9315791130065918
Epoch: 6, Steps: 18 | Train Loss: 0.102 Vali Loss: 0.155 Vali Acc: 0.973 Test Loss: 0.155 Test Acc: 0.973
Validation loss decreased (-0.966664 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 0.8652057647705078
Epoch: 7, Steps: 18 | Train Loss: 0.037 Vali Loss: 0.131 Vali Acc: 0.970 Test Loss: 0.131 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0469732284545898
Epoch: 8, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 0.9466793537139893
Epoch: 9, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.113 Vali Acc: 0.967 Test Loss: 0.113 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9638512134552002
Epoch: 10, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 0.9795494079589844
Epoch: 11, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 12 cost time: 1.047520637512207
Epoch: 12, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 13 cost time: 0.932518720626831
Epoch: 13, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 14 cost time: 0.8456873893737793
Epoch: 14, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 15 cost time: 0.8932487964630127
Epoch: 15, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 16 cost time: 0.8983561992645264
Epoch: 16, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 17 cost time: 0.821434497833252
Epoch: 17, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9390246868133545
Epoch: 18, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 19 cost time: 1.030285358428955
Epoch: 19, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 20 cost time: 0.9244437217712402
Epoch: 20, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 21 cost time: 0.9098565578460693
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 22 cost time: 0.913994550704956
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 23 cost time: 0.9552404880523682
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 24 cost time: 0.9549829959869385
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9832746982574463
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.9921295642852783
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.9320533275604248
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.9281775951385498
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 29 cost time: 0.8341317176818848
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.8546383380889893
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.0098185539245605
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.942136287689209
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.9322230815887451
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 34 cost time: 0.9429383277893066
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.036149501800537
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 36 cost time: 0.9672935009002686
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 37 cost time: 0.958303689956665
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 38 cost time: 0.925973653793335
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.8779096603393555
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.9256699085235596
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 41 cost time: 0.8897991180419922
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.8821330070495605
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 43 cost time: 1.0216264724731445
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.9293191432952881
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.9771215915679932
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.9716508388519287
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.9552178382873535
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.9581968784332275
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.9490487575531006
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.869645357131958
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps22_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9733333333333334
model parameter : 613113
model size : 2.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps29_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.8623042106628418
Epoch: 1, Steps: 18 | Train Loss: 3.223 Vali Loss: 3.132 Vali Acc: 0.177 Test Loss: 3.132 Test Acc: 0.177
Validation loss decreased (inf --> -0.176635).  Saving model ...
Epoch: 2 cost time: 0.9189918041229248
Epoch: 2, Steps: 18 | Train Loss: 2.912 Vali Loss: 2.744 Vali Acc: 0.607 Test Loss: 2.744 Test Acc: 0.607
Validation loss decreased (-0.176635 --> -0.606639).  Saving model ...
Epoch: 3 cost time: 0.9056992530822754
Epoch: 3, Steps: 18 | Train Loss: 2.310 Vali Loss: 2.038 Vali Acc: 0.880 Test Loss: 2.038 Test Acc: 0.880
Validation loss decreased (-0.606639 --> -0.879980).  Saving model ...
Epoch: 4 cost time: 0.9243652820587158
Epoch: 4, Steps: 18 | Train Loss: 1.501 Vali Loss: 1.116 Vali Acc: 0.933 Test Loss: 1.116 Test Acc: 0.933
Validation loss decreased (-0.879980 --> -0.933322).  Saving model ...
Epoch: 5 cost time: 0.9487624168395996
Epoch: 5, Steps: 18 | Train Loss: 0.651 Vali Loss: 0.442 Vali Acc: 0.960 Test Loss: 0.442 Test Acc: 0.960
Validation loss decreased (-0.933322 --> -0.959996).  Saving model ...
Epoch: 6 cost time: 0.9308314323425293
Epoch: 6, Steps: 18 | Train Loss: 0.213 Vali Loss: 0.221 Vali Acc: 0.960 Test Loss: 0.221 Test Acc: 0.960
Validation loss decreased (-0.959996 --> -0.959998).  Saving model ...
Epoch: 7 cost time: 0.9512488842010498
Epoch: 7, Steps: 18 | Train Loss: 0.086 Vali Loss: 0.161 Vali Acc: 0.963 Test Loss: 0.161 Test Acc: 0.963
Validation loss decreased (-0.959998 --> -0.963332).  Saving model ...
Epoch: 8 cost time: 0.9311211109161377
Epoch: 8, Steps: 18 | Train Loss: 0.041 Vali Loss: 0.133 Vali Acc: 0.977 Test Loss: 0.133 Test Acc: 0.977
Validation loss decreased (-0.963332 --> -0.976665).  Saving model ...
Epoch: 9 cost time: 0.8980906009674072
Epoch: 9, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.949486255645752
Epoch: 10, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.115 Vali Acc: 0.970 Test Loss: 0.115 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9858260154724121
Epoch: 11, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 0.9715156555175781
Epoch: 12, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9303476810455322
Epoch: 13, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9154722690582275
Epoch: 14, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.920316219329834
Epoch: 15, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.9222042560577393
Epoch: 16, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.8966515064239502
Epoch: 17, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 0.9361462593078613
Epoch: 18, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9134247303009033
Epoch: 19, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 0.8149070739746094
Epoch: 20, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.015925407409668
Epoch: 21, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.088 Vali Acc: 0.970 Test Loss: 0.088 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.8199856281280518
Epoch: 22, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.086 Vali Acc: 0.970 Test Loss: 0.086 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.8592972755432129
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
Validation loss decreased (-0.976666 --> -0.983332).  Saving model ...
Epoch: 24 cost time: 0.8712165355682373
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9346697330474854
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.9967763423919678
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.8998348712921143
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.020909309387207
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.9108989238739014
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.9542896747589111
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.9426891803741455
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.8747110366821289
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.0167005062103271
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps29_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 584537
model size : 2.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps36_str18_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.0310604572296143
Epoch: 1, Steps: 18 | Train Loss: 3.190 Vali Loss: 3.148 Vali Acc: 0.077 Test Loss: 3.148 Test Acc: 0.077
Validation loss decreased (inf --> -0.076635).  Saving model ...
Epoch: 2 cost time: 0.9518914222717285
Epoch: 2, Steps: 18 | Train Loss: 2.987 Vali Loss: 2.889 Vali Acc: 0.477 Test Loss: 2.889 Test Acc: 0.477
Validation loss decreased (-0.076635 --> -0.476638).  Saving model ...
Epoch: 3 cost time: 0.8626070022583008
Epoch: 3, Steps: 18 | Train Loss: 2.619 Vali Loss: 2.438 Vali Acc: 0.853 Test Loss: 2.438 Test Acc: 0.853
Validation loss decreased (-0.476638 --> -0.853309).  Saving model ...
Epoch: 4 cost time: 0.9489624500274658
Epoch: 4, Steps: 18 | Train Loss: 2.067 Vali Loss: 1.752 Vali Acc: 0.950 Test Loss: 1.752 Test Acc: 0.950
Validation loss decreased (-0.853309 --> -0.949982).  Saving model ...
Epoch: 5 cost time: 0.8661298751831055
Epoch: 5, Steps: 18 | Train Loss: 1.303 Vali Loss: 0.971 Vali Acc: 0.960 Test Loss: 0.971 Test Acc: 0.960
Validation loss decreased (-0.949982 --> -0.959990).  Saving model ...
Epoch: 6 cost time: 0.9914162158966064
Epoch: 6, Steps: 18 | Train Loss: 0.623 Vali Loss: 0.444 Vali Acc: 0.973 Test Loss: 0.444 Test Acc: 0.973
Validation loss decreased (-0.959990 --> -0.973329).  Saving model ...
Epoch: 7 cost time: 1.0073254108428955
Epoch: 7, Steps: 18 | Train Loss: 0.239 Vali Loss: 0.262 Vali Acc: 0.973 Test Loss: 0.262 Test Acc: 0.973
Validation loss decreased (-0.973329 --> -0.973331).  Saving model ...
Epoch: 8 cost time: 0.9080719947814941
Epoch: 8, Steps: 18 | Train Loss: 0.112 Vali Loss: 0.196 Vali Acc: 0.977 Test Loss: 0.196 Test Acc: 0.977
Validation loss decreased (-0.973331 --> -0.976665).  Saving model ...
Epoch: 9 cost time: 0.8896934986114502
Epoch: 9, Steps: 18 | Train Loss: 0.071 Vali Loss: 0.163 Vali Acc: 0.977 Test Loss: 0.163 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 10 cost time: 1.1151623725891113
Epoch: 10, Steps: 18 | Train Loss: 0.043 Vali Loss: 0.145 Vali Acc: 0.987 Test Loss: 0.145 Test Acc: 0.987
Validation loss decreased (-0.976665 --> -0.986665).  Saving model ...
Epoch: 11 cost time: 1.1194427013397217
Epoch: 11, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.132 Vali Acc: 0.987 Test Loss: 0.132 Test Acc: 0.987
Validation loss decreased (-0.986665 --> -0.986665).  Saving model ...
Epoch: 12 cost time: 1.0202562808990479
Epoch: 12, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.124 Vali Acc: 0.987 Test Loss: 0.124 Test Acc: 0.987
Validation loss decreased (-0.986665 --> -0.986665).  Saving model ...
Epoch: 13 cost time: 1.0932810306549072
Epoch: 13, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.118 Vali Acc: 0.987 Test Loss: 0.118 Test Acc: 0.987
Validation loss decreased (-0.986665 --> -0.986665).  Saving model ...
Epoch: 14 cost time: 1.0710108280181885
Epoch: 14, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.113 Vali Acc: 0.987 Test Loss: 0.113 Test Acc: 0.987
Validation loss decreased (-0.986665 --> -0.986666).  Saving model ...
Epoch: 15 cost time: 1.095550775527954
Epoch: 15, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.109 Vali Acc: 0.987 Test Loss: 0.109 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 16 cost time: 0.9132404327392578
Epoch: 16, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.105 Vali Acc: 0.987 Test Loss: 0.105 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 17 cost time: 1.0330052375793457
Epoch: 17, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.104 Vali Acc: 0.987 Test Loss: 0.104 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 18 cost time: 1.1802499294281006
Epoch: 18, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.102 Vali Acc: 0.987 Test Loss: 0.102 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 19 cost time: 1.0614879131317139
Epoch: 19, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.102 Vali Acc: 0.987 Test Loss: 0.102 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 20 cost time: 1.0689847469329834
Epoch: 20, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.100 Vali Acc: 0.987 Test Loss: 0.100 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 21 cost time: 1.0696213245391846
Epoch: 21, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.097 Vali Acc: 0.987 Test Loss: 0.097 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 22 cost time: 0.9709279537200928
Epoch: 22, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.097 Vali Acc: 0.987 Test Loss: 0.097 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 23 cost time: 1.0960078239440918
Epoch: 23, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.987 Test Loss: 0.096 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 24 cost time: 0.9174861907958984
Epoch: 24, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.095 Vali Acc: 0.987 Test Loss: 0.095 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 25 cost time: 0.9260647296905518
Epoch: 25, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.095 Vali Acc: 0.987 Test Loss: 0.095 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.1127116680145264
Epoch: 26, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.095 Vali Acc: 0.987 Test Loss: 0.095 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 27 cost time: 1.0578639507293701
Epoch: 27, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.095 Vali Acc: 0.987 Test Loss: 0.095 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 28 cost time: 1.0652449131011963
Epoch: 28, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.987 Test Loss: 0.093 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 29 cost time: 0.9146835803985596
Epoch: 29, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.987 Test Loss: 0.092 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 30 cost time: 1.1443591117858887
Epoch: 30, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.987 Test Loss: 0.092 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 31 cost time: 0.9999563694000244
Epoch: 31, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.987 Test Loss: 0.091 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 32 cost time: 1.0383327007293701
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.987 Test Loss: 0.091 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.8427863121032715
Epoch: 33, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.987 Test Loss: 0.091 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 34 cost time: 1.0866143703460693
Epoch: 34, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.987 Test Loss: 0.091 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.0410666465759277
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.987 Test Loss: 0.091 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.0459628105163574
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.987 Test Loss: 0.091 Test Acc: 0.987
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.9353539943695068
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.987 Test Loss: 0.092 Test Acc: 0.987
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.0357697010040283
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.987 Test Loss: 0.091 Test Acc: 0.987
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.9085452556610107
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.987 Test Loss: 0.090 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 40 cost time: 0.9374494552612305
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.987 Test Loss: 0.091 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.0282158851623535
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.987 Test Loss: 0.091 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.091386079788208
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.987 Test Loss: 0.091 Test Acc: 0.987
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.9966826438903809
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.987 Test Loss: 0.092 Test Acc: 0.987
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.1163039207458496
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.987 Test Loss: 0.092 Test Acc: 0.987
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.9238548278808594
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.987 Test Loss: 0.091 Test Acc: 0.987
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.094437837600708
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.987 Test Loss: 0.091 Test Acc: 0.987
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.0519108772277832
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.987 Test Loss: 0.091 Test Acc: 0.987
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 0.8695733547210693
Epoch: 48, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.987 Test Loss: 0.091 Test Acc: 0.987
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 0.9176657199859619
Epoch: 49, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.987 Test Loss: 0.091 Test Acc: 0.987
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps36_str18_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9866666666666667
model parameter : 555961
model size : 2.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.031959295272827
Epoch: 1, Steps: 18 | Train Loss: 3.095 Vali Loss: 2.751 Vali Acc: 0.743 Test Loss: 2.751 Test Acc: 0.743
Validation loss decreased (inf --> -0.743306).  Saving model ...
Epoch: 2 cost time: 1.0390150547027588
Epoch: 2, Steps: 18 | Train Loss: 1.666 Vali Loss: 0.945 Vali Acc: 0.940 Test Loss: 0.945 Test Acc: 0.940
Validation loss decreased (-0.743306 --> -0.939991).  Saving model ...
Epoch: 3 cost time: 1.0989651679992676
Epoch: 3, Steps: 18 | Train Loss: 0.281 Vali Loss: 0.165 Vali Acc: 0.970 Test Loss: 0.165 Test Acc: 0.970
Validation loss decreased (-0.939991 --> -0.969998).  Saving model ...
Epoch: 4 cost time: 1.0280165672302246
Epoch: 4, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.134 Vali Acc: 0.960 Test Loss: 0.134 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0453686714172363
Epoch: 5, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
Validation loss decreased (-0.969998 --> -0.976666).  Saving model ...
Epoch: 6 cost time: 1.0534486770629883
Epoch: 6, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 7 cost time: 0.8971114158630371
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 8 cost time: 1.0038783550262451
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9688513278961182
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.0317935943603516
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 1.1175706386566162
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 1.083026647567749
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 0.9602694511413574
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 1.030717372894287
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9206006526947021
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9507627487182617
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.0810205936431885
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.0280048847198486
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.0217359066009521
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.108710765838623
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.0880687236785889
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.877415657043457
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.0154690742492676
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 1007673
model size : 3.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.0474867820739746
Epoch: 1, Steps: 18 | Train Loss: 3.165 Vali Loss: 2.976 Vali Acc: 0.453 Test Loss: 2.976 Test Acc: 0.453
Validation loss decreased (inf --> -0.453304).  Saving model ...
Epoch: 2 cost time: 0.8848581314086914
Epoch: 2, Steps: 18 | Train Loss: 2.405 Vali Loss: 1.976 Vali Acc: 0.903 Test Loss: 1.976 Test Acc: 0.903
Validation loss decreased (-0.453304 --> -0.903314).  Saving model ...
Epoch: 3 cost time: 1.0038397312164307
Epoch: 3, Steps: 18 | Train Loss: 1.124 Vali Loss: 0.566 Vali Acc: 0.957 Test Loss: 0.566 Test Acc: 0.957
Validation loss decreased (-0.903314 --> -0.956661).  Saving model ...
Epoch: 4 cost time: 0.9912171363830566
Epoch: 4, Steps: 18 | Train Loss: 0.212 Vali Loss: 0.178 Vali Acc: 0.963 Test Loss: 0.178 Test Acc: 0.963
Validation loss decreased (-0.956661 --> -0.963332).  Saving model ...
Epoch: 5 cost time: 1.0980300903320312
Epoch: 5, Steps: 18 | Train Loss: 0.037 Vali Loss: 0.135 Vali Acc: 0.970 Test Loss: 0.135 Test Acc: 0.970
Validation loss decreased (-0.963332 --> -0.969999).  Saving model ...
Epoch: 6 cost time: 1.0002245903015137
Epoch: 6, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
Validation loss decreased (-0.969999 --> -0.976666).  Saving model ...
Epoch: 7 cost time: 1.117016315460205
Epoch: 7, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 8 cost time: 1.1088447570800781
Epoch: 8, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 0.9571404457092285
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 0.984813928604126
Epoch: 10, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 1.045624017715454
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 1.0760316848754883
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 1.031383991241455
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 1.0680046081542969
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 0.9617733955383301
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.083721399307251
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 0.8680918216705322
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 1.0891964435577393
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 1.073695421218872
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 1.1682722568511963
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1204099655151367
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.1375679969787598
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 1.0530891418457031
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9575529098510742
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 0.9387993812561035
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 0.9571292400360107
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0985498428344727
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 28 cost time: 0.9890556335449219
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 29 cost time: 1.0810775756835938
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 30 cost time: 1.0343883037567139
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 31 cost time: 1.0476982593536377
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.9729914665222168
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.0587472915649414
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.0488920211791992
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.8699958324432373
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.9636008739471436
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.961033821105957
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.9401280879974365
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.0507445335388184
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.9393467903137207
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.983 Test Loss: 0.090 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 748601
model size : 2.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.8873302936553955
Epoch: 1, Steps: 18 | Train Loss: 3.155 Vali Loss: 3.053 Vali Acc: 0.227 Test Loss: 3.053 Test Acc: 0.227
Validation loss decreased (inf --> -0.226636).  Saving model ...
Epoch: 2 cost time: 1.011648178100586
Epoch: 2, Steps: 18 | Train Loss: 2.662 Vali Loss: 2.406 Vali Acc: 0.890 Test Loss: 2.406 Test Acc: 0.890
Validation loss decreased (-0.226636 --> -0.889976).  Saving model ...
Epoch: 3 cost time: 0.9249172210693359
Epoch: 3, Steps: 18 | Train Loss: 1.682 Vali Loss: 1.160 Vali Acc: 0.940 Test Loss: 1.160 Test Acc: 0.940
Validation loss decreased (-0.889976 --> -0.939988).  Saving model ...
Epoch: 4 cost time: 0.8931334018707275
Epoch: 4, Steps: 18 | Train Loss: 0.570 Vali Loss: 0.317 Vali Acc: 0.963 Test Loss: 0.317 Test Acc: 0.963
Validation loss decreased (-0.939988 --> -0.963330).  Saving model ...
Epoch: 5 cost time: 0.9835991859436035
Epoch: 5, Steps: 18 | Train Loss: 0.124 Vali Loss: 0.158 Vali Acc: 0.970 Test Loss: 0.158 Test Acc: 0.970
Validation loss decreased (-0.963330 --> -0.969998).  Saving model ...
Epoch: 6 cost time: 0.9234342575073242
Epoch: 6, Steps: 18 | Train Loss: 0.035 Vali Loss: 0.124 Vali Acc: 0.973 Test Loss: 0.124 Test Acc: 0.973
Validation loss decreased (-0.969998 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 0.9683108329772949
Epoch: 7, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 8 cost time: 0.85616135597229
Epoch: 8, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.104 Vali Acc: 0.983 Test Loss: 0.104 Test Acc: 0.983
Validation loss decreased (-0.976666 --> -0.983332).  Saving model ...
Epoch: 9 cost time: 0.8999454975128174
Epoch: 9, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.101 Vali Acc: 0.983 Test Loss: 0.101 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 10 cost time: 1.0216867923736572
Epoch: 10, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.099 Vali Acc: 0.983 Test Loss: 0.099 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 11 cost time: 0.8587131500244141
Epoch: 11, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.094 Vali Acc: 0.983 Test Loss: 0.094 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 12 cost time: 0.9428677558898926
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.095 Vali Acc: 0.983 Test Loss: 0.095 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8963367938995361
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.983 Test Loss: 0.093 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 14 cost time: 0.9338815212249756
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.983 Test Loss: 0.092 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 15 cost time: 1.0594148635864258
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.983 Test Loss: 0.090 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 16 cost time: 1.0252842903137207
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 17 cost time: 0.9924957752227783
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 18 cost time: 0.9575040340423584
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 19 cost time: 0.81339430809021
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 20 cost time: 0.8517556190490723
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 21 cost time: 0.957158088684082
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 22 cost time: 0.9821441173553467
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9548594951629639
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 24 cost time: 0.9929790496826172
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 25 cost time: 1.0516254901885986
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.914689302444458
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 27 cost time: 0.8737962245941162
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 28 cost time: 0.8402628898620605
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 29 cost time: 1.026688814163208
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9492862224578857
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.9577398300170898
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 32 cost time: 0.9240427017211914
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.020552635192871
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.0025391578674316
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.8725900650024414
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.87457275390625
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.8949205875396729
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.0341639518737793
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.8969016075134277
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.8588297367095947
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.9647576808929443
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 662297
model size : 2.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.7683088779449463
Epoch: 1, Steps: 18 | Train Loss: 3.146 Vali Loss: 3.060 Vali Acc: 0.313 Test Loss: 3.060 Test Acc: 0.313
Validation loss decreased (inf --> -0.313303).  Saving model ...
Epoch: 2 cost time: 0.8754594326019287
Epoch: 2, Steps: 18 | Train Loss: 2.686 Vali Loss: 2.438 Vali Acc: 0.837 Test Loss: 2.438 Test Acc: 0.837
Validation loss decreased (-0.313303 --> -0.836642).  Saving model ...
Epoch: 3 cost time: 1.0003774166107178
Epoch: 3, Steps: 18 | Train Loss: 1.794 Vali Loss: 1.291 Vali Acc: 0.933 Test Loss: 1.291 Test Acc: 0.933
Validation loss decreased (-0.836642 --> -0.933320).  Saving model ...
Epoch: 4 cost time: 0.8006184101104736
Epoch: 4, Steps: 18 | Train Loss: 0.693 Vali Loss: 0.393 Vali Acc: 0.957 Test Loss: 0.393 Test Acc: 0.957
Validation loss decreased (-0.933320 --> -0.956663).  Saving model ...
Epoch: 5 cost time: 0.8647265434265137
Epoch: 5, Steps: 18 | Train Loss: 0.173 Vali Loss: 0.179 Vali Acc: 0.967 Test Loss: 0.179 Test Acc: 0.967
Validation loss decreased (-0.956663 --> -0.966665).  Saving model ...
Epoch: 6 cost time: 0.8851516246795654
Epoch: 6, Steps: 18 | Train Loss: 0.053 Vali Loss: 0.138 Vali Acc: 0.963 Test Loss: 0.138 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8079948425292969
Epoch: 7, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.119 Vali Acc: 0.970 Test Loss: 0.119 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969999).  Saving model ...
Epoch: 8 cost time: 0.9737114906311035
Epoch: 8, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.117 Vali Acc: 0.973 Test Loss: 0.117 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 1.057990312576294
Epoch: 9, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 0.9154782295227051
Epoch: 10, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 1.03004789352417
Epoch: 11, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.958193302154541
Epoch: 12, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9786038398742676
Epoch: 13, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.8764259815216064
Epoch: 14, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.9847490787506104
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.0268192291259766
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.9843728542327881
Epoch: 17, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 18 cost time: 1.0283713340759277
Epoch: 18, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 19 cost time: 0.9888370037078857
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 20 cost time: 0.9678812026977539
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 21 cost time: 0.9975123405456543
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 22 cost time: 0.8582968711853027
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9923632144927979
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.9452853202819824
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 25 cost time: 1.0128028392791748
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 26 cost time: 0.9109234809875488
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 27 cost time: 0.9576950073242188
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8704090118408203
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.8714017868041992
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.944596529006958
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.902735710144043
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.9834556579589844
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.8973507881164551
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.9572384357452393
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.014136791229248
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.9447360038757324
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9733333333333334
model parameter : 633625
model size : 2.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps22_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.8640401363372803
Epoch: 1, Steps: 18 | Train Loss: 3.206 Vali Loss: 3.105 Vali Acc: 0.163 Test Loss: 3.105 Test Acc: 0.163
Validation loss decreased (inf --> -0.163302).  Saving model ...
Epoch: 2 cost time: 0.9408066272735596
Epoch: 2, Steps: 18 | Train Loss: 2.817 Vali Loss: 2.614 Vali Acc: 0.793 Test Loss: 2.614 Test Acc: 0.793
Validation loss decreased (-0.163302 --> -0.793307).  Saving model ...
Epoch: 3 cost time: 0.9403297901153564
Epoch: 3, Steps: 18 | Train Loss: 2.123 Vali Loss: 1.710 Vali Acc: 0.943 Test Loss: 1.710 Test Acc: 0.943
Validation loss decreased (-0.793307 --> -0.943316).  Saving model ...
Epoch: 4 cost time: 0.9781239032745361
Epoch: 4, Steps: 18 | Train Loss: 1.126 Vali Loss: 0.685 Vali Acc: 0.947 Test Loss: 0.685 Test Acc: 0.947
Validation loss decreased (-0.943316 --> -0.946660).  Saving model ...
Epoch: 5 cost time: 1.134230136871338
Epoch: 5, Steps: 18 | Train Loss: 0.341 Vali Loss: 0.245 Vali Acc: 0.963 Test Loss: 0.245 Test Acc: 0.963
Validation loss decreased (-0.946660 --> -0.963331).  Saving model ...
Epoch: 6 cost time: 0.953662633895874
Epoch: 6, Steps: 18 | Train Loss: 0.096 Vali Loss: 0.153 Vali Acc: 0.970 Test Loss: 0.153 Test Acc: 0.970
Validation loss decreased (-0.963331 --> -0.969998).  Saving model ...
Epoch: 7 cost time: 0.9962105751037598
Epoch: 7, Steps: 18 | Train Loss: 0.040 Vali Loss: 0.123 Vali Acc: 0.977 Test Loss: 0.123 Test Acc: 0.977
Validation loss decreased (-0.969998 --> -0.976665).  Saving model ...
Epoch: 8 cost time: 1.0206272602081299
Epoch: 8, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 1.0217130184173584
Epoch: 9, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 0.8794074058532715
Epoch: 10, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9140195846557617
Epoch: 11, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.997248649597168
Epoch: 12, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.0016398429870605
Epoch: 13, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 1.0201735496520996
Epoch: 14, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 0.9639182090759277
Epoch: 15, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 0.987342119216919
Epoch: 16, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 1.0607588291168213
Epoch: 17, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 0.9171442985534668
Epoch: 18, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 0.885399580001831
Epoch: 19, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 1.0090768337249756
Epoch: 20, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1129581928253174
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 0.9588613510131836
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.927208423614502
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 1.1024208068847656
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 1.1214964389801025
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8508896827697754
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.100417137145996
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.952495813369751
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 0.9255650043487549
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.8852124214172363
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.039217233657837
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 32 cost time: 0.9027752876281738
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 33 cost time: 0.9028675556182861
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 34 cost time: 1.0383670330047607
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 35 cost time: 1.0486559867858887
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.0854110717773438
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.042670726776123
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.81693434715271
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 39 cost time: 0.8677003383636475
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 40 cost time: 0.9412508010864258
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 41 cost time: 0.9799187183380127
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.965505838394165
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.059840202331543
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.059356927871704
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 45 cost time: 0.8985080718994141
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.9875950813293457
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.048182487487793
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.0947628021240234
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 1.0659010410308838
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.9583995342254639
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps22_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 605049
model size : 2.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps29_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.8747141361236572
Epoch: 1, Steps: 18 | Train Loss: 3.190 Vali Loss: 3.123 Vali Acc: 0.113 Test Loss: 3.123 Test Acc: 0.113
Validation loss decreased (inf --> -0.113302).  Saving model ...
Epoch: 2 cost time: 0.9390182495117188
Epoch: 2, Steps: 18 | Train Loss: 2.891 Vali Loss: 2.735 Vali Acc: 0.623 Test Loss: 2.735 Test Acc: 0.623
Validation loss decreased (-0.113302 --> -0.623306).  Saving model ...
Epoch: 3 cost time: 0.8890218734741211
Epoch: 3, Steps: 18 | Train Loss: 2.316 Vali Loss: 2.053 Vali Acc: 0.873 Test Loss: 2.053 Test Acc: 0.873
Validation loss decreased (-0.623306 --> -0.873313).  Saving model ...
Epoch: 4 cost time: 0.8175208568572998
Epoch: 4, Steps: 18 | Train Loss: 1.506 Vali Loss: 1.129 Vali Acc: 0.947 Test Loss: 1.129 Test Acc: 0.947
Validation loss decreased (-0.873313 --> -0.946655).  Saving model ...
Epoch: 5 cost time: 1.014923334121704
Epoch: 5, Steps: 18 | Train Loss: 0.698 Vali Loss: 0.456 Vali Acc: 0.957 Test Loss: 0.456 Test Acc: 0.957
Validation loss decreased (-0.946655 --> -0.956662).  Saving model ...
Epoch: 6 cost time: 0.9547920227050781
Epoch: 6, Steps: 18 | Train Loss: 0.247 Vali Loss: 0.229 Vali Acc: 0.967 Test Loss: 0.229 Test Acc: 0.967
Validation loss decreased (-0.956662 --> -0.966664).  Saving model ...
Epoch: 7 cost time: 0.8946921825408936
Epoch: 7, Steps: 18 | Train Loss: 0.082 Vali Loss: 0.175 Vali Acc: 0.970 Test Loss: 0.175 Test Acc: 0.970
Validation loss decreased (-0.966664 --> -0.969998).  Saving model ...
Epoch: 8 cost time: 0.8778033256530762
Epoch: 8, Steps: 18 | Train Loss: 0.045 Vali Loss: 0.150 Vali Acc: 0.963 Test Loss: 0.150 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9827752113342285
Epoch: 9, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.133 Vali Acc: 0.967 Test Loss: 0.133 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7779254913330078
Epoch: 10, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.126 Vali Acc: 0.967 Test Loss: 0.126 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.7879045009613037
Epoch: 11, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.115 Vali Acc: 0.970 Test Loss: 0.115 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969999).  Saving model ...
Epoch: 12 cost time: 0.7900199890136719
Epoch: 12, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 13 cost time: 0.9231786727905273
Epoch: 13, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.109 Vali Acc: 0.967 Test Loss: 0.109 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8941690921783447
Epoch: 14, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.106 Vali Acc: 0.967 Test Loss: 0.106 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0148687362670898
Epoch: 15, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 16 cost time: 0.9320039749145508
Epoch: 16, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 17 cost time: 0.8554213047027588
Epoch: 17, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 18 cost time: 0.8838222026824951
Epoch: 18, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 19 cost time: 0.9878480434417725
Epoch: 19, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9358987808227539
Epoch: 20, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 21 cost time: 1.0449621677398682
Epoch: 21, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9742791652679443
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 23 cost time: 0.9492318630218506
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 24 cost time: 0.926513671875
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.970 Test Loss: 0.095 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 25 cost time: 0.833949089050293
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 26 cost time: 0.9757757186889648
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 27 cost time: 0.9580378532409668
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0230426788330078
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.935523509979248
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.9882974624633789
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 31 cost time: 0.9384689331054688
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 32 cost time: 0.9691605567932129
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 33 cost time: 0.9265358448028564
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.970 Test Loss: 0.091 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.0492677688598633
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.0140430927276611
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.1009643077850342
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.970 Test Loss: 0.091 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.0253446102142334
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.9251558780670166
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.8672678470611572
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.9634015560150146
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 41 cost time: 1.024181842803955
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.970 Test Loss: 0.090 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.9517226219177246
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.970 Test Loss: 0.091 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.0575859546661377
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.019299030303955
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 45 cost time: 0.951552152633667
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.0412077903747559
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.9612293243408203
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.0841233730316162
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 1.0297138690948486
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 1.0631771087646484
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps29_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 576473
model size : 2.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps36_str18_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.9574027061462402
Epoch: 1, Steps: 18 | Train Loss: 3.231 Vali Loss: 3.175 Vali Acc: 0.043 Test Loss: 3.175 Test Acc: 0.043
Validation loss decreased (inf --> -0.043302).  Saving model ...
Epoch: 2 cost time: 1.0066215991973877
Epoch: 2, Steps: 18 | Train Loss: 3.014 Vali Loss: 2.929 Vali Acc: 0.440 Test Loss: 2.929 Test Acc: 0.440
Validation loss decreased (-0.043302 --> -0.439971).  Saving model ...
Epoch: 3 cost time: 0.7712702751159668
Epoch: 3, Steps: 18 | Train Loss: 2.644 Vali Loss: 2.503 Vali Acc: 0.817 Test Loss: 2.503 Test Acc: 0.817
Validation loss decreased (-0.439971 --> -0.816642).  Saving model ...
Epoch: 4 cost time: 0.8512437343597412
Epoch: 4, Steps: 18 | Train Loss: 2.108 Vali Loss: 1.839 Vali Acc: 0.923 Test Loss: 1.839 Test Acc: 0.923
Validation loss decreased (-0.816642 --> -0.923315).  Saving model ...
Epoch: 5 cost time: 0.9590413570404053
Epoch: 5, Steps: 18 | Train Loss: 1.358 Vali Loss: 1.026 Vali Acc: 0.947 Test Loss: 1.026 Test Acc: 0.947
Validation loss decreased (-0.923315 --> -0.946656).  Saving model ...
Epoch: 6 cost time: 0.8820075988769531
Epoch: 6, Steps: 18 | Train Loss: 0.618 Vali Loss: 0.468 Vali Acc: 0.967 Test Loss: 0.468 Test Acc: 0.967
Validation loss decreased (-0.946656 --> -0.966662).  Saving model ...
Epoch: 7 cost time: 1.0150117874145508
Epoch: 7, Steps: 18 | Train Loss: 0.260 Vali Loss: 0.270 Vali Acc: 0.970 Test Loss: 0.270 Test Acc: 0.970
Validation loss decreased (-0.966662 --> -0.969997).  Saving model ...
Epoch: 8 cost time: 1.074817419052124
Epoch: 8, Steps: 18 | Train Loss: 0.112 Vali Loss: 0.208 Vali Acc: 0.973 Test Loss: 0.208 Test Acc: 0.973
Validation loss decreased (-0.969997 --> -0.973331).  Saving model ...
Epoch: 9 cost time: 0.9781014919281006
Epoch: 9, Steps: 18 | Train Loss: 0.074 Vali Loss: 0.171 Vali Acc: 0.977 Test Loss: 0.171 Test Acc: 0.977
Validation loss decreased (-0.973331 --> -0.976665).  Saving model ...
Epoch: 10 cost time: 0.8339400291442871
Epoch: 10, Steps: 18 | Train Loss: 0.044 Vali Loss: 0.157 Vali Acc: 0.977 Test Loss: 0.157 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 11 cost time: 0.8932774066925049
Epoch: 11, Steps: 18 | Train Loss: 0.032 Vali Loss: 0.145 Vali Acc: 0.980 Test Loss: 0.145 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 0.8344871997833252
Epoch: 12, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.132 Vali Acc: 0.983 Test Loss: 0.132 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 13 cost time: 0.9123992919921875
Epoch: 13, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.126 Vali Acc: 0.980 Test Loss: 0.126 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9162306785583496
Epoch: 14, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.120 Vali Acc: 0.983 Test Loss: 0.120 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 15 cost time: 0.7938659191131592
Epoch: 15, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.118 Vali Acc: 0.983 Test Loss: 0.118 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 16 cost time: 0.7683207988739014
Epoch: 16, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.112 Vali Acc: 0.983 Test Loss: 0.112 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 17 cost time: 0.8914308547973633
Epoch: 17, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.110 Vali Acc: 0.983 Test Loss: 0.110 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 18 cost time: 0.9915261268615723
Epoch: 18, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.107 Vali Acc: 0.983 Test Loss: 0.107 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 19 cost time: 1.0321545600891113
Epoch: 19, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.107 Vali Acc: 0.983 Test Loss: 0.107 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9510359764099121
Epoch: 20, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.105 Vali Acc: 0.983 Test Loss: 0.105 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 21 cost time: 0.9653661251068115
Epoch: 21, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.104 Vali Acc: 0.983 Test Loss: 0.104 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 22 cost time: 0.9170253276824951
Epoch: 22, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.103 Vali Acc: 0.983 Test Loss: 0.103 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 23 cost time: 0.8729434013366699
Epoch: 23, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.102 Vali Acc: 0.983 Test Loss: 0.102 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 24 cost time: 0.9703235626220703
Epoch: 24, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.101 Vali Acc: 0.983 Test Loss: 0.101 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 25 cost time: 0.9655630588531494
Epoch: 25, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.100 Vali Acc: 0.983 Test Loss: 0.100 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 26 cost time: 0.9710655212402344
Epoch: 26, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.100 Vali Acc: 0.983 Test Loss: 0.100 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 27 cost time: 1.0466923713684082
Epoch: 27, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.100 Vali Acc: 0.983 Test Loss: 0.100 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 28 cost time: 0.8991241455078125
Epoch: 28, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.099 Vali Acc: 0.983 Test Loss: 0.099 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 29 cost time: 0.9038448333740234
Epoch: 29, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.098 Vali Acc: 0.983 Test Loss: 0.098 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 30 cost time: 0.8656797409057617
Epoch: 30, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.097 Vali Acc: 0.983 Test Loss: 0.097 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 31 cost time: 0.9966998100280762
Epoch: 31, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.097 Vali Acc: 0.983 Test Loss: 0.097 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.9283251762390137
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.983 Test Loss: 0.097 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 33 cost time: 0.9915595054626465
Epoch: 33, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.097 Vali Acc: 0.983 Test Loss: 0.097 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 34 cost time: 0.897770881652832
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.983 Test Loss: 0.096 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 35 cost time: 1.0138204097747803
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.983 Test Loss: 0.096 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 36 cost time: 0.9499530792236328
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.983 Test Loss: 0.096 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 37 cost time: 0.9675416946411133
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.983 Test Loss: 0.096 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.9728131294250488
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.983 Test Loss: 0.096 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 39 cost time: 0.8944008350372314
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.983 Test Loss: 0.096 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.9326932430267334
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.983 Test Loss: 0.096 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.9140980243682861
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.983 Test Loss: 0.096 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 42 cost time: 0.9105207920074463
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.983 Test Loss: 0.096 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.9313781261444092
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.983 Test Loss: 0.096 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 44 cost time: 0.9148383140563965
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.983 Test Loss: 0.096 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.0949630737304688
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.983 Test Loss: 0.096 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.8644485473632812
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.983 Test Loss: 0.096 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.9291741847991943
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.983 Test Loss: 0.096 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.9756906032562256
Epoch: 48, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.983 Test Loss: 0.096 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.1117932796478271
Epoch: 49, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.983 Test Loss: 0.097 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 1.1037824153900146
Epoch: 50, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.983 Test Loss: 0.097 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps36_str18_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 547897
model size : 2.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.3026323318481445
Epoch: 1, Steps: 18 | Train Loss: 2.414 Vali Loss: 0.856 Vali Acc: 0.947 Test Loss: 0.856 Test Acc: 0.947
Validation loss decreased (inf --> -0.946658).  Saving model ...
Epoch: 2 cost time: 1.2264156341552734
Epoch: 2, Steps: 18 | Train Loss: 0.145 Vali Loss: 0.196 Vali Acc: 0.940 Test Loss: 0.196 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1791329383850098
Epoch: 3, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.167 Vali Acc: 0.953 Test Loss: 0.167 Test Acc: 0.953
Validation loss decreased (-0.946658 --> -0.953332).  Saving model ...
Epoch: 4 cost time: 1.1766033172607422
Epoch: 4, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.157 Vali Acc: 0.963 Test Loss: 0.157 Test Acc: 0.963
Validation loss decreased (-0.953332 --> -0.963332).  Saving model ...
Epoch: 5 cost time: 1.3947179317474365
Epoch: 5, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.290 Vali Acc: 0.933 Test Loss: 0.290 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2835776805877686
Epoch: 6, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.172 Vali Acc: 0.963 Test Loss: 0.172 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.044731616973877
Epoch: 7, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.967 Test Loss: 0.177 Test Acc: 0.967
Validation loss decreased (-0.963332 --> -0.966665).  Saving model ...
Epoch: 8 cost time: 1.0555830001831055
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.171 Vali Acc: 0.967 Test Loss: 0.171 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 9 cost time: 0.9961836338043213
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.166 Vali Acc: 0.970 Test Loss: 0.166 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969998).  Saving model ...
Epoch: 10 cost time: 0.9660239219665527
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.163 Vali Acc: 0.970 Test Loss: 0.163 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 11 cost time: 1.0513954162597656
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.160 Vali Acc: 0.970 Test Loss: 0.160 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 12 cost time: 1.239682912826538
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.157 Vali Acc: 0.970 Test Loss: 0.157 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 13 cost time: 1.3987581729888916
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.155 Vali Acc: 0.970 Test Loss: 0.155 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 14 cost time: 1.3693435192108154
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.154 Vali Acc: 0.970 Test Loss: 0.154 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 15 cost time: 1.096656084060669
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.152 Vali Acc: 0.970 Test Loss: 0.152 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 16 cost time: 1.138805866241455
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.151 Vali Acc: 0.970 Test Loss: 0.151 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 17 cost time: 1.360598087310791
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.150 Vali Acc: 0.970 Test Loss: 0.150 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969999).  Saving model ...
Epoch: 18 cost time: 1.2625436782836914
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.148 Vali Acc: 0.970 Test Loss: 0.148 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 19 cost time: 1.3001806735992432
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.148 Vali Acc: 0.970 Test Loss: 0.148 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 20 cost time: 1.340785264968872
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.147 Vali Acc: 0.970 Test Loss: 0.147 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 21 cost time: 1.1377906799316406
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.146 Vali Acc: 0.970 Test Loss: 0.146 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 22 cost time: 1.3325483798980713
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.145 Vali Acc: 0.970 Test Loss: 0.145 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 23 cost time: 1.3669884204864502
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.144 Vali Acc: 0.970 Test Loss: 0.144 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 24 cost time: 1.3359363079071045
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.143 Vali Acc: 0.970 Test Loss: 0.143 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 25 cost time: 1.361870527267456
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.142 Vali Acc: 0.970 Test Loss: 0.142 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 26 cost time: 1.2062819004058838
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.142 Vali Acc: 0.970 Test Loss: 0.142 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 27 cost time: 1.1573691368103027
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.142 Vali Acc: 0.970 Test Loss: 0.142 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 28 cost time: 1.1823205947875977
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.141 Vali Acc: 0.970 Test Loss: 0.141 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 29 cost time: 1.3847954273223877
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.141 Vali Acc: 0.970 Test Loss: 0.141 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 30 cost time: 1.3696057796478271
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.140 Vali Acc: 0.970 Test Loss: 0.140 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 31 cost time: 1.2716612815856934
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.140 Vali Acc: 0.970 Test Loss: 0.140 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 32 cost time: 1.1281342506408691
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.139 Vali Acc: 0.970 Test Loss: 0.139 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 33 cost time: 1.3357183933258057
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.139 Vali Acc: 0.970 Test Loss: 0.139 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 34 cost time: 1.2314629554748535
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.139 Vali Acc: 0.970 Test Loss: 0.139 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 35 cost time: 1.2669095993041992
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.138 Vali Acc: 0.970 Test Loss: 0.138 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 36 cost time: 1.3691599369049072
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.138 Vali Acc: 0.970 Test Loss: 0.138 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 37 cost time: 1.2159423828125
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.138 Vali Acc: 0.970 Test Loss: 0.138 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 38 cost time: 1.158238410949707
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.137 Vali Acc: 0.970 Test Loss: 0.137 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 39 cost time: 1.3417043685913086
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.136 Vali Acc: 0.970 Test Loss: 0.136 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 40 cost time: 1.3114490509033203
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.135 Vali Acc: 0.970 Test Loss: 0.135 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 41 cost time: 1.3984816074371338
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.135 Vali Acc: 0.970 Test Loss: 0.135 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 42 cost time: 1.293835163116455
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.135 Vali Acc: 0.970 Test Loss: 0.135 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.1260159015655518
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.135 Vali Acc: 0.970 Test Loss: 0.135 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 44 cost time: 1.269529104232788
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.135 Vali Acc: 0.970 Test Loss: 0.135 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 45 cost time: 1.357088565826416
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.135 Vali Acc: 0.970 Test Loss: 0.135 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.400958776473999
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.135 Vali Acc: 0.970 Test Loss: 0.135 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 47 cost time: 1.3703854084014893
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.135 Vali Acc: 0.970 Test Loss: 0.135 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.1029393672943115
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.135 Vali Acc: 0.970 Test Loss: 0.135 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 49 cost time: 1.13685941696167
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.134 Vali Acc: 0.970 Test Loss: 0.134 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 50 cost time: 1.3251161575317383
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.134 Vali Acc: 0.970 Test Loss: 0.134 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.97
model parameter : 3767961
model size : 14.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.9406518936157227
Epoch: 1, Steps: 18 | Train Loss: 2.754 Vali Loss: 1.821 Vali Acc: 0.930 Test Loss: 1.821 Test Acc: 0.930
Validation loss decreased (inf --> -0.929982).  Saving model ...
Epoch: 2 cost time: 0.9958000183105469
Epoch: 2, Steps: 18 | Train Loss: 0.509 Vali Loss: 0.214 Vali Acc: 0.953 Test Loss: 0.214 Test Acc: 0.953
Validation loss decreased (-0.929982 --> -0.953331).  Saving model ...
Epoch: 3 cost time: 1.07252836227417
Epoch: 3, Steps: 18 | Train Loss: 0.034 Vali Loss: 0.163 Vali Acc: 0.957 Test Loss: 0.163 Test Acc: 0.957
Validation loss decreased (-0.953331 --> -0.956665).  Saving model ...
Epoch: 4 cost time: 1.071735143661499
Epoch: 4, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.122 Vali Acc: 0.970 Test Loss: 0.122 Test Acc: 0.970
Validation loss decreased (-0.956665 --> -0.969999).  Saving model ...
Epoch: 5 cost time: 0.9425103664398193
Epoch: 5, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.110 Vali Acc: 0.970 Test Loss: 0.110 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 6 cost time: 1.0508956909179688
Epoch: 6, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 1.2409467697143555
Epoch: 7, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 1.2790138721466064
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 1.184830665588379
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 1.2569220066070557
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 1.0939936637878418
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 12 cost time: 1.0542519092559814
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 13 cost time: 1.141162633895874
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 14 cost time: 1.262697458267212
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 15 cost time: 1.2010419368743896
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 16 cost time: 1.2237496376037598
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 17 cost time: 1.0841021537780762
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 18 cost time: 1.2879118919372559
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 19 cost time: 1.1581733226776123
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1237850189208984
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.2396526336669922
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.2166261672973633
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.0673558712005615
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.1821303367614746
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.1097781658172607
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.3268520832061768
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.2569639682769775
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.1651983261108398
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 1.1620862483978271
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.1838104724884033
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.1624126434326172
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.1629838943481445
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 33 cost time: 1.2186179161071777
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 34 cost time: 1.2417852878570557
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 35 cost time: 1.0268476009368896
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 36 cost time: 1.2949018478393555
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.2333030700683594
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.2636473178863525
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.1948497295379639
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.2472386360168457
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.075634241104126
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.3016386032104492
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.1402380466461182
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.1394877433776855
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 1.2534971237182617
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 2731673
model size : 10.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.972332239151001
Epoch: 1, Steps: 18 | Train Loss: 2.913 Vali Loss: 2.275 Vali Acc: 0.923 Test Loss: 2.275 Test Acc: 0.923
Validation loss decreased (inf --> -0.923311).  Saving model ...
Epoch: 2 cost time: 1.0804295539855957
Epoch: 2, Steps: 18 | Train Loss: 0.941 Vali Loss: 0.340 Vali Acc: 0.957 Test Loss: 0.340 Test Acc: 0.957
Validation loss decreased (-0.923311 --> -0.956663).  Saving model ...
Epoch: 3 cost time: 1.2161188125610352
Epoch: 3, Steps: 18 | Train Loss: 0.074 Vali Loss: 0.215 Vali Acc: 0.917 Test Loss: 0.215 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9353799819946289
Epoch: 4, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
Validation loss decreased (-0.956663 --> -0.979999).  Saving model ...
Epoch: 5 cost time: 0.9522249698638916
Epoch: 5, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.102 Vali Acc: 0.983 Test Loss: 0.102 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 6 cost time: 1.0647552013397217
Epoch: 6, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.103 Vali Acc: 0.983 Test Loss: 0.103 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9511122703552246
Epoch: 7, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1257247924804688
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.983 Test Loss: 0.102 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 9 cost time: 0.9680764675140381
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.983 Test Loss: 0.102 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 10 cost time: 1.0500032901763916
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.983 Test Loss: 0.101 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 11 cost time: 1.0699903964996338
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.983 Test Loss: 0.101 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 12 cost time: 1.1860041618347168
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.983 Test Loss: 0.100 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 13 cost time: 1.0533266067504883
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.983 Test Loss: 0.101 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1189792156219482
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.983 Test Loss: 0.100 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 15 cost time: 0.9112484455108643
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.983 Test Loss: 0.100 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1054677963256836
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.983 Test Loss: 0.100 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0080225467681885
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.983 Test Loss: 0.100 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.9811680316925049
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.983 Test Loss: 0.100 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.9237310886383057
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.983 Test Loss: 0.100 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.9869561195373535
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.983 Test Loss: 0.100 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 21 cost time: 1.0417695045471191
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.983 Test Loss: 0.100 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 22 cost time: 1.0854103565216064
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.983 Test Loss: 0.099 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 23 cost time: 1.1002554893493652
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.983 Test Loss: 0.099 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.1384124755859375
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.983 Test Loss: 0.100 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.0776326656341553
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.983 Test Loss: 0.099 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.9889824390411377
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.983 Test Loss: 0.100 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.9614732265472412
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.983 Test Loss: 0.100 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.114039659500122
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.983 Test Loss: 0.100 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.0684726238250732
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.983 Test Loss: 0.100 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.1216611862182617
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.983 Test Loss: 0.100 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.104870080947876
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.983 Test Loss: 0.101 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.0568864345550537
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.983 Test Loss: 0.100 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 2386457
model size : 9.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.035764217376709
Epoch: 1, Steps: 18 | Train Loss: 2.940 Vali Loss: 2.481 Vali Acc: 0.847 Test Loss: 2.481 Test Acc: 0.847
Validation loss decreased (inf --> -0.846642).  Saving model ...
Epoch: 2 cost time: 1.0395824909210205
Epoch: 2, Steps: 18 | Train Loss: 1.228 Vali Loss: 0.556 Vali Acc: 0.957 Test Loss: 0.556 Test Acc: 0.957
Validation loss decreased (-0.846642 --> -0.956661).  Saving model ...
Epoch: 3 cost time: 1.1404705047607422
Epoch: 3, Steps: 18 | Train Loss: 0.132 Vali Loss: 0.137 Vali Acc: 0.970 Test Loss: 0.137 Test Acc: 0.970
Validation loss decreased (-0.956661 --> -0.969999).  Saving model ...
Epoch: 4 cost time: 1.0741493701934814
Epoch: 4, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.114 Vali Acc: 0.970 Test Loss: 0.114 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 5 cost time: 1.081352710723877
Epoch: 5, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 6 cost time: 1.0505826473236084
Epoch: 6, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.969999 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 1.093973159790039
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0044195652008057
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.063633680343628
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.0363664627075195
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.9598450660705566
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.0185797214508057
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.9395434856414795
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.9935011863708496
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.0589821338653564
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.0173976421356201
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 2214169
model size : 8.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps22_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.8364319801330566
Epoch: 1, Steps: 18 | Train Loss: 2.973 Vali Loss: 2.540 Vali Acc: 0.803 Test Loss: 2.540 Test Acc: 0.803
Validation loss decreased (inf --> -0.803308).  Saving model ...
Epoch: 2 cost time: 1.0577526092529297
Epoch: 2, Steps: 18 | Train Loss: 1.456 Vali Loss: 0.744 Vali Acc: 0.957 Test Loss: 0.744 Test Acc: 0.957
Validation loss decreased (-0.803308 --> -0.956659).  Saving model ...
Epoch: 3 cost time: 0.941054105758667
Epoch: 3, Steps: 18 | Train Loss: 0.207 Vali Loss: 0.145 Vali Acc: 0.970 Test Loss: 0.145 Test Acc: 0.970
Validation loss decreased (-0.956659 --> -0.969999).  Saving model ...
Epoch: 4 cost time: 0.9202935695648193
Epoch: 4, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.969999 --> -0.979999).  Saving model ...
Epoch: 5 cost time: 0.9233567714691162
Epoch: 5, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9931182861328125
Epoch: 6, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 0.9831819534301758
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 1.0807342529296875
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0130810737609863
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9452192783355713
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9369297027587891
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.933586835861206
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.9270787239074707
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.0231499671936035
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.9710869789123535
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.0872282981872559
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.9992518424987793
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 0.7964298725128174
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 0.9467012882232666
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 0.9795441627502441
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 0.9027483463287354
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 1.047905683517456
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9798979759216309
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.9714019298553467
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.9617161750793457
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.031076192855835
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.933333158493042
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.0154268741607666
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.8913936614990234
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.924842357635498
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.9713089466094971
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps22_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 2099865
model size : 8.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps29_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.8613576889038086
Epoch: 1, Steps: 18 | Train Loss: 3.028 Vali Loss: 2.705 Vali Acc: 0.757 Test Loss: 2.705 Test Acc: 0.757
Validation loss decreased (inf --> -0.756640).  Saving model ...
Epoch: 2 cost time: 0.9795596599578857
Epoch: 2, Steps: 18 | Train Loss: 1.823 Vali Loss: 1.175 Vali Acc: 0.940 Test Loss: 1.175 Test Acc: 0.940
Validation loss decreased (-0.756640 --> -0.939988).  Saving model ...
Epoch: 3 cost time: 1.0244677066802979
Epoch: 3, Steps: 18 | Train Loss: 0.439 Vali Loss: 0.235 Vali Acc: 0.967 Test Loss: 0.235 Test Acc: 0.967
Validation loss decreased (-0.939988 --> -0.966664).  Saving model ...
Epoch: 4 cost time: 1.0294549465179443
Epoch: 4, Steps: 18 | Train Loss: 0.063 Vali Loss: 0.130 Vali Acc: 0.960 Test Loss: 0.130 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9912114143371582
Epoch: 5, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
Validation loss decreased (-0.966664 --> -0.976666).  Saving model ...
Epoch: 6 cost time: 0.9365122318267822
Epoch: 6, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 7 cost time: 0.9003682136535645
Epoch: 7, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 0.9291012287139893
Epoch: 8, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 1.0139081478118896
Epoch: 9, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9910213947296143
Epoch: 10, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9187235832214355
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 0.9934849739074707
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 0.8909409046173096
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 1.0425426959991455
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 0.9207720756530762
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 0.9940216541290283
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 0.9518857002258301
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 0.930849552154541
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 0.8627607822418213
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9945266246795654
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 1.0142085552215576
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 0.9852199554443359
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.016308307647705
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.938868522644043
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 0.9093225002288818
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9812526702880859
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.9793334007263184
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.9492690563201904
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.0013251304626465
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.060333013534546
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.8425323963165283
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.9697995185852051
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.0456562042236328
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.0477662086486816
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps29_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 1985561
model size : 7.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps36_str18_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.0283238887786865
Epoch: 1, Steps: 18 | Train Loss: 3.082 Vali Loss: 2.785 Vali Acc: 0.623 Test Loss: 2.785 Test Acc: 0.623
Validation loss decreased (inf --> -0.623305).  Saving model ...
Epoch: 2 cost time: 1.10060453414917
Epoch: 2, Steps: 18 | Train Loss: 2.062 Vali Loss: 1.472 Vali Acc: 0.913 Test Loss: 1.472 Test Acc: 0.913
Validation loss decreased (-0.623305 --> -0.913319).  Saving model ...
Epoch: 3 cost time: 0.9783124923706055
Epoch: 3, Steps: 18 | Train Loss: 0.687 Vali Loss: 0.341 Vali Acc: 0.963 Test Loss: 0.341 Test Acc: 0.963
Validation loss decreased (-0.913319 --> -0.963330).  Saving model ...
Epoch: 4 cost time: 1.0203871726989746
Epoch: 4, Steps: 18 | Train Loss: 0.108 Vali Loss: 0.157 Vali Acc: 0.953 Test Loss: 0.157 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.084214448928833
Epoch: 5, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
Validation loss decreased (-0.963330 --> -0.969999).  Saving model ...
Epoch: 6 cost time: 0.9813868999481201
Epoch: 6, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 7 cost time: 1.04191255569458
Epoch: 7, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 8 cost time: 0.9781861305236816
Epoch: 8, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 9 cost time: 0.9397757053375244
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 1.0157318115234375
Epoch: 10, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1045074462890625
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0435891151428223
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 13 cost time: 1.0564417839050293
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 14 cost time: 1.113260269165039
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 15 cost time: 0.9938812255859375
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 16 cost time: 1.0036499500274658
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 17 cost time: 1.1291627883911133
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 18 cost time: 1.067042350769043
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 19 cost time: 1.0604686737060547
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 20 cost time: 1.078749179840088
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 21 cost time: 1.0163283348083496
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 1.0180160999298096
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.00052809715271
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.069774866104126
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.055469274520874
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.0798020362854004
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.9880247116088867
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.0048224925994873
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.9887235164642334
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 30 cost time: 1.0459342002868652
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 31 cost time: 1.008127212524414
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.0054025650024414
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 33 cost time: 0.9475297927856445
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.041062831878662
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.1059420108795166
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.079918622970581
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.0426902770996094
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.9721713066101074
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.967015266418457
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.0822863578796387
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.122192144393921
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.052098035812378
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps36_str18_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 1928857
model size : 7.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.7291910648345947
Epoch: 1, Steps: 18 | Train Loss: 2.765 Vali Loss: 1.845 Vali Acc: 0.870 Test Loss: 1.845 Test Acc: 0.870
Validation loss decreased (inf --> -0.869982).  Saving model ...
Epoch: 2 cost time: 0.8056149482727051
Epoch: 2, Steps: 18 | Train Loss: 0.585 Vali Loss: 0.237 Vali Acc: 0.953 Test Loss: 0.237 Test Acc: 0.953
Validation loss decreased (-0.869982 --> -0.953331).  Saving model ...
Epoch: 3 cost time: 0.7521333694458008
Epoch: 3, Steps: 18 | Train Loss: 0.037 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
Validation loss decreased (-0.953331 --> -0.976666).  Saving model ...
Epoch: 4 cost time: 0.7817642688751221
Epoch: 4, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.102 Vali Acc: 0.967 Test Loss: 0.102 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8106124401092529
Epoch: 5, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9209718704223633
Epoch: 6, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.8223812580108643
Epoch: 7, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.8151159286499023
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.8341946601867676
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.730435848236084
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.8008582592010498
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.970 Test Loss: 0.091 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.8520300388336182
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.970 Test Loss: 0.091 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.7648043632507324
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.970 Test Loss: 0.091 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 1498969
model size : 5.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.5890038013458252
Epoch: 1, Steps: 18 | Train Loss: 2.976 Vali Loss: 2.485 Vali Acc: 0.807 Test Loss: 2.485 Test Acc: 0.807
Validation loss decreased (inf --> -0.806642).  Saving model ...
Epoch: 2 cost time: 0.7672479152679443
Epoch: 2, Steps: 18 | Train Loss: 1.334 Vali Loss: 0.661 Vali Acc: 0.937 Test Loss: 0.661 Test Acc: 0.937
Validation loss decreased (-0.806642 --> -0.936660).  Saving model ...
Epoch: 3 cost time: 0.8348143100738525
Epoch: 3, Steps: 18 | Train Loss: 0.164 Vali Loss: 0.147 Vali Acc: 0.970 Test Loss: 0.147 Test Acc: 0.970
Validation loss decreased (-0.936660 --> -0.969999).  Saving model ...
Epoch: 4 cost time: 0.8347318172454834
Epoch: 4, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
Validation loss decreased (-0.969999 --> -0.979999).  Saving model ...
Epoch: 5 cost time: 0.7340505123138428
Epoch: 5, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.093 Vali Acc: 0.983 Test Loss: 0.093 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 6 cost time: 0.7839858531951904
Epoch: 6, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8247735500335693
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8267195224761963
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.875901460647583
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.7717278003692627
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.7707498073577881
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.7949934005737305
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.8279054164886475
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.8105487823486328
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.8131558895111084
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 980825
model size : 3.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.6450157165527344
Epoch: 1, Steps: 18 | Train Loss: 3.081 Vali Loss: 2.718 Vali Acc: 0.733 Test Loss: 2.718 Test Acc: 0.733
Validation loss decreased (inf --> -0.733306).  Saving model ...
Epoch: 2 cost time: 0.8248064517974854
Epoch: 2, Steps: 18 | Train Loss: 1.816 Vali Loss: 1.186 Vali Acc: 0.930 Test Loss: 1.186 Test Acc: 0.930
Validation loss decreased (-0.733306 --> -0.929988).  Saving model ...
Epoch: 3 cost time: 0.7785854339599609
Epoch: 3, Steps: 18 | Train Loss: 0.437 Vali Loss: 0.240 Vali Acc: 0.973 Test Loss: 0.240 Test Acc: 0.973
Validation loss decreased (-0.929988 --> -0.973331).  Saving model ...
Epoch: 4 cost time: 0.7538881301879883
Epoch: 4, Steps: 18 | Train Loss: 0.050 Vali Loss: 0.139 Vali Acc: 0.967 Test Loss: 0.139 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7401249408721924
Epoch: 5, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
Validation loss decreased (-0.973331 --> -0.976666).  Saving model ...
Epoch: 6 cost time: 0.7522249221801758
Epoch: 6, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 7 cost time: 0.8267672061920166
Epoch: 7, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 8 cost time: 0.7849476337432861
Epoch: 8, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 0.6741561889648438
Epoch: 9, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 0.8780248165130615
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8130135536193848
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 0.7140970230102539
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 0.6941969394683838
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 0.7846040725708008
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7434031963348389
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.79549241065979
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 0.8026323318481445
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 0.7957448959350586
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 0.7011880874633789
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 0.8171670436859131
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 0.7762424945831299
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7494237422943115
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.8023643493652344
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 0.7632372379302979
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7693846225738525
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.7451918125152588
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.735013484954834
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.9041743278503418
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.8068809509277344
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.7721490859985352
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.8250133991241455
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.7250208854675293
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.7645900249481201
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 808217
model size : 3.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.7799859046936035
Epoch: 1, Steps: 18 | Train Loss: 3.111 Vali Loss: 2.873 Vali Acc: 0.553 Test Loss: 2.873 Test Acc: 0.553
Validation loss decreased (inf --> -0.553305).  Saving model ...
Epoch: 2 cost time: 0.8068912029266357
Epoch: 2, Steps: 18 | Train Loss: 2.175 Vali Loss: 1.641 Vali Acc: 0.933 Test Loss: 1.641 Test Acc: 0.933
Validation loss decreased (-0.553305 --> -0.933317).  Saving model ...
Epoch: 3 cost time: 0.794295072555542
Epoch: 3, Steps: 18 | Train Loss: 0.773 Vali Loss: 0.417 Vali Acc: 0.970 Test Loss: 0.417 Test Acc: 0.970
Validation loss decreased (-0.933317 --> -0.969996).  Saving model ...
Epoch: 4 cost time: 0.8274674415588379
Epoch: 4, Steps: 18 | Train Loss: 0.119 Vali Loss: 0.155 Vali Acc: 0.967 Test Loss: 0.155 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.757704496383667
Epoch: 5, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
Validation loss decreased (-0.969996 --> -0.973332).  Saving model ...
Epoch: 6 cost time: 0.8359770774841309
Epoch: 6, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
Validation loss decreased (-0.973332 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 0.7850770950317383
Epoch: 7, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7683782577514648
Epoch: 8, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.710200309753418
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.7582030296325684
Epoch: 10, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.7970249652862549
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 0.8912978172302246
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 0.8217949867248535
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 0.7484281063079834
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 0.7268218994140625
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 0.7817089557647705
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 0.8785994052886963
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7773826122283936
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7243890762329102
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.7691597938537598
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.7512638568878174
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.7980015277862549
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 0.7419841289520264
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 0.6200881004333496
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6474590301513672
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.8445322513580322
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.6762385368347168
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.8572711944580078
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.783658504486084
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.7249279022216797
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.8628597259521484
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.7772164344787598
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.7134807109832764
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 722073
model size : 2.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps22_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.581721544265747
Epoch: 1, Steps: 18 | Train Loss: 3.135 Vali Loss: 2.925 Vali Acc: 0.487 Test Loss: 2.925 Test Acc: 0.487
Validation loss decreased (inf --> -0.486637).  Saving model ...
Epoch: 2 cost time: 0.7662262916564941
Epoch: 2, Steps: 18 | Train Loss: 2.354 Vali Loss: 1.875 Vali Acc: 0.920 Test Loss: 1.875 Test Acc: 0.920
Validation loss decreased (-0.486637 --> -0.919981).  Saving model ...
Epoch: 3 cost time: 0.7103853225708008
Epoch: 3, Steps: 18 | Train Loss: 1.066 Vali Loss: 0.611 Vali Acc: 0.963 Test Loss: 0.611 Test Acc: 0.963
Validation loss decreased (-0.919981 --> -0.963327).  Saving model ...
Epoch: 4 cost time: 0.7374422550201416
Epoch: 4, Steps: 18 | Train Loss: 0.267 Vali Loss: 0.200 Vali Acc: 0.960 Test Loss: 0.200 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.858222246170044
Epoch: 5, Steps: 18 | Train Loss: 0.052 Vali Loss: 0.134 Vali Acc: 0.977 Test Loss: 0.134 Test Acc: 0.977
Validation loss decreased (-0.963327 --> -0.976665).  Saving model ...
Epoch: 6 cost time: 0.8075442314147949
Epoch: 6, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.117 Vali Acc: 0.973 Test Loss: 0.117 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8422074317932129
Epoch: 7, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 0.7682716846466064
Epoch: 8, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6971845626831055
Epoch: 9, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 0.7213523387908936
Epoch: 10, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 0.7784087657928467
Epoch: 11, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 0.8035595417022705
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 0.7604978084564209
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 0.721505880355835
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 0.7508673667907715
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 0.8480808734893799
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 0.8234190940856934
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 0.7619056701660156
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 0.7312717437744141
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 0.7593579292297363
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 0.7230942249298096
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7850842475891113
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.7144174575805664
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.8811354637145996
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.8167054653167725
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.779364824295044
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.7742397785186768
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 0.7908291816711426
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 0.7350344657897949
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 0.8337581157684326
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8464703559875488
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.8070175647735596
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.8344600200653076
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.7535595893859863
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 35 cost time: 0.9015665054321289
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 36 cost time: 0.8440473079681396
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 37 cost time: 0.8195152282714844
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.8484349250793457
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.7661335468292236
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.7762253284454346
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.722503662109375
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.9196920394897461
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.8059501647949219
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.7986431121826172
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.9020528793334961
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 0.810964822769165
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps22_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 664921
model size : 2.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps29_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.611785888671875
Epoch: 1, Steps: 18 | Train Loss: 3.149 Vali Loss: 2.977 Vali Acc: 0.377 Test Loss: 2.977 Test Acc: 0.377
Validation loss decreased (inf --> -0.376637).  Saving model ...
Epoch: 2 cost time: 0.7380046844482422
Epoch: 2, Steps: 18 | Train Loss: 2.532 Vali Loss: 2.198 Vali Acc: 0.893 Test Loss: 2.198 Test Acc: 0.893
Validation loss decreased (-0.376637 --> -0.893311).  Saving model ...
Epoch: 3 cost time: 0.7058658599853516
Epoch: 3, Steps: 18 | Train Loss: 1.516 Vali Loss: 1.054 Vali Acc: 0.943 Test Loss: 1.054 Test Acc: 0.943
Validation loss decreased (-0.893311 --> -0.943323).  Saving model ...
Epoch: 4 cost time: 0.8551652431488037
Epoch: 4, Steps: 18 | Train Loss: 0.514 Vali Loss: 0.333 Vali Acc: 0.963 Test Loss: 0.333 Test Acc: 0.963
Validation loss decreased (-0.943323 --> -0.963330).  Saving model ...
Epoch: 5 cost time: 0.7324812412261963
Epoch: 5, Steps: 18 | Train Loss: 0.114 Vali Loss: 0.166 Vali Acc: 0.967 Test Loss: 0.166 Test Acc: 0.967
Validation loss decreased (-0.963330 --> -0.966665).  Saving model ...
Epoch: 6 cost time: 0.827582836151123
Epoch: 6, Steps: 18 | Train Loss: 0.038 Vali Loss: 0.121 Vali Acc: 0.977 Test Loss: 0.121 Test Acc: 0.977
Validation loss decreased (-0.966665 --> -0.976665).  Saving model ...
Epoch: 7 cost time: 0.8215541839599609
Epoch: 7, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 8 cost time: 0.756788969039917
Epoch: 8, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 0.8228392601013184
Epoch: 9, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 0.7589809894561768
Epoch: 10, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 0.8266556262969971
Epoch: 11, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 0.8097541332244873
Epoch: 12, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 0.7339432239532471
Epoch: 13, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 0.7392432689666748
Epoch: 14, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 0.7859179973602295
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 0.7706522941589355
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 0.7648618221282959
Epoch: 17, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 0.7580339908599854
Epoch: 18, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 0.891638994216919
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 0.7353568077087402
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 0.7720601558685303
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8136718273162842
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 0.7883055210113525
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 0.8494603633880615
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8432431221008301
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.8018012046813965
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.7387759685516357
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 28 cost time: 0.8237512111663818
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 0.8616375923156738
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 30 cost time: 0.8048460483551025
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8278830051422119
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 32 cost time: 0.7900822162628174
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.7221324443817139
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.7368919849395752
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.7727313041687012
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.7845211029052734
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.6892015933990479
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.7328345775604248
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.8069334030151367
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.7685122489929199
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.7743439674377441
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps29_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 607769
model size : 2.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps36_str18_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.7249953746795654
Epoch: 1, Steps: 18 | Train Loss: 3.204 Vali Loss: 3.048 Vali Acc: 0.270 Test Loss: 3.048 Test Acc: 0.270
Validation loss decreased (inf --> -0.269970).  Saving model ...
Epoch: 2 cost time: 0.6724369525909424
Epoch: 2, Steps: 18 | Train Loss: 2.743 Vali Loss: 2.430 Vali Acc: 0.783 Test Loss: 2.430 Test Acc: 0.783
Validation loss decreased (-0.269970 --> -0.783309).  Saving model ...
Epoch: 3 cost time: 0.7102251052856445
Epoch: 3, Steps: 18 | Train Loss: 1.890 Vali Loss: 1.451 Vali Acc: 0.950 Test Loss: 1.451 Test Acc: 0.950
Validation loss decreased (-0.783309 --> -0.949985).  Saving model ...
Epoch: 4 cost time: 0.7559690475463867
Epoch: 4, Steps: 18 | Train Loss: 0.847 Vali Loss: 0.525 Vali Acc: 0.960 Test Loss: 0.525 Test Acc: 0.960
Validation loss decreased (-0.949985 --> -0.959995).  Saving model ...
Epoch: 5 cost time: 0.8432655334472656
Epoch: 5, Steps: 18 | Train Loss: 0.246 Vali Loss: 0.227 Vali Acc: 0.963 Test Loss: 0.227 Test Acc: 0.963
Validation loss decreased (-0.959995 --> -0.963331).  Saving model ...
Epoch: 6 cost time: 0.6765234470367432
Epoch: 6, Steps: 18 | Train Loss: 0.066 Vali Loss: 0.150 Vali Acc: 0.970 Test Loss: 0.150 Test Acc: 0.970
Validation loss decreased (-0.963331 --> -0.969999).  Saving model ...
Epoch: 7 cost time: 0.6944658756256104
Epoch: 7, Steps: 18 | Train Loss: 0.031 Vali Loss: 0.133 Vali Acc: 0.967 Test Loss: 0.133 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8102364540100098
Epoch: 8, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.122 Vali Acc: 0.973 Test Loss: 0.122 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 0.7537093162536621
Epoch: 9, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 0.8197219371795654
Epoch: 10, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 0.6699056625366211
Epoch: 11, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7353532314300537
Epoch: 12, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 13 cost time: 0.7409963607788086
Epoch: 13, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 14 cost time: 0.7089197635650635
Epoch: 14, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 15 cost time: 0.7522463798522949
Epoch: 15, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 16 cost time: 0.6860127449035645
Epoch: 16, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 17 cost time: 0.7223680019378662
Epoch: 17, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 18 cost time: 0.7720870971679688
Epoch: 18, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7534065246582031
Epoch: 19, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 20 cost time: 0.7462911605834961
Epoch: 20, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 21 cost time: 0.7479095458984375
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.749079704284668
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 23 cost time: 0.7722420692443848
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 24 cost time: 0.6879878044128418
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 25 cost time: 0.7046310901641846
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 26 cost time: 0.7350304126739502
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.7522664070129395
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.7600619792938232
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 29 cost time: 0.7712745666503906
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.8128926753997803
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.8081474304199219
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.7498605251312256
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.6447157859802246
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.7440776824951172
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.7305920124053955
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.6539549827575684
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.7674503326416016
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.7077789306640625
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps36_str18_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9733333333333334
model parameter : 579417
model size : 2.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.6128871440887451
Epoch: 1, Steps: 18 | Train Loss: 2.990 Vali Loss: 2.437 Vali Acc: 0.827 Test Loss: 2.437 Test Acc: 0.827
Validation loss decreased (inf --> -0.826642).  Saving model ...
Epoch: 2 cost time: 0.6386735439300537
Epoch: 2, Steps: 18 | Train Loss: 1.345 Vali Loss: 0.721 Vali Acc: 0.957 Test Loss: 0.721 Test Acc: 0.957
Validation loss decreased (-0.826642 --> -0.956659).  Saving model ...
Epoch: 3 cost time: 0.6851346492767334
Epoch: 3, Steps: 18 | Train Loss: 0.209 Vali Loss: 0.174 Vali Acc: 0.970 Test Loss: 0.174 Test Acc: 0.970
Validation loss decreased (-0.956659 --> -0.969998).  Saving model ...
Epoch: 4 cost time: 0.6684155464172363
Epoch: 4, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
Validation loss decreased (-0.969998 --> -0.976666).  Saving model ...
Epoch: 5 cost time: 0.6371099948883057
Epoch: 5, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 6 cost time: 0.5860581398010254
Epoch: 6, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7038509845733643
Epoch: 7, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7221670150756836
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.6270177364349365
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.6906771659851074
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.6900701522827148
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.650944709777832
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.6962628364562988
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.7375357151031494
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.7077016830444336
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 653241
model size : 2.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.4882190227508545
Epoch: 1, Steps: 18 | Train Loss: 3.089 Vali Loss: 2.782 Vali Acc: 0.640 Test Loss: 2.782 Test Acc: 0.640
Validation loss decreased (inf --> -0.639972).  Saving model ...
Epoch: 2 cost time: 0.6185336112976074
Epoch: 2, Steps: 18 | Train Loss: 2.125 Vali Loss: 1.581 Vali Acc: 0.933 Test Loss: 1.581 Test Acc: 0.933
Validation loss decreased (-0.639972 --> -0.933318).  Saving model ...
Epoch: 3 cost time: 0.610299825668335
Epoch: 3, Steps: 18 | Train Loss: 0.800 Vali Loss: 0.475 Vali Acc: 0.957 Test Loss: 0.475 Test Acc: 0.957
Validation loss decreased (-0.933318 --> -0.956662).  Saving model ...
Epoch: 4 cost time: 0.6480791568756104
Epoch: 4, Steps: 18 | Train Loss: 0.147 Vali Loss: 0.174 Vali Acc: 0.977 Test Loss: 0.174 Test Acc: 0.977
Validation loss decreased (-0.956662 --> -0.976665).  Saving model ...
Epoch: 5 cost time: 0.6661252975463867
Epoch: 5, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.121 Vali Acc: 0.977 Test Loss: 0.121 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 6 cost time: 0.5761122703552246
Epoch: 6, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 7 cost time: 0.6403958797454834
Epoch: 7, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7115068435668945
Epoch: 8, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7072970867156982
Epoch: 9, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.7024478912353516
Epoch: 10, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 0.6217632293701172
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 0.6734700202941895
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 0.5964419841766357
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 0.6184730529785156
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 0.646765947341919
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6746606826782227
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 0.802330493927002
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.713268518447876
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 0.6163952350616455
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 0.6491844654083252
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 0.6518886089324951
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 0.739295482635498
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7700185775756836
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 0.6602597236633301
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7049593925476074
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.6331443786621094
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 0.5993962287902832
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6867263317108154
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 0.5895001888275146
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 0.6687185764312744
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.626413106918335
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.6040353775024414
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 33 cost time: 0.7076108455657959
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 34 cost time: 0.6464447975158691
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.5728704929351807
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 36 cost time: 0.5926024913787842
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.6980810165405273
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.7008843421936035
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.6756658554077148
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.6362051963806152
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.611274242401123
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.6738224029541016
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.6316065788269043
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.6785600185394287
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.6951107978820801
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 394169
model size : 1.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.5338966846466064
Epoch: 1, Steps: 18 | Train Loss: 3.195 Vali Loss: 3.027 Vali Acc: 0.293 Test Loss: 3.027 Test Acc: 0.293
Validation loss decreased (inf --> -0.293303).  Saving model ...
Epoch: 2 cost time: 0.639512300491333
Epoch: 2, Steps: 18 | Train Loss: 2.626 Vali Loss: 2.310 Vali Acc: 0.880 Test Loss: 2.310 Test Acc: 0.880
Validation loss decreased (-0.293303 --> -0.879977).  Saving model ...
Epoch: 3 cost time: 0.7055387496948242
Epoch: 3, Steps: 18 | Train Loss: 1.632 Vali Loss: 1.210 Vali Acc: 0.953 Test Loss: 1.210 Test Acc: 0.953
Validation loss decreased (-0.879977 --> -0.953321).  Saving model ...
Epoch: 4 cost time: 0.6849312782287598
Epoch: 4, Steps: 18 | Train Loss: 0.594 Vali Loss: 0.390 Vali Acc: 0.963 Test Loss: 0.390 Test Acc: 0.963
Validation loss decreased (-0.953321 --> -0.963329).  Saving model ...
Epoch: 5 cost time: 0.6928739547729492
Epoch: 5, Steps: 18 | Train Loss: 0.132 Vali Loss: 0.186 Vali Acc: 0.970 Test Loss: 0.186 Test Acc: 0.970
Validation loss decreased (-0.963329 --> -0.969998).  Saving model ...
Epoch: 6 cost time: 0.6527495384216309
Epoch: 6, Steps: 18 | Train Loss: 0.039 Vali Loss: 0.137 Vali Acc: 0.973 Test Loss: 0.137 Test Acc: 0.973
Validation loss decreased (-0.969998 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 0.611290454864502
Epoch: 7, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.123 Vali Acc: 0.980 Test Loss: 0.123 Test Acc: 0.980
Validation loss decreased (-0.973332 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 0.6365320682525635
Epoch: 8, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6924500465393066
Epoch: 9, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 0.6084351539611816
Epoch: 10, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 0.6802272796630859
Epoch: 11, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 0.7058563232421875
Epoch: 12, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 0.6054582595825195
Epoch: 13, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 0.6306748390197754
Epoch: 14, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 0.6244864463806152
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 0.6593334674835205
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 0.6646757125854492
Epoch: 17, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 0.7300457954406738
Epoch: 18, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 0.6227545738220215
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5943417549133301
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.5985910892486572
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.6248683929443359
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 0.6333637237548828
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 0.6779086589813232
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 0.646031379699707
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 0.6132936477661133
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 0.589106559753418
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 0.6702253818511963
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 0.711165189743042
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.7175331115722656
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.5893404483795166
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.5807032585144043
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 33 cost time: 0.7623286247253418
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 34 cost time: 0.7397072315216064
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.7315425872802734
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.5687658786773682
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 37 cost time: 0.6357371807098389
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 38 cost time: 0.6753032207489014
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 39 cost time: 0.6601743698120117
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.6327543258666992
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.7082915306091309
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.7083063125610352
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.6521742343902588
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.6871793270111084
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.6802964210510254
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.6431303024291992
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.6767065525054932
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 0.6361486911773682
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 307865
model size : 1.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.7340049743652344
Epoch: 1, Steps: 18 | Train Loss: 3.195 Vali Loss: 3.073 Vali Acc: 0.180 Test Loss: 3.073 Test Acc: 0.180
Validation loss decreased (inf --> -0.179969).  Saving model ...
Epoch: 2 cost time: 0.619041919708252
Epoch: 2, Steps: 18 | Train Loss: 2.747 Vali Loss: 2.508 Vali Acc: 0.807 Test Loss: 2.508 Test Acc: 0.807
Validation loss decreased (-0.179969 --> -0.806642).  Saving model ...
Epoch: 3 cost time: 0.673220157623291
Epoch: 3, Steps: 18 | Train Loss: 1.937 Vali Loss: 1.593 Vali Acc: 0.923 Test Loss: 1.593 Test Acc: 0.923
Validation loss decreased (-0.806642 --> -0.923317).  Saving model ...
Epoch: 4 cost time: 0.6940865516662598
Epoch: 4, Steps: 18 | Train Loss: 0.947 Vali Loss: 0.645 Vali Acc: 0.963 Test Loss: 0.645 Test Acc: 0.963
Validation loss decreased (-0.923317 --> -0.963327).  Saving model ...
Epoch: 5 cost time: 0.6460578441619873
Epoch: 5, Steps: 18 | Train Loss: 0.295 Vali Loss: 0.259 Vali Acc: 0.970 Test Loss: 0.259 Test Acc: 0.970
Validation loss decreased (-0.963327 --> -0.969997).  Saving model ...
Epoch: 6 cost time: 0.6168768405914307
Epoch: 6, Steps: 18 | Train Loss: 0.085 Vali Loss: 0.163 Vali Acc: 0.973 Test Loss: 0.163 Test Acc: 0.973
Validation loss decreased (-0.969997 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 0.7700543403625488
Epoch: 7, Steps: 18 | Train Loss: 0.038 Vali Loss: 0.134 Vali Acc: 0.977 Test Loss: 0.134 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 8 cost time: 0.6624650955200195
Epoch: 8, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.129 Vali Acc: 0.973 Test Loss: 0.129 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7340846061706543
Epoch: 9, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 0.6371040344238281
Epoch: 10, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 0.6288943290710449
Epoch: 11, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 0.7125551700592041
Epoch: 12, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 0.6973166465759277
Epoch: 13, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 0.687279224395752
Epoch: 14, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 0.698535680770874
Epoch: 15, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 0.6939334869384766
Epoch: 16, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 0.7561628818511963
Epoch: 17, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 0.7014069557189941
Epoch: 18, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 0.6454920768737793
Epoch: 19, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 0.7100667953491211
Epoch: 20, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 0.6684844493865967
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 0.7223753929138184
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 0.5782351493835449
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 0.683128833770752
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6468226909637451
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 0.6031956672668457
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 0.751514196395874
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 28 cost time: 0.6034002304077148
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 0.6811263561248779
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.7086808681488037
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.6400668621063232
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.6935017108917236
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.6947312355041504
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.646796464920044
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.642021894454956
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.6653673648834229
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 37 cost time: 0.6909832954406738
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 38 cost time: 0.6482195854187012
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 39 cost time: 0.6570453643798828
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.6905956268310547
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.6501481533050537
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.6524405479431152
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.6884260177612305
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.7140421867370605
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.7058210372924805
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.7049946784973145
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.6766316890716553
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 0.6904065608978271
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 264793
model size : 1.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps22_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.4702270030975342
Epoch: 1, Steps: 18 | Train Loss: 3.170 Vali Loss: 3.057 Vali Acc: 0.287 Test Loss: 3.057 Test Acc: 0.287
Validation loss decreased (inf --> -0.286636).  Saving model ...
Epoch: 2 cost time: 0.6685552597045898
Epoch: 2, Steps: 18 | Train Loss: 2.783 Vali Loss: 2.557 Vali Acc: 0.750 Test Loss: 2.557 Test Acc: 0.750
Validation loss decreased (-0.286636 --> -0.749974).  Saving model ...
Epoch: 3 cost time: 0.6934185028076172
Epoch: 3, Steps: 18 | Train Loss: 2.095 Vali Loss: 1.750 Vali Acc: 0.897 Test Loss: 1.750 Test Acc: 0.897
Validation loss decreased (-0.749974 --> -0.896649).  Saving model ...
Epoch: 4 cost time: 0.6637842655181885
Epoch: 4, Steps: 18 | Train Loss: 1.178 Vali Loss: 0.848 Vali Acc: 0.947 Test Loss: 0.848 Test Acc: 0.947
Validation loss decreased (-0.896649 --> -0.946658).  Saving model ...
Epoch: 5 cost time: 0.701531171798706
Epoch: 5, Steps: 18 | Train Loss: 0.447 Vali Loss: 0.334 Vali Acc: 0.963 Test Loss: 0.334 Test Acc: 0.963
Validation loss decreased (-0.946658 --> -0.963330).  Saving model ...
Epoch: 6 cost time: 0.6558647155761719
Epoch: 6, Steps: 18 | Train Loss: 0.140 Vali Loss: 0.196 Vali Acc: 0.963 Test Loss: 0.196 Test Acc: 0.963
Validation loss decreased (-0.963330 --> -0.963331).  Saving model ...
Epoch: 7 cost time: 0.6480114459991455
Epoch: 7, Steps: 18 | Train Loss: 0.063 Vali Loss: 0.156 Vali Acc: 0.967 Test Loss: 0.156 Test Acc: 0.967
Validation loss decreased (-0.963331 --> -0.966665).  Saving model ...
Epoch: 8 cost time: 0.6779463291168213
Epoch: 8, Steps: 18 | Train Loss: 0.032 Vali Loss: 0.137 Vali Acc: 0.967 Test Loss: 0.137 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 9 cost time: 0.677990198135376
Epoch: 9, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.119 Vali Acc: 0.967 Test Loss: 0.119 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 10 cost time: 0.6830346584320068
Epoch: 10, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.115 Vali Acc: 0.967 Test Loss: 0.115 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966666).  Saving model ...
Epoch: 11 cost time: 0.6050450801849365
Epoch: 11, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.111 Vali Acc: 0.970 Test Loss: 0.111 Test Acc: 0.970
Validation loss decreased (-0.966666 --> -0.969999).  Saving model ...
Epoch: 12 cost time: 0.6648640632629395
Epoch: 12, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 13 cost time: 0.5999906063079834
Epoch: 13, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 14 cost time: 0.6656854152679443
Epoch: 14, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 15 cost time: 0.7090404033660889
Epoch: 15, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 16 cost time: 0.7113082408905029
Epoch: 16, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 17 cost time: 0.6807982921600342
Epoch: 17, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 18 cost time: 0.6101694107055664
Epoch: 18, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.607778787612915
Epoch: 19, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 20 cost time: 0.6407487392425537
Epoch: 20, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 0.7170610427856445
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6210906505584717
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.7004368305206299
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 0.6651356220245361
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 0.6512806415557861
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 0.6348187923431396
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5929512977600098
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.7043747901916504
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.6789999008178711
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.6841118335723877
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.6435530185699463
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 32 cost time: 0.712092399597168
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 33 cost time: 0.6488516330718994
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 34 cost time: 0.5931746959686279
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 35 cost time: 0.7014186382293701
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.710270881652832
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.7200582027435303
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 38 cost time: 0.6779236793518066
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 39 cost time: 0.6854813098907471
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.724623441696167
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 41 cost time: 0.6419298648834229
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.7258279323577881
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 43 cost time: 0.6888651847839355
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 44 cost time: 0.7524456977844238
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 45 cost time: 0.697868824005127
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 46 cost time: 0.775261402130127
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 47 cost time: 0.6432449817657471
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.5754380226135254
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.6442520618438721
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.6632366180419922
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps22_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 236217
model size : 0.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps29_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.7677013874053955
Epoch: 1, Steps: 18 | Train Loss: 3.187 Vali Loss: 3.072 Vali Acc: 0.213 Test Loss: 3.072 Test Acc: 0.213
Validation loss decreased (inf --> -0.213303).  Saving model ...
Epoch: 2 cost time: 0.6619839668273926
Epoch: 2, Steps: 18 | Train Loss: 2.846 Vali Loss: 2.674 Vali Acc: 0.713 Test Loss: 2.674 Test Acc: 0.713
Validation loss decreased (-0.213303 --> -0.713307).  Saving model ...
Epoch: 3 cost time: 0.678776741027832
Epoch: 3, Steps: 18 | Train Loss: 2.348 Vali Loss: 2.064 Vali Acc: 0.900 Test Loss: 2.064 Test Acc: 0.900
Validation loss decreased (-0.713307 --> -0.899979).  Saving model ...
Epoch: 4 cost time: 0.6980137825012207
Epoch: 4, Steps: 18 | Train Loss: 1.611 Vali Loss: 1.264 Vali Acc: 0.940 Test Loss: 1.264 Test Acc: 0.940
Validation loss decreased (-0.899979 --> -0.939987).  Saving model ...
Epoch: 5 cost time: 0.6652927398681641
Epoch: 5, Steps: 18 | Train Loss: 0.815 Vali Loss: 0.586 Vali Acc: 0.953 Test Loss: 0.586 Test Acc: 0.953
Validation loss decreased (-0.939987 --> -0.953327).  Saving model ...
Epoch: 6 cost time: 0.6638917922973633
Epoch: 6, Steps: 18 | Train Loss: 0.320 Vali Loss: 0.303 Vali Acc: 0.960 Test Loss: 0.303 Test Acc: 0.960
Validation loss decreased (-0.953327 --> -0.959997).  Saving model ...
Epoch: 7 cost time: 0.6885430812835693
Epoch: 7, Steps: 18 | Train Loss: 0.137 Vali Loss: 0.206 Vali Acc: 0.967 Test Loss: 0.206 Test Acc: 0.967
Validation loss decreased (-0.959997 --> -0.966665).  Saving model ...
Epoch: 8 cost time: 0.6465151309967041
Epoch: 8, Steps: 18 | Train Loss: 0.069 Vali Loss: 0.163 Vali Acc: 0.967 Test Loss: 0.163 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 9 cost time: 0.6764657497406006
Epoch: 9, Steps: 18 | Train Loss: 0.042 Vali Loss: 0.143 Vali Acc: 0.970 Test Loss: 0.143 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969999).  Saving model ...
Epoch: 10 cost time: 0.6226048469543457
Epoch: 10, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.132 Vali Acc: 0.970 Test Loss: 0.132 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 11 cost time: 0.6536548137664795
Epoch: 11, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.123 Vali Acc: 0.977 Test Loss: 0.123 Test Acc: 0.977
Validation loss decreased (-0.969999 --> -0.976665).  Saving model ...
Epoch: 12 cost time: 0.6551303863525391
Epoch: 12, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7057693004608154
Epoch: 13, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6980862617492676
Epoch: 14, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 0.6479499340057373
Epoch: 15, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 0.6266076564788818
Epoch: 16, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 0.596217155456543
Epoch: 17, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 0.6493141651153564
Epoch: 18, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 0.6865296363830566
Epoch: 19, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 0.5939526557922363
Epoch: 20, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 0.6757354736328125
Epoch: 21, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 0.636324405670166
Epoch: 22, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 0.658261775970459
Epoch: 23, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 0.674628496170044
Epoch: 24, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 0.666663408279419
Epoch: 25, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 0.6558964252471924
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 0.6590793132781982
Epoch: 27, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 28 cost time: 0.6428463459014893
Epoch: 28, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 0.7102534770965576
Epoch: 29, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.6227853298187256
Epoch: 30, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.7125914096832275
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 32 cost time: 0.6346173286437988
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.6615986824035645
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.7002906799316406
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.7494602203369141
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.6651060581207275
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.5985169410705566
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.7068672180175781
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.6925337314605713
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.6710941791534424
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.6138753890991211
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps29_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 207641
model size : 0.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps36_str18_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.4721319675445557
Epoch: 1, Steps: 18 | Train Loss: 3.286 Vali Loss: 3.168 Vali Acc: 0.113 Test Loss: 3.168 Test Acc: 0.113
Validation loss decreased (inf --> -0.113302).  Saving model ...
Epoch: 2 cost time: 0.6837551593780518
Epoch: 2, Steps: 18 | Train Loss: 3.052 Vali Loss: 2.926 Vali Acc: 0.397 Test Loss: 2.926 Test Acc: 0.397
Validation loss decreased (-0.113302 --> -0.396637).  Saving model ...
Epoch: 3 cost time: 0.6715960502624512
Epoch: 3, Steps: 18 | Train Loss: 2.691 Vali Loss: 2.518 Vali Acc: 0.723 Test Loss: 2.518 Test Acc: 0.723
Validation loss decreased (-0.396637 --> -0.723308).  Saving model ...
Epoch: 4 cost time: 0.7035043239593506
Epoch: 4, Steps: 18 | Train Loss: 2.157 Vali Loss: 1.901 Vali Acc: 0.867 Test Loss: 1.901 Test Acc: 0.867
Validation loss decreased (-0.723308 --> -0.866648).  Saving model ...
Epoch: 5 cost time: 0.6781940460205078
Epoch: 5, Steps: 18 | Train Loss: 1.454 Vali Loss: 1.171 Vali Acc: 0.940 Test Loss: 1.171 Test Acc: 0.940
Validation loss decreased (-0.866648 --> -0.939988).  Saving model ...
Epoch: 6 cost time: 0.6239204406738281
Epoch: 6, Steps: 18 | Train Loss: 0.719 Vali Loss: 0.576 Vali Acc: 0.957 Test Loss: 0.576 Test Acc: 0.957
Validation loss decreased (-0.939988 --> -0.956661).  Saving model ...
Epoch: 7 cost time: 0.6372354030609131
Epoch: 7, Steps: 18 | Train Loss: 0.300 Vali Loss: 0.318 Vali Acc: 0.967 Test Loss: 0.318 Test Acc: 0.967
Validation loss decreased (-0.956661 --> -0.966663).  Saving model ...
Epoch: 8 cost time: 0.686004638671875
Epoch: 8, Steps: 18 | Train Loss: 0.141 Vali Loss: 0.230 Vali Acc: 0.970 Test Loss: 0.230 Test Acc: 0.970
Validation loss decreased (-0.966663 --> -0.969998).  Saving model ...
Epoch: 9 cost time: 0.6360604763031006
Epoch: 9, Steps: 18 | Train Loss: 0.084 Vali Loss: 0.188 Vali Acc: 0.973 Test Loss: 0.188 Test Acc: 0.973
Validation loss decreased (-0.969998 --> -0.973331).  Saving model ...
Epoch: 10 cost time: 0.683617353439331
Epoch: 10, Steps: 18 | Train Loss: 0.054 Vali Loss: 0.163 Vali Acc: 0.977 Test Loss: 0.163 Test Acc: 0.977
Validation loss decreased (-0.973331 --> -0.976665).  Saving model ...
Epoch: 11 cost time: 0.6755647659301758
Epoch: 11, Steps: 18 | Train Loss: 0.036 Vali Loss: 0.148 Vali Acc: 0.973 Test Loss: 0.148 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6987824440002441
Epoch: 12, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.137 Vali Acc: 0.977 Test Loss: 0.137 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 13 cost time: 0.7100858688354492
Epoch: 13, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.129 Vali Acc: 0.977 Test Loss: 0.129 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 14 cost time: 0.7207427024841309
Epoch: 14, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.123 Vali Acc: 0.977 Test Loss: 0.123 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 15 cost time: 0.723980188369751
Epoch: 15, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.121 Vali Acc: 0.977 Test Loss: 0.121 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 16 cost time: 0.6319551467895508
Epoch: 16, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 0.7092249393463135
Epoch: 17, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 0.6811313629150391
Epoch: 18, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 0.6719181537628174
Epoch: 19, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 0.6430001258850098
Epoch: 20, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 0.7067112922668457
Epoch: 21, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.683281660079956
Epoch: 22, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 0.6070983409881592
Epoch: 23, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 0.7326419353485107
Epoch: 24, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 0.6638698577880859
Epoch: 25, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 0.7349801063537598
Epoch: 26, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.7116756439208984
Epoch: 27, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 28 cost time: 0.6677851676940918
Epoch: 28, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 0.6700179576873779
Epoch: 29, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 30 cost time: 0.6537458896636963
Epoch: 30, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.6104776859283447
Epoch: 31, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 32 cost time: 0.5884113311767578
Epoch: 32, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 33 cost time: 0.68898606300354
Epoch: 33, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 34 cost time: 0.6051294803619385
Epoch: 34, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 35 cost time: 0.6657252311706543
Epoch: 35, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.6035904884338379
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.6240339279174805
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 38 cost time: 0.6775705814361572
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.588714599609375
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.673961877822876
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 41 cost time: 0.5508158206939697
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 42 cost time: 0.6813929080963135
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 43 cost time: 0.6195952892303467
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.649057149887085
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 45 cost time: 0.6083483695983887
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.6120040416717529
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.6548054218292236
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.6496908664703369
Epoch: 48, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 49 cost time: 0.6669414043426514
Epoch: 49, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 50 cost time: 0.6571965217590332
Epoch: 50, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps36_str18_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 193465
model size : 0.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.4853286743164062
Epoch: 1, Steps: 18 | Train Loss: 2.374 Vali Loss: 0.852 Vali Acc: 0.907 Test Loss: 0.852 Test Acc: 0.907
Validation loss decreased (inf --> -0.906658).  Saving model ...
Epoch: 2 cost time: 1.4623363018035889
Epoch: 2, Steps: 18 | Train Loss: 0.152 Vali Loss: 0.137 Vali Acc: 0.967 Test Loss: 0.137 Test Acc: 0.967
Validation loss decreased (-0.906658 --> -0.966665).  Saving model ...
Epoch: 3 cost time: 1.4874396324157715
Epoch: 3, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.120 Vali Acc: 0.973 Test Loss: 0.120 Test Acc: 0.973
Validation loss decreased (-0.966665 --> -0.973332).  Saving model ...
Epoch: 4 cost time: 1.4765653610229492
Epoch: 4, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.122 Vali Acc: 0.983 Test Loss: 0.122 Test Acc: 0.983
Validation loss decreased (-0.973332 --> -0.983332).  Saving model ...
Epoch: 5 cost time: 1.491511583328247
Epoch: 5, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.131 Vali Acc: 0.973 Test Loss: 0.131 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.518937110900879
Epoch: 6, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.132 Vali Acc: 0.970 Test Loss: 0.132 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.5189580917358398
Epoch: 7, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.134 Vali Acc: 0.970 Test Loss: 0.134 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.4717645645141602
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.133 Vali Acc: 0.973 Test Loss: 0.133 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.5177125930786133
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.132 Vali Acc: 0.973 Test Loss: 0.132 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.4427602291107178
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.132 Vali Acc: 0.973 Test Loss: 0.132 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.5036513805389404
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.131 Vali Acc: 0.977 Test Loss: 0.131 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.3274660110473633
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.130 Vali Acc: 0.977 Test Loss: 0.130 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.3820698261260986
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.129 Vali Acc: 0.977 Test Loss: 0.129 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.4630329608917236
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.129 Vali Acc: 0.977 Test Loss: 0.129 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 3754137
model size : 14.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.2715296745300293
Epoch: 1, Steps: 18 | Train Loss: 2.723 Vali Loss: 1.780 Vali Acc: 0.903 Test Loss: 1.780 Test Acc: 0.903
Validation loss decreased (inf --> -0.903316).  Saving model ...
Epoch: 2 cost time: 1.3373277187347412
Epoch: 2, Steps: 18 | Train Loss: 0.483 Vali Loss: 0.186 Vali Acc: 0.960 Test Loss: 0.186 Test Acc: 0.960
Validation loss decreased (-0.903316 --> -0.959998).  Saving model ...
Epoch: 3 cost time: 1.3816659450531006
Epoch: 3, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
Validation loss decreased (-0.959998 --> -0.969999).  Saving model ...
Epoch: 4 cost time: 1.3371095657348633
Epoch: 4, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.165 Vali Acc: 0.943 Test Loss: 0.165 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.378570556640625
Epoch: 5, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 6 cost time: 1.3471391201019287
Epoch: 6, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4167993068695068
Epoch: 7, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 1.2000339031219482
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 1.2525596618652344
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 1.3805110454559326
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 1.3760554790496826
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
Validation loss decreased (-0.973332 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 1.380678653717041
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 1.3865342140197754
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 1.3975224494934082
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 1.3771860599517822
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3392329216003418
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 1.3601975440979004
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3773229122161865
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.410409927368164
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 1.3309917449951172
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 1.3833370208740234
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.185270071029663
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.1327574253082275
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.1647310256958008
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.3212952613830566
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.2468161582946777
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.407496452331543
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.378406047821045
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.4199848175048828
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.3670012950897217
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 2717849
model size : 10.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.3832685947418213
Epoch: 1, Steps: 18 | Train Loss: 2.894 Vali Loss: 2.317 Vali Acc: 0.917 Test Loss: 2.317 Test Acc: 0.917
Validation loss decreased (inf --> -0.916643).  Saving model ...
Epoch: 2 cost time: 1.2022366523742676
Epoch: 2, Steps: 18 | Train Loss: 0.994 Vali Loss: 0.387 Vali Acc: 0.943 Test Loss: 0.387 Test Acc: 0.943
Validation loss decreased (-0.916643 --> -0.943329).  Saving model ...
Epoch: 3 cost time: 1.2070581912994385
Epoch: 3, Steps: 18 | Train Loss: 0.074 Vali Loss: 0.122 Vali Acc: 0.970 Test Loss: 0.122 Test Acc: 0.970
Validation loss decreased (-0.943329 --> -0.969999).  Saving model ...
Epoch: 4 cost time: 1.3443195819854736
Epoch: 4, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 5 cost time: 1.3207218647003174
Epoch: 5, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 6 cost time: 1.3069140911102295
Epoch: 6, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 7 cost time: 1.3336498737335205
Epoch: 7, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 1.3074259757995605
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 1.3592369556427002
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 1.3366947174072266
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 1.3279311656951904
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 1.3146429061889648
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.366340160369873
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 1.3175199031829834
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 1.317688226699829
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 1.3417420387268066
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2306137084960938
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 1.216261863708496
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 1.2655847072601318
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3064284324645996
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 1.3479421138763428
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 1.3067905902862549
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.3954529762268066
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 1.3046536445617676
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.3502254486083984
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.3549835681915283
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.309006929397583
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.3656394481658936
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.3279504776000977
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.3237025737762451
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.3418498039245605
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.256075143814087
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.1615312099456787
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 2372633
model size : 9.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.3750805854797363
Epoch: 1, Steps: 18 | Train Loss: 3.000 Vali Loss: 2.552 Vali Acc: 0.820 Test Loss: 2.552 Test Acc: 0.820
Validation loss decreased (inf --> -0.819974).  Saving model ...
Epoch: 2 cost time: 1.310509204864502
Epoch: 2, Steps: 18 | Train Loss: 1.311 Vali Loss: 0.605 Vali Acc: 0.950 Test Loss: 0.605 Test Acc: 0.950
Validation loss decreased (-0.819974 --> -0.949994).  Saving model ...
Epoch: 3 cost time: 1.2981843948364258
Epoch: 3, Steps: 18 | Train Loss: 0.145 Vali Loss: 0.148 Vali Acc: 0.957 Test Loss: 0.148 Test Acc: 0.957
Validation loss decreased (-0.949994 --> -0.956665).  Saving model ...
Epoch: 4 cost time: 1.357696771621704
Epoch: 4, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
Validation loss decreased (-0.956665 --> -0.973332).  Saving model ...
Epoch: 5 cost time: 1.2666451930999756
Epoch: 5, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
Validation loss decreased (-0.973332 --> -0.979999).  Saving model ...
Epoch: 6 cost time: 1.2973217964172363
Epoch: 6, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 1.3253793716430664
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 1.312830924987793
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 1.1159279346466064
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 1.0694057941436768
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 1.0483951568603516
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 1.2164454460144043
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2187426090240479
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 1.226701021194458
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3561124801635742
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2644319534301758
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.2890584468841553
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.444983959197998
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.3267412185668945
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.3256540298461914
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.31130051612854
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.3155813217163086
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.3252196311950684
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 2200345
model size : 8.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps22_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.336348295211792
Epoch: 1, Steps: 18 | Train Loss: 3.004 Vali Loss: 2.544 Vali Acc: 0.873 Test Loss: 2.544 Test Acc: 0.873
Validation loss decreased (inf --> -0.873308).  Saving model ...
Epoch: 2 cost time: 1.2936110496520996
Epoch: 2, Steps: 18 | Train Loss: 1.455 Vali Loss: 0.711 Vali Acc: 0.947 Test Loss: 0.711 Test Acc: 0.947
Validation loss decreased (-0.873308 --> -0.946660).  Saving model ...
Epoch: 3 cost time: 1.3325507640838623
Epoch: 3, Steps: 18 | Train Loss: 0.225 Vali Loss: 0.146 Vali Acc: 0.963 Test Loss: 0.146 Test Acc: 0.963
Validation loss decreased (-0.946660 --> -0.963332).  Saving model ...
Epoch: 4 cost time: 1.3147368431091309
Epoch: 4, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.122 Vali Acc: 0.963 Test Loss: 0.122 Test Acc: 0.963
Validation loss decreased (-0.963332 --> -0.963332).  Saving model ...
Epoch: 5 cost time: 1.2982978820800781
Epoch: 5, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
Validation loss decreased (-0.963332 --> -0.973332).  Saving model ...
Epoch: 6 cost time: 1.3113446235656738
Epoch: 6, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.269963264465332
Epoch: 7, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 1.3548133373260498
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 1.3124973773956299
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 1.1346490383148193
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 1.169334888458252
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 1.2614877223968506
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2737414836883545
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 1.3105602264404297
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 1.2677066326141357
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.317734956741333
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.2674601078033447
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.3263490200042725
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.3278555870056152
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.3202073574066162
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.319765329360962
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.3650145530700684
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.3068206310272217
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.366281509399414
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps22_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 2086041
model size : 8.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps29_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.3174047470092773
Epoch: 1, Steps: 18 | Train Loss: 3.070 Vali Loss: 2.710 Vali Acc: 0.697 Test Loss: 2.710 Test Acc: 0.697
Validation loss decreased (inf --> -0.696640).  Saving model ...
Epoch: 2 cost time: 1.2649435997009277
Epoch: 2, Steps: 18 | Train Loss: 1.843 Vali Loss: 1.163 Vali Acc: 0.947 Test Loss: 1.163 Test Acc: 0.947
Validation loss decreased (-0.696640 --> -0.946655).  Saving model ...
Epoch: 3 cost time: 1.316225290298462
Epoch: 3, Steps: 18 | Train Loss: 0.439 Vali Loss: 0.227 Vali Acc: 0.967 Test Loss: 0.227 Test Acc: 0.967
Validation loss decreased (-0.946655 --> -0.966664).  Saving model ...
Epoch: 4 cost time: 1.2430577278137207
Epoch: 4, Steps: 18 | Train Loss: 0.067 Vali Loss: 0.137 Vali Acc: 0.967 Test Loss: 0.137 Test Acc: 0.967
Validation loss decreased (-0.966664 --> -0.966665).  Saving model ...
Epoch: 5 cost time: 1.3131508827209473
Epoch: 5, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
Validation loss decreased (-0.966665 --> -0.973332).  Saving model ...
Epoch: 6 cost time: 1.3022215366363525
Epoch: 6, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 1.3261439800262451
Epoch: 7, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 1.2895336151123047
Epoch: 8, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 1.2906606197357178
Epoch: 9, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 1.2701506614685059
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1523044109344482
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 12 cost time: 1.0911850929260254
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9591045379638672
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 14 cost time: 1.280660629272461
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 15 cost time: 1.2879159450531006
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 16 cost time: 1.2660162448883057
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.973332 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 1.259887933731079
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2598249912261963
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.297842025756836
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.3380804061889648
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.260925054550171
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.2658922672271729
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.2244651317596436
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.1849544048309326
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.2311444282531738
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.1847314834594727
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps29_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 1971737
model size : 7.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps36_str18_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.4033288955688477
Epoch: 1, Steps: 18 | Train Loss: 3.072 Vali Loss: 2.804 Vali Acc: 0.623 Test Loss: 2.804 Test Acc: 0.623
Validation loss decreased (inf --> -0.623305).  Saving model ...
Epoch: 2 cost time: 1.5010247230529785
Epoch: 2, Steps: 18 | Train Loss: 2.119 Vali Loss: 1.509 Vali Acc: 0.920 Test Loss: 1.509 Test Acc: 0.920
Validation loss decreased (-0.623305 --> -0.919985).  Saving model ...
Epoch: 3 cost time: 1.4221854209899902
Epoch: 3, Steps: 18 | Train Loss: 0.722 Vali Loss: 0.358 Vali Acc: 0.967 Test Loss: 0.358 Test Acc: 0.967
Validation loss decreased (-0.919985 --> -0.966663).  Saving model ...
Epoch: 4 cost time: 1.4014685153961182
Epoch: 4, Steps: 18 | Train Loss: 0.126 Vali Loss: 0.150 Vali Acc: 0.970 Test Loss: 0.150 Test Acc: 0.970
Validation loss decreased (-0.966663 --> -0.969998).  Saving model ...
Epoch: 5 cost time: 1.4462881088256836
Epoch: 5, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.126 Vali Acc: 0.973 Test Loss: 0.126 Test Acc: 0.973
Validation loss decreased (-0.969998 --> -0.973332).  Saving model ...
Epoch: 6 cost time: 1.3877789974212646
Epoch: 6, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 1.376939296722412
Epoch: 7, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 1.475651741027832
Epoch: 8, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 1.3904190063476562
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 1.4321565628051758
Epoch: 10, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 1.4745395183563232
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 1.4365344047546387
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2738938331604004
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 1.3746254444122314
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 1.2789664268493652
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3180954456329346
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.4739983081817627
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 1.4527382850646973
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 1.4198284149169922
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.4696664810180664
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.4623372554779053
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.4235484600067139
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 1.4705827236175537
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.3919572830200195
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.3813414573669434
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.5009496212005615
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.3747718334197998
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 28 cost time: 1.406080961227417
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 1.4838237762451172
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.330712080001831
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.2284042835235596
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.452383279800415
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.8960433006286621
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.405186653137207
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.5159709453582764
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.3691980838775635
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.3601112365722656
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 38 cost time: 1.5774924755096436
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.3716614246368408
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.3425259590148926
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.4008252620697021
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.3405730724334717
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.3463945388793945
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.3507814407348633
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.490764856338501
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 1.3881018161773682
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 1.3579459190368652
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps36_str18_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 1915033
model size : 7.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.151226043701172
Epoch: 1, Steps: 18 | Train Loss: 2.767 Vali Loss: 1.854 Vali Acc: 0.940 Test Loss: 1.854 Test Acc: 0.940
Validation loss decreased (inf --> -0.939981).  Saving model ...
Epoch: 2 cost time: 1.221921682357788
Epoch: 2, Steps: 18 | Train Loss: 0.600 Vali Loss: 0.243 Vali Acc: 0.950 Test Loss: 0.243 Test Acc: 0.950
Validation loss decreased (-0.939981 --> -0.949998).  Saving model ...
Epoch: 3 cost time: 1.1558849811553955
Epoch: 3, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.120 Vali Acc: 0.967 Test Loss: 0.120 Test Acc: 0.967
Validation loss decreased (-0.949998 --> -0.966665).  Saving model ...
Epoch: 4 cost time: 1.1221778392791748
Epoch: 4, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
Validation loss decreased (-0.966665 --> -0.973332).  Saving model ...
Epoch: 5 cost time: 1.127077341079712
Epoch: 5, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 6 cost time: 1.2882513999938965
Epoch: 6, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 1.2019636631011963
Epoch: 7, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1904218196868896
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 1.2290022373199463
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 1.1254122257232666
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 1.1103651523590088
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 12 cost time: 1.1278862953186035
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 13 cost time: 1.236086368560791
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 14 cost time: 1.2272164821624756
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 15 cost time: 0.9907147884368896
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 16 cost time: 0.9585814476013184
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 17 cost time: 1.1131651401519775
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 18 cost time: 1.1876516342163086
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 19 cost time: 1.2334098815917969
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 20 cost time: 1.2114055156707764
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 21 cost time: 1.203951120376587
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 22 cost time: 1.2579891681671143
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.1039891242980957
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.1092636585235596
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 25 cost time: 1.1445162296295166
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 1.3042511940002441
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.214709997177124
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.1838185787200928
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.2624826431274414
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 30 cost time: 1.1803665161132812
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 31 cost time: 1.1379477977752686
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 32 cost time: 1.1754729747772217
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.2746450901031494
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.9739487171173096
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.0168368816375732
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.150609016418457
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.1976268291473389
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.2205235958099365
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.2165191173553467
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.9697244167327881
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.0619826316833496
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 1492057
model size : 5.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.2587175369262695
Epoch: 1, Steps: 18 | Train Loss: 2.990 Vali Loss: 2.507 Vali Acc: 0.830 Test Loss: 2.507 Test Acc: 0.830
Validation loss decreased (inf --> -0.829975).  Saving model ...
Epoch: 2 cost time: 1.1809139251708984
Epoch: 2, Steps: 18 | Train Loss: 1.400 Vali Loss: 0.722 Vali Acc: 0.940 Test Loss: 0.722 Test Acc: 0.940
Validation loss decreased (-0.829975 --> -0.939993).  Saving model ...
Epoch: 3 cost time: 1.0790846347808838
Epoch: 3, Steps: 18 | Train Loss: 0.195 Vali Loss: 0.149 Vali Acc: 0.980 Test Loss: 0.149 Test Acc: 0.980
Validation loss decreased (-0.939993 --> -0.979999).  Saving model ...
Epoch: 4 cost time: 1.0170021057128906
Epoch: 4, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 5 cost time: 0.9754650592803955
Epoch: 5, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 6 cost time: 1.0362071990966797
Epoch: 6, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0666332244873047
Epoch: 7, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8675649166107178
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.2093825340270996
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.2078039646148682
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.1690678596496582
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.2580926418304443
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.2038593292236328
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.139474868774414
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 1.2244205474853516
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 1.0768530368804932
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 1.0160045623779297
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 1.0711863040924072
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 1.1142499446868896
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1558160781860352
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.1608102321624756
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.2077465057373047
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.0778498649597168
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.7579421997070312
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 0.9525539875030518
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 1.0300848484039307
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0476853847503662
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 1.043083667755127
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.1401658058166504
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.1332812309265137
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.1162424087524414
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.2257156372070312
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.0907306671142578
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.0522880554199219
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.044802188873291
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.1165130138397217
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.1291086673736572
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 973913
model size : 3.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.8947875499725342
Epoch: 1, Steps: 18 | Train Loss: 3.087 Vali Loss: 2.737 Vali Acc: 0.670 Test Loss: 2.737 Test Acc: 0.670
Validation loss decreased (inf --> -0.669973).  Saving model ...
Epoch: 2 cost time: 0.9349212646484375
Epoch: 2, Steps: 18 | Train Loss: 1.853 Vali Loss: 1.209 Vali Acc: 0.933 Test Loss: 1.209 Test Acc: 0.933
Validation loss decreased (-0.669973 --> -0.933321).  Saving model ...
Epoch: 3 cost time: 1.0286707878112793
Epoch: 3, Steps: 18 | Train Loss: 0.456 Vali Loss: 0.255 Vali Acc: 0.963 Test Loss: 0.255 Test Acc: 0.963
Validation loss decreased (-0.933321 --> -0.963331).  Saving model ...
Epoch: 4 cost time: 1.1213140487670898
Epoch: 4, Steps: 18 | Train Loss: 0.053 Vali Loss: 0.135 Vali Acc: 0.973 Test Loss: 0.135 Test Acc: 0.973
Validation loss decreased (-0.963331 --> -0.973332).  Saving model ...
Epoch: 5 cost time: 1.1252970695495605
Epoch: 5, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.116 Vali Acc: 0.970 Test Loss: 0.116 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0785295963287354
Epoch: 6, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1849126815795898
Epoch: 7, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.9806764125823975
Epoch: 8, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.023263931274414
Epoch: 9, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.0495085716247559
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 1.1012794971466064
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 1.1345100402832031
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 1.078474760055542
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1193854808807373
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 1.0331077575683594
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 1.0255444049835205
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 1.0712268352508545
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 1.1073052883148193
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1031439304351807
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 1.016408920288086
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9927206039428711
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 0.9265401363372803
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 0.7585909366607666
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.119682788848877
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.0402965545654297
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.0137226581573486
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.0105915069580078
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.1365530490875244
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.1068120002746582
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 30 cost time: 1.1134836673736572
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.143007755279541
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.1013333797454834
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.1073980331420898
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.0971739292144775
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.0829832553863525
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.0677306652069092
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.1205122470855713
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.147294521331787
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.0897047519683838
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 801305
model size : 3.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.080470085144043
Epoch: 1, Steps: 18 | Train Loss: 3.105 Vali Loss: 2.865 Vali Acc: 0.557 Test Loss: 2.865 Test Acc: 0.557
Validation loss decreased (inf --> -0.556638).  Saving model ...
Epoch: 2 cost time: 1.091219425201416
Epoch: 2, Steps: 18 | Train Loss: 2.173 Vali Loss: 1.670 Vali Acc: 0.920 Test Loss: 1.670 Test Acc: 0.920
Validation loss decreased (-0.556638 --> -0.919983).  Saving model ...
Epoch: 3 cost time: 1.110032081604004
Epoch: 3, Steps: 18 | Train Loss: 0.794 Vali Loss: 0.435 Vali Acc: 0.953 Test Loss: 0.435 Test Acc: 0.953
Validation loss decreased (-0.919983 --> -0.953329).  Saving model ...
Epoch: 4 cost time: 1.1139063835144043
Epoch: 4, Steps: 18 | Train Loss: 0.145 Vali Loss: 0.162 Vali Acc: 0.970 Test Loss: 0.162 Test Acc: 0.970
Validation loss decreased (-0.953329 --> -0.969998).  Saving model ...
Epoch: 5 cost time: 1.1003649234771729
Epoch: 5, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.127 Vali Acc: 0.967 Test Loss: 0.127 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1798231601715088
Epoch: 6, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
Validation loss decreased (-0.969998 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 1.124591588973999
Epoch: 7, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0809605121612549
Epoch: 8, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 1.1037204265594482
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 1.14150071144104
Epoch: 10, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 0.997241735458374
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 0.9694182872772217
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 1.0284333229064941
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 0.9609246253967285
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 0.9928524494171143
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 0.9454898834228516
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 0.9663782119750977
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1344120502471924
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.103426218032837
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.1447439193725586
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.0643043518066406
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.0933310985565186
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.0833332538604736
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 0.9808478355407715
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9123647212982178
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.0139431953430176
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.976250171661377
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.9468753337860107
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 1.2156908512115479
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 1.0384492874145508
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.065396785736084
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 32 cost time: 0.9300825595855713
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 33 cost time: 0.9892551898956299
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 34 cost time: 0.9561333656311035
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 35 cost time: 0.9108877182006836
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 36 cost time: 0.8386485576629639
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.7531895637512207
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.7295255661010742
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.8133666515350342
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 40 cost time: 0.7195830345153809
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.7753186225891113
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.7256438732147217
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.9963970184326172
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.022265911102295
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.0977346897125244
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.0898451805114746
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.0380408763885498
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 1.0558674335479736
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 1.02083158493042
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 715161
model size : 2.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps22_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.899763822555542
Epoch: 1, Steps: 18 | Train Loss: 3.147 Vali Loss: 2.934 Vali Acc: 0.563 Test Loss: 2.934 Test Acc: 0.563
Validation loss decreased (inf --> -0.563304).  Saving model ...
Epoch: 2 cost time: 0.7876071929931641
Epoch: 2, Steps: 18 | Train Loss: 2.385 Vali Loss: 1.932 Vali Acc: 0.897 Test Loss: 1.932 Test Acc: 0.897
Validation loss decreased (-0.563304 --> -0.896647).  Saving model ...
Epoch: 3 cost time: 1.0783586502075195
Epoch: 3, Steps: 18 | Train Loss: 1.126 Vali Loss: 0.635 Vali Acc: 0.967 Test Loss: 0.635 Test Acc: 0.967
Validation loss decreased (-0.896647 --> -0.966660).  Saving model ...
Epoch: 4 cost time: 0.890045166015625
Epoch: 4, Steps: 18 | Train Loss: 0.240 Vali Loss: 0.186 Vali Acc: 0.967 Test Loss: 0.186 Test Acc: 0.967
Validation loss decreased (-0.966660 --> -0.966665).  Saving model ...
Epoch: 5 cost time: 0.8691563606262207
Epoch: 5, Steps: 18 | Train Loss: 0.052 Vali Loss: 0.136 Vali Acc: 0.970 Test Loss: 0.136 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969999).  Saving model ...
Epoch: 6 cost time: 0.9028928279876709
Epoch: 6, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.110 Vali Acc: 0.967 Test Loss: 0.110 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0283823013305664
Epoch: 7, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.110 Vali Acc: 0.970 Test Loss: 0.110 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 8 cost time: 1.0084171295166016
Epoch: 8, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.969999 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 1.0130431652069092
Epoch: 9, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 0.9983499050140381
Epoch: 10, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 0.8713512420654297
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9563286304473877
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9602503776550293
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.9900662899017334
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 0.7581274509429932
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 0.7818427085876465
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 0.9467442035675049
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 0.9927704334259033
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 0.9646210670471191
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 1.0395712852478027
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 1.0073294639587402
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 0.9935603141784668
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 0.9676916599273682
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0335938930511475
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.0112652778625488
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.0159573554992676
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 1.060117244720459
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0163602828979492
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.0205514430999756
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.8481664657592773
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.755908727645874
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 32 cost time: 0.8933231830596924
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 33 cost time: 0.9658353328704834
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.9200248718261719
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.926206111907959
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.0035195350646973
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.0154609680175781
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 38 cost time: 1.037013292312622
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.0108134746551514
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.004216194152832
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.8761882781982422
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.8910183906555176
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.9230697154998779
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.0416300296783447
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.012436866760254
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.8657634258270264
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.855501651763916
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps22_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 658009
model size : 2.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps29_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.9678585529327393
Epoch: 1, Steps: 18 | Train Loss: 3.179 Vali Loss: 2.986 Vali Acc: 0.390 Test Loss: 2.986 Test Acc: 0.390
Validation loss decreased (inf --> -0.389970).  Saving model ...
Epoch: 2 cost time: 1.087829351425171
Epoch: 2, Steps: 18 | Train Loss: 2.549 Vali Loss: 2.198 Vali Acc: 0.900 Test Loss: 2.198 Test Acc: 0.900
Validation loss decreased (-0.389970 --> -0.899978).  Saving model ...
Epoch: 3 cost time: 1.014183521270752
Epoch: 3, Steps: 18 | Train Loss: 1.509 Vali Loss: 1.061 Vali Acc: 0.950 Test Loss: 1.061 Test Acc: 0.950
Validation loss decreased (-0.899978 --> -0.949989).  Saving model ...
Epoch: 4 cost time: 0.979048490524292
Epoch: 4, Steps: 18 | Train Loss: 0.514 Vali Loss: 0.335 Vali Acc: 0.967 Test Loss: 0.335 Test Acc: 0.967
Validation loss decreased (-0.949989 --> -0.966663).  Saving model ...
Epoch: 5 cost time: 0.9695124626159668
Epoch: 5, Steps: 18 | Train Loss: 0.113 Vali Loss: 0.162 Vali Acc: 0.977 Test Loss: 0.162 Test Acc: 0.977
Validation loss decreased (-0.966663 --> -0.976665).  Saving model ...
Epoch: 6 cost time: 0.9479331970214844
Epoch: 6, Steps: 18 | Train Loss: 0.038 Vali Loss: 0.127 Vali Acc: 0.973 Test Loss: 0.127 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.87103271484375
Epoch: 7, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.117 Vali Acc: 0.973 Test Loss: 0.117 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8253827095031738
Epoch: 8, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 0.8024330139160156
Epoch: 9, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7703049182891846
Epoch: 10, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.124910831451416
Epoch: 11, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.0497052669525146
Epoch: 12, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.0967936515808105
Epoch: 13, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.0889523029327393
Epoch: 14, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.0358102321624756
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 1.0814483165740967
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0628607273101807
Epoch: 17, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8963208198547363
Epoch: 18, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 0.9709832668304443
Epoch: 19, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0001275539398193
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.055408239364624
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.932215690612793
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.8244366645812988
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 0.9610967636108398
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0174798965454102
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.9236202239990234
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 1.1063759326934814
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 28 cost time: 1.1099305152893066
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.0056676864624023
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.1112720966339111
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 31 cost time: 1.068713903427124
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.0922293663024902
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 33 cost time: 1.1054043769836426
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 34 cost time: 1.0526840686798096
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.0360944271087646
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 36 cost time: 0.922130823135376
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.8781147003173828
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.8560364246368408
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.1098003387451172
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.095170021057129
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.1437499523162842
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.0460355281829834
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.0407941341400146
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.0381662845611572
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 1.0765113830566406
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 46 cost time: 1.0004847049713135
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.9657087326049805
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.0242137908935547
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.9960517883300781
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.8356389999389648
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps29_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 600857
model size : 2.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps36_str18_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.173522710800171
Epoch: 1, Steps: 18 | Train Loss: 3.173 Vali Loss: 3.030 Vali Acc: 0.283 Test Loss: 3.030 Test Acc: 0.283
Validation loss decreased (inf --> -0.283303).  Saving model ...
Epoch: 2 cost time: 1.138080358505249
Epoch: 2, Steps: 18 | Train Loss: 2.697 Vali Loss: 2.402 Vali Acc: 0.767 Test Loss: 2.402 Test Acc: 0.767
Validation loss decreased (-0.283303 --> -0.766643).  Saving model ...
Epoch: 3 cost time: 0.8730769157409668
Epoch: 3, Steps: 18 | Train Loss: 1.842 Vali Loss: 1.402 Vali Acc: 0.920 Test Loss: 1.402 Test Acc: 0.920
Validation loss decreased (-0.766643 --> -0.919986).  Saving model ...
Epoch: 4 cost time: 1.0324430465698242
Epoch: 4, Steps: 18 | Train Loss: 0.820 Vali Loss: 0.500 Vali Acc: 0.957 Test Loss: 0.500 Test Acc: 0.957
Validation loss decreased (-0.919986 --> -0.956662).  Saving model ...
Epoch: 5 cost time: 0.9853940010070801
Epoch: 5, Steps: 18 | Train Loss: 0.232 Vali Loss: 0.220 Vali Acc: 0.963 Test Loss: 0.220 Test Acc: 0.963
Validation loss decreased (-0.956662 --> -0.963331).  Saving model ...
Epoch: 6 cost time: 0.9187443256378174
Epoch: 6, Steps: 18 | Train Loss: 0.078 Vali Loss: 0.151 Vali Acc: 0.967 Test Loss: 0.151 Test Acc: 0.967
Validation loss decreased (-0.963331 --> -0.966665).  Saving model ...
Epoch: 7 cost time: 0.9190869331359863
Epoch: 7, Steps: 18 | Train Loss: 0.035 Vali Loss: 0.127 Vali Acc: 0.970 Test Loss: 0.127 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969999).  Saving model ...
Epoch: 8 cost time: 0.8640062808990479
Epoch: 8, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
Validation loss decreased (-0.969999 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 0.7618296146392822
Epoch: 9, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.111 Vali Acc: 0.970 Test Loss: 0.111 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7149229049682617
Epoch: 10, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0159258842468262
Epoch: 11, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.9252839088439941
Epoch: 12, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.9410488605499268
Epoch: 13, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.0684728622436523
Epoch: 14, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.9315729141235352
Epoch: 15, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.9627194404602051
Epoch: 16, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.0487184524536133
Epoch: 17, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.9513659477233887
Epoch: 18, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.970 Test Loss: 0.096 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps36_str18_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 572505
model size : 2.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.817704200744629
Epoch: 1, Steps: 18 | Train Loss: 2.959 Vali Loss: 2.415 Vali Acc: 0.850 Test Loss: 2.415 Test Acc: 0.850
Validation loss decreased (inf --> -0.849976).  Saving model ...
Epoch: 2 cost time: 0.8299107551574707
Epoch: 2, Steps: 18 | Train Loss: 1.309 Vali Loss: 0.690 Vali Acc: 0.963 Test Loss: 0.690 Test Acc: 0.963
Validation loss decreased (-0.849976 --> -0.963326).  Saving model ...
Epoch: 3 cost time: 0.8520896434783936
Epoch: 3, Steps: 18 | Train Loss: 0.193 Vali Loss: 0.176 Vali Acc: 0.970 Test Loss: 0.176 Test Acc: 0.970
Validation loss decreased (-0.963326 --> -0.969998).  Saving model ...
Epoch: 4 cost time: 0.8865876197814941
Epoch: 4, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.111 Vali Acc: 0.983 Test Loss: 0.111 Test Acc: 0.983
Validation loss decreased (-0.969998 --> -0.983332).  Saving model ...
Epoch: 5 cost time: 0.8548870086669922
Epoch: 5, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8793015480041504
Epoch: 6, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.8540279865264893
Epoch: 7, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.8958377838134766
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.8693504333496094
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.8848376274108887
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.9017486572265625
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.8745713233947754
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.876699686050415
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.6896061897277832
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 649785
model size : 2.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.5449442863464355
Epoch: 1, Steps: 18 | Train Loss: 3.111 Vali Loss: 2.800 Vali Acc: 0.627 Test Loss: 2.800 Test Acc: 0.627
Validation loss decreased (inf --> -0.626639).  Saving model ...
Epoch: 2 cost time: 0.779883623123169
Epoch: 2, Steps: 18 | Train Loss: 2.149 Vali Loss: 1.604 Vali Acc: 0.903 Test Loss: 1.604 Test Acc: 0.903
Validation loss decreased (-0.626639 --> -0.903317).  Saving model ...
Epoch: 3 cost time: 0.7862510681152344
Epoch: 3, Steps: 18 | Train Loss: 0.823 Vali Loss: 0.485 Vali Acc: 0.963 Test Loss: 0.485 Test Acc: 0.963
Validation loss decreased (-0.903317 --> -0.963328).  Saving model ...
Epoch: 4 cost time: 0.8602650165557861
Epoch: 4, Steps: 18 | Train Loss: 0.177 Vali Loss: 0.178 Vali Acc: 0.970 Test Loss: 0.178 Test Acc: 0.970
Validation loss decreased (-0.963328 --> -0.969998).  Saving model ...
Epoch: 5 cost time: 0.906620979309082
Epoch: 5, Steps: 18 | Train Loss: 0.046 Vali Loss: 0.137 Vali Acc: 0.970 Test Loss: 0.137 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969999).  Saving model ...
Epoch: 6 cost time: 0.8422751426696777
Epoch: 6, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
Validation loss decreased (-0.969999 --> -0.976666).  Saving model ...
Epoch: 7 cost time: 0.9089550971984863
Epoch: 7, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8196513652801514
Epoch: 8, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.922616720199585
Epoch: 9, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.7776923179626465
Epoch: 10, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.6385681629180908
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.7404241561889648
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.817603349685669
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.8891701698303223
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.7822723388671875
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.8683464527130127
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 0.7738268375396729
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 0.7616574764251709
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 0.7388911247253418
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 0.7663061618804932
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 0.7078108787536621
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 0.6840832233428955
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 0.8211088180541992
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 0.843019962310791
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6487061977386475
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 0.8265030384063721
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 0.7859163284301758
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 28 cost time: 0.8611588478088379
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 0.8893043994903564
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 30 cost time: 0.8024587631225586
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8562793731689453
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 32 cost time: 0.8569679260253906
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 33 cost time: 0.8161804676055908
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.981781005859375
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.8019063472747803
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.8679959774017334
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.8551928997039795
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.8980789184570312
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.8738939762115479
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.8575949668884277
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.8326542377471924
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 42 cost time: 0.6933574676513672
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 43 cost time: 0.6774177551269531
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.809197187423706
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 45 cost time: 0.8941378593444824
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.8495638370513916
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 47 cost time: 0.8458349704742432
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 48 cost time: 0.8890764713287354
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.8563327789306641
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.8945369720458984
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 390713
model size : 1.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.7993907928466797
Epoch: 1, Steps: 18 | Train Loss: 3.170 Vali Loss: 3.021 Vali Acc: 0.300 Test Loss: 3.021 Test Acc: 0.300
Validation loss decreased (inf --> -0.299970).  Saving model ...
Epoch: 2 cost time: 0.7404255867004395
Epoch: 2, Steps: 18 | Train Loss: 2.614 Vali Loss: 2.311 Vali Acc: 0.853 Test Loss: 2.311 Test Acc: 0.853
Validation loss decreased (-0.299970 --> -0.853310).  Saving model ...
Epoch: 3 cost time: 0.8059015274047852
Epoch: 3, Steps: 18 | Train Loss: 1.650 Vali Loss: 1.212 Vali Acc: 0.950 Test Loss: 1.212 Test Acc: 0.950
Validation loss decreased (-0.853310 --> -0.949988).  Saving model ...
Epoch: 4 cost time: 0.8602523803710938
Epoch: 4, Steps: 18 | Train Loss: 0.590 Vali Loss: 0.404 Vali Acc: 0.963 Test Loss: 0.404 Test Acc: 0.963
Validation loss decreased (-0.949988 --> -0.963329).  Saving model ...
Epoch: 5 cost time: 0.8318624496459961
Epoch: 5, Steps: 18 | Train Loss: 0.141 Vali Loss: 0.192 Vali Acc: 0.970 Test Loss: 0.192 Test Acc: 0.970
Validation loss decreased (-0.963329 --> -0.969998).  Saving model ...
Epoch: 6 cost time: 0.8411865234375
Epoch: 6, Steps: 18 | Train Loss: 0.041 Vali Loss: 0.147 Vali Acc: 0.970 Test Loss: 0.147 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969999).  Saving model ...
Epoch: 7 cost time: 0.8486306667327881
Epoch: 7, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.129 Vali Acc: 0.973 Test Loss: 0.129 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 0.872328519821167
Epoch: 8, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 0.8711180686950684
Epoch: 9, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 0.8818168640136719
Epoch: 10, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.110 Vali Acc: 0.980 Test Loss: 0.110 Test Acc: 0.980
Validation loss decreased (-0.973332 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 0.8454844951629639
Epoch: 11, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 0.9024887084960938
Epoch: 12, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 0.8681888580322266
Epoch: 13, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 0.8239443302154541
Epoch: 14, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 0.8799769878387451
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 0.831096887588501
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 0.7727527618408203
Epoch: 17, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 0.7868115901947021
Epoch: 18, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 0.8298742771148682
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 0.8476886749267578
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 0.778008222579956
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 0.805720329284668
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 0.8464856147766113
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7392110824584961
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 0.7787611484527588
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 0.7913057804107666
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 0.7666313648223877
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 0.8749589920043945
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 0.7322304248809814
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.7159850597381592
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.6102476119995117
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 32 cost time: 0.6815285682678223
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.811009407043457
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.8301703929901123
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.8431720733642578
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.8485403060913086
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 37 cost time: 0.8248541355133057
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.8947985172271729
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.0037150382995605
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 40 cost time: 0.9621472358703613
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.7907617092132568
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.7949233055114746
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.8083319664001465
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.8289601802825928
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.9068617820739746
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.8750150203704834
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.8579211235046387
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 0.772489070892334
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 0.6690585613250732
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 304409
model size : 1.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.9365513324737549
Epoch: 1, Steps: 18 | Train Loss: 3.217 Vali Loss: 3.085 Vali Acc: 0.197 Test Loss: 3.085 Test Acc: 0.197
Validation loss decreased (inf --> -0.196636).  Saving model ...
Epoch: 2 cost time: 0.8187108039855957
Epoch: 2, Steps: 18 | Train Loss: 2.756 Vali Loss: 2.532 Vali Acc: 0.773 Test Loss: 2.532 Test Acc: 0.773
Validation loss decreased (-0.196636 --> -0.773308).  Saving model ...
Epoch: 3 cost time: 0.7884533405303955
Epoch: 3, Steps: 18 | Train Loss: 1.945 Vali Loss: 1.592 Vali Acc: 0.940 Test Loss: 1.592 Test Acc: 0.940
Validation loss decreased (-0.773308 --> -0.939984).  Saving model ...
Epoch: 4 cost time: 0.8113265037536621
Epoch: 4, Steps: 18 | Train Loss: 0.973 Vali Loss: 0.669 Vali Acc: 0.960 Test Loss: 0.669 Test Acc: 0.960
Validation loss decreased (-0.939984 --> -0.959993).  Saving model ...
Epoch: 5 cost time: 0.7505607604980469
Epoch: 5, Steps: 18 | Train Loss: 0.306 Vali Loss: 0.264 Vali Acc: 0.967 Test Loss: 0.264 Test Acc: 0.967
Validation loss decreased (-0.959993 --> -0.966664).  Saving model ...
Epoch: 6 cost time: 0.771963357925415
Epoch: 6, Steps: 18 | Train Loss: 0.088 Vali Loss: 0.165 Vali Acc: 0.973 Test Loss: 0.165 Test Acc: 0.973
Validation loss decreased (-0.966664 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 0.8281300067901611
Epoch: 7, Steps: 18 | Train Loss: 0.039 Vali Loss: 0.140 Vali Acc: 0.970 Test Loss: 0.140 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7893335819244385
Epoch: 8, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.123 Vali Acc: 0.973 Test Loss: 0.123 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 0.7205550670623779
Epoch: 9, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.117 Vali Acc: 0.973 Test Loss: 0.117 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 0.8239803314208984
Epoch: 10, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 0.6244757175445557
Epoch: 11, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 12 cost time: 0.9400525093078613
Epoch: 12, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 0.8275821208953857
Epoch: 13, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 0.8364036083221436
Epoch: 14, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 0.8518950939178467
Epoch: 15, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 0.8712339401245117
Epoch: 16, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 0.8273429870605469
Epoch: 17, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 0.785412073135376
Epoch: 18, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 0.8273365497589111
Epoch: 19, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 0.8005573749542236
Epoch: 20, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 0.8592836856842041
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8548407554626465
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 0.8134951591491699
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 0.6623270511627197
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7907466888427734
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 0.8254375457763672
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 0.8733415603637695
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 0.8064281940460205
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 0.8178446292877197
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.8852536678314209
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 31 cost time: 0.8159201145172119
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.8090701103210449
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.6923961639404297
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.7969553470611572
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.8483216762542725
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 36 cost time: 0.7939319610595703
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 37 cost time: 0.8388972282409668
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.8133041858673096
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 39 cost time: 0.8977997303009033
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.589730978012085
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.8537583351135254
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.8161933422088623
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.6271870136260986
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.7624626159667969
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 45 cost time: 0.8019900321960449
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 46 cost time: 0.8498451709747314
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.8165295124053955
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.8738443851470947
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.8584263324737549
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.7659356594085693
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 261337
model size : 1.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps22_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.7579429149627686
Epoch: 1, Steps: 18 | Train Loss: 3.177 Vali Loss: 3.060 Vali Acc: 0.220 Test Loss: 3.060 Test Acc: 0.220
Validation loss decreased (inf --> -0.219969).  Saving model ...
Epoch: 2 cost time: 0.7079017162322998
Epoch: 2, Steps: 18 | Train Loss: 2.785 Vali Loss: 2.571 Vali Acc: 0.727 Test Loss: 2.571 Test Acc: 0.727
Validation loss decreased (-0.219969 --> -0.726641).  Saving model ...
Epoch: 3 cost time: 0.8092854022979736
Epoch: 3, Steps: 18 | Train Loss: 2.120 Vali Loss: 1.767 Vali Acc: 0.930 Test Loss: 1.767 Test Acc: 0.930
Validation loss decreased (-0.726641 --> -0.929982).  Saving model ...
Epoch: 4 cost time: 0.8427691459655762
Epoch: 4, Steps: 18 | Train Loss: 1.239 Vali Loss: 0.875 Vali Acc: 0.957 Test Loss: 0.875 Test Acc: 0.957
Validation loss decreased (-0.929982 --> -0.956658).  Saving model ...
Epoch: 5 cost time: 0.7841503620147705
Epoch: 5, Steps: 18 | Train Loss: 0.469 Vali Loss: 0.347 Vali Acc: 0.967 Test Loss: 0.347 Test Acc: 0.967
Validation loss decreased (-0.956658 --> -0.966663).  Saving model ...
Epoch: 6 cost time: 0.7420024871826172
Epoch: 6, Steps: 18 | Train Loss: 0.153 Vali Loss: 0.199 Vali Acc: 0.963 Test Loss: 0.199 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8112359046936035
Epoch: 7, Steps: 18 | Train Loss: 0.062 Vali Loss: 0.155 Vali Acc: 0.970 Test Loss: 0.155 Test Acc: 0.970
Validation loss decreased (-0.966663 --> -0.969998).  Saving model ...
Epoch: 8 cost time: 0.7518970966339111
Epoch: 8, Steps: 18 | Train Loss: 0.037 Vali Loss: 0.130 Vali Acc: 0.977 Test Loss: 0.130 Test Acc: 0.977
Validation loss decreased (-0.969998 --> -0.976665).  Saving model ...
Epoch: 9 cost time: 0.8514842987060547
Epoch: 9, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.122 Vali Acc: 0.977 Test Loss: 0.122 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 10 cost time: 0.7353432178497314
Epoch: 10, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 0.7719953060150146
Epoch: 11, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 0.7772426605224609
Epoch: 12, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 0.767817497253418
Epoch: 13, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 0.8402559757232666
Epoch: 14, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 0.8116130828857422
Epoch: 15, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.094 Vali Acc: 0.983 Test Loss: 0.094 Test Acc: 0.983
Validation loss decreased (-0.976666 --> -0.983332).  Saving model ...
Epoch: 16 cost time: 0.7666428089141846
Epoch: 16, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7354230880737305
Epoch: 17, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8453805446624756
Epoch: 18, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.8399627208709717
Epoch: 19, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.8181982040405273
Epoch: 20, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.8512635231018066
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.806771993637085
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.7452740669250488
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.8630938529968262
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.8869035243988037
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps22_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 232761
model size : 0.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps29_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.9594500064849854
Epoch: 1, Steps: 18 | Train Loss: 3.195 Vali Loss: 3.118 Vali Acc: 0.123 Test Loss: 3.118 Test Acc: 0.123
Validation loss decreased (inf --> -0.123302).  Saving model ...
Epoch: 2 cost time: 0.7757360935211182
Epoch: 2, Steps: 18 | Train Loss: 2.892 Vali Loss: 2.733 Vali Acc: 0.547 Test Loss: 2.733 Test Acc: 0.547
Validation loss decreased (-0.123302 --> -0.546639).  Saving model ...
Epoch: 3 cost time: 0.7981791496276855
Epoch: 3, Steps: 18 | Train Loss: 2.382 Vali Loss: 2.128 Vali Acc: 0.833 Test Loss: 2.128 Test Acc: 0.833
Validation loss decreased (-0.546639 --> -0.833312).  Saving model ...
Epoch: 4 cost time: 0.7487649917602539
Epoch: 4, Steps: 18 | Train Loss: 1.685 Vali Loss: 1.338 Vali Acc: 0.940 Test Loss: 1.338 Test Acc: 0.940
Validation loss decreased (-0.833312 --> -0.939987).  Saving model ...
Epoch: 5 cost time: 0.7708876132965088
Epoch: 5, Steps: 18 | Train Loss: 0.843 Vali Loss: 0.627 Vali Acc: 0.967 Test Loss: 0.627 Test Acc: 0.967
Validation loss decreased (-0.939987 --> -0.966660).  Saving model ...
Epoch: 6 cost time: 0.7935023307800293
Epoch: 6, Steps: 18 | Train Loss: 0.330 Vali Loss: 0.302 Vali Acc: 0.960 Test Loss: 0.302 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7730145454406738
Epoch: 7, Steps: 18 | Train Loss: 0.133 Vali Loss: 0.198 Vali Acc: 0.963 Test Loss: 0.198 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7903330326080322
Epoch: 8, Steps: 18 | Train Loss: 0.068 Vali Loss: 0.162 Vali Acc: 0.973 Test Loss: 0.162 Test Acc: 0.973
Validation loss decreased (-0.966660 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 0.8259923458099365
Epoch: 9, Steps: 18 | Train Loss: 0.041 Vali Loss: 0.146 Vali Acc: 0.963 Test Loss: 0.146 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8330631256103516
Epoch: 10, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.130 Vali Acc: 0.973 Test Loss: 0.130 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 0.8099899291992188
Epoch: 11, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.123 Vali Acc: 0.973 Test Loss: 0.123 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 12 cost time: 0.8321530818939209
Epoch: 12, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 13 cost time: 0.7733943462371826
Epoch: 13, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 14 cost time: 0.7580468654632568
Epoch: 14, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 0.7015509605407715
Epoch: 15, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 0.7839653491973877
Epoch: 16, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 0.8238992691040039
Epoch: 17, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 0.8776288032531738
Epoch: 18, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 0.8641252517700195
Epoch: 19, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 0.742053747177124
Epoch: 20, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 0.8601870536804199
Epoch: 21, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 0.8285386562347412
Epoch: 22, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 0.8298518657684326
Epoch: 23, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 0.8275535106658936
Epoch: 24, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 0.7798886299133301
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 0.8506081104278564
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 0.8373661041259766
Epoch: 27, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 28 cost time: 0.6755313873291016
Epoch: 28, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 0.6696071624755859
Epoch: 29, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 30 cost time: 0.6600403785705566
Epoch: 30, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.7627015113830566
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.7415997982025146
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.7335555553436279
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 34 cost time: 0.7788705825805664
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.8215899467468262
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 36 cost time: 0.8262436389923096
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.8432502746582031
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.7717957496643066
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 39 cost time: 0.7071347236633301
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.7834925651550293
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.8027384281158447
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 42 cost time: 0.8597691059112549
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 43 cost time: 0.8032288551330566
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 44 cost time: 0.6753764152526855
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.7349328994750977
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 46 cost time: 0.8121206760406494
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 47 cost time: 0.7998590469360352
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 48 cost time: 0.7537803649902344
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 49 cost time: 0.7897450923919678
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.8727459907531738
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps29_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 204185
model size : 0.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps36_str18_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.560595989227295
Epoch: 1, Steps: 18 | Train Loss: 3.236 Vali Loss: 3.157 Vali Acc: 0.083 Test Loss: 3.157 Test Acc: 0.083
Validation loss decreased (inf --> -0.083302).  Saving model ...
Epoch: 2 cost time: 0.6418676376342773
Epoch: 2, Steps: 18 | Train Loss: 3.030 Vali Loss: 2.900 Vali Acc: 0.517 Test Loss: 2.900 Test Acc: 0.517
Validation loss decreased (-0.083302 --> -0.516638).  Saving model ...
Epoch: 3 cost time: 0.6582508087158203
Epoch: 3, Steps: 18 | Train Loss: 2.662 Vali Loss: 2.468 Vali Acc: 0.823 Test Loss: 2.468 Test Acc: 0.823
Validation loss decreased (-0.516638 --> -0.823309).  Saving model ...
Epoch: 4 cost time: 0.7420287132263184
Epoch: 4, Steps: 18 | Train Loss: 2.106 Vali Loss: 1.839 Vali Acc: 0.917 Test Loss: 1.839 Test Acc: 0.917
Validation loss decreased (-0.823309 --> -0.916648).  Saving model ...
Epoch: 5 cost time: 0.8158273696899414
Epoch: 5, Steps: 18 | Train Loss: 1.398 Vali Loss: 1.108 Vali Acc: 0.937 Test Loss: 1.108 Test Acc: 0.937
Validation loss decreased (-0.916648 --> -0.936656).  Saving model ...
Epoch: 6 cost time: 0.6168951988220215
Epoch: 6, Steps: 18 | Train Loss: 0.692 Vali Loss: 0.553 Vali Acc: 0.967 Test Loss: 0.553 Test Acc: 0.967
Validation loss decreased (-0.936656 --> -0.966661).  Saving model ...
Epoch: 7 cost time: 0.6417715549468994
Epoch: 7, Steps: 18 | Train Loss: 0.294 Vali Loss: 0.317 Vali Acc: 0.967 Test Loss: 0.317 Test Acc: 0.967
Validation loss decreased (-0.966661 --> -0.966664).  Saving model ...
Epoch: 8 cost time: 0.6195731163024902
Epoch: 8, Steps: 18 | Train Loss: 0.144 Vali Loss: 0.221 Vali Acc: 0.967 Test Loss: 0.221 Test Acc: 0.967
Validation loss decreased (-0.966664 --> -0.966664).  Saving model ...
Epoch: 9 cost time: 0.6113669872283936
Epoch: 9, Steps: 18 | Train Loss: 0.084 Vali Loss: 0.184 Vali Acc: 0.973 Test Loss: 0.184 Test Acc: 0.973
Validation loss decreased (-0.966664 --> -0.973331).  Saving model ...
Epoch: 10 cost time: 0.6594102382659912
Epoch: 10, Steps: 18 | Train Loss: 0.054 Vali Loss: 0.162 Vali Acc: 0.973 Test Loss: 0.162 Test Acc: 0.973
Validation loss decreased (-0.973331 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 0.6175243854522705
Epoch: 11, Steps: 18 | Train Loss: 0.038 Vali Loss: 0.145 Vali Acc: 0.973 Test Loss: 0.145 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 12 cost time: 0.6838295459747314
Epoch: 12, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.136 Vali Acc: 0.973 Test Loss: 0.136 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 13 cost time: 0.8155736923217773
Epoch: 13, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.130 Vali Acc: 0.973 Test Loss: 0.130 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 14 cost time: 0.7459330558776855
Epoch: 14, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.122 Vali Acc: 0.977 Test Loss: 0.122 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 15 cost time: 0.8570139408111572
Epoch: 15, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 16 cost time: 0.8426952362060547
Epoch: 16, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7571206092834473
Epoch: 17, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7974238395690918
Epoch: 18, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.8302891254425049
Epoch: 19, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.7278316020965576
Epoch: 20, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.8442347049713135
Epoch: 21, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.8192286491394043
Epoch: 22, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.7592601776123047
Epoch: 23, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.779435396194458
Epoch: 24, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.752988338470459
Epoch: 25, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps36_str18_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 190009
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.589294672012329
Epoch: 1, Steps: 18 | Train Loss: 1.778 Vali Loss: 0.270 Vali Acc: 0.923 Test Loss: 0.270 Test Acc: 0.923
Validation loss decreased (inf --> -0.923331).  Saving model ...
Epoch: 2 cost time: 1.5530812740325928
Epoch: 2, Steps: 18 | Train Loss: 0.069 Vali Loss: 0.499 Vali Acc: 0.897 Test Loss: 0.499 Test Acc: 0.897
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6026172637939453
Epoch: 3, Steps: 18 | Train Loss: 0.125 Vali Loss: 0.548 Vali Acc: 0.890 Test Loss: 0.548 Test Acc: 0.890
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5916173458099365
Epoch: 4, Steps: 18 | Train Loss: 0.048 Vali Loss: 0.428 Vali Acc: 0.913 Test Loss: 0.428 Test Acc: 0.913
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.5771663188934326
Epoch: 5, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.828 Vali Acc: 0.887 Test Loss: 0.828 Test Acc: 0.887
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.3743925094604492
Epoch: 6, Steps: 18 | Train Loss: 0.094 Vali Loss: 0.857 Vali Acc: 0.887 Test Loss: 0.857 Test Acc: 0.887
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.4296302795410156
Epoch: 7, Steps: 18 | Train Loss: 0.067 Vali Loss: 0.795 Vali Acc: 0.893 Test Loss: 0.795 Test Acc: 0.893
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.6014690399169922
Epoch: 8, Steps: 18 | Train Loss: 0.044 Vali Loss: 0.651 Vali Acc: 0.913 Test Loss: 0.651 Test Acc: 0.913
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.5760748386383057
Epoch: 9, Steps: 18 | Train Loss: 0.238 Vali Loss: 1.018 Vali Acc: 0.897 Test Loss: 1.018 Test Acc: 0.897
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.5920836925506592
Epoch: 10, Steps: 18 | Train Loss: 0.315 Vali Loss: 2.539 Vali Acc: 0.790 Test Loss: 2.539 Test Acc: 0.790
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.5922560691833496
Epoch: 11, Steps: 18 | Train Loss: 0.340 Vali Loss: 1.250 Vali Acc: 0.907 Test Loss: 1.250 Test Acc: 0.907
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9233333333333333
model parameter : 5430553
model size : 20.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.8976216316223145
Epoch: 1, Steps: 18 | Train Loss: 2.062 Vali Loss: 0.464 Vali Acc: 0.903 Test Loss: 0.464 Test Acc: 0.903
Validation loss decreased (inf --> -0.903329).  Saving model ...
Epoch: 2 cost time: 0.9935855865478516
Epoch: 2, Steps: 18 | Train Loss: 0.086 Vali Loss: 0.171 Vali Acc: 0.960 Test Loss: 0.171 Test Acc: 0.960
Validation loss decreased (-0.903329 --> -0.959998).  Saving model ...
Epoch: 3 cost time: 0.9714219570159912
Epoch: 3, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.166 Vali Acc: 0.953 Test Loss: 0.166 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.093935251235962
Epoch: 4, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.169 Vali Acc: 0.943 Test Loss: 0.169 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.1090240478515625
Epoch: 5, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.959998 --> -0.976666).  Saving model ...
Epoch: 6 cost time: 1.06056809425354
Epoch: 6, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.142 Vali Acc: 0.967 Test Loss: 0.142 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1140942573547363
Epoch: 7, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.280 Vali Acc: 0.933 Test Loss: 0.280 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.080066442489624
Epoch: 8, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.292 Vali Acc: 0.927 Test Loss: 0.292 Test Acc: 0.927
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.0496819019317627
Epoch: 9, Steps: 18 | Train Loss: 0.069 Vali Loss: 0.544 Vali Acc: 0.887 Test Loss: 0.544 Test Acc: 0.887
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.0454394817352295
Epoch: 10, Steps: 18 | Train Loss: 0.072 Vali Loss: 0.355 Vali Acc: 0.937 Test Loss: 0.355 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.0742034912109375
Epoch: 11, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.561 Vali Acc: 0.927 Test Loss: 0.561 Test Acc: 0.927
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.1272273063659668
Epoch: 12, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.603 Vali Acc: 0.917 Test Loss: 0.603 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.0051932334899902
Epoch: 13, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.350 Vali Acc: 0.943 Test Loss: 0.350 Test Acc: 0.943
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.9091477394104004
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.477 Vali Acc: 0.930 Test Loss: 0.477 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.004915475845337
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.489 Vali Acc: 0.933 Test Loss: 0.489 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 3357977
model size : 12.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.039010524749756
Epoch: 1, Steps: 18 | Train Loss: 2.256 Vali Loss: 0.695 Vali Acc: 0.937 Test Loss: 0.695 Test Acc: 0.937
Validation loss decreased (inf --> -0.936660).  Saving model ...
Epoch: 2 cost time: 1.0231754779815674
Epoch: 2, Steps: 18 | Train Loss: 0.095 Vali Loss: 0.144 Vali Acc: 0.960 Test Loss: 0.144 Test Acc: 0.960
Validation loss decreased (-0.936660 --> -0.959999).  Saving model ...
Epoch: 3 cost time: 1.0392003059387207
Epoch: 3, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.118 Vali Acc: 0.970 Test Loss: 0.118 Test Acc: 0.970
Validation loss decreased (-0.959999 --> -0.969999).  Saving model ...
Epoch: 4 cost time: 1.0650296211242676
Epoch: 4, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.114 Vali Acc: 0.970 Test Loss: 0.114 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 5 cost time: 1.0124332904815674
Epoch: 5, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.969999 --> -0.979999).  Saving model ...
Epoch: 6 cost time: 1.128941535949707
Epoch: 6, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9217665195465088
Epoch: 7, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7615785598754883
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.8944053649902344
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 1.0306825637817383
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0427639484405518
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 1.0078997611999512
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983333).  Saving model ...
Epoch: 13 cost time: 1.0224251747131348
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 14 cost time: 1.0130784511566162
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 15 cost time: 1.0157628059387207
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 16 cost time: 1.050400972366333
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0265772342681885
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0610547065734863
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.9587798118591309
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.0085136890411377
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.696772575378418
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 22 cost time: 0.9362959861755371
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 23 cost time: 1.051985263824463
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 24 cost time: 1.0661964416503906
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 25 cost time: 1.0678091049194336
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 26 cost time: 1.0528287887573242
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.019949197769165
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 28 cost time: 1.0589361190795898
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9921114444732666
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.987 Test Loss: 0.080 Test Acc: 0.987
Validation loss decreased (-0.983333 --> -0.986666).  Saving model ...
Epoch: 30 cost time: 1.0363554954528809
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.987 Test Loss: 0.080 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 31 cost time: 1.0406622886657715
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.987 Test Loss: 0.080 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.9864218235015869
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.987 Test Loss: 0.080 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 33 cost time: 0.9774606227874756
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.987 Test Loss: 0.080 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 34 cost time: 0.7508208751678467
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.987 Test Loss: 0.080 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 35 cost time: 0.8310291767120361
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.987 Test Loss: 0.079 Test Acc: 0.987
Validation loss decreased (-0.986666 --> -0.986666).  Saving model ...
Epoch: 36 cost time: 0.9809055328369141
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.987 Test Loss: 0.080 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.9338235855102539
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.987 Test Loss: 0.080 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.9366416931152344
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.987 Test Loss: 0.080 Test Acc: 0.987
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.0307600498199463
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.987 Test Loss: 0.080 Test Acc: 0.987
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.0495648384094238
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.987 Test Loss: 0.080 Test Acc: 0.987
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.990159273147583
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.987 Test Loss: 0.080 Test Acc: 0.987
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.9878106117248535
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.987 Test Loss: 0.080 Test Acc: 0.987
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.0023574829101562
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.987 Test Loss: 0.080 Test Acc: 0.987
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.0509920120239258
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.987 Test Loss: 0.080 Test Acc: 0.987
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 1.0381567478179932
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.987 Test Loss: 0.080 Test Acc: 0.987
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9866666666666667
model parameter : 2667545
model size : 10.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.0942695140838623
Epoch: 1, Steps: 18 | Train Loss: 2.400 Vali Loss: 0.987 Vali Acc: 0.920 Test Loss: 0.987 Test Acc: 0.920
Validation loss decreased (inf --> -0.919990).  Saving model ...
Epoch: 2 cost time: 1.0131676197052002
Epoch: 2, Steps: 18 | Train Loss: 0.172 Vali Loss: 0.169 Vali Acc: 0.950 Test Loss: 0.169 Test Acc: 0.950
Validation loss decreased (-0.919990 --> -0.949998).  Saving model ...
Epoch: 3 cost time: 0.9734630584716797
Epoch: 3, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
Validation loss decreased (-0.949998 --> -0.973332).  Saving model ...
Epoch: 4 cost time: 1.0327188968658447
Epoch: 4, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 5 cost time: 0.9499132633209229
Epoch: 5, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0014913082122803
Epoch: 6, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 7 cost time: 1.0008659362792969
Epoch: 7, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 0.9773352146148682
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 0.9468402862548828
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 0.8364818096160889
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 0.7538683414459229
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 1.052781581878662
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 1.044006586074829
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 1.0136244297027588
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 0.9258995056152344
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 1.0573925971984863
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 0.9958815574645996
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 1.015103816986084
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 1.0385510921478271
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9551582336425781
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 0.9929683208465576
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 0.8617324829101562
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9008822441101074
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.6672792434692383
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.9737918376922607
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 0.979902982711792
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 0.9362704753875732
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 1.0123469829559326
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 1.0381004810333252
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9953594207763672
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.0173718929290771
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.0353400707244873
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.9718446731567383
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.0039739608764648
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.8755502700805664
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 36 cost time: 0.8195385932922363
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.8301410675048828
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.9916002750396729
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 39 cost time: 0.9516675472259521
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 40 cost time: 1.0059442520141602
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 41 cost time: 0.9690055847167969
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.0387718677520752
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.017230749130249
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 44 cost time: 1.014204978942871
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 45 cost time: 0.9296650886535645
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.8988916873931885
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.9211046695709229
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.8316183090209961
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.7987308502197266
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.6175918579101562
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 2322969
model size : 8.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps22_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.8299593925476074
Epoch: 1, Steps: 18 | Train Loss: 2.595 Vali Loss: 1.350 Vali Acc: 0.927 Test Loss: 1.350 Test Acc: 0.927
Validation loss decreased (inf --> -0.926653).  Saving model ...
Epoch: 2 cost time: 0.9807522296905518
Epoch: 2, Steps: 18 | Train Loss: 0.309 Vali Loss: 0.223 Vali Acc: 0.940 Test Loss: 0.223 Test Acc: 0.940
Validation loss decreased (-0.926653 --> -0.939998).  Saving model ...
Epoch: 3 cost time: 1.0018198490142822
Epoch: 3, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
Validation loss decreased (-0.939998 --> -0.979999).  Saving model ...
Epoch: 4 cost time: 0.9743173122406006
Epoch: 4, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9970948696136475
Epoch: 5, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8978660106658936
Epoch: 6, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9484524726867676
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 1.0387463569641113
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 1.0279324054718018
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9669802188873291
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9305367469787598
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 0.995018720626831
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 0.9989750385284424
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 0.9774739742279053
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 1.0468566417694092
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0465736389160156
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 1.0085909366607666
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0090391635894775
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.887984037399292
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 0.925621747970581
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 0.9628443717956543
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 0.9974973201751709
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 0.9856491088867188
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0177133083343506
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.0302186012268066
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.9493248462677002
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.9980878829956055
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.9302878379821777
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.9746091365814209
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.9347174167633057
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 31 cost time: 0.9908432960510254
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 32 cost time: 0.9424149990081787
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.9122922420501709
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.8032357692718506
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.0760130882263184
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 36 cost time: 1.0297672748565674
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.9594123363494873
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.0101356506347656
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.016446828842163
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.0310115814208984
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.9986650943756104
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.9884274005889893
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.0361826419830322
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.0265274047851562
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.9192664623260498
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps22_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 2036761
model size : 7.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps29_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.830744981765747
Epoch: 1, Steps: 18 | Train Loss: 2.802 Vali Loss: 1.772 Vali Acc: 0.893 Test Loss: 1.772 Test Acc: 0.893
Validation loss decreased (inf --> -0.893316).  Saving model ...
Epoch: 2 cost time: 0.9197335243225098
Epoch: 2, Steps: 18 | Train Loss: 0.620 Vali Loss: 0.297 Vali Acc: 0.960 Test Loss: 0.297 Test Acc: 0.960
Validation loss decreased (-0.893316 --> -0.959997).  Saving model ...
Epoch: 3 cost time: 1.029843807220459
Epoch: 3, Steps: 18 | Train Loss: 0.061 Vali Loss: 0.124 Vali Acc: 0.973 Test Loss: 0.124 Test Acc: 0.973
Validation loss decreased (-0.959997 --> -0.973332).  Saving model ...
Epoch: 4 cost time: 0.9338560104370117
Epoch: 4, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9748120307922363
Epoch: 5, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.098 Vali Acc: 0.983 Test Loss: 0.098 Test Acc: 0.983
Validation loss decreased (-0.973332 --> -0.983332).  Saving model ...
Epoch: 6 cost time: 1.0210168361663818
Epoch: 6, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.093 Vali Acc: 0.983 Test Loss: 0.093 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 7 cost time: 0.987295389175415
Epoch: 7, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.983 Test Loss: 0.090 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 8 cost time: 0.9392626285552979
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 9 cost time: 0.8850870132446289
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8242104053497314
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7619640827178955
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.7723541259765625
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 13 cost time: 0.7103075981140137
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 14 cost time: 0.771190881729126
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 15 cost time: 0.7464957237243652
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 16 cost time: 0.6842978000640869
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983333).  Saving model ...
Epoch: 17 cost time: 0.7840650081634521
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 18 cost time: 0.899935245513916
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 19 cost time: 0.9362385272979736
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 20 cost time: 0.9433102607727051
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 21 cost time: 0.970435380935669
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0127131938934326
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0054118633270264
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 24 cost time: 0.96195387840271
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 25 cost time: 0.962244987487793
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8772282600402832
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.7761759757995605
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.743023157119751
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 29 cost time: 0.7260189056396484
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 30 cost time: 0.8779964447021484
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8232877254486084
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.9428262710571289
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.910510778427124
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.9634816646575928
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 35 cost time: 0.9562532901763916
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 36 cost time: 0.9882967472076416
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 37 cost time: 0.9716379642486572
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.931602954864502
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.9168517589569092
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 40 cost time: 0.9388437271118164
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.9708843231201172
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.9887409210205078
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.9385106563568115
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.9452416896820068
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.9757001399993896
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.91011643409729
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.8990755081176758
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 0.8998889923095703
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 0.9568283557891846
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps29_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 1808153
model size : 6.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps36_str18_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.8545136451721191
Epoch: 1, Steps: 18 | Train Loss: 2.776 Vali Loss: 1.828 Vali Acc: 0.897 Test Loss: 1.828 Test Acc: 0.897
Validation loss decreased (inf --> -0.896648).  Saving model ...
Epoch: 2 cost time: 0.8570623397827148
Epoch: 2, Steps: 18 | Train Loss: 0.701 Vali Loss: 0.340 Vali Acc: 0.963 Test Loss: 0.340 Test Acc: 0.963
Validation loss decreased (-0.896648 --> -0.963330).  Saving model ...
Epoch: 3 cost time: 0.9039516448974609
Epoch: 3, Steps: 18 | Train Loss: 0.083 Vali Loss: 0.123 Vali Acc: 0.967 Test Loss: 0.123 Test Acc: 0.967
Validation loss decreased (-0.963330 --> -0.966665).  Saving model ...
Epoch: 4 cost time: 0.9093530178070068
Epoch: 4, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.966665 --> -0.979999).  Saving model ...
Epoch: 5 cost time: 0.9418785572052002
Epoch: 5, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9108176231384277
Epoch: 6, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 7 cost time: 0.9743838310241699
Epoch: 7, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 0.8666470050811768
Epoch: 8, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 0.9383821487426758
Epoch: 9, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 1.0002388954162598
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9687135219573975
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 0.9460952281951904
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 0.9571535587310791
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 0.9572286605834961
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 0.9176127910614014
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 0.921511173248291
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 0.9622015953063965
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 0.8963198661804199
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9418067932128906
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 0.9793679714202881
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 0.8911547660827637
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9140944480895996
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 0.9729549884796143
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 0.9790999889373779
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 0.9661026000976562
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 0.9284300804138184
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9950637817382812
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.9808022975921631
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 0.9254391193389893
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 0.9640765190124512
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 31 cost time: 0.9319548606872559
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 32 cost time: 0.8659341335296631
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 33 cost time: 0.7981202602386475
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 34 cost time: 0.7210886478424072
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 35 cost time: 0.900273323059082
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 36 cost time: 0.9376540184020996
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 37 cost time: 0.9873483180999756
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 38 cost time: 0.9561753273010254
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.9436390399932861
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.9327616691589355
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.9784634113311768
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.9550471305847168
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.010204792022705
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.856553316116333
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.860191822052002
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.9383275508880615
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.9788920879364014
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps36_str18_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 1752345
model size : 6.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.9864423274993896
Epoch: 1, Steps: 18 | Train Loss: 1.974 Vali Loss: 0.411 Vali Acc: 0.927 Test Loss: 0.411 Test Acc: 0.927
Validation loss decreased (inf --> -0.926663).  Saving model ...
Epoch: 2 cost time: 0.8143918514251709
Epoch: 2, Steps: 18 | Train Loss: 0.083 Vali Loss: 0.221 Vali Acc: 0.940 Test Loss: 0.221 Test Acc: 0.940
Validation loss decreased (-0.926663 --> -0.939998).  Saving model ...
Epoch: 3 cost time: 0.7196075916290283
Epoch: 3, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.128 Vali Acc: 0.967 Test Loss: 0.128 Test Acc: 0.967
Validation loss decreased (-0.939998 --> -0.966665).  Saving model ...
Epoch: 4 cost time: 0.6937606334686279
Epoch: 4, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.144 Vali Acc: 0.967 Test Loss: 0.144 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7598793506622314
Epoch: 5, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.144 Vali Acc: 0.960 Test Loss: 0.144 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.856473445892334
Epoch: 6, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.123 Vali Acc: 0.973 Test Loss: 0.123 Test Acc: 0.973
Validation loss decreased (-0.966665 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 0.8235957622528076
Epoch: 7, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.127 Vali Acc: 0.970 Test Loss: 0.127 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8429007530212402
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.128 Vali Acc: 0.970 Test Loss: 0.128 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8383646011352539
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.124 Vali Acc: 0.973 Test Loss: 0.124 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8834729194641113
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.122 Vali Acc: 0.973 Test Loss: 0.122 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 0.8582048416137695
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.973 Test Loss: 0.120 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 12 cost time: 0.7815914154052734
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 13 cost time: 0.7637500762939453
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 14 cost time: 0.8504390716552734
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.973 Test Loss: 0.118 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 15 cost time: 0.8590748310089111
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 16 cost time: 0.7255809307098389
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 0.7474732398986816
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 0.8299033641815186
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 0.8633348941802979
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8726646900177002
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 0.8448739051818848
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 0.8589732646942139
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 0.8537492752075195
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.980 Test Loss: 0.115 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 0.8572916984558105
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9559805393218994
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.8649494647979736
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.8661916255950928
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.8006680011749268
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.614938497543335
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.6809430122375488
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.8987369537353516
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.8981845378875732
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.8442659378051758
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 2420377
model size : 9.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.589317798614502
Epoch: 1, Steps: 18 | Train Loss: 2.416 Vali Loss: 1.017 Vali Acc: 0.937 Test Loss: 1.017 Test Acc: 0.937
Validation loss decreased (inf --> -0.936656).  Saving model ...
Epoch: 2 cost time: 0.7166042327880859
Epoch: 2, Steps: 18 | Train Loss: 0.182 Vali Loss: 0.158 Vali Acc: 0.963 Test Loss: 0.158 Test Acc: 0.963
Validation loss decreased (-0.936656 --> -0.963332).  Saving model ...
Epoch: 3 cost time: 0.6857247352600098
Epoch: 3, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.122 Vali Acc: 0.963 Test Loss: 0.122 Test Acc: 0.963
Validation loss decreased (-0.963332 --> -0.963332).  Saving model ...
Epoch: 4 cost time: 0.6897027492523193
Epoch: 4, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
Validation loss decreased (-0.963332 --> -0.973332).  Saving model ...
Epoch: 5 cost time: 0.7219688892364502
Epoch: 5, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 6 cost time: 0.7297172546386719
Epoch: 6, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 0.6930603981018066
Epoch: 7, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 0.7026715278625488
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 0.7008552551269531
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 0.7104442119598389
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 0.778911828994751
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7545876502990723
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 13 cost time: 0.781151533126831
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973333).  Saving model ...
Epoch: 14 cost time: 0.7487196922302246
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
Validation loss decreased (-0.973333 --> -0.973333).  Saving model ...
Epoch: 15 cost time: 0.7732179164886475
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
Validation loss decreased (-0.973333 --> -0.973333).  Saving model ...
Epoch: 16 cost time: 0.5045003890991211
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
Validation loss decreased (-0.973333 --> -0.973333).  Saving model ...
Epoch: 17 cost time: 0.6820704936981201
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
Validation loss decreased (-0.973333 --> -0.973333).  Saving model ...
Epoch: 18 cost time: 0.6097536087036133
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7537283897399902
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7665822505950928
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.6918330192565918
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.7755610942840576
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.7757370471954346
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.6994447708129883
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.7232160568237305
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.7416954040527344
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
Validation loss decreased (-0.973333 --> -0.973333).  Saving model ...
Epoch: 27 cost time: 0.7358636856079102
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
Validation loss decreased (-0.973333 --> -0.973333).  Saving model ...
Epoch: 28 cost time: 0.7605655193328857
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.973 Test Loss: 0.081 Test Acc: 0.973
Validation loss decreased (-0.973333 --> -0.973333).  Saving model ...
Epoch: 29 cost time: 0.7210724353790283
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.973 Test Loss: 0.081 Test Acc: 0.973
Validation loss decreased (-0.973333 --> -0.973333).  Saving model ...
Epoch: 30 cost time: 0.5815770626068115
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.973 Test Loss: 0.081 Test Acc: 0.973
Validation loss decreased (-0.973333 --> -0.973333).  Saving model ...
Epoch: 31 cost time: 0.6453084945678711
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.973 Test Loss: 0.081 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.633441686630249
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.973 Test Loss: 0.081 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.6877896785736084
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.973333 --> -0.976666).  Saving model ...
Epoch: 34 cost time: 0.7273569107055664
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 35 cost time: 0.7529118061065674
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 36 cost time: 0.7728219032287598
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 37 cost time: 0.7575976848602295
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 38 cost time: 0.8105490207672119
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.7572951316833496
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.7698800563812256
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.8495728969573975
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.7670774459838867
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.7559468746185303
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.5587773323059082
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.6737112998962402
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.7206597328186035
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 47 cost time: 0.7365014553070068
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.7595455646514893
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.7144064903259277
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.7254025936126709
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.973 Test Loss: 0.080 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 1384089
model size : 5.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.8554844856262207
Epoch: 1, Steps: 18 | Train Loss: 2.678 Vali Loss: 1.520 Vali Acc: 0.933 Test Loss: 1.520 Test Acc: 0.933
Validation loss decreased (inf --> -0.933318).  Saving model ...
Epoch: 2 cost time: 0.6982629299163818
Epoch: 2, Steps: 18 | Train Loss: 0.385 Vali Loss: 0.211 Vali Acc: 0.970 Test Loss: 0.211 Test Acc: 0.970
Validation loss decreased (-0.933318 --> -0.969998).  Saving model ...
Epoch: 3 cost time: 0.6968522071838379
Epoch: 3, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.118 Vali Acc: 0.973 Test Loss: 0.118 Test Acc: 0.973
Validation loss decreased (-0.969998 --> -0.973332).  Saving model ...
Epoch: 4 cost time: 0.6953470706939697
Epoch: 4, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.114 Vali Acc: 0.970 Test Loss: 0.114 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7990505695343018
Epoch: 5, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 6 cost time: 0.8046083450317383
Epoch: 6, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 0.7709696292877197
Epoch: 7, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 0.8095197677612305
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 0.8424367904663086
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 0.7541358470916748
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 0.8327131271362305
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 12 cost time: 0.8245844841003418
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7701213359832764
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 14 cost time: 0.7897861003875732
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 15 cost time: 0.7170600891113281
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 16 cost time: 0.7200713157653809
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 17 cost time: 0.6726517677307129
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 18 cost time: 0.70658278465271
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8182277679443359
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8152363300323486
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973333).  Saving model ...
Epoch: 21 cost time: 0.8159687519073486
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.973333 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 0.7655544281005859
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8052637577056885
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 0.8225991725921631
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 0.8041326999664307
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 0.8005621433258057
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 0.8179256916046143
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7908451557159424
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 0.7006387710571289
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 0.6864337921142578
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.6851952075958252
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 32 cost time: 0.687476634979248
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 33 cost time: 0.7315680980682373
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 34 cost time: 0.7535600662231445
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 35 cost time: 0.6891696453094482
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 36 cost time: 0.6402633190155029
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 37 cost time: 0.7029030323028564
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 38 cost time: 0.7629203796386719
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 39 cost time: 0.8119614124298096
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 40 cost time: 0.7592031955718994
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 41 cost time: 0.778111457824707
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 42 cost time: 0.697091817855835
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.6108977794647217
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.6738250255584717
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.7635424137115479
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 46 cost time: 0.7802734375
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.7713329792022705
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.844184398651123
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.767737627029419
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.7851910591125488
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 1038873
model size : 4.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.6508305072784424
Epoch: 1, Steps: 18 | Train Loss: 2.775 Vali Loss: 1.880 Vali Acc: 0.903 Test Loss: 1.880 Test Acc: 0.903
Validation loss decreased (inf --> -0.903315).  Saving model ...
Epoch: 2 cost time: 0.7954213619232178
Epoch: 2, Steps: 18 | Train Loss: 0.605 Vali Loss: 0.303 Vali Acc: 0.970 Test Loss: 0.303 Test Acc: 0.970
Validation loss decreased (-0.903315 --> -0.969997).  Saving model ...
Epoch: 3 cost time: 0.8018558025360107
Epoch: 3, Steps: 18 | Train Loss: 0.054 Vali Loss: 0.144 Vali Acc: 0.970 Test Loss: 0.144 Test Acc: 0.970
Validation loss decreased (-0.969997 --> -0.969999).  Saving model ...
Epoch: 4 cost time: 0.7294878959655762
Epoch: 4, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.125 Vali Acc: 0.973 Test Loss: 0.125 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 5 cost time: 0.7849297523498535
Epoch: 5, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 6 cost time: 0.7892491817474365
Epoch: 6, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 7 cost time: 0.7308802604675293
Epoch: 7, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 8 cost time: 0.7694110870361328
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7860202789306641
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 0.7193021774291992
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 0.7565984725952148
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 0.7988109588623047
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 0.6262543201446533
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 0.6823804378509521
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5492362976074219
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 0.7650988101959229
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 0.7019226551055908
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 0.7217955589294434
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8137590885162354
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 0.6914064884185791
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 0.7755646705627441
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 0.7293837070465088
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 0.8199465274810791
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 0.7399251461029053
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 0.7213113307952881
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 0.7141435146331787
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5902938842773438
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.6844532489776611
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.7647643089294434
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.755502462387085
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 31 cost time: 0.7965819835662842
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 32 cost time: 0.7938899993896484
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.7482044696807861
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.7679955959320068
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.7577269077301025
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 36 cost time: 0.7458596229553223
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 37 cost time: 0.7608120441436768
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.8076660633087158
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 39 cost time: 0.673957109451294
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.7464292049407959
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.7131783962249756
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 42 cost time: 0.7874021530151367
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 43 cost time: 0.7477743625640869
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.7776830196380615
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 45 cost time: 0.7384300231933594
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 46 cost time: 0.742358922958374
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 47 cost time: 0.6727793216705322
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.7529866695404053
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.7476816177368164
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 50 cost time: 0.6711757183074951
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 866585
model size : 3.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps22_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.5575478076934814
Epoch: 1, Steps: 18 | Train Loss: 2.914 Vali Loss: 2.191 Vali Acc: 0.800 Test Loss: 2.191 Test Acc: 0.800
Validation loss decreased (inf --> -0.799978).  Saving model ...
Epoch: 2 cost time: 0.7624995708465576
Epoch: 2, Steps: 18 | Train Loss: 0.984 Vali Loss: 0.546 Vali Acc: 0.967 Test Loss: 0.546 Test Acc: 0.967
Validation loss decreased (-0.799978 --> -0.966661).  Saving model ...
Epoch: 3 cost time: 0.7462544441223145
Epoch: 3, Steps: 18 | Train Loss: 0.144 Vali Loss: 0.178 Vali Acc: 0.967 Test Loss: 0.178 Test Acc: 0.967
Validation loss decreased (-0.966661 --> -0.966665).  Saving model ...
Epoch: 4 cost time: 0.754784107208252
Epoch: 4, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.132 Vali Acc: 0.973 Test Loss: 0.132 Test Acc: 0.973
Validation loss decreased (-0.966665 --> -0.973332).  Saving model ...
Epoch: 5 cost time: 0.7686829566955566
Epoch: 5, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.113 Vali Acc: 0.980 Test Loss: 0.113 Test Acc: 0.980
Validation loss decreased (-0.973332 --> -0.979999).  Saving model ...
Epoch: 6 cost time: 0.7745261192321777
Epoch: 6, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6562371253967285
Epoch: 7, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 0.6465938091278076
Epoch: 8, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 0.6464405059814453
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 0.6950597763061523
Epoch: 10, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6585943698883057
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.617588996887207
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 0.5516741275787354
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 0.7245383262634277
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7881162166595459
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 0.7376928329467773
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 0.7827703952789307
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 0.8426220417022705
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 0.7517011165618896
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 0.8128619194030762
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 0.6698617935180664
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 0.7467780113220215
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 0.7227368354797363
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 0.6442146301269531
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6202187538146973
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.6264777183532715
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 0.7612967491149902
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 0.6070225238800049
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 0.7015917301177979
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 0.5787649154663086
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 31 cost time: 0.5637328624725342
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 32 cost time: 0.5599174499511719
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 33 cost time: 0.6372613906860352
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 34 cost time: 0.6283707618713379
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 35 cost time: 0.6525945663452148
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.7686553001403809
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.7020976543426514
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.7950484752655029
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 39 cost time: 0.8322293758392334
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 40 cost time: 0.7294461727142334
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 41 cost time: 0.6742310523986816
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 42 cost time: 0.7776904106140137
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 43 cost time: 0.7835075855255127
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.7968997955322266
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 45 cost time: 0.6799304485321045
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 46 cost time: 0.6328315734863281
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.6892929077148438
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.7701115608215332
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.8473019599914551
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.8056190013885498
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps22_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 723481
model size : 2.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps29_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.5620567798614502
Epoch: 1, Steps: 18 | Train Loss: 2.985 Vali Loss: 2.397 Vali Acc: 0.737 Test Loss: 2.397 Test Acc: 0.737
Validation loss decreased (inf --> -0.736643).  Saving model ...
Epoch: 2 cost time: 0.614548921585083
Epoch: 2, Steps: 18 | Train Loss: 1.359 Vali Loss: 0.818 Vali Acc: 0.953 Test Loss: 0.818 Test Acc: 0.953
Validation loss decreased (-0.736643 --> -0.953325).  Saving model ...
Epoch: 3 cost time: 0.5792465209960938
Epoch: 3, Steps: 18 | Train Loss: 0.313 Vali Loss: 0.274 Vali Acc: 0.967 Test Loss: 0.274 Test Acc: 0.967
Validation loss decreased (-0.953325 --> -0.966664).  Saving model ...
Epoch: 4 cost time: 0.6747152805328369
Epoch: 4, Steps: 18 | Train Loss: 0.065 Vali Loss: 0.159 Vali Acc: 0.973 Test Loss: 0.159 Test Acc: 0.973
Validation loss decreased (-0.966664 --> -0.973332).  Saving model ...
Epoch: 5 cost time: 0.6819107532501221
Epoch: 5, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.129 Vali Acc: 0.980 Test Loss: 0.129 Test Acc: 0.980
Validation loss decreased (-0.973332 --> -0.979999).  Saving model ...
Epoch: 6 cost time: 0.6437859535217285
Epoch: 6, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.120 Vali Acc: 0.977 Test Loss: 0.120 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6876018047332764
Epoch: 7, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7036693096160889
Epoch: 8, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.7526602745056152
Epoch: 9, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.7492854595184326
Epoch: 10, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.8136711120605469
Epoch: 11, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.7373027801513672
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.6391606330871582
Epoch: 13, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.6813037395477295
Epoch: 14, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.7028863430023193
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps29_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 609177
model size : 2.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps36_str18_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.6593070030212402
Epoch: 1, Steps: 18 | Train Loss: 3.029 Vali Loss: 2.475 Vali Acc: 0.650 Test Loss: 2.475 Test Acc: 0.650
Validation loss decreased (inf --> -0.649975).  Saving model ...
Epoch: 2 cost time: 0.7536766529083252
Epoch: 2, Steps: 18 | Train Loss: 1.525 Vali Loss: 0.949 Vali Acc: 0.947 Test Loss: 0.949 Test Acc: 0.947
Validation loss decreased (-0.649975 --> -0.946657).  Saving model ...
Epoch: 3 cost time: 0.7156021595001221
Epoch: 3, Steps: 18 | Train Loss: 0.405 Vali Loss: 0.308 Vali Acc: 0.963 Test Loss: 0.308 Test Acc: 0.963
Validation loss decreased (-0.946657 --> -0.963330).  Saving model ...
Epoch: 4 cost time: 0.6869184970855713
Epoch: 4, Steps: 18 | Train Loss: 0.091 Vali Loss: 0.171 Vali Acc: 0.970 Test Loss: 0.171 Test Acc: 0.970
Validation loss decreased (-0.963330 --> -0.969998).  Saving model ...
Epoch: 5 cost time: 0.6704025268554688
Epoch: 5, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.133 Vali Acc: 0.973 Test Loss: 0.133 Test Acc: 0.973
Validation loss decreased (-0.969998 --> -0.973332).  Saving model ...
Epoch: 6 cost time: 0.6167018413543701
Epoch: 6, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.124 Vali Acc: 0.973 Test Loss: 0.124 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 0.7037630081176758
Epoch: 7, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 8 cost time: 0.725210428237915
Epoch: 8, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 0.7158517837524414
Epoch: 9, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 0.7851846218109131
Epoch: 10, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.755993127822876
Epoch: 11, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 0.7313051223754883
Epoch: 12, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7491579055786133
Epoch: 13, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 0.7407219409942627
Epoch: 14, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 0.7483131885528564
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.983 Test Loss: 0.090 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 16 cost time: 0.7004618644714355
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7221202850341797
Epoch: 17, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.6236691474914551
Epoch: 18, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.6442506313323975
Epoch: 19, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.7019808292388916
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 21 cost time: 0.7397966384887695
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 22 cost time: 0.7523293495178223
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6896975040435791
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983333).  Saving model ...
Epoch: 24 cost time: 0.746779203414917
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.678093433380127
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.7490749359130859
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 27 cost time: 0.7053818702697754
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 28 cost time: 0.7522356510162354
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 29 cost time: 0.7449495792388916
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.7540769577026367
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.6407926082611084
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.727607011795044
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 33 cost time: 0.7341904640197754
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 34 cost time: 0.6876609325408936
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 35 cost time: 0.7070837020874023
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 36 cost time: 0.7842588424682617
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.778252363204956
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.7522118091583252
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.7116134166717529
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 40 cost time: 0.7459206581115723
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 41 cost time: 0.7328996658325195
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 42 cost time: 0.7502577304840088
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.6488568782806396
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 44 cost time: 0.6494362354278564
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 45 cost time: 0.7219901084899902
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 46 cost time: 0.7373025417327881
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 47 cost time: 0.700462818145752
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 48 cost time: 0.7169761657714844
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 49 cost time: 0.7880730628967285
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.8184554576873779
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps36_str18_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 581273
model size : 2.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.5306386947631836
Epoch: 1, Steps: 18 | Train Loss: 2.452 Vali Loss: 0.952 Vali Acc: 0.937 Test Loss: 0.952 Test Acc: 0.937
Validation loss decreased (inf --> -0.936657).  Saving model ...
Epoch: 2 cost time: 0.5789203643798828
Epoch: 2, Steps: 18 | Train Loss: 0.165 Vali Loss: 0.178 Vali Acc: 0.950 Test Loss: 0.178 Test Acc: 0.950
Validation loss decreased (-0.936657 --> -0.949998).  Saving model ...
Epoch: 3 cost time: 0.6611316204071045
Epoch: 3, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
Validation loss decreased (-0.949998 --> -0.973332).  Saving model ...
Epoch: 4 cost time: 0.6176695823669434
Epoch: 4, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6179757118225098
Epoch: 5, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 6 cost time: 0.6662981510162354
Epoch: 6, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 0.6341371536254883
Epoch: 7, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.973332 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 0.6182258129119873
Epoch: 8, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 0.6497800350189209
Epoch: 9, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 0.6689438819885254
Epoch: 10, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 0.5931084156036377
Epoch: 11, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 0.6275177001953125
Epoch: 12, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 0.45386791229248047
Epoch: 13, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 0.5330502986907959
Epoch: 14, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 0.5907561779022217
Epoch: 15, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 0.5101008415222168
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 0.6501750946044922
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 0.6266276836395264
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6167755126953125
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 0.5839090347290039
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 0.6568470001220703
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 0.6013524532318115
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6042153835296631
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.5902714729309082
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.5892350673675537
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.615957498550415
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 0.6487061977386475
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 0.5180268287658691
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 0.49443697929382324
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.5769779682159424
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 31 cost time: 0.5701115131378174
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 32 cost time: 0.650733232498169
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 33 cost time: 0.6308979988098145
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 34 cost time: 0.6013426780700684
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.6519787311553955
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 36 cost time: 0.6271646022796631
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.6149871349334717
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.632664680480957
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.6427700519561768
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.5476148128509521
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.652440071105957
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.47434449195861816
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.5740458965301514
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 44 cost time: 0.5833673477172852
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 45 cost time: 0.5958774089813232
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 46 cost time: 0.5869855880737305
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.6594140529632568
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.627605676651001
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.5783159732818604
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.5912075042724609
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 1136473
model size : 4.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.6368327140808105
Epoch: 1, Steps: 18 | Train Loss: 2.691 Vali Loss: 1.753 Vali Acc: 0.937 Test Loss: 1.753 Test Acc: 0.937
Validation loss decreased (inf --> -0.936649).  Saving model ...
Epoch: 2 cost time: 0.5773627758026123
Epoch: 2, Steps: 18 | Train Loss: 0.567 Vali Loss: 0.298 Vali Acc: 0.963 Test Loss: 0.298 Test Acc: 0.963
Validation loss decreased (-0.936649 --> -0.963330).  Saving model ...
Epoch: 3 cost time: 0.6026225090026855
Epoch: 3, Steps: 18 | Train Loss: 0.054 Vali Loss: 0.134 Vali Acc: 0.970 Test Loss: 0.134 Test Acc: 0.970
Validation loss decreased (-0.963330 --> -0.969999).  Saving model ...
Epoch: 4 cost time: 0.6247208118438721
Epoch: 4, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 5 cost time: 0.5905337333679199
Epoch: 5, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.969999 --> -0.979999).  Saving model ...
Epoch: 6 cost time: 0.6340551376342773
Epoch: 6, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6578569412231445
Epoch: 7, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.6729385852813721
Epoch: 8, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 0.5998177528381348
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 0.6511189937591553
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 0.6505279541015625
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.648169994354248
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 0.512976884841919
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 0.5732409954071045
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 0.6707801818847656
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6863987445831299
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 0.5815165042877197
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 0.6065146923065186
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 0.6323964595794678
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 0.6179068088531494
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 0.6753051280975342
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6751585006713867
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 0.6024751663208008
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 0.6350259780883789
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6762149333953857
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.5941181182861328
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.5530364513397217
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.6042323112487793
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.6225399971008301
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 0.6301376819610596
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 31 cost time: 0.643376350402832
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.6329641342163086
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 33 cost time: 0.6286485195159912
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 34 cost time: 0.6152291297912598
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 35 cost time: 0.6808366775512695
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 36 cost time: 0.643791913986206
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.6224234104156494
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.6242885589599609
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.6159329414367676
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.5324716567993164
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.5103006362915039
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.5824816226959229
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.6809108257293701
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.5657823085784912
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.6156954765319824
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 618329
model size : 2.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.6418321132659912
Epoch: 1, Steps: 18 | Train Loss: 2.951 Vali Loss: 2.295 Vali Acc: 0.827 Test Loss: 2.295 Test Acc: 0.827
Validation loss decreased (inf --> -0.826644).  Saving model ...
Epoch: 2 cost time: 0.5659630298614502
Epoch: 2, Steps: 18 | Train Loss: 1.103 Vali Loss: 0.638 Vali Acc: 0.960 Test Loss: 0.638 Test Acc: 0.960
Validation loss decreased (-0.826644 --> -0.959994).  Saving model ...
Epoch: 3 cost time: 0.5684080123901367
Epoch: 3, Steps: 18 | Train Loss: 0.181 Vali Loss: 0.223 Vali Acc: 0.960 Test Loss: 0.223 Test Acc: 0.960
Validation loss decreased (-0.959994 --> -0.959998).  Saving model ...
Epoch: 4 cost time: 0.6161901950836182
Epoch: 4, Steps: 18 | Train Loss: 0.040 Vali Loss: 0.141 Vali Acc: 0.967 Test Loss: 0.141 Test Acc: 0.967
Validation loss decreased (-0.959998 --> -0.966665).  Saving model ...
Epoch: 5 cost time: 0.5628702640533447
Epoch: 5, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.121 Vali Acc: 0.980 Test Loss: 0.121 Test Acc: 0.980
Validation loss decreased (-0.966665 --> -0.979999).  Saving model ...
Epoch: 6 cost time: 0.6111001968383789
Epoch: 6, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.107 Vali Acc: 0.983 Test Loss: 0.107 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 7 cost time: 0.6085684299468994
Epoch: 7, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.101 Vali Acc: 0.983 Test Loss: 0.101 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 8 cost time: 0.6060695648193359
Epoch: 8, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.099 Vali Acc: 0.983 Test Loss: 0.099 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 9 cost time: 0.6313602924346924
Epoch: 9, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.983 Test Loss: 0.096 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 10 cost time: 0.5895512104034424
Epoch: 10, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.983 Test Loss: 0.095 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 11 cost time: 0.6631784439086914
Epoch: 11, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.983 Test Loss: 0.093 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 12 cost time: 0.6509203910827637
Epoch: 12, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.983 Test Loss: 0.092 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 13 cost time: 0.5845999717712402
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.983 Test Loss: 0.092 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 14 cost time: 0.6324062347412109
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.983 Test Loss: 0.090 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 15 cost time: 0.6340060234069824
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 16 cost time: 0.486743688583374
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 17 cost time: 0.5999996662139893
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 18 cost time: 0.5948762893676758
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 19 cost time: 0.6387655735015869
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 20 cost time: 0.6424295902252197
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 21 cost time: 0.6637399196624756
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 22 cost time: 0.6020820140838623
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 23 cost time: 0.5989434719085693
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983333).  Saving model ...
Epoch: 24 cost time: 0.6126797199249268
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 25 cost time: 0.5667760372161865
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6237077713012695
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 27 cost time: 0.6028287410736084
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6882286071777344
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 29 cost time: 0.5634303092956543
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.5118288993835449
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 31 cost time: 0.5614368915557861
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 32 cost time: 0.5516805648803711
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 33 cost time: 0.5742864608764648
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 34 cost time: 0.6588995456695557
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 35 cost time: 0.5946085453033447
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 36 cost time: 0.6792447566986084
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 37 cost time: 0.5720839500427246
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 38 cost time: 0.5852344036102295
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 39 cost time: 0.5610902309417725
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 40 cost time: 0.6008176803588867
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 41 cost time: 0.6440863609313965
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 42 cost time: 0.6533041000366211
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 43 cost time: 0.6395995616912842
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 44 cost time: 0.5904595851898193
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 45 cost time: 0.5533304214477539
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 46 cost time: 0.6441457271575928
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 47 cost time: 0.5505039691925049
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 48 cost time: 0.5610411167144775
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.5433633327484131
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.983333 --> -0.983333).  Saving model ...
Epoch: 50 cost time: 0.4968082904815674
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 445721
model size : 1.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.3990931510925293
Epoch: 1, Steps: 18 | Train Loss: 3.029 Vali Loss: 2.526 Vali Acc: 0.653 Test Loss: 2.526 Test Acc: 0.653
Validation loss decreased (inf --> -0.653308).  Saving model ...
Epoch: 2 cost time: 0.5643258094787598
Epoch: 2, Steps: 18 | Train Loss: 1.441 Vali Loss: 0.959 Vali Acc: 0.957 Test Loss: 0.959 Test Acc: 0.957
Validation loss decreased (-0.653308 --> -0.956657).  Saving model ...
Epoch: 3 cost time: 0.5972673892974854
Epoch: 3, Steps: 18 | Train Loss: 0.344 Vali Loss: 0.298 Vali Acc: 0.957 Test Loss: 0.298 Test Acc: 0.957
Validation loss decreased (-0.956657 --> -0.956664).  Saving model ...
Epoch: 4 cost time: 0.5930626392364502
Epoch: 4, Steps: 18 | Train Loss: 0.074 Vali Loss: 0.175 Vali Acc: 0.967 Test Loss: 0.175 Test Acc: 0.967
Validation loss decreased (-0.956664 --> -0.966665).  Saving model ...
Epoch: 5 cost time: 0.668513298034668
Epoch: 5, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.135 Vali Acc: 0.977 Test Loss: 0.135 Test Acc: 0.977
Validation loss decreased (-0.966665 --> -0.976665).  Saving model ...
Epoch: 6 cost time: 0.6765992641448975
Epoch: 6, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.127 Vali Acc: 0.977 Test Loss: 0.127 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 7 cost time: 0.6201705932617188
Epoch: 7, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.119 Vali Acc: 0.980 Test Loss: 0.119 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 8 cost time: 0.5751409530639648
Epoch: 8, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 9 cost time: 0.5806484222412109
Epoch: 9, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.110 Vali Acc: 0.980 Test Loss: 0.110 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 0.5225570201873779
Epoch: 10, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 0.568500280380249
Epoch: 11, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 0.6090166568756104
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 0.6413094997406006
Epoch: 13, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 0.603919506072998
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 0.6853036880493164
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 0.5958058834075928
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 0.605278730392456
Epoch: 17, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 0.5795688629150391
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 0.6099839210510254
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 0.6093275547027588
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 0.6441802978515625
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 0.5964987277984619
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 0.5766723155975342
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 0.5669164657592773
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 0.57871413230896
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 0.5938212871551514
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 0.6454207897186279
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 0.6405019760131836
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 0.6054105758666992
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 0.5801362991333008
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 31 cost time: 0.6383461952209473
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 32 cost time: 0.6435339450836182
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 33 cost time: 0.5880169868469238
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 34 cost time: 0.6271045207977295
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 35 cost time: 0.6026763916015625
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 36 cost time: 0.5475318431854248
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 37 cost time: 0.6043319702148438
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 38 cost time: 0.5425238609313965
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.5500125885009766
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 40 cost time: 0.6090784072875977
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 41 cost time: 0.5732557773590088
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.6054878234863281
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 43 cost time: 0.6587848663330078
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 44 cost time: 0.6229970455169678
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 45 cost time: 0.670778751373291
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.6095316410064697
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.6212038993835449
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.6111586093902588
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.5917766094207764
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 50 cost time: 0.5741400718688965
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 359577
model size : 1.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps22_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.5419089794158936
Epoch: 1, Steps: 18 | Train Loss: 3.057 Vali Loss: 2.640 Vali Acc: 0.583 Test Loss: 2.640 Test Acc: 0.583
Validation loss decreased (inf --> -0.583307).  Saving model ...
Epoch: 2 cost time: 0.5764949321746826
Epoch: 2, Steps: 18 | Train Loss: 1.806 Vali Loss: 1.278 Vali Acc: 0.937 Test Loss: 1.278 Test Acc: 0.937
Validation loss decreased (-0.583307 --> -0.936654).  Saving model ...
Epoch: 3 cost time: 0.595405101776123
Epoch: 3, Steps: 18 | Train Loss: 0.621 Vali Loss: 0.449 Vali Acc: 0.970 Test Loss: 0.449 Test Acc: 0.970
Validation loss decreased (-0.936654 --> -0.969996).  Saving model ...
Epoch: 4 cost time: 0.6732897758483887
Epoch: 4, Steps: 18 | Train Loss: 0.161 Vali Loss: 0.205 Vali Acc: 0.977 Test Loss: 0.205 Test Acc: 0.977
Validation loss decreased (-0.969996 --> -0.976665).  Saving model ...
Epoch: 5 cost time: 0.6700222492218018
Epoch: 5, Steps: 18 | Train Loss: 0.058 Vali Loss: 0.160 Vali Acc: 0.973 Test Loss: 0.160 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5406014919281006
Epoch: 6, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.135 Vali Acc: 0.973 Test Loss: 0.135 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.619598388671875
Epoch: 7, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.126 Vali Acc: 0.973 Test Loss: 0.126 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.5190315246582031
Epoch: 8, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 0.5066351890563965
Epoch: 9, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 0.5986194610595703
Epoch: 10, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 0.6009137630462646
Epoch: 11, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 0.6234292984008789
Epoch: 12, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 13 cost time: 0.617377758026123
Epoch: 13, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 0.6334621906280518
Epoch: 14, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 0.6366381645202637
Epoch: 15, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 0.6169347763061523
Epoch: 16, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 0.5988020896911621
Epoch: 17, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 0.6032068729400635
Epoch: 18, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 0.63564133644104
Epoch: 19, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 0.5496625900268555
Epoch: 20, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 0.551293134689331
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 0.5828404426574707
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 0.5215609073638916
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 0.616790771484375
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 0.6569004058837891
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 0.6122524738311768
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 0.600916862487793
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 28 cost time: 0.5873174667358398
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 0.5980615615844727
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 30 cost time: 0.5490028858184814
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 31 cost time: 0.6069402694702148
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 32 cost time: 0.555203914642334
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.633746862411499
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.5710835456848145
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.5943396091461182
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 36 cost time: 0.5623960494995117
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 37 cost time: 0.5752341747283936
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 38 cost time: 0.721574068069458
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 39 cost time: 0.6620218753814697
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 40 cost time: 0.6347916126251221
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 41 cost time: 0.5930976867675781
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 42 cost time: 0.609630823135376
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.5853731632232666
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 44 cost time: 0.5847868919372559
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 45 cost time: 0.5641756057739258
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 46 cost time: 0.6150856018066406
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.5389788150787354
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.977 Test Loss: 0.076 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.540015697479248
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.5442421436309814
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 50 cost time: 0.5360977649688721
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.075 Vali Acc: 0.977 Test Loss: 0.075 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps22_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 288025
model size : 1.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps29_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.3796026706695557
Epoch: 1, Steps: 18 | Train Loss: 3.152 Vali Loss: 2.863 Vali Acc: 0.343 Test Loss: 2.863 Test Acc: 0.343
Validation loss decreased (inf --> -0.343305).  Saving model ...
Epoch: 2 cost time: 0.624762773513794
Epoch: 2, Steps: 18 | Train Loss: 2.181 Vali Loss: 1.786 Vali Acc: 0.847 Test Loss: 1.786 Test Acc: 0.847
Validation loss decreased (-0.343305 --> -0.846649).  Saving model ...
Epoch: 3 cost time: 0.5729289054870605
Epoch: 3, Steps: 18 | Train Loss: 1.066 Vali Loss: 0.840 Vali Acc: 0.953 Test Loss: 0.840 Test Acc: 0.953
Validation loss decreased (-0.846649 --> -0.953325).  Saving model ...
Epoch: 4 cost time: 0.5800540447235107
Epoch: 4, Steps: 18 | Train Loss: 0.404 Vali Loss: 0.399 Vali Acc: 0.963 Test Loss: 0.399 Test Acc: 0.963
Validation loss decreased (-0.953325 --> -0.963329).  Saving model ...
Epoch: 5 cost time: 0.5533277988433838
Epoch: 5, Steps: 18 | Train Loss: 0.139 Vali Loss: 0.253 Vali Acc: 0.970 Test Loss: 0.253 Test Acc: 0.970
Validation loss decreased (-0.963329 --> -0.969997).  Saving model ...
Epoch: 6 cost time: 0.5895662307739258
Epoch: 6, Steps: 18 | Train Loss: 0.063 Vali Loss: 0.192 Vali Acc: 0.970 Test Loss: 0.192 Test Acc: 0.970
Validation loss decreased (-0.969997 --> -0.969998).  Saving model ...
Epoch: 7 cost time: 0.5721383094787598
Epoch: 7, Steps: 18 | Train Loss: 0.036 Vali Loss: 0.171 Vali Acc: 0.973 Test Loss: 0.171 Test Acc: 0.973
Validation loss decreased (-0.969998 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 0.5550124645233154
Epoch: 8, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.155 Vali Acc: 0.973 Test Loss: 0.155 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 0.5203518867492676
Epoch: 9, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.142 Vali Acc: 0.973 Test Loss: 0.142 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 0.583784818649292
Epoch: 10, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.134 Vali Acc: 0.973 Test Loss: 0.134 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 0.5864691734313965
Epoch: 11, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.128 Vali Acc: 0.973 Test Loss: 0.128 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 12 cost time: 0.6126031875610352
Epoch: 12, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.126 Vali Acc: 0.973 Test Loss: 0.126 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 13 cost time: 0.6144146919250488
Epoch: 13, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 14 cost time: 0.590644359588623
Epoch: 14, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.118 Vali Acc: 0.973 Test Loss: 0.118 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 15 cost time: 0.5726234912872314
Epoch: 15, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 16 cost time: 0.5904743671417236
Epoch: 16, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 17 cost time: 0.5987412929534912
Epoch: 17, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 18 cost time: 0.5589609146118164
Epoch: 18, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 19 cost time: 0.589134931564331
Epoch: 19, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 20 cost time: 0.5731158256530762
Epoch: 20, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 21 cost time: 0.5819499492645264
Epoch: 21, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 22 cost time: 0.5248894691467285
Epoch: 22, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 23 cost time: 0.5793027877807617
Epoch: 23, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6221592426300049
Epoch: 24, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 25 cost time: 0.6139335632324219
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 26 cost time: 0.6479952335357666
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 27 cost time: 0.5846748352050781
Epoch: 27, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 28 cost time: 0.5801808834075928
Epoch: 28, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 29 cost time: 0.6229162216186523
Epoch: 29, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 30 cost time: 0.5671257972717285
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 31 cost time: 0.622725248336792
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 32 cost time: 0.5362362861633301
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 33 cost time: 0.5827188491821289
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.6670205593109131
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 35 cost time: 0.6000630855560303
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 36 cost time: 0.554826021194458
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.5382835865020752
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 38 cost time: 0.5695734024047852
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 39 cost time: 0.6661477088928223
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 40 cost time: 0.599419116973877
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 41 cost time: 0.6942765712738037
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 42 cost time: 0.5938725471496582
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 43 cost time: 0.6339321136474609
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.6209521293640137
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.6157886981964111
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.5610613822937012
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.5559492111206055
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.575098991394043
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 49 cost time: 0.5555257797241211
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 50 cost time: 0.5334470272064209
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps29_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 230873
model size : 0.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps36_str18_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.5538113117218018
Epoch: 1, Steps: 18 | Train Loss: 3.153 Vali Loss: 2.859 Vali Acc: 0.350 Test Loss: 2.859 Test Acc: 0.350
Validation loss decreased (inf --> -0.349971).  Saving model ...
Epoch: 2 cost time: 0.6049034595489502
Epoch: 2, Steps: 18 | Train Loss: 2.269 Vali Loss: 1.846 Vali Acc: 0.903 Test Loss: 1.846 Test Acc: 0.903
Validation loss decreased (-0.349971 --> -0.903315).  Saving model ...
Epoch: 3 cost time: 0.6255958080291748
Epoch: 3, Steps: 18 | Train Loss: 1.199 Vali Loss: 0.938 Vali Acc: 0.940 Test Loss: 0.938 Test Acc: 0.940
Validation loss decreased (-0.903315 --> -0.939991).  Saving model ...
Epoch: 4 cost time: 0.5454354286193848
Epoch: 4, Steps: 18 | Train Loss: 0.477 Vali Loss: 0.440 Vali Acc: 0.957 Test Loss: 0.440 Test Acc: 0.957
Validation loss decreased (-0.939991 --> -0.956662).  Saving model ...
Epoch: 5 cost time: 0.5711538791656494
Epoch: 5, Steps: 18 | Train Loss: 0.174 Vali Loss: 0.264 Vali Acc: 0.967 Test Loss: 0.264 Test Acc: 0.967
Validation loss decreased (-0.956662 --> -0.966664).  Saving model ...
Epoch: 6 cost time: 0.5908243656158447
Epoch: 6, Steps: 18 | Train Loss: 0.082 Vali Loss: 0.198 Vali Acc: 0.970 Test Loss: 0.198 Test Acc: 0.970
Validation loss decreased (-0.966664 --> -0.969998).  Saving model ...
Epoch: 7 cost time: 0.5569257736206055
Epoch: 7, Steps: 18 | Train Loss: 0.046 Vali Loss: 0.172 Vali Acc: 0.973 Test Loss: 0.172 Test Acc: 0.973
Validation loss decreased (-0.969998 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 0.506732702255249
Epoch: 8, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.152 Vali Acc: 0.977 Test Loss: 0.152 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 9 cost time: 0.5221836566925049
Epoch: 9, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.143 Vali Acc: 0.977 Test Loss: 0.143 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 10 cost time: 0.6003916263580322
Epoch: 10, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.131 Vali Acc: 0.977 Test Loss: 0.131 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 11 cost time: 0.6023383140563965
Epoch: 11, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.124 Vali Acc: 0.977 Test Loss: 0.124 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 12 cost time: 0.5437946319580078
Epoch: 12, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 13 cost time: 0.5774824619293213
Epoch: 13, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 14 cost time: 0.6105482578277588
Epoch: 14, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 0.6130518913269043
Epoch: 15, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 16 cost time: 0.6283605098724365
Epoch: 16, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 0.565504789352417
Epoch: 17, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 0.586810827255249
Epoch: 18, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 0.6254990100860596
Epoch: 19, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 0.5817134380340576
Epoch: 20, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 0.5355923175811768
Epoch: 21, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 0.5645954608917236
Epoch: 22, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 0.5328781604766846
Epoch: 23, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 0.6314570903778076
Epoch: 24, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 0.5554900169372559
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 0.5508155822753906
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 0.5632565021514893
Epoch: 27, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 28 cost time: 0.6167728900909424
Epoch: 28, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 0.612738847732544
Epoch: 29, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 30 cost time: 0.6463558673858643
Epoch: 30, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.6531245708465576
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 32 cost time: 0.5999476909637451
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 33 cost time: 0.550910234451294
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 34 cost time: 0.5644371509552002
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 35 cost time: 0.5778429508209229
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 36 cost time: 0.5855312347412109
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 37 cost time: 0.5551803112030029
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 38 cost time: 0.5425302982330322
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 39 cost time: 0.6014997959136963
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.62200927734375
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 41 cost time: 0.558394193649292
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 42 cost time: 0.6038470268249512
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 43 cost time: 0.5602757930755615
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.6712660789489746
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 45 cost time: 0.5903933048248291
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 46 cost time: 0.6466789245605469
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.5685265064239502
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 48 cost time: 0.6292366981506348
Epoch: 48, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 49 cost time: 0.530714750289917
Epoch: 49, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.5295288562774658
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps36_str18_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 216921
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.556016445159912
Epoch: 1, Steps: 18 | Train Loss: 2.782 Vali Loss: 1.792 Vali Acc: 0.903 Test Loss: 1.792 Test Acc: 0.903
Validation loss decreased (inf --> -0.903315).  Saving model ...
Epoch: 2 cost time: 0.5717172622680664
Epoch: 2, Steps: 18 | Train Loss: 0.609 Vali Loss: 0.317 Vali Acc: 0.963 Test Loss: 0.317 Test Acc: 0.963
Validation loss decreased (-0.903315 --> -0.963330).  Saving model ...
Epoch: 3 cost time: 0.5642521381378174
Epoch: 3, Steps: 18 | Train Loss: 0.065 Vali Loss: 0.143 Vali Acc: 0.967 Test Loss: 0.143 Test Acc: 0.967
Validation loss decreased (-0.963330 --> -0.966665).  Saving model ...
Epoch: 4 cost time: 0.6010487079620361
Epoch: 4, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.116 Vali Acc: 0.970 Test Loss: 0.116 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969999).  Saving model ...
Epoch: 5 cost time: 0.5421884059906006
Epoch: 5, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 6 cost time: 0.5339615345001221
Epoch: 6, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5087306499481201
Epoch: 7, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 0.5471389293670654
Epoch: 8, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 0.46004724502563477
Epoch: 9, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 0.5605552196502686
Epoch: 10, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 11 cost time: 0.5615105628967285
Epoch: 11, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 12 cost time: 0.5562710762023926
Epoch: 12, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5656485557556152
Epoch: 13, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.5593960285186768
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 15 cost time: 0.5476481914520264
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.538100004196167
Epoch: 16, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 17 cost time: 0.5340914726257324
Epoch: 17, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 18 cost time: 0.5751440525054932
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 0.5617649555206299
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 0.5384461879730225
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 0.5272176265716553
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 0.6166853904724121
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 0.6001460552215576
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 0.5937318801879883
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 0.7547259330749512
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 0.6263675689697266
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.6595485210418701
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.726905107498169
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 0.562391996383667
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.662710428237915
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.7068405151367188
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.7321362495422363
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.6352643966674805
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.6559510231018066
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.7262721061706543
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 36 cost time: 0.5816168785095215
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.5010385513305664
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.6325078010559082
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 39 cost time: 0.6075115203857422
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.656109094619751
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 41 cost time: 0.738551139831543
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.6654937267303467
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 43 cost time: 0.6318025588989258
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.6236426830291748
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.7716729640960693
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.5878233909606934
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.6745178699493408
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.7700197696685791
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.7250857353210449
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 50 cost time: 0.6774539947509766
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 549817
model size : 2.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.7652099132537842
Epoch: 1, Steps: 18 | Train Loss: 3.025 Vali Loss: 2.400 Vali Acc: 0.720 Test Loss: 2.400 Test Acc: 0.720
Validation loss decreased (inf --> -0.719976).  Saving model ...
Epoch: 2 cost time: 0.5971832275390625
Epoch: 2, Steps: 18 | Train Loss: 1.410 Vali Loss: 0.863 Vali Acc: 0.963 Test Loss: 0.863 Test Acc: 0.963
Validation loss decreased (-0.719976 --> -0.963325).  Saving model ...
Epoch: 3 cost time: 0.5653231143951416
Epoch: 3, Steps: 18 | Train Loss: 0.334 Vali Loss: 0.289 Vali Acc: 0.957 Test Loss: 0.289 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5273573398590088
Epoch: 4, Steps: 18 | Train Loss: 0.082 Vali Loss: 0.167 Vali Acc: 0.973 Test Loss: 0.167 Test Acc: 0.973
Validation loss decreased (-0.963325 --> -0.973332).  Saving model ...
Epoch: 5 cost time: 0.6732113361358643
Epoch: 5, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.140 Vali Acc: 0.973 Test Loss: 0.140 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 6 cost time: 0.6173989772796631
Epoch: 6, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.128 Vali Acc: 0.973 Test Loss: 0.128 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 7 cost time: 0.6210372447967529
Epoch: 7, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 8 cost time: 0.7142832279205322
Epoch: 8, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 9 cost time: 0.7570104598999023
Epoch: 9, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 10 cost time: 0.6469042301177979
Epoch: 10, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 0.5442874431610107
Epoch: 11, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 0.7238128185272217
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 0.5155880451202393
Epoch: 13, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 0.6349318027496338
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 0.6718032360076904
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 0.616539716720581
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 0.6903049945831299
Epoch: 17, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 0.6705288887023926
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 0.6005778312683105
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 0.6429612636566162
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 0.6783063411712646
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 0.711524486541748
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 0.6493420600891113
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 0.6223964691162109
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 0.7244040966033936
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 0.6040694713592529
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 0.48409318923950195
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6702334880828857
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 0.5540182590484619
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 0.6052238941192627
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.6589493751525879
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 32 cost time: 0.49984097480773926
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.5444321632385254
Epoch: 33, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 34 cost time: 0.5236387252807617
Epoch: 34, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 35 cost time: 0.6691691875457764
Epoch: 35, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.6565868854522705
Epoch: 36, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.6350650787353516
Epoch: 37, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 38 cost time: 0.7128646373748779
Epoch: 38, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 39 cost time: 0.6070330142974854
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 40 cost time: 0.6349482536315918
Epoch: 40, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.6152830123901367
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.5938131809234619
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 43 cost time: 0.5161969661712646
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 44 cost time: 0.4647204875946045
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 45 cost time: 0.6679565906524658
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 46 cost time: 0.454967737197876
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 47 cost time: 0.49268651008605957
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.5142149925231934
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 49 cost time: 0.4656944274902344
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 50 cost time: 0.5622389316558838
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 290745
model size : 1.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.5008642673492432
Epoch: 1, Steps: 18 | Train Loss: 3.111 Vali Loss: 2.755 Vali Acc: 0.490 Test Loss: 2.755 Test Acc: 0.490
Validation loss decreased (inf --> -0.489972).  Saving model ...
Epoch: 2 cost time: 0.6034319400787354
Epoch: 2, Steps: 18 | Train Loss: 1.969 Vali Loss: 1.498 Vali Acc: 0.907 Test Loss: 1.498 Test Acc: 0.907
Validation loss decreased (-0.489972 --> -0.906652).  Saving model ...
Epoch: 3 cost time: 0.6711349487304688
Epoch: 3, Steps: 18 | Train Loss: 0.764 Vali Loss: 0.578 Vali Acc: 0.960 Test Loss: 0.578 Test Acc: 0.960
Validation loss decreased (-0.906652 --> -0.959994).  Saving model ...
Epoch: 4 cost time: 0.6043739318847656
Epoch: 4, Steps: 18 | Train Loss: 0.234 Vali Loss: 0.258 Vali Acc: 0.970 Test Loss: 0.258 Test Acc: 0.970
Validation loss decreased (-0.959994 --> -0.969997).  Saving model ...
Epoch: 5 cost time: 0.6538829803466797
Epoch: 5, Steps: 18 | Train Loss: 0.066 Vali Loss: 0.192 Vali Acc: 0.967 Test Loss: 0.192 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6948480606079102
Epoch: 6, Steps: 18 | Train Loss: 0.032 Vali Loss: 0.161 Vali Acc: 0.970 Test Loss: 0.161 Test Acc: 0.970
Validation loss decreased (-0.969997 --> -0.969998).  Saving model ...
Epoch: 7 cost time: 0.7063736915588379
Epoch: 7, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.142 Vali Acc: 0.973 Test Loss: 0.142 Test Acc: 0.973
Validation loss decreased (-0.969998 --> -0.973332).  Saving model ...
Epoch: 8 cost time: 0.6176266670227051
Epoch: 8, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.129 Vali Acc: 0.973 Test Loss: 0.129 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 9 cost time: 0.638735294342041
Epoch: 9, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.125 Vali Acc: 0.973 Test Loss: 0.125 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 0.630479097366333
Epoch: 10, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.117 Vali Acc: 0.973 Test Loss: 0.117 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 0.4887101650238037
Epoch: 11, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 12 cost time: 0.5371818542480469
Epoch: 12, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 13 cost time: 0.6614425182342529
Epoch: 13, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 14 cost time: 0.6660993099212646
Epoch: 14, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 15 cost time: 0.6113193035125732
Epoch: 15, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 16 cost time: 0.5814948081970215
Epoch: 16, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 17 cost time: 0.6747593879699707
Epoch: 17, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 18 cost time: 0.5917236804962158
Epoch: 18, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 19 cost time: 0.5451302528381348
Epoch: 19, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 20 cost time: 0.6153333187103271
Epoch: 20, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 21 cost time: 0.7130041122436523
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 22 cost time: 0.6075174808502197
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 23 cost time: 0.6353628635406494
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 24 cost time: 0.7448704242706299
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 25 cost time: 0.6713972091674805
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 26 cost time: 0.5628890991210938
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 27 cost time: 0.46488428115844727
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 28 cost time: 0.6135084629058838
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 29 cost time: 0.48345947265625
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 30 cost time: 0.6196353435516357
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 31 cost time: 0.6646280288696289
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.5115115642547607
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.5974876880645752
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 34 cost time: 0.5667800903320312
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 35 cost time: 0.7030675411224365
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 36 cost time: 0.6624643802642822
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 37 cost time: 0.6651613712310791
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973333).  Saving model ...
Epoch: 38 cost time: 0.6553688049316406
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
Validation loss decreased (-0.973333 --> -0.973333).  Saving model ...
Epoch: 39 cost time: 0.6810517311096191
Epoch: 39, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
Validation loss decreased (-0.973333 --> -0.973333).  Saving model ...
Epoch: 40 cost time: 0.5964698791503906
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
Validation loss decreased (-0.973333 --> -0.973333).  Saving model ...
Epoch: 41 cost time: 0.6245715618133545
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.684870719909668
Epoch: 42, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.5171599388122559
Epoch: 43, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.973 Test Loss: 0.081 Test Acc: 0.973
Validation loss decreased (-0.973333 --> -0.973333).  Saving model ...
Epoch: 44 cost time: 0.5711979866027832
Epoch: 44, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.657764196395874
Epoch: 45, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.973333 --> -0.976666).  Saving model ...
Epoch: 46 cost time: 0.5884749889373779
Epoch: 46, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.5072548389434814
Epoch: 47, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 48 cost time: 0.5134491920471191
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 49 cost time: 0.6735374927520752
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.646263599395752
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps11_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 204441
model size : 0.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.4753079414367676
Epoch: 1, Steps: 18 | Train Loss: 3.206 Vali Loss: 2.924 Vali Acc: 0.243 Test Loss: 2.924 Test Acc: 0.243
Validation loss decreased (inf --> -0.243304).  Saving model ...
Epoch: 2 cost time: 0.4599642753601074
Epoch: 2, Steps: 18 | Train Loss: 2.301 Vali Loss: 1.902 Vali Acc: 0.877 Test Loss: 1.902 Test Acc: 0.877
Validation loss decreased (-0.243304 --> -0.876648).  Saving model ...
Epoch: 3 cost time: 0.5024137496948242
Epoch: 3, Steps: 18 | Train Loss: 1.170 Vali Loss: 0.911 Vali Acc: 0.953 Test Loss: 0.911 Test Acc: 0.953
Validation loss decreased (-0.876648 --> -0.953324).  Saving model ...
Epoch: 4 cost time: 0.5045328140258789
Epoch: 4, Steps: 18 | Train Loss: 0.435 Vali Loss: 0.413 Vali Acc: 0.970 Test Loss: 0.413 Test Acc: 0.970
Validation loss decreased (-0.953324 --> -0.969996).  Saving model ...
Epoch: 5 cost time: 0.5384047031402588
Epoch: 5, Steps: 18 | Train Loss: 0.146 Vali Loss: 0.259 Vali Acc: 0.977 Test Loss: 0.259 Test Acc: 0.977
Validation loss decreased (-0.969996 --> -0.976664).  Saving model ...
Epoch: 6 cost time: 0.5375642776489258
Epoch: 6, Steps: 18 | Train Loss: 0.064 Vali Loss: 0.200 Vali Acc: 0.977 Test Loss: 0.200 Test Acc: 0.977
Validation loss decreased (-0.976664 --> -0.976665).  Saving model ...
Epoch: 7 cost time: 0.608694314956665
Epoch: 7, Steps: 18 | Train Loss: 0.037 Vali Loss: 0.176 Vali Acc: 0.980 Test Loss: 0.176 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979998).  Saving model ...
Epoch: 8 cost time: 0.6458227634429932
Epoch: 8, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.156 Vali Acc: 0.980 Test Loss: 0.156 Test Acc: 0.980
Validation loss decreased (-0.979998 --> -0.979998).  Saving model ...
Epoch: 9 cost time: 0.5979359149932861
Epoch: 9, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.146 Vali Acc: 0.980 Test Loss: 0.146 Test Acc: 0.980
Validation loss decreased (-0.979998 --> -0.979999).  Saving model ...
Epoch: 10 cost time: 0.656552791595459
Epoch: 10, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.139 Vali Acc: 0.980 Test Loss: 0.139 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 11 cost time: 0.6136434078216553
Epoch: 11, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.128 Vali Acc: 0.980 Test Loss: 0.128 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 12 cost time: 0.6682529449462891
Epoch: 12, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.124 Vali Acc: 0.980 Test Loss: 0.124 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 13 cost time: 0.6557943820953369
Epoch: 13, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.120 Vali Acc: 0.980 Test Loss: 0.120 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 14 cost time: 0.582237958908081
Epoch: 14, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 0.6144120693206787
Epoch: 15, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.113 Vali Acc: 0.980 Test Loss: 0.113 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 0.6003429889678955
Epoch: 16, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 0.5982081890106201
Epoch: 17, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.108 Vali Acc: 0.980 Test Loss: 0.108 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 0.5907824039459229
Epoch: 18, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 0.46353745460510254
Epoch: 19, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 0.6650304794311523
Epoch: 20, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 0.5768277645111084
Epoch: 21, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 0.6495640277862549
Epoch: 22, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 0.621347188949585
Epoch: 23, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 0.5799779891967773
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6098415851593018
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 0.5475080013275146
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 0.5574307441711426
Epoch: 27, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 0.6363577842712402
Epoch: 28, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 0.49311137199401855
Epoch: 29, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 0.5562417507171631
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 31 cost time: 0.49266767501831055
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 32 cost time: 0.5339031219482422
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 33 cost time: 0.5025134086608887
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.5167355537414551
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 35 cost time: 0.5108733177185059
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 36 cost time: 0.587242841720581
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 37 cost time: 0.6023964881896973
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 38 cost time: 0.6083061695098877
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.5996341705322266
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 40 cost time: 0.5854587554931641
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 41 cost time: 0.645226001739502
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 42 cost time: 0.621990442276001
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 43 cost time: 0.651155948638916
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 44 cost time: 0.6184418201446533
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 45 cost time: 0.611914873123169
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 46 cost time: 0.6065776348114014
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.5750815868377686
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 48 cost time: 0.48862600326538086
Epoch: 48, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 49 cost time: 0.539121150970459
Epoch: 49, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.612269401550293
Epoch: 50, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 161369
model size : 0.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps22_str11_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.4465203285217285
Epoch: 1, Steps: 18 | Train Loss: 3.156 Vali Loss: 2.936 Vali Acc: 0.273 Test Loss: 2.936 Test Acc: 0.273
Validation loss decreased (inf --> -0.273304).  Saving model ...
Epoch: 2 cost time: 0.5287024974822998
Epoch: 2, Steps: 18 | Train Loss: 2.450 Vali Loss: 2.112 Vali Acc: 0.827 Test Loss: 2.112 Test Acc: 0.827
Validation loss decreased (-0.273304 --> -0.826646).  Saving model ...
Epoch: 3 cost time: 0.5419139862060547
Epoch: 3, Steps: 18 | Train Loss: 1.522 Vali Loss: 1.201 Vali Acc: 0.923 Test Loss: 1.201 Test Acc: 0.923
Validation loss decreased (-0.826646 --> -0.923321).  Saving model ...
Epoch: 4 cost time: 0.6412262916564941
Epoch: 4, Steps: 18 | Train Loss: 0.712 Vali Loss: 0.612 Vali Acc: 0.963 Test Loss: 0.612 Test Acc: 0.963
Validation loss decreased (-0.923321 --> -0.963327).  Saving model ...
Epoch: 5 cost time: 0.61918044090271
Epoch: 5, Steps: 18 | Train Loss: 0.290 Vali Loss: 0.341 Vali Acc: 0.967 Test Loss: 0.341 Test Acc: 0.967
Validation loss decreased (-0.963327 --> -0.966663).  Saving model ...
Epoch: 6 cost time: 0.5749139785766602
Epoch: 6, Steps: 18 | Train Loss: 0.126 Vali Loss: 0.253 Vali Acc: 0.970 Test Loss: 0.253 Test Acc: 0.970
Validation loss decreased (-0.966663 --> -0.969997).  Saving model ...
Epoch: 7 cost time: 0.5947542190551758
Epoch: 7, Steps: 18 | Train Loss: 0.073 Vali Loss: 0.207 Vali Acc: 0.970 Test Loss: 0.207 Test Acc: 0.970
Validation loss decreased (-0.969997 --> -0.969998).  Saving model ...
Epoch: 8 cost time: 0.6406259536743164
Epoch: 8, Steps: 18 | Train Loss: 0.052 Vali Loss: 0.179 Vali Acc: 0.970 Test Loss: 0.179 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 9 cost time: 0.5725648403167725
Epoch: 9, Steps: 18 | Train Loss: 0.035 Vali Loss: 0.174 Vali Acc: 0.963 Test Loss: 0.174 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6315770149230957
Epoch: 10, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.154 Vali Acc: 0.970 Test Loss: 0.154 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 11 cost time: 0.622523307800293
Epoch: 11, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.143 Vali Acc: 0.970 Test Loss: 0.143 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969999).  Saving model ...
Epoch: 12 cost time: 0.6290972232818604
Epoch: 12, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.137 Vali Acc: 0.973 Test Loss: 0.137 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 13 cost time: 0.6294655799865723
Epoch: 13, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.130 Vali Acc: 0.973 Test Loss: 0.130 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 14 cost time: 0.6048610210418701
Epoch: 14, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.124 Vali Acc: 0.973 Test Loss: 0.124 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 15 cost time: 0.6370735168457031
Epoch: 15, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 16 cost time: 0.6674220561981201
Epoch: 16, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 17 cost time: 0.6242425441741943
Epoch: 17, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 18 cost time: 0.6554098129272461
Epoch: 18, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 19 cost time: 0.6444258689880371
Epoch: 19, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 20 cost time: 0.5734941959381104
Epoch: 20, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 21 cost time: 0.5335628986358643
Epoch: 21, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 22 cost time: 0.5872890949249268
Epoch: 22, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 23 cost time: 0.5038120746612549
Epoch: 23, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 24 cost time: 0.5481641292572021
Epoch: 24, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 25 cost time: 0.47908830642700195
Epoch: 25, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 26 cost time: 0.6051931381225586
Epoch: 26, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 27 cost time: 0.6097934246063232
Epoch: 27, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 28 cost time: 0.7114958763122559
Epoch: 28, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 29 cost time: 0.6000783443450928
Epoch: 29, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 30 cost time: 0.6327252388000488
Epoch: 30, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 31 cost time: 0.6064567565917969
Epoch: 31, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 32 cost time: 0.5534656047821045
Epoch: 32, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.6245615482330322
Epoch: 33, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 34 cost time: 0.6467292308807373
Epoch: 34, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.973 Test Loss: 0.092 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 35 cost time: 0.6060717105865479
Epoch: 35, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 36 cost time: 0.6127865314483643
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 37 cost time: 0.49181675910949707
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 38 cost time: 0.6028594970703125
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 39 cost time: 0.5754315853118896
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 40 cost time: 0.4616103172302246
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 41 cost time: 0.6481912136077881
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 42 cost time: 0.6116516590118408
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 43 cost time: 0.6389544010162354
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.6959178447723389
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.6929984092712402
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.643563985824585
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.6023428440093994
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.6397807598114014
Epoch: 48, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.625946044921875
Epoch: 49, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.599151611328125
Epoch: 50, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps22_str11_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 125593
model size : 0.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps29_str15_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.531951665878296
Epoch: 1, Steps: 18 | Train Loss: 3.146 Vali Loss: 3.006 Vali Acc: 0.180 Test Loss: 3.006 Test Acc: 0.180
Validation loss decreased (inf --> -0.179970).  Saving model ...
Epoch: 2 cost time: 0.609520673751831
Epoch: 2, Steps: 18 | Train Loss: 2.646 Vali Loss: 2.387 Vali Acc: 0.667 Test Loss: 2.387 Test Acc: 0.667
Validation loss decreased (-0.179970 --> -0.666643).  Saving model ...
Epoch: 3 cost time: 0.5770359039306641
Epoch: 3, Steps: 18 | Train Loss: 1.897 Vali Loss: 1.653 Vali Acc: 0.890 Test Loss: 1.653 Test Acc: 0.890
Validation loss decreased (-0.666643 --> -0.889983).  Saving model ...
Epoch: 4 cost time: 0.604041576385498
Epoch: 4, Steps: 18 | Train Loss: 1.202 Vali Loss: 1.028 Vali Acc: 0.950 Test Loss: 1.028 Test Acc: 0.950
Validation loss decreased (-0.889983 --> -0.949990).  Saving model ...
Epoch: 5 cost time: 0.6282503604888916
Epoch: 5, Steps: 18 | Train Loss: 0.658 Vali Loss: 0.614 Vali Acc: 0.960 Test Loss: 0.614 Test Acc: 0.960
Validation loss decreased (-0.949990 --> -0.959994).  Saving model ...
Epoch: 6 cost time: 0.6914787292480469
Epoch: 6, Steps: 18 | Train Loss: 0.329 Vali Loss: 0.395 Vali Acc: 0.963 Test Loss: 0.395 Test Acc: 0.963
Validation loss decreased (-0.959994 --> -0.963329).  Saving model ...
Epoch: 7 cost time: 0.6444191932678223
Epoch: 7, Steps: 18 | Train Loss: 0.179 Vali Loss: 0.296 Vali Acc: 0.967 Test Loss: 0.296 Test Acc: 0.967
Validation loss decreased (-0.963329 --> -0.966664).  Saving model ...
Epoch: 8 cost time: 0.5656533241271973
Epoch: 8, Steps: 18 | Train Loss: 0.111 Vali Loss: 0.243 Vali Acc: 0.977 Test Loss: 0.243 Test Acc: 0.977
Validation loss decreased (-0.966664 --> -0.976664).  Saving model ...
Epoch: 9 cost time: 0.5248236656188965
Epoch: 9, Steps: 18 | Train Loss: 0.078 Vali Loss: 0.210 Vali Acc: 0.977 Test Loss: 0.210 Test Acc: 0.977
Validation loss decreased (-0.976664 --> -0.976665).  Saving model ...
Epoch: 10 cost time: 0.47841429710388184
Epoch: 10, Steps: 18 | Train Loss: 0.057 Vali Loss: 0.191 Vali Acc: 0.977 Test Loss: 0.191 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 11 cost time: 0.5279750823974609
Epoch: 11, Steps: 18 | Train Loss: 0.045 Vali Loss: 0.175 Vali Acc: 0.980 Test Loss: 0.175 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979998).  Saving model ...
Epoch: 12 cost time: 0.4662160873413086
Epoch: 12, Steps: 18 | Train Loss: 0.038 Vali Loss: 0.162 Vali Acc: 0.980 Test Loss: 0.162 Test Acc: 0.980
Validation loss decreased (-0.979998 --> -0.979998).  Saving model ...
Epoch: 13 cost time: 0.4427788257598877
Epoch: 13, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.151 Vali Acc: 0.980 Test Loss: 0.151 Test Acc: 0.980
Validation loss decreased (-0.979998 --> -0.979998).  Saving model ...
Epoch: 14 cost time: 0.5944747924804688
Epoch: 14, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.144 Vali Acc: 0.980 Test Loss: 0.144 Test Acc: 0.980
Validation loss decreased (-0.979998 --> -0.979999).  Saving model ...
Epoch: 15 cost time: 0.5043160915374756
Epoch: 15, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.138 Vali Acc: 0.980 Test Loss: 0.138 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 0.4962747097015381
Epoch: 16, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.132 Vali Acc: 0.980 Test Loss: 0.132 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 0.6634647846221924
Epoch: 17, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.127 Vali Acc: 0.980 Test Loss: 0.127 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 18 cost time: 0.6144611835479736
Epoch: 18, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.122 Vali Acc: 0.980 Test Loss: 0.122 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 0.5750188827514648
Epoch: 19, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.121 Vali Acc: 0.980 Test Loss: 0.121 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 0.5720129013061523
Epoch: 20, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 0.6335790157318115
Epoch: 21, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.115 Vali Acc: 0.980 Test Loss: 0.115 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 22 cost time: 0.6506028175354004
Epoch: 22, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 0.6082406044006348
Epoch: 23, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.109 Vali Acc: 0.980 Test Loss: 0.109 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 0.5219838619232178
Epoch: 24, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 25 cost time: 0.5728530883789062
Epoch: 25, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 26 cost time: 0.47989416122436523
Epoch: 26, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 0.5076944828033447
Epoch: 27, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 28 cost time: 0.5973186492919922
Epoch: 28, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 29 cost time: 0.46203041076660156
Epoch: 29, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 0.5095605850219727
Epoch: 30, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 31 cost time: 0.5020632743835449
Epoch: 31, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 32 cost time: 0.49739885330200195
Epoch: 32, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 33 cost time: 0.5055058002471924
Epoch: 33, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 34 cost time: 0.5471301078796387
Epoch: 34, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 35 cost time: 0.5940549373626709
Epoch: 35, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.5194885730743408
Epoch: 36, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 37 cost time: 0.569176197052002
Epoch: 37, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 38 cost time: 0.560434103012085
Epoch: 38, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 39 cost time: 0.5559945106506348
Epoch: 39, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 40 cost time: 0.5916352272033691
Epoch: 40, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.5605695247650146
Epoch: 41, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 42 cost time: 0.6096315383911133
Epoch: 42, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 43 cost time: 0.49045395851135254
Epoch: 43, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.5347321033477783
Epoch: 44, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 45 cost time: 0.541419267654419
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 46 cost time: 0.4980928897857666
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 47 cost time: 0.6071000099182129
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 48 cost time: 0.6207449436187744
Epoch: 48, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 49 cost time: 0.6293072700500488
Epoch: 49, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.5696427822113037
Epoch: 50, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps29_str15_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 97017
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps36_str18_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.4756779670715332
Epoch: 1, Steps: 18 | Train Loss: 3.211 Vali Loss: 3.065 Vali Acc: 0.097 Test Loss: 3.065 Test Acc: 0.097
Validation loss decreased (inf --> -0.096636).  Saving model ...
Epoch: 2 cost time: 0.49654316902160645
Epoch: 2, Steps: 18 | Train Loss: 2.722 Vali Loss: 2.506 Vali Acc: 0.597 Test Loss: 2.506 Test Acc: 0.597
Validation loss decreased (-0.096636 --> -0.596642).  Saving model ...
Epoch: 3 cost time: 0.5903289318084717
Epoch: 3, Steps: 18 | Train Loss: 2.065 Vali Loss: 1.819 Vali Acc: 0.873 Test Loss: 1.819 Test Acc: 0.873
Validation loss decreased (-0.596642 --> -0.873315).  Saving model ...
Epoch: 4 cost time: 0.4846162796020508
Epoch: 4, Steps: 18 | Train Loss: 1.319 Vali Loss: 1.170 Vali Acc: 0.933 Test Loss: 1.170 Test Acc: 0.933
Validation loss decreased (-0.873315 --> -0.933322).  Saving model ...
Epoch: 5 cost time: 0.5485811233520508
Epoch: 5, Steps: 18 | Train Loss: 0.758 Vali Loss: 0.715 Vali Acc: 0.953 Test Loss: 0.715 Test Acc: 0.953
Validation loss decreased (-0.933322 --> -0.953326).  Saving model ...
Epoch: 6 cost time: 0.620617151260376
Epoch: 6, Steps: 18 | Train Loss: 0.381 Vali Loss: 0.460 Vali Acc: 0.960 Test Loss: 0.460 Test Acc: 0.960
Validation loss decreased (-0.953326 --> -0.959995).  Saving model ...
Epoch: 7 cost time: 0.5569100379943848
Epoch: 7, Steps: 18 | Train Loss: 0.214 Vali Loss: 0.333 Vali Acc: 0.967 Test Loss: 0.333 Test Acc: 0.967
Validation loss decreased (-0.959995 --> -0.966663).  Saving model ...
Epoch: 8 cost time: 0.5230419635772705
Epoch: 8, Steps: 18 | Train Loss: 0.129 Vali Loss: 0.271 Vali Acc: 0.967 Test Loss: 0.271 Test Acc: 0.967
Validation loss decreased (-0.966663 --> -0.966664).  Saving model ...
Epoch: 9 cost time: 0.49526524543762207
Epoch: 9, Steps: 18 | Train Loss: 0.098 Vali Loss: 0.238 Vali Acc: 0.963 Test Loss: 0.238 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6306073665618896
Epoch: 10, Steps: 18 | Train Loss: 0.069 Vali Loss: 0.212 Vali Acc: 0.970 Test Loss: 0.212 Test Acc: 0.970
Validation loss decreased (-0.966664 --> -0.969998).  Saving model ...
Epoch: 11 cost time: 0.5893356800079346
Epoch: 11, Steps: 18 | Train Loss: 0.056 Vali Loss: 0.189 Vali Acc: 0.973 Test Loss: 0.189 Test Acc: 0.973
Validation loss decreased (-0.969998 --> -0.973331).  Saving model ...
Epoch: 12 cost time: 0.5479030609130859
Epoch: 12, Steps: 18 | Train Loss: 0.042 Vali Loss: 0.176 Vali Acc: 0.970 Test Loss: 0.176 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6465103626251221
Epoch: 13, Steps: 18 | Train Loss: 0.034 Vali Loss: 0.162 Vali Acc: 0.973 Test Loss: 0.162 Test Acc: 0.973
Validation loss decreased (-0.973331 --> -0.973332).  Saving model ...
Epoch: 14 cost time: 0.5707006454467773
Epoch: 14, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.154 Vali Acc: 0.970 Test Loss: 0.154 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5947062969207764
Epoch: 15, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.151 Vali Acc: 0.970 Test Loss: 0.151 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6734414100646973
Epoch: 16, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.142 Vali Acc: 0.970 Test Loss: 0.142 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.4619472026824951
Epoch: 17, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.136 Vali Acc: 0.973 Test Loss: 0.136 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 18 cost time: 0.5660037994384766
Epoch: 18, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.132 Vali Acc: 0.970 Test Loss: 0.132 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5871872901916504
Epoch: 19, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.128 Vali Acc: 0.970 Test Loss: 0.128 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.5426590442657471
Epoch: 20, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.125 Vali Acc: 0.973 Test Loss: 0.125 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 21 cost time: 0.5841596126556396
Epoch: 21, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.122 Vali Acc: 0.973 Test Loss: 0.122 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 22 cost time: 0.6528065204620361
Epoch: 22, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.117 Vali Acc: 0.973 Test Loss: 0.117 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 23 cost time: 0.6316165924072266
Epoch: 23, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 0.6311492919921875
Epoch: 24, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 0.623206377029419
Epoch: 25, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 0.5498306751251221
Epoch: 26, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 0.7007057666778564
Epoch: 27, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 28 cost time: 0.6331250667572021
Epoch: 28, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 0.5355653762817383
Epoch: 29, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 30 cost time: 0.5292797088623047
Epoch: 30, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 31 cost time: 0.5252814292907715
Epoch: 31, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 32 cost time: 0.638169527053833
Epoch: 32, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 33 cost time: 0.5796740055084229
Epoch: 33, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 34 cost time: 0.47710680961608887
Epoch: 34, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.977 Test Loss: 0.096 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.5696549415588379
Epoch: 35, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 36 cost time: 0.6172013282775879
Epoch: 36, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 37 cost time: 0.6052796840667725
Epoch: 37, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 38 cost time: 0.5927443504333496
Epoch: 38, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 39 cost time: 0.5859827995300293
Epoch: 39, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 40 cost time: 0.5863680839538574
Epoch: 40, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 41 cost time: 0.6263723373413086
Epoch: 41, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.4887840747833252
Epoch: 42, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 43 cost time: 0.5247654914855957
Epoch: 43, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 44 cost time: 0.5240294933319092
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 45 cost time: 0.6504061222076416
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 46 cost time: 0.5839455127716064
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.5956392288208008
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.480194091796875
Epoch: 48, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.4527432918548584
Epoch: 49, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 50 cost time: 0.5415065288543701
Epoch: 50, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_ModernTCN_UEA_ftM_sl144_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps36_str18_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 90041
model size : 0.36MB
