Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.8876283168792725
Epoch: 1, Steps: 10 | Train Loss: 3.272 Vali Loss: 3.264 Vali Acc: 0.038 Test Loss: 3.264 Test Acc: 0.038
Validation loss decreased (inf --> -0.037614).  Saving model ...
Epoch: 2 cost time: 0.9992780685424805
Epoch: 2, Steps: 10 | Train Loss: 3.139 Vali Loss: 3.255 Vali Acc: 0.056 Test Loss: 3.255 Test Acc: 0.056
Validation loss decreased (-0.037614 --> -0.056438).  Saving model ...
Epoch: 3 cost time: 1.2063937187194824
Epoch: 3, Steps: 10 | Train Loss: 2.940 Vali Loss: 3.260 Vali Acc: 0.065 Test Loss: 3.260 Test Acc: 0.065
Validation loss decreased (-0.056438 --> -0.064673).  Saving model ...
Epoch: 4 cost time: 1.3096036911010742
Epoch: 4, Steps: 10 | Train Loss: 2.681 Vali Loss: 3.256 Vali Acc: 0.092 Test Loss: 3.256 Test Acc: 0.092
Validation loss decreased (-0.064673 --> -0.091732).  Saving model ...
Epoch: 5 cost time: 1.3720629215240479
Epoch: 5, Steps: 10 | Train Loss: 2.417 Vali Loss: 3.236 Vali Acc: 0.116 Test Loss: 3.236 Test Acc: 0.116
Validation loss decreased (-0.091732 --> -0.116438).  Saving model ...
Epoch: 6 cost time: 1.165440320968628
Epoch: 6, Steps: 10 | Train Loss: 2.043 Vali Loss: 3.206 Vali Acc: 0.147 Test Loss: 3.206 Test Acc: 0.147
Validation loss decreased (-0.116438 --> -0.147027).  Saving model ...
Epoch: 7 cost time: 1.3189990520477295
Epoch: 7, Steps: 10 | Train Loss: 1.661 Vali Loss: 3.196 Vali Acc: 0.166 Test Loss: 3.196 Test Acc: 0.166
Validation loss decreased (-0.147027 --> -0.165850).  Saving model ...
Epoch: 8 cost time: 1.244288682937622
Epoch: 8, Steps: 10 | Train Loss: 1.214 Vali Loss: 3.232 Vali Acc: 0.204 Test Loss: 3.232 Test Acc: 0.204
Validation loss decreased (-0.165850 --> -0.203497).  Saving model ...
Epoch: 9 cost time: 1.3374879360198975
Epoch: 9, Steps: 10 | Train Loss: 0.823 Vali Loss: 3.316 Vali Acc: 0.219 Test Loss: 3.316 Test Acc: 0.219
Validation loss decreased (-0.203497 --> -0.218790).  Saving model ...
Epoch: 10 cost time: 1.3465688228607178
Epoch: 10, Steps: 10 | Train Loss: 0.508 Vali Loss: 3.423 Vali Acc: 0.246 Test Loss: 3.423 Test Acc: 0.246
Validation loss decreased (-0.218790 --> -0.245848).  Saving model ...
Epoch: 11 cost time: 1.2010350227355957
Epoch: 11, Steps: 10 | Train Loss: 0.299 Vali Loss: 3.605 Vali Acc: 0.248 Test Loss: 3.605 Test Acc: 0.248
Validation loss decreased (-0.245848 --> -0.248199).  Saving model ...
Epoch: 12 cost time: 1.4372143745422363
Epoch: 12, Steps: 10 | Train Loss: 0.159 Vali Loss: 3.808 Vali Acc: 0.260 Test Loss: 3.808 Test Acc: 0.260
Validation loss decreased (-0.248199 --> -0.259962).  Saving model ...
Epoch: 13 cost time: 1.3594472408294678
Epoch: 13, Steps: 10 | Train Loss: 0.084 Vali Loss: 3.957 Vali Acc: 0.262 Test Loss: 3.957 Test Acc: 0.262
Validation loss decreased (-0.259962 --> -0.262313).  Saving model ...
Epoch: 14 cost time: 1.1332180500030518
Epoch: 14, Steps: 10 | Train Loss: 0.047 Vali Loss: 4.100 Vali Acc: 0.255 Test Loss: 4.100 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4621198177337646
Epoch: 15, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.204 Vali Acc: 0.258 Test Loss: 4.204 Test Acc: 0.258
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.4964325428009033
Epoch: 16, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.240 Vali Acc: 0.259 Test Loss: 4.240 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.1138195991516113
Epoch: 17, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.314 Vali Acc: 0.260 Test Loss: 4.314 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.0009067058563232
Epoch: 18, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.362 Vali Acc: 0.262 Test Loss: 4.362 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.393235206604004
Epoch: 19, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.408 Vali Acc: 0.266 Test Loss: 4.408 Test Acc: 0.266
Validation loss decreased (-0.262313 --> -0.265838).  Saving model ...
Epoch: 20 cost time: 1.4577438831329346
Epoch: 20, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.449 Vali Acc: 0.267 Test Loss: 4.449 Test Acc: 0.267
Validation loss decreased (-0.265838 --> -0.267014).  Saving model ...
Epoch: 21 cost time: 1.328533411026001
Epoch: 21, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.484 Vali Acc: 0.269 Test Loss: 4.484 Test Acc: 0.269
Validation loss decreased (-0.267014 --> -0.269367).  Saving model ...
Epoch: 22 cost time: 1.4459271430969238
Epoch: 22, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.529 Vali Acc: 0.268 Test Loss: 4.529 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.3175296783447266
Epoch: 23, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.556 Vali Acc: 0.271 Test Loss: 4.556 Test Acc: 0.271
Validation loss decreased (-0.269367 --> -0.270543).  Saving model ...
Epoch: 24 cost time: 1.2254033088684082
Epoch: 24, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.591 Vali Acc: 0.273 Test Loss: 4.591 Test Acc: 0.273
Validation loss decreased (-0.270543 --> -0.272895).  Saving model ...
Epoch: 25 cost time: 1.2916474342346191
Epoch: 25, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.622 Vali Acc: 0.269 Test Loss: 4.622 Test Acc: 0.269
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0022985935211182
Epoch: 26, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.661 Vali Acc: 0.268 Test Loss: 4.661 Test Acc: 0.268
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.0696406364440918
Epoch: 27, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.689 Vali Acc: 0.272 Test Loss: 4.689 Test Acc: 0.272
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.001427412033081
Epoch: 28, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.715 Vali Acc: 0.272 Test Loss: 4.715 Test Acc: 0.272
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.1799376010894775
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.730 Vali Acc: 0.275 Test Loss: 4.730 Test Acc: 0.275
Validation loss decreased (-0.272895 --> -0.275247).  Saving model ...
Epoch: 30 cost time: 1.2519335746765137
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.756 Vali Acc: 0.276 Test Loss: 4.756 Test Acc: 0.276
Validation loss decreased (-0.275247 --> -0.276423).  Saving model ...
Epoch: 31 cost time: 1.3856937885284424
Epoch: 31, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.802 Vali Acc: 0.268 Test Loss: 4.802 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.3124518394470215
Epoch: 32, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.828 Vali Acc: 0.271 Test Loss: 4.828 Test Acc: 0.271
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.3882036209106445
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.847 Vali Acc: 0.271 Test Loss: 4.847 Test Acc: 0.271
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.2326571941375732
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.877 Vali Acc: 0.268 Test Loss: 4.877 Test Acc: 0.268
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.2916278839111328
Epoch: 35, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.895 Vali Acc: 0.268 Test Loss: 4.895 Test Acc: 0.268
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.1606183052062988
Epoch: 36, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.912 Vali Acc: 0.271 Test Loss: 4.912 Test Acc: 0.271
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.17079496383667
Epoch: 37, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.941 Vali Acc: 0.269 Test Loss: 4.941 Test Acc: 0.269
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.1615207195281982
Epoch: 38, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.964 Vali Acc: 0.271 Test Loss: 4.964 Test Acc: 0.271
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.3148765563964844
Epoch: 39, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.979 Vali Acc: 0.272 Test Loss: 4.979 Test Acc: 0.272
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.3667693138122559
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.001 Vali Acc: 0.273 Test Loss: 5.001 Test Acc: 0.273
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27647058823529413
model parameter : 764986
model size : 2.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.20473051071167
Epoch: 1, Steps: 10 | Train Loss: 3.313 Vali Loss: 3.266 Vali Acc: 0.045 Test Loss: 3.266 Test Acc: 0.045
Validation loss decreased (inf --> -0.044673).  Saving model ...
Epoch: 2 cost time: 1.0159742832183838
Epoch: 2, Steps: 10 | Train Loss: 3.237 Vali Loss: 3.257 Vali Acc: 0.060 Test Loss: 3.257 Test Acc: 0.060
Validation loss decreased (-0.044673 --> -0.059967).  Saving model ...
Epoch: 3 cost time: 1.0559933185577393
Epoch: 3, Steps: 10 | Train Loss: 3.083 Vali Loss: 3.247 Vali Acc: 0.076 Test Loss: 3.247 Test Acc: 0.076
Validation loss decreased (-0.059967 --> -0.076438).  Saving model ...
Epoch: 4 cost time: 1.0319790840148926
Epoch: 4, Steps: 10 | Train Loss: 2.936 Vali Loss: 3.243 Vali Acc: 0.093 Test Loss: 3.243 Test Acc: 0.093
Validation loss decreased (-0.076438 --> -0.092909).  Saving model ...
Epoch: 5 cost time: 1.0489611625671387
Epoch: 5, Steps: 10 | Train Loss: 2.759 Vali Loss: 3.237 Vali Acc: 0.094 Test Loss: 3.237 Test Acc: 0.094
Validation loss decreased (-0.092909 --> -0.094085).  Saving model ...
Epoch: 6 cost time: 1.182138442993164
Epoch: 6, Steps: 10 | Train Loss: 2.541 Vali Loss: 3.224 Vali Acc: 0.108 Test Loss: 3.224 Test Acc: 0.108
Validation loss decreased (-0.094085 --> -0.108203).  Saving model ...
Epoch: 7 cost time: 1.0475940704345703
Epoch: 7, Steps: 10 | Train Loss: 2.322 Vali Loss: 3.213 Vali Acc: 0.120 Test Loss: 3.213 Test Acc: 0.120
Validation loss decreased (-0.108203 --> -0.119968).  Saving model ...
Epoch: 8 cost time: 1.146888017654419
Epoch: 8, Steps: 10 | Train Loss: 2.077 Vali Loss: 3.189 Vali Acc: 0.144 Test Loss: 3.189 Test Acc: 0.144
Validation loss decreased (-0.119968 --> -0.143498).  Saving model ...
Epoch: 9 cost time: 1.1994266510009766
Epoch: 9, Steps: 10 | Train Loss: 1.799 Vali Loss: 3.183 Vali Acc: 0.162 Test Loss: 3.183 Test Acc: 0.162
Validation loss decreased (-0.143498 --> -0.162321).  Saving model ...
Epoch: 10 cost time: 1.0357744693756104
Epoch: 10, Steps: 10 | Train Loss: 1.454 Vali Loss: 3.193 Vali Acc: 0.182 Test Loss: 3.193 Test Acc: 0.182
Validation loss decreased (-0.162321 --> -0.182321).  Saving model ...
Epoch: 11 cost time: 0.9776773452758789
Epoch: 11, Steps: 10 | Train Loss: 1.191 Vali Loss: 3.216 Vali Acc: 0.201 Test Loss: 3.216 Test Acc: 0.201
Validation loss decreased (-0.182321 --> -0.201144).  Saving model ...
Epoch: 12 cost time: 1.0724482536315918
Epoch: 12, Steps: 10 | Train Loss: 0.906 Vali Loss: 3.263 Vali Acc: 0.206 Test Loss: 3.263 Test Acc: 0.206
Validation loss decreased (-0.201144 --> -0.205850).  Saving model ...
Epoch: 13 cost time: 1.0912632942199707
Epoch: 13, Steps: 10 | Train Loss: 0.687 Vali Loss: 3.323 Vali Acc: 0.219 Test Loss: 3.323 Test Acc: 0.219
Validation loss decreased (-0.205850 --> -0.218790).  Saving model ...
Epoch: 14 cost time: 1.0741479396820068
Epoch: 14, Steps: 10 | Train Loss: 0.490 Vali Loss: 3.431 Vali Acc: 0.232 Test Loss: 3.431 Test Acc: 0.232
Validation loss decreased (-0.218790 --> -0.231730).  Saving model ...
Epoch: 15 cost time: 1.1256959438323975
Epoch: 15, Steps: 10 | Train Loss: 0.333 Vali Loss: 3.536 Vali Acc: 0.241 Test Loss: 3.536 Test Acc: 0.241
Validation loss decreased (-0.231730 --> -0.241141).  Saving model ...
Epoch: 16 cost time: 1.1183905601501465
Epoch: 16, Steps: 10 | Train Loss: 0.225 Vali Loss: 3.643 Vali Acc: 0.252 Test Loss: 3.643 Test Acc: 0.252
Validation loss decreased (-0.241141 --> -0.251728).  Saving model ...
Epoch: 17 cost time: 0.8330237865447998
Epoch: 17, Steps: 10 | Train Loss: 0.151 Vali Loss: 3.744 Vali Acc: 0.255 Test Loss: 3.744 Test Acc: 0.255
Validation loss decreased (-0.251728 --> -0.255257).  Saving model ...
Epoch: 18 cost time: 0.9774465560913086
Epoch: 18, Steps: 10 | Train Loss: 0.097 Vali Loss: 3.860 Vali Acc: 0.256 Test Loss: 3.860 Test Acc: 0.256
Validation loss decreased (-0.255257 --> -0.256432).  Saving model ...
Epoch: 19 cost time: 1.0420973300933838
Epoch: 19, Steps: 10 | Train Loss: 0.068 Vali Loss: 3.948 Vali Acc: 0.254 Test Loss: 3.948 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1658401489257812
Epoch: 20, Steps: 10 | Train Loss: 0.053 Vali Loss: 4.021 Vali Acc: 0.259 Test Loss: 4.021 Test Acc: 0.259
Validation loss decreased (-0.256432 --> -0.258783).  Saving model ...
Epoch: 21 cost time: 1.1004071235656738
Epoch: 21, Steps: 10 | Train Loss: 0.041 Vali Loss: 4.074 Vali Acc: 0.258 Test Loss: 4.074 Test Acc: 0.258
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0412981510162354
Epoch: 22, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.119 Vali Acc: 0.261 Test Loss: 4.119 Test Acc: 0.261
Validation loss decreased (-0.258783 --> -0.261135).  Saving model ...
Epoch: 23 cost time: 1.1593356132507324
Epoch: 23, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.156 Vali Acc: 0.268 Test Loss: 4.156 Test Acc: 0.268
Validation loss decreased (-0.261135 --> -0.268194).  Saving model ...
Epoch: 24 cost time: 0.954343318939209
Epoch: 24, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.203 Vali Acc: 0.262 Test Loss: 4.203 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0304059982299805
Epoch: 25, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.242 Vali Acc: 0.262 Test Loss: 4.242 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.178382396697998
Epoch: 26, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.285 Vali Acc: 0.265 Test Loss: 4.285 Test Acc: 0.265
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.237699031829834
Epoch: 27, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.321 Vali Acc: 0.266 Test Loss: 4.321 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.1060192584991455
Epoch: 28, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.350 Vali Acc: 0.268 Test Loss: 4.350 Test Acc: 0.268
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.2043359279632568
Epoch: 29, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.388 Vali Acc: 0.267 Test Loss: 4.388 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.993877649307251
Epoch: 30, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.425 Vali Acc: 0.265 Test Loss: 4.425 Test Acc: 0.265
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.0623736381530762
Epoch: 31, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.468 Vali Acc: 0.267 Test Loss: 4.468 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.1319797039031982
Epoch: 32, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.519 Vali Acc: 0.271 Test Loss: 4.519 Test Acc: 0.271
Validation loss decreased (-0.268194 --> -0.270543).  Saving model ...
Epoch: 33 cost time: 1.1535022258758545
Epoch: 33, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.543 Vali Acc: 0.271 Test Loss: 4.543 Test Acc: 0.271
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.0428895950317383
Epoch: 34, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.565 Vali Acc: 0.271 Test Loss: 4.565 Test Acc: 0.271
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.1462383270263672
Epoch: 35, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.600 Vali Acc: 0.271 Test Loss: 4.600 Test Acc: 0.271
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.1458873748779297
Epoch: 36, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.613 Vali Acc: 0.272 Test Loss: 4.613 Test Acc: 0.272
Validation loss decreased (-0.270543 --> -0.271719).  Saving model ...
Epoch: 37 cost time: 1.0219976902008057
Epoch: 37, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.637 Vali Acc: 0.272 Test Loss: 4.637 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.15032958984375
Epoch: 38, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.652 Vali Acc: 0.275 Test Loss: 4.652 Test Acc: 0.275
Validation loss decreased (-0.271719 --> -0.275248).  Saving model ...
Epoch: 39 cost time: 0.9879369735717773
Epoch: 39, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.677 Vali Acc: 0.275 Test Loss: 4.677 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.1802527904510498
Epoch: 40, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.704 Vali Acc: 0.274 Test Loss: 4.704 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.0657894611358643
Epoch: 41, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.737 Vali Acc: 0.279 Test Loss: 4.737 Test Acc: 0.279
Validation loss decreased (-0.275248 --> -0.278776).  Saving model ...
Epoch: 42 cost time: 1.138681411743164
Epoch: 42, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.755 Vali Acc: 0.274 Test Loss: 4.755 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.1171979904174805
Epoch: 43, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.794 Vali Acc: 0.274 Test Loss: 4.794 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.1048705577850342
Epoch: 44, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.799 Vali Acc: 0.273 Test Loss: 4.799 Test Acc: 0.273
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.164252519607544
Epoch: 45, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.815 Vali Acc: 0.275 Test Loss: 4.815 Test Acc: 0.275
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.1903290748596191
Epoch: 46, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.843 Vali Acc: 0.274 Test Loss: 4.843 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.1054837703704834
Epoch: 47, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.865 Vali Acc: 0.273 Test Loss: 4.865 Test Acc: 0.273
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.2372915744781494
Epoch: 48, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.883 Vali Acc: 0.275 Test Loss: 4.883 Test Acc: 0.275
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 1.0872654914855957
Epoch: 49, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.890 Vali Acc: 0.276 Test Loss: 4.890 Test Acc: 0.276
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 1.0970451831817627
Epoch: 50, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.905 Vali Acc: 0.276 Test Loss: 4.905 Test Acc: 0.276
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2788235294117647
model parameter : 675258
model size : 2.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps12_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.4537696838378906
Epoch: 1, Steps: 10 | Train Loss: 3.282 Vali Loss: 3.267 Vali Acc: 0.035 Test Loss: 3.267 Test Acc: 0.035
Validation loss decreased (inf --> -0.035261).  Saving model ...
Epoch: 2 cost time: 1.0635628700256348
Epoch: 2, Steps: 10 | Train Loss: 3.208 Vali Loss: 3.264 Vali Acc: 0.054 Test Loss: 3.264 Test Acc: 0.054
Validation loss decreased (-0.035261 --> -0.054085).  Saving model ...
Epoch: 3 cost time: 0.8325421810150146
Epoch: 3, Steps: 10 | Train Loss: 3.127 Vali Loss: 3.259 Vali Acc: 0.071 Test Loss: 3.259 Test Acc: 0.071
Validation loss decreased (-0.054085 --> -0.070556).  Saving model ...
Epoch: 4 cost time: 0.8068170547485352
Epoch: 4, Steps: 10 | Train Loss: 2.988 Vali Loss: 3.255 Vali Acc: 0.087 Test Loss: 3.255 Test Acc: 0.087
Validation loss decreased (-0.070556 --> -0.087026).  Saving model ...
Epoch: 5 cost time: 0.961970329284668
Epoch: 5, Steps: 10 | Train Loss: 2.836 Vali Loss: 3.249 Vali Acc: 0.096 Test Loss: 3.249 Test Acc: 0.096
Validation loss decreased (-0.087026 --> -0.096438).  Saving model ...
Epoch: 6 cost time: 1.045532464981079
Epoch: 6, Steps: 10 | Train Loss: 2.701 Vali Loss: 3.249 Vali Acc: 0.108 Test Loss: 3.249 Test Acc: 0.108
Validation loss decreased (-0.096438 --> -0.108203).  Saving model ...
Epoch: 7 cost time: 1.057023048400879
Epoch: 7, Steps: 10 | Train Loss: 2.526 Vali Loss: 3.237 Vali Acc: 0.121 Test Loss: 3.237 Test Acc: 0.121
Validation loss decreased (-0.108203 --> -0.121144).  Saving model ...
Epoch: 8 cost time: 1.1405246257781982
Epoch: 8, Steps: 10 | Train Loss: 2.338 Vali Loss: 3.219 Vali Acc: 0.138 Test Loss: 3.219 Test Acc: 0.138
Validation loss decreased (-0.121144 --> -0.137615).  Saving model ...
Epoch: 9 cost time: 1.0396556854248047
Epoch: 9, Steps: 10 | Train Loss: 2.095 Vali Loss: 3.206 Vali Acc: 0.148 Test Loss: 3.206 Test Acc: 0.148
Validation loss decreased (-0.137615 --> -0.148203).  Saving model ...
Epoch: 10 cost time: 1.0546894073486328
Epoch: 10, Steps: 10 | Train Loss: 1.880 Vali Loss: 3.200 Vali Acc: 0.165 Test Loss: 3.200 Test Acc: 0.165
Validation loss decreased (-0.148203 --> -0.164674).  Saving model ...
Epoch: 11 cost time: 0.9764246940612793
Epoch: 11, Steps: 10 | Train Loss: 1.625 Vali Loss: 3.202 Vali Acc: 0.169 Test Loss: 3.202 Test Acc: 0.169
Validation loss decreased (-0.164674 --> -0.169380).  Saving model ...
Epoch: 12 cost time: 0.9503726959228516
Epoch: 12, Steps: 10 | Train Loss: 1.366 Vali Loss: 3.228 Vali Acc: 0.184 Test Loss: 3.228 Test Acc: 0.184
Validation loss decreased (-0.169380 --> -0.183497).  Saving model ...
Epoch: 13 cost time: 1.0427961349487305
Epoch: 13, Steps: 10 | Train Loss: 1.127 Vali Loss: 3.245 Vali Acc: 0.206 Test Loss: 3.245 Test Acc: 0.206
Validation loss decreased (-0.183497 --> -0.205850).  Saving model ...
Epoch: 14 cost time: 1.0349864959716797
Epoch: 14, Steps: 10 | Train Loss: 0.920 Vali Loss: 3.278 Vali Acc: 0.225 Test Loss: 3.278 Test Acc: 0.225
Validation loss decreased (-0.205850 --> -0.224673).  Saving model ...
Epoch: 15 cost time: 1.1478242874145508
Epoch: 15, Steps: 10 | Train Loss: 0.707 Vali Loss: 3.336 Vali Acc: 0.229 Test Loss: 3.336 Test Acc: 0.229
Validation loss decreased (-0.224673 --> -0.229378).  Saving model ...
Epoch: 16 cost time: 0.9590516090393066
Epoch: 16, Steps: 10 | Train Loss: 0.521 Vali Loss: 3.402 Vali Acc: 0.234 Test Loss: 3.402 Test Acc: 0.234
Validation loss decreased (-0.229378 --> -0.234084).  Saving model ...
Epoch: 17 cost time: 1.1733825206756592
Epoch: 17, Steps: 10 | Train Loss: 0.366 Vali Loss: 3.499 Vali Acc: 0.235 Test Loss: 3.499 Test Acc: 0.235
Validation loss decreased (-0.234084 --> -0.235259).  Saving model ...
Epoch: 18 cost time: 1.0698480606079102
Epoch: 18, Steps: 10 | Train Loss: 0.271 Vali Loss: 3.593 Vali Acc: 0.241 Test Loss: 3.593 Test Acc: 0.241
Validation loss decreased (-0.235259 --> -0.241141).  Saving model ...
Epoch: 19 cost time: 1.0189337730407715
Epoch: 19, Steps: 10 | Train Loss: 0.190 Vali Loss: 3.668 Vali Acc: 0.247 Test Loss: 3.668 Test Acc: 0.247
Validation loss decreased (-0.241141 --> -0.247022).  Saving model ...
Epoch: 20 cost time: 1.0091238021850586
Epoch: 20, Steps: 10 | Train Loss: 0.142 Vali Loss: 3.777 Vali Acc: 0.235 Test Loss: 3.777 Test Acc: 0.235
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0408935546875
Epoch: 21, Steps: 10 | Train Loss: 0.104 Vali Loss: 3.866 Vali Acc: 0.232 Test Loss: 3.866 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.974156379699707
Epoch: 22, Steps: 10 | Train Loss: 0.081 Vali Loss: 3.908 Vali Acc: 0.240 Test Loss: 3.908 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.8464388847351074
Epoch: 23, Steps: 10 | Train Loss: 0.061 Vali Loss: 3.953 Vali Acc: 0.242 Test Loss: 3.953 Test Acc: 0.242
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.9014880657196045
Epoch: 24, Steps: 10 | Train Loss: 0.055 Vali Loss: 4.013 Vali Acc: 0.246 Test Loss: 4.013 Test Acc: 0.246
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.00114107131958
Epoch: 25, Steps: 10 | Train Loss: 0.043 Vali Loss: 4.062 Vali Acc: 0.253 Test Loss: 4.062 Test Acc: 0.253
Validation loss decreased (-0.247022 --> -0.252901).  Saving model ...
Epoch: 26 cost time: 1.2382924556732178
Epoch: 26, Steps: 10 | Train Loss: 0.038 Vali Loss: 4.118 Vali Acc: 0.254 Test Loss: 4.118 Test Acc: 0.254
Validation loss decreased (-0.252901 --> -0.254076).  Saving model ...
Epoch: 27 cost time: 1.1643061637878418
Epoch: 27, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.150 Vali Acc: 0.251 Test Loss: 4.150 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0892245769500732
Epoch: 28, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.190 Vali Acc: 0.248 Test Loss: 4.190 Test Acc: 0.248
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.0763163566589355
Epoch: 29, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.218 Vali Acc: 0.253 Test Loss: 4.218 Test Acc: 0.253
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.2590954303741455
Epoch: 30, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.266 Vali Acc: 0.251 Test Loss: 4.266 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.980968713760376
Epoch: 31, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.303 Vali Acc: 0.249 Test Loss: 4.303 Test Acc: 0.249
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.18245267868042
Epoch: 32, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.343 Vali Acc: 0.248 Test Loss: 4.343 Test Acc: 0.248
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.1400117874145508
Epoch: 33, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.377 Vali Acc: 0.251 Test Loss: 4.377 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.1331241130828857
Epoch: 34, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.413 Vali Acc: 0.251 Test Loss: 4.413 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.040869951248169
Epoch: 35, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.444 Vali Acc: 0.251 Test Loss: 4.444 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.2756092548370361
Epoch: 36, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.456 Vali Acc: 0.253 Test Loss: 4.456 Test Acc: 0.253
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps12_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2541176470588235
model parameter : 645434
model size : 2.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.118671178817749
Epoch: 1, Steps: 10 | Train Loss: 3.222 Vali Loss: 3.270 Vali Acc: 0.028 Test Loss: 3.270 Test Acc: 0.028
Validation loss decreased (inf --> -0.028203).  Saving model ...
Epoch: 2 cost time: 0.993476152420044
Epoch: 2, Steps: 10 | Train Loss: 3.181 Vali Loss: 3.269 Vali Acc: 0.039 Test Loss: 3.269 Test Acc: 0.039
Validation loss decreased (-0.028203 --> -0.038791).  Saving model ...
Epoch: 3 cost time: 0.9104945659637451
Epoch: 3, Steps: 10 | Train Loss: 3.101 Vali Loss: 3.264 Vali Acc: 0.059 Test Loss: 3.264 Test Acc: 0.059
Validation loss decreased (-0.038791 --> -0.058791).  Saving model ...
Epoch: 4 cost time: 0.864633321762085
Epoch: 4, Steps: 10 | Train Loss: 3.016 Vali Loss: 3.258 Vali Acc: 0.073 Test Loss: 3.258 Test Acc: 0.073
Validation loss decreased (-0.058791 --> -0.072909).  Saving model ...
Epoch: 5 cost time: 0.9536299705505371
Epoch: 5, Steps: 10 | Train Loss: 2.901 Vali Loss: 3.253 Vali Acc: 0.082 Test Loss: 3.253 Test Acc: 0.082
Validation loss decreased (-0.072909 --> -0.082320).  Saving model ...
Epoch: 6 cost time: 0.9809694290161133
Epoch: 6, Steps: 10 | Train Loss: 2.787 Vali Loss: 3.247 Vali Acc: 0.105 Test Loss: 3.247 Test Acc: 0.105
Validation loss decreased (-0.082320 --> -0.104673).  Saving model ...
Epoch: 7 cost time: 0.9538147449493408
Epoch: 7, Steps: 10 | Train Loss: 2.643 Vali Loss: 3.243 Vali Acc: 0.108 Test Loss: 3.243 Test Acc: 0.108
Validation loss decreased (-0.104673 --> -0.108203).  Saving model ...
Epoch: 8 cost time: 1.1558327674865723
Epoch: 8, Steps: 10 | Train Loss: 2.453 Vali Loss: 3.238 Vali Acc: 0.109 Test Loss: 3.238 Test Acc: 0.109
Validation loss decreased (-0.108203 --> -0.109379).  Saving model ...
Epoch: 9 cost time: 0.8759443759918213
Epoch: 9, Steps: 10 | Train Loss: 2.301 Vali Loss: 3.228 Vali Acc: 0.118 Test Loss: 3.228 Test Acc: 0.118
Validation loss decreased (-0.109379 --> -0.117615).  Saving model ...
Epoch: 10 cost time: 1.000929355621338
Epoch: 10, Steps: 10 | Train Loss: 2.112 Vali Loss: 3.225 Vali Acc: 0.127 Test Loss: 3.225 Test Acc: 0.127
Validation loss decreased (-0.117615 --> -0.127027).  Saving model ...
Epoch: 11 cost time: 1.0226366519927979
Epoch: 11, Steps: 10 | Train Loss: 1.886 Vali Loss: 3.216 Vali Acc: 0.134 Test Loss: 3.216 Test Acc: 0.134
Validation loss decreased (-0.127027 --> -0.134085).  Saving model ...
Epoch: 12 cost time: 1.0697944164276123
Epoch: 12, Steps: 10 | Train Loss: 1.716 Vali Loss: 3.213 Vali Acc: 0.140 Test Loss: 3.213 Test Acc: 0.140
Validation loss decreased (-0.134085 --> -0.139968).  Saving model ...
Epoch: 13 cost time: 0.9979479312896729
Epoch: 13, Steps: 10 | Train Loss: 1.471 Vali Loss: 3.217 Vali Acc: 0.152 Test Loss: 3.217 Test Acc: 0.152
Validation loss decreased (-0.139968 --> -0.151733).  Saving model ...
Epoch: 14 cost time: 0.9327013492584229
Epoch: 14, Steps: 10 | Train Loss: 1.246 Vali Loss: 3.225 Vali Acc: 0.165 Test Loss: 3.225 Test Acc: 0.165
Validation loss decreased (-0.151733 --> -0.164674).  Saving model ...
Epoch: 15 cost time: 0.9582920074462891
Epoch: 15, Steps: 10 | Train Loss: 1.038 Vali Loss: 3.255 Vali Acc: 0.181 Test Loss: 3.255 Test Acc: 0.181
Validation loss decreased (-0.164674 --> -0.181144).  Saving model ...
Epoch: 16 cost time: 0.9119083881378174
Epoch: 16, Steps: 10 | Train Loss: 0.832 Vali Loss: 3.268 Vali Acc: 0.189 Test Loss: 3.268 Test Acc: 0.189
Validation loss decreased (-0.181144 --> -0.189379).  Saving model ...
Epoch: 17 cost time: 1.021484613418579
Epoch: 17, Steps: 10 | Train Loss: 0.663 Vali Loss: 3.330 Vali Acc: 0.202 Test Loss: 3.330 Test Acc: 0.202
Validation loss decreased (-0.189379 --> -0.202320).  Saving model ...
Epoch: 18 cost time: 1.1340901851654053
Epoch: 18, Steps: 10 | Train Loss: 0.498 Vali Loss: 3.392 Vali Acc: 0.201 Test Loss: 3.392 Test Acc: 0.201
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0361709594726562
Epoch: 19, Steps: 10 | Train Loss: 0.377 Vali Loss: 3.435 Vali Acc: 0.211 Test Loss: 3.435 Test Acc: 0.211
Validation loss decreased (-0.202320 --> -0.210554).  Saving model ...
Epoch: 20 cost time: 1.0251119136810303
Epoch: 20, Steps: 10 | Train Loss: 0.278 Vali Loss: 3.500 Vali Acc: 0.221 Test Loss: 3.500 Test Acc: 0.221
Validation loss decreased (-0.210554 --> -0.221141).  Saving model ...
Epoch: 21 cost time: 1.021723985671997
Epoch: 21, Steps: 10 | Train Loss: 0.221 Vali Loss: 3.577 Vali Acc: 0.221 Test Loss: 3.577 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8655376434326172
Epoch: 22, Steps: 10 | Train Loss: 0.154 Vali Loss: 3.640 Vali Acc: 0.231 Test Loss: 3.640 Test Acc: 0.231
Validation loss decreased (-0.221141 --> -0.230552).  Saving model ...
Epoch: 23 cost time: 1.1180248260498047
Epoch: 23, Steps: 10 | Train Loss: 0.127 Vali Loss: 3.712 Vali Acc: 0.234 Test Loss: 3.712 Test Acc: 0.234
Validation loss decreased (-0.230552 --> -0.234081).  Saving model ...
Epoch: 24 cost time: 1.1318180561065674
Epoch: 24, Steps: 10 | Train Loss: 0.094 Vali Loss: 3.787 Vali Acc: 0.226 Test Loss: 3.787 Test Acc: 0.226
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0378522872924805
Epoch: 25, Steps: 10 | Train Loss: 0.078 Vali Loss: 3.839 Vali Acc: 0.227 Test Loss: 3.839 Test Acc: 0.227
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.1474149227142334
Epoch: 26, Steps: 10 | Train Loss: 0.063 Vali Loss: 3.886 Vali Acc: 0.233 Test Loss: 3.886 Test Acc: 0.233
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.9419682025909424
Epoch: 27, Steps: 10 | Train Loss: 0.055 Vali Loss: 3.931 Vali Acc: 0.233 Test Loss: 3.931 Test Acc: 0.233
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.961862325668335
Epoch: 28, Steps: 10 | Train Loss: 0.049 Vali Loss: 3.974 Vali Acc: 0.233 Test Loss: 3.974 Test Acc: 0.233
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.8602149486541748
Epoch: 29, Steps: 10 | Train Loss: 0.038 Vali Loss: 4.008 Vali Acc: 0.238 Test Loss: 4.008 Test Acc: 0.238
Validation loss decreased (-0.234081 --> -0.237607).  Saving model ...
Epoch: 30 cost time: 1.0305366516113281
Epoch: 30, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.038 Vali Acc: 0.240 Test Loss: 4.038 Test Acc: 0.240
Validation loss decreased (-0.237607 --> -0.239960).  Saving model ...
Epoch: 31 cost time: 1.0417194366455078
Epoch: 31, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.082 Vali Acc: 0.239 Test Loss: 4.082 Test Acc: 0.239
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.9136073589324951
Epoch: 32, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.116 Vali Acc: 0.242 Test Loss: 4.116 Test Acc: 0.242
Validation loss decreased (-0.239960 --> -0.242312).  Saving model ...
Epoch: 33 cost time: 1.1168651580810547
Epoch: 33, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.143 Vali Acc: 0.244 Test Loss: 4.143 Test Acc: 0.244
Validation loss decreased (-0.242312 --> -0.243488).  Saving model ...
Epoch: 34 cost time: 1.1046533584594727
Epoch: 34, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.167 Vali Acc: 0.245 Test Loss: 4.167 Test Acc: 0.245
Validation loss decreased (-0.243488 --> -0.244664).  Saving model ...
Epoch: 35 cost time: 1.0949428081512451
Epoch: 35, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.198 Vali Acc: 0.247 Test Loss: 4.198 Test Acc: 0.247
Validation loss decreased (-0.244664 --> -0.247017).  Saving model ...
Epoch: 36 cost time: 1.094428539276123
Epoch: 36, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.229 Vali Acc: 0.245 Test Loss: 4.229 Test Acc: 0.245
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.1331827640533447
Epoch: 37, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.257 Vali Acc: 0.245 Test Loss: 4.257 Test Acc: 0.245
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.8935110569000244
Epoch: 38, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.308 Vali Acc: 0.239 Test Loss: 4.308 Test Acc: 0.239
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.9710328578948975
Epoch: 39, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.330 Vali Acc: 0.235 Test Loss: 4.330 Test Acc: 0.235
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.042140007019043
Epoch: 40, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.345 Vali Acc: 0.246 Test Loss: 4.345 Test Acc: 0.246
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.9832890033721924
Epoch: 41, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.380 Vali Acc: 0.246 Test Loss: 4.380 Test Acc: 0.246
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.9772388935089111
Epoch: 42, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.396 Vali Acc: 0.241 Test Loss: 4.396 Test Acc: 0.241
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.932323694229126
Epoch: 43, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.408 Vali Acc: 0.244 Test Loss: 4.408 Test Acc: 0.244
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.8982481956481934
Epoch: 44, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.433 Vali Acc: 0.240 Test Loss: 4.433 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 1.0845229625701904
Epoch: 45, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.471 Vali Acc: 0.245 Test Loss: 4.471 Test Acc: 0.245
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.24705882352941178
model parameter : 625594
model size : 2.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps23_str12_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.528867483139038
Epoch: 1, Steps: 10 | Train Loss: 3.278 Vali Loss: 3.271 Vali Acc: 0.044 Test Loss: 3.271 Test Acc: 0.044
Validation loss decreased (inf --> -0.043497).  Saving model ...
Epoch: 2 cost time: 1.0347120761871338
Epoch: 2, Steps: 10 | Train Loss: 3.252 Vali Loss: 3.271 Vali Acc: 0.038 Test Loss: 3.271 Test Acc: 0.038
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0574963092803955
Epoch: 3, Steps: 10 | Train Loss: 3.183 Vali Loss: 3.266 Vali Acc: 0.052 Test Loss: 3.266 Test Acc: 0.052
Validation loss decreased (-0.043497 --> -0.051732).  Saving model ...
Epoch: 4 cost time: 1.162569284439087
Epoch: 4, Steps: 10 | Train Loss: 3.094 Vali Loss: 3.260 Vali Acc: 0.064 Test Loss: 3.260 Test Acc: 0.064
Validation loss decreased (-0.051732 --> -0.063497).  Saving model ...
Epoch: 5 cost time: 0.9557125568389893
Epoch: 5, Steps: 10 | Train Loss: 3.002 Vali Loss: 3.253 Vali Acc: 0.072 Test Loss: 3.253 Test Acc: 0.072
Validation loss decreased (-0.063497 --> -0.071732).  Saving model ...
Epoch: 6 cost time: 0.9969463348388672
Epoch: 6, Steps: 10 | Train Loss: 2.900 Vali Loss: 3.246 Vali Acc: 0.085 Test Loss: 3.246 Test Acc: 0.085
Validation loss decreased (-0.071732 --> -0.084673).  Saving model ...
Epoch: 7 cost time: 1.1837248802185059
Epoch: 7, Steps: 10 | Train Loss: 2.790 Vali Loss: 3.242 Vali Acc: 0.091 Test Loss: 3.242 Test Acc: 0.091
Validation loss decreased (-0.084673 --> -0.090556).  Saving model ...
Epoch: 8 cost time: 0.7726356983184814
Epoch: 8, Steps: 10 | Train Loss: 2.676 Vali Loss: 3.237 Vali Acc: 0.108 Test Loss: 3.237 Test Acc: 0.108
Validation loss decreased (-0.090556 --> -0.108203).  Saving model ...
Epoch: 9 cost time: 0.8876354694366455
Epoch: 9, Steps: 10 | Train Loss: 2.553 Vali Loss: 3.235 Vali Acc: 0.116 Test Loss: 3.235 Test Acc: 0.116
Validation loss decreased (-0.108203 --> -0.116438).  Saving model ...
Epoch: 10 cost time: 1.1425528526306152
Epoch: 10, Steps: 10 | Train Loss: 2.397 Vali Loss: 3.232 Vali Acc: 0.128 Test Loss: 3.232 Test Acc: 0.128
Validation loss decreased (-0.116438 --> -0.128203).  Saving model ...
Epoch: 11 cost time: 1.0761001110076904
Epoch: 11, Steps: 10 | Train Loss: 2.258 Vali Loss: 3.225 Vali Acc: 0.135 Test Loss: 3.225 Test Acc: 0.135
Validation loss decreased (-0.128203 --> -0.135262).  Saving model ...
Epoch: 12 cost time: 1.1764333248138428
Epoch: 12, Steps: 10 | Train Loss: 2.080 Vali Loss: 3.222 Vali Acc: 0.142 Test Loss: 3.222 Test Acc: 0.142
Validation loss decreased (-0.135262 --> -0.142321).  Saving model ...
Epoch: 13 cost time: 1.229417324066162
Epoch: 13, Steps: 10 | Train Loss: 1.930 Vali Loss: 3.221 Vali Acc: 0.154 Test Loss: 3.221 Test Acc: 0.154
Validation loss decreased (-0.142321 --> -0.154085).  Saving model ...
Epoch: 14 cost time: 0.8925139904022217
Epoch: 14, Steps: 10 | Train Loss: 1.735 Vali Loss: 3.219 Vali Acc: 0.166 Test Loss: 3.219 Test Acc: 0.166
Validation loss decreased (-0.154085 --> -0.165850).  Saving model ...
Epoch: 15 cost time: 1.0791525840759277
Epoch: 15, Steps: 10 | Train Loss: 1.564 Vali Loss: 3.224 Vali Acc: 0.174 Test Loss: 3.224 Test Acc: 0.174
Validation loss decreased (-0.165850 --> -0.174085).  Saving model ...
Epoch: 16 cost time: 0.9734573364257812
Epoch: 16, Steps: 10 | Train Loss: 1.341 Vali Loss: 3.237 Vali Acc: 0.181 Test Loss: 3.237 Test Acc: 0.181
Validation loss decreased (-0.174085 --> -0.181144).  Saving model ...
Epoch: 17 cost time: 1.058528184890747
Epoch: 17, Steps: 10 | Train Loss: 1.176 Vali Loss: 3.257 Vali Acc: 0.194 Test Loss: 3.257 Test Acc: 0.194
Validation loss decreased (-0.181144 --> -0.194085).  Saving model ...
Epoch: 18 cost time: 0.9944801330566406
Epoch: 18, Steps: 10 | Train Loss: 1.051 Vali Loss: 3.288 Vali Acc: 0.196 Test Loss: 3.288 Test Acc: 0.196
Validation loss decreased (-0.194085 --> -0.196438).  Saving model ...
Epoch: 19 cost time: 1.1347410678863525
Epoch: 19, Steps: 10 | Train Loss: 0.809 Vali Loss: 3.330 Vali Acc: 0.201 Test Loss: 3.330 Test Acc: 0.201
Validation loss decreased (-0.196438 --> -0.201143).  Saving model ...
Epoch: 20 cost time: 0.9069709777832031
Epoch: 20, Steps: 10 | Train Loss: 0.676 Vali Loss: 3.372 Vali Acc: 0.219 Test Loss: 3.372 Test Acc: 0.219
Validation loss decreased (-0.201143 --> -0.218790).  Saving model ...
Epoch: 21 cost time: 1.0858709812164307
Epoch: 21, Steps: 10 | Train Loss: 0.539 Vali Loss: 3.419 Vali Acc: 0.220 Test Loss: 3.419 Test Acc: 0.220
Validation loss decreased (-0.218790 --> -0.219966).  Saving model ...
Epoch: 22 cost time: 1.1213438510894775
Epoch: 22, Steps: 10 | Train Loss: 0.404 Vali Loss: 3.484 Vali Acc: 0.229 Test Loss: 3.484 Test Acc: 0.229
Validation loss decreased (-0.219966 --> -0.229377).  Saving model ...
Epoch: 23 cost time: 0.9371798038482666
Epoch: 23, Steps: 10 | Train Loss: 0.339 Vali Loss: 3.553 Vali Acc: 0.225 Test Loss: 3.553 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0156936645507812
Epoch: 24, Steps: 10 | Train Loss: 0.262 Vali Loss: 3.637 Vali Acc: 0.236 Test Loss: 3.637 Test Acc: 0.236
Validation loss decreased (-0.229377 --> -0.236434).  Saving model ...
Epoch: 25 cost time: 0.9304423332214355
Epoch: 25, Steps: 10 | Train Loss: 0.205 Vali Loss: 3.706 Vali Acc: 0.234 Test Loss: 3.706 Test Acc: 0.234
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9715354442596436
Epoch: 26, Steps: 10 | Train Loss: 0.157 Vali Loss: 3.809 Vali Acc: 0.229 Test Loss: 3.809 Test Acc: 0.229
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.123995304107666
Epoch: 27, Steps: 10 | Train Loss: 0.131 Vali Loss: 3.850 Vali Acc: 0.233 Test Loss: 3.850 Test Acc: 0.233
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.9665260314941406
Epoch: 28, Steps: 10 | Train Loss: 0.115 Vali Loss: 3.901 Vali Acc: 0.233 Test Loss: 3.901 Test Acc: 0.233
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.9596505165100098
Epoch: 29, Steps: 10 | Train Loss: 0.092 Vali Loss: 3.945 Vali Acc: 0.235 Test Loss: 3.945 Test Acc: 0.235
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.8346827030181885
Epoch: 30, Steps: 10 | Train Loss: 0.078 Vali Loss: 4.000 Vali Acc: 0.234 Test Loss: 4.000 Test Acc: 0.234
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.159749984741211
Epoch: 31, Steps: 10 | Train Loss: 0.074 Vali Loss: 4.035 Vali Acc: 0.235 Test Loss: 4.035 Test Acc: 0.235
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.062870740890503
Epoch: 32, Steps: 10 | Train Loss: 0.056 Vali Loss: 4.094 Vali Acc: 0.232 Test Loss: 4.094 Test Acc: 0.232
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.9909439086914062
Epoch: 33, Steps: 10 | Train Loss: 0.051 Vali Loss: 4.166 Vali Acc: 0.231 Test Loss: 4.166 Test Acc: 0.231
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.0943055152893066
Epoch: 34, Steps: 10 | Train Loss: 0.044 Vali Loss: 4.234 Vali Acc: 0.231 Test Loss: 4.234 Test Acc: 0.231
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps23_str12_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.23647058823529413
model parameter : 605850
model size : 2.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.067842483520508
Epoch: 1, Steps: 10 | Train Loss: 3.267 Vali Loss: 3.257 Vali Acc: 0.051 Test Loss: 3.257 Test Acc: 0.051
Validation loss decreased (inf --> -0.050556).  Saving model ...
Epoch: 2 cost time: 0.9522504806518555
Epoch: 2, Steps: 10 | Train Loss: 3.245 Vali Loss: 3.253 Vali Acc: 0.060 Test Loss: 3.253 Test Acc: 0.060
Validation loss decreased (-0.050556 --> -0.059967).  Saving model ...
Epoch: 3 cost time: 1.105928659439087
Epoch: 3, Steps: 10 | Train Loss: 3.175 Vali Loss: 3.246 Vali Acc: 0.065 Test Loss: 3.246 Test Acc: 0.065
Validation loss decreased (-0.059967 --> -0.064673).  Saving model ...
Epoch: 4 cost time: 1.042421579360962
Epoch: 4, Steps: 10 | Train Loss: 3.094 Vali Loss: 3.236 Vali Acc: 0.072 Test Loss: 3.236 Test Acc: 0.072
Validation loss decreased (-0.064673 --> -0.071732).  Saving model ...
Epoch: 5 cost time: 0.8590240478515625
Epoch: 5, Steps: 10 | Train Loss: 3.012 Vali Loss: 3.227 Vali Acc: 0.082 Test Loss: 3.227 Test Acc: 0.082
Validation loss decreased (-0.071732 --> -0.082321).  Saving model ...
Epoch: 6 cost time: 1.0685901641845703
Epoch: 6, Steps: 10 | Train Loss: 2.912 Vali Loss: 3.220 Vali Acc: 0.094 Test Loss: 3.220 Test Acc: 0.094
Validation loss decreased (-0.082321 --> -0.094085).  Saving model ...
Epoch: 7 cost time: 1.009916067123413
Epoch: 7, Steps: 10 | Train Loss: 2.828 Vali Loss: 3.215 Vali Acc: 0.096 Test Loss: 3.215 Test Acc: 0.096
Validation loss decreased (-0.094085 --> -0.096438).  Saving model ...
Epoch: 8 cost time: 0.9533302783966064
Epoch: 8, Steps: 10 | Train Loss: 2.691 Vali Loss: 3.210 Vali Acc: 0.104 Test Loss: 3.210 Test Acc: 0.104
Validation loss decreased (-0.096438 --> -0.103497).  Saving model ...
Epoch: 9 cost time: 0.8792235851287842
Epoch: 9, Steps: 10 | Train Loss: 2.584 Vali Loss: 3.206 Vali Acc: 0.108 Test Loss: 3.206 Test Acc: 0.108
Validation loss decreased (-0.103497 --> -0.108203).  Saving model ...
Epoch: 10 cost time: 1.1306183338165283
Epoch: 10, Steps: 10 | Train Loss: 2.448 Vali Loss: 3.201 Vali Acc: 0.122 Test Loss: 3.201 Test Acc: 0.122
Validation loss decreased (-0.108203 --> -0.122321).  Saving model ...
Epoch: 11 cost time: 1.0962023735046387
Epoch: 11, Steps: 10 | Train Loss: 2.318 Vali Loss: 3.201 Vali Acc: 0.132 Test Loss: 3.201 Test Acc: 0.132
Validation loss decreased (-0.122321 --> -0.131733).  Saving model ...
Epoch: 12 cost time: 0.9281485080718994
Epoch: 12, Steps: 10 | Train Loss: 2.137 Vali Loss: 3.194 Vali Acc: 0.138 Test Loss: 3.194 Test Acc: 0.138
Validation loss decreased (-0.131733 --> -0.137615).  Saving model ...
Epoch: 13 cost time: 1.1468133926391602
Epoch: 13, Steps: 10 | Train Loss: 2.006 Vali Loss: 3.188 Vali Acc: 0.144 Test Loss: 3.188 Test Acc: 0.144
Validation loss decreased (-0.137615 --> -0.143498).  Saving model ...
Epoch: 14 cost time: 1.0421946048736572
Epoch: 14, Steps: 10 | Train Loss: 1.806 Vali Loss: 3.189 Vali Acc: 0.151 Test Loss: 3.189 Test Acc: 0.151
Validation loss decreased (-0.143498 --> -0.150556).  Saving model ...
Epoch: 15 cost time: 1.0854682922363281
Epoch: 15, Steps: 10 | Train Loss: 1.652 Vali Loss: 3.195 Vali Acc: 0.164 Test Loss: 3.195 Test Acc: 0.164
Validation loss decreased (-0.150556 --> -0.163497).  Saving model ...
Epoch: 16 cost time: 1.036858081817627
Epoch: 16, Steps: 10 | Train Loss: 1.448 Vali Loss: 3.201 Vali Acc: 0.180 Test Loss: 3.201 Test Acc: 0.180
Validation loss decreased (-0.163497 --> -0.179968).  Saving model ...
Epoch: 17 cost time: 0.9699573516845703
Epoch: 17, Steps: 10 | Train Loss: 1.284 Vali Loss: 3.225 Vali Acc: 0.193 Test Loss: 3.225 Test Acc: 0.193
Validation loss decreased (-0.179968 --> -0.192909).  Saving model ...
Epoch: 18 cost time: 0.9565107822418213
Epoch: 18, Steps: 10 | Train Loss: 1.100 Vali Loss: 3.246 Vali Acc: 0.193 Test Loss: 3.246 Test Acc: 0.193
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0597641468048096
Epoch: 19, Steps: 10 | Train Loss: 0.944 Vali Loss: 3.283 Vali Acc: 0.194 Test Loss: 3.283 Test Acc: 0.194
Validation loss decreased (-0.192909 --> -0.194085).  Saving model ...
Epoch: 20 cost time: 0.9340393543243408
Epoch: 20, Steps: 10 | Train Loss: 0.788 Vali Loss: 3.319 Vali Acc: 0.198 Test Loss: 3.319 Test Acc: 0.198
Validation loss decreased (-0.194085 --> -0.197614).  Saving model ...
Epoch: 21 cost time: 0.9110872745513916
Epoch: 21, Steps: 10 | Train Loss: 0.637 Vali Loss: 3.359 Vali Acc: 0.211 Test Loss: 3.359 Test Acc: 0.211
Validation loss decreased (-0.197614 --> -0.210555).  Saving model ...
Epoch: 22 cost time: 1.0690414905548096
Epoch: 22, Steps: 10 | Train Loss: 0.524 Vali Loss: 3.420 Vali Acc: 0.216 Test Loss: 3.420 Test Acc: 0.216
Validation loss decreased (-0.210555 --> -0.216436).  Saving model ...
Epoch: 23 cost time: 0.9916098117828369
Epoch: 23, Steps: 10 | Train Loss: 0.412 Vali Loss: 3.479 Vali Acc: 0.227 Test Loss: 3.479 Test Acc: 0.227
Validation loss decreased (-0.216436 --> -0.227024).  Saving model ...
Epoch: 24 cost time: 1.0103998184204102
Epoch: 24, Steps: 10 | Train Loss: 0.345 Vali Loss: 3.551 Vali Acc: 0.224 Test Loss: 3.551 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.088146448135376
Epoch: 25, Steps: 10 | Train Loss: 0.269 Vali Loss: 3.614 Vali Acc: 0.231 Test Loss: 3.614 Test Acc: 0.231
Validation loss decreased (-0.227024 --> -0.230552).  Saving model ...
Epoch: 26 cost time: 1.0505702495574951
Epoch: 26, Steps: 10 | Train Loss: 0.199 Vali Loss: 3.678 Vali Acc: 0.227 Test Loss: 3.678 Test Acc: 0.227
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.066709280014038
Epoch: 27, Steps: 10 | Train Loss: 0.160 Vali Loss: 3.745 Vali Acc: 0.232 Test Loss: 3.745 Test Acc: 0.232
Validation loss decreased (-0.230552 --> -0.231727).  Saving model ...
Epoch: 28 cost time: 1.1244175434112549
Epoch: 28, Steps: 10 | Train Loss: 0.128 Vali Loss: 3.791 Vali Acc: 0.234 Test Loss: 3.791 Test Acc: 0.234
Validation loss decreased (-0.231727 --> -0.234080).  Saving model ...
Epoch: 29 cost time: 1.0676887035369873
Epoch: 29, Steps: 10 | Train Loss: 0.112 Vali Loss: 3.844 Vali Acc: 0.242 Test Loss: 3.844 Test Acc: 0.242
Validation loss decreased (-0.234080 --> -0.242315).  Saving model ...
Epoch: 30 cost time: 0.9540059566497803
Epoch: 30, Steps: 10 | Train Loss: 0.101 Vali Loss: 3.904 Vali Acc: 0.241 Test Loss: 3.904 Test Acc: 0.241
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.0875930786132812
Epoch: 31, Steps: 10 | Train Loss: 0.078 Vali Loss: 3.976 Vali Acc: 0.240 Test Loss: 3.976 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.9337012767791748
Epoch: 32, Steps: 10 | Train Loss: 0.071 Vali Loss: 4.028 Vali Acc: 0.226 Test Loss: 4.028 Test Acc: 0.226
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.053844928741455
Epoch: 33, Steps: 10 | Train Loss: 0.058 Vali Loss: 4.072 Vali Acc: 0.235 Test Loss: 4.072 Test Acc: 0.235
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.990288496017456
Epoch: 34, Steps: 10 | Train Loss: 0.049 Vali Loss: 4.118 Vali Acc: 0.227 Test Loss: 4.118 Test Acc: 0.227
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.0554966926574707
Epoch: 35, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.151 Vali Acc: 0.231 Test Loss: 4.151 Test Acc: 0.231
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.8878874778747559
Epoch: 36, Steps: 10 | Train Loss: 0.041 Vali Loss: 4.181 Vali Acc: 0.240 Test Loss: 4.181 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.0324311256408691
Epoch: 37, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.227 Vali Acc: 0.241 Test Loss: 4.227 Test Acc: 0.241
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.1056759357452393
Epoch: 38, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.280 Vali Acc: 0.232 Test Loss: 4.280 Test Acc: 0.232
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.8588442802429199
Epoch: 39, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.320 Vali Acc: 0.231 Test Loss: 4.320 Test Acc: 0.231
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.24235294117647058
model parameter : 606106
model size : 2.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps38_str19_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.122255563735962
Epoch: 1, Steps: 10 | Train Loss: 3.282 Vali Loss: 3.272 Vali Acc: 0.026 Test Loss: 3.272 Test Acc: 0.026
Validation loss decreased (inf --> -0.025850).  Saving model ...
Epoch: 2 cost time: 0.8601198196411133
Epoch: 2, Steps: 10 | Train Loss: 3.243 Vali Loss: 3.275 Vali Acc: 0.035 Test Loss: 3.275 Test Acc: 0.035
Validation loss decreased (-0.025850 --> -0.035261).  Saving model ...
Epoch: 3 cost time: 1.054187536239624
Epoch: 3, Steps: 10 | Train Loss: 3.195 Vali Loss: 3.271 Vali Acc: 0.040 Test Loss: 3.271 Test Acc: 0.040
Validation loss decreased (-0.035261 --> -0.039967).  Saving model ...
Epoch: 4 cost time: 1.118070125579834
Epoch: 4, Steps: 10 | Train Loss: 3.120 Vali Loss: 3.265 Vali Acc: 0.039 Test Loss: 3.265 Test Acc: 0.039
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0936803817749023
Epoch: 5, Steps: 10 | Train Loss: 3.068 Vali Loss: 3.256 Vali Acc: 0.046 Test Loss: 3.256 Test Acc: 0.046
Validation loss decreased (-0.039967 --> -0.045850).  Saving model ...
Epoch: 6 cost time: 0.9406049251556396
Epoch: 6, Steps: 10 | Train Loss: 2.982 Vali Loss: 3.247 Vali Acc: 0.058 Test Loss: 3.247 Test Acc: 0.058
Validation loss decreased (-0.045850 --> -0.057615).  Saving model ...
Epoch: 7 cost time: 1.0663278102874756
Epoch: 7, Steps: 10 | Train Loss: 2.904 Vali Loss: 3.239 Vali Acc: 0.071 Test Loss: 3.239 Test Acc: 0.071
Validation loss decreased (-0.057615 --> -0.070556).  Saving model ...
Epoch: 8 cost time: 1.1407136917114258
Epoch: 8, Steps: 10 | Train Loss: 2.784 Vali Loss: 3.231 Vali Acc: 0.088 Test Loss: 3.231 Test Acc: 0.088
Validation loss decreased (-0.070556 --> -0.088203).  Saving model ...
Epoch: 9 cost time: 1.0926096439361572
Epoch: 9, Steps: 10 | Train Loss: 2.696 Vali Loss: 3.224 Vali Acc: 0.112 Test Loss: 3.224 Test Acc: 0.112
Validation loss decreased (-0.088203 --> -0.111732).  Saving model ...
Epoch: 10 cost time: 0.9100382328033447
Epoch: 10, Steps: 10 | Train Loss: 2.595 Vali Loss: 3.219 Vali Acc: 0.115 Test Loss: 3.219 Test Acc: 0.115
Validation loss decreased (-0.111732 --> -0.115262).  Saving model ...
Epoch: 11 cost time: 1.054490566253662
Epoch: 11, Steps: 10 | Train Loss: 2.463 Vali Loss: 3.212 Vali Acc: 0.135 Test Loss: 3.212 Test Acc: 0.135
Validation loss decreased (-0.115262 --> -0.135262).  Saving model ...
Epoch: 12 cost time: 1.0604515075683594
Epoch: 12, Steps: 10 | Train Loss: 2.333 Vali Loss: 3.207 Vali Acc: 0.141 Test Loss: 3.207 Test Acc: 0.141
Validation loss decreased (-0.135262 --> -0.141144).  Saving model ...
Epoch: 13 cost time: 0.981849193572998
Epoch: 13, Steps: 10 | Train Loss: 2.177 Vali Loss: 3.206 Vali Acc: 0.146 Test Loss: 3.206 Test Acc: 0.146
Validation loss decreased (-0.141144 --> -0.145850).  Saving model ...
Epoch: 14 cost time: 0.7529923915863037
Epoch: 14, Steps: 10 | Train Loss: 2.062 Vali Loss: 3.210 Vali Acc: 0.152 Test Loss: 3.210 Test Acc: 0.152
Validation loss decreased (-0.145850 --> -0.151733).  Saving model ...
Epoch: 15 cost time: 0.8628146648406982
Epoch: 15, Steps: 10 | Train Loss: 1.878 Vali Loss: 3.209 Vali Acc: 0.165 Test Loss: 3.209 Test Acc: 0.165
Validation loss decreased (-0.151733 --> -0.164674).  Saving model ...
Epoch: 16 cost time: 0.9665887355804443
Epoch: 16, Steps: 10 | Train Loss: 1.674 Vali Loss: 3.210 Vali Acc: 0.173 Test Loss: 3.210 Test Acc: 0.173
Validation loss decreased (-0.164674 --> -0.172909).  Saving model ...
Epoch: 17 cost time: 1.0519661903381348
Epoch: 17, Steps: 10 | Train Loss: 1.528 Vali Loss: 3.222 Vali Acc: 0.191 Test Loss: 3.222 Test Acc: 0.191
Validation loss decreased (-0.172909 --> -0.190556).  Saving model ...
Epoch: 18 cost time: 1.064826250076294
Epoch: 18, Steps: 10 | Train Loss: 1.355 Vali Loss: 3.241 Vali Acc: 0.194 Test Loss: 3.241 Test Acc: 0.194
Validation loss decreased (-0.190556 --> -0.194085).  Saving model ...
Epoch: 19 cost time: 1.0318200588226318
Epoch: 19, Steps: 10 | Train Loss: 1.168 Vali Loss: 3.265 Vali Acc: 0.201 Test Loss: 3.265 Test Acc: 0.201
Validation loss decreased (-0.194085 --> -0.201144).  Saving model ...
Epoch: 20 cost time: 0.9736361503601074
Epoch: 20, Steps: 10 | Train Loss: 1.023 Vali Loss: 3.295 Vali Acc: 0.200 Test Loss: 3.295 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0993030071258545
Epoch: 21, Steps: 10 | Train Loss: 0.884 Vali Loss: 3.338 Vali Acc: 0.208 Test Loss: 3.338 Test Acc: 0.208
Validation loss decreased (-0.201144 --> -0.208202).  Saving model ...
Epoch: 22 cost time: 0.9688780307769775
Epoch: 22, Steps: 10 | Train Loss: 0.724 Vali Loss: 3.367 Vali Acc: 0.212 Test Loss: 3.367 Test Acc: 0.212
Validation loss decreased (-0.208202 --> -0.211731).  Saving model ...
Epoch: 23 cost time: 1.1181297302246094
Epoch: 23, Steps: 10 | Train Loss: 0.590 Vali Loss: 3.404 Vali Acc: 0.227 Test Loss: 3.404 Test Acc: 0.227
Validation loss decreased (-0.211731 --> -0.227025).  Saving model ...
Epoch: 24 cost time: 1.0439538955688477
Epoch: 24, Steps: 10 | Train Loss: 0.470 Vali Loss: 3.474 Vali Acc: 0.232 Test Loss: 3.474 Test Acc: 0.232
Validation loss decreased (-0.227025 --> -0.231730).  Saving model ...
Epoch: 25 cost time: 1.027411937713623
Epoch: 25, Steps: 10 | Train Loss: 0.398 Vali Loss: 3.549 Vali Acc: 0.233 Test Loss: 3.549 Test Acc: 0.233
Validation loss decreased (-0.231730 --> -0.232906).  Saving model ...
Epoch: 26 cost time: 1.0660555362701416
Epoch: 26, Steps: 10 | Train Loss: 0.314 Vali Loss: 3.587 Vali Acc: 0.229 Test Loss: 3.587 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0552425384521484
Epoch: 27, Steps: 10 | Train Loss: 0.259 Vali Loss: 3.668 Vali Acc: 0.229 Test Loss: 3.668 Test Acc: 0.229
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.9074194431304932
Epoch: 28, Steps: 10 | Train Loss: 0.209 Vali Loss: 3.726 Vali Acc: 0.231 Test Loss: 3.726 Test Acc: 0.231
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.8683953285217285
Epoch: 29, Steps: 10 | Train Loss: 0.185 Vali Loss: 3.773 Vali Acc: 0.221 Test Loss: 3.773 Test Acc: 0.221
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.0860402584075928
Epoch: 30, Steps: 10 | Train Loss: 0.142 Vali Loss: 3.851 Vali Acc: 0.224 Test Loss: 3.851 Test Acc: 0.224
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.1133124828338623
Epoch: 31, Steps: 10 | Train Loss: 0.128 Vali Loss: 3.876 Vali Acc: 0.231 Test Loss: 3.876 Test Acc: 0.231
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.0641074180603027
Epoch: 32, Steps: 10 | Train Loss: 0.097 Vali Loss: 3.953 Vali Acc: 0.224 Test Loss: 3.953 Test Acc: 0.224
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.890505313873291
Epoch: 33, Steps: 10 | Train Loss: 0.089 Vali Loss: 4.055 Vali Acc: 0.224 Test Loss: 4.055 Test Acc: 0.224
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.9366683959960938
Epoch: 34, Steps: 10 | Train Loss: 0.070 Vali Loss: 4.115 Vali Acc: 0.220 Test Loss: 4.115 Test Acc: 0.220
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.9130706787109375
Epoch: 35, Steps: 10 | Train Loss: 0.061 Vali Loss: 4.124 Vali Acc: 0.226 Test Loss: 4.124 Test Acc: 0.226
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps38_str19_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.23294117647058823
model parameter : 596346
model size : 2.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.399369478225708
Epoch: 1, Steps: 10 | Train Loss: 3.283 Vali Loss: 3.264 Vali Acc: 0.040 Test Loss: 3.264 Test Acc: 0.040
Validation loss decreased (inf --> -0.039967).  Saving model ...
Epoch: 2 cost time: 1.1062712669372559
Epoch: 2, Steps: 10 | Train Loss: 3.150 Vali Loss: 3.256 Vali Acc: 0.047 Test Loss: 3.256 Test Acc: 0.047
Validation loss decreased (-0.039967 --> -0.047026).  Saving model ...
Epoch: 3 cost time: 1.1412830352783203
Epoch: 3, Steps: 10 | Train Loss: 2.958 Vali Loss: 3.253 Vali Acc: 0.072 Test Loss: 3.253 Test Acc: 0.072
Validation loss decreased (-0.047026 --> -0.071732).  Saving model ...
Epoch: 4 cost time: 0.7983548641204834
Epoch: 4, Steps: 10 | Train Loss: 2.690 Vali Loss: 3.247 Vali Acc: 0.107 Test Loss: 3.247 Test Acc: 0.107
Validation loss decreased (-0.071732 --> -0.107026).  Saving model ...
Epoch: 5 cost time: 1.1748015880584717
Epoch: 5, Steps: 10 | Train Loss: 2.368 Vali Loss: 3.230 Vali Acc: 0.122 Test Loss: 3.230 Test Acc: 0.122
Validation loss decreased (-0.107026 --> -0.122321).  Saving model ...
Epoch: 6 cost time: 1.254441261291504
Epoch: 6, Steps: 10 | Train Loss: 2.010 Vali Loss: 3.213 Vali Acc: 0.152 Test Loss: 3.213 Test Acc: 0.152
Validation loss decreased (-0.122321 --> -0.151733).  Saving model ...
Epoch: 7 cost time: 1.169952392578125
Epoch: 7, Steps: 10 | Train Loss: 1.614 Vali Loss: 3.193 Vali Acc: 0.166 Test Loss: 3.193 Test Acc: 0.166
Validation loss decreased (-0.151733 --> -0.165850).  Saving model ...
Epoch: 8 cost time: 1.150200366973877
Epoch: 8, Steps: 10 | Train Loss: 1.190 Vali Loss: 3.234 Vali Acc: 0.185 Test Loss: 3.234 Test Acc: 0.185
Validation loss decreased (-0.165850 --> -0.184674).  Saving model ...
Epoch: 9 cost time: 1.1132915019989014
Epoch: 9, Steps: 10 | Train Loss: 0.812 Vali Loss: 3.303 Vali Acc: 0.206 Test Loss: 3.303 Test Acc: 0.206
Validation loss decreased (-0.184674 --> -0.205849).  Saving model ...
Epoch: 10 cost time: 1.0251243114471436
Epoch: 10, Steps: 10 | Train Loss: 0.501 Vali Loss: 3.449 Vali Acc: 0.226 Test Loss: 3.449 Test Acc: 0.226
Validation loss decreased (-0.205849 --> -0.225848).  Saving model ...
Epoch: 11 cost time: 0.9609529972076416
Epoch: 11, Steps: 10 | Train Loss: 0.301 Vali Loss: 3.618 Vali Acc: 0.241 Test Loss: 3.618 Test Acc: 0.241
Validation loss decreased (-0.225848 --> -0.241140).  Saving model ...
Epoch: 12 cost time: 0.9345598220825195
Epoch: 12, Steps: 10 | Train Loss: 0.181 Vali Loss: 3.761 Vali Acc: 0.242 Test Loss: 3.761 Test Acc: 0.242
Validation loss decreased (-0.241140 --> -0.242315).  Saving model ...
Epoch: 13 cost time: 0.9208059310913086
Epoch: 13, Steps: 10 | Train Loss: 0.088 Vali Loss: 3.919 Vali Acc: 0.246 Test Loss: 3.919 Test Acc: 0.246
Validation loss decreased (-0.242315 --> -0.245843).  Saving model ...
Epoch: 14 cost time: 1.1552529335021973
Epoch: 14, Steps: 10 | Train Loss: 0.049 Vali Loss: 4.101 Vali Acc: 0.247 Test Loss: 4.101 Test Acc: 0.247
Validation loss decreased (-0.245843 --> -0.247018).  Saving model ...
Epoch: 15 cost time: 1.2191064357757568
Epoch: 15, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.163 Vali Acc: 0.253 Test Loss: 4.163 Test Acc: 0.253
Validation loss decreased (-0.247018 --> -0.252900).  Saving model ...
Epoch: 16 cost time: 1.1609179973602295
Epoch: 16, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.217 Vali Acc: 0.261 Test Loss: 4.217 Test Acc: 0.261
Validation loss decreased (-0.252900 --> -0.261134).  Saving model ...
Epoch: 17 cost time: 1.1634936332702637
Epoch: 17, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.277 Vali Acc: 0.255 Test Loss: 4.277 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1342785358428955
Epoch: 18, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.341 Vali Acc: 0.259 Test Loss: 4.341 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9999206066131592
Epoch: 19, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.397 Vali Acc: 0.260 Test Loss: 4.397 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.0802061557769775
Epoch: 20, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.443 Vali Acc: 0.259 Test Loss: 4.443 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.13407564163208
Epoch: 21, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.458 Vali Acc: 0.266 Test Loss: 4.458 Test Acc: 0.266
Validation loss decreased (-0.261134 --> -0.265838).  Saving model ...
Epoch: 22 cost time: 1.1257617473602295
Epoch: 22, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.506 Vali Acc: 0.264 Test Loss: 4.506 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9224348068237305
Epoch: 23, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.540 Vali Acc: 0.264 Test Loss: 4.540 Test Acc: 0.264
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.0078551769256592
Epoch: 24, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.572 Vali Acc: 0.262 Test Loss: 4.572 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.256096363067627
Epoch: 25, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.604 Vali Acc: 0.260 Test Loss: 4.604 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.2402679920196533
Epoch: 26, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.636 Vali Acc: 0.260 Test Loss: 4.636 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.2052204608917236
Epoch: 27, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.664 Vali Acc: 0.261 Test Loss: 4.664 Test Acc: 0.261
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.2569053173065186
Epoch: 28, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.686 Vali Acc: 0.262 Test Loss: 4.686 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.1676898002624512
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.715 Vali Acc: 0.262 Test Loss: 4.715 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.0616540908813477
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.748 Vali Acc: 0.261 Test Loss: 4.748 Test Acc: 0.261
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.0630762577056885
Epoch: 31, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.771 Vali Acc: 0.261 Test Loss: 4.771 Test Acc: 0.261
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26588235294117646
model parameter : 762298
model size : 2.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.1829946041107178
Epoch: 1, Steps: 10 | Train Loss: 3.313 Vali Loss: 3.259 Vali Acc: 0.038 Test Loss: 3.259 Test Acc: 0.038
Validation loss decreased (inf --> -0.037614).  Saving model ...
Epoch: 2 cost time: 0.995880126953125
Epoch: 2, Steps: 10 | Train Loss: 3.223 Vali Loss: 3.250 Vali Acc: 0.035 Test Loss: 3.250 Test Acc: 0.035
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1622838973999023
Epoch: 3, Steps: 10 | Train Loss: 3.075 Vali Loss: 3.239 Vali Acc: 0.062 Test Loss: 3.239 Test Acc: 0.062
Validation loss decreased (-0.037614 --> -0.062321).  Saving model ...
Epoch: 4 cost time: 1.2024824619293213
Epoch: 4, Steps: 10 | Train Loss: 2.932 Vali Loss: 3.234 Vali Acc: 0.074 Test Loss: 3.234 Test Acc: 0.074
Validation loss decreased (-0.062321 --> -0.074085).  Saving model ...
Epoch: 5 cost time: 1.173903226852417
Epoch: 5, Steps: 10 | Train Loss: 2.753 Vali Loss: 3.233 Vali Acc: 0.082 Test Loss: 3.233 Test Acc: 0.082
Validation loss decreased (-0.074085 --> -0.082321).  Saving model ...
Epoch: 6 cost time: 1.0723779201507568
Epoch: 6, Steps: 10 | Train Loss: 2.532 Vali Loss: 3.220 Vali Acc: 0.089 Test Loss: 3.220 Test Acc: 0.089
Validation loss decreased (-0.082321 --> -0.089380).  Saving model ...
Epoch: 7 cost time: 1.1482930183410645
Epoch: 7, Steps: 10 | Train Loss: 2.286 Vali Loss: 3.197 Vali Acc: 0.118 Test Loss: 3.197 Test Acc: 0.118
Validation loss decreased (-0.089380 --> -0.117615).  Saving model ...
Epoch: 8 cost time: 1.2215471267700195
Epoch: 8, Steps: 10 | Train Loss: 2.003 Vali Loss: 3.183 Vali Acc: 0.134 Test Loss: 3.183 Test Acc: 0.134
Validation loss decreased (-0.117615 --> -0.134086).  Saving model ...
Epoch: 9 cost time: 1.0865211486816406
Epoch: 9, Steps: 10 | Train Loss: 1.731 Vali Loss: 3.180 Vali Acc: 0.152 Test Loss: 3.180 Test Acc: 0.152
Validation loss decreased (-0.134086 --> -0.151733).  Saving model ...
Epoch: 10 cost time: 1.0962154865264893
Epoch: 10, Steps: 10 | Train Loss: 1.439 Vali Loss: 3.202 Vali Acc: 0.167 Test Loss: 3.202 Test Acc: 0.167
Validation loss decreased (-0.151733 --> -0.167027).  Saving model ...
Epoch: 11 cost time: 1.0440058708190918
Epoch: 11, Steps: 10 | Train Loss: 1.144 Vali Loss: 3.218 Vali Acc: 0.200 Test Loss: 3.218 Test Acc: 0.200
Validation loss decreased (-0.167027 --> -0.199968).  Saving model ...
Epoch: 12 cost time: 0.9071533679962158
Epoch: 12, Steps: 10 | Train Loss: 0.855 Vali Loss: 3.271 Vali Acc: 0.222 Test Loss: 3.271 Test Acc: 0.222
Validation loss decreased (-0.199968 --> -0.222320).  Saving model ...
Epoch: 13 cost time: 1.0680410861968994
Epoch: 13, Steps: 10 | Train Loss: 0.635 Vali Loss: 3.349 Vali Acc: 0.229 Test Loss: 3.349 Test Acc: 0.229
Validation loss decreased (-0.222320 --> -0.229378).  Saving model ...
Epoch: 14 cost time: 1.1614694595336914
Epoch: 14, Steps: 10 | Train Loss: 0.422 Vali Loss: 3.427 Vali Acc: 0.244 Test Loss: 3.427 Test Acc: 0.244
Validation loss decreased (-0.229378 --> -0.243495).  Saving model ...
Epoch: 15 cost time: 1.1232452392578125
Epoch: 15, Steps: 10 | Train Loss: 0.302 Vali Loss: 3.545 Vali Acc: 0.246 Test Loss: 3.545 Test Acc: 0.246
Validation loss decreased (-0.243495 --> -0.245847).  Saving model ...
Epoch: 16 cost time: 1.197099208831787
Epoch: 16, Steps: 10 | Train Loss: 0.192 Vali Loss: 3.629 Vali Acc: 0.253 Test Loss: 3.629 Test Acc: 0.253
Validation loss decreased (-0.245847 --> -0.252905).  Saving model ...
Epoch: 17 cost time: 1.3361146450042725
Epoch: 17, Steps: 10 | Train Loss: 0.128 Vali Loss: 3.775 Vali Acc: 0.244 Test Loss: 3.775 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2213945388793945
Epoch: 18, Steps: 10 | Train Loss: 0.087 Vali Loss: 3.875 Vali Acc: 0.248 Test Loss: 3.875 Test Acc: 0.248
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.2328674793243408
Epoch: 19, Steps: 10 | Train Loss: 0.062 Vali Loss: 3.932 Vali Acc: 0.253 Test Loss: 3.932 Test Acc: 0.253
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.247307538986206
Epoch: 20, Steps: 10 | Train Loss: 0.048 Vali Loss: 3.972 Vali Acc: 0.256 Test Loss: 3.972 Test Acc: 0.256
Validation loss decreased (-0.252905 --> -0.256431).  Saving model ...
Epoch: 21 cost time: 1.384382724761963
Epoch: 21, Steps: 10 | Train Loss: 0.039 Vali Loss: 4.044 Vali Acc: 0.253 Test Loss: 4.044 Test Acc: 0.253
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1844394207000732
Epoch: 22, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.094 Vali Acc: 0.255 Test Loss: 4.094 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0953900814056396
Epoch: 23, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.126 Vali Acc: 0.258 Test Loss: 4.126 Test Acc: 0.258
Validation loss decreased (-0.256431 --> -0.257606).  Saving model ...
Epoch: 24 cost time: 1.1395444869995117
Epoch: 24, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.172 Vali Acc: 0.264 Test Loss: 4.172 Test Acc: 0.264
Validation loss decreased (-0.257606 --> -0.263488).  Saving model ...
Epoch: 25 cost time: 1.2102012634277344
Epoch: 25, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.214 Vali Acc: 0.265 Test Loss: 4.214 Test Acc: 0.265
Validation loss decreased (-0.263488 --> -0.264664).  Saving model ...
Epoch: 26 cost time: 1.1690013408660889
Epoch: 26, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.253 Vali Acc: 0.264 Test Loss: 4.253 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1430859565734863
Epoch: 27, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.287 Vali Acc: 0.265 Test Loss: 4.287 Test Acc: 0.265
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.0009727478027344
Epoch: 28, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.314 Vali Acc: 0.266 Test Loss: 4.314 Test Acc: 0.266
Validation loss decreased (-0.264664 --> -0.265839).  Saving model ...
Epoch: 29 cost time: 1.1351215839385986
Epoch: 29, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.347 Vali Acc: 0.268 Test Loss: 4.347 Test Acc: 0.268
Validation loss decreased (-0.265839 --> -0.268192).  Saving model ...
Epoch: 30 cost time: 1.0091664791107178
Epoch: 30, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.368 Vali Acc: 0.272 Test Loss: 4.368 Test Acc: 0.272
Validation loss decreased (-0.268192 --> -0.271721).  Saving model ...
Epoch: 31 cost time: 1.1407761573791504
Epoch: 31, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.400 Vali Acc: 0.269 Test Loss: 4.400 Test Acc: 0.269
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.012712001800537
Epoch: 32, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.428 Vali Acc: 0.272 Test Loss: 4.428 Test Acc: 0.272
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.1547672748565674
Epoch: 33, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.463 Vali Acc: 0.269 Test Loss: 4.463 Test Acc: 0.269
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.213648796081543
Epoch: 34, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.496 Vali Acc: 0.273 Test Loss: 4.496 Test Acc: 0.273
Validation loss decreased (-0.271721 --> -0.272896).  Saving model ...
Epoch: 35 cost time: 1.3727691173553467
Epoch: 35, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.525 Vali Acc: 0.272 Test Loss: 4.525 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.0916130542755127
Epoch: 36, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.557 Vali Acc: 0.262 Test Loss: 4.557 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.0680179595947266
Epoch: 37, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.575 Vali Acc: 0.264 Test Loss: 4.575 Test Acc: 0.264
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.1647236347198486
Epoch: 38, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.603 Vali Acc: 0.265 Test Loss: 4.603 Test Acc: 0.265
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.2939887046813965
Epoch: 39, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.617 Vali Acc: 0.267 Test Loss: 4.617 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.2957489490509033
Epoch: 40, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.629 Vali Acc: 0.267 Test Loss: 4.629 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.2492163181304932
Epoch: 41, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.655 Vali Acc: 0.266 Test Loss: 4.655 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.2117819786071777
Epoch: 42, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.670 Vali Acc: 0.268 Test Loss: 4.670 Test Acc: 0.268
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 1.0883312225341797
Epoch: 43, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.695 Vali Acc: 0.268 Test Loss: 4.695 Test Acc: 0.268
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 1.1233887672424316
Epoch: 44, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.713 Vali Acc: 0.269 Test Loss: 4.713 Test Acc: 0.269
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27294117647058824
model parameter : 672570
model size : 2.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps12_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.226402997970581
Epoch: 1, Steps: 10 | Train Loss: 3.283 Vali Loss: 3.267 Vali Acc: 0.033 Test Loss: 3.267 Test Acc: 0.033
Validation loss decreased (inf --> -0.032909).  Saving model ...
Epoch: 2 cost time: 1.0746843814849854
Epoch: 2, Steps: 10 | Train Loss: 3.199 Vali Loss: 3.265 Vali Acc: 0.052 Test Loss: 3.265 Test Acc: 0.052
Validation loss decreased (-0.032909 --> -0.051732).  Saving model ...
Epoch: 3 cost time: 1.1849501132965088
Epoch: 3, Steps: 10 | Train Loss: 3.100 Vali Loss: 3.259 Vali Acc: 0.073 Test Loss: 3.259 Test Acc: 0.073
Validation loss decreased (-0.051732 --> -0.072909).  Saving model ...
Epoch: 4 cost time: 1.076791763305664
Epoch: 4, Steps: 10 | Train Loss: 2.999 Vali Loss: 3.258 Vali Acc: 0.072 Test Loss: 3.258 Test Acc: 0.072
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1376957893371582
Epoch: 5, Steps: 10 | Train Loss: 2.827 Vali Loss: 3.252 Vali Acc: 0.085 Test Loss: 3.252 Test Acc: 0.085
Validation loss decreased (-0.072909 --> -0.084673).  Saving model ...
Epoch: 6 cost time: 1.0785596370697021
Epoch: 6, Steps: 10 | Train Loss: 2.674 Vali Loss: 3.246 Vali Acc: 0.094 Test Loss: 3.246 Test Acc: 0.094
Validation loss decreased (-0.084673 --> -0.094085).  Saving model ...
Epoch: 7 cost time: 1.0748951435089111
Epoch: 7, Steps: 10 | Train Loss: 2.504 Vali Loss: 3.235 Vali Acc: 0.111 Test Loss: 3.235 Test Acc: 0.111
Validation loss decreased (-0.094085 --> -0.110556).  Saving model ...
Epoch: 8 cost time: 1.0848324298858643
Epoch: 8, Steps: 10 | Train Loss: 2.355 Vali Loss: 3.227 Vali Acc: 0.121 Test Loss: 3.227 Test Acc: 0.121
Validation loss decreased (-0.110556 --> -0.121144).  Saving model ...
Epoch: 9 cost time: 1.0818936824798584
Epoch: 9, Steps: 10 | Train Loss: 2.108 Vali Loss: 3.207 Vali Acc: 0.138 Test Loss: 3.207 Test Acc: 0.138
Validation loss decreased (-0.121144 --> -0.137615).  Saving model ...
Epoch: 10 cost time: 1.0250248908996582
Epoch: 10, Steps: 10 | Train Loss: 1.852 Vali Loss: 3.201 Vali Acc: 0.152 Test Loss: 3.201 Test Acc: 0.152
Validation loss decreased (-0.137615 --> -0.151733).  Saving model ...
Epoch: 11 cost time: 1.2386057376861572
Epoch: 11, Steps: 10 | Train Loss: 1.639 Vali Loss: 3.193 Vali Acc: 0.158 Test Loss: 3.193 Test Acc: 0.158
Validation loss decreased (-0.151733 --> -0.157615).  Saving model ...
Epoch: 12 cost time: 1.2391941547393799
Epoch: 12, Steps: 10 | Train Loss: 1.343 Vali Loss: 3.210 Vali Acc: 0.159 Test Loss: 3.210 Test Acc: 0.159
Validation loss decreased (-0.157615 --> -0.158791).  Saving model ...
Epoch: 13 cost time: 1.1687612533569336
Epoch: 13, Steps: 10 | Train Loss: 1.128 Vali Loss: 3.233 Vali Acc: 0.179 Test Loss: 3.233 Test Acc: 0.179
Validation loss decreased (-0.158791 --> -0.178791).  Saving model ...
Epoch: 14 cost time: 1.1007962226867676
Epoch: 14, Steps: 10 | Train Loss: 0.895 Vali Loss: 3.269 Vali Acc: 0.199 Test Loss: 3.269 Test Acc: 0.199
Validation loss decreased (-0.178791 --> -0.198791).  Saving model ...
Epoch: 15 cost time: 1.068880558013916
Epoch: 15, Steps: 10 | Train Loss: 0.704 Vali Loss: 3.319 Vali Acc: 0.212 Test Loss: 3.319 Test Acc: 0.212
Validation loss decreased (-0.198791 --> -0.211732).  Saving model ...
Epoch: 16 cost time: 1.3291244506835938
Epoch: 16, Steps: 10 | Train Loss: 0.529 Vali Loss: 3.376 Vali Acc: 0.220 Test Loss: 3.376 Test Acc: 0.220
Validation loss decreased (-0.211732 --> -0.219966).  Saving model ...
Epoch: 17 cost time: 1.1443626880645752
Epoch: 17, Steps: 10 | Train Loss: 0.366 Vali Loss: 3.456 Vali Acc: 0.226 Test Loss: 3.456 Test Acc: 0.226
Validation loss decreased (-0.219966 --> -0.225848).  Saving model ...
Epoch: 18 cost time: 1.127394676208496
Epoch: 18, Steps: 10 | Train Loss: 0.274 Vali Loss: 3.548 Vali Acc: 0.233 Test Loss: 3.548 Test Acc: 0.233
Validation loss decreased (-0.225848 --> -0.232906).  Saving model ...
Epoch: 19 cost time: 1.123936414718628
Epoch: 19, Steps: 10 | Train Loss: 0.210 Vali Loss: 3.654 Vali Acc: 0.234 Test Loss: 3.654 Test Acc: 0.234
Validation loss decreased (-0.232906 --> -0.234081).  Saving model ...
Epoch: 20 cost time: 1.058410406112671
Epoch: 20, Steps: 10 | Train Loss: 0.137 Vali Loss: 3.742 Vali Acc: 0.238 Test Loss: 3.742 Test Acc: 0.238
Validation loss decreased (-0.234081 --> -0.237610).  Saving model ...
Epoch: 21 cost time: 1.0437242984771729
Epoch: 21, Steps: 10 | Train Loss: 0.112 Vali Loss: 3.812 Vali Acc: 0.235 Test Loss: 3.812 Test Acc: 0.235
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0935778617858887
Epoch: 22, Steps: 10 | Train Loss: 0.086 Vali Loss: 3.876 Vali Acc: 0.233 Test Loss: 3.876 Test Acc: 0.233
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.1431512832641602
Epoch: 23, Steps: 10 | Train Loss: 0.065 Vali Loss: 3.918 Vali Acc: 0.233 Test Loss: 3.918 Test Acc: 0.233
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.9974892139434814
Epoch: 24, Steps: 10 | Train Loss: 0.050 Vali Loss: 3.965 Vali Acc: 0.234 Test Loss: 3.965 Test Acc: 0.234
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.0323307514190674
Epoch: 25, Steps: 10 | Train Loss: 0.044 Vali Loss: 4.008 Vali Acc: 0.235 Test Loss: 4.008 Test Acc: 0.235
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.0045416355133057
Epoch: 26, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.053 Vali Acc: 0.239 Test Loss: 4.053 Test Acc: 0.239
Validation loss decreased (-0.237610 --> -0.238783).  Saving model ...
Epoch: 27 cost time: 0.9821224212646484
Epoch: 27, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.086 Vali Acc: 0.244 Test Loss: 4.086 Test Acc: 0.244
Validation loss decreased (-0.238783 --> -0.243489).  Saving model ...
Epoch: 28 cost time: 1.1647555828094482
Epoch: 28, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.129 Vali Acc: 0.239 Test Loss: 4.129 Test Acc: 0.239
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.2310528755187988
Epoch: 29, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.174 Vali Acc: 0.244 Test Loss: 4.174 Test Acc: 0.244
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.0375359058380127
Epoch: 30, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.208 Vali Acc: 0.242 Test Loss: 4.208 Test Acc: 0.242
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.1913940906524658
Epoch: 31, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.250 Vali Acc: 0.240 Test Loss: 4.250 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.0869524478912354
Epoch: 32, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.283 Vali Acc: 0.241 Test Loss: 4.283 Test Acc: 0.241
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.1457319259643555
Epoch: 33, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.291 Vali Acc: 0.241 Test Loss: 4.291 Test Acc: 0.241
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.077249526977539
Epoch: 34, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.310 Vali Acc: 0.244 Test Loss: 4.310 Test Acc: 0.244
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.2146594524383545
Epoch: 35, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.337 Vali Acc: 0.247 Test Loss: 4.337 Test Acc: 0.247
Validation loss decreased (-0.243489 --> -0.247015).  Saving model ...
Epoch: 36 cost time: 1.238447904586792
Epoch: 36, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.361 Vali Acc: 0.242 Test Loss: 4.361 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.0074882507324219
Epoch: 37, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.378 Vali Acc: 0.245 Test Loss: 4.378 Test Acc: 0.245
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.1813914775848389
Epoch: 38, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.432 Vali Acc: 0.245 Test Loss: 4.432 Test Acc: 0.245
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.9298510551452637
Epoch: 39, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.466 Vali Acc: 0.245 Test Loss: 4.466 Test Acc: 0.245
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.0938060283660889
Epoch: 40, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.499 Vali Acc: 0.244 Test Loss: 4.499 Test Acc: 0.244
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.9574055671691895
Epoch: 41, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.510 Vali Acc: 0.241 Test Loss: 4.510 Test Acc: 0.241
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.8859274387359619
Epoch: 42, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.526 Vali Acc: 0.242 Test Loss: 4.526 Test Acc: 0.242
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.1632356643676758
Epoch: 43, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.553 Vali Acc: 0.244 Test Loss: 4.553 Test Acc: 0.244
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.0783514976501465
Epoch: 44, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.563 Vali Acc: 0.244 Test Loss: 4.563 Test Acc: 0.244
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.9150476455688477
Epoch: 45, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.595 Vali Acc: 0.248 Test Loss: 4.595 Test Acc: 0.248
Validation loss decreased (-0.247015 --> -0.248189).  Saving model ...
Epoch: 46 cost time: 1.141035795211792
Epoch: 46, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.615 Vali Acc: 0.245 Test Loss: 4.615 Test Acc: 0.245
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.2154431343078613
Epoch: 47, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.629 Vali Acc: 0.244 Test Loss: 4.629 Test Acc: 0.244
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.1275560855865479
Epoch: 48, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.660 Vali Acc: 0.247 Test Loss: 4.660 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.2101061344146729
Epoch: 49, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.669 Vali Acc: 0.248 Test Loss: 4.669 Test Acc: 0.248
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.9902844429016113
Epoch: 50, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.688 Vali Acc: 0.245 Test Loss: 4.688 Test Acc: 0.245
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps12_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.24823529411764705
model parameter : 642746
model size : 2.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.227808952331543
Epoch: 1, Steps: 10 | Train Loss: 3.282 Vali Loss: 3.264 Vali Acc: 0.045 Test Loss: 3.264 Test Acc: 0.045
Validation loss decreased (inf --> -0.044673).  Saving model ...
Epoch: 2 cost time: 1.1993129253387451
Epoch: 2, Steps: 10 | Train Loss: 3.247 Vali Loss: 3.261 Vali Acc: 0.055 Test Loss: 3.261 Test Acc: 0.055
Validation loss decreased (-0.044673 --> -0.055262).  Saving model ...
Epoch: 3 cost time: 1.053645372390747
Epoch: 3, Steps: 10 | Train Loss: 3.147 Vali Loss: 3.252 Vali Acc: 0.053 Test Loss: 3.252 Test Acc: 0.053
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1182522773742676
Epoch: 4, Steps: 10 | Train Loss: 3.041 Vali Loss: 3.243 Vali Acc: 0.065 Test Loss: 3.243 Test Acc: 0.065
Validation loss decreased (-0.055262 --> -0.064673).  Saving model ...
Epoch: 5 cost time: 1.175079345703125
Epoch: 5, Steps: 10 | Train Loss: 2.933 Vali Loss: 3.234 Vali Acc: 0.076 Test Loss: 3.234 Test Acc: 0.076
Validation loss decreased (-0.064673 --> -0.076438).  Saving model ...
Epoch: 6 cost time: 1.1505036354064941
Epoch: 6, Steps: 10 | Train Loss: 2.797 Vali Loss: 3.225 Vali Acc: 0.086 Test Loss: 3.225 Test Acc: 0.086
Validation loss decreased (-0.076438 --> -0.085850).  Saving model ...
Epoch: 7 cost time: 1.0152173042297363
Epoch: 7, Steps: 10 | Train Loss: 2.667 Vali Loss: 3.221 Vali Acc: 0.099 Test Loss: 3.221 Test Acc: 0.099
Validation loss decreased (-0.085850 --> -0.098791).  Saving model ...
Epoch: 8 cost time: 1.2535614967346191
Epoch: 8, Steps: 10 | Train Loss: 2.476 Vali Loss: 3.207 Vali Acc: 0.113 Test Loss: 3.207 Test Acc: 0.113
Validation loss decreased (-0.098791 --> -0.112909).  Saving model ...
Epoch: 9 cost time: 1.0833230018615723
Epoch: 9, Steps: 10 | Train Loss: 2.357 Vali Loss: 3.199 Vali Acc: 0.115 Test Loss: 3.199 Test Acc: 0.115
Validation loss decreased (-0.112909 --> -0.115262).  Saving model ...
Epoch: 10 cost time: 1.1063182353973389
Epoch: 10, Steps: 10 | Train Loss: 2.116 Vali Loss: 3.181 Vali Acc: 0.134 Test Loss: 3.181 Test Acc: 0.134
Validation loss decreased (-0.115262 --> -0.134086).  Saving model ...
Epoch: 11 cost time: 1.0598704814910889
Epoch: 11, Steps: 10 | Train Loss: 1.933 Vali Loss: 3.170 Vali Acc: 0.146 Test Loss: 3.170 Test Acc: 0.146
Validation loss decreased (-0.134086 --> -0.145851).  Saving model ...
Epoch: 12 cost time: 1.0980219841003418
Epoch: 12, Steps: 10 | Train Loss: 1.709 Vali Loss: 3.165 Vali Acc: 0.151 Test Loss: 3.165 Test Acc: 0.151
Validation loss decreased (-0.145851 --> -0.150557).  Saving model ...
Epoch: 13 cost time: 0.9605488777160645
Epoch: 13, Steps: 10 | Train Loss: 1.510 Vali Loss: 3.164 Vali Acc: 0.162 Test Loss: 3.164 Test Acc: 0.162
Validation loss decreased (-0.150557 --> -0.162321).  Saving model ...
Epoch: 14 cost time: 0.9519505500793457
Epoch: 14, Steps: 10 | Train Loss: 1.246 Vali Loss: 3.174 Vali Acc: 0.173 Test Loss: 3.174 Test Acc: 0.173
Validation loss decreased (-0.162321 --> -0.172909).  Saving model ...
Epoch: 15 cost time: 1.1621572971343994
Epoch: 15, Steps: 10 | Train Loss: 1.050 Vali Loss: 3.200 Vali Acc: 0.184 Test Loss: 3.200 Test Acc: 0.184
Validation loss decreased (-0.172909 --> -0.183497).  Saving model ...
Epoch: 16 cost time: 1.1762471199035645
Epoch: 16, Steps: 10 | Train Loss: 0.832 Vali Loss: 3.240 Vali Acc: 0.192 Test Loss: 3.240 Test Acc: 0.192
Validation loss decreased (-0.183497 --> -0.191732).  Saving model ...
Epoch: 17 cost time: 1.217613935470581
Epoch: 17, Steps: 10 | Train Loss: 0.674 Vali Loss: 3.280 Vali Acc: 0.207 Test Loss: 3.280 Test Acc: 0.207
Validation loss decreased (-0.191732 --> -0.207026).  Saving model ...
Epoch: 18 cost time: 1.2205348014831543
Epoch: 18, Steps: 10 | Train Loss: 0.501 Vali Loss: 3.342 Vali Acc: 0.218 Test Loss: 3.342 Test Acc: 0.218
Validation loss decreased (-0.207026 --> -0.217614).  Saving model ...
Epoch: 19 cost time: 1.2286078929901123
Epoch: 19, Steps: 10 | Train Loss: 0.392 Vali Loss: 3.408 Vali Acc: 0.227 Test Loss: 3.408 Test Acc: 0.227
Validation loss decreased (-0.217614 --> -0.227025).  Saving model ...
Epoch: 20 cost time: 1.1845808029174805
Epoch: 20, Steps: 10 | Train Loss: 0.292 Vali Loss: 3.467 Vali Acc: 0.238 Test Loss: 3.467 Test Acc: 0.238
Validation loss decreased (-0.227025 --> -0.237612).  Saving model ...
Epoch: 21 cost time: 1.1697986125946045
Epoch: 21, Steps: 10 | Train Loss: 0.225 Vali Loss: 3.536 Vali Acc: 0.236 Test Loss: 3.536 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1528925895690918
Epoch: 22, Steps: 10 | Train Loss: 0.172 Vali Loss: 3.609 Vali Acc: 0.245 Test Loss: 3.609 Test Acc: 0.245
Validation loss decreased (-0.237612 --> -0.244670).  Saving model ...
Epoch: 23 cost time: 1.2238578796386719
Epoch: 23, Steps: 10 | Train Loss: 0.129 Vali Loss: 3.667 Vali Acc: 0.244 Test Loss: 3.667 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0587682723999023
Epoch: 24, Steps: 10 | Train Loss: 0.104 Vali Loss: 3.733 Vali Acc: 0.246 Test Loss: 3.733 Test Acc: 0.246
Validation loss decreased (-0.244670 --> -0.245845).  Saving model ...
Epoch: 25 cost time: 1.1060967445373535
Epoch: 25, Steps: 10 | Train Loss: 0.089 Vali Loss: 3.775 Vali Acc: 0.248 Test Loss: 3.775 Test Acc: 0.248
Validation loss decreased (-0.245845 --> -0.248198).  Saving model ...
Epoch: 26 cost time: 1.2607767581939697
Epoch: 26, Steps: 10 | Train Loss: 0.067 Vali Loss: 3.801 Vali Acc: 0.254 Test Loss: 3.801 Test Acc: 0.254
Validation loss decreased (-0.248198 --> -0.254080).  Saving model ...
Epoch: 27 cost time: 1.2290074825286865
Epoch: 27, Steps: 10 | Train Loss: 0.061 Vali Loss: 3.868 Vali Acc: 0.253 Test Loss: 3.868 Test Acc: 0.253
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.120427131652832
Epoch: 28, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.920 Vali Acc: 0.254 Test Loss: 3.920 Test Acc: 0.254
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.2097911834716797
Epoch: 29, Steps: 10 | Train Loss: 0.042 Vali Loss: 3.978 Vali Acc: 0.253 Test Loss: 3.978 Test Acc: 0.253
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.1559176445007324
Epoch: 30, Steps: 10 | Train Loss: 0.036 Vali Loss: 3.997 Vali Acc: 0.252 Test Loss: 3.997 Test Acc: 0.252
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.0655395984649658
Epoch: 31, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.031 Vali Acc: 0.252 Test Loss: 4.031 Test Acc: 0.252
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.2105963230133057
Epoch: 32, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.071 Vali Acc: 0.251 Test Loss: 4.071 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.989689826965332
Epoch: 33, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.107 Vali Acc: 0.249 Test Loss: 4.107 Test Acc: 0.249
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.0768468379974365
Epoch: 34, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.110 Vali Acc: 0.251 Test Loss: 4.110 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.077488660812378
Epoch: 35, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.147 Vali Acc: 0.253 Test Loss: 4.147 Test Acc: 0.253
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.117605447769165
Epoch: 36, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.193 Vali Acc: 0.258 Test Loss: 4.193 Test Acc: 0.258
Validation loss decreased (-0.254080 --> -0.257605).  Saving model ...
Epoch: 37 cost time: 0.9213283061981201
Epoch: 37, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.234 Vali Acc: 0.258 Test Loss: 4.234 Test Acc: 0.258
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.1540799140930176
Epoch: 38, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.264 Vali Acc: 0.251 Test Loss: 4.264 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.04547119140625
Epoch: 39, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.284 Vali Acc: 0.255 Test Loss: 4.284 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.1790010929107666
Epoch: 40, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.290 Vali Acc: 0.258 Test Loss: 4.290 Test Acc: 0.258
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.287351369857788
Epoch: 41, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.303 Vali Acc: 0.260 Test Loss: 4.303 Test Acc: 0.260
Validation loss decreased (-0.257605 --> -0.259957).  Saving model ...
Epoch: 42 cost time: 1.0940172672271729
Epoch: 42, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.314 Vali Acc: 0.262 Test Loss: 4.314 Test Acc: 0.262
Validation loss decreased (-0.259957 --> -0.262310).  Saving model ...
Epoch: 43 cost time: 1.1384692192077637
Epoch: 43, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.341 Vali Acc: 0.260 Test Loss: 4.341 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.2453372478485107
Epoch: 44, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.381 Vali Acc: 0.256 Test Loss: 4.381 Test Acc: 0.256
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.0023009777069092
Epoch: 45, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.404 Vali Acc: 0.258 Test Loss: 4.404 Test Acc: 0.258
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.0145103931427002
Epoch: 46, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.451 Vali Acc: 0.259 Test Loss: 4.451 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.156853437423706
Epoch: 47, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.476 Vali Acc: 0.261 Test Loss: 4.476 Test Acc: 0.261
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.049288034439087
Epoch: 48, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.506 Vali Acc: 0.262 Test Loss: 4.506 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.92952561378479
Epoch: 49, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.527 Vali Acc: 0.258 Test Loss: 4.527 Test Acc: 0.258
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.996589183807373
Epoch: 50, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.527 Vali Acc: 0.262 Test Loss: 4.527 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26235294117647057
model parameter : 622906
model size : 2.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps23_str12_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.289825201034546
Epoch: 1, Steps: 10 | Train Loss: 3.301 Vali Loss: 3.257 Vali Acc: 0.067 Test Loss: 3.257 Test Acc: 0.067
Validation loss decreased (inf --> -0.067026).  Saving model ...
Epoch: 2 cost time: 1.0790481567382812
Epoch: 2, Steps: 10 | Train Loss: 3.263 Vali Loss: 3.254 Vali Acc: 0.069 Test Loss: 3.254 Test Acc: 0.069
Validation loss decreased (-0.067026 --> -0.069379).  Saving model ...
Epoch: 3 cost time: 1.0444884300231934
Epoch: 3, Steps: 10 | Train Loss: 3.179 Vali Loss: 3.246 Vali Acc: 0.073 Test Loss: 3.246 Test Acc: 0.073
Validation loss decreased (-0.069379 --> -0.072909).  Saving model ...
Epoch: 4 cost time: 0.9921174049377441
Epoch: 4, Steps: 10 | Train Loss: 3.093 Vali Loss: 3.235 Vali Acc: 0.071 Test Loss: 3.235 Test Acc: 0.071
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0967895984649658
Epoch: 5, Steps: 10 | Train Loss: 3.020 Vali Loss: 3.225 Vali Acc: 0.073 Test Loss: 3.225 Test Acc: 0.073
Validation loss decreased (-0.072909 --> -0.072909).  Saving model ...
Epoch: 6 cost time: 0.8689169883728027
Epoch: 6, Steps: 10 | Train Loss: 2.899 Vali Loss: 3.214 Vali Acc: 0.091 Test Loss: 3.214 Test Acc: 0.091
Validation loss decreased (-0.072909 --> -0.090556).  Saving model ...
Epoch: 7 cost time: 0.995110273361206
Epoch: 7, Steps: 10 | Train Loss: 2.792 Vali Loss: 3.205 Vali Acc: 0.106 Test Loss: 3.205 Test Acc: 0.106
Validation loss decreased (-0.090556 --> -0.105850).  Saving model ...
Epoch: 8 cost time: 1.1422913074493408
Epoch: 8, Steps: 10 | Train Loss: 2.680 Vali Loss: 3.199 Vali Acc: 0.111 Test Loss: 3.199 Test Acc: 0.111
Validation loss decreased (-0.105850 --> -0.110556).  Saving model ...
Epoch: 9 cost time: 1.0408949851989746
Epoch: 9, Steps: 10 | Train Loss: 2.528 Vali Loss: 3.192 Vali Acc: 0.119 Test Loss: 3.192 Test Acc: 0.119
Validation loss decreased (-0.110556 --> -0.118792).  Saving model ...
Epoch: 10 cost time: 1.07371187210083
Epoch: 10, Steps: 10 | Train Loss: 2.408 Vali Loss: 3.191 Vali Acc: 0.126 Test Loss: 3.191 Test Acc: 0.126
Validation loss decreased (-0.118792 --> -0.125850).  Saving model ...
Epoch: 11 cost time: 1.082428216934204
Epoch: 11, Steps: 10 | Train Loss: 2.224 Vali Loss: 3.188 Vali Acc: 0.135 Test Loss: 3.188 Test Acc: 0.135
Validation loss decreased (-0.125850 --> -0.135262).  Saving model ...
Epoch: 12 cost time: 1.2080729007720947
Epoch: 12, Steps: 10 | Train Loss: 2.060 Vali Loss: 3.186 Vali Acc: 0.144 Test Loss: 3.186 Test Acc: 0.144
Validation loss decreased (-0.135262 --> -0.143498).  Saving model ...
Epoch: 13 cost time: 1.1360909938812256
Epoch: 13, Steps: 10 | Train Loss: 1.904 Vali Loss: 3.194 Vali Acc: 0.149 Test Loss: 3.194 Test Acc: 0.149
Validation loss decreased (-0.143498 --> -0.149380).  Saving model ...
Epoch: 14 cost time: 1.1239516735076904
Epoch: 14, Steps: 10 | Train Loss: 1.714 Vali Loss: 3.199 Vali Acc: 0.162 Test Loss: 3.199 Test Acc: 0.162
Validation loss decreased (-0.149380 --> -0.162321).  Saving model ...
Epoch: 15 cost time: 1.026975154876709
Epoch: 15, Steps: 10 | Train Loss: 1.553 Vali Loss: 3.215 Vali Acc: 0.166 Test Loss: 3.215 Test Acc: 0.166
Validation loss decreased (-0.162321 --> -0.165850).  Saving model ...
Epoch: 16 cost time: 1.101855993270874
Epoch: 16, Steps: 10 | Train Loss: 1.373 Vali Loss: 3.227 Vali Acc: 0.178 Test Loss: 3.227 Test Acc: 0.178
Validation loss decreased (-0.165850 --> -0.177615).  Saving model ...
Epoch: 17 cost time: 1.0704777240753174
Epoch: 17, Steps: 10 | Train Loss: 1.222 Vali Loss: 3.257 Vali Acc: 0.185 Test Loss: 3.257 Test Acc: 0.185
Validation loss decreased (-0.177615 --> -0.184673).  Saving model ...
Epoch: 18 cost time: 1.0377233028411865
Epoch: 18, Steps: 10 | Train Loss: 1.011 Vali Loss: 3.285 Vali Acc: 0.186 Test Loss: 3.285 Test Acc: 0.186
Validation loss decreased (-0.184673 --> -0.185849).  Saving model ...
Epoch: 19 cost time: 1.1127469539642334
Epoch: 19, Steps: 10 | Train Loss: 0.865 Vali Loss: 3.317 Vali Acc: 0.191 Test Loss: 3.317 Test Acc: 0.191
Validation loss decreased (-0.185849 --> -0.190555).  Saving model ...
Epoch: 20 cost time: 1.10626220703125
Epoch: 20, Steps: 10 | Train Loss: 0.691 Vali Loss: 3.360 Vali Acc: 0.208 Test Loss: 3.360 Test Acc: 0.208
Validation loss decreased (-0.190555 --> -0.208202).  Saving model ...
Epoch: 21 cost time: 1.0881233215332031
Epoch: 21, Steps: 10 | Train Loss: 0.567 Vali Loss: 3.413 Vali Acc: 0.216 Test Loss: 3.413 Test Acc: 0.216
Validation loss decreased (-0.208202 --> -0.216436).  Saving model ...
Epoch: 22 cost time: 1.1003162860870361
Epoch: 22, Steps: 10 | Train Loss: 0.462 Vali Loss: 3.485 Vali Acc: 0.222 Test Loss: 3.485 Test Acc: 0.222
Validation loss decreased (-0.216436 --> -0.222318).  Saving model ...
Epoch: 23 cost time: 0.9495911598205566
Epoch: 23, Steps: 10 | Train Loss: 0.359 Vali Loss: 3.555 Vali Acc: 0.225 Test Loss: 3.555 Test Acc: 0.225
Validation loss decreased (-0.222318 --> -0.224670).  Saving model ...
Epoch: 24 cost time: 1.0633234977722168
Epoch: 24, Steps: 10 | Train Loss: 0.261 Vali Loss: 3.601 Vali Acc: 0.229 Test Loss: 3.601 Test Acc: 0.229
Validation loss decreased (-0.224670 --> -0.229376).  Saving model ...
Epoch: 25 cost time: 1.108398199081421
Epoch: 25, Steps: 10 | Train Loss: 0.216 Vali Loss: 3.675 Vali Acc: 0.235 Test Loss: 3.675 Test Acc: 0.235
Validation loss decreased (-0.229376 --> -0.235257).  Saving model ...
Epoch: 26 cost time: 0.9825530052185059
Epoch: 26, Steps: 10 | Train Loss: 0.167 Vali Loss: 3.734 Vali Acc: 0.229 Test Loss: 3.734 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.984912633895874
Epoch: 27, Steps: 10 | Train Loss: 0.137 Vali Loss: 3.800 Vali Acc: 0.232 Test Loss: 3.800 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.9096250534057617
Epoch: 28, Steps: 10 | Train Loss: 0.112 Vali Loss: 3.870 Vali Acc: 0.228 Test Loss: 3.870 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.852755069732666
Epoch: 29, Steps: 10 | Train Loss: 0.094 Vali Loss: 3.899 Vali Acc: 0.234 Test Loss: 3.899 Test Acc: 0.234
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.0254709720611572
Epoch: 30, Steps: 10 | Train Loss: 0.078 Vali Loss: 3.948 Vali Acc: 0.228 Test Loss: 3.948 Test Acc: 0.228
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.0775432586669922
Epoch: 31, Steps: 10 | Train Loss: 0.065 Vali Loss: 4.024 Vali Acc: 0.234 Test Loss: 4.024 Test Acc: 0.234
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.0529005527496338
Epoch: 32, Steps: 10 | Train Loss: 0.058 Vali Loss: 4.061 Vali Acc: 0.233 Test Loss: 4.061 Test Acc: 0.233
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.0612144470214844
Epoch: 33, Steps: 10 | Train Loss: 0.051 Vali Loss: 4.087 Vali Acc: 0.235 Test Loss: 4.087 Test Acc: 0.235
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.9602499008178711
Epoch: 34, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.150 Vali Acc: 0.233 Test Loss: 4.150 Test Acc: 0.233
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.107982873916626
Epoch: 35, Steps: 10 | Train Loss: 0.039 Vali Loss: 4.169 Vali Acc: 0.238 Test Loss: 4.169 Test Acc: 0.238
Validation loss decreased (-0.235257 --> -0.237605).  Saving model ...
Epoch: 36 cost time: 1.0264225006103516
Epoch: 36, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.190 Vali Acc: 0.242 Test Loss: 4.190 Test Acc: 0.242
Validation loss decreased (-0.237605 --> -0.242311).  Saving model ...
Epoch: 37 cost time: 1.2305309772491455
Epoch: 37, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.226 Vali Acc: 0.245 Test Loss: 4.226 Test Acc: 0.245
Validation loss decreased (-0.242311 --> -0.244664).  Saving model ...
Epoch: 38 cost time: 1.1497094631195068
Epoch: 38, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.294 Vali Acc: 0.246 Test Loss: 4.294 Test Acc: 0.246
Validation loss decreased (-0.244664 --> -0.245839).  Saving model ...
Epoch: 39 cost time: 1.0981290340423584
Epoch: 39, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.331 Vali Acc: 0.239 Test Loss: 4.331 Test Acc: 0.239
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.9557960033416748
Epoch: 40, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.361 Vali Acc: 0.240 Test Loss: 4.361 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.9920668601989746
Epoch: 41, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.386 Vali Acc: 0.240 Test Loss: 4.386 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.0931730270385742
Epoch: 42, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.400 Vali Acc: 0.241 Test Loss: 4.400 Test Acc: 0.241
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.9924130439758301
Epoch: 43, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.439 Vali Acc: 0.238 Test Loss: 4.439 Test Acc: 0.238
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.0600619316101074
Epoch: 44, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.449 Vali Acc: 0.239 Test Loss: 4.449 Test Acc: 0.239
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.1166777610778809
Epoch: 45, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.471 Vali Acc: 0.235 Test Loss: 4.471 Test Acc: 0.235
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.9851224422454834
Epoch: 46, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.510 Vali Acc: 0.235 Test Loss: 4.510 Test Acc: 0.235
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 1.1647520065307617
Epoch: 47, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.550 Vali Acc: 0.231 Test Loss: 4.550 Test Acc: 0.231
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 0.9535171985626221
Epoch: 48, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.568 Vali Acc: 0.233 Test Loss: 4.568 Test Acc: 0.233
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps23_str12_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.24588235294117647
model parameter : 603162
model size : 2.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.262610673904419
Epoch: 1, Steps: 10 | Train Loss: 3.286 Vali Loss: 3.265 Vali Acc: 0.024 Test Loss: 3.265 Test Acc: 0.024
Validation loss decreased (inf --> -0.023497).  Saving model ...
Epoch: 2 cost time: 0.962148904800415
Epoch: 2, Steps: 10 | Train Loss: 3.252 Vali Loss: 3.264 Vali Acc: 0.041 Test Loss: 3.264 Test Acc: 0.041
Validation loss decreased (-0.023497 --> -0.041144).  Saving model ...
Epoch: 3 cost time: 0.9636893272399902
Epoch: 3, Steps: 10 | Train Loss: 3.188 Vali Loss: 3.256 Vali Acc: 0.051 Test Loss: 3.256 Test Acc: 0.051
Validation loss decreased (-0.041144 --> -0.050556).  Saving model ...
Epoch: 4 cost time: 0.9902119636535645
Epoch: 4, Steps: 10 | Train Loss: 3.115 Vali Loss: 3.246 Vali Acc: 0.061 Test Loss: 3.246 Test Acc: 0.061
Validation loss decreased (-0.050556 --> -0.061144).  Saving model ...
Epoch: 5 cost time: 1.0431904792785645
Epoch: 5, Steps: 10 | Train Loss: 3.027 Vali Loss: 3.236 Vali Acc: 0.062 Test Loss: 3.236 Test Acc: 0.062
Validation loss decreased (-0.061144 --> -0.062321).  Saving model ...
Epoch: 6 cost time: 0.9774088859558105
Epoch: 6, Steps: 10 | Train Loss: 2.935 Vali Loss: 3.228 Vali Acc: 0.078 Test Loss: 3.228 Test Acc: 0.078
Validation loss decreased (-0.062321 --> -0.077615).  Saving model ...
Epoch: 7 cost time: 1.0450661182403564
Epoch: 7, Steps: 10 | Train Loss: 2.819 Vali Loss: 3.221 Vali Acc: 0.084 Test Loss: 3.221 Test Acc: 0.084
Validation loss decreased (-0.077615 --> -0.083497).  Saving model ...
Epoch: 8 cost time: 1.0337498188018799
Epoch: 8, Steps: 10 | Train Loss: 2.706 Vali Loss: 3.212 Vali Acc: 0.095 Test Loss: 3.212 Test Acc: 0.095
Validation loss decreased (-0.083497 --> -0.095262).  Saving model ...
Epoch: 9 cost time: 1.0240800380706787
Epoch: 9, Steps: 10 | Train Loss: 2.627 Vali Loss: 3.206 Vali Acc: 0.102 Test Loss: 3.206 Test Acc: 0.102
Validation loss decreased (-0.095262 --> -0.102321).  Saving model ...
Epoch: 10 cost time: 0.9561798572540283
Epoch: 10, Steps: 10 | Train Loss: 2.494 Vali Loss: 3.196 Vali Acc: 0.115 Test Loss: 3.196 Test Acc: 0.115
Validation loss decreased (-0.102321 --> -0.115262).  Saving model ...
Epoch: 11 cost time: 0.9649229049682617
Epoch: 11, Steps: 10 | Train Loss: 2.372 Vali Loss: 3.186 Vali Acc: 0.128 Test Loss: 3.186 Test Acc: 0.128
Validation loss decreased (-0.115262 --> -0.128203).  Saving model ...
Epoch: 12 cost time: 0.9412813186645508
Epoch: 12, Steps: 10 | Train Loss: 2.194 Vali Loss: 3.175 Vali Acc: 0.135 Test Loss: 3.175 Test Acc: 0.135
Validation loss decreased (-0.128203 --> -0.135262).  Saving model ...
Epoch: 13 cost time: 0.9266321659088135
Epoch: 13, Steps: 10 | Train Loss: 2.032 Vali Loss: 3.169 Vali Acc: 0.149 Test Loss: 3.169 Test Acc: 0.149
Validation loss decreased (-0.135262 --> -0.149380).  Saving model ...
Epoch: 14 cost time: 0.9887776374816895
Epoch: 14, Steps: 10 | Train Loss: 1.860 Vali Loss: 3.161 Vali Acc: 0.164 Test Loss: 3.161 Test Acc: 0.164
Validation loss decreased (-0.149380 --> -0.163498).  Saving model ...
Epoch: 15 cost time: 0.9338843822479248
Epoch: 15, Steps: 10 | Train Loss: 1.651 Vali Loss: 3.166 Vali Acc: 0.175 Test Loss: 3.166 Test Acc: 0.175
Validation loss decreased (-0.163498 --> -0.175262).  Saving model ...
Epoch: 16 cost time: 0.9273049831390381
Epoch: 16, Steps: 10 | Train Loss: 1.466 Vali Loss: 3.177 Vali Acc: 0.185 Test Loss: 3.177 Test Acc: 0.185
Validation loss decreased (-0.175262 --> -0.184674).  Saving model ...
Epoch: 17 cost time: 1.090888261795044
Epoch: 17, Steps: 10 | Train Loss: 1.300 Vali Loss: 3.188 Vali Acc: 0.196 Test Loss: 3.188 Test Acc: 0.196
Validation loss decreased (-0.184674 --> -0.196439).  Saving model ...
Epoch: 18 cost time: 1.0400564670562744
Epoch: 18, Steps: 10 | Train Loss: 1.148 Vali Loss: 3.198 Vali Acc: 0.209 Test Loss: 3.198 Test Acc: 0.209
Validation loss decreased (-0.196439 --> -0.209380).  Saving model ...
Epoch: 19 cost time: 1.0426537990570068
Epoch: 19, Steps: 10 | Train Loss: 0.959 Vali Loss: 3.220 Vali Acc: 0.211 Test Loss: 3.220 Test Acc: 0.211
Validation loss decreased (-0.209380 --> -0.210556).  Saving model ...
Epoch: 20 cost time: 0.8436157703399658
Epoch: 20, Steps: 10 | Train Loss: 0.786 Vali Loss: 3.260 Vali Acc: 0.211 Test Loss: 3.260 Test Acc: 0.211
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9548439979553223
Epoch: 21, Steps: 10 | Train Loss: 0.624 Vali Loss: 3.301 Vali Acc: 0.221 Test Loss: 3.301 Test Acc: 0.221
Validation loss decreased (-0.210556 --> -0.221143).  Saving model ...
Epoch: 22 cost time: 1.145376205444336
Epoch: 22, Steps: 10 | Train Loss: 0.543 Vali Loss: 3.359 Vali Acc: 0.224 Test Loss: 3.359 Test Acc: 0.224
Validation loss decreased (-0.221143 --> -0.223496).  Saving model ...
Epoch: 23 cost time: 0.8615596294403076
Epoch: 23, Steps: 10 | Train Loss: 0.425 Vali Loss: 3.409 Vali Acc: 0.233 Test Loss: 3.409 Test Acc: 0.233
Validation loss decreased (-0.223496 --> -0.232907).  Saving model ...
Epoch: 24 cost time: 0.901486873626709
Epoch: 24, Steps: 10 | Train Loss: 0.329 Vali Loss: 3.465 Vali Acc: 0.233 Test Loss: 3.465 Test Acc: 0.233
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8551337718963623
Epoch: 25, Steps: 10 | Train Loss: 0.256 Vali Loss: 3.511 Vali Acc: 0.244 Test Loss: 3.511 Test Acc: 0.244
Validation loss decreased (-0.232907 --> -0.243494).  Saving model ...
Epoch: 26 cost time: 1.0359671115875244
Epoch: 26, Steps: 10 | Train Loss: 0.207 Vali Loss: 3.587 Vali Acc: 0.239 Test Loss: 3.587 Test Acc: 0.239
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9662749767303467
Epoch: 27, Steps: 10 | Train Loss: 0.172 Vali Loss: 3.622 Vali Acc: 0.245 Test Loss: 3.622 Test Acc: 0.245
Validation loss decreased (-0.243494 --> -0.244670).  Saving model ...
Epoch: 28 cost time: 1.1125898361206055
Epoch: 28, Steps: 10 | Train Loss: 0.137 Vali Loss: 3.685 Vali Acc: 0.256 Test Loss: 3.685 Test Acc: 0.256
Validation loss decreased (-0.244670 --> -0.256434).  Saving model ...
Epoch: 29 cost time: 0.9370584487915039
Epoch: 29, Steps: 10 | Train Loss: 0.108 Vali Loss: 3.762 Vali Acc: 0.242 Test Loss: 3.762 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9516820907592773
Epoch: 30, Steps: 10 | Train Loss: 0.087 Vali Loss: 3.821 Vali Acc: 0.241 Test Loss: 3.821 Test Acc: 0.241
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.0655953884124756
Epoch: 31, Steps: 10 | Train Loss: 0.081 Vali Loss: 3.864 Vali Acc: 0.245 Test Loss: 3.864 Test Acc: 0.245
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.054521083831787
Epoch: 32, Steps: 10 | Train Loss: 0.066 Vali Loss: 3.913 Vali Acc: 0.247 Test Loss: 3.913 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.9494287967681885
Epoch: 33, Steps: 10 | Train Loss: 0.052 Vali Loss: 3.937 Vali Acc: 0.255 Test Loss: 3.937 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.9670119285583496
Epoch: 34, Steps: 10 | Train Loss: 0.051 Vali Loss: 3.963 Vali Acc: 0.260 Test Loss: 3.963 Test Acc: 0.260
Validation loss decreased (-0.256434 --> -0.259960).  Saving model ...
Epoch: 35 cost time: 0.9936871528625488
Epoch: 35, Steps: 10 | Train Loss: 0.045 Vali Loss: 4.030 Vali Acc: 0.253 Test Loss: 4.030 Test Acc: 0.253
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.0116043090820312
Epoch: 36, Steps: 10 | Train Loss: 0.041 Vali Loss: 4.095 Vali Acc: 0.251 Test Loss: 4.095 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.036940097808838
Epoch: 37, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.111 Vali Acc: 0.256 Test Loss: 4.111 Test Acc: 0.256
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.010756015777588
Epoch: 38, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.129 Vali Acc: 0.255 Test Loss: 4.129 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.9727933406829834
Epoch: 39, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.160 Vali Acc: 0.256 Test Loss: 4.160 Test Acc: 0.256
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.126326084136963
Epoch: 40, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.198 Vali Acc: 0.255 Test Loss: 4.198 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.1692440509796143
Epoch: 41, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.250 Vali Acc: 0.248 Test Loss: 4.250 Test Acc: 0.248
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.0990228652954102
Epoch: 42, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.300 Vali Acc: 0.241 Test Loss: 4.300 Test Acc: 0.241
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 1.2709872722625732
Epoch: 43, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.334 Vali Acc: 0.245 Test Loss: 4.334 Test Acc: 0.245
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 1.3457074165344238
Epoch: 44, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.319 Vali Acc: 0.246 Test Loss: 4.319 Test Acc: 0.246
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26
model parameter : 603418
model size : 2.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps38_str19_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.2825984954833984
Epoch: 1, Steps: 10 | Train Loss: 3.286 Vali Loss: 3.263 Vali Acc: 0.051 Test Loss: 3.263 Test Acc: 0.051
Validation loss decreased (inf --> -0.050556).  Saving model ...
Epoch: 2 cost time: 0.8177981376647949
Epoch: 2, Steps: 10 | Train Loss: 3.266 Vali Loss: 3.264 Vali Acc: 0.059 Test Loss: 3.264 Test Acc: 0.059
Validation loss decreased (-0.050556 --> -0.058791).  Saving model ...
Epoch: 3 cost time: 1.1091244220733643
Epoch: 3, Steps: 10 | Train Loss: 3.216 Vali Loss: 3.260 Vali Acc: 0.064 Test Loss: 3.260 Test Acc: 0.064
Validation loss decreased (-0.058791 --> -0.063497).  Saving model ...
Epoch: 4 cost time: 1.0743813514709473
Epoch: 4, Steps: 10 | Train Loss: 3.133 Vali Loss: 3.253 Vali Acc: 0.068 Test Loss: 3.253 Test Acc: 0.068
Validation loss decreased (-0.063497 --> -0.068203).  Saving model ...
Epoch: 5 cost time: 1.1032910346984863
Epoch: 5, Steps: 10 | Train Loss: 3.061 Vali Loss: 3.245 Vali Acc: 0.080 Test Loss: 3.245 Test Acc: 0.080
Validation loss decreased (-0.068203 --> -0.079968).  Saving model ...
Epoch: 6 cost time: 1.1370344161987305
Epoch: 6, Steps: 10 | Train Loss: 2.971 Vali Loss: 3.238 Vali Acc: 0.095 Test Loss: 3.238 Test Acc: 0.095
Validation loss decreased (-0.079968 --> -0.095262).  Saving model ...
Epoch: 7 cost time: 1.1504886150360107
Epoch: 7, Steps: 10 | Train Loss: 2.890 Vali Loss: 3.232 Vali Acc: 0.100 Test Loss: 3.232 Test Acc: 0.100
Validation loss decreased (-0.095262 --> -0.099968).  Saving model ...
Epoch: 8 cost time: 1.1785173416137695
Epoch: 8, Steps: 10 | Train Loss: 2.782 Vali Loss: 3.226 Vali Acc: 0.113 Test Loss: 3.226 Test Acc: 0.113
Validation loss decreased (-0.099968 --> -0.112909).  Saving model ...
Epoch: 9 cost time: 1.2377023696899414
Epoch: 9, Steps: 10 | Train Loss: 2.681 Vali Loss: 3.222 Vali Acc: 0.113 Test Loss: 3.222 Test Acc: 0.113
Validation loss decreased (-0.112909 --> -0.112909).  Saving model ...
Epoch: 10 cost time: 1.068206548690796
Epoch: 10, Steps: 10 | Train Loss: 2.584 Vali Loss: 3.218 Vali Acc: 0.120 Test Loss: 3.218 Test Acc: 0.120
Validation loss decreased (-0.112909 --> -0.119968).  Saving model ...
Epoch: 11 cost time: 1.228562355041504
Epoch: 11, Steps: 10 | Train Loss: 2.472 Vali Loss: 3.216 Vali Acc: 0.128 Test Loss: 3.216 Test Acc: 0.128
Validation loss decreased (-0.119968 --> -0.128203).  Saving model ...
Epoch: 12 cost time: 1.0237927436828613
Epoch: 12, Steps: 10 | Train Loss: 2.333 Vali Loss: 3.217 Vali Acc: 0.128 Test Loss: 3.217 Test Acc: 0.128
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1726315021514893
Epoch: 13, Steps: 10 | Train Loss: 2.180 Vali Loss: 3.210 Vali Acc: 0.134 Test Loss: 3.210 Test Acc: 0.134
Validation loss decreased (-0.128203 --> -0.134086).  Saving model ...
Epoch: 14 cost time: 1.0931158065795898
Epoch: 14, Steps: 10 | Train Loss: 2.006 Vali Loss: 3.212 Vali Acc: 0.138 Test Loss: 3.212 Test Acc: 0.138
Validation loss decreased (-0.134086 --> -0.137615).  Saving model ...
Epoch: 15 cost time: 1.0974979400634766
Epoch: 15, Steps: 10 | Train Loss: 1.837 Vali Loss: 3.216 Vali Acc: 0.149 Test Loss: 3.216 Test Acc: 0.149
Validation loss decreased (-0.137615 --> -0.149380).  Saving model ...
Epoch: 16 cost time: 1.188056230545044
Epoch: 16, Steps: 10 | Train Loss: 1.694 Vali Loss: 3.222 Vali Acc: 0.155 Test Loss: 3.222 Test Acc: 0.155
Validation loss decreased (-0.149380 --> -0.155262).  Saving model ...
Epoch: 17 cost time: 1.1069278717041016
Epoch: 17, Steps: 10 | Train Loss: 1.482 Vali Loss: 3.224 Vali Acc: 0.167 Test Loss: 3.224 Test Acc: 0.167
Validation loss decreased (-0.155262 --> -0.167027).  Saving model ...
Epoch: 18 cost time: 1.0327651500701904
Epoch: 18, Steps: 10 | Train Loss: 1.310 Vali Loss: 3.242 Vali Acc: 0.169 Test Loss: 3.242 Test Acc: 0.169
Validation loss decreased (-0.167027 --> -0.169379).  Saving model ...
Epoch: 19 cost time: 1.0080702304840088
Epoch: 19, Steps: 10 | Train Loss: 1.134 Vali Loss: 3.255 Vali Acc: 0.184 Test Loss: 3.255 Test Acc: 0.184
Validation loss decreased (-0.169379 --> -0.183497).  Saving model ...
Epoch: 20 cost time: 1.1602509021759033
Epoch: 20, Steps: 10 | Train Loss: 0.975 Vali Loss: 3.289 Vali Acc: 0.198 Test Loss: 3.289 Test Acc: 0.198
Validation loss decreased (-0.183497 --> -0.197614).  Saving model ...
Epoch: 21 cost time: 1.2301595211029053
Epoch: 21, Steps: 10 | Train Loss: 0.857 Vali Loss: 3.323 Vali Acc: 0.204 Test Loss: 3.323 Test Acc: 0.204
Validation loss decreased (-0.197614 --> -0.203496).  Saving model ...
Epoch: 22 cost time: 1.1940841674804688
Epoch: 22, Steps: 10 | Train Loss: 0.700 Vali Loss: 3.364 Vali Acc: 0.200 Test Loss: 3.364 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.1670112609863281
Epoch: 23, Steps: 10 | Train Loss: 0.565 Vali Loss: 3.416 Vali Acc: 0.199 Test Loss: 3.416 Test Acc: 0.199
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.1781246662139893
Epoch: 24, Steps: 10 | Train Loss: 0.454 Vali Loss: 3.495 Vali Acc: 0.198 Test Loss: 3.495 Test Acc: 0.198
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.0157802104949951
Epoch: 25, Steps: 10 | Train Loss: 0.397 Vali Loss: 3.533 Vali Acc: 0.206 Test Loss: 3.533 Test Acc: 0.206
Validation loss decreased (-0.203496 --> -0.205847).  Saving model ...
Epoch: 26 cost time: 0.911257266998291
Epoch: 26, Steps: 10 | Train Loss: 0.293 Vali Loss: 3.602 Vali Acc: 0.204 Test Loss: 3.602 Test Acc: 0.204
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9670290946960449
Epoch: 27, Steps: 10 | Train Loss: 0.229 Vali Loss: 3.676 Vali Acc: 0.207 Test Loss: 3.676 Test Acc: 0.207
Validation loss decreased (-0.205847 --> -0.207022).  Saving model ...
Epoch: 28 cost time: 1.1153576374053955
Epoch: 28, Steps: 10 | Train Loss: 0.207 Vali Loss: 3.715 Vali Acc: 0.207 Test Loss: 3.715 Test Acc: 0.207
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.1973075866699219
Epoch: 29, Steps: 10 | Train Loss: 0.143 Vali Loss: 3.773 Vali Acc: 0.219 Test Loss: 3.773 Test Acc: 0.219
Validation loss decreased (-0.207022 --> -0.218786).  Saving model ...
Epoch: 30 cost time: 1.164210557937622
Epoch: 30, Steps: 10 | Train Loss: 0.135 Vali Loss: 3.833 Vali Acc: 0.220 Test Loss: 3.833 Test Acc: 0.220
Validation loss decreased (-0.218786 --> -0.219962).  Saving model ...
Epoch: 31 cost time: 1.0533828735351562
Epoch: 31, Steps: 10 | Train Loss: 0.103 Vali Loss: 3.881 Vali Acc: 0.221 Test Loss: 3.881 Test Acc: 0.221
Validation loss decreased (-0.219962 --> -0.221138).  Saving model ...
Epoch: 32 cost time: 1.20237135887146
Epoch: 32, Steps: 10 | Train Loss: 0.097 Vali Loss: 3.941 Vali Acc: 0.221 Test Loss: 3.941 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.1923658847808838
Epoch: 33, Steps: 10 | Train Loss: 0.084 Vali Loss: 3.983 Vali Acc: 0.228 Test Loss: 3.983 Test Acc: 0.228
Validation loss decreased (-0.221138 --> -0.228195).  Saving model ...
Epoch: 34 cost time: 1.21470046043396
Epoch: 34, Steps: 10 | Train Loss: 0.072 Vali Loss: 4.024 Vali Acc: 0.225 Test Loss: 4.024 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.0533697605133057
Epoch: 35, Steps: 10 | Train Loss: 0.069 Vali Loss: 4.068 Vali Acc: 0.225 Test Loss: 4.068 Test Acc: 0.225
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.0426414012908936
Epoch: 36, Steps: 10 | Train Loss: 0.058 Vali Loss: 4.140 Vali Acc: 0.224 Test Loss: 4.140 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.1225621700286865
Epoch: 37, Steps: 10 | Train Loss: 0.044 Vali Loss: 4.153 Vali Acc: 0.222 Test Loss: 4.153 Test Acc: 0.222
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.0624067783355713
Epoch: 38, Steps: 10 | Train Loss: 0.038 Vali Loss: 4.181 Vali Acc: 0.229 Test Loss: 4.181 Test Acc: 0.229
Validation loss decreased (-0.228195 --> -0.229370).  Saving model ...
Epoch: 39 cost time: 1.0668518543243408
Epoch: 39, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.213 Vali Acc: 0.235 Test Loss: 4.213 Test Acc: 0.235
Validation loss decreased (-0.229370 --> -0.235252).  Saving model ...
Epoch: 40 cost time: 0.9409797191619873
Epoch: 40, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.250 Vali Acc: 0.232 Test Loss: 4.250 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.2368497848510742
Epoch: 41, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.305 Vali Acc: 0.228 Test Loss: 4.305 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.236074447631836
Epoch: 42, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.346 Vali Acc: 0.225 Test Loss: 4.346 Test Acc: 0.225
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.2672908306121826
Epoch: 43, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.342 Vali Acc: 0.227 Test Loss: 4.342 Test Acc: 0.227
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.1623811721801758
Epoch: 44, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.369 Vali Acc: 0.226 Test Loss: 4.369 Test Acc: 0.226
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.1197826862335205
Epoch: 45, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.400 Vali Acc: 0.229 Test Loss: 4.400 Test Acc: 0.229
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.145819902420044
Epoch: 46, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.443 Vali Acc: 0.236 Test Loss: 4.443 Test Acc: 0.236
Validation loss decreased (-0.235252 --> -0.236426).  Saving model ...
Epoch: 47 cost time: 1.1447763442993164
Epoch: 47, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.503 Vali Acc: 0.222 Test Loss: 4.503 Test Acc: 0.222
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.1146795749664307
Epoch: 48, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.572 Vali Acc: 0.224 Test Loss: 4.572 Test Acc: 0.224
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.107358694076538
Epoch: 49, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.576 Vali Acc: 0.226 Test Loss: 4.576 Test Acc: 0.226
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.0588741302490234
Epoch: 50, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.589 Vali Acc: 0.232 Test Loss: 4.589 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps38_str19_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.23647058823529413
model parameter : 593658
model size : 2.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.7928805351257324
Epoch: 1, Steps: 10 | Train Loss: 3.289 Vali Loss: 3.258 Vali Acc: 0.049 Test Loss: 3.258 Test Acc: 0.049
Validation loss decreased (inf --> -0.049379).  Saving model ...
Epoch: 2 cost time: 1.584657907485962
Epoch: 2, Steps: 10 | Train Loss: 2.823 Vali Loss: 3.256 Vali Acc: 0.087 Test Loss: 3.256 Test Acc: 0.087
Validation loss decreased (-0.049379 --> -0.087026).  Saving model ...
Epoch: 3 cost time: 2.0301387310028076
Epoch: 3, Steps: 10 | Train Loss: 2.136 Vali Loss: 3.252 Vali Acc: 0.129 Test Loss: 3.252 Test Acc: 0.129
Validation loss decreased (-0.087026 --> -0.129379).  Saving model ...
Epoch: 4 cost time: 2.0299651622772217
Epoch: 4, Steps: 10 | Train Loss: 1.297 Vali Loss: 3.252 Vali Acc: 0.200 Test Loss: 3.252 Test Acc: 0.200
Validation loss decreased (-0.129379 --> -0.199967).  Saving model ...
Epoch: 5 cost time: 1.8755183219909668
Epoch: 5, Steps: 10 | Train Loss: 0.592 Vali Loss: 3.519 Vali Acc: 0.242 Test Loss: 3.519 Test Acc: 0.242
Validation loss decreased (-0.199967 --> -0.242318).  Saving model ...
Epoch: 6 cost time: 1.7872443199157715
Epoch: 6, Steps: 10 | Train Loss: 0.199 Vali Loss: 4.030 Vali Acc: 0.258 Test Loss: 4.030 Test Acc: 0.258
Validation loss decreased (-0.242318 --> -0.257607).  Saving model ...
Epoch: 7 cost time: 1.1645526885986328
Epoch: 7, Steps: 10 | Train Loss: 0.053 Vali Loss: 4.562 Vali Acc: 0.267 Test Loss: 4.562 Test Acc: 0.267
Validation loss decreased (-0.257607 --> -0.267013).  Saving model ...
Epoch: 8 cost time: 1.3814842700958252
Epoch: 8, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.946 Vali Acc: 0.254 Test Loss: 4.946 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7461988925933838
Epoch: 9, Steps: 10 | Train Loss: 0.008 Vali Loss: 5.108 Vali Acc: 0.252 Test Loss: 5.108 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.9310781955718994
Epoch: 10, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.228 Vali Acc: 0.266 Test Loss: 5.228 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.737415075302124
Epoch: 11, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.304 Vali Acc: 0.273 Test Loss: 5.304 Test Acc: 0.273
Validation loss decreased (-0.267013 --> -0.272888).  Saving model ...
Epoch: 12 cost time: 1.8228504657745361
Epoch: 12, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.343 Vali Acc: 0.272 Test Loss: 5.343 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5692241191864014
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.384 Vali Acc: 0.271 Test Loss: 5.384 Test Acc: 0.271
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.9152140617370605
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.404 Vali Acc: 0.268 Test Loss: 5.404 Test Acc: 0.268
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.7416067123413086
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.419 Vali Acc: 0.268 Test Loss: 5.419 Test Acc: 0.268
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.7682867050170898
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.446 Vali Acc: 0.268 Test Loss: 5.446 Test Acc: 0.268
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.6959753036499023
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.463 Vali Acc: 0.268 Test Loss: 5.463 Test Acc: 0.268
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.9630906581878662
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.491 Vali Acc: 0.272 Test Loss: 5.491 Test Acc: 0.272
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.9614167213439941
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.504 Vali Acc: 0.273 Test Loss: 5.504 Test Acc: 0.273
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.0001707077026367
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.522 Vali Acc: 0.275 Test Loss: 5.522 Test Acc: 0.275
Validation loss decreased (-0.272888 --> -0.275239).  Saving model ...
Epoch: 21 cost time: 1.8634016513824463
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.554 Vali Acc: 0.278 Test Loss: 5.554 Test Acc: 0.278
Validation loss decreased (-0.275239 --> -0.277592).  Saving model ...
Epoch: 22 cost time: 1.9388892650604248
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.575 Vali Acc: 0.276 Test Loss: 5.575 Test Acc: 0.276
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2840867042541504
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.597 Vali Acc: 0.275 Test Loss: 5.597 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.7234742641448975
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.631 Vali Acc: 0.276 Test Loss: 5.631 Test Acc: 0.276
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.6836066246032715
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.649 Vali Acc: 0.274 Test Loss: 5.649 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.5506067276000977
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.674 Vali Acc: 0.273 Test Loss: 5.674 Test Acc: 0.273
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.8811328411102295
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.693 Vali Acc: 0.273 Test Loss: 5.693 Test Acc: 0.273
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.8038372993469238
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.726 Vali Acc: 0.271 Test Loss: 5.726 Test Acc: 0.271
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.7847745418548584
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.743 Vali Acc: 0.274 Test Loss: 5.743 Test Acc: 0.274
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.5618500709533691
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.767 Vali Acc: 0.274 Test Loss: 5.767 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.8031816482543945
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.778 Vali Acc: 0.274 Test Loss: 5.778 Test Acc: 0.274
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2776470588235294
model parameter : 2857114
model size : 10.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.5495071411132812
Epoch: 1, Steps: 10 | Train Loss: 3.269 Vali Loss: 3.259 Vali Acc: 0.046 Test Loss: 3.259 Test Acc: 0.046
Validation loss decreased (inf --> -0.045850).  Saving model ...
Epoch: 2 cost time: 1.352924108505249
Epoch: 2, Steps: 10 | Train Loss: 3.018 Vali Loss: 3.242 Vali Acc: 0.079 Test Loss: 3.242 Test Acc: 0.079
Validation loss decreased (-0.045850 --> -0.078791).  Saving model ...
Epoch: 3 cost time: 1.5411980152130127
Epoch: 3, Steps: 10 | Train Loss: 2.614 Vali Loss: 3.239 Vali Acc: 0.112 Test Loss: 3.239 Test Acc: 0.112
Validation loss decreased (-0.078791 --> -0.111732).  Saving model ...
Epoch: 4 cost time: 1.5484912395477295
Epoch: 4, Steps: 10 | Train Loss: 2.099 Vali Loss: 3.229 Vali Acc: 0.132 Test Loss: 3.229 Test Acc: 0.132
Validation loss decreased (-0.111732 --> -0.131732).  Saving model ...
Epoch: 5 cost time: 1.4857590198516846
Epoch: 5, Steps: 10 | Train Loss: 1.536 Vali Loss: 3.231 Vali Acc: 0.189 Test Loss: 3.231 Test Acc: 0.189
Validation loss decreased (-0.131732 --> -0.189379).  Saving model ...
Epoch: 6 cost time: 1.3358306884765625
Epoch: 6, Steps: 10 | Train Loss: 0.974 Vali Loss: 3.299 Vali Acc: 0.235 Test Loss: 3.299 Test Acc: 0.235
Validation loss decreased (-0.189379 --> -0.235261).  Saving model ...
Epoch: 7 cost time: 1.2452261447906494
Epoch: 7, Steps: 10 | Train Loss: 0.516 Vali Loss: 3.517 Vali Acc: 0.239 Test Loss: 3.517 Test Acc: 0.239
Validation loss decreased (-0.235261 --> -0.238788).  Saving model ...
Epoch: 8 cost time: 1.5485866069793701
Epoch: 8, Steps: 10 | Train Loss: 0.243 Vali Loss: 3.827 Vali Acc: 0.248 Test Loss: 3.827 Test Acc: 0.248
Validation loss decreased (-0.238788 --> -0.248197).  Saving model ...
Epoch: 9 cost time: 1.5720326900482178
Epoch: 9, Steps: 10 | Train Loss: 0.097 Vali Loss: 4.082 Vali Acc: 0.265 Test Loss: 4.082 Test Acc: 0.265
Validation loss decreased (-0.248197 --> -0.264665).  Saving model ...
Epoch: 10 cost time: 1.4808862209320068
Epoch: 10, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.323 Vali Acc: 0.266 Test Loss: 4.323 Test Acc: 0.266
Validation loss decreased (-0.264665 --> -0.265839).  Saving model ...
Epoch: 11 cost time: 1.2908844947814941
Epoch: 11, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.449 Vali Acc: 0.280 Test Loss: 4.449 Test Acc: 0.280
Validation loss decreased (-0.265839 --> -0.279956).  Saving model ...
Epoch: 12 cost time: 1.3913960456848145
Epoch: 12, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.564 Vali Acc: 0.274 Test Loss: 4.564 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4523026943206787
Epoch: 13, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.677 Vali Acc: 0.269 Test Loss: 4.677 Test Acc: 0.269
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.4518179893493652
Epoch: 14, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.737 Vali Acc: 0.273 Test Loss: 4.737 Test Acc: 0.273
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.2434909343719482
Epoch: 15, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.776 Vali Acc: 0.274 Test Loss: 4.776 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.4859392642974854
Epoch: 16, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.834 Vali Acc: 0.271 Test Loss: 4.834 Test Acc: 0.271
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.4541490077972412
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.889 Vali Acc: 0.272 Test Loss: 4.889 Test Acc: 0.272
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.5337986946105957
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.911 Vali Acc: 0.272 Test Loss: 4.911 Test Acc: 0.272
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.3762693405151367
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.942 Vali Acc: 0.274 Test Loss: 4.942 Test Acc: 0.274
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.6125237941741943
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.976 Vali Acc: 0.275 Test Loss: 4.976 Test Acc: 0.275
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.2382121086120605
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.008 Vali Acc: 0.275 Test Loss: 5.008 Test Acc: 0.275
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.28
model parameter : 2478234
model size : 9.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps12_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.5550739765167236
Epoch: 1, Steps: 10 | Train Loss: 3.296 Vali Loss: 3.271 Vali Acc: 0.042 Test Loss: 3.271 Test Acc: 0.042
Validation loss decreased (inf --> -0.042320).  Saving model ...
Epoch: 2 cost time: 1.3611509799957275
Epoch: 2, Steps: 10 | Train Loss: 3.078 Vali Loss: 3.252 Vali Acc: 0.071 Test Loss: 3.252 Test Acc: 0.071
Validation loss decreased (-0.042320 --> -0.070556).  Saving model ...
Epoch: 3 cost time: 1.3643288612365723
Epoch: 3, Steps: 10 | Train Loss: 2.739 Vali Loss: 3.250 Vali Acc: 0.095 Test Loss: 3.250 Test Acc: 0.095
Validation loss decreased (-0.070556 --> -0.095262).  Saving model ...
Epoch: 4 cost time: 1.3459668159484863
Epoch: 4, Steps: 10 | Train Loss: 2.344 Vali Loss: 3.242 Vali Acc: 0.118 Test Loss: 3.242 Test Acc: 0.118
Validation loss decreased (-0.095262 --> -0.117615).  Saving model ...
Epoch: 5 cost time: 1.2606079578399658
Epoch: 5, Steps: 10 | Train Loss: 1.883 Vali Loss: 3.229 Vali Acc: 0.146 Test Loss: 3.229 Test Acc: 0.146
Validation loss decreased (-0.117615 --> -0.145850).  Saving model ...
Epoch: 6 cost time: 1.3179576396942139
Epoch: 6, Steps: 10 | Train Loss: 1.419 Vali Loss: 3.229 Vali Acc: 0.172 Test Loss: 3.229 Test Acc: 0.172
Validation loss decreased (-0.145850 --> -0.171732).  Saving model ...
Epoch: 7 cost time: 1.2370281219482422
Epoch: 7, Steps: 10 | Train Loss: 0.936 Vali Loss: 3.266 Vali Acc: 0.207 Test Loss: 3.266 Test Acc: 0.207
Validation loss decreased (-0.171732 --> -0.207026).  Saving model ...
Epoch: 8 cost time: 1.241199254989624
Epoch: 8, Steps: 10 | Train Loss: 0.540 Vali Loss: 3.424 Vali Acc: 0.225 Test Loss: 3.424 Test Acc: 0.225
Validation loss decreased (-0.207026 --> -0.224672).  Saving model ...
Epoch: 9 cost time: 1.1879630088806152
Epoch: 9, Steps: 10 | Train Loss: 0.297 Vali Loss: 3.614 Vali Acc: 0.234 Test Loss: 3.614 Test Acc: 0.234
Validation loss decreased (-0.224672 --> -0.234082).  Saving model ...
Epoch: 10 cost time: 1.1736423969268799
Epoch: 10, Steps: 10 | Train Loss: 0.151 Vali Loss: 3.844 Vali Acc: 0.245 Test Loss: 3.844 Test Acc: 0.245
Validation loss decreased (-0.234082 --> -0.244667).  Saving model ...
Epoch: 11 cost time: 1.2732481956481934
Epoch: 11, Steps: 10 | Train Loss: 0.069 Vali Loss: 4.051 Vali Acc: 0.253 Test Loss: 4.051 Test Acc: 0.253
Validation loss decreased (-0.244667 --> -0.252901).  Saving model ...
Epoch: 12 cost time: 1.2818207740783691
Epoch: 12, Steps: 10 | Train Loss: 0.038 Vali Loss: 4.244 Vali Acc: 0.244 Test Loss: 4.244 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4034309387207031
Epoch: 13, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.309 Vali Acc: 0.249 Test Loss: 4.309 Test Acc: 0.249
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.3905012607574463
Epoch: 14, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.387 Vali Acc: 0.255 Test Loss: 4.387 Test Acc: 0.255
Validation loss decreased (-0.252901 --> -0.255250).  Saving model ...
Epoch: 15 cost time: 1.3876092433929443
Epoch: 15, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.453 Vali Acc: 0.245 Test Loss: 4.453 Test Acc: 0.245
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2965331077575684
Epoch: 16, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.508 Vali Acc: 0.251 Test Loss: 4.508 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.3538460731506348
Epoch: 17, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.558 Vali Acc: 0.254 Test Loss: 4.558 Test Acc: 0.254
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.3129839897155762
Epoch: 18, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.604 Vali Acc: 0.256 Test Loss: 4.604 Test Acc: 0.256
Validation loss decreased (-0.255250 --> -0.256425).  Saving model ...
Epoch: 19 cost time: 1.475773572921753
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.641 Vali Acc: 0.254 Test Loss: 4.641 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.4166088104248047
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.695 Vali Acc: 0.254 Test Loss: 4.695 Test Acc: 0.254
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.3631339073181152
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.729 Vali Acc: 0.248 Test Loss: 4.729 Test Acc: 0.248
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.5089001655578613
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.756 Vali Acc: 0.246 Test Loss: 4.756 Test Acc: 0.246
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.2060739994049072
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.778 Vali Acc: 0.255 Test Loss: 4.778 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.099954605102539
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.801 Vali Acc: 0.256 Test Loss: 4.801 Test Acc: 0.256
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.4263696670532227
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.842 Vali Acc: 0.253 Test Loss: 4.842 Test Acc: 0.253
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.2151260375976562
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.862 Vali Acc: 0.252 Test Loss: 4.862 Test Acc: 0.252
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.4635765552520752
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.902 Vali Acc: 0.254 Test Loss: 4.902 Test Acc: 0.254
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.4509670734405518
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.910 Vali Acc: 0.254 Test Loss: 4.910 Test Acc: 0.254
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps12_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2564705882352941
model parameter : 2358938
model size : 9.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.496166706085205
Epoch: 1, Steps: 10 | Train Loss: 3.289 Vali Loss: 3.254 Vali Acc: 0.049 Test Loss: 3.254 Test Acc: 0.049
Validation loss decreased (inf --> -0.049379).  Saving model ...
Epoch: 2 cost time: 1.142421007156372
Epoch: 2, Steps: 10 | Train Loss: 3.126 Vali Loss: 3.233 Vali Acc: 0.068 Test Loss: 3.233 Test Acc: 0.068
Validation loss decreased (-0.049379 --> -0.068203).  Saving model ...
Epoch: 3 cost time: 1.2468421459197998
Epoch: 3, Steps: 10 | Train Loss: 2.851 Vali Loss: 3.223 Vali Acc: 0.099 Test Loss: 3.223 Test Acc: 0.099
Validation loss decreased (-0.068203 --> -0.098791).  Saving model ...
Epoch: 4 cost time: 1.0595943927764893
Epoch: 4, Steps: 10 | Train Loss: 2.509 Vali Loss: 3.210 Vali Acc: 0.116 Test Loss: 3.210 Test Acc: 0.116
Validation loss decreased (-0.098791 --> -0.116438).  Saving model ...
Epoch: 5 cost time: 1.0995309352874756
Epoch: 5, Steps: 10 | Train Loss: 2.161 Vali Loss: 3.192 Vali Acc: 0.148 Test Loss: 3.192 Test Acc: 0.148
Validation loss decreased (-0.116438 --> -0.148203).  Saving model ...
Epoch: 6 cost time: 1.1864824295043945
Epoch: 6, Steps: 10 | Train Loss: 1.735 Vali Loss: 3.178 Vali Acc: 0.176 Test Loss: 3.178 Test Acc: 0.176
Validation loss decreased (-0.148203 --> -0.176439).  Saving model ...
Epoch: 7 cost time: 1.0854055881500244
Epoch: 7, Steps: 10 | Train Loss: 1.306 Vali Loss: 3.193 Vali Acc: 0.208 Test Loss: 3.193 Test Acc: 0.208
Validation loss decreased (-0.176439 --> -0.208203).  Saving model ...
Epoch: 8 cost time: 1.2023723125457764
Epoch: 8, Steps: 10 | Train Loss: 0.919 Vali Loss: 3.259 Vali Acc: 0.232 Test Loss: 3.259 Test Acc: 0.232
Validation loss decreased (-0.208203 --> -0.231732).  Saving model ...
Epoch: 9 cost time: 1.3232920169830322
Epoch: 9, Steps: 10 | Train Loss: 0.604 Vali Loss: 3.362 Vali Acc: 0.242 Test Loss: 3.362 Test Acc: 0.242
Validation loss decreased (-0.231732 --> -0.242319).  Saving model ...
Epoch: 10 cost time: 1.2501780986785889
Epoch: 10, Steps: 10 | Train Loss: 0.343 Vali Loss: 3.521 Vali Acc: 0.255 Test Loss: 3.521 Test Acc: 0.255
Validation loss decreased (-0.242319 --> -0.255259).  Saving model ...
Epoch: 11 cost time: 1.1086618900299072
Epoch: 11, Steps: 10 | Train Loss: 0.199 Vali Loss: 3.741 Vali Acc: 0.264 Test Loss: 3.741 Test Acc: 0.264
Validation loss decreased (-0.255259 --> -0.263492).  Saving model ...
Epoch: 12 cost time: 1.1691157817840576
Epoch: 12, Steps: 10 | Train Loss: 0.103 Vali Loss: 3.888 Vali Acc: 0.266 Test Loss: 3.888 Test Acc: 0.266
Validation loss decreased (-0.263492 --> -0.265843).  Saving model ...
Epoch: 13 cost time: 1.2895350456237793
Epoch: 13, Steps: 10 | Train Loss: 0.058 Vali Loss: 3.968 Vali Acc: 0.276 Test Loss: 3.968 Test Acc: 0.276
Validation loss decreased (-0.265843 --> -0.276431).  Saving model ...
Epoch: 14 cost time: 1.1412887573242188
Epoch: 14, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.089 Vali Acc: 0.276 Test Loss: 4.089 Test Acc: 0.276
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0802192687988281
Epoch: 15, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.165 Vali Acc: 0.278 Test Loss: 4.165 Test Acc: 0.278
Validation loss decreased (-0.276431 --> -0.277605).  Saving model ...
Epoch: 16 cost time: 0.9489121437072754
Epoch: 16, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.221 Vali Acc: 0.285 Test Loss: 4.221 Test Acc: 0.285
Validation loss decreased (-0.277605 --> -0.284664).  Saving model ...
Epoch: 17 cost time: 0.9381721019744873
Epoch: 17, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.280 Vali Acc: 0.281 Test Loss: 4.280 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1272335052490234
Epoch: 18, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.336 Vali Acc: 0.282 Test Loss: 4.336 Test Acc: 0.282
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.1319780349731445
Epoch: 19, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.380 Vali Acc: 0.288 Test Loss: 4.380 Test Acc: 0.288
Validation loss decreased (-0.284664 --> -0.288191).  Saving model ...
Epoch: 20 cost time: 1.239858865737915
Epoch: 20, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.411 Vali Acc: 0.285 Test Loss: 4.411 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1410627365112305
Epoch: 21, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.454 Vali Acc: 0.282 Test Loss: 4.454 Test Acc: 0.282
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.1272375583648682
Epoch: 22, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.501 Vali Acc: 0.281 Test Loss: 4.501 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.082446575164795
Epoch: 23, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.545 Vali Acc: 0.281 Test Loss: 4.545 Test Acc: 0.281
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.1866035461425781
Epoch: 24, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.585 Vali Acc: 0.286 Test Loss: 4.585 Test Acc: 0.286
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.1350364685058594
Epoch: 25, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.594 Vali Acc: 0.282 Test Loss: 4.594 Test Acc: 0.282
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.1644916534423828
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.622 Vali Acc: 0.284 Test Loss: 4.622 Test Acc: 0.284
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.9010193347930908
Epoch: 27, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.655 Vali Acc: 0.284 Test Loss: 4.655 Test Acc: 0.284
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.853574275970459
Epoch: 28, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.684 Vali Acc: 0.285 Test Loss: 4.684 Test Acc: 0.285
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.0275814533233643
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.718 Vali Acc: 0.285 Test Loss: 4.718 Test Acc: 0.285
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.28823529411764703
model parameter : 2299546
model size : 8.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps23_str12_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.208350896835327
Epoch: 1, Steps: 10 | Train Loss: 3.296 Vali Loss: 3.279 Vali Acc: 0.040 Test Loss: 3.279 Test Acc: 0.040
Validation loss decreased (inf --> -0.039967).  Saving model ...
Epoch: 2 cost time: 0.9755954742431641
Epoch: 2, Steps: 10 | Train Loss: 3.170 Vali Loss: 3.261 Vali Acc: 0.045 Test Loss: 3.261 Test Acc: 0.045
Validation loss decreased (-0.039967 --> -0.044673).  Saving model ...
Epoch: 3 cost time: 1.1355576515197754
Epoch: 3, Steps: 10 | Train Loss: 2.963 Vali Loss: 3.239 Vali Acc: 0.061 Test Loss: 3.239 Test Acc: 0.061
Validation loss decreased (-0.044673 --> -0.061144).  Saving model ...
Epoch: 4 cost time: 1.0277142524719238
Epoch: 4, Steps: 10 | Train Loss: 2.717 Vali Loss: 3.221 Vali Acc: 0.086 Test Loss: 3.221 Test Acc: 0.086
Validation loss decreased (-0.061144 --> -0.085850).  Saving model ...
Epoch: 5 cost time: 1.1312496662139893
Epoch: 5, Steps: 10 | Train Loss: 2.480 Vali Loss: 3.204 Vali Acc: 0.109 Test Loss: 3.204 Test Acc: 0.109
Validation loss decreased (-0.085850 --> -0.109380).  Saving model ...
Epoch: 6 cost time: 1.164536476135254
Epoch: 6, Steps: 10 | Train Loss: 2.143 Vali Loss: 3.192 Vali Acc: 0.124 Test Loss: 3.192 Test Acc: 0.124
Validation loss decreased (-0.109380 --> -0.123497).  Saving model ...
Epoch: 7 cost time: 1.2087910175323486
Epoch: 7, Steps: 10 | Train Loss: 1.816 Vali Loss: 3.177 Vali Acc: 0.148 Test Loss: 3.177 Test Acc: 0.148
Validation loss decreased (-0.123497 --> -0.148204).  Saving model ...
Epoch: 8 cost time: 1.2307491302490234
Epoch: 8, Steps: 10 | Train Loss: 1.463 Vali Loss: 3.172 Vali Acc: 0.192 Test Loss: 3.172 Test Acc: 0.192
Validation loss decreased (-0.148204 --> -0.191733).  Saving model ...
Epoch: 9 cost time: 1.113799810409546
Epoch: 9, Steps: 10 | Train Loss: 1.102 Vali Loss: 3.210 Vali Acc: 0.220 Test Loss: 3.210 Test Acc: 0.220
Validation loss decreased (-0.191733 --> -0.219968).  Saving model ...
Epoch: 10 cost time: 1.0454764366149902
Epoch: 10, Steps: 10 | Train Loss: 0.833 Vali Loss: 3.263 Vali Acc: 0.238 Test Loss: 3.263 Test Acc: 0.238
Validation loss decreased (-0.219968 --> -0.237614).  Saving model ...
Epoch: 11 cost time: 1.0157535076141357
Epoch: 11, Steps: 10 | Train Loss: 0.588 Vali Loss: 3.330 Vali Acc: 0.251 Test Loss: 3.330 Test Acc: 0.251
Validation loss decreased (-0.237614 --> -0.250555).  Saving model ...
Epoch: 12 cost time: 1.1403148174285889
Epoch: 12, Steps: 10 | Train Loss: 0.391 Vali Loss: 3.442 Vali Acc: 0.266 Test Loss: 3.442 Test Acc: 0.266
Validation loss decreased (-0.250555 --> -0.265848).  Saving model ...
Epoch: 13 cost time: 1.0910930633544922
Epoch: 13, Steps: 10 | Train Loss: 0.239 Vali Loss: 3.556 Vali Acc: 0.265 Test Loss: 3.556 Test Acc: 0.265
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1260416507720947
Epoch: 14, Steps: 10 | Train Loss: 0.155 Vali Loss: 3.684 Vali Acc: 0.267 Test Loss: 3.684 Test Acc: 0.267
Validation loss decreased (-0.265848 --> -0.267022).  Saving model ...
Epoch: 15 cost time: 1.1462750434875488
Epoch: 15, Steps: 10 | Train Loss: 0.099 Vali Loss: 3.781 Vali Acc: 0.271 Test Loss: 3.781 Test Acc: 0.271
Validation loss decreased (-0.267022 --> -0.270550).  Saving model ...
Epoch: 16 cost time: 1.122445821762085
Epoch: 16, Steps: 10 | Train Loss: 0.065 Vali Loss: 3.862 Vali Acc: 0.274 Test Loss: 3.862 Test Acc: 0.274
Validation loss decreased (-0.270550 --> -0.274079).  Saving model ...
Epoch: 17 cost time: 1.2686865329742432
Epoch: 17, Steps: 10 | Train Loss: 0.049 Vali Loss: 3.931 Vali Acc: 0.268 Test Loss: 3.931 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0777318477630615
Epoch: 18, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.007 Vali Acc: 0.267 Test Loss: 4.007 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9299271106719971
Epoch: 19, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.052 Vali Acc: 0.276 Test Loss: 4.052 Test Acc: 0.276
Validation loss decreased (-0.274079 --> -0.276430).  Saving model ...
Epoch: 20 cost time: 1.306485652923584
Epoch: 20, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.096 Vali Acc: 0.285 Test Loss: 4.096 Test Acc: 0.285
Validation loss decreased (-0.276430 --> -0.284665).  Saving model ...
Epoch: 21 cost time: 1.2572236061096191
Epoch: 21, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.132 Vali Acc: 0.287 Test Loss: 4.132 Test Acc: 0.287
Validation loss decreased (-0.284665 --> -0.287018).  Saving model ...
Epoch: 22 cost time: 1.2404193878173828
Epoch: 22, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.164 Vali Acc: 0.282 Test Loss: 4.164 Test Acc: 0.282
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.281386375427246
Epoch: 23, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.191 Vali Acc: 0.281 Test Loss: 4.191 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.2162954807281494
Epoch: 24, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.244 Vali Acc: 0.282 Test Loss: 4.244 Test Acc: 0.282
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.200861930847168
Epoch: 25, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.278 Vali Acc: 0.284 Test Loss: 4.278 Test Acc: 0.284
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.280733346939087
Epoch: 26, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.308 Vali Acc: 0.279 Test Loss: 4.308 Test Acc: 0.279
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.174790382385254
Epoch: 27, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.350 Vali Acc: 0.286 Test Loss: 4.350 Test Acc: 0.286
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.3097221851348877
Epoch: 28, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.377 Vali Acc: 0.285 Test Loss: 4.377 Test Acc: 0.285
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.130965232849121
Epoch: 29, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.403 Vali Acc: 0.284 Test Loss: 4.403 Test Acc: 0.284
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.1643409729003906
Epoch: 30, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.431 Vali Acc: 0.285 Test Loss: 4.431 Test Acc: 0.285
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.2523512840270996
Epoch: 31, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.452 Vali Acc: 0.287 Test Loss: 4.452 Test Acc: 0.287
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps23_str12_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.28705882352941176
model parameter : 2220570
model size : 8.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.2476115226745605
Epoch: 1, Steps: 10 | Train Loss: 3.313 Vali Loss: 3.274 Vali Acc: 0.034 Test Loss: 3.274 Test Acc: 0.034
Validation loss decreased (inf --> -0.034085).  Saving model ...
Epoch: 2 cost time: 1.1605191230773926
Epoch: 2, Steps: 10 | Train Loss: 3.205 Vali Loss: 3.258 Vali Acc: 0.048 Test Loss: 3.258 Test Acc: 0.048
Validation loss decreased (-0.034085 --> -0.048203).  Saving model ...
Epoch: 3 cost time: 1.2704367637634277
Epoch: 3, Steps: 10 | Train Loss: 3.032 Vali Loss: 3.240 Vali Acc: 0.076 Test Loss: 3.240 Test Acc: 0.076
Validation loss decreased (-0.048203 --> -0.076438).  Saving model ...
Epoch: 4 cost time: 1.067549467086792
Epoch: 4, Steps: 10 | Train Loss: 2.804 Vali Loss: 3.222 Vali Acc: 0.085 Test Loss: 3.222 Test Acc: 0.085
Validation loss decreased (-0.076438 --> -0.084674).  Saving model ...
Epoch: 5 cost time: 1.0890898704528809
Epoch: 5, Steps: 10 | Train Loss: 2.571 Vali Loss: 3.210 Vali Acc: 0.108 Test Loss: 3.210 Test Acc: 0.108
Validation loss decreased (-0.084674 --> -0.108203).  Saving model ...
Epoch: 6 cost time: 1.0564589500427246
Epoch: 6, Steps: 10 | Train Loss: 2.313 Vali Loss: 3.195 Vali Acc: 0.132 Test Loss: 3.195 Test Acc: 0.132
Validation loss decreased (-0.108203 --> -0.131733).  Saving model ...
Epoch: 7 cost time: 1.164604663848877
Epoch: 7, Steps: 10 | Train Loss: 2.022 Vali Loss: 3.190 Vali Acc: 0.141 Test Loss: 3.190 Test Acc: 0.141
Validation loss decreased (-0.131733 --> -0.141145).  Saving model ...
Epoch: 8 cost time: 1.0788745880126953
Epoch: 8, Steps: 10 | Train Loss: 1.730 Vali Loss: 3.177 Vali Acc: 0.165 Test Loss: 3.177 Test Acc: 0.165
Validation loss decreased (-0.141145 --> -0.164674).  Saving model ...
Epoch: 9 cost time: 1.0514774322509766
Epoch: 9, Steps: 10 | Train Loss: 1.419 Vali Loss: 3.166 Vali Acc: 0.179 Test Loss: 3.166 Test Acc: 0.179
Validation loss decreased (-0.164674 --> -0.178792).  Saving model ...
Epoch: 10 cost time: 1.2088284492492676
Epoch: 10, Steps: 10 | Train Loss: 1.127 Vali Loss: 3.189 Vali Acc: 0.199 Test Loss: 3.189 Test Acc: 0.199
Validation loss decreased (-0.178792 --> -0.198792).  Saving model ...
Epoch: 11 cost time: 1.2150795459747314
Epoch: 11, Steps: 10 | Train Loss: 0.837 Vali Loss: 3.230 Vali Acc: 0.215 Test Loss: 3.230 Test Acc: 0.215
Validation loss decreased (-0.198792 --> -0.215262).  Saving model ...
Epoch: 12 cost time: 1.063483476638794
Epoch: 12, Steps: 10 | Train Loss: 0.606 Vali Loss: 3.283 Vali Acc: 0.244 Test Loss: 3.283 Test Acc: 0.244
Validation loss decreased (-0.215262 --> -0.243497).  Saving model ...
Epoch: 13 cost time: 1.0466506481170654
Epoch: 13, Steps: 10 | Train Loss: 0.422 Vali Loss: 3.369 Vali Acc: 0.244 Test Loss: 3.369 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.963416337966919
Epoch: 14, Steps: 10 | Train Loss: 0.263 Vali Loss: 3.460 Vali Acc: 0.259 Test Loss: 3.460 Test Acc: 0.259
Validation loss decreased (-0.243497 --> -0.258789).  Saving model ...
Epoch: 15 cost time: 1.2056083679199219
Epoch: 15, Steps: 10 | Train Loss: 0.171 Vali Loss: 3.538 Vali Acc: 0.265 Test Loss: 3.538 Test Acc: 0.265
Validation loss decreased (-0.258789 --> -0.264670).  Saving model ...
Epoch: 16 cost time: 1.1604282855987549
Epoch: 16, Steps: 10 | Train Loss: 0.109 Vali Loss: 3.627 Vali Acc: 0.273 Test Loss: 3.627 Test Acc: 0.273
Validation loss decreased (-0.264670 --> -0.272905).  Saving model ...
Epoch: 17 cost time: 1.1039321422576904
Epoch: 17, Steps: 10 | Train Loss: 0.074 Vali Loss: 3.742 Vali Acc: 0.272 Test Loss: 3.742 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0225040912628174
Epoch: 18, Steps: 10 | Train Loss: 0.057 Vali Loss: 3.835 Vali Acc: 0.273 Test Loss: 3.835 Test Acc: 0.273
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.1963322162628174
Epoch: 19, Steps: 10 | Train Loss: 0.042 Vali Loss: 3.893 Vali Acc: 0.271 Test Loss: 3.893 Test Acc: 0.271
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.0002353191375732
Epoch: 20, Steps: 10 | Train Loss: 0.035 Vali Loss: 3.918 Vali Acc: 0.276 Test Loss: 3.918 Test Acc: 0.276
Validation loss decreased (-0.272905 --> -0.276431).  Saving model ...
Epoch: 21 cost time: 0.9748480319976807
Epoch: 21, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.963 Vali Acc: 0.275 Test Loss: 3.963 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8678977489471436
Epoch: 22, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.013 Vali Acc: 0.275 Test Loss: 4.013 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0187733173370361
Epoch: 23, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.067 Vali Acc: 0.271 Test Loss: 4.067 Test Acc: 0.271
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.9731400012969971
Epoch: 24, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.101 Vali Acc: 0.273 Test Loss: 4.101 Test Acc: 0.273
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.1289048194885254
Epoch: 25, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.112 Vali Acc: 0.278 Test Loss: 4.112 Test Acc: 0.278
Validation loss decreased (-0.276431 --> -0.277606).  Saving model ...
Epoch: 26 cost time: 1.0234954357147217
Epoch: 26, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.136 Vali Acc: 0.279 Test Loss: 4.136 Test Acc: 0.279
Validation loss decreased (-0.277606 --> -0.278782).  Saving model ...
Epoch: 27 cost time: 1.0608189105987549
Epoch: 27, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.179 Vali Acc: 0.281 Test Loss: 4.179 Test Acc: 0.281
Validation loss decreased (-0.278782 --> -0.281135).  Saving model ...
Epoch: 28 cost time: 1.1259233951568604
Epoch: 28, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.216 Vali Acc: 0.280 Test Loss: 4.216 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.0897715091705322
Epoch: 29, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.237 Vali Acc: 0.285 Test Loss: 4.237 Test Acc: 0.285
Validation loss decreased (-0.281135 --> -0.284664).  Saving model ...
Epoch: 30 cost time: 1.104358434677124
Epoch: 30, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.297 Vali Acc: 0.285 Test Loss: 4.297 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.1617939472198486
Epoch: 31, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.309 Vali Acc: 0.284 Test Loss: 4.309 Test Acc: 0.284
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.0656638145446777
Epoch: 32, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.334 Vali Acc: 0.286 Test Loss: 4.334 Test Acc: 0.286
Validation loss decreased (-0.284664 --> -0.285839).  Saving model ...
Epoch: 33 cost time: 0.9802196025848389
Epoch: 33, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.347 Vali Acc: 0.286 Test Loss: 4.347 Test Acc: 0.286
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.9576077461242676
Epoch: 34, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.383 Vali Acc: 0.285 Test Loss: 4.383 Test Acc: 0.285
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.1010396480560303
Epoch: 35, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.412 Vali Acc: 0.285 Test Loss: 4.412 Test Acc: 0.285
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.0113487243652344
Epoch: 36, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.426 Vali Acc: 0.284 Test Loss: 4.426 Test Acc: 0.284
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.084035873413086
Epoch: 37, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.453 Vali Acc: 0.281 Test Loss: 4.453 Test Acc: 0.281
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.181272268295288
Epoch: 38, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.457 Vali Acc: 0.281 Test Loss: 4.457 Test Acc: 0.281
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.0724279880523682
Epoch: 39, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.472 Vali Acc: 0.281 Test Loss: 4.472 Test Acc: 0.281
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.0819871425628662
Epoch: 40, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.498 Vali Acc: 0.286 Test Loss: 4.498 Test Acc: 0.286
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.0496084690093994
Epoch: 41, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.532 Vali Acc: 0.287 Test Loss: 4.532 Test Acc: 0.287
Validation loss decreased (-0.285839 --> -0.287014).  Saving model ...
Epoch: 42 cost time: 1.0823440551757812
Epoch: 42, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.547 Vali Acc: 0.286 Test Loss: 4.547 Test Acc: 0.286
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.1757287979125977
Epoch: 43, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.582 Vali Acc: 0.286 Test Loss: 4.582 Test Acc: 0.286
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.9597992897033691
Epoch: 44, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.597 Vali Acc: 0.284 Test Loss: 4.597 Test Acc: 0.284
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.1100640296936035
Epoch: 45, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.612 Vali Acc: 0.292 Test Loss: 4.612 Test Acc: 0.292
Validation loss decreased (-0.287014 --> -0.291719).  Saving model ...
Epoch: 46 cost time: 1.0104873180389404
Epoch: 46, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.621 Vali Acc: 0.288 Test Loss: 4.621 Test Acc: 0.288
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.0687587261199951
Epoch: 47, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.658 Vali Acc: 0.289 Test Loss: 4.658 Test Acc: 0.289
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.9031093120574951
Epoch: 48, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.668 Vali Acc: 0.287 Test Loss: 4.668 Test Acc: 0.287
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.0258698463439941
Epoch: 49, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.661 Vali Acc: 0.285 Test Loss: 4.661 Test Acc: 0.285
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 1.1408171653747559
Epoch: 50, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.677 Vali Acc: 0.286 Test Loss: 4.677 Test Acc: 0.286
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2917647058823529
model parameter : 2201626
model size : 8.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps38_str19_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.1852338314056396
Epoch: 1, Steps: 10 | Train Loss: 3.311 Vali Loss: 3.267 Vali Acc: 0.051 Test Loss: 3.267 Test Acc: 0.051
Validation loss decreased (inf --> -0.050556).  Saving model ...
Epoch: 2 cost time: 1.2034637928009033
Epoch: 2, Steps: 10 | Train Loss: 3.238 Vali Loss: 3.251 Vali Acc: 0.054 Test Loss: 3.251 Test Acc: 0.054
Validation loss decreased (-0.050556 --> -0.054085).  Saving model ...
Epoch: 3 cost time: 1.1151719093322754
Epoch: 3, Steps: 10 | Train Loss: 3.058 Vali Loss: 3.227 Vali Acc: 0.084 Test Loss: 3.227 Test Acc: 0.084
Validation loss decreased (-0.054085 --> -0.083497).  Saving model ...
Epoch: 4 cost time: 1.1033146381378174
Epoch: 4, Steps: 10 | Train Loss: 2.884 Vali Loss: 3.209 Vali Acc: 0.101 Test Loss: 3.209 Test Acc: 0.101
Validation loss decreased (-0.083497 --> -0.101144).  Saving model ...
Epoch: 5 cost time: 1.0056195259094238
Epoch: 5, Steps: 10 | Train Loss: 2.648 Vali Loss: 3.196 Vali Acc: 0.116 Test Loss: 3.196 Test Acc: 0.116
Validation loss decreased (-0.101144 --> -0.116439).  Saving model ...
Epoch: 6 cost time: 1.0178790092468262
Epoch: 6, Steps: 10 | Train Loss: 2.402 Vali Loss: 3.186 Vali Acc: 0.131 Test Loss: 3.186 Test Acc: 0.131
Validation loss decreased (-0.116439 --> -0.130556).  Saving model ...
Epoch: 7 cost time: 1.0266473293304443
Epoch: 7, Steps: 10 | Train Loss: 2.167 Vali Loss: 3.175 Vali Acc: 0.151 Test Loss: 3.175 Test Acc: 0.151
Validation loss decreased (-0.130556 --> -0.150556).  Saving model ...
Epoch: 8 cost time: 1.1310977935791016
Epoch: 8, Steps: 10 | Train Loss: 1.912 Vali Loss: 3.171 Vali Acc: 0.165 Test Loss: 3.171 Test Acc: 0.165
Validation loss decreased (-0.150556 --> -0.164674).  Saving model ...
Epoch: 9 cost time: 1.0262327194213867
Epoch: 9, Steps: 10 | Train Loss: 1.594 Vali Loss: 3.175 Vali Acc: 0.182 Test Loss: 3.175 Test Acc: 0.182
Validation loss decreased (-0.164674 --> -0.182321).  Saving model ...
Epoch: 10 cost time: 1.1343774795532227
Epoch: 10, Steps: 10 | Train Loss: 1.297 Vali Loss: 3.190 Vali Acc: 0.201 Test Loss: 3.190 Test Acc: 0.201
Validation loss decreased (-0.182321 --> -0.201145).  Saving model ...
Epoch: 11 cost time: 1.0648975372314453
Epoch: 11, Steps: 10 | Train Loss: 1.024 Vali Loss: 3.229 Vali Acc: 0.221 Test Loss: 3.229 Test Acc: 0.221
Validation loss decreased (-0.201145 --> -0.221144).  Saving model ...
Epoch: 12 cost time: 1.0901353359222412
Epoch: 12, Steps: 10 | Train Loss: 0.782 Vali Loss: 3.282 Vali Acc: 0.226 Test Loss: 3.282 Test Acc: 0.226
Validation loss decreased (-0.221144 --> -0.225850).  Saving model ...
Epoch: 13 cost time: 1.119462490081787
Epoch: 13, Steps: 10 | Train Loss: 0.605 Vali Loss: 3.358 Vali Acc: 0.238 Test Loss: 3.358 Test Acc: 0.238
Validation loss decreased (-0.225850 --> -0.237613).  Saving model ...
Epoch: 14 cost time: 1.170518159866333
Epoch: 14, Steps: 10 | Train Loss: 0.400 Vali Loss: 3.454 Vali Acc: 0.252 Test Loss: 3.454 Test Acc: 0.252
Validation loss decreased (-0.237613 --> -0.251730).  Saving model ...
Epoch: 15 cost time: 1.1299052238464355
Epoch: 15, Steps: 10 | Train Loss: 0.267 Vali Loss: 3.537 Vali Acc: 0.251 Test Loss: 3.537 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1686286926269531
Epoch: 16, Steps: 10 | Train Loss: 0.186 Vali Loss: 3.626 Vali Acc: 0.255 Test Loss: 3.626 Test Acc: 0.255
Validation loss decreased (-0.251730 --> -0.255258).  Saving model ...
Epoch: 17 cost time: 1.1323330402374268
Epoch: 17, Steps: 10 | Train Loss: 0.118 Vali Loss: 3.689 Vali Acc: 0.260 Test Loss: 3.689 Test Acc: 0.260
Validation loss decreased (-0.255258 --> -0.259963).  Saving model ...
Epoch: 18 cost time: 1.1764075756072998
Epoch: 18, Steps: 10 | Train Loss: 0.098 Vali Loss: 3.797 Vali Acc: 0.260 Test Loss: 3.797 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1135344505310059
Epoch: 19, Steps: 10 | Train Loss: 0.063 Vali Loss: 3.878 Vali Acc: 0.260 Test Loss: 3.878 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.126671314239502
Epoch: 20, Steps: 10 | Train Loss: 0.052 Vali Loss: 3.925 Vali Acc: 0.266 Test Loss: 3.925 Test Acc: 0.266
Validation loss decreased (-0.259963 --> -0.265843).  Saving model ...
Epoch: 21 cost time: 1.113466739654541
Epoch: 21, Steps: 10 | Train Loss: 0.039 Vali Loss: 3.995 Vali Acc: 0.269 Test Loss: 3.995 Test Acc: 0.269
Validation loss decreased (-0.265843 --> -0.269372).  Saving model ...
Epoch: 22 cost time: 1.1089723110198975
Epoch: 22, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.025 Vali Acc: 0.272 Test Loss: 4.025 Test Acc: 0.272
Validation loss decreased (-0.269372 --> -0.271724).  Saving model ...
Epoch: 23 cost time: 1.1358914375305176
Epoch: 23, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.068 Vali Acc: 0.272 Test Loss: 4.068 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.2994697093963623
Epoch: 24, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.088 Vali Acc: 0.278 Test Loss: 4.088 Test Acc: 0.278
Validation loss decreased (-0.271724 --> -0.277606).  Saving model ...
Epoch: 25 cost time: 1.3228049278259277
Epoch: 25, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.152 Vali Acc: 0.274 Test Loss: 4.152 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.3448903560638428
Epoch: 26, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.188 Vali Acc: 0.275 Test Loss: 4.188 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.2632243633270264
Epoch: 27, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.235 Vali Acc: 0.278 Test Loss: 4.235 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.4299955368041992
Epoch: 28, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.275 Vali Acc: 0.278 Test Loss: 4.275 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.172945261001587
Epoch: 29, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.301 Vali Acc: 0.275 Test Loss: 4.301 Test Acc: 0.275
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.2198221683502197
Epoch: 30, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.328 Vali Acc: 0.279 Test Loss: 4.328 Test Acc: 0.279
Validation loss decreased (-0.277606 --> -0.278780).  Saving model ...
Epoch: 31 cost time: 1.2132501602172852
Epoch: 31, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.345 Vali Acc: 0.280 Test Loss: 4.345 Test Acc: 0.280
Validation loss decreased (-0.278780 --> -0.279957).  Saving model ...
Epoch: 32 cost time: 1.424393892288208
Epoch: 32, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.395 Vali Acc: 0.281 Test Loss: 4.395 Test Acc: 0.281
Validation loss decreased (-0.279957 --> -0.281133).  Saving model ...
Epoch: 33 cost time: 1.22995924949646
Epoch: 33, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.414 Vali Acc: 0.280 Test Loss: 4.414 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.1685969829559326
Epoch: 34, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.441 Vali Acc: 0.281 Test Loss: 4.441 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.2573635578155518
Epoch: 35, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.467 Vali Acc: 0.282 Test Loss: 4.467 Test Acc: 0.282
Validation loss decreased (-0.281133 --> -0.282308).  Saving model ...
Epoch: 36 cost time: 1.129746913909912
Epoch: 36, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.481 Vali Acc: 0.281 Test Loss: 4.481 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.407165288925171
Epoch: 37, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.512 Vali Acc: 0.282 Test Loss: 4.512 Test Acc: 0.282
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.3619012832641602
Epoch: 38, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.538 Vali Acc: 0.287 Test Loss: 4.538 Test Acc: 0.287
Validation loss decreased (-0.282308 --> -0.287013).  Saving model ...
Epoch: 39 cost time: 1.2888104915618896
Epoch: 39, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.560 Vali Acc: 0.289 Test Loss: 4.560 Test Acc: 0.289
Validation loss decreased (-0.287013 --> -0.289366).  Saving model ...
Epoch: 40 cost time: 1.3546409606933594
Epoch: 40, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.589 Vali Acc: 0.284 Test Loss: 4.589 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.391371726989746
Epoch: 41, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.602 Vali Acc: 0.281 Test Loss: 4.602 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.379819393157959
Epoch: 42, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.640 Vali Acc: 0.281 Test Loss: 4.640 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.225687026977539
Epoch: 43, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.661 Vali Acc: 0.280 Test Loss: 4.661 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.3751001358032227
Epoch: 44, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.689 Vali Acc: 0.278 Test Loss: 4.689 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.3515589237213135
Epoch: 45, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.705 Vali Acc: 0.284 Test Loss: 4.705 Test Acc: 0.284
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.4139950275421143
Epoch: 46, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.736 Vali Acc: 0.285 Test Loss: 4.736 Test Acc: 0.285
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.1115586757659912
Epoch: 47, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.743 Vali Acc: 0.285 Test Loss: 4.743 Test Acc: 0.285
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 1.153299331665039
Epoch: 48, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.780 Vali Acc: 0.285 Test Loss: 4.780 Test Acc: 0.285
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 1.4177134037017822
Epoch: 49, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.785 Vali Acc: 0.284 Test Loss: 4.785 Test Acc: 0.284
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps38_str19_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.28941176470588237
model parameter : 2182554
model size : 8.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.8317253589630127
Epoch: 1, Steps: 10 | Train Loss: 3.314 Vali Loss: 3.263 Vali Acc: 0.047 Test Loss: 3.263 Test Acc: 0.047
Validation loss decreased (inf --> -0.047026).  Saving model ...
Epoch: 2 cost time: 1.215651512145996
Epoch: 2, Steps: 10 | Train Loss: 3.101 Vali Loss: 3.242 Vali Acc: 0.087 Test Loss: 3.242 Test Acc: 0.087
Validation loss decreased (-0.047026 --> -0.087026).  Saving model ...
Epoch: 3 cost time: 1.2150325775146484
Epoch: 3, Steps: 10 | Train Loss: 2.645 Vali Loss: 3.231 Vali Acc: 0.096 Test Loss: 3.231 Test Acc: 0.096
Validation loss decreased (-0.087026 --> -0.096438).  Saving model ...
Epoch: 4 cost time: 1.2742946147918701
Epoch: 4, Steps: 10 | Train Loss: 2.209 Vali Loss: 3.214 Vali Acc: 0.128 Test Loss: 3.214 Test Acc: 0.128
Validation loss decreased (-0.096438 --> -0.128203).  Saving model ...
Epoch: 5 cost time: 1.14034104347229
Epoch: 5, Steps: 10 | Train Loss: 1.593 Vali Loss: 3.193 Vali Acc: 0.171 Test Loss: 3.193 Test Acc: 0.171
Validation loss decreased (-0.128203 --> -0.170556).  Saving model ...
Epoch: 6 cost time: 1.3125333786010742
Epoch: 6, Steps: 10 | Train Loss: 1.026 Vali Loss: 3.257 Vali Acc: 0.212 Test Loss: 3.257 Test Acc: 0.212
Validation loss decreased (-0.170556 --> -0.211732).  Saving model ...
Epoch: 7 cost time: 1.5143427848815918
Epoch: 7, Steps: 10 | Train Loss: 0.555 Vali Loss: 3.389 Vali Acc: 0.226 Test Loss: 3.389 Test Acc: 0.226
Validation loss decreased (-0.211732 --> -0.225848).  Saving model ...
Epoch: 8 cost time: 1.2988121509552002
Epoch: 8, Steps: 10 | Train Loss: 0.256 Vali Loss: 3.647 Vali Acc: 0.242 Test Loss: 3.647 Test Acc: 0.242
Validation loss decreased (-0.225848 --> -0.242316).  Saving model ...
Epoch: 9 cost time: 1.3166251182556152
Epoch: 9, Steps: 10 | Train Loss: 0.103 Vali Loss: 3.995 Vali Acc: 0.242 Test Loss: 3.995 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2314443588256836
Epoch: 10, Steps: 10 | Train Loss: 0.038 Vali Loss: 4.231 Vali Acc: 0.260 Test Loss: 4.231 Test Acc: 0.260
Validation loss decreased (-0.242316 --> -0.259958).  Saving model ...
Epoch: 11 cost time: 1.4172592163085938
Epoch: 11, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.324 Vali Acc: 0.262 Test Loss: 4.324 Test Acc: 0.262
Validation loss decreased (-0.259958 --> -0.262310).  Saving model ...
Epoch: 12 cost time: 1.3292334079742432
Epoch: 12, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.422 Vali Acc: 0.256 Test Loss: 4.422 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3146259784698486
Epoch: 13, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.486 Vali Acc: 0.264 Test Loss: 4.486 Test Acc: 0.264
Validation loss decreased (-0.262310 --> -0.263485).  Saving model ...
Epoch: 14 cost time: 1.0977308750152588
Epoch: 14, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.545 Vali Acc: 0.266 Test Loss: 4.545 Test Acc: 0.266
Validation loss decreased (-0.263485 --> -0.265837).  Saving model ...
Epoch: 15 cost time: 1.1443946361541748
Epoch: 15, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.623 Vali Acc: 0.262 Test Loss: 4.623 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3516950607299805
Epoch: 16, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.652 Vali Acc: 0.265 Test Loss: 4.652 Test Acc: 0.265
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.3814411163330078
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.690 Vali Acc: 0.265 Test Loss: 4.690 Test Acc: 0.265
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.3867733478546143
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.721 Vali Acc: 0.264 Test Loss: 4.721 Test Acc: 0.264
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.2649509906768799
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.758 Vali Acc: 0.265 Test Loss: 4.758 Test Acc: 0.265
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.3626360893249512
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.792 Vali Acc: 0.264 Test Loss: 4.792 Test Acc: 0.264
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.1478509902954102
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.829 Vali Acc: 0.262 Test Loss: 4.829 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.3208794593811035
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.866 Vali Acc: 0.264 Test Loss: 4.866 Test Acc: 0.264
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.3631584644317627
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.897 Vali Acc: 0.265 Test Loss: 4.897 Test Acc: 0.265
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.3083264827728271
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.924 Vali Acc: 0.264 Test Loss: 4.924 Test Acc: 0.264
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26588235294117646
model parameter : 920666
model size : 3.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.2069411277770996
Epoch: 1, Steps: 10 | Train Loss: 3.273 Vali Loss: 3.253 Vali Acc: 0.032 Test Loss: 3.253 Test Acc: 0.032
Validation loss decreased (inf --> -0.031732).  Saving model ...
Epoch: 2 cost time: 0.7954630851745605
Epoch: 2, Steps: 10 | Train Loss: 3.120 Vali Loss: 3.235 Vali Acc: 0.067 Test Loss: 3.235 Test Acc: 0.067
Validation loss decreased (-0.031732 --> -0.067026).  Saving model ...
Epoch: 3 cost time: 0.9590740203857422
Epoch: 3, Steps: 10 | Train Loss: 2.893 Vali Loss: 3.223 Vali Acc: 0.098 Test Loss: 3.223 Test Acc: 0.098
Validation loss decreased (-0.067026 --> -0.097615).  Saving model ...
Epoch: 4 cost time: 1.1885268688201904
Epoch: 4, Steps: 10 | Train Loss: 2.610 Vali Loss: 3.216 Vali Acc: 0.116 Test Loss: 3.216 Test Acc: 0.116
Validation loss decreased (-0.097615 --> -0.116438).  Saving model ...
Epoch: 5 cost time: 1.1299355030059814
Epoch: 5, Steps: 10 | Train Loss: 2.287 Vali Loss: 3.189 Vali Acc: 0.146 Test Loss: 3.189 Test Acc: 0.146
Validation loss decreased (-0.116438 --> -0.145850).  Saving model ...
Epoch: 6 cost time: 1.0666656494140625
Epoch: 6, Steps: 10 | Train Loss: 1.942 Vali Loss: 3.174 Vali Acc: 0.185 Test Loss: 3.174 Test Acc: 0.185
Validation loss decreased (-0.145850 --> -0.184674).  Saving model ...
Epoch: 7 cost time: 1.1453723907470703
Epoch: 7, Steps: 10 | Train Loss: 1.531 Vali Loss: 3.179 Vali Acc: 0.193 Test Loss: 3.179 Test Acc: 0.193
Validation loss decreased (-0.184674 --> -0.192909).  Saving model ...
Epoch: 8 cost time: 1.1158998012542725
Epoch: 8, Steps: 10 | Train Loss: 1.119 Vali Loss: 3.214 Vali Acc: 0.219 Test Loss: 3.214 Test Acc: 0.219
Validation loss decreased (-0.192909 --> -0.218791).  Saving model ...
Epoch: 9 cost time: 0.913140058517456
Epoch: 9, Steps: 10 | Train Loss: 0.745 Vali Loss: 3.302 Vali Acc: 0.231 Test Loss: 3.302 Test Acc: 0.231
Validation loss decreased (-0.218791 --> -0.230555).  Saving model ...
Epoch: 10 cost time: 0.9951422214508057
Epoch: 10, Steps: 10 | Train Loss: 0.473 Vali Loss: 3.467 Vali Acc: 0.239 Test Loss: 3.467 Test Acc: 0.239
Validation loss decreased (-0.230555 --> -0.238789).  Saving model ...
Epoch: 11 cost time: 1.1667718887329102
Epoch: 11, Steps: 10 | Train Loss: 0.274 Vali Loss: 3.645 Vali Acc: 0.239 Test Loss: 3.645 Test Acc: 0.239
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0350298881530762
Epoch: 12, Steps: 10 | Train Loss: 0.159 Vali Loss: 3.860 Vali Acc: 0.245 Test Loss: 3.860 Test Acc: 0.245
Validation loss decreased (-0.238789 --> -0.244667).  Saving model ...
Epoch: 13 cost time: 0.8100347518920898
Epoch: 13, Steps: 10 | Train Loss: 0.091 Vali Loss: 3.972 Vali Acc: 0.253 Test Loss: 3.972 Test Acc: 0.253
Validation loss decreased (-0.244667 --> -0.252901).  Saving model ...
Epoch: 14 cost time: 0.83675217628479
Epoch: 14, Steps: 10 | Train Loss: 0.052 Vali Loss: 4.137 Vali Acc: 0.253 Test Loss: 4.137 Test Acc: 0.253
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9828636646270752
Epoch: 15, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.262 Vali Acc: 0.256 Test Loss: 4.262 Test Acc: 0.256
Validation loss decreased (-0.252901 --> -0.256428).  Saving model ...
Epoch: 16 cost time: 1.205918788909912
Epoch: 16, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.326 Vali Acc: 0.255 Test Loss: 4.326 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2162282466888428
Epoch: 17, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.387 Vali Acc: 0.255 Test Loss: 4.387 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.082336664199829
Epoch: 18, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.449 Vali Acc: 0.261 Test Loss: 4.449 Test Acc: 0.261
Validation loss decreased (-0.256428 --> -0.261132).  Saving model ...
Epoch: 19 cost time: 1.0591809749603271
Epoch: 19, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.499 Vali Acc: 0.261 Test Loss: 4.499 Test Acc: 0.261
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0799298286437988
Epoch: 20, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.569 Vali Acc: 0.259 Test Loss: 4.569 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.1256051063537598
Epoch: 21, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.614 Vali Acc: 0.261 Test Loss: 4.614 Test Acc: 0.261
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.0813367366790771
Epoch: 22, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.662 Vali Acc: 0.260 Test Loss: 4.662 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.115412950515747
Epoch: 23, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.706 Vali Acc: 0.258 Test Loss: 4.706 Test Acc: 0.258
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.0161311626434326
Epoch: 24, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.743 Vali Acc: 0.260 Test Loss: 4.743 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.196159839630127
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.770 Vali Acc: 0.264 Test Loss: 4.770 Test Acc: 0.264
Validation loss decreased (-0.261132 --> -0.263482).  Saving model ...
Epoch: 26 cost time: 1.1981632709503174
Epoch: 26, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.808 Vali Acc: 0.264 Test Loss: 4.808 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9231178760528564
Epoch: 27, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.847 Vali Acc: 0.261 Test Loss: 4.847 Test Acc: 0.261
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.0987439155578613
Epoch: 28, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.882 Vali Acc: 0.259 Test Loss: 4.882 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.164705514907837
Epoch: 29, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.919 Vali Acc: 0.262 Test Loss: 4.919 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.148303508758545
Epoch: 30, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.950 Vali Acc: 0.261 Test Loss: 4.950 Test Acc: 0.261
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.0678064823150635
Epoch: 31, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.994 Vali Acc: 0.264 Test Loss: 4.994 Test Acc: 0.264
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.0825920104980469
Epoch: 32, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.020 Vali Acc: 0.267 Test Loss: 5.020 Test Acc: 0.267
Validation loss decreased (-0.263482 --> -0.267009).  Saving model ...
Epoch: 33 cost time: 1.1124565601348877
Epoch: 33, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.047 Vali Acc: 0.267 Test Loss: 5.047 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.0454864501953125
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.067 Vali Acc: 0.265 Test Loss: 5.067 Test Acc: 0.265
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.2420153617858887
Epoch: 35, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.092 Vali Acc: 0.265 Test Loss: 5.092 Test Acc: 0.265
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.2553503513336182
Epoch: 36, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.121 Vali Acc: 0.266 Test Loss: 5.121 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.1658744812011719
Epoch: 37, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.144 Vali Acc: 0.267 Test Loss: 5.144 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.2653801441192627
Epoch: 38, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.172 Vali Acc: 0.268 Test Loss: 5.172 Test Acc: 0.268
Validation loss decreased (-0.267009 --> -0.268184).  Saving model ...
Epoch: 39 cost time: 1.0233674049377441
Epoch: 39, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.195 Vali Acc: 0.269 Test Loss: 5.195 Test Acc: 0.269
Validation loss decreased (-0.268184 --> -0.269360).  Saving model ...
Epoch: 40 cost time: 1.0538787841796875
Epoch: 40, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.218 Vali Acc: 0.268 Test Loss: 5.218 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.0442349910736084
Epoch: 41, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.248 Vali Acc: 0.268 Test Loss: 5.248 Test Acc: 0.268
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.0933465957641602
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.253 Vali Acc: 0.268 Test Loss: 5.253 Test Acc: 0.268
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.1461920738220215
Epoch: 43, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.277 Vali Acc: 0.269 Test Loss: 5.277 Test Acc: 0.269
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.156559944152832
Epoch: 44, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.293 Vali Acc: 0.271 Test Loss: 5.293 Test Acc: 0.271
Validation loss decreased (-0.269360 --> -0.270535).  Saving model ...
Epoch: 45 cost time: 1.2060363292694092
Epoch: 45, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.318 Vali Acc: 0.269 Test Loss: 5.318 Test Acc: 0.269
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.1123008728027344
Epoch: 46, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.341 Vali Acc: 0.272 Test Loss: 5.341 Test Acc: 0.272
Validation loss decreased (-0.270535 --> -0.271711).  Saving model ...
Epoch: 47 cost time: 1.2463927268981934
Epoch: 47, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.361 Vali Acc: 0.271 Test Loss: 5.361 Test Acc: 0.271
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.1357300281524658
Epoch: 48, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.379 Vali Acc: 0.269 Test Loss: 5.379 Test Acc: 0.269
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.1677141189575195
Epoch: 49, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.399 Vali Acc: 0.271 Test Loss: 5.399 Test Acc: 0.271
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.1602671146392822
Epoch: 50, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.416 Vali Acc: 0.268 Test Loss: 5.416 Test Acc: 0.268
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27176470588235296
model parameter : 731226
model size : 2.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps12_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.3038411140441895
Epoch: 1, Steps: 10 | Train Loss: 3.291 Vali Loss: 3.263 Vali Acc: 0.055 Test Loss: 3.263 Test Acc: 0.055
Validation loss decreased (inf --> -0.055261).  Saving model ...
Epoch: 2 cost time: 1.1090474128723145
Epoch: 2, Steps: 10 | Train Loss: 3.178 Vali Loss: 3.249 Vali Acc: 0.062 Test Loss: 3.249 Test Acc: 0.062
Validation loss decreased (-0.055261 --> -0.062320).  Saving model ...
Epoch: 3 cost time: 1.0921030044555664
Epoch: 3, Steps: 10 | Train Loss: 3.000 Vali Loss: 3.233 Vali Acc: 0.085 Test Loss: 3.233 Test Acc: 0.085
Validation loss decreased (-0.062320 --> -0.084674).  Saving model ...
Epoch: 4 cost time: 0.9903450012207031
Epoch: 4, Steps: 10 | Train Loss: 2.814 Vali Loss: 3.221 Vali Acc: 0.094 Test Loss: 3.221 Test Acc: 0.094
Validation loss decreased (-0.084674 --> -0.094085).  Saving model ...
Epoch: 5 cost time: 1.0327281951904297
Epoch: 5, Steps: 10 | Train Loss: 2.564 Vali Loss: 3.211 Vali Acc: 0.114 Test Loss: 3.211 Test Acc: 0.114
Validation loss decreased (-0.094085 --> -0.114086).  Saving model ...
Epoch: 6 cost time: 1.1703424453735352
Epoch: 6, Steps: 10 | Train Loss: 2.297 Vali Loss: 3.203 Vali Acc: 0.133 Test Loss: 3.203 Test Acc: 0.133
Validation loss decreased (-0.114086 --> -0.132909).  Saving model ...
Epoch: 7 cost time: 0.7349789142608643
Epoch: 7, Steps: 10 | Train Loss: 1.997 Vali Loss: 3.190 Vali Acc: 0.156 Test Loss: 3.190 Test Acc: 0.156
Validation loss decreased (-0.132909 --> -0.156439).  Saving model ...
Epoch: 8 cost time: 0.756662130355835
Epoch: 8, Steps: 10 | Train Loss: 1.664 Vali Loss: 3.186 Vali Acc: 0.168 Test Loss: 3.186 Test Acc: 0.168
Validation loss decreased (-0.156439 --> -0.168203).  Saving model ...
Epoch: 9 cost time: 0.879814863204956
Epoch: 9, Steps: 10 | Train Loss: 1.321 Vali Loss: 3.201 Vali Acc: 0.185 Test Loss: 3.201 Test Acc: 0.185
Validation loss decreased (-0.168203 --> -0.184674).  Saving model ...
Epoch: 10 cost time: 1.1118378639221191
Epoch: 10, Steps: 10 | Train Loss: 1.001 Vali Loss: 3.226 Vali Acc: 0.212 Test Loss: 3.226 Test Acc: 0.212
Validation loss decreased (-0.184674 --> -0.211732).  Saving model ...
Epoch: 11 cost time: 1.2058680057525635
Epoch: 11, Steps: 10 | Train Loss: 0.705 Vali Loss: 3.306 Vali Acc: 0.232 Test Loss: 3.306 Test Acc: 0.232
Validation loss decreased (-0.211732 --> -0.231732).  Saving model ...
Epoch: 12 cost time: 1.1729848384857178
Epoch: 12, Steps: 10 | Train Loss: 0.489 Vali Loss: 3.412 Vali Acc: 0.240 Test Loss: 3.412 Test Acc: 0.240
Validation loss decreased (-0.231732 --> -0.239966).  Saving model ...
Epoch: 13 cost time: 1.1494629383087158
Epoch: 13, Steps: 10 | Train Loss: 0.322 Vali Loss: 3.549 Vali Acc: 0.252 Test Loss: 3.549 Test Acc: 0.252
Validation loss decreased (-0.239966 --> -0.251729).  Saving model ...
Epoch: 14 cost time: 1.0472149848937988
Epoch: 14, Steps: 10 | Train Loss: 0.201 Vali Loss: 3.716 Vali Acc: 0.259 Test Loss: 3.716 Test Acc: 0.259
Validation loss decreased (-0.251729 --> -0.258786).  Saving model ...
Epoch: 15 cost time: 1.0425894260406494
Epoch: 15, Steps: 10 | Train Loss: 0.127 Vali Loss: 3.833 Vali Acc: 0.252 Test Loss: 3.833 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.14369797706604
Epoch: 16, Steps: 10 | Train Loss: 0.089 Vali Loss: 3.936 Vali Acc: 0.255 Test Loss: 3.936 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.1242854595184326
Epoch: 17, Steps: 10 | Train Loss: 0.060 Vali Loss: 4.008 Vali Acc: 0.262 Test Loss: 4.008 Test Acc: 0.262
Validation loss decreased (-0.258786 --> -0.262313).  Saving model ...
Epoch: 18 cost time: 1.0284862518310547
Epoch: 18, Steps: 10 | Train Loss: 0.043 Vali Loss: 4.083 Vali Acc: 0.264 Test Loss: 4.083 Test Acc: 0.264
Validation loss decreased (-0.262313 --> -0.263489).  Saving model ...
Epoch: 19 cost time: 1.1113512516021729
Epoch: 19, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.142 Vali Acc: 0.273 Test Loss: 4.142 Test Acc: 0.273
Validation loss decreased (-0.263489 --> -0.272900).  Saving model ...
Epoch: 20 cost time: 1.0204637050628662
Epoch: 20, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.190 Vali Acc: 0.272 Test Loss: 4.190 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.175501823425293
Epoch: 21, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.237 Vali Acc: 0.271 Test Loss: 4.237 Test Acc: 0.271
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.1039433479309082
Epoch: 22, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.305 Vali Acc: 0.266 Test Loss: 4.305 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.05775785446167
Epoch: 23, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.356 Vali Acc: 0.268 Test Loss: 4.356 Test Acc: 0.268
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.1464951038360596
Epoch: 24, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.407 Vali Acc: 0.267 Test Loss: 4.407 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.1826355457305908
Epoch: 25, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.427 Vali Acc: 0.266 Test Loss: 4.427 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.069735050201416
Epoch: 26, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.493 Vali Acc: 0.267 Test Loss: 4.493 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.1395783424377441
Epoch: 27, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.513 Vali Acc: 0.266 Test Loss: 4.513 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.0739376544952393
Epoch: 28, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.557 Vali Acc: 0.267 Test Loss: 4.557 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.117630958557129
Epoch: 29, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.621 Vali Acc: 0.267 Test Loss: 4.621 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps12_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27294117647058824
model parameter : 671578
model size : 2.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.4357573986053467
Epoch: 1, Steps: 10 | Train Loss: 3.282 Vali Loss: 3.270 Vali Acc: 0.035 Test Loss: 3.270 Test Acc: 0.035
Validation loss decreased (inf --> -0.035261).  Saving model ...
Epoch: 2 cost time: 0.9551985263824463
Epoch: 2, Steps: 10 | Train Loss: 3.211 Vali Loss: 3.260 Vali Acc: 0.051 Test Loss: 3.260 Test Acc: 0.051
Validation loss decreased (-0.035261 --> -0.050556).  Saving model ...
Epoch: 3 cost time: 1.0171897411346436
Epoch: 3, Steps: 10 | Train Loss: 3.064 Vali Loss: 3.246 Vali Acc: 0.066 Test Loss: 3.246 Test Acc: 0.066
Validation loss decreased (-0.050556 --> -0.065850).  Saving model ...
Epoch: 4 cost time: 0.9546210765838623
Epoch: 4, Steps: 10 | Train Loss: 2.903 Vali Loss: 3.236 Vali Acc: 0.089 Test Loss: 3.236 Test Acc: 0.089
Validation loss decreased (-0.065850 --> -0.089379).  Saving model ...
Epoch: 5 cost time: 0.9902679920196533
Epoch: 5, Steps: 10 | Train Loss: 2.713 Vali Loss: 3.224 Vali Acc: 0.108 Test Loss: 3.224 Test Acc: 0.108
Validation loss decreased (-0.089379 --> -0.108203).  Saving model ...
Epoch: 6 cost time: 0.8626217842102051
Epoch: 6, Steps: 10 | Train Loss: 2.490 Vali Loss: 3.214 Vali Acc: 0.120 Test Loss: 3.214 Test Acc: 0.120
Validation loss decreased (-0.108203 --> -0.119968).  Saving model ...
Epoch: 7 cost time: 1.014742374420166
Epoch: 7, Steps: 10 | Train Loss: 2.265 Vali Loss: 3.207 Vali Acc: 0.135 Test Loss: 3.207 Test Acc: 0.135
Validation loss decreased (-0.119968 --> -0.135262).  Saving model ...
Epoch: 8 cost time: 0.9626553058624268
Epoch: 8, Steps: 10 | Train Loss: 2.000 Vali Loss: 3.198 Vali Acc: 0.160 Test Loss: 3.198 Test Acc: 0.160
Validation loss decreased (-0.135262 --> -0.159968).  Saving model ...
Epoch: 9 cost time: 0.9703013896942139
Epoch: 9, Steps: 10 | Train Loss: 1.701 Vali Loss: 3.193 Vali Acc: 0.176 Test Loss: 3.193 Test Acc: 0.176
Validation loss decreased (-0.159968 --> -0.176439).  Saving model ...
Epoch: 10 cost time: 1.0664634704589844
Epoch: 10, Steps: 10 | Train Loss: 1.390 Vali Loss: 3.196 Vali Acc: 0.194 Test Loss: 3.196 Test Acc: 0.194
Validation loss decreased (-0.176439 --> -0.194086).  Saving model ...
Epoch: 11 cost time: 0.8863325119018555
Epoch: 11, Steps: 10 | Train Loss: 1.104 Vali Loss: 3.232 Vali Acc: 0.201 Test Loss: 3.232 Test Acc: 0.201
Validation loss decreased (-0.194086 --> -0.201144).  Saving model ...
Epoch: 12 cost time: 0.900592565536499
Epoch: 12, Steps: 10 | Train Loss: 0.845 Vali Loss: 3.291 Vali Acc: 0.212 Test Loss: 3.291 Test Acc: 0.212
Validation loss decreased (-0.201144 --> -0.211732).  Saving model ...
Epoch: 13 cost time: 0.9629380702972412
Epoch: 13, Steps: 10 | Train Loss: 0.635 Vali Loss: 3.356 Vali Acc: 0.244 Test Loss: 3.356 Test Acc: 0.244
Validation loss decreased (-0.211732 --> -0.243496).  Saving model ...
Epoch: 14 cost time: 0.8715240955352783
Epoch: 14, Steps: 10 | Train Loss: 0.459 Vali Loss: 3.443 Vali Acc: 0.249 Test Loss: 3.443 Test Acc: 0.249
Validation loss decreased (-0.243496 --> -0.249377).  Saving model ...
Epoch: 15 cost time: 0.927598237991333
Epoch: 15, Steps: 10 | Train Loss: 0.330 Vali Loss: 3.545 Vali Acc: 0.254 Test Loss: 3.545 Test Acc: 0.254
Validation loss decreased (-0.249377 --> -0.254082).  Saving model ...
Epoch: 16 cost time: 0.9629011154174805
Epoch: 16, Steps: 10 | Train Loss: 0.214 Vali Loss: 3.659 Vali Acc: 0.267 Test Loss: 3.659 Test Acc: 0.267
Validation loss decreased (-0.254082 --> -0.267022).  Saving model ...
Epoch: 17 cost time: 0.9648013114929199
Epoch: 17, Steps: 10 | Train Loss: 0.151 Vali Loss: 3.785 Vali Acc: 0.265 Test Loss: 3.785 Test Acc: 0.265
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9133598804473877
Epoch: 18, Steps: 10 | Train Loss: 0.106 Vali Loss: 3.873 Vali Acc: 0.266 Test Loss: 3.873 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.924877405166626
Epoch: 19, Steps: 10 | Train Loss: 0.082 Vali Loss: 3.956 Vali Acc: 0.271 Test Loss: 3.956 Test Acc: 0.271
Validation loss decreased (-0.267022 --> -0.270549).  Saving model ...
Epoch: 20 cost time: 0.862307071685791
Epoch: 20, Steps: 10 | Train Loss: 0.059 Vali Loss: 3.995 Vali Acc: 0.271 Test Loss: 3.995 Test Acc: 0.271
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8935630321502686
Epoch: 21, Steps: 10 | Train Loss: 0.045 Vali Loss: 4.051 Vali Acc: 0.275 Test Loss: 4.051 Test Acc: 0.275
Validation loss decreased (-0.270549 --> -0.275254).  Saving model ...
Epoch: 22 cost time: 0.9154708385467529
Epoch: 22, Steps: 10 | Train Loss: 0.037 Vali Loss: 4.121 Vali Acc: 0.278 Test Loss: 4.121 Test Acc: 0.278
Validation loss decreased (-0.275254 --> -0.277606).  Saving model ...
Epoch: 23 cost time: 0.9762544631958008
Epoch: 23, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.187 Vali Acc: 0.275 Test Loss: 4.187 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9844174385070801
Epoch: 24, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.236 Vali Acc: 0.276 Test Loss: 4.236 Test Acc: 0.276
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.0542609691619873
Epoch: 25, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.269 Vali Acc: 0.275 Test Loss: 4.269 Test Acc: 0.275
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.9073700904846191
Epoch: 26, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.308 Vali Acc: 0.274 Test Loss: 4.308 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.9752192497253418
Epoch: 27, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.351 Vali Acc: 0.273 Test Loss: 4.351 Test Acc: 0.273
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.0501596927642822
Epoch: 28, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.379 Vali Acc: 0.273 Test Loss: 4.379 Test Acc: 0.273
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.8327090740203857
Epoch: 29, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.414 Vali Acc: 0.271 Test Loss: 4.414 Test Acc: 0.271
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.70522141456604
Epoch: 30, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.444 Vali Acc: 0.274 Test Loss: 4.444 Test Acc: 0.274
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.9509775638580322
Epoch: 31, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.473 Vali Acc: 0.272 Test Loss: 4.473 Test Acc: 0.272
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.9484641551971436
Epoch: 32, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.501 Vali Acc: 0.275 Test Loss: 4.501 Test Acc: 0.275
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2776470588235294
model parameter : 641882
model size : 2.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps23_str12_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.045653820037842
Epoch: 1, Steps: 10 | Train Loss: 3.288 Vali Loss: 3.260 Vali Acc: 0.046 Test Loss: 3.260 Test Acc: 0.046
Validation loss decreased (inf --> -0.045850).  Saving model ...
Epoch: 2 cost time: 0.8048546314239502
Epoch: 2, Steps: 10 | Train Loss: 3.229 Vali Loss: 3.250 Vali Acc: 0.041 Test Loss: 3.250 Test Acc: 0.041
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6624336242675781
Epoch: 3, Steps: 10 | Train Loss: 3.142 Vali Loss: 3.237 Vali Acc: 0.062 Test Loss: 3.237 Test Acc: 0.062
Validation loss decreased (-0.045850 --> -0.062321).  Saving model ...
Epoch: 4 cost time: 0.9866106510162354
Epoch: 4, Steps: 10 | Train Loss: 3.025 Vali Loss: 3.224 Vali Acc: 0.079 Test Loss: 3.224 Test Acc: 0.079
Validation loss decreased (-0.062321 --> -0.078791).  Saving model ...
Epoch: 5 cost time: 0.9844686985015869
Epoch: 5, Steps: 10 | Train Loss: 2.872 Vali Loss: 3.213 Vali Acc: 0.088 Test Loss: 3.213 Test Acc: 0.088
Validation loss decreased (-0.078791 --> -0.088203).  Saving model ...
Epoch: 6 cost time: 0.9277646541595459
Epoch: 6, Steps: 10 | Train Loss: 2.715 Vali Loss: 3.200 Vali Acc: 0.100 Test Loss: 3.200 Test Acc: 0.100
Validation loss decreased (-0.088203 --> -0.099968).  Saving model ...
Epoch: 7 cost time: 0.9410510063171387
Epoch: 7, Steps: 10 | Train Loss: 2.559 Vali Loss: 3.194 Vali Acc: 0.108 Test Loss: 3.194 Test Acc: 0.108
Validation loss decreased (-0.099968 --> -0.108203).  Saving model ...
Epoch: 8 cost time: 0.8473188877105713
Epoch: 8, Steps: 10 | Train Loss: 2.351 Vali Loss: 3.185 Vali Acc: 0.126 Test Loss: 3.185 Test Acc: 0.126
Validation loss decreased (-0.108203 --> -0.125851).  Saving model ...
Epoch: 9 cost time: 0.822857141494751
Epoch: 9, Steps: 10 | Train Loss: 2.149 Vali Loss: 3.177 Vali Acc: 0.140 Test Loss: 3.177 Test Acc: 0.140
Validation loss decreased (-0.125851 --> -0.139968).  Saving model ...
Epoch: 10 cost time: 0.8689451217651367
Epoch: 10, Steps: 10 | Train Loss: 1.902 Vali Loss: 3.169 Vali Acc: 0.151 Test Loss: 3.169 Test Acc: 0.151
Validation loss decreased (-0.139968 --> -0.150557).  Saving model ...
Epoch: 11 cost time: 0.775658130645752
Epoch: 11, Steps: 10 | Train Loss: 1.687 Vali Loss: 3.167 Vali Acc: 0.161 Test Loss: 3.167 Test Acc: 0.161
Validation loss decreased (-0.150557 --> -0.161145).  Saving model ...
Epoch: 12 cost time: 0.8415474891662598
Epoch: 12, Steps: 10 | Train Loss: 1.474 Vali Loss: 3.169 Vali Acc: 0.181 Test Loss: 3.169 Test Acc: 0.181
Validation loss decreased (-0.161145 --> -0.181145).  Saving model ...
Epoch: 13 cost time: 0.9228420257568359
Epoch: 13, Steps: 10 | Train Loss: 1.207 Vali Loss: 3.191 Vali Acc: 0.193 Test Loss: 3.191 Test Acc: 0.193
Validation loss decreased (-0.181145 --> -0.192909).  Saving model ...
Epoch: 14 cost time: 0.9296896457672119
Epoch: 14, Steps: 10 | Train Loss: 0.984 Vali Loss: 3.218 Vali Acc: 0.211 Test Loss: 3.218 Test Acc: 0.211
Validation loss decreased (-0.192909 --> -0.210556).  Saving model ...
Epoch: 15 cost time: 0.8882870674133301
Epoch: 15, Steps: 10 | Train Loss: 0.760 Vali Loss: 3.262 Vali Acc: 0.222 Test Loss: 3.262 Test Acc: 0.222
Validation loss decreased (-0.210556 --> -0.222320).  Saving model ...
Epoch: 16 cost time: 0.9213566780090332
Epoch: 16, Steps: 10 | Train Loss: 0.589 Vali Loss: 3.320 Vali Acc: 0.233 Test Loss: 3.320 Test Acc: 0.233
Validation loss decreased (-0.222320 --> -0.232908).  Saving model ...
Epoch: 17 cost time: 0.9433262348175049
Epoch: 17, Steps: 10 | Train Loss: 0.474 Vali Loss: 3.404 Vali Acc: 0.228 Test Loss: 3.404 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9446172714233398
Epoch: 18, Steps: 10 | Train Loss: 0.352 Vali Loss: 3.496 Vali Acc: 0.238 Test Loss: 3.496 Test Acc: 0.238
Validation loss decreased (-0.232908 --> -0.237612).  Saving model ...
Epoch: 19 cost time: 0.9099457263946533
Epoch: 19, Steps: 10 | Train Loss: 0.247 Vali Loss: 3.591 Vali Acc: 0.242 Test Loss: 3.591 Test Acc: 0.242
Validation loss decreased (-0.237612 --> -0.242317).  Saving model ...
Epoch: 20 cost time: 0.867567777633667
Epoch: 20, Steps: 10 | Train Loss: 0.183 Vali Loss: 3.634 Vali Acc: 0.249 Test Loss: 3.634 Test Acc: 0.249
Validation loss decreased (-0.242317 --> -0.249375).  Saving model ...
Epoch: 21 cost time: 0.7745051383972168
Epoch: 21, Steps: 10 | Train Loss: 0.138 Vali Loss: 3.725 Vali Acc: 0.258 Test Loss: 3.725 Test Acc: 0.258
Validation loss decreased (-0.249375 --> -0.257610).  Saving model ...
Epoch: 22 cost time: 0.8674085140228271
Epoch: 22, Steps: 10 | Train Loss: 0.116 Vali Loss: 3.789 Vali Acc: 0.264 Test Loss: 3.789 Test Acc: 0.264
Validation loss decreased (-0.257610 --> -0.263492).  Saving model ...
Epoch: 23 cost time: 0.8961727619171143
Epoch: 23, Steps: 10 | Train Loss: 0.084 Vali Loss: 3.835 Vali Acc: 0.261 Test Loss: 3.835 Test Acc: 0.261
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8067522048950195
Epoch: 24, Steps: 10 | Train Loss: 0.065 Vali Loss: 3.879 Vali Acc: 0.262 Test Loss: 3.879 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.9245293140411377
Epoch: 25, Steps: 10 | Train Loss: 0.056 Vali Loss: 3.932 Vali Acc: 0.264 Test Loss: 3.932 Test Acc: 0.264
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.9865641593933105
Epoch: 26, Steps: 10 | Train Loss: 0.046 Vali Loss: 3.982 Vali Acc: 0.262 Test Loss: 3.982 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.9646353721618652
Epoch: 27, Steps: 10 | Train Loss: 0.038 Vali Loss: 4.020 Vali Acc: 0.262 Test Loss: 4.020 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.9117755889892578
Epoch: 28, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.077 Vali Acc: 0.262 Test Loss: 4.077 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.9153034687042236
Epoch: 29, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.088 Vali Acc: 0.265 Test Loss: 4.088 Test Acc: 0.265
Validation loss decreased (-0.263492 --> -0.264665).  Saving model ...
Epoch: 30 cost time: 0.9803521633148193
Epoch: 30, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.120 Vali Acc: 0.264 Test Loss: 4.120 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.9440412521362305
Epoch: 31, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.161 Vali Acc: 0.264 Test Loss: 4.161 Test Acc: 0.264
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.0128133296966553
Epoch: 32, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.189 Vali Acc: 0.264 Test Loss: 4.189 Test Acc: 0.264
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.9352896213531494
Epoch: 33, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.227 Vali Acc: 0.266 Test Loss: 4.227 Test Acc: 0.266
Validation loss decreased (-0.264665 --> -0.265840).  Saving model ...
Epoch: 34 cost time: 0.8448357582092285
Epoch: 34, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.271 Vali Acc: 0.268 Test Loss: 4.271 Test Acc: 0.268
Validation loss decreased (-0.265840 --> -0.268193).  Saving model ...
Epoch: 35 cost time: 0.7265722751617432
Epoch: 35, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.306 Vali Acc: 0.268 Test Loss: 4.306 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.6973938941955566
Epoch: 36, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.343 Vali Acc: 0.269 Test Loss: 4.343 Test Acc: 0.269
Validation loss decreased (-0.268193 --> -0.269368).  Saving model ...
Epoch: 37 cost time: 0.7715983390808105
Epoch: 37, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.353 Vali Acc: 0.269 Test Loss: 4.353 Test Acc: 0.269
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.9450685977935791
Epoch: 38, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.384 Vali Acc: 0.268 Test Loss: 4.384 Test Acc: 0.268
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.8196253776550293
Epoch: 39, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.401 Vali Acc: 0.267 Test Loss: 4.401 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.823005199432373
Epoch: 40, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.425 Vali Acc: 0.268 Test Loss: 4.425 Test Acc: 0.268
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.9943077564239502
Epoch: 41, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.447 Vali Acc: 0.274 Test Loss: 4.447 Test Acc: 0.274
Validation loss decreased (-0.269368 --> -0.274073).  Saving model ...
Epoch: 42 cost time: 0.9154880046844482
Epoch: 42, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.459 Vali Acc: 0.271 Test Loss: 4.459 Test Acc: 0.271
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.8931002616882324
Epoch: 43, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.488 Vali Acc: 0.274 Test Loss: 4.488 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.8025350570678711
Epoch: 44, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.514 Vali Acc: 0.274 Test Loss: 4.514 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.7922713756561279
Epoch: 45, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.553 Vali Acc: 0.272 Test Loss: 4.553 Test Acc: 0.272
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.8422200679779053
Epoch: 46, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.568 Vali Acc: 0.274 Test Loss: 4.568 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.948089599609375
Epoch: 47, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.593 Vali Acc: 0.275 Test Loss: 4.593 Test Acc: 0.275
Validation loss decreased (-0.274073 --> -0.275248).  Saving model ...
Epoch: 48 cost time: 0.8452718257904053
Epoch: 48, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.635 Vali Acc: 0.273 Test Loss: 4.635 Test Acc: 0.273
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.8480274677276611
Epoch: 49, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.635 Vali Acc: 0.272 Test Loss: 4.635 Test Acc: 0.272
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.8842818737030029
Epoch: 50, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.660 Vali Acc: 0.274 Test Loss: 4.660 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps23_str12_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2752941176470588
model parameter : 602394
model size : 2.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.9648935794830322
Epoch: 1, Steps: 10 | Train Loss: 3.273 Vali Loss: 3.262 Vali Acc: 0.044 Test Loss: 3.262 Test Acc: 0.044
Validation loss decreased (inf --> -0.043497).  Saving model ...
Epoch: 2 cost time: 0.9809224605560303
Epoch: 2, Steps: 10 | Train Loss: 3.221 Vali Loss: 3.256 Vali Acc: 0.054 Test Loss: 3.256 Test Acc: 0.054
Validation loss decreased (-0.043497 --> -0.054085).  Saving model ...
Epoch: 3 cost time: 0.9425432682037354
Epoch: 3, Steps: 10 | Train Loss: 3.131 Vali Loss: 3.246 Vali Acc: 0.062 Test Loss: 3.246 Test Acc: 0.062
Validation loss decreased (-0.054085 --> -0.062320).  Saving model ...
Epoch: 4 cost time: 0.8989689350128174
Epoch: 4, Steps: 10 | Train Loss: 3.039 Vali Loss: 3.236 Vali Acc: 0.078 Test Loss: 3.236 Test Acc: 0.078
Validation loss decreased (-0.062320 --> -0.077615).  Saving model ...
Epoch: 5 cost time: 0.8295762538909912
Epoch: 5, Steps: 10 | Train Loss: 2.906 Vali Loss: 3.227 Vali Acc: 0.099 Test Loss: 3.227 Test Acc: 0.099
Validation loss decreased (-0.077615 --> -0.098791).  Saving model ...
Epoch: 6 cost time: 0.8432440757751465
Epoch: 6, Steps: 10 | Train Loss: 2.763 Vali Loss: 3.221 Vali Acc: 0.109 Test Loss: 3.221 Test Acc: 0.109
Validation loss decreased (-0.098791 --> -0.109380).  Saving model ...
Epoch: 7 cost time: 0.8066697120666504
Epoch: 7, Steps: 10 | Train Loss: 2.628 Vali Loss: 3.215 Vali Acc: 0.121 Test Loss: 3.215 Test Acc: 0.121
Validation loss decreased (-0.109380 --> -0.121144).  Saving model ...
Epoch: 8 cost time: 0.8589870929718018
Epoch: 8, Steps: 10 | Train Loss: 2.495 Vali Loss: 3.212 Vali Acc: 0.140 Test Loss: 3.212 Test Acc: 0.140
Validation loss decreased (-0.121144 --> -0.139968).  Saving model ...
Epoch: 9 cost time: 0.8348746299743652
Epoch: 9, Steps: 10 | Train Loss: 2.279 Vali Loss: 3.200 Vali Acc: 0.152 Test Loss: 3.200 Test Acc: 0.152
Validation loss decreased (-0.139968 --> -0.151733).  Saving model ...
Epoch: 10 cost time: 0.8149216175079346
Epoch: 10, Steps: 10 | Train Loss: 2.124 Vali Loss: 3.194 Vali Acc: 0.159 Test Loss: 3.194 Test Acc: 0.159
Validation loss decreased (-0.151733 --> -0.158792).  Saving model ...
Epoch: 11 cost time: 0.8361246585845947
Epoch: 11, Steps: 10 | Train Loss: 1.930 Vali Loss: 3.190 Vali Acc: 0.165 Test Loss: 3.190 Test Acc: 0.165
Validation loss decreased (-0.158792 --> -0.164674).  Saving model ...
Epoch: 12 cost time: 0.8418247699737549
Epoch: 12, Steps: 10 | Train Loss: 1.722 Vali Loss: 3.188 Vali Acc: 0.176 Test Loss: 3.188 Test Acc: 0.176
Validation loss decreased (-0.164674 --> -0.176439).  Saving model ...
Epoch: 13 cost time: 0.8528752326965332
Epoch: 13, Steps: 10 | Train Loss: 1.486 Vali Loss: 3.193 Vali Acc: 0.188 Test Loss: 3.193 Test Acc: 0.188
Validation loss decreased (-0.176439 --> -0.188203).  Saving model ...
Epoch: 14 cost time: 0.8521978855133057
Epoch: 14, Steps: 10 | Train Loss: 1.295 Vali Loss: 3.197 Vali Acc: 0.193 Test Loss: 3.197 Test Acc: 0.193
Validation loss decreased (-0.188203 --> -0.192909).  Saving model ...
Epoch: 15 cost time: 0.821143627166748
Epoch: 15, Steps: 10 | Train Loss: 1.095 Vali Loss: 3.215 Vali Acc: 0.209 Test Loss: 3.215 Test Acc: 0.209
Validation loss decreased (-0.192909 --> -0.209380).  Saving model ...
Epoch: 16 cost time: 0.8475935459136963
Epoch: 16, Steps: 10 | Train Loss: 0.924 Vali Loss: 3.240 Vali Acc: 0.212 Test Loss: 3.240 Test Acc: 0.212
Validation loss decreased (-0.209380 --> -0.211732).  Saving model ...
Epoch: 17 cost time: 0.9006659984588623
Epoch: 17, Steps: 10 | Train Loss: 0.744 Vali Loss: 3.297 Vali Acc: 0.221 Test Loss: 3.297 Test Acc: 0.221
Validation loss decreased (-0.211732 --> -0.221144).  Saving model ...
Epoch: 18 cost time: 0.8607628345489502
Epoch: 18, Steps: 10 | Train Loss: 0.562 Vali Loss: 3.339 Vali Acc: 0.239 Test Loss: 3.339 Test Acc: 0.239
Validation loss decreased (-0.221144 --> -0.238790).  Saving model ...
Epoch: 19 cost time: 0.8365342617034912
Epoch: 19, Steps: 10 | Train Loss: 0.443 Vali Loss: 3.389 Vali Acc: 0.234 Test Loss: 3.389 Test Acc: 0.234
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7747817039489746
Epoch: 20, Steps: 10 | Train Loss: 0.341 Vali Loss: 3.469 Vali Acc: 0.248 Test Loss: 3.469 Test Acc: 0.248
Validation loss decreased (-0.238790 --> -0.248201).  Saving model ...
Epoch: 21 cost time: 0.7137069702148438
Epoch: 21, Steps: 10 | Train Loss: 0.250 Vali Loss: 3.547 Vali Acc: 0.244 Test Loss: 3.547 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6979105472564697
Epoch: 22, Steps: 10 | Train Loss: 0.192 Vali Loss: 3.603 Vali Acc: 0.251 Test Loss: 3.603 Test Acc: 0.251
Validation loss decreased (-0.248201 --> -0.250552).  Saving model ...
Epoch: 23 cost time: 0.8944764137268066
Epoch: 23, Steps: 10 | Train Loss: 0.153 Vali Loss: 3.645 Vali Acc: 0.264 Test Loss: 3.645 Test Acc: 0.264
Validation loss decreased (-0.250552 --> -0.263493).  Saving model ...
Epoch: 24 cost time: 0.956895112991333
Epoch: 24, Steps: 10 | Train Loss: 0.125 Vali Loss: 3.712 Vali Acc: 0.265 Test Loss: 3.712 Test Acc: 0.265
Validation loss decreased (-0.263493 --> -0.264669).  Saving model ...
Epoch: 25 cost time: 0.873626708984375
Epoch: 25, Steps: 10 | Train Loss: 0.098 Vali Loss: 3.778 Vali Acc: 0.255 Test Loss: 3.778 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9774637222290039
Epoch: 26, Steps: 10 | Train Loss: 0.074 Vali Loss: 3.827 Vali Acc: 0.259 Test Loss: 3.827 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.8316380977630615
Epoch: 27, Steps: 10 | Train Loss: 0.069 Vali Loss: 3.866 Vali Acc: 0.258 Test Loss: 3.866 Test Acc: 0.258
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.9617047309875488
Epoch: 28, Steps: 10 | Train Loss: 0.056 Vali Loss: 3.904 Vali Acc: 0.268 Test Loss: 3.904 Test Acc: 0.268
Validation loss decreased (-0.264669 --> -0.268196).  Saving model ...
Epoch: 29 cost time: 0.947063684463501
Epoch: 29, Steps: 10 | Train Loss: 0.046 Vali Loss: 3.958 Vali Acc: 0.265 Test Loss: 3.958 Test Acc: 0.265
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.7721607685089111
Epoch: 30, Steps: 10 | Train Loss: 0.045 Vali Loss: 3.982 Vali Acc: 0.260 Test Loss: 3.982 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.8808324337005615
Epoch: 31, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.020 Vali Acc: 0.259 Test Loss: 4.020 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.9605622291564941
Epoch: 32, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.072 Vali Acc: 0.259 Test Loss: 4.072 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.8262369632720947
Epoch: 33, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.121 Vali Acc: 0.266 Test Loss: 4.121 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.6744847297668457
Epoch: 34, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.155 Vali Acc: 0.266 Test Loss: 4.155 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.8861982822418213
Epoch: 35, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.184 Vali Acc: 0.266 Test Loss: 4.184 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.8164775371551514
Epoch: 36, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.193 Vali Acc: 0.264 Test Loss: 4.193 Test Acc: 0.264
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.9432382583618164
Epoch: 37, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.221 Vali Acc: 0.264 Test Loss: 4.221 Test Acc: 0.264
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.8748090267181396
Epoch: 38, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.243 Vali Acc: 0.268 Test Loss: 4.243 Test Acc: 0.268
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26823529411764707
model parameter : 592922
model size : 2.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps38_str19_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.107673168182373
Epoch: 1, Steps: 10 | Train Loss: 3.251 Vali Loss: 3.267 Vali Acc: 0.051 Test Loss: 3.267 Test Acc: 0.051
Validation loss decreased (inf --> -0.050556).  Saving model ...
Epoch: 2 cost time: 0.9071555137634277
Epoch: 2, Steps: 10 | Train Loss: 3.215 Vali Loss: 3.264 Vali Acc: 0.061 Test Loss: 3.264 Test Acc: 0.061
Validation loss decreased (-0.050556 --> -0.061144).  Saving model ...
Epoch: 3 cost time: 1.0621442794799805
Epoch: 3, Steps: 10 | Train Loss: 3.123 Vali Loss: 3.255 Vali Acc: 0.068 Test Loss: 3.255 Test Acc: 0.068
Validation loss decreased (-0.061144 --> -0.068203).  Saving model ...
Epoch: 4 cost time: 0.9295213222503662
Epoch: 4, Steps: 10 | Train Loss: 3.040 Vali Loss: 3.244 Vali Acc: 0.079 Test Loss: 3.244 Test Acc: 0.079
Validation loss decreased (-0.068203 --> -0.078791).  Saving model ...
Epoch: 5 cost time: 0.9567914009094238
Epoch: 5, Steps: 10 | Train Loss: 2.922 Vali Loss: 3.233 Vali Acc: 0.092 Test Loss: 3.233 Test Acc: 0.092
Validation loss decreased (-0.078791 --> -0.091732).  Saving model ...
Epoch: 6 cost time: 0.9099628925323486
Epoch: 6, Steps: 10 | Train Loss: 2.807 Vali Loss: 3.225 Vali Acc: 0.104 Test Loss: 3.225 Test Acc: 0.104
Validation loss decreased (-0.091732 --> -0.103497).  Saving model ...
Epoch: 7 cost time: 0.9876739978790283
Epoch: 7, Steps: 10 | Train Loss: 2.714 Vali Loss: 3.220 Vali Acc: 0.108 Test Loss: 3.220 Test Acc: 0.108
Validation loss decreased (-0.103497 --> -0.108203).  Saving model ...
Epoch: 8 cost time: 0.9841148853302002
Epoch: 8, Steps: 10 | Train Loss: 2.562 Vali Loss: 3.212 Vali Acc: 0.128 Test Loss: 3.212 Test Acc: 0.128
Validation loss decreased (-0.108203 --> -0.128203).  Saving model ...
Epoch: 9 cost time: 0.9322474002838135
Epoch: 9, Steps: 10 | Train Loss: 2.394 Vali Loss: 3.204 Vali Acc: 0.135 Test Loss: 3.204 Test Acc: 0.135
Validation loss decreased (-0.128203 --> -0.135262).  Saving model ...
Epoch: 10 cost time: 1.062082290649414
Epoch: 10, Steps: 10 | Train Loss: 2.241 Vali Loss: 3.201 Vali Acc: 0.146 Test Loss: 3.201 Test Acc: 0.146
Validation loss decreased (-0.135262 --> -0.145850).  Saving model ...
Epoch: 11 cost time: 0.8525993824005127
Epoch: 11, Steps: 10 | Train Loss: 2.075 Vali Loss: 3.196 Vali Acc: 0.160 Test Loss: 3.196 Test Acc: 0.160
Validation loss decreased (-0.145850 --> -0.159968).  Saving model ...
Epoch: 12 cost time: 0.7288017272949219
Epoch: 12, Steps: 10 | Train Loss: 1.902 Vali Loss: 3.195 Vali Acc: 0.175 Test Loss: 3.195 Test Acc: 0.175
Validation loss decreased (-0.159968 --> -0.175262).  Saving model ...
Epoch: 13 cost time: 0.68143630027771
Epoch: 13, Steps: 10 | Train Loss: 1.718 Vali Loss: 3.194 Vali Acc: 0.184 Test Loss: 3.194 Test Acc: 0.184
Validation loss decreased (-0.175262 --> -0.183497).  Saving model ...
Epoch: 14 cost time: 0.7017276287078857
Epoch: 14, Steps: 10 | Train Loss: 1.490 Vali Loss: 3.196 Vali Acc: 0.187 Test Loss: 3.196 Test Acc: 0.187
Validation loss decreased (-0.183497 --> -0.187027).  Saving model ...
Epoch: 15 cost time: 0.9040913581848145
Epoch: 15, Steps: 10 | Train Loss: 1.334 Vali Loss: 3.208 Vali Acc: 0.192 Test Loss: 3.208 Test Acc: 0.192
Validation loss decreased (-0.187027 --> -0.191733).  Saving model ...
Epoch: 16 cost time: 0.8834292888641357
Epoch: 16, Steps: 10 | Train Loss: 1.102 Vali Loss: 3.231 Vali Acc: 0.205 Test Loss: 3.231 Test Acc: 0.205
Validation loss decreased (-0.191733 --> -0.204674).  Saving model ...
Epoch: 17 cost time: 0.9581553936004639
Epoch: 17, Steps: 10 | Train Loss: 0.934 Vali Loss: 3.265 Vali Acc: 0.211 Test Loss: 3.265 Test Acc: 0.211
Validation loss decreased (-0.204674 --> -0.210556).  Saving model ...
Epoch: 18 cost time: 1.0060765743255615
Epoch: 18, Steps: 10 | Train Loss: 0.756 Vali Loss: 3.297 Vali Acc: 0.225 Test Loss: 3.297 Test Acc: 0.225
Validation loss decreased (-0.210556 --> -0.224673).  Saving model ...
Epoch: 19 cost time: 1.0832974910736084
Epoch: 19, Steps: 10 | Train Loss: 0.620 Vali Loss: 3.352 Vali Acc: 0.235 Test Loss: 3.352 Test Acc: 0.235
Validation loss decreased (-0.224673 --> -0.235261).  Saving model ...
Epoch: 20 cost time: 0.9789612293243408
Epoch: 20, Steps: 10 | Train Loss: 0.490 Vali Loss: 3.413 Vali Acc: 0.236 Test Loss: 3.413 Test Acc: 0.236
Validation loss decreased (-0.235261 --> -0.236436).  Saving model ...
Epoch: 21 cost time: 0.8959329128265381
Epoch: 21, Steps: 10 | Train Loss: 0.387 Vali Loss: 3.469 Vali Acc: 0.242 Test Loss: 3.469 Test Acc: 0.242
Validation loss decreased (-0.236436 --> -0.242318).  Saving model ...
Epoch: 22 cost time: 1.0076637268066406
Epoch: 22, Steps: 10 | Train Loss: 0.309 Vali Loss: 3.553 Vali Acc: 0.234 Test Loss: 3.553 Test Acc: 0.234
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9695870876312256
Epoch: 23, Steps: 10 | Train Loss: 0.224 Vali Loss: 3.620 Vali Acc: 0.244 Test Loss: 3.620 Test Acc: 0.244
Validation loss decreased (-0.242318 --> -0.243493).  Saving model ...
Epoch: 24 cost time: 0.9668080806732178
Epoch: 24, Steps: 10 | Train Loss: 0.177 Vali Loss: 3.685 Vali Acc: 0.242 Test Loss: 3.685 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9796454906463623
Epoch: 25, Steps: 10 | Train Loss: 0.146 Vali Loss: 3.723 Vali Acc: 0.244 Test Loss: 3.723 Test Acc: 0.244
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.9807202816009521
Epoch: 26, Steps: 10 | Train Loss: 0.124 Vali Loss: 3.755 Vali Acc: 0.251 Test Loss: 3.755 Test Acc: 0.251
Validation loss decreased (-0.243493 --> -0.250551).  Saving model ...
Epoch: 27 cost time: 0.946967363357544
Epoch: 27, Steps: 10 | Train Loss: 0.110 Vali Loss: 3.834 Vali Acc: 0.247 Test Loss: 3.834 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0405848026275635
Epoch: 28, Steps: 10 | Train Loss: 0.087 Vali Loss: 3.879 Vali Acc: 0.255 Test Loss: 3.879 Test Acc: 0.255
Validation loss decreased (-0.250551 --> -0.255255).  Saving model ...
Epoch: 29 cost time: 0.9522314071655273
Epoch: 29, Steps: 10 | Train Loss: 0.071 Vali Loss: 3.905 Vali Acc: 0.255 Test Loss: 3.905 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9133157730102539
Epoch: 30, Steps: 10 | Train Loss: 0.058 Vali Loss: 3.966 Vali Acc: 0.256 Test Loss: 3.966 Test Acc: 0.256
Validation loss decreased (-0.255255 --> -0.256431).  Saving model ...
Epoch: 31 cost time: 0.8601107597351074
Epoch: 31, Steps: 10 | Train Loss: 0.055 Vali Loss: 4.011 Vali Acc: 0.255 Test Loss: 4.011 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.0624470710754395
Epoch: 32, Steps: 10 | Train Loss: 0.045 Vali Loss: 4.067 Vali Acc: 0.254 Test Loss: 4.067 Test Acc: 0.254
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.9577646255493164
Epoch: 33, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.103 Vali Acc: 0.256 Test Loss: 4.103 Test Acc: 0.256
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.0428574085235596
Epoch: 34, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.141 Vali Acc: 0.266 Test Loss: 4.141 Test Acc: 0.266
Validation loss decreased (-0.256431 --> -0.265841).  Saving model ...
Epoch: 35 cost time: 0.961674690246582
Epoch: 35, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.172 Vali Acc: 0.271 Test Loss: 4.172 Test Acc: 0.271
Validation loss decreased (-0.265841 --> -0.270547).  Saving model ...
Epoch: 36 cost time: 0.9313266277313232
Epoch: 36, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.206 Vali Acc: 0.265 Test Loss: 4.206 Test Acc: 0.265
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.939295768737793
Epoch: 37, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.241 Vali Acc: 0.264 Test Loss: 4.241 Test Acc: 0.264
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.8606255054473877
Epoch: 38, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.282 Vali Acc: 0.262 Test Loss: 4.282 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.9190130233764648
Epoch: 39, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.324 Vali Acc: 0.264 Test Loss: 4.324 Test Acc: 0.264
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.8982295989990234
Epoch: 40, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.330 Vali Acc: 0.264 Test Loss: 4.330 Test Acc: 0.264
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.8619945049285889
Epoch: 41, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.345 Vali Acc: 0.266 Test Loss: 4.345 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.9286515712738037
Epoch: 42, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.391 Vali Acc: 0.264 Test Loss: 4.391 Test Acc: 0.264
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.9125692844390869
Epoch: 43, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.426 Vali Acc: 0.259 Test Loss: 4.426 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.8634030818939209
Epoch: 44, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.443 Vali Acc: 0.258 Test Loss: 4.443 Test Acc: 0.258
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.9127852916717529
Epoch: 45, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.468 Vali Acc: 0.264 Test Loss: 4.468 Test Acc: 0.264
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps38_str19_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27058823529411763
model parameter : 583386
model size : 2.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.0124094486236572
Epoch: 1, Steps: 10 | Train Loss: 3.300 Vali Loss: 3.265 Vali Acc: 0.040 Test Loss: 3.265 Test Acc: 0.040
Validation loss decreased (inf --> -0.039967).  Saving model ...
Epoch: 2 cost time: 0.7858772277832031
Epoch: 2, Steps: 10 | Train Loss: 3.157 Vali Loss: 3.250 Vali Acc: 0.055 Test Loss: 3.250 Test Acc: 0.055
Validation loss decreased (-0.039967 --> -0.055262).  Saving model ...
Epoch: 3 cost time: 0.9582736492156982
Epoch: 3, Steps: 10 | Train Loss: 2.937 Vali Loss: 3.246 Vali Acc: 0.084 Test Loss: 3.246 Test Acc: 0.084
Validation loss decreased (-0.055262 --> -0.083497).  Saving model ...
Epoch: 4 cost time: 0.7942142486572266
Epoch: 4, Steps: 10 | Train Loss: 2.681 Vali Loss: 3.243 Vali Acc: 0.099 Test Loss: 3.243 Test Acc: 0.099
Validation loss decreased (-0.083497 --> -0.098791).  Saving model ...
Epoch: 5 cost time: 0.9580023288726807
Epoch: 5, Steps: 10 | Train Loss: 2.364 Vali Loss: 3.222 Vali Acc: 0.127 Test Loss: 3.222 Test Acc: 0.127
Validation loss decreased (-0.098791 --> -0.127027).  Saving model ...
Epoch: 6 cost time: 0.8316495418548584
Epoch: 6, Steps: 10 | Train Loss: 2.020 Vali Loss: 3.203 Vali Acc: 0.156 Test Loss: 3.203 Test Acc: 0.156
Validation loss decreased (-0.127027 --> -0.156439).  Saving model ...
Epoch: 7 cost time: 0.8940856456756592
Epoch: 7, Steps: 10 | Train Loss: 1.633 Vali Loss: 3.196 Vali Acc: 0.176 Test Loss: 3.196 Test Acc: 0.176
Validation loss decreased (-0.156439 --> -0.176439).  Saving model ...
Epoch: 8 cost time: 0.997230052947998
Epoch: 8, Steps: 10 | Train Loss: 1.224 Vali Loss: 3.216 Vali Acc: 0.201 Test Loss: 3.216 Test Acc: 0.201
Validation loss decreased (-0.176439 --> -0.201144).  Saving model ...
Epoch: 9 cost time: 0.892009973526001
Epoch: 9, Steps: 10 | Train Loss: 0.844 Vali Loss: 3.281 Vali Acc: 0.220 Test Loss: 3.281 Test Acc: 0.220
Validation loss decreased (-0.201144 --> -0.219967).  Saving model ...
Epoch: 10 cost time: 0.8467168807983398
Epoch: 10, Steps: 10 | Train Loss: 0.626 Vali Loss: 3.410 Vali Acc: 0.225 Test Loss: 3.410 Test Acc: 0.225
Validation loss decreased (-0.219967 --> -0.224672).  Saving model ...
Epoch: 11 cost time: 0.9155383110046387
Epoch: 11, Steps: 10 | Train Loss: 0.351 Vali Loss: 3.589 Vali Acc: 0.236 Test Loss: 3.589 Test Acc: 0.236
Validation loss decreased (-0.224672 --> -0.236435).  Saving model ...
Epoch: 12 cost time: 0.6767239570617676
Epoch: 12, Steps: 10 | Train Loss: 0.204 Vali Loss: 3.743 Vali Acc: 0.255 Test Loss: 3.743 Test Acc: 0.255
Validation loss decreased (-0.236435 --> -0.255257).  Saving model ...
Epoch: 13 cost time: 0.8089966773986816
Epoch: 13, Steps: 10 | Train Loss: 0.123 Vali Loss: 3.906 Vali Acc: 0.264 Test Loss: 3.906 Test Acc: 0.264
Validation loss decreased (-0.255257 --> -0.263490).  Saving model ...
Epoch: 14 cost time: 1.0952484607696533
Epoch: 14, Steps: 10 | Train Loss: 0.066 Vali Loss: 4.041 Vali Acc: 0.271 Test Loss: 4.041 Test Acc: 0.271
Validation loss decreased (-0.263490 --> -0.270548).  Saving model ...
Epoch: 15 cost time: 0.874842643737793
Epoch: 15, Steps: 10 | Train Loss: 0.042 Vali Loss: 4.136 Vali Acc: 0.266 Test Loss: 4.136 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.797518253326416
Epoch: 16, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.259 Vali Acc: 0.271 Test Loss: 4.259 Test Acc: 0.271
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9683799743652344
Epoch: 17, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.305 Vali Acc: 0.274 Test Loss: 4.305 Test Acc: 0.274
Validation loss decreased (-0.270548 --> -0.274075).  Saving model ...
Epoch: 18 cost time: 0.7600381374359131
Epoch: 18, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.372 Vali Acc: 0.267 Test Loss: 4.372 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9157328605651855
Epoch: 19, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.402 Vali Acc: 0.274 Test Loss: 4.402 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8151788711547852
Epoch: 20, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.437 Vali Acc: 0.280 Test Loss: 4.437 Test Acc: 0.280
Validation loss decreased (-0.274075 --> -0.279956).  Saving model ...
Epoch: 21 cost time: 0.9038290977478027
Epoch: 21, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.476 Vali Acc: 0.281 Test Loss: 4.476 Test Acc: 0.281
Validation loss decreased (-0.279956 --> -0.281132).  Saving model ...
Epoch: 22 cost time: 0.836254358291626
Epoch: 22, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.521 Vali Acc: 0.279 Test Loss: 4.521 Test Acc: 0.279
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8252513408660889
Epoch: 23, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.563 Vali Acc: 0.280 Test Loss: 4.563 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.8363218307495117
Epoch: 24, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.606 Vali Acc: 0.279 Test Loss: 4.606 Test Acc: 0.279
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.8365437984466553
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.637 Vali Acc: 0.278 Test Loss: 4.637 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.7543179988861084
Epoch: 26, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.678 Vali Acc: 0.278 Test Loss: 4.678 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.8732876777648926
Epoch: 27, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.706 Vali Acc: 0.280 Test Loss: 4.706 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.846081018447876
Epoch: 28, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.748 Vali Acc: 0.279 Test Loss: 4.748 Test Acc: 0.279
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.8720135688781738
Epoch: 29, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.766 Vali Acc: 0.281 Test Loss: 4.766 Test Acc: 0.281
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.0083866119384766
Epoch: 30, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.787 Vali Acc: 0.285 Test Loss: 4.787 Test Acc: 0.285
Validation loss decreased (-0.281132 --> -0.284658).  Saving model ...
Epoch: 31 cost time: 0.8478004932403564
Epoch: 31, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.823 Vali Acc: 0.282 Test Loss: 4.823 Test Acc: 0.282
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.8935518264770508
Epoch: 32, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.846 Vali Acc: 0.281 Test Loss: 4.846 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.0177531242370605
Epoch: 33, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.868 Vali Acc: 0.281 Test Loss: 4.868 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.0097770690917969
Epoch: 34, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.898 Vali Acc: 0.284 Test Loss: 4.898 Test Acc: 0.284
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.890192985534668
Epoch: 35, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.922 Vali Acc: 0.284 Test Loss: 4.922 Test Acc: 0.284
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.9523818492889404
Epoch: 36, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.950 Vali Acc: 0.285 Test Loss: 4.950 Test Acc: 0.285
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.0634853839874268
Epoch: 37, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.979 Vali Acc: 0.284 Test Loss: 4.979 Test Acc: 0.284
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.8747386932373047
Epoch: 38, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.006 Vali Acc: 0.284 Test Loss: 5.006 Test Acc: 0.284
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.9357364177703857
Epoch: 39, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.029 Vali Acc: 0.284 Test Loss: 5.029 Test Acc: 0.284
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.8938999176025391
Epoch: 40, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.055 Vali Acc: 0.281 Test Loss: 5.055 Test Acc: 0.281
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2847058823529412
model parameter : 333370
model size : 1.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.121931552886963
Epoch: 1, Steps: 10 | Train Loss: 3.307 Vali Loss: 3.263 Vali Acc: 0.049 Test Loss: 3.263 Test Acc: 0.049
Validation loss decreased (inf --> -0.049379).  Saving model ...
Epoch: 2 cost time: 0.7775626182556152
Epoch: 2, Steps: 10 | Train Loss: 3.213 Vali Loss: 3.250 Vali Acc: 0.061 Test Loss: 3.250 Test Acc: 0.061
Validation loss decreased (-0.049379 --> -0.061144).  Saving model ...
Epoch: 3 cost time: 0.8280942440032959
Epoch: 3, Steps: 10 | Train Loss: 3.102 Vali Loss: 3.236 Vali Acc: 0.071 Test Loss: 3.236 Test Acc: 0.071
Validation loss decreased (-0.061144 --> -0.070556).  Saving model ...
Epoch: 4 cost time: 0.752108097076416
Epoch: 4, Steps: 10 | Train Loss: 2.945 Vali Loss: 3.228 Vali Acc: 0.086 Test Loss: 3.228 Test Acc: 0.086
Validation loss decreased (-0.070556 --> -0.085850).  Saving model ...
Epoch: 5 cost time: 0.849297285079956
Epoch: 5, Steps: 10 | Train Loss: 2.775 Vali Loss: 3.221 Vali Acc: 0.091 Test Loss: 3.221 Test Acc: 0.091
Validation loss decreased (-0.085850 --> -0.090556).  Saving model ...
Epoch: 6 cost time: 0.8016760349273682
Epoch: 6, Steps: 10 | Train Loss: 2.576 Vali Loss: 3.207 Vali Acc: 0.106 Test Loss: 3.207 Test Acc: 0.106
Validation loss decreased (-0.090556 --> -0.105850).  Saving model ...
Epoch: 7 cost time: 0.7992947101593018
Epoch: 7, Steps: 10 | Train Loss: 2.362 Vali Loss: 3.195 Vali Acc: 0.124 Test Loss: 3.195 Test Acc: 0.124
Validation loss decreased (-0.105850 --> -0.123497).  Saving model ...
Epoch: 8 cost time: 0.6592607498168945
Epoch: 8, Steps: 10 | Train Loss: 2.120 Vali Loss: 3.175 Vali Acc: 0.139 Test Loss: 3.175 Test Acc: 0.139
Validation loss decreased (-0.123497 --> -0.138792).  Saving model ...
Epoch: 9 cost time: 0.648120641708374
Epoch: 9, Steps: 10 | Train Loss: 1.820 Vali Loss: 3.167 Vali Acc: 0.161 Test Loss: 3.167 Test Acc: 0.161
Validation loss decreased (-0.138792 --> -0.161145).  Saving model ...
Epoch: 10 cost time: 0.6990153789520264
Epoch: 10, Steps: 10 | Train Loss: 1.552 Vali Loss: 3.175 Vali Acc: 0.184 Test Loss: 3.175 Test Acc: 0.184
Validation loss decreased (-0.161145 --> -0.183498).  Saving model ...
Epoch: 11 cost time: 0.760270357131958
Epoch: 11, Steps: 10 | Train Loss: 1.256 Vali Loss: 3.210 Vali Acc: 0.191 Test Loss: 3.210 Test Acc: 0.191
Validation loss decreased (-0.183498 --> -0.190556).  Saving model ...
Epoch: 12 cost time: 0.8261959552764893
Epoch: 12, Steps: 10 | Train Loss: 1.009 Vali Loss: 3.235 Vali Acc: 0.204 Test Loss: 3.235 Test Acc: 0.204
Validation loss decreased (-0.190556 --> -0.203497).  Saving model ...
Epoch: 13 cost time: 0.8687539100646973
Epoch: 13, Steps: 10 | Train Loss: 0.784 Vali Loss: 3.283 Vali Acc: 0.225 Test Loss: 3.283 Test Acc: 0.225
Validation loss decreased (-0.203497 --> -0.224673).  Saving model ...
Epoch: 14 cost time: 0.765953779220581
Epoch: 14, Steps: 10 | Train Loss: 0.560 Vali Loss: 3.382 Vali Acc: 0.233 Test Loss: 3.382 Test Acc: 0.233
Validation loss decreased (-0.224673 --> -0.232907).  Saving model ...
Epoch: 15 cost time: 0.8242542743682861
Epoch: 15, Steps: 10 | Train Loss: 0.389 Vali Loss: 3.482 Vali Acc: 0.248 Test Loss: 3.482 Test Acc: 0.248
Validation loss decreased (-0.232907 --> -0.248200).  Saving model ...
Epoch: 16 cost time: 0.7784180641174316
Epoch: 16, Steps: 10 | Train Loss: 0.279 Vali Loss: 3.611 Vali Acc: 0.253 Test Loss: 3.611 Test Acc: 0.253
Validation loss decreased (-0.248200 --> -0.252905).  Saving model ...
Epoch: 17 cost time: 0.7996070384979248
Epoch: 17, Steps: 10 | Train Loss: 0.196 Vali Loss: 3.727 Vali Acc: 0.258 Test Loss: 3.727 Test Acc: 0.258
Validation loss decreased (-0.252905 --> -0.257610).  Saving model ...
Epoch: 18 cost time: 0.7391293048858643
Epoch: 18, Steps: 10 | Train Loss: 0.133 Vali Loss: 3.811 Vali Acc: 0.262 Test Loss: 3.811 Test Acc: 0.262
Validation loss decreased (-0.257610 --> -0.262315).  Saving model ...
Epoch: 19 cost time: 0.7450251579284668
Epoch: 19, Steps: 10 | Train Loss: 0.096 Vali Loss: 3.910 Vali Acc: 0.265 Test Loss: 3.910 Test Acc: 0.265
Validation loss decreased (-0.262315 --> -0.264667).  Saving model ...
Epoch: 20 cost time: 0.7753942012786865
Epoch: 20, Steps: 10 | Train Loss: 0.070 Vali Loss: 3.994 Vali Acc: 0.267 Test Loss: 3.994 Test Acc: 0.267
Validation loss decreased (-0.264667 --> -0.267019).  Saving model ...
Epoch: 21 cost time: 0.7528109550476074
Epoch: 21, Steps: 10 | Train Loss: 0.056 Vali Loss: 4.060 Vali Acc: 0.265 Test Loss: 4.060 Test Acc: 0.265
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7754411697387695
Epoch: 22, Steps: 10 | Train Loss: 0.048 Vali Loss: 4.137 Vali Acc: 0.266 Test Loss: 4.137 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.8499071598052979
Epoch: 23, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.194 Vali Acc: 0.266 Test Loss: 4.194 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.6992084980010986
Epoch: 24, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.246 Vali Acc: 0.274 Test Loss: 4.246 Test Acc: 0.274
Validation loss decreased (-0.267019 --> -0.274075).  Saving model ...
Epoch: 25 cost time: 0.8191208839416504
Epoch: 25, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.301 Vali Acc: 0.272 Test Loss: 4.301 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8968408107757568
Epoch: 26, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.333 Vali Acc: 0.273 Test Loss: 4.333 Test Acc: 0.273
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.9392445087432861
Epoch: 27, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.375 Vali Acc: 0.273 Test Loss: 4.375 Test Acc: 0.273
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.9976351261138916
Epoch: 28, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.408 Vali Acc: 0.268 Test Loss: 4.408 Test Acc: 0.268
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.8050854206085205
Epoch: 29, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.446 Vali Acc: 0.272 Test Loss: 4.446 Test Acc: 0.272
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.7606561183929443
Epoch: 30, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.498 Vali Acc: 0.275 Test Loss: 4.498 Test Acc: 0.275
Validation loss decreased (-0.274075 --> -0.275249).  Saving model ...
Epoch: 31 cost time: 0.8597338199615479
Epoch: 31, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.531 Vali Acc: 0.274 Test Loss: 4.531 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.8460001945495605
Epoch: 32, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.563 Vali Acc: 0.273 Test Loss: 4.563 Test Acc: 0.273
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.9872660636901855
Epoch: 33, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.596 Vali Acc: 0.267 Test Loss: 4.596 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.8445017337799072
Epoch: 34, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.631 Vali Acc: 0.272 Test Loss: 4.631 Test Acc: 0.272
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.9646124839782715
Epoch: 35, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.671 Vali Acc: 0.269 Test Loss: 4.671 Test Acc: 0.269
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.8694865703582764
Epoch: 36, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.706 Vali Acc: 0.265 Test Loss: 4.706 Test Acc: 0.265
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.8971335887908936
Epoch: 37, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.740 Vali Acc: 0.261 Test Loss: 4.740 Test Acc: 0.261
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.9617178440093994
Epoch: 38, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.759 Vali Acc: 0.267 Test Loss: 4.759 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.8468821048736572
Epoch: 39, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.780 Vali Acc: 0.267 Test Loss: 4.780 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.8183903694152832
Epoch: 40, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.804 Vali Acc: 0.274 Test Loss: 4.804 Test Acc: 0.274
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2752941176470588
model parameter : 238650
model size : 0.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps12_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.0631895065307617
Epoch: 1, Steps: 10 | Train Loss: 3.333 Vali Loss: 3.282 Vali Acc: 0.049 Test Loss: 3.282 Test Acc: 0.049
Validation loss decreased (inf --> -0.049379).  Saving model ...
Epoch: 2 cost time: 0.8124697208404541
Epoch: 2, Steps: 10 | Train Loss: 3.260 Vali Loss: 3.277 Vali Acc: 0.055 Test Loss: 3.277 Test Acc: 0.055
Validation loss decreased (-0.049379 --> -0.055261).  Saving model ...
Epoch: 3 cost time: 0.8720295429229736
Epoch: 3, Steps: 10 | Train Loss: 3.170 Vali Loss: 3.268 Vali Acc: 0.075 Test Loss: 3.268 Test Acc: 0.075
Validation loss decreased (-0.055261 --> -0.075261).  Saving model ...
Epoch: 4 cost time: 0.7859463691711426
Epoch: 4, Steps: 10 | Train Loss: 3.043 Vali Loss: 3.262 Vali Acc: 0.088 Test Loss: 3.262 Test Acc: 0.088
Validation loss decreased (-0.075261 --> -0.088203).  Saving model ...
Epoch: 5 cost time: 0.7805917263031006
Epoch: 5, Steps: 10 | Train Loss: 2.909 Vali Loss: 3.256 Vali Acc: 0.100 Test Loss: 3.256 Test Acc: 0.100
Validation loss decreased (-0.088203 --> -0.099967).  Saving model ...
Epoch: 6 cost time: 0.8014323711395264
Epoch: 6, Steps: 10 | Train Loss: 2.791 Vali Loss: 3.251 Vali Acc: 0.091 Test Loss: 3.251 Test Acc: 0.091
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8011407852172852
Epoch: 7, Steps: 10 | Train Loss: 2.632 Vali Loss: 3.244 Vali Acc: 0.099 Test Loss: 3.244 Test Acc: 0.099
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7617378234863281
Epoch: 8, Steps: 10 | Train Loss: 2.451 Vali Loss: 3.234 Vali Acc: 0.113 Test Loss: 3.234 Test Acc: 0.113
Validation loss decreased (-0.099967 --> -0.112909).  Saving model ...
Epoch: 9 cost time: 0.6767153739929199
Epoch: 9, Steps: 10 | Train Loss: 2.271 Vali Loss: 3.224 Vali Acc: 0.122 Test Loss: 3.224 Test Acc: 0.122
Validation loss decreased (-0.112909 --> -0.122321).  Saving model ...
Epoch: 10 cost time: 0.7539734840393066
Epoch: 10, Steps: 10 | Train Loss: 2.043 Vali Loss: 3.211 Vali Acc: 0.134 Test Loss: 3.211 Test Acc: 0.134
Validation loss decreased (-0.122321 --> -0.134086).  Saving model ...
Epoch: 11 cost time: 0.9256823062896729
Epoch: 11, Steps: 10 | Train Loss: 1.804 Vali Loss: 3.208 Vali Acc: 0.145 Test Loss: 3.208 Test Acc: 0.145
Validation loss decreased (-0.134086 --> -0.144674).  Saving model ...
Epoch: 12 cost time: 0.8848938941955566
Epoch: 12, Steps: 10 | Train Loss: 1.595 Vali Loss: 3.213 Vali Acc: 0.168 Test Loss: 3.213 Test Acc: 0.168
Validation loss decreased (-0.144674 --> -0.168203).  Saving model ...
Epoch: 13 cost time: 0.8939735889434814
Epoch: 13, Steps: 10 | Train Loss: 1.358 Vali Loss: 3.216 Vali Acc: 0.180 Test Loss: 3.216 Test Acc: 0.180
Validation loss decreased (-0.168203 --> -0.179968).  Saving model ...
Epoch: 14 cost time: 0.7460677623748779
Epoch: 14, Steps: 10 | Train Loss: 1.117 Vali Loss: 3.234 Vali Acc: 0.201 Test Loss: 3.234 Test Acc: 0.201
Validation loss decreased (-0.179968 --> -0.201144).  Saving model ...
Epoch: 15 cost time: 0.7702815532684326
Epoch: 15, Steps: 10 | Train Loss: 0.921 Vali Loss: 3.272 Vali Acc: 0.200 Test Loss: 3.272 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6858382225036621
Epoch: 16, Steps: 10 | Train Loss: 0.723 Vali Loss: 3.330 Vali Acc: 0.211 Test Loss: 3.330 Test Acc: 0.211
Validation loss decreased (-0.201144 --> -0.210555).  Saving model ...
Epoch: 17 cost time: 0.6833481788635254
Epoch: 17, Steps: 10 | Train Loss: 0.535 Vali Loss: 3.387 Vali Acc: 0.219 Test Loss: 3.387 Test Acc: 0.219
Validation loss decreased (-0.210555 --> -0.218790).  Saving model ...
Epoch: 18 cost time: 0.6770377159118652
Epoch: 18, Steps: 10 | Train Loss: 0.417 Vali Loss: 3.474 Vali Acc: 0.235 Test Loss: 3.474 Test Acc: 0.235
Validation loss decreased (-0.218790 --> -0.235259).  Saving model ...
Epoch: 19 cost time: 0.8452045917510986
Epoch: 19, Steps: 10 | Train Loss: 0.310 Vali Loss: 3.538 Vali Acc: 0.251 Test Loss: 3.538 Test Acc: 0.251
Validation loss decreased (-0.235259 --> -0.250553).  Saving model ...
Epoch: 20 cost time: 0.7502107620239258
Epoch: 20, Steps: 10 | Train Loss: 0.227 Vali Loss: 3.620 Vali Acc: 0.244 Test Loss: 3.620 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8188531398773193
Epoch: 21, Steps: 10 | Train Loss: 0.173 Vali Loss: 3.681 Vali Acc: 0.248 Test Loss: 3.681 Test Acc: 0.248
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7542414665222168
Epoch: 22, Steps: 10 | Train Loss: 0.136 Vali Loss: 3.805 Vali Acc: 0.236 Test Loss: 3.805 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.7404253482818604
Epoch: 23, Steps: 10 | Train Loss: 0.106 Vali Loss: 3.843 Vali Acc: 0.239 Test Loss: 3.843 Test Acc: 0.239
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.7249035835266113
Epoch: 24, Steps: 10 | Train Loss: 0.084 Vali Loss: 3.895 Vali Acc: 0.238 Test Loss: 3.895 Test Acc: 0.238
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.8613483905792236
Epoch: 25, Steps: 10 | Train Loss: 0.070 Vali Loss: 3.963 Vali Acc: 0.242 Test Loss: 3.963 Test Acc: 0.242
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.5796291828155518
Epoch: 26, Steps: 10 | Train Loss: 0.056 Vali Loss: 4.018 Vali Acc: 0.242 Test Loss: 4.018 Test Acc: 0.242
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.6528370380401611
Epoch: 27, Steps: 10 | Train Loss: 0.049 Vali Loss: 4.047 Vali Acc: 0.249 Test Loss: 4.047 Test Acc: 0.249
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.7260260581970215
Epoch: 28, Steps: 10 | Train Loss: 0.044 Vali Loss: 4.094 Vali Acc: 0.248 Test Loss: 4.094 Test Acc: 0.248
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.6202375888824463
Epoch: 29, Steps: 10 | Train Loss: 0.037 Vali Loss: 4.150 Vali Acc: 0.252 Test Loss: 4.150 Test Acc: 0.252
Validation loss decreased (-0.250553 --> -0.251723).  Saving model ...
Epoch: 30 cost time: 0.5930280685424805
Epoch: 30, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.204 Vali Acc: 0.249 Test Loss: 4.204 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.7687346935272217
Epoch: 31, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.255 Vali Acc: 0.251 Test Loss: 4.255 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.8422205448150635
Epoch: 32, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.279 Vali Acc: 0.249 Test Loss: 4.279 Test Acc: 0.249
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.8500685691833496
Epoch: 33, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.292 Vali Acc: 0.251 Test Loss: 4.292 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.7483875751495361
Epoch: 34, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.329 Vali Acc: 0.252 Test Loss: 4.329 Test Acc: 0.252
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.7450153827667236
Epoch: 35, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.361 Vali Acc: 0.251 Test Loss: 4.361 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.792102575302124
Epoch: 36, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.393 Vali Acc: 0.251 Test Loss: 4.393 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.7290282249450684
Epoch: 37, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.436 Vali Acc: 0.252 Test Loss: 4.436 Test Acc: 0.252
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.7838406562805176
Epoch: 38, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.483 Vali Acc: 0.253 Test Loss: 4.483 Test Acc: 0.253
Validation loss decreased (-0.251723 --> -0.252896).  Saving model ...
Epoch: 39 cost time: 0.7561352252960205
Epoch: 39, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.494 Vali Acc: 0.254 Test Loss: 4.494 Test Acc: 0.254
Validation loss decreased (-0.252896 --> -0.254073).  Saving model ...
Epoch: 40 cost time: 0.7330548763275146
Epoch: 40, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.506 Vali Acc: 0.253 Test Loss: 4.506 Test Acc: 0.253
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.7641158103942871
Epoch: 41, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.536 Vali Acc: 0.248 Test Loss: 4.536 Test Acc: 0.248
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.8016550540924072
Epoch: 42, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.559 Vali Acc: 0.247 Test Loss: 4.559 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.6908392906188965
Epoch: 43, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.590 Vali Acc: 0.247 Test Loss: 4.590 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.7525503635406494
Epoch: 44, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.622 Vali Acc: 0.253 Test Loss: 4.622 Test Acc: 0.253
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.6949186325073242
Epoch: 45, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.651 Vali Acc: 0.254 Test Loss: 4.651 Test Acc: 0.254
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.7770082950592041
Epoch: 46, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.680 Vali Acc: 0.252 Test Loss: 4.680 Test Acc: 0.252
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.6164367198944092
Epoch: 47, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.705 Vali Acc: 0.252 Test Loss: 4.705 Test Acc: 0.252
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 0.8066778182983398
Epoch: 48, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.724 Vali Acc: 0.251 Test Loss: 4.724 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 0.6224188804626465
Epoch: 49, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.752 Vali Acc: 0.253 Test Loss: 4.752 Test Acc: 0.253
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps12_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2541176470588235
model parameter : 208826
model size : 0.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.1497817039489746
Epoch: 1, Steps: 10 | Train Loss: 3.359 Vali Loss: 3.265 Vali Acc: 0.042 Test Loss: 3.265 Test Acc: 0.042
Validation loss decreased (inf --> -0.042320).  Saving model ...
Epoch: 2 cost time: 0.8662576675415039
Epoch: 2, Steps: 10 | Train Loss: 3.316 Vali Loss: 3.257 Vali Acc: 0.044 Test Loss: 3.257 Test Acc: 0.044
Validation loss decreased (-0.042320 --> -0.043497).  Saving model ...
Epoch: 3 cost time: 0.7047524452209473
Epoch: 3, Steps: 10 | Train Loss: 3.227 Vali Loss: 3.246 Vali Acc: 0.054 Test Loss: 3.246 Test Acc: 0.054
Validation loss decreased (-0.043497 --> -0.054085).  Saving model ...
Epoch: 4 cost time: 0.6688165664672852
Epoch: 4, Steps: 10 | Train Loss: 3.131 Vali Loss: 3.234 Vali Acc: 0.059 Test Loss: 3.234 Test Acc: 0.059
Validation loss decreased (-0.054085 --> -0.058791).  Saving model ...
Epoch: 5 cost time: 0.7005929946899414
Epoch: 5, Steps: 10 | Train Loss: 3.025 Vali Loss: 3.222 Vali Acc: 0.076 Test Loss: 3.222 Test Acc: 0.076
Validation loss decreased (-0.058791 --> -0.076438).  Saving model ...
Epoch: 6 cost time: 0.7215676307678223
Epoch: 6, Steps: 10 | Train Loss: 2.934 Vali Loss: 3.212 Vali Acc: 0.089 Test Loss: 3.212 Test Acc: 0.089
Validation loss decreased (-0.076438 --> -0.089380).  Saving model ...
Epoch: 7 cost time: 0.7173476219177246
Epoch: 7, Steps: 10 | Train Loss: 2.803 Vali Loss: 3.204 Vali Acc: 0.095 Test Loss: 3.204 Test Acc: 0.095
Validation loss decreased (-0.089380 --> -0.095262).  Saving model ...
Epoch: 8 cost time: 0.6993248462677002
Epoch: 8, Steps: 10 | Train Loss: 2.647 Vali Loss: 3.195 Vali Acc: 0.107 Test Loss: 3.195 Test Acc: 0.107
Validation loss decreased (-0.095262 --> -0.107027).  Saving model ...
Epoch: 9 cost time: 0.6908020973205566
Epoch: 9, Steps: 10 | Train Loss: 2.539 Vali Loss: 3.187 Vali Acc: 0.111 Test Loss: 3.187 Test Acc: 0.111
Validation loss decreased (-0.107027 --> -0.110556).  Saving model ...
Epoch: 10 cost time: 0.7475771903991699
Epoch: 10, Steps: 10 | Train Loss: 2.346 Vali Loss: 3.171 Vali Acc: 0.127 Test Loss: 3.171 Test Acc: 0.127
Validation loss decreased (-0.110556 --> -0.127027).  Saving model ...
Epoch: 11 cost time: 0.8907907009124756
Epoch: 11, Steps: 10 | Train Loss: 2.182 Vali Loss: 3.166 Vali Acc: 0.136 Test Loss: 3.166 Test Acc: 0.136
Validation loss decreased (-0.127027 --> -0.136439).  Saving model ...
Epoch: 12 cost time: 0.8531506061553955
Epoch: 12, Steps: 10 | Train Loss: 1.978 Vali Loss: 3.149 Vali Acc: 0.156 Test Loss: 3.149 Test Acc: 0.156
Validation loss decreased (-0.136439 --> -0.156439).  Saving model ...
Epoch: 13 cost time: 0.8277246952056885
Epoch: 13, Steps: 10 | Train Loss: 1.786 Vali Loss: 3.143 Vali Acc: 0.169 Test Loss: 3.143 Test Acc: 0.169
Validation loss decreased (-0.156439 --> -0.169380).  Saving model ...
Epoch: 14 cost time: 0.7803528308868408
Epoch: 14, Steps: 10 | Train Loss: 1.605 Vali Loss: 3.136 Vali Acc: 0.181 Test Loss: 3.136 Test Acc: 0.181
Validation loss decreased (-0.169380 --> -0.181145).  Saving model ...
Epoch: 15 cost time: 0.7596502304077148
Epoch: 15, Steps: 10 | Train Loss: 1.389 Vali Loss: 3.136 Vali Acc: 0.193 Test Loss: 3.136 Test Acc: 0.193
Validation loss decreased (-0.181145 --> -0.192910).  Saving model ...
Epoch: 16 cost time: 0.7593038082122803
Epoch: 16, Steps: 10 | Train Loss: 1.154 Vali Loss: 3.151 Vali Acc: 0.208 Test Loss: 3.151 Test Acc: 0.208
Validation loss decreased (-0.192910 --> -0.208204).  Saving model ...
Epoch: 17 cost time: 0.764667272567749
Epoch: 17, Steps: 10 | Train Loss: 0.978 Vali Loss: 3.173 Vali Acc: 0.218 Test Loss: 3.173 Test Acc: 0.218
Validation loss decreased (-0.208204 --> -0.217615).  Saving model ...
Epoch: 18 cost time: 0.7447910308837891
Epoch: 18, Steps: 10 | Train Loss: 0.781 Vali Loss: 3.206 Vali Acc: 0.229 Test Loss: 3.206 Test Acc: 0.229
Validation loss decreased (-0.217615 --> -0.229380).  Saving model ...
Epoch: 19 cost time: 0.7652277946472168
Epoch: 19, Steps: 10 | Train Loss: 0.618 Vali Loss: 3.248 Vali Acc: 0.241 Test Loss: 3.248 Test Acc: 0.241
Validation loss decreased (-0.229380 --> -0.241144).  Saving model ...
Epoch: 20 cost time: 0.7544565200805664
Epoch: 20, Steps: 10 | Train Loss: 0.485 Vali Loss: 3.309 Vali Acc: 0.253 Test Loss: 3.309 Test Acc: 0.253
Validation loss decreased (-0.241144 --> -0.252908).  Saving model ...
Epoch: 21 cost time: 0.7018182277679443
Epoch: 21, Steps: 10 | Train Loss: 0.379 Vali Loss: 3.397 Vali Acc: 0.259 Test Loss: 3.397 Test Acc: 0.259
Validation loss decreased (-0.252908 --> -0.258790).  Saving model ...
Epoch: 22 cost time: 0.7363200187683105
Epoch: 22, Steps: 10 | Train Loss: 0.293 Vali Loss: 3.445 Vali Acc: 0.266 Test Loss: 3.445 Test Acc: 0.266
Validation loss decreased (-0.258790 --> -0.265848).  Saving model ...
Epoch: 23 cost time: 0.8327491283416748
Epoch: 23, Steps: 10 | Train Loss: 0.237 Vali Loss: 3.507 Vali Acc: 0.272 Test Loss: 3.507 Test Acc: 0.272
Validation loss decreased (-0.265848 --> -0.271730).  Saving model ...
Epoch: 24 cost time: 0.7510285377502441
Epoch: 24, Steps: 10 | Train Loss: 0.181 Vali Loss: 3.561 Vali Acc: 0.268 Test Loss: 3.561 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8342916965484619
Epoch: 25, Steps: 10 | Train Loss: 0.147 Vali Loss: 3.624 Vali Acc: 0.276 Test Loss: 3.624 Test Acc: 0.276
Validation loss decreased (-0.271730 --> -0.276434).  Saving model ...
Epoch: 26 cost time: 0.7644109725952148
Epoch: 26, Steps: 10 | Train Loss: 0.118 Vali Loss: 3.676 Vali Acc: 0.278 Test Loss: 3.676 Test Acc: 0.278
Validation loss decreased (-0.276434 --> -0.277610).  Saving model ...
Epoch: 27 cost time: 0.6767759323120117
Epoch: 27, Steps: 10 | Train Loss: 0.099 Vali Loss: 3.739 Vali Acc: 0.276 Test Loss: 3.739 Test Acc: 0.276
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6365599632263184
Epoch: 28, Steps: 10 | Train Loss: 0.083 Vali Loss: 3.798 Vali Acc: 0.281 Test Loss: 3.798 Test Acc: 0.281
Validation loss decreased (-0.277610 --> -0.281138).  Saving model ...
Epoch: 29 cost time: 0.6836020946502686
Epoch: 29, Steps: 10 | Train Loss: 0.076 Vali Loss: 3.847 Vali Acc: 0.285 Test Loss: 3.847 Test Acc: 0.285
Validation loss decreased (-0.281138 --> -0.284667).  Saving model ...
Epoch: 30 cost time: 0.5728955268859863
Epoch: 30, Steps: 10 | Train Loss: 0.062 Vali Loss: 3.892 Vali Acc: 0.287 Test Loss: 3.892 Test Acc: 0.287
Validation loss decreased (-0.284667 --> -0.287020).  Saving model ...
Epoch: 31 cost time: 0.7673225402832031
Epoch: 31, Steps: 10 | Train Loss: 0.055 Vali Loss: 3.916 Vali Acc: 0.272 Test Loss: 3.916 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.737774133682251
Epoch: 32, Steps: 10 | Train Loss: 0.046 Vali Loss: 3.962 Vali Acc: 0.273 Test Loss: 3.962 Test Acc: 0.273
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.6724298000335693
Epoch: 33, Steps: 10 | Train Loss: 0.039 Vali Loss: 4.009 Vali Acc: 0.275 Test Loss: 4.009 Test Acc: 0.275
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.8688828945159912
Epoch: 34, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.031 Vali Acc: 0.275 Test Loss: 4.031 Test Acc: 0.275
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.7131474018096924
Epoch: 35, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.063 Vali Acc: 0.281 Test Loss: 4.063 Test Acc: 0.281
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.883669376373291
Epoch: 36, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.087 Vali Acc: 0.284 Test Loss: 4.087 Test Acc: 0.284
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.8920168876647949
Epoch: 37, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.134 Vali Acc: 0.281 Test Loss: 4.134 Test Acc: 0.281
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.8736629486083984
Epoch: 38, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.177 Vali Acc: 0.275 Test Loss: 4.177 Test Acc: 0.275
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.7743268013000488
Epoch: 39, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.208 Vali Acc: 0.275 Test Loss: 4.208 Test Acc: 0.275
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.9278156757354736
Epoch: 40, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.245 Vali Acc: 0.272 Test Loss: 4.245 Test Acc: 0.272
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.28705882352941176
model parameter : 193978
model size : 0.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps23_str12_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.9894871711730957
Epoch: 1, Steps: 10 | Train Loss: 3.282 Vali Loss: 3.272 Vali Acc: 0.048 Test Loss: 3.272 Test Acc: 0.048
Validation loss decreased (inf --> -0.048203).  Saving model ...
Epoch: 2 cost time: 0.7465074062347412
Epoch: 2, Steps: 10 | Train Loss: 3.248 Vali Loss: 3.269 Vali Acc: 0.041 Test Loss: 3.269 Test Acc: 0.041
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7759964466094971
Epoch: 3, Steps: 10 | Train Loss: 3.201 Vali Loss: 3.261 Vali Acc: 0.036 Test Loss: 3.261 Test Acc: 0.036
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9490516185760498
Epoch: 4, Steps: 10 | Train Loss: 3.134 Vali Loss: 3.253 Vali Acc: 0.039 Test Loss: 3.253 Test Acc: 0.039
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.8736753463745117
Epoch: 5, Steps: 10 | Train Loss: 3.065 Vali Loss: 3.243 Vali Acc: 0.046 Test Loss: 3.243 Test Acc: 0.046
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.8726949691772461
Epoch: 6, Steps: 10 | Train Loss: 2.972 Vali Loss: 3.234 Vali Acc: 0.058 Test Loss: 3.234 Test Acc: 0.058
Validation loss decreased (-0.048203 --> -0.057615).  Saving model ...
Epoch: 7 cost time: 0.7553603649139404
Epoch: 7, Steps: 10 | Train Loss: 2.910 Vali Loss: 3.229 Vali Acc: 0.060 Test Loss: 3.229 Test Acc: 0.060
Validation loss decreased (-0.057615 --> -0.059968).  Saving model ...
Epoch: 8 cost time: 0.6669201850891113
Epoch: 8, Steps: 10 | Train Loss: 2.797 Vali Loss: 3.223 Vali Acc: 0.068 Test Loss: 3.223 Test Acc: 0.068
Validation loss decreased (-0.059968 --> -0.068203).  Saving model ...
Epoch: 9 cost time: 0.7374594211578369
Epoch: 9, Steps: 10 | Train Loss: 2.672 Vali Loss: 3.215 Vali Acc: 0.086 Test Loss: 3.215 Test Acc: 0.086
Validation loss decreased (-0.068203 --> -0.085850).  Saving model ...
Epoch: 10 cost time: 0.8650152683258057
Epoch: 10, Steps: 10 | Train Loss: 2.558 Vali Loss: 3.206 Vali Acc: 0.098 Test Loss: 3.206 Test Acc: 0.098
Validation loss decreased (-0.085850 --> -0.097615).  Saving model ...
Epoch: 11 cost time: 0.8103387355804443
Epoch: 11, Steps: 10 | Train Loss: 2.441 Vali Loss: 3.200 Vali Acc: 0.112 Test Loss: 3.200 Test Acc: 0.112
Validation loss decreased (-0.097615 --> -0.111733).  Saving model ...
Epoch: 12 cost time: 0.8302600383758545
Epoch: 12, Steps: 10 | Train Loss: 2.291 Vali Loss: 3.197 Vali Acc: 0.115 Test Loss: 3.197 Test Acc: 0.115
Validation loss decreased (-0.111733 --> -0.115262).  Saving model ...
Epoch: 13 cost time: 0.8592898845672607
Epoch: 13, Steps: 10 | Train Loss: 2.135 Vali Loss: 3.196 Vali Acc: 0.133 Test Loss: 3.196 Test Acc: 0.133
Validation loss decreased (-0.115262 --> -0.132909).  Saving model ...
Epoch: 14 cost time: 0.8661527633666992
Epoch: 14, Steps: 10 | Train Loss: 1.971 Vali Loss: 3.194 Vali Acc: 0.138 Test Loss: 3.194 Test Acc: 0.138
Validation loss decreased (-0.132909 --> -0.137615).  Saving model ...
Epoch: 15 cost time: 0.8043761253356934
Epoch: 15, Steps: 10 | Train Loss: 1.857 Vali Loss: 3.202 Vali Acc: 0.146 Test Loss: 3.202 Test Acc: 0.146
Validation loss decreased (-0.137615 --> -0.145850).  Saving model ...
Epoch: 16 cost time: 0.9085502624511719
Epoch: 16, Steps: 10 | Train Loss: 1.666 Vali Loss: 3.209 Vali Acc: 0.160 Test Loss: 3.209 Test Acc: 0.160
Validation loss decreased (-0.145850 --> -0.159968).  Saving model ...
Epoch: 17 cost time: 0.7280950546264648
Epoch: 17, Steps: 10 | Train Loss: 1.485 Vali Loss: 3.219 Vali Acc: 0.168 Test Loss: 3.219 Test Acc: 0.168
Validation loss decreased (-0.159968 --> -0.168203).  Saving model ...
Epoch: 18 cost time: 0.8180198669433594
Epoch: 18, Steps: 10 | Train Loss: 1.356 Vali Loss: 3.239 Vali Acc: 0.178 Test Loss: 3.239 Test Acc: 0.178
Validation loss decreased (-0.168203 --> -0.177615).  Saving model ...
Epoch: 19 cost time: 0.7296535968780518
Epoch: 19, Steps: 10 | Train Loss: 1.174 Vali Loss: 3.260 Vali Acc: 0.189 Test Loss: 3.260 Test Acc: 0.189
Validation loss decreased (-0.177615 --> -0.189379).  Saving model ...
Epoch: 20 cost time: 0.8650975227355957
Epoch: 20, Steps: 10 | Train Loss: 1.010 Vali Loss: 3.299 Vali Acc: 0.201 Test Loss: 3.299 Test Acc: 0.201
Validation loss decreased (-0.189379 --> -0.201143).  Saving model ...
Epoch: 21 cost time: 0.8655228614807129
Epoch: 21, Steps: 10 | Train Loss: 0.913 Vali Loss: 3.331 Vali Acc: 0.214 Test Loss: 3.331 Test Acc: 0.214
Validation loss decreased (-0.201143 --> -0.214084).  Saving model ...
Epoch: 22 cost time: 0.7149195671081543
Epoch: 22, Steps: 10 | Train Loss: 0.769 Vali Loss: 3.368 Vali Acc: 0.215 Test Loss: 3.368 Test Acc: 0.215
Validation loss decreased (-0.214084 --> -0.215260).  Saving model ...
Epoch: 23 cost time: 0.7672805786132812
Epoch: 23, Steps: 10 | Train Loss: 0.643 Vali Loss: 3.424 Vali Acc: 0.222 Test Loss: 3.424 Test Acc: 0.222
Validation loss decreased (-0.215260 --> -0.222319).  Saving model ...
Epoch: 24 cost time: 0.8930511474609375
Epoch: 24, Steps: 10 | Train Loss: 0.568 Vali Loss: 3.480 Vali Acc: 0.216 Test Loss: 3.480 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8175337314605713
Epoch: 25, Steps: 10 | Train Loss: 0.465 Vali Loss: 3.526 Vali Acc: 0.231 Test Loss: 3.526 Test Acc: 0.231
Validation loss decreased (-0.222319 --> -0.230553).  Saving model ...
Epoch: 26 cost time: 0.7363748550415039
Epoch: 26, Steps: 10 | Train Loss: 0.370 Vali Loss: 3.585 Vali Acc: 0.231 Test Loss: 3.585 Test Acc: 0.231
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.7880232334136963
Epoch: 27, Steps: 10 | Train Loss: 0.333 Vali Loss: 3.643 Vali Acc: 0.242 Test Loss: 3.643 Test Acc: 0.242
Validation loss decreased (-0.230553 --> -0.242317).  Saving model ...
Epoch: 28 cost time: 0.8264625072479248
Epoch: 28, Steps: 10 | Train Loss: 0.258 Vali Loss: 3.719 Vali Acc: 0.241 Test Loss: 3.719 Test Acc: 0.241
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.8229539394378662
Epoch: 29, Steps: 10 | Train Loss: 0.222 Vali Loss: 3.760 Vali Acc: 0.238 Test Loss: 3.760 Test Acc: 0.238
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.7300276756286621
Epoch: 30, Steps: 10 | Train Loss: 0.194 Vali Loss: 3.817 Vali Acc: 0.238 Test Loss: 3.817 Test Acc: 0.238
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.8264634609222412
Epoch: 31, Steps: 10 | Train Loss: 0.160 Vali Loss: 3.858 Vali Acc: 0.244 Test Loss: 3.858 Test Acc: 0.244
Validation loss decreased (-0.242317 --> -0.243491).  Saving model ...
Epoch: 32 cost time: 0.6665830612182617
Epoch: 32, Steps: 10 | Train Loss: 0.133 Vali Loss: 3.909 Vali Acc: 0.241 Test Loss: 3.909 Test Acc: 0.241
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.7171530723571777
Epoch: 33, Steps: 10 | Train Loss: 0.124 Vali Loss: 3.971 Vali Acc: 0.244 Test Loss: 3.971 Test Acc: 0.244
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.779010534286499
Epoch: 34, Steps: 10 | Train Loss: 0.100 Vali Loss: 4.014 Vali Acc: 0.244 Test Loss: 4.014 Test Acc: 0.244
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.7867598533630371
Epoch: 35, Steps: 10 | Train Loss: 0.093 Vali Loss: 4.072 Vali Acc: 0.247 Test Loss: 4.072 Test Acc: 0.247
Validation loss decreased (-0.243491 --> -0.247018).  Saving model ...
Epoch: 36 cost time: 0.7659816741943359
Epoch: 36, Steps: 10 | Train Loss: 0.076 Vali Loss: 4.107 Vali Acc: 0.249 Test Loss: 4.107 Test Acc: 0.249
Validation loss decreased (-0.247018 --> -0.249371).  Saving model ...
Epoch: 37 cost time: 0.7360713481903076
Epoch: 37, Steps: 10 | Train Loss: 0.071 Vali Loss: 4.134 Vali Acc: 0.246 Test Loss: 4.134 Test Acc: 0.246
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.8837366104125977
Epoch: 38, Steps: 10 | Train Loss: 0.065 Vali Loss: 4.175 Vali Acc: 0.248 Test Loss: 4.175 Test Acc: 0.248
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.7219336032867432
Epoch: 39, Steps: 10 | Train Loss: 0.061 Vali Loss: 4.203 Vali Acc: 0.249 Test Loss: 4.203 Test Acc: 0.249
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.7224369049072266
Epoch: 40, Steps: 10 | Train Loss: 0.046 Vali Loss: 4.249 Vali Acc: 0.251 Test Loss: 4.249 Test Acc: 0.251
Validation loss decreased (-0.249371 --> -0.250546).  Saving model ...
Epoch: 41 cost time: 0.8503396511077881
Epoch: 41, Steps: 10 | Train Loss: 0.043 Vali Loss: 4.280 Vali Acc: 0.251 Test Loss: 4.280 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.8091599941253662
Epoch: 42, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.305 Vali Acc: 0.251 Test Loss: 4.305 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.8632791042327881
Epoch: 43, Steps: 10 | Train Loss: 0.037 Vali Loss: 4.358 Vali Acc: 0.253 Test Loss: 4.358 Test Acc: 0.253
Validation loss decreased (-0.250546 --> -0.252898).  Saving model ...
Epoch: 44 cost time: 0.7419149875640869
Epoch: 44, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.393 Vali Acc: 0.254 Test Loss: 4.393 Test Acc: 0.254
Validation loss decreased (-0.252898 --> -0.254074).  Saving model ...
Epoch: 45 cost time: 0.7797486782073975
Epoch: 45, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.419 Vali Acc: 0.254 Test Loss: 4.419 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.7898125648498535
Epoch: 46, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.427 Vali Acc: 0.253 Test Loss: 4.427 Test Acc: 0.253
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.7527201175689697
Epoch: 47, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.463 Vali Acc: 0.253 Test Loss: 4.463 Test Acc: 0.253
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.7156939506530762
Epoch: 48, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.498 Vali Acc: 0.254 Test Loss: 4.498 Test Acc: 0.254
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.7443897724151611
Epoch: 49, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.530 Vali Acc: 0.254 Test Loss: 4.530 Test Acc: 0.254
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.938115119934082
Epoch: 50, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.574 Vali Acc: 0.258 Test Loss: 4.574 Test Acc: 0.258
Validation loss decreased (-0.254074 --> -0.257601).  Saving model ...
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps23_str12_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2576470588235294
model parameter : 174234
model size : 0.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.908529281616211
Epoch: 1, Steps: 10 | Train Loss: 3.297 Vali Loss: 3.263 Vali Acc: 0.034 Test Loss: 3.263 Test Acc: 0.034
Validation loss decreased (inf --> -0.034085).  Saving model ...
Epoch: 2 cost time: 0.6594827175140381
Epoch: 2, Steps: 10 | Train Loss: 3.263 Vali Loss: 3.263 Vali Acc: 0.045 Test Loss: 3.263 Test Acc: 0.045
Validation loss decreased (-0.034085 --> -0.044673).  Saving model ...
Epoch: 3 cost time: 0.7014172077178955
Epoch: 3, Steps: 10 | Train Loss: 3.221 Vali Loss: 3.258 Vali Acc: 0.053 Test Loss: 3.258 Test Acc: 0.053
Validation loss decreased (-0.044673 --> -0.052909).  Saving model ...
Epoch: 4 cost time: 0.8142337799072266
Epoch: 4, Steps: 10 | Train Loss: 3.160 Vali Loss: 3.250 Vali Acc: 0.060 Test Loss: 3.250 Test Acc: 0.060
Validation loss decreased (-0.052909 --> -0.059967).  Saving model ...
Epoch: 5 cost time: 0.8345761299133301
Epoch: 5, Steps: 10 | Train Loss: 3.089 Vali Loss: 3.243 Vali Acc: 0.065 Test Loss: 3.243 Test Acc: 0.065
Validation loss decreased (-0.059967 --> -0.064673).  Saving model ...
Epoch: 6 cost time: 0.8813004493713379
Epoch: 6, Steps: 10 | Train Loss: 3.052 Vali Loss: 3.237 Vali Acc: 0.067 Test Loss: 3.237 Test Acc: 0.067
Validation loss decreased (-0.064673 --> -0.067026).  Saving model ...
Epoch: 7 cost time: 0.7572968006134033
Epoch: 7, Steps: 10 | Train Loss: 2.989 Vali Loss: 3.229 Vali Acc: 0.079 Test Loss: 3.229 Test Acc: 0.079
Validation loss decreased (-0.067026 --> -0.078791).  Saving model ...
Epoch: 8 cost time: 0.8497073650360107
Epoch: 8, Steps: 10 | Train Loss: 2.884 Vali Loss: 3.224 Vali Acc: 0.092 Test Loss: 3.224 Test Acc: 0.092
Validation loss decreased (-0.078791 --> -0.091732).  Saving model ...
Epoch: 9 cost time: 0.6922087669372559
Epoch: 9, Steps: 10 | Train Loss: 2.808 Vali Loss: 3.219 Vali Acc: 0.102 Test Loss: 3.219 Test Acc: 0.102
Validation loss decreased (-0.091732 --> -0.102321).  Saving model ...
Epoch: 10 cost time: 0.8894031047821045
Epoch: 10, Steps: 10 | Train Loss: 2.694 Vali Loss: 3.215 Vali Acc: 0.104 Test Loss: 3.215 Test Acc: 0.104
Validation loss decreased (-0.102321 --> -0.103497).  Saving model ...
Epoch: 11 cost time: 0.8085761070251465
Epoch: 11, Steps: 10 | Train Loss: 2.585 Vali Loss: 3.209 Vali Acc: 0.114 Test Loss: 3.209 Test Acc: 0.114
Validation loss decreased (-0.103497 --> -0.114086).  Saving model ...
Epoch: 12 cost time: 0.6214065551757812
Epoch: 12, Steps: 10 | Train Loss: 2.492 Vali Loss: 3.204 Vali Acc: 0.122 Test Loss: 3.204 Test Acc: 0.122
Validation loss decreased (-0.114086 --> -0.122321).  Saving model ...
Epoch: 13 cost time: 0.7208380699157715
Epoch: 13, Steps: 10 | Train Loss: 2.359 Vali Loss: 3.201 Vali Acc: 0.126 Test Loss: 3.201 Test Acc: 0.126
Validation loss decreased (-0.122321 --> -0.125850).  Saving model ...
Epoch: 14 cost time: 0.6353111267089844
Epoch: 14, Steps: 10 | Train Loss: 2.238 Vali Loss: 3.200 Vali Acc: 0.134 Test Loss: 3.200 Test Acc: 0.134
Validation loss decreased (-0.125850 --> -0.134086).  Saving model ...
Epoch: 15 cost time: 0.7789490222930908
Epoch: 15, Steps: 10 | Train Loss: 2.106 Vali Loss: 3.196 Vali Acc: 0.139 Test Loss: 3.196 Test Acc: 0.139
Validation loss decreased (-0.134086 --> -0.138792).  Saving model ...
Epoch: 16 cost time: 0.8259143829345703
Epoch: 16, Steps: 10 | Train Loss: 1.961 Vali Loss: 3.197 Vali Acc: 0.152 Test Loss: 3.197 Test Acc: 0.152
Validation loss decreased (-0.138792 --> -0.151733).  Saving model ...
Epoch: 17 cost time: 0.8202548027038574
Epoch: 17, Steps: 10 | Train Loss: 1.810 Vali Loss: 3.194 Vali Acc: 0.161 Test Loss: 3.194 Test Acc: 0.161
Validation loss decreased (-0.151733 --> -0.161145).  Saving model ...
Epoch: 18 cost time: 0.7340519428253174
Epoch: 18, Steps: 10 | Train Loss: 1.660 Vali Loss: 3.200 Vali Acc: 0.164 Test Loss: 3.200 Test Acc: 0.164
Validation loss decreased (-0.161145 --> -0.163497).  Saving model ...
Epoch: 19 cost time: 0.7656750679016113
Epoch: 19, Steps: 10 | Train Loss: 1.471 Vali Loss: 3.206 Vali Acc: 0.174 Test Loss: 3.206 Test Acc: 0.174
Validation loss decreased (-0.163497 --> -0.174086).  Saving model ...
Epoch: 20 cost time: 0.7533168792724609
Epoch: 20, Steps: 10 | Train Loss: 1.304 Vali Loss: 3.217 Vali Acc: 0.181 Test Loss: 3.217 Test Acc: 0.181
Validation loss decreased (-0.174086 --> -0.181144).  Saving model ...
Epoch: 21 cost time: 0.8281679153442383
Epoch: 21, Steps: 10 | Train Loss: 1.203 Vali Loss: 3.233 Vali Acc: 0.192 Test Loss: 3.233 Test Acc: 0.192
Validation loss decreased (-0.181144 --> -0.191732).  Saving model ...
Epoch: 22 cost time: 0.6924607753753662
Epoch: 22, Steps: 10 | Train Loss: 1.062 Vali Loss: 3.250 Vali Acc: 0.196 Test Loss: 3.250 Test Acc: 0.196
Validation loss decreased (-0.191732 --> -0.196438).  Saving model ...
Epoch: 23 cost time: 0.7928683757781982
Epoch: 23, Steps: 10 | Train Loss: 0.916 Vali Loss: 3.286 Vali Acc: 0.204 Test Loss: 3.286 Test Acc: 0.204
Validation loss decreased (-0.196438 --> -0.203497).  Saving model ...
Epoch: 24 cost time: 0.6892929077148438
Epoch: 24, Steps: 10 | Train Loss: 0.790 Vali Loss: 3.305 Vali Acc: 0.212 Test Loss: 3.305 Test Acc: 0.212
Validation loss decreased (-0.203497 --> -0.211732).  Saving model ...
Epoch: 25 cost time: 0.6059987545013428
Epoch: 25, Steps: 10 | Train Loss: 0.643 Vali Loss: 3.343 Vali Acc: 0.216 Test Loss: 3.343 Test Acc: 0.216
Validation loss decreased (-0.211732 --> -0.216437).  Saving model ...
Epoch: 26 cost time: 0.6004476547241211
Epoch: 26, Steps: 10 | Train Loss: 0.547 Vali Loss: 3.381 Vali Acc: 0.221 Test Loss: 3.381 Test Acc: 0.221
Validation loss decreased (-0.216437 --> -0.221143).  Saving model ...
Epoch: 27 cost time: 0.8159575462341309
Epoch: 27, Steps: 10 | Train Loss: 0.458 Vali Loss: 3.427 Vali Acc: 0.228 Test Loss: 3.427 Test Acc: 0.228
Validation loss decreased (-0.221143 --> -0.228201).  Saving model ...
Epoch: 28 cost time: 0.7385232448577881
Epoch: 28, Steps: 10 | Train Loss: 0.387 Vali Loss: 3.473 Vali Acc: 0.225 Test Loss: 3.473 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7018163204193115
Epoch: 29, Steps: 10 | Train Loss: 0.306 Vali Loss: 3.527 Vali Acc: 0.233 Test Loss: 3.527 Test Acc: 0.233
Validation loss decreased (-0.228201 --> -0.232906).  Saving model ...
Epoch: 30 cost time: 0.778374195098877
Epoch: 30, Steps: 10 | Train Loss: 0.276 Vali Loss: 3.584 Vali Acc: 0.232 Test Loss: 3.584 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.7319436073303223
Epoch: 31, Steps: 10 | Train Loss: 0.239 Vali Loss: 3.617 Vali Acc: 0.233 Test Loss: 3.617 Test Acc: 0.233
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.7867493629455566
Epoch: 32, Steps: 10 | Train Loss: 0.191 Vali Loss: 3.675 Vali Acc: 0.240 Test Loss: 3.675 Test Acc: 0.240
Validation loss decreased (-0.232906 --> -0.239963).  Saving model ...
Epoch: 33 cost time: 0.7135369777679443
Epoch: 33, Steps: 10 | Train Loss: 0.165 Vali Loss: 3.711 Vali Acc: 0.240 Test Loss: 3.711 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.6785855293273926
Epoch: 34, Steps: 10 | Train Loss: 0.152 Vali Loss: 3.777 Vali Acc: 0.238 Test Loss: 3.777 Test Acc: 0.238
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.7332935333251953
Epoch: 35, Steps: 10 | Train Loss: 0.129 Vali Loss: 3.813 Vali Acc: 0.245 Test Loss: 3.813 Test Acc: 0.245
Validation loss decreased (-0.239963 --> -0.244668).  Saving model ...
Epoch: 36 cost time: 0.7968182563781738
Epoch: 36, Steps: 10 | Train Loss: 0.106 Vali Loss: 3.850 Vali Acc: 0.248 Test Loss: 3.850 Test Acc: 0.248
Validation loss decreased (-0.244668 --> -0.248197).  Saving model ...
Epoch: 37 cost time: 0.8414967060089111
Epoch: 37, Steps: 10 | Train Loss: 0.095 Vali Loss: 3.885 Vali Acc: 0.247 Test Loss: 3.885 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.7500684261322021
Epoch: 38, Steps: 10 | Train Loss: 0.085 Vali Loss: 3.947 Vali Acc: 0.247 Test Loss: 3.947 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.7290091514587402
Epoch: 39, Steps: 10 | Train Loss: 0.076 Vali Loss: 3.979 Vali Acc: 0.254 Test Loss: 3.979 Test Acc: 0.254
Validation loss decreased (-0.248197 --> -0.254078).  Saving model ...
Epoch: 40 cost time: 0.7030024528503418
Epoch: 40, Steps: 10 | Train Loss: 0.065 Vali Loss: 4.007 Vali Acc: 0.251 Test Loss: 4.007 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.8001370429992676
Epoch: 41, Steps: 10 | Train Loss: 0.054 Vali Loss: 4.018 Vali Acc: 0.252 Test Loss: 4.018 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.7531924247741699
Epoch: 42, Steps: 10 | Train Loss: 0.048 Vali Loss: 4.056 Vali Acc: 0.249 Test Loss: 4.056 Test Acc: 0.249
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.7826268672943115
Epoch: 43, Steps: 10 | Train Loss: 0.046 Vali Loss: 4.112 Vali Acc: 0.247 Test Loss: 4.112 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.7551939487457275
Epoch: 44, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.138 Vali Acc: 0.251 Test Loss: 4.138 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.6132290363311768
Epoch: 45, Steps: 10 | Train Loss: 0.038 Vali Loss: 4.138 Vali Acc: 0.252 Test Loss: 4.138 Test Acc: 0.252
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.6103761196136475
Epoch: 46, Steps: 10 | Train Loss: 0.041 Vali Loss: 4.178 Vali Acc: 0.252 Test Loss: 4.178 Test Acc: 0.252
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.6999523639678955
Epoch: 47, Steps: 10 | Train Loss: 0.039 Vali Loss: 4.200 Vali Acc: 0.252 Test Loss: 4.200 Test Acc: 0.252
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 0.7713594436645508
Epoch: 48, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.227 Vali Acc: 0.249 Test Loss: 4.227 Test Acc: 0.249
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 0.7844119071960449
Epoch: 49, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.266 Vali Acc: 0.246 Test Loss: 4.266 Test Acc: 0.246
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2541176470588235
model parameter : 169498
model size : 0.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps38_str19_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.9365670680999756
Epoch: 1, Steps: 10 | Train Loss: 3.312 Vali Loss: 3.268 Vali Acc: 0.026 Test Loss: 3.268 Test Acc: 0.026
Validation loss decreased (inf --> -0.025850).  Saving model ...
Epoch: 2 cost time: 0.7126784324645996
Epoch: 2, Steps: 10 | Train Loss: 3.283 Vali Loss: 3.267 Vali Acc: 0.028 Test Loss: 3.267 Test Acc: 0.028
Validation loss decreased (-0.025850 --> -0.028203).  Saving model ...
Epoch: 3 cost time: 0.74607253074646
Epoch: 3, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.262 Vali Acc: 0.035 Test Loss: 3.262 Test Acc: 0.035
Validation loss decreased (-0.028203 --> -0.035261).  Saving model ...
Epoch: 4 cost time: 0.7709054946899414
Epoch: 4, Steps: 10 | Train Loss: 3.226 Vali Loss: 3.254 Vali Acc: 0.046 Test Loss: 3.254 Test Acc: 0.046
Validation loss decreased (-0.035261 --> -0.045850).  Saving model ...
Epoch: 5 cost time: 0.7162683010101318
Epoch: 5, Steps: 10 | Train Loss: 3.153 Vali Loss: 3.246 Vali Acc: 0.058 Test Loss: 3.246 Test Acc: 0.058
Validation loss decreased (-0.045850 --> -0.057615).  Saving model ...
Epoch: 6 cost time: 0.648113489151001
Epoch: 6, Steps: 10 | Train Loss: 3.092 Vali Loss: 3.238 Vali Acc: 0.064 Test Loss: 3.238 Test Acc: 0.064
Validation loss decreased (-0.057615 --> -0.063497).  Saving model ...
Epoch: 7 cost time: 0.7423515319824219
Epoch: 7, Steps: 10 | Train Loss: 3.050 Vali Loss: 3.230 Vali Acc: 0.078 Test Loss: 3.230 Test Acc: 0.078
Validation loss decreased (-0.063497 --> -0.077615).  Saving model ...
Epoch: 8 cost time: 0.8180882930755615
Epoch: 8, Steps: 10 | Train Loss: 2.955 Vali Loss: 3.222 Vali Acc: 0.085 Test Loss: 3.222 Test Acc: 0.085
Validation loss decreased (-0.077615 --> -0.084674).  Saving model ...
Epoch: 9 cost time: 0.699324369430542
Epoch: 9, Steps: 10 | Train Loss: 2.875 Vali Loss: 3.217 Vali Acc: 0.094 Test Loss: 3.217 Test Acc: 0.094
Validation loss decreased (-0.084674 --> -0.094085).  Saving model ...
Epoch: 10 cost time: 0.7587299346923828
Epoch: 10, Steps: 10 | Train Loss: 2.790 Vali Loss: 3.211 Vali Acc: 0.104 Test Loss: 3.211 Test Acc: 0.104
Validation loss decreased (-0.094085 --> -0.103497).  Saving model ...
Epoch: 11 cost time: 0.7377240657806396
Epoch: 11, Steps: 10 | Train Loss: 2.734 Vali Loss: 3.205 Vali Acc: 0.108 Test Loss: 3.205 Test Acc: 0.108
Validation loss decreased (-0.103497 --> -0.108203).  Saving model ...
Epoch: 12 cost time: 0.839747428894043
Epoch: 12, Steps: 10 | Train Loss: 2.599 Vali Loss: 3.200 Vali Acc: 0.119 Test Loss: 3.200 Test Acc: 0.119
Validation loss decreased (-0.108203 --> -0.118792).  Saving model ...
Epoch: 13 cost time: 0.7415015697479248
Epoch: 13, Steps: 10 | Train Loss: 2.513 Vali Loss: 3.197 Vali Acc: 0.122 Test Loss: 3.197 Test Acc: 0.122
Validation loss decreased (-0.118792 --> -0.122321).  Saving model ...
Epoch: 14 cost time: 0.6516788005828857
Epoch: 14, Steps: 10 | Train Loss: 2.424 Vali Loss: 3.194 Vali Acc: 0.131 Test Loss: 3.194 Test Acc: 0.131
Validation loss decreased (-0.122321 --> -0.130556).  Saving model ...
Epoch: 15 cost time: 0.6894810199737549
Epoch: 15, Steps: 10 | Train Loss: 2.301 Vali Loss: 3.189 Vali Acc: 0.141 Test Loss: 3.189 Test Acc: 0.141
Validation loss decreased (-0.130556 --> -0.141145).  Saving model ...
Epoch: 16 cost time: 0.7098808288574219
Epoch: 16, Steps: 10 | Train Loss: 2.144 Vali Loss: 3.184 Vali Acc: 0.151 Test Loss: 3.184 Test Acc: 0.151
Validation loss decreased (-0.141145 --> -0.150556).  Saving model ...
Epoch: 17 cost time: 0.6945681571960449
Epoch: 17, Steps: 10 | Train Loss: 2.022 Vali Loss: 3.187 Vali Acc: 0.155 Test Loss: 3.187 Test Acc: 0.155
Validation loss decreased (-0.150556 --> -0.155262).  Saving model ...
Epoch: 18 cost time: 0.6961781978607178
Epoch: 18, Steps: 10 | Train Loss: 1.904 Vali Loss: 3.193 Vali Acc: 0.159 Test Loss: 3.193 Test Acc: 0.159
Validation loss decreased (-0.155262 --> -0.158792).  Saving model ...
Epoch: 19 cost time: 0.7800242900848389
Epoch: 19, Steps: 10 | Train Loss: 1.736 Vali Loss: 3.192 Vali Acc: 0.171 Test Loss: 3.192 Test Acc: 0.171
Validation loss decreased (-0.158792 --> -0.170556).  Saving model ...
Epoch: 20 cost time: 0.7935073375701904
Epoch: 20, Steps: 10 | Train Loss: 1.576 Vali Loss: 3.198 Vali Acc: 0.169 Test Loss: 3.198 Test Acc: 0.169
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.692690372467041
Epoch: 21, Steps: 10 | Train Loss: 1.460 Vali Loss: 3.203 Vali Acc: 0.184 Test Loss: 3.203 Test Acc: 0.184
Validation loss decreased (-0.170556 --> -0.183497).  Saving model ...
Epoch: 22 cost time: 0.7437689304351807
Epoch: 22, Steps: 10 | Train Loss: 1.305 Vali Loss: 3.212 Vali Acc: 0.192 Test Loss: 3.212 Test Acc: 0.192
Validation loss decreased (-0.183497 --> -0.191733).  Saving model ...
Epoch: 23 cost time: 0.6373610496520996
Epoch: 23, Steps: 10 | Train Loss: 1.133 Vali Loss: 3.227 Vali Acc: 0.202 Test Loss: 3.227 Test Acc: 0.202
Validation loss decreased (-0.191733 --> -0.202321).  Saving model ...
Epoch: 24 cost time: 0.8260712623596191
Epoch: 24, Steps: 10 | Train Loss: 0.983 Vali Loss: 3.261 Vali Acc: 0.209 Test Loss: 3.261 Test Acc: 0.209
Validation loss decreased (-0.202321 --> -0.209379).  Saving model ...
Epoch: 25 cost time: 0.7672226428985596
Epoch: 25, Steps: 10 | Train Loss: 0.879 Vali Loss: 3.284 Vali Acc: 0.216 Test Loss: 3.284 Test Acc: 0.216
Validation loss decreased (-0.209379 --> -0.216438).  Saving model ...
Epoch: 26 cost time: 0.8162648677825928
Epoch: 26, Steps: 10 | Train Loss: 0.758 Vali Loss: 3.324 Vali Acc: 0.225 Test Loss: 3.324 Test Acc: 0.225
Validation loss decreased (-0.216438 --> -0.224673).  Saving model ...
Epoch: 27 cost time: 0.8107426166534424
Epoch: 27, Steps: 10 | Train Loss: 0.632 Vali Loss: 3.368 Vali Acc: 0.222 Test Loss: 3.368 Test Acc: 0.222
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.5339841842651367
Epoch: 28, Steps: 10 | Train Loss: 0.532 Vali Loss: 3.423 Vali Acc: 0.225 Test Loss: 3.423 Test Acc: 0.225
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.650198221206665
Epoch: 29, Steps: 10 | Train Loss: 0.501 Vali Loss: 3.468 Vali Acc: 0.226 Test Loss: 3.468 Test Acc: 0.226
Validation loss decreased (-0.224673 --> -0.225848).  Saving model ...
Epoch: 30 cost time: 0.7276768684387207
Epoch: 30, Steps: 10 | Train Loss: 0.403 Vali Loss: 3.525 Vali Acc: 0.227 Test Loss: 3.525 Test Acc: 0.227
Validation loss decreased (-0.225848 --> -0.227024).  Saving model ...
Epoch: 31 cost time: 0.8050806522369385
Epoch: 31, Steps: 10 | Train Loss: 0.340 Vali Loss: 3.567 Vali Acc: 0.235 Test Loss: 3.567 Test Acc: 0.235
Validation loss decreased (-0.227024 --> -0.235258).  Saving model ...
Epoch: 32 cost time: 0.7589735984802246
Epoch: 32, Steps: 10 | Train Loss: 0.297 Vali Loss: 3.619 Vali Acc: 0.245 Test Loss: 3.619 Test Acc: 0.245
Validation loss decreased (-0.235258 --> -0.244670).  Saving model ...
Epoch: 33 cost time: 0.7944719791412354
Epoch: 33, Steps: 10 | Train Loss: 0.270 Vali Loss: 3.689 Vali Acc: 0.239 Test Loss: 3.689 Test Acc: 0.239
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.8143355846405029
Epoch: 34, Steps: 10 | Train Loss: 0.222 Vali Loss: 3.723 Vali Acc: 0.248 Test Loss: 3.723 Test Acc: 0.248
Validation loss decreased (-0.244670 --> -0.248198).  Saving model ...
Epoch: 35 cost time: 0.730576753616333
Epoch: 35, Steps: 10 | Train Loss: 0.177 Vali Loss: 3.776 Vali Acc: 0.239 Test Loss: 3.776 Test Acc: 0.239
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.7037675380706787
Epoch: 36, Steps: 10 | Train Loss: 0.162 Vali Loss: 3.820 Vali Acc: 0.240 Test Loss: 3.820 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.8251655101776123
Epoch: 37, Steps: 10 | Train Loss: 0.146 Vali Loss: 3.869 Vali Acc: 0.246 Test Loss: 3.869 Test Acc: 0.246
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.734194278717041
Epoch: 38, Steps: 10 | Train Loss: 0.145 Vali Loss: 3.892 Vali Acc: 0.252 Test Loss: 3.892 Test Acc: 0.252
Validation loss decreased (-0.248198 --> -0.251726).  Saving model ...
Epoch: 39 cost time: 0.8259992599487305
Epoch: 39, Steps: 10 | Train Loss: 0.113 Vali Loss: 3.947 Vali Acc: 0.252 Test Loss: 3.947 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.7717392444610596
Epoch: 40, Steps: 10 | Train Loss: 0.106 Vali Loss: 3.993 Vali Acc: 0.252 Test Loss: 3.993 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.7912228107452393
Epoch: 41, Steps: 10 | Train Loss: 0.089 Vali Loss: 4.043 Vali Acc: 0.249 Test Loss: 4.043 Test Acc: 0.249
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.6880548000335693
Epoch: 42, Steps: 10 | Train Loss: 0.077 Vali Loss: 4.089 Vali Acc: 0.255 Test Loss: 4.089 Test Acc: 0.255
Validation loss decreased (-0.251726 --> -0.255253).  Saving model ...
Epoch: 43 cost time: 0.7682819366455078
Epoch: 43, Steps: 10 | Train Loss: 0.076 Vali Loss: 4.101 Vali Acc: 0.253 Test Loss: 4.101 Test Acc: 0.253
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.8202202320098877
Epoch: 44, Steps: 10 | Train Loss: 0.069 Vali Loss: 4.128 Vali Acc: 0.252 Test Loss: 4.128 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.8270938396453857
Epoch: 45, Steps: 10 | Train Loss: 0.050 Vali Loss: 4.158 Vali Acc: 0.254 Test Loss: 4.158 Test Acc: 0.254
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.8425402641296387
Epoch: 46, Steps: 10 | Train Loss: 0.048 Vali Loss: 4.206 Vali Acc: 0.254 Test Loss: 4.206 Test Acc: 0.254
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.8239638805389404
Epoch: 47, Steps: 10 | Train Loss: 0.045 Vali Loss: 4.251 Vali Acc: 0.255 Test Loss: 4.251 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.8126249313354492
Epoch: 48, Steps: 10 | Train Loss: 0.039 Vali Loss: 4.275 Vali Acc: 0.255 Test Loss: 4.275 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.7975988388061523
Epoch: 49, Steps: 10 | Train Loss: 0.038 Vali Loss: 4.314 Vali Acc: 0.253 Test Loss: 4.314 Test Acc: 0.253
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.8602862358093262
Epoch: 50, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.353 Vali Acc: 0.259 Test Loss: 4.353 Test Acc: 0.259
Validation loss decreased (-0.255253 --> -0.258780).  Saving model ...
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps38_str19_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.25882352941176473
model parameter : 164730
model size : 0.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.5574216842651367
Epoch: 1, Steps: 10 | Train Loss: 3.280 Vali Loss: 3.250 Vali Acc: 0.061 Test Loss: 3.250 Test Acc: 0.061
Validation loss decreased (inf --> -0.061144).  Saving model ...
Epoch: 2 cost time: 1.6992754936218262
Epoch: 2, Steps: 10 | Train Loss: 2.844 Vali Loss: 3.255 Vali Acc: 0.108 Test Loss: 3.255 Test Acc: 0.108
Validation loss decreased (-0.061144 --> -0.108203).  Saving model ...
Epoch: 3 cost time: 1.3397669792175293
Epoch: 3, Steps: 10 | Train Loss: 2.147 Vali Loss: 3.231 Vali Acc: 0.152 Test Loss: 3.231 Test Acc: 0.152
Validation loss decreased (-0.108203 --> -0.151732).  Saving model ...
Epoch: 4 cost time: 1.4010636806488037
Epoch: 4, Steps: 10 | Train Loss: 1.272 Vali Loss: 3.219 Vali Acc: 0.204 Test Loss: 3.219 Test Acc: 0.204
Validation loss decreased (-0.151732 --> -0.203497).  Saving model ...
Epoch: 5 cost time: 1.1773812770843506
Epoch: 5, Steps: 10 | Train Loss: 0.671 Vali Loss: 3.523 Vali Acc: 0.241 Test Loss: 3.523 Test Acc: 0.241
Validation loss decreased (-0.203497 --> -0.241141).  Saving model ...
Epoch: 6 cost time: 1.3142335414886475
Epoch: 6, Steps: 10 | Train Loss: 0.200 Vali Loss: 4.040 Vali Acc: 0.238 Test Loss: 4.040 Test Acc: 0.238
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2168283462524414
Epoch: 7, Steps: 10 | Train Loss: 0.053 Vali Loss: 4.479 Vali Acc: 0.275 Test Loss: 4.479 Test Acc: 0.275
Validation loss decreased (-0.241141 --> -0.275249).  Saving model ...
Epoch: 8 cost time: 1.4825725555419922
Epoch: 8, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.997 Vali Acc: 0.253 Test Loss: 4.997 Test Acc: 0.253
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5981395244598389
Epoch: 9, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.034 Vali Acc: 0.284 Test Loss: 5.034 Test Acc: 0.284
Validation loss decreased (-0.275249 --> -0.283479).  Saving model ...
Epoch: 10 cost time: 1.5817019939422607
Epoch: 10, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.123 Vali Acc: 0.275 Test Loss: 5.123 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.558180332183838
Epoch: 11, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.189 Vali Acc: 0.275 Test Loss: 5.189 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.3916890621185303
Epoch: 12, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.230 Vali Acc: 0.275 Test Loss: 5.230 Test Acc: 0.275
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.203554391860962
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.261 Vali Acc: 0.276 Test Loss: 5.261 Test Acc: 0.276
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.3681738376617432
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.300 Vali Acc: 0.276 Test Loss: 5.300 Test Acc: 0.276
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.498664379119873
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.327 Vali Acc: 0.281 Test Loss: 5.327 Test Acc: 0.281
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.5030112266540527
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.345 Vali Acc: 0.282 Test Loss: 5.345 Test Acc: 0.282
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.5035405158996582
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.373 Vali Acc: 0.281 Test Loss: 5.373 Test Acc: 0.281
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.3077270984649658
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.402 Vali Acc: 0.281 Test Loss: 5.402 Test Acc: 0.281
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.5425961017608643
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.429 Vali Acc: 0.284 Test Loss: 5.429 Test Acc: 0.284
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.28352941176470586
model parameter : 2852506
model size : 10.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.363203763961792
Epoch: 1, Steps: 10 | Train Loss: 3.259 Vali Loss: 3.245 Vali Acc: 0.062 Test Loss: 3.245 Test Acc: 0.062
Validation loss decreased (inf --> -0.062320).  Saving model ...
Epoch: 2 cost time: 1.1213245391845703
Epoch: 2, Steps: 10 | Train Loss: 2.991 Vali Loss: 3.229 Vali Acc: 0.088 Test Loss: 3.229 Test Acc: 0.088
Validation loss decreased (-0.062320 --> -0.088203).  Saving model ...
Epoch: 3 cost time: 1.0611193180084229
Epoch: 3, Steps: 10 | Train Loss: 2.633 Vali Loss: 3.239 Vali Acc: 0.101 Test Loss: 3.239 Test Acc: 0.101
Validation loss decreased (-0.088203 --> -0.101144).  Saving model ...
Epoch: 4 cost time: 0.9776067733764648
Epoch: 4, Steps: 10 | Train Loss: 2.090 Vali Loss: 3.206 Vali Acc: 0.147 Test Loss: 3.206 Test Acc: 0.147
Validation loss decreased (-0.101144 --> -0.147027).  Saving model ...
Epoch: 5 cost time: 1.1371665000915527
Epoch: 5, Steps: 10 | Train Loss: 1.506 Vali Loss: 3.214 Vali Acc: 0.185 Test Loss: 3.214 Test Acc: 0.185
Validation loss decreased (-0.147027 --> -0.184674).  Saving model ...
Epoch: 6 cost time: 1.0523886680603027
Epoch: 6, Steps: 10 | Train Loss: 0.934 Vali Loss: 3.300 Vali Acc: 0.224 Test Loss: 3.300 Test Acc: 0.224
Validation loss decreased (-0.184674 --> -0.223496).  Saving model ...
Epoch: 7 cost time: 0.8521783351898193
Epoch: 7, Steps: 10 | Train Loss: 0.522 Vali Loss: 3.542 Vali Acc: 0.240 Test Loss: 3.542 Test Acc: 0.240
Validation loss decreased (-0.223496 --> -0.239965).  Saving model ...
Epoch: 8 cost time: 1.2026751041412354
Epoch: 8, Steps: 10 | Train Loss: 0.228 Vali Loss: 3.844 Vali Acc: 0.256 Test Loss: 3.844 Test Acc: 0.256
Validation loss decreased (-0.239965 --> -0.256432).  Saving model ...
Epoch: 9 cost time: 1.1027019023895264
Epoch: 9, Steps: 10 | Train Loss: 0.093 Vali Loss: 4.129 Vali Acc: 0.262 Test Loss: 4.129 Test Acc: 0.262
Validation loss decreased (-0.256432 --> -0.262312).  Saving model ...
Epoch: 10 cost time: 1.2006361484527588
Epoch: 10, Steps: 10 | Train Loss: 0.038 Vali Loss: 4.319 Vali Acc: 0.276 Test Loss: 4.319 Test Acc: 0.276
Validation loss decreased (-0.262312 --> -0.276427).  Saving model ...
Epoch: 11 cost time: 1.0970604419708252
Epoch: 11, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.542 Vali Acc: 0.278 Test Loss: 4.542 Test Acc: 0.278
Validation loss decreased (-0.276427 --> -0.277602).  Saving model ...
Epoch: 12 cost time: 1.2214009761810303
Epoch: 12, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.697 Vali Acc: 0.268 Test Loss: 4.697 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.15962553024292
Epoch: 13, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.781 Vali Acc: 0.265 Test Loss: 4.781 Test Acc: 0.265
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9994986057281494
Epoch: 14, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.818 Vali Acc: 0.271 Test Loss: 4.818 Test Acc: 0.271
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.9486918449401855
Epoch: 15, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.849 Vali Acc: 0.271 Test Loss: 4.849 Test Acc: 0.271
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.0461068153381348
Epoch: 16, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.890 Vali Acc: 0.268 Test Loss: 4.890 Test Acc: 0.268
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.2442817687988281
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.941 Vali Acc: 0.271 Test Loss: 4.941 Test Acc: 0.271
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.1414234638214111
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.975 Vali Acc: 0.273 Test Loss: 4.975 Test Acc: 0.273
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.047541618347168
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.019 Vali Acc: 0.274 Test Loss: 5.019 Test Acc: 0.274
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.005610466003418
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.078 Vali Acc: 0.275 Test Loss: 5.078 Test Acc: 0.275
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.1086571216583252
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.106 Vali Acc: 0.273 Test Loss: 5.106 Test Acc: 0.273
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2776470588235294
model parameter : 2473626
model size : 9.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps12_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.2317075729370117
Epoch: 1, Steps: 10 | Train Loss: 3.295 Vali Loss: 3.271 Vali Acc: 0.036 Test Loss: 3.271 Test Acc: 0.036
Validation loss decreased (inf --> -0.036438).  Saving model ...
Epoch: 2 cost time: 0.885350227355957
Epoch: 2, Steps: 10 | Train Loss: 3.061 Vali Loss: 3.247 Vali Acc: 0.079 Test Loss: 3.247 Test Acc: 0.079
Validation loss decreased (-0.036438 --> -0.078791).  Saving model ...
Epoch: 3 cost time: 1.1022417545318604
Epoch: 3, Steps: 10 | Train Loss: 2.708 Vali Loss: 3.242 Vali Acc: 0.091 Test Loss: 3.242 Test Acc: 0.091
Validation loss decreased (-0.078791 --> -0.090556).  Saving model ...
Epoch: 4 cost time: 1.107539415359497
Epoch: 4, Steps: 10 | Train Loss: 2.335 Vali Loss: 3.239 Vali Acc: 0.120 Test Loss: 3.239 Test Acc: 0.120
Validation loss decreased (-0.090556 --> -0.119968).  Saving model ...
Epoch: 5 cost time: 1.1077630519866943
Epoch: 5, Steps: 10 | Train Loss: 1.888 Vali Loss: 3.218 Vali Acc: 0.154 Test Loss: 3.218 Test Acc: 0.154
Validation loss decreased (-0.119968 --> -0.154085).  Saving model ...
Epoch: 6 cost time: 1.144103765487671
Epoch: 6, Steps: 10 | Train Loss: 1.374 Vali Loss: 3.211 Vali Acc: 0.192 Test Loss: 3.211 Test Acc: 0.192
Validation loss decreased (-0.154085 --> -0.191733).  Saving model ...
Epoch: 7 cost time: 0.9596381187438965
Epoch: 7, Steps: 10 | Train Loss: 0.907 Vali Loss: 3.279 Vali Acc: 0.226 Test Loss: 3.279 Test Acc: 0.226
Validation loss decreased (-0.191733 --> -0.225850).  Saving model ...
Epoch: 8 cost time: 0.8498916625976562
Epoch: 8, Steps: 10 | Train Loss: 0.530 Vali Loss: 3.423 Vali Acc: 0.231 Test Loss: 3.423 Test Acc: 0.231
Validation loss decreased (-0.225850 --> -0.230554).  Saving model ...
Epoch: 9 cost time: 0.9000425338745117
Epoch: 9, Steps: 10 | Train Loss: 0.285 Vali Loss: 3.671 Vali Acc: 0.247 Test Loss: 3.671 Test Acc: 0.247
Validation loss decreased (-0.230554 --> -0.247022).  Saving model ...
Epoch: 10 cost time: 1.0433979034423828
Epoch: 10, Steps: 10 | Train Loss: 0.133 Vali Loss: 3.866 Vali Acc: 0.251 Test Loss: 3.866 Test Acc: 0.251
Validation loss decreased (-0.247022 --> -0.250550).  Saving model ...
Epoch: 11 cost time: 1.1336920261383057
Epoch: 11, Steps: 10 | Train Loss: 0.065 Vali Loss: 4.069 Vali Acc: 0.247 Test Loss: 4.069 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1132268905639648
Epoch: 12, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.157 Vali Acc: 0.258 Test Loss: 4.157 Test Acc: 0.258
Validation loss decreased (-0.250550 --> -0.257605).  Saving model ...
Epoch: 13 cost time: 1.2564692497253418
Epoch: 13, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.262 Vali Acc: 0.256 Test Loss: 4.262 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.129993200302124
Epoch: 14, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.378 Vali Acc: 0.253 Test Loss: 4.378 Test Acc: 0.253
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.2377564907073975
Epoch: 15, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.431 Vali Acc: 0.254 Test Loss: 4.431 Test Acc: 0.254
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.181532382965088
Epoch: 16, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.477 Vali Acc: 0.254 Test Loss: 4.477 Test Acc: 0.254
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.1412122249603271
Epoch: 17, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.525 Vali Acc: 0.255 Test Loss: 4.525 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.2998332977294922
Epoch: 18, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.576 Vali Acc: 0.260 Test Loss: 4.576 Test Acc: 0.260
Validation loss decreased (-0.257605 --> -0.259954).  Saving model ...
Epoch: 19 cost time: 1.0897598266601562
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.631 Vali Acc: 0.256 Test Loss: 4.631 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1594929695129395
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.663 Vali Acc: 0.260 Test Loss: 4.663 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.2255616188049316
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.706 Vali Acc: 0.258 Test Loss: 4.706 Test Acc: 0.258
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.2495687007904053
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.746 Vali Acc: 0.254 Test Loss: 4.746 Test Acc: 0.254
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.1723108291625977
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.789 Vali Acc: 0.254 Test Loss: 4.789 Test Acc: 0.254
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.1117753982543945
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.817 Vali Acc: 0.256 Test Loss: 4.817 Test Acc: 0.256
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.9341061115264893
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.850 Vali Acc: 0.255 Test Loss: 4.850 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.1247875690460205
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.873 Vali Acc: 0.258 Test Loss: 4.873 Test Acc: 0.258
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.147719144821167
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.901 Vali Acc: 0.258 Test Loss: 4.901 Test Acc: 0.258
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.0200021266937256
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.933 Vali Acc: 0.256 Test Loss: 4.933 Test Acc: 0.256
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps12_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26
model parameter : 2354330
model size : 9.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.5485682487487793
Epoch: 1, Steps: 10 | Train Loss: 3.243 Vali Loss: 3.247 Vali Acc: 0.067 Test Loss: 3.247 Test Acc: 0.067
Validation loss decreased (inf --> -0.067026).  Saving model ...
Epoch: 2 cost time: 1.193260908126831
Epoch: 2, Steps: 10 | Train Loss: 3.107 Vali Loss: 3.223 Vali Acc: 0.082 Test Loss: 3.223 Test Acc: 0.082
Validation loss decreased (-0.067026 --> -0.082321).  Saving model ...
Epoch: 3 cost time: 1.256791353225708
Epoch: 3, Steps: 10 | Train Loss: 2.805 Vali Loss: 3.205 Vali Acc: 0.100 Test Loss: 3.205 Test Acc: 0.100
Validation loss decreased (-0.082321 --> -0.099968).  Saving model ...
Epoch: 4 cost time: 1.1930992603302002
Epoch: 4, Steps: 10 | Train Loss: 2.476 Vali Loss: 3.193 Vali Acc: 0.119 Test Loss: 3.193 Test Acc: 0.119
Validation loss decreased (-0.099968 --> -0.118792).  Saving model ...
Epoch: 5 cost time: 1.2123608589172363
Epoch: 5, Steps: 10 | Train Loss: 2.157 Vali Loss: 3.181 Vali Acc: 0.158 Test Loss: 3.181 Test Acc: 0.158
Validation loss decreased (-0.118792 --> -0.157615).  Saving model ...
Epoch: 6 cost time: 1.0710623264312744
Epoch: 6, Steps: 10 | Train Loss: 1.675 Vali Loss: 3.157 Vali Acc: 0.192 Test Loss: 3.157 Test Acc: 0.192
Validation loss decreased (-0.157615 --> -0.191733).  Saving model ...
Epoch: 7 cost time: 1.0421717166900635
Epoch: 7, Steps: 10 | Train Loss: 1.260 Vali Loss: 3.172 Vali Acc: 0.206 Test Loss: 3.172 Test Acc: 0.206
Validation loss decreased (-0.191733 --> -0.205851).  Saving model ...
Epoch: 8 cost time: 1.2573974132537842
Epoch: 8, Steps: 10 | Train Loss: 0.912 Vali Loss: 3.229 Vali Acc: 0.228 Test Loss: 3.229 Test Acc: 0.228
Validation loss decreased (-0.205851 --> -0.228203).  Saving model ...
Epoch: 9 cost time: 1.149996280670166
Epoch: 9, Steps: 10 | Train Loss: 0.552 Vali Loss: 3.359 Vali Acc: 0.242 Test Loss: 3.359 Test Acc: 0.242
Validation loss decreased (-0.228203 --> -0.242319).  Saving model ...
Epoch: 10 cost time: 1.4258522987365723
Epoch: 10, Steps: 10 | Train Loss: 0.348 Vali Loss: 3.508 Vali Acc: 0.259 Test Loss: 3.508 Test Acc: 0.259
Validation loss decreased (-0.242319 --> -0.258788).  Saving model ...
Epoch: 11 cost time: 1.353355884552002
Epoch: 11, Steps: 10 | Train Loss: 0.200 Vali Loss: 3.673 Vali Acc: 0.262 Test Loss: 3.673 Test Acc: 0.262
Validation loss decreased (-0.258788 --> -0.262316).  Saving model ...
Epoch: 12 cost time: 1.2412710189819336
Epoch: 12, Steps: 10 | Train Loss: 0.100 Vali Loss: 3.815 Vali Acc: 0.281 Test Loss: 3.815 Test Acc: 0.281
Validation loss decreased (-0.262316 --> -0.281138).  Saving model ...
Epoch: 13 cost time: 1.322427749633789
Epoch: 13, Steps: 10 | Train Loss: 0.062 Vali Loss: 3.954 Vali Acc: 0.276 Test Loss: 3.954 Test Acc: 0.276
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2970473766326904
Epoch: 14, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.066 Vali Acc: 0.265 Test Loss: 4.066 Test Acc: 0.265
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.3580858707427979
Epoch: 15, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.165 Vali Acc: 0.266 Test Loss: 4.165 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.3900833129882812
Epoch: 16, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.262 Vali Acc: 0.273 Test Loss: 4.262 Test Acc: 0.273
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.159177303314209
Epoch: 17, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.292 Vali Acc: 0.284 Test Loss: 4.292 Test Acc: 0.284
Validation loss decreased (-0.281138 --> -0.283486).  Saving model ...
Epoch: 18 cost time: 0.9641261100769043
Epoch: 18, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.333 Vali Acc: 0.287 Test Loss: 4.333 Test Acc: 0.287
Validation loss decreased (-0.283486 --> -0.287015).  Saving model ...
Epoch: 19 cost time: 1.2233319282531738
Epoch: 19, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.373 Vali Acc: 0.284 Test Loss: 4.373 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.261671543121338
Epoch: 20, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.418 Vali Acc: 0.279 Test Loss: 4.418 Test Acc: 0.279
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.2548868656158447
Epoch: 21, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.450 Vali Acc: 0.280 Test Loss: 4.450 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.2211031913757324
Epoch: 22, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.486 Vali Acc: 0.278 Test Loss: 4.486 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.292647361755371
Epoch: 23, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.524 Vali Acc: 0.279 Test Loss: 4.524 Test Acc: 0.279
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.2115671634674072
Epoch: 24, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.553 Vali Acc: 0.280 Test Loss: 4.553 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.2193236351013184
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.579 Vali Acc: 0.279 Test Loss: 4.579 Test Acc: 0.279
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.1092910766601562
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.611 Vali Acc: 0.279 Test Loss: 4.611 Test Acc: 0.279
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.3775174617767334
Epoch: 27, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.644 Vali Acc: 0.276 Test Loss: 4.644 Test Acc: 0.276
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.2613024711608887
Epoch: 28, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.687 Vali Acc: 0.274 Test Loss: 4.687 Test Acc: 0.274
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.28705882352941176
model parameter : 2294938
model size : 8.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps23_str12_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.3194515705108643
Epoch: 1, Steps: 10 | Train Loss: 3.279 Vali Loss: 3.260 Vali Acc: 0.039 Test Loss: 3.260 Test Acc: 0.039
Validation loss decreased (inf --> -0.038791).  Saving model ...
Epoch: 2 cost time: 1.2082343101501465
Epoch: 2, Steps: 10 | Train Loss: 3.166 Vali Loss: 3.243 Vali Acc: 0.075 Test Loss: 3.243 Test Acc: 0.075
Validation loss decreased (-0.038791 --> -0.075262).  Saving model ...
Epoch: 3 cost time: 1.2501904964447021
Epoch: 3, Steps: 10 | Train Loss: 2.944 Vali Loss: 3.225 Vali Acc: 0.098 Test Loss: 3.225 Test Acc: 0.098
Validation loss decreased (-0.075262 --> -0.097615).  Saving model ...
Epoch: 4 cost time: 1.114830493927002
Epoch: 4, Steps: 10 | Train Loss: 2.697 Vali Loss: 3.209 Vali Acc: 0.108 Test Loss: 3.209 Test Acc: 0.108
Validation loss decreased (-0.097615 --> -0.108203).  Saving model ...
Epoch: 5 cost time: 1.2365846633911133
Epoch: 5, Steps: 10 | Train Loss: 2.459 Vali Loss: 3.201 Vali Acc: 0.122 Test Loss: 3.201 Test Acc: 0.122
Validation loss decreased (-0.108203 --> -0.122321).  Saving model ...
Epoch: 6 cost time: 1.0560767650604248
Epoch: 6, Steps: 10 | Train Loss: 2.128 Vali Loss: 3.184 Vali Acc: 0.139 Test Loss: 3.184 Test Acc: 0.139
Validation loss decreased (-0.122321 --> -0.138792).  Saving model ...
Epoch: 7 cost time: 1.2617683410644531
Epoch: 7, Steps: 10 | Train Loss: 1.855 Vali Loss: 3.182 Vali Acc: 0.153 Test Loss: 3.182 Test Acc: 0.153
Validation loss decreased (-0.138792 --> -0.152909).  Saving model ...
Epoch: 8 cost time: 1.185145378112793
Epoch: 8, Steps: 10 | Train Loss: 1.497 Vali Loss: 3.190 Vali Acc: 0.186 Test Loss: 3.190 Test Acc: 0.186
Validation loss decreased (-0.152909 --> -0.185850).  Saving model ...
Epoch: 9 cost time: 0.9447042942047119
Epoch: 9, Steps: 10 | Train Loss: 1.154 Vali Loss: 3.202 Vali Acc: 0.213 Test Loss: 3.202 Test Acc: 0.213
Validation loss decreased (-0.185850 --> -0.212909).  Saving model ...
Epoch: 10 cost time: 0.9202256202697754
Epoch: 10, Steps: 10 | Train Loss: 0.866 Vali Loss: 3.249 Vali Acc: 0.234 Test Loss: 3.249 Test Acc: 0.234
Validation loss decreased (-0.212909 --> -0.234085).  Saving model ...
Epoch: 11 cost time: 1.1307339668273926
Epoch: 11, Steps: 10 | Train Loss: 0.592 Vali Loss: 3.327 Vali Acc: 0.241 Test Loss: 3.327 Test Acc: 0.241
Validation loss decreased (-0.234085 --> -0.241143).  Saving model ...
Epoch: 12 cost time: 1.0203454494476318
Epoch: 12, Steps: 10 | Train Loss: 0.394 Vali Loss: 3.426 Vali Acc: 0.259 Test Loss: 3.426 Test Acc: 0.259
Validation loss decreased (-0.241143 --> -0.258789).  Saving model ...
Epoch: 13 cost time: 0.95442795753479
Epoch: 13, Steps: 10 | Train Loss: 0.236 Vali Loss: 3.575 Vali Acc: 0.267 Test Loss: 3.575 Test Acc: 0.267
Validation loss decreased (-0.258789 --> -0.267023).  Saving model ...
Epoch: 14 cost time: 1.2118823528289795
Epoch: 14, Steps: 10 | Train Loss: 0.145 Vali Loss: 3.703 Vali Acc: 0.264 Test Loss: 3.703 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2555091381072998
Epoch: 15, Steps: 10 | Train Loss: 0.094 Vali Loss: 3.794 Vali Acc: 0.274 Test Loss: 3.794 Test Acc: 0.274
Validation loss decreased (-0.267023 --> -0.274080).  Saving model ...
Epoch: 16 cost time: 1.1755914688110352
Epoch: 16, Steps: 10 | Train Loss: 0.061 Vali Loss: 3.847 Vali Acc: 0.279 Test Loss: 3.847 Test Acc: 0.279
Validation loss decreased (-0.274080 --> -0.278785).  Saving model ...
Epoch: 17 cost time: 1.2131075859069824
Epoch: 17, Steps: 10 | Train Loss: 0.042 Vali Loss: 3.933 Vali Acc: 0.281 Test Loss: 3.933 Test Acc: 0.281
Validation loss decreased (-0.278785 --> -0.281137).  Saving model ...
Epoch: 18 cost time: 1.2017662525177002
Epoch: 18, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.997 Vali Acc: 0.276 Test Loss: 3.997 Test Acc: 0.276
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3004069328308105
Epoch: 19, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.048 Vali Acc: 0.275 Test Loss: 4.048 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.2475237846374512
Epoch: 20, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.092 Vali Acc: 0.276 Test Loss: 4.092 Test Acc: 0.276
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.3133118152618408
Epoch: 21, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.148 Vali Acc: 0.281 Test Loss: 4.148 Test Acc: 0.281
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.2091095447540283
Epoch: 22, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.192 Vali Acc: 0.287 Test Loss: 4.192 Test Acc: 0.287
Validation loss decreased (-0.281137 --> -0.287017).  Saving model ...
Epoch: 23 cost time: 1.1446254253387451
Epoch: 23, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.221 Vali Acc: 0.281 Test Loss: 4.221 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.2063231468200684
Epoch: 24, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.257 Vali Acc: 0.282 Test Loss: 4.257 Test Acc: 0.282
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.2180554866790771
Epoch: 25, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.286 Vali Acc: 0.282 Test Loss: 4.286 Test Acc: 0.282
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.224043846130371
Epoch: 26, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.317 Vali Acc: 0.281 Test Loss: 4.317 Test Acc: 0.281
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.2722868919372559
Epoch: 27, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.339 Vali Acc: 0.286 Test Loss: 4.339 Test Acc: 0.286
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.1053359508514404
Epoch: 28, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.371 Vali Acc: 0.287 Test Loss: 4.371 Test Acc: 0.287
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.0972607135772705
Epoch: 29, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.407 Vali Acc: 0.282 Test Loss: 4.407 Test Acc: 0.282
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.22849702835083
Epoch: 30, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.449 Vali Acc: 0.285 Test Loss: 4.449 Test Acc: 0.285
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.2617292404174805
Epoch: 31, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.476 Vali Acc: 0.284 Test Loss: 4.476 Test Acc: 0.284
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.1695570945739746
Epoch: 32, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.495 Vali Acc: 0.286 Test Loss: 4.495 Test Acc: 0.286
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps23_str12_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.28705882352941176
model parameter : 2215962
model size : 8.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.1320178508758545
Epoch: 1, Steps: 10 | Train Loss: 3.286 Vali Loss: 3.253 Vali Acc: 0.048 Test Loss: 3.253 Test Acc: 0.048
Validation loss decreased (inf --> -0.048203).  Saving model ...
Epoch: 2 cost time: 1.0471289157867432
Epoch: 2, Steps: 10 | Train Loss: 3.164 Vali Loss: 3.235 Vali Acc: 0.061 Test Loss: 3.235 Test Acc: 0.061
Validation loss decreased (-0.048203 --> -0.061144).  Saving model ...
Epoch: 3 cost time: 1.0712807178497314
Epoch: 3, Steps: 10 | Train Loss: 2.993 Vali Loss: 3.215 Vali Acc: 0.086 Test Loss: 3.215 Test Acc: 0.086
Validation loss decreased (-0.061144 --> -0.085850).  Saving model ...
Epoch: 4 cost time: 1.2331814765930176
Epoch: 4, Steps: 10 | Train Loss: 2.773 Vali Loss: 3.196 Vali Acc: 0.112 Test Loss: 3.196 Test Acc: 0.112
Validation loss decreased (-0.085850 --> -0.111733).  Saving model ...
Epoch: 5 cost time: 1.2110304832458496
Epoch: 5, Steps: 10 | Train Loss: 2.540 Vali Loss: 3.183 Vali Acc: 0.133 Test Loss: 3.183 Test Acc: 0.133
Validation loss decreased (-0.111733 --> -0.132909).  Saving model ...
Epoch: 6 cost time: 1.2520291805267334
Epoch: 6, Steps: 10 | Train Loss: 2.307 Vali Loss: 3.177 Vali Acc: 0.136 Test Loss: 3.177 Test Acc: 0.136
Validation loss decreased (-0.132909 --> -0.136439).  Saving model ...
Epoch: 7 cost time: 1.1108486652374268
Epoch: 7, Steps: 10 | Train Loss: 1.998 Vali Loss: 3.163 Vali Acc: 0.166 Test Loss: 3.163 Test Acc: 0.166
Validation loss decreased (-0.136439 --> -0.165851).  Saving model ...
Epoch: 8 cost time: 1.234492301940918
Epoch: 8, Steps: 10 | Train Loss: 1.712 Vali Loss: 3.146 Vali Acc: 0.182 Test Loss: 3.146 Test Acc: 0.182
Validation loss decreased (-0.165851 --> -0.182321).  Saving model ...
Epoch: 9 cost time: 1.155116081237793
Epoch: 9, Steps: 10 | Train Loss: 1.424 Vali Loss: 3.152 Vali Acc: 0.193 Test Loss: 3.152 Test Acc: 0.193
Validation loss decreased (-0.182321 --> -0.192910).  Saving model ...
Epoch: 10 cost time: 0.9456067085266113
Epoch: 10, Steps: 10 | Train Loss: 1.090 Vali Loss: 3.165 Vali Acc: 0.211 Test Loss: 3.165 Test Acc: 0.211
Validation loss decreased (-0.192910 --> -0.210557).  Saving model ...
Epoch: 11 cost time: 1.07338285446167
Epoch: 11, Steps: 10 | Train Loss: 0.821 Vali Loss: 3.207 Vali Acc: 0.232 Test Loss: 3.207 Test Acc: 0.232
Validation loss decreased (-0.210557 --> -0.231733).  Saving model ...
Epoch: 12 cost time: 1.202010154724121
Epoch: 12, Steps: 10 | Train Loss: 0.594 Vali Loss: 3.276 Vali Acc: 0.241 Test Loss: 3.276 Test Acc: 0.241
Validation loss decreased (-0.231733 --> -0.241144).  Saving model ...
Epoch: 13 cost time: 1.1884922981262207
Epoch: 13, Steps: 10 | Train Loss: 0.400 Vali Loss: 3.359 Vali Acc: 0.244 Test Loss: 3.359 Test Acc: 0.244
Validation loss decreased (-0.241144 --> -0.243496).  Saving model ...
Epoch: 14 cost time: 1.1317660808563232
Epoch: 14, Steps: 10 | Train Loss: 0.258 Vali Loss: 3.462 Vali Acc: 0.260 Test Loss: 3.462 Test Acc: 0.260
Validation loss decreased (-0.243496 --> -0.259965).  Saving model ...
Epoch: 15 cost time: 1.2201471328735352
Epoch: 15, Steps: 10 | Train Loss: 0.174 Vali Loss: 3.567 Vali Acc: 0.261 Test Loss: 3.567 Test Acc: 0.261
Validation loss decreased (-0.259965 --> -0.261141).  Saving model ...
Epoch: 16 cost time: 1.2477831840515137
Epoch: 16, Steps: 10 | Train Loss: 0.117 Vali Loss: 3.678 Vali Acc: 0.261 Test Loss: 3.678 Test Acc: 0.261
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1681396961212158
Epoch: 17, Steps: 10 | Train Loss: 0.076 Vali Loss: 3.720 Vali Acc: 0.271 Test Loss: 3.720 Test Acc: 0.271
Validation loss decreased (-0.261141 --> -0.270551).  Saving model ...
Epoch: 18 cost time: 1.1534216403961182
Epoch: 18, Steps: 10 | Train Loss: 0.058 Vali Loss: 3.766 Vali Acc: 0.262 Test Loss: 3.766 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.984086275100708
Epoch: 19, Steps: 10 | Train Loss: 0.042 Vali Loss: 3.831 Vali Acc: 0.266 Test Loss: 3.831 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.2398102283477783
Epoch: 20, Steps: 10 | Train Loss: 0.035 Vali Loss: 3.905 Vali Acc: 0.268 Test Loss: 3.905 Test Acc: 0.268
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.196084976196289
Epoch: 21, Steps: 10 | Train Loss: 0.027 Vali Loss: 3.949 Vali Acc: 0.269 Test Loss: 3.949 Test Acc: 0.269
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.076298475265503
Epoch: 22, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.973 Vali Acc: 0.271 Test Loss: 3.973 Test Acc: 0.271
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.1255130767822266
Epoch: 23, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.009 Vali Acc: 0.268 Test Loss: 4.009 Test Acc: 0.268
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.215989351272583
Epoch: 24, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.043 Vali Acc: 0.268 Test Loss: 4.043 Test Acc: 0.268
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.1171104907989502
Epoch: 25, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.095 Vali Acc: 0.268 Test Loss: 4.095 Test Acc: 0.268
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.1967360973358154
Epoch: 26, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.127 Vali Acc: 0.274 Test Loss: 4.127 Test Acc: 0.274
Validation loss decreased (-0.270551 --> -0.274076).  Saving model ...
Epoch: 27 cost time: 1.183598279953003
Epoch: 27, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.156 Vali Acc: 0.278 Test Loss: 4.156 Test Acc: 0.278
Validation loss decreased (-0.274076 --> -0.277606).  Saving model ...
Epoch: 28 cost time: 1.194157600402832
Epoch: 28, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.189 Vali Acc: 0.275 Test Loss: 4.189 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.1953825950622559
Epoch: 29, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.203 Vali Acc: 0.275 Test Loss: 4.203 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.0039393901824951
Epoch: 30, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.233 Vali Acc: 0.274 Test Loss: 4.233 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.300156831741333
Epoch: 31, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.243 Vali Acc: 0.275 Test Loss: 4.243 Test Acc: 0.275
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.1532578468322754
Epoch: 32, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.292 Vali Acc: 0.278 Test Loss: 4.292 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.1391856670379639
Epoch: 33, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.314 Vali Acc: 0.281 Test Loss: 4.314 Test Acc: 0.281
Validation loss decreased (-0.277606 --> -0.281133).  Saving model ...
Epoch: 34 cost time: 1.3876993656158447
Epoch: 34, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.348 Vali Acc: 0.279 Test Loss: 4.348 Test Acc: 0.279
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.2661798000335693
Epoch: 35, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.373 Vali Acc: 0.281 Test Loss: 4.373 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.2063322067260742
Epoch: 36, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.394 Vali Acc: 0.279 Test Loss: 4.394 Test Acc: 0.279
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.1952364444732666
Epoch: 37, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.420 Vali Acc: 0.284 Test Loss: 4.420 Test Acc: 0.284
Validation loss decreased (-0.281133 --> -0.283485).  Saving model ...
Epoch: 38 cost time: 1.0898826122283936
Epoch: 38, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.458 Vali Acc: 0.281 Test Loss: 4.458 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.0993132591247559
Epoch: 39, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.469 Vali Acc: 0.281 Test Loss: 4.469 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.9937329292297363
Epoch: 40, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.477 Vali Acc: 0.281 Test Loss: 4.477 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.0316781997680664
Epoch: 41, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.506 Vali Acc: 0.280 Test Loss: 4.506 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.2201690673828125
Epoch: 42, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.530 Vali Acc: 0.281 Test Loss: 4.530 Test Acc: 0.281
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.2393863201141357
Epoch: 43, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.541 Vali Acc: 0.281 Test Loss: 4.541 Test Acc: 0.281
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.2706615924835205
Epoch: 44, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.573 Vali Acc: 0.281 Test Loss: 4.573 Test Acc: 0.281
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.0823218822479248
Epoch: 45, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.591 Vali Acc: 0.284 Test Loss: 4.591 Test Acc: 0.284
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 1.3154540061950684
Epoch: 46, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.613 Vali Acc: 0.281 Test Loss: 4.613 Test Acc: 0.281
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 1.1681427955627441
Epoch: 47, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.610 Vali Acc: 0.282 Test Loss: 4.610 Test Acc: 0.282
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.28352941176470586
model parameter : 2197018
model size : 8.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps38_str19_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.459343910217285
Epoch: 1, Steps: 10 | Train Loss: 3.263 Vali Loss: 3.261 Vali Acc: 0.059 Test Loss: 3.261 Test Acc: 0.059
Validation loss decreased (inf --> -0.058791).  Saving model ...
Epoch: 2 cost time: 1.0858685970306396
Epoch: 2, Steps: 10 | Train Loss: 3.180 Vali Loss: 3.247 Vali Acc: 0.075 Test Loss: 3.247 Test Acc: 0.075
Validation loss decreased (-0.058791 --> -0.075262).  Saving model ...
Epoch: 3 cost time: 1.0779757499694824
Epoch: 3, Steps: 10 | Train Loss: 3.034 Vali Loss: 3.227 Vali Acc: 0.076 Test Loss: 3.227 Test Acc: 0.076
Validation loss decreased (-0.075262 --> -0.076438).  Saving model ...
Epoch: 4 cost time: 1.0107018947601318
Epoch: 4, Steps: 10 | Train Loss: 2.829 Vali Loss: 3.207 Vali Acc: 0.115 Test Loss: 3.207 Test Acc: 0.115
Validation loss decreased (-0.076438 --> -0.115262).  Saving model ...
Epoch: 5 cost time: 0.9535341262817383
Epoch: 5, Steps: 10 | Train Loss: 2.633 Vali Loss: 3.193 Vali Acc: 0.124 Test Loss: 3.193 Test Acc: 0.124
Validation loss decreased (-0.115262 --> -0.123497).  Saving model ...
Epoch: 6 cost time: 1.1221849918365479
Epoch: 6, Steps: 10 | Train Loss: 2.392 Vali Loss: 3.189 Vali Acc: 0.138 Test Loss: 3.189 Test Acc: 0.138
Validation loss decreased (-0.123497 --> -0.137615).  Saving model ...
Epoch: 7 cost time: 1.1109373569488525
Epoch: 7, Steps: 10 | Train Loss: 2.148 Vali Loss: 3.174 Vali Acc: 0.158 Test Loss: 3.174 Test Acc: 0.158
Validation loss decreased (-0.137615 --> -0.157615).  Saving model ...
Epoch: 8 cost time: 0.9615888595581055
Epoch: 8, Steps: 10 | Train Loss: 1.854 Vali Loss: 3.171 Vali Acc: 0.181 Test Loss: 3.171 Test Acc: 0.181
Validation loss decreased (-0.157615 --> -0.181145).  Saving model ...
Epoch: 9 cost time: 0.9241399765014648
Epoch: 9, Steps: 10 | Train Loss: 1.561 Vali Loss: 3.166 Vali Acc: 0.199 Test Loss: 3.166 Test Acc: 0.199
Validation loss decreased (-0.181145 --> -0.198792).  Saving model ...
Epoch: 10 cost time: 0.7785074710845947
Epoch: 10, Steps: 10 | Train Loss: 1.323 Vali Loss: 3.195 Vali Acc: 0.206 Test Loss: 3.195 Test Acc: 0.206
Validation loss decreased (-0.198792 --> -0.205850).  Saving model ...
Epoch: 11 cost time: 1.0969023704528809
Epoch: 11, Steps: 10 | Train Loss: 1.042 Vali Loss: 3.215 Vali Acc: 0.224 Test Loss: 3.215 Test Acc: 0.224
Validation loss decreased (-0.205850 --> -0.223497).  Saving model ...
Epoch: 12 cost time: 0.9155724048614502
Epoch: 12, Steps: 10 | Train Loss: 0.773 Vali Loss: 3.267 Vali Acc: 0.233 Test Loss: 3.267 Test Acc: 0.233
Validation loss decreased (-0.223497 --> -0.232909).  Saving model ...
Epoch: 13 cost time: 0.825035810470581
Epoch: 13, Steps: 10 | Train Loss: 0.583 Vali Loss: 3.332 Vali Acc: 0.240 Test Loss: 3.332 Test Acc: 0.240
Validation loss decreased (-0.232909 --> -0.239967).  Saving model ...
Epoch: 14 cost time: 1.0719804763793945
Epoch: 14, Steps: 10 | Train Loss: 0.400 Vali Loss: 3.433 Vali Acc: 0.252 Test Loss: 3.433 Test Acc: 0.252
Validation loss decreased (-0.239967 --> -0.251730).  Saving model ...
Epoch: 15 cost time: 1.2053747177124023
Epoch: 15, Steps: 10 | Train Loss: 0.271 Vali Loss: 3.528 Vali Acc: 0.260 Test Loss: 3.528 Test Acc: 0.260
Validation loss decreased (-0.251730 --> -0.259965).  Saving model ...
Epoch: 16 cost time: 1.1889896392822266
Epoch: 16, Steps: 10 | Train Loss: 0.179 Vali Loss: 3.632 Vali Acc: 0.259 Test Loss: 3.632 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0629863739013672
Epoch: 17, Steps: 10 | Train Loss: 0.117 Vali Loss: 3.710 Vali Acc: 0.259 Test Loss: 3.710 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9837541580200195
Epoch: 18, Steps: 10 | Train Loss: 0.088 Vali Loss: 3.783 Vali Acc: 0.269 Test Loss: 3.783 Test Acc: 0.269
Validation loss decreased (-0.259965 --> -0.269374).  Saving model ...
Epoch: 19 cost time: 1.1109240055084229
Epoch: 19, Steps: 10 | Train Loss: 0.062 Vali Loss: 3.851 Vali Acc: 0.265 Test Loss: 3.851 Test Acc: 0.265
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0787177085876465
Epoch: 20, Steps: 10 | Train Loss: 0.052 Vali Loss: 3.912 Vali Acc: 0.267 Test Loss: 3.912 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.011193037033081
Epoch: 21, Steps: 10 | Train Loss: 0.039 Vali Loss: 3.958 Vali Acc: 0.273 Test Loss: 3.958 Test Acc: 0.273
Validation loss decreased (-0.269374 --> -0.272902).  Saving model ...
Epoch: 22 cost time: 1.1345443725585938
Epoch: 22, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.025 Vali Acc: 0.273 Test Loss: 4.025 Test Acc: 0.273
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.1104319095611572
Epoch: 23, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.060 Vali Acc: 0.276 Test Loss: 4.060 Test Acc: 0.276
Validation loss decreased (-0.272902 --> -0.276430).  Saving model ...
Epoch: 24 cost time: 1.0643820762634277
Epoch: 24, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.087 Vali Acc: 0.282 Test Loss: 4.087 Test Acc: 0.282
Validation loss decreased (-0.276430 --> -0.282312).  Saving model ...
Epoch: 25 cost time: 1.2739043235778809
Epoch: 25, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.124 Vali Acc: 0.279 Test Loss: 4.124 Test Acc: 0.279
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.128185749053955
Epoch: 26, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.178 Vali Acc: 0.281 Test Loss: 4.178 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.1741745471954346
Epoch: 27, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.203 Vali Acc: 0.282 Test Loss: 4.203 Test Acc: 0.282
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.1480448246002197
Epoch: 28, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.253 Vali Acc: 0.282 Test Loss: 4.253 Test Acc: 0.282
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.8032100200653076
Epoch: 29, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.264 Vali Acc: 0.280 Test Loss: 4.264 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.8605566024780273
Epoch: 30, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.287 Vali Acc: 0.285 Test Loss: 4.287 Test Acc: 0.285
Validation loss decreased (-0.282312 --> -0.284663).  Saving model ...
Epoch: 31 cost time: 1.134871006011963
Epoch: 31, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.342 Vali Acc: 0.284 Test Loss: 4.342 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.1794414520263672
Epoch: 32, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.389 Vali Acc: 0.282 Test Loss: 4.389 Test Acc: 0.282
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.1494925022125244
Epoch: 33, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.383 Vali Acc: 0.281 Test Loss: 4.383 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.2676856517791748
Epoch: 34, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.401 Vali Acc: 0.282 Test Loss: 4.401 Test Acc: 0.282
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.1198766231536865
Epoch: 35, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.479 Vali Acc: 0.279 Test Loss: 4.479 Test Acc: 0.279
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.125366449356079
Epoch: 36, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.478 Vali Acc: 0.282 Test Loss: 4.478 Test Acc: 0.282
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.2469067573547363
Epoch: 37, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.452 Vali Acc: 0.286 Test Loss: 4.452 Test Acc: 0.286
Validation loss decreased (-0.284663 --> -0.285838).  Saving model ...
Epoch: 38 cost time: 1.1793861389160156
Epoch: 38, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.498 Vali Acc: 0.285 Test Loss: 4.498 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.0426867008209229
Epoch: 39, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.531 Vali Acc: 0.280 Test Loss: 4.531 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.9614522457122803
Epoch: 40, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.562 Vali Acc: 0.276 Test Loss: 4.562 Test Acc: 0.276
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.9637808799743652
Epoch: 41, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.602 Vali Acc: 0.281 Test Loss: 4.602 Test Acc: 0.281
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.0797650814056396
Epoch: 42, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.625 Vali Acc: 0.282 Test Loss: 4.625 Test Acc: 0.282
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.0043799877166748
Epoch: 43, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.647 Vali Acc: 0.280 Test Loss: 4.647 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.2106592655181885
Epoch: 44, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.673 Vali Acc: 0.286 Test Loss: 4.673 Test Acc: 0.286
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.2575340270996094
Epoch: 45, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.680 Vali Acc: 0.282 Test Loss: 4.680 Test Acc: 0.282
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 1.1505722999572754
Epoch: 46, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.696 Vali Acc: 0.287 Test Loss: 4.696 Test Acc: 0.287
Validation loss decreased (-0.285838 --> -0.287012).  Saving model ...
Epoch: 47 cost time: 1.1432971954345703
Epoch: 47, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.715 Vali Acc: 0.286 Test Loss: 4.715 Test Acc: 0.286
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.1075243949890137
Epoch: 48, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.745 Vali Acc: 0.286 Test Loss: 4.745 Test Acc: 0.286
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.1756958961486816
Epoch: 49, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.768 Vali Acc: 0.285 Test Loss: 4.768 Test Acc: 0.285
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.1977684497833252
Epoch: 50, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.775 Vali Acc: 0.285 Test Loss: 4.775 Test Acc: 0.285
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps38_str19_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.28705882352941176
model parameter : 2177946
model size : 8.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.3316214084625244
Epoch: 1, Steps: 10 | Train Loss: 3.269 Vali Loss: 3.249 Vali Acc: 0.056 Test Loss: 3.249 Test Acc: 0.056
Validation loss decreased (inf --> -0.056438).  Saving model ...
Epoch: 2 cost time: 0.9187865257263184
Epoch: 2, Steps: 10 | Train Loss: 3.029 Vali Loss: 3.239 Vali Acc: 0.091 Test Loss: 3.239 Test Acc: 0.091
Validation loss decreased (-0.056438 --> -0.090556).  Saving model ...
Epoch: 3 cost time: 1.1069388389587402
Epoch: 3, Steps: 10 | Train Loss: 2.628 Vali Loss: 3.237 Vali Acc: 0.105 Test Loss: 3.237 Test Acc: 0.105
Validation loss decreased (-0.090556 --> -0.104674).  Saving model ...
Epoch: 4 cost time: 1.262573003768921
Epoch: 4, Steps: 10 | Train Loss: 2.186 Vali Loss: 3.213 Vali Acc: 0.136 Test Loss: 3.213 Test Acc: 0.136
Validation loss decreased (-0.104674 --> -0.136438).  Saving model ...
Epoch: 5 cost time: 1.1888043880462646
Epoch: 5, Steps: 10 | Train Loss: 1.615 Vali Loss: 3.182 Vali Acc: 0.167 Test Loss: 3.182 Test Acc: 0.167
Validation loss decreased (-0.136438 --> -0.167027).  Saving model ...
Epoch: 6 cost time: 0.9714739322662354
Epoch: 6, Steps: 10 | Train Loss: 1.008 Vali Loss: 3.229 Vali Acc: 0.202 Test Loss: 3.229 Test Acc: 0.202
Validation loss decreased (-0.167027 --> -0.202321).  Saving model ...
Epoch: 7 cost time: 1.192185878753662
Epoch: 7, Steps: 10 | Train Loss: 0.595 Vali Loss: 3.430 Vali Acc: 0.219 Test Loss: 3.430 Test Acc: 0.219
Validation loss decreased (-0.202321 --> -0.218789).  Saving model ...
Epoch: 8 cost time: 1.204538345336914
Epoch: 8, Steps: 10 | Train Loss: 0.273 Vali Loss: 3.696 Vali Acc: 0.232 Test Loss: 3.696 Test Acc: 0.232
Validation loss decreased (-0.218789 --> -0.231728).  Saving model ...
Epoch: 9 cost time: 1.1354484558105469
Epoch: 9, Steps: 10 | Train Loss: 0.111 Vali Loss: 3.979 Vali Acc: 0.253 Test Loss: 3.979 Test Acc: 0.253
Validation loss decreased (-0.231728 --> -0.252901).  Saving model ...
Epoch: 10 cost time: 1.377913475036621
Epoch: 10, Steps: 10 | Train Loss: 0.051 Vali Loss: 4.282 Vali Acc: 0.231 Test Loss: 4.282 Test Acc: 0.231
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2527060508728027
Epoch: 11, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.338 Vali Acc: 0.252 Test Loss: 4.338 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.221184492111206
Epoch: 12, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.407 Vali Acc: 0.265 Test Loss: 4.407 Test Acc: 0.265
Validation loss decreased (-0.252901 --> -0.264662).  Saving model ...
Epoch: 13 cost time: 1.2660305500030518
Epoch: 13, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.494 Vali Acc: 0.260 Test Loss: 4.494 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3266031742095947
Epoch: 14, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.592 Vali Acc: 0.254 Test Loss: 4.592 Test Acc: 0.254
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9942831993103027
Epoch: 15, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.643 Vali Acc: 0.256 Test Loss: 4.643 Test Acc: 0.256
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9270670413970947
Epoch: 16, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.674 Vali Acc: 0.260 Test Loss: 4.674 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.319441556930542
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.717 Vali Acc: 0.261 Test Loss: 4.717 Test Acc: 0.261
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.253877878189087
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.767 Vali Acc: 0.260 Test Loss: 4.767 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.3061065673828125
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.794 Vali Acc: 0.261 Test Loss: 4.794 Test Acc: 0.261
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.2007837295532227
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.824 Vali Acc: 0.258 Test Loss: 4.824 Test Acc: 0.258
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.121168613433838
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.853 Vali Acc: 0.259 Test Loss: 4.853 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.1467359066009521
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.879 Vali Acc: 0.261 Test Loss: 4.879 Test Acc: 0.261
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2647058823529412
model parameter : 918362
model size : 3.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.1887574195861816
Epoch: 1, Steps: 10 | Train Loss: 3.259 Vali Loss: 3.261 Vali Acc: 0.053 Test Loss: 3.261 Test Acc: 0.053
Validation loss decreased (inf --> -0.052909).  Saving model ...
Epoch: 2 cost time: 1.0221385955810547
Epoch: 2, Steps: 10 | Train Loss: 3.128 Vali Loss: 3.242 Vali Acc: 0.068 Test Loss: 3.242 Test Acc: 0.068
Validation loss decreased (-0.052909 --> -0.068203).  Saving model ...
Epoch: 3 cost time: 1.0986833572387695
Epoch: 3, Steps: 10 | Train Loss: 2.886 Vali Loss: 3.231 Vali Acc: 0.096 Test Loss: 3.231 Test Acc: 0.096
Validation loss decreased (-0.068203 --> -0.096438).  Saving model ...
Epoch: 4 cost time: 1.089341163635254
Epoch: 4, Steps: 10 | Train Loss: 2.564 Vali Loss: 3.221 Vali Acc: 0.116 Test Loss: 3.221 Test Acc: 0.116
Validation loss decreased (-0.096438 --> -0.116438).  Saving model ...
Epoch: 5 cost time: 0.9491331577301025
Epoch: 5, Steps: 10 | Train Loss: 2.269 Vali Loss: 3.216 Vali Acc: 0.125 Test Loss: 3.216 Test Acc: 0.125
Validation loss decreased (-0.116438 --> -0.124674).  Saving model ...
Epoch: 6 cost time: 1.0600571632385254
Epoch: 6, Steps: 10 | Train Loss: 1.855 Vali Loss: 3.187 Vali Acc: 0.154 Test Loss: 3.187 Test Acc: 0.154
Validation loss decreased (-0.124674 --> -0.154086).  Saving model ...
Epoch: 7 cost time: 1.034581184387207
Epoch: 7, Steps: 10 | Train Loss: 1.469 Vali Loss: 3.203 Vali Acc: 0.174 Test Loss: 3.203 Test Acc: 0.174
Validation loss decreased (-0.154086 --> -0.174086).  Saving model ...
Epoch: 8 cost time: 0.9312646389007568
Epoch: 8, Steps: 10 | Train Loss: 1.045 Vali Loss: 3.250 Vali Acc: 0.200 Test Loss: 3.250 Test Acc: 0.200
Validation loss decreased (-0.174086 --> -0.199968).  Saving model ...
Epoch: 9 cost time: 0.9043376445770264
Epoch: 9, Steps: 10 | Train Loss: 0.705 Vali Loss: 3.340 Vali Acc: 0.224 Test Loss: 3.340 Test Acc: 0.224
Validation loss decreased (-0.199968 --> -0.223496).  Saving model ...
Epoch: 10 cost time: 1.0587725639343262
Epoch: 10, Steps: 10 | Train Loss: 0.470 Vali Loss: 3.515 Vali Acc: 0.242 Test Loss: 3.515 Test Acc: 0.242
Validation loss decreased (-0.223496 --> -0.242318).  Saving model ...
Epoch: 11 cost time: 1.0707688331604004
Epoch: 11, Steps: 10 | Train Loss: 0.265 Vali Loss: 3.680 Vali Acc: 0.239 Test Loss: 3.680 Test Acc: 0.239
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.785076379776001
Epoch: 12, Steps: 10 | Train Loss: 0.139 Vali Loss: 3.869 Vali Acc: 0.249 Test Loss: 3.869 Test Acc: 0.249
Validation loss decreased (-0.242318 --> -0.249373).  Saving model ...
Epoch: 13 cost time: 0.7532069683074951
Epoch: 13, Steps: 10 | Train Loss: 0.093 Vali Loss: 4.030 Vali Acc: 0.259 Test Loss: 4.030 Test Acc: 0.259
Validation loss decreased (-0.249373 --> -0.258783).  Saving model ...
Epoch: 14 cost time: 0.8494784832000732
Epoch: 14, Steps: 10 | Train Loss: 0.051 Vali Loss: 4.191 Vali Acc: 0.248 Test Loss: 4.191 Test Acc: 0.248
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0783405303955078
Epoch: 15, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.257 Vali Acc: 0.260 Test Loss: 4.257 Test Acc: 0.260
Validation loss decreased (-0.258783 --> -0.259957).  Saving model ...
Epoch: 16 cost time: 1.0753469467163086
Epoch: 16, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.307 Vali Acc: 0.260 Test Loss: 4.307 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0790812969207764
Epoch: 17, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.389 Vali Acc: 0.262 Test Loss: 4.389 Test Acc: 0.262
Validation loss decreased (-0.259957 --> -0.262309).  Saving model ...
Epoch: 18 cost time: 1.0232534408569336
Epoch: 18, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.473 Vali Acc: 0.259 Test Loss: 4.473 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0393867492675781
Epoch: 19, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.530 Vali Acc: 0.266 Test Loss: 4.530 Test Acc: 0.266
Validation loss decreased (-0.262309 --> -0.265837).  Saving model ...
Epoch: 20 cost time: 0.9372467994689941
Epoch: 20, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.559 Vali Acc: 0.260 Test Loss: 4.559 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.003465175628662
Epoch: 21, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.594 Vali Acc: 0.261 Test Loss: 4.594 Test Acc: 0.261
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.0230364799499512
Epoch: 22, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.638 Vali Acc: 0.266 Test Loss: 4.638 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.8951170444488525
Epoch: 23, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.688 Vali Acc: 0.260 Test Loss: 4.688 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.129991054534912
Epoch: 24, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.729 Vali Acc: 0.262 Test Loss: 4.729 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.9910657405853271
Epoch: 25, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.773 Vali Acc: 0.268 Test Loss: 4.773 Test Acc: 0.268
Validation loss decreased (-0.265837 --> -0.268188).  Saving model ...
Epoch: 26 cost time: 0.9226012229919434
Epoch: 26, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.808 Vali Acc: 0.268 Test Loss: 4.808 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9382355213165283
Epoch: 27, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.848 Vali Acc: 0.271 Test Loss: 4.848 Test Acc: 0.271
Validation loss decreased (-0.268188 --> -0.270540).  Saving model ...
Epoch: 28 cost time: 1.036858320236206
Epoch: 28, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.871 Vali Acc: 0.269 Test Loss: 4.871 Test Acc: 0.269
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.073988914489746
Epoch: 29, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.906 Vali Acc: 0.268 Test Loss: 4.906 Test Acc: 0.268
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.9656665325164795
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.932 Vali Acc: 0.268 Test Loss: 4.932 Test Acc: 0.268
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.067370891571045
Epoch: 31, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.959 Vali Acc: 0.267 Test Loss: 4.959 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.12532377243042
Epoch: 32, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.986 Vali Acc: 0.269 Test Loss: 4.986 Test Acc: 0.269
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.182969093322754
Epoch: 33, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.009 Vali Acc: 0.268 Test Loss: 5.009 Test Acc: 0.268
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.136451005935669
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.033 Vali Acc: 0.268 Test Loss: 5.033 Test Acc: 0.268
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.1126904487609863
Epoch: 35, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.071 Vali Acc: 0.267 Test Loss: 5.071 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.1207053661346436
Epoch: 36, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.104 Vali Acc: 0.268 Test Loss: 5.104 Test Acc: 0.268
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.120284080505371
Epoch: 37, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.125 Vali Acc: 0.268 Test Loss: 5.125 Test Acc: 0.268
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27058823529411763
model parameter : 728922
model size : 2.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps12_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.0904946327209473
Epoch: 1, Steps: 10 | Train Loss: 3.274 Vali Loss: 3.264 Vali Acc: 0.046 Test Loss: 3.264 Test Acc: 0.046
Validation loss decreased (inf --> -0.045850).  Saving model ...
Epoch: 2 cost time: 0.8259544372558594
Epoch: 2, Steps: 10 | Train Loss: 3.177 Vali Loss: 3.249 Vali Acc: 0.051 Test Loss: 3.249 Test Acc: 0.051
Validation loss decreased (-0.045850 --> -0.050556).  Saving model ...
Epoch: 3 cost time: 1.0043606758117676
Epoch: 3, Steps: 10 | Train Loss: 3.015 Vali Loss: 3.234 Vali Acc: 0.075 Test Loss: 3.234 Test Acc: 0.075
Validation loss decreased (-0.050556 --> -0.075262).  Saving model ...
Epoch: 4 cost time: 0.862917423248291
Epoch: 4, Steps: 10 | Train Loss: 2.789 Vali Loss: 3.219 Vali Acc: 0.104 Test Loss: 3.219 Test Acc: 0.104
Validation loss decreased (-0.075262 --> -0.103497).  Saving model ...
Epoch: 5 cost time: 0.9805660247802734
Epoch: 5, Steps: 10 | Train Loss: 2.544 Vali Loss: 3.212 Vali Acc: 0.101 Test Loss: 3.212 Test Acc: 0.101
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0522329807281494
Epoch: 6, Steps: 10 | Train Loss: 2.289 Vali Loss: 3.197 Vali Acc: 0.126 Test Loss: 3.197 Test Acc: 0.126
Validation loss decreased (-0.103497 --> -0.125850).  Saving model ...
Epoch: 7 cost time: 1.151538610458374
Epoch: 7, Steps: 10 | Train Loss: 1.959 Vali Loss: 3.182 Vali Acc: 0.147 Test Loss: 3.182 Test Acc: 0.147
Validation loss decreased (-0.125850 --> -0.147027).  Saving model ...
Epoch: 8 cost time: 1.0139384269714355
Epoch: 8, Steps: 10 | Train Loss: 1.635 Vali Loss: 3.183 Vali Acc: 0.167 Test Loss: 3.183 Test Acc: 0.167
Validation loss decreased (-0.147027 --> -0.167027).  Saving model ...
Epoch: 9 cost time: 1.0419647693634033
Epoch: 9, Steps: 10 | Train Loss: 1.307 Vali Loss: 3.192 Vali Acc: 0.200 Test Loss: 3.192 Test Acc: 0.200
Validation loss decreased (-0.167027 --> -0.199968).  Saving model ...
Epoch: 10 cost time: 1.1760165691375732
Epoch: 10, Steps: 10 | Train Loss: 0.987 Vali Loss: 3.238 Vali Acc: 0.225 Test Loss: 3.238 Test Acc: 0.225
Validation loss decreased (-0.199968 --> -0.224673).  Saving model ...
Epoch: 11 cost time: 1.116727352142334
Epoch: 11, Steps: 10 | Train Loss: 0.688 Vali Loss: 3.326 Vali Acc: 0.226 Test Loss: 3.326 Test Acc: 0.226
Validation loss decreased (-0.224673 --> -0.225849).  Saving model ...
Epoch: 12 cost time: 1.04371976852417
Epoch: 12, Steps: 10 | Train Loss: 0.459 Vali Loss: 3.445 Vali Acc: 0.236 Test Loss: 3.445 Test Acc: 0.236
Validation loss decreased (-0.225849 --> -0.236436).  Saving model ...
Epoch: 13 cost time: 0.9389843940734863
Epoch: 13, Steps: 10 | Train Loss: 0.325 Vali Loss: 3.607 Vali Acc: 0.238 Test Loss: 3.607 Test Acc: 0.238
Validation loss decreased (-0.236436 --> -0.237611).  Saving model ...
Epoch: 14 cost time: 0.9844334125518799
Epoch: 14, Steps: 10 | Train Loss: 0.203 Vali Loss: 3.742 Vali Acc: 0.247 Test Loss: 3.742 Test Acc: 0.247
Validation loss decreased (-0.237611 --> -0.247021).  Saving model ...
Epoch: 15 cost time: 1.0076422691345215
Epoch: 15, Steps: 10 | Train Loss: 0.127 Vali Loss: 3.841 Vali Acc: 0.255 Test Loss: 3.841 Test Acc: 0.255
Validation loss decreased (-0.247021 --> -0.255256).  Saving model ...
Epoch: 16 cost time: 1.0763592720031738
Epoch: 16, Steps: 10 | Train Loss: 0.082 Vali Loss: 3.987 Vali Acc: 0.248 Test Loss: 3.987 Test Acc: 0.248
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0981950759887695
Epoch: 17, Steps: 10 | Train Loss: 0.058 Vali Loss: 4.096 Vali Acc: 0.242 Test Loss: 4.096 Test Acc: 0.242
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0878205299377441
Epoch: 18, Steps: 10 | Train Loss: 0.039 Vali Loss: 4.156 Vali Acc: 0.256 Test Loss: 4.156 Test Acc: 0.256
Validation loss decreased (-0.255256 --> -0.256429).  Saving model ...
Epoch: 19 cost time: 1.085998773574829
Epoch: 19, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.199 Vali Acc: 0.256 Test Loss: 4.199 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.184480905532837
Epoch: 20, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.278 Vali Acc: 0.255 Test Loss: 4.278 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.1253135204315186
Epoch: 21, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.327 Vali Acc: 0.258 Test Loss: 4.327 Test Acc: 0.258
Validation loss decreased (-0.256429 --> -0.257604).  Saving model ...
Epoch: 22 cost time: 1.0645792484283447
Epoch: 22, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.368 Vali Acc: 0.259 Test Loss: 4.368 Test Acc: 0.259
Validation loss decreased (-0.257604 --> -0.258780).  Saving model ...
Epoch: 23 cost time: 1.1130156517028809
Epoch: 23, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.406 Vali Acc: 0.259 Test Loss: 4.406 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0839269161224365
Epoch: 24, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.464 Vali Acc: 0.261 Test Loss: 4.464 Test Acc: 0.261
Validation loss decreased (-0.258780 --> -0.261132).  Saving model ...
Epoch: 25 cost time: 1.0721542835235596
Epoch: 25, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.510 Vali Acc: 0.265 Test Loss: 4.510 Test Acc: 0.265
Validation loss decreased (-0.261132 --> -0.264661).  Saving model ...
Epoch: 26 cost time: 1.0613160133361816
Epoch: 26, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.546 Vali Acc: 0.267 Test Loss: 4.546 Test Acc: 0.267
Validation loss decreased (-0.264661 --> -0.267013).  Saving model ...
Epoch: 27 cost time: 0.9413270950317383
Epoch: 27, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.577 Vali Acc: 0.265 Test Loss: 4.577 Test Acc: 0.265
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0190768241882324
Epoch: 28, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.636 Vali Acc: 0.265 Test Loss: 4.636 Test Acc: 0.265
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.0880951881408691
Epoch: 29, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.680 Vali Acc: 0.262 Test Loss: 4.680 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.1357676982879639
Epoch: 30, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.691 Vali Acc: 0.265 Test Loss: 4.691 Test Acc: 0.265
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.0519428253173828
Epoch: 31, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.724 Vali Acc: 0.266 Test Loss: 4.724 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.9359159469604492
Epoch: 32, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.752 Vali Acc: 0.266 Test Loss: 4.752 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.9819009304046631
Epoch: 33, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.774 Vali Acc: 0.267 Test Loss: 4.774 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.10121488571167
Epoch: 34, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.808 Vali Acc: 0.268 Test Loss: 4.808 Test Acc: 0.268
Validation loss decreased (-0.267013 --> -0.268187).  Saving model ...
Epoch: 35 cost time: 1.080770492553711
Epoch: 35, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.838 Vali Acc: 0.267 Test Loss: 4.838 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.9683377742767334
Epoch: 36, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.859 Vali Acc: 0.265 Test Loss: 4.859 Test Acc: 0.265
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.8732173442840576
Epoch: 37, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.881 Vali Acc: 0.267 Test Loss: 4.881 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.9062843322753906
Epoch: 38, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.907 Vali Acc: 0.267 Test Loss: 4.907 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.0731687545776367
Epoch: 39, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.932 Vali Acc: 0.266 Test Loss: 4.932 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.161759376525879
Epoch: 40, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.956 Vali Acc: 0.266 Test Loss: 4.956 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.121009111404419
Epoch: 41, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.968 Vali Acc: 0.272 Test Loss: 4.968 Test Acc: 0.272
Validation loss decreased (-0.268187 --> -0.271715).  Saving model ...
Epoch: 42 cost time: 0.9800562858581543
Epoch: 42, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.989 Vali Acc: 0.272 Test Loss: 4.989 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.9275069236755371
Epoch: 43, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.006 Vali Acc: 0.271 Test Loss: 5.006 Test Acc: 0.271
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.0316555500030518
Epoch: 44, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.049 Vali Acc: 0.268 Test Loss: 5.049 Test Acc: 0.268
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.0036451816558838
Epoch: 45, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.067 Vali Acc: 0.269 Test Loss: 5.067 Test Acc: 0.269
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.0057148933410645
Epoch: 46, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.098 Vali Acc: 0.272 Test Loss: 5.098 Test Acc: 0.272
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.0123090744018555
Epoch: 47, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.114 Vali Acc: 0.272 Test Loss: 5.114 Test Acc: 0.272
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.013129472732544
Epoch: 48, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.133 Vali Acc: 0.269 Test Loss: 5.133 Test Acc: 0.269
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.9484043121337891
Epoch: 49, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.142 Vali Acc: 0.271 Test Loss: 5.142 Test Acc: 0.271
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 0.8534679412841797
Epoch: 50, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.159 Vali Acc: 0.272 Test Loss: 5.159 Test Acc: 0.272
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps12_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27176470588235296
model parameter : 669274
model size : 2.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.1246867179870605
Epoch: 1, Steps: 10 | Train Loss: 3.306 Vali Loss: 3.264 Vali Acc: 0.035 Test Loss: 3.264 Test Acc: 0.035
Validation loss decreased (inf --> -0.035261).  Saving model ...
Epoch: 2 cost time: 0.9784057140350342
Epoch: 2, Steps: 10 | Train Loss: 3.220 Vali Loss: 3.251 Vali Acc: 0.062 Test Loss: 3.251 Test Acc: 0.062
Validation loss decreased (-0.035261 --> -0.062320).  Saving model ...
Epoch: 3 cost time: 0.9892632961273193
Epoch: 3, Steps: 10 | Train Loss: 3.091 Vali Loss: 3.238 Vali Acc: 0.080 Test Loss: 3.238 Test Acc: 0.080
Validation loss decreased (-0.062320 --> -0.079968).  Saving model ...
Epoch: 4 cost time: 0.8565261363983154
Epoch: 4, Steps: 10 | Train Loss: 2.890 Vali Loss: 3.229 Vali Acc: 0.095 Test Loss: 3.229 Test Acc: 0.095
Validation loss decreased (-0.079968 --> -0.095262).  Saving model ...
Epoch: 5 cost time: 0.805168628692627
Epoch: 5, Steps: 10 | Train Loss: 2.715 Vali Loss: 3.221 Vali Acc: 0.102 Test Loss: 3.221 Test Acc: 0.102
Validation loss decreased (-0.095262 --> -0.102321).  Saving model ...
Epoch: 6 cost time: 1.0134708881378174
Epoch: 6, Steps: 10 | Train Loss: 2.498 Vali Loss: 3.214 Vali Acc: 0.116 Test Loss: 3.214 Test Acc: 0.116
Validation loss decreased (-0.102321 --> -0.116438).  Saving model ...
Epoch: 7 cost time: 0.8514478206634521
Epoch: 7, Steps: 10 | Train Loss: 2.233 Vali Loss: 3.208 Vali Acc: 0.136 Test Loss: 3.208 Test Acc: 0.136
Validation loss decreased (-0.116438 --> -0.136439).  Saving model ...
Epoch: 8 cost time: 0.8711051940917969
Epoch: 8, Steps: 10 | Train Loss: 1.987 Vali Loss: 3.194 Vali Acc: 0.145 Test Loss: 3.194 Test Acc: 0.145
Validation loss decreased (-0.136439 --> -0.144674).  Saving model ...
Epoch: 9 cost time: 0.8981971740722656
Epoch: 9, Steps: 10 | Train Loss: 1.682 Vali Loss: 3.204 Vali Acc: 0.152 Test Loss: 3.204 Test Acc: 0.152
Validation loss decreased (-0.144674 --> -0.151733).  Saving model ...
Epoch: 10 cost time: 0.797814130783081
Epoch: 10, Steps: 10 | Train Loss: 1.379 Vali Loss: 3.199 Vali Acc: 0.185 Test Loss: 3.199 Test Acc: 0.185
Validation loss decreased (-0.151733 --> -0.184674).  Saving model ...
Epoch: 11 cost time: 0.7514793872833252
Epoch: 11, Steps: 10 | Train Loss: 1.081 Vali Loss: 3.237 Vali Acc: 0.201 Test Loss: 3.237 Test Acc: 0.201
Validation loss decreased (-0.184674 --> -0.201144).  Saving model ...
Epoch: 12 cost time: 0.8666763305664062
Epoch: 12, Steps: 10 | Train Loss: 0.822 Vali Loss: 3.307 Vali Acc: 0.220 Test Loss: 3.307 Test Acc: 0.220
Validation loss decreased (-0.201144 --> -0.219967).  Saving model ...
Epoch: 13 cost time: 0.8973393440246582
Epoch: 13, Steps: 10 | Train Loss: 0.622 Vali Loss: 3.389 Vali Acc: 0.222 Test Loss: 3.389 Test Acc: 0.222
Validation loss decreased (-0.219967 --> -0.222319).  Saving model ...
Epoch: 14 cost time: 0.86362624168396
Epoch: 14, Steps: 10 | Train Loss: 0.447 Vali Loss: 3.474 Vali Acc: 0.251 Test Loss: 3.474 Test Acc: 0.251
Validation loss decreased (-0.222319 --> -0.250553).  Saving model ...
Epoch: 15 cost time: 0.9304370880126953
Epoch: 15, Steps: 10 | Train Loss: 0.292 Vali Loss: 3.579 Vali Acc: 0.252 Test Loss: 3.579 Test Acc: 0.252
Validation loss decreased (-0.250553 --> -0.251729).  Saving model ...
Epoch: 16 cost time: 0.7353358268737793
Epoch: 16, Steps: 10 | Train Loss: 0.191 Vali Loss: 3.699 Vali Acc: 0.252 Test Loss: 3.699 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0115792751312256
Epoch: 17, Steps: 10 | Train Loss: 0.130 Vali Loss: 3.815 Vali Acc: 0.264 Test Loss: 3.815 Test Acc: 0.264
Validation loss decreased (-0.251729 --> -0.263491).  Saving model ...
Epoch: 18 cost time: 0.8447530269622803
Epoch: 18, Steps: 10 | Train Loss: 0.098 Vali Loss: 3.905 Vali Acc: 0.268 Test Loss: 3.905 Test Acc: 0.268
Validation loss decreased (-0.263491 --> -0.268196).  Saving model ...
Epoch: 19 cost time: 0.7990596294403076
Epoch: 19, Steps: 10 | Train Loss: 0.074 Vali Loss: 3.981 Vali Acc: 0.274 Test Loss: 3.981 Test Acc: 0.274
Validation loss decreased (-0.268196 --> -0.274078).  Saving model ...
Epoch: 20 cost time: 0.7104752063751221
Epoch: 20, Steps: 10 | Train Loss: 0.054 Vali Loss: 4.050 Vali Acc: 0.268 Test Loss: 4.050 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7035107612609863
Epoch: 21, Steps: 10 | Train Loss: 0.041 Vali Loss: 4.113 Vali Acc: 0.272 Test Loss: 4.113 Test Acc: 0.272
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.8568758964538574
Epoch: 22, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.183 Vali Acc: 0.271 Test Loss: 4.183 Test Acc: 0.271
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.7670416831970215
Epoch: 23, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.243 Vali Acc: 0.275 Test Loss: 4.243 Test Acc: 0.275
Validation loss decreased (-0.274078 --> -0.275252).  Saving model ...
Epoch: 24 cost time: 0.8082320690155029
Epoch: 24, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.281 Vali Acc: 0.274 Test Loss: 4.281 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7573122978210449
Epoch: 25, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.303 Vali Acc: 0.276 Test Loss: 4.303 Test Acc: 0.276
Validation loss decreased (-0.275252 --> -0.276428).  Saving model ...
Epoch: 26 cost time: 0.8215460777282715
Epoch: 26, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.360 Vali Acc: 0.272 Test Loss: 4.360 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9810540676116943
Epoch: 27, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.406 Vali Acc: 0.275 Test Loss: 4.406 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.8039982318878174
Epoch: 28, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.450 Vali Acc: 0.273 Test Loss: 4.450 Test Acc: 0.273
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.8697044849395752
Epoch: 29, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.485 Vali Acc: 0.275 Test Loss: 4.485 Test Acc: 0.275
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.8055684566497803
Epoch: 30, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.510 Vali Acc: 0.273 Test Loss: 4.510 Test Acc: 0.273
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.920651912689209
Epoch: 31, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.518 Vali Acc: 0.272 Test Loss: 4.518 Test Acc: 0.272
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.8866081237792969
Epoch: 32, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.556 Vali Acc: 0.274 Test Loss: 4.556 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.822486400604248
Epoch: 33, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.574 Vali Acc: 0.274 Test Loss: 4.574 Test Acc: 0.274
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.8349931240081787
Epoch: 34, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.611 Vali Acc: 0.271 Test Loss: 4.611 Test Acc: 0.271
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.7156002521514893
Epoch: 35, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.645 Vali Acc: 0.271 Test Loss: 4.645 Test Acc: 0.271
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27647058823529413
model parameter : 639578
model size : 2.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps23_str12_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.035001039505005
Epoch: 1, Steps: 10 | Train Loss: 3.294 Vali Loss: 3.279 Vali Acc: 0.042 Test Loss: 3.279 Test Acc: 0.042
Validation loss decreased (inf --> -0.042320).  Saving model ...
Epoch: 2 cost time: 0.8307228088378906
Epoch: 2, Steps: 10 | Train Loss: 3.230 Vali Loss: 3.271 Vali Acc: 0.054 Test Loss: 3.271 Test Acc: 0.054
Validation loss decreased (-0.042320 --> -0.054085).  Saving model ...
Epoch: 3 cost time: 0.8189196586608887
Epoch: 3, Steps: 10 | Train Loss: 3.131 Vali Loss: 3.258 Vali Acc: 0.059 Test Loss: 3.258 Test Acc: 0.059
Validation loss decreased (-0.054085 --> -0.058791).  Saving model ...
Epoch: 4 cost time: 0.787606954574585
Epoch: 4, Steps: 10 | Train Loss: 3.023 Vali Loss: 3.246 Vali Acc: 0.067 Test Loss: 3.246 Test Acc: 0.067
Validation loss decreased (-0.058791 --> -0.067026).  Saving model ...
Epoch: 5 cost time: 0.8400559425354004
Epoch: 5, Steps: 10 | Train Loss: 2.872 Vali Loss: 3.234 Vali Acc: 0.078 Test Loss: 3.234 Test Acc: 0.078
Validation loss decreased (-0.067026 --> -0.077615).  Saving model ...
Epoch: 6 cost time: 0.8453595638275146
Epoch: 6, Steps: 10 | Train Loss: 2.708 Vali Loss: 3.225 Vali Acc: 0.096 Test Loss: 3.225 Test Acc: 0.096
Validation loss decreased (-0.077615 --> -0.096438).  Saving model ...
Epoch: 7 cost time: 0.7693867683410645
Epoch: 7, Steps: 10 | Train Loss: 2.559 Vali Loss: 3.216 Vali Acc: 0.114 Test Loss: 3.216 Test Acc: 0.114
Validation loss decreased (-0.096438 --> -0.114085).  Saving model ...
Epoch: 8 cost time: 0.8267276287078857
Epoch: 8, Steps: 10 | Train Loss: 2.361 Vali Loss: 3.211 Vali Acc: 0.122 Test Loss: 3.211 Test Acc: 0.122
Validation loss decreased (-0.114085 --> -0.122321).  Saving model ...
Epoch: 9 cost time: 0.8917355537414551
Epoch: 9, Steps: 10 | Train Loss: 2.132 Vali Loss: 3.204 Vali Acc: 0.138 Test Loss: 3.204 Test Acc: 0.138
Validation loss decreased (-0.122321 --> -0.137615).  Saving model ...
Epoch: 10 cost time: 0.7624716758728027
Epoch: 10, Steps: 10 | Train Loss: 1.915 Vali Loss: 3.203 Vali Acc: 0.154 Test Loss: 3.203 Test Acc: 0.154
Validation loss decreased (-0.137615 --> -0.154086).  Saving model ...
Epoch: 11 cost time: 0.9079575538635254
Epoch: 11, Steps: 10 | Train Loss: 1.685 Vali Loss: 3.200 Vali Acc: 0.160 Test Loss: 3.200 Test Acc: 0.160
Validation loss decreased (-0.154086 --> -0.159968).  Saving model ...
Epoch: 12 cost time: 0.8587799072265625
Epoch: 12, Steps: 10 | Train Loss: 1.455 Vali Loss: 3.202 Vali Acc: 0.184 Test Loss: 3.202 Test Acc: 0.184
Validation loss decreased (-0.159968 --> -0.183497).  Saving model ...
Epoch: 13 cost time: 0.8635818958282471
Epoch: 13, Steps: 10 | Train Loss: 1.180 Vali Loss: 3.210 Vali Acc: 0.200 Test Loss: 3.210 Test Acc: 0.200
Validation loss decreased (-0.183497 --> -0.199968).  Saving model ...
Epoch: 14 cost time: 0.7996971607208252
Epoch: 14, Steps: 10 | Train Loss: 1.000 Vali Loss: 3.251 Vali Acc: 0.220 Test Loss: 3.251 Test Acc: 0.220
Validation loss decreased (-0.199968 --> -0.219967).  Saving model ...
Epoch: 15 cost time: 0.6692125797271729
Epoch: 15, Steps: 10 | Train Loss: 0.773 Vali Loss: 3.293 Vali Acc: 0.226 Test Loss: 3.293 Test Acc: 0.226
Validation loss decreased (-0.219967 --> -0.225849).  Saving model ...
Epoch: 16 cost time: 0.758852481842041
Epoch: 16, Steps: 10 | Train Loss: 0.600 Vali Loss: 3.350 Vali Acc: 0.241 Test Loss: 3.350 Test Acc: 0.241
Validation loss decreased (-0.225849 --> -0.241143).  Saving model ...
Epoch: 17 cost time: 0.8545107841491699
Epoch: 17, Steps: 10 | Train Loss: 0.455 Vali Loss: 3.413 Vali Acc: 0.242 Test Loss: 3.413 Test Acc: 0.242
Validation loss decreased (-0.241143 --> -0.242319).  Saving model ...
Epoch: 18 cost time: 0.8882002830505371
Epoch: 18, Steps: 10 | Train Loss: 0.332 Vali Loss: 3.486 Vali Acc: 0.246 Test Loss: 3.486 Test Acc: 0.246
Validation loss decreased (-0.242319 --> -0.245847).  Saving model ...
Epoch: 19 cost time: 0.8530933856964111
Epoch: 19, Steps: 10 | Train Loss: 0.249 Vali Loss: 3.577 Vali Acc: 0.265 Test Loss: 3.577 Test Acc: 0.265
Validation loss decreased (-0.245847 --> -0.264670).  Saving model ...
Epoch: 20 cost time: 0.7886519432067871
Epoch: 20, Steps: 10 | Train Loss: 0.186 Vali Loss: 3.638 Vali Acc: 0.269 Test Loss: 3.638 Test Acc: 0.269
Validation loss decreased (-0.264670 --> -0.269375).  Saving model ...
Epoch: 21 cost time: 0.778764009475708
Epoch: 21, Steps: 10 | Train Loss: 0.140 Vali Loss: 3.705 Vali Acc: 0.268 Test Loss: 3.705 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8212885856628418
Epoch: 22, Steps: 10 | Train Loss: 0.111 Vali Loss: 3.769 Vali Acc: 0.279 Test Loss: 3.769 Test Acc: 0.279
Validation loss decreased (-0.269375 --> -0.278786).  Saving model ...
Epoch: 23 cost time: 0.9202558994293213
Epoch: 23, Steps: 10 | Train Loss: 0.086 Vali Loss: 3.829 Vali Acc: 0.274 Test Loss: 3.829 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9974994659423828
Epoch: 24, Steps: 10 | Train Loss: 0.067 Vali Loss: 3.870 Vali Acc: 0.276 Test Loss: 3.870 Test Acc: 0.276
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.9604482650756836
Epoch: 25, Steps: 10 | Train Loss: 0.059 Vali Loss: 3.925 Vali Acc: 0.278 Test Loss: 3.925 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.8452842235565186
Epoch: 26, Steps: 10 | Train Loss: 0.048 Vali Loss: 3.969 Vali Acc: 0.280 Test Loss: 3.969 Test Acc: 0.280
Validation loss decreased (-0.278786 --> -0.279960).  Saving model ...
Epoch: 27 cost time: 0.9270811080932617
Epoch: 27, Steps: 10 | Train Loss: 0.043 Vali Loss: 4.005 Vali Acc: 0.281 Test Loss: 4.005 Test Acc: 0.281
Validation loss decreased (-0.279960 --> -0.281136).  Saving model ...
Epoch: 28 cost time: 0.8237171173095703
Epoch: 28, Steps: 10 | Train Loss: 0.037 Vali Loss: 4.049 Vali Acc: 0.276 Test Loss: 4.049 Test Acc: 0.276
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7485382556915283
Epoch: 29, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.101 Vali Acc: 0.286 Test Loss: 4.101 Test Acc: 0.286
Validation loss decreased (-0.281136 --> -0.285841).  Saving model ...
Epoch: 30 cost time: 0.842747688293457
Epoch: 30, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.148 Vali Acc: 0.285 Test Loss: 4.148 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.7010345458984375
Epoch: 31, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.184 Vali Acc: 0.282 Test Loss: 4.184 Test Acc: 0.282
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.8036985397338867
Epoch: 32, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.212 Vali Acc: 0.279 Test Loss: 4.212 Test Acc: 0.279
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.7107987403869629
Epoch: 33, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.243 Vali Acc: 0.280 Test Loss: 4.243 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.8885114192962646
Epoch: 34, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.254 Vali Acc: 0.280 Test Loss: 4.254 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.8749172687530518
Epoch: 35, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.287 Vali Acc: 0.279 Test Loss: 4.287 Test Acc: 0.279
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.8746159076690674
Epoch: 36, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.313 Vali Acc: 0.282 Test Loss: 4.313 Test Acc: 0.282
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.8142735958099365
Epoch: 37, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.324 Vali Acc: 0.286 Test Loss: 4.324 Test Acc: 0.286
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.7113232612609863
Epoch: 38, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.356 Vali Acc: 0.286 Test Loss: 4.356 Test Acc: 0.286
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.7020421028137207
Epoch: 39, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.380 Vali Acc: 0.282 Test Loss: 4.380 Test Acc: 0.282
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps23_str12_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2858823529411765
model parameter : 600090
model size : 2.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.9814958572387695
Epoch: 1, Steps: 10 | Train Loss: 3.326 Vali Loss: 3.275 Vali Acc: 0.034 Test Loss: 3.275 Test Acc: 0.034
Validation loss decreased (inf --> -0.034085).  Saving model ...
Epoch: 2 cost time: 0.822052001953125
Epoch: 2, Steps: 10 | Train Loss: 3.269 Vali Loss: 3.270 Vali Acc: 0.039 Test Loss: 3.270 Test Acc: 0.039
Validation loss decreased (-0.034085 --> -0.038791).  Saving model ...
Epoch: 3 cost time: 0.724294900894165
Epoch: 3, Steps: 10 | Train Loss: 3.181 Vali Loss: 3.256 Vali Acc: 0.051 Test Loss: 3.256 Test Acc: 0.051
Validation loss decreased (-0.038791 --> -0.050556).  Saving model ...
Epoch: 4 cost time: 0.7222263813018799
Epoch: 4, Steps: 10 | Train Loss: 3.071 Vali Loss: 3.241 Vali Acc: 0.066 Test Loss: 3.241 Test Acc: 0.066
Validation loss decreased (-0.050556 --> -0.065850).  Saving model ...
Epoch: 5 cost time: 0.8336713314056396
Epoch: 5, Steps: 10 | Train Loss: 2.953 Vali Loss: 3.228 Vali Acc: 0.096 Test Loss: 3.228 Test Acc: 0.096
Validation loss decreased (-0.065850 --> -0.096438).  Saving model ...
Epoch: 6 cost time: 0.8911054134368896
Epoch: 6, Steps: 10 | Train Loss: 2.798 Vali Loss: 3.219 Vali Acc: 0.107 Test Loss: 3.219 Test Acc: 0.107
Validation loss decreased (-0.096438 --> -0.107027).  Saving model ...
Epoch: 7 cost time: 0.8495340347290039
Epoch: 7, Steps: 10 | Train Loss: 2.676 Vali Loss: 3.212 Vali Acc: 0.107 Test Loss: 3.212 Test Acc: 0.107
Validation loss decreased (-0.107027 --> -0.107027).  Saving model ...
Epoch: 8 cost time: 0.8908777236938477
Epoch: 8, Steps: 10 | Train Loss: 2.511 Vali Loss: 3.204 Vali Acc: 0.121 Test Loss: 3.204 Test Acc: 0.121
Validation loss decreased (-0.107027 --> -0.121144).  Saving model ...
Epoch: 9 cost time: 0.8420627117156982
Epoch: 9, Steps: 10 | Train Loss: 2.343 Vali Loss: 3.200 Vali Acc: 0.127 Test Loss: 3.200 Test Acc: 0.127
Validation loss decreased (-0.121144 --> -0.127027).  Saving model ...
Epoch: 10 cost time: 0.8194713592529297
Epoch: 10, Steps: 10 | Train Loss: 2.191 Vali Loss: 3.192 Vali Acc: 0.141 Test Loss: 3.192 Test Acc: 0.141
Validation loss decreased (-0.127027 --> -0.141145).  Saving model ...
Epoch: 11 cost time: 0.9579217433929443
Epoch: 11, Steps: 10 | Train Loss: 1.979 Vali Loss: 3.178 Vali Acc: 0.161 Test Loss: 3.178 Test Acc: 0.161
Validation loss decreased (-0.141145 --> -0.161145).  Saving model ...
Epoch: 12 cost time: 0.8378636837005615
Epoch: 12, Steps: 10 | Train Loss: 1.773 Vali Loss: 3.175 Vali Acc: 0.173 Test Loss: 3.175 Test Acc: 0.173
Validation loss decreased (-0.161145 --> -0.172909).  Saving model ...
Epoch: 13 cost time: 0.9930496215820312
Epoch: 13, Steps: 10 | Train Loss: 1.541 Vali Loss: 3.172 Vali Acc: 0.191 Test Loss: 3.172 Test Acc: 0.191
Validation loss decreased (-0.172909 --> -0.190557).  Saving model ...
Epoch: 14 cost time: 0.873358964920044
Epoch: 14, Steps: 10 | Train Loss: 1.340 Vali Loss: 3.176 Vali Acc: 0.198 Test Loss: 3.176 Test Acc: 0.198
Validation loss decreased (-0.190557 --> -0.197615).  Saving model ...
Epoch: 15 cost time: 0.8633501529693604
Epoch: 15, Steps: 10 | Train Loss: 1.147 Vali Loss: 3.190 Vali Acc: 0.215 Test Loss: 3.190 Test Acc: 0.215
Validation loss decreased (-0.197615 --> -0.215262).  Saving model ...
Epoch: 16 cost time: 0.8919286727905273
Epoch: 16, Steps: 10 | Train Loss: 0.921 Vali Loss: 3.213 Vali Acc: 0.227 Test Loss: 3.213 Test Acc: 0.227
Validation loss decreased (-0.215262 --> -0.227027).  Saving model ...
Epoch: 17 cost time: 0.9397876262664795
Epoch: 17, Steps: 10 | Train Loss: 0.720 Vali Loss: 3.267 Vali Acc: 0.228 Test Loss: 3.267 Test Acc: 0.228
Validation loss decreased (-0.227027 --> -0.228203).  Saving model ...
Epoch: 18 cost time: 0.9487144947052002
Epoch: 18, Steps: 10 | Train Loss: 0.572 Vali Loss: 3.318 Vali Acc: 0.239 Test Loss: 3.318 Test Acc: 0.239
Validation loss decreased (-0.228203 --> -0.238790).  Saving model ...
Epoch: 19 cost time: 0.8872299194335938
Epoch: 19, Steps: 10 | Train Loss: 0.414 Vali Loss: 3.372 Vali Acc: 0.251 Test Loss: 3.372 Test Acc: 0.251
Validation loss decreased (-0.238790 --> -0.250555).  Saving model ...
Epoch: 20 cost time: 0.8853895664215088
Epoch: 20, Steps: 10 | Train Loss: 0.349 Vali Loss: 3.440 Vali Acc: 0.255 Test Loss: 3.440 Test Acc: 0.255
Validation loss decreased (-0.250555 --> -0.255260).  Saving model ...
Epoch: 21 cost time: 0.8070988655090332
Epoch: 21, Steps: 10 | Train Loss: 0.241 Vali Loss: 3.506 Vali Acc: 0.252 Test Loss: 3.506 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8302350044250488
Epoch: 22, Steps: 10 | Train Loss: 0.207 Vali Loss: 3.571 Vali Acc: 0.260 Test Loss: 3.571 Test Acc: 0.260
Validation loss decreased (-0.255260 --> -0.259964).  Saving model ...
Epoch: 23 cost time: 0.850351095199585
Epoch: 23, Steps: 10 | Train Loss: 0.145 Vali Loss: 3.619 Vali Acc: 0.256 Test Loss: 3.619 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8408381938934326
Epoch: 24, Steps: 10 | Train Loss: 0.114 Vali Loss: 3.679 Vali Acc: 0.259 Test Loss: 3.679 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.7763147354125977
Epoch: 25, Steps: 10 | Train Loss: 0.092 Vali Loss: 3.742 Vali Acc: 0.262 Test Loss: 3.742 Test Acc: 0.262
Validation loss decreased (-0.259964 --> -0.262316).  Saving model ...
Epoch: 26 cost time: 0.9190995693206787
Epoch: 26, Steps: 10 | Train Loss: 0.079 Vali Loss: 3.804 Vali Acc: 0.261 Test Loss: 3.804 Test Acc: 0.261
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8892271518707275
Epoch: 27, Steps: 10 | Train Loss: 0.068 Vali Loss: 3.834 Vali Acc: 0.262 Test Loss: 3.834 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.7540473937988281
Epoch: 28, Steps: 10 | Train Loss: 0.053 Vali Loss: 3.866 Vali Acc: 0.264 Test Loss: 3.866 Test Acc: 0.264
Validation loss decreased (-0.262316 --> -0.263491).  Saving model ...
Epoch: 29 cost time: 0.8283214569091797
Epoch: 29, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.932 Vali Acc: 0.265 Test Loss: 3.932 Test Acc: 0.265
Validation loss decreased (-0.263491 --> -0.264667).  Saving model ...
Epoch: 30 cost time: 0.8369207382202148
Epoch: 30, Steps: 10 | Train Loss: 0.041 Vali Loss: 3.956 Vali Acc: 0.267 Test Loss: 3.956 Test Acc: 0.267
Validation loss decreased (-0.264667 --> -0.267019).  Saving model ...
Epoch: 31 cost time: 0.8933372497558594
Epoch: 31, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.982 Vali Acc: 0.264 Test Loss: 3.982 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.8697381019592285
Epoch: 32, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.030 Vali Acc: 0.268 Test Loss: 4.030 Test Acc: 0.268
Validation loss decreased (-0.267019 --> -0.268195).  Saving model ...
Epoch: 33 cost time: 0.8802192211151123
Epoch: 33, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.074 Vali Acc: 0.269 Test Loss: 4.074 Test Acc: 0.269
Validation loss decreased (-0.268195 --> -0.269371).  Saving model ...
Epoch: 34 cost time: 0.7604091167449951
Epoch: 34, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.105 Vali Acc: 0.273 Test Loss: 4.105 Test Acc: 0.273
Validation loss decreased (-0.269371 --> -0.272900).  Saving model ...
Epoch: 35 cost time: 0.8603003025054932
Epoch: 35, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.147 Vali Acc: 0.271 Test Loss: 4.147 Test Acc: 0.271
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.7761654853820801
Epoch: 36, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.171 Vali Acc: 0.274 Test Loss: 4.171 Test Acc: 0.274
Validation loss decreased (-0.272900 --> -0.274076).  Saving model ...
Epoch: 37 cost time: 0.781907320022583
Epoch: 37, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.183 Vali Acc: 0.268 Test Loss: 4.183 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.78517746925354
Epoch: 38, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.222 Vali Acc: 0.268 Test Loss: 4.222 Test Acc: 0.268
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.8200104236602783
Epoch: 39, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.267 Vali Acc: 0.266 Test Loss: 4.267 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.831519365310669
Epoch: 40, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.300 Vali Acc: 0.269 Test Loss: 4.300 Test Acc: 0.269
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.8503260612487793
Epoch: 41, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.317 Vali Acc: 0.273 Test Loss: 4.317 Test Acc: 0.273
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.8566765785217285
Epoch: 42, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.334 Vali Acc: 0.274 Test Loss: 4.334 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.8597023487091064
Epoch: 43, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.369 Vali Acc: 0.274 Test Loss: 4.369 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.9254159927368164
Epoch: 44, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.403 Vali Acc: 0.266 Test Loss: 4.403 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.822012186050415
Epoch: 45, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.424 Vali Acc: 0.269 Test Loss: 4.424 Test Acc: 0.269
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 0.7741825580596924
Epoch: 46, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.432 Vali Acc: 0.271 Test Loss: 4.432 Test Acc: 0.271
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2741176470588235
model parameter : 590618
model size : 2.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps38_str19_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.0197925567626953
Epoch: 1, Steps: 10 | Train Loss: 3.266 Vali Loss: 3.263 Vali Acc: 0.045 Test Loss: 3.263 Test Acc: 0.045
Validation loss decreased (inf --> -0.044673).  Saving model ...
Epoch: 2 cost time: 0.7340497970581055
Epoch: 2, Steps: 10 | Train Loss: 3.204 Vali Loss: 3.259 Vali Acc: 0.047 Test Loss: 3.259 Test Acc: 0.047
Validation loss decreased (-0.044673 --> -0.047026).  Saving model ...
Epoch: 3 cost time: 0.7918848991394043
Epoch: 3, Steps: 10 | Train Loss: 3.124 Vali Loss: 3.251 Vali Acc: 0.061 Test Loss: 3.251 Test Acc: 0.061
Validation loss decreased (-0.047026 --> -0.061144).  Saving model ...
Epoch: 4 cost time: 0.7645633220672607
Epoch: 4, Steps: 10 | Train Loss: 3.035 Vali Loss: 3.240 Vali Acc: 0.081 Test Loss: 3.240 Test Acc: 0.081
Validation loss decreased (-0.061144 --> -0.081144).  Saving model ...
Epoch: 5 cost time: 0.9107213020324707
Epoch: 5, Steps: 10 | Train Loss: 2.936 Vali Loss: 3.230 Vali Acc: 0.099 Test Loss: 3.230 Test Acc: 0.099
Validation loss decreased (-0.081144 --> -0.098791).  Saving model ...
Epoch: 6 cost time: 0.8830235004425049
Epoch: 6, Steps: 10 | Train Loss: 2.826 Vali Loss: 3.222 Vali Acc: 0.105 Test Loss: 3.222 Test Acc: 0.105
Validation loss decreased (-0.098791 --> -0.104674).  Saving model ...
Epoch: 7 cost time: 0.8769776821136475
Epoch: 7, Steps: 10 | Train Loss: 2.679 Vali Loss: 3.213 Vali Acc: 0.119 Test Loss: 3.213 Test Acc: 0.119
Validation loss decreased (-0.104674 --> -0.118791).  Saving model ...
Epoch: 8 cost time: 0.735581636428833
Epoch: 8, Steps: 10 | Train Loss: 2.533 Vali Loss: 3.207 Vali Acc: 0.128 Test Loss: 3.207 Test Acc: 0.128
Validation loss decreased (-0.118791 --> -0.128203).  Saving model ...
Epoch: 9 cost time: 0.8625774383544922
Epoch: 9, Steps: 10 | Train Loss: 2.369 Vali Loss: 3.201 Vali Acc: 0.136 Test Loss: 3.201 Test Acc: 0.136
Validation loss decreased (-0.128203 --> -0.136439).  Saving model ...
Epoch: 10 cost time: 0.8170440196990967
Epoch: 10, Steps: 10 | Train Loss: 2.221 Vali Loss: 3.202 Vali Acc: 0.145 Test Loss: 3.202 Test Acc: 0.145
Validation loss decreased (-0.136439 --> -0.144674).  Saving model ...
Epoch: 11 cost time: 0.7368919849395752
Epoch: 11, Steps: 10 | Train Loss: 2.027 Vali Loss: 3.200 Vali Acc: 0.159 Test Loss: 3.200 Test Acc: 0.159
Validation loss decreased (-0.144674 --> -0.158792).  Saving model ...
Epoch: 12 cost time: 0.7294156551361084
Epoch: 12, Steps: 10 | Train Loss: 1.875 Vali Loss: 3.203 Vali Acc: 0.158 Test Loss: 3.203 Test Acc: 0.158
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7211775779724121
Epoch: 13, Steps: 10 | Train Loss: 1.655 Vali Loss: 3.207 Vali Acc: 0.165 Test Loss: 3.207 Test Acc: 0.165
Validation loss decreased (-0.158792 --> -0.164674).  Saving model ...
Epoch: 14 cost time: 0.6933329105377197
Epoch: 14, Steps: 10 | Train Loss: 1.496 Vali Loss: 3.228 Vali Acc: 0.173 Test Loss: 3.228 Test Acc: 0.173
Validation loss decreased (-0.164674 --> -0.172909).  Saving model ...
Epoch: 15 cost time: 0.8062500953674316
Epoch: 15, Steps: 10 | Train Loss: 1.323 Vali Loss: 3.234 Vali Acc: 0.189 Test Loss: 3.234 Test Acc: 0.189
Validation loss decreased (-0.172909 --> -0.189379).  Saving model ...
Epoch: 16 cost time: 0.6443848609924316
Epoch: 16, Steps: 10 | Train Loss: 1.121 Vali Loss: 3.255 Vali Acc: 0.208 Test Loss: 3.255 Test Acc: 0.208
Validation loss decreased (-0.189379 --> -0.208203).  Saving model ...
Epoch: 17 cost time: 0.7999029159545898
Epoch: 17, Steps: 10 | Train Loss: 0.955 Vali Loss: 3.284 Vali Acc: 0.226 Test Loss: 3.284 Test Acc: 0.226
Validation loss decreased (-0.208203 --> -0.225850).  Saving model ...
Epoch: 18 cost time: 0.7740869522094727
Epoch: 18, Steps: 10 | Train Loss: 0.770 Vali Loss: 3.324 Vali Acc: 0.235 Test Loss: 3.324 Test Acc: 0.235
Validation loss decreased (-0.225850 --> -0.235261).  Saving model ...
Epoch: 19 cost time: 0.8066473007202148
Epoch: 19, Steps: 10 | Train Loss: 0.616 Vali Loss: 3.373 Vali Acc: 0.239 Test Loss: 3.373 Test Acc: 0.239
Validation loss decreased (-0.235261 --> -0.238790).  Saving model ...
Epoch: 20 cost time: 0.7272756099700928
Epoch: 20, Steps: 10 | Train Loss: 0.485 Vali Loss: 3.443 Vali Acc: 0.239 Test Loss: 3.443 Test Acc: 0.239
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7923176288604736
Epoch: 21, Steps: 10 | Train Loss: 0.396 Vali Loss: 3.510 Vali Acc: 0.238 Test Loss: 3.510 Test Acc: 0.238
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.822026252746582
Epoch: 22, Steps: 10 | Train Loss: 0.298 Vali Loss: 3.569 Vali Acc: 0.252 Test Loss: 3.569 Test Acc: 0.252
Validation loss decreased (-0.238790 --> -0.251729).  Saving model ...
Epoch: 23 cost time: 0.8136172294616699
Epoch: 23, Steps: 10 | Train Loss: 0.250 Vali Loss: 3.627 Vali Acc: 0.253 Test Loss: 3.627 Test Acc: 0.253
Validation loss decreased (-0.251729 --> -0.252905).  Saving model ...
Epoch: 24 cost time: 0.8113067150115967
Epoch: 24, Steps: 10 | Train Loss: 0.194 Vali Loss: 3.701 Vali Acc: 0.249 Test Loss: 3.701 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6175003051757812
Epoch: 25, Steps: 10 | Train Loss: 0.145 Vali Loss: 3.746 Vali Acc: 0.261 Test Loss: 3.746 Test Acc: 0.261
Validation loss decreased (-0.252905 --> -0.261139).  Saving model ...
Epoch: 26 cost time: 0.8355419635772705
Epoch: 26, Steps: 10 | Train Loss: 0.118 Vali Loss: 3.815 Vali Acc: 0.255 Test Loss: 3.815 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8274896144866943
Epoch: 27, Steps: 10 | Train Loss: 0.107 Vali Loss: 3.878 Vali Acc: 0.259 Test Loss: 3.878 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.8479785919189453
Epoch: 28, Steps: 10 | Train Loss: 0.080 Vali Loss: 3.921 Vali Acc: 0.261 Test Loss: 3.921 Test Acc: 0.261
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.8623459339141846
Epoch: 29, Steps: 10 | Train Loss: 0.071 Vali Loss: 3.961 Vali Acc: 0.266 Test Loss: 3.961 Test Acc: 0.266
Validation loss decreased (-0.261139 --> -0.265843).  Saving model ...
Epoch: 30 cost time: 0.7610287666320801
Epoch: 30, Steps: 10 | Train Loss: 0.066 Vali Loss: 4.021 Vali Acc: 0.271 Test Loss: 4.021 Test Acc: 0.271
Validation loss decreased (-0.265843 --> -0.270548).  Saving model ...
Epoch: 31 cost time: 0.7100925445556641
Epoch: 31, Steps: 10 | Train Loss: 0.053 Vali Loss: 4.066 Vali Acc: 0.274 Test Loss: 4.066 Test Acc: 0.274
Validation loss decreased (-0.270548 --> -0.274077).  Saving model ...
Epoch: 32 cost time: 0.8919188976287842
Epoch: 32, Steps: 10 | Train Loss: 0.047 Vali Loss: 4.094 Vali Acc: 0.269 Test Loss: 4.094 Test Acc: 0.269
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.846564531326294
Epoch: 33, Steps: 10 | Train Loss: 0.044 Vali Loss: 4.138 Vali Acc: 0.271 Test Loss: 4.138 Test Acc: 0.271
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.7835114002227783
Epoch: 34, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.169 Vali Acc: 0.272 Test Loss: 4.169 Test Acc: 0.272
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.7833254337310791
Epoch: 35, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.203 Vali Acc: 0.272 Test Loss: 4.203 Test Acc: 0.272
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.8097207546234131
Epoch: 36, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.224 Vali Acc: 0.274 Test Loss: 4.224 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.734760046005249
Epoch: 37, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.257 Vali Acc: 0.273 Test Loss: 4.257 Test Acc: 0.273
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.848341703414917
Epoch: 38, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.298 Vali Acc: 0.274 Test Loss: 4.298 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.8226475715637207
Epoch: 39, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.321 Vali Acc: 0.271 Test Loss: 4.321 Test Acc: 0.271
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.7800309658050537
Epoch: 40, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.370 Vali Acc: 0.267 Test Loss: 4.370 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.8216872215270996
Epoch: 41, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.405 Vali Acc: 0.272 Test Loss: 4.405 Test Acc: 0.272
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps38_str19_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2741176470588235
model parameter : 581082
model size : 2.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.21577525138855
Epoch: 1, Steps: 10 | Train Loss: 3.263 Vali Loss: 3.253 Vali Acc: 0.048 Test Loss: 3.253 Test Acc: 0.048
Validation loss decreased (inf --> -0.048203).  Saving model ...
Epoch: 2 cost time: 0.8234097957611084
Epoch: 2, Steps: 10 | Train Loss: 3.124 Vali Loss: 3.235 Vali Acc: 0.064 Test Loss: 3.235 Test Acc: 0.064
Validation loss decreased (-0.048203 --> -0.063497).  Saving model ...
Epoch: 3 cost time: 0.8345253467559814
Epoch: 3, Steps: 10 | Train Loss: 2.928 Vali Loss: 3.226 Vali Acc: 0.082 Test Loss: 3.226 Test Acc: 0.082
Validation loss decreased (-0.063497 --> -0.082321).  Saving model ...
Epoch: 4 cost time: 0.8237502574920654
Epoch: 4, Steps: 10 | Train Loss: 2.678 Vali Loss: 3.218 Vali Acc: 0.101 Test Loss: 3.218 Test Acc: 0.101
Validation loss decreased (-0.082321 --> -0.101144).  Saving model ...
Epoch: 5 cost time: 0.826791524887085
Epoch: 5, Steps: 10 | Train Loss: 2.339 Vali Loss: 3.197 Vali Acc: 0.125 Test Loss: 3.197 Test Acc: 0.125
Validation loss decreased (-0.101144 --> -0.124674).  Saving model ...
Epoch: 6 cost time: 0.7792842388153076
Epoch: 6, Steps: 10 | Train Loss: 2.040 Vali Loss: 3.181 Vali Acc: 0.153 Test Loss: 3.181 Test Acc: 0.153
Validation loss decreased (-0.124674 --> -0.152909).  Saving model ...
Epoch: 7 cost time: 0.8737406730651855
Epoch: 7, Steps: 10 | Train Loss: 1.590 Vali Loss: 3.165 Vali Acc: 0.179 Test Loss: 3.165 Test Acc: 0.179
Validation loss decreased (-0.152909 --> -0.178792).  Saving model ...
Epoch: 8 cost time: 0.8309104442596436
Epoch: 8, Steps: 10 | Train Loss: 1.222 Vali Loss: 3.197 Vali Acc: 0.195 Test Loss: 3.197 Test Acc: 0.195
Validation loss decreased (-0.178792 --> -0.195262).  Saving model ...
Epoch: 9 cost time: 0.8408877849578857
Epoch: 9, Steps: 10 | Train Loss: 0.822 Vali Loss: 3.277 Vali Acc: 0.222 Test Loss: 3.277 Test Acc: 0.222
Validation loss decreased (-0.195262 --> -0.222320).  Saving model ...
Epoch: 10 cost time: 0.8469562530517578
Epoch: 10, Steps: 10 | Train Loss: 0.542 Vali Loss: 3.362 Vali Acc: 0.238 Test Loss: 3.362 Test Acc: 0.238
Validation loss decreased (-0.222320 --> -0.237613).  Saving model ...
Epoch: 11 cost time: 0.8772492408752441
Epoch: 11, Steps: 10 | Train Loss: 0.331 Vali Loss: 3.527 Vali Acc: 0.252 Test Loss: 3.527 Test Acc: 0.252
Validation loss decreased (-0.237613 --> -0.251729).  Saving model ...
Epoch: 12 cost time: 0.803624153137207
Epoch: 12, Steps: 10 | Train Loss: 0.193 Vali Loss: 3.717 Vali Acc: 0.255 Test Loss: 3.717 Test Acc: 0.255
Validation loss decreased (-0.251729 --> -0.255257).  Saving model ...
Epoch: 13 cost time: 0.7733035087585449
Epoch: 13, Steps: 10 | Train Loss: 0.109 Vali Loss: 3.916 Vali Acc: 0.253 Test Loss: 3.916 Test Acc: 0.253
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8263065814971924
Epoch: 14, Steps: 10 | Train Loss: 0.063 Vali Loss: 3.990 Vali Acc: 0.264 Test Loss: 3.990 Test Acc: 0.264
Validation loss decreased (-0.255257 --> -0.263490).  Saving model ...
Epoch: 15 cost time: 0.8817548751831055
Epoch: 15, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.092 Vali Acc: 0.279 Test Loss: 4.092 Test Acc: 0.279
Validation loss decreased (-0.263490 --> -0.278783).  Saving model ...
Epoch: 16 cost time: 0.9464316368103027
Epoch: 16, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.196 Vali Acc: 0.278 Test Loss: 4.196 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8442978858947754
Epoch: 17, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.276 Vali Acc: 0.275 Test Loss: 4.276 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7581608295440674
Epoch: 18, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.335 Vali Acc: 0.281 Test Loss: 4.335 Test Acc: 0.281
Validation loss decreased (-0.278783 --> -0.281133).  Saving model ...
Epoch: 19 cost time: 0.7529997825622559
Epoch: 19, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.380 Vali Acc: 0.279 Test Loss: 4.380 Test Acc: 0.279
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7141125202178955
Epoch: 20, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.404 Vali Acc: 0.281 Test Loss: 4.404 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.8644957542419434
Epoch: 21, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.432 Vali Acc: 0.282 Test Loss: 4.432 Test Acc: 0.282
Validation loss decreased (-0.281133 --> -0.282309).  Saving model ...
Epoch: 22 cost time: 0.8860430717468262
Epoch: 22, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.480 Vali Acc: 0.281 Test Loss: 4.480 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.874669075012207
Epoch: 23, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.523 Vali Acc: 0.282 Test Loss: 4.523 Test Acc: 0.282
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.8819115161895752
Epoch: 24, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.569 Vali Acc: 0.281 Test Loss: 4.569 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.826575517654419
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.607 Vali Acc: 0.279 Test Loss: 4.607 Test Acc: 0.279
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.6946742534637451
Epoch: 26, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.632 Vali Acc: 0.282 Test Loss: 4.632 Test Acc: 0.282
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.9467105865478516
Epoch: 27, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.670 Vali Acc: 0.282 Test Loss: 4.670 Test Acc: 0.282
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.8088600635528564
Epoch: 28, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.700 Vali Acc: 0.281 Test Loss: 4.700 Test Acc: 0.281
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.8965821266174316
Epoch: 29, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.727 Vali Acc: 0.279 Test Loss: 4.727 Test Acc: 0.279
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.7711465358734131
Epoch: 30, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.752 Vali Acc: 0.279 Test Loss: 4.752 Test Acc: 0.279
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.6598825454711914
Epoch: 31, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.786 Vali Acc: 0.280 Test Loss: 4.786 Test Acc: 0.280
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2823529411764706
model parameter : 332218
model size : 1.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.9271759986877441
Epoch: 1, Steps: 10 | Train Loss: 3.290 Vali Loss: 3.262 Vali Acc: 0.041 Test Loss: 3.262 Test Acc: 0.041
Validation loss decreased (inf --> -0.041144).  Saving model ...
Epoch: 2 cost time: 0.7578253746032715
Epoch: 2, Steps: 10 | Train Loss: 3.199 Vali Loss: 3.248 Vali Acc: 0.049 Test Loss: 3.248 Test Acc: 0.049
Validation loss decreased (-0.041144 --> -0.049379).  Saving model ...
Epoch: 3 cost time: 0.7226016521453857
Epoch: 3, Steps: 10 | Train Loss: 3.075 Vali Loss: 3.235 Vali Acc: 0.062 Test Loss: 3.235 Test Acc: 0.062
Validation loss decreased (-0.049379 --> -0.062321).  Saving model ...
Epoch: 4 cost time: 0.7040853500366211
Epoch: 4, Steps: 10 | Train Loss: 2.901 Vali Loss: 3.226 Vali Acc: 0.068 Test Loss: 3.226 Test Acc: 0.068
Validation loss decreased (-0.062321 --> -0.068203).  Saving model ...
Epoch: 5 cost time: 0.7070870399475098
Epoch: 5, Steps: 10 | Train Loss: 2.729 Vali Loss: 3.219 Vali Acc: 0.085 Test Loss: 3.219 Test Acc: 0.085
Validation loss decreased (-0.068203 --> -0.084674).  Saving model ...
Epoch: 6 cost time: 0.6962175369262695
Epoch: 6, Steps: 10 | Train Loss: 2.539 Vali Loss: 3.203 Vali Acc: 0.107 Test Loss: 3.203 Test Acc: 0.107
Validation loss decreased (-0.084674 --> -0.107027).  Saving model ...
Epoch: 7 cost time: 0.7250523567199707
Epoch: 7, Steps: 10 | Train Loss: 2.292 Vali Loss: 3.188 Vali Acc: 0.132 Test Loss: 3.188 Test Acc: 0.132
Validation loss decreased (-0.107027 --> -0.131733).  Saving model ...
Epoch: 8 cost time: 0.7065727710723877
Epoch: 8, Steps: 10 | Train Loss: 2.069 Vali Loss: 3.174 Vali Acc: 0.156 Test Loss: 3.174 Test Acc: 0.156
Validation loss decreased (-0.131733 --> -0.156439).  Saving model ...
Epoch: 9 cost time: 0.7452542781829834
Epoch: 9, Steps: 10 | Train Loss: 1.769 Vali Loss: 3.170 Vali Acc: 0.171 Test Loss: 3.170 Test Acc: 0.171
Validation loss decreased (-0.156439 --> -0.170557).  Saving model ...
Epoch: 10 cost time: 0.7051000595092773
Epoch: 10, Steps: 10 | Train Loss: 1.532 Vali Loss: 3.179 Vali Acc: 0.174 Test Loss: 3.179 Test Acc: 0.174
Validation loss decreased (-0.170557 --> -0.174086).  Saving model ...
Epoch: 11 cost time: 0.7729284763336182
Epoch: 11, Steps: 10 | Train Loss: 1.220 Vali Loss: 3.201 Vali Acc: 0.200 Test Loss: 3.201 Test Acc: 0.200
Validation loss decreased (-0.174086 --> -0.199968).  Saving model ...
Epoch: 12 cost time: 0.7092592716217041
Epoch: 12, Steps: 10 | Train Loss: 0.982 Vali Loss: 3.246 Vali Acc: 0.221 Test Loss: 3.246 Test Acc: 0.221
Validation loss decreased (-0.199968 --> -0.221144).  Saving model ...
Epoch: 13 cost time: 0.8498661518096924
Epoch: 13, Steps: 10 | Train Loss: 0.735 Vali Loss: 3.312 Vali Acc: 0.233 Test Loss: 3.312 Test Acc: 0.233
Validation loss decreased (-0.221144 --> -0.232908).  Saving model ...
Epoch: 14 cost time: 0.7986490726470947
Epoch: 14, Steps: 10 | Train Loss: 0.555 Vali Loss: 3.373 Vali Acc: 0.244 Test Loss: 3.373 Test Acc: 0.244
Validation loss decreased (-0.232908 --> -0.243496).  Saving model ...
Epoch: 15 cost time: 0.7632238864898682
Epoch: 15, Steps: 10 | Train Loss: 0.389 Vali Loss: 3.485 Vali Acc: 0.251 Test Loss: 3.485 Test Acc: 0.251
Validation loss decreased (-0.243496 --> -0.250553).  Saving model ...
Epoch: 16 cost time: 0.7465388774871826
Epoch: 16, Steps: 10 | Train Loss: 0.284 Vali Loss: 3.616 Vali Acc: 0.261 Test Loss: 3.616 Test Acc: 0.261
Validation loss decreased (-0.250553 --> -0.261140).  Saving model ...
Epoch: 17 cost time: 0.6891305446624756
Epoch: 17, Steps: 10 | Train Loss: 0.197 Vali Loss: 3.746 Vali Acc: 0.262 Test Loss: 3.746 Test Acc: 0.262
Validation loss decreased (-0.261140 --> -0.262315).  Saving model ...
Epoch: 18 cost time: 0.7940816879272461
Epoch: 18, Steps: 10 | Train Loss: 0.140 Vali Loss: 3.827 Vali Acc: 0.255 Test Loss: 3.827 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.680396318435669
Epoch: 19, Steps: 10 | Train Loss: 0.103 Vali Loss: 3.933 Vali Acc: 0.266 Test Loss: 3.933 Test Acc: 0.266
Validation loss decreased (-0.262315 --> -0.265843).  Saving model ...
Epoch: 20 cost time: 0.7678685188293457
Epoch: 20, Steps: 10 | Train Loss: 0.083 Vali Loss: 4.021 Vali Acc: 0.267 Test Loss: 4.021 Test Acc: 0.267
Validation loss decreased (-0.265843 --> -0.267019).  Saving model ...
Epoch: 21 cost time: 0.8739657402038574
Epoch: 21, Steps: 10 | Train Loss: 0.057 Vali Loss: 4.104 Vali Acc: 0.256 Test Loss: 4.104 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8729732036590576
Epoch: 22, Steps: 10 | Train Loss: 0.047 Vali Loss: 4.156 Vali Acc: 0.261 Test Loss: 4.156 Test Acc: 0.261
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.9608733654022217
Epoch: 23, Steps: 10 | Train Loss: 0.037 Vali Loss: 4.196 Vali Acc: 0.268 Test Loss: 4.196 Test Acc: 0.268
Validation loss decreased (-0.267019 --> -0.268193).  Saving model ...
Epoch: 24 cost time: 0.8486783504486084
Epoch: 24, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.257 Vali Acc: 0.267 Test Loss: 4.257 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7705018520355225
Epoch: 25, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.317 Vali Acc: 0.269 Test Loss: 4.317 Test Acc: 0.269
Validation loss decreased (-0.268193 --> -0.269369).  Saving model ...
Epoch: 26 cost time: 0.7927899360656738
Epoch: 26, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.360 Vali Acc: 0.275 Test Loss: 4.360 Test Acc: 0.275
Validation loss decreased (-0.269369 --> -0.275251).  Saving model ...
Epoch: 27 cost time: 0.9761121273040771
Epoch: 27, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.402 Vali Acc: 0.272 Test Loss: 4.402 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8720898628234863
Epoch: 28, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.441 Vali Acc: 0.272 Test Loss: 4.441 Test Acc: 0.272
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.8194172382354736
Epoch: 29, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.484 Vali Acc: 0.268 Test Loss: 4.484 Test Acc: 0.268
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.9031994342803955
Epoch: 30, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.529 Vali Acc: 0.275 Test Loss: 4.529 Test Acc: 0.275
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.9272089004516602
Epoch: 31, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.564 Vali Acc: 0.275 Test Loss: 4.564 Test Acc: 0.275
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.863701581954956
Epoch: 32, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.594 Vali Acc: 0.273 Test Loss: 4.594 Test Acc: 0.273
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.8115196228027344
Epoch: 33, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.615 Vali Acc: 0.268 Test Loss: 4.615 Test Acc: 0.268
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.8545684814453125
Epoch: 34, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.646 Vali Acc: 0.268 Test Loss: 4.646 Test Acc: 0.268
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.8892977237701416
Epoch: 35, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.677 Vali Acc: 0.266 Test Loss: 4.677 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.7980237007141113
Epoch: 36, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.713 Vali Acc: 0.266 Test Loss: 4.713 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2752941176470588
model parameter : 237498
model size : 0.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps12_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.9710395336151123
Epoch: 1, Steps: 10 | Train Loss: 3.313 Vali Loss: 3.268 Vali Acc: 0.028 Test Loss: 3.268 Test Acc: 0.028
Validation loss decreased (inf --> -0.028203).  Saving model ...
Epoch: 2 cost time: 0.8390216827392578
Epoch: 2, Steps: 10 | Train Loss: 3.244 Vali Loss: 3.262 Vali Acc: 0.041 Test Loss: 3.262 Test Acc: 0.041
Validation loss decreased (-0.028203 --> -0.041144).  Saving model ...
Epoch: 3 cost time: 0.7748160362243652
Epoch: 3, Steps: 10 | Train Loss: 3.153 Vali Loss: 3.252 Vali Acc: 0.062 Test Loss: 3.252 Test Acc: 0.062
Validation loss decreased (-0.041144 --> -0.062320).  Saving model ...
Epoch: 4 cost time: 0.622157096862793
Epoch: 4, Steps: 10 | Train Loss: 3.051 Vali Loss: 3.244 Vali Acc: 0.068 Test Loss: 3.244 Test Acc: 0.068
Validation loss decreased (-0.062320 --> -0.068203).  Saving model ...
Epoch: 5 cost time: 0.6165437698364258
Epoch: 5, Steps: 10 | Train Loss: 2.914 Vali Loss: 3.236 Vali Acc: 0.084 Test Loss: 3.236 Test Acc: 0.084
Validation loss decreased (-0.068203 --> -0.083497).  Saving model ...
Epoch: 6 cost time: 0.612241268157959
Epoch: 6, Steps: 10 | Train Loss: 2.752 Vali Loss: 3.227 Vali Acc: 0.095 Test Loss: 3.227 Test Acc: 0.095
Validation loss decreased (-0.083497 --> -0.095262).  Saving model ...
Epoch: 7 cost time: 0.5594558715820312
Epoch: 7, Steps: 10 | Train Loss: 2.622 Vali Loss: 3.222 Vali Acc: 0.096 Test Loss: 3.222 Test Acc: 0.096
Validation loss decreased (-0.095262 --> -0.096438).  Saving model ...
Epoch: 8 cost time: 0.6500654220581055
Epoch: 8, Steps: 10 | Train Loss: 2.438 Vali Loss: 3.210 Vali Acc: 0.119 Test Loss: 3.210 Test Acc: 0.119
Validation loss decreased (-0.096438 --> -0.118791).  Saving model ...
Epoch: 9 cost time: 0.6684067249298096
Epoch: 9, Steps: 10 | Train Loss: 2.246 Vali Loss: 3.198 Vali Acc: 0.134 Test Loss: 3.198 Test Acc: 0.134
Validation loss decreased (-0.118791 --> -0.134086).  Saving model ...
Epoch: 10 cost time: 0.7252779006958008
Epoch: 10, Steps: 10 | Train Loss: 2.037 Vali Loss: 3.187 Vali Acc: 0.140 Test Loss: 3.187 Test Acc: 0.140
Validation loss decreased (-0.134086 --> -0.139968).  Saving model ...
Epoch: 11 cost time: 0.7011198997497559
Epoch: 11, Steps: 10 | Train Loss: 1.785 Vali Loss: 3.177 Vali Acc: 0.156 Test Loss: 3.177 Test Acc: 0.156
Validation loss decreased (-0.139968 --> -0.156439).  Saving model ...
Epoch: 12 cost time: 0.8016238212585449
Epoch: 12, Steps: 10 | Train Loss: 1.548 Vali Loss: 3.179 Vali Acc: 0.176 Test Loss: 3.179 Test Acc: 0.176
Validation loss decreased (-0.156439 --> -0.176439).  Saving model ...
Epoch: 13 cost time: 0.7452986240386963
Epoch: 13, Steps: 10 | Train Loss: 1.311 Vali Loss: 3.196 Vali Acc: 0.188 Test Loss: 3.196 Test Acc: 0.188
Validation loss decreased (-0.176439 --> -0.188203).  Saving model ...
Epoch: 14 cost time: 0.7745027542114258
Epoch: 14, Steps: 10 | Train Loss: 1.103 Vali Loss: 3.220 Vali Acc: 0.204 Test Loss: 3.220 Test Acc: 0.204
Validation loss decreased (-0.188203 --> -0.203497).  Saving model ...
Epoch: 15 cost time: 0.7953295707702637
Epoch: 15, Steps: 10 | Train Loss: 0.888 Vali Loss: 3.248 Vali Acc: 0.209 Test Loss: 3.248 Test Acc: 0.209
Validation loss decreased (-0.203497 --> -0.209379).  Saving model ...
Epoch: 16 cost time: 0.7140176296234131
Epoch: 16, Steps: 10 | Train Loss: 0.690 Vali Loss: 3.304 Vali Acc: 0.220 Test Loss: 3.304 Test Acc: 0.220
Validation loss decreased (-0.209379 --> -0.219967).  Saving model ...
Epoch: 17 cost time: 0.6900382041931152
Epoch: 17, Steps: 10 | Train Loss: 0.535 Vali Loss: 3.371 Vali Acc: 0.221 Test Loss: 3.371 Test Acc: 0.221
Validation loss decreased (-0.219967 --> -0.221143).  Saving model ...
Epoch: 18 cost time: 0.6966333389282227
Epoch: 18, Steps: 10 | Train Loss: 0.412 Vali Loss: 3.458 Vali Acc: 0.234 Test Loss: 3.458 Test Acc: 0.234
Validation loss decreased (-0.221143 --> -0.234083).  Saving model ...
Epoch: 19 cost time: 0.7591257095336914
Epoch: 19, Steps: 10 | Train Loss: 0.304 Vali Loss: 3.537 Vali Acc: 0.242 Test Loss: 3.537 Test Acc: 0.242
Validation loss decreased (-0.234083 --> -0.242318).  Saving model ...
Epoch: 20 cost time: 0.6719646453857422
Epoch: 20, Steps: 10 | Train Loss: 0.231 Vali Loss: 3.599 Vali Acc: 0.244 Test Loss: 3.599 Test Acc: 0.244
Validation loss decreased (-0.242318 --> -0.243493).  Saving model ...
Epoch: 21 cost time: 0.7028446197509766
Epoch: 21, Steps: 10 | Train Loss: 0.173 Vali Loss: 3.704 Vali Acc: 0.232 Test Loss: 3.704 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.64896559715271
Epoch: 22, Steps: 10 | Train Loss: 0.123 Vali Loss: 3.770 Vali Acc: 0.244 Test Loss: 3.770 Test Acc: 0.244
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.7406678199768066
Epoch: 23, Steps: 10 | Train Loss: 0.116 Vali Loss: 3.835 Vali Acc: 0.241 Test Loss: 3.835 Test Acc: 0.241
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.7205946445465088
Epoch: 24, Steps: 10 | Train Loss: 0.082 Vali Loss: 3.894 Vali Acc: 0.246 Test Loss: 3.894 Test Acc: 0.246
Validation loss decreased (-0.243493 --> -0.245843).  Saving model ...
Epoch: 25 cost time: 0.7414448261260986
Epoch: 25, Steps: 10 | Train Loss: 0.074 Vali Loss: 3.949 Vali Acc: 0.246 Test Loss: 3.949 Test Acc: 0.246
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.772233247756958
Epoch: 26, Steps: 10 | Train Loss: 0.054 Vali Loss: 3.987 Vali Acc: 0.251 Test Loss: 3.987 Test Acc: 0.251
Validation loss decreased (-0.245843 --> -0.250548).  Saving model ...
Epoch: 27 cost time: 0.748715877532959
Epoch: 27, Steps: 10 | Train Loss: 0.052 Vali Loss: 4.035 Vali Acc: 0.252 Test Loss: 4.035 Test Acc: 0.252
Validation loss decreased (-0.250548 --> -0.251724).  Saving model ...
Epoch: 28 cost time: 0.6325826644897461
Epoch: 28, Steps: 10 | Train Loss: 0.043 Vali Loss: 4.095 Vali Acc: 0.252 Test Loss: 4.095 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6542062759399414
Epoch: 29, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.127 Vali Acc: 0.255 Test Loss: 4.127 Test Acc: 0.255
Validation loss decreased (-0.251724 --> -0.255253).  Saving model ...
Epoch: 30 cost time: 0.7108945846557617
Epoch: 30, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.173 Vali Acc: 0.255 Test Loss: 4.173 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.9122273921966553
Epoch: 31, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.227 Vali Acc: 0.249 Test Loss: 4.227 Test Acc: 0.249
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.8721652030944824
Epoch: 32, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.261 Vali Acc: 0.249 Test Loss: 4.261 Test Acc: 0.249
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.884833574295044
Epoch: 33, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.300 Vali Acc: 0.252 Test Loss: 4.300 Test Acc: 0.252
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.8830547332763672
Epoch: 34, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.314 Vali Acc: 0.253 Test Loss: 4.314 Test Acc: 0.253
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.8845293521881104
Epoch: 35, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.344 Vali Acc: 0.252 Test Loss: 4.344 Test Acc: 0.252
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.8333141803741455
Epoch: 36, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.373 Vali Acc: 0.252 Test Loss: 4.373 Test Acc: 0.252
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.8007369041442871
Epoch: 37, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.421 Vali Acc: 0.260 Test Loss: 4.421 Test Acc: 0.260
Validation loss decreased (-0.255253 --> -0.259956).  Saving model ...
Epoch: 38 cost time: 0.8389065265655518
Epoch: 38, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.451 Vali Acc: 0.260 Test Loss: 4.451 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.860004186630249
Epoch: 39, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.474 Vali Acc: 0.258 Test Loss: 4.474 Test Acc: 0.258
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.8993453979492188
Epoch: 40, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.508 Vali Acc: 0.258 Test Loss: 4.508 Test Acc: 0.258
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.8139584064483643
Epoch: 41, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.539 Vali Acc: 0.255 Test Loss: 4.539 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.8040211200714111
Epoch: 42, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.553 Vali Acc: 0.258 Test Loss: 4.553 Test Acc: 0.258
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.6517255306243896
Epoch: 43, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.574 Vali Acc: 0.260 Test Loss: 4.574 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.8387763500213623
Epoch: 44, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.617 Vali Acc: 0.260 Test Loss: 4.617 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.80267333984375
Epoch: 45, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.648 Vali Acc: 0.259 Test Loss: 4.648 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.7774574756622314
Epoch: 46, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.674 Vali Acc: 0.259 Test Loss: 4.674 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.8012092113494873
Epoch: 47, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.708 Vali Acc: 0.258 Test Loss: 4.708 Test Acc: 0.258
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps12_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26
model parameter : 207674
model size : 0.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.9124138355255127
Epoch: 1, Steps: 10 | Train Loss: 3.289 Vali Loss: 3.272 Vali Acc: 0.053 Test Loss: 3.272 Test Acc: 0.053
Validation loss decreased (inf --> -0.052908).  Saving model ...
Epoch: 2 cost time: 0.6794931888580322
Epoch: 2, Steps: 10 | Train Loss: 3.225 Vali Loss: 3.269 Vali Acc: 0.056 Test Loss: 3.269 Test Acc: 0.056
Validation loss decreased (-0.052908 --> -0.056438).  Saving model ...
Epoch: 3 cost time: 0.77675461769104
Epoch: 3, Steps: 10 | Train Loss: 3.139 Vali Loss: 3.261 Vali Acc: 0.060 Test Loss: 3.261 Test Acc: 0.060
Validation loss decreased (-0.056438 --> -0.059967).  Saving model ...
Epoch: 4 cost time: 0.7976424694061279
Epoch: 4, Steps: 10 | Train Loss: 3.067 Vali Loss: 3.252 Vali Acc: 0.078 Test Loss: 3.252 Test Acc: 0.078
Validation loss decreased (-0.059967 --> -0.077615).  Saving model ...
Epoch: 5 cost time: 0.8348877429962158
Epoch: 5, Steps: 10 | Train Loss: 2.978 Vali Loss: 3.244 Vali Acc: 0.094 Test Loss: 3.244 Test Acc: 0.094
Validation loss decreased (-0.077615 --> -0.094085).  Saving model ...
Epoch: 6 cost time: 0.7050044536590576
Epoch: 6, Steps: 10 | Train Loss: 2.842 Vali Loss: 3.236 Vali Acc: 0.108 Test Loss: 3.236 Test Acc: 0.108
Validation loss decreased (-0.094085 --> -0.108203).  Saving model ...
Epoch: 7 cost time: 0.8645317554473877
Epoch: 7, Steps: 10 | Train Loss: 2.727 Vali Loss: 3.229 Vali Acc: 0.114 Test Loss: 3.229 Test Acc: 0.114
Validation loss decreased (-0.108203 --> -0.114085).  Saving model ...
Epoch: 8 cost time: 0.8302609920501709
Epoch: 8, Steps: 10 | Train Loss: 2.598 Vali Loss: 3.222 Vali Acc: 0.121 Test Loss: 3.222 Test Acc: 0.121
Validation loss decreased (-0.114085 --> -0.121144).  Saving model ...
Epoch: 9 cost time: 0.7511425018310547
Epoch: 9, Steps: 10 | Train Loss: 2.457 Vali Loss: 3.214 Vali Acc: 0.129 Test Loss: 3.214 Test Acc: 0.129
Validation loss decreased (-0.121144 --> -0.129380).  Saving model ...
Epoch: 10 cost time: 0.8215370178222656
Epoch: 10, Steps: 10 | Train Loss: 2.313 Vali Loss: 3.203 Vali Acc: 0.138 Test Loss: 3.203 Test Acc: 0.138
Validation loss decreased (-0.129380 --> -0.137615).  Saving model ...
Epoch: 11 cost time: 0.8541531562805176
Epoch: 11, Steps: 10 | Train Loss: 2.122 Vali Loss: 3.188 Vali Acc: 0.146 Test Loss: 3.188 Test Acc: 0.146
Validation loss decreased (-0.137615 --> -0.145850).  Saving model ...
Epoch: 12 cost time: 0.7935340404510498
Epoch: 12, Steps: 10 | Train Loss: 1.929 Vali Loss: 3.174 Vali Acc: 0.151 Test Loss: 3.174 Test Acc: 0.151
Validation loss decreased (-0.145850 --> -0.150556).  Saving model ...
Epoch: 13 cost time: 0.7425153255462646
Epoch: 13, Steps: 10 | Train Loss: 1.733 Vali Loss: 3.172 Vali Acc: 0.155 Test Loss: 3.172 Test Acc: 0.155
Validation loss decreased (-0.150556 --> -0.155262).  Saving model ...
Epoch: 14 cost time: 0.8333423137664795
Epoch: 14, Steps: 10 | Train Loss: 1.533 Vali Loss: 3.168 Vali Acc: 0.174 Test Loss: 3.168 Test Acc: 0.174
Validation loss decreased (-0.155262 --> -0.174086).  Saving model ...
Epoch: 15 cost time: 0.8978960514068604
Epoch: 15, Steps: 10 | Train Loss: 1.335 Vali Loss: 3.177 Vali Acc: 0.193 Test Loss: 3.177 Test Acc: 0.193
Validation loss decreased (-0.174086 --> -0.192909).  Saving model ...
Epoch: 16 cost time: 0.9032330513000488
Epoch: 16, Steps: 10 | Train Loss: 1.124 Vali Loss: 3.194 Vali Acc: 0.202 Test Loss: 3.194 Test Acc: 0.202
Validation loss decreased (-0.192909 --> -0.202321).  Saving model ...
Epoch: 17 cost time: 0.7263736724853516
Epoch: 17, Steps: 10 | Train Loss: 0.953 Vali Loss: 3.217 Vali Acc: 0.213 Test Loss: 3.217 Test Acc: 0.213
Validation loss decreased (-0.202321 --> -0.212909).  Saving model ...
Epoch: 18 cost time: 0.8113267421722412
Epoch: 18, Steps: 10 | Train Loss: 0.766 Vali Loss: 3.273 Vali Acc: 0.225 Test Loss: 3.273 Test Acc: 0.225
Validation loss decreased (-0.212909 --> -0.224673).  Saving model ...
Epoch: 19 cost time: 0.7279987335205078
Epoch: 19, Steps: 10 | Train Loss: 0.620 Vali Loss: 3.310 Vali Acc: 0.232 Test Loss: 3.310 Test Acc: 0.232
Validation loss decreased (-0.224673 --> -0.231732).  Saving model ...
Epoch: 20 cost time: 0.6106100082397461
Epoch: 20, Steps: 10 | Train Loss: 0.474 Vali Loss: 3.358 Vali Acc: 0.245 Test Loss: 3.358 Test Acc: 0.245
Validation loss decreased (-0.231732 --> -0.244672).  Saving model ...
Epoch: 21 cost time: 0.8010566234588623
Epoch: 21, Steps: 10 | Train Loss: 0.400 Vali Loss: 3.427 Vali Acc: 0.249 Test Loss: 3.427 Test Acc: 0.249
Validation loss decreased (-0.244672 --> -0.249377).  Saving model ...
Epoch: 22 cost time: 0.8412489891052246
Epoch: 22, Steps: 10 | Train Loss: 0.316 Vali Loss: 3.497 Vali Acc: 0.249 Test Loss: 3.497 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9569706916809082
Epoch: 23, Steps: 10 | Train Loss: 0.249 Vali Loss: 3.585 Vali Acc: 0.253 Test Loss: 3.585 Test Acc: 0.253
Validation loss decreased (-0.249377 --> -0.252905).  Saving model ...
Epoch: 24 cost time: 0.9308171272277832
Epoch: 24, Steps: 10 | Train Loss: 0.187 Vali Loss: 3.657 Vali Acc: 0.253 Test Loss: 3.657 Test Acc: 0.253
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8346860408782959
Epoch: 25, Steps: 10 | Train Loss: 0.144 Vali Loss: 3.716 Vali Acc: 0.254 Test Loss: 3.716 Test Acc: 0.254
Validation loss decreased (-0.252905 --> -0.254080).  Saving model ...
Epoch: 26 cost time: 0.869755744934082
Epoch: 26, Steps: 10 | Train Loss: 0.120 Vali Loss: 3.766 Vali Acc: 0.261 Test Loss: 3.766 Test Acc: 0.261
Validation loss decreased (-0.254080 --> -0.261139).  Saving model ...
Epoch: 27 cost time: 0.8848822116851807
Epoch: 27, Steps: 10 | Train Loss: 0.098 Vali Loss: 3.816 Vali Acc: 0.260 Test Loss: 3.816 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7524149417877197
Epoch: 28, Steps: 10 | Train Loss: 0.083 Vali Loss: 3.859 Vali Acc: 0.271 Test Loss: 3.859 Test Acc: 0.271
Validation loss decreased (-0.261139 --> -0.270550).  Saving model ...
Epoch: 29 cost time: 0.7950108051300049
Epoch: 29, Steps: 10 | Train Loss: 0.075 Vali Loss: 3.919 Vali Acc: 0.266 Test Loss: 3.919 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.8217496871948242
Epoch: 30, Steps: 10 | Train Loss: 0.059 Vali Loss: 3.968 Vali Acc: 0.268 Test Loss: 3.968 Test Acc: 0.268
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.8079369068145752
Epoch: 31, Steps: 10 | Train Loss: 0.053 Vali Loss: 4.001 Vali Acc: 0.267 Test Loss: 4.001 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.7202193737030029
Epoch: 32, Steps: 10 | Train Loss: 0.049 Vali Loss: 4.047 Vali Acc: 0.267 Test Loss: 4.047 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.7391324043273926
Epoch: 33, Steps: 10 | Train Loss: 0.042 Vali Loss: 4.091 Vali Acc: 0.275 Test Loss: 4.091 Test Acc: 0.275
Validation loss decreased (-0.270550 --> -0.275253).  Saving model ...
Epoch: 34 cost time: 0.7870426177978516
Epoch: 34, Steps: 10 | Train Loss: 0.037 Vali Loss: 4.130 Vali Acc: 0.273 Test Loss: 4.130 Test Acc: 0.273
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.8639822006225586
Epoch: 35, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.158 Vali Acc: 0.275 Test Loss: 4.158 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.7268121242523193
Epoch: 36, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.189 Vali Acc: 0.275 Test Loss: 4.189 Test Acc: 0.275
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.8577079772949219
Epoch: 37, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.212 Vali Acc: 0.278 Test Loss: 4.212 Test Acc: 0.278
Validation loss decreased (-0.275253 --> -0.277605).  Saving model ...
Epoch: 38 cost time: 0.8263826370239258
Epoch: 38, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.236 Vali Acc: 0.276 Test Loss: 4.236 Test Acc: 0.276
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.6205675601959229
Epoch: 39, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.267 Vali Acc: 0.272 Test Loss: 4.267 Test Acc: 0.272
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.6914684772491455
Epoch: 40, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.306 Vali Acc: 0.273 Test Loss: 4.306 Test Acc: 0.273
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.7272632122039795
Epoch: 41, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.328 Vali Acc: 0.274 Test Loss: 4.328 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.795051097869873
Epoch: 42, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.362 Vali Acc: 0.275 Test Loss: 4.362 Test Acc: 0.275
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.8204386234283447
Epoch: 43, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.393 Vali Acc: 0.273 Test Loss: 4.393 Test Acc: 0.273
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.7368779182434082
Epoch: 44, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.396 Vali Acc: 0.276 Test Loss: 4.396 Test Acc: 0.276
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.7661733627319336
Epoch: 45, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.426 Vali Acc: 0.276 Test Loss: 4.426 Test Acc: 0.276
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.8682012557983398
Epoch: 46, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.457 Vali Acc: 0.274 Test Loss: 4.457 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.6778590679168701
Epoch: 47, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.485 Vali Acc: 0.280 Test Loss: 4.485 Test Acc: 0.280
Validation loss decreased (-0.277605 --> -0.279955).  Saving model ...
Epoch: 48 cost time: 0.7559962272644043
Epoch: 48, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.508 Vali Acc: 0.276 Test Loss: 4.508 Test Acc: 0.276
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.724539041519165
Epoch: 49, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.526 Vali Acc: 0.278 Test Loss: 4.526 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.8032104969024658
Epoch: 50, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.546 Vali Acc: 0.280 Test Loss: 4.546 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.28
model parameter : 192826
model size : 0.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps23_str12_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.0260488986968994
Epoch: 1, Steps: 10 | Train Loss: 3.277 Vali Loss: 3.277 Vali Acc: 0.031 Test Loss: 3.277 Test Acc: 0.031
Validation loss decreased (inf --> -0.030555).  Saving model ...
Epoch: 2 cost time: 0.8400917053222656
Epoch: 2, Steps: 10 | Train Loss: 3.220 Vali Loss: 3.277 Vali Acc: 0.031 Test Loss: 3.277 Test Acc: 0.031
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7869024276733398
Epoch: 3, Steps: 10 | Train Loss: 3.187 Vali Loss: 3.272 Vali Acc: 0.045 Test Loss: 3.272 Test Acc: 0.045
Validation loss decreased (-0.030555 --> -0.044673).  Saving model ...
Epoch: 4 cost time: 0.7677450180053711
Epoch: 4, Steps: 10 | Train Loss: 3.121 Vali Loss: 3.265 Vali Acc: 0.054 Test Loss: 3.265 Test Acc: 0.054
Validation loss decreased (-0.044673 --> -0.054085).  Saving model ...
Epoch: 5 cost time: 0.7821450233459473
Epoch: 5, Steps: 10 | Train Loss: 3.035 Vali Loss: 3.257 Vali Acc: 0.067 Test Loss: 3.257 Test Acc: 0.067
Validation loss decreased (-0.054085 --> -0.067026).  Saving model ...
Epoch: 6 cost time: 0.6874699592590332
Epoch: 6, Steps: 10 | Train Loss: 2.950 Vali Loss: 3.251 Vali Acc: 0.074 Test Loss: 3.251 Test Acc: 0.074
Validation loss decreased (-0.067026 --> -0.074085).  Saving model ...
Epoch: 7 cost time: 0.7081449031829834
Epoch: 7, Steps: 10 | Train Loss: 2.889 Vali Loss: 3.244 Vali Acc: 0.075 Test Loss: 3.244 Test Acc: 0.075
Validation loss decreased (-0.074085 --> -0.075262).  Saving model ...
Epoch: 8 cost time: 0.6838924884796143
Epoch: 8, Steps: 10 | Train Loss: 2.764 Vali Loss: 3.238 Vali Acc: 0.082 Test Loss: 3.238 Test Acc: 0.082
Validation loss decreased (-0.075262 --> -0.082321).  Saving model ...
Epoch: 9 cost time: 0.7564160823822021
Epoch: 9, Steps: 10 | Train Loss: 2.670 Vali Loss: 3.233 Vali Acc: 0.085 Test Loss: 3.233 Test Acc: 0.085
Validation loss decreased (-0.082321 --> -0.084674).  Saving model ...
Epoch: 10 cost time: 0.740257740020752
Epoch: 10, Steps: 10 | Train Loss: 2.584 Vali Loss: 3.227 Vali Acc: 0.098 Test Loss: 3.227 Test Acc: 0.098
Validation loss decreased (-0.084674 --> -0.097615).  Saving model ...
Epoch: 11 cost time: 0.692453145980835
Epoch: 11, Steps: 10 | Train Loss: 2.417 Vali Loss: 3.224 Vali Acc: 0.104 Test Loss: 3.224 Test Acc: 0.104
Validation loss decreased (-0.097615 --> -0.103497).  Saving model ...
Epoch: 12 cost time: 0.701862096786499
Epoch: 12, Steps: 10 | Train Loss: 2.311 Vali Loss: 3.223 Vali Acc: 0.113 Test Loss: 3.223 Test Acc: 0.113
Validation loss decreased (-0.103497 --> -0.112909).  Saving model ...
Epoch: 13 cost time: 0.8346126079559326
Epoch: 13, Steps: 10 | Train Loss: 2.169 Vali Loss: 3.223 Vali Acc: 0.114 Test Loss: 3.223 Test Acc: 0.114
Validation loss decreased (-0.112909 --> -0.114085).  Saving model ...
Epoch: 14 cost time: 0.7279925346374512
Epoch: 14, Steps: 10 | Train Loss: 2.005 Vali Loss: 3.219 Vali Acc: 0.126 Test Loss: 3.219 Test Acc: 0.126
Validation loss decreased (-0.114085 --> -0.125850).  Saving model ...
Epoch: 15 cost time: 0.806999683380127
Epoch: 15, Steps: 10 | Train Loss: 1.887 Vali Loss: 3.223 Vali Acc: 0.131 Test Loss: 3.223 Test Acc: 0.131
Validation loss decreased (-0.125850 --> -0.130556).  Saving model ...
Epoch: 16 cost time: 0.7551450729370117
Epoch: 16, Steps: 10 | Train Loss: 1.674 Vali Loss: 3.226 Vali Acc: 0.145 Test Loss: 3.226 Test Acc: 0.145
Validation loss decreased (-0.130556 --> -0.144674).  Saving model ...
Epoch: 17 cost time: 0.7006580829620361
Epoch: 17, Steps: 10 | Train Loss: 1.507 Vali Loss: 3.227 Vali Acc: 0.160 Test Loss: 3.227 Test Acc: 0.160
Validation loss decreased (-0.144674 --> -0.159968).  Saving model ...
Epoch: 18 cost time: 0.8447749614715576
Epoch: 18, Steps: 10 | Train Loss: 1.354 Vali Loss: 3.243 Vali Acc: 0.173 Test Loss: 3.243 Test Acc: 0.173
Validation loss decreased (-0.159968 --> -0.172909).  Saving model ...
Epoch: 19 cost time: 0.7154819965362549
Epoch: 19, Steps: 10 | Train Loss: 1.240 Vali Loss: 3.268 Vali Acc: 0.185 Test Loss: 3.268 Test Acc: 0.185
Validation loss decreased (-0.172909 --> -0.184673).  Saving model ...
Epoch: 20 cost time: 0.8158149719238281
Epoch: 20, Steps: 10 | Train Loss: 1.053 Vali Loss: 3.297 Vali Acc: 0.191 Test Loss: 3.297 Test Acc: 0.191
Validation loss decreased (-0.184673 --> -0.190555).  Saving model ...
Epoch: 21 cost time: 0.729799747467041
Epoch: 21, Steps: 10 | Train Loss: 0.906 Vali Loss: 3.333 Vali Acc: 0.200 Test Loss: 3.333 Test Acc: 0.200
Validation loss decreased (-0.190555 --> -0.199967).  Saving model ...
Epoch: 22 cost time: 0.750176191329956
Epoch: 22, Steps: 10 | Train Loss: 0.771 Vali Loss: 3.373 Vali Acc: 0.208 Test Loss: 3.373 Test Acc: 0.208
Validation loss decreased (-0.199967 --> -0.208202).  Saving model ...
Epoch: 23 cost time: 0.82157301902771
Epoch: 23, Steps: 10 | Train Loss: 0.659 Vali Loss: 3.424 Vali Acc: 0.209 Test Loss: 3.424 Test Acc: 0.209
Validation loss decreased (-0.208202 --> -0.209378).  Saving model ...
Epoch: 24 cost time: 0.703850507736206
Epoch: 24, Steps: 10 | Train Loss: 0.564 Vali Loss: 3.482 Vali Acc: 0.211 Test Loss: 3.482 Test Acc: 0.211
Validation loss decreased (-0.209378 --> -0.210553).  Saving model ...
Epoch: 25 cost time: 0.8211731910705566
Epoch: 25, Steps: 10 | Train Loss: 0.462 Vali Loss: 3.546 Vali Acc: 0.211 Test Loss: 3.546 Test Acc: 0.211
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7053749561309814
Epoch: 26, Steps: 10 | Train Loss: 0.388 Vali Loss: 3.601 Vali Acc: 0.212 Test Loss: 3.601 Test Acc: 0.212
Validation loss decreased (-0.210553 --> -0.211729).  Saving model ...
Epoch: 27 cost time: 0.6769263744354248
Epoch: 27, Steps: 10 | Train Loss: 0.311 Vali Loss: 3.657 Vali Acc: 0.222 Test Loss: 3.657 Test Acc: 0.222
Validation loss decreased (-0.211729 --> -0.222316).  Saving model ...
Epoch: 28 cost time: 0.6285443305969238
Epoch: 28, Steps: 10 | Train Loss: 0.260 Vali Loss: 3.723 Vali Acc: 0.221 Test Loss: 3.723 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6256613731384277
Epoch: 29, Steps: 10 | Train Loss: 0.216 Vali Loss: 3.769 Vali Acc: 0.228 Test Loss: 3.769 Test Acc: 0.228
Validation loss decreased (-0.222316 --> -0.228198).  Saving model ...
Epoch: 30 cost time: 0.6731176376342773
Epoch: 30, Steps: 10 | Train Loss: 0.184 Vali Loss: 3.825 Vali Acc: 0.229 Test Loss: 3.825 Test Acc: 0.229
Validation loss decreased (-0.228198 --> -0.229374).  Saving model ...
Epoch: 31 cost time: 0.7692813873291016
Epoch: 31, Steps: 10 | Train Loss: 0.163 Vali Loss: 3.913 Vali Acc: 0.224 Test Loss: 3.913 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.8433802127838135
Epoch: 32, Steps: 10 | Train Loss: 0.138 Vali Loss: 3.972 Vali Acc: 0.220 Test Loss: 3.972 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.8978636264801025
Epoch: 33, Steps: 10 | Train Loss: 0.114 Vali Loss: 3.997 Vali Acc: 0.222 Test Loss: 3.997 Test Acc: 0.222
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.7452208995819092
Epoch: 34, Steps: 10 | Train Loss: 0.091 Vali Loss: 4.040 Vali Acc: 0.227 Test Loss: 4.040 Test Acc: 0.227
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.7953858375549316
Epoch: 35, Steps: 10 | Train Loss: 0.083 Vali Loss: 4.101 Vali Acc: 0.229 Test Loss: 4.101 Test Acc: 0.229
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.7693133354187012
Epoch: 36, Steps: 10 | Train Loss: 0.077 Vali Loss: 4.149 Vali Acc: 0.227 Test Loss: 4.149 Test Acc: 0.227
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.8054366111755371
Epoch: 37, Steps: 10 | Train Loss: 0.065 Vali Loss: 4.181 Vali Acc: 0.236 Test Loss: 4.181 Test Acc: 0.236
Validation loss decreased (-0.229374 --> -0.236429).  Saving model ...
Epoch: 38 cost time: 0.8289575576782227
Epoch: 38, Steps: 10 | Train Loss: 0.063 Vali Loss: 4.227 Vali Acc: 0.244 Test Loss: 4.227 Test Acc: 0.244
Validation loss decreased (-0.236429 --> -0.243487).  Saving model ...
Epoch: 39 cost time: 0.7527320384979248
Epoch: 39, Steps: 10 | Train Loss: 0.050 Vali Loss: 4.267 Vali Acc: 0.239 Test Loss: 4.267 Test Acc: 0.239
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.8494625091552734
Epoch: 40, Steps: 10 | Train Loss: 0.047 Vali Loss: 4.310 Vali Acc: 0.240 Test Loss: 4.310 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.809161901473999
Epoch: 41, Steps: 10 | Train Loss: 0.049 Vali Loss: 4.372 Vali Acc: 0.229 Test Loss: 4.372 Test Acc: 0.229
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.8657031059265137
Epoch: 42, Steps: 10 | Train Loss: 0.038 Vali Loss: 4.384 Vali Acc: 0.236 Test Loss: 4.384 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.596653938293457
Epoch: 43, Steps: 10 | Train Loss: 0.038 Vali Loss: 4.401 Vali Acc: 0.245 Test Loss: 4.401 Test Acc: 0.245
Validation loss decreased (-0.243487 --> -0.244662).  Saving model ...
Epoch: 44 cost time: 0.8112642765045166
Epoch: 44, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.434 Vali Acc: 0.240 Test Loss: 4.434 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.8259375095367432
Epoch: 45, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.461 Vali Acc: 0.240 Test Loss: 4.461 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.8817429542541504
Epoch: 46, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.481 Vali Acc: 0.242 Test Loss: 4.481 Test Acc: 0.242
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.9121229648590088
Epoch: 47, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.551 Vali Acc: 0.238 Test Loss: 4.551 Test Acc: 0.238
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.8629021644592285
Epoch: 48, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.565 Vali Acc: 0.235 Test Loss: 4.565 Test Acc: 0.235
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.7722117900848389
Epoch: 49, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.593 Vali Acc: 0.244 Test Loss: 4.593 Test Acc: 0.244
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.8046329021453857
Epoch: 50, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.608 Vali Acc: 0.245 Test Loss: 4.608 Test Acc: 0.245
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps23_str12_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2447058823529412
model parameter : 173082
model size : 0.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.6753511428833008
Epoch: 1, Steps: 10 | Train Loss: 3.269 Vali Loss: 3.267 Vali Acc: 0.040 Test Loss: 3.267 Test Acc: 0.040
Validation loss decreased (inf --> -0.039967).  Saving model ...
Epoch: 2 cost time: 0.5699660778045654
Epoch: 2, Steps: 10 | Train Loss: 3.240 Vali Loss: 3.263 Vali Acc: 0.041 Test Loss: 3.263 Test Acc: 0.041
Validation loss decreased (-0.039967 --> -0.041144).  Saving model ...
Epoch: 3 cost time: 0.6595394611358643
Epoch: 3, Steps: 10 | Train Loss: 3.211 Vali Loss: 3.258 Vali Acc: 0.049 Test Loss: 3.258 Test Acc: 0.049
Validation loss decreased (-0.041144 --> -0.049379).  Saving model ...
Epoch: 4 cost time: 0.6868555545806885
Epoch: 4, Steps: 10 | Train Loss: 3.153 Vali Loss: 3.251 Vali Acc: 0.053 Test Loss: 3.251 Test Acc: 0.053
Validation loss decreased (-0.049379 --> -0.052909).  Saving model ...
Epoch: 5 cost time: 0.7935354709625244
Epoch: 5, Steps: 10 | Train Loss: 3.066 Vali Loss: 3.243 Vali Acc: 0.062 Test Loss: 3.243 Test Acc: 0.062
Validation loss decreased (-0.052909 --> -0.062321).  Saving model ...
Epoch: 6 cost time: 0.7254767417907715
Epoch: 6, Steps: 10 | Train Loss: 2.999 Vali Loss: 3.236 Vali Acc: 0.078 Test Loss: 3.236 Test Acc: 0.078
Validation loss decreased (-0.062321 --> -0.077615).  Saving model ...
Epoch: 7 cost time: 0.7934370040893555
Epoch: 7, Steps: 10 | Train Loss: 2.941 Vali Loss: 3.229 Vali Acc: 0.089 Test Loss: 3.229 Test Acc: 0.089
Validation loss decreased (-0.077615 --> -0.089379).  Saving model ...
Epoch: 8 cost time: 0.8196442127227783
Epoch: 8, Steps: 10 | Train Loss: 2.858 Vali Loss: 3.223 Vali Acc: 0.095 Test Loss: 3.223 Test Acc: 0.095
Validation loss decreased (-0.089379 --> -0.095262).  Saving model ...
Epoch: 9 cost time: 0.8406162261962891
Epoch: 9, Steps: 10 | Train Loss: 2.774 Vali Loss: 3.218 Vali Acc: 0.101 Test Loss: 3.218 Test Acc: 0.101
Validation loss decreased (-0.095262 --> -0.101144).  Saving model ...
Epoch: 10 cost time: 0.8957855701446533
Epoch: 10, Steps: 10 | Train Loss: 2.676 Vali Loss: 3.215 Vali Acc: 0.106 Test Loss: 3.215 Test Acc: 0.106
Validation loss decreased (-0.101144 --> -0.105850).  Saving model ...
Epoch: 11 cost time: 0.7475578784942627
Epoch: 11, Steps: 10 | Train Loss: 2.568 Vali Loss: 3.208 Vali Acc: 0.108 Test Loss: 3.208 Test Acc: 0.108
Validation loss decreased (-0.105850 --> -0.108203).  Saving model ...
Epoch: 12 cost time: 0.8210041522979736
Epoch: 12, Steps: 10 | Train Loss: 2.475 Vali Loss: 3.205 Vali Acc: 0.118 Test Loss: 3.205 Test Acc: 0.118
Validation loss decreased (-0.108203 --> -0.117615).  Saving model ...
Epoch: 13 cost time: 0.7501227855682373
Epoch: 13, Steps: 10 | Train Loss: 2.347 Vali Loss: 3.200 Vali Acc: 0.126 Test Loss: 3.200 Test Acc: 0.126
Validation loss decreased (-0.117615 --> -0.125850).  Saving model ...
Epoch: 14 cost time: 0.8436267375946045
Epoch: 14, Steps: 10 | Train Loss: 2.224 Vali Loss: 3.200 Vali Acc: 0.129 Test Loss: 3.200 Test Acc: 0.129
Validation loss decreased (-0.125850 --> -0.129380).  Saving model ...
Epoch: 15 cost time: 0.8749735355377197
Epoch: 15, Steps: 10 | Train Loss: 2.097 Vali Loss: 3.195 Vali Acc: 0.135 Test Loss: 3.195 Test Acc: 0.135
Validation loss decreased (-0.129380 --> -0.135262).  Saving model ...
Epoch: 16 cost time: 0.9697213172912598
Epoch: 16, Steps: 10 | Train Loss: 1.940 Vali Loss: 3.196 Vali Acc: 0.142 Test Loss: 3.196 Test Acc: 0.142
Validation loss decreased (-0.135262 --> -0.142321).  Saving model ...
Epoch: 17 cost time: 0.7972230911254883
Epoch: 17, Steps: 10 | Train Loss: 1.790 Vali Loss: 3.198 Vali Acc: 0.153 Test Loss: 3.198 Test Acc: 0.153
Validation loss decreased (-0.142321 --> -0.152909).  Saving model ...
Epoch: 18 cost time: 0.7689666748046875
Epoch: 18, Steps: 10 | Train Loss: 1.614 Vali Loss: 3.204 Vali Acc: 0.158 Test Loss: 3.204 Test Acc: 0.158
Validation loss decreased (-0.152909 --> -0.157615).  Saving model ...
Epoch: 19 cost time: 0.7862045764923096
Epoch: 19, Steps: 10 | Train Loss: 1.515 Vali Loss: 3.208 Vali Acc: 0.169 Test Loss: 3.208 Test Acc: 0.169
Validation loss decreased (-0.157615 --> -0.169380).  Saving model ...
Epoch: 20 cost time: 0.7974474430084229
Epoch: 20, Steps: 10 | Train Loss: 1.316 Vali Loss: 3.219 Vali Acc: 0.180 Test Loss: 3.219 Test Acc: 0.180
Validation loss decreased (-0.169380 --> -0.179968).  Saving model ...
Epoch: 21 cost time: 0.8277528285980225
Epoch: 21, Steps: 10 | Train Loss: 1.187 Vali Loss: 3.239 Vali Acc: 0.185 Test Loss: 3.239 Test Acc: 0.185
Validation loss decreased (-0.179968 --> -0.184673).  Saving model ...
Epoch: 22 cost time: 0.7532773017883301
Epoch: 22, Steps: 10 | Train Loss: 1.038 Vali Loss: 3.261 Vali Acc: 0.187 Test Loss: 3.261 Test Acc: 0.187
Validation loss decreased (-0.184673 --> -0.187026).  Saving model ...
Epoch: 23 cost time: 0.7200744152069092
Epoch: 23, Steps: 10 | Train Loss: 0.876 Vali Loss: 3.291 Vali Acc: 0.198 Test Loss: 3.291 Test Acc: 0.198
Validation loss decreased (-0.187026 --> -0.197614).  Saving model ...
Epoch: 24 cost time: 0.6987667083740234
Epoch: 24, Steps: 10 | Train Loss: 0.740 Vali Loss: 3.326 Vali Acc: 0.199 Test Loss: 3.326 Test Acc: 0.199
Validation loss decreased (-0.197614 --> -0.198790).  Saving model ...
Epoch: 25 cost time: 0.7592408657073975
Epoch: 25, Steps: 10 | Train Loss: 0.662 Vali Loss: 3.366 Vali Acc: 0.199 Test Loss: 3.366 Test Acc: 0.199
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7797238826751709
Epoch: 26, Steps: 10 | Train Loss: 0.543 Vali Loss: 3.421 Vali Acc: 0.205 Test Loss: 3.421 Test Acc: 0.205
Validation loss decreased (-0.198790 --> -0.204672).  Saving model ...
Epoch: 27 cost time: 0.6669645309448242
Epoch: 27, Steps: 10 | Train Loss: 0.484 Vali Loss: 3.472 Vali Acc: 0.208 Test Loss: 3.472 Test Acc: 0.208
Validation loss decreased (-0.204672 --> -0.208201).  Saving model ...
Epoch: 28 cost time: 0.7998881340026855
Epoch: 28, Steps: 10 | Train Loss: 0.367 Vali Loss: 3.524 Vali Acc: 0.206 Test Loss: 3.524 Test Acc: 0.206
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.8218181133270264
Epoch: 29, Steps: 10 | Train Loss: 0.316 Vali Loss: 3.564 Vali Acc: 0.212 Test Loss: 3.564 Test Acc: 0.212
Validation loss decreased (-0.208201 --> -0.211729).  Saving model ...
Epoch: 30 cost time: 0.7464015483856201
Epoch: 30, Steps: 10 | Train Loss: 0.271 Vali Loss: 3.623 Vali Acc: 0.219 Test Loss: 3.623 Test Acc: 0.219
Validation loss decreased (-0.211729 --> -0.218787).  Saving model ...
Epoch: 31 cost time: 0.7743465900421143
Epoch: 31, Steps: 10 | Train Loss: 0.233 Vali Loss: 3.685 Vali Acc: 0.222 Test Loss: 3.685 Test Acc: 0.222
Validation loss decreased (-0.218787 --> -0.222316).  Saving model ...
Epoch: 32 cost time: 0.7354786396026611
Epoch: 32, Steps: 10 | Train Loss: 0.210 Vali Loss: 3.728 Vali Acc: 0.238 Test Loss: 3.728 Test Acc: 0.238
Validation loss decreased (-0.222316 --> -0.237610).  Saving model ...
Epoch: 33 cost time: 0.8243293762207031
Epoch: 33, Steps: 10 | Train Loss: 0.168 Vali Loss: 3.771 Vali Acc: 0.244 Test Loss: 3.771 Test Acc: 0.244
Validation loss decreased (-0.237610 --> -0.243492).  Saving model ...
Epoch: 34 cost time: 0.8619506359100342
Epoch: 34, Steps: 10 | Train Loss: 0.139 Vali Loss: 3.807 Vali Acc: 0.240 Test Loss: 3.807 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.8347992897033691
Epoch: 35, Steps: 10 | Train Loss: 0.120 Vali Loss: 3.859 Vali Acc: 0.236 Test Loss: 3.859 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.7580680847167969
Epoch: 36, Steps: 10 | Train Loss: 0.099 Vali Loss: 3.907 Vali Acc: 0.244 Test Loss: 3.907 Test Acc: 0.244
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.8110225200653076
Epoch: 37, Steps: 10 | Train Loss: 0.094 Vali Loss: 3.954 Vali Acc: 0.251 Test Loss: 3.954 Test Acc: 0.251
Validation loss decreased (-0.243492 --> -0.250549).  Saving model ...
Epoch: 38 cost time: 0.8231761455535889
Epoch: 38, Steps: 10 | Train Loss: 0.077 Vali Loss: 3.990 Vali Acc: 0.239 Test Loss: 3.990 Test Acc: 0.239
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.7619385719299316
Epoch: 39, Steps: 10 | Train Loss: 0.076 Vali Loss: 4.027 Vali Acc: 0.240 Test Loss: 4.027 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.7967424392700195
Epoch: 40, Steps: 10 | Train Loss: 0.068 Vali Loss: 4.078 Vali Acc: 0.241 Test Loss: 4.078 Test Acc: 0.241
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.8255033493041992
Epoch: 41, Steps: 10 | Train Loss: 0.061 Vali Loss: 4.118 Vali Acc: 0.246 Test Loss: 4.118 Test Acc: 0.246
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.8145976066589355
Epoch: 42, Steps: 10 | Train Loss: 0.051 Vali Loss: 4.157 Vali Acc: 0.242 Test Loss: 4.157 Test Acc: 0.242
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.8917748928070068
Epoch: 43, Steps: 10 | Train Loss: 0.045 Vali Loss: 4.199 Vali Acc: 0.242 Test Loss: 4.199 Test Acc: 0.242
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.828763484954834
Epoch: 44, Steps: 10 | Train Loss: 0.048 Vali Loss: 4.246 Vali Acc: 0.236 Test Loss: 4.246 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.771012544631958
Epoch: 45, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.243 Vali Acc: 0.246 Test Loss: 4.243 Test Acc: 0.246
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.6852786540985107
Epoch: 46, Steps: 10 | Train Loss: 0.039 Vali Loss: 4.289 Vali Acc: 0.249 Test Loss: 4.289 Test Acc: 0.249
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.7146632671356201
Epoch: 47, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.320 Vali Acc: 0.249 Test Loss: 4.320 Test Acc: 0.249
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.25058823529411767
model parameter : 168346
model size : 0.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps38_str19_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.786214828491211
Epoch: 1, Steps: 10 | Train Loss: 3.298 Vali Loss: 3.272 Vali Acc: 0.034 Test Loss: 3.272 Test Acc: 0.034
Validation loss decreased (inf --> -0.034085).  Saving model ...
Epoch: 2 cost time: 0.6073839664459229
Epoch: 2, Steps: 10 | Train Loss: 3.280 Vali Loss: 3.271 Vali Acc: 0.031 Test Loss: 3.271 Test Acc: 0.031
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7552964687347412
Epoch: 3, Steps: 10 | Train Loss: 3.229 Vali Loss: 3.267 Vali Acc: 0.040 Test Loss: 3.267 Test Acc: 0.040
Validation loss decreased (-0.034085 --> -0.039967).  Saving model ...
Epoch: 4 cost time: 0.6757135391235352
Epoch: 4, Steps: 10 | Train Loss: 3.178 Vali Loss: 3.259 Vali Acc: 0.049 Test Loss: 3.259 Test Acc: 0.049
Validation loss decreased (-0.039967 --> -0.049379).  Saving model ...
Epoch: 5 cost time: 0.6056900024414062
Epoch: 5, Steps: 10 | Train Loss: 3.125 Vali Loss: 3.251 Vali Acc: 0.062 Test Loss: 3.251 Test Acc: 0.062
Validation loss decreased (-0.049379 --> -0.062320).  Saving model ...
Epoch: 6 cost time: 0.570751428604126
Epoch: 6, Steps: 10 | Train Loss: 3.060 Vali Loss: 3.244 Vali Acc: 0.065 Test Loss: 3.244 Test Acc: 0.065
Validation loss decreased (-0.062320 --> -0.064673).  Saving model ...
Epoch: 7 cost time: 0.5899510383605957
Epoch: 7, Steps: 10 | Train Loss: 3.004 Vali Loss: 3.236 Vali Acc: 0.071 Test Loss: 3.236 Test Acc: 0.071
Validation loss decreased (-0.064673 --> -0.070556).  Saving model ...
Epoch: 8 cost time: 0.6790688037872314
Epoch: 8, Steps: 10 | Train Loss: 2.937 Vali Loss: 3.229 Vali Acc: 0.079 Test Loss: 3.229 Test Acc: 0.079
Validation loss decreased (-0.070556 --> -0.078791).  Saving model ...
Epoch: 9 cost time: 0.6531877517700195
Epoch: 9, Steps: 10 | Train Loss: 2.873 Vali Loss: 3.222 Vali Acc: 0.093 Test Loss: 3.222 Test Acc: 0.093
Validation loss decreased (-0.078791 --> -0.092909).  Saving model ...
Epoch: 10 cost time: 0.7116057872772217
Epoch: 10, Steps: 10 | Train Loss: 2.765 Vali Loss: 3.216 Vali Acc: 0.095 Test Loss: 3.216 Test Acc: 0.095
Validation loss decreased (-0.092909 --> -0.095262).  Saving model ...
Epoch: 11 cost time: 0.7128400802612305
Epoch: 11, Steps: 10 | Train Loss: 2.700 Vali Loss: 3.212 Vali Acc: 0.111 Test Loss: 3.212 Test Acc: 0.111
Validation loss decreased (-0.095262 --> -0.110556).  Saving model ...
Epoch: 12 cost time: 0.6412885189056396
Epoch: 12, Steps: 10 | Train Loss: 2.572 Vali Loss: 3.207 Vali Acc: 0.118 Test Loss: 3.207 Test Acc: 0.118
Validation loss decreased (-0.110556 --> -0.117615).  Saving model ...
Epoch: 13 cost time: 0.7241160869598389
Epoch: 13, Steps: 10 | Train Loss: 2.478 Vali Loss: 3.203 Vali Acc: 0.124 Test Loss: 3.203 Test Acc: 0.124
Validation loss decreased (-0.117615 --> -0.123497).  Saving model ...
Epoch: 14 cost time: 0.6262483596801758
Epoch: 14, Steps: 10 | Train Loss: 2.362 Vali Loss: 3.198 Vali Acc: 0.132 Test Loss: 3.198 Test Acc: 0.132
Validation loss decreased (-0.123497 --> -0.131733).  Saving model ...
Epoch: 15 cost time: 0.647768497467041
Epoch: 15, Steps: 10 | Train Loss: 2.244 Vali Loss: 3.192 Vali Acc: 0.136 Test Loss: 3.192 Test Acc: 0.136
Validation loss decreased (-0.131733 --> -0.136439).  Saving model ...
Epoch: 16 cost time: 0.6243715286254883
Epoch: 16, Steps: 10 | Train Loss: 2.121 Vali Loss: 3.188 Vali Acc: 0.140 Test Loss: 3.188 Test Acc: 0.140
Validation loss decreased (-0.136439 --> -0.139968).  Saving model ...
Epoch: 17 cost time: 0.7494471073150635
Epoch: 17, Steps: 10 | Train Loss: 1.983 Vali Loss: 3.188 Vali Acc: 0.146 Test Loss: 3.188 Test Acc: 0.146
Validation loss decreased (-0.139968 --> -0.145850).  Saving model ...
Epoch: 18 cost time: 0.693397045135498
Epoch: 18, Steps: 10 | Train Loss: 1.843 Vali Loss: 3.183 Vali Acc: 0.162 Test Loss: 3.183 Test Acc: 0.162
Validation loss decreased (-0.145850 --> -0.162321).  Saving model ...
Epoch: 19 cost time: 0.5883159637451172
Epoch: 19, Steps: 10 | Train Loss: 1.713 Vali Loss: 3.190 Vali Acc: 0.164 Test Loss: 3.190 Test Acc: 0.164
Validation loss decreased (-0.162321 --> -0.163498).  Saving model ...
Epoch: 20 cost time: 0.5614826679229736
Epoch: 20, Steps: 10 | Train Loss: 1.560 Vali Loss: 3.193 Vali Acc: 0.178 Test Loss: 3.193 Test Acc: 0.178
Validation loss decreased (-0.163498 --> -0.177615).  Saving model ...
Epoch: 21 cost time: 0.6410276889801025
Epoch: 21, Steps: 10 | Train Loss: 1.401 Vali Loss: 3.200 Vali Acc: 0.182 Test Loss: 3.200 Test Acc: 0.182
Validation loss decreased (-0.177615 --> -0.182321).  Saving model ...
Epoch: 22 cost time: 0.6335704326629639
Epoch: 22, Steps: 10 | Train Loss: 1.238 Vali Loss: 3.209 Vali Acc: 0.191 Test Loss: 3.209 Test Acc: 0.191
Validation loss decreased (-0.182321 --> -0.190556).  Saving model ...
Epoch: 23 cost time: 0.6870598793029785
Epoch: 23, Steps: 10 | Train Loss: 1.109 Vali Loss: 3.222 Vali Acc: 0.201 Test Loss: 3.222 Test Acc: 0.201
Validation loss decreased (-0.190556 --> -0.201144).  Saving model ...
Epoch: 24 cost time: 0.6642165184020996
Epoch: 24, Steps: 10 | Train Loss: 0.979 Vali Loss: 3.252 Vali Acc: 0.212 Test Loss: 3.252 Test Acc: 0.212
Validation loss decreased (-0.201144 --> -0.211732).  Saving model ...
Epoch: 25 cost time: 0.6923108100891113
Epoch: 25, Steps: 10 | Train Loss: 0.848 Vali Loss: 3.274 Vali Acc: 0.218 Test Loss: 3.274 Test Acc: 0.218
Validation loss decreased (-0.211732 --> -0.217614).  Saving model ...
Epoch: 26 cost time: 0.637700080871582
Epoch: 26, Steps: 10 | Train Loss: 0.727 Vali Loss: 3.299 Vali Acc: 0.215 Test Loss: 3.299 Test Acc: 0.215
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.6904788017272949
Epoch: 27, Steps: 10 | Train Loss: 0.637 Vali Loss: 3.335 Vali Acc: 0.221 Test Loss: 3.335 Test Acc: 0.221
Validation loss decreased (-0.217614 --> -0.221143).  Saving model ...
Epoch: 28 cost time: 0.6855661869049072
Epoch: 28, Steps: 10 | Train Loss: 0.520 Vali Loss: 3.387 Vali Acc: 0.231 Test Loss: 3.387 Test Acc: 0.231
Validation loss decreased (-0.221143 --> -0.230554).  Saving model ...
Epoch: 29 cost time: 0.6491456031799316
Epoch: 29, Steps: 10 | Train Loss: 0.477 Vali Loss: 3.442 Vali Acc: 0.221 Test Loss: 3.442 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.6486773490905762
Epoch: 30, Steps: 10 | Train Loss: 0.393 Vali Loss: 3.491 Vali Acc: 0.221 Test Loss: 3.491 Test Acc: 0.221
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.6868016719818115
Epoch: 31, Steps: 10 | Train Loss: 0.316 Vali Loss: 3.529 Vali Acc: 0.232 Test Loss: 3.529 Test Acc: 0.232
Validation loss decreased (-0.230554 --> -0.231729).  Saving model ...
Epoch: 32 cost time: 0.6570460796356201
Epoch: 32, Steps: 10 | Train Loss: 0.282 Vali Loss: 3.558 Vali Acc: 0.231 Test Loss: 3.558 Test Acc: 0.231
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.6398615837097168
Epoch: 33, Steps: 10 | Train Loss: 0.271 Vali Loss: 3.597 Vali Acc: 0.251 Test Loss: 3.597 Test Acc: 0.251
Validation loss decreased (-0.231729 --> -0.250552).  Saving model ...
Epoch: 34 cost time: 0.6771516799926758
Epoch: 34, Steps: 10 | Train Loss: 0.206 Vali Loss: 3.650 Vali Acc: 0.240 Test Loss: 3.650 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.6489958763122559
Epoch: 35, Steps: 10 | Train Loss: 0.177 Vali Loss: 3.719 Vali Acc: 0.240 Test Loss: 3.719 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.7271318435668945
Epoch: 36, Steps: 10 | Train Loss: 0.153 Vali Loss: 3.749 Vali Acc: 0.239 Test Loss: 3.749 Test Acc: 0.239
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.7258803844451904
Epoch: 37, Steps: 10 | Train Loss: 0.124 Vali Loss: 3.802 Vali Acc: 0.246 Test Loss: 3.802 Test Acc: 0.246
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.583681583404541
Epoch: 38, Steps: 10 | Train Loss: 0.115 Vali Loss: 3.858 Vali Acc: 0.248 Test Loss: 3.858 Test Acc: 0.248
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.5586256980895996
Epoch: 39, Steps: 10 | Train Loss: 0.097 Vali Loss: 3.898 Vali Acc: 0.253 Test Loss: 3.898 Test Acc: 0.253
Validation loss decreased (-0.250552 --> -0.252902).  Saving model ...
Epoch: 40 cost time: 0.595240592956543
Epoch: 40, Steps: 10 | Train Loss: 0.099 Vali Loss: 3.938 Vali Acc: 0.252 Test Loss: 3.938 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.611851692199707
Epoch: 41, Steps: 10 | Train Loss: 0.075 Vali Loss: 3.972 Vali Acc: 0.248 Test Loss: 3.972 Test Acc: 0.248
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.5979869365692139
Epoch: 42, Steps: 10 | Train Loss: 0.075 Vali Loss: 3.998 Vali Acc: 0.248 Test Loss: 3.998 Test Acc: 0.248
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.6691958904266357
Epoch: 43, Steps: 10 | Train Loss: 0.066 Vali Loss: 4.038 Vali Acc: 0.246 Test Loss: 4.038 Test Acc: 0.246
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.5671520233154297
Epoch: 44, Steps: 10 | Train Loss: 0.063 Vali Loss: 4.073 Vali Acc: 0.247 Test Loss: 4.073 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.6436645984649658
Epoch: 45, Steps: 10 | Train Loss: 0.054 Vali Loss: 4.130 Vali Acc: 0.248 Test Loss: 4.130 Test Acc: 0.248
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.6665334701538086
Epoch: 46, Steps: 10 | Train Loss: 0.049 Vali Loss: 4.173 Vali Acc: 0.251 Test Loss: 4.173 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.6446278095245361
Epoch: 47, Steps: 10 | Train Loss: 0.043 Vali Loss: 4.209 Vali Acc: 0.254 Test Loss: 4.209 Test Acc: 0.254
Validation loss decreased (-0.252902 --> -0.254076).  Saving model ...
Epoch: 48 cost time: 0.6327016353607178
Epoch: 48, Steps: 10 | Train Loss: 0.049 Vali Loss: 4.233 Vali Acc: 0.252 Test Loss: 4.233 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.6592497825622559
Epoch: 49, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.251 Vali Acc: 0.255 Test Loss: 4.251 Test Acc: 0.255
Validation loss decreased (-0.254076 --> -0.255252).  Saving model ...
Epoch: 50 cost time: 0.6715450286865234
Epoch: 50, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.293 Vali Acc: 0.254 Test Loss: 4.293 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps38_str19_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.25529411764705884
model parameter : 163578
model size : 0.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.4766390323638916
Epoch: 1, Steps: 10 | Train Loss: 3.297 Vali Loss: 3.230 Vali Acc: 0.091 Test Loss: 3.230 Test Acc: 0.091
Validation loss decreased (inf --> -0.090556).  Saving model ...
Epoch: 2 cost time: 1.382033109664917
Epoch: 2, Steps: 10 | Train Loss: 2.043 Vali Loss: 3.251 Vali Acc: 0.172 Test Loss: 3.251 Test Acc: 0.172
Validation loss decreased (-0.090556 --> -0.171732).  Saving model ...
Epoch: 3 cost time: 1.073441982269287
Epoch: 3, Steps: 10 | Train Loss: 0.719 Vali Loss: 3.448 Vali Acc: 0.239 Test Loss: 3.448 Test Acc: 0.239
Validation loss decreased (-0.171732 --> -0.238789).  Saving model ...
Epoch: 4 cost time: 1.420351505279541
Epoch: 4, Steps: 10 | Train Loss: 0.185 Vali Loss: 4.041 Vali Acc: 0.245 Test Loss: 4.041 Test Acc: 0.245
Validation loss decreased (-0.238789 --> -0.244665).  Saving model ...
Epoch: 5 cost time: 1.3553650379180908
Epoch: 5, Steps: 10 | Train Loss: 0.047 Vali Loss: 4.376 Vali Acc: 0.259 Test Loss: 4.376 Test Acc: 0.259
Validation loss decreased (-0.244665 --> -0.258780).  Saving model ...
Epoch: 6 cost time: 1.4263629913330078
Epoch: 6, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.759 Vali Acc: 0.273 Test Loss: 4.759 Test Acc: 0.273
Validation loss decreased (-0.258780 --> -0.272894).  Saving model ...
Epoch: 7 cost time: 1.131028413772583
Epoch: 7, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.881 Vali Acc: 0.272 Test Loss: 4.881 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.31679368019104
Epoch: 8, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.957 Vali Acc: 0.269 Test Loss: 4.957 Test Acc: 0.269
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.223036289215088
Epoch: 9, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.173 Vali Acc: 0.252 Test Loss: 5.173 Test Acc: 0.252
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.1558959484100342
Epoch: 10, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.976 Vali Acc: 0.274 Test Loss: 4.976 Test Acc: 0.274
Validation loss decreased (-0.272894 --> -0.274068).  Saving model ...
Epoch: 11 cost time: 1.0556745529174805
Epoch: 11, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.997 Vali Acc: 0.273 Test Loss: 4.997 Test Acc: 0.273
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1199016571044922
Epoch: 12, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.043 Vali Acc: 0.273 Test Loss: 5.043 Test Acc: 0.273
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.390660285949707
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.071 Vali Acc: 0.276 Test Loss: 5.071 Test Acc: 0.276
Validation loss decreased (-0.274068 --> -0.276420).  Saving model ...
Epoch: 14 cost time: 1.2685565948486328
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.110 Vali Acc: 0.275 Test Loss: 5.110 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3912084102630615
Epoch: 15, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.124 Vali Acc: 0.275 Test Loss: 5.124 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.276491641998291
Epoch: 16, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.139 Vali Acc: 0.274 Test Loss: 5.139 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.263519287109375
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.136 Vali Acc: 0.275 Test Loss: 5.136 Test Acc: 0.275
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.3485617637634277
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.159 Vali Acc: 0.274 Test Loss: 5.159 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.5765659809112549
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.173 Vali Acc: 0.274 Test Loss: 5.173 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.30088210105896
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.183 Vali Acc: 0.275 Test Loss: 5.183 Test Acc: 0.275
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.2850360870361328
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.201 Vali Acc: 0.276 Test Loss: 5.201 Test Acc: 0.276
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.1955530643463135
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.215 Vali Acc: 0.275 Test Loss: 5.215 Test Acc: 0.275
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.281989336013794
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.221 Vali Acc: 0.278 Test Loss: 5.221 Test Acc: 0.278
Validation loss decreased (-0.276420 --> -0.277595).  Saving model ...
Epoch: 24 cost time: 1.1788532733917236
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.237 Vali Acc: 0.275 Test Loss: 5.237 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.2401444911956787
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.249 Vali Acc: 0.274 Test Loss: 5.249 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.4920639991760254
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.262 Vali Acc: 0.273 Test Loss: 5.262 Test Acc: 0.273
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.4203598499298096
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.279 Vali Acc: 0.269 Test Loss: 5.279 Test Acc: 0.269
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.5372998714447021
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.285 Vali Acc: 0.268 Test Loss: 5.285 Test Acc: 0.268
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.6194164752960205
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.318 Vali Acc: 0.271 Test Loss: 5.318 Test Acc: 0.271
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.5473463535308838
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.330 Vali Acc: 0.269 Test Loss: 5.330 Test Acc: 0.269
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.3040626049041748
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.340 Vali Acc: 0.269 Test Loss: 5.340 Test Acc: 0.269
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.4930922985076904
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.347 Vali Acc: 0.269 Test Loss: 5.347 Test Acc: 0.269
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.4137120246887207
Epoch: 33, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.373 Vali Acc: 0.273 Test Loss: 5.373 Test Acc: 0.273
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2776470588235294
model parameter : 3135770
model size : 11.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.725008726119995
Epoch: 1, Steps: 10 | Train Loss: 3.327 Vali Loss: 3.267 Vali Acc: 0.054 Test Loss: 3.267 Test Acc: 0.054
Validation loss decreased (inf --> -0.054085).  Saving model ...
Epoch: 2 cost time: 1.018878698348999
Epoch: 2, Steps: 10 | Train Loss: 2.585 Vali Loss: 3.286 Vali Acc: 0.100 Test Loss: 3.286 Test Acc: 0.100
Validation loss decreased (-0.054085 --> -0.099967).  Saving model ...
Epoch: 3 cost time: 0.9178354740142822
Epoch: 3, Steps: 10 | Train Loss: 1.495 Vali Loss: 3.230 Vali Acc: 0.200 Test Loss: 3.230 Test Acc: 0.200
Validation loss decreased (-0.099967 --> -0.199968).  Saving model ...
Epoch: 4 cost time: 1.1371471881866455
Epoch: 4, Steps: 10 | Train Loss: 0.708 Vali Loss: 3.360 Vali Acc: 0.233 Test Loss: 3.360 Test Acc: 0.233
Validation loss decreased (-0.199968 --> -0.232908).  Saving model ...
Epoch: 5 cost time: 0.9560632705688477
Epoch: 5, Steps: 10 | Train Loss: 0.289 Vali Loss: 3.701 Vali Acc: 0.239 Test Loss: 3.701 Test Acc: 0.239
Validation loss decreased (-0.232908 --> -0.238787).  Saving model ...
Epoch: 6 cost time: 1.1065983772277832
Epoch: 6, Steps: 10 | Train Loss: 0.107 Vali Loss: 3.934 Vali Acc: 0.266 Test Loss: 3.934 Test Acc: 0.266
Validation loss decreased (-0.238787 --> -0.265843).  Saving model ...
Epoch: 7 cost time: 0.9713780879974365
Epoch: 7, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.148 Vali Acc: 0.245 Test Loss: 4.148 Test Acc: 0.245
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1366515159606934
Epoch: 8, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.244 Vali Acc: 0.260 Test Loss: 4.244 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2217159271240234
Epoch: 9, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.367 Vali Acc: 0.260 Test Loss: 4.367 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.0826101303100586
Epoch: 10, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.442 Vali Acc: 0.262 Test Loss: 4.442 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.101470947265625
Epoch: 11, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.457 Vali Acc: 0.269 Test Loss: 4.457 Test Acc: 0.269
Validation loss decreased (-0.265843 --> -0.269367).  Saving model ...
Epoch: 12 cost time: 1.1644282341003418
Epoch: 12, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.451 Vali Acc: 0.275 Test Loss: 4.451 Test Acc: 0.275
Validation loss decreased (-0.269367 --> -0.275250).  Saving model ...
Epoch: 13 cost time: 1.2134051322937012
Epoch: 13, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.466 Vali Acc: 0.273 Test Loss: 4.466 Test Acc: 0.273
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2634010314941406
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.511 Vali Acc: 0.271 Test Loss: 4.511 Test Acc: 0.271
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1061792373657227
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.553 Vali Acc: 0.269 Test Loss: 4.553 Test Acc: 0.269
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.247208833694458
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.580 Vali Acc: 0.271 Test Loss: 4.580 Test Acc: 0.271
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.1411151885986328
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.620 Vali Acc: 0.267 Test Loss: 4.620 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.113999843597412
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.638 Vali Acc: 0.266 Test Loss: 4.638 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.164020299911499
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.664 Vali Acc: 0.268 Test Loss: 4.664 Test Acc: 0.268
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.2884528636932373
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.698 Vali Acc: 0.267 Test Loss: 4.698 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.3382060527801514
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.715 Vali Acc: 0.269 Test Loss: 4.715 Test Acc: 0.269
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.231447696685791
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.734 Vali Acc: 0.274 Test Loss: 4.734 Test Acc: 0.274
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2752941176470588
model parameter : 2378010
model size : 9.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps12_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.075892448425293
Epoch: 1, Steps: 10 | Train Loss: 3.304 Vali Loss: 3.246 Vali Acc: 0.053 Test Loss: 3.246 Test Acc: 0.053
Validation loss decreased (inf --> -0.052909).  Saving model ...
Epoch: 2 cost time: 1.0541963577270508
Epoch: 2, Steps: 10 | Train Loss: 2.752 Vali Loss: 3.232 Vali Acc: 0.112 Test Loss: 3.232 Test Acc: 0.112
Validation loss decreased (-0.052909 --> -0.111732).  Saving model ...
Epoch: 3 cost time: 1.2123823165893555
Epoch: 3, Steps: 10 | Train Loss: 1.926 Vali Loss: 3.197 Vali Acc: 0.166 Test Loss: 3.197 Test Acc: 0.166
Validation loss decreased (-0.111732 --> -0.165850).  Saving model ...
Epoch: 4 cost time: 1.154906988143921
Epoch: 4, Steps: 10 | Train Loss: 1.185 Vali Loss: 3.224 Vali Acc: 0.207 Test Loss: 3.224 Test Acc: 0.207
Validation loss decreased (-0.165850 --> -0.207027).  Saving model ...
Epoch: 5 cost time: 1.1892006397247314
Epoch: 5, Steps: 10 | Train Loss: 0.640 Vali Loss: 3.290 Vali Acc: 0.236 Test Loss: 3.290 Test Acc: 0.236
Validation loss decreased (-0.207027 --> -0.236438).  Saving model ...
Epoch: 6 cost time: 1.107942819595337
Epoch: 6, Steps: 10 | Train Loss: 0.287 Vali Loss: 3.548 Vali Acc: 0.261 Test Loss: 3.548 Test Acc: 0.261
Validation loss decreased (-0.236438 --> -0.261141).  Saving model ...
Epoch: 7 cost time: 1.112004041671753
Epoch: 7, Steps: 10 | Train Loss: 0.127 Vali Loss: 3.725 Vali Acc: 0.269 Test Loss: 3.725 Test Acc: 0.269
Validation loss decreased (-0.261141 --> -0.269375).  Saving model ...
Epoch: 8 cost time: 1.2404024600982666
Epoch: 8, Steps: 10 | Train Loss: 0.052 Vali Loss: 3.882 Vali Acc: 0.260 Test Loss: 3.882 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.325739860534668
Epoch: 9, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.006 Vali Acc: 0.264 Test Loss: 4.006 Test Acc: 0.264
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1094961166381836
Epoch: 10, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.097 Vali Acc: 0.274 Test Loss: 4.097 Test Acc: 0.274
Validation loss decreased (-0.269375 --> -0.274077).  Saving model ...
Epoch: 11 cost time: 1.1074440479278564
Epoch: 11, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.162 Vali Acc: 0.274 Test Loss: 4.162 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2261662483215332
Epoch: 12, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.185 Vali Acc: 0.280 Test Loss: 4.185 Test Acc: 0.280
Validation loss decreased (-0.274077 --> -0.279958).  Saving model ...
Epoch: 13 cost time: 1.1885590553283691
Epoch: 13, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.237 Vali Acc: 0.281 Test Loss: 4.237 Test Acc: 0.281
Validation loss decreased (-0.279958 --> -0.281134).  Saving model ...
Epoch: 14 cost time: 1.018604040145874
Epoch: 14, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.269 Vali Acc: 0.276 Test Loss: 4.269 Test Acc: 0.276
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1787121295928955
Epoch: 15, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.304 Vali Acc: 0.278 Test Loss: 4.304 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.292464256286621
Epoch: 16, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.328 Vali Acc: 0.280 Test Loss: 4.328 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.1723318099975586
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.366 Vali Acc: 0.280 Test Loss: 4.366 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.1943902969360352
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.398 Vali Acc: 0.280 Test Loss: 4.398 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.163883924484253
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.437 Vali Acc: 0.281 Test Loss: 4.437 Test Acc: 0.281
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.148463487625122
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.460 Vali Acc: 0.281 Test Loss: 4.460 Test Acc: 0.281
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.1337831020355225
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.483 Vali Acc: 0.279 Test Loss: 4.483 Test Acc: 0.279
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.199636459350586
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.506 Vali Acc: 0.279 Test Loss: 4.506 Test Acc: 0.279
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.252173662185669
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.543 Vali Acc: 0.279 Test Loss: 4.543 Test Acc: 0.279
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps12_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2811764705882353
model parameter : 2119450
model size : 8.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.8547048568725586
Epoch: 1, Steps: 10 | Train Loss: 3.359 Vali Loss: 3.273 Vali Acc: 0.049 Test Loss: 3.273 Test Acc: 0.049
Validation loss decreased (inf --> -0.049379).  Saving model ...
Epoch: 2 cost time: 1.0148274898529053
Epoch: 2, Steps: 10 | Train Loss: 2.881 Vali Loss: 3.237 Vali Acc: 0.095 Test Loss: 3.237 Test Acc: 0.095
Validation loss decreased (-0.049379 --> -0.095262).  Saving model ...
Epoch: 3 cost time: 1.120598316192627
Epoch: 3, Steps: 10 | Train Loss: 2.181 Vali Loss: 3.214 Vali Acc: 0.135 Test Loss: 3.214 Test Acc: 0.135
Validation loss decreased (-0.095262 --> -0.135262).  Saving model ...
Epoch: 4 cost time: 1.0650136470794678
Epoch: 4, Steps: 10 | Train Loss: 1.492 Vali Loss: 3.175 Vali Acc: 0.193 Test Loss: 3.175 Test Acc: 0.193
Validation loss decreased (-0.135262 --> -0.192909).  Saving model ...
Epoch: 5 cost time: 1.0974338054656982
Epoch: 5, Steps: 10 | Train Loss: 0.925 Vali Loss: 3.225 Vali Acc: 0.220 Test Loss: 3.225 Test Acc: 0.220
Validation loss decreased (-0.192909 --> -0.219968).  Saving model ...
Epoch: 6 cost time: 0.9915814399719238
Epoch: 6, Steps: 10 | Train Loss: 0.514 Vali Loss: 3.316 Vali Acc: 0.253 Test Loss: 3.316 Test Acc: 0.253
Validation loss decreased (-0.219968 --> -0.252908).  Saving model ...
Epoch: 7 cost time: 0.9744961261749268
Epoch: 7, Steps: 10 | Train Loss: 0.287 Vali Loss: 3.509 Vali Acc: 0.255 Test Loss: 3.509 Test Acc: 0.255
Validation loss decreased (-0.252908 --> -0.255259).  Saving model ...
Epoch: 8 cost time: 1.0038130283355713
Epoch: 8, Steps: 10 | Train Loss: 0.133 Vali Loss: 3.663 Vali Acc: 0.265 Test Loss: 3.663 Test Acc: 0.265
Validation loss decreased (-0.255259 --> -0.264669).  Saving model ...
Epoch: 9 cost time: 1.0299396514892578
Epoch: 9, Steps: 10 | Train Loss: 0.065 Vali Loss: 3.738 Vali Acc: 0.284 Test Loss: 3.738 Test Acc: 0.284
Validation loss decreased (-0.264669 --> -0.283492).  Saving model ...
Epoch: 10 cost time: 0.8908827304840088
Epoch: 10, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.844 Vali Acc: 0.284 Test Loss: 3.844 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3143577575683594
Epoch: 11, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.945 Vali Acc: 0.268 Test Loss: 3.945 Test Acc: 0.268
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1982319355010986
Epoch: 12, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.009 Vali Acc: 0.273 Test Loss: 4.009 Test Acc: 0.273
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.0992178916931152
Epoch: 13, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.039 Vali Acc: 0.271 Test Loss: 4.039 Test Acc: 0.271
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.9065361022949219
Epoch: 14, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.058 Vali Acc: 0.276 Test Loss: 4.058 Test Acc: 0.276
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.1126453876495361
Epoch: 15, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.093 Vali Acc: 0.282 Test Loss: 4.093 Test Acc: 0.282
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.2087972164154053
Epoch: 16, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.133 Vali Acc: 0.279 Test Loss: 4.133 Test Acc: 0.279
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.1625428199768066
Epoch: 17, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.171 Vali Acc: 0.281 Test Loss: 4.171 Test Acc: 0.281
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.179306983947754
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.211 Vali Acc: 0.276 Test Loss: 4.211 Test Acc: 0.276
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.013702392578125
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.230 Vali Acc: 0.278 Test Loss: 4.230 Test Acc: 0.278
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.28352941176470586
model parameter : 2000666
model size : 7.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps23_str12_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.7468535900115967
Epoch: 1, Steps: 10 | Train Loss: 3.362 Vali Loss: 3.263 Vali Acc: 0.047 Test Loss: 3.263 Test Acc: 0.047
Validation loss decreased (inf --> -0.047026).  Saving model ...
Epoch: 2 cost time: 1.058581829071045
Epoch: 2, Steps: 10 | Train Loss: 3.061 Vali Loss: 3.229 Vali Acc: 0.100 Test Loss: 3.229 Test Acc: 0.100
Validation loss decreased (-0.047026 --> -0.099968).  Saving model ...
Epoch: 3 cost time: 1.118161678314209
Epoch: 3, Steps: 10 | Train Loss: 2.566 Vali Loss: 3.226 Vali Acc: 0.129 Test Loss: 3.226 Test Acc: 0.129
Validation loss decreased (-0.099968 --> -0.129380).  Saving model ...
Epoch: 4 cost time: 1.1437528133392334
Epoch: 4, Steps: 10 | Train Loss: 2.016 Vali Loss: 3.181 Vali Acc: 0.151 Test Loss: 3.181 Test Acc: 0.151
Validation loss decreased (-0.129380 --> -0.150556).  Saving model ...
Epoch: 5 cost time: 1.1494338512420654
Epoch: 5, Steps: 10 | Train Loss: 1.486 Vali Loss: 3.143 Vali Acc: 0.189 Test Loss: 3.143 Test Acc: 0.189
Validation loss decreased (-0.150556 --> -0.189380).  Saving model ...
Epoch: 6 cost time: 1.1705007553100586
Epoch: 6, Steps: 10 | Train Loss: 1.019 Vali Loss: 3.170 Vali Acc: 0.220 Test Loss: 3.170 Test Acc: 0.220
Validation loss decreased (-0.189380 --> -0.219968).  Saving model ...
Epoch: 7 cost time: 1.1979169845581055
Epoch: 7, Steps: 10 | Train Loss: 0.655 Vali Loss: 3.235 Vali Acc: 0.234 Test Loss: 3.235 Test Acc: 0.234
Validation loss decreased (-0.219968 --> -0.234085).  Saving model ...
Epoch: 8 cost time: 1.2134332656860352
Epoch: 8, Steps: 10 | Train Loss: 0.413 Vali Loss: 3.299 Vali Acc: 0.255 Test Loss: 3.299 Test Acc: 0.255
Validation loss decreased (-0.234085 --> -0.255261).  Saving model ...
Epoch: 9 cost time: 1.1516811847686768
Epoch: 9, Steps: 10 | Train Loss: 0.256 Vali Loss: 3.444 Vali Acc: 0.256 Test Loss: 3.444 Test Acc: 0.256
Validation loss decreased (-0.255261 --> -0.256436).  Saving model ...
Epoch: 10 cost time: 1.1931672096252441
Epoch: 10, Steps: 10 | Train Loss: 0.143 Vali Loss: 3.548 Vali Acc: 0.264 Test Loss: 3.548 Test Acc: 0.264
Validation loss decreased (-0.256436 --> -0.263494).  Saving model ...
Epoch: 11 cost time: 1.166301965713501
Epoch: 11, Steps: 10 | Train Loss: 0.082 Vali Loss: 3.628 Vali Acc: 0.272 Test Loss: 3.628 Test Acc: 0.272
Validation loss decreased (-0.263494 --> -0.271728).  Saving model ...
Epoch: 12 cost time: 1.3016057014465332
Epoch: 12, Steps: 10 | Train Loss: 0.050 Vali Loss: 3.696 Vali Acc: 0.268 Test Loss: 3.696 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.342111349105835
Epoch: 13, Steps: 10 | Train Loss: 0.037 Vali Loss: 3.753 Vali Acc: 0.278 Test Loss: 3.753 Test Acc: 0.278
Validation loss decreased (-0.271728 --> -0.277610).  Saving model ...
Epoch: 14 cost time: 0.9737706184387207
Epoch: 14, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.792 Vali Acc: 0.280 Test Loss: 3.792 Test Acc: 0.280
Validation loss decreased (-0.277610 --> -0.279962).  Saving model ...
Epoch: 15 cost time: 1.17557954788208
Epoch: 15, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.840 Vali Acc: 0.278 Test Loss: 3.840 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1080665588378906
Epoch: 16, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.879 Vali Acc: 0.276 Test Loss: 3.879 Test Acc: 0.276
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.1262719631195068
Epoch: 17, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.917 Vali Acc: 0.279 Test Loss: 3.917 Test Acc: 0.279
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.1713204383850098
Epoch: 18, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.959 Vali Acc: 0.281 Test Loss: 3.959 Test Acc: 0.281
Validation loss decreased (-0.279962 --> -0.281137).  Saving model ...
Epoch: 19 cost time: 1.2488934993743896
Epoch: 19, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.981 Vali Acc: 0.287 Test Loss: 3.981 Test Acc: 0.287
Validation loss decreased (-0.281137 --> -0.287019).  Saving model ...
Epoch: 20 cost time: 1.1027781963348389
Epoch: 20, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.999 Vali Acc: 0.285 Test Loss: 3.999 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8814988136291504
Epoch: 21, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.032 Vali Acc: 0.286 Test Loss: 4.032 Test Acc: 0.286
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.917616605758667
Epoch: 22, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.072 Vali Acc: 0.284 Test Loss: 4.072 Test Acc: 0.284
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.0868911743164062
Epoch: 23, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.083 Vali Acc: 0.286 Test Loss: 4.083 Test Acc: 0.286
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.1485719680786133
Epoch: 24, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.103 Vali Acc: 0.289 Test Loss: 4.103 Test Acc: 0.289
Validation loss decreased (-0.287019 --> -0.289371).  Saving model ...
Epoch: 25 cost time: 0.9671428203582764
Epoch: 25, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.140 Vali Acc: 0.287 Test Loss: 4.140 Test Acc: 0.287
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.111311435699463
Epoch: 26, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.170 Vali Acc: 0.289 Test Loss: 4.170 Test Acc: 0.289
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.1390645503997803
Epoch: 27, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.215 Vali Acc: 0.291 Test Loss: 4.215 Test Acc: 0.291
Validation loss decreased (-0.289371 --> -0.290546).  Saving model ...
Epoch: 28 cost time: 1.0622949600219727
Epoch: 28, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.239 Vali Acc: 0.289 Test Loss: 4.239 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.2665061950683594
Epoch: 29, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.251 Vali Acc: 0.289 Test Loss: 4.251 Test Acc: 0.289
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.059772253036499
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.288 Vali Acc: 0.291 Test Loss: 4.288 Test Acc: 0.291
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.3169240951538086
Epoch: 31, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.302 Vali Acc: 0.291 Test Loss: 4.302 Test Acc: 0.291
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.9267184734344482
Epoch: 32, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.324 Vali Acc: 0.289 Test Loss: 4.324 Test Acc: 0.289
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.0662479400634766
Epoch: 33, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.353 Vali Acc: 0.288 Test Loss: 4.353 Test Acc: 0.288
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.1591582298278809
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.372 Vali Acc: 0.291 Test Loss: 4.372 Test Acc: 0.291
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.024744987487793
Epoch: 35, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.392 Vali Acc: 0.289 Test Loss: 4.392 Test Acc: 0.289
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.9920048713684082
Epoch: 36, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.426 Vali Acc: 0.289 Test Loss: 4.426 Test Acc: 0.289
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.0336287021636963
Epoch: 37, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.446 Vali Acc: 0.291 Test Loss: 4.446 Test Acc: 0.291
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps23_str12_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.29058823529411765
model parameter : 1862682
model size : 7.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.6415395736694336
Epoch: 1, Steps: 10 | Train Loss: 3.377 Vali Loss: 3.300 Vali Acc: 0.036 Test Loss: 3.300 Test Acc: 0.036
Validation loss decreased (inf --> -0.036438).  Saving model ...
Epoch: 2 cost time: 1.2225830554962158
Epoch: 2, Steps: 10 | Train Loss: 3.128 Vali Loss: 3.275 Vali Acc: 0.053 Test Loss: 3.275 Test Acc: 0.053
Validation loss decreased (-0.036438 --> -0.052908).  Saving model ...
Epoch: 3 cost time: 1.037717342376709
Epoch: 3, Steps: 10 | Train Loss: 2.706 Vali Loss: 3.249 Vali Acc: 0.093 Test Loss: 3.249 Test Acc: 0.093
Validation loss decreased (-0.052908 --> -0.092909).  Saving model ...
Epoch: 4 cost time: 0.928300142288208
Epoch: 4, Steps: 10 | Train Loss: 2.277 Vali Loss: 3.217 Vali Acc: 0.148 Test Loss: 3.217 Test Acc: 0.148
Validation loss decreased (-0.092909 --> -0.148203).  Saving model ...
Epoch: 5 cost time: 1.1025984287261963
Epoch: 5, Steps: 10 | Train Loss: 1.823 Vali Loss: 3.186 Vali Acc: 0.181 Test Loss: 3.186 Test Acc: 0.181
Validation loss decreased (-0.148203 --> -0.181145).  Saving model ...
Epoch: 6 cost time: 0.9453940391540527
Epoch: 6, Steps: 10 | Train Loss: 1.366 Vali Loss: 3.171 Vali Acc: 0.194 Test Loss: 3.171 Test Acc: 0.194
Validation loss decreased (-0.181145 --> -0.194086).  Saving model ...
Epoch: 7 cost time: 0.907869815826416
Epoch: 7, Steps: 10 | Train Loss: 1.025 Vali Loss: 3.168 Vali Acc: 0.224 Test Loss: 3.168 Test Acc: 0.224
Validation loss decreased (-0.194086 --> -0.223498).  Saving model ...
Epoch: 8 cost time: 1.3002774715423584
Epoch: 8, Steps: 10 | Train Loss: 0.708 Vali Loss: 3.204 Vali Acc: 0.252 Test Loss: 3.204 Test Acc: 0.252
Validation loss decreased (-0.223498 --> -0.251733).  Saving model ...
Epoch: 9 cost time: 1.2440216541290283
Epoch: 9, Steps: 10 | Train Loss: 0.480 Vali Loss: 3.300 Vali Acc: 0.265 Test Loss: 3.300 Test Acc: 0.265
Validation loss decreased (-0.251733 --> -0.264673).  Saving model ...
Epoch: 10 cost time: 1.2411212921142578
Epoch: 10, Steps: 10 | Train Loss: 0.295 Vali Loss: 3.370 Vali Acc: 0.262 Test Loss: 3.370 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.193406581878662
Epoch: 11, Steps: 10 | Train Loss: 0.192 Vali Loss: 3.450 Vali Acc: 0.274 Test Loss: 3.450 Test Acc: 0.274
Validation loss decreased (-0.264673 --> -0.274083).  Saving model ...
Epoch: 12 cost time: 0.9137899875640869
Epoch: 12, Steps: 10 | Train Loss: 0.116 Vali Loss: 3.534 Vali Acc: 0.281 Test Loss: 3.534 Test Acc: 0.281
Validation loss decreased (-0.274083 --> -0.281141).  Saving model ...
Epoch: 13 cost time: 1.0965626239776611
Epoch: 13, Steps: 10 | Train Loss: 0.076 Vali Loss: 3.613 Vali Acc: 0.286 Test Loss: 3.613 Test Acc: 0.286
Validation loss decreased (-0.281141 --> -0.285846).  Saving model ...
Epoch: 14 cost time: 1.1891529560089111
Epoch: 14, Steps: 10 | Train Loss: 0.054 Vali Loss: 3.731 Vali Acc: 0.271 Test Loss: 3.731 Test Acc: 0.271
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1480047702789307
Epoch: 15, Steps: 10 | Train Loss: 0.038 Vali Loss: 3.765 Vali Acc: 0.278 Test Loss: 3.765 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0788631439208984
Epoch: 16, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.801 Vali Acc: 0.278 Test Loss: 3.801 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.2969627380371094
Epoch: 17, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.837 Vali Acc: 0.276 Test Loss: 3.837 Test Acc: 0.276
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.2594385147094727
Epoch: 18, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.886 Vali Acc: 0.279 Test Loss: 3.886 Test Acc: 0.279
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.2565374374389648
Epoch: 19, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.927 Vali Acc: 0.284 Test Loss: 3.927 Test Acc: 0.284
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.258000135421753
Epoch: 20, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.965 Vali Acc: 0.284 Test Loss: 3.965 Test Acc: 0.284
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.3296940326690674
Epoch: 21, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.998 Vali Acc: 0.279 Test Loss: 3.998 Test Acc: 0.279
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.0005722045898438
Epoch: 22, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.026 Vali Acc: 0.280 Test Loss: 4.026 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.9878294467926025
Epoch: 23, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.060 Vali Acc: 0.280 Test Loss: 4.060 Test Acc: 0.280
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2858823529411765
model parameter : 1804826
model size : 6.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps38_str19_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.7147464752197266
Epoch: 1, Steps: 10 | Train Loss: 3.303 Vali Loss: 3.269 Vali Acc: 0.049 Test Loss: 3.269 Test Acc: 0.049
Validation loss decreased (inf --> -0.049379).  Saving model ...
Epoch: 2 cost time: 0.9396073818206787
Epoch: 2, Steps: 10 | Train Loss: 3.058 Vali Loss: 3.247 Vali Acc: 0.073 Test Loss: 3.247 Test Acc: 0.073
Validation loss decreased (-0.049379 --> -0.072909).  Saving model ...
Epoch: 3 cost time: 1.0853567123413086
Epoch: 3, Steps: 10 | Train Loss: 2.734 Vali Loss: 3.227 Vali Acc: 0.098 Test Loss: 3.227 Test Acc: 0.098
Validation loss decreased (-0.072909 --> -0.097615).  Saving model ...
Epoch: 4 cost time: 0.9807617664337158
Epoch: 4, Steps: 10 | Train Loss: 2.335 Vali Loss: 3.219 Vali Acc: 0.136 Test Loss: 3.219 Test Acc: 0.136
Validation loss decreased (-0.097615 --> -0.136438).  Saving model ...
Epoch: 5 cost time: 1.023303747177124
Epoch: 5, Steps: 10 | Train Loss: 1.909 Vali Loss: 3.187 Vali Acc: 0.167 Test Loss: 3.187 Test Acc: 0.167
Validation loss decreased (-0.136438 --> -0.167027).  Saving model ...
Epoch: 6 cost time: 0.9470851421356201
Epoch: 6, Steps: 10 | Train Loss: 1.517 Vali Loss: 3.157 Vali Acc: 0.196 Test Loss: 3.157 Test Acc: 0.196
Validation loss decreased (-0.167027 --> -0.196439).  Saving model ...
Epoch: 7 cost time: 0.9129946231842041
Epoch: 7, Steps: 10 | Train Loss: 1.132 Vali Loss: 3.144 Vali Acc: 0.224 Test Loss: 3.144 Test Acc: 0.224
Validation loss decreased (-0.196439 --> -0.223498).  Saving model ...
Epoch: 8 cost time: 0.9556968212127686
Epoch: 8, Steps: 10 | Train Loss: 0.835 Vali Loss: 3.177 Vali Acc: 0.238 Test Loss: 3.177 Test Acc: 0.238
Validation loss decreased (-0.223498 --> -0.237615).  Saving model ...
Epoch: 9 cost time: 0.9063973426818848
Epoch: 9, Steps: 10 | Train Loss: 0.602 Vali Loss: 3.261 Vali Acc: 0.236 Test Loss: 3.261 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8527815341949463
Epoch: 10, Steps: 10 | Train Loss: 0.400 Vali Loss: 3.317 Vali Acc: 0.256 Test Loss: 3.317 Test Acc: 0.256
Validation loss decreased (-0.237615 --> -0.256437).  Saving model ...
Epoch: 11 cost time: 0.9427285194396973
Epoch: 11, Steps: 10 | Train Loss: 0.266 Vali Loss: 3.379 Vali Acc: 0.272 Test Loss: 3.379 Test Acc: 0.272
Validation loss decreased (-0.256437 --> -0.271731).  Saving model ...
Epoch: 12 cost time: 0.9671304225921631
Epoch: 12, Steps: 10 | Train Loss: 0.158 Vali Loss: 3.454 Vali Acc: 0.268 Test Loss: 3.454 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9956247806549072
Epoch: 13, Steps: 10 | Train Loss: 0.107 Vali Loss: 3.570 Vali Acc: 0.256 Test Loss: 3.570 Test Acc: 0.256
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9915010929107666
Epoch: 14, Steps: 10 | Train Loss: 0.070 Vali Loss: 3.608 Vali Acc: 0.273 Test Loss: 3.608 Test Acc: 0.273
Validation loss decreased (-0.271731 --> -0.272905).  Saving model ...
Epoch: 15 cost time: 0.9639530181884766
Epoch: 15, Steps: 10 | Train Loss: 0.052 Vali Loss: 3.655 Vali Acc: 0.278 Test Loss: 3.655 Test Acc: 0.278
Validation loss decreased (-0.272905 --> -0.277611).  Saving model ...
Epoch: 16 cost time: 0.9199681282043457
Epoch: 16, Steps: 10 | Train Loss: 0.039 Vali Loss: 3.703 Vali Acc: 0.276 Test Loss: 3.703 Test Acc: 0.276
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9825949668884277
Epoch: 17, Steps: 10 | Train Loss: 0.031 Vali Loss: 3.738 Vali Acc: 0.272 Test Loss: 3.738 Test Acc: 0.272
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8516156673431396
Epoch: 18, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.781 Vali Acc: 0.271 Test Loss: 3.781 Test Acc: 0.271
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.9447712898254395
Epoch: 19, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.842 Vali Acc: 0.273 Test Loss: 3.842 Test Acc: 0.273
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.8399021625518799
Epoch: 20, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.883 Vali Acc: 0.274 Test Loss: 3.883 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.9308145046234131
Epoch: 21, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.900 Vali Acc: 0.268 Test Loss: 3.900 Test Acc: 0.268
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.0331037044525146
Epoch: 22, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.930 Vali Acc: 0.271 Test Loss: 3.930 Test Acc: 0.271
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.1240439414978027
Epoch: 23, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.961 Vali Acc: 0.272 Test Loss: 3.961 Test Acc: 0.272
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.9800891876220703
Epoch: 24, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.996 Vali Acc: 0.271 Test Loss: 3.996 Test Acc: 0.271
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.9913272857666016
Epoch: 25, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.000 Vali Acc: 0.273 Test Loss: 4.000 Test Acc: 0.273
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps38_str19_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2776470588235294
model parameter : 1786650
model size : 6.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.7856807708740234
Epoch: 1, Steps: 10 | Train Loss: 3.373 Vali Loss: 3.266 Vali Acc: 0.066 Test Loss: 3.266 Test Acc: 0.066
Validation loss decreased (inf --> -0.065850).  Saving model ...
Epoch: 2 cost time: 1.0512561798095703
Epoch: 2, Steps: 10 | Train Loss: 2.559 Vali Loss: 3.288 Vali Acc: 0.112 Test Loss: 3.288 Test Acc: 0.112
Validation loss decreased (-0.065850 --> -0.111732).  Saving model ...
Epoch: 3 cost time: 1.285494327545166
Epoch: 3, Steps: 10 | Train Loss: 1.540 Vali Loss: 3.232 Vali Acc: 0.200 Test Loss: 3.232 Test Acc: 0.200
Validation loss decreased (-0.111732 --> -0.199968).  Saving model ...
Epoch: 4 cost time: 1.1163489818572998
Epoch: 4, Steps: 10 | Train Loss: 0.717 Vali Loss: 3.332 Vali Acc: 0.238 Test Loss: 3.332 Test Acc: 0.238
Validation loss decreased (-0.199968 --> -0.237614).  Saving model ...
Epoch: 5 cost time: 1.2085864543914795
Epoch: 5, Steps: 10 | Train Loss: 0.315 Vali Loss: 3.618 Vali Acc: 0.247 Test Loss: 3.618 Test Acc: 0.247
Validation loss decreased (-0.237614 --> -0.247023).  Saving model ...
Epoch: 6 cost time: 1.1479129791259766
Epoch: 6, Steps: 10 | Train Loss: 0.104 Vali Loss: 3.963 Vali Acc: 0.239 Test Loss: 3.963 Test Acc: 0.239
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0641794204711914
Epoch: 7, Steps: 10 | Train Loss: 0.039 Vali Loss: 4.154 Vali Acc: 0.249 Test Loss: 4.154 Test Acc: 0.249
Validation loss decreased (-0.247023 --> -0.249370).  Saving model ...
Epoch: 8 cost time: 1.2886276245117188
Epoch: 8, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.294 Vali Acc: 0.248 Test Loss: 4.294 Test Acc: 0.248
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9946045875549316
Epoch: 9, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.282 Vali Acc: 0.259 Test Loss: 4.282 Test Acc: 0.259
Validation loss decreased (-0.249370 --> -0.258781).  Saving model ...
Epoch: 10 cost time: 0.959620475769043
Epoch: 10, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.375 Vali Acc: 0.262 Test Loss: 4.375 Test Acc: 0.262
Validation loss decreased (-0.258781 --> -0.262309).  Saving model ...
Epoch: 11 cost time: 0.9781033992767334
Epoch: 11, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.429 Vali Acc: 0.260 Test Loss: 4.429 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0286710262298584
Epoch: 12, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.453 Vali Acc: 0.260 Test Loss: 4.453 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.0721919536590576
Epoch: 13, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.466 Vali Acc: 0.258 Test Loss: 4.466 Test Acc: 0.258
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.176534652709961
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.500 Vali Acc: 0.262 Test Loss: 4.500 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.1110620498657227
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.534 Vali Acc: 0.261 Test Loss: 4.534 Test Acc: 0.261
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.9287576675415039
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.554 Vali Acc: 0.261 Test Loss: 4.554 Test Acc: 0.261
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.0591633319854736
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.584 Vali Acc: 0.264 Test Loss: 4.584 Test Acc: 0.264
Validation loss decreased (-0.262309 --> -0.263484).  Saving model ...
Epoch: 18 cost time: 1.0980284214019775
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.602 Vali Acc: 0.261 Test Loss: 4.602 Test Acc: 0.261
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.160428524017334
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.622 Vali Acc: 0.262 Test Loss: 4.622 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.0189664363861084
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.627 Vali Acc: 0.261 Test Loss: 4.627 Test Acc: 0.261
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.1748991012573242
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.666 Vali Acc: 0.262 Test Loss: 4.666 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.1651813983917236
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.698 Vali Acc: 0.264 Test Loss: 4.698 Test Acc: 0.264
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.1033177375793457
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.714 Vali Acc: 0.262 Test Loss: 4.714 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.1541931629180908
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.745 Vali Acc: 0.268 Test Loss: 4.745 Test Acc: 0.268
Validation loss decreased (-0.263484 --> -0.268188).  Saving model ...
Epoch: 25 cost time: 1.1269049644470215
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.774 Vali Acc: 0.266 Test Loss: 4.774 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.3287429809570312
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.796 Vali Acc: 0.268 Test Loss: 4.796 Test Acc: 0.268
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.0201725959777832
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.824 Vali Acc: 0.266 Test Loss: 4.824 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.2264928817749023
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.840 Vali Acc: 0.266 Test Loss: 4.840 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.086169719696045
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.866 Vali Acc: 0.264 Test Loss: 4.866 Test Acc: 0.264
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.0507056713104248
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.891 Vali Acc: 0.267 Test Loss: 4.891 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.2875356674194336
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.908 Vali Acc: 0.268 Test Loss: 4.908 Test Acc: 0.268
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.0354080200195312
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.926 Vali Acc: 0.268 Test Loss: 4.926 Test Acc: 0.268
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.9729259014129639
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.940 Vali Acc: 0.267 Test Loss: 4.940 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.9075074195861816
Epoch: 34, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.961 Vali Acc: 0.268 Test Loss: 4.961 Test Acc: 0.268
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26823529411764707
model parameter : 1174682
model size : 4.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.743494987487793
Epoch: 1, Steps: 10 | Train Loss: 3.322 Vali Loss: 3.271 Vali Acc: 0.064 Test Loss: 3.271 Test Acc: 0.064
Validation loss decreased (inf --> -0.063497).  Saving model ...
Epoch: 2 cost time: 0.8748445510864258
Epoch: 2, Steps: 10 | Train Loss: 2.818 Vali Loss: 3.236 Vali Acc: 0.101 Test Loss: 3.236 Test Acc: 0.101
Validation loss decreased (-0.063497 --> -0.101144).  Saving model ...
Epoch: 3 cost time: 0.8767969608306885
Epoch: 3, Steps: 10 | Train Loss: 2.184 Vali Loss: 3.241 Vali Acc: 0.133 Test Loss: 3.241 Test Acc: 0.133
Validation loss decreased (-0.101144 --> -0.132909).  Saving model ...
Epoch: 4 cost time: 0.8519432544708252
Epoch: 4, Steps: 10 | Train Loss: 1.535 Vali Loss: 3.199 Vali Acc: 0.211 Test Loss: 3.199 Test Acc: 0.211
Validation loss decreased (-0.132909 --> -0.210556).  Saving model ...
Epoch: 5 cost time: 0.83575439453125
Epoch: 5, Steps: 10 | Train Loss: 0.953 Vali Loss: 3.269 Vali Acc: 0.199 Test Loss: 3.269 Test Acc: 0.199
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8343296051025391
Epoch: 6, Steps: 10 | Train Loss: 0.567 Vali Loss: 3.351 Vali Acc: 0.226 Test Loss: 3.351 Test Acc: 0.226
Validation loss decreased (-0.210556 --> -0.225849).  Saving model ...
Epoch: 7 cost time: 0.9003505706787109
Epoch: 7, Steps: 10 | Train Loss: 0.318 Vali Loss: 3.542 Vali Acc: 0.248 Test Loss: 3.542 Test Acc: 0.248
Validation loss decreased (-0.225849 --> -0.248200).  Saving model ...
Epoch: 8 cost time: 1.0499544143676758
Epoch: 8, Steps: 10 | Train Loss: 0.167 Vali Loss: 3.664 Vali Acc: 0.259 Test Loss: 3.664 Test Acc: 0.259
Validation loss decreased (-0.248200 --> -0.258787).  Saving model ...
Epoch: 9 cost time: 1.147639513015747
Epoch: 9, Steps: 10 | Train Loss: 0.080 Vali Loss: 3.802 Vali Acc: 0.249 Test Loss: 3.802 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9898102283477783
Epoch: 10, Steps: 10 | Train Loss: 0.040 Vali Loss: 3.901 Vali Acc: 0.252 Test Loss: 3.901 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9544222354888916
Epoch: 11, Steps: 10 | Train Loss: 0.027 Vali Loss: 3.973 Vali Acc: 0.251 Test Loss: 3.973 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.7865936756134033
Epoch: 12, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.041 Vali Acc: 0.259 Test Loss: 4.041 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.7912764549255371
Epoch: 13, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.075 Vali Acc: 0.259 Test Loss: 4.075 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.0892407894134521
Epoch: 14, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.107 Vali Acc: 0.262 Test Loss: 4.107 Test Acc: 0.262
Validation loss decreased (-0.258787 --> -0.262312).  Saving model ...
Epoch: 15 cost time: 0.8372995853424072
Epoch: 15, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.172 Vali Acc: 0.258 Test Loss: 4.172 Test Acc: 0.258
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9238636493682861
Epoch: 16, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.204 Vali Acc: 0.259 Test Loss: 4.204 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.908104658126831
Epoch: 17, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.252 Vali Acc: 0.256 Test Loss: 4.252 Test Acc: 0.256
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.8663532733917236
Epoch: 18, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.274 Vali Acc: 0.258 Test Loss: 4.274 Test Acc: 0.258
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.8614530563354492
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.307 Vali Acc: 0.258 Test Loss: 4.307 Test Acc: 0.258
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.8853001594543457
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.351 Vali Acc: 0.258 Test Loss: 4.351 Test Acc: 0.258
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.7752969264984131
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.380 Vali Acc: 0.259 Test Loss: 4.380 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.9281680583953857
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.415 Vali Acc: 0.262 Test Loss: 4.415 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.9726009368896484
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.438 Vali Acc: 0.259 Test Loss: 4.438 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.9794290065765381
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.469 Vali Acc: 0.258 Test Loss: 4.469 Test Acc: 0.258
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26235294117647057
model parameter : 795802
model size : 3.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps12_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.767934799194336
Epoch: 1, Steps: 10 | Train Loss: 3.341 Vali Loss: 3.281 Vali Acc: 0.045 Test Loss: 3.281 Test Acc: 0.045
Validation loss decreased (inf --> -0.044673).  Saving model ...
Epoch: 2 cost time: 0.9980900287628174
Epoch: 2, Steps: 10 | Train Loss: 3.021 Vali Loss: 3.257 Vali Acc: 0.069 Test Loss: 3.257 Test Acc: 0.069
Validation loss decreased (-0.044673 --> -0.069379).  Saving model ...
Epoch: 3 cost time: 0.9182431697845459
Epoch: 3, Steps: 10 | Train Loss: 2.504 Vali Loss: 3.236 Vali Acc: 0.124 Test Loss: 3.236 Test Acc: 0.124
Validation loss decreased (-0.069379 --> -0.123497).  Saving model ...
Epoch: 4 cost time: 0.9862606525421143
Epoch: 4, Steps: 10 | Train Loss: 2.020 Vali Loss: 3.206 Vali Acc: 0.154 Test Loss: 3.206 Test Acc: 0.154
Validation loss decreased (-0.123497 --> -0.154086).  Saving model ...
Epoch: 5 cost time: 1.0503406524658203
Epoch: 5, Steps: 10 | Train Loss: 1.473 Vali Loss: 3.195 Vali Acc: 0.186 Test Loss: 3.195 Test Acc: 0.186
Validation loss decreased (-0.154086 --> -0.185850).  Saving model ...
Epoch: 6 cost time: 0.9657576084136963
Epoch: 6, Steps: 10 | Train Loss: 1.037 Vali Loss: 3.215 Vali Acc: 0.221 Test Loss: 3.215 Test Acc: 0.221
Validation loss decreased (-0.185850 --> -0.221144).  Saving model ...
Epoch: 7 cost time: 0.9547548294067383
Epoch: 7, Steps: 10 | Train Loss: 0.682 Vali Loss: 3.284 Vali Acc: 0.233 Test Loss: 3.284 Test Acc: 0.233
Validation loss decreased (-0.221144 --> -0.232908).  Saving model ...
Epoch: 8 cost time: 0.9650301933288574
Epoch: 8, Steps: 10 | Train Loss: 0.419 Vali Loss: 3.372 Vali Acc: 0.236 Test Loss: 3.372 Test Acc: 0.236
Validation loss decreased (-0.232908 --> -0.236437).  Saving model ...
Epoch: 9 cost time: 0.8224775791168213
Epoch: 9, Steps: 10 | Train Loss: 0.251 Vali Loss: 3.486 Vali Acc: 0.254 Test Loss: 3.486 Test Acc: 0.254
Validation loss decreased (-0.236437 --> -0.254083).  Saving model ...
Epoch: 10 cost time: 0.7949767112731934
Epoch: 10, Steps: 10 | Train Loss: 0.139 Vali Loss: 3.596 Vali Acc: 0.258 Test Loss: 3.596 Test Acc: 0.258
Validation loss decreased (-0.254083 --> -0.257611).  Saving model ...
Epoch: 11 cost time: 0.7979779243469238
Epoch: 11, Steps: 10 | Train Loss: 0.084 Vali Loss: 3.739 Vali Acc: 0.248 Test Loss: 3.739 Test Acc: 0.248
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8104734420776367
Epoch: 12, Steps: 10 | Train Loss: 0.052 Vali Loss: 3.828 Vali Acc: 0.241 Test Loss: 3.828 Test Acc: 0.241
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.0139288902282715
Epoch: 13, Steps: 10 | Train Loss: 0.038 Vali Loss: 3.853 Vali Acc: 0.259 Test Loss: 3.853 Test Acc: 0.259
Validation loss decreased (-0.257611 --> -0.258785).  Saving model ...
Epoch: 14 cost time: 0.9430608749389648
Epoch: 14, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.907 Vali Acc: 0.261 Test Loss: 3.907 Test Acc: 0.261
Validation loss decreased (-0.258785 --> -0.261137).  Saving model ...
Epoch: 15 cost time: 1.0435612201690674
Epoch: 15, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.977 Vali Acc: 0.266 Test Loss: 3.977 Test Acc: 0.266
Validation loss decreased (-0.261137 --> -0.265843).  Saving model ...
Epoch: 16 cost time: 0.8610551357269287
Epoch: 16, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.024 Vali Acc: 0.267 Test Loss: 4.024 Test Acc: 0.267
Validation loss decreased (-0.265843 --> -0.267019).  Saving model ...
Epoch: 17 cost time: 0.8729324340820312
Epoch: 17, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.067 Vali Acc: 0.260 Test Loss: 4.067 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.017953872680664
Epoch: 18, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.111 Vali Acc: 0.262 Test Loss: 4.111 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8548762798309326
Epoch: 19, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.145 Vali Acc: 0.264 Test Loss: 4.145 Test Acc: 0.264
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.9404129981994629
Epoch: 20, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.170 Vali Acc: 0.271 Test Loss: 4.170 Test Acc: 0.271
Validation loss decreased (-0.267019 --> -0.270547).  Saving model ...
Epoch: 21 cost time: 0.8269541263580322
Epoch: 21, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.193 Vali Acc: 0.272 Test Loss: 4.193 Test Acc: 0.272
Validation loss decreased (-0.270547 --> -0.271723).  Saving model ...
Epoch: 22 cost time: 0.927544355392456
Epoch: 22, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.236 Vali Acc: 0.272 Test Loss: 4.236 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9417264461517334
Epoch: 23, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.268 Vali Acc: 0.271 Test Loss: 4.268 Test Acc: 0.271
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.8642959594726562
Epoch: 24, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.302 Vali Acc: 0.271 Test Loss: 4.302 Test Acc: 0.271
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.0564956665039062
Epoch: 25, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.328 Vali Acc: 0.274 Test Loss: 4.328 Test Acc: 0.274
Validation loss decreased (-0.271723 --> -0.274074).  Saving model ...
Epoch: 26 cost time: 0.9346601963043213
Epoch: 26, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.373 Vali Acc: 0.278 Test Loss: 4.373 Test Acc: 0.278
Validation loss decreased (-0.274074 --> -0.277603).  Saving model ...
Epoch: 27 cost time: 0.7841367721557617
Epoch: 27, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.409 Vali Acc: 0.276 Test Loss: 4.409 Test Acc: 0.276
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.739478588104248
Epoch: 28, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.426 Vali Acc: 0.279 Test Loss: 4.426 Test Acc: 0.279
Validation loss decreased (-0.277603 --> -0.278779).  Saving model ...
Epoch: 29 cost time: 0.7598447799682617
Epoch: 29, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.466 Vali Acc: 0.278 Test Loss: 4.466 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.8517918586730957
Epoch: 30, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.494 Vali Acc: 0.278 Test Loss: 4.494 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.8602468967437744
Epoch: 31, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.518 Vali Acc: 0.273 Test Loss: 4.518 Test Acc: 0.273
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.8667888641357422
Epoch: 32, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.542 Vali Acc: 0.275 Test Loss: 4.542 Test Acc: 0.275
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.9698152542114258
Epoch: 33, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.572 Vali Acc: 0.275 Test Loss: 4.572 Test Acc: 0.275
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.9476959705352783
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.592 Vali Acc: 0.274 Test Loss: 4.592 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.9306228160858154
Epoch: 35, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.623 Vali Acc: 0.273 Test Loss: 4.623 Test Acc: 0.273
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.7933309078216553
Epoch: 36, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.657 Vali Acc: 0.274 Test Loss: 4.657 Test Acc: 0.274
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.0435764789581299
Epoch: 37, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.690 Vali Acc: 0.274 Test Loss: 4.690 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.0448925495147705
Epoch: 38, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.703 Vali Acc: 0.276 Test Loss: 4.703 Test Acc: 0.276
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps12_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2788235294117647
model parameter : 666522
model size : 2.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.636192798614502
Epoch: 1, Steps: 10 | Train Loss: 3.308 Vali Loss: 3.275 Vali Acc: 0.046 Test Loss: 3.275 Test Acc: 0.046
Validation loss decreased (inf --> -0.045850).  Saving model ...
Epoch: 2 cost time: 0.7438836097717285
Epoch: 2, Steps: 10 | Train Loss: 3.072 Vali Loss: 3.253 Vali Acc: 0.066 Test Loss: 3.253 Test Acc: 0.066
Validation loss decreased (-0.045850 --> -0.065850).  Saving model ...
Epoch: 3 cost time: 0.6594388484954834
Epoch: 3, Steps: 10 | Train Loss: 2.699 Vali Loss: 3.246 Vali Acc: 0.104 Test Loss: 3.246 Test Acc: 0.104
Validation loss decreased (-0.065850 --> -0.103497).  Saving model ...
Epoch: 4 cost time: 0.7959141731262207
Epoch: 4, Steps: 10 | Train Loss: 2.232 Vali Loss: 3.222 Vali Acc: 0.129 Test Loss: 3.222 Test Acc: 0.129
Validation loss decreased (-0.103497 --> -0.129380).  Saving model ...
Epoch: 5 cost time: 0.6813452243804932
Epoch: 5, Steps: 10 | Train Loss: 1.747 Vali Loss: 3.191 Vali Acc: 0.160 Test Loss: 3.191 Test Acc: 0.160
Validation loss decreased (-0.129380 --> -0.159968).  Saving model ...
Epoch: 6 cost time: 0.9061353206634521
Epoch: 6, Steps: 10 | Train Loss: 1.355 Vali Loss: 3.209 Vali Acc: 0.176 Test Loss: 3.209 Test Acc: 0.176
Validation loss decreased (-0.159968 --> -0.176439).  Saving model ...
Epoch: 7 cost time: 0.7983670234680176
Epoch: 7, Steps: 10 | Train Loss: 0.983 Vali Loss: 3.228 Vali Acc: 0.191 Test Loss: 3.228 Test Acc: 0.191
Validation loss decreased (-0.176439 --> -0.190556).  Saving model ...
Epoch: 8 cost time: 0.7988564968109131
Epoch: 8, Steps: 10 | Train Loss: 0.695 Vali Loss: 3.267 Vali Acc: 0.224 Test Loss: 3.267 Test Acc: 0.224
Validation loss decreased (-0.190556 --> -0.223497).  Saving model ...
Epoch: 9 cost time: 0.7958166599273682
Epoch: 9, Steps: 10 | Train Loss: 0.464 Vali Loss: 3.354 Vali Acc: 0.234 Test Loss: 3.354 Test Acc: 0.234
Validation loss decreased (-0.223497 --> -0.234084).  Saving model ...
Epoch: 10 cost time: 0.8541984558105469
Epoch: 10, Steps: 10 | Train Loss: 0.306 Vali Loss: 3.449 Vali Acc: 0.239 Test Loss: 3.449 Test Acc: 0.239
Validation loss decreased (-0.234084 --> -0.238789).  Saving model ...
Epoch: 11 cost time: 0.8822813034057617
Epoch: 11, Steps: 10 | Train Loss: 0.198 Vali Loss: 3.516 Vali Acc: 0.247 Test Loss: 3.516 Test Acc: 0.247
Validation loss decreased (-0.238789 --> -0.247024).  Saving model ...
Epoch: 12 cost time: 1.0126700401306152
Epoch: 12, Steps: 10 | Train Loss: 0.121 Vali Loss: 3.634 Vali Acc: 0.247 Test Loss: 3.634 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.006363868713379
Epoch: 13, Steps: 10 | Train Loss: 0.080 Vali Loss: 3.690 Vali Acc: 0.253 Test Loss: 3.690 Test Acc: 0.253
Validation loss decreased (-0.247024 --> -0.252904).  Saving model ...
Epoch: 14 cost time: 0.9504530429840088
Epoch: 14, Steps: 10 | Train Loss: 0.054 Vali Loss: 3.777 Vali Acc: 0.254 Test Loss: 3.777 Test Acc: 0.254
Validation loss decreased (-0.252904 --> -0.254080).  Saving model ...
Epoch: 15 cost time: 1.0049729347229004
Epoch: 15, Steps: 10 | Train Loss: 0.044 Vali Loss: 3.819 Vali Acc: 0.254 Test Loss: 3.819 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7952086925506592
Epoch: 16, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.866 Vali Acc: 0.256 Test Loss: 3.866 Test Acc: 0.256
Validation loss decreased (-0.254080 --> -0.256432).  Saving model ...
Epoch: 17 cost time: 0.931572675704956
Epoch: 17, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.895 Vali Acc: 0.259 Test Loss: 3.895 Test Acc: 0.259
Validation loss decreased (-0.256432 --> -0.258785).  Saving model ...
Epoch: 18 cost time: 0.9160733222961426
Epoch: 18, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.929 Vali Acc: 0.261 Test Loss: 3.929 Test Acc: 0.261
Validation loss decreased (-0.258785 --> -0.261137).  Saving model ...
Epoch: 19 cost time: 0.9843571186065674
Epoch: 19, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.984 Vali Acc: 0.265 Test Loss: 3.984 Test Acc: 0.265
Validation loss decreased (-0.261137 --> -0.264666).  Saving model ...
Epoch: 20 cost time: 0.8941440582275391
Epoch: 20, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.053 Vali Acc: 0.262 Test Loss: 4.053 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9566869735717773
Epoch: 21, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.086 Vali Acc: 0.258 Test Loss: 4.086 Test Acc: 0.258
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.8896832466125488
Epoch: 22, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.124 Vali Acc: 0.259 Test Loss: 4.124 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.9396541118621826
Epoch: 23, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.144 Vali Acc: 0.260 Test Loss: 4.144 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.9932680130004883
Epoch: 24, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.168 Vali Acc: 0.259 Test Loss: 4.168 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.9454810619354248
Epoch: 25, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.186 Vali Acc: 0.264 Test Loss: 4.186 Test Acc: 0.264
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.147721767425537
Epoch: 26, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.205 Vali Acc: 0.266 Test Loss: 4.205 Test Acc: 0.266
Validation loss decreased (-0.264666 --> -0.265840).  Saving model ...
Epoch: 27 cost time: 1.0141346454620361
Epoch: 27, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.240 Vali Acc: 0.265 Test Loss: 4.240 Test Acc: 0.265
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8599729537963867
Epoch: 28, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.286 Vali Acc: 0.266 Test Loss: 4.286 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.1903245449066162
Epoch: 29, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.334 Vali Acc: 0.268 Test Loss: 4.334 Test Acc: 0.268
Validation loss decreased (-0.265840 --> -0.268192).  Saving model ...
Epoch: 30 cost time: 1.0812487602233887
Epoch: 30, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.360 Vali Acc: 0.265 Test Loss: 4.360 Test Acc: 0.265
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.0547363758087158
Epoch: 31, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.383 Vali Acc: 0.268 Test Loss: 4.383 Test Acc: 0.268
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.1275458335876465
Epoch: 32, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.413 Vali Acc: 0.266 Test Loss: 4.413 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.0197207927703857
Epoch: 33, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.427 Vali Acc: 0.268 Test Loss: 4.427 Test Acc: 0.268
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.1353199481964111
Epoch: 34, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.444 Vali Acc: 0.268 Test Loss: 4.444 Test Acc: 0.268
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.9395298957824707
Epoch: 35, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.476 Vali Acc: 0.265 Test Loss: 4.476 Test Acc: 0.265
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.996598482131958
Epoch: 36, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.502 Vali Acc: 0.268 Test Loss: 4.502 Test Acc: 0.268
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.0717496871948242
Epoch: 37, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.530 Vali Acc: 0.269 Test Loss: 4.530 Test Acc: 0.269
Validation loss decreased (-0.268192 --> -0.269366).  Saving model ...
Epoch: 38 cost time: 1.0834741592407227
Epoch: 38, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.562 Vali Acc: 0.268 Test Loss: 4.562 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.9852399826049805
Epoch: 39, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.570 Vali Acc: 0.269 Test Loss: 4.570 Test Acc: 0.269
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.9675674438476562
Epoch: 40, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.576 Vali Acc: 0.271 Test Loss: 4.576 Test Acc: 0.271
Validation loss decreased (-0.269366 --> -0.270542).  Saving model ...
Epoch: 41 cost time: 1.0092854499816895
Epoch: 41, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.599 Vali Acc: 0.267 Test Loss: 4.599 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.015453577041626
Epoch: 42, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.638 Vali Acc: 0.268 Test Loss: 4.638 Test Acc: 0.268
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.879220724105835
Epoch: 43, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.670 Vali Acc: 0.268 Test Loss: 4.670 Test Acc: 0.268
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.9573817253112793
Epoch: 44, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.697 Vali Acc: 0.269 Test Loss: 4.697 Test Acc: 0.269
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.9577033519744873
Epoch: 45, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.704 Vali Acc: 0.268 Test Loss: 4.704 Test Acc: 0.268
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.248575210571289
Epoch: 46, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.723 Vali Acc: 0.267 Test Loss: 4.723 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.0479183197021484
Epoch: 47, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.754 Vali Acc: 0.267 Test Loss: 4.754 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.0723564624786377
Epoch: 48, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.764 Vali Acc: 0.269 Test Loss: 4.764 Test Acc: 0.269
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.0622358322143555
Epoch: 49, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.782 Vali Acc: 0.272 Test Loss: 4.782 Test Acc: 0.272
Validation loss decreased (-0.270542 --> -0.271717).  Saving model ...
Epoch: 50 cost time: 0.9959874153137207
Epoch: 50, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.809 Vali Acc: 0.269 Test Loss: 4.809 Test Acc: 0.269
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27176470588235296
model parameter : 607130
model size : 2.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps23_str12_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.7230827808380127
Epoch: 1, Steps: 10 | Train Loss: 3.350 Vali Loss: 3.294 Vali Acc: 0.042 Test Loss: 3.294 Test Acc: 0.042
Validation loss decreased (inf --> -0.042320).  Saving model ...
Epoch: 2 cost time: 0.7800002098083496
Epoch: 2, Steps: 10 | Train Loss: 3.141 Vali Loss: 3.272 Vali Acc: 0.049 Test Loss: 3.272 Test Acc: 0.049
Validation loss decreased (-0.042320 --> -0.049379).  Saving model ...
Epoch: 3 cost time: 1.0084939002990723
Epoch: 3, Steps: 10 | Train Loss: 2.889 Vali Loss: 3.250 Vali Acc: 0.086 Test Loss: 3.250 Test Acc: 0.086
Validation loss decreased (-0.049379 --> -0.085850).  Saving model ...
Epoch: 4 cost time: 0.7938427925109863
Epoch: 4, Steps: 10 | Train Loss: 2.526 Vali Loss: 3.234 Vali Acc: 0.105 Test Loss: 3.234 Test Acc: 0.105
Validation loss decreased (-0.085850 --> -0.104674).  Saving model ...
Epoch: 5 cost time: 0.8287022113800049
Epoch: 5, Steps: 10 | Train Loss: 2.168 Vali Loss: 3.215 Vali Acc: 0.127 Test Loss: 3.215 Test Acc: 0.127
Validation loss decreased (-0.104674 --> -0.127027).  Saving model ...
Epoch: 6 cost time: 0.8021738529205322
Epoch: 6, Steps: 10 | Train Loss: 1.848 Vali Loss: 3.185 Vali Acc: 0.156 Test Loss: 3.185 Test Acc: 0.156
Validation loss decreased (-0.127027 --> -0.156439).  Saving model ...
Epoch: 7 cost time: 1.0035271644592285
Epoch: 7, Steps: 10 | Train Loss: 1.516 Vali Loss: 3.167 Vali Acc: 0.180 Test Loss: 3.167 Test Acc: 0.180
Validation loss decreased (-0.156439 --> -0.179968).  Saving model ...
Epoch: 8 cost time: 0.8742506504058838
Epoch: 8, Steps: 10 | Train Loss: 1.212 Vali Loss: 3.170 Vali Acc: 0.206 Test Loss: 3.170 Test Acc: 0.206
Validation loss decreased (-0.179968 --> -0.205851).  Saving model ...
Epoch: 9 cost time: 0.7738687992095947
Epoch: 9, Steps: 10 | Train Loss: 0.937 Vali Loss: 3.186 Vali Acc: 0.226 Test Loss: 3.186 Test Acc: 0.226
Validation loss decreased (-0.205851 --> -0.225850).  Saving model ...
Epoch: 10 cost time: 0.8726215362548828
Epoch: 10, Steps: 10 | Train Loss: 0.705 Vali Loss: 3.219 Vali Acc: 0.238 Test Loss: 3.219 Test Acc: 0.238
Validation loss decreased (-0.225850 --> -0.237615).  Saving model ...
Epoch: 11 cost time: 0.8415288925170898
Epoch: 11, Steps: 10 | Train Loss: 0.520 Vali Loss: 3.268 Vali Acc: 0.240 Test Loss: 3.268 Test Acc: 0.240
Validation loss decreased (-0.237615 --> -0.239967).  Saving model ...
Epoch: 12 cost time: 1.045398235321045
Epoch: 12, Steps: 10 | Train Loss: 0.368 Vali Loss: 3.310 Vali Acc: 0.255 Test Loss: 3.310 Test Acc: 0.255
Validation loss decreased (-0.239967 --> -0.255261).  Saving model ...
Epoch: 13 cost time: 0.9646461009979248
Epoch: 13, Steps: 10 | Train Loss: 0.257 Vali Loss: 3.407 Vali Acc: 0.254 Test Loss: 3.407 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9753763675689697
Epoch: 14, Steps: 10 | Train Loss: 0.176 Vali Loss: 3.467 Vali Acc: 0.255 Test Loss: 3.467 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.997227668762207
Epoch: 15, Steps: 10 | Train Loss: 0.130 Vali Loss: 3.535 Vali Acc: 0.261 Test Loss: 3.535 Test Acc: 0.261
Validation loss decreased (-0.255261 --> -0.261141).  Saving model ...
Epoch: 16 cost time: 1.0091242790222168
Epoch: 16, Steps: 10 | Train Loss: 0.091 Vali Loss: 3.591 Vali Acc: 0.262 Test Loss: 3.591 Test Acc: 0.262
Validation loss decreased (-0.261141 --> -0.262317).  Saving model ...
Epoch: 17 cost time: 0.9269204139709473
Epoch: 17, Steps: 10 | Train Loss: 0.070 Vali Loss: 3.631 Vali Acc: 0.274 Test Loss: 3.631 Test Acc: 0.274
Validation loss decreased (-0.262317 --> -0.274081).  Saving model ...
Epoch: 18 cost time: 0.8905024528503418
Epoch: 18, Steps: 10 | Train Loss: 0.055 Vali Loss: 3.684 Vali Acc: 0.266 Test Loss: 3.684 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8565878868103027
Epoch: 19, Steps: 10 | Train Loss: 0.048 Vali Loss: 3.722 Vali Acc: 0.266 Test Loss: 3.722 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8439724445343018
Epoch: 20, Steps: 10 | Train Loss: 0.039 Vali Loss: 3.786 Vali Acc: 0.262 Test Loss: 3.786 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.8484773635864258
Epoch: 21, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.807 Vali Acc: 0.274 Test Loss: 3.807 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.8460779190063477
Epoch: 22, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.847 Vali Acc: 0.274 Test Loss: 3.847 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.8657100200653076
Epoch: 23, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.891 Vali Acc: 0.274 Test Loss: 3.891 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.9167134761810303
Epoch: 24, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.916 Vali Acc: 0.274 Test Loss: 3.916 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.9191408157348633
Epoch: 25, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.955 Vali Acc: 0.271 Test Loss: 3.955 Test Acc: 0.271
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.0243239402770996
Epoch: 26, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.977 Vali Acc: 0.272 Test Loss: 3.977 Test Acc: 0.272
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.070901870727539
Epoch: 27, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.006 Vali Acc: 0.275 Test Loss: 4.006 Test Acc: 0.275
Validation loss decreased (-0.274081 --> -0.275254).  Saving model ...
Epoch: 28 cost time: 0.8940684795379639
Epoch: 28, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.035 Vali Acc: 0.275 Test Loss: 4.035 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.8890650272369385
Epoch: 29, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.064 Vali Acc: 0.275 Test Loss: 4.064 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.0657117366790771
Epoch: 30, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.110 Vali Acc: 0.269 Test Loss: 4.110 Test Acc: 0.269
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.9322528839111328
Epoch: 31, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.148 Vali Acc: 0.268 Test Loss: 4.148 Test Acc: 0.268
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.9248623847961426
Epoch: 32, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.177 Vali Acc: 0.275 Test Loss: 4.177 Test Acc: 0.275
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.9960453510284424
Epoch: 33, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.202 Vali Acc: 0.276 Test Loss: 4.202 Test Acc: 0.276
Validation loss decreased (-0.275254 --> -0.276429).  Saving model ...
Epoch: 34 cost time: 0.9263958930969238
Epoch: 34, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.209 Vali Acc: 0.275 Test Loss: 4.209 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.8327999114990234
Epoch: 35, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.237 Vali Acc: 0.275 Test Loss: 4.237 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.9818010330200195
Epoch: 36, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.263 Vali Acc: 0.273 Test Loss: 4.263 Test Acc: 0.273
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.9667308330535889
Epoch: 37, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.277 Vali Acc: 0.275 Test Loss: 4.277 Test Acc: 0.275
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.1026816368103027
Epoch: 38, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.313 Vali Acc: 0.275 Test Loss: 4.313 Test Acc: 0.275
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.0648159980773926
Epoch: 39, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.338 Vali Acc: 0.273 Test Loss: 4.338 Test Acc: 0.273
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.9939367771148682
Epoch: 40, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.357 Vali Acc: 0.278 Test Loss: 4.357 Test Acc: 0.278
Validation loss decreased (-0.276429 --> -0.277603).  Saving model ...
Epoch: 41 cost time: 0.9225180149078369
Epoch: 41, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.399 Vali Acc: 0.281 Test Loss: 4.399 Test Acc: 0.281
Validation loss decreased (-0.277603 --> -0.281132).  Saving model ...
Epoch: 42 cost time: 0.9357750415802002
Epoch: 42, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.426 Vali Acc: 0.281 Test Loss: 4.426 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.9755773544311523
Epoch: 43, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.432 Vali Acc: 0.280 Test Loss: 4.432 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.1436054706573486
Epoch: 44, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.431 Vali Acc: 0.280 Test Loss: 4.431 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.9583585262298584
Epoch: 45, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.456 Vali Acc: 0.278 Test Loss: 4.456 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.8508834838867188
Epoch: 46, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.478 Vali Acc: 0.279 Test Loss: 4.478 Test Acc: 0.279
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.8597509860992432
Epoch: 47, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.503 Vali Acc: 0.278 Test Loss: 4.503 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.0650413036346436
Epoch: 48, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.520 Vali Acc: 0.280 Test Loss: 4.520 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 1.0069279670715332
Epoch: 49, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.562 Vali Acc: 0.280 Test Loss: 4.562 Test Acc: 0.280
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 0.9049460887908936
Epoch: 50, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.570 Vali Acc: 0.279 Test Loss: 4.570 Test Acc: 0.279
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps23_str12_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2811764705882353
model parameter : 538138
model size : 2.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.475543975830078
Epoch: 1, Steps: 10 | Train Loss: 3.286 Vali Loss: 3.282 Vali Acc: 0.059 Test Loss: 3.282 Test Acc: 0.059
Validation loss decreased (inf --> -0.058791).  Saving model ...
Epoch: 2 cost time: 0.8996572494506836
Epoch: 2, Steps: 10 | Train Loss: 3.155 Vali Loss: 3.263 Vali Acc: 0.054 Test Loss: 3.263 Test Acc: 0.054
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9254069328308105
Epoch: 3, Steps: 10 | Train Loss: 2.925 Vali Loss: 3.246 Vali Acc: 0.079 Test Loss: 3.246 Test Acc: 0.079
Validation loss decreased (-0.058791 --> -0.078791).  Saving model ...
Epoch: 4 cost time: 0.8504745960235596
Epoch: 4, Steps: 10 | Train Loss: 2.649 Vali Loss: 3.230 Vali Acc: 0.096 Test Loss: 3.230 Test Acc: 0.096
Validation loss decreased (-0.078791 --> -0.096438).  Saving model ...
Epoch: 5 cost time: 0.9196889400482178
Epoch: 5, Steps: 10 | Train Loss: 2.397 Vali Loss: 3.216 Vali Acc: 0.129 Test Loss: 3.216 Test Acc: 0.129
Validation loss decreased (-0.096438 --> -0.129380).  Saving model ...
Epoch: 6 cost time: 0.8203020095825195
Epoch: 6, Steps: 10 | Train Loss: 2.087 Vali Loss: 3.193 Vali Acc: 0.144 Test Loss: 3.193 Test Acc: 0.144
Validation loss decreased (-0.129380 --> -0.143497).  Saving model ...
Epoch: 7 cost time: 0.8776614665985107
Epoch: 7, Steps: 10 | Train Loss: 1.845 Vali Loss: 3.181 Vali Acc: 0.162 Test Loss: 3.181 Test Acc: 0.162
Validation loss decreased (-0.143497 --> -0.162321).  Saving model ...
Epoch: 8 cost time: 0.9775733947753906
Epoch: 8, Steps: 10 | Train Loss: 1.556 Vali Loss: 3.164 Vali Acc: 0.180 Test Loss: 3.164 Test Acc: 0.180
Validation loss decreased (-0.162321 --> -0.179968).  Saving model ...
Epoch: 9 cost time: 0.8805813789367676
Epoch: 9, Steps: 10 | Train Loss: 1.294 Vali Loss: 3.156 Vali Acc: 0.193 Test Loss: 3.156 Test Acc: 0.193
Validation loss decreased (-0.179968 --> -0.192910).  Saving model ...
Epoch: 10 cost time: 0.8260607719421387
Epoch: 10, Steps: 10 | Train Loss: 1.044 Vali Loss: 3.162 Vali Acc: 0.207 Test Loss: 3.162 Test Acc: 0.207
Validation loss decreased (-0.192910 --> -0.207027).  Saving model ...
Epoch: 11 cost time: 0.9257771968841553
Epoch: 11, Steps: 10 | Train Loss: 0.846 Vali Loss: 3.193 Vali Acc: 0.213 Test Loss: 3.193 Test Acc: 0.213
Validation loss decreased (-0.207027 --> -0.212909).  Saving model ...
Epoch: 12 cost time: 0.7845213413238525
Epoch: 12, Steps: 10 | Train Loss: 0.652 Vali Loss: 3.223 Vali Acc: 0.226 Test Loss: 3.223 Test Acc: 0.226
Validation loss decreased (-0.212909 --> -0.225850).  Saving model ...
Epoch: 13 cost time: 0.7984483242034912
Epoch: 13, Steps: 10 | Train Loss: 0.487 Vali Loss: 3.278 Vali Acc: 0.240 Test Loss: 3.278 Test Acc: 0.240
Validation loss decreased (-0.225850 --> -0.239967).  Saving model ...
Epoch: 14 cost time: 0.8921802043914795
Epoch: 14, Steps: 10 | Train Loss: 0.378 Vali Loss: 3.324 Vali Acc: 0.241 Test Loss: 3.324 Test Acc: 0.241
Validation loss decreased (-0.239967 --> -0.241143).  Saving model ...
Epoch: 15 cost time: 0.8820326328277588
Epoch: 15, Steps: 10 | Train Loss: 0.271 Vali Loss: 3.384 Vali Acc: 0.251 Test Loss: 3.384 Test Acc: 0.251
Validation loss decreased (-0.241143 --> -0.250554).  Saving model ...
Epoch: 16 cost time: 1.0975687503814697
Epoch: 16, Steps: 10 | Train Loss: 0.192 Vali Loss: 3.471 Vali Acc: 0.252 Test Loss: 3.471 Test Acc: 0.252
Validation loss decreased (-0.250554 --> -0.251730).  Saving model ...
Epoch: 17 cost time: 0.8798820972442627
Epoch: 17, Steps: 10 | Train Loss: 0.145 Vali Loss: 3.537 Vali Acc: 0.264 Test Loss: 3.537 Test Acc: 0.264
Validation loss decreased (-0.251730 --> -0.263494).  Saving model ...
Epoch: 18 cost time: 0.8244514465332031
Epoch: 18, Steps: 10 | Train Loss: 0.114 Vali Loss: 3.591 Vali Acc: 0.272 Test Loss: 3.591 Test Acc: 0.272
Validation loss decreased (-0.263494 --> -0.271729).  Saving model ...
Epoch: 19 cost time: 1.0219297409057617
Epoch: 19, Steps: 10 | Train Loss: 0.086 Vali Loss: 3.611 Vali Acc: 0.266 Test Loss: 3.611 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0234785079956055
Epoch: 20, Steps: 10 | Train Loss: 0.071 Vali Loss: 3.645 Vali Acc: 0.267 Test Loss: 3.645 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.8736340999603271
Epoch: 21, Steps: 10 | Train Loss: 0.058 Vali Loss: 3.704 Vali Acc: 0.273 Test Loss: 3.704 Test Acc: 0.273
Validation loss decreased (-0.271729 --> -0.272904).  Saving model ...
Epoch: 22 cost time: 0.9125320911407471
Epoch: 22, Steps: 10 | Train Loss: 0.046 Vali Loss: 3.772 Vali Acc: 0.278 Test Loss: 3.772 Test Acc: 0.278
Validation loss decreased (-0.272904 --> -0.277609).  Saving model ...
Epoch: 23 cost time: 0.8971197605133057
Epoch: 23, Steps: 10 | Train Loss: 0.040 Vali Loss: 3.804 Vali Acc: 0.281 Test Loss: 3.804 Test Acc: 0.281
Validation loss decreased (-0.277609 --> -0.281138).  Saving model ...
Epoch: 24 cost time: 0.8660151958465576
Epoch: 24, Steps: 10 | Train Loss: 0.035 Vali Loss: 3.844 Vali Acc: 0.269 Test Loss: 3.844 Test Acc: 0.269
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8517122268676758
Epoch: 25, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.887 Vali Acc: 0.272 Test Loss: 3.887 Test Acc: 0.272
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.9213728904724121
Epoch: 26, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.922 Vali Acc: 0.268 Test Loss: 3.922 Test Acc: 0.268
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.8867180347442627
Epoch: 27, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.957 Vali Acc: 0.275 Test Loss: 3.957 Test Acc: 0.275
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.7255125045776367
Epoch: 28, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.974 Vali Acc: 0.278 Test Loss: 3.974 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.7586464881896973
Epoch: 29, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.003 Vali Acc: 0.278 Test Loss: 4.003 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.7738301753997803
Epoch: 30, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.030 Vali Acc: 0.278 Test Loss: 4.030 Test Acc: 0.278
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.0310654640197754
Epoch: 31, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.054 Vali Acc: 0.276 Test Loss: 4.054 Test Acc: 0.276
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.9744248390197754
Epoch: 32, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.069 Vali Acc: 0.273 Test Loss: 4.069 Test Acc: 0.273
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.9411971569061279
Epoch: 33, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.105 Vali Acc: 0.276 Test Loss: 4.105 Test Acc: 0.276
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2811764705882353
model parameter : 509210
model size : 1.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps38_str19_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.2617251873016357
Epoch: 1, Steps: 10 | Train Loss: 3.265 Vali Loss: 3.292 Vali Acc: 0.039 Test Loss: 3.292 Test Acc: 0.039
Validation loss decreased (inf --> -0.038791).  Saving model ...
Epoch: 2 cost time: 0.8795647621154785
Epoch: 2, Steps: 10 | Train Loss: 3.125 Vali Loss: 3.286 Vali Acc: 0.048 Test Loss: 3.286 Test Acc: 0.048
Validation loss decreased (-0.038791 --> -0.048202).  Saving model ...
Epoch: 3 cost time: 0.8927731513977051
Epoch: 3, Steps: 10 | Train Loss: 2.938 Vali Loss: 3.274 Vali Acc: 0.066 Test Loss: 3.274 Test Acc: 0.066
Validation loss decreased (-0.048202 --> -0.065850).  Saving model ...
Epoch: 4 cost time: 0.9552457332611084
Epoch: 4, Steps: 10 | Train Loss: 2.741 Vali Loss: 3.264 Vali Acc: 0.095 Test Loss: 3.264 Test Acc: 0.095
Validation loss decreased (-0.065850 --> -0.095261).  Saving model ...
Epoch: 5 cost time: 0.9592664241790771
Epoch: 5, Steps: 10 | Train Loss: 2.442 Vali Loss: 3.246 Vali Acc: 0.118 Test Loss: 3.246 Test Acc: 0.118
Validation loss decreased (-0.095261 --> -0.117615).  Saving model ...
Epoch: 6 cost time: 0.8508913516998291
Epoch: 6, Steps: 10 | Train Loss: 2.224 Vali Loss: 3.231 Vali Acc: 0.139 Test Loss: 3.231 Test Acc: 0.139
Validation loss decreased (-0.117615 --> -0.138791).  Saving model ...
Epoch: 7 cost time: 0.8731861114501953
Epoch: 7, Steps: 10 | Train Loss: 1.940 Vali Loss: 3.214 Vali Acc: 0.158 Test Loss: 3.214 Test Acc: 0.158
Validation loss decreased (-0.138791 --> -0.157615).  Saving model ...
Epoch: 8 cost time: 0.8608927726745605
Epoch: 8, Steps: 10 | Train Loss: 1.664 Vali Loss: 3.201 Vali Acc: 0.176 Test Loss: 3.201 Test Acc: 0.176
Validation loss decreased (-0.157615 --> -0.176439).  Saving model ...
Epoch: 9 cost time: 0.7197973728179932
Epoch: 9, Steps: 10 | Train Loss: 1.446 Vali Loss: 3.191 Vali Acc: 0.194 Test Loss: 3.191 Test Acc: 0.194
Validation loss decreased (-0.176439 --> -0.194086).  Saving model ...
Epoch: 10 cost time: 0.7339189052581787
Epoch: 10, Steps: 10 | Train Loss: 1.209 Vali Loss: 3.184 Vali Acc: 0.207 Test Loss: 3.184 Test Acc: 0.207
Validation loss decreased (-0.194086 --> -0.207027).  Saving model ...
Epoch: 11 cost time: 0.9044899940490723
Epoch: 11, Steps: 10 | Train Loss: 0.995 Vali Loss: 3.191 Vali Acc: 0.213 Test Loss: 3.191 Test Acc: 0.213
Validation loss decreased (-0.207027 --> -0.212909).  Saving model ...
Epoch: 12 cost time: 0.9445466995239258
Epoch: 12, Steps: 10 | Train Loss: 0.785 Vali Loss: 3.225 Vali Acc: 0.218 Test Loss: 3.225 Test Acc: 0.218
Validation loss decreased (-0.212909 --> -0.217615).  Saving model ...
Epoch: 13 cost time: 0.7918305397033691
Epoch: 13, Steps: 10 | Train Loss: 0.671 Vali Loss: 3.243 Vali Acc: 0.242 Test Loss: 3.243 Test Acc: 0.242
Validation loss decreased (-0.217615 --> -0.242321).  Saving model ...
Epoch: 14 cost time: 0.8496294021606445
Epoch: 14, Steps: 10 | Train Loss: 0.503 Vali Loss: 3.290 Vali Acc: 0.248 Test Loss: 3.290 Test Acc: 0.248
Validation loss decreased (-0.242321 --> -0.248202).  Saving model ...
Epoch: 15 cost time: 0.8810842037200928
Epoch: 15, Steps: 10 | Train Loss: 0.375 Vali Loss: 3.371 Vali Acc: 0.254 Test Loss: 3.371 Test Acc: 0.254
Validation loss decreased (-0.248202 --> -0.254084).  Saving model ...
Epoch: 16 cost time: 0.9229028224945068
Epoch: 16, Steps: 10 | Train Loss: 0.270 Vali Loss: 3.411 Vali Acc: 0.261 Test Loss: 3.411 Test Acc: 0.261
Validation loss decreased (-0.254084 --> -0.261142).  Saving model ...
Epoch: 17 cost time: 0.784477710723877
Epoch: 17, Steps: 10 | Train Loss: 0.208 Vali Loss: 3.475 Vali Acc: 0.256 Test Loss: 3.475 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9455151557922363
Epoch: 18, Steps: 10 | Train Loss: 0.152 Vali Loss: 3.510 Vali Acc: 0.255 Test Loss: 3.510 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9041149616241455
Epoch: 19, Steps: 10 | Train Loss: 0.117 Vali Loss: 3.558 Vali Acc: 0.267 Test Loss: 3.558 Test Acc: 0.267
Validation loss decreased (-0.261142 --> -0.267023).  Saving model ...
Epoch: 20 cost time: 0.8297133445739746
Epoch: 20, Steps: 10 | Train Loss: 0.101 Vali Loss: 3.599 Vali Acc: 0.272 Test Loss: 3.599 Test Acc: 0.272
Validation loss decreased (-0.267023 --> -0.271729).  Saving model ...
Epoch: 21 cost time: 0.7672858238220215
Epoch: 21, Steps: 10 | Train Loss: 0.079 Vali Loss: 3.664 Vali Acc: 0.254 Test Loss: 3.664 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9088973999023438
Epoch: 22, Steps: 10 | Train Loss: 0.067 Vali Loss: 3.725 Vali Acc: 0.266 Test Loss: 3.725 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.7843730449676514
Epoch: 23, Steps: 10 | Train Loss: 0.052 Vali Loss: 3.756 Vali Acc: 0.267 Test Loss: 3.756 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.865278959274292
Epoch: 24, Steps: 10 | Train Loss: 0.046 Vali Loss: 3.773 Vali Acc: 0.274 Test Loss: 3.773 Test Acc: 0.274
Validation loss decreased (-0.271729 --> -0.274080).  Saving model ...
Epoch: 25 cost time: 0.820704460144043
Epoch: 25, Steps: 10 | Train Loss: 0.042 Vali Loss: 3.815 Vali Acc: 0.267 Test Loss: 3.815 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8012597560882568
Epoch: 26, Steps: 10 | Train Loss: 0.035 Vali Loss: 3.848 Vali Acc: 0.271 Test Loss: 3.848 Test Acc: 0.271
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.8010048866271973
Epoch: 27, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.879 Vali Acc: 0.275 Test Loss: 3.879 Test Acc: 0.275
Validation loss decreased (-0.274080 --> -0.275255).  Saving model ...
Epoch: 28 cost time: 0.8257067203521729
Epoch: 28, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.918 Vali Acc: 0.275 Test Loss: 3.918 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7483484745025635
Epoch: 29, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.958 Vali Acc: 0.271 Test Loss: 3.958 Test Acc: 0.271
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.8605287075042725
Epoch: 30, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.006 Vali Acc: 0.262 Test Loss: 4.006 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.8966348171234131
Epoch: 31, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.018 Vali Acc: 0.271 Test Loss: 4.018 Test Acc: 0.271
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.9272642135620117
Epoch: 32, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.045 Vali Acc: 0.273 Test Loss: 4.045 Test Acc: 0.273
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.812608003616333
Epoch: 33, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.086 Vali Acc: 0.271 Test Loss: 4.086 Test Acc: 0.271
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.8597767353057861
Epoch: 34, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.119 Vali Acc: 0.269 Test Loss: 4.119 Test Acc: 0.269
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.8273830413818359
Epoch: 35, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.146 Vali Acc: 0.275 Test Loss: 4.146 Test Acc: 0.275
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.7856318950653076
Epoch: 36, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.169 Vali Acc: 0.280 Test Loss: 4.169 Test Acc: 0.280
Validation loss decreased (-0.275255 --> -0.279958).  Saving model ...
Epoch: 37 cost time: 0.82417893409729
Epoch: 37, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.168 Vali Acc: 0.278 Test Loss: 4.168 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.7747397422790527
Epoch: 38, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.205 Vali Acc: 0.279 Test Loss: 4.205 Test Acc: 0.279
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.8791940212249756
Epoch: 39, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.241 Vali Acc: 0.281 Test Loss: 4.241 Test Acc: 0.281
Validation loss decreased (-0.279958 --> -0.281134).  Saving model ...
Epoch: 40 cost time: 0.8371357917785645
Epoch: 40, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.271 Vali Acc: 0.280 Test Loss: 4.271 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.7900443077087402
Epoch: 41, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.275 Vali Acc: 0.276 Test Loss: 4.275 Test Acc: 0.276
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.8090174198150635
Epoch: 42, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.301 Vali Acc: 0.274 Test Loss: 4.301 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.7088563442230225
Epoch: 43, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.342 Vali Acc: 0.271 Test Loss: 4.342 Test Acc: 0.271
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.1128113269805908
Epoch: 44, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.361 Vali Acc: 0.276 Test Loss: 4.361 Test Acc: 0.276
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.02494478225708
Epoch: 45, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.371 Vali Acc: 0.278 Test Loss: 4.371 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.9834177494049072
Epoch: 46, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.408 Vali Acc: 0.276 Test Loss: 4.408 Test Acc: 0.276
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.0049846172332764
Epoch: 47, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.436 Vali Acc: 0.276 Test Loss: 4.436 Test Acc: 0.276
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 1.0607106685638428
Epoch: 48, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.466 Vali Acc: 0.279 Test Loss: 4.466 Test Acc: 0.279
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 0.973597526550293
Epoch: 49, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.478 Vali Acc: 0.280 Test Loss: 4.478 Test Acc: 0.280
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps38_str19_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2811764705882353
model parameter : 500122
model size : 1.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.7609097957611084
Epoch: 1, Steps: 10 | Train Loss: 3.339 Vali Loss: 3.257 Vali Acc: 0.039 Test Loss: 3.257 Test Acc: 0.039
Validation loss decreased (inf --> -0.038791).  Saving model ...
Epoch: 2 cost time: 0.9899449348449707
Epoch: 2, Steps: 10 | Train Loss: 2.923 Vali Loss: 3.221 Vali Acc: 0.104 Test Loss: 3.221 Test Acc: 0.104
Validation loss decreased (-0.038791 --> -0.103497).  Saving model ...
Epoch: 3 cost time: 0.7442047595977783
Epoch: 3, Steps: 10 | Train Loss: 2.203 Vali Loss: 3.208 Vali Acc: 0.138 Test Loss: 3.208 Test Acc: 0.138
Validation loss decreased (-0.103497 --> -0.137615).  Saving model ...
Epoch: 4 cost time: 0.9762759208679199
Epoch: 4, Steps: 10 | Train Loss: 1.532 Vali Loss: 3.186 Vali Acc: 0.181 Test Loss: 3.186 Test Acc: 0.181
Validation loss decreased (-0.137615 --> -0.181145).  Saving model ...
Epoch: 5 cost time: 0.863783597946167
Epoch: 5, Steps: 10 | Train Loss: 0.956 Vali Loss: 3.224 Vali Acc: 0.233 Test Loss: 3.224 Test Acc: 0.233
Validation loss decreased (-0.181145 --> -0.232909).  Saving model ...
Epoch: 6 cost time: 1.0826215744018555
Epoch: 6, Steps: 10 | Train Loss: 0.560 Vali Loss: 3.338 Vali Acc: 0.240 Test Loss: 3.338 Test Acc: 0.240
Validation loss decreased (-0.232909 --> -0.239967).  Saving model ...
Epoch: 7 cost time: 1.0152347087860107
Epoch: 7, Steps: 10 | Train Loss: 0.298 Vali Loss: 3.455 Vali Acc: 0.249 Test Loss: 3.455 Test Acc: 0.249
Validation loss decreased (-0.239967 --> -0.249377).  Saving model ...
Epoch: 8 cost time: 1.0662140846252441
Epoch: 8, Steps: 10 | Train Loss: 0.162 Vali Loss: 3.679 Vali Acc: 0.246 Test Loss: 3.679 Test Acc: 0.246
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9682960510253906
Epoch: 9, Steps: 10 | Train Loss: 0.069 Vali Loss: 3.780 Vali Acc: 0.259 Test Loss: 3.780 Test Acc: 0.259
Validation loss decreased (-0.249377 --> -0.258786).  Saving model ...
Epoch: 10 cost time: 0.9198329448699951
Epoch: 10, Steps: 10 | Train Loss: 0.039 Vali Loss: 3.868 Vali Acc: 0.260 Test Loss: 3.868 Test Acc: 0.260
Validation loss decreased (-0.258786 --> -0.259961).  Saving model ...
Epoch: 11 cost time: 0.9762451648712158
Epoch: 11, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.941 Vali Acc: 0.259 Test Loss: 3.941 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0528252124786377
Epoch: 12, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.009 Vali Acc: 0.262 Test Loss: 4.009 Test Acc: 0.262
Validation loss decreased (-0.259961 --> -0.262313).  Saving model ...
Epoch: 13 cost time: 0.8822267055511475
Epoch: 13, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.041 Vali Acc: 0.265 Test Loss: 4.041 Test Acc: 0.265
Validation loss decreased (-0.262313 --> -0.264665).  Saving model ...
Epoch: 14 cost time: 0.9930806159973145
Epoch: 14, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.089 Vali Acc: 0.265 Test Loss: 4.089 Test Acc: 0.265
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9689986705780029
Epoch: 15, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.128 Vali Acc: 0.266 Test Loss: 4.128 Test Acc: 0.266
Validation loss decreased (-0.264665 --> -0.265841).  Saving model ...
Epoch: 16 cost time: 0.9726912975311279
Epoch: 16, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.169 Vali Acc: 0.269 Test Loss: 4.169 Test Acc: 0.269
Validation loss decreased (-0.265841 --> -0.269370).  Saving model ...
Epoch: 17 cost time: 0.9380843639373779
Epoch: 17, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.205 Vali Acc: 0.264 Test Loss: 4.205 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0611934661865234
Epoch: 18, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.229 Vali Acc: 0.266 Test Loss: 4.229 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.0771965980529785
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.261 Vali Acc: 0.266 Test Loss: 4.261 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.932934045791626
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.315 Vali Acc: 0.265 Test Loss: 4.315 Test Acc: 0.265
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.9515717029571533
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.340 Vali Acc: 0.266 Test Loss: 4.340 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.8283336162567139
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.364 Vali Acc: 0.266 Test Loss: 4.364 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.9995965957641602
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.378 Vali Acc: 0.268 Test Loss: 4.378 Test Acc: 0.268
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.9972074031829834
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.418 Vali Acc: 0.266 Test Loss: 4.418 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.8299345970153809
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.455 Vali Acc: 0.267 Test Loss: 4.455 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.6893906593322754
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.495 Vali Acc: 0.268 Test Loss: 4.495 Test Acc: 0.268
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26941176470588235
model parameter : 489050
model size : 1.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.498831272125244
Epoch: 1, Steps: 10 | Train Loss: 3.314 Vali Loss: 3.265 Vali Acc: 0.048 Test Loss: 3.265 Test Acc: 0.048
Validation loss decreased (inf --> -0.048203).  Saving model ...
Epoch: 2 cost time: 0.8607361316680908
Epoch: 2, Steps: 10 | Train Loss: 3.092 Vali Loss: 3.233 Vali Acc: 0.072 Test Loss: 3.233 Test Acc: 0.072
Validation loss decreased (-0.048203 --> -0.071732).  Saving model ...
Epoch: 3 cost time: 0.9061546325683594
Epoch: 3, Steps: 10 | Train Loss: 2.670 Vali Loss: 3.223 Vali Acc: 0.106 Test Loss: 3.223 Test Acc: 0.106
Validation loss decreased (-0.071732 --> -0.105850).  Saving model ...
Epoch: 4 cost time: 0.8572976589202881
Epoch: 4, Steps: 10 | Train Loss: 2.263 Vali Loss: 3.208 Vali Acc: 0.136 Test Loss: 3.208 Test Acc: 0.136
Validation loss decreased (-0.105850 --> -0.136439).  Saving model ...
Epoch: 5 cost time: 0.987027645111084
Epoch: 5, Steps: 10 | Train Loss: 1.840 Vali Loss: 3.183 Vali Acc: 0.161 Test Loss: 3.183 Test Acc: 0.161
Validation loss decreased (-0.136439 --> -0.161145).  Saving model ...
Epoch: 6 cost time: 0.8805279731750488
Epoch: 6, Steps: 10 | Train Loss: 1.405 Vali Loss: 3.166 Vali Acc: 0.182 Test Loss: 3.166 Test Acc: 0.182
Validation loss decreased (-0.161145 --> -0.182321).  Saving model ...
Epoch: 7 cost time: 0.9066276550292969
Epoch: 7, Steps: 10 | Train Loss: 1.049 Vali Loss: 3.190 Vali Acc: 0.204 Test Loss: 3.190 Test Acc: 0.204
Validation loss decreased (-0.182321 --> -0.203498).  Saving model ...
Epoch: 8 cost time: 0.8298547267913818
Epoch: 8, Steps: 10 | Train Loss: 0.725 Vali Loss: 3.245 Vali Acc: 0.218 Test Loss: 3.245 Test Acc: 0.218
Validation loss decreased (-0.203498 --> -0.217615).  Saving model ...
Epoch: 9 cost time: 0.9230730533599854
Epoch: 9, Steps: 10 | Train Loss: 0.496 Vali Loss: 3.338 Vali Acc: 0.241 Test Loss: 3.338 Test Acc: 0.241
Validation loss decreased (-0.217615 --> -0.241143).  Saving model ...
Epoch: 10 cost time: 0.8960850238800049
Epoch: 10, Steps: 10 | Train Loss: 0.331 Vali Loss: 3.400 Vali Acc: 0.241 Test Loss: 3.400 Test Acc: 0.241
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9135353565216064
Epoch: 11, Steps: 10 | Train Loss: 0.223 Vali Loss: 3.518 Vali Acc: 0.240 Test Loss: 3.518 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7120418548583984
Epoch: 12, Steps: 10 | Train Loss: 0.139 Vali Loss: 3.587 Vali Acc: 0.248 Test Loss: 3.587 Test Acc: 0.248
Validation loss decreased (-0.241143 --> -0.248199).  Saving model ...
Epoch: 13 cost time: 0.9959475994110107
Epoch: 13, Steps: 10 | Train Loss: 0.100 Vali Loss: 3.658 Vali Acc: 0.248 Test Loss: 3.658 Test Acc: 0.248
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.063542366027832
Epoch: 14, Steps: 10 | Train Loss: 0.070 Vali Loss: 3.763 Vali Acc: 0.255 Test Loss: 3.763 Test Acc: 0.255
Validation loss decreased (-0.248199 --> -0.255256).  Saving model ...
Epoch: 15 cost time: 0.8767595291137695
Epoch: 15, Steps: 10 | Train Loss: 0.049 Vali Loss: 3.784 Vali Acc: 0.256 Test Loss: 3.784 Test Acc: 0.256
Validation loss decreased (-0.255256 --> -0.256433).  Saving model ...
Epoch: 16 cost time: 0.8624861240386963
Epoch: 16, Steps: 10 | Train Loss: 0.039 Vali Loss: 3.839 Vali Acc: 0.258 Test Loss: 3.839 Test Acc: 0.258
Validation loss decreased (-0.256433 --> -0.257609).  Saving model ...
Epoch: 17 cost time: 0.8984920978546143
Epoch: 17, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.898 Vali Acc: 0.260 Test Loss: 3.898 Test Acc: 0.260
Validation loss decreased (-0.257609 --> -0.259961).  Saving model ...
Epoch: 18 cost time: 0.8846189975738525
Epoch: 18, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.937 Vali Acc: 0.259 Test Loss: 3.937 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8077061176300049
Epoch: 19, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.983 Vali Acc: 0.260 Test Loss: 3.983 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8056938648223877
Epoch: 20, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.026 Vali Acc: 0.264 Test Loss: 4.026 Test Acc: 0.264
Validation loss decreased (-0.259961 --> -0.263489).  Saving model ...
Epoch: 21 cost time: 0.7390801906585693
Epoch: 21, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.059 Vali Acc: 0.267 Test Loss: 4.059 Test Acc: 0.267
Validation loss decreased (-0.263489 --> -0.267018).  Saving model ...
Epoch: 22 cost time: 0.8567829132080078
Epoch: 22, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.101 Vali Acc: 0.261 Test Loss: 4.101 Test Acc: 0.261
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8091497421264648
Epoch: 23, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.143 Vali Acc: 0.262 Test Loss: 4.143 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.9023246765136719
Epoch: 24, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.188 Vali Acc: 0.265 Test Loss: 4.188 Test Acc: 0.265
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.8946585655212402
Epoch: 25, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.239 Vali Acc: 0.265 Test Loss: 4.239 Test Acc: 0.265
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.7836494445800781
Epoch: 26, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.291 Vali Acc: 0.262 Test Loss: 4.291 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.8086211681365967
Epoch: 27, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.296 Vali Acc: 0.267 Test Loss: 4.296 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.8399207592010498
Epoch: 28, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.314 Vali Acc: 0.269 Test Loss: 4.314 Test Acc: 0.269
Validation loss decreased (-0.267018 --> -0.269369).  Saving model ...
Epoch: 29 cost time: 0.9282491207122803
Epoch: 29, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.341 Vali Acc: 0.274 Test Loss: 4.341 Test Acc: 0.274
Validation loss decreased (-0.269369 --> -0.274074).  Saving model ...
Epoch: 30 cost time: 0.6860373020172119
Epoch: 30, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.371 Vali Acc: 0.274 Test Loss: 4.371 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8223505020141602
Epoch: 31, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.414 Vali Acc: 0.271 Test Loss: 4.414 Test Acc: 0.271
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.9031541347503662
Epoch: 32, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.450 Vali Acc: 0.272 Test Loss: 4.450 Test Acc: 0.272
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.833986759185791
Epoch: 33, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.488 Vali Acc: 0.271 Test Loss: 4.488 Test Acc: 0.271
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.8571491241455078
Epoch: 34, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.511 Vali Acc: 0.269 Test Loss: 4.511 Test Acc: 0.269
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.9353678226470947
Epoch: 35, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.543 Vali Acc: 0.268 Test Loss: 4.543 Test Acc: 0.268
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.8663322925567627
Epoch: 36, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.566 Vali Acc: 0.268 Test Loss: 4.566 Test Acc: 0.268
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.8878939151763916
Epoch: 37, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.596 Vali Acc: 0.271 Test Loss: 4.596 Test Acc: 0.271
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.8689992427825928
Epoch: 38, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.622 Vali Acc: 0.271 Test Loss: 4.622 Test Acc: 0.271
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.8561758995056152
Epoch: 39, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.658 Vali Acc: 0.273 Test Loss: 4.658 Test Acc: 0.273
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2741176470588235
model parameter : 299610
model size : 1.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps12_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.4428322315216064
Epoch: 1, Steps: 10 | Train Loss: 3.307 Vali Loss: 3.288 Vali Acc: 0.038 Test Loss: 3.288 Test Acc: 0.038
Validation loss decreased (inf --> -0.037614).  Saving model ...
Epoch: 2 cost time: 0.8370261192321777
Epoch: 2, Steps: 10 | Train Loss: 3.132 Vali Loss: 3.262 Vali Acc: 0.058 Test Loss: 3.262 Test Acc: 0.058
Validation loss decreased (-0.037614 --> -0.057614).  Saving model ...
Epoch: 3 cost time: 0.826047420501709
Epoch: 3, Steps: 10 | Train Loss: 2.837 Vali Loss: 3.239 Vali Acc: 0.087 Test Loss: 3.239 Test Acc: 0.087
Validation loss decreased (-0.057614 --> -0.087026).  Saving model ...
Epoch: 4 cost time: 0.846426248550415
Epoch: 4, Steps: 10 | Train Loss: 2.527 Vali Loss: 3.228 Vali Acc: 0.107 Test Loss: 3.228 Test Acc: 0.107
Validation loss decreased (-0.087026 --> -0.107027).  Saving model ...
Epoch: 5 cost time: 0.7566592693328857
Epoch: 5, Steps: 10 | Train Loss: 2.190 Vali Loss: 3.208 Vali Acc: 0.128 Test Loss: 3.208 Test Acc: 0.128
Validation loss decreased (-0.107027 --> -0.128203).  Saving model ...
Epoch: 6 cost time: 0.8010420799255371
Epoch: 6, Steps: 10 | Train Loss: 1.841 Vali Loss: 3.186 Vali Acc: 0.155 Test Loss: 3.186 Test Acc: 0.155
Validation loss decreased (-0.128203 --> -0.155262).  Saving model ...
Epoch: 7 cost time: 0.7599248886108398
Epoch: 7, Steps: 10 | Train Loss: 1.500 Vali Loss: 3.171 Vali Acc: 0.182 Test Loss: 3.171 Test Acc: 0.182
Validation loss decreased (-0.155262 --> -0.182321).  Saving model ...
Epoch: 8 cost time: 0.8089797496795654
Epoch: 8, Steps: 10 | Train Loss: 1.203 Vali Loss: 3.177 Vali Acc: 0.198 Test Loss: 3.177 Test Acc: 0.198
Validation loss decreased (-0.182321 --> -0.197615).  Saving model ...
Epoch: 9 cost time: 0.8198215961456299
Epoch: 9, Steps: 10 | Train Loss: 0.962 Vali Loss: 3.189 Vali Acc: 0.207 Test Loss: 3.189 Test Acc: 0.207
Validation loss decreased (-0.197615 --> -0.207027).  Saving model ...
Epoch: 10 cost time: 0.7126049995422363
Epoch: 10, Steps: 10 | Train Loss: 0.724 Vali Loss: 3.250 Vali Acc: 0.213 Test Loss: 3.250 Test Acc: 0.213
Validation loss decreased (-0.207027 --> -0.212909).  Saving model ...
Epoch: 11 cost time: 0.7750089168548584
Epoch: 11, Steps: 10 | Train Loss: 0.528 Vali Loss: 3.309 Vali Acc: 0.232 Test Loss: 3.309 Test Acc: 0.232
Validation loss decreased (-0.212909 --> -0.231732).  Saving model ...
Epoch: 12 cost time: 0.7656176090240479
Epoch: 12, Steps: 10 | Train Loss: 0.374 Vali Loss: 3.373 Vali Acc: 0.241 Test Loss: 3.373 Test Acc: 0.241
Validation loss decreased (-0.231732 --> -0.241143).  Saving model ...
Epoch: 13 cost time: 0.771925687789917
Epoch: 13, Steps: 10 | Train Loss: 0.269 Vali Loss: 3.433 Vali Acc: 0.245 Test Loss: 3.433 Test Acc: 0.245
Validation loss decreased (-0.241143 --> -0.244672).  Saving model ...
Epoch: 14 cost time: 0.9476115703582764
Epoch: 14, Steps: 10 | Train Loss: 0.189 Vali Loss: 3.537 Vali Acc: 0.253 Test Loss: 3.537 Test Acc: 0.253
Validation loss decreased (-0.244672 --> -0.252906).  Saving model ...
Epoch: 15 cost time: 0.87990403175354
Epoch: 15, Steps: 10 | Train Loss: 0.151 Vali Loss: 3.617 Vali Acc: 0.249 Test Loss: 3.617 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7551789283752441
Epoch: 16, Steps: 10 | Train Loss: 0.105 Vali Loss: 3.664 Vali Acc: 0.254 Test Loss: 3.664 Test Acc: 0.254
Validation loss decreased (-0.252906 --> -0.254081).  Saving model ...
Epoch: 17 cost time: 0.8221349716186523
Epoch: 17, Steps: 10 | Train Loss: 0.078 Vali Loss: 3.726 Vali Acc: 0.251 Test Loss: 3.726 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8507146835327148
Epoch: 18, Steps: 10 | Train Loss: 0.062 Vali Loss: 3.795 Vali Acc: 0.251 Test Loss: 3.795 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7026021480560303
Epoch: 19, Steps: 10 | Train Loss: 0.050 Vali Loss: 3.832 Vali Acc: 0.249 Test Loss: 3.832 Test Acc: 0.249
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.8369803428649902
Epoch: 20, Steps: 10 | Train Loss: 0.041 Vali Loss: 3.873 Vali Acc: 0.254 Test Loss: 3.873 Test Acc: 0.254
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.7910473346710205
Epoch: 21, Steps: 10 | Train Loss: 0.037 Vali Loss: 3.912 Vali Acc: 0.256 Test Loss: 3.912 Test Acc: 0.256
Validation loss decreased (-0.254081 --> -0.256431).  Saving model ...
Epoch: 22 cost time: 0.7948770523071289
Epoch: 22, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.951 Vali Acc: 0.253 Test Loss: 3.951 Test Acc: 0.253
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8448331356048584
Epoch: 23, Steps: 10 | Train Loss: 0.027 Vali Loss: 3.995 Vali Acc: 0.253 Test Loss: 3.995 Test Acc: 0.253
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.8925256729125977
Epoch: 24, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.029 Vali Acc: 0.258 Test Loss: 4.029 Test Acc: 0.258
Validation loss decreased (-0.256431 --> -0.257607).  Saving model ...
Epoch: 25 cost time: 0.9176886081695557
Epoch: 25, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.071 Vali Acc: 0.258 Test Loss: 4.071 Test Acc: 0.258
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7462377548217773
Epoch: 26, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.110 Vali Acc: 0.258 Test Loss: 4.110 Test Acc: 0.258
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.7765452861785889
Epoch: 27, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.163 Vali Acc: 0.256 Test Loss: 4.163 Test Acc: 0.256
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.8787460327148438
Epoch: 28, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.182 Vali Acc: 0.256 Test Loss: 4.182 Test Acc: 0.256
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.8042457103729248
Epoch: 29, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.213 Vali Acc: 0.256 Test Loss: 4.213 Test Acc: 0.256
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.9510610103607178
Epoch: 30, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.247 Vali Acc: 0.259 Test Loss: 4.247 Test Acc: 0.259
Validation loss decreased (-0.257607 --> -0.258781).  Saving model ...
Epoch: 31 cost time: 0.8150651454925537
Epoch: 31, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.284 Vali Acc: 0.253 Test Loss: 4.284 Test Acc: 0.253
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.7552449703216553
Epoch: 32, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.324 Vali Acc: 0.256 Test Loss: 4.324 Test Acc: 0.256
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.8115074634552002
Epoch: 33, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.361 Vali Acc: 0.259 Test Loss: 4.361 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.7665090560913086
Epoch: 34, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.384 Vali Acc: 0.260 Test Loss: 4.384 Test Acc: 0.260
Validation loss decreased (-0.258781 --> -0.259956).  Saving model ...
Epoch: 35 cost time: 0.824561595916748
Epoch: 35, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.399 Vali Acc: 0.256 Test Loss: 4.399 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.8562614917755127
Epoch: 36, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.431 Vali Acc: 0.261 Test Loss: 4.431 Test Acc: 0.261
Validation loss decreased (-0.259956 --> -0.261132).  Saving model ...
Epoch: 37 cost time: 0.7975177764892578
Epoch: 37, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.473 Vali Acc: 0.260 Test Loss: 4.473 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.8709092140197754
Epoch: 38, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.501 Vali Acc: 0.259 Test Loss: 4.501 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.867229700088501
Epoch: 39, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.538 Vali Acc: 0.258 Test Loss: 4.538 Test Acc: 0.258
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.9546382427215576
Epoch: 40, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.572 Vali Acc: 0.255 Test Loss: 4.572 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.6749815940856934
Epoch: 41, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.604 Vali Acc: 0.255 Test Loss: 4.604 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.8268337249755859
Epoch: 42, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.613 Vali Acc: 0.255 Test Loss: 4.613 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.8260607719421387
Epoch: 43, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.634 Vali Acc: 0.256 Test Loss: 4.634 Test Acc: 0.256
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.9111311435699463
Epoch: 44, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.677 Vali Acc: 0.255 Test Loss: 4.677 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.8404371738433838
Epoch: 45, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.680 Vali Acc: 0.254 Test Loss: 4.680 Test Acc: 0.254
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 0.8412520885467529
Epoch: 46, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.714 Vali Acc: 0.254 Test Loss: 4.714 Test Acc: 0.254
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps12_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2611764705882353
model parameter : 234970
model size : 0.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.6291005611419678
Epoch: 1, Steps: 10 | Train Loss: 3.382 Vali Loss: 3.292 Vali Acc: 0.036 Test Loss: 3.292 Test Acc: 0.036
Validation loss decreased (inf --> -0.036438).  Saving model ...
Epoch: 2 cost time: 0.7647368907928467
Epoch: 2, Steps: 10 | Train Loss: 3.197 Vali Loss: 3.269 Vali Acc: 0.062 Test Loss: 3.269 Test Acc: 0.062
Validation loss decreased (-0.036438 --> -0.062320).  Saving model ...
Epoch: 3 cost time: 0.8885047435760498
Epoch: 3, Steps: 10 | Train Loss: 2.990 Vali Loss: 3.244 Vali Acc: 0.081 Test Loss: 3.244 Test Acc: 0.081
Validation loss decreased (-0.062320 --> -0.081144).  Saving model ...
Epoch: 4 cost time: 0.75034499168396
Epoch: 4, Steps: 10 | Train Loss: 2.702 Vali Loss: 3.219 Vali Acc: 0.108 Test Loss: 3.219 Test Acc: 0.108
Validation loss decreased (-0.081144 --> -0.108203).  Saving model ...
Epoch: 5 cost time: 0.7917187213897705
Epoch: 5, Steps: 10 | Train Loss: 2.470 Vali Loss: 3.209 Vali Acc: 0.129 Test Loss: 3.209 Test Acc: 0.129
Validation loss decreased (-0.108203 --> -0.129380).  Saving model ...
Epoch: 6 cost time: 0.7219669818878174
Epoch: 6, Steps: 10 | Train Loss: 2.170 Vali Loss: 3.193 Vali Acc: 0.146 Test Loss: 3.193 Test Acc: 0.146
Validation loss decreased (-0.129380 --> -0.145850).  Saving model ...
Epoch: 7 cost time: 0.68015456199646
Epoch: 7, Steps: 10 | Train Loss: 1.845 Vali Loss: 3.163 Vali Acc: 0.179 Test Loss: 3.163 Test Acc: 0.179
Validation loss decreased (-0.145850 --> -0.178792).  Saving model ...
Epoch: 8 cost time: 0.8028755187988281
Epoch: 8, Steps: 10 | Train Loss: 1.583 Vali Loss: 3.157 Vali Acc: 0.196 Test Loss: 3.157 Test Acc: 0.196
Validation loss decreased (-0.178792 --> -0.196439).  Saving model ...
Epoch: 9 cost time: 0.6570935249328613
Epoch: 9, Steps: 10 | Train Loss: 1.347 Vali Loss: 3.156 Vali Acc: 0.204 Test Loss: 3.156 Test Acc: 0.204
Validation loss decreased (-0.196439 --> -0.203498).  Saving model ...
Epoch: 10 cost time: 0.94698166847229
Epoch: 10, Steps: 10 | Train Loss: 1.118 Vali Loss: 3.163 Vali Acc: 0.220 Test Loss: 3.163 Test Acc: 0.220
Validation loss decreased (-0.203498 --> -0.219968).  Saving model ...
Epoch: 11 cost time: 0.7770733833312988
Epoch: 11, Steps: 10 | Train Loss: 0.874 Vali Loss: 3.195 Vali Acc: 0.228 Test Loss: 3.195 Test Acc: 0.228
Validation loss decreased (-0.219968 --> -0.228203).  Saving model ...
Epoch: 12 cost time: 0.8353502750396729
Epoch: 12, Steps: 10 | Train Loss: 0.688 Vali Loss: 3.234 Vali Acc: 0.235 Test Loss: 3.234 Test Acc: 0.235
Validation loss decreased (-0.228203 --> -0.235262).  Saving model ...
Epoch: 13 cost time: 0.6936607360839844
Epoch: 13, Steps: 10 | Train Loss: 0.549 Vali Loss: 3.282 Vali Acc: 0.240 Test Loss: 3.282 Test Acc: 0.240
Validation loss decreased (-0.235262 --> -0.239967).  Saving model ...
Epoch: 14 cost time: 0.8880105018615723
Epoch: 14, Steps: 10 | Train Loss: 0.415 Vali Loss: 3.334 Vali Acc: 0.248 Test Loss: 3.334 Test Acc: 0.248
Validation loss decreased (-0.239967 --> -0.248202).  Saving model ...
Epoch: 15 cost time: 0.8194336891174316
Epoch: 15, Steps: 10 | Train Loss: 0.301 Vali Loss: 3.404 Vali Acc: 0.252 Test Loss: 3.404 Test Acc: 0.252
Validation loss decreased (-0.248202 --> -0.251731).  Saving model ...
Epoch: 16 cost time: 0.7654752731323242
Epoch: 16, Steps: 10 | Train Loss: 0.236 Vali Loss: 3.475 Vali Acc: 0.245 Test Loss: 3.475 Test Acc: 0.245
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7152493000030518
Epoch: 17, Steps: 10 | Train Loss: 0.164 Vali Loss: 3.521 Vali Acc: 0.256 Test Loss: 3.521 Test Acc: 0.256
Validation loss decreased (-0.251731 --> -0.256435).  Saving model ...
Epoch: 18 cost time: 0.8602771759033203
Epoch: 18, Steps: 10 | Train Loss: 0.130 Vali Loss: 3.583 Vali Acc: 0.262 Test Loss: 3.583 Test Acc: 0.262
Validation loss decreased (-0.256435 --> -0.262317).  Saving model ...
Epoch: 19 cost time: 0.9045252799987793
Epoch: 19, Steps: 10 | Train Loss: 0.106 Vali Loss: 3.655 Vali Acc: 0.249 Test Loss: 3.655 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7587344646453857
Epoch: 20, Steps: 10 | Train Loss: 0.095 Vali Loss: 3.689 Vali Acc: 0.254 Test Loss: 3.689 Test Acc: 0.254
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.8579385280609131
Epoch: 21, Steps: 10 | Train Loss: 0.071 Vali Loss: 3.767 Vali Acc: 0.251 Test Loss: 3.767 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.7300467491149902
Epoch: 22, Steps: 10 | Train Loss: 0.057 Vali Loss: 3.798 Vali Acc: 0.255 Test Loss: 3.798 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.8112459182739258
Epoch: 23, Steps: 10 | Train Loss: 0.050 Vali Loss: 3.822 Vali Acc: 0.262 Test Loss: 3.822 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.857367992401123
Epoch: 24, Steps: 10 | Train Loss: 0.041 Vali Loss: 3.867 Vali Acc: 0.265 Test Loss: 3.867 Test Acc: 0.265
Validation loss decreased (-0.262317 --> -0.264667).  Saving model ...
Epoch: 25 cost time: 0.9286611080169678
Epoch: 25, Steps: 10 | Train Loss: 0.036 Vali Loss: 3.915 Vali Acc: 0.262 Test Loss: 3.915 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9080886840820312
Epoch: 26, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.959 Vali Acc: 0.258 Test Loss: 3.959 Test Acc: 0.258
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.8917737007141113
Epoch: 27, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.980 Vali Acc: 0.254 Test Loss: 3.980 Test Acc: 0.254
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.9654731750488281
Epoch: 28, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.026 Vali Acc: 0.256 Test Loss: 4.026 Test Acc: 0.256
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.8304324150085449
Epoch: 29, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.066 Vali Acc: 0.261 Test Loss: 4.066 Test Acc: 0.261
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.9037971496582031
Epoch: 30, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.092 Vali Acc: 0.262 Test Loss: 4.092 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.7798242568969727
Epoch: 31, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.116 Vali Acc: 0.260 Test Loss: 4.116 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.8516769409179688
Epoch: 32, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.123 Vali Acc: 0.264 Test Loss: 4.123 Test Acc: 0.264
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.7391636371612549
Epoch: 33, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.145 Vali Acc: 0.269 Test Loss: 4.145 Test Acc: 0.269
Validation loss decreased (-0.264667 --> -0.269370).  Saving model ...
Epoch: 34 cost time: 0.9479103088378906
Epoch: 34, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.184 Vali Acc: 0.272 Test Loss: 4.184 Test Acc: 0.272
Validation loss decreased (-0.269370 --> -0.271723).  Saving model ...
Epoch: 35 cost time: 0.810460090637207
Epoch: 35, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.234 Vali Acc: 0.262 Test Loss: 4.234 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.822059154510498
Epoch: 36, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.289 Vali Acc: 0.262 Test Loss: 4.289 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.855560302734375
Epoch: 37, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.316 Vali Acc: 0.265 Test Loss: 4.316 Test Acc: 0.265
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.8135390281677246
Epoch: 38, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.339 Vali Acc: 0.267 Test Loss: 4.339 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.7922372817993164
Epoch: 39, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.361 Vali Acc: 0.269 Test Loss: 4.361 Test Acc: 0.269
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.9000327587127686
Epoch: 40, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.396 Vali Acc: 0.267 Test Loss: 4.396 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.8900585174560547
Epoch: 41, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.435 Vali Acc: 0.266 Test Loss: 4.435 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.8142211437225342
Epoch: 42, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.459 Vali Acc: 0.262 Test Loss: 4.459 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.8466782569885254
Epoch: 43, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.488 Vali Acc: 0.264 Test Loss: 4.488 Test Acc: 0.264
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.7645466327667236
Epoch: 44, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.513 Vali Acc: 0.264 Test Loss: 4.513 Test Acc: 0.264
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27176470588235296
model parameter : 205274
model size : 0.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps23_str12_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.5148773193359375
Epoch: 1, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.288 Vali Acc: 0.046 Test Loss: 3.288 Test Acc: 0.046
Validation loss decreased (inf --> -0.045849).  Saving model ...
Epoch: 2 cost time: 0.8284182548522949
Epoch: 2, Steps: 10 | Train Loss: 3.216 Vali Loss: 3.282 Vali Acc: 0.059 Test Loss: 3.282 Test Acc: 0.059
Validation loss decreased (-0.045849 --> -0.058791).  Saving model ...
Epoch: 3 cost time: 0.878976583480835
Epoch: 3, Steps: 10 | Train Loss: 3.046 Vali Loss: 3.269 Vali Acc: 0.076 Test Loss: 3.269 Test Acc: 0.076
Validation loss decreased (-0.058791 --> -0.076438).  Saving model ...
Epoch: 4 cost time: 0.8293051719665527
Epoch: 4, Steps: 10 | Train Loss: 2.887 Vali Loss: 3.252 Vali Acc: 0.102 Test Loss: 3.252 Test Acc: 0.102
Validation loss decreased (-0.076438 --> -0.102320).  Saving model ...
Epoch: 5 cost time: 0.7463681697845459
Epoch: 5, Steps: 10 | Train Loss: 2.678 Vali Loss: 3.234 Vali Acc: 0.120 Test Loss: 3.234 Test Acc: 0.120
Validation loss decreased (-0.102320 --> -0.119968).  Saving model ...
Epoch: 6 cost time: 0.9008784294128418
Epoch: 6, Steps: 10 | Train Loss: 2.436 Vali Loss: 3.217 Vali Acc: 0.136 Test Loss: 3.217 Test Acc: 0.136
Validation loss decreased (-0.119968 --> -0.136438).  Saving model ...
Epoch: 7 cost time: 0.8801894187927246
Epoch: 7, Steps: 10 | Train Loss: 2.212 Vali Loss: 3.195 Vali Acc: 0.151 Test Loss: 3.195 Test Acc: 0.151
Validation loss decreased (-0.136438 --> -0.150556).  Saving model ...
Epoch: 8 cost time: 0.854844331741333
Epoch: 8, Steps: 10 | Train Loss: 1.965 Vali Loss: 3.177 Vali Acc: 0.166 Test Loss: 3.177 Test Acc: 0.166
Validation loss decreased (-0.150556 --> -0.165851).  Saving model ...
Epoch: 9 cost time: 0.9359889030456543
Epoch: 9, Steps: 10 | Train Loss: 1.764 Vali Loss: 3.165 Vali Acc: 0.180 Test Loss: 3.165 Test Acc: 0.180
Validation loss decreased (-0.165851 --> -0.179968).  Saving model ...
Epoch: 10 cost time: 0.8033900260925293
Epoch: 10, Steps: 10 | Train Loss: 1.568 Vali Loss: 3.159 Vali Acc: 0.185 Test Loss: 3.159 Test Acc: 0.185
Validation loss decreased (-0.179968 --> -0.184674).  Saving model ...
Epoch: 11 cost time: 0.8683655261993408
Epoch: 11, Steps: 10 | Train Loss: 1.318 Vali Loss: 3.158 Vali Acc: 0.198 Test Loss: 3.158 Test Acc: 0.198
Validation loss decreased (-0.184674 --> -0.197615).  Saving model ...
Epoch: 12 cost time: 0.8684089183807373
Epoch: 12, Steps: 10 | Train Loss: 1.160 Vali Loss: 3.162 Vali Acc: 0.201 Test Loss: 3.162 Test Acc: 0.201
Validation loss decreased (-0.197615 --> -0.201145).  Saving model ...
Epoch: 13 cost time: 0.7672641277313232
Epoch: 13, Steps: 10 | Train Loss: 1.004 Vali Loss: 3.183 Vali Acc: 0.212 Test Loss: 3.183 Test Acc: 0.212
Validation loss decreased (-0.201145 --> -0.211733).  Saving model ...
Epoch: 14 cost time: 0.8128776550292969
Epoch: 14, Steps: 10 | Train Loss: 0.833 Vali Loss: 3.195 Vali Acc: 0.219 Test Loss: 3.195 Test Acc: 0.219
Validation loss decreased (-0.211733 --> -0.218792).  Saving model ...
Epoch: 15 cost time: 0.773897647857666
Epoch: 15, Steps: 10 | Train Loss: 0.694 Vali Loss: 3.219 Vali Acc: 0.229 Test Loss: 3.219 Test Acc: 0.229
Validation loss decreased (-0.218792 --> -0.229380).  Saving model ...
Epoch: 16 cost time: 0.7239336967468262
Epoch: 16, Steps: 10 | Train Loss: 0.551 Vali Loss: 3.258 Vali Acc: 0.231 Test Loss: 3.258 Test Acc: 0.231
Validation loss decreased (-0.229380 --> -0.230556).  Saving model ...
Epoch: 17 cost time: 0.8311991691589355
Epoch: 17, Steps: 10 | Train Loss: 0.438 Vali Loss: 3.296 Vali Acc: 0.235 Test Loss: 3.296 Test Acc: 0.235
Validation loss decreased (-0.230556 --> -0.235261).  Saving model ...
Epoch: 18 cost time: 1.0603466033935547
Epoch: 18, Steps: 10 | Train Loss: 0.362 Vali Loss: 3.335 Vali Acc: 0.251 Test Loss: 3.335 Test Acc: 0.251
Validation loss decreased (-0.235261 --> -0.250555).  Saving model ...
Epoch: 19 cost time: 0.760798454284668
Epoch: 19, Steps: 10 | Train Loss: 0.282 Vali Loss: 3.384 Vali Acc: 0.253 Test Loss: 3.384 Test Acc: 0.253
Validation loss decreased (-0.250555 --> -0.252907).  Saving model ...
Epoch: 20 cost time: 0.8126487731933594
Epoch: 20, Steps: 10 | Train Loss: 0.227 Vali Loss: 3.418 Vali Acc: 0.260 Test Loss: 3.418 Test Acc: 0.260
Validation loss decreased (-0.252907 --> -0.259966).  Saving model ...
Epoch: 21 cost time: 0.9089117050170898
Epoch: 21, Steps: 10 | Train Loss: 0.182 Vali Loss: 3.481 Vali Acc: 0.259 Test Loss: 3.481 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9252212047576904
Epoch: 22, Steps: 10 | Train Loss: 0.149 Vali Loss: 3.495 Vali Acc: 0.262 Test Loss: 3.495 Test Acc: 0.262
Validation loss decreased (-0.259966 --> -0.262318).  Saving model ...
Epoch: 23 cost time: 0.9616076946258545
Epoch: 23, Steps: 10 | Train Loss: 0.127 Vali Loss: 3.544 Vali Acc: 0.260 Test Loss: 3.544 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8490912914276123
Epoch: 24, Steps: 10 | Train Loss: 0.107 Vali Loss: 3.589 Vali Acc: 0.260 Test Loss: 3.589 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.7968690395355225
Epoch: 25, Steps: 10 | Train Loss: 0.090 Vali Loss: 3.629 Vali Acc: 0.268 Test Loss: 3.629 Test Acc: 0.268
Validation loss decreased (-0.262318 --> -0.268199).  Saving model ...
Epoch: 26 cost time: 0.6830093860626221
Epoch: 26, Steps: 10 | Train Loss: 0.076 Vali Loss: 3.659 Vali Acc: 0.265 Test Loss: 3.659 Test Acc: 0.265
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.7686963081359863
Epoch: 27, Steps: 10 | Train Loss: 0.070 Vali Loss: 3.715 Vali Acc: 0.262 Test Loss: 3.715 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.930415153503418
Epoch: 28, Steps: 10 | Train Loss: 0.061 Vali Loss: 3.743 Vali Acc: 0.272 Test Loss: 3.743 Test Acc: 0.272
Validation loss decreased (-0.268199 --> -0.271727).  Saving model ...
Epoch: 29 cost time: 0.8613157272338867
Epoch: 29, Steps: 10 | Train Loss: 0.052 Vali Loss: 3.766 Vali Acc: 0.278 Test Loss: 3.766 Test Acc: 0.278
Validation loss decreased (-0.271727 --> -0.277609).  Saving model ...
Epoch: 30 cost time: 0.9087820053100586
Epoch: 30, Steps: 10 | Train Loss: 0.045 Vali Loss: 3.799 Vali Acc: 0.272 Test Loss: 3.799 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.9248933792114258
Epoch: 31, Steps: 10 | Train Loss: 0.037 Vali Loss: 3.824 Vali Acc: 0.265 Test Loss: 3.824 Test Acc: 0.265
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.8953597545623779
Epoch: 32, Steps: 10 | Train Loss: 0.037 Vali Loss: 3.862 Vali Acc: 0.267 Test Loss: 3.862 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.8256580829620361
Epoch: 33, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.882 Vali Acc: 0.265 Test Loss: 3.882 Test Acc: 0.265
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.8654096126556396
Epoch: 34, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.912 Vali Acc: 0.267 Test Loss: 3.912 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.8746001720428467
Epoch: 35, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.923 Vali Acc: 0.269 Test Loss: 3.923 Test Acc: 0.269
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.7931885719299316
Epoch: 36, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.949 Vali Acc: 0.271 Test Loss: 3.949 Test Acc: 0.271
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.8851139545440674
Epoch: 37, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.984 Vali Acc: 0.269 Test Loss: 3.984 Test Acc: 0.269
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.8630542755126953
Epoch: 38, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.018 Vali Acc: 0.272 Test Loss: 4.018 Test Acc: 0.272
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.7034642696380615
Epoch: 39, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.048 Vali Acc: 0.268 Test Loss: 4.048 Test Acc: 0.268
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps23_str12_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2776470588235294
model parameter : 170778
model size : 0.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.5398101806640625
Epoch: 1, Steps: 10 | Train Loss: 3.331 Vali Loss: 3.290 Vali Acc: 0.034 Test Loss: 3.290 Test Acc: 0.034
Validation loss decreased (inf --> -0.034085).  Saving model ...
Epoch: 2 cost time: 0.8460249900817871
Epoch: 2, Steps: 10 | Train Loss: 3.282 Vali Loss: 3.292 Vali Acc: 0.039 Test Loss: 3.292 Test Acc: 0.039
Validation loss decreased (-0.034085 --> -0.038791).  Saving model ...
Epoch: 3 cost time: 0.817204475402832
Epoch: 3, Steps: 10 | Train Loss: 3.137 Vali Loss: 3.282 Vali Acc: 0.052 Test Loss: 3.282 Test Acc: 0.052
Validation loss decreased (-0.038791 --> -0.051732).  Saving model ...
Epoch: 4 cost time: 0.8406715393066406
Epoch: 4, Steps: 10 | Train Loss: 3.029 Vali Loss: 3.267 Vali Acc: 0.067 Test Loss: 3.267 Test Acc: 0.067
Validation loss decreased (-0.051732 --> -0.067026).  Saving model ...
Epoch: 5 cost time: 0.7191798686981201
Epoch: 5, Steps: 10 | Train Loss: 2.855 Vali Loss: 3.250 Vali Acc: 0.078 Test Loss: 3.250 Test Acc: 0.078
Validation loss decreased (-0.067026 --> -0.077615).  Saving model ...
Epoch: 6 cost time: 0.8061318397521973
Epoch: 6, Steps: 10 | Train Loss: 2.694 Vali Loss: 3.236 Vali Acc: 0.088 Test Loss: 3.236 Test Acc: 0.088
Validation loss decreased (-0.077615 --> -0.088203).  Saving model ...
Epoch: 7 cost time: 0.6748788356781006
Epoch: 7, Steps: 10 | Train Loss: 2.482 Vali Loss: 3.225 Vali Acc: 0.094 Test Loss: 3.225 Test Acc: 0.094
Validation loss decreased (-0.088203 --> -0.094085).  Saving model ...
Epoch: 8 cost time: 0.7452547550201416
Epoch: 8, Steps: 10 | Train Loss: 2.343 Vali Loss: 3.206 Vali Acc: 0.114 Test Loss: 3.206 Test Acc: 0.114
Validation loss decreased (-0.094085 --> -0.114086).  Saving model ...
Epoch: 9 cost time: 0.7668356895446777
Epoch: 9, Steps: 10 | Train Loss: 2.140 Vali Loss: 3.191 Vali Acc: 0.138 Test Loss: 3.191 Test Acc: 0.138
Validation loss decreased (-0.114086 --> -0.137615).  Saving model ...
Epoch: 10 cost time: 0.8933537006378174
Epoch: 10, Steps: 10 | Train Loss: 1.968 Vali Loss: 3.176 Vali Acc: 0.156 Test Loss: 3.176 Test Acc: 0.156
Validation loss decreased (-0.137615 --> -0.156439).  Saving model ...
Epoch: 11 cost time: 0.8054554462432861
Epoch: 11, Steps: 10 | Train Loss: 1.786 Vali Loss: 3.167 Vali Acc: 0.171 Test Loss: 3.167 Test Acc: 0.171
Validation loss decreased (-0.156439 --> -0.170557).  Saving model ...
Epoch: 12 cost time: 0.7756381034851074
Epoch: 12, Steps: 10 | Train Loss: 1.591 Vali Loss: 3.159 Vali Acc: 0.176 Test Loss: 3.159 Test Acc: 0.176
Validation loss decreased (-0.170557 --> -0.176439).  Saving model ...
Epoch: 13 cost time: 0.8131921291351318
Epoch: 13, Steps: 10 | Train Loss: 1.400 Vali Loss: 3.147 Vali Acc: 0.184 Test Loss: 3.147 Test Acc: 0.184
Validation loss decreased (-0.176439 --> -0.183498).  Saving model ...
Epoch: 14 cost time: 0.8084530830383301
Epoch: 14, Steps: 10 | Train Loss: 1.258 Vali Loss: 3.145 Vali Acc: 0.196 Test Loss: 3.145 Test Acc: 0.196
Validation loss decreased (-0.183498 --> -0.196439).  Saving model ...
Epoch: 15 cost time: 0.789142370223999
Epoch: 15, Steps: 10 | Train Loss: 1.115 Vali Loss: 3.152 Vali Acc: 0.211 Test Loss: 3.152 Test Acc: 0.211
Validation loss decreased (-0.196439 --> -0.210557).  Saving model ...
Epoch: 16 cost time: 0.8748562335968018
Epoch: 16, Steps: 10 | Train Loss: 0.925 Vali Loss: 3.171 Vali Acc: 0.218 Test Loss: 3.171 Test Acc: 0.218
Validation loss decreased (-0.210557 --> -0.217615).  Saving model ...
Epoch: 17 cost time: 0.8184266090393066
Epoch: 17, Steps: 10 | Train Loss: 0.778 Vali Loss: 3.195 Vali Acc: 0.222 Test Loss: 3.195 Test Acc: 0.222
Validation loss decreased (-0.217615 --> -0.222321).  Saving model ...
Epoch: 18 cost time: 0.8015356063842773
Epoch: 18, Steps: 10 | Train Loss: 0.659 Vali Loss: 3.212 Vali Acc: 0.228 Test Loss: 3.212 Test Acc: 0.228
Validation loss decreased (-0.222321 --> -0.228203).  Saving model ...
Epoch: 19 cost time: 0.9037559032440186
Epoch: 19, Steps: 10 | Train Loss: 0.537 Vali Loss: 3.240 Vali Acc: 0.239 Test Loss: 3.240 Test Acc: 0.239
Validation loss decreased (-0.228203 --> -0.238791).  Saving model ...
Epoch: 20 cost time: 0.8732013702392578
Epoch: 20, Steps: 10 | Train Loss: 0.443 Vali Loss: 3.280 Vali Acc: 0.246 Test Loss: 3.280 Test Acc: 0.246
Validation loss decreased (-0.238791 --> -0.245850).  Saving model ...
Epoch: 21 cost time: 0.8633427619934082
Epoch: 21, Steps: 10 | Train Loss: 0.358 Vali Loss: 3.317 Vali Acc: 0.253 Test Loss: 3.317 Test Acc: 0.253
Validation loss decreased (-0.245850 --> -0.252908).  Saving model ...
Epoch: 22 cost time: 0.8725769519805908
Epoch: 22, Steps: 10 | Train Loss: 0.296 Vali Loss: 3.384 Vali Acc: 0.254 Test Loss: 3.384 Test Acc: 0.254
Validation loss decreased (-0.252908 --> -0.254084).  Saving model ...
Epoch: 23 cost time: 0.857715368270874
Epoch: 23, Steps: 10 | Train Loss: 0.238 Vali Loss: 3.423 Vali Acc: 0.254 Test Loss: 3.423 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8480932712554932
Epoch: 24, Steps: 10 | Train Loss: 0.194 Vali Loss: 3.449 Vali Acc: 0.255 Test Loss: 3.449 Test Acc: 0.255
Validation loss decreased (-0.254084 --> -0.255260).  Saving model ...
Epoch: 25 cost time: 0.871344804763794
Epoch: 25, Steps: 10 | Train Loss: 0.175 Vali Loss: 3.493 Vali Acc: 0.258 Test Loss: 3.493 Test Acc: 0.258
Validation loss decreased (-0.255260 --> -0.257612).  Saving model ...
Epoch: 26 cost time: 0.839228630065918
Epoch: 26, Steps: 10 | Train Loss: 0.138 Vali Loss: 3.534 Vali Acc: 0.260 Test Loss: 3.534 Test Acc: 0.260
Validation loss decreased (-0.257612 --> -0.259965).  Saving model ...
Epoch: 27 cost time: 0.8615374565124512
Epoch: 27, Steps: 10 | Train Loss: 0.116 Vali Loss: 3.566 Vali Acc: 0.264 Test Loss: 3.566 Test Acc: 0.264
Validation loss decreased (-0.259965 --> -0.263494).  Saving model ...
Epoch: 28 cost time: 0.8670840263366699
Epoch: 28, Steps: 10 | Train Loss: 0.099 Vali Loss: 3.643 Vali Acc: 0.256 Test Loss: 3.643 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.1160850524902344
Epoch: 29, Steps: 10 | Train Loss: 0.095 Vali Loss: 3.690 Vali Acc: 0.260 Test Loss: 3.690 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.8867003917694092
Epoch: 30, Steps: 10 | Train Loss: 0.081 Vali Loss: 3.730 Vali Acc: 0.262 Test Loss: 3.730 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.8891415596008301
Epoch: 31, Steps: 10 | Train Loss: 0.067 Vali Loss: 3.720 Vali Acc: 0.259 Test Loss: 3.720 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.0145304203033447
Epoch: 32, Steps: 10 | Train Loss: 0.059 Vali Loss: 3.752 Vali Acc: 0.261 Test Loss: 3.752 Test Acc: 0.261
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.9029252529144287
Epoch: 33, Steps: 10 | Train Loss: 0.055 Vali Loss: 3.781 Vali Acc: 0.260 Test Loss: 3.781 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.8944113254547119
Epoch: 34, Steps: 10 | Train Loss: 0.050 Vali Loss: 3.849 Vali Acc: 0.264 Test Loss: 3.849 Test Acc: 0.264
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.9126927852630615
Epoch: 35, Steps: 10 | Train Loss: 0.044 Vali Loss: 3.883 Vali Acc: 0.265 Test Loss: 3.883 Test Acc: 0.265
Validation loss decreased (-0.263494 --> -0.264667).  Saving model ...
Epoch: 36 cost time: 0.9160308837890625
Epoch: 36, Steps: 10 | Train Loss: 0.039 Vali Loss: 3.913 Vali Acc: 0.262 Test Loss: 3.913 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.941084623336792
Epoch: 37, Steps: 10 | Train Loss: 0.037 Vali Loss: 3.932 Vali Acc: 0.266 Test Loss: 3.932 Test Acc: 0.266
Validation loss decreased (-0.264667 --> -0.265843).  Saving model ...
Epoch: 38 cost time: 0.9488296508789062
Epoch: 38, Steps: 10 | Train Loss: 0.031 Vali Loss: 3.959 Vali Acc: 0.264 Test Loss: 3.959 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.9306657314300537
Epoch: 39, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.974 Vali Acc: 0.268 Test Loss: 3.974 Test Acc: 0.268
Validation loss decreased (-0.265843 --> -0.268196).  Saving model ...
Epoch: 40 cost time: 0.9103941917419434
Epoch: 40, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.026 Vali Acc: 0.265 Test Loss: 4.026 Test Acc: 0.265
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.9577527046203613
Epoch: 41, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.041 Vali Acc: 0.265 Test Loss: 4.041 Test Acc: 0.265
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.8387219905853271
Epoch: 42, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.058 Vali Acc: 0.264 Test Loss: 4.058 Test Acc: 0.264
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.8854007720947266
Epoch: 43, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.088 Vali Acc: 0.264 Test Loss: 4.088 Test Acc: 0.264
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.8087279796600342
Epoch: 44, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.118 Vali Acc: 0.268 Test Loss: 4.118 Test Acc: 0.268
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.9685227870941162
Epoch: 45, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.164 Vali Acc: 0.265 Test Loss: 4.164 Test Acc: 0.265
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.8805217742919922
Epoch: 46, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.181 Vali Acc: 0.262 Test Loss: 4.181 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.8999300003051758
Epoch: 47, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.206 Vali Acc: 0.268 Test Loss: 4.206 Test Acc: 0.268
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 0.9092385768890381
Epoch: 48, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.232 Vali Acc: 0.262 Test Loss: 4.232 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 0.8906643390655518
Epoch: 49, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.251 Vali Acc: 0.266 Test Loss: 4.251 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26823529411764707
model parameter : 156314
model size : 0.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps38_str19_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.491689443588257
Epoch: 1, Steps: 10 | Train Loss: 3.372 Vali Loss: 3.295 Vali Acc: 0.028 Test Loss: 3.295 Test Acc: 0.028
Validation loss decreased (inf --> -0.028202).  Saving model ...
Epoch: 2 cost time: 0.9389111995697021
Epoch: 2, Steps: 10 | Train Loss: 3.315 Vali Loss: 3.296 Vali Acc: 0.032 Test Loss: 3.296 Test Acc: 0.032
Validation loss decreased (-0.028202 --> -0.031732).  Saving model ...
Epoch: 3 cost time: 0.7703592777252197
Epoch: 3, Steps: 10 | Train Loss: 3.223 Vali Loss: 3.287 Vali Acc: 0.041 Test Loss: 3.287 Test Acc: 0.041
Validation loss decreased (-0.031732 --> -0.041144).  Saving model ...
Epoch: 4 cost time: 0.8998336791992188
Epoch: 4, Steps: 10 | Train Loss: 3.058 Vali Loss: 3.274 Vali Acc: 0.056 Test Loss: 3.274 Test Acc: 0.056
Validation loss decreased (-0.041144 --> -0.056438).  Saving model ...
Epoch: 5 cost time: 0.7887964248657227
Epoch: 5, Steps: 10 | Train Loss: 2.918 Vali Loss: 3.260 Vali Acc: 0.080 Test Loss: 3.260 Test Acc: 0.080
Validation loss decreased (-0.056438 --> -0.079967).  Saving model ...
Epoch: 6 cost time: 0.7115285396575928
Epoch: 6, Steps: 10 | Train Loss: 2.780 Vali Loss: 3.247 Vali Acc: 0.104 Test Loss: 3.247 Test Acc: 0.104
Validation loss decreased (-0.079967 --> -0.103497).  Saving model ...
Epoch: 7 cost time: 0.7309403419494629
Epoch: 7, Steps: 10 | Train Loss: 2.613 Vali Loss: 3.230 Vali Acc: 0.124 Test Loss: 3.230 Test Acc: 0.124
Validation loss decreased (-0.103497 --> -0.123497).  Saving model ...
Epoch: 8 cost time: 0.7578384876251221
Epoch: 8, Steps: 10 | Train Loss: 2.426 Vali Loss: 3.219 Vali Acc: 0.133 Test Loss: 3.219 Test Acc: 0.133
Validation loss decreased (-0.123497 --> -0.132909).  Saving model ...
Epoch: 9 cost time: 0.781853437423706
Epoch: 9, Steps: 10 | Train Loss: 2.253 Vali Loss: 3.203 Vali Acc: 0.149 Test Loss: 3.203 Test Acc: 0.149
Validation loss decreased (-0.132909 --> -0.149380).  Saving model ...
Epoch: 10 cost time: 0.9595074653625488
Epoch: 10, Steps: 10 | Train Loss: 2.104 Vali Loss: 3.184 Vali Acc: 0.165 Test Loss: 3.184 Test Acc: 0.165
Validation loss decreased (-0.149380 --> -0.164674).  Saving model ...
Epoch: 11 cost time: 0.9179072380065918
Epoch: 11, Steps: 10 | Train Loss: 1.891 Vali Loss: 3.178 Vali Acc: 0.166 Test Loss: 3.178 Test Acc: 0.166
Validation loss decreased (-0.164674 --> -0.165851).  Saving model ...
Epoch: 12 cost time: 0.9143321514129639
Epoch: 12, Steps: 10 | Train Loss: 1.724 Vali Loss: 3.170 Vali Acc: 0.176 Test Loss: 3.170 Test Acc: 0.176
Validation loss decreased (-0.165851 --> -0.176439).  Saving model ...
Epoch: 13 cost time: 0.8781070709228516
Epoch: 13, Steps: 10 | Train Loss: 1.556 Vali Loss: 3.158 Vali Acc: 0.185 Test Loss: 3.158 Test Acc: 0.185
Validation loss decreased (-0.176439 --> -0.184674).  Saving model ...
Epoch: 14 cost time: 0.8009111881256104
Epoch: 14, Steps: 10 | Train Loss: 1.393 Vali Loss: 3.154 Vali Acc: 0.191 Test Loss: 3.154 Test Acc: 0.191
Validation loss decreased (-0.184674 --> -0.190557).  Saving model ...
Epoch: 15 cost time: 0.8277907371520996
Epoch: 15, Steps: 10 | Train Loss: 1.256 Vali Loss: 3.157 Vali Acc: 0.200 Test Loss: 3.157 Test Acc: 0.200
Validation loss decreased (-0.190557 --> -0.199968).  Saving model ...
Epoch: 16 cost time: 0.8581671714782715
Epoch: 16, Steps: 10 | Train Loss: 1.083 Vali Loss: 3.157 Vali Acc: 0.212 Test Loss: 3.157 Test Acc: 0.212
Validation loss decreased (-0.199968 --> -0.211733).  Saving model ...
Epoch: 17 cost time: 0.8295469284057617
Epoch: 17, Steps: 10 | Train Loss: 0.921 Vali Loss: 3.159 Vali Acc: 0.222 Test Loss: 3.159 Test Acc: 0.222
Validation loss decreased (-0.211733 --> -0.222321).  Saving model ...
Epoch: 18 cost time: 0.7986652851104736
Epoch: 18, Steps: 10 | Train Loss: 0.836 Vali Loss: 3.182 Vali Acc: 0.233 Test Loss: 3.182 Test Acc: 0.233
Validation loss decreased (-0.222321 --> -0.232909).  Saving model ...
Epoch: 19 cost time: 0.7589855194091797
Epoch: 19, Steps: 10 | Train Loss: 0.725 Vali Loss: 3.217 Vali Acc: 0.240 Test Loss: 3.217 Test Acc: 0.240
Validation loss decreased (-0.232909 --> -0.239968).  Saving model ...
Epoch: 20 cost time: 0.7464780807495117
Epoch: 20, Steps: 10 | Train Loss: 0.589 Vali Loss: 3.232 Vali Acc: 0.245 Test Loss: 3.232 Test Acc: 0.245
Validation loss decreased (-0.239968 --> -0.244674).  Saving model ...
Epoch: 21 cost time: 0.8323187828063965
Epoch: 21, Steps: 10 | Train Loss: 0.480 Vali Loss: 3.271 Vali Acc: 0.248 Test Loss: 3.271 Test Acc: 0.248
Validation loss decreased (-0.244674 --> -0.248203).  Saving model ...
Epoch: 22 cost time: 0.8541548252105713
Epoch: 22, Steps: 10 | Train Loss: 0.421 Vali Loss: 3.301 Vali Acc: 0.255 Test Loss: 3.301 Test Acc: 0.255
Validation loss decreased (-0.248203 --> -0.255261).  Saving model ...
Epoch: 23 cost time: 0.7666287422180176
Epoch: 23, Steps: 10 | Train Loss: 0.360 Vali Loss: 3.346 Vali Acc: 0.256 Test Loss: 3.346 Test Acc: 0.256
Validation loss decreased (-0.255261 --> -0.256437).  Saving model ...
Epoch: 24 cost time: 0.7691833972930908
Epoch: 24, Steps: 10 | Train Loss: 0.291 Vali Loss: 3.385 Vali Acc: 0.255 Test Loss: 3.385 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7979702949523926
Epoch: 25, Steps: 10 | Train Loss: 0.257 Vali Loss: 3.435 Vali Acc: 0.256 Test Loss: 3.435 Test Acc: 0.256
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.870736837387085
Epoch: 26, Steps: 10 | Train Loss: 0.208 Vali Loss: 3.444 Vali Acc: 0.266 Test Loss: 3.444 Test Acc: 0.266
Validation loss decreased (-0.256437 --> -0.265848).  Saving model ...
Epoch: 27 cost time: 0.8487169742584229
Epoch: 27, Steps: 10 | Train Loss: 0.172 Vali Loss: 3.499 Vali Acc: 0.255 Test Loss: 3.499 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8745386600494385
Epoch: 28, Steps: 10 | Train Loss: 0.147 Vali Loss: 3.543 Vali Acc: 0.252 Test Loss: 3.543 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.8019998073577881
Epoch: 29, Steps: 10 | Train Loss: 0.122 Vali Loss: 3.559 Vali Acc: 0.255 Test Loss: 3.559 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.7271156311035156
Epoch: 30, Steps: 10 | Train Loss: 0.113 Vali Loss: 3.585 Vali Acc: 0.265 Test Loss: 3.585 Test Acc: 0.265
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.9128603935241699
Epoch: 31, Steps: 10 | Train Loss: 0.090 Vali Loss: 3.642 Vali Acc: 0.266 Test Loss: 3.642 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.7869322299957275
Epoch: 32, Steps: 10 | Train Loss: 0.082 Vali Loss: 3.676 Vali Acc: 0.266 Test Loss: 3.676 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.9773252010345459
Epoch: 33, Steps: 10 | Train Loss: 0.073 Vali Loss: 3.714 Vali Acc: 0.264 Test Loss: 3.714 Test Acc: 0.264
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.8044931888580322
Epoch: 34, Steps: 10 | Train Loss: 0.061 Vali Loss: 3.721 Vali Acc: 0.264 Test Loss: 3.721 Test Acc: 0.264
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.8622350692749023
Epoch: 35, Steps: 10 | Train Loss: 0.056 Vali Loss: 3.767 Vali Acc: 0.266 Test Loss: 3.767 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.8232219219207764
Epoch: 36, Steps: 10 | Train Loss: 0.055 Vali Loss: 3.807 Vali Acc: 0.260 Test Loss: 3.807 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps38_str19_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26588235294117646
model parameter : 151770
model size : 0.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.925340175628662
Epoch: 1, Steps: 10 | Train Loss: 3.326 Vali Loss: 3.276 Vali Acc: 0.044 Test Loss: 3.276 Test Acc: 0.044
Validation loss decreased (inf --> -0.043497).  Saving model ...
Epoch: 2 cost time: 0.810417890548706
Epoch: 2, Steps: 10 | Train Loss: 3.043 Vali Loss: 3.248 Vali Acc: 0.082 Test Loss: 3.248 Test Acc: 0.082
Validation loss decreased (-0.043497 --> -0.082320).  Saving model ...
Epoch: 3 cost time: 0.7899713516235352
Epoch: 3, Steps: 10 | Train Loss: 2.668 Vali Loss: 3.235 Vali Acc: 0.105 Test Loss: 3.235 Test Acc: 0.105
Validation loss decreased (-0.082320 --> -0.104674).  Saving model ...
Epoch: 4 cost time: 0.7249948978424072
Epoch: 4, Steps: 10 | Train Loss: 2.235 Vali Loss: 3.225 Vali Acc: 0.138 Test Loss: 3.225 Test Acc: 0.138
Validation loss decreased (-0.104674 --> -0.137615).  Saving model ...
Epoch: 5 cost time: 0.7544710636138916
Epoch: 5, Steps: 10 | Train Loss: 1.783 Vali Loss: 3.201 Vali Acc: 0.165 Test Loss: 3.201 Test Acc: 0.165
Validation loss decreased (-0.137615 --> -0.164674).  Saving model ...
Epoch: 6 cost time: 0.757713794708252
Epoch: 6, Steps: 10 | Train Loss: 1.425 Vali Loss: 3.193 Vali Acc: 0.181 Test Loss: 3.193 Test Acc: 0.181
Validation loss decreased (-0.164674 --> -0.181145).  Saving model ...
Epoch: 7 cost time: 0.8184971809387207
Epoch: 7, Steps: 10 | Train Loss: 0.995 Vali Loss: 3.211 Vali Acc: 0.199 Test Loss: 3.211 Test Acc: 0.199
Validation loss decreased (-0.181145 --> -0.198791).  Saving model ...
Epoch: 8 cost time: 0.7742125988006592
Epoch: 8, Steps: 10 | Train Loss: 0.727 Vali Loss: 3.234 Vali Acc: 0.214 Test Loss: 3.234 Test Acc: 0.214
Validation loss decreased (-0.198791 --> -0.214085).  Saving model ...
Epoch: 9 cost time: 0.77435302734375
Epoch: 9, Steps: 10 | Train Loss: 0.481 Vali Loss: 3.318 Vali Acc: 0.241 Test Loss: 3.318 Test Acc: 0.241
Validation loss decreased (-0.214085 --> -0.241143).  Saving model ...
Epoch: 10 cost time: 0.7604317665100098
Epoch: 10, Steps: 10 | Train Loss: 0.315 Vali Loss: 3.422 Vali Acc: 0.240 Test Loss: 3.422 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7923192977905273
Epoch: 11, Steps: 10 | Train Loss: 0.207 Vali Loss: 3.479 Vali Acc: 0.248 Test Loss: 3.479 Test Acc: 0.248
Validation loss decreased (-0.241143 --> -0.248201).  Saving model ...
Epoch: 12 cost time: 0.7549281120300293
Epoch: 12, Steps: 10 | Train Loss: 0.123 Vali Loss: 3.610 Vali Acc: 0.249 Test Loss: 3.610 Test Acc: 0.249
Validation loss decreased (-0.248201 --> -0.249376).  Saving model ...
Epoch: 13 cost time: 0.8964376449584961
Epoch: 13, Steps: 10 | Train Loss: 0.090 Vali Loss: 3.686 Vali Acc: 0.248 Test Loss: 3.686 Test Acc: 0.248
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9329061508178711
Epoch: 14, Steps: 10 | Train Loss: 0.062 Vali Loss: 3.742 Vali Acc: 0.262 Test Loss: 3.742 Test Acc: 0.262
Validation loss decreased (-0.249376 --> -0.262316).  Saving model ...
Epoch: 15 cost time: 0.7088034152984619
Epoch: 15, Steps: 10 | Train Loss: 0.045 Vali Loss: 3.769 Vali Acc: 0.260 Test Loss: 3.769 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7457301616668701
Epoch: 16, Steps: 10 | Train Loss: 0.039 Vali Loss: 3.809 Vali Acc: 0.261 Test Loss: 3.809 Test Acc: 0.261
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.8215739727020264
Epoch: 17, Steps: 10 | Train Loss: 0.033 Vali Loss: 3.875 Vali Acc: 0.259 Test Loss: 3.875 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.837186336517334
Epoch: 18, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.910 Vali Acc: 0.261 Test Loss: 3.910 Test Acc: 0.261
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.8804173469543457
Epoch: 19, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.926 Vali Acc: 0.261 Test Loss: 3.926 Test Acc: 0.261
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.000553846359253
Epoch: 20, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.968 Vali Acc: 0.259 Test Loss: 3.968 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.7145278453826904
Epoch: 21, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.985 Vali Acc: 0.258 Test Loss: 3.985 Test Acc: 0.258
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.7670290470123291
Epoch: 22, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.027 Vali Acc: 0.264 Test Loss: 4.027 Test Acc: 0.264
Validation loss decreased (-0.262316 --> -0.263489).  Saving model ...
Epoch: 23 cost time: 0.8587117195129395
Epoch: 23, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.063 Vali Acc: 0.268 Test Loss: 4.063 Test Acc: 0.268
Validation loss decreased (-0.263489 --> -0.268195).  Saving model ...
Epoch: 24 cost time: 0.8443725109100342
Epoch: 24, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.093 Vali Acc: 0.265 Test Loss: 4.093 Test Acc: 0.265
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8327834606170654
Epoch: 25, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.124 Vali Acc: 0.265 Test Loss: 4.124 Test Acc: 0.265
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.8638181686401367
Epoch: 26, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.166 Vali Acc: 0.266 Test Loss: 4.166 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.9041047096252441
Epoch: 27, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.202 Vali Acc: 0.262 Test Loss: 4.202 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.8322708606719971
Epoch: 28, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.224 Vali Acc: 0.266 Test Loss: 4.224 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.7839047908782959
Epoch: 29, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.242 Vali Acc: 0.265 Test Loss: 4.242 Test Acc: 0.265
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.7602479457855225
Epoch: 30, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.270 Vali Acc: 0.267 Test Loss: 4.270 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.7003438472747803
Epoch: 31, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.294 Vali Acc: 0.262 Test Loss: 4.294 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.8540725708007812
Epoch: 32, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.337 Vali Acc: 0.261 Test Loss: 4.337 Test Acc: 0.261
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.7526137828826904
Epoch: 33, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.378 Vali Acc: 0.264 Test Loss: 4.378 Test Acc: 0.264
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26823529411764707
model parameter : 219962
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.559156656265259
Epoch: 1, Steps: 10 | Train Loss: 3.310 Vali Loss: 3.285 Vali Acc: 0.032 Test Loss: 3.285 Test Acc: 0.032
Validation loss decreased (inf --> -0.031732).  Saving model ...
Epoch: 2 cost time: 0.8087549209594727
Epoch: 2, Steps: 10 | Train Loss: 3.159 Vali Loss: 3.273 Vali Acc: 0.040 Test Loss: 3.273 Test Acc: 0.040
Validation loss decreased (-0.031732 --> -0.039967).  Saving model ...
Epoch: 3 cost time: 0.7578041553497314
Epoch: 3, Steps: 10 | Train Loss: 2.932 Vali Loss: 3.251 Vali Acc: 0.064 Test Loss: 3.251 Test Acc: 0.064
Validation loss decreased (-0.039967 --> -0.063497).  Saving model ...
Epoch: 4 cost time: 0.7958102226257324
Epoch: 4, Steps: 10 | Train Loss: 2.672 Vali Loss: 3.237 Vali Acc: 0.091 Test Loss: 3.237 Test Acc: 0.091
Validation loss decreased (-0.063497 --> -0.090556).  Saving model ...
Epoch: 5 cost time: 0.7116811275482178
Epoch: 5, Steps: 10 | Train Loss: 2.418 Vali Loss: 3.218 Vali Acc: 0.109 Test Loss: 3.218 Test Acc: 0.109
Validation loss decreased (-0.090556 --> -0.109380).  Saving model ...
Epoch: 6 cost time: 0.7679080963134766
Epoch: 6, Steps: 10 | Train Loss: 2.149 Vali Loss: 3.200 Vali Acc: 0.128 Test Loss: 3.200 Test Acc: 0.128
Validation loss decreased (-0.109380 --> -0.128203).  Saving model ...
Epoch: 7 cost time: 0.8980238437652588
Epoch: 7, Steps: 10 | Train Loss: 1.816 Vali Loss: 3.181 Vali Acc: 0.151 Test Loss: 3.181 Test Acc: 0.151
Validation loss decreased (-0.128203 --> -0.150556).  Saving model ...
Epoch: 8 cost time: 0.7720298767089844
Epoch: 8, Steps: 10 | Train Loss: 1.571 Vali Loss: 3.174 Vali Acc: 0.173 Test Loss: 3.174 Test Acc: 0.173
Validation loss decreased (-0.150556 --> -0.172909).  Saving model ...
Epoch: 9 cost time: 0.7451455593109131
Epoch: 9, Steps: 10 | Train Loss: 1.306 Vali Loss: 3.171 Vali Acc: 0.194 Test Loss: 3.171 Test Acc: 0.194
Validation loss decreased (-0.172909 --> -0.194086).  Saving model ...
Epoch: 10 cost time: 0.6824405193328857
Epoch: 10, Steps: 10 | Train Loss: 1.064 Vali Loss: 3.173 Vali Acc: 0.205 Test Loss: 3.173 Test Acc: 0.205
Validation loss decreased (-0.194086 --> -0.204674).  Saving model ...
Epoch: 11 cost time: 0.744809627532959
Epoch: 11, Steps: 10 | Train Loss: 0.859 Vali Loss: 3.201 Vali Acc: 0.216 Test Loss: 3.201 Test Acc: 0.216
Validation loss decreased (-0.204674 --> -0.216439).  Saving model ...
Epoch: 12 cost time: 0.7440741062164307
Epoch: 12, Steps: 10 | Train Loss: 0.664 Vali Loss: 3.238 Vali Acc: 0.213 Test Loss: 3.238 Test Acc: 0.213
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.733771800994873
Epoch: 13, Steps: 10 | Train Loss: 0.530 Vali Loss: 3.294 Vali Acc: 0.224 Test Loss: 3.294 Test Acc: 0.224
Validation loss decreased (-0.216439 --> -0.223496).  Saving model ...
Epoch: 14 cost time: 0.8999686241149902
Epoch: 14, Steps: 10 | Train Loss: 0.410 Vali Loss: 3.349 Vali Acc: 0.236 Test Loss: 3.349 Test Acc: 0.236
Validation loss decreased (-0.223496 --> -0.236437).  Saving model ...
Epoch: 15 cost time: 0.6940746307373047
Epoch: 15, Steps: 10 | Train Loss: 0.301 Vali Loss: 3.408 Vali Acc: 0.244 Test Loss: 3.408 Test Acc: 0.244
Validation loss decreased (-0.236437 --> -0.243495).  Saving model ...
Epoch: 16 cost time: 0.7324228286743164
Epoch: 16, Steps: 10 | Train Loss: 0.247 Vali Loss: 3.472 Vali Acc: 0.253 Test Loss: 3.472 Test Acc: 0.253
Validation loss decreased (-0.243495 --> -0.252906).  Saving model ...
Epoch: 17 cost time: 0.7911727428436279
Epoch: 17, Steps: 10 | Train Loss: 0.182 Vali Loss: 3.536 Vali Acc: 0.258 Test Loss: 3.536 Test Acc: 0.258
Validation loss decreased (-0.252906 --> -0.257612).  Saving model ...
Epoch: 18 cost time: 0.7246861457824707
Epoch: 18, Steps: 10 | Train Loss: 0.135 Vali Loss: 3.575 Vali Acc: 0.259 Test Loss: 3.575 Test Acc: 0.259
Validation loss decreased (-0.257612 --> -0.258788).  Saving model ...
Epoch: 19 cost time: 0.6657063961029053
Epoch: 19, Steps: 10 | Train Loss: 0.109 Vali Loss: 3.638 Vali Acc: 0.262 Test Loss: 3.638 Test Acc: 0.262
Validation loss decreased (-0.258788 --> -0.262317).  Saving model ...
Epoch: 20 cost time: 0.7885744571685791
Epoch: 20, Steps: 10 | Train Loss: 0.092 Vali Loss: 3.680 Vali Acc: 0.262 Test Loss: 3.680 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7030322551727295
Epoch: 21, Steps: 10 | Train Loss: 0.075 Vali Loss: 3.716 Vali Acc: 0.262 Test Loss: 3.716 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7914354801177979
Epoch: 22, Steps: 10 | Train Loss: 0.064 Vali Loss: 3.778 Vali Acc: 0.262 Test Loss: 3.778 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.0002543926239014
Epoch: 23, Steps: 10 | Train Loss: 0.055 Vali Loss: 3.832 Vali Acc: 0.267 Test Loss: 3.832 Test Acc: 0.267
Validation loss decreased (-0.262317 --> -0.267021).  Saving model ...
Epoch: 24 cost time: 0.6774263381958008
Epoch: 24, Steps: 10 | Train Loss: 0.045 Vali Loss: 3.877 Vali Acc: 0.265 Test Loss: 3.877 Test Acc: 0.265
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7556514739990234
Epoch: 25, Steps: 10 | Train Loss: 0.041 Vali Loss: 3.939 Vali Acc: 0.262 Test Loss: 3.939 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.795720100402832
Epoch: 26, Steps: 10 | Train Loss: 0.036 Vali Loss: 3.954 Vali Acc: 0.264 Test Loss: 3.954 Test Acc: 0.264
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.6999332904815674
Epoch: 27, Steps: 10 | Train Loss: 0.033 Vali Loss: 3.998 Vali Acc: 0.265 Test Loss: 3.998 Test Acc: 0.265
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.7540204524993896
Epoch: 28, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.022 Vali Acc: 0.259 Test Loss: 4.022 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.8053286075592041
Epoch: 29, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.058 Vali Acc: 0.261 Test Loss: 4.058 Test Acc: 0.261
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.8476536273956299
Epoch: 30, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.099 Vali Acc: 0.260 Test Loss: 4.099 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.7434048652648926
Epoch: 31, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.143 Vali Acc: 0.262 Test Loss: 4.143 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.7968461513519287
Epoch: 32, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.193 Vali Acc: 0.262 Test Loss: 4.193 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.7755072116851807
Epoch: 33, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.215 Vali Acc: 0.262 Test Loss: 4.215 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26705882352941174
model parameter : 125242
model size : 0.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps12_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.475062608718872
Epoch: 1, Steps: 10 | Train Loss: 3.356 Vali Loss: 3.303 Vali Acc: 0.041 Test Loss: 3.303 Test Acc: 0.041
Validation loss decreased (inf --> -0.041143).  Saving model ...
Epoch: 2 cost time: 0.8145370483398438
Epoch: 2, Steps: 10 | Train Loss: 3.283 Vali Loss: 3.299 Vali Acc: 0.047 Test Loss: 3.299 Test Acc: 0.047
Validation loss decreased (-0.041143 --> -0.047026).  Saving model ...
Epoch: 3 cost time: 0.6838028430938721
Epoch: 3, Steps: 10 | Train Loss: 3.093 Vali Loss: 3.288 Vali Acc: 0.061 Test Loss: 3.288 Test Acc: 0.061
Validation loss decreased (-0.047026 --> -0.061144).  Saving model ...
Epoch: 4 cost time: 0.667485237121582
Epoch: 4, Steps: 10 | Train Loss: 2.885 Vali Loss: 3.278 Vali Acc: 0.068 Test Loss: 3.278 Test Acc: 0.068
Validation loss decreased (-0.061144 --> -0.068203).  Saving model ...
Epoch: 5 cost time: 0.8026444911956787
Epoch: 5, Steps: 10 | Train Loss: 2.734 Vali Loss: 3.267 Vali Acc: 0.088 Test Loss: 3.267 Test Acc: 0.088
Validation loss decreased (-0.068203 --> -0.088203).  Saving model ...
Epoch: 6 cost time: 0.7091865539550781
Epoch: 6, Steps: 10 | Train Loss: 2.464 Vali Loss: 3.254 Vali Acc: 0.105 Test Loss: 3.254 Test Acc: 0.105
Validation loss decreased (-0.088203 --> -0.104673).  Saving model ...
Epoch: 7 cost time: 0.6594617366790771
Epoch: 7, Steps: 10 | Train Loss: 2.266 Vali Loss: 3.239 Vali Acc: 0.124 Test Loss: 3.239 Test Acc: 0.124
Validation loss decreased (-0.104673 --> -0.123497).  Saving model ...
Epoch: 8 cost time: 0.7838795185089111
Epoch: 8, Steps: 10 | Train Loss: 2.084 Vali Loss: 3.221 Vali Acc: 0.139 Test Loss: 3.221 Test Acc: 0.139
Validation loss decreased (-0.123497 --> -0.138791).  Saving model ...
Epoch: 9 cost time: 0.8178749084472656
Epoch: 9, Steps: 10 | Train Loss: 1.846 Vali Loss: 3.205 Vali Acc: 0.155 Test Loss: 3.205 Test Acc: 0.155
Validation loss decreased (-0.138791 --> -0.155262).  Saving model ...
Epoch: 10 cost time: 0.7877767086029053
Epoch: 10, Steps: 10 | Train Loss: 1.650 Vali Loss: 3.194 Vali Acc: 0.168 Test Loss: 3.194 Test Acc: 0.168
Validation loss decreased (-0.155262 --> -0.168203).  Saving model ...
Epoch: 11 cost time: 0.7498457431793213
Epoch: 11, Steps: 10 | Train Loss: 1.423 Vali Loss: 3.191 Vali Acc: 0.186 Test Loss: 3.191 Test Acc: 0.186
Validation loss decreased (-0.168203 --> -0.185850).  Saving model ...
Epoch: 12 cost time: 0.7644951343536377
Epoch: 12, Steps: 10 | Train Loss: 1.189 Vali Loss: 3.189 Vali Acc: 0.195 Test Loss: 3.189 Test Acc: 0.195
Validation loss decreased (-0.185850 --> -0.195262).  Saving model ...
Epoch: 13 cost time: 0.8080093860626221
Epoch: 13, Steps: 10 | Train Loss: 1.051 Vali Loss: 3.191 Vali Acc: 0.200 Test Loss: 3.191 Test Acc: 0.200
Validation loss decreased (-0.195262 --> -0.199968).  Saving model ...
Epoch: 14 cost time: 0.6277515888214111
Epoch: 14, Steps: 10 | Train Loss: 0.870 Vali Loss: 3.215 Vali Acc: 0.204 Test Loss: 3.215 Test Acc: 0.204
Validation loss decreased (-0.199968 --> -0.203497).  Saving model ...
Epoch: 15 cost time: 0.7071897983551025
Epoch: 15, Steps: 10 | Train Loss: 0.744 Vali Loss: 3.246 Vali Acc: 0.219 Test Loss: 3.246 Test Acc: 0.219
Validation loss decreased (-0.203497 --> -0.218791).  Saving model ...
Epoch: 16 cost time: 0.760880708694458
Epoch: 16, Steps: 10 | Train Loss: 0.592 Vali Loss: 3.275 Vali Acc: 0.228 Test Loss: 3.275 Test Acc: 0.228
Validation loss decreased (-0.218791 --> -0.228203).  Saving model ...
Epoch: 17 cost time: 0.6290051937103271
Epoch: 17, Steps: 10 | Train Loss: 0.482 Vali Loss: 3.308 Vali Acc: 0.232 Test Loss: 3.308 Test Acc: 0.232
Validation loss decreased (-0.228203 --> -0.231732).  Saving model ...
Epoch: 18 cost time: 0.7984867095947266
Epoch: 18, Steps: 10 | Train Loss: 0.396 Vali Loss: 3.355 Vali Acc: 0.232 Test Loss: 3.355 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8157553672790527
Epoch: 19, Steps: 10 | Train Loss: 0.324 Vali Loss: 3.401 Vali Acc: 0.239 Test Loss: 3.401 Test Acc: 0.239
Validation loss decreased (-0.231732 --> -0.238790).  Saving model ...
Epoch: 20 cost time: 0.9098691940307617
Epoch: 20, Steps: 10 | Train Loss: 0.251 Vali Loss: 3.447 Vali Acc: 0.240 Test Loss: 3.447 Test Acc: 0.240
Validation loss decreased (-0.238790 --> -0.239966).  Saving model ...
Epoch: 21 cost time: 0.7281336784362793
Epoch: 21, Steps: 10 | Train Loss: 0.214 Vali Loss: 3.488 Vali Acc: 0.240 Test Loss: 3.488 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8488526344299316
Epoch: 22, Steps: 10 | Train Loss: 0.164 Vali Loss: 3.527 Vali Acc: 0.238 Test Loss: 3.527 Test Acc: 0.238
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.7440040111541748
Epoch: 23, Steps: 10 | Train Loss: 0.144 Vali Loss: 3.559 Vali Acc: 0.245 Test Loss: 3.559 Test Acc: 0.245
Validation loss decreased (-0.239966 --> -0.244670).  Saving model ...
Epoch: 24 cost time: 0.7625524997711182
Epoch: 24, Steps: 10 | Train Loss: 0.122 Vali Loss: 3.589 Vali Acc: 0.246 Test Loss: 3.589 Test Acc: 0.246
Validation loss decreased (-0.244670 --> -0.245846).  Saving model ...
Epoch: 25 cost time: 0.799013614654541
Epoch: 25, Steps: 10 | Train Loss: 0.112 Vali Loss: 3.642 Vali Acc: 0.252 Test Loss: 3.642 Test Acc: 0.252
Validation loss decreased (-0.245846 --> -0.251728).  Saving model ...
Epoch: 26 cost time: 0.734370231628418
Epoch: 26, Steps: 10 | Train Loss: 0.089 Vali Loss: 3.662 Vali Acc: 0.253 Test Loss: 3.662 Test Acc: 0.253
Validation loss decreased (-0.251728 --> -0.252905).  Saving model ...
Epoch: 27 cost time: 0.7871236801147461
Epoch: 27, Steps: 10 | Train Loss: 0.080 Vali Loss: 3.703 Vali Acc: 0.252 Test Loss: 3.703 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.923288106918335
Epoch: 28, Steps: 10 | Train Loss: 0.071 Vali Loss: 3.755 Vali Acc: 0.251 Test Loss: 3.755 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.7644379138946533
Epoch: 29, Steps: 10 | Train Loss: 0.063 Vali Loss: 3.801 Vali Acc: 0.258 Test Loss: 3.801 Test Acc: 0.258
Validation loss decreased (-0.252905 --> -0.257609).  Saving model ...
Epoch: 30 cost time: 0.7831950187683105
Epoch: 30, Steps: 10 | Train Loss: 0.058 Vali Loss: 3.822 Vali Acc: 0.256 Test Loss: 3.822 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8631069660186768
Epoch: 31, Steps: 10 | Train Loss: 0.051 Vali Loss: 3.838 Vali Acc: 0.254 Test Loss: 3.838 Test Acc: 0.254
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.7517857551574707
Epoch: 32, Steps: 10 | Train Loss: 0.043 Vali Loss: 3.856 Vali Acc: 0.255 Test Loss: 3.856 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.708625316619873
Epoch: 33, Steps: 10 | Train Loss: 0.041 Vali Loss: 3.885 Vali Acc: 0.255 Test Loss: 3.885 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.7460284233093262
Epoch: 34, Steps: 10 | Train Loss: 0.037 Vali Loss: 3.950 Vali Acc: 0.253 Test Loss: 3.950 Test Acc: 0.253
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.6459369659423828
Epoch: 35, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.983 Vali Acc: 0.255 Test Loss: 3.983 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.8696804046630859
Epoch: 36, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.005 Vali Acc: 0.253 Test Loss: 4.005 Test Acc: 0.253
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.6808433532714844
Epoch: 37, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.017 Vali Acc: 0.253 Test Loss: 4.017 Test Acc: 0.253
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.7394754886627197
Epoch: 38, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.035 Vali Acc: 0.254 Test Loss: 4.035 Test Acc: 0.254
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.730764627456665
Epoch: 39, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.080 Vali Acc: 0.256 Test Loss: 4.080 Test Acc: 0.256
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps12_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2576470588235294
model parameter : 92922
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.4217641353607178
Epoch: 1, Steps: 10 | Train Loss: 3.340 Vali Loss: 3.280 Vali Acc: 0.041 Test Loss: 3.280 Test Acc: 0.041
Validation loss decreased (inf --> -0.041144).  Saving model ...
Epoch: 2 cost time: 0.6814491748809814
Epoch: 2, Steps: 10 | Train Loss: 3.236 Vali Loss: 3.276 Vali Acc: 0.044 Test Loss: 3.276 Test Acc: 0.044
Validation loss decreased (-0.041144 --> -0.043497).  Saving model ...
Epoch: 3 cost time: 0.6843283176422119
Epoch: 3, Steps: 10 | Train Loss: 3.122 Vali Loss: 3.266 Vali Acc: 0.061 Test Loss: 3.266 Test Acc: 0.061
Validation loss decreased (-0.043497 --> -0.061144).  Saving model ...
Epoch: 4 cost time: 0.8044357299804688
Epoch: 4, Steps: 10 | Train Loss: 3.004 Vali Loss: 3.253 Vali Acc: 0.089 Test Loss: 3.253 Test Acc: 0.089
Validation loss decreased (-0.061144 --> -0.089379).  Saving model ...
Epoch: 5 cost time: 0.8375861644744873
Epoch: 5, Steps: 10 | Train Loss: 2.843 Vali Loss: 3.240 Vali Acc: 0.098 Test Loss: 3.240 Test Acc: 0.098
Validation loss decreased (-0.089379 --> -0.097615).  Saving model ...
Epoch: 6 cost time: 0.7841289043426514
Epoch: 6, Steps: 10 | Train Loss: 2.663 Vali Loss: 3.225 Vali Acc: 0.118 Test Loss: 3.225 Test Acc: 0.118
Validation loss decreased (-0.097615 --> -0.117615).  Saving model ...
Epoch: 7 cost time: 0.702364444732666
Epoch: 7, Steps: 10 | Train Loss: 2.504 Vali Loss: 3.213 Vali Acc: 0.122 Test Loss: 3.213 Test Acc: 0.122
Validation loss decreased (-0.117615 --> -0.122321).  Saving model ...
Epoch: 8 cost time: 0.8194377422332764
Epoch: 8, Steps: 10 | Train Loss: 2.328 Vali Loss: 3.201 Vali Acc: 0.133 Test Loss: 3.201 Test Acc: 0.133
Validation loss decreased (-0.122321 --> -0.132909).  Saving model ...
Epoch: 9 cost time: 0.7573130130767822
Epoch: 9, Steps: 10 | Train Loss: 2.116 Vali Loss: 3.191 Vali Acc: 0.146 Test Loss: 3.191 Test Acc: 0.146
Validation loss decreased (-0.132909 --> -0.145850).  Saving model ...
Epoch: 10 cost time: 0.8178703784942627
Epoch: 10, Steps: 10 | Train Loss: 1.968 Vali Loss: 3.177 Vali Acc: 0.155 Test Loss: 3.177 Test Acc: 0.155
Validation loss decreased (-0.145850 --> -0.155262).  Saving model ...
Epoch: 11 cost time: 0.8197274208068848
Epoch: 11, Steps: 10 | Train Loss: 1.769 Vali Loss: 3.169 Vali Acc: 0.162 Test Loss: 3.169 Test Acc: 0.162
Validation loss decreased (-0.155262 --> -0.162321).  Saving model ...
Epoch: 12 cost time: 0.8310418128967285
Epoch: 12, Steps: 10 | Train Loss: 1.608 Vali Loss: 3.171 Vali Acc: 0.174 Test Loss: 3.171 Test Acc: 0.174
Validation loss decreased (-0.162321 --> -0.174086).  Saving model ...
Epoch: 13 cost time: 0.9445879459381104
Epoch: 13, Steps: 10 | Train Loss: 1.438 Vali Loss: 3.173 Vali Acc: 0.176 Test Loss: 3.173 Test Acc: 0.176
Validation loss decreased (-0.174086 --> -0.176439).  Saving model ...
Epoch: 14 cost time: 0.9833908081054688
Epoch: 14, Steps: 10 | Train Loss: 1.251 Vali Loss: 3.171 Vali Acc: 0.196 Test Loss: 3.171 Test Acc: 0.196
Validation loss decreased (-0.176439 --> -0.196439).  Saving model ...
Epoch: 15 cost time: 1.0263094902038574
Epoch: 15, Steps: 10 | Train Loss: 1.115 Vali Loss: 3.175 Vali Acc: 0.208 Test Loss: 3.175 Test Acc: 0.208
Validation loss decreased (-0.196439 --> -0.208204).  Saving model ...
Epoch: 16 cost time: 1.009664535522461
Epoch: 16, Steps: 10 | Train Loss: 0.947 Vali Loss: 3.194 Vali Acc: 0.213 Test Loss: 3.194 Test Acc: 0.213
Validation loss decreased (-0.208204 --> -0.212909).  Saving model ...
Epoch: 17 cost time: 0.8846642971038818
Epoch: 17, Steps: 10 | Train Loss: 0.823 Vali Loss: 3.218 Vali Acc: 0.218 Test Loss: 3.218 Test Acc: 0.218
Validation loss decreased (-0.212909 --> -0.217615).  Saving model ...
Epoch: 18 cost time: 0.9946274757385254
Epoch: 18, Steps: 10 | Train Loss: 0.736 Vali Loss: 3.246 Vali Acc: 0.227 Test Loss: 3.246 Test Acc: 0.227
Validation loss decreased (-0.217615 --> -0.227026).  Saving model ...
Epoch: 19 cost time: 0.9431333541870117
Epoch: 19, Steps: 10 | Train Loss: 0.593 Vali Loss: 3.272 Vali Acc: 0.234 Test Loss: 3.272 Test Acc: 0.234
Validation loss decreased (-0.227026 --> -0.234085).  Saving model ...
Epoch: 20 cost time: 0.9592173099517822
Epoch: 20, Steps: 10 | Train Loss: 0.503 Vali Loss: 3.316 Vali Acc: 0.239 Test Loss: 3.316 Test Acc: 0.239
Validation loss decreased (-0.234085 --> -0.238790).  Saving model ...
Epoch: 21 cost time: 1.1162340641021729
Epoch: 21, Steps: 10 | Train Loss: 0.422 Vali Loss: 3.343 Vali Acc: 0.239 Test Loss: 3.343 Test Acc: 0.239
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8599872589111328
Epoch: 22, Steps: 10 | Train Loss: 0.354 Vali Loss: 3.391 Vali Acc: 0.244 Test Loss: 3.391 Test Acc: 0.244
Validation loss decreased (-0.238790 --> -0.243496).  Saving model ...
Epoch: 23 cost time: 0.9098989963531494
Epoch: 23, Steps: 10 | Train Loss: 0.309 Vali Loss: 3.450 Vali Acc: 0.242 Test Loss: 3.450 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0270426273345947
Epoch: 24, Steps: 10 | Train Loss: 0.262 Vali Loss: 3.491 Vali Acc: 0.258 Test Loss: 3.491 Test Acc: 0.258
Validation loss decreased (-0.243496 --> -0.257612).  Saving model ...
Epoch: 25 cost time: 1.0288684368133545
Epoch: 25, Steps: 10 | Train Loss: 0.214 Vali Loss: 3.558 Vali Acc: 0.254 Test Loss: 3.558 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.972447395324707
Epoch: 26, Steps: 10 | Train Loss: 0.179 Vali Loss: 3.576 Vali Acc: 0.260 Test Loss: 3.576 Test Acc: 0.260
Validation loss decreased (-0.257612 --> -0.259964).  Saving model ...
Epoch: 27 cost time: 1.181408166885376
Epoch: 27, Steps: 10 | Train Loss: 0.157 Vali Loss: 3.595 Vali Acc: 0.262 Test Loss: 3.595 Test Acc: 0.262
Validation loss decreased (-0.259964 --> -0.262317).  Saving model ...
Epoch: 28 cost time: 0.908179759979248
Epoch: 28, Steps: 10 | Train Loss: 0.140 Vali Loss: 3.664 Vali Acc: 0.255 Test Loss: 3.664 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7841689586639404
Epoch: 29, Steps: 10 | Train Loss: 0.117 Vali Loss: 3.716 Vali Acc: 0.266 Test Loss: 3.716 Test Acc: 0.266
Validation loss decreased (-0.262317 --> -0.265845).  Saving model ...
Epoch: 30 cost time: 0.9763257503509521
Epoch: 30, Steps: 10 | Train Loss: 0.112 Vali Loss: 3.762 Vali Acc: 0.265 Test Loss: 3.762 Test Acc: 0.265
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.997352123260498
Epoch: 31, Steps: 10 | Train Loss: 0.093 Vali Loss: 3.799 Vali Acc: 0.260 Test Loss: 3.799 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.0428850650787354
Epoch: 32, Steps: 10 | Train Loss: 0.083 Vali Loss: 3.837 Vali Acc: 0.268 Test Loss: 3.837 Test Acc: 0.268
Validation loss decreased (-0.265845 --> -0.268197).  Saving model ...
Epoch: 33 cost time: 0.7372028827667236
Epoch: 33, Steps: 10 | Train Loss: 0.076 Vali Loss: 3.886 Vali Acc: 0.265 Test Loss: 3.886 Test Acc: 0.265
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.9931671619415283
Epoch: 34, Steps: 10 | Train Loss: 0.063 Vali Loss: 3.902 Vali Acc: 0.266 Test Loss: 3.902 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.03482985496521
Epoch: 35, Steps: 10 | Train Loss: 0.061 Vali Loss: 3.940 Vali Acc: 0.265 Test Loss: 3.940 Test Acc: 0.265
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.9871830940246582
Epoch: 36, Steps: 10 | Train Loss: 0.056 Vali Loss: 3.970 Vali Acc: 0.266 Test Loss: 3.970 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.8323915004730225
Epoch: 37, Steps: 10 | Train Loss: 0.048 Vali Loss: 4.002 Vali Acc: 0.267 Test Loss: 4.002 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.6922359466552734
Epoch: 38, Steps: 10 | Train Loss: 0.044 Vali Loss: 4.055 Vali Acc: 0.267 Test Loss: 4.055 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.9554481506347656
Epoch: 39, Steps: 10 | Train Loss: 0.043 Vali Loss: 4.090 Vali Acc: 0.268 Test Loss: 4.090 Test Acc: 0.268
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.8875937461853027
Epoch: 40, Steps: 10 | Train Loss: 0.038 Vali Loss: 4.110 Vali Acc: 0.271 Test Loss: 4.110 Test Acc: 0.271
Validation loss decreased (-0.268197 --> -0.270547).  Saving model ...
Epoch: 41 cost time: 0.9092085361480713
Epoch: 41, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.138 Vali Acc: 0.261 Test Loss: 4.138 Test Acc: 0.261
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.7677335739135742
Epoch: 42, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.213 Vali Acc: 0.265 Test Loss: 4.213 Test Acc: 0.265
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.9488382339477539
Epoch: 43, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.247 Vali Acc: 0.267 Test Loss: 4.247 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.8464736938476562
Epoch: 44, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.258 Vali Acc: 0.268 Test Loss: 4.258 Test Acc: 0.268
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.9149196147918701
Epoch: 45, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.288 Vali Acc: 0.268 Test Loss: 4.288 Test Acc: 0.268
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.7940053939819336
Epoch: 46, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.305 Vali Acc: 0.266 Test Loss: 4.305 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.857832670211792
Epoch: 47, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.329 Vali Acc: 0.269 Test Loss: 4.329 Test Acc: 0.269
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 0.9195973873138428
Epoch: 48, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.367 Vali Acc: 0.269 Test Loss: 4.367 Test Acc: 0.269
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 0.9936695098876953
Epoch: 49, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.395 Vali Acc: 0.271 Test Loss: 4.395 Test Acc: 0.271
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 0.919196367263794
Epoch: 50, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.438 Vali Acc: 0.264 Test Loss: 4.438 Test Acc: 0.264
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27058823529411763
model parameter : 78074
model size : 0.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps23_str12_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.409449577331543
Epoch: 1, Steps: 10 | Train Loss: 3.356 Vali Loss: 3.296 Vali Acc: 0.044 Test Loss: 3.296 Test Acc: 0.044
Validation loss decreased (inf --> -0.043496).  Saving model ...
Epoch: 2 cost time: 0.9032626152038574
Epoch: 2, Steps: 10 | Train Loss: 3.300 Vali Loss: 3.299 Vali Acc: 0.045 Test Loss: 3.299 Test Acc: 0.045
Validation loss decreased (-0.043496 --> -0.044673).  Saving model ...
Epoch: 3 cost time: 0.8368949890136719
Epoch: 3, Steps: 10 | Train Loss: 3.235 Vali Loss: 3.294 Vali Acc: 0.053 Test Loss: 3.294 Test Acc: 0.053
Validation loss decreased (-0.044673 --> -0.052908).  Saving model ...
Epoch: 4 cost time: 0.8833315372467041
Epoch: 4, Steps: 10 | Train Loss: 3.127 Vali Loss: 3.284 Vali Acc: 0.065 Test Loss: 3.284 Test Acc: 0.065
Validation loss decreased (-0.052908 --> -0.064673).  Saving model ...
Epoch: 5 cost time: 0.8065741062164307
Epoch: 5, Steps: 10 | Train Loss: 3.025 Vali Loss: 3.272 Vali Acc: 0.067 Test Loss: 3.272 Test Acc: 0.067
Validation loss decreased (-0.064673 --> -0.067026).  Saving model ...
Epoch: 6 cost time: 0.8277897834777832
Epoch: 6, Steps: 10 | Train Loss: 2.896 Vali Loss: 3.259 Vali Acc: 0.078 Test Loss: 3.259 Test Acc: 0.078
Validation loss decreased (-0.067026 --> -0.077614).  Saving model ...
Epoch: 7 cost time: 0.8172407150268555
Epoch: 7, Steps: 10 | Train Loss: 2.749 Vali Loss: 3.248 Vali Acc: 0.085 Test Loss: 3.248 Test Acc: 0.085
Validation loss decreased (-0.077614 --> -0.084673).  Saving model ...
Epoch: 8 cost time: 0.7235198020935059
Epoch: 8, Steps: 10 | Train Loss: 2.652 Vali Loss: 3.236 Vali Acc: 0.105 Test Loss: 3.236 Test Acc: 0.105
Validation loss decreased (-0.084673 --> -0.104674).  Saving model ...
Epoch: 9 cost time: 0.7309226989746094
Epoch: 9, Steps: 10 | Train Loss: 2.501 Vali Loss: 3.228 Vali Acc: 0.112 Test Loss: 3.228 Test Acc: 0.112
Validation loss decreased (-0.104674 --> -0.111732).  Saving model ...
Epoch: 10 cost time: 0.6716432571411133
Epoch: 10, Steps: 10 | Train Loss: 2.347 Vali Loss: 3.218 Vali Acc: 0.120 Test Loss: 3.218 Test Acc: 0.120
Validation loss decreased (-0.111732 --> -0.119968).  Saving model ...
Epoch: 11 cost time: 0.762833833694458
Epoch: 11, Steps: 10 | Train Loss: 2.209 Vali Loss: 3.210 Vali Acc: 0.129 Test Loss: 3.210 Test Acc: 0.129
Validation loss decreased (-0.119968 --> -0.129380).  Saving model ...
Epoch: 12 cost time: 0.816514253616333
Epoch: 12, Steps: 10 | Train Loss: 2.090 Vali Loss: 3.202 Vali Acc: 0.145 Test Loss: 3.202 Test Acc: 0.145
Validation loss decreased (-0.129380 --> -0.144674).  Saving model ...
Epoch: 13 cost time: 0.8072793483734131
Epoch: 13, Steps: 10 | Train Loss: 1.930 Vali Loss: 3.194 Vali Acc: 0.149 Test Loss: 3.194 Test Acc: 0.149
Validation loss decreased (-0.144674 --> -0.149380).  Saving model ...
Epoch: 14 cost time: 0.6897075176239014
Epoch: 14, Steps: 10 | Train Loss: 1.771 Vali Loss: 3.185 Vali Acc: 0.156 Test Loss: 3.185 Test Acc: 0.156
Validation loss decreased (-0.149380 --> -0.156439).  Saving model ...
Epoch: 15 cost time: 0.7153477668762207
Epoch: 15, Steps: 10 | Train Loss: 1.666 Vali Loss: 3.186 Vali Acc: 0.168 Test Loss: 3.186 Test Acc: 0.168
Validation loss decreased (-0.156439 --> -0.168203).  Saving model ...
Epoch: 16 cost time: 0.7959961891174316
Epoch: 16, Steps: 10 | Train Loss: 1.505 Vali Loss: 3.186 Vali Acc: 0.179 Test Loss: 3.186 Test Acc: 0.179
Validation loss decreased (-0.168203 --> -0.178792).  Saving model ...
Epoch: 17 cost time: 0.8052513599395752
Epoch: 17, Steps: 10 | Train Loss: 1.371 Vali Loss: 3.186 Vali Acc: 0.188 Test Loss: 3.186 Test Acc: 0.188
Validation loss decreased (-0.178792 --> -0.188203).  Saving model ...
Epoch: 18 cost time: 0.7565348148345947
Epoch: 18, Steps: 10 | Train Loss: 1.214 Vali Loss: 3.188 Vali Acc: 0.205 Test Loss: 3.188 Test Acc: 0.205
Validation loss decreased (-0.188203 --> -0.204674).  Saving model ...
Epoch: 19 cost time: 0.8398952484130859
Epoch: 19, Steps: 10 | Train Loss: 1.087 Vali Loss: 3.196 Vali Acc: 0.208 Test Loss: 3.196 Test Acc: 0.208
Validation loss decreased (-0.204674 --> -0.208203).  Saving model ...
Epoch: 20 cost time: 0.922614336013794
Epoch: 20, Steps: 10 | Train Loss: 0.987 Vali Loss: 3.212 Vali Acc: 0.219 Test Loss: 3.212 Test Acc: 0.219
Validation loss decreased (-0.208203 --> -0.218791).  Saving model ...
Epoch: 21 cost time: 0.8761727809906006
Epoch: 21, Steps: 10 | Train Loss: 0.870 Vali Loss: 3.229 Vali Acc: 0.225 Test Loss: 3.229 Test Acc: 0.225
Validation loss decreased (-0.218791 --> -0.224674).  Saving model ...
Epoch: 22 cost time: 0.7602472305297852
Epoch: 22, Steps: 10 | Train Loss: 0.767 Vali Loss: 3.261 Vali Acc: 0.224 Test Loss: 3.261 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8009593486785889
Epoch: 23, Steps: 10 | Train Loss: 0.666 Vali Loss: 3.282 Vali Acc: 0.224 Test Loss: 3.282 Test Acc: 0.224
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.8599677085876465
Epoch: 24, Steps: 10 | Train Loss: 0.621 Vali Loss: 3.309 Vali Acc: 0.227 Test Loss: 3.309 Test Acc: 0.227
Validation loss decreased (-0.224674 --> -0.227026).  Saving model ...
Epoch: 25 cost time: 0.8174660205841064
Epoch: 25, Steps: 10 | Train Loss: 0.498 Vali Loss: 3.342 Vali Acc: 0.231 Test Loss: 3.342 Test Acc: 0.231
Validation loss decreased (-0.227026 --> -0.230555).  Saving model ...
Epoch: 26 cost time: 0.7512736320495605
Epoch: 26, Steps: 10 | Train Loss: 0.433 Vali Loss: 3.384 Vali Acc: 0.235 Test Loss: 3.384 Test Acc: 0.235
Validation loss decreased (-0.230555 --> -0.235260).  Saving model ...
Epoch: 27 cost time: 0.6633439064025879
Epoch: 27, Steps: 10 | Train Loss: 0.383 Vali Loss: 3.426 Vali Acc: 0.239 Test Loss: 3.426 Test Acc: 0.239
Validation loss decreased (-0.235260 --> -0.238789).  Saving model ...
Epoch: 28 cost time: 0.8447160720825195
Epoch: 28, Steps: 10 | Train Loss: 0.342 Vali Loss: 3.460 Vali Acc: 0.238 Test Loss: 3.460 Test Acc: 0.238
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6566047668457031
Epoch: 29, Steps: 10 | Train Loss: 0.278 Vali Loss: 3.509 Vali Acc: 0.232 Test Loss: 3.509 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.7446320056915283
Epoch: 30, Steps: 10 | Train Loss: 0.292 Vali Loss: 3.531 Vali Acc: 0.236 Test Loss: 3.531 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.8095180988311768
Epoch: 31, Steps: 10 | Train Loss: 0.207 Vali Loss: 3.578 Vali Acc: 0.240 Test Loss: 3.578 Test Acc: 0.240
Validation loss decreased (-0.238789 --> -0.239964).  Saving model ...
Epoch: 32 cost time: 0.6294171810150146
Epoch: 32, Steps: 10 | Train Loss: 0.201 Vali Loss: 3.619 Vali Acc: 0.239 Test Loss: 3.619 Test Acc: 0.239
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.670996904373169
Epoch: 33, Steps: 10 | Train Loss: 0.176 Vali Loss: 3.669 Vali Acc: 0.240 Test Loss: 3.669 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.8128719329833984
Epoch: 34, Steps: 10 | Train Loss: 0.157 Vali Loss: 3.717 Vali Acc: 0.241 Test Loss: 3.717 Test Acc: 0.241
Validation loss decreased (-0.239964 --> -0.241139).  Saving model ...
Epoch: 35 cost time: 0.7537147998809814
Epoch: 35, Steps: 10 | Train Loss: 0.156 Vali Loss: 3.747 Vali Acc: 0.247 Test Loss: 3.747 Test Acc: 0.247
Validation loss decreased (-0.241139 --> -0.247021).  Saving model ...
Epoch: 36 cost time: 0.7441415786743164
Epoch: 36, Steps: 10 | Train Loss: 0.129 Vali Loss: 3.798 Vali Acc: 0.242 Test Loss: 3.798 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.7101290225982666
Epoch: 37, Steps: 10 | Train Loss: 0.111 Vali Loss: 3.819 Vali Acc: 0.245 Test Loss: 3.819 Test Acc: 0.245
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.7578797340393066
Epoch: 38, Steps: 10 | Train Loss: 0.107 Vali Loss: 3.846 Vali Acc: 0.245 Test Loss: 3.846 Test Acc: 0.245
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.7583119869232178
Epoch: 39, Steps: 10 | Train Loss: 0.095 Vali Loss: 3.907 Vali Acc: 0.244 Test Loss: 3.907 Test Acc: 0.244
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.8415744304656982
Epoch: 40, Steps: 10 | Train Loss: 0.075 Vali Loss: 3.924 Vali Acc: 0.245 Test Loss: 3.924 Test Acc: 0.245
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.8227179050445557
Epoch: 41, Steps: 10 | Train Loss: 0.073 Vali Loss: 3.955 Vali Acc: 0.246 Test Loss: 3.955 Test Acc: 0.246
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.8677558898925781
Epoch: 42, Steps: 10 | Train Loss: 0.063 Vali Loss: 3.989 Vali Acc: 0.254 Test Loss: 3.989 Test Acc: 0.254
Validation loss decreased (-0.247021 --> -0.254078).  Saving model ...
Epoch: 43 cost time: 0.774461030960083
Epoch: 43, Steps: 10 | Train Loss: 0.059 Vali Loss: 4.037 Vali Acc: 0.254 Test Loss: 4.037 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.7734377384185791
Epoch: 44, Steps: 10 | Train Loss: 0.063 Vali Loss: 4.067 Vali Acc: 0.245 Test Loss: 4.067 Test Acc: 0.245
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.8464112281799316
Epoch: 45, Steps: 10 | Train Loss: 0.047 Vali Loss: 4.129 Vali Acc: 0.244 Test Loss: 4.129 Test Acc: 0.244
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.6899328231811523
Epoch: 46, Steps: 10 | Train Loss: 0.041 Vali Loss: 4.169 Vali Acc: 0.244 Test Loss: 4.169 Test Acc: 0.244
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.8409500122070312
Epoch: 47, Steps: 10 | Train Loss: 0.044 Vali Loss: 4.184 Vali Acc: 0.248 Test Loss: 4.184 Test Acc: 0.248
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.7895760536193848
Epoch: 48, Steps: 10 | Train Loss: 0.042 Vali Loss: 4.201 Vali Acc: 0.252 Test Loss: 4.201 Test Acc: 0.252
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.9636263847351074
Epoch: 49, Steps: 10 | Train Loss: 0.038 Vali Loss: 4.224 Vali Acc: 0.249 Test Loss: 4.224 Test Acc: 0.249
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.6343390941619873
Epoch: 50, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.279 Vali Acc: 0.249 Test Loss: 4.279 Test Acc: 0.249
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps23_str12_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2541176470588235
model parameter : 60826
model size : 0.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.0124013423919678
Epoch: 1, Steps: 10 | Train Loss: 3.354 Vali Loss: 3.300 Vali Acc: 0.041 Test Loss: 3.300 Test Acc: 0.041
Validation loss decreased (inf --> -0.041143).  Saving model ...
Epoch: 2 cost time: 0.8660662174224854
Epoch: 2, Steps: 10 | Train Loss: 3.334 Vali Loss: 3.310 Vali Acc: 0.039 Test Loss: 3.310 Test Acc: 0.039
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9060187339782715
Epoch: 3, Steps: 10 | Train Loss: 3.249 Vali Loss: 3.309 Vali Acc: 0.041 Test Loss: 3.309 Test Acc: 0.041
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9800019264221191
Epoch: 4, Steps: 10 | Train Loss: 3.158 Vali Loss: 3.300 Vali Acc: 0.046 Test Loss: 3.300 Test Acc: 0.046
Validation loss decreased (-0.041143 --> -0.045849).  Saving model ...
Epoch: 5 cost time: 0.892906665802002
Epoch: 5, Steps: 10 | Train Loss: 3.091 Vali Loss: 3.290 Vali Acc: 0.047 Test Loss: 3.290 Test Acc: 0.047
Validation loss decreased (-0.045849 --> -0.047026).  Saving model ...
Epoch: 6 cost time: 0.8943073749542236
Epoch: 6, Steps: 10 | Train Loss: 2.985 Vali Loss: 3.280 Vali Acc: 0.044 Test Loss: 3.280 Test Acc: 0.044
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.944474458694458
Epoch: 7, Steps: 10 | Train Loss: 2.894 Vali Loss: 3.270 Vali Acc: 0.061 Test Loss: 3.270 Test Acc: 0.061
Validation loss decreased (-0.047026 --> -0.061144).  Saving model ...
Epoch: 8 cost time: 0.8049936294555664
Epoch: 8, Steps: 10 | Train Loss: 2.773 Vali Loss: 3.262 Vali Acc: 0.074 Test Loss: 3.262 Test Acc: 0.074
Validation loss decreased (-0.061144 --> -0.074085).  Saving model ...
Epoch: 9 cost time: 1.0090069770812988
Epoch: 9, Steps: 10 | Train Loss: 2.660 Vali Loss: 3.252 Vali Acc: 0.085 Test Loss: 3.252 Test Acc: 0.085
Validation loss decreased (-0.074085 --> -0.084673).  Saving model ...
Epoch: 10 cost time: 0.8425037860870361
Epoch: 10, Steps: 10 | Train Loss: 2.573 Vali Loss: 3.243 Vali Acc: 0.094 Test Loss: 3.243 Test Acc: 0.094
Validation loss decreased (-0.084673 --> -0.094085).  Saving model ...
Epoch: 11 cost time: 0.7746210098266602
Epoch: 11, Steps: 10 | Train Loss: 2.430 Vali Loss: 3.235 Vali Acc: 0.104 Test Loss: 3.235 Test Acc: 0.104
Validation loss decreased (-0.094085 --> -0.103497).  Saving model ...
Epoch: 12 cost time: 1.0565390586853027
Epoch: 12, Steps: 10 | Train Loss: 2.342 Vali Loss: 3.226 Vali Acc: 0.113 Test Loss: 3.226 Test Acc: 0.113
Validation loss decreased (-0.103497 --> -0.112909).  Saving model ...
Epoch: 13 cost time: 0.8950984477996826
Epoch: 13, Steps: 10 | Train Loss: 2.232 Vali Loss: 3.215 Vali Acc: 0.131 Test Loss: 3.215 Test Acc: 0.131
Validation loss decreased (-0.112909 --> -0.130556).  Saving model ...
Epoch: 14 cost time: 0.8423688411712646
Epoch: 14, Steps: 10 | Train Loss: 2.076 Vali Loss: 3.206 Vali Acc: 0.132 Test Loss: 3.206 Test Acc: 0.132
Validation loss decreased (-0.130556 --> -0.131733).  Saving model ...
Epoch: 15 cost time: 0.8235788345336914
Epoch: 15, Steps: 10 | Train Loss: 2.007 Vali Loss: 3.199 Vali Acc: 0.149 Test Loss: 3.199 Test Acc: 0.149
Validation loss decreased (-0.131733 --> -0.149380).  Saving model ...
Epoch: 16 cost time: 1.0066072940826416
Epoch: 16, Steps: 10 | Train Loss: 1.845 Vali Loss: 3.192 Vali Acc: 0.159 Test Loss: 3.192 Test Acc: 0.159
Validation loss decreased (-0.149380 --> -0.158792).  Saving model ...
Epoch: 17 cost time: 0.7580299377441406
Epoch: 17, Steps: 10 | Train Loss: 1.760 Vali Loss: 3.184 Vali Acc: 0.165 Test Loss: 3.184 Test Acc: 0.165
Validation loss decreased (-0.158792 --> -0.164674).  Saving model ...
Epoch: 18 cost time: 0.8480725288391113
Epoch: 18, Steps: 10 | Train Loss: 1.597 Vali Loss: 3.178 Vali Acc: 0.176 Test Loss: 3.178 Test Acc: 0.176
Validation loss decreased (-0.164674 --> -0.176439).  Saving model ...
Epoch: 19 cost time: 0.9634528160095215
Epoch: 19, Steps: 10 | Train Loss: 1.485 Vali Loss: 3.182 Vali Acc: 0.188 Test Loss: 3.182 Test Acc: 0.188
Validation loss decreased (-0.176439 --> -0.188203).  Saving model ...
Epoch: 20 cost time: 0.8993744850158691
Epoch: 20, Steps: 10 | Train Loss: 1.369 Vali Loss: 3.184 Vali Acc: 0.196 Test Loss: 3.184 Test Acc: 0.196
Validation loss decreased (-0.188203 --> -0.196439).  Saving model ...
Epoch: 21 cost time: 0.8064885139465332
Epoch: 21, Steps: 10 | Train Loss: 1.260 Vali Loss: 3.187 Vali Acc: 0.198 Test Loss: 3.187 Test Acc: 0.198
Validation loss decreased (-0.196439 --> -0.197615).  Saving model ...
Epoch: 22 cost time: 1.212402582168579
Epoch: 22, Steps: 10 | Train Loss: 1.152 Vali Loss: 3.192 Vali Acc: 0.205 Test Loss: 3.192 Test Acc: 0.205
Validation loss decreased (-0.197615 --> -0.204674).  Saving model ...
Epoch: 23 cost time: 0.9713153839111328
Epoch: 23, Steps: 10 | Train Loss: 1.048 Vali Loss: 3.198 Vali Acc: 0.208 Test Loss: 3.198 Test Acc: 0.208
Validation loss decreased (-0.204674 --> -0.208203).  Saving model ...
Epoch: 24 cost time: 0.7733137607574463
Epoch: 24, Steps: 10 | Train Loss: 0.911 Vali Loss: 3.206 Vali Acc: 0.220 Test Loss: 3.206 Test Acc: 0.220
Validation loss decreased (-0.208203 --> -0.219968).  Saving model ...
Epoch: 25 cost time: 0.867588996887207
Epoch: 25, Steps: 10 | Train Loss: 0.845 Vali Loss: 3.221 Vali Acc: 0.229 Test Loss: 3.221 Test Acc: 0.229
Validation loss decreased (-0.219968 --> -0.229380).  Saving model ...
Epoch: 26 cost time: 1.0355570316314697
Epoch: 26, Steps: 10 | Train Loss: 0.750 Vali Loss: 3.239 Vali Acc: 0.233 Test Loss: 3.239 Test Acc: 0.233
Validation loss decreased (-0.229380 --> -0.232909).  Saving model ...
Epoch: 27 cost time: 1.0046260356903076
Epoch: 27, Steps: 10 | Train Loss: 0.659 Vali Loss: 3.257 Vali Acc: 0.231 Test Loss: 3.257 Test Acc: 0.231
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0106449127197266
Epoch: 28, Steps: 10 | Train Loss: 0.617 Vali Loss: 3.284 Vali Acc: 0.235 Test Loss: 3.284 Test Acc: 0.235
Validation loss decreased (-0.232909 --> -0.235261).  Saving model ...
Epoch: 29 cost time: 0.8709375858306885
Epoch: 29, Steps: 10 | Train Loss: 0.525 Vali Loss: 3.320 Vali Acc: 0.234 Test Loss: 3.320 Test Acc: 0.234
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.0443458557128906
Epoch: 30, Steps: 10 | Train Loss: 0.454 Vali Loss: 3.345 Vali Acc: 0.240 Test Loss: 3.345 Test Acc: 0.240
Validation loss decreased (-0.235261 --> -0.239967).  Saving model ...
Epoch: 31 cost time: 1.0427842140197754
Epoch: 31, Steps: 10 | Train Loss: 0.397 Vali Loss: 3.379 Vali Acc: 0.249 Test Loss: 3.379 Test Acc: 0.249
Validation loss decreased (-0.239967 --> -0.249378).  Saving model ...
Epoch: 32 cost time: 1.287792444229126
Epoch: 32, Steps: 10 | Train Loss: 0.355 Vali Loss: 3.402 Vali Acc: 0.246 Test Loss: 3.402 Test Acc: 0.246
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.0102958679199219
Epoch: 33, Steps: 10 | Train Loss: 0.323 Vali Loss: 3.454 Vali Acc: 0.247 Test Loss: 3.454 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.9235033988952637
Epoch: 34, Steps: 10 | Train Loss: 0.289 Vali Loss: 3.475 Vali Acc: 0.248 Test Loss: 3.475 Test Acc: 0.248
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.9382543563842773
Epoch: 35, Steps: 10 | Train Loss: 0.245 Vali Loss: 3.503 Vali Acc: 0.249 Test Loss: 3.503 Test Acc: 0.249
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.7148559093475342
Epoch: 36, Steps: 10 | Train Loss: 0.235 Vali Loss: 3.531 Vali Acc: 0.258 Test Loss: 3.531 Test Acc: 0.258
Validation loss decreased (-0.249378 --> -0.257612).  Saving model ...
Epoch: 37 cost time: 1.1898002624511719
Epoch: 37, Steps: 10 | Train Loss: 0.233 Vali Loss: 3.567 Vali Acc: 0.261 Test Loss: 3.567 Test Acc: 0.261
Validation loss decreased (-0.257612 --> -0.261141).  Saving model ...
Epoch: 38 cost time: 1.2032923698425293
Epoch: 38, Steps: 10 | Train Loss: 0.188 Vali Loss: 3.600 Vali Acc: 0.260 Test Loss: 3.600 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.0329227447509766
Epoch: 39, Steps: 10 | Train Loss: 0.171 Vali Loss: 3.643 Vali Acc: 0.261 Test Loss: 3.643 Test Acc: 0.261
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.20709228515625
Epoch: 40, Steps: 10 | Train Loss: 0.157 Vali Loss: 3.669 Vali Acc: 0.254 Test Loss: 3.669 Test Acc: 0.254
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.1793015003204346
Epoch: 41, Steps: 10 | Train Loss: 0.131 Vali Loss: 3.695 Vali Acc: 0.255 Test Loss: 3.695 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.9903676509857178
Epoch: 42, Steps: 10 | Train Loss: 0.128 Vali Loss: 3.734 Vali Acc: 0.259 Test Loss: 3.734 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.9641656875610352
Epoch: 43, Steps: 10 | Train Loss: 0.118 Vali Loss: 3.756 Vali Acc: 0.262 Test Loss: 3.756 Test Acc: 0.262
Validation loss decreased (-0.261141 --> -0.262315).  Saving model ...
Epoch: 44 cost time: 1.004244327545166
Epoch: 44, Steps: 10 | Train Loss: 0.102 Vali Loss: 3.807 Vali Acc: 0.264 Test Loss: 3.807 Test Acc: 0.264
Validation loss decreased (-0.262315 --> -0.263491).  Saving model ...
Epoch: 45 cost time: 1.2027227878570557
Epoch: 45, Steps: 10 | Train Loss: 0.097 Vali Loss: 3.830 Vali Acc: 0.269 Test Loss: 3.830 Test Acc: 0.269
Validation loss decreased (-0.263491 --> -0.269373).  Saving model ...
Epoch: 46 cost time: 1.005326509475708
Epoch: 46, Steps: 10 | Train Loss: 0.089 Vali Loss: 3.865 Vali Acc: 0.268 Test Loss: 3.865 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.1625990867614746
Epoch: 47, Steps: 10 | Train Loss: 0.080 Vali Loss: 3.881 Vali Acc: 0.260 Test Loss: 3.881 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.9916412830352783
Epoch: 48, Steps: 10 | Train Loss: 0.087 Vali Loss: 3.922 Vali Acc: 0.254 Test Loss: 3.922 Test Acc: 0.254
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.1620497703552246
Epoch: 49, Steps: 10 | Train Loss: 0.066 Vali Loss: 3.974 Vali Acc: 0.252 Test Loss: 3.974 Test Acc: 0.252
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 1.2106876373291016
Epoch: 50, Steps: 10 | Train Loss: 0.060 Vali Loss: 4.003 Vali Acc: 0.261 Test Loss: 4.003 Test Acc: 0.261
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26941176470588235
model parameter : 53594
model size : 0.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps38_str19_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.1958322525024414
Epoch: 1, Steps: 10 | Train Loss: 3.282 Vali Loss: 3.291 Vali Acc: 0.039 Test Loss: 3.291 Test Acc: 0.039
Validation loss decreased (inf --> -0.038791).  Saving model ...
Epoch: 2 cost time: 1.0939433574676514
Epoch: 2, Steps: 10 | Train Loss: 3.227 Vali Loss: 3.301 Vali Acc: 0.036 Test Loss: 3.301 Test Acc: 0.036
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0903353691101074
Epoch: 3, Steps: 10 | Train Loss: 3.179 Vali Loss: 3.301 Vali Acc: 0.041 Test Loss: 3.301 Test Acc: 0.041
Validation loss decreased (-0.038791 --> -0.041143).  Saving model ...
Epoch: 4 cost time: 1.3540890216827393
Epoch: 4, Steps: 10 | Train Loss: 3.102 Vali Loss: 3.295 Vali Acc: 0.042 Test Loss: 3.295 Test Acc: 0.042
Validation loss decreased (-0.041143 --> -0.042320).  Saving model ...
Epoch: 5 cost time: 1.0755078792572021
Epoch: 5, Steps: 10 | Train Loss: 3.056 Vali Loss: 3.287 Vali Acc: 0.045 Test Loss: 3.287 Test Acc: 0.045
Validation loss decreased (-0.042320 --> -0.044673).  Saving model ...
Epoch: 6 cost time: 0.9802160263061523
Epoch: 6, Steps: 10 | Train Loss: 2.975 Vali Loss: 3.276 Vali Acc: 0.051 Test Loss: 3.276 Test Acc: 0.051
Validation loss decreased (-0.044673 --> -0.050555).  Saving model ...
Epoch: 7 cost time: 0.9256267547607422
Epoch: 7, Steps: 10 | Train Loss: 2.859 Vali Loss: 3.267 Vali Acc: 0.058 Test Loss: 3.267 Test Acc: 0.058
Validation loss decreased (-0.050555 --> -0.057614).  Saving model ...
Epoch: 8 cost time: 1.1644983291625977
Epoch: 8, Steps: 10 | Train Loss: 2.785 Vali Loss: 3.260 Vali Acc: 0.074 Test Loss: 3.260 Test Acc: 0.074
Validation loss decreased (-0.057614 --> -0.074085).  Saving model ...
Epoch: 9 cost time: 1.0145373344421387
Epoch: 9, Steps: 10 | Train Loss: 2.681 Vali Loss: 3.251 Vali Acc: 0.091 Test Loss: 3.251 Test Acc: 0.091
Validation loss decreased (-0.074085 --> -0.090556).  Saving model ...
Epoch: 10 cost time: 1.121610403060913
Epoch: 10, Steps: 10 | Train Loss: 2.581 Vali Loss: 3.244 Vali Acc: 0.095 Test Loss: 3.244 Test Acc: 0.095
Validation loss decreased (-0.090556 --> -0.095262).  Saving model ...
Epoch: 11 cost time: 1.003465175628662
Epoch: 11, Steps: 10 | Train Loss: 2.490 Vali Loss: 3.237 Vali Acc: 0.104 Test Loss: 3.237 Test Acc: 0.104
Validation loss decreased (-0.095262 --> -0.103497).  Saving model ...
Epoch: 12 cost time: 0.9700210094451904
Epoch: 12, Steps: 10 | Train Loss: 2.371 Vali Loss: 3.230 Vali Acc: 0.111 Test Loss: 3.230 Test Acc: 0.111
Validation loss decreased (-0.103497 --> -0.110556).  Saving model ...
Epoch: 13 cost time: 1.0424156188964844
Epoch: 13, Steps: 10 | Train Loss: 2.243 Vali Loss: 3.223 Vali Acc: 0.119 Test Loss: 3.223 Test Acc: 0.119
Validation loss decreased (-0.110556 --> -0.118791).  Saving model ...
Epoch: 14 cost time: 0.857438325881958
Epoch: 14, Steps: 10 | Train Loss: 2.146 Vali Loss: 3.216 Vali Acc: 0.125 Test Loss: 3.216 Test Acc: 0.125
Validation loss decreased (-0.118791 --> -0.124674).  Saving model ...
Epoch: 15 cost time: 1.0359218120574951
Epoch: 15, Steps: 10 | Train Loss: 2.040 Vali Loss: 3.212 Vali Acc: 0.131 Test Loss: 3.212 Test Acc: 0.131
Validation loss decreased (-0.124674 --> -0.130556).  Saving model ...
Epoch: 16 cost time: 0.7315194606781006
Epoch: 16, Steps: 10 | Train Loss: 1.946 Vali Loss: 3.207 Vali Acc: 0.138 Test Loss: 3.207 Test Acc: 0.138
Validation loss decreased (-0.130556 --> -0.137615).  Saving model ...
Epoch: 17 cost time: 0.89990234375
Epoch: 17, Steps: 10 | Train Loss: 1.804 Vali Loss: 3.204 Vali Acc: 0.144 Test Loss: 3.204 Test Acc: 0.144
Validation loss decreased (-0.137615 --> -0.143497).  Saving model ...
Epoch: 18 cost time: 1.1585478782653809
Epoch: 18, Steps: 10 | Train Loss: 1.713 Vali Loss: 3.195 Vali Acc: 0.158 Test Loss: 3.195 Test Acc: 0.158
Validation loss decreased (-0.143497 --> -0.157615).  Saving model ...
Epoch: 19 cost time: 1.1505846977233887
Epoch: 19, Steps: 10 | Train Loss: 1.593 Vali Loss: 3.192 Vali Acc: 0.169 Test Loss: 3.192 Test Acc: 0.169
Validation loss decreased (-0.157615 --> -0.169380).  Saving model ...
Epoch: 20 cost time: 1.0371744632720947
Epoch: 20, Steps: 10 | Train Loss: 1.478 Vali Loss: 3.192 Vali Acc: 0.175 Test Loss: 3.192 Test Acc: 0.175
Validation loss decreased (-0.169380 --> -0.175262).  Saving model ...
Epoch: 21 cost time: 0.9760890007019043
Epoch: 21, Steps: 10 | Train Loss: 1.396 Vali Loss: 3.194 Vali Acc: 0.182 Test Loss: 3.194 Test Acc: 0.182
Validation loss decreased (-0.175262 --> -0.182321).  Saving model ...
Epoch: 22 cost time: 0.8867034912109375
Epoch: 22, Steps: 10 | Train Loss: 1.286 Vali Loss: 3.193 Vali Acc: 0.185 Test Loss: 3.193 Test Acc: 0.185
Validation loss decreased (-0.182321 --> -0.184674).  Saving model ...
Epoch: 23 cost time: 0.9609394073486328
Epoch: 23, Steps: 10 | Train Loss: 1.158 Vali Loss: 3.203 Vali Acc: 0.188 Test Loss: 3.203 Test Acc: 0.188
Validation loss decreased (-0.184674 --> -0.188203).  Saving model ...
Epoch: 24 cost time: 0.9557592868804932
Epoch: 24, Steps: 10 | Train Loss: 1.025 Vali Loss: 3.207 Vali Acc: 0.198 Test Loss: 3.207 Test Acc: 0.198
Validation loss decreased (-0.188203 --> -0.197615).  Saving model ...
Epoch: 25 cost time: 1.071192741394043
Epoch: 25, Steps: 10 | Train Loss: 0.953 Vali Loss: 3.211 Vali Acc: 0.208 Test Loss: 3.211 Test Acc: 0.208
Validation loss decreased (-0.197615 --> -0.208203).  Saving model ...
Epoch: 26 cost time: 1.0336148738861084
Epoch: 26, Steps: 10 | Train Loss: 0.885 Vali Loss: 3.220 Vali Acc: 0.209 Test Loss: 3.220 Test Acc: 0.209
Validation loss decreased (-0.208203 --> -0.209380).  Saving model ...
Epoch: 27 cost time: 1.0865657329559326
Epoch: 27, Steps: 10 | Train Loss: 0.770 Vali Loss: 3.235 Vali Acc: 0.214 Test Loss: 3.235 Test Acc: 0.214
Validation loss decreased (-0.209380 --> -0.214085).  Saving model ...
Epoch: 28 cost time: 0.851874589920044
Epoch: 28, Steps: 10 | Train Loss: 0.694 Vali Loss: 3.250 Vali Acc: 0.213 Test Loss: 3.250 Test Acc: 0.213
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.0955369472503662
Epoch: 29, Steps: 10 | Train Loss: 0.627 Vali Loss: 3.281 Vali Acc: 0.216 Test Loss: 3.281 Test Acc: 0.216
Validation loss decreased (-0.214085 --> -0.216438).  Saving model ...
Epoch: 30 cost time: 0.9077205657958984
Epoch: 30, Steps: 10 | Train Loss: 0.553 Vali Loss: 3.303 Vali Acc: 0.219 Test Loss: 3.303 Test Acc: 0.219
Validation loss decreased (-0.216438 --> -0.218790).  Saving model ...
Epoch: 31 cost time: 1.2300009727478027
Epoch: 31, Steps: 10 | Train Loss: 0.518 Vali Loss: 3.325 Vali Acc: 0.224 Test Loss: 3.325 Test Acc: 0.224
Validation loss decreased (-0.218790 --> -0.223496).  Saving model ...
Epoch: 32 cost time: 1.0248308181762695
Epoch: 32, Steps: 10 | Train Loss: 0.430 Vali Loss: 3.371 Vali Acc: 0.227 Test Loss: 3.371 Test Acc: 0.227
Validation loss decreased (-0.223496 --> -0.227025).  Saving model ...
Epoch: 33 cost time: 1.1009466648101807
Epoch: 33, Steps: 10 | Train Loss: 0.365 Vali Loss: 3.395 Vali Acc: 0.229 Test Loss: 3.395 Test Acc: 0.229
Validation loss decreased (-0.227025 --> -0.229378).  Saving model ...
Epoch: 34 cost time: 1.2950880527496338
Epoch: 34, Steps: 10 | Train Loss: 0.342 Vali Loss: 3.427 Vali Acc: 0.233 Test Loss: 3.427 Test Acc: 0.233
Validation loss decreased (-0.229378 --> -0.232907).  Saving model ...
Epoch: 35 cost time: 1.446387767791748
Epoch: 35, Steps: 10 | Train Loss: 0.318 Vali Loss: 3.455 Vali Acc: 0.234 Test Loss: 3.455 Test Acc: 0.234
Validation loss decreased (-0.232907 --> -0.234083).  Saving model ...
Epoch: 36 cost time: 1.4126851558685303
Epoch: 36, Steps: 10 | Train Loss: 0.261 Vali Loss: 3.491 Vali Acc: 0.236 Test Loss: 3.491 Test Acc: 0.236
Validation loss decreased (-0.234083 --> -0.236436).  Saving model ...
Epoch: 37 cost time: 1.1764121055603027
Epoch: 37, Steps: 10 | Train Loss: 0.236 Vali Loss: 3.519 Vali Acc: 0.239 Test Loss: 3.519 Test Acc: 0.239
Validation loss decreased (-0.236436 --> -0.238788).  Saving model ...
Epoch: 38 cost time: 1.4194016456604004
Epoch: 38, Steps: 10 | Train Loss: 0.223 Vali Loss: 3.533 Vali Acc: 0.234 Test Loss: 3.533 Test Acc: 0.234
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.3752834796905518
Epoch: 39, Steps: 10 | Train Loss: 0.188 Vali Loss: 3.566 Vali Acc: 0.229 Test Loss: 3.566 Test Acc: 0.229
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.2191946506500244
Epoch: 40, Steps: 10 | Train Loss: 0.170 Vali Loss: 3.617 Vali Acc: 0.232 Test Loss: 3.617 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.3339605331420898
Epoch: 41, Steps: 10 | Train Loss: 0.154 Vali Loss: 3.674 Vali Acc: 0.226 Test Loss: 3.674 Test Acc: 0.226
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.0973360538482666
Epoch: 42, Steps: 10 | Train Loss: 0.128 Vali Loss: 3.666 Vali Acc: 0.229 Test Loss: 3.666 Test Acc: 0.229
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.2587015628814697
Epoch: 43, Steps: 10 | Train Loss: 0.130 Vali Loss: 3.684 Vali Acc: 0.235 Test Loss: 3.684 Test Acc: 0.235
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.3889269828796387
Epoch: 44, Steps: 10 | Train Loss: 0.105 Vali Loss: 3.750 Vali Acc: 0.244 Test Loss: 3.750 Test Acc: 0.244
Validation loss decreased (-0.238788 --> -0.243492).  Saving model ...
Epoch: 45 cost time: 1.521430253982544
Epoch: 45, Steps: 10 | Train Loss: 0.102 Vali Loss: 3.773 Vali Acc: 0.240 Test Loss: 3.773 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.2210981845855713
Epoch: 46, Steps: 10 | Train Loss: 0.095 Vali Loss: 3.795 Vali Acc: 0.238 Test Loss: 3.795 Test Acc: 0.238
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.1283950805664062
Epoch: 47, Steps: 10 | Train Loss: 0.081 Vali Loss: 3.830 Vali Acc: 0.241 Test Loss: 3.830 Test Acc: 0.241
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.0880067348480225
Epoch: 48, Steps: 10 | Train Loss: 0.068 Vali Loss: 3.865 Vali Acc: 0.234 Test Loss: 3.865 Test Acc: 0.234
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 1.127229928970337
Epoch: 49, Steps: 10 | Train Loss: 0.066 Vali Loss: 3.908 Vali Acc: 0.233 Test Loss: 3.908 Test Acc: 0.233
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 1.1908278465270996
Epoch: 50, Steps: 10 | Train Loss: 0.065 Vali Loss: 3.931 Vali Acc: 0.240 Test Loss: 3.931 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps38_str19_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.24352941176470588
model parameter : 51322
model size : 0.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.8058454990386963
Epoch: 1, Steps: 10 | Train Loss: 3.251 Vali Loss: 3.259 Vali Acc: 0.038 Test Loss: 3.259 Test Acc: 0.038
Validation loss decreased (inf --> -0.037614).  Saving model ...
Epoch: 2 cost time: 1.1083173751831055
Epoch: 2, Steps: 10 | Train Loss: 3.119 Vali Loss: 3.250 Vali Acc: 0.065 Test Loss: 3.250 Test Acc: 0.065
Validation loss decreased (-0.037614 --> -0.064673).  Saving model ...
Epoch: 3 cost time: 1.1269550323486328
Epoch: 3, Steps: 10 | Train Loss: 2.938 Vali Loss: 3.252 Vali Acc: 0.078 Test Loss: 3.252 Test Acc: 0.078
Validation loss decreased (-0.064673 --> -0.077615).  Saving model ...
Epoch: 4 cost time: 1.3526725769042969
Epoch: 4, Steps: 10 | Train Loss: 2.697 Vali Loss: 3.246 Vali Acc: 0.100 Test Loss: 3.246 Test Acc: 0.100
Validation loss decreased (-0.077615 --> -0.099968).  Saving model ...
Epoch: 5 cost time: 1.1603026390075684
Epoch: 5, Steps: 10 | Train Loss: 2.430 Vali Loss: 3.223 Vali Acc: 0.125 Test Loss: 3.223 Test Acc: 0.125
Validation loss decreased (-0.099968 --> -0.124674).  Saving model ...
Epoch: 6 cost time: 1.0743544101715088
Epoch: 6, Steps: 10 | Train Loss: 2.105 Vali Loss: 3.182 Vali Acc: 0.141 Test Loss: 3.182 Test Acc: 0.141
Validation loss decreased (-0.124674 --> -0.141145).  Saving model ...
Epoch: 7 cost time: 1.1258416175842285
Epoch: 7, Steps: 10 | Train Loss: 1.751 Vali Loss: 3.183 Vali Acc: 0.162 Test Loss: 3.183 Test Acc: 0.162
Validation loss decreased (-0.141145 --> -0.162321).  Saving model ...
Epoch: 8 cost time: 1.0929780006408691
Epoch: 8, Steps: 10 | Train Loss: 1.302 Vali Loss: 3.207 Vali Acc: 0.189 Test Loss: 3.207 Test Acc: 0.189
Validation loss decreased (-0.162321 --> -0.189380).  Saving model ...
Epoch: 9 cost time: 1.0886085033416748
Epoch: 9, Steps: 10 | Train Loss: 0.948 Vali Loss: 3.297 Vali Acc: 0.204 Test Loss: 3.297 Test Acc: 0.204
Validation loss decreased (-0.189380 --> -0.203496).  Saving model ...
Epoch: 10 cost time: 1.4274556636810303
Epoch: 10, Steps: 10 | Train Loss: 0.600 Vali Loss: 3.422 Vali Acc: 0.226 Test Loss: 3.422 Test Acc: 0.226
Validation loss decreased (-0.203496 --> -0.225848).  Saving model ...
Epoch: 11 cost time: 1.5712032318115234
Epoch: 11, Steps: 10 | Train Loss: 0.370 Vali Loss: 3.560 Vali Acc: 0.235 Test Loss: 3.560 Test Acc: 0.235
Validation loss decreased (-0.225848 --> -0.235259).  Saving model ...
Epoch: 12 cost time: 1.243128776550293
Epoch: 12, Steps: 10 | Train Loss: 0.211 Vali Loss: 3.752 Vali Acc: 0.253 Test Loss: 3.752 Test Acc: 0.253
Validation loss decreased (-0.235259 --> -0.252904).  Saving model ...
Epoch: 13 cost time: 1.4084765911102295
Epoch: 13, Steps: 10 | Train Loss: 0.107 Vali Loss: 3.973 Vali Acc: 0.248 Test Loss: 3.973 Test Acc: 0.248
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6000590324401855
Epoch: 14, Steps: 10 | Train Loss: 0.068 Vali Loss: 4.080 Vali Acc: 0.247 Test Loss: 4.080 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.3781216144561768
Epoch: 15, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.168 Vali Acc: 0.262 Test Loss: 4.168 Test Acc: 0.262
Validation loss decreased (-0.252904 --> -0.262311).  Saving model ...
Epoch: 16 cost time: 1.374992847442627
Epoch: 16, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.260 Vali Acc: 0.255 Test Loss: 4.260 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4649436473846436
Epoch: 17, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.328 Vali Acc: 0.260 Test Loss: 4.328 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3727762699127197
Epoch: 18, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.409 Vali Acc: 0.258 Test Loss: 4.409 Test Acc: 0.258
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.5113766193389893
Epoch: 19, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.453 Vali Acc: 0.262 Test Loss: 4.453 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.3936500549316406
Epoch: 20, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.481 Vali Acc: 0.265 Test Loss: 4.481 Test Acc: 0.265
Validation loss decreased (-0.262311 --> -0.264661).  Saving model ...
Epoch: 21 cost time: 1.255791425704956
Epoch: 21, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.523 Vali Acc: 0.262 Test Loss: 4.523 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2765817642211914
Epoch: 22, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.562 Vali Acc: 0.262 Test Loss: 4.562 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.4913506507873535
Epoch: 23, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.604 Vali Acc: 0.259 Test Loss: 4.604 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.5375783443450928
Epoch: 24, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.636 Vali Acc: 0.260 Test Loss: 4.636 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.484248161315918
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.676 Vali Acc: 0.259 Test Loss: 4.676 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.4547491073608398
Epoch: 26, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.708 Vali Acc: 0.261 Test Loss: 4.708 Test Acc: 0.261
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.4467246532440186
Epoch: 27, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.746 Vali Acc: 0.260 Test Loss: 4.746 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.2258570194244385
Epoch: 28, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.780 Vali Acc: 0.262 Test Loss: 4.780 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.5435144901275635
Epoch: 29, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.805 Vali Acc: 0.261 Test Loss: 4.805 Test Acc: 0.261
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.2833549976348877
Epoch: 30, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.831 Vali Acc: 0.259 Test Loss: 4.831 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2647058823529412
model parameter : 496186
model size : 1.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.882901906967163
Epoch: 1, Steps: 10 | Train Loss: 3.259 Vali Loss: 3.263 Vali Acc: 0.048 Test Loss: 3.263 Test Acc: 0.048
Validation loss decreased (inf --> -0.048203).  Saving model ...
Epoch: 2 cost time: 1.1410553455352783
Epoch: 2, Steps: 10 | Train Loss: 3.185 Vali Loss: 3.257 Vali Acc: 0.056 Test Loss: 3.257 Test Acc: 0.056
Validation loss decreased (-0.048203 --> -0.056438).  Saving model ...
Epoch: 3 cost time: 1.2481179237365723
Epoch: 3, Steps: 10 | Train Loss: 3.052 Vali Loss: 3.254 Vali Acc: 0.062 Test Loss: 3.254 Test Acc: 0.062
Validation loss decreased (-0.056438 --> -0.062320).  Saving model ...
Epoch: 4 cost time: 1.2647647857666016
Epoch: 4, Steps: 10 | Train Loss: 2.895 Vali Loss: 3.255 Vali Acc: 0.085 Test Loss: 3.255 Test Acc: 0.085
Validation loss decreased (-0.062320 --> -0.084673).  Saving model ...
Epoch: 5 cost time: 1.6719951629638672
Epoch: 5, Steps: 10 | Train Loss: 2.756 Vali Loss: 3.258 Vali Acc: 0.107 Test Loss: 3.258 Test Acc: 0.107
Validation loss decreased (-0.084673 --> -0.107026).  Saving model ...
Epoch: 6 cost time: 1.250814437866211
Epoch: 6, Steps: 10 | Train Loss: 2.571 Vali Loss: 3.244 Vali Acc: 0.115 Test Loss: 3.244 Test Acc: 0.115
Validation loss decreased (-0.107026 --> -0.115262).  Saving model ...
Epoch: 7 cost time: 1.3583016395568848
Epoch: 7, Steps: 10 | Train Loss: 2.370 Vali Loss: 3.222 Vali Acc: 0.127 Test Loss: 3.222 Test Acc: 0.127
Validation loss decreased (-0.115262 --> -0.127027).  Saving model ...
Epoch: 8 cost time: 1.2509386539459229
Epoch: 8, Steps: 10 | Train Loss: 2.135 Vali Loss: 3.194 Vali Acc: 0.145 Test Loss: 3.194 Test Acc: 0.145
Validation loss decreased (-0.127027 --> -0.144674).  Saving model ...
Epoch: 9 cost time: 1.4796357154846191
Epoch: 9, Steps: 10 | Train Loss: 1.861 Vali Loss: 3.183 Vali Acc: 0.161 Test Loss: 3.183 Test Acc: 0.161
Validation loss decreased (-0.144674 --> -0.161145).  Saving model ...
Epoch: 10 cost time: 1.4942729473114014
Epoch: 10, Steps: 10 | Train Loss: 1.564 Vali Loss: 3.178 Vali Acc: 0.173 Test Loss: 3.178 Test Acc: 0.173
Validation loss decreased (-0.161145 --> -0.172909).  Saving model ...
Epoch: 11 cost time: 1.2326979637145996
Epoch: 11, Steps: 10 | Train Loss: 1.269 Vali Loss: 3.222 Vali Acc: 0.186 Test Loss: 3.222 Test Acc: 0.186
Validation loss decreased (-0.172909 --> -0.185850).  Saving model ...
Epoch: 12 cost time: 1.167250633239746
Epoch: 12, Steps: 10 | Train Loss: 0.985 Vali Loss: 3.258 Vali Acc: 0.206 Test Loss: 3.258 Test Acc: 0.206
Validation loss decreased (-0.185850 --> -0.205850).  Saving model ...
Epoch: 13 cost time: 1.2673406600952148
Epoch: 13, Steps: 10 | Train Loss: 0.758 Vali Loss: 3.336 Vali Acc: 0.219 Test Loss: 3.336 Test Acc: 0.219
Validation loss decreased (-0.205850 --> -0.218790).  Saving model ...
Epoch: 14 cost time: 1.3278930187225342
Epoch: 14, Steps: 10 | Train Loss: 0.561 Vali Loss: 3.424 Vali Acc: 0.233 Test Loss: 3.424 Test Acc: 0.233
Validation loss decreased (-0.218790 --> -0.232907).  Saving model ...
Epoch: 15 cost time: 1.3048608303070068
Epoch: 15, Steps: 10 | Train Loss: 0.392 Vali Loss: 3.513 Vali Acc: 0.240 Test Loss: 3.513 Test Acc: 0.240
Validation loss decreased (-0.232907 --> -0.239965).  Saving model ...
Epoch: 16 cost time: 1.5817031860351562
Epoch: 16, Steps: 10 | Train Loss: 0.271 Vali Loss: 3.635 Vali Acc: 0.253 Test Loss: 3.635 Test Acc: 0.253
Validation loss decreased (-0.239965 --> -0.252905).  Saving model ...
Epoch: 17 cost time: 1.3561065196990967
Epoch: 17, Steps: 10 | Train Loss: 0.185 Vali Loss: 3.753 Vali Acc: 0.249 Test Loss: 3.753 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2626988887786865
Epoch: 18, Steps: 10 | Train Loss: 0.128 Vali Loss: 3.874 Vali Acc: 0.247 Test Loss: 3.874 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.289309024810791
Epoch: 19, Steps: 10 | Train Loss: 0.090 Vali Loss: 3.975 Vali Acc: 0.251 Test Loss: 3.975 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.271935224533081
Epoch: 20, Steps: 10 | Train Loss: 0.064 Vali Loss: 4.023 Vali Acc: 0.255 Test Loss: 4.023 Test Acc: 0.255
Validation loss decreased (-0.252905 --> -0.255254).  Saving model ...
Epoch: 21 cost time: 1.3525872230529785
Epoch: 21, Steps: 10 | Train Loss: 0.049 Vali Loss: 4.098 Vali Acc: 0.260 Test Loss: 4.098 Test Acc: 0.260
Validation loss decreased (-0.255254 --> -0.259959).  Saving model ...
Epoch: 22 cost time: 1.4816563129425049
Epoch: 22, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.193 Vali Acc: 0.256 Test Loss: 4.193 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.3536791801452637
Epoch: 23, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.216 Vali Acc: 0.261 Test Loss: 4.216 Test Acc: 0.261
Validation loss decreased (-0.259959 --> -0.261134).  Saving model ...
Epoch: 24 cost time: 1.2006855010986328
Epoch: 24, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.241 Vali Acc: 0.266 Test Loss: 4.241 Test Acc: 0.266
Validation loss decreased (-0.261134 --> -0.265840).  Saving model ...
Epoch: 25 cost time: 1.037440299987793
Epoch: 25, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.287 Vali Acc: 0.269 Test Loss: 4.287 Test Acc: 0.269
Validation loss decreased (-0.265840 --> -0.269369).  Saving model ...
Epoch: 26 cost time: 1.0614805221557617
Epoch: 26, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.328 Vali Acc: 0.274 Test Loss: 4.328 Test Acc: 0.274
Validation loss decreased (-0.269369 --> -0.274074).  Saving model ...
Epoch: 27 cost time: 1.5054748058319092
Epoch: 27, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.374 Vali Acc: 0.267 Test Loss: 4.374 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.2712509632110596
Epoch: 28, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.399 Vali Acc: 0.267 Test Loss: 4.399 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.1214148998260498
Epoch: 29, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.437 Vali Acc: 0.271 Test Loss: 4.437 Test Acc: 0.271
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.1755585670471191
Epoch: 30, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.466 Vali Acc: 0.273 Test Loss: 4.466 Test Acc: 0.273
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.2355272769927979
Epoch: 31, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.492 Vali Acc: 0.272 Test Loss: 4.492 Test Acc: 0.272
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.1514172554016113
Epoch: 32, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.527 Vali Acc: 0.273 Test Loss: 4.527 Test Acc: 0.273
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.3738486766815186
Epoch: 33, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.563 Vali Acc: 0.272 Test Loss: 4.563 Test Acc: 0.272
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.2976539134979248
Epoch: 34, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.593 Vali Acc: 0.274 Test Loss: 4.593 Test Acc: 0.274
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.6857383251190186
Epoch: 35, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.624 Vali Acc: 0.274 Test Loss: 4.624 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.2127857208251953
Epoch: 36, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.643 Vali Acc: 0.271 Test Loss: 4.643 Test Acc: 0.271
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2741176470588235
model parameter : 406458
model size : 1.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps12_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.3192832469940186
Epoch: 1, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.269 Vali Acc: 0.046 Test Loss: 3.269 Test Acc: 0.046
Validation loss decreased (inf --> -0.045850).  Saving model ...
Epoch: 2 cost time: 1.3688619136810303
Epoch: 2, Steps: 10 | Train Loss: 3.187 Vali Loss: 3.267 Vali Acc: 0.049 Test Loss: 3.267 Test Acc: 0.049
Validation loss decreased (-0.045850 --> -0.049379).  Saving model ...
Epoch: 3 cost time: 1.4044842720031738
Epoch: 3, Steps: 10 | Train Loss: 3.095 Vali Loss: 3.266 Vali Acc: 0.046 Test Loss: 3.266 Test Acc: 0.046
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4167404174804688
Epoch: 4, Steps: 10 | Train Loss: 3.007 Vali Loss: 3.268 Vali Acc: 0.051 Test Loss: 3.268 Test Acc: 0.051
Validation loss decreased (-0.049379 --> -0.050556).  Saving model ...
Epoch: 5 cost time: 1.1283795833587646
Epoch: 5, Steps: 10 | Train Loss: 2.872 Vali Loss: 3.264 Vali Acc: 0.076 Test Loss: 3.264 Test Acc: 0.076
Validation loss decreased (-0.050556 --> -0.076438).  Saving model ...
Epoch: 6 cost time: 1.2105214595794678
Epoch: 6, Steps: 10 | Train Loss: 2.711 Vali Loss: 3.253 Vali Acc: 0.075 Test Loss: 3.253 Test Acc: 0.075
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.557685136795044
Epoch: 7, Steps: 10 | Train Loss: 2.592 Vali Loss: 3.249 Vali Acc: 0.087 Test Loss: 3.249 Test Acc: 0.087
Validation loss decreased (-0.076438 --> -0.087026).  Saving model ...
Epoch: 8 cost time: 1.6304841041564941
Epoch: 8, Steps: 10 | Train Loss: 2.401 Vali Loss: 3.228 Vali Acc: 0.098 Test Loss: 3.228 Test Acc: 0.098
Validation loss decreased (-0.087026 --> -0.097615).  Saving model ...
Epoch: 9 cost time: 1.3024652004241943
Epoch: 9, Steps: 10 | Train Loss: 2.196 Vali Loss: 3.204 Vali Acc: 0.116 Test Loss: 3.204 Test Acc: 0.116
Validation loss decreased (-0.097615 --> -0.116439).  Saving model ...
Epoch: 10 cost time: 1.0877108573913574
Epoch: 10, Steps: 10 | Train Loss: 2.011 Vali Loss: 3.187 Vali Acc: 0.135 Test Loss: 3.187 Test Acc: 0.135
Validation loss decreased (-0.116439 --> -0.135262).  Saving model ...
Epoch: 11 cost time: 1.7319543361663818
Epoch: 11, Steps: 10 | Train Loss: 1.770 Vali Loss: 3.176 Vali Acc: 0.158 Test Loss: 3.176 Test Acc: 0.158
Validation loss decreased (-0.135262 --> -0.157615).  Saving model ...
Epoch: 12 cost time: 1.5316424369812012
Epoch: 12, Steps: 10 | Train Loss: 1.488 Vali Loss: 3.180 Vali Acc: 0.171 Test Loss: 3.180 Test Acc: 0.171
Validation loss decreased (-0.157615 --> -0.170556).  Saving model ...
Epoch: 13 cost time: 1.4791369438171387
Epoch: 13, Steps: 10 | Train Loss: 1.254 Vali Loss: 3.194 Vali Acc: 0.176 Test Loss: 3.194 Test Acc: 0.176
Validation loss decreased (-0.170556 --> -0.176439).  Saving model ...
Epoch: 14 cost time: 1.2680227756500244
Epoch: 14, Steps: 10 | Train Loss: 1.059 Vali Loss: 3.228 Vali Acc: 0.187 Test Loss: 3.228 Test Acc: 0.187
Validation loss decreased (-0.176439 --> -0.187027).  Saving model ...
Epoch: 15 cost time: 1.2935843467712402
Epoch: 15, Steps: 10 | Train Loss: 0.810 Vali Loss: 3.280 Vali Acc: 0.196 Test Loss: 3.280 Test Acc: 0.196
Validation loss decreased (-0.187027 --> -0.196438).  Saving model ...
Epoch: 16 cost time: 1.406355857849121
Epoch: 16, Steps: 10 | Train Loss: 0.620 Vali Loss: 3.347 Vali Acc: 0.208 Test Loss: 3.347 Test Acc: 0.208
Validation loss decreased (-0.196438 --> -0.208202).  Saving model ...
Epoch: 17 cost time: 1.500809669494629
Epoch: 17, Steps: 10 | Train Loss: 0.464 Vali Loss: 3.413 Vali Acc: 0.220 Test Loss: 3.413 Test Acc: 0.220
Validation loss decreased (-0.208202 --> -0.219966).  Saving model ...
Epoch: 18 cost time: 1.5682096481323242
Epoch: 18, Steps: 10 | Train Loss: 0.347 Vali Loss: 3.501 Vali Acc: 0.221 Test Loss: 3.501 Test Acc: 0.221
Validation loss decreased (-0.219966 --> -0.221141).  Saving model ...
Epoch: 19 cost time: 1.3287856578826904
Epoch: 19, Steps: 10 | Train Loss: 0.241 Vali Loss: 3.572 Vali Acc: 0.222 Test Loss: 3.572 Test Acc: 0.222
Validation loss decreased (-0.221141 --> -0.222317).  Saving model ...
Epoch: 20 cost time: 1.5637516975402832
Epoch: 20, Steps: 10 | Train Loss: 0.185 Vali Loss: 3.671 Vali Acc: 0.226 Test Loss: 3.671 Test Acc: 0.226
Validation loss decreased (-0.222317 --> -0.225846).  Saving model ...
Epoch: 21 cost time: 1.314223289489746
Epoch: 21, Steps: 10 | Train Loss: 0.129 Vali Loss: 3.738 Vali Acc: 0.234 Test Loss: 3.738 Test Acc: 0.234
Validation loss decreased (-0.225846 --> -0.234080).  Saving model ...
Epoch: 22 cost time: 1.4162044525146484
Epoch: 22, Steps: 10 | Train Loss: 0.104 Vali Loss: 3.801 Vali Acc: 0.227 Test Loss: 3.801 Test Acc: 0.227
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.154111385345459
Epoch: 23, Steps: 10 | Train Loss: 0.083 Vali Loss: 3.854 Vali Acc: 0.233 Test Loss: 3.854 Test Acc: 0.233
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.3011651039123535
Epoch: 24, Steps: 10 | Train Loss: 0.067 Vali Loss: 3.936 Vali Acc: 0.228 Test Loss: 3.936 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.8109335899353027
Epoch: 25, Steps: 10 | Train Loss: 0.064 Vali Loss: 3.995 Vali Acc: 0.231 Test Loss: 3.995 Test Acc: 0.231
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.3765554428100586
Epoch: 26, Steps: 10 | Train Loss: 0.048 Vali Loss: 4.033 Vali Acc: 0.242 Test Loss: 4.033 Test Acc: 0.242
Validation loss decreased (-0.234080 --> -0.242313).  Saving model ...
Epoch: 27 cost time: 1.52303147315979
Epoch: 27, Steps: 10 | Train Loss: 0.042 Vali Loss: 4.066 Vali Acc: 0.244 Test Loss: 4.066 Test Acc: 0.244
Validation loss decreased (-0.242313 --> -0.243489).  Saving model ...
Epoch: 28 cost time: 1.5466182231903076
Epoch: 28, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.110 Vali Acc: 0.242 Test Loss: 4.110 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.2768948078155518
Epoch: 29, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.151 Vali Acc: 0.241 Test Loss: 4.151 Test Acc: 0.241
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.5508410930633545
Epoch: 30, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.180 Vali Acc: 0.246 Test Loss: 4.180 Test Acc: 0.246
Validation loss decreased (-0.243489 --> -0.245841).  Saving model ...
Epoch: 31 cost time: 1.1491446495056152
Epoch: 31, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.217 Vali Acc: 0.249 Test Loss: 4.217 Test Acc: 0.249
Validation loss decreased (-0.245841 --> -0.249370).  Saving model ...
Epoch: 32 cost time: 1.2846674919128418
Epoch: 32, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.254 Vali Acc: 0.244 Test Loss: 4.254 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.4303123950958252
Epoch: 33, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.295 Vali Acc: 0.242 Test Loss: 4.295 Test Acc: 0.242
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.6028258800506592
Epoch: 34, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.311 Vali Acc: 0.245 Test Loss: 4.311 Test Acc: 0.245
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.4016478061676025
Epoch: 35, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.325 Vali Acc: 0.247 Test Loss: 4.325 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.4743754863739014
Epoch: 36, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.352 Vali Acc: 0.252 Test Loss: 4.352 Test Acc: 0.252
Validation loss decreased (-0.249370 --> -0.251721).  Saving model ...
Epoch: 37 cost time: 1.4831459522247314
Epoch: 37, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.390 Vali Acc: 0.248 Test Loss: 4.390 Test Acc: 0.248
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.5425195693969727
Epoch: 38, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.413 Vali Acc: 0.248 Test Loss: 4.413 Test Acc: 0.248
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.4984233379364014
Epoch: 39, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.442 Vali Acc: 0.249 Test Loss: 4.442 Test Acc: 0.249
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.5497114658355713
Epoch: 40, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.473 Vali Acc: 0.251 Test Loss: 4.473 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.420278787612915
Epoch: 41, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.496 Vali Acc: 0.248 Test Loss: 4.496 Test Acc: 0.248
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.4494636058807373
Epoch: 42, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.520 Vali Acc: 0.245 Test Loss: 4.520 Test Acc: 0.245
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.2656173706054688
Epoch: 43, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.531 Vali Acc: 0.253 Test Loss: 4.531 Test Acc: 0.253
Validation loss decreased (-0.251721 --> -0.252896).  Saving model ...
Epoch: 44 cost time: 1.4047198295593262
Epoch: 44, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.551 Vali Acc: 0.248 Test Loss: 4.551 Test Acc: 0.248
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.403545618057251
Epoch: 45, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.582 Vali Acc: 0.251 Test Loss: 4.582 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.2468080520629883
Epoch: 46, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.601 Vali Acc: 0.249 Test Loss: 4.601 Test Acc: 0.249
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.2013132572174072
Epoch: 47, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.611 Vali Acc: 0.252 Test Loss: 4.611 Test Acc: 0.252
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.6069090366363525
Epoch: 48, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.635 Vali Acc: 0.252 Test Loss: 4.635 Test Acc: 0.252
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.3572711944580078
Epoch: 49, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.662 Vali Acc: 0.249 Test Loss: 4.662 Test Acc: 0.249
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 1.0839884281158447
Epoch: 50, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.688 Vali Acc: 0.248 Test Loss: 4.688 Test Acc: 0.248
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps12_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2529411764705882
model parameter : 376634
model size : 1.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.0859649181365967
Epoch: 1, Steps: 10 | Train Loss: 3.278 Vali Loss: 3.268 Vali Acc: 0.045 Test Loss: 3.268 Test Acc: 0.045
Validation loss decreased (inf --> -0.044673).  Saving model ...
Epoch: 2 cost time: 1.0503292083740234
Epoch: 2, Steps: 10 | Train Loss: 3.246 Vali Loss: 3.265 Vali Acc: 0.054 Test Loss: 3.265 Test Acc: 0.054
Validation loss decreased (-0.044673 --> -0.054085).  Saving model ...
Epoch: 3 cost time: 1.1168453693389893
Epoch: 3, Steps: 10 | Train Loss: 3.147 Vali Loss: 3.259 Vali Acc: 0.068 Test Loss: 3.259 Test Acc: 0.068
Validation loss decreased (-0.054085 --> -0.068203).  Saving model ...
Epoch: 4 cost time: 1.2951233386993408
Epoch: 4, Steps: 10 | Train Loss: 3.058 Vali Loss: 3.255 Vali Acc: 0.076 Test Loss: 3.255 Test Acc: 0.076
Validation loss decreased (-0.068203 --> -0.076438).  Saving model ...
Epoch: 5 cost time: 1.1480441093444824
Epoch: 5, Steps: 10 | Train Loss: 2.939 Vali Loss: 3.249 Vali Acc: 0.085 Test Loss: 3.249 Test Acc: 0.085
Validation loss decreased (-0.076438 --> -0.084673).  Saving model ...
Epoch: 6 cost time: 1.2789463996887207
Epoch: 6, Steps: 10 | Train Loss: 2.836 Vali Loss: 3.247 Vali Acc: 0.095 Test Loss: 3.247 Test Acc: 0.095
Validation loss decreased (-0.084673 --> -0.095262).  Saving model ...
Epoch: 7 cost time: 1.2394473552703857
Epoch: 7, Steps: 10 | Train Loss: 2.691 Vali Loss: 3.242 Vali Acc: 0.106 Test Loss: 3.242 Test Acc: 0.106
Validation loss decreased (-0.095262 --> -0.105850).  Saving model ...
Epoch: 8 cost time: 1.3273143768310547
Epoch: 8, Steps: 10 | Train Loss: 2.548 Vali Loss: 3.236 Vali Acc: 0.119 Test Loss: 3.236 Test Acc: 0.119
Validation loss decreased (-0.105850 --> -0.118791).  Saving model ...
Epoch: 9 cost time: 1.0885779857635498
Epoch: 9, Steps: 10 | Train Loss: 2.389 Vali Loss: 3.223 Vali Acc: 0.125 Test Loss: 3.223 Test Acc: 0.125
Validation loss decreased (-0.118791 --> -0.124674).  Saving model ...
Epoch: 10 cost time: 1.4650075435638428
Epoch: 10, Steps: 10 | Train Loss: 2.224 Vali Loss: 3.215 Vali Acc: 0.128 Test Loss: 3.215 Test Acc: 0.128
Validation loss decreased (-0.124674 --> -0.128203).  Saving model ...
Epoch: 11 cost time: 1.3165483474731445
Epoch: 11, Steps: 10 | Train Loss: 2.044 Vali Loss: 3.209 Vali Acc: 0.133 Test Loss: 3.209 Test Acc: 0.133
Validation loss decreased (-0.128203 --> -0.132909).  Saving model ...
Epoch: 12 cost time: 0.9038574695587158
Epoch: 12, Steps: 10 | Train Loss: 1.842 Vali Loss: 3.203 Vali Acc: 0.152 Test Loss: 3.203 Test Acc: 0.152
Validation loss decreased (-0.132909 --> -0.151733).  Saving model ...
Epoch: 13 cost time: 1.1664657592773438
Epoch: 13, Steps: 10 | Train Loss: 1.647 Vali Loss: 3.198 Vali Acc: 0.169 Test Loss: 3.198 Test Acc: 0.169
Validation loss decreased (-0.151733 --> -0.169380).  Saving model ...
Epoch: 14 cost time: 1.2289485931396484
Epoch: 14, Steps: 10 | Train Loss: 1.438 Vali Loss: 3.194 Vali Acc: 0.179 Test Loss: 3.194 Test Acc: 0.179
Validation loss decreased (-0.169380 --> -0.178792).  Saving model ...
Epoch: 15 cost time: 0.9886267185211182
Epoch: 15, Steps: 10 | Train Loss: 1.231 Vali Loss: 3.203 Vali Acc: 0.189 Test Loss: 3.203 Test Acc: 0.189
Validation loss decreased (-0.178792 --> -0.189380).  Saving model ...
Epoch: 16 cost time: 1.0764122009277344
Epoch: 16, Steps: 10 | Train Loss: 1.039 Vali Loss: 3.231 Vali Acc: 0.208 Test Loss: 3.231 Test Acc: 0.208
Validation loss decreased (-0.189380 --> -0.208203).  Saving model ...
Epoch: 17 cost time: 1.3640248775482178
Epoch: 17, Steps: 10 | Train Loss: 0.828 Vali Loss: 3.268 Vali Acc: 0.211 Test Loss: 3.268 Test Acc: 0.211
Validation loss decreased (-0.208203 --> -0.210556).  Saving model ...
Epoch: 18 cost time: 1.195659875869751
Epoch: 18, Steps: 10 | Train Loss: 0.648 Vali Loss: 3.315 Vali Acc: 0.219 Test Loss: 3.315 Test Acc: 0.219
Validation loss decreased (-0.210556 --> -0.218790).  Saving model ...
Epoch: 19 cost time: 1.1821448802947998
Epoch: 19, Steps: 10 | Train Loss: 0.520 Vali Loss: 3.357 Vali Acc: 0.236 Test Loss: 3.357 Test Acc: 0.236
Validation loss decreased (-0.218790 --> -0.236437).  Saving model ...
Epoch: 20 cost time: 1.3906114101409912
Epoch: 20, Steps: 10 | Train Loss: 0.401 Vali Loss: 3.415 Vali Acc: 0.246 Test Loss: 3.415 Test Acc: 0.246
Validation loss decreased (-0.236437 --> -0.245848).  Saving model ...
Epoch: 21 cost time: 1.1729803085327148
Epoch: 21, Steps: 10 | Train Loss: 0.302 Vali Loss: 3.474 Vali Acc: 0.248 Test Loss: 3.474 Test Acc: 0.248
Validation loss decreased (-0.245848 --> -0.248201).  Saving model ...
Epoch: 22 cost time: 1.220991849899292
Epoch: 22, Steps: 10 | Train Loss: 0.249 Vali Loss: 3.558 Vali Acc: 0.249 Test Loss: 3.558 Test Acc: 0.249
Validation loss decreased (-0.248201 --> -0.249376).  Saving model ...
Epoch: 23 cost time: 0.9414863586425781
Epoch: 23, Steps: 10 | Train Loss: 0.198 Vali Loss: 3.607 Vali Acc: 0.264 Test Loss: 3.607 Test Acc: 0.264
Validation loss decreased (-0.249376 --> -0.263493).  Saving model ...
Epoch: 24 cost time: 0.9655325412750244
Epoch: 24, Steps: 10 | Train Loss: 0.160 Vali Loss: 3.667 Vali Acc: 0.256 Test Loss: 3.667 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.209801435470581
Epoch: 25, Steps: 10 | Train Loss: 0.116 Vali Loss: 3.708 Vali Acc: 0.252 Test Loss: 3.708 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.2189316749572754
Epoch: 26, Steps: 10 | Train Loss: 0.100 Vali Loss: 3.751 Vali Acc: 0.265 Test Loss: 3.751 Test Acc: 0.265
Validation loss decreased (-0.263493 --> -0.264668).  Saving model ...
Epoch: 27 cost time: 0.9784619808197021
Epoch: 27, Steps: 10 | Train Loss: 0.078 Vali Loss: 3.805 Vali Acc: 0.262 Test Loss: 3.805 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.103102445602417
Epoch: 28, Steps: 10 | Train Loss: 0.065 Vali Loss: 3.856 Vali Acc: 0.266 Test Loss: 3.856 Test Acc: 0.266
Validation loss decreased (-0.264668 --> -0.265844).  Saving model ...
Epoch: 29 cost time: 1.0368890762329102
Epoch: 29, Steps: 10 | Train Loss: 0.060 Vali Loss: 3.900 Vali Acc: 0.262 Test Loss: 3.900 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.0199356079101562
Epoch: 30, Steps: 10 | Train Loss: 0.052 Vali Loss: 3.928 Vali Acc: 0.266 Test Loss: 3.928 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.9886550903320312
Epoch: 31, Steps: 10 | Train Loss: 0.044 Vali Loss: 3.985 Vali Acc: 0.264 Test Loss: 3.985 Test Acc: 0.264
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.1175687313079834
Epoch: 32, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.011 Vali Acc: 0.262 Test Loss: 4.011 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.0250766277313232
Epoch: 33, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.054 Vali Acc: 0.262 Test Loss: 4.054 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.934565544128418
Epoch: 34, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.087 Vali Acc: 0.258 Test Loss: 4.087 Test Acc: 0.258
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.097376823425293
Epoch: 35, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.104 Vali Acc: 0.262 Test Loss: 4.104 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.0179622173309326
Epoch: 36, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.125 Vali Acc: 0.266 Test Loss: 4.125 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.092648983001709
Epoch: 37, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.134 Vali Acc: 0.271 Test Loss: 4.134 Test Acc: 0.271
Validation loss decreased (-0.265844 --> -0.270547).  Saving model ...
Epoch: 38 cost time: 1.1016089916229248
Epoch: 38, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.168 Vali Acc: 0.268 Test Loss: 4.168 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.1778788566589355
Epoch: 39, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.197 Vali Acc: 0.271 Test Loss: 4.197 Test Acc: 0.271
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.1607842445373535
Epoch: 40, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.234 Vali Acc: 0.266 Test Loss: 4.234 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.2682483196258545
Epoch: 41, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.255 Vali Acc: 0.268 Test Loss: 4.255 Test Acc: 0.268
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.1012604236602783
Epoch: 42, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.265 Vali Acc: 0.269 Test Loss: 4.265 Test Acc: 0.269
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.125087022781372
Epoch: 43, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.275 Vali Acc: 0.268 Test Loss: 4.275 Test Acc: 0.268
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.181143045425415
Epoch: 44, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.314 Vali Acc: 0.271 Test Loss: 4.314 Test Acc: 0.271
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.0930509567260742
Epoch: 45, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.344 Vali Acc: 0.271 Test Loss: 4.344 Test Acc: 0.271
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 1.276540756225586
Epoch: 46, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.367 Vali Acc: 0.269 Test Loss: 4.367 Test Acc: 0.269
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 1.193114995956421
Epoch: 47, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.386 Vali Acc: 0.271 Test Loss: 4.386 Test Acc: 0.271
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27058823529411763
model parameter : 356794
model size : 1.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps23_str12_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.4908831119537354
Epoch: 1, Steps: 10 | Train Loss: 3.280 Vali Loss: 3.262 Vali Acc: 0.049 Test Loss: 3.262 Test Acc: 0.049
Validation loss decreased (inf --> -0.049379).  Saving model ...
Epoch: 2 cost time: 1.2389585971832275
Epoch: 2, Steps: 10 | Train Loss: 3.233 Vali Loss: 3.261 Vali Acc: 0.047 Test Loss: 3.261 Test Acc: 0.047
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2201931476593018
Epoch: 3, Steps: 10 | Train Loss: 3.164 Vali Loss: 3.254 Vali Acc: 0.052 Test Loss: 3.254 Test Acc: 0.052
Validation loss decreased (-0.049379 --> -0.051732).  Saving model ...
Epoch: 4 cost time: 1.0744903087615967
Epoch: 4, Steps: 10 | Train Loss: 3.087 Vali Loss: 3.248 Vali Acc: 0.059 Test Loss: 3.248 Test Acc: 0.059
Validation loss decreased (-0.051732 --> -0.058791).  Saving model ...
Epoch: 5 cost time: 1.2514081001281738
Epoch: 5, Steps: 10 | Train Loss: 3.032 Vali Loss: 3.242 Vali Acc: 0.071 Test Loss: 3.242 Test Acc: 0.071
Validation loss decreased (-0.058791 --> -0.070556).  Saving model ...
Epoch: 6 cost time: 1.1622023582458496
Epoch: 6, Steps: 10 | Train Loss: 2.933 Vali Loss: 3.238 Vali Acc: 0.081 Test Loss: 3.238 Test Acc: 0.081
Validation loss decreased (-0.070556 --> -0.081144).  Saving model ...
Epoch: 7 cost time: 1.1777355670928955
Epoch: 7, Steps: 10 | Train Loss: 2.814 Vali Loss: 3.234 Vali Acc: 0.082 Test Loss: 3.234 Test Acc: 0.082
Validation loss decreased (-0.081144 --> -0.082321).  Saving model ...
Epoch: 8 cost time: 0.9805817604064941
Epoch: 8, Steps: 10 | Train Loss: 2.735 Vali Loss: 3.232 Vali Acc: 0.091 Test Loss: 3.232 Test Acc: 0.091
Validation loss decreased (-0.082321 --> -0.090556).  Saving model ...
Epoch: 9 cost time: 0.9593784809112549
Epoch: 9, Steps: 10 | Train Loss: 2.595 Vali Loss: 3.224 Vali Acc: 0.100 Test Loss: 3.224 Test Acc: 0.100
Validation loss decreased (-0.090556 --> -0.099968).  Saving model ...
Epoch: 10 cost time: 1.0278575420379639
Epoch: 10, Steps: 10 | Train Loss: 2.498 Vali Loss: 3.219 Vali Acc: 0.105 Test Loss: 3.219 Test Acc: 0.105
Validation loss decreased (-0.099968 --> -0.104674).  Saving model ...
Epoch: 11 cost time: 0.8977022171020508
Epoch: 11, Steps: 10 | Train Loss: 2.314 Vali Loss: 3.213 Vali Acc: 0.111 Test Loss: 3.213 Test Acc: 0.111
Validation loss decreased (-0.104674 --> -0.110556).  Saving model ...
Epoch: 12 cost time: 1.1884150505065918
Epoch: 12, Steps: 10 | Train Loss: 2.220 Vali Loss: 3.207 Vali Acc: 0.114 Test Loss: 3.207 Test Acc: 0.114
Validation loss decreased (-0.110556 --> -0.114086).  Saving model ...
Epoch: 13 cost time: 1.1009554862976074
Epoch: 13, Steps: 10 | Train Loss: 2.023 Vali Loss: 3.206 Vali Acc: 0.124 Test Loss: 3.206 Test Acc: 0.124
Validation loss decreased (-0.114086 --> -0.123497).  Saving model ...
Epoch: 14 cost time: 1.1369602680206299
Epoch: 14, Steps: 10 | Train Loss: 1.903 Vali Loss: 3.209 Vali Acc: 0.138 Test Loss: 3.209 Test Acc: 0.138
Validation loss decreased (-0.123497 --> -0.137615).  Saving model ...
Epoch: 15 cost time: 1.3485329151153564
Epoch: 15, Steps: 10 | Train Loss: 1.691 Vali Loss: 3.212 Vali Acc: 0.148 Test Loss: 3.212 Test Acc: 0.148
Validation loss decreased (-0.137615 --> -0.148203).  Saving model ...
Epoch: 16 cost time: 1.096618413925171
Epoch: 16, Steps: 10 | Train Loss: 1.567 Vali Loss: 3.216 Vali Acc: 0.164 Test Loss: 3.216 Test Acc: 0.164
Validation loss decreased (-0.148203 --> -0.163497).  Saving model ...
Epoch: 17 cost time: 1.015373945236206
Epoch: 17, Steps: 10 | Train Loss: 1.363 Vali Loss: 3.230 Vali Acc: 0.179 Test Loss: 3.230 Test Acc: 0.179
Validation loss decreased (-0.163497 --> -0.178791).  Saving model ...
Epoch: 18 cost time: 1.2362184524536133
Epoch: 18, Steps: 10 | Train Loss: 1.204 Vali Loss: 3.256 Vali Acc: 0.191 Test Loss: 3.256 Test Acc: 0.191
Validation loss decreased (-0.178791 --> -0.190556).  Saving model ...
Epoch: 19 cost time: 1.0848028659820557
Epoch: 19, Steps: 10 | Train Loss: 1.043 Vali Loss: 3.287 Vali Acc: 0.200 Test Loss: 3.287 Test Acc: 0.200
Validation loss decreased (-0.190556 --> -0.199967).  Saving model ...
Epoch: 20 cost time: 1.1268055438995361
Epoch: 20, Steps: 10 | Train Loss: 0.910 Vali Loss: 3.317 Vali Acc: 0.204 Test Loss: 3.317 Test Acc: 0.204
Validation loss decreased (-0.199967 --> -0.203496).  Saving model ...
Epoch: 21 cost time: 1.2274117469787598
Epoch: 21, Steps: 10 | Train Loss: 0.742 Vali Loss: 3.352 Vali Acc: 0.218 Test Loss: 3.352 Test Acc: 0.218
Validation loss decreased (-0.203496 --> -0.217614).  Saving model ...
Epoch: 22 cost time: 1.3397331237792969
Epoch: 22, Steps: 10 | Train Loss: 0.623 Vali Loss: 3.416 Vali Acc: 0.211 Test Loss: 3.416 Test Acc: 0.211
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0079245567321777
Epoch: 23, Steps: 10 | Train Loss: 0.520 Vali Loss: 3.477 Vali Acc: 0.224 Test Loss: 3.477 Test Acc: 0.224
Validation loss decreased (-0.217614 --> -0.223495).  Saving model ...
Epoch: 24 cost time: 0.9883589744567871
Epoch: 24, Steps: 10 | Train Loss: 0.404 Vali Loss: 3.533 Vali Acc: 0.233 Test Loss: 3.533 Test Acc: 0.233
Validation loss decreased (-0.223495 --> -0.232906).  Saving model ...
Epoch: 25 cost time: 1.023348093032837
Epoch: 25, Steps: 10 | Train Loss: 0.349 Vali Loss: 3.607 Vali Acc: 0.233 Test Loss: 3.607 Test Acc: 0.233
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.1722583770751953
Epoch: 26, Steps: 10 | Train Loss: 0.296 Vali Loss: 3.669 Vali Acc: 0.229 Test Loss: 3.669 Test Acc: 0.229
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.1170768737792969
Epoch: 27, Steps: 10 | Train Loss: 0.231 Vali Loss: 3.724 Vali Acc: 0.234 Test Loss: 3.724 Test Acc: 0.234
Validation loss decreased (-0.232906 --> -0.234080).  Saving model ...
Epoch: 28 cost time: 0.9977211952209473
Epoch: 28, Steps: 10 | Train Loss: 0.198 Vali Loss: 3.772 Vali Acc: 0.228 Test Loss: 3.772 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.0297143459320068
Epoch: 29, Steps: 10 | Train Loss: 0.155 Vali Loss: 3.839 Vali Acc: 0.222 Test Loss: 3.839 Test Acc: 0.222
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.1091139316558838
Epoch: 30, Steps: 10 | Train Loss: 0.121 Vali Loss: 3.879 Vali Acc: 0.232 Test Loss: 3.879 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.0976409912109375
Epoch: 31, Steps: 10 | Train Loss: 0.109 Vali Loss: 3.938 Vali Acc: 0.234 Test Loss: 3.938 Test Acc: 0.234
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.2415685653686523
Epoch: 32, Steps: 10 | Train Loss: 0.094 Vali Loss: 3.992 Vali Acc: 0.229 Test Loss: 3.992 Test Acc: 0.229
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.0509567260742188
Epoch: 33, Steps: 10 | Train Loss: 0.083 Vali Loss: 4.036 Vali Acc: 0.231 Test Loss: 4.036 Test Acc: 0.231
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.3376295566558838
Epoch: 34, Steps: 10 | Train Loss: 0.069 Vali Loss: 4.080 Vali Acc: 0.235 Test Loss: 4.080 Test Acc: 0.235
Validation loss decreased (-0.234080 --> -0.235253).  Saving model ...
Epoch: 35 cost time: 1.1692750453948975
Epoch: 35, Steps: 10 | Train Loss: 0.063 Vali Loss: 4.134 Vali Acc: 0.236 Test Loss: 4.134 Test Acc: 0.236
Validation loss decreased (-0.235253 --> -0.236429).  Saving model ...
Epoch: 36 cost time: 1.1512258052825928
Epoch: 36, Steps: 10 | Train Loss: 0.055 Vali Loss: 4.170 Vali Acc: 0.235 Test Loss: 4.170 Test Acc: 0.235
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.0830168724060059
Epoch: 37, Steps: 10 | Train Loss: 0.054 Vali Loss: 4.230 Vali Acc: 0.226 Test Loss: 4.230 Test Acc: 0.226
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.996619462966919
Epoch: 38, Steps: 10 | Train Loss: 0.049 Vali Loss: 4.262 Vali Acc: 0.227 Test Loss: 4.262 Test Acc: 0.227
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.101637601852417
Epoch: 39, Steps: 10 | Train Loss: 0.042 Vali Loss: 4.265 Vali Acc: 0.232 Test Loss: 4.265 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.817497730255127
Epoch: 40, Steps: 10 | Train Loss: 0.038 Vali Loss: 4.300 Vali Acc: 0.235 Test Loss: 4.300 Test Acc: 0.235
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.8964900970458984
Epoch: 41, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.303 Vali Acc: 0.239 Test Loss: 4.303 Test Acc: 0.239
Validation loss decreased (-0.236429 --> -0.238781).  Saving model ...
Epoch: 42 cost time: 0.8545193672180176
Epoch: 42, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.346 Vali Acc: 0.240 Test Loss: 4.346 Test Acc: 0.240
Validation loss decreased (-0.238781 --> -0.239957).  Saving model ...
Epoch: 43 cost time: 0.9202191829681396
Epoch: 43, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.362 Vali Acc: 0.239 Test Loss: 4.362 Test Acc: 0.239
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.2320432662963867
Epoch: 44, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.390 Vali Acc: 0.238 Test Loss: 4.390 Test Acc: 0.238
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.0439453125
Epoch: 45, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.406 Vali Acc: 0.238 Test Loss: 4.406 Test Acc: 0.238
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.2504212856292725
Epoch: 46, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.431 Vali Acc: 0.238 Test Loss: 4.431 Test Acc: 0.238
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.2386794090270996
Epoch: 47, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.473 Vali Acc: 0.238 Test Loss: 4.473 Test Acc: 0.238
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.3578712940216064
Epoch: 48, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.501 Vali Acc: 0.239 Test Loss: 4.501 Test Acc: 0.239
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 1.1493024826049805
Epoch: 49, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.535 Vali Acc: 0.238 Test Loss: 4.535 Test Acc: 0.238
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 1.2356417179107666
Epoch: 50, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.553 Vali Acc: 0.242 Test Loss: 4.553 Test Acc: 0.242
Validation loss decreased (-0.239957 --> -0.242307).  Saving model ...
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps23_str12_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.24235294117647058
model parameter : 337050
model size : 1.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.4202723503112793
Epoch: 1, Steps: 10 | Train Loss: 3.219 Vali Loss: 3.269 Vali Acc: 0.029 Test Loss: 3.269 Test Acc: 0.029
Validation loss decreased (inf --> -0.029379).  Saving model ...
Epoch: 2 cost time: 1.3233516216278076
Epoch: 2, Steps: 10 | Train Loss: 3.197 Vali Loss: 3.271 Vali Acc: 0.038 Test Loss: 3.271 Test Acc: 0.038
Validation loss decreased (-0.029379 --> -0.037614).  Saving model ...
Epoch: 3 cost time: 1.0335817337036133
Epoch: 3, Steps: 10 | Train Loss: 3.144 Vali Loss: 3.271 Vali Acc: 0.052 Test Loss: 3.271 Test Acc: 0.052
Validation loss decreased (-0.037614 --> -0.051732).  Saving model ...
Epoch: 4 cost time: 0.9034228324890137
Epoch: 4, Steps: 10 | Train Loss: 3.074 Vali Loss: 3.266 Vali Acc: 0.062 Test Loss: 3.266 Test Acc: 0.062
Validation loss decreased (-0.051732 --> -0.062320).  Saving model ...
Epoch: 5 cost time: 1.2286591529846191
Epoch: 5, Steps: 10 | Train Loss: 3.015 Vali Loss: 3.263 Vali Acc: 0.075 Test Loss: 3.263 Test Acc: 0.075
Validation loss decreased (-0.062320 --> -0.075261).  Saving model ...
Epoch: 6 cost time: 1.068281888961792
Epoch: 6, Steps: 10 | Train Loss: 2.916 Vali Loss: 3.260 Vali Acc: 0.074 Test Loss: 3.260 Test Acc: 0.074
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.002455234527588
Epoch: 7, Steps: 10 | Train Loss: 2.832 Vali Loss: 3.256 Vali Acc: 0.092 Test Loss: 3.256 Test Acc: 0.092
Validation loss decreased (-0.075261 --> -0.091732).  Saving model ...
Epoch: 8 cost time: 1.3149285316467285
Epoch: 8, Steps: 10 | Train Loss: 2.753 Vali Loss: 3.253 Vali Acc: 0.104 Test Loss: 3.253 Test Acc: 0.104
Validation loss decreased (-0.091732 --> -0.103497).  Saving model ...
Epoch: 9 cost time: 1.096876621246338
Epoch: 9, Steps: 10 | Train Loss: 2.624 Vali Loss: 3.245 Vali Acc: 0.111 Test Loss: 3.245 Test Acc: 0.111
Validation loss decreased (-0.103497 --> -0.110556).  Saving model ...
Epoch: 10 cost time: 1.0514650344848633
Epoch: 10, Steps: 10 | Train Loss: 2.542 Vali Loss: 3.238 Vali Acc: 0.118 Test Loss: 3.238 Test Acc: 0.118
Validation loss decreased (-0.110556 --> -0.117615).  Saving model ...
Epoch: 11 cost time: 1.2288072109222412
Epoch: 11, Steps: 10 | Train Loss: 2.394 Vali Loss: 3.231 Vali Acc: 0.125 Test Loss: 3.231 Test Acc: 0.125
Validation loss decreased (-0.117615 --> -0.124674).  Saving model ...
Epoch: 12 cost time: 1.0209674835205078
Epoch: 12, Steps: 10 | Train Loss: 2.300 Vali Loss: 3.224 Vali Acc: 0.131 Test Loss: 3.224 Test Acc: 0.131
Validation loss decreased (-0.124674 --> -0.130556).  Saving model ...
Epoch: 13 cost time: 1.0647554397583008
Epoch: 13, Steps: 10 | Train Loss: 2.132 Vali Loss: 3.211 Vali Acc: 0.144 Test Loss: 3.211 Test Acc: 0.144
Validation loss decreased (-0.130556 --> -0.143497).  Saving model ...
Epoch: 14 cost time: 1.4176685810089111
Epoch: 14, Steps: 10 | Train Loss: 1.984 Vali Loss: 3.205 Vali Acc: 0.151 Test Loss: 3.205 Test Acc: 0.151
Validation loss decreased (-0.143497 --> -0.150556).  Saving model ...
Epoch: 15 cost time: 1.1398088932037354
Epoch: 15, Steps: 10 | Train Loss: 1.823 Vali Loss: 3.206 Vali Acc: 0.154 Test Loss: 3.206 Test Acc: 0.154
Validation loss decreased (-0.150556 --> -0.154086).  Saving model ...
Epoch: 16 cost time: 1.0313632488250732
Epoch: 16, Steps: 10 | Train Loss: 1.682 Vali Loss: 3.205 Vali Acc: 0.160 Test Loss: 3.205 Test Acc: 0.160
Validation loss decreased (-0.154086 --> -0.159968).  Saving model ...
Epoch: 17 cost time: 1.261991262435913
Epoch: 17, Steps: 10 | Train Loss: 1.515 Vali Loss: 3.212 Vali Acc: 0.172 Test Loss: 3.212 Test Acc: 0.172
Validation loss decreased (-0.159968 --> -0.171733).  Saving model ...
Epoch: 18 cost time: 0.9557046890258789
Epoch: 18, Steps: 10 | Train Loss: 1.330 Vali Loss: 3.222 Vali Acc: 0.175 Test Loss: 3.222 Test Acc: 0.175
Validation loss decreased (-0.171733 --> -0.175262).  Saving model ...
Epoch: 19 cost time: 0.9044251441955566
Epoch: 19, Steps: 10 | Train Loss: 1.217 Vali Loss: 3.246 Vali Acc: 0.186 Test Loss: 3.246 Test Acc: 0.186
Validation loss decreased (-0.175262 --> -0.185850).  Saving model ...
Epoch: 20 cost time: 0.9895162582397461
Epoch: 20, Steps: 10 | Train Loss: 1.075 Vali Loss: 3.261 Vali Acc: 0.186 Test Loss: 3.261 Test Acc: 0.186
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0360445976257324
Epoch: 21, Steps: 10 | Train Loss: 0.897 Vali Loss: 3.279 Vali Acc: 0.200 Test Loss: 3.279 Test Acc: 0.200
Validation loss decreased (-0.185850 --> -0.199967).  Saving model ...
Epoch: 22 cost time: 1.0196256637573242
Epoch: 22, Steps: 10 | Train Loss: 0.786 Vali Loss: 3.323 Vali Acc: 0.202 Test Loss: 3.323 Test Acc: 0.202
Validation loss decreased (-0.199967 --> -0.202320).  Saving model ...
Epoch: 23 cost time: 1.1536743640899658
Epoch: 23, Steps: 10 | Train Loss: 0.646 Vali Loss: 3.354 Vali Acc: 0.212 Test Loss: 3.354 Test Acc: 0.212
Validation loss decreased (-0.202320 --> -0.211731).  Saving model ...
Epoch: 24 cost time: 1.1411306858062744
Epoch: 24, Steps: 10 | Train Loss: 0.531 Vali Loss: 3.406 Vali Acc: 0.219 Test Loss: 3.406 Test Acc: 0.219
Validation loss decreased (-0.211731 --> -0.218789).  Saving model ...
Epoch: 25 cost time: 1.2117347717285156
Epoch: 25, Steps: 10 | Train Loss: 0.429 Vali Loss: 3.458 Vali Acc: 0.222 Test Loss: 3.458 Test Acc: 0.222
Validation loss decreased (-0.218789 --> -0.222318).  Saving model ...
Epoch: 26 cost time: 1.2671513557434082
Epoch: 26, Steps: 10 | Train Loss: 0.348 Vali Loss: 3.519 Vali Acc: 0.221 Test Loss: 3.519 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.2863211631774902
Epoch: 27, Steps: 10 | Train Loss: 0.320 Vali Loss: 3.574 Vali Acc: 0.228 Test Loss: 3.574 Test Acc: 0.228
Validation loss decreased (-0.222318 --> -0.228200).  Saving model ...
Epoch: 28 cost time: 1.2895572185516357
Epoch: 28, Steps: 10 | Train Loss: 0.249 Vali Loss: 3.632 Vali Acc: 0.233 Test Loss: 3.632 Test Acc: 0.233
Validation loss decreased (-0.228200 --> -0.232905).  Saving model ...
Epoch: 29 cost time: 1.3504207134246826
Epoch: 29, Steps: 10 | Train Loss: 0.197 Vali Loss: 3.671 Vali Acc: 0.238 Test Loss: 3.671 Test Acc: 0.238
Validation loss decreased (-0.232905 --> -0.237610).  Saving model ...
Epoch: 30 cost time: 1.146355152130127
Epoch: 30, Steps: 10 | Train Loss: 0.176 Vali Loss: 3.698 Vali Acc: 0.235 Test Loss: 3.698 Test Acc: 0.235
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.2983946800231934
Epoch: 31, Steps: 10 | Train Loss: 0.149 Vali Loss: 3.745 Vali Acc: 0.240 Test Loss: 3.745 Test Acc: 0.240
Validation loss decreased (-0.237610 --> -0.239963).  Saving model ...
Epoch: 32 cost time: 1.3857371807098389
Epoch: 32, Steps: 10 | Train Loss: 0.119 Vali Loss: 3.798 Vali Acc: 0.235 Test Loss: 3.798 Test Acc: 0.235
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.2360210418701172
Epoch: 33, Steps: 10 | Train Loss: 0.106 Vali Loss: 3.834 Vali Acc: 0.242 Test Loss: 3.834 Test Acc: 0.242
Validation loss decreased (-0.239963 --> -0.242315).  Saving model ...
Epoch: 34 cost time: 1.4608232975006104
Epoch: 34, Steps: 10 | Train Loss: 0.083 Vali Loss: 3.877 Vali Acc: 0.244 Test Loss: 3.877 Test Acc: 0.244
Validation loss decreased (-0.242315 --> -0.243491).  Saving model ...
Epoch: 35 cost time: 1.1591577529907227
Epoch: 35, Steps: 10 | Train Loss: 0.075 Vali Loss: 3.917 Vali Acc: 0.244 Test Loss: 3.917 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.2271077632904053
Epoch: 36, Steps: 10 | Train Loss: 0.064 Vali Loss: 3.971 Vali Acc: 0.248 Test Loss: 3.971 Test Acc: 0.248
Validation loss decreased (-0.243491 --> -0.248196).  Saving model ...
Epoch: 37 cost time: 1.3318562507629395
Epoch: 37, Steps: 10 | Train Loss: 0.061 Vali Loss: 4.001 Vali Acc: 0.245 Test Loss: 4.001 Test Acc: 0.245
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.4094841480255127
Epoch: 38, Steps: 10 | Train Loss: 0.048 Vali Loss: 4.018 Vali Acc: 0.242 Test Loss: 4.018 Test Acc: 0.242
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.3380589485168457
Epoch: 39, Steps: 10 | Train Loss: 0.047 Vali Loss: 4.041 Vali Acc: 0.241 Test Loss: 4.041 Test Acc: 0.241
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.4464573860168457
Epoch: 40, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.062 Vali Acc: 0.244 Test Loss: 4.062 Test Acc: 0.244
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.0512745380401611
Epoch: 41, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.124 Vali Acc: 0.247 Test Loss: 4.124 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.2656488418579102
Epoch: 42, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.144 Vali Acc: 0.244 Test Loss: 4.144 Test Acc: 0.244
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.2267882823944092
Epoch: 43, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.164 Vali Acc: 0.251 Test Loss: 4.164 Test Acc: 0.251
Validation loss decreased (-0.248196 --> -0.250547).  Saving model ...
Epoch: 44 cost time: 1.1058845520019531
Epoch: 44, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.187 Vali Acc: 0.252 Test Loss: 4.187 Test Acc: 0.252
Validation loss decreased (-0.250547 --> -0.251723).  Saving model ...
Epoch: 45 cost time: 1.0965287685394287
Epoch: 45, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.199 Vali Acc: 0.256 Test Loss: 4.199 Test Acc: 0.256
Validation loss decreased (-0.251723 --> -0.256429).  Saving model ...
Epoch: 46 cost time: 1.2973973751068115
Epoch: 46, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.209 Vali Acc: 0.262 Test Loss: 4.209 Test Acc: 0.262
Validation loss decreased (-0.256429 --> -0.262311).  Saving model ...
Epoch: 47 cost time: 1.178419589996338
Epoch: 47, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.243 Vali Acc: 0.261 Test Loss: 4.243 Test Acc: 0.261
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.228431224822998
Epoch: 48, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.285 Vali Acc: 0.253 Test Loss: 4.285 Test Acc: 0.253
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.297788381576538
Epoch: 49, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.317 Vali Acc: 0.252 Test Loss: 4.317 Test Acc: 0.252
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.156477928161621
Epoch: 50, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.340 Vali Acc: 0.251 Test Loss: 4.340 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26235294117647057
model parameter : 337306
model size : 1.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps38_str19_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.8512699604034424
Epoch: 1, Steps: 10 | Train Loss: 3.313 Vali Loss: 3.278 Vali Acc: 0.033 Test Loss: 3.278 Test Acc: 0.033
Validation loss decreased (inf --> -0.032908).  Saving model ...
Epoch: 2 cost time: 1.1675114631652832
Epoch: 2, Steps: 10 | Train Loss: 3.265 Vali Loss: 3.279 Vali Acc: 0.028 Test Loss: 3.279 Test Acc: 0.028
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3363490104675293
Epoch: 3, Steps: 10 | Train Loss: 3.232 Vali Loss: 3.276 Vali Acc: 0.025 Test Loss: 3.276 Test Acc: 0.025
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.383941888809204
Epoch: 4, Steps: 10 | Train Loss: 3.161 Vali Loss: 3.269 Vali Acc: 0.033 Test Loss: 3.269 Test Acc: 0.033
Validation loss decreased (-0.032908 --> -0.032908).  Saving model ...
Epoch: 5 cost time: 1.3854014873504639
Epoch: 5, Steps: 10 | Train Loss: 3.096 Vali Loss: 3.261 Vali Acc: 0.044 Test Loss: 3.261 Test Acc: 0.044
Validation loss decreased (-0.032908 --> -0.043497).  Saving model ...
Epoch: 6 cost time: 1.3841791152954102
Epoch: 6, Steps: 10 | Train Loss: 3.007 Vali Loss: 3.255 Vali Acc: 0.048 Test Loss: 3.255 Test Acc: 0.048
Validation loss decreased (-0.043497 --> -0.048203).  Saving model ...
Epoch: 7 cost time: 1.330519199371338
Epoch: 7, Steps: 10 | Train Loss: 2.944 Vali Loss: 3.249 Vali Acc: 0.058 Test Loss: 3.249 Test Acc: 0.058
Validation loss decreased (-0.048203 --> -0.057615).  Saving model ...
Epoch: 8 cost time: 1.4469718933105469
Epoch: 8, Steps: 10 | Train Loss: 2.871 Vali Loss: 3.245 Vali Acc: 0.072 Test Loss: 3.245 Test Acc: 0.072
Validation loss decreased (-0.057615 --> -0.071732).  Saving model ...
Epoch: 9 cost time: 1.27284574508667
Epoch: 9, Steps: 10 | Train Loss: 2.756 Vali Loss: 3.239 Vali Acc: 0.088 Test Loss: 3.239 Test Acc: 0.088
Validation loss decreased (-0.071732 --> -0.088203).  Saving model ...
Epoch: 10 cost time: 1.0599572658538818
Epoch: 10, Steps: 10 | Train Loss: 2.666 Vali Loss: 3.232 Vali Acc: 0.096 Test Loss: 3.232 Test Acc: 0.096
Validation loss decreased (-0.088203 --> -0.096438).  Saving model ...
Epoch: 11 cost time: 1.2714176177978516
Epoch: 11, Steps: 10 | Train Loss: 2.572 Vali Loss: 3.226 Vali Acc: 0.101 Test Loss: 3.226 Test Acc: 0.101
Validation loss decreased (-0.096438 --> -0.101144).  Saving model ...
Epoch: 12 cost time: 1.241715669631958
Epoch: 12, Steps: 10 | Train Loss: 2.449 Vali Loss: 3.222 Vali Acc: 0.121 Test Loss: 3.222 Test Acc: 0.121
Validation loss decreased (-0.101144 --> -0.121144).  Saving model ...
Epoch: 13 cost time: 1.4490718841552734
Epoch: 13, Steps: 10 | Train Loss: 2.310 Vali Loss: 3.218 Vali Acc: 0.140 Test Loss: 3.218 Test Acc: 0.140
Validation loss decreased (-0.121144 --> -0.139968).  Saving model ...
Epoch: 14 cost time: 1.2186496257781982
Epoch: 14, Steps: 10 | Train Loss: 2.221 Vali Loss: 3.211 Vali Acc: 0.148 Test Loss: 3.211 Test Acc: 0.148
Validation loss decreased (-0.139968 --> -0.148203).  Saving model ...
Epoch: 15 cost time: 1.0741233825683594
Epoch: 15, Steps: 10 | Train Loss: 2.069 Vali Loss: 3.204 Vali Acc: 0.160 Test Loss: 3.204 Test Acc: 0.160
Validation loss decreased (-0.148203 --> -0.159968).  Saving model ...
Epoch: 16 cost time: 1.2450294494628906
Epoch: 16, Steps: 10 | Train Loss: 1.931 Vali Loss: 3.205 Vali Acc: 0.161 Test Loss: 3.205 Test Acc: 0.161
Validation loss decreased (-0.159968 --> -0.161144).  Saving model ...
Epoch: 17 cost time: 1.1878154277801514
Epoch: 17, Steps: 10 | Train Loss: 1.754 Vali Loss: 3.199 Vali Acc: 0.172 Test Loss: 3.199 Test Acc: 0.172
Validation loss decreased (-0.161144 --> -0.171733).  Saving model ...
Epoch: 18 cost time: 1.1003150939941406
Epoch: 18, Steps: 10 | Train Loss: 1.591 Vali Loss: 3.206 Vali Acc: 0.172 Test Loss: 3.206 Test Acc: 0.172
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2815356254577637
Epoch: 19, Steps: 10 | Train Loss: 1.459 Vali Loss: 3.212 Vali Acc: 0.182 Test Loss: 3.212 Test Acc: 0.182
Validation loss decreased (-0.171733 --> -0.182321).  Saving model ...
Epoch: 20 cost time: 1.557631254196167
Epoch: 20, Steps: 10 | Train Loss: 1.301 Vali Loss: 3.233 Vali Acc: 0.189 Test Loss: 3.233 Test Acc: 0.189
Validation loss decreased (-0.182321 --> -0.189379).  Saving model ...
Epoch: 21 cost time: 1.537360668182373
Epoch: 21, Steps: 10 | Train Loss: 1.148 Vali Loss: 3.253 Vali Acc: 0.201 Test Loss: 3.253 Test Acc: 0.201
Validation loss decreased (-0.189379 --> -0.201144).  Saving model ...
Epoch: 22 cost time: 1.274420976638794
Epoch: 22, Steps: 10 | Train Loss: 0.967 Vali Loss: 3.279 Vali Acc: 0.207 Test Loss: 3.279 Test Acc: 0.207
Validation loss decreased (-0.201144 --> -0.207026).  Saving model ...
Epoch: 23 cost time: 1.3143947124481201
Epoch: 23, Steps: 10 | Train Loss: 0.865 Vali Loss: 3.309 Vali Acc: 0.224 Test Loss: 3.309 Test Acc: 0.224
Validation loss decreased (-0.207026 --> -0.223496).  Saving model ...
Epoch: 24 cost time: 1.4307518005371094
Epoch: 24, Steps: 10 | Train Loss: 0.701 Vali Loss: 3.348 Vali Acc: 0.225 Test Loss: 3.348 Test Acc: 0.225
Validation loss decreased (-0.223496 --> -0.224672).  Saving model ...
Epoch: 25 cost time: 1.474219799041748
Epoch: 25, Steps: 10 | Train Loss: 0.601 Vali Loss: 3.379 Vali Acc: 0.220 Test Loss: 3.379 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.5053625106811523
Epoch: 26, Steps: 10 | Train Loss: 0.507 Vali Loss: 3.441 Vali Acc: 0.232 Test Loss: 3.441 Test Acc: 0.232
Validation loss decreased (-0.224672 --> -0.231730).  Saving model ...
Epoch: 27 cost time: 1.3920645713806152
Epoch: 27, Steps: 10 | Train Loss: 0.427 Vali Loss: 3.492 Vali Acc: 0.233 Test Loss: 3.492 Test Acc: 0.233
Validation loss decreased (-0.231730 --> -0.232906).  Saving model ...
Epoch: 28 cost time: 1.334709644317627
Epoch: 28, Steps: 10 | Train Loss: 0.354 Vali Loss: 3.526 Vali Acc: 0.229 Test Loss: 3.526 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.3973004817962646
Epoch: 29, Steps: 10 | Train Loss: 0.299 Vali Loss: 3.574 Vali Acc: 0.228 Test Loss: 3.574 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.483691930770874
Epoch: 30, Steps: 10 | Train Loss: 0.279 Vali Loss: 3.655 Vali Acc: 0.220 Test Loss: 3.655 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.412947654724121
Epoch: 31, Steps: 10 | Train Loss: 0.192 Vali Loss: 3.699 Vali Acc: 0.225 Test Loss: 3.699 Test Acc: 0.225
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.3952691555023193
Epoch: 32, Steps: 10 | Train Loss: 0.161 Vali Loss: 3.761 Vali Acc: 0.227 Test Loss: 3.761 Test Acc: 0.227
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.2565686702728271
Epoch: 33, Steps: 10 | Train Loss: 0.150 Vali Loss: 3.785 Vali Acc: 0.231 Test Loss: 3.785 Test Acc: 0.231
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.482180118560791
Epoch: 34, Steps: 10 | Train Loss: 0.133 Vali Loss: 3.842 Vali Acc: 0.234 Test Loss: 3.842 Test Acc: 0.234
Validation loss decreased (-0.232906 --> -0.234079).  Saving model ...
Epoch: 35 cost time: 1.4719245433807373
Epoch: 35, Steps: 10 | Train Loss: 0.115 Vali Loss: 3.892 Vali Acc: 0.225 Test Loss: 3.892 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.073512554168701
Epoch: 36, Steps: 10 | Train Loss: 0.108 Vali Loss: 3.945 Vali Acc: 0.227 Test Loss: 3.945 Test Acc: 0.227
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.3000428676605225
Epoch: 37, Steps: 10 | Train Loss: 0.107 Vali Loss: 4.003 Vali Acc: 0.231 Test Loss: 4.003 Test Acc: 0.231
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.3311727046966553
Epoch: 38, Steps: 10 | Train Loss: 0.074 Vali Loss: 4.017 Vali Acc: 0.233 Test Loss: 4.017 Test Acc: 0.233
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.6201982498168945
Epoch: 39, Steps: 10 | Train Loss: 0.072 Vali Loss: 4.052 Vali Acc: 0.229 Test Loss: 4.052 Test Acc: 0.229
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.3929686546325684
Epoch: 40, Steps: 10 | Train Loss: 0.058 Vali Loss: 4.094 Vali Acc: 0.227 Test Loss: 4.094 Test Acc: 0.227
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.2727060317993164
Epoch: 41, Steps: 10 | Train Loss: 0.054 Vali Loss: 4.123 Vali Acc: 0.226 Test Loss: 4.123 Test Acc: 0.226
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.3290653228759766
Epoch: 42, Steps: 10 | Train Loss: 0.048 Vali Loss: 4.174 Vali Acc: 0.232 Test Loss: 4.174 Test Acc: 0.232
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 1.4195866584777832
Epoch: 43, Steps: 10 | Train Loss: 0.045 Vali Loss: 4.216 Vali Acc: 0.235 Test Loss: 4.216 Test Acc: 0.235
Validation loss decreased (-0.234079 --> -0.235252).  Saving model ...
Epoch: 44 cost time: 1.2507593631744385
Epoch: 44, Steps: 10 | Train Loss: 0.038 Vali Loss: 4.231 Vali Acc: 0.233 Test Loss: 4.231 Test Acc: 0.233
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.322662353515625
Epoch: 45, Steps: 10 | Train Loss: 0.037 Vali Loss: 4.251 Vali Acc: 0.233 Test Loss: 4.251 Test Acc: 0.233
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.336271047592163
Epoch: 46, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.286 Vali Acc: 0.238 Test Loss: 4.286 Test Acc: 0.238
Validation loss decreased (-0.235252 --> -0.237604).  Saving model ...
Epoch: 47 cost time: 1.5881328582763672
Epoch: 47, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.313 Vali Acc: 0.231 Test Loss: 4.313 Test Acc: 0.231
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.3896949291229248
Epoch: 48, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.340 Vali Acc: 0.236 Test Loss: 4.340 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.3597819805145264
Epoch: 49, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.351 Vali Acc: 0.238 Test Loss: 4.351 Test Acc: 0.238
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.3304052352905273
Epoch: 50, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.403 Vali Acc: 0.236 Test Loss: 4.403 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps38_str19_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2376470588235294
model parameter : 327546
model size : 1.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.6651742458343506
Epoch: 1, Steps: 10 | Train Loss: 3.280 Vali Loss: 3.256 Vali Acc: 0.047 Test Loss: 3.256 Test Acc: 0.047
Validation loss decreased (inf --> -0.047026).  Saving model ...
Epoch: 2 cost time: 1.2728445529937744
Epoch: 2, Steps: 10 | Train Loss: 3.161 Vali Loss: 3.251 Vali Acc: 0.053 Test Loss: 3.251 Test Acc: 0.053
Validation loss decreased (-0.047026 --> -0.052909).  Saving model ...
Epoch: 3 cost time: 1.2367665767669678
Epoch: 3, Steps: 10 | Train Loss: 2.994 Vali Loss: 3.261 Vali Acc: 0.056 Test Loss: 3.261 Test Acc: 0.056
Validation loss decreased (-0.052909 --> -0.056438).  Saving model ...
Epoch: 4 cost time: 1.7249715328216553
Epoch: 4, Steps: 10 | Train Loss: 2.763 Vali Loss: 3.252 Vali Acc: 0.101 Test Loss: 3.252 Test Acc: 0.101
Validation loss decreased (-0.056438 --> -0.101144).  Saving model ...
Epoch: 5 cost time: 1.671696424484253
Epoch: 5, Steps: 10 | Train Loss: 2.490 Vali Loss: 3.225 Vali Acc: 0.111 Test Loss: 3.225 Test Acc: 0.111
Validation loss decreased (-0.101144 --> -0.110556).  Saving model ...
Epoch: 6 cost time: 1.5194506645202637
Epoch: 6, Steps: 10 | Train Loss: 2.164 Vali Loss: 3.208 Vali Acc: 0.140 Test Loss: 3.208 Test Acc: 0.140
Validation loss decreased (-0.110556 --> -0.139968).  Saving model ...
Epoch: 7 cost time: 1.407782793045044
Epoch: 7, Steps: 10 | Train Loss: 1.760 Vali Loss: 3.186 Vali Acc: 0.164 Test Loss: 3.186 Test Acc: 0.164
Validation loss decreased (-0.139968 --> -0.163498).  Saving model ...
Epoch: 8 cost time: 1.7150132656097412
Epoch: 8, Steps: 10 | Train Loss: 1.353 Vali Loss: 3.207 Vali Acc: 0.186 Test Loss: 3.207 Test Acc: 0.186
Validation loss decreased (-0.163498 --> -0.185850).  Saving model ...
Epoch: 9 cost time: 1.6178326606750488
Epoch: 9, Steps: 10 | Train Loss: 0.921 Vali Loss: 3.284 Vali Acc: 0.222 Test Loss: 3.284 Test Acc: 0.222
Validation loss decreased (-0.185850 --> -0.222320).  Saving model ...
Epoch: 10 cost time: 1.724940299987793
Epoch: 10, Steps: 10 | Train Loss: 0.608 Vali Loss: 3.412 Vali Acc: 0.241 Test Loss: 3.412 Test Acc: 0.241
Validation loss decreased (-0.222320 --> -0.241142).  Saving model ...
Epoch: 11 cost time: 1.4583139419555664
Epoch: 11, Steps: 10 | Train Loss: 0.382 Vali Loss: 3.510 Vali Acc: 0.247 Test Loss: 3.510 Test Acc: 0.247
Validation loss decreased (-0.241142 --> -0.247024).  Saving model ...
Epoch: 12 cost time: 1.3855969905853271
Epoch: 12, Steps: 10 | Train Loss: 0.211 Vali Loss: 3.712 Vali Acc: 0.262 Test Loss: 3.712 Test Acc: 0.262
Validation loss decreased (-0.247024 --> -0.262316).  Saving model ...
Epoch: 13 cost time: 1.5174331665039062
Epoch: 13, Steps: 10 | Train Loss: 0.118 Vali Loss: 3.914 Vali Acc: 0.265 Test Loss: 3.914 Test Acc: 0.265
Validation loss decreased (-0.262316 --> -0.264667).  Saving model ...
Epoch: 14 cost time: 1.7245845794677734
Epoch: 14, Steps: 10 | Train Loss: 0.061 Vali Loss: 4.049 Vali Acc: 0.262 Test Loss: 4.049 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7223725318908691
Epoch: 15, Steps: 10 | Train Loss: 0.043 Vali Loss: 4.126 Vali Acc: 0.265 Test Loss: 4.126 Test Acc: 0.265
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.616647481918335
Epoch: 16, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.192 Vali Acc: 0.269 Test Loss: 4.192 Test Acc: 0.269
Validation loss decreased (-0.264667 --> -0.269370).  Saving model ...
Epoch: 17 cost time: 1.5056750774383545
Epoch: 17, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.246 Vali Acc: 0.269 Test Loss: 4.246 Test Acc: 0.269
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.5303781032562256
Epoch: 18, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.317 Vali Acc: 0.267 Test Loss: 4.317 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.5204155445098877
Epoch: 19, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.372 Vali Acc: 0.269 Test Loss: 4.372 Test Acc: 0.269
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.5107152462005615
Epoch: 20, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.433 Vali Acc: 0.266 Test Loss: 4.433 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.5268096923828125
Epoch: 21, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.481 Vali Acc: 0.265 Test Loss: 4.481 Test Acc: 0.265
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.5388095378875732
Epoch: 22, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.512 Vali Acc: 0.264 Test Loss: 4.512 Test Acc: 0.264
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.7212698459625244
Epoch: 23, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.536 Vali Acc: 0.264 Test Loss: 4.536 Test Acc: 0.264
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.7477478981018066
Epoch: 24, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.575 Vali Acc: 0.264 Test Loss: 4.575 Test Acc: 0.264
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.608656883239746
Epoch: 25, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.600 Vali Acc: 0.267 Test Loss: 4.600 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.8065524101257324
Epoch: 26, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.628 Vali Acc: 0.267 Test Loss: 4.628 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26941176470588235
model parameter : 493498
model size : 1.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.474519968032837
Epoch: 1, Steps: 10 | Train Loss: 3.297 Vali Loss: 3.256 Vali Acc: 0.047 Test Loss: 3.256 Test Acc: 0.047
Validation loss decreased (inf --> -0.047026).  Saving model ...
Epoch: 2 cost time: 1.7317874431610107
Epoch: 2, Steps: 10 | Train Loss: 3.202 Vali Loss: 3.250 Vali Acc: 0.056 Test Loss: 3.250 Test Acc: 0.056
Validation loss decreased (-0.047026 --> -0.056438).  Saving model ...
Epoch: 3 cost time: 1.579702615737915
Epoch: 3, Steps: 10 | Train Loss: 3.099 Vali Loss: 3.252 Vali Acc: 0.066 Test Loss: 3.252 Test Acc: 0.066
Validation loss decreased (-0.056438 --> -0.065850).  Saving model ...
Epoch: 4 cost time: 1.7976837158203125
Epoch: 4, Steps: 10 | Train Loss: 2.949 Vali Loss: 3.252 Vali Acc: 0.081 Test Loss: 3.252 Test Acc: 0.081
Validation loss decreased (-0.065850 --> -0.081144).  Saving model ...
Epoch: 5 cost time: 1.6272594928741455
Epoch: 5, Steps: 10 | Train Loss: 2.806 Vali Loss: 3.245 Vali Acc: 0.088 Test Loss: 3.245 Test Acc: 0.088
Validation loss decreased (-0.081144 --> -0.088203).  Saving model ...
Epoch: 6 cost time: 1.5059199333190918
Epoch: 6, Steps: 10 | Train Loss: 2.613 Vali Loss: 3.229 Vali Acc: 0.102 Test Loss: 3.229 Test Acc: 0.102
Validation loss decreased (-0.088203 --> -0.102321).  Saving model ...
Epoch: 7 cost time: 1.5547993183135986
Epoch: 7, Steps: 10 | Train Loss: 2.408 Vali Loss: 3.211 Vali Acc: 0.111 Test Loss: 3.211 Test Acc: 0.111
Validation loss decreased (-0.102321 --> -0.110556).  Saving model ...
Epoch: 8 cost time: 1.6490254402160645
Epoch: 8, Steps: 10 | Train Loss: 2.169 Vali Loss: 3.196 Vali Acc: 0.132 Test Loss: 3.196 Test Acc: 0.132
Validation loss decreased (-0.110556 --> -0.131733).  Saving model ...
Epoch: 9 cost time: 1.728839635848999
Epoch: 9, Steps: 10 | Train Loss: 1.927 Vali Loss: 3.176 Vali Acc: 0.147 Test Loss: 3.176 Test Acc: 0.147
Validation loss decreased (-0.131733 --> -0.147027).  Saving model ...
Epoch: 10 cost time: 1.4173450469970703
Epoch: 10, Steps: 10 | Train Loss: 1.647 Vali Loss: 3.177 Vali Acc: 0.176 Test Loss: 3.177 Test Acc: 0.176
Validation loss decreased (-0.147027 --> -0.176439).  Saving model ...
Epoch: 11 cost time: 1.6750166416168213
Epoch: 11, Steps: 10 | Train Loss: 1.347 Vali Loss: 3.198 Vali Acc: 0.191 Test Loss: 3.198 Test Acc: 0.191
Validation loss decreased (-0.176439 --> -0.190556).  Saving model ...
Epoch: 12 cost time: 1.5196559429168701
Epoch: 12, Steps: 10 | Train Loss: 1.053 Vali Loss: 3.235 Vali Acc: 0.215 Test Loss: 3.235 Test Acc: 0.215
Validation loss decreased (-0.190556 --> -0.215262).  Saving model ...
Epoch: 13 cost time: 1.3063526153564453
Epoch: 13, Steps: 10 | Train Loss: 0.767 Vali Loss: 3.322 Vali Acc: 0.215 Test Loss: 3.322 Test Acc: 0.215
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4249017238616943
Epoch: 14, Steps: 10 | Train Loss: 0.548 Vali Loss: 3.419 Vali Acc: 0.235 Test Loss: 3.419 Test Acc: 0.235
Validation loss decreased (-0.215262 --> -0.235260).  Saving model ...
Epoch: 15 cost time: 1.3054285049438477
Epoch: 15, Steps: 10 | Train Loss: 0.371 Vali Loss: 3.519 Vali Acc: 0.248 Test Loss: 3.519 Test Acc: 0.248
Validation loss decreased (-0.235260 --> -0.248200).  Saving model ...
Epoch: 16 cost time: 1.685256004333496
Epoch: 16, Steps: 10 | Train Loss: 0.270 Vali Loss: 3.637 Vali Acc: 0.254 Test Loss: 3.637 Test Acc: 0.254
Validation loss decreased (-0.248200 --> -0.254081).  Saving model ...
Epoch: 17 cost time: 1.6394267082214355
Epoch: 17, Steps: 10 | Train Loss: 0.178 Vali Loss: 3.749 Vali Acc: 0.264 Test Loss: 3.749 Test Acc: 0.264
Validation loss decreased (-0.254081 --> -0.263492).  Saving model ...
Epoch: 18 cost time: 1.6461524963378906
Epoch: 18, Steps: 10 | Train Loss: 0.111 Vali Loss: 3.845 Vali Acc: 0.267 Test Loss: 3.845 Test Acc: 0.267
Validation loss decreased (-0.263492 --> -0.267020).  Saving model ...
Epoch: 19 cost time: 1.5273411273956299
Epoch: 19, Steps: 10 | Train Loss: 0.083 Vali Loss: 3.926 Vali Acc: 0.266 Test Loss: 3.926 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.9218366146087646
Epoch: 20, Steps: 10 | Train Loss: 0.064 Vali Loss: 4.015 Vali Acc: 0.272 Test Loss: 4.015 Test Acc: 0.272
Validation loss decreased (-0.267020 --> -0.271725).  Saving model ...
Epoch: 21 cost time: 1.9494678974151611
Epoch: 21, Steps: 10 | Train Loss: 0.044 Vali Loss: 4.078 Vali Acc: 0.271 Test Loss: 4.078 Test Acc: 0.271
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.3235018253326416
Epoch: 22, Steps: 10 | Train Loss: 0.039 Vali Loss: 4.159 Vali Acc: 0.266 Test Loss: 4.159 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.6400361061096191
Epoch: 23, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.199 Vali Acc: 0.274 Test Loss: 4.199 Test Acc: 0.274
Validation loss decreased (-0.271725 --> -0.274076).  Saving model ...
Epoch: 24 cost time: 2.3042681217193604
Epoch: 24, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.225 Vali Acc: 0.276 Test Loss: 4.225 Test Acc: 0.276
Validation loss decreased (-0.274076 --> -0.276428).  Saving model ...
Epoch: 25 cost time: 1.8739643096923828
Epoch: 25, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.276 Vali Acc: 0.276 Test Loss: 4.276 Test Acc: 0.276
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.8094360828399658
Epoch: 26, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.322 Vali Acc: 0.281 Test Loss: 4.322 Test Acc: 0.281
Validation loss decreased (-0.276428 --> -0.281133).  Saving model ...
Epoch: 27 cost time: 1.1711628437042236
Epoch: 27, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.364 Vali Acc: 0.281 Test Loss: 4.364 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.4971179962158203
Epoch: 28, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.399 Vali Acc: 0.279 Test Loss: 4.399 Test Acc: 0.279
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.989001750946045
Epoch: 29, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.429 Vali Acc: 0.280 Test Loss: 4.429 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.4270844459533691
Epoch: 30, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.466 Vali Acc: 0.281 Test Loss: 4.466 Test Acc: 0.281
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.918078899383545
Epoch: 31, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.504 Vali Acc: 0.275 Test Loss: 4.504 Test Acc: 0.275
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.564042091369629
Epoch: 32, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.550 Vali Acc: 0.275 Test Loss: 4.550 Test Acc: 0.275
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.6283891201019287
Epoch: 33, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.578 Vali Acc: 0.281 Test Loss: 4.578 Test Acc: 0.281
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.6456313133239746
Epoch: 34, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.603 Vali Acc: 0.274 Test Loss: 4.603 Test Acc: 0.274
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.8136382102966309
Epoch: 35, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.637 Vali Acc: 0.275 Test Loss: 4.637 Test Acc: 0.275
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.500730037689209
Epoch: 36, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.664 Vali Acc: 0.276 Test Loss: 4.664 Test Acc: 0.276
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2811764705882353
model parameter : 403770
model size : 1.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps12_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.619300365447998
Epoch: 1, Steps: 10 | Train Loss: 3.290 Vali Loss: 3.263 Vali Acc: 0.041 Test Loss: 3.263 Test Acc: 0.041
Validation loss decreased (inf --> -0.041144).  Saving model ...
Epoch: 2 cost time: 1.567030906677246
Epoch: 2, Steps: 10 | Train Loss: 3.214 Vali Loss: 3.260 Vali Acc: 0.048 Test Loss: 3.260 Test Acc: 0.048
Validation loss decreased (-0.041144 --> -0.048203).  Saving model ...
Epoch: 3 cost time: 1.686046838760376
Epoch: 3, Steps: 10 | Train Loss: 3.135 Vali Loss: 3.257 Vali Acc: 0.061 Test Loss: 3.257 Test Acc: 0.061
Validation loss decreased (-0.048203 --> -0.061144).  Saving model ...
Epoch: 4 cost time: 1.3605165481567383
Epoch: 4, Steps: 10 | Train Loss: 3.023 Vali Loss: 3.257 Vali Acc: 0.062 Test Loss: 3.257 Test Acc: 0.062
Validation loss decreased (-0.061144 --> -0.062320).  Saving model ...
Epoch: 5 cost time: 1.336789846420288
Epoch: 5, Steps: 10 | Train Loss: 2.892 Vali Loss: 3.260 Vali Acc: 0.074 Test Loss: 3.260 Test Acc: 0.074
Validation loss decreased (-0.062320 --> -0.074085).  Saving model ...
Epoch: 6 cost time: 1.35105299949646
Epoch: 6, Steps: 10 | Train Loss: 2.760 Vali Loss: 3.253 Vali Acc: 0.084 Test Loss: 3.253 Test Acc: 0.084
Validation loss decreased (-0.074085 --> -0.083497).  Saving model ...
Epoch: 7 cost time: 1.55226469039917
Epoch: 7, Steps: 10 | Train Loss: 2.572 Vali Loss: 3.241 Vali Acc: 0.093 Test Loss: 3.241 Test Acc: 0.093
Validation loss decreased (-0.083497 --> -0.092909).  Saving model ...
Epoch: 8 cost time: 1.221888542175293
Epoch: 8, Steps: 10 | Train Loss: 2.415 Vali Loss: 3.226 Vali Acc: 0.105 Test Loss: 3.226 Test Acc: 0.105
Validation loss decreased (-0.092909 --> -0.104674).  Saving model ...
Epoch: 9 cost time: 1.381237506866455
Epoch: 9, Steps: 10 | Train Loss: 2.219 Vali Loss: 3.213 Vali Acc: 0.116 Test Loss: 3.213 Test Acc: 0.116
Validation loss decreased (-0.104674 --> -0.116438).  Saving model ...
Epoch: 10 cost time: 1.3870456218719482
Epoch: 10, Steps: 10 | Train Loss: 2.006 Vali Loss: 3.206 Vali Acc: 0.133 Test Loss: 3.206 Test Acc: 0.133
Validation loss decreased (-0.116438 --> -0.132909).  Saving model ...
Epoch: 11 cost time: 1.415632724761963
Epoch: 11, Steps: 10 | Train Loss: 1.751 Vali Loss: 3.197 Vali Acc: 0.154 Test Loss: 3.197 Test Acc: 0.154
Validation loss decreased (-0.132909 --> -0.154086).  Saving model ...
Epoch: 12 cost time: 1.5527982711791992
Epoch: 12, Steps: 10 | Train Loss: 1.494 Vali Loss: 3.207 Vali Acc: 0.165 Test Loss: 3.207 Test Acc: 0.165
Validation loss decreased (-0.154086 --> -0.164674).  Saving model ...
Epoch: 13 cost time: 1.2629122734069824
Epoch: 13, Steps: 10 | Train Loss: 1.252 Vali Loss: 3.235 Vali Acc: 0.180 Test Loss: 3.235 Test Acc: 0.180
Validation loss decreased (-0.164674 --> -0.179968).  Saving model ...
Epoch: 14 cost time: 1.5096614360809326
Epoch: 14, Steps: 10 | Train Loss: 1.036 Vali Loss: 3.274 Vali Acc: 0.195 Test Loss: 3.274 Test Acc: 0.195
Validation loss decreased (-0.179968 --> -0.195261).  Saving model ...
Epoch: 15 cost time: 1.6387553215026855
Epoch: 15, Steps: 10 | Train Loss: 0.809 Vali Loss: 3.327 Vali Acc: 0.199 Test Loss: 3.327 Test Acc: 0.199
Validation loss decreased (-0.195261 --> -0.198790).  Saving model ...
Epoch: 16 cost time: 1.386932134628296
Epoch: 16, Steps: 10 | Train Loss: 0.629 Vali Loss: 3.390 Vali Acc: 0.206 Test Loss: 3.390 Test Acc: 0.206
Validation loss decreased (-0.198790 --> -0.205848).  Saving model ...
Epoch: 17 cost time: 1.624976634979248
Epoch: 17, Steps: 10 | Train Loss: 0.456 Vali Loss: 3.469 Vali Acc: 0.218 Test Loss: 3.469 Test Acc: 0.218
Validation loss decreased (-0.205848 --> -0.217612).  Saving model ...
Epoch: 18 cost time: 1.7442975044250488
Epoch: 18, Steps: 10 | Train Loss: 0.338 Vali Loss: 3.566 Vali Acc: 0.226 Test Loss: 3.566 Test Acc: 0.226
Validation loss decreased (-0.217612 --> -0.225847).  Saving model ...
Epoch: 19 cost time: 1.554621696472168
Epoch: 19, Steps: 10 | Train Loss: 0.234 Vali Loss: 3.659 Vali Acc: 0.231 Test Loss: 3.659 Test Acc: 0.231
Validation loss decreased (-0.225847 --> -0.230552).  Saving model ...
Epoch: 20 cost time: 1.492340326309204
Epoch: 20, Steps: 10 | Train Loss: 0.178 Vali Loss: 3.752 Vali Acc: 0.229 Test Loss: 3.752 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2506325244903564
Epoch: 21, Steps: 10 | Train Loss: 0.141 Vali Loss: 3.826 Vali Acc: 0.234 Test Loss: 3.826 Test Acc: 0.234
Validation loss decreased (-0.230552 --> -0.234079).  Saving model ...
Epoch: 22 cost time: 1.4696204662322998
Epoch: 22, Steps: 10 | Train Loss: 0.098 Vali Loss: 3.908 Vali Acc: 0.236 Test Loss: 3.908 Test Acc: 0.236
Validation loss decreased (-0.234079 --> -0.236432).  Saving model ...
Epoch: 23 cost time: 1.8306386470794678
Epoch: 23, Steps: 10 | Train Loss: 0.086 Vali Loss: 3.973 Vali Acc: 0.241 Test Loss: 3.973 Test Acc: 0.241
Validation loss decreased (-0.236432 --> -0.241137).  Saving model ...
Epoch: 24 cost time: 1.5894057750701904
Epoch: 24, Steps: 10 | Train Loss: 0.068 Vali Loss: 4.042 Vali Acc: 0.234 Test Loss: 4.042 Test Acc: 0.234
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.5834338665008545
Epoch: 25, Steps: 10 | Train Loss: 0.056 Vali Loss: 4.077 Vali Acc: 0.234 Test Loss: 4.077 Test Acc: 0.234
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.6414830684661865
Epoch: 26, Steps: 10 | Train Loss: 0.046 Vali Loss: 4.119 Vali Acc: 0.240 Test Loss: 4.119 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.763026237487793
Epoch: 27, Steps: 10 | Train Loss: 0.041 Vali Loss: 4.153 Vali Acc: 0.244 Test Loss: 4.153 Test Acc: 0.244
Validation loss decreased (-0.241137 --> -0.243488).  Saving model ...
Epoch: 28 cost time: 1.3939950466156006
Epoch: 28, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.216 Vali Acc: 0.239 Test Loss: 4.216 Test Acc: 0.239
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.6416733264923096
Epoch: 29, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.275 Vali Acc: 0.245 Test Loss: 4.275 Test Acc: 0.245
Validation loss decreased (-0.243488 --> -0.244663).  Saving model ...
Epoch: 30 cost time: 1.5718393325805664
Epoch: 30, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.317 Vali Acc: 0.244 Test Loss: 4.317 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.7624289989471436
Epoch: 31, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.322 Vali Acc: 0.245 Test Loss: 4.322 Test Acc: 0.245
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.5546784400939941
Epoch: 32, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.352 Vali Acc: 0.242 Test Loss: 4.352 Test Acc: 0.242
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.5894503593444824
Epoch: 33, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.376 Vali Acc: 0.241 Test Loss: 4.376 Test Acc: 0.241
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.4813172817230225
Epoch: 34, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.414 Vali Acc: 0.245 Test Loss: 4.414 Test Acc: 0.245
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.4011285305023193
Epoch: 35, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.437 Vali Acc: 0.246 Test Loss: 4.437 Test Acc: 0.246
Validation loss decreased (-0.244663 --> -0.245838).  Saving model ...
Epoch: 36 cost time: 1.6465070247650146
Epoch: 36, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.488 Vali Acc: 0.244 Test Loss: 4.488 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.5043830871582031
Epoch: 37, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.512 Vali Acc: 0.244 Test Loss: 4.512 Test Acc: 0.244
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.4020519256591797
Epoch: 38, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.536 Vali Acc: 0.244 Test Loss: 4.536 Test Acc: 0.244
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.6532914638519287
Epoch: 39, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.560 Vali Acc: 0.242 Test Loss: 4.560 Test Acc: 0.242
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.1777524948120117
Epoch: 40, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.576 Vali Acc: 0.244 Test Loss: 4.576 Test Acc: 0.244
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 2.100689649581909
Epoch: 41, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.611 Vali Acc: 0.240 Test Loss: 4.611 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.6997923851013184
Epoch: 42, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.644 Vali Acc: 0.240 Test Loss: 4.644 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.5434889793395996
Epoch: 43, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.662 Vali Acc: 0.242 Test Loss: 4.662 Test Acc: 0.242
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.4416146278381348
Epoch: 44, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.687 Vali Acc: 0.242 Test Loss: 4.687 Test Acc: 0.242
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 1.4517171382904053
Epoch: 45, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.707 Vali Acc: 0.247 Test Loss: 4.707 Test Acc: 0.247
Validation loss decreased (-0.245838 --> -0.247012).  Saving model ...
Epoch: 46 cost time: 1.4033784866333008
Epoch: 46, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.721 Vali Acc: 0.246 Test Loss: 4.721 Test Acc: 0.246
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.4787852764129639
Epoch: 47, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.733 Vali Acc: 0.246 Test Loss: 4.733 Test Acc: 0.246
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.7641777992248535
Epoch: 48, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.767 Vali Acc: 0.246 Test Loss: 4.767 Test Acc: 0.246
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.475510597229004
Epoch: 49, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.770 Vali Acc: 0.246 Test Loss: 4.770 Test Acc: 0.246
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 1.364762544631958
Epoch: 50, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.797 Vali Acc: 0.247 Test Loss: 4.797 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps12_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.24705882352941178
model parameter : 373946
model size : 1.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.374735593795776
Epoch: 1, Steps: 10 | Train Loss: 3.291 Vali Loss: 3.256 Vali Acc: 0.039 Test Loss: 3.256 Test Acc: 0.039
Validation loss decreased (inf --> -0.038791).  Saving model ...
Epoch: 2 cost time: 1.6653220653533936
Epoch: 2, Steps: 10 | Train Loss: 3.243 Vali Loss: 3.249 Vali Acc: 0.040 Test Loss: 3.249 Test Acc: 0.040
Validation loss decreased (-0.038791 --> -0.039968).  Saving model ...
Epoch: 3 cost time: 1.426609992980957
Epoch: 3, Steps: 10 | Train Loss: 3.161 Vali Loss: 3.241 Vali Acc: 0.047 Test Loss: 3.241 Test Acc: 0.047
Validation loss decreased (-0.039968 --> -0.047026).  Saving model ...
Epoch: 4 cost time: 1.3462855815887451
Epoch: 4, Steps: 10 | Train Loss: 3.063 Vali Loss: 3.234 Vali Acc: 0.067 Test Loss: 3.234 Test Acc: 0.067
Validation loss decreased (-0.047026 --> -0.067026).  Saving model ...
Epoch: 5 cost time: 1.5360889434814453
Epoch: 5, Steps: 10 | Train Loss: 2.942 Vali Loss: 3.231 Vali Acc: 0.074 Test Loss: 3.231 Test Acc: 0.074
Validation loss decreased (-0.067026 --> -0.074085).  Saving model ...
Epoch: 6 cost time: 1.2516260147094727
Epoch: 6, Steps: 10 | Train Loss: 2.836 Vali Loss: 3.227 Vali Acc: 0.081 Test Loss: 3.227 Test Acc: 0.081
Validation loss decreased (-0.074085 --> -0.081144).  Saving model ...
Epoch: 7 cost time: 1.2532622814178467
Epoch: 7, Steps: 10 | Train Loss: 2.690 Vali Loss: 3.223 Vali Acc: 0.089 Test Loss: 3.223 Test Acc: 0.089
Validation loss decreased (-0.081144 --> -0.089380).  Saving model ...
Epoch: 8 cost time: 1.635535717010498
Epoch: 8, Steps: 10 | Train Loss: 2.597 Vali Loss: 3.216 Vali Acc: 0.101 Test Loss: 3.216 Test Acc: 0.101
Validation loss decreased (-0.089380 --> -0.101144).  Saving model ...
Epoch: 9 cost time: 1.5649847984313965
Epoch: 9, Steps: 10 | Train Loss: 2.427 Vali Loss: 3.201 Vali Acc: 0.119 Test Loss: 3.201 Test Acc: 0.119
Validation loss decreased (-0.101144 --> -0.118792).  Saving model ...
Epoch: 10 cost time: 1.4190263748168945
Epoch: 10, Steps: 10 | Train Loss: 2.277 Vali Loss: 3.191 Vali Acc: 0.128 Test Loss: 3.191 Test Acc: 0.128
Validation loss decreased (-0.118792 --> -0.128203).  Saving model ...
Epoch: 11 cost time: 1.7354252338409424
Epoch: 11, Steps: 10 | Train Loss: 2.066 Vali Loss: 3.179 Vali Acc: 0.148 Test Loss: 3.179 Test Acc: 0.148
Validation loss decreased (-0.128203 --> -0.148204).  Saving model ...
Epoch: 12 cost time: 1.4011282920837402
Epoch: 12, Steps: 10 | Train Loss: 1.871 Vali Loss: 3.170 Vali Acc: 0.160 Test Loss: 3.170 Test Acc: 0.160
Validation loss decreased (-0.148204 --> -0.159968).  Saving model ...
Epoch: 13 cost time: 1.398198127746582
Epoch: 13, Steps: 10 | Train Loss: 1.690 Vali Loss: 3.173 Vali Acc: 0.171 Test Loss: 3.173 Test Acc: 0.171
Validation loss decreased (-0.159968 --> -0.170557).  Saving model ...
Epoch: 14 cost time: 1.6358306407928467
Epoch: 14, Steps: 10 | Train Loss: 1.493 Vali Loss: 3.176 Vali Acc: 0.186 Test Loss: 3.176 Test Acc: 0.186
Validation loss decreased (-0.170557 --> -0.185851).  Saving model ...
Epoch: 15 cost time: 1.3540153503417969
Epoch: 15, Steps: 10 | Train Loss: 1.254 Vali Loss: 3.193 Vali Acc: 0.188 Test Loss: 3.193 Test Acc: 0.188
Validation loss decreased (-0.185851 --> -0.188203).  Saving model ...
Epoch: 16 cost time: 1.5360479354858398
Epoch: 16, Steps: 10 | Train Loss: 1.053 Vali Loss: 3.218 Vali Acc: 0.198 Test Loss: 3.218 Test Acc: 0.198
Validation loss decreased (-0.188203 --> -0.197615).  Saving model ...
Epoch: 17 cost time: 1.3569939136505127
Epoch: 17, Steps: 10 | Train Loss: 0.852 Vali Loss: 3.244 Vali Acc: 0.207 Test Loss: 3.244 Test Acc: 0.207
Validation loss decreased (-0.197615 --> -0.207026).  Saving model ...
Epoch: 18 cost time: 1.5766491889953613
Epoch: 18, Steps: 10 | Train Loss: 0.693 Vali Loss: 3.296 Vali Acc: 0.220 Test Loss: 3.296 Test Acc: 0.220
Validation loss decreased (-0.207026 --> -0.219967).  Saving model ...
Epoch: 19 cost time: 1.4512221813201904
Epoch: 19, Steps: 10 | Train Loss: 0.538 Vali Loss: 3.358 Vali Acc: 0.222 Test Loss: 3.358 Test Acc: 0.222
Validation loss decreased (-0.219967 --> -0.222319).  Saving model ...
Epoch: 20 cost time: 1.668942928314209
Epoch: 20, Steps: 10 | Train Loss: 0.413 Vali Loss: 3.432 Vali Acc: 0.225 Test Loss: 3.432 Test Acc: 0.225
Validation loss decreased (-0.222319 --> -0.224672).  Saving model ...
Epoch: 21 cost time: 1.8849177360534668
Epoch: 21, Steps: 10 | Train Loss: 0.319 Vali Loss: 3.486 Vali Acc: 0.235 Test Loss: 3.486 Test Acc: 0.235
Validation loss decreased (-0.224672 --> -0.235259).  Saving model ...
Epoch: 22 cost time: 1.3165974617004395
Epoch: 22, Steps: 10 | Train Loss: 0.252 Vali Loss: 3.560 Vali Acc: 0.247 Test Loss: 3.560 Test Acc: 0.247
Validation loss decreased (-0.235259 --> -0.247023).  Saving model ...
Epoch: 23 cost time: 1.602024793624878
Epoch: 23, Steps: 10 | Train Loss: 0.196 Vali Loss: 3.643 Vali Acc: 0.234 Test Loss: 3.643 Test Acc: 0.234
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.3227543830871582
Epoch: 24, Steps: 10 | Train Loss: 0.156 Vali Loss: 3.704 Vali Acc: 0.239 Test Loss: 3.704 Test Acc: 0.239
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.335958480834961
Epoch: 25, Steps: 10 | Train Loss: 0.121 Vali Loss: 3.756 Vali Acc: 0.249 Test Loss: 3.756 Test Acc: 0.249
Validation loss decreased (-0.247023 --> -0.249374).  Saving model ...
Epoch: 26 cost time: 1.240605115890503
Epoch: 26, Steps: 10 | Train Loss: 0.100 Vali Loss: 3.799 Vali Acc: 0.258 Test Loss: 3.799 Test Acc: 0.258
Validation loss decreased (-0.249374 --> -0.257609).  Saving model ...
Epoch: 27 cost time: 1.4169886112213135
Epoch: 27, Steps: 10 | Train Loss: 0.079 Vali Loss: 3.837 Vali Acc: 0.261 Test Loss: 3.837 Test Acc: 0.261
Validation loss decreased (-0.257609 --> -0.261138).  Saving model ...
Epoch: 28 cost time: 1.3188393115997314
Epoch: 28, Steps: 10 | Train Loss: 0.070 Vali Loss: 3.885 Vali Acc: 0.254 Test Loss: 3.885 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.4663076400756836
Epoch: 29, Steps: 10 | Train Loss: 0.056 Vali Loss: 3.927 Vali Acc: 0.256 Test Loss: 3.927 Test Acc: 0.256
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.3269085884094238
Epoch: 30, Steps: 10 | Train Loss: 0.050 Vali Loss: 3.967 Vali Acc: 0.258 Test Loss: 3.967 Test Acc: 0.258
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.4812791347503662
Epoch: 31, Steps: 10 | Train Loss: 0.046 Vali Loss: 4.010 Vali Acc: 0.256 Test Loss: 4.010 Test Acc: 0.256
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.543973684310913
Epoch: 32, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.048 Vali Acc: 0.259 Test Loss: 4.048 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.9172852039337158
Epoch: 33, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.083 Vali Acc: 0.259 Test Loss: 4.083 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.8577985763549805
Epoch: 34, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.117 Vali Acc: 0.264 Test Loss: 4.117 Test Acc: 0.264
Validation loss decreased (-0.261138 --> -0.263488).  Saving model ...
Epoch: 35 cost time: 1.9816527366638184
Epoch: 35, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.140 Vali Acc: 0.262 Test Loss: 4.140 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.4151546955108643
Epoch: 36, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.170 Vali Acc: 0.264 Test Loss: 4.170 Test Acc: 0.264
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.6817824840545654
Epoch: 37, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.201 Vali Acc: 0.266 Test Loss: 4.201 Test Acc: 0.266
Validation loss decreased (-0.263488 --> -0.265840).  Saving model ...
Epoch: 38 cost time: 1.5657682418823242
Epoch: 38, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.227 Vali Acc: 0.264 Test Loss: 4.227 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.3904008865356445
Epoch: 39, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.252 Vali Acc: 0.264 Test Loss: 4.252 Test Acc: 0.264
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.6704540252685547
Epoch: 40, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.282 Vali Acc: 0.262 Test Loss: 4.282 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.966257095336914
Epoch: 41, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.305 Vali Acc: 0.266 Test Loss: 4.305 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.3431158065795898
Epoch: 42, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.337 Vali Acc: 0.268 Test Loss: 4.337 Test Acc: 0.268
Validation loss decreased (-0.265840 --> -0.268192).  Saving model ...
Epoch: 43 cost time: 1.3745269775390625
Epoch: 43, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.369 Vali Acc: 0.267 Test Loss: 4.369 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.587294101715088
Epoch: 44, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.386 Vali Acc: 0.265 Test Loss: 4.386 Test Acc: 0.265
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.55662202835083
Epoch: 45, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.406 Vali Acc: 0.269 Test Loss: 4.406 Test Acc: 0.269
Validation loss decreased (-0.268192 --> -0.269368).  Saving model ...
Epoch: 46 cost time: 1.5029499530792236
Epoch: 46, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.426 Vali Acc: 0.269 Test Loss: 4.426 Test Acc: 0.269
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.19407320022583
Epoch: 47, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.446 Vali Acc: 0.268 Test Loss: 4.446 Test Acc: 0.268
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.5296614170074463
Epoch: 48, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.474 Vali Acc: 0.268 Test Loss: 4.474 Test Acc: 0.268
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.649731159210205
Epoch: 49, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.496 Vali Acc: 0.268 Test Loss: 4.496 Test Acc: 0.268
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 1.4602174758911133
Epoch: 50, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.508 Vali Acc: 0.272 Test Loss: 4.508 Test Acc: 0.272
Validation loss decreased (-0.269368 --> -0.271720).  Saving model ...
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27176470588235296
model parameter : 354106
model size : 1.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps23_str12_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.74182653427124
Epoch: 1, Steps: 10 | Train Loss: 3.269 Vali Loss: 3.269 Vali Acc: 0.039 Test Loss: 3.269 Test Acc: 0.039
Validation loss decreased (inf --> -0.038791).  Saving model ...
Epoch: 2 cost time: 1.4633889198303223
Epoch: 2, Steps: 10 | Train Loss: 3.231 Vali Loss: 3.266 Vali Acc: 0.045 Test Loss: 3.266 Test Acc: 0.045
Validation loss decreased (-0.038791 --> -0.044673).  Saving model ...
Epoch: 3 cost time: 1.648616075515747
Epoch: 3, Steps: 10 | Train Loss: 3.184 Vali Loss: 3.260 Vali Acc: 0.048 Test Loss: 3.260 Test Acc: 0.048
Validation loss decreased (-0.044673 --> -0.048203).  Saving model ...
Epoch: 4 cost time: 1.7253172397613525
Epoch: 4, Steps: 10 | Train Loss: 3.091 Vali Loss: 3.254 Vali Acc: 0.065 Test Loss: 3.254 Test Acc: 0.065
Validation loss decreased (-0.048203 --> -0.064673).  Saving model ...
Epoch: 5 cost time: 1.5573208332061768
Epoch: 5, Steps: 10 | Train Loss: 3.050 Vali Loss: 3.247 Vali Acc: 0.073 Test Loss: 3.247 Test Acc: 0.073
Validation loss decreased (-0.064673 --> -0.072909).  Saving model ...
Epoch: 6 cost time: 1.5845532417297363
Epoch: 6, Steps: 10 | Train Loss: 2.930 Vali Loss: 3.242 Vali Acc: 0.080 Test Loss: 3.242 Test Acc: 0.080
Validation loss decreased (-0.072909 --> -0.079968).  Saving model ...
Epoch: 7 cost time: 1.6657514572143555
Epoch: 7, Steps: 10 | Train Loss: 2.861 Vali Loss: 3.237 Vali Acc: 0.088 Test Loss: 3.237 Test Acc: 0.088
Validation loss decreased (-0.079968 --> -0.088203).  Saving model ...
Epoch: 8 cost time: 1.6631824970245361
Epoch: 8, Steps: 10 | Train Loss: 2.740 Vali Loss: 3.229 Vali Acc: 0.094 Test Loss: 3.229 Test Acc: 0.094
Validation loss decreased (-0.088203 --> -0.094085).  Saving model ...
Epoch: 9 cost time: 2.054344892501831
Epoch: 9, Steps: 10 | Train Loss: 2.637 Vali Loss: 3.219 Vali Acc: 0.107 Test Loss: 3.219 Test Acc: 0.107
Validation loss decreased (-0.094085 --> -0.107027).  Saving model ...
Epoch: 10 cost time: 1.4544544219970703
Epoch: 10, Steps: 10 | Train Loss: 2.518 Vali Loss: 3.215 Vali Acc: 0.115 Test Loss: 3.215 Test Acc: 0.115
Validation loss decreased (-0.107027 --> -0.115262).  Saving model ...
Epoch: 11 cost time: 1.3230509757995605
Epoch: 11, Steps: 10 | Train Loss: 2.371 Vali Loss: 3.207 Vali Acc: 0.122 Test Loss: 3.207 Test Acc: 0.122
Validation loss decreased (-0.115262 --> -0.122321).  Saving model ...
Epoch: 12 cost time: 1.3383500576019287
Epoch: 12, Steps: 10 | Train Loss: 2.225 Vali Loss: 3.197 Vali Acc: 0.129 Test Loss: 3.197 Test Acc: 0.129
Validation loss decreased (-0.122321 --> -0.129380).  Saving model ...
Epoch: 13 cost time: 1.5166451930999756
Epoch: 13, Steps: 10 | Train Loss: 2.087 Vali Loss: 3.188 Vali Acc: 0.142 Test Loss: 3.188 Test Acc: 0.142
Validation loss decreased (-0.129380 --> -0.142321).  Saving model ...
Epoch: 14 cost time: 1.2413780689239502
Epoch: 14, Steps: 10 | Train Loss: 1.922 Vali Loss: 3.184 Vali Acc: 0.149 Test Loss: 3.184 Test Acc: 0.149
Validation loss decreased (-0.142321 --> -0.149380).  Saving model ...
Epoch: 15 cost time: 1.546245813369751
Epoch: 15, Steps: 10 | Train Loss: 1.751 Vali Loss: 3.183 Vali Acc: 0.164 Test Loss: 3.183 Test Acc: 0.164
Validation loss decreased (-0.149380 --> -0.163498).  Saving model ...
Epoch: 16 cost time: 1.7643659114837646
Epoch: 16, Steps: 10 | Train Loss: 1.595 Vali Loss: 3.189 Vali Acc: 0.172 Test Loss: 3.189 Test Acc: 0.172
Validation loss decreased (-0.163498 --> -0.171733).  Saving model ...
Epoch: 17 cost time: 2.093705177307129
Epoch: 17, Steps: 10 | Train Loss: 1.406 Vali Loss: 3.201 Vali Acc: 0.178 Test Loss: 3.201 Test Acc: 0.178
Validation loss decreased (-0.171733 --> -0.177615).  Saving model ...
Epoch: 18 cost time: 1.404083490371704
Epoch: 18, Steps: 10 | Train Loss: 1.229 Vali Loss: 3.221 Vali Acc: 0.195 Test Loss: 3.221 Test Acc: 0.195
Validation loss decreased (-0.177615 --> -0.195262).  Saving model ...
Epoch: 19 cost time: 1.8033711910247803
Epoch: 19, Steps: 10 | Train Loss: 1.092 Vali Loss: 3.247 Vali Acc: 0.198 Test Loss: 3.247 Test Acc: 0.198
Validation loss decreased (-0.195262 --> -0.197615).  Saving model ...
Epoch: 20 cost time: 1.4877498149871826
Epoch: 20, Steps: 10 | Train Loss: 0.912 Vali Loss: 3.268 Vali Acc: 0.211 Test Loss: 3.268 Test Acc: 0.211
Validation loss decreased (-0.197615 --> -0.210556).  Saving model ...
Epoch: 21 cost time: 1.5747580528259277
Epoch: 21, Steps: 10 | Train Loss: 0.773 Vali Loss: 3.309 Vali Acc: 0.225 Test Loss: 3.309 Test Acc: 0.225
Validation loss decreased (-0.210556 --> -0.224673).  Saving model ...
Epoch: 22 cost time: 1.5743317604064941
Epoch: 22, Steps: 10 | Train Loss: 0.623 Vali Loss: 3.378 Vali Acc: 0.220 Test Loss: 3.378 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.935967206954956
Epoch: 23, Steps: 10 | Train Loss: 0.530 Vali Loss: 3.437 Vali Acc: 0.225 Test Loss: 3.437 Test Acc: 0.225
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.4991114139556885
Epoch: 24, Steps: 10 | Train Loss: 0.424 Vali Loss: 3.488 Vali Acc: 0.228 Test Loss: 3.488 Test Acc: 0.228
Validation loss decreased (-0.224673 --> -0.228200).  Saving model ...
Epoch: 25 cost time: 1.4899225234985352
Epoch: 25, Steps: 10 | Train Loss: 0.354 Vali Loss: 3.547 Vali Acc: 0.235 Test Loss: 3.547 Test Acc: 0.235
Validation loss decreased (-0.228200 --> -0.235259).  Saving model ...
Epoch: 26 cost time: 1.750624418258667
Epoch: 26, Steps: 10 | Train Loss: 0.281 Vali Loss: 3.608 Vali Acc: 0.240 Test Loss: 3.608 Test Acc: 0.240
Validation loss decreased (-0.235259 --> -0.239964).  Saving model ...
Epoch: 27 cost time: 1.3820672035217285
Epoch: 27, Steps: 10 | Train Loss: 0.232 Vali Loss: 3.682 Vali Acc: 0.238 Test Loss: 3.682 Test Acc: 0.238
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.7729439735412598
Epoch: 28, Steps: 10 | Train Loss: 0.190 Vali Loss: 3.741 Vali Acc: 0.234 Test Loss: 3.741 Test Acc: 0.234
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.672452449798584
Epoch: 29, Steps: 10 | Train Loss: 0.165 Vali Loss: 3.790 Vali Acc: 0.240 Test Loss: 3.790 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.8442473411560059
Epoch: 30, Steps: 10 | Train Loss: 0.133 Vali Loss: 3.846 Vali Acc: 0.236 Test Loss: 3.846 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.7610960006713867
Epoch: 31, Steps: 10 | Train Loss: 0.119 Vali Loss: 3.895 Vali Acc: 0.239 Test Loss: 3.895 Test Acc: 0.239
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 2.1340010166168213
Epoch: 32, Steps: 10 | Train Loss: 0.092 Vali Loss: 3.933 Vali Acc: 0.236 Test Loss: 3.933 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.971733570098877
Epoch: 33, Steps: 10 | Train Loss: 0.087 Vali Loss: 3.976 Vali Acc: 0.246 Test Loss: 3.976 Test Acc: 0.246
Validation loss decreased (-0.239964 --> -0.245843).  Saving model ...
Epoch: 34 cost time: 1.9698736667633057
Epoch: 34, Steps: 10 | Train Loss: 0.084 Vali Loss: 4.023 Vali Acc: 0.242 Test Loss: 4.023 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.5019915103912354
Epoch: 35, Steps: 10 | Train Loss: 0.065 Vali Loss: 4.099 Vali Acc: 0.244 Test Loss: 4.099 Test Acc: 0.244
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.5000827312469482
Epoch: 36, Steps: 10 | Train Loss: 0.059 Vali Loss: 4.094 Vali Acc: 0.247 Test Loss: 4.094 Test Acc: 0.247
Validation loss decreased (-0.245843 --> -0.247018).  Saving model ...
Epoch: 37 cost time: 1.6368112564086914
Epoch: 37, Steps: 10 | Train Loss: 0.052 Vali Loss: 4.129 Vali Acc: 0.239 Test Loss: 4.129 Test Acc: 0.239
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.4212660789489746
Epoch: 38, Steps: 10 | Train Loss: 0.043 Vali Loss: 4.162 Vali Acc: 0.242 Test Loss: 4.162 Test Acc: 0.242
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.8366827964782715
Epoch: 39, Steps: 10 | Train Loss: 0.041 Vali Loss: 4.185 Vali Acc: 0.244 Test Loss: 4.185 Test Acc: 0.244
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.7167460918426514
Epoch: 40, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.224 Vali Acc: 0.244 Test Loss: 4.224 Test Acc: 0.244
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.9293663501739502
Epoch: 41, Steps: 10 | Train Loss: 0.037 Vali Loss: 4.264 Vali Acc: 0.242 Test Loss: 4.264 Test Acc: 0.242
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.8978755474090576
Epoch: 42, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.296 Vali Acc: 0.247 Test Loss: 4.296 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.8078744411468506
Epoch: 43, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.339 Vali Acc: 0.254 Test Loss: 4.339 Test Acc: 0.254
Validation loss decreased (-0.247018 --> -0.254074).  Saving model ...
Epoch: 44 cost time: 1.479712963104248
Epoch: 44, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.353 Vali Acc: 0.254 Test Loss: 4.353 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.8959763050079346
Epoch: 45, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.369 Vali Acc: 0.248 Test Loss: 4.369 Test Acc: 0.248
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.9914374351501465
Epoch: 46, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.415 Vali Acc: 0.245 Test Loss: 4.415 Test Acc: 0.245
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.4690356254577637
Epoch: 47, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.425 Vali Acc: 0.245 Test Loss: 4.425 Test Acc: 0.245
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.5746841430664062
Epoch: 48, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.442 Vali Acc: 0.244 Test Loss: 4.442 Test Acc: 0.244
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.5444495677947998
Epoch: 49, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.458 Vali Acc: 0.246 Test Loss: 4.458 Test Acc: 0.246
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 1.8834223747253418
Epoch: 50, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.488 Vali Acc: 0.248 Test Loss: 4.488 Test Acc: 0.248
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps23_str12_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2541176470588235
model parameter : 334362
model size : 1.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.923464775085449
Epoch: 1, Steps: 10 | Train Loss: 3.295 Vali Loss: 3.262 Vali Acc: 0.039 Test Loss: 3.262 Test Acc: 0.039
Validation loss decreased (inf --> -0.038791).  Saving model ...
Epoch: 2 cost time: 1.7095601558685303
Epoch: 2, Steps: 10 | Train Loss: 3.269 Vali Loss: 3.256 Vali Acc: 0.056 Test Loss: 3.256 Test Acc: 0.056
Validation loss decreased (-0.038791 --> -0.056438).  Saving model ...
Epoch: 3 cost time: 1.6115837097167969
Epoch: 3, Steps: 10 | Train Loss: 3.228 Vali Loss: 3.247 Vali Acc: 0.061 Test Loss: 3.247 Test Acc: 0.061
Validation loss decreased (-0.056438 --> -0.061144).  Saving model ...
Epoch: 4 cost time: 1.8879802227020264
Epoch: 4, Steps: 10 | Train Loss: 3.138 Vali Loss: 3.238 Vali Acc: 0.074 Test Loss: 3.238 Test Acc: 0.074
Validation loss decreased (-0.061144 --> -0.074085).  Saving model ...
Epoch: 5 cost time: 1.689361810684204
Epoch: 5, Steps: 10 | Train Loss: 3.070 Vali Loss: 3.233 Vali Acc: 0.084 Test Loss: 3.233 Test Acc: 0.084
Validation loss decreased (-0.074085 --> -0.083497).  Saving model ...
Epoch: 6 cost time: 1.8235862255096436
Epoch: 6, Steps: 10 | Train Loss: 2.985 Vali Loss: 3.228 Vali Acc: 0.094 Test Loss: 3.228 Test Acc: 0.094
Validation loss decreased (-0.083497 --> -0.094085).  Saving model ...
Epoch: 7 cost time: 1.902916431427002
Epoch: 7, Steps: 10 | Train Loss: 2.864 Vali Loss: 3.224 Vali Acc: 0.096 Test Loss: 3.224 Test Acc: 0.096
Validation loss decreased (-0.094085 --> -0.096438).  Saving model ...
Epoch: 8 cost time: 2.022130012512207
Epoch: 8, Steps: 10 | Train Loss: 2.792 Vali Loss: 3.220 Vali Acc: 0.104 Test Loss: 3.220 Test Acc: 0.104
Validation loss decreased (-0.096438 --> -0.103497).  Saving model ...
Epoch: 9 cost time: 1.4091475009918213
Epoch: 9, Steps: 10 | Train Loss: 2.707 Vali Loss: 3.215 Vali Acc: 0.112 Test Loss: 3.215 Test Acc: 0.112
Validation loss decreased (-0.103497 --> -0.111733).  Saving model ...
Epoch: 10 cost time: 1.7279326915740967
Epoch: 10, Steps: 10 | Train Loss: 2.580 Vali Loss: 3.208 Vali Acc: 0.119 Test Loss: 3.208 Test Acc: 0.119
Validation loss decreased (-0.111733 --> -0.118791).  Saving model ...
Epoch: 11 cost time: 1.5697925090789795
Epoch: 11, Steps: 10 | Train Loss: 2.456 Vali Loss: 3.199 Vali Acc: 0.125 Test Loss: 3.199 Test Acc: 0.125
Validation loss decreased (-0.118791 --> -0.124674).  Saving model ...
Epoch: 12 cost time: 1.6391022205352783
Epoch: 12, Steps: 10 | Train Loss: 2.350 Vali Loss: 3.194 Vali Acc: 0.129 Test Loss: 3.194 Test Acc: 0.129
Validation loss decreased (-0.124674 --> -0.129380).  Saving model ...
Epoch: 13 cost time: 1.6672308444976807
Epoch: 13, Steps: 10 | Train Loss: 2.178 Vali Loss: 3.189 Vali Acc: 0.146 Test Loss: 3.189 Test Acc: 0.146
Validation loss decreased (-0.129380 --> -0.145850).  Saving model ...
Epoch: 14 cost time: 1.4900274276733398
Epoch: 14, Steps: 10 | Train Loss: 2.039 Vali Loss: 3.180 Vali Acc: 0.145 Test Loss: 3.180 Test Acc: 0.145
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.009692668914795
Epoch: 15, Steps: 10 | Train Loss: 1.885 Vali Loss: 3.179 Vali Acc: 0.158 Test Loss: 3.179 Test Acc: 0.158
Validation loss decreased (-0.145850 --> -0.157615).  Saving model ...
Epoch: 16 cost time: 1.621213674545288
Epoch: 16, Steps: 10 | Train Loss: 1.708 Vali Loss: 3.182 Vali Acc: 0.169 Test Loss: 3.182 Test Acc: 0.169
Validation loss decreased (-0.157615 --> -0.169380).  Saving model ...
Epoch: 17 cost time: 1.439389705657959
Epoch: 17, Steps: 10 | Train Loss: 1.555 Vali Loss: 3.183 Vali Acc: 0.180 Test Loss: 3.183 Test Acc: 0.180
Validation loss decreased (-0.169380 --> -0.179968).  Saving model ...
Epoch: 18 cost time: 1.77988600730896
Epoch: 18, Steps: 10 | Train Loss: 1.400 Vali Loss: 3.191 Vali Acc: 0.191 Test Loss: 3.191 Test Acc: 0.191
Validation loss decreased (-0.179968 --> -0.190556).  Saving model ...
Epoch: 19 cost time: 1.4406864643096924
Epoch: 19, Steps: 10 | Train Loss: 1.213 Vali Loss: 3.209 Vali Acc: 0.186 Test Loss: 3.209 Test Acc: 0.186
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.7149016857147217
Epoch: 20, Steps: 10 | Train Loss: 1.052 Vali Loss: 3.224 Vali Acc: 0.204 Test Loss: 3.224 Test Acc: 0.204
Validation loss decreased (-0.190556 --> -0.203497).  Saving model ...
Epoch: 21 cost time: 1.4609730243682861
Epoch: 21, Steps: 10 | Train Loss: 0.935 Vali Loss: 3.259 Vali Acc: 0.202 Test Loss: 3.259 Test Acc: 0.202
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.5184683799743652
Epoch: 22, Steps: 10 | Train Loss: 0.790 Vali Loss: 3.285 Vali Acc: 0.208 Test Loss: 3.285 Test Acc: 0.208
Validation loss decreased (-0.203497 --> -0.208202).  Saving model ...
Epoch: 23 cost time: 1.6047859191894531
Epoch: 23, Steps: 10 | Train Loss: 0.647 Vali Loss: 3.328 Vali Acc: 0.213 Test Loss: 3.328 Test Acc: 0.213
Validation loss decreased (-0.208202 --> -0.212908).  Saving model ...
Epoch: 24 cost time: 1.423217535018921
Epoch: 24, Steps: 10 | Train Loss: 0.530 Vali Loss: 3.367 Vali Acc: 0.216 Test Loss: 3.367 Test Acc: 0.216
Validation loss decreased (-0.212908 --> -0.216437).  Saving model ...
Epoch: 25 cost time: 1.6602022647857666
Epoch: 25, Steps: 10 | Train Loss: 0.417 Vali Loss: 3.428 Vali Acc: 0.218 Test Loss: 3.428 Test Acc: 0.218
Validation loss decreased (-0.216437 --> -0.217613).  Saving model ...
Epoch: 26 cost time: 1.4619767665863037
Epoch: 26, Steps: 10 | Train Loss: 0.331 Vali Loss: 3.496 Vali Acc: 0.226 Test Loss: 3.496 Test Acc: 0.226
Validation loss decreased (-0.217613 --> -0.225847).  Saving model ...
Epoch: 27 cost time: 1.5834627151489258
Epoch: 27, Steps: 10 | Train Loss: 0.272 Vali Loss: 3.540 Vali Acc: 0.231 Test Loss: 3.540 Test Acc: 0.231
Validation loss decreased (-0.225847 --> -0.230553).  Saving model ...
Epoch: 28 cost time: 1.4841108322143555
Epoch: 28, Steps: 10 | Train Loss: 0.231 Vali Loss: 3.613 Vali Acc: 0.231 Test Loss: 3.613 Test Acc: 0.231
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.813652515411377
Epoch: 29, Steps: 10 | Train Loss: 0.187 Vali Loss: 3.676 Vali Acc: 0.231 Test Loss: 3.676 Test Acc: 0.231
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.786890983581543
Epoch: 30, Steps: 10 | Train Loss: 0.165 Vali Loss: 3.731 Vali Acc: 0.229 Test Loss: 3.731 Test Acc: 0.229
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.441669225692749
Epoch: 31, Steps: 10 | Train Loss: 0.131 Vali Loss: 3.757 Vali Acc: 0.231 Test Loss: 3.757 Test Acc: 0.231
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.56364107131958
Epoch: 32, Steps: 10 | Train Loss: 0.105 Vali Loss: 3.817 Vali Acc: 0.229 Test Loss: 3.817 Test Acc: 0.229
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.5293049812316895
Epoch: 33, Steps: 10 | Train Loss: 0.099 Vali Loss: 3.831 Vali Acc: 0.236 Test Loss: 3.831 Test Acc: 0.236
Validation loss decreased (-0.230553 --> -0.236432).  Saving model ...
Epoch: 34 cost time: 1.9791114330291748
Epoch: 34, Steps: 10 | Train Loss: 0.079 Vali Loss: 3.869 Vali Acc: 0.235 Test Loss: 3.869 Test Acc: 0.235
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.6640491485595703
Epoch: 35, Steps: 10 | Train Loss: 0.065 Vali Loss: 3.901 Vali Acc: 0.234 Test Loss: 3.901 Test Acc: 0.234
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.6755688190460205
Epoch: 36, Steps: 10 | Train Loss: 0.060 Vali Loss: 3.957 Vali Acc: 0.241 Test Loss: 3.957 Test Acc: 0.241
Validation loss decreased (-0.236432 --> -0.241137).  Saving model ...
Epoch: 37 cost time: 1.7787165641784668
Epoch: 37, Steps: 10 | Train Loss: 0.053 Vali Loss: 4.012 Vali Acc: 0.231 Test Loss: 4.012 Test Acc: 0.231
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.6079928874969482
Epoch: 38, Steps: 10 | Train Loss: 0.050 Vali Loss: 4.040 Vali Acc: 0.235 Test Loss: 4.040 Test Acc: 0.235
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.7630558013916016
Epoch: 39, Steps: 10 | Train Loss: 0.044 Vali Loss: 4.101 Vali Acc: 0.239 Test Loss: 4.101 Test Acc: 0.239
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.7230536937713623
Epoch: 40, Steps: 10 | Train Loss: 0.042 Vali Loss: 4.118 Vali Acc: 0.245 Test Loss: 4.118 Test Acc: 0.245
Validation loss decreased (-0.241137 --> -0.244665).  Saving model ...
Epoch: 41 cost time: 1.4693677425384521
Epoch: 41, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.138 Vali Acc: 0.241 Test Loss: 4.138 Test Acc: 0.241
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.7617466449737549
Epoch: 42, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.162 Vali Acc: 0.234 Test Loss: 4.162 Test Acc: 0.234
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.3725359439849854
Epoch: 43, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.209 Vali Acc: 0.233 Test Loss: 4.209 Test Acc: 0.233
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.7212331295013428
Epoch: 44, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.201 Vali Acc: 0.233 Test Loss: 4.201 Test Acc: 0.233
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.377169132232666
Epoch: 45, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.242 Vali Acc: 0.241 Test Loss: 4.242 Test Acc: 0.241
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.868109941482544
Epoch: 46, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.288 Vali Acc: 0.240 Test Loss: 4.288 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.6906123161315918
Epoch: 47, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.316 Vali Acc: 0.233 Test Loss: 4.316 Test Acc: 0.233
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.49375319480896
Epoch: 48, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.350 Vali Acc: 0.239 Test Loss: 4.350 Test Acc: 0.239
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.662677526473999
Epoch: 49, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.377 Vali Acc: 0.236 Test Loss: 4.377 Test Acc: 0.236
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 1.4809553623199463
Epoch: 50, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.411 Vali Acc: 0.236 Test Loss: 4.411 Test Acc: 0.236
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2447058823529412
model parameter : 334618
model size : 1.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps38_str19_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.457119703292847
Epoch: 1, Steps: 10 | Train Loss: 3.240 Vali Loss: 3.256 Vali Acc: 0.045 Test Loss: 3.256 Test Acc: 0.045
Validation loss decreased (inf --> -0.044673).  Saving model ...
Epoch: 2 cost time: 1.5060615539550781
Epoch: 2, Steps: 10 | Train Loss: 3.232 Vali Loss: 3.252 Vali Acc: 0.056 Test Loss: 3.252 Test Acc: 0.056
Validation loss decreased (-0.044673 --> -0.056438).  Saving model ...
Epoch: 3 cost time: 1.4639463424682617
Epoch: 3, Steps: 10 | Train Loss: 3.169 Vali Loss: 3.246 Vali Acc: 0.059 Test Loss: 3.246 Test Acc: 0.059
Validation loss decreased (-0.056438 --> -0.058791).  Saving model ...
Epoch: 4 cost time: 1.5097715854644775
Epoch: 4, Steps: 10 | Train Loss: 3.102 Vali Loss: 3.240 Vali Acc: 0.062 Test Loss: 3.240 Test Acc: 0.062
Validation loss decreased (-0.058791 --> -0.062321).  Saving model ...
Epoch: 5 cost time: 1.6715679168701172
Epoch: 5, Steps: 10 | Train Loss: 3.037 Vali Loss: 3.233 Vali Acc: 0.075 Test Loss: 3.233 Test Acc: 0.075
Validation loss decreased (-0.062321 --> -0.075262).  Saving model ...
Epoch: 6 cost time: 1.8286480903625488
Epoch: 6, Steps: 10 | Train Loss: 2.964 Vali Loss: 3.227 Vali Acc: 0.081 Test Loss: 3.227 Test Acc: 0.081
Validation loss decreased (-0.075262 --> -0.081144).  Saving model ...
Epoch: 7 cost time: 1.9022293090820312
Epoch: 7, Steps: 10 | Train Loss: 2.887 Vali Loss: 3.222 Vali Acc: 0.089 Test Loss: 3.222 Test Acc: 0.089
Validation loss decreased (-0.081144 --> -0.089380).  Saving model ...
Epoch: 8 cost time: 1.8121070861816406
Epoch: 8, Steps: 10 | Train Loss: 2.791 Vali Loss: 3.218 Vali Acc: 0.101 Test Loss: 3.218 Test Acc: 0.101
Validation loss decreased (-0.089380 --> -0.101144).  Saving model ...
Epoch: 9 cost time: 2.085122585296631
Epoch: 9, Steps: 10 | Train Loss: 2.723 Vali Loss: 3.214 Vali Acc: 0.106 Test Loss: 3.214 Test Acc: 0.106
Validation loss decreased (-0.101144 --> -0.105850).  Saving model ...
Epoch: 10 cost time: 1.6834886074066162
Epoch: 10, Steps: 10 | Train Loss: 2.629 Vali Loss: 3.211 Vali Acc: 0.121 Test Loss: 3.211 Test Acc: 0.121
Validation loss decreased (-0.105850 --> -0.121144).  Saving model ...
Epoch: 11 cost time: 1.889810562133789
Epoch: 11, Steps: 10 | Train Loss: 2.506 Vali Loss: 3.205 Vali Acc: 0.127 Test Loss: 3.205 Test Acc: 0.127
Validation loss decreased (-0.121144 --> -0.127027).  Saving model ...
Epoch: 12 cost time: 1.3124184608459473
Epoch: 12, Steps: 10 | Train Loss: 2.408 Vali Loss: 3.203 Vali Acc: 0.136 Test Loss: 3.203 Test Acc: 0.136
Validation loss decreased (-0.127027 --> -0.136439).  Saving model ...
Epoch: 13 cost time: 1.6687793731689453
Epoch: 13, Steps: 10 | Train Loss: 2.274 Vali Loss: 3.202 Vali Acc: 0.148 Test Loss: 3.202 Test Acc: 0.148
Validation loss decreased (-0.136439 --> -0.148203).  Saving model ...
Epoch: 14 cost time: 1.8381757736206055
Epoch: 14, Steps: 10 | Train Loss: 2.131 Vali Loss: 3.200 Vali Acc: 0.162 Test Loss: 3.200 Test Acc: 0.162
Validation loss decreased (-0.148203 --> -0.162321).  Saving model ...
Epoch: 15 cost time: 1.6882481575012207
Epoch: 15, Steps: 10 | Train Loss: 2.004 Vali Loss: 3.200 Vali Acc: 0.169 Test Loss: 3.200 Test Acc: 0.169
Validation loss decreased (-0.162321 --> -0.169380).  Saving model ...
Epoch: 16 cost time: 1.6052680015563965
Epoch: 16, Steps: 10 | Train Loss: 1.876 Vali Loss: 3.206 Vali Acc: 0.166 Test Loss: 3.206 Test Acc: 0.166
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.923907995223999
Epoch: 17, Steps: 10 | Train Loss: 1.752 Vali Loss: 3.213 Vali Acc: 0.175 Test Loss: 3.213 Test Acc: 0.175
Validation loss decreased (-0.169380 --> -0.175262).  Saving model ...
Epoch: 18 cost time: 1.7447681427001953
Epoch: 18, Steps: 10 | Train Loss: 1.539 Vali Loss: 3.225 Vali Acc: 0.179 Test Loss: 3.225 Test Acc: 0.179
Validation loss decreased (-0.175262 --> -0.178791).  Saving model ...
Epoch: 19 cost time: 2.0577645301818848
Epoch: 19, Steps: 10 | Train Loss: 1.435 Vali Loss: 3.241 Vali Acc: 0.186 Test Loss: 3.241 Test Acc: 0.186
Validation loss decreased (-0.178791 --> -0.185850).  Saving model ...
Epoch: 20 cost time: 1.7528471946716309
Epoch: 20, Steps: 10 | Train Loss: 1.267 Vali Loss: 3.257 Vali Acc: 0.195 Test Loss: 3.257 Test Acc: 0.195
Validation loss decreased (-0.185850 --> -0.195262).  Saving model ...
Epoch: 21 cost time: 1.7248706817626953
Epoch: 21, Steps: 10 | Train Loss: 1.146 Vali Loss: 3.288 Vali Acc: 0.199 Test Loss: 3.288 Test Acc: 0.199
Validation loss decreased (-0.195262 --> -0.198791).  Saving model ...
Epoch: 22 cost time: 1.6118793487548828
Epoch: 22, Steps: 10 | Train Loss: 0.978 Vali Loss: 3.309 Vali Acc: 0.204 Test Loss: 3.309 Test Acc: 0.204
Validation loss decreased (-0.198791 --> -0.203496).  Saving model ...
Epoch: 23 cost time: 1.738741397857666
Epoch: 23, Steps: 10 | Train Loss: 0.837 Vali Loss: 3.347 Vali Acc: 0.209 Test Loss: 3.347 Test Acc: 0.209
Validation loss decreased (-0.203496 --> -0.209378).  Saving model ...
Epoch: 24 cost time: 2.0022776126861572
Epoch: 24, Steps: 10 | Train Loss: 0.748 Vali Loss: 3.385 Vali Acc: 0.212 Test Loss: 3.385 Test Acc: 0.212
Validation loss decreased (-0.209378 --> -0.211731).  Saving model ...
Epoch: 25 cost time: 1.3402314186096191
Epoch: 25, Steps: 10 | Train Loss: 0.624 Vali Loss: 3.429 Vali Acc: 0.215 Test Loss: 3.429 Test Acc: 0.215
Validation loss decreased (-0.211731 --> -0.215260).  Saving model ...
Epoch: 26 cost time: 2.441376209259033
Epoch: 26, Steps: 10 | Train Loss: 0.496 Vali Loss: 3.469 Vali Acc: 0.215 Test Loss: 3.469 Test Acc: 0.215
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.7504279613494873
Epoch: 27, Steps: 10 | Train Loss: 0.445 Vali Loss: 3.528 Vali Acc: 0.213 Test Loss: 3.528 Test Acc: 0.213
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.8143162727355957
Epoch: 28, Steps: 10 | Train Loss: 0.355 Vali Loss: 3.581 Vali Acc: 0.218 Test Loss: 3.581 Test Acc: 0.218
Validation loss decreased (-0.215260 --> -0.217611).  Saving model ...
Epoch: 29 cost time: 1.7345447540283203
Epoch: 29, Steps: 10 | Train Loss: 0.295 Vali Loss: 3.627 Vali Acc: 0.222 Test Loss: 3.627 Test Acc: 0.222
Validation loss decreased (-0.217611 --> -0.222317).  Saving model ...
Epoch: 30 cost time: 2.018695831298828
Epoch: 30, Steps: 10 | Train Loss: 0.260 Vali Loss: 3.684 Vali Acc: 0.224 Test Loss: 3.684 Test Acc: 0.224
Validation loss decreased (-0.222317 --> -0.223493).  Saving model ...
Epoch: 31 cost time: 1.676558256149292
Epoch: 31, Steps: 10 | Train Loss: 0.235 Vali Loss: 3.749 Vali Acc: 0.216 Test Loss: 3.749 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.8917734622955322
Epoch: 32, Steps: 10 | Train Loss: 0.175 Vali Loss: 3.810 Vali Acc: 0.212 Test Loss: 3.810 Test Acc: 0.212
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.8125677108764648
Epoch: 33, Steps: 10 | Train Loss: 0.146 Vali Loss: 3.852 Vali Acc: 0.213 Test Loss: 3.852 Test Acc: 0.213
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 2.3365378379821777
Epoch: 34, Steps: 10 | Train Loss: 0.128 Vali Loss: 3.877 Vali Acc: 0.215 Test Loss: 3.877 Test Acc: 0.215
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.9060966968536377
Epoch: 35, Steps: 10 | Train Loss: 0.112 Vali Loss: 3.935 Vali Acc: 0.218 Test Loss: 3.935 Test Acc: 0.218
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.7794904708862305
Epoch: 36, Steps: 10 | Train Loss: 0.106 Vali Loss: 3.980 Vali Acc: 0.222 Test Loss: 3.980 Test Acc: 0.222
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.5731184482574463
Epoch: 37, Steps: 10 | Train Loss: 0.081 Vali Loss: 4.008 Vali Acc: 0.214 Test Loss: 4.008 Test Acc: 0.214
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 2.071352005004883
Epoch: 38, Steps: 10 | Train Loss: 0.070 Vali Loss: 4.069 Vali Acc: 0.219 Test Loss: 4.069 Test Acc: 0.219
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.8722949028015137
Epoch: 39, Steps: 10 | Train Loss: 0.063 Vali Loss: 4.120 Vali Acc: 0.221 Test Loss: 4.120 Test Acc: 0.221
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.8837244510650635
Epoch: 40, Steps: 10 | Train Loss: 0.063 Vali Loss: 4.162 Vali Acc: 0.221 Test Loss: 4.162 Test Acc: 0.221
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps38_str19_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2235294117647059
model parameter : 324858
model size : 1.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.467822790145874
Epoch: 1, Steps: 10 | Train Loss: 3.245 Vali Loss: 3.252 Vali Acc: 0.049 Test Loss: 3.252 Test Acc: 0.049
Validation loss decreased (inf --> -0.049379).  Saving model ...
Epoch: 2 cost time: 1.9519827365875244
Epoch: 2, Steps: 10 | Train Loss: 2.842 Vali Loss: 3.253 Vali Acc: 0.108 Test Loss: 3.253 Test Acc: 0.108
Validation loss decreased (-0.049379 --> -0.108203).  Saving model ...
Epoch: 3 cost time: 1.9370503425598145
Epoch: 3, Steps: 10 | Train Loss: 2.121 Vali Loss: 3.205 Vali Acc: 0.146 Test Loss: 3.205 Test Acc: 0.146
Validation loss decreased (-0.108203 --> -0.145850).  Saving model ...
Epoch: 4 cost time: 1.9048874378204346
Epoch: 4, Steps: 10 | Train Loss: 1.319 Vali Loss: 3.222 Vali Acc: 0.208 Test Loss: 3.222 Test Acc: 0.208
Validation loss decreased (-0.145850 --> -0.208203).  Saving model ...
Epoch: 5 cost time: 2.0311291217803955
Epoch: 5, Steps: 10 | Train Loss: 0.638 Vali Loss: 3.504 Vali Acc: 0.225 Test Loss: 3.504 Test Acc: 0.225
Validation loss decreased (-0.208203 --> -0.224671).  Saving model ...
Epoch: 6 cost time: 1.6044490337371826
Epoch: 6, Steps: 10 | Train Loss: 0.245 Vali Loss: 3.912 Vali Acc: 0.251 Test Loss: 3.912 Test Acc: 0.251
Validation loss decreased (-0.224671 --> -0.250549).  Saving model ...
Epoch: 7 cost time: 1.9361815452575684
Epoch: 7, Steps: 10 | Train Loss: 0.087 Vali Loss: 4.358 Vali Acc: 0.256 Test Loss: 4.358 Test Acc: 0.256
Validation loss decreased (-0.250549 --> -0.256427).  Saving model ...
Epoch: 8 cost time: 1.6207644939422607
Epoch: 8, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.733 Vali Acc: 0.266 Test Loss: 4.733 Test Acc: 0.266
Validation loss decreased (-0.256427 --> -0.265835).  Saving model ...
Epoch: 9 cost time: 1.6350581645965576
Epoch: 9, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.958 Vali Acc: 0.268 Test Loss: 4.958 Test Acc: 0.268
Validation loss decreased (-0.265835 --> -0.268186).  Saving model ...
Epoch: 10 cost time: 1.4839060306549072
Epoch: 10, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.107 Vali Acc: 0.264 Test Loss: 5.107 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.591019868850708
Epoch: 11, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.164 Vali Acc: 0.272 Test Loss: 5.164 Test Acc: 0.272
Validation loss decreased (-0.268186 --> -0.271713).  Saving model ...
Epoch: 12 cost time: 1.6276566982269287
Epoch: 12, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.197 Vali Acc: 0.280 Test Loss: 5.197 Test Acc: 0.280
Validation loss decreased (-0.271713 --> -0.279948).  Saving model ...
Epoch: 13 cost time: 1.7219018936157227
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.225 Vali Acc: 0.276 Test Loss: 5.225 Test Acc: 0.276
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.8846421241760254
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.276 Vali Acc: 0.278 Test Loss: 5.276 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.1127126216888428
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.316 Vali Acc: 0.280 Test Loss: 5.316 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.8461284637451172
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.338 Vali Acc: 0.278 Test Loss: 5.338 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.099914312362671
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.345 Vali Acc: 0.282 Test Loss: 5.345 Test Acc: 0.282
Validation loss decreased (-0.279948 --> -0.282299).  Saving model ...
Epoch: 18 cost time: 2.2205421924591064
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.373 Vali Acc: 0.282 Test Loss: 5.373 Test Acc: 0.282
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.7340099811553955
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.397 Vali Acc: 0.284 Test Loss: 5.397 Test Acc: 0.284
Validation loss decreased (-0.282299 --> -0.283475).  Saving model ...
Epoch: 20 cost time: 1.9826240539550781
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.432 Vali Acc: 0.284 Test Loss: 5.432 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.1465723514556885
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.461 Vali Acc: 0.285 Test Loss: 5.461 Test Acc: 0.285
Validation loss decreased (-0.283475 --> -0.284651).  Saving model ...
Epoch: 22 cost time: 1.9951765537261963
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.484 Vali Acc: 0.282 Test Loss: 5.484 Test Acc: 0.282
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.8855595588684082
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.511 Vali Acc: 0.282 Test Loss: 5.511 Test Acc: 0.282
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.180413007736206
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.528 Vali Acc: 0.282 Test Loss: 5.528 Test Acc: 0.282
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.9472370147705078
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.546 Vali Acc: 0.281 Test Loss: 5.546 Test Acc: 0.281
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.045264720916748
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.580 Vali Acc: 0.281 Test Loss: 5.580 Test Acc: 0.281
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.9874722957611084
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.617 Vali Acc: 0.280 Test Loss: 5.617 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.040666103363037
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.635 Vali Acc: 0.282 Test Loss: 5.635 Test Acc: 0.282
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.8890018463134766
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.666 Vali Acc: 0.281 Test Loss: 5.666 Test Acc: 0.281
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.9497685432434082
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.676 Vali Acc: 0.282 Test Loss: 5.676 Test Acc: 0.282
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 2.2620317935943604
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.695 Vali Acc: 0.281 Test Loss: 5.695 Test Acc: 0.281
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2847058823529412
model parameter : 1855642
model size : 7.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.7423202991485596
Epoch: 1, Steps: 10 | Train Loss: 3.280 Vali Loss: 3.268 Vali Acc: 0.044 Test Loss: 3.268 Test Acc: 0.044
Validation loss decreased (inf --> -0.043497).  Saving model ...
Epoch: 2 cost time: 1.6161577701568604
Epoch: 2, Steps: 10 | Train Loss: 3.049 Vali Loss: 3.269 Vali Acc: 0.085 Test Loss: 3.269 Test Acc: 0.085
Validation loss decreased (-0.043497 --> -0.084673).  Saving model ...
Epoch: 3 cost time: 1.6983325481414795
Epoch: 3, Steps: 10 | Train Loss: 2.656 Vali Loss: 3.261 Vali Acc: 0.100 Test Loss: 3.261 Test Acc: 0.100
Validation loss decreased (-0.084673 --> -0.099967).  Saving model ...
Epoch: 4 cost time: 1.7420997619628906
Epoch: 4, Steps: 10 | Train Loss: 2.196 Vali Loss: 3.210 Vali Acc: 0.148 Test Loss: 3.210 Test Acc: 0.148
Validation loss decreased (-0.099967 --> -0.148203).  Saving model ...
Epoch: 5 cost time: 1.7981975078582764
Epoch: 5, Steps: 10 | Train Loss: 1.630 Vali Loss: 3.214 Vali Acc: 0.186 Test Loss: 3.214 Test Acc: 0.186
Validation loss decreased (-0.148203 --> -0.185850).  Saving model ...
Epoch: 6 cost time: 1.4275717735290527
Epoch: 6, Steps: 10 | Train Loss: 1.069 Vali Loss: 3.280 Vali Acc: 0.204 Test Loss: 3.280 Test Acc: 0.204
Validation loss decreased (-0.185850 --> -0.203497).  Saving model ...
Epoch: 7 cost time: 1.6860110759735107
Epoch: 7, Steps: 10 | Train Loss: 0.590 Vali Loss: 3.439 Vali Acc: 0.235 Test Loss: 3.439 Test Acc: 0.235
Validation loss decreased (-0.203497 --> -0.235260).  Saving model ...
Epoch: 8 cost time: 1.5904982089996338
Epoch: 8, Steps: 10 | Train Loss: 0.271 Vali Loss: 3.745 Vali Acc: 0.249 Test Loss: 3.745 Test Acc: 0.249
Validation loss decreased (-0.235260 --> -0.249374).  Saving model ...
Epoch: 9 cost time: 1.5162861347198486
Epoch: 9, Steps: 10 | Train Loss: 0.120 Vali Loss: 4.117 Vali Acc: 0.251 Test Loss: 4.117 Test Acc: 0.251
Validation loss decreased (-0.249374 --> -0.250547).  Saving model ...
Epoch: 10 cost time: 1.622574806213379
Epoch: 10, Steps: 10 | Train Loss: 0.043 Vali Loss: 4.359 Vali Acc: 0.267 Test Loss: 4.359 Test Acc: 0.267
Validation loss decreased (-0.250547 --> -0.267015).  Saving model ...
Epoch: 11 cost time: 1.545421838760376
Epoch: 11, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.464 Vali Acc: 0.279 Test Loss: 4.464 Test Acc: 0.279
Validation loss decreased (-0.267015 --> -0.278779).  Saving model ...
Epoch: 12 cost time: 1.6889796257019043
Epoch: 12, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.572 Vali Acc: 0.286 Test Loss: 4.572 Test Acc: 0.286
Validation loss decreased (-0.278779 --> -0.285837).  Saving model ...
Epoch: 13 cost time: 1.6418910026550293
Epoch: 13, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.675 Vali Acc: 0.272 Test Loss: 4.675 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.681556224822998
Epoch: 14, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.753 Vali Acc: 0.271 Test Loss: 4.753 Test Acc: 0.271
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.8818378448486328
Epoch: 15, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.810 Vali Acc: 0.273 Test Loss: 4.810 Test Acc: 0.273
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.7349720001220703
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.867 Vali Acc: 0.276 Test Loss: 4.867 Test Acc: 0.276
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.4605908393859863
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.924 Vali Acc: 0.271 Test Loss: 4.924 Test Acc: 0.271
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.4984819889068604
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.967 Vali Acc: 0.274 Test Loss: 4.967 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.3783156871795654
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.009 Vali Acc: 0.273 Test Loss: 5.009 Test Acc: 0.273
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.4238409996032715
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.040 Vali Acc: 0.274 Test Loss: 5.040 Test Acc: 0.274
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.5286290645599365
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.071 Vali Acc: 0.275 Test Loss: 5.071 Test Acc: 0.275
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.551990270614624
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.108 Vali Acc: 0.273 Test Loss: 5.108 Test Acc: 0.273
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2858823529411765
model parameter : 1476762
model size : 5.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps12_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.1850433349609375
Epoch: 1, Steps: 10 | Train Loss: 3.273 Vali Loss: 3.259 Vali Acc: 0.054 Test Loss: 3.259 Test Acc: 0.054
Validation loss decreased (inf --> -0.054085).  Saving model ...
Epoch: 2 cost time: 1.6320512294769287
Epoch: 2, Steps: 10 | Train Loss: 3.089 Vali Loss: 3.246 Vali Acc: 0.084 Test Loss: 3.246 Test Acc: 0.084
Validation loss decreased (-0.054085 --> -0.083497).  Saving model ...
Epoch: 3 cost time: 1.546656847000122
Epoch: 3, Steps: 10 | Train Loss: 2.779 Vali Loss: 3.249 Vali Acc: 0.095 Test Loss: 3.249 Test Acc: 0.095
Validation loss decreased (-0.083497 --> -0.095262).  Saving model ...
Epoch: 4 cost time: 1.8865082263946533
Epoch: 4, Steps: 10 | Train Loss: 2.415 Vali Loss: 3.224 Vali Acc: 0.124 Test Loss: 3.224 Test Acc: 0.124
Validation loss decreased (-0.095262 --> -0.123497).  Saving model ...
Epoch: 5 cost time: 1.6209816932678223
Epoch: 5, Steps: 10 | Train Loss: 2.011 Vali Loss: 3.177 Vali Acc: 0.155 Test Loss: 3.177 Test Acc: 0.155
Validation loss decreased (-0.123497 --> -0.155262).  Saving model ...
Epoch: 6 cost time: 1.8663268089294434
Epoch: 6, Steps: 10 | Train Loss: 1.474 Vali Loss: 3.197 Vali Acc: 0.188 Test Loss: 3.197 Test Acc: 0.188
Validation loss decreased (-0.155262 --> -0.188203).  Saving model ...
Epoch: 7 cost time: 1.965437412261963
Epoch: 7, Steps: 10 | Train Loss: 1.026 Vali Loss: 3.263 Vali Acc: 0.204 Test Loss: 3.263 Test Acc: 0.204
Validation loss decreased (-0.188203 --> -0.203497).  Saving model ...
Epoch: 8 cost time: 1.8527259826660156
Epoch: 8, Steps: 10 | Train Loss: 0.607 Vali Loss: 3.386 Vali Acc: 0.227 Test Loss: 3.386 Test Acc: 0.227
Validation loss decreased (-0.203497 --> -0.227025).  Saving model ...
Epoch: 9 cost time: 2.0141513347625732
Epoch: 9, Steps: 10 | Train Loss: 0.336 Vali Loss: 3.549 Vali Acc: 0.238 Test Loss: 3.549 Test Acc: 0.238
Validation loss decreased (-0.227025 --> -0.237612).  Saving model ...
Epoch: 10 cost time: 1.9636292457580566
Epoch: 10, Steps: 10 | Train Loss: 0.178 Vali Loss: 3.800 Vali Acc: 0.246 Test Loss: 3.800 Test Acc: 0.246
Validation loss decreased (-0.237612 --> -0.245844).  Saving model ...
Epoch: 11 cost time: 1.7223172187805176
Epoch: 11, Steps: 10 | Train Loss: 0.084 Vali Loss: 4.031 Vali Acc: 0.258 Test Loss: 4.031 Test Acc: 0.258
Validation loss decreased (-0.245844 --> -0.257607).  Saving model ...
Epoch: 12 cost time: 1.7616932392120361
Epoch: 12, Steps: 10 | Train Loss: 0.043 Vali Loss: 4.228 Vali Acc: 0.242 Test Loss: 4.228 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7745158672332764
Epoch: 13, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.260 Vali Acc: 0.247 Test Loss: 4.260 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.8500001430511475
Epoch: 14, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.348 Vali Acc: 0.256 Test Loss: 4.348 Test Acc: 0.256
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.6687397956848145
Epoch: 15, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.441 Vali Acc: 0.254 Test Loss: 4.441 Test Acc: 0.254
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.7400991916656494
Epoch: 16, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.523 Vali Acc: 0.253 Test Loss: 4.523 Test Acc: 0.253
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.9855244159698486
Epoch: 17, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.570 Vali Acc: 0.251 Test Loss: 4.570 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.0954315662384033
Epoch: 18, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.634 Vali Acc: 0.251 Test Loss: 4.634 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.9044146537780762
Epoch: 19, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.679 Vali Acc: 0.249 Test Loss: 4.679 Test Acc: 0.249
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.8126285076141357
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.703 Vali Acc: 0.247 Test Loss: 4.703 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.8794145584106445
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.728 Vali Acc: 0.247 Test Loss: 4.728 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps12_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2576470588235294
model parameter : 1357466
model size : 5.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.7511439323425293
Epoch: 1, Steps: 10 | Train Loss: 3.298 Vali Loss: 3.255 Vali Acc: 0.042 Test Loss: 3.255 Test Acc: 0.042
Validation loss decreased (inf --> -0.042320).  Saving model ...
Epoch: 2 cost time: 1.5655627250671387
Epoch: 2, Steps: 10 | Train Loss: 3.130 Vali Loss: 3.237 Vali Acc: 0.059 Test Loss: 3.237 Test Acc: 0.059
Validation loss decreased (-0.042320 --> -0.058791).  Saving model ...
Epoch: 3 cost time: 1.4887571334838867
Epoch: 3, Steps: 10 | Train Loss: 2.883 Vali Loss: 3.234 Vali Acc: 0.074 Test Loss: 3.234 Test Acc: 0.074
Validation loss decreased (-0.058791 --> -0.074085).  Saving model ...
Epoch: 4 cost time: 1.3936657905578613
Epoch: 4, Steps: 10 | Train Loss: 2.579 Vali Loss: 3.221 Vali Acc: 0.099 Test Loss: 3.221 Test Acc: 0.099
Validation loss decreased (-0.074085 --> -0.098791).  Saving model ...
Epoch: 5 cost time: 1.7328355312347412
Epoch: 5, Steps: 10 | Train Loss: 2.220 Vali Loss: 3.191 Vali Acc: 0.131 Test Loss: 3.191 Test Acc: 0.131
Validation loss decreased (-0.098791 --> -0.130556).  Saving model ...
Epoch: 6 cost time: 1.5038599967956543
Epoch: 6, Steps: 10 | Train Loss: 1.841 Vali Loss: 3.167 Vali Acc: 0.161 Test Loss: 3.167 Test Acc: 0.161
Validation loss decreased (-0.130556 --> -0.161145).  Saving model ...
Epoch: 7 cost time: 1.686739206314087
Epoch: 7, Steps: 10 | Train Loss: 1.391 Vali Loss: 3.172 Vali Acc: 0.181 Test Loss: 3.172 Test Acc: 0.181
Validation loss decreased (-0.161145 --> -0.181145).  Saving model ...
Epoch: 8 cost time: 1.7711842060089111
Epoch: 8, Steps: 10 | Train Loss: 1.006 Vali Loss: 3.208 Vali Acc: 0.216 Test Loss: 3.208 Test Acc: 0.216
Validation loss decreased (-0.181145 --> -0.216439).  Saving model ...
Epoch: 9 cost time: 1.6328482627868652
Epoch: 9, Steps: 10 | Train Loss: 0.677 Vali Loss: 3.297 Vali Acc: 0.225 Test Loss: 3.297 Test Acc: 0.225
Validation loss decreased (-0.216439 --> -0.224673).  Saving model ...
Epoch: 10 cost time: 1.588747262954712
Epoch: 10, Steps: 10 | Train Loss: 0.420 Vali Loss: 3.429 Vali Acc: 0.252 Test Loss: 3.429 Test Acc: 0.252
Validation loss decreased (-0.224673 --> -0.251730).  Saving model ...
Epoch: 11 cost time: 1.5525379180908203
Epoch: 11, Steps: 10 | Train Loss: 0.246 Vali Loss: 3.588 Vali Acc: 0.256 Test Loss: 3.588 Test Acc: 0.256
Validation loss decreased (-0.251730 --> -0.256435).  Saving model ...
Epoch: 12 cost time: 1.5529158115386963
Epoch: 12, Steps: 10 | Train Loss: 0.132 Vali Loss: 3.729 Vali Acc: 0.261 Test Loss: 3.729 Test Acc: 0.261
Validation loss decreased (-0.256435 --> -0.261139).  Saving model ...
Epoch: 13 cost time: 1.4187963008880615
Epoch: 13, Steps: 10 | Train Loss: 0.073 Vali Loss: 3.893 Vali Acc: 0.271 Test Loss: 3.893 Test Acc: 0.271
Validation loss decreased (-0.261139 --> -0.270549).  Saving model ...
Epoch: 14 cost time: 1.3886241912841797
Epoch: 14, Steps: 10 | Train Loss: 0.044 Vali Loss: 3.989 Vali Acc: 0.279 Test Loss: 3.989 Test Acc: 0.279
Validation loss decreased (-0.270549 --> -0.278784).  Saving model ...
Epoch: 15 cost time: 1.3375346660614014
Epoch: 15, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.057 Vali Acc: 0.285 Test Loss: 4.057 Test Acc: 0.285
Validation loss decreased (-0.278784 --> -0.284665).  Saving model ...
Epoch: 16 cost time: 1.4242730140686035
Epoch: 16, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.137 Vali Acc: 0.280 Test Loss: 4.137 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.6514170169830322
Epoch: 17, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.210 Vali Acc: 0.274 Test Loss: 4.210 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.8095145225524902
Epoch: 18, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.270 Vali Acc: 0.278 Test Loss: 4.270 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.6923773288726807
Epoch: 19, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.314 Vali Acc: 0.275 Test Loss: 4.314 Test Acc: 0.275
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.8007557392120361
Epoch: 20, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.343 Vali Acc: 0.279 Test Loss: 4.343 Test Acc: 0.279
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.5382215976715088
Epoch: 21, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.378 Vali Acc: 0.278 Test Loss: 4.378 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.8772873878479004
Epoch: 22, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.411 Vali Acc: 0.284 Test Loss: 4.411 Test Acc: 0.284
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.636162281036377
Epoch: 23, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.432 Vali Acc: 0.282 Test Loss: 4.432 Test Acc: 0.282
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.6349127292633057
Epoch: 24, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.466 Vali Acc: 0.284 Test Loss: 4.466 Test Acc: 0.284
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.6416749954223633
Epoch: 25, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.496 Vali Acc: 0.286 Test Loss: 4.496 Test Acc: 0.286
Validation loss decreased (-0.284665 --> -0.285837).  Saving model ...
Epoch: 26 cost time: 1.625401258468628
Epoch: 26, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.540 Vali Acc: 0.284 Test Loss: 4.540 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.641946792602539
Epoch: 27, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.568 Vali Acc: 0.285 Test Loss: 4.568 Test Acc: 0.285
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.6380283832550049
Epoch: 28, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.595 Vali Acc: 0.287 Test Loss: 4.595 Test Acc: 0.287
Validation loss decreased (-0.285837 --> -0.287013).  Saving model ...
Epoch: 29 cost time: 1.6484050750732422
Epoch: 29, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.629 Vali Acc: 0.287 Test Loss: 4.629 Test Acc: 0.287
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.7472987174987793
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.654 Vali Acc: 0.286 Test Loss: 4.654 Test Acc: 0.286
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.5724785327911377
Epoch: 31, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.677 Vali Acc: 0.285 Test Loss: 4.677 Test Acc: 0.285
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.5727379322052002
Epoch: 32, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.702 Vali Acc: 0.286 Test Loss: 4.702 Test Acc: 0.286
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.674102783203125
Epoch: 33, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.729 Vali Acc: 0.286 Test Loss: 4.729 Test Acc: 0.286
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.6022419929504395
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.740 Vali Acc: 0.288 Test Loss: 4.740 Test Acc: 0.288
Validation loss decreased (-0.287013 --> -0.288188).  Saving model ...
Epoch: 35 cost time: 1.7929773330688477
Epoch: 35, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.774 Vali Acc: 0.289 Test Loss: 4.774 Test Acc: 0.289
Validation loss decreased (-0.288188 --> -0.289364).  Saving model ...
Epoch: 36 cost time: 1.6234145164489746
Epoch: 36, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.794 Vali Acc: 0.288 Test Loss: 4.794 Test Acc: 0.288
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.8119275569915771
Epoch: 37, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.814 Vali Acc: 0.285 Test Loss: 4.814 Test Acc: 0.285
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.7692155838012695
Epoch: 38, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.829 Vali Acc: 0.285 Test Loss: 4.829 Test Acc: 0.285
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.5632820129394531
Epoch: 39, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.848 Vali Acc: 0.284 Test Loss: 4.848 Test Acc: 0.284
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.6715433597564697
Epoch: 40, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.867 Vali Acc: 0.284 Test Loss: 4.867 Test Acc: 0.284
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.5581531524658203
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.890 Vali Acc: 0.284 Test Loss: 4.890 Test Acc: 0.284
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.7251160144805908
Epoch: 42, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.912 Vali Acc: 0.282 Test Loss: 4.912 Test Acc: 0.282
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.8442597389221191
Epoch: 43, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.926 Vali Acc: 0.286 Test Loss: 4.926 Test Acc: 0.286
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.6533534526824951
Epoch: 44, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.936 Vali Acc: 0.285 Test Loss: 4.936 Test Acc: 0.285
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 1.7080981731414795
Epoch: 45, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.954 Vali Acc: 0.284 Test Loss: 4.954 Test Acc: 0.284
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.28941176470588237
model parameter : 1298074
model size : 5.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps23_str12_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.7809078693389893
Epoch: 1, Steps: 10 | Train Loss: 3.287 Vali Loss: 3.266 Vali Acc: 0.036 Test Loss: 3.266 Test Acc: 0.036
Validation loss decreased (inf --> -0.036438).  Saving model ...
Epoch: 2 cost time: 1.185497760772705
Epoch: 2, Steps: 10 | Train Loss: 3.163 Vali Loss: 3.249 Vali Acc: 0.051 Test Loss: 3.249 Test Acc: 0.051
Validation loss decreased (-0.036438 --> -0.050556).  Saving model ...
Epoch: 3 cost time: 1.5371689796447754
Epoch: 3, Steps: 10 | Train Loss: 2.972 Vali Loss: 3.228 Vali Acc: 0.079 Test Loss: 3.228 Test Acc: 0.079
Validation loss decreased (-0.050556 --> -0.078791).  Saving model ...
Epoch: 4 cost time: 1.427922248840332
Epoch: 4, Steps: 10 | Train Loss: 2.742 Vali Loss: 3.220 Vali Acc: 0.092 Test Loss: 3.220 Test Acc: 0.092
Validation loss decreased (-0.078791 --> -0.091733).  Saving model ...
Epoch: 5 cost time: 1.159142255783081
Epoch: 5, Steps: 10 | Train Loss: 2.499 Vali Loss: 3.202 Vali Acc: 0.114 Test Loss: 3.202 Test Acc: 0.114
Validation loss decreased (-0.091733 --> -0.114086).  Saving model ...
Epoch: 6 cost time: 1.313002347946167
Epoch: 6, Steps: 10 | Train Loss: 2.218 Vali Loss: 3.177 Vali Acc: 0.133 Test Loss: 3.177 Test Acc: 0.133
Validation loss decreased (-0.114086 --> -0.132909).  Saving model ...
Epoch: 7 cost time: 1.486952543258667
Epoch: 7, Steps: 10 | Train Loss: 1.866 Vali Loss: 3.153 Vali Acc: 0.166 Test Loss: 3.153 Test Acc: 0.166
Validation loss decreased (-0.132909 --> -0.165851).  Saving model ...
Epoch: 8 cost time: 1.3062348365783691
Epoch: 8, Steps: 10 | Train Loss: 1.552 Vali Loss: 3.158 Vali Acc: 0.178 Test Loss: 3.158 Test Acc: 0.178
Validation loss decreased (-0.165851 --> -0.177615).  Saving model ...
Epoch: 9 cost time: 1.209463119506836
Epoch: 9, Steps: 10 | Train Loss: 1.209 Vali Loss: 3.179 Vali Acc: 0.205 Test Loss: 3.179 Test Acc: 0.205
Validation loss decreased (-0.177615 --> -0.204674).  Saving model ...
Epoch: 10 cost time: 1.2620306015014648
Epoch: 10, Steps: 10 | Train Loss: 0.909 Vali Loss: 3.212 Vali Acc: 0.234 Test Loss: 3.212 Test Acc: 0.234
Validation loss decreased (-0.204674 --> -0.234086).  Saving model ...
Epoch: 11 cost time: 1.469895601272583
Epoch: 11, Steps: 10 | Train Loss: 0.680 Vali Loss: 3.309 Vali Acc: 0.249 Test Loss: 3.309 Test Acc: 0.249
Validation loss decreased (-0.234086 --> -0.249379).  Saving model ...
Epoch: 12 cost time: 1.4713590145111084
Epoch: 12, Steps: 10 | Train Loss: 0.433 Vali Loss: 3.395 Vali Acc: 0.261 Test Loss: 3.395 Test Acc: 0.261
Validation loss decreased (-0.249379 --> -0.261143).  Saving model ...
Epoch: 13 cost time: 1.28132963180542
Epoch: 13, Steps: 10 | Train Loss: 0.290 Vali Loss: 3.517 Vali Acc: 0.259 Test Loss: 3.517 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3517062664031982
Epoch: 14, Steps: 10 | Train Loss: 0.189 Vali Loss: 3.626 Vali Acc: 0.262 Test Loss: 3.626 Test Acc: 0.262
Validation loss decreased (-0.261143 --> -0.262317).  Saving model ...
Epoch: 15 cost time: 1.3793892860412598
Epoch: 15, Steps: 10 | Train Loss: 0.119 Vali Loss: 3.758 Vali Acc: 0.266 Test Loss: 3.758 Test Acc: 0.266
Validation loss decreased (-0.262317 --> -0.265845).  Saving model ...
Epoch: 16 cost time: 1.2266597747802734
Epoch: 16, Steps: 10 | Train Loss: 0.079 Vali Loss: 3.853 Vali Acc: 0.269 Test Loss: 3.853 Test Acc: 0.269
Validation loss decreased (-0.265845 --> -0.269373).  Saving model ...
Epoch: 17 cost time: 1.4195215702056885
Epoch: 17, Steps: 10 | Train Loss: 0.061 Vali Loss: 3.906 Vali Acc: 0.272 Test Loss: 3.906 Test Acc: 0.272
Validation loss decreased (-0.269373 --> -0.271726).  Saving model ...
Epoch: 18 cost time: 1.3790078163146973
Epoch: 18, Steps: 10 | Train Loss: 0.039 Vali Loss: 3.946 Vali Acc: 0.279 Test Loss: 3.946 Test Acc: 0.279
Validation loss decreased (-0.271726 --> -0.278784).  Saving model ...
Epoch: 19 cost time: 1.5347909927368164
Epoch: 19, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.004 Vali Acc: 0.282 Test Loss: 4.004 Test Acc: 0.282
Validation loss decreased (-0.278784 --> -0.282313).  Saving model ...
Epoch: 20 cost time: 1.3777885437011719
Epoch: 20, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.076 Vali Acc: 0.275 Test Loss: 4.076 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.5829203128814697
Epoch: 21, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.121 Vali Acc: 0.278 Test Loss: 4.121 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.5158028602600098
Epoch: 22, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.162 Vali Acc: 0.280 Test Loss: 4.162 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.6764397621154785
Epoch: 23, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.215 Vali Acc: 0.272 Test Loss: 4.215 Test Acc: 0.272
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.5640645027160645
Epoch: 24, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.236 Vali Acc: 0.282 Test Loss: 4.236 Test Acc: 0.282
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.5076382160186768
Epoch: 25, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.256 Vali Acc: 0.282 Test Loss: 4.256 Test Acc: 0.282
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.6868157386779785
Epoch: 26, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.286 Vali Acc: 0.280 Test Loss: 4.286 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.6027679443359375
Epoch: 27, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.339 Vali Acc: 0.278 Test Loss: 4.339 Test Acc: 0.278
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.5592613220214844
Epoch: 28, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.375 Vali Acc: 0.276 Test Loss: 4.375 Test Acc: 0.276
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.54579758644104
Epoch: 29, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.402 Vali Acc: 0.278 Test Loss: 4.402 Test Acc: 0.278
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps23_str12_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2823529411764706
model parameter : 1219098
model size : 4.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.5545427799224854
Epoch: 1, Steps: 10 | Train Loss: 3.261 Vali Loss: 3.253 Vali Acc: 0.048 Test Loss: 3.253 Test Acc: 0.048
Validation loss decreased (inf --> -0.048203).  Saving model ...
Epoch: 2 cost time: 1.2573847770690918
Epoch: 2, Steps: 10 | Train Loss: 3.150 Vali Loss: 3.241 Vali Acc: 0.074 Test Loss: 3.241 Test Acc: 0.074
Validation loss decreased (-0.048203 --> -0.074085).  Saving model ...
Epoch: 3 cost time: 1.1032133102416992
Epoch: 3, Steps: 10 | Train Loss: 2.979 Vali Loss: 3.227 Vali Acc: 0.088 Test Loss: 3.227 Test Acc: 0.088
Validation loss decreased (-0.074085 --> -0.088203).  Saving model ...
Epoch: 4 cost time: 1.2327210903167725
Epoch: 4, Steps: 10 | Train Loss: 2.790 Vali Loss: 3.218 Vali Acc: 0.100 Test Loss: 3.218 Test Acc: 0.100
Validation loss decreased (-0.088203 --> -0.099968).  Saving model ...
Epoch: 5 cost time: 1.56126070022583
Epoch: 5, Steps: 10 | Train Loss: 2.567 Vali Loss: 3.205 Vali Acc: 0.107 Test Loss: 3.205 Test Acc: 0.107
Validation loss decreased (-0.099968 --> -0.107027).  Saving model ...
Epoch: 6 cost time: 1.8901481628417969
Epoch: 6, Steps: 10 | Train Loss: 2.357 Vali Loss: 3.190 Vali Acc: 0.121 Test Loss: 3.190 Test Acc: 0.121
Validation loss decreased (-0.107027 --> -0.121145).  Saving model ...
Epoch: 7 cost time: 1.397749423980713
Epoch: 7, Steps: 10 | Train Loss: 2.040 Vali Loss: 3.170 Vali Acc: 0.140 Test Loss: 3.170 Test Acc: 0.140
Validation loss decreased (-0.121145 --> -0.139968).  Saving model ...
Epoch: 8 cost time: 1.6143367290496826
Epoch: 8, Steps: 10 | Train Loss: 1.807 Vali Loss: 3.159 Vali Acc: 0.166 Test Loss: 3.159 Test Acc: 0.166
Validation loss decreased (-0.139968 --> -0.165851).  Saving model ...
Epoch: 9 cost time: 1.4449946880340576
Epoch: 9, Steps: 10 | Train Loss: 1.495 Vali Loss: 3.155 Vali Acc: 0.186 Test Loss: 3.155 Test Acc: 0.186
Validation loss decreased (-0.165851 --> -0.185851).  Saving model ...
Epoch: 10 cost time: 1.3312528133392334
Epoch: 10, Steps: 10 | Train Loss: 1.213 Vali Loss: 3.163 Vali Acc: 0.195 Test Loss: 3.163 Test Acc: 0.195
Validation loss decreased (-0.185851 --> -0.195262).  Saving model ...
Epoch: 11 cost time: 1.4008879661560059
Epoch: 11, Steps: 10 | Train Loss: 0.948 Vali Loss: 3.197 Vali Acc: 0.220 Test Loss: 3.197 Test Acc: 0.220
Validation loss decreased (-0.195262 --> -0.219968).  Saving model ...
Epoch: 12 cost time: 1.4318735599517822
Epoch: 12, Steps: 10 | Train Loss: 0.750 Vali Loss: 3.262 Vali Acc: 0.229 Test Loss: 3.262 Test Acc: 0.229
Validation loss decreased (-0.219968 --> -0.229379).  Saving model ...
Epoch: 13 cost time: 1.3801231384277344
Epoch: 13, Steps: 10 | Train Loss: 0.510 Vali Loss: 3.358 Vali Acc: 0.228 Test Loss: 3.358 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.331897497177124
Epoch: 14, Steps: 10 | Train Loss: 0.339 Vali Loss: 3.415 Vali Acc: 0.247 Test Loss: 3.415 Test Acc: 0.247
Validation loss decreased (-0.229379 --> -0.247025).  Saving model ...
Epoch: 15 cost time: 1.1345453262329102
Epoch: 15, Steps: 10 | Train Loss: 0.238 Vali Loss: 3.528 Vali Acc: 0.256 Test Loss: 3.528 Test Acc: 0.256
Validation loss decreased (-0.247025 --> -0.256435).  Saving model ...
Epoch: 16 cost time: 1.1773335933685303
Epoch: 16, Steps: 10 | Train Loss: 0.147 Vali Loss: 3.658 Vali Acc: 0.247 Test Loss: 3.658 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4800002574920654
Epoch: 17, Steps: 10 | Train Loss: 0.107 Vali Loss: 3.734 Vali Acc: 0.252 Test Loss: 3.734 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.2200703620910645
Epoch: 18, Steps: 10 | Train Loss: 0.076 Vali Loss: 3.771 Vali Acc: 0.262 Test Loss: 3.771 Test Acc: 0.262
Validation loss decreased (-0.256435 --> -0.262315).  Saving model ...
Epoch: 19 cost time: 1.4041197299957275
Epoch: 19, Steps: 10 | Train Loss: 0.059 Vali Loss: 3.833 Vali Acc: 0.271 Test Loss: 3.833 Test Acc: 0.271
Validation loss decreased (-0.262315 --> -0.270550).  Saving model ...
Epoch: 20 cost time: 1.3205633163452148
Epoch: 20, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.894 Vali Acc: 0.271 Test Loss: 3.894 Test Acc: 0.271
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.30938720703125
Epoch: 21, Steps: 10 | Train Loss: 0.035 Vali Loss: 3.970 Vali Acc: 0.265 Test Loss: 3.970 Test Acc: 0.265
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.3541638851165771
Epoch: 22, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.017 Vali Acc: 0.266 Test Loss: 4.017 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.5702648162841797
Epoch: 23, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.042 Vali Acc: 0.266 Test Loss: 4.042 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.529850959777832
Epoch: 24, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.077 Vali Acc: 0.267 Test Loss: 4.077 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.5622103214263916
Epoch: 25, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.104 Vali Acc: 0.269 Test Loss: 4.104 Test Acc: 0.269
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.4954159259796143
Epoch: 26, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.128 Vali Acc: 0.272 Test Loss: 4.128 Test Acc: 0.272
Validation loss decreased (-0.270550 --> -0.271723).  Saving model ...
Epoch: 27 cost time: 1.2530992031097412
Epoch: 27, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.154 Vali Acc: 0.274 Test Loss: 4.154 Test Acc: 0.274
Validation loss decreased (-0.271723 --> -0.274076).  Saving model ...
Epoch: 28 cost time: 1.3188965320587158
Epoch: 28, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.187 Vali Acc: 0.272 Test Loss: 4.187 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.3961899280548096
Epoch: 29, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.221 Vali Acc: 0.272 Test Loss: 4.221 Test Acc: 0.272
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.4318556785583496
Epoch: 30, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.255 Vali Acc: 0.276 Test Loss: 4.255 Test Acc: 0.276
Validation loss decreased (-0.274076 --> -0.276428).  Saving model ...
Epoch: 31 cost time: 1.2926216125488281
Epoch: 31, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.278 Vali Acc: 0.276 Test Loss: 4.278 Test Acc: 0.276
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.4876530170440674
Epoch: 32, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.311 Vali Acc: 0.276 Test Loss: 4.311 Test Acc: 0.276
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.4650704860687256
Epoch: 33, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.343 Vali Acc: 0.278 Test Loss: 4.343 Test Acc: 0.278
Validation loss decreased (-0.276428 --> -0.277604).  Saving model ...
Epoch: 34 cost time: 1.5909950733184814
Epoch: 34, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.374 Vali Acc: 0.278 Test Loss: 4.374 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.467388391494751
Epoch: 35, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.367 Vali Acc: 0.275 Test Loss: 4.367 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.4216396808624268
Epoch: 36, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.391 Vali Acc: 0.276 Test Loss: 4.391 Test Acc: 0.276
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.4605038166046143
Epoch: 37, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.406 Vali Acc: 0.274 Test Loss: 4.406 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.3810536861419678
Epoch: 38, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.432 Vali Acc: 0.271 Test Loss: 4.432 Test Acc: 0.271
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.3161449432373047
Epoch: 39, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.452 Vali Acc: 0.275 Test Loss: 4.452 Test Acc: 0.275
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.3571712970733643
Epoch: 40, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.472 Vali Acc: 0.276 Test Loss: 4.472 Test Acc: 0.276
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.390714406967163
Epoch: 41, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.505 Vali Acc: 0.275 Test Loss: 4.505 Test Acc: 0.275
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.4735217094421387
Epoch: 42, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.520 Vali Acc: 0.274 Test Loss: 4.520 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.3756566047668457
Epoch: 43, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.538 Vali Acc: 0.275 Test Loss: 4.538 Test Acc: 0.275
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2776470588235294
model parameter : 1200154
model size : 4.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps38_str19_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.8138678073883057
Epoch: 1, Steps: 10 | Train Loss: 3.295 Vali Loss: 3.248 Vali Acc: 0.047 Test Loss: 3.248 Test Acc: 0.047
Validation loss decreased (inf --> -0.047026).  Saving model ...
Epoch: 2 cost time: 1.355928659439087
Epoch: 2, Steps: 10 | Train Loss: 3.190 Vali Loss: 3.236 Vali Acc: 0.058 Test Loss: 3.236 Test Acc: 0.058
Validation loss decreased (-0.047026 --> -0.057615).  Saving model ...
Epoch: 3 cost time: 1.3139772415161133
Epoch: 3, Steps: 10 | Train Loss: 3.046 Vali Loss: 3.224 Vali Acc: 0.073 Test Loss: 3.224 Test Acc: 0.073
Validation loss decreased (-0.057615 --> -0.072909).  Saving model ...
Epoch: 4 cost time: 1.3450355529785156
Epoch: 4, Steps: 10 | Train Loss: 2.881 Vali Loss: 3.214 Vali Acc: 0.091 Test Loss: 3.214 Test Acc: 0.091
Validation loss decreased (-0.072909 --> -0.090556).  Saving model ...
Epoch: 5 cost time: 1.4901318550109863
Epoch: 5, Steps: 10 | Train Loss: 2.681 Vali Loss: 3.202 Vali Acc: 0.111 Test Loss: 3.202 Test Acc: 0.111
Validation loss decreased (-0.090556 --> -0.110556).  Saving model ...
Epoch: 6 cost time: 1.4145307540893555
Epoch: 6, Steps: 10 | Train Loss: 2.466 Vali Loss: 3.194 Vali Acc: 0.119 Test Loss: 3.194 Test Acc: 0.119
Validation loss decreased (-0.110556 --> -0.118792).  Saving model ...
Epoch: 7 cost time: 1.1958436965942383
Epoch: 7, Steps: 10 | Train Loss: 2.221 Vali Loss: 3.188 Vali Acc: 0.140 Test Loss: 3.188 Test Acc: 0.140
Validation loss decreased (-0.118792 --> -0.139968).  Saving model ...
Epoch: 8 cost time: 1.2738823890686035
Epoch: 8, Steps: 10 | Train Loss: 1.966 Vali Loss: 3.173 Vali Acc: 0.156 Test Loss: 3.173 Test Acc: 0.156
Validation loss decreased (-0.139968 --> -0.156439).  Saving model ...
Epoch: 9 cost time: 1.3248460292816162
Epoch: 9, Steps: 10 | Train Loss: 1.683 Vali Loss: 3.163 Vali Acc: 0.179 Test Loss: 3.163 Test Acc: 0.179
Validation loss decreased (-0.156439 --> -0.178792).  Saving model ...
Epoch: 10 cost time: 1.2729902267456055
Epoch: 10, Steps: 10 | Train Loss: 1.437 Vali Loss: 3.161 Vali Acc: 0.202 Test Loss: 3.161 Test Acc: 0.202
Validation loss decreased (-0.178792 --> -0.202321).  Saving model ...
Epoch: 11 cost time: 1.3591926097869873
Epoch: 11, Steps: 10 | Train Loss: 1.164 Vali Loss: 3.199 Vali Acc: 0.215 Test Loss: 3.199 Test Acc: 0.215
Validation loss decreased (-0.202321 --> -0.215262).  Saving model ...
Epoch: 12 cost time: 1.3456175327301025
Epoch: 12, Steps: 10 | Train Loss: 0.911 Vali Loss: 3.242 Vali Acc: 0.229 Test Loss: 3.242 Test Acc: 0.229
Validation loss decreased (-0.215262 --> -0.229379).  Saving model ...
Epoch: 13 cost time: 1.276782751083374
Epoch: 13, Steps: 10 | Train Loss: 0.710 Vali Loss: 3.292 Vali Acc: 0.246 Test Loss: 3.292 Test Acc: 0.246
Validation loss decreased (-0.229379 --> -0.245849).  Saving model ...
Epoch: 14 cost time: 1.2342767715454102
Epoch: 14, Steps: 10 | Train Loss: 0.532 Vali Loss: 3.368 Vali Acc: 0.258 Test Loss: 3.368 Test Acc: 0.258
Validation loss decreased (-0.245849 --> -0.257613).  Saving model ...
Epoch: 15 cost time: 1.1667497158050537
Epoch: 15, Steps: 10 | Train Loss: 0.381 Vali Loss: 3.450 Vali Acc: 0.260 Test Loss: 3.450 Test Acc: 0.260
Validation loss decreased (-0.257613 --> -0.259966).  Saving model ...
Epoch: 16 cost time: 1.3833951950073242
Epoch: 16, Steps: 10 | Train Loss: 0.256 Vali Loss: 3.531 Vali Acc: 0.265 Test Loss: 3.531 Test Acc: 0.265
Validation loss decreased (-0.259966 --> -0.264671).  Saving model ...
Epoch: 17 cost time: 1.2837486267089844
Epoch: 17, Steps: 10 | Train Loss: 0.183 Vali Loss: 3.636 Vali Acc: 0.265 Test Loss: 3.636 Test Acc: 0.265
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2713956832885742
Epoch: 18, Steps: 10 | Train Loss: 0.123 Vali Loss: 3.717 Vali Acc: 0.276 Test Loss: 3.717 Test Acc: 0.276
Validation loss decreased (-0.264671 --> -0.276433).  Saving model ...
Epoch: 19 cost time: 1.3423819541931152
Epoch: 19, Steps: 10 | Train Loss: 0.095 Vali Loss: 3.762 Vali Acc: 0.276 Test Loss: 3.762 Test Acc: 0.276
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2710578441619873
Epoch: 20, Steps: 10 | Train Loss: 0.073 Vali Loss: 3.862 Vali Acc: 0.267 Test Loss: 3.862 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.2669110298156738
Epoch: 21, Steps: 10 | Train Loss: 0.060 Vali Loss: 3.922 Vali Acc: 0.272 Test Loss: 3.922 Test Acc: 0.272
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.2842144966125488
Epoch: 22, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.957 Vali Acc: 0.274 Test Loss: 3.957 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.2828240394592285
Epoch: 23, Steps: 10 | Train Loss: 0.037 Vali Loss: 3.993 Vali Acc: 0.276 Test Loss: 3.993 Test Acc: 0.276
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.2795274257659912
Epoch: 24, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.058 Vali Acc: 0.280 Test Loss: 4.058 Test Acc: 0.280
Validation loss decreased (-0.276433 --> -0.279959).  Saving model ...
Epoch: 25 cost time: 1.267672061920166
Epoch: 25, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.097 Vali Acc: 0.275 Test Loss: 4.097 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.3349852561950684
Epoch: 26, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.128 Vali Acc: 0.273 Test Loss: 4.128 Test Acc: 0.273
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.2859172821044922
Epoch: 27, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.184 Vali Acc: 0.276 Test Loss: 4.184 Test Acc: 0.276
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.2852301597595215
Epoch: 28, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.227 Vali Acc: 0.273 Test Loss: 4.227 Test Acc: 0.273
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.2445619106292725
Epoch: 29, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.251 Vali Acc: 0.274 Test Loss: 4.251 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.2087254524230957
Epoch: 30, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.282 Vali Acc: 0.278 Test Loss: 4.282 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.3126587867736816
Epoch: 31, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.298 Vali Acc: 0.276 Test Loss: 4.298 Test Acc: 0.276
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.2106330394744873
Epoch: 32, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.348 Vali Acc: 0.282 Test Loss: 4.348 Test Acc: 0.282
Validation loss decreased (-0.279959 --> -0.282309).  Saving model ...
Epoch: 33 cost time: 1.2623379230499268
Epoch: 33, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.371 Vali Acc: 0.285 Test Loss: 4.371 Test Acc: 0.285
Validation loss decreased (-0.282309 --> -0.284662).  Saving model ...
Epoch: 34 cost time: 1.2211496829986572
Epoch: 34, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.388 Vali Acc: 0.287 Test Loss: 4.388 Test Acc: 0.287
Validation loss decreased (-0.284662 --> -0.287015).  Saving model ...
Epoch: 35 cost time: 1.326134204864502
Epoch: 35, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.412 Vali Acc: 0.285 Test Loss: 4.412 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.2966220378875732
Epoch: 36, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.423 Vali Acc: 0.288 Test Loss: 4.423 Test Acc: 0.288
Validation loss decreased (-0.287015 --> -0.288191).  Saving model ...
Epoch: 37 cost time: 1.4064173698425293
Epoch: 37, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.449 Vali Acc: 0.287 Test Loss: 4.449 Test Acc: 0.287
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.1360104084014893
Epoch: 38, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.463 Vali Acc: 0.285 Test Loss: 4.463 Test Acc: 0.285
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.3156721591949463
Epoch: 39, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.485 Vali Acc: 0.286 Test Loss: 4.485 Test Acc: 0.286
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.3381896018981934
Epoch: 40, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.512 Vali Acc: 0.286 Test Loss: 4.512 Test Acc: 0.286
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.2436869144439697
Epoch: 41, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.548 Vali Acc: 0.281 Test Loss: 4.548 Test Acc: 0.281
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.2525842189788818
Epoch: 42, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.550 Vali Acc: 0.286 Test Loss: 4.550 Test Acc: 0.286
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.4308135509490967
Epoch: 43, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.562 Vali Acc: 0.285 Test Loss: 4.562 Test Acc: 0.285
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.3223204612731934
Epoch: 44, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.594 Vali Acc: 0.285 Test Loss: 4.594 Test Acc: 0.285
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 1.3219091892242432
Epoch: 45, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.626 Vali Acc: 0.288 Test Loss: 4.626 Test Acc: 0.288
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 1.4085137844085693
Epoch: 46, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.643 Vali Acc: 0.288 Test Loss: 4.643 Test Acc: 0.288
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps38_str19_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.28823529411764703
model parameter : 1181082
model size : 4.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.6255221366882324
Epoch: 1, Steps: 10 | Train Loss: 3.264 Vali Loss: 3.258 Vali Acc: 0.064 Test Loss: 3.258 Test Acc: 0.064
Validation loss decreased (inf --> -0.063497).  Saving model ...
Epoch: 2 cost time: 1.370565414428711
Epoch: 2, Steps: 10 | Train Loss: 3.040 Vali Loss: 3.254 Vali Acc: 0.076 Test Loss: 3.254 Test Acc: 0.076
Validation loss decreased (-0.063497 --> -0.076438).  Saving model ...
Epoch: 3 cost time: 1.134768009185791
Epoch: 3, Steps: 10 | Train Loss: 2.670 Vali Loss: 3.284 Vali Acc: 0.089 Test Loss: 3.284 Test Acc: 0.089
Validation loss decreased (-0.076438 --> -0.089379).  Saving model ...
Epoch: 4 cost time: 1.2621989250183105
Epoch: 4, Steps: 10 | Train Loss: 2.237 Vali Loss: 3.241 Vali Acc: 0.133 Test Loss: 3.241 Test Acc: 0.133
Validation loss decreased (-0.089379 --> -0.132909).  Saving model ...
Epoch: 5 cost time: 1.1867270469665527
Epoch: 5, Steps: 10 | Train Loss: 1.692 Vali Loss: 3.157 Vali Acc: 0.186 Test Loss: 3.157 Test Acc: 0.186
Validation loss decreased (-0.132909 --> -0.185851).  Saving model ...
Epoch: 6 cost time: 1.2286376953125
Epoch: 6, Steps: 10 | Train Loss: 1.100 Vali Loss: 3.231 Vali Acc: 0.199 Test Loss: 3.231 Test Acc: 0.199
Validation loss decreased (-0.185851 --> -0.198791).  Saving model ...
Epoch: 7 cost time: 1.2026073932647705
Epoch: 7, Steps: 10 | Train Loss: 0.613 Vali Loss: 3.401 Vali Acc: 0.221 Test Loss: 3.401 Test Acc: 0.221
Validation loss decreased (-0.198791 --> -0.221142).  Saving model ...
Epoch: 8 cost time: 1.2979729175567627
Epoch: 8, Steps: 10 | Train Loss: 0.303 Vali Loss: 3.629 Vali Acc: 0.235 Test Loss: 3.629 Test Acc: 0.235
Validation loss decreased (-0.221142 --> -0.235258).  Saving model ...
Epoch: 9 cost time: 1.242372751235962
Epoch: 9, Steps: 10 | Train Loss: 0.123 Vali Loss: 3.941 Vali Acc: 0.242 Test Loss: 3.941 Test Acc: 0.242
Validation loss decreased (-0.235258 --> -0.242314).  Saving model ...
Epoch: 10 cost time: 1.2430670261383057
Epoch: 10, Steps: 10 | Train Loss: 0.048 Vali Loss: 4.171 Vali Acc: 0.253 Test Loss: 4.171 Test Acc: 0.253
Validation loss decreased (-0.242314 --> -0.252899).  Saving model ...
Epoch: 11 cost time: 1.2886440753936768
Epoch: 11, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.297 Vali Acc: 0.271 Test Loss: 4.297 Test Acc: 0.271
Validation loss decreased (-0.252899 --> -0.270545).  Saving model ...
Epoch: 12 cost time: 1.370413064956665
Epoch: 12, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.423 Vali Acc: 0.266 Test Loss: 4.423 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.241701364517212
Epoch: 13, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.489 Vali Acc: 0.266 Test Loss: 4.489 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1541986465454102
Epoch: 14, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.551 Vali Acc: 0.271 Test Loss: 4.551 Test Acc: 0.271
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.4117519855499268
Epoch: 15, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.632 Vali Acc: 0.269 Test Loss: 4.632 Test Acc: 0.269
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.2559731006622314
Epoch: 16, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.674 Vali Acc: 0.271 Test Loss: 4.674 Test Acc: 0.271
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.452150583267212
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.695 Vali Acc: 0.271 Test Loss: 4.695 Test Acc: 0.271
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.1708853244781494
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.717 Vali Acc: 0.269 Test Loss: 4.717 Test Acc: 0.269
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.3100285530090332
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.752 Vali Acc: 0.269 Test Loss: 4.752 Test Acc: 0.269
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.4360218048095703
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.773 Vali Acc: 0.271 Test Loss: 4.773 Test Acc: 0.271
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.4890036582946777
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.807 Vali Acc: 0.275 Test Loss: 4.807 Test Acc: 0.275
Validation loss decreased (-0.270545 --> -0.275246).  Saving model ...
Epoch: 22 cost time: 1.4355087280273438
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.837 Vali Acc: 0.275 Test Loss: 4.837 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.4678373336791992
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.867 Vali Acc: 0.272 Test Loss: 4.867 Test Acc: 0.272
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.4707756042480469
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.901 Vali Acc: 0.275 Test Loss: 4.901 Test Acc: 0.275
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.7725491523742676
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.930 Vali Acc: 0.273 Test Loss: 4.930 Test Acc: 0.273
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.5195887088775635
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.963 Vali Acc: 0.274 Test Loss: 4.963 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.243159532546997
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.984 Vali Acc: 0.273 Test Loss: 4.984 Test Acc: 0.273
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.3070437908172607
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.006 Vali Acc: 0.273 Test Loss: 5.006 Test Acc: 0.273
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.3847031593322754
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.033 Vali Acc: 0.272 Test Loss: 5.033 Test Acc: 0.272
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.310331106185913
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.049 Vali Acc: 0.274 Test Loss: 5.049 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.607292890548706
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.075 Vali Acc: 0.273 Test Loss: 5.075 Test Acc: 0.273
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2752941176470588
model parameter : 665690
model size : 2.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.557865858078003
Epoch: 1, Steps: 10 | Train Loss: 3.286 Vali Loss: 3.277 Vali Acc: 0.044 Test Loss: 3.277 Test Acc: 0.044
Validation loss decreased (inf --> -0.043497).  Saving model ...
Epoch: 2 cost time: 1.2558345794677734
Epoch: 2, Steps: 10 | Train Loss: 3.167 Vali Loss: 3.267 Vali Acc: 0.055 Test Loss: 3.267 Test Acc: 0.055
Validation loss decreased (-0.043497 --> -0.055261).  Saving model ...
Epoch: 3 cost time: 1.2108027935028076
Epoch: 3, Steps: 10 | Train Loss: 2.927 Vali Loss: 3.264 Vali Acc: 0.071 Test Loss: 3.264 Test Acc: 0.071
Validation loss decreased (-0.055261 --> -0.070556).  Saving model ...
Epoch: 4 cost time: 1.165053129196167
Epoch: 4, Steps: 10 | Train Loss: 2.661 Vali Loss: 3.248 Vali Acc: 0.105 Test Loss: 3.248 Test Acc: 0.105
Validation loss decreased (-0.070556 --> -0.104673).  Saving model ...
Epoch: 5 cost time: 1.0318830013275146
Epoch: 5, Steps: 10 | Train Loss: 2.358 Vali Loss: 3.221 Vali Acc: 0.132 Test Loss: 3.221 Test Acc: 0.132
Validation loss decreased (-0.104673 --> -0.131732).  Saving model ...
Epoch: 6 cost time: 1.2972557544708252
Epoch: 6, Steps: 10 | Train Loss: 2.007 Vali Loss: 3.197 Vali Acc: 0.138 Test Loss: 3.197 Test Acc: 0.138
Validation loss decreased (-0.131732 --> -0.137615).  Saving model ...
Epoch: 7 cost time: 1.258742094039917
Epoch: 7, Steps: 10 | Train Loss: 1.630 Vali Loss: 3.208 Vali Acc: 0.167 Test Loss: 3.208 Test Acc: 0.167
Validation loss decreased (-0.137615 --> -0.167027).  Saving model ...
Epoch: 8 cost time: 1.1947908401489258
Epoch: 8, Steps: 10 | Train Loss: 1.192 Vali Loss: 3.216 Vali Acc: 0.207 Test Loss: 3.216 Test Acc: 0.207
Validation loss decreased (-0.167027 --> -0.207027).  Saving model ...
Epoch: 9 cost time: 1.3333327770233154
Epoch: 9, Steps: 10 | Train Loss: 0.818 Vali Loss: 3.297 Vali Acc: 0.227 Test Loss: 3.297 Test Acc: 0.227
Validation loss decreased (-0.207027 --> -0.227026).  Saving model ...
Epoch: 10 cost time: 1.2970657348632812
Epoch: 10, Steps: 10 | Train Loss: 0.537 Vali Loss: 3.423 Vali Acc: 0.235 Test Loss: 3.423 Test Acc: 0.235
Validation loss decreased (-0.227026 --> -0.235260).  Saving model ...
Epoch: 11 cost time: 1.2883632183074951
Epoch: 11, Steps: 10 | Train Loss: 0.329 Vali Loss: 3.626 Vali Acc: 0.245 Test Loss: 3.626 Test Acc: 0.245
Validation loss decreased (-0.235260 --> -0.244670).  Saving model ...
Epoch: 12 cost time: 1.261772871017456
Epoch: 12, Steps: 10 | Train Loss: 0.187 Vali Loss: 3.811 Vali Acc: 0.253 Test Loss: 3.811 Test Acc: 0.253
Validation loss decreased (-0.244670 --> -0.252903).  Saving model ...
Epoch: 13 cost time: 1.4778954982757568
Epoch: 13, Steps: 10 | Train Loss: 0.103 Vali Loss: 3.975 Vali Acc: 0.255 Test Loss: 3.975 Test Acc: 0.255
Validation loss decreased (-0.252903 --> -0.255254).  Saving model ...
Epoch: 14 cost time: 1.3483424186706543
Epoch: 14, Steps: 10 | Train Loss: 0.056 Vali Loss: 4.136 Vali Acc: 0.253 Test Loss: 4.136 Test Acc: 0.253
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5493018627166748
Epoch: 15, Steps: 10 | Train Loss: 0.039 Vali Loss: 4.212 Vali Acc: 0.262 Test Loss: 4.212 Test Acc: 0.262
Validation loss decreased (-0.255254 --> -0.262311).  Saving model ...
Epoch: 16 cost time: 1.6574394702911377
Epoch: 16, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.288 Vali Acc: 0.267 Test Loss: 4.288 Test Acc: 0.267
Validation loss decreased (-0.262311 --> -0.267016).  Saving model ...
Epoch: 17 cost time: 1.2757267951965332
Epoch: 17, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.377 Vali Acc: 0.262 Test Loss: 4.377 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.435692548751831
Epoch: 18, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.441 Vali Acc: 0.269 Test Loss: 4.441 Test Acc: 0.269
Validation loss decreased (-0.267016 --> -0.269367).  Saving model ...
Epoch: 19 cost time: 1.349416732788086
Epoch: 19, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.496 Vali Acc: 0.272 Test Loss: 4.496 Test Acc: 0.272
Validation loss decreased (-0.269367 --> -0.271720).  Saving model ...
Epoch: 20 cost time: 1.6207520961761475
Epoch: 20, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.533 Vali Acc: 0.279 Test Loss: 4.533 Test Acc: 0.279
Validation loss decreased (-0.271720 --> -0.278778).  Saving model ...
Epoch: 21 cost time: 1.3561909198760986
Epoch: 21, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.580 Vali Acc: 0.271 Test Loss: 4.580 Test Acc: 0.271
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.587770938873291
Epoch: 22, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.625 Vali Acc: 0.272 Test Loss: 4.625 Test Acc: 0.272
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.2866225242614746
Epoch: 23, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.666 Vali Acc: 0.273 Test Loss: 4.666 Test Acc: 0.273
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.6715567111968994
Epoch: 24, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.697 Vali Acc: 0.271 Test Loss: 4.697 Test Acc: 0.271
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.1715710163116455
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.741 Vali Acc: 0.274 Test Loss: 4.741 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.328782320022583
Epoch: 26, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.771 Vali Acc: 0.273 Test Loss: 4.771 Test Acc: 0.273
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.285379409790039
Epoch: 27, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.810 Vali Acc: 0.272 Test Loss: 4.810 Test Acc: 0.272
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.2797839641571045
Epoch: 28, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.840 Vali Acc: 0.273 Test Loss: 4.840 Test Acc: 0.273
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.362762689590454
Epoch: 29, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.872 Vali Acc: 0.275 Test Loss: 4.872 Test Acc: 0.275
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.2182912826538086
Epoch: 30, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.899 Vali Acc: 0.276 Test Loss: 4.899 Test Acc: 0.276
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2788235294117647
model parameter : 476250
model size : 1.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps12_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.8712968826293945
Epoch: 1, Steps: 10 | Train Loss: 3.277 Vali Loss: 3.256 Vali Acc: 0.041 Test Loss: 3.256 Test Acc: 0.041
Validation loss decreased (inf --> -0.041144).  Saving model ...
Epoch: 2 cost time: 1.1620609760284424
Epoch: 2, Steps: 10 | Train Loss: 3.177 Vali Loss: 3.244 Vali Acc: 0.049 Test Loss: 3.244 Test Acc: 0.049
Validation loss decreased (-0.041144 --> -0.049379).  Saving model ...
Epoch: 3 cost time: 1.094374418258667
Epoch: 3, Steps: 10 | Train Loss: 3.006 Vali Loss: 3.234 Vali Acc: 0.072 Test Loss: 3.234 Test Acc: 0.072
Validation loss decreased (-0.049379 --> -0.071732).  Saving model ...
Epoch: 4 cost time: 1.3596808910369873
Epoch: 4, Steps: 10 | Train Loss: 2.822 Vali Loss: 3.238 Vali Acc: 0.081 Test Loss: 3.238 Test Acc: 0.081
Validation loss decreased (-0.071732 --> -0.081144).  Saving model ...
Epoch: 5 cost time: 1.0937974452972412
Epoch: 5, Steps: 10 | Train Loss: 2.592 Vali Loss: 3.216 Vali Acc: 0.113 Test Loss: 3.216 Test Acc: 0.113
Validation loss decreased (-0.081144 --> -0.112909).  Saving model ...
Epoch: 6 cost time: 1.3765676021575928
Epoch: 6, Steps: 10 | Train Loss: 2.347 Vali Loss: 3.199 Vali Acc: 0.129 Test Loss: 3.199 Test Acc: 0.129
Validation loss decreased (-0.112909 --> -0.129380).  Saving model ...
Epoch: 7 cost time: 1.0503969192504883
Epoch: 7, Steps: 10 | Train Loss: 2.052 Vali Loss: 3.187 Vali Acc: 0.138 Test Loss: 3.187 Test Acc: 0.138
Validation loss decreased (-0.129380 --> -0.137615).  Saving model ...
Epoch: 8 cost time: 1.3953502178192139
Epoch: 8, Steps: 10 | Train Loss: 1.737 Vali Loss: 3.164 Vali Acc: 0.179 Test Loss: 3.164 Test Acc: 0.179
Validation loss decreased (-0.137615 --> -0.178792).  Saving model ...
Epoch: 9 cost time: 1.1825401782989502
Epoch: 9, Steps: 10 | Train Loss: 1.410 Vali Loss: 3.181 Vali Acc: 0.202 Test Loss: 3.181 Test Acc: 0.202
Validation loss decreased (-0.178792 --> -0.202321).  Saving model ...
Epoch: 10 cost time: 1.3269093036651611
Epoch: 10, Steps: 10 | Train Loss: 1.111 Vali Loss: 3.224 Vali Acc: 0.216 Test Loss: 3.224 Test Acc: 0.216
Validation loss decreased (-0.202321 --> -0.216438).  Saving model ...
Epoch: 11 cost time: 1.1844031810760498
Epoch: 11, Steps: 10 | Train Loss: 0.813 Vali Loss: 3.273 Vali Acc: 0.231 Test Loss: 3.273 Test Acc: 0.231
Validation loss decreased (-0.216438 --> -0.230556).  Saving model ...
Epoch: 12 cost time: 1.241312026977539
Epoch: 12, Steps: 10 | Train Loss: 0.568 Vali Loss: 3.377 Vali Acc: 0.246 Test Loss: 3.377 Test Acc: 0.246
Validation loss decreased (-0.230556 --> -0.245849).  Saving model ...
Epoch: 13 cost time: 1.3617901802062988
Epoch: 13, Steps: 10 | Train Loss: 0.400 Vali Loss: 3.498 Vali Acc: 0.247 Test Loss: 3.498 Test Acc: 0.247
Validation loss decreased (-0.245849 --> -0.247024).  Saving model ...
Epoch: 14 cost time: 1.3939473628997803
Epoch: 14, Steps: 10 | Train Loss: 0.253 Vali Loss: 3.639 Vali Acc: 0.261 Test Loss: 3.639 Test Acc: 0.261
Validation loss decreased (-0.247024 --> -0.261140).  Saving model ...
Epoch: 15 cost time: 1.3262853622436523
Epoch: 15, Steps: 10 | Train Loss: 0.161 Vali Loss: 3.809 Vali Acc: 0.256 Test Loss: 3.809 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3030004501342773
Epoch: 16, Steps: 10 | Train Loss: 0.103 Vali Loss: 3.898 Vali Acc: 0.262 Test Loss: 3.898 Test Acc: 0.262
Validation loss decreased (-0.261140 --> -0.262314).  Saving model ...
Epoch: 17 cost time: 1.2373995780944824
Epoch: 17, Steps: 10 | Train Loss: 0.072 Vali Loss: 4.014 Vali Acc: 0.254 Test Loss: 4.014 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3549280166625977
Epoch: 18, Steps: 10 | Train Loss: 0.052 Vali Loss: 4.089 Vali Acc: 0.254 Test Loss: 4.089 Test Acc: 0.254
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.1586384773254395
Epoch: 19, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.146 Vali Acc: 0.261 Test Loss: 4.146 Test Acc: 0.261
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.227973222732544
Epoch: 20, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.210 Vali Acc: 0.264 Test Loss: 4.210 Test Acc: 0.264
Validation loss decreased (-0.262314 --> -0.263487).  Saving model ...
Epoch: 21 cost time: 1.6552329063415527
Epoch: 21, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.274 Vali Acc: 0.262 Test Loss: 4.274 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1769471168518066
Epoch: 22, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.343 Vali Acc: 0.264 Test Loss: 4.343 Test Acc: 0.264
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.485382080078125
Epoch: 23, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.391 Vali Acc: 0.260 Test Loss: 4.391 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.281264066696167
Epoch: 24, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.421 Vali Acc: 0.261 Test Loss: 4.421 Test Acc: 0.261
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.3136405944824219
Epoch: 25, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.466 Vali Acc: 0.266 Test Loss: 4.466 Test Acc: 0.266
Validation loss decreased (-0.263487 --> -0.265838).  Saving model ...
Epoch: 26 cost time: 1.1802773475646973
Epoch: 26, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.499 Vali Acc: 0.269 Test Loss: 4.499 Test Acc: 0.269
Validation loss decreased (-0.265838 --> -0.269367).  Saving model ...
Epoch: 27 cost time: 1.113157033920288
Epoch: 27, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.531 Vali Acc: 0.272 Test Loss: 4.531 Test Acc: 0.272
Validation loss decreased (-0.269367 --> -0.271719).  Saving model ...
Epoch: 28 cost time: 1.2468605041503906
Epoch: 28, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.576 Vali Acc: 0.272 Test Loss: 4.576 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.2841413021087646
Epoch: 29, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.611 Vali Acc: 0.271 Test Loss: 4.611 Test Acc: 0.271
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.179290533065796
Epoch: 30, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.639 Vali Acc: 0.269 Test Loss: 4.639 Test Acc: 0.269
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.1911144256591797
Epoch: 31, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.666 Vali Acc: 0.273 Test Loss: 4.666 Test Acc: 0.273
Validation loss decreased (-0.271719 --> -0.272895).  Saving model ...
Epoch: 32 cost time: 0.9738450050354004
Epoch: 32, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.697 Vali Acc: 0.271 Test Loss: 4.697 Test Acc: 0.271
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.4254217147827148
Epoch: 33, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.725 Vali Acc: 0.272 Test Loss: 4.725 Test Acc: 0.272
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.2429144382476807
Epoch: 34, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.758 Vali Acc: 0.272 Test Loss: 4.758 Test Acc: 0.272
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.2648394107818604
Epoch: 35, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.800 Vali Acc: 0.271 Test Loss: 4.800 Test Acc: 0.271
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.4305977821350098
Epoch: 36, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.823 Vali Acc: 0.269 Test Loss: 4.823 Test Acc: 0.269
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.401747703552246
Epoch: 37, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.852 Vali Acc: 0.269 Test Loss: 4.852 Test Acc: 0.269
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.3140895366668701
Epoch: 38, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.866 Vali Acc: 0.271 Test Loss: 4.866 Test Acc: 0.271
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.3437018394470215
Epoch: 39, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.889 Vali Acc: 0.266 Test Loss: 4.889 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.2170310020446777
Epoch: 40, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.904 Vali Acc: 0.266 Test Loss: 4.904 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.2230875492095947
Epoch: 41, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.933 Vali Acc: 0.271 Test Loss: 4.933 Test Acc: 0.271
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps12_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27294117647058824
model parameter : 416602
model size : 1.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.0172698497772217
Epoch: 1, Steps: 10 | Train Loss: 3.251 Vali Loss: 3.261 Vali Acc: 0.046 Test Loss: 3.261 Test Acc: 0.046
Validation loss decreased (inf --> -0.045850).  Saving model ...
Epoch: 2 cost time: 1.0417933464050293
Epoch: 2, Steps: 10 | Train Loss: 3.176 Vali Loss: 3.251 Vali Acc: 0.061 Test Loss: 3.251 Test Acc: 0.061
Validation loss decreased (-0.045850 --> -0.061144).  Saving model ...
Epoch: 3 cost time: 1.0450165271759033
Epoch: 3, Steps: 10 | Train Loss: 3.041 Vali Loss: 3.241 Vali Acc: 0.082 Test Loss: 3.241 Test Acc: 0.082
Validation loss decreased (-0.061144 --> -0.082321).  Saving model ...
Epoch: 4 cost time: 1.081803560256958
Epoch: 4, Steps: 10 | Train Loss: 2.899 Vali Loss: 3.237 Vali Acc: 0.100 Test Loss: 3.237 Test Acc: 0.100
Validation loss decreased (-0.082321 --> -0.099968).  Saving model ...
Epoch: 5 cost time: 1.5390915870666504
Epoch: 5, Steps: 10 | Train Loss: 2.703 Vali Loss: 3.231 Vali Acc: 0.124 Test Loss: 3.231 Test Acc: 0.124
Validation loss decreased (-0.099968 --> -0.123497).  Saving model ...
Epoch: 6 cost time: 1.2586982250213623
Epoch: 6, Steps: 10 | Train Loss: 2.510 Vali Loss: 3.221 Vali Acc: 0.138 Test Loss: 3.221 Test Acc: 0.138
Validation loss decreased (-0.123497 --> -0.137615).  Saving model ...
Epoch: 7 cost time: 1.2750792503356934
Epoch: 7, Steps: 10 | Train Loss: 2.267 Vali Loss: 3.201 Vali Acc: 0.147 Test Loss: 3.201 Test Acc: 0.147
Validation loss decreased (-0.137615 --> -0.147027).  Saving model ...
Epoch: 8 cost time: 1.261918067932129
Epoch: 8, Steps: 10 | Train Loss: 2.020 Vali Loss: 3.189 Vali Acc: 0.161 Test Loss: 3.189 Test Acc: 0.161
Validation loss decreased (-0.147027 --> -0.161145).  Saving model ...
Epoch: 9 cost time: 1.1185941696166992
Epoch: 9, Steps: 10 | Train Loss: 1.739 Vali Loss: 3.176 Vali Acc: 0.180 Test Loss: 3.176 Test Acc: 0.180
Validation loss decreased (-0.161145 --> -0.179968).  Saving model ...
Epoch: 10 cost time: 1.2235569953918457
Epoch: 10, Steps: 10 | Train Loss: 1.477 Vali Loss: 3.191 Vali Acc: 0.195 Test Loss: 3.191 Test Acc: 0.195
Validation loss decreased (-0.179968 --> -0.195262).  Saving model ...
Epoch: 11 cost time: 1.1816706657409668
Epoch: 11, Steps: 10 | Train Loss: 1.206 Vali Loss: 3.224 Vali Acc: 0.200 Test Loss: 3.224 Test Acc: 0.200
Validation loss decreased (-0.195262 --> -0.199968).  Saving model ...
Epoch: 12 cost time: 0.9967765808105469
Epoch: 12, Steps: 10 | Train Loss: 0.890 Vali Loss: 3.272 Vali Acc: 0.218 Test Loss: 3.272 Test Acc: 0.218
Validation loss decreased (-0.199968 --> -0.217614).  Saving model ...
Epoch: 13 cost time: 1.0130360126495361
Epoch: 13, Steps: 10 | Train Loss: 0.678 Vali Loss: 3.334 Vali Acc: 0.242 Test Loss: 3.334 Test Acc: 0.242
Validation loss decreased (-0.217614 --> -0.242320).  Saving model ...
Epoch: 14 cost time: 1.245220422744751
Epoch: 14, Steps: 10 | Train Loss: 0.511 Vali Loss: 3.417 Vali Acc: 0.240 Test Loss: 3.417 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2019867897033691
Epoch: 15, Steps: 10 | Train Loss: 0.360 Vali Loss: 3.541 Vali Acc: 0.266 Test Loss: 3.541 Test Acc: 0.266
Validation loss decreased (-0.242320 --> -0.265847).  Saving model ...
Epoch: 16 cost time: 1.1890711784362793
Epoch: 16, Steps: 10 | Train Loss: 0.243 Vali Loss: 3.653 Vali Acc: 0.272 Test Loss: 3.653 Test Acc: 0.272
Validation loss decreased (-0.265847 --> -0.271728).  Saving model ...
Epoch: 17 cost time: 1.1343908309936523
Epoch: 17, Steps: 10 | Train Loss: 0.169 Vali Loss: 3.760 Vali Acc: 0.264 Test Loss: 3.760 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.203861951828003
Epoch: 18, Steps: 10 | Train Loss: 0.115 Vali Loss: 3.861 Vali Acc: 0.274 Test Loss: 3.861 Test Acc: 0.274
Validation loss decreased (-0.271728 --> -0.274079).  Saving model ...
Epoch: 19 cost time: 1.2469966411590576
Epoch: 19, Steps: 10 | Train Loss: 0.093 Vali Loss: 3.946 Vali Acc: 0.275 Test Loss: 3.946 Test Acc: 0.275
Validation loss decreased (-0.274079 --> -0.275255).  Saving model ...
Epoch: 20 cost time: 1.160752773284912
Epoch: 20, Steps: 10 | Train Loss: 0.063 Vali Loss: 4.016 Vali Acc: 0.281 Test Loss: 4.016 Test Acc: 0.281
Validation loss decreased (-0.275255 --> -0.281136).  Saving model ...
Epoch: 21 cost time: 1.0939042568206787
Epoch: 21, Steps: 10 | Train Loss: 0.051 Vali Loss: 4.068 Vali Acc: 0.282 Test Loss: 4.068 Test Acc: 0.282
Validation loss decreased (-0.281136 --> -0.282312).  Saving model ...
Epoch: 22 cost time: 1.2627956867218018
Epoch: 22, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.128 Vali Acc: 0.288 Test Loss: 4.128 Test Acc: 0.288
Validation loss decreased (-0.282312 --> -0.288194).  Saving model ...
Epoch: 23 cost time: 1.210035800933838
Epoch: 23, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.176 Vali Acc: 0.284 Test Loss: 4.176 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.1162264347076416
Epoch: 24, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.237 Vali Acc: 0.281 Test Loss: 4.237 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.0783116817474365
Epoch: 25, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.271 Vali Acc: 0.284 Test Loss: 4.271 Test Acc: 0.284
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.3666484355926514
Epoch: 26, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.315 Vali Acc: 0.284 Test Loss: 4.315 Test Acc: 0.284
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.3465571403503418
Epoch: 27, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.374 Vali Acc: 0.282 Test Loss: 4.374 Test Acc: 0.282
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.2877817153930664
Epoch: 28, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.399 Vali Acc: 0.282 Test Loss: 4.399 Test Acc: 0.282
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.1957223415374756
Epoch: 29, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.426 Vali Acc: 0.284 Test Loss: 4.426 Test Acc: 0.284
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.092005968093872
Epoch: 30, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.459 Vali Acc: 0.284 Test Loss: 4.459 Test Acc: 0.284
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.206009864807129
Epoch: 31, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.504 Vali Acc: 0.282 Test Loss: 4.504 Test Acc: 0.282
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.2278966903686523
Epoch: 32, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.531 Vali Acc: 0.284 Test Loss: 4.531 Test Acc: 0.284
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.28823529411764703
model parameter : 386906
model size : 1.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps23_str12_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.6729342937469482
Epoch: 1, Steps: 10 | Train Loss: 3.288 Vali Loss: 3.261 Vali Acc: 0.046 Test Loss: 3.261 Test Acc: 0.046
Validation loss decreased (inf --> -0.045850).  Saving model ...
Epoch: 2 cost time: 1.240602731704712
Epoch: 2, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.254 Vali Acc: 0.054 Test Loss: 3.254 Test Acc: 0.054
Validation loss decreased (-0.045850 --> -0.054085).  Saving model ...
Epoch: 3 cost time: 1.2137179374694824
Epoch: 3, Steps: 10 | Train Loss: 3.141 Vali Loss: 3.246 Vali Acc: 0.071 Test Loss: 3.246 Test Acc: 0.071
Validation loss decreased (-0.054085 --> -0.070556).  Saving model ...
Epoch: 4 cost time: 1.1768951416015625
Epoch: 4, Steps: 10 | Train Loss: 3.045 Vali Loss: 3.239 Vali Acc: 0.076 Test Loss: 3.239 Test Acc: 0.076
Validation loss decreased (-0.070556 --> -0.076438).  Saving model ...
Epoch: 5 cost time: 1.0830111503601074
Epoch: 5, Steps: 10 | Train Loss: 2.910 Vali Loss: 3.232 Vali Acc: 0.080 Test Loss: 3.232 Test Acc: 0.080
Validation loss decreased (-0.076438 --> -0.079968).  Saving model ...
Epoch: 6 cost time: 1.1737236976623535
Epoch: 6, Steps: 10 | Train Loss: 2.743 Vali Loss: 3.226 Vali Acc: 0.085 Test Loss: 3.226 Test Acc: 0.085
Validation loss decreased (-0.079968 --> -0.084674).  Saving model ...
Epoch: 7 cost time: 1.075610637664795
Epoch: 7, Steps: 10 | Train Loss: 2.599 Vali Loss: 3.219 Vali Acc: 0.104 Test Loss: 3.219 Test Acc: 0.104
Validation loss decreased (-0.084674 --> -0.103497).  Saving model ...
Epoch: 8 cost time: 1.2713100910186768
Epoch: 8, Steps: 10 | Train Loss: 2.431 Vali Loss: 3.207 Vali Acc: 0.109 Test Loss: 3.207 Test Acc: 0.109
Validation loss decreased (-0.103497 --> -0.109380).  Saving model ...
Epoch: 9 cost time: 1.2181732654571533
Epoch: 9, Steps: 10 | Train Loss: 2.235 Vali Loss: 3.206 Vali Acc: 0.127 Test Loss: 3.206 Test Acc: 0.127
Validation loss decreased (-0.109380 --> -0.127027).  Saving model ...
Epoch: 10 cost time: 1.2130546569824219
Epoch: 10, Steps: 10 | Train Loss: 2.016 Vali Loss: 3.199 Vali Acc: 0.138 Test Loss: 3.199 Test Acc: 0.138
Validation loss decreased (-0.127027 --> -0.137615).  Saving model ...
Epoch: 11 cost time: 1.185866117477417
Epoch: 11, Steps: 10 | Train Loss: 1.795 Vali Loss: 3.196 Vali Acc: 0.156 Test Loss: 3.196 Test Acc: 0.156
Validation loss decreased (-0.137615 --> -0.156439).  Saving model ...
Epoch: 12 cost time: 1.3196985721588135
Epoch: 12, Steps: 10 | Train Loss: 1.538 Vali Loss: 3.194 Vali Acc: 0.176 Test Loss: 3.194 Test Acc: 0.176
Validation loss decreased (-0.156439 --> -0.176439).  Saving model ...
Epoch: 13 cost time: 1.0748813152313232
Epoch: 13, Steps: 10 | Train Loss: 1.350 Vali Loss: 3.211 Vali Acc: 0.184 Test Loss: 3.211 Test Acc: 0.184
Validation loss decreased (-0.176439 --> -0.183497).  Saving model ...
Epoch: 14 cost time: 1.4393093585968018
Epoch: 14, Steps: 10 | Train Loss: 1.101 Vali Loss: 3.236 Vali Acc: 0.200 Test Loss: 3.236 Test Acc: 0.200
Validation loss decreased (-0.183497 --> -0.199968).  Saving model ...
Epoch: 15 cost time: 1.1439104080200195
Epoch: 15, Steps: 10 | Train Loss: 0.908 Vali Loss: 3.282 Vali Acc: 0.216 Test Loss: 3.282 Test Acc: 0.216
Validation loss decreased (-0.199968 --> -0.216438).  Saving model ...
Epoch: 16 cost time: 1.2528719902038574
Epoch: 16, Steps: 10 | Train Loss: 0.758 Vali Loss: 3.322 Vali Acc: 0.228 Test Loss: 3.322 Test Acc: 0.228
Validation loss decreased (-0.216438 --> -0.228202).  Saving model ...
Epoch: 17 cost time: 1.2849478721618652
Epoch: 17, Steps: 10 | Train Loss: 0.558 Vali Loss: 3.378 Vali Acc: 0.233 Test Loss: 3.378 Test Acc: 0.233
Validation loss decreased (-0.228202 --> -0.232907).  Saving model ...
Epoch: 18 cost time: 1.269446611404419
Epoch: 18, Steps: 10 | Train Loss: 0.443 Vali Loss: 3.442 Vali Acc: 0.244 Test Loss: 3.442 Test Acc: 0.244
Validation loss decreased (-0.232907 --> -0.243495).  Saving model ...
Epoch: 19 cost time: 1.3124959468841553
Epoch: 19, Steps: 10 | Train Loss: 0.321 Vali Loss: 3.534 Vali Acc: 0.249 Test Loss: 3.534 Test Acc: 0.249
Validation loss decreased (-0.243495 --> -0.249376).  Saving model ...
Epoch: 20 cost time: 1.2419638633728027
Epoch: 20, Steps: 10 | Train Loss: 0.248 Vali Loss: 3.588 Vali Acc: 0.252 Test Loss: 3.588 Test Acc: 0.252
Validation loss decreased (-0.249376 --> -0.251729).  Saving model ...
Epoch: 21 cost time: 1.1709372997283936
Epoch: 21, Steps: 10 | Train Loss: 0.187 Vali Loss: 3.657 Vali Acc: 0.253 Test Loss: 3.657 Test Acc: 0.253
Validation loss decreased (-0.251729 --> -0.252905).  Saving model ...
Epoch: 22 cost time: 1.232692003250122
Epoch: 22, Steps: 10 | Train Loss: 0.146 Vali Loss: 3.729 Vali Acc: 0.261 Test Loss: 3.729 Test Acc: 0.261
Validation loss decreased (-0.252905 --> -0.261139).  Saving model ...
Epoch: 23 cost time: 1.3201897144317627
Epoch: 23, Steps: 10 | Train Loss: 0.113 Vali Loss: 3.792 Vali Acc: 0.262 Test Loss: 3.792 Test Acc: 0.262
Validation loss decreased (-0.261139 --> -0.262315).  Saving model ...
Epoch: 24 cost time: 1.4579715728759766
Epoch: 24, Steps: 10 | Train Loss: 0.095 Vali Loss: 3.846 Vali Acc: 0.260 Test Loss: 3.846 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.4653234481811523
Epoch: 25, Steps: 10 | Train Loss: 0.072 Vali Loss: 3.883 Vali Acc: 0.266 Test Loss: 3.883 Test Acc: 0.266
Validation loss decreased (-0.262315 --> -0.265844).  Saving model ...
Epoch: 26 cost time: 1.364074468612671
Epoch: 26, Steps: 10 | Train Loss: 0.061 Vali Loss: 3.927 Vali Acc: 0.274 Test Loss: 3.927 Test Acc: 0.274
Validation loss decreased (-0.265844 --> -0.274078).  Saving model ...
Epoch: 27 cost time: 1.3358335494995117
Epoch: 27, Steps: 10 | Train Loss: 0.057 Vali Loss: 3.964 Vali Acc: 0.275 Test Loss: 3.964 Test Acc: 0.275
Validation loss decreased (-0.274078 --> -0.275254).  Saving model ...
Epoch: 28 cost time: 1.4516587257385254
Epoch: 28, Steps: 10 | Train Loss: 0.047 Vali Loss: 4.012 Vali Acc: 0.273 Test Loss: 4.012 Test Acc: 0.273
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.2959394454956055
Epoch: 29, Steps: 10 | Train Loss: 0.039 Vali Loss: 4.025 Vali Acc: 0.272 Test Loss: 4.025 Test Acc: 0.272
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.3909447193145752
Epoch: 30, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.058 Vali Acc: 0.276 Test Loss: 4.058 Test Acc: 0.276
Validation loss decreased (-0.275254 --> -0.276430).  Saving model ...
Epoch: 31 cost time: 1.5588996410369873
Epoch: 31, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.080 Vali Acc: 0.280 Test Loss: 4.080 Test Acc: 0.280
Validation loss decreased (-0.276430 --> -0.279959).  Saving model ...
Epoch: 32 cost time: 1.527672529220581
Epoch: 32, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.109 Vali Acc: 0.286 Test Loss: 4.109 Test Acc: 0.286
Validation loss decreased (-0.279959 --> -0.285841).  Saving model ...
Epoch: 33 cost time: 1.717456340789795
Epoch: 33, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.158 Vali Acc: 0.284 Test Loss: 4.158 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.1338880062103271
Epoch: 34, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.195 Vali Acc: 0.281 Test Loss: 4.195 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.3648288249969482
Epoch: 35, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.217 Vali Acc: 0.284 Test Loss: 4.217 Test Acc: 0.284
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.252845048904419
Epoch: 36, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.239 Vali Acc: 0.279 Test Loss: 4.239 Test Acc: 0.279
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.3941528797149658
Epoch: 37, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.276 Vali Acc: 0.281 Test Loss: 4.276 Test Acc: 0.281
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.1090352535247803
Epoch: 38, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.302 Vali Acc: 0.281 Test Loss: 4.302 Test Acc: 0.281
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.2575154304504395
Epoch: 39, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.316 Vali Acc: 0.281 Test Loss: 4.316 Test Acc: 0.281
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.212254524230957
Epoch: 40, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.333 Vali Acc: 0.285 Test Loss: 4.333 Test Acc: 0.285
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.2460391521453857
Epoch: 41, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.343 Vali Acc: 0.287 Test Loss: 4.343 Test Acc: 0.287
Validation loss decreased (-0.285841 --> -0.287015).  Saving model ...
Epoch: 42 cost time: 1.4590539932250977
Epoch: 42, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.371 Vali Acc: 0.285 Test Loss: 4.371 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.3326032161712646
Epoch: 43, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.381 Vali Acc: 0.286 Test Loss: 4.381 Test Acc: 0.286
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.7104721069335938
Epoch: 44, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.402 Vali Acc: 0.286 Test Loss: 4.402 Test Acc: 0.286
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.221452236175537
Epoch: 45, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.419 Vali Acc: 0.287 Test Loss: 4.419 Test Acc: 0.287
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.5805714130401611
Epoch: 46, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.444 Vali Acc: 0.286 Test Loss: 4.444 Test Acc: 0.286
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.6435730457305908
Epoch: 47, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.467 Vali Acc: 0.286 Test Loss: 4.467 Test Acc: 0.286
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.652383804321289
Epoch: 48, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.487 Vali Acc: 0.286 Test Loss: 4.487 Test Acc: 0.286
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 1.5256695747375488
Epoch: 49, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.489 Vali Acc: 0.282 Test Loss: 4.489 Test Acc: 0.282
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 1.4260509014129639
Epoch: 50, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.513 Vali Acc: 0.286 Test Loss: 4.513 Test Acc: 0.286
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps23_str12_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.28705882352941176
model parameter : 347418
model size : 1.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.2317967414855957
Epoch: 1, Steps: 10 | Train Loss: 3.285 Vali Loss: 3.267 Vali Acc: 0.041 Test Loss: 3.267 Test Acc: 0.041
Validation loss decreased (inf --> -0.041144).  Saving model ...
Epoch: 2 cost time: 1.31960129737854
Epoch: 2, Steps: 10 | Train Loss: 3.224 Vali Loss: 3.261 Vali Acc: 0.055 Test Loss: 3.261 Test Acc: 0.055
Validation loss decreased (-0.041144 --> -0.055262).  Saving model ...
Epoch: 3 cost time: 1.0893709659576416
Epoch: 3, Steps: 10 | Train Loss: 3.162 Vali Loss: 3.252 Vali Acc: 0.067 Test Loss: 3.252 Test Acc: 0.067
Validation loss decreased (-0.055262 --> -0.067026).  Saving model ...
Epoch: 4 cost time: 1.1950292587280273
Epoch: 4, Steps: 10 | Train Loss: 3.052 Vali Loss: 3.246 Vali Acc: 0.073 Test Loss: 3.246 Test Acc: 0.073
Validation loss decreased (-0.067026 --> -0.072909).  Saving model ...
Epoch: 5 cost time: 1.3221516609191895
Epoch: 5, Steps: 10 | Train Loss: 2.934 Vali Loss: 3.240 Vali Acc: 0.076 Test Loss: 3.240 Test Acc: 0.076
Validation loss decreased (-0.072909 --> -0.076438).  Saving model ...
Epoch: 6 cost time: 1.1884374618530273
Epoch: 6, Steps: 10 | Train Loss: 2.811 Vali Loss: 3.234 Vali Acc: 0.096 Test Loss: 3.234 Test Acc: 0.096
Validation loss decreased (-0.076438 --> -0.096438).  Saving model ...
Epoch: 7 cost time: 1.3359317779541016
Epoch: 7, Steps: 10 | Train Loss: 2.717 Vali Loss: 3.228 Vali Acc: 0.101 Test Loss: 3.228 Test Acc: 0.101
Validation loss decreased (-0.096438 --> -0.101144).  Saving model ...
Epoch: 8 cost time: 1.1203813552856445
Epoch: 8, Steps: 10 | Train Loss: 2.548 Vali Loss: 3.218 Vali Acc: 0.115 Test Loss: 3.218 Test Acc: 0.115
Validation loss decreased (-0.101144 --> -0.115262).  Saving model ...
Epoch: 9 cost time: 1.331514596939087
Epoch: 9, Steps: 10 | Train Loss: 2.394 Vali Loss: 3.211 Vali Acc: 0.131 Test Loss: 3.211 Test Acc: 0.131
Validation loss decreased (-0.115262 --> -0.130556).  Saving model ...
Epoch: 10 cost time: 1.2796218395233154
Epoch: 10, Steps: 10 | Train Loss: 2.230 Vali Loss: 3.199 Vali Acc: 0.144 Test Loss: 3.199 Test Acc: 0.144
Validation loss decreased (-0.130556 --> -0.143497).  Saving model ...
Epoch: 11 cost time: 1.3547077178955078
Epoch: 11, Steps: 10 | Train Loss: 2.059 Vali Loss: 3.192 Vali Acc: 0.153 Test Loss: 3.192 Test Acc: 0.153
Validation loss decreased (-0.143497 --> -0.152909).  Saving model ...
Epoch: 12 cost time: 1.441617488861084
Epoch: 12, Steps: 10 | Train Loss: 1.859 Vali Loss: 3.185 Vali Acc: 0.169 Test Loss: 3.185 Test Acc: 0.169
Validation loss decreased (-0.152909 --> -0.169380).  Saving model ...
Epoch: 13 cost time: 1.4889037609100342
Epoch: 13, Steps: 10 | Train Loss: 1.655 Vali Loss: 3.192 Vali Acc: 0.176 Test Loss: 3.192 Test Acc: 0.176
Validation loss decreased (-0.169380 --> -0.176439).  Saving model ...
Epoch: 14 cost time: 1.4850194454193115
Epoch: 14, Steps: 10 | Train Loss: 1.430 Vali Loss: 3.197 Vali Acc: 0.194 Test Loss: 3.197 Test Acc: 0.194
Validation loss decreased (-0.176439 --> -0.194086).  Saving model ...
Epoch: 15 cost time: 1.50211501121521
Epoch: 15, Steps: 10 | Train Loss: 1.224 Vali Loss: 3.215 Vali Acc: 0.204 Test Loss: 3.215 Test Acc: 0.204
Validation loss decreased (-0.194086 --> -0.203497).  Saving model ...
Epoch: 16 cost time: 1.3248767852783203
Epoch: 16, Steps: 10 | Train Loss: 1.081 Vali Loss: 3.232 Vali Acc: 0.214 Test Loss: 3.232 Test Acc: 0.214
Validation loss decreased (-0.203497 --> -0.214085).  Saving model ...
Epoch: 17 cost time: 1.49601149559021
Epoch: 17, Steps: 10 | Train Loss: 0.878 Vali Loss: 3.257 Vali Acc: 0.224 Test Loss: 3.257 Test Acc: 0.224
Validation loss decreased (-0.214085 --> -0.223497).  Saving model ...
Epoch: 18 cost time: 1.248605728149414
Epoch: 18, Steps: 10 | Train Loss: 0.745 Vali Loss: 3.301 Vali Acc: 0.224 Test Loss: 3.301 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2597086429595947
Epoch: 19, Steps: 10 | Train Loss: 0.573 Vali Loss: 3.336 Vali Acc: 0.236 Test Loss: 3.336 Test Acc: 0.236
Validation loss decreased (-0.223497 --> -0.236437).  Saving model ...
Epoch: 20 cost time: 1.453772783279419
Epoch: 20, Steps: 10 | Train Loss: 0.452 Vali Loss: 3.388 Vali Acc: 0.245 Test Loss: 3.388 Test Acc: 0.245
Validation loss decreased (-0.236437 --> -0.244672).  Saving model ...
Epoch: 21 cost time: 1.6489627361297607
Epoch: 21, Steps: 10 | Train Loss: 0.352 Vali Loss: 3.456 Vali Acc: 0.251 Test Loss: 3.456 Test Acc: 0.251
Validation loss decreased (-0.244672 --> -0.250554).  Saving model ...
Epoch: 22 cost time: 1.5551249980926514
Epoch: 22, Steps: 10 | Train Loss: 0.270 Vali Loss: 3.506 Vali Acc: 0.253 Test Loss: 3.506 Test Acc: 0.253
Validation loss decreased (-0.250554 --> -0.252906).  Saving model ...
Epoch: 23 cost time: 1.550144910812378
Epoch: 23, Steps: 10 | Train Loss: 0.220 Vali Loss: 3.553 Vali Acc: 0.266 Test Loss: 3.553 Test Acc: 0.266
Validation loss decreased (-0.252906 --> -0.265847).  Saving model ...
Epoch: 24 cost time: 1.4356045722961426
Epoch: 24, Steps: 10 | Train Loss: 0.177 Vali Loss: 3.627 Vali Acc: 0.259 Test Loss: 3.627 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.5020644664764404
Epoch: 25, Steps: 10 | Train Loss: 0.158 Vali Loss: 3.666 Vali Acc: 0.261 Test Loss: 3.666 Test Acc: 0.261
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.5703105926513672
Epoch: 26, Steps: 10 | Train Loss: 0.111 Vali Loss: 3.728 Vali Acc: 0.261 Test Loss: 3.728 Test Acc: 0.261
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.403135061264038
Epoch: 27, Steps: 10 | Train Loss: 0.099 Vali Loss: 3.791 Vali Acc: 0.264 Test Loss: 3.791 Test Acc: 0.264
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.4308831691741943
Epoch: 28, Steps: 10 | Train Loss: 0.082 Vali Loss: 3.820 Vali Acc: 0.269 Test Loss: 3.820 Test Acc: 0.269
Validation loss decreased (-0.265847 --> -0.269374).  Saving model ...
Epoch: 29 cost time: 1.312488317489624
Epoch: 29, Steps: 10 | Train Loss: 0.068 Vali Loss: 3.847 Vali Acc: 0.268 Test Loss: 3.847 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.5643746852874756
Epoch: 30, Steps: 10 | Train Loss: 0.062 Vali Loss: 3.886 Vali Acc: 0.272 Test Loss: 3.886 Test Acc: 0.272
Validation loss decreased (-0.269374 --> -0.271726).  Saving model ...
Epoch: 31 cost time: 1.4723117351531982
Epoch: 31, Steps: 10 | Train Loss: 0.052 Vali Loss: 3.914 Vali Acc: 0.273 Test Loss: 3.914 Test Acc: 0.273
Validation loss decreased (-0.271726 --> -0.272902).  Saving model ...
Epoch: 32 cost time: 1.3941066265106201
Epoch: 32, Steps: 10 | Train Loss: 0.044 Vali Loss: 3.941 Vali Acc: 0.273 Test Loss: 3.941 Test Acc: 0.273
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.571305274963379
Epoch: 33, Steps: 10 | Train Loss: 0.041 Vali Loss: 3.983 Vali Acc: 0.278 Test Loss: 3.983 Test Acc: 0.278
Validation loss decreased (-0.272902 --> -0.277607).  Saving model ...
Epoch: 34 cost time: 1.3898358345031738
Epoch: 34, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.020 Vali Acc: 0.274 Test Loss: 4.020 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.5888862609863281
Epoch: 35, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.049 Vali Acc: 0.271 Test Loss: 4.049 Test Acc: 0.271
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.3695340156555176
Epoch: 36, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.073 Vali Acc: 0.271 Test Loss: 4.073 Test Acc: 0.271
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.2747085094451904
Epoch: 37, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.110 Vali Acc: 0.276 Test Loss: 4.110 Test Acc: 0.276
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.2403240203857422
Epoch: 38, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.134 Vali Acc: 0.279 Test Loss: 4.134 Test Acc: 0.279
Validation loss decreased (-0.277607 --> -0.278782).  Saving model ...
Epoch: 39 cost time: 1.3655922412872314
Epoch: 39, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.174 Vali Acc: 0.276 Test Loss: 4.174 Test Acc: 0.276
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.4684388637542725
Epoch: 40, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.193 Vali Acc: 0.281 Test Loss: 4.193 Test Acc: 0.281
Validation loss decreased (-0.278782 --> -0.281135).  Saving model ...
Epoch: 41 cost time: 1.269639492034912
Epoch: 41, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.211 Vali Acc: 0.279 Test Loss: 4.211 Test Acc: 0.279
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.2826714515686035
Epoch: 42, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.240 Vali Acc: 0.282 Test Loss: 4.240 Test Acc: 0.282
Validation loss decreased (-0.281135 --> -0.282311).  Saving model ...
Epoch: 43 cost time: 1.2780067920684814
Epoch: 43, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.252 Vali Acc: 0.281 Test Loss: 4.252 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.0841484069824219
Epoch: 44, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.282 Vali Acc: 0.278 Test Loss: 4.282 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.1296255588531494
Epoch: 45, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.295 Vali Acc: 0.275 Test Loss: 4.295 Test Acc: 0.275
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.3415112495422363
Epoch: 46, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.302 Vali Acc: 0.276 Test Loss: 4.302 Test Acc: 0.276
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.3117995262145996
Epoch: 47, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.325 Vali Acc: 0.281 Test Loss: 4.325 Test Acc: 0.281
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.3751351833343506
Epoch: 48, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.349 Vali Acc: 0.278 Test Loss: 4.349 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 1.3449201583862305
Epoch: 49, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.366 Vali Acc: 0.276 Test Loss: 4.366 Test Acc: 0.276
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 1.4785819053649902
Epoch: 50, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.417 Vali Acc: 0.275 Test Loss: 4.417 Test Acc: 0.275
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2823529411764706
model parameter : 337946
model size : 1.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps38_str19_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.5617592334747314
Epoch: 1, Steps: 10 | Train Loss: 3.294 Vali Loss: 3.267 Vali Acc: 0.033 Test Loss: 3.267 Test Acc: 0.033
Validation loss decreased (inf --> -0.032909).  Saving model ...
Epoch: 2 cost time: 1.2252984046936035
Epoch: 2, Steps: 10 | Train Loss: 3.243 Vali Loss: 3.264 Vali Acc: 0.041 Test Loss: 3.264 Test Acc: 0.041
Validation loss decreased (-0.032909 --> -0.041144).  Saving model ...
Epoch: 3 cost time: 1.289043664932251
Epoch: 3, Steps: 10 | Train Loss: 3.190 Vali Loss: 3.256 Vali Acc: 0.052 Test Loss: 3.256 Test Acc: 0.052
Validation loss decreased (-0.041144 --> -0.051732).  Saving model ...
Epoch: 4 cost time: 1.29664945602417
Epoch: 4, Steps: 10 | Train Loss: 3.098 Vali Loss: 3.246 Vali Acc: 0.066 Test Loss: 3.246 Test Acc: 0.066
Validation loss decreased (-0.051732 --> -0.065850).  Saving model ...
Epoch: 5 cost time: 1.1278948783874512
Epoch: 5, Steps: 10 | Train Loss: 2.984 Vali Loss: 3.237 Vali Acc: 0.075 Test Loss: 3.237 Test Acc: 0.075
Validation loss decreased (-0.065850 --> -0.075262).  Saving model ...
Epoch: 6 cost time: 1.3445656299591064
Epoch: 6, Steps: 10 | Train Loss: 2.858 Vali Loss: 3.230 Vali Acc: 0.094 Test Loss: 3.230 Test Acc: 0.094
Validation loss decreased (-0.075262 --> -0.094085).  Saving model ...
Epoch: 7 cost time: 1.105705738067627
Epoch: 7, Steps: 10 | Train Loss: 2.763 Vali Loss: 3.226 Vali Acc: 0.112 Test Loss: 3.226 Test Acc: 0.112
Validation loss decreased (-0.094085 --> -0.111732).  Saving model ...
Epoch: 8 cost time: 1.4205858707427979
Epoch: 8, Steps: 10 | Train Loss: 2.618 Vali Loss: 3.220 Vali Acc: 0.113 Test Loss: 3.220 Test Acc: 0.113
Validation loss decreased (-0.111732 --> -0.112909).  Saving model ...
Epoch: 9 cost time: 1.3111622333526611
Epoch: 9, Steps: 10 | Train Loss: 2.487 Vali Loss: 3.211 Vali Acc: 0.125 Test Loss: 3.211 Test Acc: 0.125
Validation loss decreased (-0.112909 --> -0.124674).  Saving model ...
Epoch: 10 cost time: 1.262538194656372
Epoch: 10, Steps: 10 | Train Loss: 2.327 Vali Loss: 3.204 Vali Acc: 0.131 Test Loss: 3.204 Test Acc: 0.131
Validation loss decreased (-0.124674 --> -0.130556).  Saving model ...
Epoch: 11 cost time: 1.256112813949585
Epoch: 11, Steps: 10 | Train Loss: 2.184 Vali Loss: 3.197 Vali Acc: 0.145 Test Loss: 3.197 Test Acc: 0.145
Validation loss decreased (-0.130556 --> -0.144674).  Saving model ...
Epoch: 12 cost time: 1.26047682762146
Epoch: 12, Steps: 10 | Train Loss: 2.015 Vali Loss: 3.195 Vali Acc: 0.152 Test Loss: 3.195 Test Acc: 0.152
Validation loss decreased (-0.144674 --> -0.151733).  Saving model ...
Epoch: 13 cost time: 1.2412309646606445
Epoch: 13, Steps: 10 | Train Loss: 1.829 Vali Loss: 3.189 Vali Acc: 0.168 Test Loss: 3.189 Test Acc: 0.168
Validation loss decreased (-0.151733 --> -0.168203).  Saving model ...
Epoch: 14 cost time: 1.186563491821289
Epoch: 14, Steps: 10 | Train Loss: 1.646 Vali Loss: 3.193 Vali Acc: 0.180 Test Loss: 3.193 Test Acc: 0.180
Validation loss decreased (-0.168203 --> -0.179968).  Saving model ...
Epoch: 15 cost time: 1.2126224040985107
Epoch: 15, Steps: 10 | Train Loss: 1.439 Vali Loss: 3.196 Vali Acc: 0.192 Test Loss: 3.196 Test Acc: 0.192
Validation loss decreased (-0.179968 --> -0.191733).  Saving model ...
Epoch: 16 cost time: 1.2031784057617188
Epoch: 16, Steps: 10 | Train Loss: 1.278 Vali Loss: 3.214 Vali Acc: 0.206 Test Loss: 3.214 Test Acc: 0.206
Validation loss decreased (-0.191733 --> -0.205850).  Saving model ...
Epoch: 17 cost time: 1.2347352504730225
Epoch: 17, Steps: 10 | Train Loss: 1.125 Vali Loss: 3.242 Vali Acc: 0.215 Test Loss: 3.242 Test Acc: 0.215
Validation loss decreased (-0.205850 --> -0.215262).  Saving model ...
Epoch: 18 cost time: 1.0291459560394287
Epoch: 18, Steps: 10 | Train Loss: 0.919 Vali Loss: 3.269 Vali Acc: 0.221 Test Loss: 3.269 Test Acc: 0.221
Validation loss decreased (-0.215262 --> -0.221144).  Saving model ...
Epoch: 19 cost time: 1.2868125438690186
Epoch: 19, Steps: 10 | Train Loss: 0.801 Vali Loss: 3.307 Vali Acc: 0.231 Test Loss: 3.307 Test Acc: 0.231
Validation loss decreased (-0.221144 --> -0.230555).  Saving model ...
Epoch: 20 cost time: 1.0797960758209229
Epoch: 20, Steps: 10 | Train Loss: 0.658 Vali Loss: 3.350 Vali Acc: 0.234 Test Loss: 3.350 Test Acc: 0.234
Validation loss decreased (-0.230555 --> -0.234084).  Saving model ...
Epoch: 21 cost time: 1.0923633575439453
Epoch: 21, Steps: 10 | Train Loss: 0.528 Vali Loss: 3.389 Vali Acc: 0.242 Test Loss: 3.389 Test Acc: 0.242
Validation loss decreased (-0.234084 --> -0.242319).  Saving model ...
Epoch: 22 cost time: 1.1178529262542725
Epoch: 22, Steps: 10 | Train Loss: 0.427 Vali Loss: 3.460 Vali Acc: 0.241 Test Loss: 3.460 Test Acc: 0.241
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.417649269104004
Epoch: 23, Steps: 10 | Train Loss: 0.336 Vali Loss: 3.515 Vali Acc: 0.247 Test Loss: 3.515 Test Acc: 0.247
Validation loss decreased (-0.242319 --> -0.247024).  Saving model ...
Epoch: 24 cost time: 1.140679121017456
Epoch: 24, Steps: 10 | Train Loss: 0.279 Vali Loss: 3.581 Vali Acc: 0.253 Test Loss: 3.581 Test Acc: 0.253
Validation loss decreased (-0.247024 --> -0.252905).  Saving model ...
Epoch: 25 cost time: 1.2236621379852295
Epoch: 25, Steps: 10 | Train Loss: 0.225 Vali Loss: 3.638 Vali Acc: 0.249 Test Loss: 3.638 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.1453540325164795
Epoch: 26, Steps: 10 | Train Loss: 0.181 Vali Loss: 3.688 Vali Acc: 0.251 Test Loss: 3.688 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.2089743614196777
Epoch: 27, Steps: 10 | Train Loss: 0.151 Vali Loss: 3.741 Vali Acc: 0.258 Test Loss: 3.741 Test Acc: 0.258
Validation loss decreased (-0.252905 --> -0.257610).  Saving model ...
Epoch: 28 cost time: 1.122279167175293
Epoch: 28, Steps: 10 | Train Loss: 0.122 Vali Loss: 3.811 Vali Acc: 0.262 Test Loss: 3.811 Test Acc: 0.262
Validation loss decreased (-0.257610 --> -0.262315).  Saving model ...
Epoch: 29 cost time: 1.1224706172943115
Epoch: 29, Steps: 10 | Train Loss: 0.107 Vali Loss: 3.855 Vali Acc: 0.256 Test Loss: 3.855 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.2733972072601318
Epoch: 30, Steps: 10 | Train Loss: 0.085 Vali Loss: 3.905 Vali Acc: 0.258 Test Loss: 3.905 Test Acc: 0.258
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.4053795337677002
Epoch: 31, Steps: 10 | Train Loss: 0.080 Vali Loss: 3.948 Vali Acc: 0.254 Test Loss: 3.948 Test Acc: 0.254
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.2162585258483887
Epoch: 32, Steps: 10 | Train Loss: 0.065 Vali Loss: 3.983 Vali Acc: 0.265 Test Loss: 3.983 Test Acc: 0.265
Validation loss decreased (-0.262315 --> -0.264666).  Saving model ...
Epoch: 33 cost time: 1.3120472431182861
Epoch: 33, Steps: 10 | Train Loss: 0.059 Vali Loss: 4.027 Vali Acc: 0.264 Test Loss: 4.027 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.0884346961975098
Epoch: 34, Steps: 10 | Train Loss: 0.054 Vali Loss: 4.059 Vali Acc: 0.261 Test Loss: 4.059 Test Acc: 0.261
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.489549160003662
Epoch: 35, Steps: 10 | Train Loss: 0.048 Vali Loss: 4.106 Vali Acc: 0.261 Test Loss: 4.106 Test Acc: 0.261
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.1793055534362793
Epoch: 36, Steps: 10 | Train Loss: 0.041 Vali Loss: 4.146 Vali Acc: 0.262 Test Loss: 4.146 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.3163871765136719
Epoch: 37, Steps: 10 | Train Loss: 0.038 Vali Loss: 4.177 Vali Acc: 0.262 Test Loss: 4.177 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.1433792114257812
Epoch: 38, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.196 Vali Acc: 0.265 Test Loss: 4.196 Test Acc: 0.265
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.1471569538116455
Epoch: 39, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.234 Vali Acc: 0.267 Test Loss: 4.234 Test Acc: 0.267
Validation loss decreased (-0.264666 --> -0.267016).  Saving model ...
Epoch: 40 cost time: 1.3417119979858398
Epoch: 40, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.258 Vali Acc: 0.272 Test Loss: 4.258 Test Acc: 0.272
Validation loss decreased (-0.267016 --> -0.271722).  Saving model ...
Epoch: 41 cost time: 1.2051188945770264
Epoch: 41, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.292 Vali Acc: 0.267 Test Loss: 4.292 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.286026954650879
Epoch: 42, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.316 Vali Acc: 0.269 Test Loss: 4.316 Test Acc: 0.269
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.2376248836517334
Epoch: 43, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.357 Vali Acc: 0.268 Test Loss: 4.357 Test Acc: 0.268
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.2422146797180176
Epoch: 44, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.383 Vali Acc: 0.267 Test Loss: 4.383 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.2942004203796387
Epoch: 45, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.388 Vali Acc: 0.266 Test Loss: 4.388 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.3419384956359863
Epoch: 46, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.394 Vali Acc: 0.267 Test Loss: 4.394 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.1234214305877686
Epoch: 47, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.431 Vali Acc: 0.268 Test Loss: 4.431 Test Acc: 0.268
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.0498900413513184
Epoch: 48, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.450 Vali Acc: 0.269 Test Loss: 4.450 Test Acc: 0.269
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.1623058319091797
Epoch: 49, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.496 Vali Acc: 0.265 Test Loss: 4.496 Test Acc: 0.265
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 1.1436231136322021
Epoch: 50, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.515 Vali Acc: 0.265 Test Loss: 4.515 Test Acc: 0.265
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps38_str19_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27176470588235296
model parameter : 328410
model size : 1.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.5683653354644775
Epoch: 1, Steps: 10 | Train Loss: 3.296 Vali Loss: 3.276 Vali Acc: 0.038 Test Loss: 3.276 Test Acc: 0.038
Validation loss decreased (inf --> -0.037614).  Saving model ...
Epoch: 2 cost time: 1.0754084587097168
Epoch: 2, Steps: 10 | Train Loss: 3.157 Vali Loss: 3.267 Vali Acc: 0.061 Test Loss: 3.267 Test Acc: 0.061
Validation loss decreased (-0.037614 --> -0.061144).  Saving model ...
Epoch: 3 cost time: 1.1011817455291748
Epoch: 3, Steps: 10 | Train Loss: 2.957 Vali Loss: 3.260 Vali Acc: 0.078 Test Loss: 3.260 Test Acc: 0.078
Validation loss decreased (-0.061144 --> -0.077614).  Saving model ...
Epoch: 4 cost time: 1.0855984687805176
Epoch: 4, Steps: 10 | Train Loss: 2.700 Vali Loss: 3.243 Vali Acc: 0.093 Test Loss: 3.243 Test Acc: 0.093
Validation loss decreased (-0.077614 --> -0.092909).  Saving model ...
Epoch: 5 cost time: 1.1736257076263428
Epoch: 5, Steps: 10 | Train Loss: 2.384 Vali Loss: 3.220 Vali Acc: 0.128 Test Loss: 3.220 Test Acc: 0.128
Validation loss decreased (-0.092909 --> -0.128203).  Saving model ...
Epoch: 6 cost time: 1.0024421215057373
Epoch: 6, Steps: 10 | Train Loss: 2.085 Vali Loss: 3.203 Vali Acc: 0.144 Test Loss: 3.203 Test Acc: 0.144
Validation loss decreased (-0.128203 --> -0.143497).  Saving model ...
Epoch: 7 cost time: 1.174736738204956
Epoch: 7, Steps: 10 | Train Loss: 1.673 Vali Loss: 3.170 Vali Acc: 0.164 Test Loss: 3.170 Test Acc: 0.164
Validation loss decreased (-0.143497 --> -0.163498).  Saving model ...
Epoch: 8 cost time: 1.0528388023376465
Epoch: 8, Steps: 10 | Train Loss: 1.296 Vali Loss: 3.190 Vali Acc: 0.209 Test Loss: 3.190 Test Acc: 0.209
Validation loss decreased (-0.163498 --> -0.209380).  Saving model ...
Epoch: 9 cost time: 1.0159697532653809
Epoch: 9, Steps: 10 | Train Loss: 0.982 Vali Loss: 3.244 Vali Acc: 0.216 Test Loss: 3.244 Test Acc: 0.216
Validation loss decreased (-0.209380 --> -0.216438).  Saving model ...
Epoch: 10 cost time: 1.2487435340881348
Epoch: 10, Steps: 10 | Train Loss: 0.627 Vali Loss: 3.369 Vali Acc: 0.236 Test Loss: 3.369 Test Acc: 0.236
Validation loss decreased (-0.216438 --> -0.236437).  Saving model ...
Epoch: 11 cost time: 0.9803671836853027
Epoch: 11, Steps: 10 | Train Loss: 0.387 Vali Loss: 3.472 Vali Acc: 0.266 Test Loss: 3.472 Test Acc: 0.266
Validation loss decreased (-0.236437 --> -0.265848).  Saving model ...
Epoch: 12 cost time: 1.0361030101776123
Epoch: 12, Steps: 10 | Train Loss: 0.223 Vali Loss: 3.673 Vali Acc: 0.268 Test Loss: 3.673 Test Acc: 0.268
Validation loss decreased (-0.265848 --> -0.268199).  Saving model ...
Epoch: 13 cost time: 1.0254390239715576
Epoch: 13, Steps: 10 | Train Loss: 0.122 Vali Loss: 3.846 Vali Acc: 0.269 Test Loss: 3.846 Test Acc: 0.269
Validation loss decreased (-0.268199 --> -0.269373).  Saving model ...
Epoch: 14 cost time: 1.164893627166748
Epoch: 14, Steps: 10 | Train Loss: 0.066 Vali Loss: 4.014 Vali Acc: 0.269 Test Loss: 4.014 Test Acc: 0.269
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0641138553619385
Epoch: 15, Steps: 10 | Train Loss: 0.044 Vali Loss: 4.083 Vali Acc: 0.284 Test Loss: 4.083 Test Acc: 0.284
Validation loss decreased (-0.269373 --> -0.283489).  Saving model ...
Epoch: 16 cost time: 1.1554510593414307
Epoch: 16, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.148 Vali Acc: 0.288 Test Loss: 4.148 Test Acc: 0.288
Validation loss decreased (-0.283489 --> -0.288194).  Saving model ...
Epoch: 17 cost time: 1.1783747673034668
Epoch: 17, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.205 Vali Acc: 0.292 Test Loss: 4.205 Test Acc: 0.292
Validation loss decreased (-0.288194 --> -0.291723).  Saving model ...
Epoch: 18 cost time: 1.0096092224121094
Epoch: 18, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.279 Vali Acc: 0.286 Test Loss: 4.279 Test Acc: 0.286
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0720856189727783
Epoch: 19, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.346 Vali Acc: 0.284 Test Loss: 4.346 Test Acc: 0.284
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.0853972434997559
Epoch: 20, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.408 Vali Acc: 0.289 Test Loss: 4.408 Test Acc: 0.289
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.0358946323394775
Epoch: 21, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.432 Vali Acc: 0.287 Test Loss: 4.432 Test Acc: 0.287
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.1245181560516357
Epoch: 22, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.459 Vali Acc: 0.295 Test Loss: 4.459 Test Acc: 0.295
Validation loss decreased (-0.291723 --> -0.295250).  Saving model ...
Epoch: 23 cost time: 1.2073085308074951
Epoch: 23, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.494 Vali Acc: 0.294 Test Loss: 4.494 Test Acc: 0.294
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.1662585735321045
Epoch: 24, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.530 Vali Acc: 0.298 Test Loss: 4.530 Test Acc: 0.298
Validation loss decreased (-0.295250 --> -0.297602).  Saving model ...
Epoch: 25 cost time: 1.1763417720794678
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.572 Vali Acc: 0.295 Test Loss: 4.572 Test Acc: 0.295
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.005023717880249
Epoch: 26, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.612 Vali Acc: 0.292 Test Loss: 4.612 Test Acc: 0.292
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.2682623863220215
Epoch: 27, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.646 Vali Acc: 0.293 Test Loss: 4.646 Test Acc: 0.293
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.19407057762146
Epoch: 28, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.677 Vali Acc: 0.295 Test Loss: 4.677 Test Acc: 0.295
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.0950467586517334
Epoch: 29, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.704 Vali Acc: 0.300 Test Loss: 4.704 Test Acc: 0.300
Validation loss decreased (-0.297602 --> -0.299953).  Saving model ...
Epoch: 30 cost time: 1.2350852489471436
Epoch: 30, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.734 Vali Acc: 0.298 Test Loss: 4.734 Test Acc: 0.298
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.0324482917785645
Epoch: 31, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.767 Vali Acc: 0.296 Test Loss: 4.767 Test Acc: 0.296
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.1478424072265625
Epoch: 32, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.795 Vali Acc: 0.298 Test Loss: 4.795 Test Acc: 0.298
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.1440587043762207
Epoch: 33, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.821 Vali Acc: 0.299 Test Loss: 4.821 Test Acc: 0.299
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.2129321098327637
Epoch: 34, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.845 Vali Acc: 0.299 Test Loss: 4.845 Test Acc: 0.299
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.0158131122589111
Epoch: 35, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.870 Vali Acc: 0.298 Test Loss: 4.870 Test Acc: 0.298
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.1688735485076904
Epoch: 36, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.887 Vali Acc: 0.299 Test Loss: 4.887 Test Acc: 0.299
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.09053635597229
Epoch: 37, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.907 Vali Acc: 0.300 Test Loss: 4.907 Test Acc: 0.300
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.2085838317871094
Epoch: 38, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.932 Vali Acc: 0.301 Test Loss: 4.932 Test Acc: 0.301
Validation loss decreased (-0.299953 --> -0.301127).  Saving model ...
Epoch: 39 cost time: 1.1694896221160889
Epoch: 39, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.964 Vali Acc: 0.294 Test Loss: 4.964 Test Acc: 0.294
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.1445286273956299
Epoch: 40, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.992 Vali Acc: 0.293 Test Loss: 4.992 Test Acc: 0.293
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.190438985824585
Epoch: 41, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.010 Vali Acc: 0.294 Test Loss: 5.010 Test Acc: 0.294
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.1148455142974854
Epoch: 42, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.030 Vali Acc: 0.296 Test Loss: 5.030 Test Acc: 0.296
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.034926176071167
Epoch: 43, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.048 Vali Acc: 0.298 Test Loss: 5.048 Test Acc: 0.298
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.128826379776001
Epoch: 44, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.056 Vali Acc: 0.296 Test Loss: 5.056 Test Acc: 0.296
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.1075575351715088
Epoch: 45, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.077 Vali Acc: 0.298 Test Loss: 5.077 Test Acc: 0.298
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.1931703090667725
Epoch: 46, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.101 Vali Acc: 0.296 Test Loss: 5.101 Test Acc: 0.296
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 1.325749397277832
Epoch: 47, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.117 Vali Acc: 0.296 Test Loss: 5.117 Test Acc: 0.296
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 1.1887059211730957
Epoch: 48, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.139 Vali Acc: 0.296 Test Loss: 5.139 Test Acc: 0.296
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.30117647058823527
model parameter : 267322
model size : 1.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.5454399585723877
Epoch: 1, Steps: 10 | Train Loss: 3.283 Vali Loss: 3.284 Vali Acc: 0.029 Test Loss: 3.284 Test Acc: 0.029
Validation loss decreased (inf --> -0.029379).  Saving model ...
Epoch: 2 cost time: 1.0035364627838135
Epoch: 2, Steps: 10 | Train Loss: 3.206 Vali Loss: 3.274 Vali Acc: 0.034 Test Loss: 3.274 Test Acc: 0.034
Validation loss decreased (-0.029379 --> -0.034085).  Saving model ...
Epoch: 3 cost time: 0.996903657913208
Epoch: 3, Steps: 10 | Train Loss: 3.088 Vali Loss: 3.265 Vali Acc: 0.045 Test Loss: 3.265 Test Acc: 0.045
Validation loss decreased (-0.034085 --> -0.044673).  Saving model ...
Epoch: 4 cost time: 0.998265266418457
Epoch: 4, Steps: 10 | Train Loss: 2.955 Vali Loss: 3.256 Vali Acc: 0.075 Test Loss: 3.256 Test Acc: 0.075
Validation loss decreased (-0.044673 --> -0.075262).  Saving model ...
Epoch: 5 cost time: 1.3176169395446777
Epoch: 5, Steps: 10 | Train Loss: 2.772 Vali Loss: 3.247 Vali Acc: 0.099 Test Loss: 3.247 Test Acc: 0.099
Validation loss decreased (-0.075262 --> -0.098791).  Saving model ...
Epoch: 6 cost time: 1.117630958557129
Epoch: 6, Steps: 10 | Train Loss: 2.590 Vali Loss: 3.235 Vali Acc: 0.112 Test Loss: 3.235 Test Acc: 0.112
Validation loss decreased (-0.098791 --> -0.111732).  Saving model ...
Epoch: 7 cost time: 1.1143429279327393
Epoch: 7, Steps: 10 | Train Loss: 2.388 Vali Loss: 3.218 Vali Acc: 0.128 Test Loss: 3.218 Test Acc: 0.128
Validation loss decreased (-0.111732 --> -0.128203).  Saving model ...
Epoch: 8 cost time: 1.0415585041046143
Epoch: 8, Steps: 10 | Train Loss: 2.151 Vali Loss: 3.201 Vali Acc: 0.145 Test Loss: 3.201 Test Acc: 0.145
Validation loss decreased (-0.128203 --> -0.144674).  Saving model ...
Epoch: 9 cost time: 1.3806300163269043
Epoch: 9, Steps: 10 | Train Loss: 1.882 Vali Loss: 3.183 Vali Acc: 0.171 Test Loss: 3.183 Test Acc: 0.171
Validation loss decreased (-0.144674 --> -0.170556).  Saving model ...
Epoch: 10 cost time: 1.1441431045532227
Epoch: 10, Steps: 10 | Train Loss: 1.608 Vali Loss: 3.191 Vali Acc: 0.188 Test Loss: 3.191 Test Acc: 0.188
Validation loss decreased (-0.170556 --> -0.188203).  Saving model ...
Epoch: 11 cost time: 1.1789252758026123
Epoch: 11, Steps: 10 | Train Loss: 1.301 Vali Loss: 3.213 Vali Acc: 0.202 Test Loss: 3.213 Test Acc: 0.202
Validation loss decreased (-0.188203 --> -0.202321).  Saving model ...
Epoch: 12 cost time: 1.1380906105041504
Epoch: 12, Steps: 10 | Train Loss: 1.052 Vali Loss: 3.259 Vali Acc: 0.222 Test Loss: 3.259 Test Acc: 0.222
Validation loss decreased (-0.202321 --> -0.222320).  Saving model ...
Epoch: 13 cost time: 1.061657190322876
Epoch: 13, Steps: 10 | Train Loss: 0.823 Vali Loss: 3.307 Vali Acc: 0.238 Test Loss: 3.307 Test Acc: 0.238
Validation loss decreased (-0.222320 --> -0.237614).  Saving model ...
Epoch: 14 cost time: 0.909475564956665
Epoch: 14, Steps: 10 | Train Loss: 0.599 Vali Loss: 3.406 Vali Acc: 0.236 Test Loss: 3.406 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.961381196975708
Epoch: 15, Steps: 10 | Train Loss: 0.432 Vali Loss: 3.519 Vali Acc: 0.249 Test Loss: 3.519 Test Acc: 0.249
Validation loss decreased (-0.237614 --> -0.249377).  Saving model ...
Epoch: 16 cost time: 0.9890646934509277
Epoch: 16, Steps: 10 | Train Loss: 0.301 Vali Loss: 3.633 Vali Acc: 0.264 Test Loss: 3.633 Test Acc: 0.264
Validation loss decreased (-0.249377 --> -0.263493).  Saving model ...
Epoch: 17 cost time: 1.0985517501831055
Epoch: 17, Steps: 10 | Train Loss: 0.203 Vali Loss: 3.755 Vali Acc: 0.266 Test Loss: 3.755 Test Acc: 0.266
Validation loss decreased (-0.263493 --> -0.265845).  Saving model ...
Epoch: 18 cost time: 1.0909183025360107
Epoch: 18, Steps: 10 | Train Loss: 0.144 Vali Loss: 3.866 Vali Acc: 0.267 Test Loss: 3.866 Test Acc: 0.267
Validation loss decreased (-0.265845 --> -0.267020).  Saving model ...
Epoch: 19 cost time: 1.0745575428009033
Epoch: 19, Steps: 10 | Train Loss: 0.103 Vali Loss: 3.936 Vali Acc: 0.275 Test Loss: 3.936 Test Acc: 0.275
Validation loss decreased (-0.267020 --> -0.275255).  Saving model ...
Epoch: 20 cost time: 1.3110511302947998
Epoch: 20, Steps: 10 | Train Loss: 0.077 Vali Loss: 4.021 Vali Acc: 0.278 Test Loss: 4.021 Test Acc: 0.278
Validation loss decreased (-0.275255 --> -0.277607).  Saving model ...
Epoch: 21 cost time: 1.1903793811798096
Epoch: 21, Steps: 10 | Train Loss: 0.061 Vali Loss: 4.093 Vali Acc: 0.280 Test Loss: 4.093 Test Acc: 0.280
Validation loss decreased (-0.277607 --> -0.279959).  Saving model ...
Epoch: 22 cost time: 1.0436882972717285
Epoch: 22, Steps: 10 | Train Loss: 0.048 Vali Loss: 4.163 Vali Acc: 0.281 Test Loss: 4.163 Test Acc: 0.281
Validation loss decreased (-0.279959 --> -0.281135).  Saving model ...
Epoch: 23 cost time: 1.0788612365722656
Epoch: 23, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.229 Vali Acc: 0.276 Test Loss: 4.229 Test Acc: 0.276
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.1586689949035645
Epoch: 24, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.288 Vali Acc: 0.279 Test Loss: 4.288 Test Acc: 0.279
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.1172387599945068
Epoch: 25, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.328 Vali Acc: 0.276 Test Loss: 4.328 Test Acc: 0.276
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.0522384643554688
Epoch: 26, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.369 Vali Acc: 0.280 Test Loss: 4.369 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.1633610725402832
Epoch: 27, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.417 Vali Acc: 0.279 Test Loss: 4.417 Test Acc: 0.279
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.157088041305542
Epoch: 28, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.502 Vali Acc: 0.280 Test Loss: 4.502 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.9489226341247559
Epoch: 29, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.523 Vali Acc: 0.280 Test Loss: 4.523 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.1162230968475342
Epoch: 30, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.536 Vali Acc: 0.276 Test Loss: 4.536 Test Acc: 0.276
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.2561421394348145
Epoch: 31, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.564 Vali Acc: 0.274 Test Loss: 4.564 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.0926148891448975
Epoch: 32, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.601 Vali Acc: 0.276 Test Loss: 4.601 Test Acc: 0.276
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2811764705882353
model parameter : 172602
model size : 0.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps12_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.743537187576294
Epoch: 1, Steps: 10 | Train Loss: 3.282 Vali Loss: 3.273 Vali Acc: 0.035 Test Loss: 3.273 Test Acc: 0.035
Validation loss decreased (inf --> -0.035261).  Saving model ...
Epoch: 2 cost time: 1.1800074577331543
Epoch: 2, Steps: 10 | Train Loss: 3.234 Vali Loss: 3.269 Vali Acc: 0.035 Test Loss: 3.269 Test Acc: 0.035
Validation loss decreased (-0.035261 --> -0.035261).  Saving model ...
Epoch: 3 cost time: 0.9584228992462158
Epoch: 3, Steps: 10 | Train Loss: 3.122 Vali Loss: 3.264 Vali Acc: 0.045 Test Loss: 3.264 Test Acc: 0.045
Validation loss decreased (-0.035261 --> -0.044673).  Saving model ...
Epoch: 4 cost time: 1.2089931964874268
Epoch: 4, Steps: 10 | Train Loss: 3.037 Vali Loss: 3.261 Vali Acc: 0.064 Test Loss: 3.261 Test Acc: 0.064
Validation loss decreased (-0.044673 --> -0.063497).  Saving model ...
Epoch: 5 cost time: 1.2349934577941895
Epoch: 5, Steps: 10 | Train Loss: 2.906 Vali Loss: 3.255 Vali Acc: 0.076 Test Loss: 3.255 Test Acc: 0.076
Validation loss decreased (-0.063497 --> -0.076438).  Saving model ...
Epoch: 6 cost time: 1.2386746406555176
Epoch: 6, Steps: 10 | Train Loss: 2.788 Vali Loss: 3.252 Vali Acc: 0.080 Test Loss: 3.252 Test Acc: 0.080
Validation loss decreased (-0.076438 --> -0.079967).  Saving model ...
Epoch: 7 cost time: 1.2033183574676514
Epoch: 7, Steps: 10 | Train Loss: 2.656 Vali Loss: 3.244 Vali Acc: 0.088 Test Loss: 3.244 Test Acc: 0.088
Validation loss decreased (-0.079967 --> -0.088203).  Saving model ...
Epoch: 8 cost time: 1.2579965591430664
Epoch: 8, Steps: 10 | Train Loss: 2.469 Vali Loss: 3.232 Vali Acc: 0.099 Test Loss: 3.232 Test Acc: 0.099
Validation loss decreased (-0.088203 --> -0.098791).  Saving model ...
Epoch: 9 cost time: 1.261986255645752
Epoch: 9, Steps: 10 | Train Loss: 2.331 Vali Loss: 3.219 Vali Acc: 0.120 Test Loss: 3.219 Test Acc: 0.120
Validation loss decreased (-0.098791 --> -0.119968).  Saving model ...
Epoch: 10 cost time: 1.1963317394256592
Epoch: 10, Steps: 10 | Train Loss: 2.095 Vali Loss: 3.204 Vali Acc: 0.146 Test Loss: 3.204 Test Acc: 0.146
Validation loss decreased (-0.119968 --> -0.145850).  Saving model ...
Epoch: 11 cost time: 1.0918197631835938
Epoch: 11, Steps: 10 | Train Loss: 1.878 Vali Loss: 3.192 Vali Acc: 0.161 Test Loss: 3.192 Test Acc: 0.161
Validation loss decreased (-0.145850 --> -0.161145).  Saving model ...
Epoch: 12 cost time: 1.2291862964630127
Epoch: 12, Steps: 10 | Train Loss: 1.664 Vali Loss: 3.181 Vali Acc: 0.172 Test Loss: 3.181 Test Acc: 0.172
Validation loss decreased (-0.161145 --> -0.171733).  Saving model ...
Epoch: 13 cost time: 1.2445976734161377
Epoch: 13, Steps: 10 | Train Loss: 1.424 Vali Loss: 3.183 Vali Acc: 0.184 Test Loss: 3.183 Test Acc: 0.184
Validation loss decreased (-0.171733 --> -0.183498).  Saving model ...
Epoch: 14 cost time: 1.2512974739074707
Epoch: 14, Steps: 10 | Train Loss: 1.200 Vali Loss: 3.204 Vali Acc: 0.196 Test Loss: 3.204 Test Acc: 0.196
Validation loss decreased (-0.183498 --> -0.196439).  Saving model ...
Epoch: 15 cost time: 1.2996680736541748
Epoch: 15, Steps: 10 | Train Loss: 0.964 Vali Loss: 3.232 Vali Acc: 0.212 Test Loss: 3.232 Test Acc: 0.212
Validation loss decreased (-0.196439 --> -0.211732).  Saving model ...
Epoch: 16 cost time: 1.2497498989105225
Epoch: 16, Steps: 10 | Train Loss: 0.781 Vali Loss: 3.290 Vali Acc: 0.214 Test Loss: 3.290 Test Acc: 0.214
Validation loss decreased (-0.211732 --> -0.214085).  Saving model ...
Epoch: 17 cost time: 1.2593672275543213
Epoch: 17, Steps: 10 | Train Loss: 0.595 Vali Loss: 3.343 Vali Acc: 0.229 Test Loss: 3.343 Test Acc: 0.229
Validation loss decreased (-0.214085 --> -0.229378).  Saving model ...
Epoch: 18 cost time: 1.1953027248382568
Epoch: 18, Steps: 10 | Train Loss: 0.495 Vali Loss: 3.405 Vali Acc: 0.225 Test Loss: 3.405 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1116793155670166
Epoch: 19, Steps: 10 | Train Loss: 0.341 Vali Loss: 3.479 Vali Acc: 0.231 Test Loss: 3.479 Test Acc: 0.231
Validation loss decreased (-0.229378 --> -0.230553).  Saving model ...
Epoch: 20 cost time: 1.1120326519012451
Epoch: 20, Steps: 10 | Train Loss: 0.256 Vali Loss: 3.568 Vali Acc: 0.231 Test Loss: 3.568 Test Acc: 0.231
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.4342625141143799
Epoch: 21, Steps: 10 | Train Loss: 0.198 Vali Loss: 3.629 Vali Acc: 0.232 Test Loss: 3.629 Test Acc: 0.232
Validation loss decreased (-0.230553 --> -0.231728).  Saving model ...
Epoch: 22 cost time: 1.2389380931854248
Epoch: 22, Steps: 10 | Train Loss: 0.145 Vali Loss: 3.687 Vali Acc: 0.236 Test Loss: 3.687 Test Acc: 0.236
Validation loss decreased (-0.231728 --> -0.236434).  Saving model ...
Epoch: 23 cost time: 1.1429071426391602
Epoch: 23, Steps: 10 | Train Loss: 0.121 Vali Loss: 3.758 Vali Acc: 0.238 Test Loss: 3.758 Test Acc: 0.238
Validation loss decreased (-0.236434 --> -0.237609).  Saving model ...
Epoch: 24 cost time: 1.2803432941436768
Epoch: 24, Steps: 10 | Train Loss: 0.099 Vali Loss: 3.817 Vali Acc: 0.239 Test Loss: 3.817 Test Acc: 0.239
Validation loss decreased (-0.237609 --> -0.238785).  Saving model ...
Epoch: 25 cost time: 1.1501870155334473
Epoch: 25, Steps: 10 | Train Loss: 0.080 Vali Loss: 3.869 Vali Acc: 0.236 Test Loss: 3.869 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0540015697479248
Epoch: 26, Steps: 10 | Train Loss: 0.069 Vali Loss: 3.923 Vali Acc: 0.233 Test Loss: 3.923 Test Acc: 0.233
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.1166281700134277
Epoch: 27, Steps: 10 | Train Loss: 0.062 Vali Loss: 3.960 Vali Acc: 0.236 Test Loss: 3.960 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.289184808731079
Epoch: 28, Steps: 10 | Train Loss: 0.048 Vali Loss: 4.016 Vali Acc: 0.236 Test Loss: 4.016 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.0517876148223877
Epoch: 29, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.064 Vali Acc: 0.234 Test Loss: 4.064 Test Acc: 0.234
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.3021430969238281
Epoch: 30, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.100 Vali Acc: 0.235 Test Loss: 4.100 Test Acc: 0.235
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.1987419128417969
Epoch: 31, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.121 Vali Acc: 0.240 Test Loss: 4.121 Test Acc: 0.240
Validation loss decreased (-0.238785 --> -0.239959).  Saving model ...
Epoch: 32 cost time: 1.0207362174987793
Epoch: 32, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.162 Vali Acc: 0.242 Test Loss: 4.162 Test Acc: 0.242
Validation loss decreased (-0.239959 --> -0.242311).  Saving model ...
Epoch: 33 cost time: 1.2099409103393555
Epoch: 33, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.192 Vali Acc: 0.242 Test Loss: 4.192 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.2797727584838867
Epoch: 34, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.221 Vali Acc: 0.242 Test Loss: 4.221 Test Acc: 0.242
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.3495917320251465
Epoch: 35, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.251 Vali Acc: 0.241 Test Loss: 4.251 Test Acc: 0.241
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.3752765655517578
Epoch: 36, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.281 Vali Acc: 0.242 Test Loss: 4.281 Test Acc: 0.242
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.424098014831543
Epoch: 37, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.318 Vali Acc: 0.242 Test Loss: 4.318 Test Acc: 0.242
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.1848769187927246
Epoch: 38, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.341 Vali Acc: 0.246 Test Loss: 4.341 Test Acc: 0.246
Validation loss decreased (-0.242311 --> -0.245839).  Saving model ...
Epoch: 39 cost time: 1.3312525749206543
Epoch: 39, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.373 Vali Acc: 0.247 Test Loss: 4.373 Test Acc: 0.247
Validation loss decreased (-0.245839 --> -0.247015).  Saving model ...
Epoch: 40 cost time: 1.1552696228027344
Epoch: 40, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.401 Vali Acc: 0.245 Test Loss: 4.401 Test Acc: 0.245
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.27146577835083
Epoch: 41, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.423 Vali Acc: 0.247 Test Loss: 4.423 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.24483323097229
Epoch: 42, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.432 Vali Acc: 0.252 Test Loss: 4.432 Test Acc: 0.252
Validation loss decreased (-0.247015 --> -0.251720).  Saving model ...
Epoch: 43 cost time: 1.1477859020233154
Epoch: 43, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.448 Vali Acc: 0.249 Test Loss: 4.448 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.2020225524902344
Epoch: 44, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.468 Vali Acc: 0.249 Test Loss: 4.468 Test Acc: 0.249
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.2502260208129883
Epoch: 45, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.504 Vali Acc: 0.248 Test Loss: 4.504 Test Acc: 0.248
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.216554880142212
Epoch: 46, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.529 Vali Acc: 0.249 Test Loss: 4.529 Test Acc: 0.249
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.2765917778015137
Epoch: 47, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.549 Vali Acc: 0.248 Test Loss: 4.549 Test Acc: 0.248
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.2130484580993652
Epoch: 48, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.574 Vali Acc: 0.245 Test Loss: 4.574 Test Acc: 0.245
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 1.0927531719207764
Epoch: 49, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.595 Vali Acc: 0.248 Test Loss: 4.595 Test Acc: 0.248
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 1.1847293376922607
Epoch: 50, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.612 Vali Acc: 0.249 Test Loss: 4.612 Test Acc: 0.249
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps12_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.25176470588235295
model parameter : 142778
model size : 0.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.290027141571045
Epoch: 1, Steps: 10 | Train Loss: 3.316 Vali Loss: 3.276 Vali Acc: 0.031 Test Loss: 3.276 Test Acc: 0.031
Validation loss decreased (inf --> -0.030555).  Saving model ...
Epoch: 2 cost time: 1.2491953372955322
Epoch: 2, Steps: 10 | Train Loss: 3.264 Vali Loss: 3.269 Vali Acc: 0.038 Test Loss: 3.269 Test Acc: 0.038
Validation loss decreased (-0.030555 --> -0.037614).  Saving model ...
Epoch: 3 cost time: 1.4255359172821045
Epoch: 3, Steps: 10 | Train Loss: 3.208 Vali Loss: 3.258 Vali Acc: 0.045 Test Loss: 3.258 Test Acc: 0.045
Validation loss decreased (-0.037614 --> -0.044673).  Saving model ...
Epoch: 4 cost time: 1.156968355178833
Epoch: 4, Steps: 10 | Train Loss: 3.130 Vali Loss: 3.247 Vali Acc: 0.064 Test Loss: 3.247 Test Acc: 0.064
Validation loss decreased (-0.044673 --> -0.063497).  Saving model ...
Epoch: 5 cost time: 1.3885231018066406
Epoch: 5, Steps: 10 | Train Loss: 3.020 Vali Loss: 3.238 Vali Acc: 0.075 Test Loss: 3.238 Test Acc: 0.075
Validation loss decreased (-0.063497 --> -0.075262).  Saving model ...
Epoch: 6 cost time: 1.1034762859344482
Epoch: 6, Steps: 10 | Train Loss: 2.921 Vali Loss: 3.231 Vali Acc: 0.086 Test Loss: 3.231 Test Acc: 0.086
Validation loss decreased (-0.075262 --> -0.085850).  Saving model ...
Epoch: 7 cost time: 1.0711042881011963
Epoch: 7, Steps: 10 | Train Loss: 2.815 Vali Loss: 3.223 Vali Acc: 0.093 Test Loss: 3.223 Test Acc: 0.093
Validation loss decreased (-0.085850 --> -0.092909).  Saving model ...
Epoch: 8 cost time: 0.9865341186523438
Epoch: 8, Steps: 10 | Train Loss: 2.683 Vali Loss: 3.213 Vali Acc: 0.113 Test Loss: 3.213 Test Acc: 0.113
Validation loss decreased (-0.092909 --> -0.112909).  Saving model ...
Epoch: 9 cost time: 1.0250368118286133
Epoch: 9, Steps: 10 | Train Loss: 2.541 Vali Loss: 3.198 Vali Acc: 0.120 Test Loss: 3.198 Test Acc: 0.120
Validation loss decreased (-0.112909 --> -0.119968).  Saving model ...
Epoch: 10 cost time: 1.1104497909545898
Epoch: 10, Steps: 10 | Train Loss: 2.382 Vali Loss: 3.185 Vali Acc: 0.132 Test Loss: 3.185 Test Acc: 0.132
Validation loss decreased (-0.119968 --> -0.131733).  Saving model ...
Epoch: 11 cost time: 0.9785792827606201
Epoch: 11, Steps: 10 | Train Loss: 2.225 Vali Loss: 3.176 Vali Acc: 0.140 Test Loss: 3.176 Test Acc: 0.140
Validation loss decreased (-0.131733 --> -0.139968).  Saving model ...
Epoch: 12 cost time: 1.1457371711730957
Epoch: 12, Steps: 10 | Train Loss: 2.044 Vali Loss: 3.158 Vali Acc: 0.162 Test Loss: 3.158 Test Acc: 0.162
Validation loss decreased (-0.139968 --> -0.162321).  Saving model ...
Epoch: 13 cost time: 1.162397861480713
Epoch: 13, Steps: 10 | Train Loss: 1.877 Vali Loss: 3.147 Vali Acc: 0.173 Test Loss: 3.147 Test Acc: 0.173
Validation loss decreased (-0.162321 --> -0.172910).  Saving model ...
Epoch: 14 cost time: 1.159350872039795
Epoch: 14, Steps: 10 | Train Loss: 1.652 Vali Loss: 3.141 Vali Acc: 0.186 Test Loss: 3.141 Test Acc: 0.186
Validation loss decreased (-0.172910 --> -0.185851).  Saving model ...
Epoch: 15 cost time: 0.9825284481048584
Epoch: 15, Steps: 10 | Train Loss: 1.438 Vali Loss: 3.144 Vali Acc: 0.194 Test Loss: 3.144 Test Acc: 0.194
Validation loss decreased (-0.185851 --> -0.194086).  Saving model ...
Epoch: 16 cost time: 1.1288187503814697
Epoch: 16, Steps: 10 | Train Loss: 1.200 Vali Loss: 3.150 Vali Acc: 0.213 Test Loss: 3.150 Test Acc: 0.213
Validation loss decreased (-0.194086 --> -0.212910).  Saving model ...
Epoch: 17 cost time: 1.0751252174377441
Epoch: 17, Steps: 10 | Train Loss: 1.037 Vali Loss: 3.172 Vali Acc: 0.222 Test Loss: 3.172 Test Acc: 0.222
Validation loss decreased (-0.212910 --> -0.222321).  Saving model ...
Epoch: 18 cost time: 1.0778570175170898
Epoch: 18, Steps: 10 | Train Loss: 0.863 Vali Loss: 3.206 Vali Acc: 0.224 Test Loss: 3.206 Test Acc: 0.224
Validation loss decreased (-0.222321 --> -0.223497).  Saving model ...
Epoch: 19 cost time: 1.0182294845581055
Epoch: 19, Steps: 10 | Train Loss: 0.703 Vali Loss: 3.249 Vali Acc: 0.239 Test Loss: 3.249 Test Acc: 0.239
Validation loss decreased (-0.223497 --> -0.238791).  Saving model ...
Epoch: 20 cost time: 1.0208375453948975
Epoch: 20, Steps: 10 | Train Loss: 0.551 Vali Loss: 3.307 Vali Acc: 0.244 Test Loss: 3.307 Test Acc: 0.244
Validation loss decreased (-0.238791 --> -0.243496).  Saving model ...
Epoch: 21 cost time: 1.0096702575683594
Epoch: 21, Steps: 10 | Train Loss: 0.461 Vali Loss: 3.375 Vali Acc: 0.248 Test Loss: 3.375 Test Acc: 0.248
Validation loss decreased (-0.243496 --> -0.248202).  Saving model ...
Epoch: 22 cost time: 1.1515750885009766
Epoch: 22, Steps: 10 | Train Loss: 0.343 Vali Loss: 3.441 Vali Acc: 0.256 Test Loss: 3.441 Test Acc: 0.256
Validation loss decreased (-0.248202 --> -0.256436).  Saving model ...
Epoch: 23 cost time: 1.1342411041259766
Epoch: 23, Steps: 10 | Train Loss: 0.279 Vali Loss: 3.500 Vali Acc: 0.258 Test Loss: 3.500 Test Acc: 0.258
Validation loss decreased (-0.256436 --> -0.257612).  Saving model ...
Epoch: 24 cost time: 1.1497387886047363
Epoch: 24, Steps: 10 | Train Loss: 0.223 Vali Loss: 3.548 Vali Acc: 0.262 Test Loss: 3.548 Test Acc: 0.262
Validation loss decreased (-0.257612 --> -0.262317).  Saving model ...
Epoch: 25 cost time: 1.0580263137817383
Epoch: 25, Steps: 10 | Train Loss: 0.184 Vali Loss: 3.606 Vali Acc: 0.264 Test Loss: 3.606 Test Acc: 0.264
Validation loss decreased (-0.262317 --> -0.263493).  Saving model ...
Epoch: 26 cost time: 1.1354362964630127
Epoch: 26, Steps: 10 | Train Loss: 0.148 Vali Loss: 3.662 Vali Acc: 0.271 Test Loss: 3.662 Test Acc: 0.271
Validation loss decreased (-0.263493 --> -0.270552).  Saving model ...
Epoch: 27 cost time: 1.0607998371124268
Epoch: 27, Steps: 10 | Train Loss: 0.120 Vali Loss: 3.727 Vali Acc: 0.266 Test Loss: 3.727 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0537588596343994
Epoch: 28, Steps: 10 | Train Loss: 0.110 Vali Loss: 3.770 Vali Acc: 0.274 Test Loss: 3.770 Test Acc: 0.274
Validation loss decreased (-0.270552 --> -0.274080).  Saving model ...
Epoch: 29 cost time: 1.0535998344421387
Epoch: 29, Steps: 10 | Train Loss: 0.091 Vali Loss: 3.801 Vali Acc: 0.269 Test Loss: 3.801 Test Acc: 0.269
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.1481938362121582
Epoch: 30, Steps: 10 | Train Loss: 0.074 Vali Loss: 3.838 Vali Acc: 0.275 Test Loss: 3.838 Test Acc: 0.275
Validation loss decreased (-0.274080 --> -0.275256).  Saving model ...
Epoch: 31 cost time: 1.0770924091339111
Epoch: 31, Steps: 10 | Train Loss: 0.070 Vali Loss: 3.881 Vali Acc: 0.272 Test Loss: 3.881 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.2543938159942627
Epoch: 32, Steps: 10 | Train Loss: 0.059 Vali Loss: 3.918 Vali Acc: 0.274 Test Loss: 3.918 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.0835511684417725
Epoch: 33, Steps: 10 | Train Loss: 0.052 Vali Loss: 3.958 Vali Acc: 0.271 Test Loss: 3.958 Test Acc: 0.271
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.2170579433441162
Epoch: 34, Steps: 10 | Train Loss: 0.043 Vali Loss: 3.996 Vali Acc: 0.274 Test Loss: 3.996 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.113525390625
Epoch: 35, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.015 Vali Acc: 0.272 Test Loss: 4.015 Test Acc: 0.272
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.1337780952453613
Epoch: 36, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.037 Vali Acc: 0.273 Test Loss: 4.037 Test Acc: 0.273
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.1090848445892334
Epoch: 37, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.071 Vali Acc: 0.272 Test Loss: 4.071 Test Acc: 0.272
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.0664215087890625
Epoch: 38, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.112 Vali Acc: 0.271 Test Loss: 4.112 Test Acc: 0.271
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.167959451675415
Epoch: 39, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.146 Vali Acc: 0.269 Test Loss: 4.146 Test Acc: 0.269
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.0415468215942383
Epoch: 40, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.169 Vali Acc: 0.273 Test Loss: 4.169 Test Acc: 0.273
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2752941176470588
model parameter : 127930
model size : 0.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps23_str12_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.2552669048309326
Epoch: 1, Steps: 10 | Train Loss: 3.278 Vali Loss: 3.274 Vali Acc: 0.034 Test Loss: 3.274 Test Acc: 0.034
Validation loss decreased (inf --> -0.034085).  Saving model ...
Epoch: 2 cost time: 0.8995757102966309
Epoch: 2, Steps: 10 | Train Loss: 3.253 Vali Loss: 3.272 Vali Acc: 0.032 Test Loss: 3.272 Test Acc: 0.032
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.140913963317871
Epoch: 3, Steps: 10 | Train Loss: 3.220 Vali Loss: 3.265 Vali Acc: 0.040 Test Loss: 3.265 Test Acc: 0.040
Validation loss decreased (-0.034085 --> -0.039967).  Saving model ...
Epoch: 4 cost time: 1.0742368698120117
Epoch: 4, Steps: 10 | Train Loss: 3.141 Vali Loss: 3.256 Vali Acc: 0.055 Test Loss: 3.256 Test Acc: 0.055
Validation loss decreased (-0.039967 --> -0.055262).  Saving model ...
Epoch: 5 cost time: 1.0958952903747559
Epoch: 5, Steps: 10 | Train Loss: 3.075 Vali Loss: 3.247 Vali Acc: 0.054 Test Loss: 3.247 Test Acc: 0.054
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.026693344116211
Epoch: 6, Steps: 10 | Train Loss: 2.985 Vali Loss: 3.239 Vali Acc: 0.069 Test Loss: 3.239 Test Acc: 0.069
Validation loss decreased (-0.055262 --> -0.069379).  Saving model ...
Epoch: 7 cost time: 1.0995078086853027
Epoch: 7, Steps: 10 | Train Loss: 2.906 Vali Loss: 3.232 Vali Acc: 0.080 Test Loss: 3.232 Test Acc: 0.080
Validation loss decreased (-0.069379 --> -0.079968).  Saving model ...
Epoch: 8 cost time: 1.0652515888214111
Epoch: 8, Steps: 10 | Train Loss: 2.820 Vali Loss: 3.225 Vali Acc: 0.086 Test Loss: 3.225 Test Acc: 0.086
Validation loss decreased (-0.079968 --> -0.085850).  Saving model ...
Epoch: 9 cost time: 1.3769161701202393
Epoch: 9, Steps: 10 | Train Loss: 2.704 Vali Loss: 3.219 Vali Acc: 0.095 Test Loss: 3.219 Test Acc: 0.095
Validation loss decreased (-0.085850 --> -0.095262).  Saving model ...
Epoch: 10 cost time: 1.0177795886993408
Epoch: 10, Steps: 10 | Train Loss: 2.612 Vali Loss: 3.213 Vali Acc: 0.098 Test Loss: 3.213 Test Acc: 0.098
Validation loss decreased (-0.095262 --> -0.097615).  Saving model ...
Epoch: 11 cost time: 1.1673882007598877
Epoch: 11, Steps: 10 | Train Loss: 2.514 Vali Loss: 3.205 Vali Acc: 0.113 Test Loss: 3.205 Test Acc: 0.113
Validation loss decreased (-0.097615 --> -0.112909).  Saving model ...
Epoch: 12 cost time: 1.0815308094024658
Epoch: 12, Steps: 10 | Train Loss: 2.362 Vali Loss: 3.196 Vali Acc: 0.120 Test Loss: 3.196 Test Acc: 0.120
Validation loss decreased (-0.112909 --> -0.119968).  Saving model ...
Epoch: 13 cost time: 1.1241676807403564
Epoch: 13, Steps: 10 | Train Loss: 2.238 Vali Loss: 3.188 Vali Acc: 0.135 Test Loss: 3.188 Test Acc: 0.135
Validation loss decreased (-0.119968 --> -0.135262).  Saving model ...
Epoch: 14 cost time: 1.1253242492675781
Epoch: 14, Steps: 10 | Train Loss: 2.078 Vali Loss: 3.182 Vali Acc: 0.147 Test Loss: 3.182 Test Acc: 0.147
Validation loss decreased (-0.135262 --> -0.147027).  Saving model ...
Epoch: 15 cost time: 1.2117462158203125
Epoch: 15, Steps: 10 | Train Loss: 1.929 Vali Loss: 3.180 Vali Acc: 0.156 Test Loss: 3.180 Test Acc: 0.156
Validation loss decreased (-0.147027 --> -0.156439).  Saving model ...
Epoch: 16 cost time: 1.0276942253112793
Epoch: 16, Steps: 10 | Train Loss: 1.770 Vali Loss: 3.179 Vali Acc: 0.161 Test Loss: 3.179 Test Acc: 0.161
Validation loss decreased (-0.156439 --> -0.161145).  Saving model ...
Epoch: 17 cost time: 1.1077418327331543
Epoch: 17, Steps: 10 | Train Loss: 1.604 Vali Loss: 3.181 Vali Acc: 0.173 Test Loss: 3.181 Test Acc: 0.173
Validation loss decreased (-0.161145 --> -0.172909).  Saving model ...
Epoch: 18 cost time: 0.9517776966094971
Epoch: 18, Steps: 10 | Train Loss: 1.490 Vali Loss: 3.195 Vali Acc: 0.181 Test Loss: 3.195 Test Acc: 0.181
Validation loss decreased (-0.172909 --> -0.181145).  Saving model ...
Epoch: 19 cost time: 1.0540547370910645
Epoch: 19, Steps: 10 | Train Loss: 1.290 Vali Loss: 3.213 Vali Acc: 0.194 Test Loss: 3.213 Test Acc: 0.194
Validation loss decreased (-0.181145 --> -0.194086).  Saving model ...
Epoch: 20 cost time: 1.2021045684814453
Epoch: 20, Steps: 10 | Train Loss: 1.166 Vali Loss: 3.232 Vali Acc: 0.201 Test Loss: 3.232 Test Acc: 0.201
Validation loss decreased (-0.194086 --> -0.201144).  Saving model ...
Epoch: 21 cost time: 0.9283061027526855
Epoch: 21, Steps: 10 | Train Loss: 0.996 Vali Loss: 3.257 Vali Acc: 0.204 Test Loss: 3.257 Test Acc: 0.204
Validation loss decreased (-0.201144 --> -0.203497).  Saving model ...
Epoch: 22 cost time: 1.130728006362915
Epoch: 22, Steps: 10 | Train Loss: 0.882 Vali Loss: 3.286 Vali Acc: 0.218 Test Loss: 3.286 Test Acc: 0.218
Validation loss decreased (-0.203497 --> -0.217614).  Saving model ...
Epoch: 23 cost time: 1.1965551376342773
Epoch: 23, Steps: 10 | Train Loss: 0.743 Vali Loss: 3.320 Vali Acc: 0.224 Test Loss: 3.320 Test Acc: 0.224
Validation loss decreased (-0.217614 --> -0.223496).  Saving model ...
Epoch: 24 cost time: 0.9643936157226562
Epoch: 24, Steps: 10 | Train Loss: 0.680 Vali Loss: 3.372 Vali Acc: 0.236 Test Loss: 3.372 Test Acc: 0.236
Validation loss decreased (-0.223496 --> -0.236437).  Saving model ...
Epoch: 25 cost time: 1.3534727096557617
Epoch: 25, Steps: 10 | Train Loss: 0.539 Vali Loss: 3.414 Vali Acc: 0.234 Test Loss: 3.414 Test Acc: 0.234
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.099025011062622
Epoch: 26, Steps: 10 | Train Loss: 0.448 Vali Loss: 3.467 Vali Acc: 0.228 Test Loss: 3.467 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.1575446128845215
Epoch: 27, Steps: 10 | Train Loss: 0.380 Vali Loss: 3.508 Vali Acc: 0.232 Test Loss: 3.508 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.991572380065918
Epoch: 28, Steps: 10 | Train Loss: 0.328 Vali Loss: 3.550 Vali Acc: 0.248 Test Loss: 3.550 Test Acc: 0.248
Validation loss decreased (-0.236437 --> -0.248200).  Saving model ...
Epoch: 29 cost time: 1.0197062492370605
Epoch: 29, Steps: 10 | Train Loss: 0.282 Vali Loss: 3.594 Vali Acc: 0.251 Test Loss: 3.594 Test Acc: 0.251
Validation loss decreased (-0.248200 --> -0.250552).  Saving model ...
Epoch: 30 cost time: 1.0705735683441162
Epoch: 30, Steps: 10 | Train Loss: 0.240 Vali Loss: 3.644 Vali Acc: 0.251 Test Loss: 3.644 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.1656827926635742
Epoch: 31, Steps: 10 | Train Loss: 0.209 Vali Loss: 3.693 Vali Acc: 0.249 Test Loss: 3.693 Test Acc: 0.249
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.0174968242645264
Epoch: 32, Steps: 10 | Train Loss: 0.173 Vali Loss: 3.740 Vali Acc: 0.249 Test Loss: 3.740 Test Acc: 0.249
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.1443345546722412
Epoch: 33, Steps: 10 | Train Loss: 0.157 Vali Loss: 3.798 Vali Acc: 0.247 Test Loss: 3.798 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.034069538116455
Epoch: 34, Steps: 10 | Train Loss: 0.145 Vali Loss: 3.830 Vali Acc: 0.255 Test Loss: 3.830 Test Acc: 0.255
Validation loss decreased (-0.250552 --> -0.255256).  Saving model ...
Epoch: 35 cost time: 1.1560015678405762
Epoch: 35, Steps: 10 | Train Loss: 0.123 Vali Loss: 3.882 Vali Acc: 0.254 Test Loss: 3.882 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.1372449398040771
Epoch: 36, Steps: 10 | Train Loss: 0.097 Vali Loss: 3.904 Vali Acc: 0.258 Test Loss: 3.904 Test Acc: 0.258
Validation loss decreased (-0.255256 --> -0.257608).  Saving model ...
Epoch: 37 cost time: 1.2936177253723145
Epoch: 37, Steps: 10 | Train Loss: 0.090 Vali Loss: 3.959 Vali Acc: 0.253 Test Loss: 3.959 Test Acc: 0.253
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.0830166339874268
Epoch: 38, Steps: 10 | Train Loss: 0.087 Vali Loss: 3.984 Vali Acc: 0.259 Test Loss: 3.984 Test Acc: 0.259
Validation loss decreased (-0.257608 --> -0.258784).  Saving model ...
Epoch: 39 cost time: 1.0179026126861572
Epoch: 39, Steps: 10 | Train Loss: 0.065 Vali Loss: 4.018 Vali Acc: 0.265 Test Loss: 4.018 Test Acc: 0.265
Validation loss decreased (-0.258784 --> -0.264666).  Saving model ...
Epoch: 40 cost time: 1.0365002155303955
Epoch: 40, Steps: 10 | Train Loss: 0.061 Vali Loss: 4.033 Vali Acc: 0.262 Test Loss: 4.033 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.1372194290161133
Epoch: 41, Steps: 10 | Train Loss: 0.061 Vali Loss: 4.063 Vali Acc: 0.262 Test Loss: 4.063 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.0145015716552734
Epoch: 42, Steps: 10 | Train Loss: 0.058 Vali Loss: 4.088 Vali Acc: 0.264 Test Loss: 4.088 Test Acc: 0.264
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.3581645488739014
Epoch: 43, Steps: 10 | Train Loss: 0.050 Vali Loss: 4.116 Vali Acc: 0.267 Test Loss: 4.116 Test Acc: 0.267
Validation loss decreased (-0.264666 --> -0.267018).  Saving model ...
Epoch: 44 cost time: 1.093061923980713
Epoch: 44, Steps: 10 | Train Loss: 0.045 Vali Loss: 4.140 Vali Acc: 0.269 Test Loss: 4.140 Test Acc: 0.269
Validation loss decreased (-0.267018 --> -0.269370).  Saving model ...
Epoch: 45 cost time: 1.1806578636169434
Epoch: 45, Steps: 10 | Train Loss: 0.037 Vali Loss: 4.184 Vali Acc: 0.268 Test Loss: 4.184 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.9945979118347168
Epoch: 46, Steps: 10 | Train Loss: 0.037 Vali Loss: 4.226 Vali Acc: 0.272 Test Loss: 4.226 Test Acc: 0.272
Validation loss decreased (-0.269370 --> -0.271722).  Saving model ...
Epoch: 47 cost time: 1.0595438480377197
Epoch: 47, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.241 Vali Acc: 0.275 Test Loss: 4.241 Test Acc: 0.275
Validation loss decreased (-0.271722 --> -0.275252).  Saving model ...
Epoch: 48 cost time: 1.06125807762146
Epoch: 48, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.267 Vali Acc: 0.265 Test Loss: 4.267 Test Acc: 0.265
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.0498087406158447
Epoch: 49, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.279 Vali Acc: 0.271 Test Loss: 4.279 Test Acc: 0.271
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.0023078918457031
Epoch: 50, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.304 Vali Acc: 0.274 Test Loss: 4.304 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps23_str12_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2752941176470588
model parameter : 108186
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.3941142559051514
Epoch: 1, Steps: 10 | Train Loss: 3.282 Vali Loss: 3.262 Vali Acc: 0.058 Test Loss: 3.262 Test Acc: 0.058
Validation loss decreased (inf --> -0.057614).  Saving model ...
Epoch: 2 cost time: 1.0423922538757324
Epoch: 2, Steps: 10 | Train Loss: 3.249 Vali Loss: 3.261 Vali Acc: 0.058 Test Loss: 3.261 Test Acc: 0.058
Validation loss decreased (-0.057614 --> -0.057614).  Saving model ...
Epoch: 3 cost time: 1.3332102298736572
Epoch: 3, Steps: 10 | Train Loss: 3.209 Vali Loss: 3.257 Vali Acc: 0.065 Test Loss: 3.257 Test Acc: 0.065
Validation loss decreased (-0.057614 --> -0.064673).  Saving model ...
Epoch: 4 cost time: 1.119767189025879
Epoch: 4, Steps: 10 | Train Loss: 3.174 Vali Loss: 3.250 Vali Acc: 0.065 Test Loss: 3.250 Test Acc: 0.065
Validation loss decreased (-0.064673 --> -0.064673).  Saving model ...
Epoch: 5 cost time: 1.2097179889678955
Epoch: 5, Steps: 10 | Train Loss: 3.093 Vali Loss: 3.244 Vali Acc: 0.066 Test Loss: 3.244 Test Acc: 0.066
Validation loss decreased (-0.064673 --> -0.065850).  Saving model ...
Epoch: 6 cost time: 1.0529358386993408
Epoch: 6, Steps: 10 | Train Loss: 3.044 Vali Loss: 3.238 Vali Acc: 0.073 Test Loss: 3.238 Test Acc: 0.073
Validation loss decreased (-0.065850 --> -0.072909).  Saving model ...
Epoch: 7 cost time: 1.0674004554748535
Epoch: 7, Steps: 10 | Train Loss: 2.939 Vali Loss: 3.233 Vali Acc: 0.075 Test Loss: 3.233 Test Acc: 0.075
Validation loss decreased (-0.072909 --> -0.075262).  Saving model ...
Epoch: 8 cost time: 1.0029222965240479
Epoch: 8, Steps: 10 | Train Loss: 2.895 Vali Loss: 3.230 Vali Acc: 0.081 Test Loss: 3.230 Test Acc: 0.081
Validation loss decreased (-0.075262 --> -0.081144).  Saving model ...
Epoch: 9 cost time: 1.035888433456421
Epoch: 9, Steps: 10 | Train Loss: 2.812 Vali Loss: 3.225 Vali Acc: 0.087 Test Loss: 3.225 Test Acc: 0.087
Validation loss decreased (-0.081144 --> -0.087027).  Saving model ...
Epoch: 10 cost time: 1.3101439476013184
Epoch: 10, Steps: 10 | Train Loss: 2.707 Vali Loss: 3.219 Vali Acc: 0.096 Test Loss: 3.219 Test Acc: 0.096
Validation loss decreased (-0.087027 --> -0.096438).  Saving model ...
Epoch: 11 cost time: 1.0965421199798584
Epoch: 11, Steps: 10 | Train Loss: 2.611 Vali Loss: 3.213 Vali Acc: 0.105 Test Loss: 3.213 Test Acc: 0.105
Validation loss decreased (-0.096438 --> -0.104674).  Saving model ...
Epoch: 12 cost time: 0.95526123046875
Epoch: 12, Steps: 10 | Train Loss: 2.523 Vali Loss: 3.206 Vali Acc: 0.120 Test Loss: 3.206 Test Acc: 0.120
Validation loss decreased (-0.104674 --> -0.119968).  Saving model ...
Epoch: 13 cost time: 1.1792330741882324
Epoch: 13, Steps: 10 | Train Loss: 2.420 Vali Loss: 3.198 Vali Acc: 0.131 Test Loss: 3.198 Test Acc: 0.131
Validation loss decreased (-0.119968 --> -0.130556).  Saving model ...
Epoch: 14 cost time: 1.0981676578521729
Epoch: 14, Steps: 10 | Train Loss: 2.291 Vali Loss: 3.198 Vali Acc: 0.139 Test Loss: 3.198 Test Acc: 0.139
Validation loss decreased (-0.130556 --> -0.138792).  Saving model ...
Epoch: 15 cost time: 0.9679713249206543
Epoch: 15, Steps: 10 | Train Loss: 2.168 Vali Loss: 3.195 Vali Acc: 0.144 Test Loss: 3.195 Test Acc: 0.144
Validation loss decreased (-0.138792 --> -0.143497).  Saving model ...
Epoch: 16 cost time: 1.0075740814208984
Epoch: 16, Steps: 10 | Train Loss: 2.050 Vali Loss: 3.194 Vali Acc: 0.160 Test Loss: 3.194 Test Acc: 0.160
Validation loss decreased (-0.143497 --> -0.159968).  Saving model ...
Epoch: 17 cost time: 0.9465770721435547
Epoch: 17, Steps: 10 | Train Loss: 1.918 Vali Loss: 3.194 Vali Acc: 0.166 Test Loss: 3.194 Test Acc: 0.166
Validation loss decreased (-0.159968 --> -0.165850).  Saving model ...
Epoch: 18 cost time: 1.0968830585479736
Epoch: 18, Steps: 10 | Train Loss: 1.755 Vali Loss: 3.194 Vali Acc: 0.173 Test Loss: 3.194 Test Acc: 0.173
Validation loss decreased (-0.165850 --> -0.172909).  Saving model ...
Epoch: 19 cost time: 1.0641965866088867
Epoch: 19, Steps: 10 | Train Loss: 1.610 Vali Loss: 3.201 Vali Acc: 0.180 Test Loss: 3.201 Test Acc: 0.180
Validation loss decreased (-0.172909 --> -0.179968).  Saving model ...
Epoch: 20 cost time: 1.2174599170684814
Epoch: 20, Steps: 10 | Train Loss: 1.499 Vali Loss: 3.208 Vali Acc: 0.181 Test Loss: 3.208 Test Acc: 0.181
Validation loss decreased (-0.179968 --> -0.181144).  Saving model ...
Epoch: 21 cost time: 1.2143912315368652
Epoch: 21, Steps: 10 | Train Loss: 1.377 Vali Loss: 3.230 Vali Acc: 0.188 Test Loss: 3.230 Test Acc: 0.188
Validation loss decreased (-0.181144 --> -0.188203).  Saving model ...
Epoch: 22 cost time: 1.0429680347442627
Epoch: 22, Steps: 10 | Train Loss: 1.202 Vali Loss: 3.248 Vali Acc: 0.198 Test Loss: 3.248 Test Acc: 0.198
Validation loss decreased (-0.188203 --> -0.197615).  Saving model ...
Epoch: 23 cost time: 0.8890852928161621
Epoch: 23, Steps: 10 | Train Loss: 1.077 Vali Loss: 3.266 Vali Acc: 0.201 Test Loss: 3.266 Test Acc: 0.201
Validation loss decreased (-0.197615 --> -0.201144).  Saving model ...
Epoch: 24 cost time: 1.4146804809570312
Epoch: 24, Steps: 10 | Train Loss: 0.963 Vali Loss: 3.291 Vali Acc: 0.205 Test Loss: 3.291 Test Acc: 0.205
Validation loss decreased (-0.201144 --> -0.204673).  Saving model ...
Epoch: 25 cost time: 1.0584871768951416
Epoch: 25, Steps: 10 | Train Loss: 0.822 Vali Loss: 3.307 Vali Acc: 0.214 Test Loss: 3.307 Test Acc: 0.214
Validation loss decreased (-0.204673 --> -0.214085).  Saving model ...
Epoch: 26 cost time: 1.0744688510894775
Epoch: 26, Steps: 10 | Train Loss: 0.727 Vali Loss: 3.338 Vali Acc: 0.216 Test Loss: 3.338 Test Acc: 0.216
Validation loss decreased (-0.214085 --> -0.216437).  Saving model ...
Epoch: 27 cost time: 1.0313901901245117
Epoch: 27, Steps: 10 | Train Loss: 0.615 Vali Loss: 3.389 Vali Acc: 0.220 Test Loss: 3.389 Test Acc: 0.220
Validation loss decreased (-0.216437 --> -0.219966).  Saving model ...
Epoch: 28 cost time: 1.0516784191131592
Epoch: 28, Steps: 10 | Train Loss: 0.545 Vali Loss: 3.446 Vali Acc: 0.228 Test Loss: 3.446 Test Acc: 0.228
Validation loss decreased (-0.219966 --> -0.228201).  Saving model ...
Epoch: 29 cost time: 1.080371379852295
Epoch: 29, Steps: 10 | Train Loss: 0.450 Vali Loss: 3.471 Vali Acc: 0.233 Test Loss: 3.471 Test Acc: 0.233
Validation loss decreased (-0.228201 --> -0.232906).  Saving model ...
Epoch: 30 cost time: 1.1169586181640625
Epoch: 30, Steps: 10 | Train Loss: 0.376 Vali Loss: 3.531 Vali Acc: 0.232 Test Loss: 3.531 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.112321138381958
Epoch: 31, Steps: 10 | Train Loss: 0.323 Vali Loss: 3.577 Vali Acc: 0.234 Test Loss: 3.577 Test Acc: 0.234
Validation loss decreased (-0.232906 --> -0.234082).  Saving model ...
Epoch: 32 cost time: 1.14141845703125
Epoch: 32, Steps: 10 | Train Loss: 0.305 Vali Loss: 3.614 Vali Acc: 0.232 Test Loss: 3.614 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.937197208404541
Epoch: 33, Steps: 10 | Train Loss: 0.261 Vali Loss: 3.647 Vali Acc: 0.232 Test Loss: 3.647 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.2764229774475098
Epoch: 34, Steps: 10 | Train Loss: 0.236 Vali Loss: 3.690 Vali Acc: 0.238 Test Loss: 3.690 Test Acc: 0.238
Validation loss decreased (-0.234082 --> -0.237610).  Saving model ...
Epoch: 35 cost time: 1.0209267139434814
Epoch: 35, Steps: 10 | Train Loss: 0.185 Vali Loss: 3.735 Vali Acc: 0.232 Test Loss: 3.735 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.1957528591156006
Epoch: 36, Steps: 10 | Train Loss: 0.165 Vali Loss: 3.777 Vali Acc: 0.246 Test Loss: 3.777 Test Acc: 0.246
Validation loss decreased (-0.237610 --> -0.245845).  Saving model ...
Epoch: 37 cost time: 1.1397290229797363
Epoch: 37, Steps: 10 | Train Loss: 0.153 Vali Loss: 3.831 Vali Acc: 0.244 Test Loss: 3.831 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.0966877937316895
Epoch: 38, Steps: 10 | Train Loss: 0.130 Vali Loss: 3.850 Vali Acc: 0.252 Test Loss: 3.850 Test Acc: 0.252
Validation loss decreased (-0.245845 --> -0.251726).  Saving model ...
Epoch: 39 cost time: 0.8803243637084961
Epoch: 39, Steps: 10 | Train Loss: 0.116 Vali Loss: 3.883 Vali Acc: 0.248 Test Loss: 3.883 Test Acc: 0.248
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.0907130241394043
Epoch: 40, Steps: 10 | Train Loss: 0.091 Vali Loss: 3.923 Vali Acc: 0.251 Test Loss: 3.923 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.1028492450714111
Epoch: 41, Steps: 10 | Train Loss: 0.095 Vali Loss: 3.966 Vali Acc: 0.249 Test Loss: 3.966 Test Acc: 0.249
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.202793836593628
Epoch: 42, Steps: 10 | Train Loss: 0.084 Vali Loss: 4.001 Vali Acc: 0.251 Test Loss: 4.001 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.0562677383422852
Epoch: 43, Steps: 10 | Train Loss: 0.077 Vali Loss: 4.023 Vali Acc: 0.249 Test Loss: 4.023 Test Acc: 0.249
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.0986785888671875
Epoch: 44, Steps: 10 | Train Loss: 0.065 Vali Loss: 4.054 Vali Acc: 0.255 Test Loss: 4.054 Test Acc: 0.255
Validation loss decreased (-0.251726 --> -0.255254).  Saving model ...
Epoch: 45 cost time: 0.9277186393737793
Epoch: 45, Steps: 10 | Train Loss: 0.054 Vali Loss: 4.086 Vali Acc: 0.252 Test Loss: 4.086 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.1823368072509766
Epoch: 46, Steps: 10 | Train Loss: 0.056 Vali Loss: 4.116 Vali Acc: 0.252 Test Loss: 4.116 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.9183990955352783
Epoch: 47, Steps: 10 | Train Loss: 0.054 Vali Loss: 4.151 Vali Acc: 0.261 Test Loss: 4.151 Test Acc: 0.261
Validation loss decreased (-0.255254 --> -0.261135).  Saving model ...
Epoch: 48 cost time: 1.0668272972106934
Epoch: 48, Steps: 10 | Train Loss: 0.045 Vali Loss: 4.177 Vali Acc: 0.262 Test Loss: 4.177 Test Acc: 0.262
Validation loss decreased (-0.261135 --> -0.262311).  Saving model ...
Epoch: 49 cost time: 1.0687923431396484
Epoch: 49, Steps: 10 | Train Loss: 0.047 Vali Loss: 4.187 Vali Acc: 0.265 Test Loss: 4.187 Test Acc: 0.265
Validation loss decreased (-0.262311 --> -0.264664).  Saving model ...
Epoch: 50 cost time: 0.9224176406860352
Epoch: 50, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.208 Vali Acc: 0.266 Test Loss: 4.208 Test Acc: 0.266
Validation loss decreased (-0.264664 --> -0.265840).  Saving model ...
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26588235294117646
model parameter : 103450
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps38_str19_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.1929566860198975
Epoch: 1, Steps: 10 | Train Loss: 3.291 Vali Loss: 3.270 Vali Acc: 0.034 Test Loss: 3.270 Test Acc: 0.034
Validation loss decreased (inf --> -0.034085).  Saving model ...
Epoch: 2 cost time: 1.0395450592041016
Epoch: 2, Steps: 10 | Train Loss: 3.252 Vali Loss: 3.267 Vali Acc: 0.033 Test Loss: 3.267 Test Acc: 0.033
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1736247539520264
Epoch: 3, Steps: 10 | Train Loss: 3.206 Vali Loss: 3.262 Vali Acc: 0.035 Test Loss: 3.262 Test Acc: 0.035
Validation loss decreased (-0.034085 --> -0.035261).  Saving model ...
Epoch: 4 cost time: 1.0376179218292236
Epoch: 4, Steps: 10 | Train Loss: 3.170 Vali Loss: 3.254 Vali Acc: 0.052 Test Loss: 3.254 Test Acc: 0.052
Validation loss decreased (-0.035261 --> -0.051732).  Saving model ...
Epoch: 5 cost time: 1.0267448425292969
Epoch: 5, Steps: 10 | Train Loss: 3.115 Vali Loss: 3.247 Vali Acc: 0.067 Test Loss: 3.247 Test Acc: 0.067
Validation loss decreased (-0.051732 --> -0.067026).  Saving model ...
Epoch: 6 cost time: 0.8897662162780762
Epoch: 6, Steps: 10 | Train Loss: 3.077 Vali Loss: 3.242 Vali Acc: 0.079 Test Loss: 3.242 Test Acc: 0.079
Validation loss decreased (-0.067026 --> -0.078791).  Saving model ...
Epoch: 7 cost time: 0.996666431427002
Epoch: 7, Steps: 10 | Train Loss: 3.001 Vali Loss: 3.237 Vali Acc: 0.082 Test Loss: 3.237 Test Acc: 0.082
Validation loss decreased (-0.078791 --> -0.082321).  Saving model ...
Epoch: 8 cost time: 1.0337822437286377
Epoch: 8, Steps: 10 | Train Loss: 2.932 Vali Loss: 3.231 Vali Acc: 0.082 Test Loss: 3.231 Test Acc: 0.082
Validation loss decreased (-0.082321 --> -0.082321).  Saving model ...
Epoch: 9 cost time: 1.0319743156433105
Epoch: 9, Steps: 10 | Train Loss: 2.845 Vali Loss: 3.226 Vali Acc: 0.091 Test Loss: 3.226 Test Acc: 0.091
Validation loss decreased (-0.082321 --> -0.090556).  Saving model ...
Epoch: 10 cost time: 0.9713897705078125
Epoch: 10, Steps: 10 | Train Loss: 2.773 Vali Loss: 3.222 Vali Acc: 0.094 Test Loss: 3.222 Test Acc: 0.094
Validation loss decreased (-0.090556 --> -0.094085).  Saving model ...
Epoch: 11 cost time: 1.0025599002838135
Epoch: 11, Steps: 10 | Train Loss: 2.719 Vali Loss: 3.220 Vali Acc: 0.099 Test Loss: 3.220 Test Acc: 0.099
Validation loss decreased (-0.094085 --> -0.098791).  Saving model ...
Epoch: 12 cost time: 1.0137152671813965
Epoch: 12, Steps: 10 | Train Loss: 2.597 Vali Loss: 3.213 Vali Acc: 0.111 Test Loss: 3.213 Test Acc: 0.111
Validation loss decreased (-0.098791 --> -0.110556).  Saving model ...
Epoch: 13 cost time: 1.0788905620574951
Epoch: 13, Steps: 10 | Train Loss: 2.533 Vali Loss: 3.209 Vali Acc: 0.120 Test Loss: 3.209 Test Acc: 0.120
Validation loss decreased (-0.110556 --> -0.119968).  Saving model ...
Epoch: 14 cost time: 1.020735502243042
Epoch: 14, Steps: 10 | Train Loss: 2.412 Vali Loss: 3.205 Vali Acc: 0.122 Test Loss: 3.205 Test Acc: 0.122
Validation loss decreased (-0.119968 --> -0.122321).  Saving model ...
Epoch: 15 cost time: 1.2111167907714844
Epoch: 15, Steps: 10 | Train Loss: 2.312 Vali Loss: 3.201 Vali Acc: 0.127 Test Loss: 3.201 Test Acc: 0.127
Validation loss decreased (-0.122321 --> -0.127027).  Saving model ...
Epoch: 16 cost time: 1.194716215133667
Epoch: 16, Steps: 10 | Train Loss: 2.198 Vali Loss: 3.197 Vali Acc: 0.136 Test Loss: 3.197 Test Acc: 0.136
Validation loss decreased (-0.127027 --> -0.136439).  Saving model ...
Epoch: 17 cost time: 0.9345381259918213
Epoch: 17, Steps: 10 | Train Loss: 2.042 Vali Loss: 3.196 Vali Acc: 0.152 Test Loss: 3.196 Test Acc: 0.152
Validation loss decreased (-0.136439 --> -0.151733).  Saving model ...
Epoch: 18 cost time: 1.283571720123291
Epoch: 18, Steps: 10 | Train Loss: 1.960 Vali Loss: 3.196 Vali Acc: 0.158 Test Loss: 3.196 Test Acc: 0.158
Validation loss decreased (-0.151733 --> -0.157615).  Saving model ...
Epoch: 19 cost time: 1.01033616065979
Epoch: 19, Steps: 10 | Train Loss: 1.808 Vali Loss: 3.196 Vali Acc: 0.166 Test Loss: 3.196 Test Acc: 0.166
Validation loss decreased (-0.157615 --> -0.165850).  Saving model ...
Epoch: 20 cost time: 1.0757403373718262
Epoch: 20, Steps: 10 | Train Loss: 1.655 Vali Loss: 3.202 Vali Acc: 0.171 Test Loss: 3.202 Test Acc: 0.171
Validation loss decreased (-0.165850 --> -0.170556).  Saving model ...
Epoch: 21 cost time: 1.1686146259307861
Epoch: 21, Steps: 10 | Train Loss: 1.535 Vali Loss: 3.207 Vali Acc: 0.174 Test Loss: 3.207 Test Acc: 0.174
Validation loss decreased (-0.170556 --> -0.174086).  Saving model ...
Epoch: 22 cost time: 1.1906850337982178
Epoch: 22, Steps: 10 | Train Loss: 1.401 Vali Loss: 3.219 Vali Acc: 0.181 Test Loss: 3.219 Test Acc: 0.181
Validation loss decreased (-0.174086 --> -0.181144).  Saving model ...
Epoch: 23 cost time: 1.0604631900787354
Epoch: 23, Steps: 10 | Train Loss: 1.283 Vali Loss: 3.238 Vali Acc: 0.189 Test Loss: 3.238 Test Acc: 0.189
Validation loss decreased (-0.181144 --> -0.189379).  Saving model ...
Epoch: 24 cost time: 1.0266263484954834
Epoch: 24, Steps: 10 | Train Loss: 1.168 Vali Loss: 3.252 Vali Acc: 0.199 Test Loss: 3.252 Test Acc: 0.199
Validation loss decreased (-0.189379 --> -0.198791).  Saving model ...
Epoch: 25 cost time: 1.173778772354126
Epoch: 25, Steps: 10 | Train Loss: 1.036 Vali Loss: 3.274 Vali Acc: 0.207 Test Loss: 3.274 Test Acc: 0.207
Validation loss decreased (-0.198791 --> -0.207026).  Saving model ...
Epoch: 26 cost time: 1.0345990657806396
Epoch: 26, Steps: 10 | Train Loss: 0.919 Vali Loss: 3.296 Vali Acc: 0.216 Test Loss: 3.296 Test Acc: 0.216
Validation loss decreased (-0.207026 --> -0.216438).  Saving model ...
Epoch: 27 cost time: 1.2190322875976562
Epoch: 27, Steps: 10 | Train Loss: 0.805 Vali Loss: 3.326 Vali Acc: 0.218 Test Loss: 3.326 Test Acc: 0.218
Validation loss decreased (-0.216438 --> -0.217614).  Saving model ...
Epoch: 28 cost time: 1.0995864868164062
Epoch: 28, Steps: 10 | Train Loss: 0.708 Vali Loss: 3.360 Vali Acc: 0.221 Test Loss: 3.360 Test Acc: 0.221
Validation loss decreased (-0.217614 --> -0.221143).  Saving model ...
Epoch: 29 cost time: 1.0962796211242676
Epoch: 29, Steps: 10 | Train Loss: 0.618 Vali Loss: 3.395 Vali Acc: 0.225 Test Loss: 3.395 Test Acc: 0.225
Validation loss decreased (-0.221143 --> -0.224672).  Saving model ...
Epoch: 30 cost time: 1.1279082298278809
Epoch: 30, Steps: 10 | Train Loss: 0.536 Vali Loss: 3.433 Vali Acc: 0.225 Test Loss: 3.433 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.9783973693847656
Epoch: 31, Steps: 10 | Train Loss: 0.455 Vali Loss: 3.478 Vali Acc: 0.229 Test Loss: 3.478 Test Acc: 0.229
Validation loss decreased (-0.224672 --> -0.229377).  Saving model ...
Epoch: 32 cost time: 1.034844160079956
Epoch: 32, Steps: 10 | Train Loss: 0.423 Vali Loss: 3.526 Vali Acc: 0.229 Test Loss: 3.526 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.0031063556671143
Epoch: 33, Steps: 10 | Train Loss: 0.370 Vali Loss: 3.566 Vali Acc: 0.233 Test Loss: 3.566 Test Acc: 0.233
Validation loss decreased (-0.229377 --> -0.232906).  Saving model ...
Epoch: 34 cost time: 1.130753755569458
Epoch: 34, Steps: 10 | Train Loss: 0.314 Vali Loss: 3.601 Vali Acc: 0.231 Test Loss: 3.601 Test Acc: 0.231
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.07674241065979
Epoch: 35, Steps: 10 | Train Loss: 0.276 Vali Loss: 3.643 Vali Acc: 0.236 Test Loss: 3.643 Test Acc: 0.236
Validation loss decreased (-0.232906 --> -0.236434).  Saving model ...
Epoch: 36 cost time: 1.1046724319458008
Epoch: 36, Steps: 10 | Train Loss: 0.250 Vali Loss: 3.691 Vali Acc: 0.239 Test Loss: 3.691 Test Acc: 0.239
Validation loss decreased (-0.236434 --> -0.238787).  Saving model ...
Epoch: 37 cost time: 1.162200927734375
Epoch: 37, Steps: 10 | Train Loss: 0.220 Vali Loss: 3.745 Vali Acc: 0.242 Test Loss: 3.745 Test Acc: 0.242
Validation loss decreased (-0.238787 --> -0.242315).  Saving model ...
Epoch: 38 cost time: 1.2649173736572266
Epoch: 38, Steps: 10 | Train Loss: 0.181 Vali Loss: 3.776 Vali Acc: 0.248 Test Loss: 3.776 Test Acc: 0.248
Validation loss decreased (-0.242315 --> -0.248198).  Saving model ...
Epoch: 39 cost time: 1.0549702644348145
Epoch: 39, Steps: 10 | Train Loss: 0.169 Vali Loss: 3.809 Vali Acc: 0.251 Test Loss: 3.809 Test Acc: 0.251
Validation loss decreased (-0.248198 --> -0.250550).  Saving model ...
Epoch: 40 cost time: 1.247119665145874
Epoch: 40, Steps: 10 | Train Loss: 0.148 Vali Loss: 3.867 Vali Acc: 0.249 Test Loss: 3.867 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.058619499206543
Epoch: 41, Steps: 10 | Train Loss: 0.125 Vali Loss: 3.914 Vali Acc: 0.247 Test Loss: 3.914 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.090101718902588
Epoch: 42, Steps: 10 | Train Loss: 0.111 Vali Loss: 3.952 Vali Acc: 0.253 Test Loss: 3.952 Test Acc: 0.253
Validation loss decreased (-0.250550 --> -0.252902).  Saving model ...
Epoch: 43 cost time: 1.1053731441497803
Epoch: 43, Steps: 10 | Train Loss: 0.113 Vali Loss: 3.983 Vali Acc: 0.252 Test Loss: 3.983 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.0762584209442139
Epoch: 44, Steps: 10 | Train Loss: 0.090 Vali Loss: 3.997 Vali Acc: 0.259 Test Loss: 3.997 Test Acc: 0.259
Validation loss decreased (-0.252902 --> -0.258784).  Saving model ...
Epoch: 45 cost time: 1.1605000495910645
Epoch: 45, Steps: 10 | Train Loss: 0.077 Vali Loss: 4.028 Vali Acc: 0.262 Test Loss: 4.028 Test Acc: 0.262
Validation loss decreased (-0.258784 --> -0.262313).  Saving model ...
Epoch: 46 cost time: 1.274855136871338
Epoch: 46, Steps: 10 | Train Loss: 0.072 Vali Loss: 4.065 Vali Acc: 0.262 Test Loss: 4.065 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.0895719528198242
Epoch: 47, Steps: 10 | Train Loss: 0.065 Vali Loss: 4.104 Vali Acc: 0.265 Test Loss: 4.104 Test Acc: 0.265
Validation loss decreased (-0.262313 --> -0.264665).  Saving model ...
Epoch: 48 cost time: 1.0976567268371582
Epoch: 48, Steps: 10 | Train Loss: 0.062 Vali Loss: 4.148 Vali Acc: 0.258 Test Loss: 4.148 Test Acc: 0.258
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.131174087524414
Epoch: 49, Steps: 10 | Train Loss: 0.057 Vali Loss: 4.180 Vali Acc: 0.256 Test Loss: 4.180 Test Acc: 0.256
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.9905388355255127
Epoch: 50, Steps: 10 | Train Loss: 0.049 Vali Loss: 4.213 Vali Acc: 0.253 Test Loss: 4.213 Test Acc: 0.253
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps38_str19_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2647058823529412
model parameter : 98682
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.2914695739746094
Epoch: 1, Steps: 10 | Train Loss: 3.240 Vali Loss: 3.255 Vali Acc: 0.048 Test Loss: 3.255 Test Acc: 0.048
Validation loss decreased (inf --> -0.048203).  Saving model ...
Epoch: 2 cost time: 1.4098093509674072
Epoch: 2, Steps: 10 | Train Loss: 2.845 Vali Loss: 3.283 Vali Acc: 0.089 Test Loss: 3.283 Test Acc: 0.089
Validation loss decreased (-0.048203 --> -0.089379).  Saving model ...
Epoch: 3 cost time: 1.3893225193023682
Epoch: 3, Steps: 10 | Train Loss: 2.217 Vali Loss: 3.219 Vali Acc: 0.148 Test Loss: 3.219 Test Acc: 0.148
Validation loss decreased (-0.089379 --> -0.148203).  Saving model ...
Epoch: 4 cost time: 1.428640365600586
Epoch: 4, Steps: 10 | Train Loss: 1.393 Vali Loss: 3.212 Vali Acc: 0.206 Test Loss: 3.212 Test Acc: 0.206
Validation loss decreased (-0.148203 --> -0.205850).  Saving model ...
Epoch: 5 cost time: 1.4838900566101074
Epoch: 5, Steps: 10 | Train Loss: 0.631 Vali Loss: 3.540 Vali Acc: 0.224 Test Loss: 3.540 Test Acc: 0.224
Validation loss decreased (-0.205850 --> -0.223494).  Saving model ...
Epoch: 6 cost time: 1.429215669631958
Epoch: 6, Steps: 10 | Train Loss: 0.240 Vali Loss: 3.899 Vali Acc: 0.261 Test Loss: 3.899 Test Acc: 0.261
Validation loss decreased (-0.223494 --> -0.261137).  Saving model ...
Epoch: 7 cost time: 1.5693440437316895
Epoch: 7, Steps: 10 | Train Loss: 0.072 Vali Loss: 4.432 Vali Acc: 0.249 Test Loss: 4.432 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5999445915222168
Epoch: 8, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.734 Vali Acc: 0.278 Test Loss: 4.734 Test Acc: 0.278
Validation loss decreased (-0.261137 --> -0.277600).  Saving model ...
Epoch: 9 cost time: 1.5723228454589844
Epoch: 9, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.970 Vali Acc: 0.275 Test Loss: 4.970 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.413097858428955
Epoch: 10, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.207 Vali Acc: 0.258 Test Loss: 5.207 Test Acc: 0.258
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.4086697101593018
Epoch: 11, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.217 Vali Acc: 0.264 Test Loss: 5.217 Test Acc: 0.264
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.2917208671569824
Epoch: 12, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.241 Vali Acc: 0.271 Test Loss: 5.241 Test Acc: 0.271
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.4030065536499023
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.273 Vali Acc: 0.273 Test Loss: 5.273 Test Acc: 0.273
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.311840534210205
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.313 Vali Acc: 0.269 Test Loss: 5.313 Test Acc: 0.269
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.3432555198669434
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.351 Vali Acc: 0.269 Test Loss: 5.351 Test Acc: 0.269
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.2204220294952393
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.389 Vali Acc: 0.264 Test Loss: 5.389 Test Acc: 0.264
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.5112810134887695
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.424 Vali Acc: 0.266 Test Loss: 5.424 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.577683925628662
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.446 Vali Acc: 0.266 Test Loss: 5.446 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2776470588235294
model parameter : 1851034
model size : 7.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.180954933166504
Epoch: 1, Steps: 10 | Train Loss: 3.249 Vali Loss: 3.256 Vali Acc: 0.055 Test Loss: 3.256 Test Acc: 0.055
Validation loss decreased (inf --> -0.055262).  Saving model ...
Epoch: 2 cost time: 1.3445298671722412
Epoch: 2, Steps: 10 | Train Loss: 2.990 Vali Loss: 3.250 Vali Acc: 0.095 Test Loss: 3.250 Test Acc: 0.095
Validation loss decreased (-0.055262 --> -0.095262).  Saving model ...
Epoch: 3 cost time: 1.2953758239746094
Epoch: 3, Steps: 10 | Train Loss: 2.640 Vali Loss: 3.253 Vali Acc: 0.113 Test Loss: 3.253 Test Acc: 0.113
Validation loss decreased (-0.095262 --> -0.112909).  Saving model ...
Epoch: 4 cost time: 1.4352614879608154
Epoch: 4, Steps: 10 | Train Loss: 2.135 Vali Loss: 3.219 Vali Acc: 0.155 Test Loss: 3.219 Test Acc: 0.155
Validation loss decreased (-0.112909 --> -0.155262).  Saving model ...
Epoch: 5 cost time: 1.3345322608947754
Epoch: 5, Steps: 10 | Train Loss: 1.583 Vali Loss: 3.215 Vali Acc: 0.188 Test Loss: 3.215 Test Acc: 0.188
Validation loss decreased (-0.155262 --> -0.188203).  Saving model ...
Epoch: 6 cost time: 1.4054434299468994
Epoch: 6, Steps: 10 | Train Loss: 1.019 Vali Loss: 3.294 Vali Acc: 0.195 Test Loss: 3.294 Test Acc: 0.195
Validation loss decreased (-0.188203 --> -0.195261).  Saving model ...
Epoch: 7 cost time: 1.3964548110961914
Epoch: 7, Steps: 10 | Train Loss: 0.596 Vali Loss: 3.470 Vali Acc: 0.240 Test Loss: 3.470 Test Acc: 0.240
Validation loss decreased (-0.195261 --> -0.239965).  Saving model ...
Epoch: 8 cost time: 1.3272173404693604
Epoch: 8, Steps: 10 | Train Loss: 0.283 Vali Loss: 3.779 Vali Acc: 0.246 Test Loss: 3.779 Test Acc: 0.246
Validation loss decreased (-0.239965 --> -0.245845).  Saving model ...
Epoch: 9 cost time: 1.4037797451019287
Epoch: 9, Steps: 10 | Train Loss: 0.115 Vali Loss: 4.086 Vali Acc: 0.261 Test Loss: 4.086 Test Acc: 0.261
Validation loss decreased (-0.245845 --> -0.261136).  Saving model ...
Epoch: 10 cost time: 1.3359062671661377
Epoch: 10, Steps: 10 | Train Loss: 0.049 Vali Loss: 4.328 Vali Acc: 0.262 Test Loss: 4.328 Test Acc: 0.262
Validation loss decreased (-0.261136 --> -0.262310).  Saving model ...
Epoch: 11 cost time: 1.2979543209075928
Epoch: 11, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.480 Vali Acc: 0.265 Test Loss: 4.480 Test Acc: 0.265
Validation loss decreased (-0.262310 --> -0.264661).  Saving model ...
Epoch: 12 cost time: 1.302246332168579
Epoch: 12, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.601 Vali Acc: 0.266 Test Loss: 4.601 Test Acc: 0.266
Validation loss decreased (-0.264661 --> -0.265836).  Saving model ...
Epoch: 13 cost time: 1.341909408569336
Epoch: 13, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.758 Vali Acc: 0.260 Test Loss: 4.758 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.371392011642456
Epoch: 14, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.797 Vali Acc: 0.265 Test Loss: 4.797 Test Acc: 0.265
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1555814743041992
Epoch: 15, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.856 Vali Acc: 0.268 Test Loss: 4.856 Test Acc: 0.268
Validation loss decreased (-0.265836 --> -0.268187).  Saving model ...
Epoch: 16 cost time: 1.371253490447998
Epoch: 16, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.904 Vali Acc: 0.268 Test Loss: 4.904 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4953067302703857
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.949 Vali Acc: 0.267 Test Loss: 4.949 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.4409472942352295
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.993 Vali Acc: 0.272 Test Loss: 4.993 Test Acc: 0.272
Validation loss decreased (-0.268187 --> -0.271715).  Saving model ...
Epoch: 19 cost time: 1.319615125656128
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.034 Vali Acc: 0.272 Test Loss: 5.034 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3245856761932373
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.071 Vali Acc: 0.273 Test Loss: 5.071 Test Acc: 0.273
Validation loss decreased (-0.271715 --> -0.272890).  Saving model ...
Epoch: 21 cost time: 1.3786399364471436
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.123 Vali Acc: 0.269 Test Loss: 5.123 Test Acc: 0.269
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.3015429973602295
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.154 Vali Acc: 0.269 Test Loss: 5.154 Test Acc: 0.269
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.2976655960083008
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.190 Vali Acc: 0.272 Test Loss: 5.190 Test Acc: 0.272
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.4511516094207764
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.219 Vali Acc: 0.272 Test Loss: 5.219 Test Acc: 0.272
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.2926301956176758
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.234 Vali Acc: 0.272 Test Loss: 5.234 Test Acc: 0.272
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.369429111480713
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.259 Vali Acc: 0.267 Test Loss: 5.259 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.4974377155303955
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.300 Vali Acc: 0.272 Test Loss: 5.300 Test Acc: 0.272
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.3582398891448975
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.320 Vali Acc: 0.271 Test Loss: 5.320 Test Acc: 0.271
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.3545479774475098
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.349 Vali Acc: 0.271 Test Loss: 5.349 Test Acc: 0.271
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.4392685890197754
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.378 Vali Acc: 0.272 Test Loss: 5.378 Test Acc: 0.272
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27294117647058824
model parameter : 1472154
model size : 5.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps12_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.0420658588409424
Epoch: 1, Steps: 10 | Train Loss: 3.263 Vali Loss: 3.266 Vali Acc: 0.033 Test Loss: 3.266 Test Acc: 0.033
Validation loss decreased (inf --> -0.032909).  Saving model ...
Epoch: 2 cost time: 1.2347397804260254
Epoch: 2, Steps: 10 | Train Loss: 3.069 Vali Loss: 3.258 Vali Acc: 0.067 Test Loss: 3.258 Test Acc: 0.067
Validation loss decreased (-0.032909 --> -0.067026).  Saving model ...
Epoch: 3 cost time: 1.2077019214630127
Epoch: 3, Steps: 10 | Train Loss: 2.773 Vali Loss: 3.267 Vali Acc: 0.104 Test Loss: 3.267 Test Acc: 0.104
Validation loss decreased (-0.067026 --> -0.103497).  Saving model ...
Epoch: 4 cost time: 1.1842517852783203
Epoch: 4, Steps: 10 | Train Loss: 2.433 Vali Loss: 3.247 Vali Acc: 0.122 Test Loss: 3.247 Test Acc: 0.122
Validation loss decreased (-0.103497 --> -0.122320).  Saving model ...
Epoch: 5 cost time: 1.2895276546478271
Epoch: 5, Steps: 10 | Train Loss: 1.983 Vali Loss: 3.203 Vali Acc: 0.155 Test Loss: 3.203 Test Acc: 0.155
Validation loss decreased (-0.122320 --> -0.155262).  Saving model ...
Epoch: 6 cost time: 1.2812247276306152
Epoch: 6, Steps: 10 | Train Loss: 1.536 Vali Loss: 3.194 Vali Acc: 0.186 Test Loss: 3.194 Test Acc: 0.186
Validation loss decreased (-0.155262 --> -0.185850).  Saving model ...
Epoch: 7 cost time: 1.3602349758148193
Epoch: 7, Steps: 10 | Train Loss: 1.083 Vali Loss: 3.252 Vali Acc: 0.206 Test Loss: 3.252 Test Acc: 0.206
Validation loss decreased (-0.185850 --> -0.205850).  Saving model ...
Epoch: 8 cost time: 1.0714080333709717
Epoch: 8, Steps: 10 | Train Loss: 0.636 Vali Loss: 3.384 Vali Acc: 0.222 Test Loss: 3.384 Test Acc: 0.222
Validation loss decreased (-0.205850 --> -0.222319).  Saving model ...
Epoch: 9 cost time: 1.296522855758667
Epoch: 9, Steps: 10 | Train Loss: 0.366 Vali Loss: 3.585 Vali Acc: 0.233 Test Loss: 3.585 Test Acc: 0.233
Validation loss decreased (-0.222319 --> -0.232905).  Saving model ...
Epoch: 10 cost time: 1.1666874885559082
Epoch: 10, Steps: 10 | Train Loss: 0.185 Vali Loss: 3.780 Vali Acc: 0.256 Test Loss: 3.780 Test Acc: 0.256
Validation loss decreased (-0.232905 --> -0.256433).  Saving model ...
Epoch: 11 cost time: 1.1762669086456299
Epoch: 11, Steps: 10 | Train Loss: 0.098 Vali Loss: 3.999 Vali Acc: 0.251 Test Loss: 3.999 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2734794616699219
Epoch: 12, Steps: 10 | Train Loss: 0.047 Vali Loss: 4.115 Vali Acc: 0.251 Test Loss: 4.115 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2450709342956543
Epoch: 13, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.297 Vali Acc: 0.249 Test Loss: 4.297 Test Acc: 0.249
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.2968533039093018
Epoch: 14, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.365 Vali Acc: 0.253 Test Loss: 4.365 Test Acc: 0.253
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.3230865001678467
Epoch: 15, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.423 Vali Acc: 0.255 Test Loss: 4.423 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.3851728439331055
Epoch: 16, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.485 Vali Acc: 0.255 Test Loss: 4.485 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.2079904079437256
Epoch: 17, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.536 Vali Acc: 0.255 Test Loss: 4.536 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.0694973468780518
Epoch: 18, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.577 Vali Acc: 0.253 Test Loss: 4.577 Test Acc: 0.253
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.145937204360962
Epoch: 19, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.633 Vali Acc: 0.254 Test Loss: 4.633 Test Acc: 0.254
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.175858736038208
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.664 Vali Acc: 0.252 Test Loss: 4.664 Test Acc: 0.252
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps12_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2564705882352941
model parameter : 1352858
model size : 5.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.1001839637756348
Epoch: 1, Steps: 10 | Train Loss: 3.269 Vali Loss: 3.269 Vali Acc: 0.045 Test Loss: 3.269 Test Acc: 0.045
Validation loss decreased (inf --> -0.044673).  Saving model ...
Epoch: 2 cost time: 1.3344428539276123
Epoch: 2, Steps: 10 | Train Loss: 3.122 Vali Loss: 3.251 Vali Acc: 0.071 Test Loss: 3.251 Test Acc: 0.071
Validation loss decreased (-0.044673 --> -0.070556).  Saving model ...
Epoch: 3 cost time: 1.2589290142059326
Epoch: 3, Steps: 10 | Train Loss: 2.867 Vali Loss: 3.244 Vali Acc: 0.099 Test Loss: 3.244 Test Acc: 0.099
Validation loss decreased (-0.070556 --> -0.098791).  Saving model ...
Epoch: 4 cost time: 1.1425535678863525
Epoch: 4, Steps: 10 | Train Loss: 2.548 Vali Loss: 3.218 Vali Acc: 0.121 Test Loss: 3.218 Test Acc: 0.121
Validation loss decreased (-0.098791 --> -0.121144).  Saving model ...
Epoch: 5 cost time: 1.4121665954589844
Epoch: 5, Steps: 10 | Train Loss: 2.237 Vali Loss: 3.204 Vali Acc: 0.144 Test Loss: 3.204 Test Acc: 0.144
Validation loss decreased (-0.121144 --> -0.143497).  Saving model ...
Epoch: 6 cost time: 1.0490531921386719
Epoch: 6, Steps: 10 | Train Loss: 1.831 Vali Loss: 3.172 Vali Acc: 0.171 Test Loss: 3.172 Test Acc: 0.171
Validation loss decreased (-0.143497 --> -0.170557).  Saving model ...
Epoch: 7 cost time: 1.3977200984954834
Epoch: 7, Steps: 10 | Train Loss: 1.392 Vali Loss: 3.175 Vali Acc: 0.198 Test Loss: 3.175 Test Acc: 0.198
Validation loss decreased (-0.170557 --> -0.197615).  Saving model ...
Epoch: 8 cost time: 1.2363560199737549
Epoch: 8, Steps: 10 | Train Loss: 0.996 Vali Loss: 3.210 Vali Acc: 0.216 Test Loss: 3.210 Test Acc: 0.216
Validation loss decreased (-0.197615 --> -0.216438).  Saving model ...
Epoch: 9 cost time: 1.2536602020263672
Epoch: 9, Steps: 10 | Train Loss: 0.672 Vali Loss: 3.316 Vali Acc: 0.233 Test Loss: 3.316 Test Acc: 0.233
Validation loss decreased (-0.216438 --> -0.232908).  Saving model ...
Epoch: 10 cost time: 1.2849223613739014
Epoch: 10, Steps: 10 | Train Loss: 0.391 Vali Loss: 3.446 Vali Acc: 0.248 Test Loss: 3.446 Test Acc: 0.248
Validation loss decreased (-0.232908 --> -0.248201).  Saving model ...
Epoch: 11 cost time: 1.103149175643921
Epoch: 11, Steps: 10 | Train Loss: 0.229 Vali Loss: 3.635 Vali Acc: 0.264 Test Loss: 3.635 Test Acc: 0.264
Validation loss decreased (-0.248201 --> -0.263493).  Saving model ...
Epoch: 12 cost time: 1.3031861782073975
Epoch: 12, Steps: 10 | Train Loss: 0.120 Vali Loss: 3.798 Vali Acc: 0.253 Test Loss: 3.798 Test Acc: 0.253
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1384520530700684
Epoch: 13, Steps: 10 | Train Loss: 0.071 Vali Loss: 3.920 Vali Acc: 0.269 Test Loss: 3.920 Test Acc: 0.269
Validation loss decreased (-0.263493 --> -0.269373).  Saving model ...
Epoch: 14 cost time: 1.3608214855194092
Epoch: 14, Steps: 10 | Train Loss: 0.043 Vali Loss: 4.012 Vali Acc: 0.276 Test Loss: 4.012 Test Acc: 0.276
Validation loss decreased (-0.269373 --> -0.276430).  Saving model ...
Epoch: 15 cost time: 1.2223644256591797
Epoch: 15, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.113 Vali Acc: 0.273 Test Loss: 4.113 Test Acc: 0.273
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2306928634643555
Epoch: 16, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.190 Vali Acc: 0.267 Test Loss: 4.190 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.2192587852478027
Epoch: 17, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.260 Vali Acc: 0.271 Test Loss: 4.260 Test Acc: 0.271
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.1895668506622314
Epoch: 18, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.310 Vali Acc: 0.273 Test Loss: 4.310 Test Acc: 0.273
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.2391271591186523
Epoch: 19, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.347 Vali Acc: 0.274 Test Loss: 4.347 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.1016333103179932
Epoch: 20, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.391 Vali Acc: 0.276 Test Loss: 4.391 Test Acc: 0.276
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.1699702739715576
Epoch: 21, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.415 Vali Acc: 0.280 Test Loss: 4.415 Test Acc: 0.280
Validation loss decreased (-0.276430 --> -0.279956).  Saving model ...
Epoch: 22 cost time: 1.4034268856048584
Epoch: 22, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.464 Vali Acc: 0.280 Test Loss: 4.464 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.36885666847229
Epoch: 23, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.512 Vali Acc: 0.276 Test Loss: 4.512 Test Acc: 0.276
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.2583518028259277
Epoch: 24, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.549 Vali Acc: 0.275 Test Loss: 4.549 Test Acc: 0.275
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.2404639720916748
Epoch: 25, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.580 Vali Acc: 0.274 Test Loss: 4.580 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.361067533493042
Epoch: 26, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.611 Vali Acc: 0.275 Test Loss: 4.611 Test Acc: 0.275
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.3546905517578125
Epoch: 27, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.633 Vali Acc: 0.276 Test Loss: 4.633 Test Acc: 0.276
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.3258461952209473
Epoch: 28, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.659 Vali Acc: 0.278 Test Loss: 4.659 Test Acc: 0.278
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.2729809284210205
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.686 Vali Acc: 0.276 Test Loss: 4.686 Test Acc: 0.276
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.2095091342926025
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.714 Vali Acc: 0.278 Test Loss: 4.714 Test Acc: 0.278
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.2082810401916504
Epoch: 31, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.734 Vali Acc: 0.279 Test Loss: 4.734 Test Acc: 0.279
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.28
model parameter : 1293466
model size : 4.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps23_str12_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.876703977584839
Epoch: 1, Steps: 10 | Train Loss: 3.253 Vali Loss: 3.257 Vali Acc: 0.040 Test Loss: 3.257 Test Acc: 0.040
Validation loss decreased (inf --> -0.039967).  Saving model ...
Epoch: 2 cost time: 1.1442487239837646
Epoch: 2, Steps: 10 | Train Loss: 3.142 Vali Loss: 3.240 Vali Acc: 0.075 Test Loss: 3.240 Test Acc: 0.075
Validation loss decreased (-0.039967 --> -0.075262).  Saving model ...
Epoch: 3 cost time: 1.2120633125305176
Epoch: 3, Steps: 10 | Train Loss: 2.972 Vali Loss: 3.224 Vali Acc: 0.100 Test Loss: 3.224 Test Acc: 0.100
Validation loss decreased (-0.075262 --> -0.099968).  Saving model ...
Epoch: 4 cost time: 1.228381633758545
Epoch: 4, Steps: 10 | Train Loss: 2.749 Vali Loss: 3.211 Vali Acc: 0.101 Test Loss: 3.211 Test Acc: 0.101
Validation loss decreased (-0.099968 --> -0.101144).  Saving model ...
Epoch: 5 cost time: 1.1998701095581055
Epoch: 5, Steps: 10 | Train Loss: 2.499 Vali Loss: 3.189 Vali Acc: 0.112 Test Loss: 3.189 Test Acc: 0.112
Validation loss decreased (-0.101144 --> -0.111733).  Saving model ...
Epoch: 6 cost time: 1.2601392269134521
Epoch: 6, Steps: 10 | Train Loss: 2.209 Vali Loss: 3.173 Vali Acc: 0.126 Test Loss: 3.173 Test Acc: 0.126
Validation loss decreased (-0.111733 --> -0.125851).  Saving model ...
Epoch: 7 cost time: 1.170220136642456
Epoch: 7, Steps: 10 | Train Loss: 1.899 Vali Loss: 3.165 Vali Acc: 0.158 Test Loss: 3.165 Test Acc: 0.158
Validation loss decreased (-0.125851 --> -0.157615).  Saving model ...
Epoch: 8 cost time: 1.2679848670959473
Epoch: 8, Steps: 10 | Train Loss: 1.587 Vali Loss: 3.163 Vali Acc: 0.186 Test Loss: 3.163 Test Acc: 0.186
Validation loss decreased (-0.157615 --> -0.185851).  Saving model ...
Epoch: 9 cost time: 1.2106053829193115
Epoch: 9, Steps: 10 | Train Loss: 1.200 Vali Loss: 3.180 Vali Acc: 0.212 Test Loss: 3.180 Test Acc: 0.212
Validation loss decreased (-0.185851 --> -0.211733).  Saving model ...
Epoch: 10 cost time: 1.18546724319458
Epoch: 10, Steps: 10 | Train Loss: 0.947 Vali Loss: 3.226 Vali Acc: 0.241 Test Loss: 3.226 Test Acc: 0.241
Validation loss decreased (-0.211733 --> -0.241144).  Saving model ...
Epoch: 11 cost time: 1.3020684719085693
Epoch: 11, Steps: 10 | Train Loss: 0.695 Vali Loss: 3.281 Vali Acc: 0.249 Test Loss: 3.281 Test Acc: 0.249
Validation loss decreased (-0.241144 --> -0.249379).  Saving model ...
Epoch: 12 cost time: 1.4054937362670898
Epoch: 12, Steps: 10 | Train Loss: 0.476 Vali Loss: 3.392 Vali Acc: 0.265 Test Loss: 3.392 Test Acc: 0.265
Validation loss decreased (-0.249379 --> -0.264672).  Saving model ...
Epoch: 13 cost time: 1.224303960800171
Epoch: 13, Steps: 10 | Train Loss: 0.304 Vali Loss: 3.488 Vali Acc: 0.259 Test Loss: 3.488 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2663476467132568
Epoch: 14, Steps: 10 | Train Loss: 0.204 Vali Loss: 3.628 Vali Acc: 0.268 Test Loss: 3.628 Test Acc: 0.268
Validation loss decreased (-0.264672 --> -0.268199).  Saving model ...
Epoch: 15 cost time: 1.2137043476104736
Epoch: 15, Steps: 10 | Train Loss: 0.126 Vali Loss: 3.734 Vali Acc: 0.269 Test Loss: 3.734 Test Acc: 0.269
Validation loss decreased (-0.268199 --> -0.269374).  Saving model ...
Epoch: 16 cost time: 1.1397504806518555
Epoch: 16, Steps: 10 | Train Loss: 0.084 Vali Loss: 3.796 Vali Acc: 0.272 Test Loss: 3.796 Test Acc: 0.272
Validation loss decreased (-0.269374 --> -0.271727).  Saving model ...
Epoch: 17 cost time: 1.141725778579712
Epoch: 17, Steps: 10 | Train Loss: 0.057 Vali Loss: 3.882 Vali Acc: 0.274 Test Loss: 3.882 Test Acc: 0.274
Validation loss decreased (-0.271727 --> -0.274079).  Saving model ...
Epoch: 18 cost time: 1.078383207321167
Epoch: 18, Steps: 10 | Train Loss: 0.043 Vali Loss: 3.933 Vali Acc: 0.278 Test Loss: 3.933 Test Acc: 0.278
Validation loss decreased (-0.274079 --> -0.277608).  Saving model ...
Epoch: 19 cost time: 1.0647485256195068
Epoch: 19, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.970 Vali Acc: 0.284 Test Loss: 3.970 Test Acc: 0.284
Validation loss decreased (-0.277608 --> -0.283490).  Saving model ...
Epoch: 20 cost time: 1.1022727489471436
Epoch: 20, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.034 Vali Acc: 0.280 Test Loss: 4.034 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1052255630493164
Epoch: 21, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.093 Vali Acc: 0.279 Test Loss: 4.093 Test Acc: 0.279
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.941317081451416
Epoch: 22, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.136 Vali Acc: 0.280 Test Loss: 4.136 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.9649722576141357
Epoch: 23, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.175 Vali Acc: 0.281 Test Loss: 4.175 Test Acc: 0.281
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.1524312496185303
Epoch: 24, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.234 Vali Acc: 0.286 Test Loss: 4.234 Test Acc: 0.286
Validation loss decreased (-0.283490 --> -0.285840).  Saving model ...
Epoch: 25 cost time: 1.1107096672058105
Epoch: 25, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.270 Vali Acc: 0.291 Test Loss: 4.270 Test Acc: 0.291
Validation loss decreased (-0.285840 --> -0.290546).  Saving model ...
Epoch: 26 cost time: 1.1605794429779053
Epoch: 26, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.297 Vali Acc: 0.285 Test Loss: 4.297 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.226181983947754
Epoch: 27, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.306 Vali Acc: 0.284 Test Loss: 4.306 Test Acc: 0.284
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.077758550643921
Epoch: 28, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.330 Vali Acc: 0.282 Test Loss: 4.330 Test Acc: 0.282
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.1585693359375
Epoch: 29, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.381 Vali Acc: 0.279 Test Loss: 4.381 Test Acc: 0.279
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.1908936500549316
Epoch: 30, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.405 Vali Acc: 0.282 Test Loss: 4.405 Test Acc: 0.282
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.0669105052947998
Epoch: 31, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.438 Vali Acc: 0.284 Test Loss: 4.438 Test Acc: 0.284
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.1690773963928223
Epoch: 32, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.458 Vali Acc: 0.285 Test Loss: 4.458 Test Acc: 0.285
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.9629976749420166
Epoch: 33, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.479 Vali Acc: 0.284 Test Loss: 4.479 Test Acc: 0.284
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.0910639762878418
Epoch: 34, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.521 Vali Acc: 0.282 Test Loss: 4.521 Test Acc: 0.282
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.0194807052612305
Epoch: 35, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.535 Vali Acc: 0.284 Test Loss: 4.535 Test Acc: 0.284
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps23_str12_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.29058823529411765
model parameter : 1214490
model size : 4.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.8538362979888916
Epoch: 1, Steps: 10 | Train Loss: 3.275 Vali Loss: 3.261 Vali Acc: 0.041 Test Loss: 3.261 Test Acc: 0.041
Validation loss decreased (inf --> -0.041144).  Saving model ...
Epoch: 2 cost time: 0.9918313026428223
Epoch: 2, Steps: 10 | Train Loss: 3.188 Vali Loss: 3.246 Vali Acc: 0.068 Test Loss: 3.246 Test Acc: 0.068
Validation loss decreased (-0.041144 --> -0.068203).  Saving model ...
Epoch: 3 cost time: 1.2092406749725342
Epoch: 3, Steps: 10 | Train Loss: 3.020 Vali Loss: 3.231 Vali Acc: 0.082 Test Loss: 3.231 Test Acc: 0.082
Validation loss decreased (-0.068203 --> -0.082321).  Saving model ...
Epoch: 4 cost time: 1.1866683959960938
Epoch: 4, Steps: 10 | Train Loss: 2.838 Vali Loss: 3.218 Vali Acc: 0.095 Test Loss: 3.218 Test Acc: 0.095
Validation loss decreased (-0.082321 --> -0.095262).  Saving model ...
Epoch: 5 cost time: 1.2243092060089111
Epoch: 5, Steps: 10 | Train Loss: 2.627 Vali Loss: 3.209 Vali Acc: 0.115 Test Loss: 3.209 Test Acc: 0.115
Validation loss decreased (-0.095262 --> -0.115262).  Saving model ...
Epoch: 6 cost time: 1.1437461376190186
Epoch: 6, Steps: 10 | Train Loss: 2.363 Vali Loss: 3.192 Vali Acc: 0.128 Test Loss: 3.192 Test Acc: 0.128
Validation loss decreased (-0.115262 --> -0.128203).  Saving model ...
Epoch: 7 cost time: 1.1194884777069092
Epoch: 7, Steps: 10 | Train Loss: 2.139 Vali Loss: 3.170 Vali Acc: 0.154 Test Loss: 3.170 Test Acc: 0.154
Validation loss decreased (-0.128203 --> -0.154086).  Saving model ...
Epoch: 8 cost time: 0.9365050792694092
Epoch: 8, Steps: 10 | Train Loss: 1.844 Vali Loss: 3.151 Vali Acc: 0.172 Test Loss: 3.151 Test Acc: 0.172
Validation loss decreased (-0.154086 --> -0.171733).  Saving model ...
Epoch: 9 cost time: 1.1594626903533936
Epoch: 9, Steps: 10 | Train Loss: 1.524 Vali Loss: 3.143 Vali Acc: 0.206 Test Loss: 3.143 Test Acc: 0.206
Validation loss decreased (-0.171733 --> -0.205851).  Saving model ...
Epoch: 10 cost time: 1.119962453842163
Epoch: 10, Steps: 10 | Train Loss: 1.237 Vali Loss: 3.150 Vali Acc: 0.219 Test Loss: 3.150 Test Acc: 0.219
Validation loss decreased (-0.205851 --> -0.218792).  Saving model ...
Epoch: 11 cost time: 1.12495756149292
Epoch: 11, Steps: 10 | Train Loss: 0.996 Vali Loss: 3.181 Vali Acc: 0.229 Test Loss: 3.181 Test Acc: 0.229
Validation loss decreased (-0.218792 --> -0.229380).  Saving model ...
Epoch: 12 cost time: 1.0348131656646729
Epoch: 12, Steps: 10 | Train Loss: 0.724 Vali Loss: 3.246 Vali Acc: 0.242 Test Loss: 3.246 Test Acc: 0.242
Validation loss decreased (-0.229380 --> -0.242320).  Saving model ...
Epoch: 13 cost time: 1.1599171161651611
Epoch: 13, Steps: 10 | Train Loss: 0.525 Vali Loss: 3.322 Vali Acc: 0.246 Test Loss: 3.322 Test Acc: 0.246
Validation loss decreased (-0.242320 --> -0.245849).  Saving model ...
Epoch: 14 cost time: 1.1360993385314941
Epoch: 14, Steps: 10 | Train Loss: 0.394 Vali Loss: 3.391 Vali Acc: 0.248 Test Loss: 3.391 Test Acc: 0.248
Validation loss decreased (-0.245849 --> -0.248201).  Saving model ...
Epoch: 15 cost time: 1.190871000289917
Epoch: 15, Steps: 10 | Train Loss: 0.242 Vali Loss: 3.477 Vali Acc: 0.255 Test Loss: 3.477 Test Acc: 0.255
Validation loss decreased (-0.248201 --> -0.255259).  Saving model ...
Epoch: 16 cost time: 1.0996942520141602
Epoch: 16, Steps: 10 | Train Loss: 0.164 Vali Loss: 3.571 Vali Acc: 0.272 Test Loss: 3.571 Test Acc: 0.272
Validation loss decreased (-0.255259 --> -0.271729).  Saving model ...
Epoch: 17 cost time: 1.040708065032959
Epoch: 17, Steps: 10 | Train Loss: 0.107 Vali Loss: 3.645 Vali Acc: 0.279 Test Loss: 3.645 Test Acc: 0.279
Validation loss decreased (-0.271729 --> -0.278787).  Saving model ...
Epoch: 18 cost time: 1.2206451892852783
Epoch: 18, Steps: 10 | Train Loss: 0.076 Vali Loss: 3.697 Vali Acc: 0.284 Test Loss: 3.697 Test Acc: 0.284
Validation loss decreased (-0.278787 --> -0.283492).  Saving model ...
Epoch: 19 cost time: 1.0181300640106201
Epoch: 19, Steps: 10 | Train Loss: 0.061 Vali Loss: 3.768 Vali Acc: 0.281 Test Loss: 3.768 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9022243022918701
Epoch: 20, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.828 Vali Acc: 0.280 Test Loss: 3.828 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.0227384567260742
Epoch: 21, Steps: 10 | Train Loss: 0.036 Vali Loss: 3.871 Vali Acc: 0.286 Test Loss: 3.871 Test Acc: 0.286
Validation loss decreased (-0.283492 --> -0.285844).  Saving model ...
Epoch: 22 cost time: 1.1306757926940918
Epoch: 22, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.920 Vali Acc: 0.285 Test Loss: 3.920 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.11651611328125
Epoch: 23, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.953 Vali Acc: 0.282 Test Loss: 3.953 Test Acc: 0.282
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.0468156337738037
Epoch: 24, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.988 Vali Acc: 0.285 Test Loss: 3.988 Test Acc: 0.285
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.0585691928863525
Epoch: 25, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.024 Vali Acc: 0.285 Test Loss: 4.024 Test Acc: 0.285
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.09848952293396
Epoch: 26, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.049 Vali Acc: 0.286 Test Loss: 4.049 Test Acc: 0.286
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.104459524154663
Epoch: 27, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.087 Vali Acc: 0.284 Test Loss: 4.087 Test Acc: 0.284
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.8808338642120361
Epoch: 28, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.102 Vali Acc: 0.289 Test Loss: 4.102 Test Acc: 0.289
Validation loss decreased (-0.285844 --> -0.289371).  Saving model ...
Epoch: 29 cost time: 1.1510660648345947
Epoch: 29, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.147 Vali Acc: 0.289 Test Loss: 4.147 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.0362234115600586
Epoch: 30, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.171 Vali Acc: 0.289 Test Loss: 4.171 Test Acc: 0.289
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.0308747291564941
Epoch: 31, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.198 Vali Acc: 0.293 Test Loss: 4.198 Test Acc: 0.293
Validation loss decreased (-0.289371 --> -0.292899).  Saving model ...
Epoch: 32 cost time: 1.1236050128936768
Epoch: 32, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.232 Vali Acc: 0.291 Test Loss: 4.232 Test Acc: 0.291
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.9949440956115723
Epoch: 33, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.245 Vali Acc: 0.289 Test Loss: 4.245 Test Acc: 0.289
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.1230127811431885
Epoch: 34, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.274 Vali Acc: 0.292 Test Loss: 4.274 Test Acc: 0.292
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.0173335075378418
Epoch: 35, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.292 Vali Acc: 0.293 Test Loss: 4.292 Test Acc: 0.293
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.0189855098724365
Epoch: 36, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.316 Vali Acc: 0.295 Test Loss: 4.316 Test Acc: 0.295
Validation loss decreased (-0.292899 --> -0.295251).  Saving model ...
Epoch: 37 cost time: 1.08856201171875
Epoch: 37, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.322 Vali Acc: 0.295 Test Loss: 4.322 Test Acc: 0.295
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.1615352630615234
Epoch: 38, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.353 Vali Acc: 0.296 Test Loss: 4.353 Test Acc: 0.296
Validation loss decreased (-0.295251 --> -0.296427).  Saving model ...
Epoch: 39 cost time: 1.0700039863586426
Epoch: 39, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.374 Vali Acc: 0.296 Test Loss: 4.374 Test Acc: 0.296
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.0992183685302734
Epoch: 40, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.388 Vali Acc: 0.295 Test Loss: 4.388 Test Acc: 0.295
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.0697546005249023
Epoch: 41, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.409 Vali Acc: 0.295 Test Loss: 4.409 Test Acc: 0.295
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.2079062461853027
Epoch: 42, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.433 Vali Acc: 0.294 Test Loss: 4.433 Test Acc: 0.294
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.1392395496368408
Epoch: 43, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.450 Vali Acc: 0.298 Test Loss: 4.450 Test Acc: 0.298
Validation loss decreased (-0.296427 --> -0.297603).  Saving model ...
Epoch: 44 cost time: 1.0350284576416016
Epoch: 44, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.466 Vali Acc: 0.296 Test Loss: 4.466 Test Acc: 0.296
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.1720104217529297
Epoch: 45, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.491 Vali Acc: 0.295 Test Loss: 4.491 Test Acc: 0.295
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.0277376174926758
Epoch: 46, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.502 Vali Acc: 0.295 Test Loss: 4.502 Test Acc: 0.295
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.0851836204528809
Epoch: 47, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.507 Vali Acc: 0.296 Test Loss: 4.507 Test Acc: 0.296
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.1653358936309814
Epoch: 48, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.521 Vali Acc: 0.298 Test Loss: 4.521 Test Acc: 0.298
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.061319351196289
Epoch: 49, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.531 Vali Acc: 0.295 Test Loss: 4.531 Test Acc: 0.295
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 1.035074234008789
Epoch: 50, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.549 Vali Acc: 0.296 Test Loss: 4.549 Test Acc: 0.296
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.29764705882352943
model parameter : 1195546
model size : 4.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps38_str19_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.5232787132263184
Epoch: 1, Steps: 10 | Train Loss: 3.298 Vali Loss: 3.270 Vali Acc: 0.039 Test Loss: 3.270 Test Acc: 0.039
Validation loss decreased (inf --> -0.038791).  Saving model ...
Epoch: 2 cost time: 1.0707440376281738
Epoch: 2, Steps: 10 | Train Loss: 3.202 Vali Loss: 3.256 Vali Acc: 0.049 Test Loss: 3.256 Test Acc: 0.049
Validation loss decreased (-0.038791 --> -0.049379).  Saving model ...
Epoch: 3 cost time: 1.0939593315124512
Epoch: 3, Steps: 10 | Train Loss: 3.052 Vali Loss: 3.238 Vali Acc: 0.064 Test Loss: 3.238 Test Acc: 0.064
Validation loss decreased (-0.049379 --> -0.063497).  Saving model ...
Epoch: 4 cost time: 1.1107778549194336
Epoch: 4, Steps: 10 | Train Loss: 2.870 Vali Loss: 3.228 Vali Acc: 0.089 Test Loss: 3.228 Test Acc: 0.089
Validation loss decreased (-0.063497 --> -0.089379).  Saving model ...
Epoch: 5 cost time: 1.0940945148468018
Epoch: 5, Steps: 10 | Train Loss: 2.669 Vali Loss: 3.215 Vali Acc: 0.111 Test Loss: 3.215 Test Acc: 0.111
Validation loss decreased (-0.089379 --> -0.110556).  Saving model ...
Epoch: 6 cost time: 1.0522792339324951
Epoch: 6, Steps: 10 | Train Loss: 2.473 Vali Loss: 3.206 Vali Acc: 0.126 Test Loss: 3.206 Test Acc: 0.126
Validation loss decreased (-0.110556 --> -0.125850).  Saving model ...
Epoch: 7 cost time: 1.0413460731506348
Epoch: 7, Steps: 10 | Train Loss: 2.238 Vali Loss: 3.196 Vali Acc: 0.146 Test Loss: 3.196 Test Acc: 0.146
Validation loss decreased (-0.125850 --> -0.145850).  Saving model ...
Epoch: 8 cost time: 1.0533835887908936
Epoch: 8, Steps: 10 | Train Loss: 1.973 Vali Loss: 3.179 Vali Acc: 0.160 Test Loss: 3.179 Test Acc: 0.160
Validation loss decreased (-0.145850 --> -0.159968).  Saving model ...
Epoch: 9 cost time: 1.1221082210540771
Epoch: 9, Steps: 10 | Train Loss: 1.751 Vali Loss: 3.173 Vali Acc: 0.184 Test Loss: 3.173 Test Acc: 0.184
Validation loss decreased (-0.159968 --> -0.183498).  Saving model ...
Epoch: 10 cost time: 1.2910652160644531
Epoch: 10, Steps: 10 | Train Loss: 1.457 Vali Loss: 3.180 Vali Acc: 0.194 Test Loss: 3.180 Test Acc: 0.194
Validation loss decreased (-0.183498 --> -0.194086).  Saving model ...
Epoch: 11 cost time: 1.125173807144165
Epoch: 11, Steps: 10 | Train Loss: 1.191 Vali Loss: 3.192 Vali Acc: 0.218 Test Loss: 3.192 Test Acc: 0.218
Validation loss decreased (-0.194086 --> -0.217615).  Saving model ...
Epoch: 12 cost time: 1.1304612159729004
Epoch: 12, Steps: 10 | Train Loss: 0.938 Vali Loss: 3.237 Vali Acc: 0.225 Test Loss: 3.237 Test Acc: 0.225
Validation loss decreased (-0.217615 --> -0.224674).  Saving model ...
Epoch: 13 cost time: 1.1767470836639404
Epoch: 13, Steps: 10 | Train Loss: 0.748 Vali Loss: 3.282 Vali Acc: 0.241 Test Loss: 3.282 Test Acc: 0.241
Validation loss decreased (-0.224674 --> -0.241144).  Saving model ...
Epoch: 14 cost time: 1.2352864742279053
Epoch: 14, Steps: 10 | Train Loss: 0.554 Vali Loss: 3.355 Vali Acc: 0.247 Test Loss: 3.355 Test Acc: 0.247
Validation loss decreased (-0.241144 --> -0.247025).  Saving model ...
Epoch: 15 cost time: 1.160459041595459
Epoch: 15, Steps: 10 | Train Loss: 0.381 Vali Loss: 3.431 Vali Acc: 0.258 Test Loss: 3.431 Test Acc: 0.258
Validation loss decreased (-0.247025 --> -0.257613).  Saving model ...
Epoch: 16 cost time: 1.1757729053497314
Epoch: 16, Steps: 10 | Train Loss: 0.262 Vali Loss: 3.527 Vali Acc: 0.261 Test Loss: 3.527 Test Acc: 0.261
Validation loss decreased (-0.257613 --> -0.261141).  Saving model ...
Epoch: 17 cost time: 1.1915247440338135
Epoch: 17, Steps: 10 | Train Loss: 0.183 Vali Loss: 3.582 Vali Acc: 0.265 Test Loss: 3.582 Test Acc: 0.265
Validation loss decreased (-0.261141 --> -0.264670).  Saving model ...
Epoch: 18 cost time: 1.2251553535461426
Epoch: 18, Steps: 10 | Train Loss: 0.130 Vali Loss: 3.660 Vali Acc: 0.266 Test Loss: 3.660 Test Acc: 0.266
Validation loss decreased (-0.264670 --> -0.265846).  Saving model ...
Epoch: 19 cost time: 1.1553254127502441
Epoch: 19, Steps: 10 | Train Loss: 0.095 Vali Loss: 3.734 Vali Acc: 0.267 Test Loss: 3.734 Test Acc: 0.267
Validation loss decreased (-0.265846 --> -0.267021).  Saving model ...
Epoch: 20 cost time: 1.1023688316345215
Epoch: 20, Steps: 10 | Train Loss: 0.074 Vali Loss: 3.788 Vali Acc: 0.267 Test Loss: 3.788 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1437005996704102
Epoch: 21, Steps: 10 | Train Loss: 0.056 Vali Loss: 3.851 Vali Acc: 0.274 Test Loss: 3.851 Test Acc: 0.274
Validation loss decreased (-0.267021 --> -0.274079).  Saving model ...
Epoch: 22 cost time: 1.0420575141906738
Epoch: 22, Steps: 10 | Train Loss: 0.045 Vali Loss: 3.906 Vali Acc: 0.280 Test Loss: 3.906 Test Acc: 0.280
Validation loss decreased (-0.274079 --> -0.279961).  Saving model ...
Epoch: 23 cost time: 1.195802927017212
Epoch: 23, Steps: 10 | Train Loss: 0.038 Vali Loss: 3.932 Vali Acc: 0.278 Test Loss: 3.932 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.044450283050537
Epoch: 24, Steps: 10 | Train Loss: 0.033 Vali Loss: 3.985 Vali Acc: 0.281 Test Loss: 3.985 Test Acc: 0.281
Validation loss decreased (-0.279961 --> -0.281137).  Saving model ...
Epoch: 25 cost time: 1.2171082496643066
Epoch: 25, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.022 Vali Acc: 0.279 Test Loss: 4.022 Test Acc: 0.279
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0985376834869385
Epoch: 26, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.054 Vali Acc: 0.282 Test Loss: 4.054 Test Acc: 0.282
Validation loss decreased (-0.281137 --> -0.282312).  Saving model ...
Epoch: 27 cost time: 1.170713186264038
Epoch: 27, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.104 Vali Acc: 0.282 Test Loss: 4.104 Test Acc: 0.282
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0526108741760254
Epoch: 28, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.137 Vali Acc: 0.285 Test Loss: 4.137 Test Acc: 0.285
Validation loss decreased (-0.282312 --> -0.284665).  Saving model ...
Epoch: 29 cost time: 1.160750150680542
Epoch: 29, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.180 Vali Acc: 0.280 Test Loss: 4.180 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.1753461360931396
Epoch: 30, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.193 Vali Acc: 0.280 Test Loss: 4.193 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.2884371280670166
Epoch: 31, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.210 Vali Acc: 0.282 Test Loss: 4.210 Test Acc: 0.282
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.055022954940796
Epoch: 32, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.238 Vali Acc: 0.288 Test Loss: 4.238 Test Acc: 0.288
Validation loss decreased (-0.284665 --> -0.288193).  Saving model ...
Epoch: 33 cost time: 1.0941693782806396
Epoch: 33, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.262 Vali Acc: 0.293 Test Loss: 4.262 Test Acc: 0.293
Validation loss decreased (-0.288193 --> -0.292899).  Saving model ...
Epoch: 34 cost time: 1.1202342510223389
Epoch: 34, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.284 Vali Acc: 0.291 Test Loss: 4.284 Test Acc: 0.291
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.2315199375152588
Epoch: 35, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.321 Vali Acc: 0.289 Test Loss: 4.321 Test Acc: 0.289
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.23795485496521
Epoch: 36, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.329 Vali Acc: 0.292 Test Loss: 4.329 Test Acc: 0.292
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.2699201107025146
Epoch: 37, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.361 Vali Acc: 0.296 Test Loss: 4.361 Test Acc: 0.296
Validation loss decreased (-0.292899 --> -0.296427).  Saving model ...
Epoch: 38 cost time: 1.2388544082641602
Epoch: 38, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.374 Vali Acc: 0.293 Test Loss: 4.374 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.0864462852478027
Epoch: 39, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.405 Vali Acc: 0.294 Test Loss: 4.405 Test Acc: 0.294
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.170335054397583
Epoch: 40, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.424 Vali Acc: 0.293 Test Loss: 4.424 Test Acc: 0.293
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.1738166809082031
Epoch: 41, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.444 Vali Acc: 0.289 Test Loss: 4.444 Test Acc: 0.289
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.1931037902832031
Epoch: 42, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.479 Vali Acc: 0.293 Test Loss: 4.479 Test Acc: 0.293
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.1968498229980469
Epoch: 43, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.486 Vali Acc: 0.291 Test Loss: 4.486 Test Acc: 0.291
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.207573413848877
Epoch: 44, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.490 Vali Acc: 0.294 Test Loss: 4.490 Test Acc: 0.294
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.0914902687072754
Epoch: 45, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.536 Vali Acc: 0.299 Test Loss: 4.536 Test Acc: 0.299
Validation loss decreased (-0.296427 --> -0.298778).  Saving model ...
Epoch: 46 cost time: 1.2398064136505127
Epoch: 46, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.539 Vali Acc: 0.299 Test Loss: 4.539 Test Acc: 0.299
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.2714629173278809
Epoch: 47, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.559 Vali Acc: 0.298 Test Loss: 4.559 Test Acc: 0.298
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.2766547203063965
Epoch: 48, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.562 Vali Acc: 0.299 Test Loss: 4.562 Test Acc: 0.299
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.2312958240509033
Epoch: 49, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.593 Vali Acc: 0.299 Test Loss: 4.593 Test Acc: 0.299
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 1.1052870750427246
Epoch: 50, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.611 Vali Acc: 0.300 Test Loss: 4.611 Test Acc: 0.300
Validation loss decreased (-0.298778 --> -0.299954).  Saving model ...
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps38_str19_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3
model parameter : 1176474
model size : 4.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.669142723083496
Epoch: 1, Steps: 10 | Train Loss: 3.240 Vali Loss: 3.275 Vali Acc: 0.042 Test Loss: 3.275 Test Acc: 0.042
Validation loss decreased (inf --> -0.042320).  Saving model ...
Epoch: 2 cost time: 0.983217716217041
Epoch: 2, Steps: 10 | Train Loss: 2.999 Vali Loss: 3.277 Vali Acc: 0.073 Test Loss: 3.277 Test Acc: 0.073
Validation loss decreased (-0.042320 --> -0.072908).  Saving model ...
Epoch: 3 cost time: 0.9362137317657471
Epoch: 3, Steps: 10 | Train Loss: 2.652 Vali Loss: 3.286 Vali Acc: 0.085 Test Loss: 3.286 Test Acc: 0.085
Validation loss decreased (-0.072908 --> -0.084673).  Saving model ...
Epoch: 4 cost time: 1.029512643814087
Epoch: 4, Steps: 10 | Train Loss: 2.208 Vali Loss: 3.224 Vali Acc: 0.135 Test Loss: 3.224 Test Acc: 0.135
Validation loss decreased (-0.084673 --> -0.135262).  Saving model ...
Epoch: 5 cost time: 1.001199722290039
Epoch: 5, Steps: 10 | Train Loss: 1.618 Vali Loss: 3.198 Vali Acc: 0.174 Test Loss: 3.198 Test Acc: 0.174
Validation loss decreased (-0.135262 --> -0.174086).  Saving model ...
Epoch: 6 cost time: 1.0812182426452637
Epoch: 6, Steps: 10 | Train Loss: 1.060 Vali Loss: 3.278 Vali Acc: 0.198 Test Loss: 3.278 Test Acc: 0.198
Validation loss decreased (-0.174086 --> -0.197614).  Saving model ...
Epoch: 7 cost time: 1.0052595138549805
Epoch: 7, Steps: 10 | Train Loss: 0.599 Vali Loss: 3.436 Vali Acc: 0.225 Test Loss: 3.436 Test Acc: 0.225
Validation loss decreased (-0.197614 --> -0.224672).  Saving model ...
Epoch: 8 cost time: 1.0679705142974854
Epoch: 8, Steps: 10 | Train Loss: 0.272 Vali Loss: 3.742 Vali Acc: 0.234 Test Loss: 3.742 Test Acc: 0.234
Validation loss decreased (-0.224672 --> -0.234080).  Saving model ...
Epoch: 9 cost time: 1.0139057636260986
Epoch: 9, Steps: 10 | Train Loss: 0.129 Vali Loss: 4.013 Vali Acc: 0.244 Test Loss: 4.013 Test Acc: 0.244
Validation loss decreased (-0.234080 --> -0.243489).  Saving model ...
Epoch: 10 cost time: 1.0759129524230957
Epoch: 10, Steps: 10 | Train Loss: 0.051 Vali Loss: 4.181 Vali Acc: 0.252 Test Loss: 4.181 Test Acc: 0.252
Validation loss decreased (-0.243489 --> -0.251723).  Saving model ...
Epoch: 11 cost time: 0.9171273708343506
Epoch: 11, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.378 Vali Acc: 0.248 Test Loss: 4.378 Test Acc: 0.248
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0377781391143799
Epoch: 12, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.472 Vali Acc: 0.259 Test Loss: 4.472 Test Acc: 0.259
Validation loss decreased (-0.251723 --> -0.258779).  Saving model ...
Epoch: 13 cost time: 0.9276587963104248
Epoch: 13, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.568 Vali Acc: 0.256 Test Loss: 4.568 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.960963249206543
Epoch: 14, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.612 Vali Acc: 0.251 Test Loss: 4.612 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.019021987915039
Epoch: 15, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.633 Vali Acc: 0.258 Test Loss: 4.633 Test Acc: 0.258
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.8609273433685303
Epoch: 16, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.674 Vali Acc: 0.265 Test Loss: 4.674 Test Acc: 0.265
Validation loss decreased (-0.258779 --> -0.264659).  Saving model ...
Epoch: 17 cost time: 0.9541563987731934
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.721 Vali Acc: 0.269 Test Loss: 4.721 Test Acc: 0.269
Validation loss decreased (-0.264659 --> -0.269365).  Saving model ...
Epoch: 18 cost time: 0.9099318981170654
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.751 Vali Acc: 0.268 Test Loss: 4.751 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9976406097412109
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.798 Vali Acc: 0.267 Test Loss: 4.798 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.0630862712860107
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.828 Vali Acc: 0.265 Test Loss: 4.828 Test Acc: 0.265
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.9334111213684082
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.859 Vali Acc: 0.266 Test Loss: 4.859 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.9771344661712646
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.901 Vali Acc: 0.265 Test Loss: 4.901 Test Acc: 0.265
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.9455256462097168
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.931 Vali Acc: 0.266 Test Loss: 4.931 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.9526102542877197
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.953 Vali Acc: 0.266 Test Loss: 4.953 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.0206995010375977
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.984 Vali Acc: 0.269 Test Loss: 4.984 Test Acc: 0.269
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.0103585720062256
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.994 Vali Acc: 0.272 Test Loss: 4.994 Test Acc: 0.272
Validation loss decreased (-0.269365 --> -0.271715).  Saving model ...
Epoch: 27 cost time: 0.9198710918426514
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.021 Vali Acc: 0.273 Test Loss: 5.021 Test Acc: 0.273
Validation loss decreased (-0.271715 --> -0.272891).  Saving model ...
Epoch: 28 cost time: 0.8919339179992676
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.050 Vali Acc: 0.273 Test Loss: 5.050 Test Acc: 0.273
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.8541274070739746
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.080 Vali Acc: 0.272 Test Loss: 5.080 Test Acc: 0.272
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.860318660736084
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.110 Vali Acc: 0.273 Test Loss: 5.110 Test Acc: 0.273
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.9495055675506592
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.131 Vali Acc: 0.275 Test Loss: 5.131 Test Acc: 0.275
Validation loss decreased (-0.272891 --> -0.275243).  Saving model ...
Epoch: 32 cost time: 0.9676361083984375
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.157 Vali Acc: 0.275 Test Loss: 5.157 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.9971153736114502
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.177 Vali Acc: 0.274 Test Loss: 5.177 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.9364340305328369
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.195 Vali Acc: 0.275 Test Loss: 5.195 Test Acc: 0.275
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.9856472015380859
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.218 Vali Acc: 0.276 Test Loss: 5.218 Test Acc: 0.276
Validation loss decreased (-0.275243 --> -0.276418).  Saving model ...
Epoch: 36 cost time: 0.9742476940155029
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.236 Vali Acc: 0.275 Test Loss: 5.236 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.1361463069915771
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.260 Vali Acc: 0.274 Test Loss: 5.260 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.9560356140136719
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.274 Vali Acc: 0.274 Test Loss: 5.274 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.0174646377563477
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.296 Vali Acc: 0.274 Test Loss: 5.296 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.9097702503204346
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.314 Vali Acc: 0.273 Test Loss: 5.314 Test Acc: 0.273
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.096958875656128
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.333 Vali Acc: 0.272 Test Loss: 5.333 Test Acc: 0.272
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.9142510890960693
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.360 Vali Acc: 0.274 Test Loss: 5.360 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.0647871494293213
Epoch: 43, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.363 Vali Acc: 0.275 Test Loss: 5.363 Test Acc: 0.275
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.0715620517730713
Epoch: 44, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.398 Vali Acc: 0.275 Test Loss: 5.398 Test Acc: 0.275
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 1.0171024799346924
Epoch: 45, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.409 Vali Acc: 0.275 Test Loss: 5.409 Test Acc: 0.275
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27647058823529413
model parameter : 663386
model size : 2.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.574828863143921
Epoch: 1, Steps: 10 | Train Loss: 3.327 Vali Loss: 3.266 Vali Acc: 0.040 Test Loss: 3.266 Test Acc: 0.040
Validation loss decreased (inf --> -0.039967).  Saving model ...
Epoch: 2 cost time: 1.0064873695373535
Epoch: 2, Steps: 10 | Train Loss: 3.153 Vali Loss: 3.250 Vali Acc: 0.062 Test Loss: 3.250 Test Acc: 0.062
Validation loss decreased (-0.039967 --> -0.062320).  Saving model ...
Epoch: 3 cost time: 0.986339807510376
Epoch: 3, Steps: 10 | Train Loss: 2.939 Vali Loss: 3.246 Vali Acc: 0.081 Test Loss: 3.246 Test Acc: 0.081
Validation loss decreased (-0.062320 --> -0.081144).  Saving model ...
Epoch: 4 cost time: 1.0945518016815186
Epoch: 4, Steps: 10 | Train Loss: 2.665 Vali Loss: 3.239 Vali Acc: 0.101 Test Loss: 3.239 Test Acc: 0.101
Validation loss decreased (-0.081144 --> -0.101144).  Saving model ...
Epoch: 5 cost time: 0.9693922996520996
Epoch: 5, Steps: 10 | Train Loss: 2.379 Vali Loss: 3.207 Vali Acc: 0.136 Test Loss: 3.207 Test Acc: 0.136
Validation loss decreased (-0.101144 --> -0.136439).  Saving model ...
Epoch: 6 cost time: 0.9547309875488281
Epoch: 6, Steps: 10 | Train Loss: 1.989 Vali Loss: 3.179 Vali Acc: 0.156 Test Loss: 3.179 Test Acc: 0.156
Validation loss decreased (-0.136439 --> -0.156439).  Saving model ...
Epoch: 7 cost time: 0.9152717590332031
Epoch: 7, Steps: 10 | Train Loss: 1.605 Vali Loss: 3.179 Vali Acc: 0.181 Test Loss: 3.179 Test Acc: 0.181
Validation loss decreased (-0.156439 --> -0.181145).  Saving model ...
Epoch: 8 cost time: 0.8458518981933594
Epoch: 8, Steps: 10 | Train Loss: 1.176 Vali Loss: 3.209 Vali Acc: 0.202 Test Loss: 3.209 Test Acc: 0.202
Validation loss decreased (-0.181145 --> -0.202321).  Saving model ...
Epoch: 9 cost time: 0.9521617889404297
Epoch: 9, Steps: 10 | Train Loss: 0.816 Vali Loss: 3.300 Vali Acc: 0.219 Test Loss: 3.300 Test Acc: 0.219
Validation loss decreased (-0.202321 --> -0.218791).  Saving model ...
Epoch: 10 cost time: 0.9531598091125488
Epoch: 10, Steps: 10 | Train Loss: 0.523 Vali Loss: 3.429 Vali Acc: 0.236 Test Loss: 3.429 Test Acc: 0.236
Validation loss decreased (-0.218791 --> -0.236436).  Saving model ...
Epoch: 11 cost time: 0.9773814678192139
Epoch: 11, Steps: 10 | Train Loss: 0.340 Vali Loss: 3.616 Vali Acc: 0.260 Test Loss: 3.616 Test Acc: 0.260
Validation loss decreased (-0.236436 --> -0.259964).  Saving model ...
Epoch: 12 cost time: 1.0598437786102295
Epoch: 12, Steps: 10 | Train Loss: 0.181 Vali Loss: 3.783 Vali Acc: 0.261 Test Loss: 3.783 Test Acc: 0.261
Validation loss decreased (-0.259964 --> -0.261139).  Saving model ...
Epoch: 13 cost time: 1.0059423446655273
Epoch: 13, Steps: 10 | Train Loss: 0.106 Vali Loss: 3.970 Vali Acc: 0.256 Test Loss: 3.970 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8545665740966797
Epoch: 14, Steps: 10 | Train Loss: 0.055 Vali Loss: 4.089 Vali Acc: 0.261 Test Loss: 4.089 Test Acc: 0.261
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0116560459136963
Epoch: 15, Steps: 10 | Train Loss: 0.038 Vali Loss: 4.270 Vali Acc: 0.254 Test Loss: 4.270 Test Acc: 0.254
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9904658794403076
Epoch: 16, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.344 Vali Acc: 0.261 Test Loss: 4.344 Test Acc: 0.261
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.9598374366760254
Epoch: 17, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.375 Vali Acc: 0.266 Test Loss: 4.375 Test Acc: 0.266
Validation loss decreased (-0.261139 --> -0.265839).  Saving model ...
Epoch: 18 cost time: 0.9120621681213379
Epoch: 18, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.418 Vali Acc: 0.266 Test Loss: 4.418 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0899016857147217
Epoch: 19, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.467 Vali Acc: 0.271 Test Loss: 4.467 Test Acc: 0.271
Validation loss decreased (-0.265839 --> -0.270544).  Saving model ...
Epoch: 20 cost time: 1.0464162826538086
Epoch: 20, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.520 Vali Acc: 0.266 Test Loss: 4.520 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9449498653411865
Epoch: 21, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.573 Vali Acc: 0.268 Test Loss: 4.573 Test Acc: 0.268
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.9066200256347656
Epoch: 22, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.619 Vali Acc: 0.262 Test Loss: 4.619 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.8875479698181152
Epoch: 23, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.668 Vali Acc: 0.267 Test Loss: 4.668 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.828657865524292
Epoch: 24, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.697 Vali Acc: 0.271 Test Loss: 4.697 Test Acc: 0.271
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.8725786209106445
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.730 Vali Acc: 0.272 Test Loss: 4.730 Test Acc: 0.272
Validation loss decreased (-0.270544 --> -0.271717).  Saving model ...
Epoch: 26 cost time: 0.9053955078125
Epoch: 26, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.764 Vali Acc: 0.272 Test Loss: 4.764 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9357352256774902
Epoch: 27, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.802 Vali Acc: 0.272 Test Loss: 4.802 Test Acc: 0.272
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.8264732360839844
Epoch: 28, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.839 Vali Acc: 0.269 Test Loss: 4.839 Test Acc: 0.269
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.031632900238037
Epoch: 29, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.873 Vali Acc: 0.274 Test Loss: 4.873 Test Acc: 0.274
Validation loss decreased (-0.271717 --> -0.274069).  Saving model ...
Epoch: 30 cost time: 1.0815744400024414
Epoch: 30, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.898 Vali Acc: 0.269 Test Loss: 4.898 Test Acc: 0.269
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.0360145568847656
Epoch: 31, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.927 Vali Acc: 0.272 Test Loss: 4.927 Test Acc: 0.272
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.9834613800048828
Epoch: 32, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.953 Vali Acc: 0.274 Test Loss: 4.953 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.0323734283447266
Epoch: 33, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.977 Vali Acc: 0.269 Test Loss: 4.977 Test Acc: 0.269
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.214991807937622
Epoch: 34, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.005 Vali Acc: 0.271 Test Loss: 5.005 Test Acc: 0.271
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.1348564624786377
Epoch: 35, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.024 Vali Acc: 0.271 Test Loss: 5.024 Test Acc: 0.271
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.174811601638794
Epoch: 36, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.044 Vali Acc: 0.273 Test Loss: 5.044 Test Acc: 0.273
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.0271172523498535
Epoch: 37, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.070 Vali Acc: 0.273 Test Loss: 5.070 Test Acc: 0.273
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.9931621551513672
Epoch: 38, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.084 Vali Acc: 0.273 Test Loss: 5.084 Test Acc: 0.273
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.035951852798462
Epoch: 39, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.104 Vali Acc: 0.274 Test Loss: 5.104 Test Acc: 0.274
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2741176470588235
model parameter : 473946
model size : 1.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps12_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.3395869731903076
Epoch: 1, Steps: 10 | Train Loss: 3.284 Vali Loss: 3.271 Vali Acc: 0.028 Test Loss: 3.271 Test Acc: 0.028
Validation loss decreased (inf --> -0.028203).  Saving model ...
Epoch: 2 cost time: 0.9351081848144531
Epoch: 2, Steps: 10 | Train Loss: 3.184 Vali Loss: 3.259 Vali Acc: 0.048 Test Loss: 3.259 Test Acc: 0.048
Validation loss decreased (-0.028203 --> -0.048203).  Saving model ...
Epoch: 3 cost time: 0.9034130573272705
Epoch: 3, Steps: 10 | Train Loss: 3.016 Vali Loss: 3.253 Vali Acc: 0.060 Test Loss: 3.253 Test Acc: 0.060
Validation loss decreased (-0.048203 --> -0.059967).  Saving model ...
Epoch: 4 cost time: 0.9658768177032471
Epoch: 4, Steps: 10 | Train Loss: 2.831 Vali Loss: 3.251 Vali Acc: 0.076 Test Loss: 3.251 Test Acc: 0.076
Validation loss decreased (-0.059967 --> -0.076438).  Saving model ...
Epoch: 5 cost time: 0.9955968856811523
Epoch: 5, Steps: 10 | Train Loss: 2.635 Vali Loss: 3.238 Vali Acc: 0.102 Test Loss: 3.238 Test Acc: 0.102
Validation loss decreased (-0.076438 --> -0.102321).  Saving model ...
Epoch: 6 cost time: 0.9544470310211182
Epoch: 6, Steps: 10 | Train Loss: 2.365 Vali Loss: 3.209 Vali Acc: 0.124 Test Loss: 3.209 Test Acc: 0.124
Validation loss decreased (-0.102321 --> -0.123497).  Saving model ...
Epoch: 7 cost time: 0.9556443691253662
Epoch: 7, Steps: 10 | Train Loss: 2.063 Vali Loss: 3.185 Vali Acc: 0.151 Test Loss: 3.185 Test Acc: 0.151
Validation loss decreased (-0.123497 --> -0.150556).  Saving model ...
Epoch: 8 cost time: 0.9265351295471191
Epoch: 8, Steps: 10 | Train Loss: 1.754 Vali Loss: 3.182 Vali Acc: 0.167 Test Loss: 3.182 Test Acc: 0.167
Validation loss decreased (-0.150556 --> -0.167027).  Saving model ...
Epoch: 9 cost time: 1.0606215000152588
Epoch: 9, Steps: 10 | Train Loss: 1.438 Vali Loss: 3.194 Vali Acc: 0.182 Test Loss: 3.194 Test Acc: 0.182
Validation loss decreased (-0.167027 --> -0.182321).  Saving model ...
Epoch: 10 cost time: 0.984137773513794
Epoch: 10, Steps: 10 | Train Loss: 1.088 Vali Loss: 3.217 Vali Acc: 0.213 Test Loss: 3.217 Test Acc: 0.213
Validation loss decreased (-0.182321 --> -0.212909).  Saving model ...
Epoch: 11 cost time: 1.0097060203552246
Epoch: 11, Steps: 10 | Train Loss: 0.795 Vali Loss: 3.300 Vali Acc: 0.224 Test Loss: 3.300 Test Acc: 0.224
Validation loss decreased (-0.212909 --> -0.223496).  Saving model ...
Epoch: 12 cost time: 0.9141106605529785
Epoch: 12, Steps: 10 | Train Loss: 0.576 Vali Loss: 3.428 Vali Acc: 0.234 Test Loss: 3.428 Test Acc: 0.234
Validation loss decreased (-0.223496 --> -0.234083).  Saving model ...
Epoch: 13 cost time: 0.978426456451416
Epoch: 13, Steps: 10 | Train Loss: 0.368 Vali Loss: 3.530 Vali Acc: 0.240 Test Loss: 3.530 Test Acc: 0.240
Validation loss decreased (-0.234083 --> -0.239965).  Saving model ...
Epoch: 14 cost time: 1.1004319190979004
Epoch: 14, Steps: 10 | Train Loss: 0.245 Vali Loss: 3.689 Vali Acc: 0.238 Test Loss: 3.689 Test Acc: 0.238
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.043229579925537
Epoch: 15, Steps: 10 | Train Loss: 0.156 Vali Loss: 3.811 Vali Acc: 0.241 Test Loss: 3.811 Test Acc: 0.241
Validation loss decreased (-0.239965 --> -0.241138).  Saving model ...
Epoch: 16 cost time: 0.9502465724945068
Epoch: 16, Steps: 10 | Train Loss: 0.100 Vali Loss: 3.939 Vali Acc: 0.247 Test Loss: 3.939 Test Acc: 0.247
Validation loss decreased (-0.241138 --> -0.247019).  Saving model ...
Epoch: 17 cost time: 0.9602382183074951
Epoch: 17, Steps: 10 | Train Loss: 0.069 Vali Loss: 4.035 Vali Acc: 0.253 Test Loss: 4.035 Test Acc: 0.253
Validation loss decreased (-0.247019 --> -0.252901).  Saving model ...
Epoch: 18 cost time: 0.9128322601318359
Epoch: 18, Steps: 10 | Train Loss: 0.048 Vali Loss: 4.101 Vali Acc: 0.255 Test Loss: 4.101 Test Acc: 0.255
Validation loss decreased (-0.252901 --> -0.255253).  Saving model ...
Epoch: 19 cost time: 1.0158064365386963
Epoch: 19, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.175 Vali Acc: 0.253 Test Loss: 4.175 Test Acc: 0.253
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1094508171081543
Epoch: 20, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.222 Vali Acc: 0.258 Test Loss: 4.222 Test Acc: 0.258
Validation loss decreased (-0.255253 --> -0.257605).  Saving model ...
Epoch: 21 cost time: 1.0521430969238281
Epoch: 21, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.295 Vali Acc: 0.258 Test Loss: 4.295 Test Acc: 0.258
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0571465492248535
Epoch: 22, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.344 Vali Acc: 0.254 Test Loss: 4.344 Test Acc: 0.254
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.9858856201171875
Epoch: 23, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.393 Vali Acc: 0.252 Test Loss: 4.393 Test Acc: 0.252
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.9809749126434326
Epoch: 24, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.429 Vali Acc: 0.252 Test Loss: 4.429 Test Acc: 0.252
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.0895490646362305
Epoch: 25, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.474 Vali Acc: 0.253 Test Loss: 4.474 Test Acc: 0.253
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.9481198787689209
Epoch: 26, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.538 Vali Acc: 0.247 Test Loss: 4.538 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.0657832622528076
Epoch: 27, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.563 Vali Acc: 0.249 Test Loss: 4.563 Test Acc: 0.249
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.9521498680114746
Epoch: 28, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.585 Vali Acc: 0.252 Test Loss: 4.585 Test Acc: 0.252
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.019016981124878
Epoch: 29, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.611 Vali Acc: 0.254 Test Loss: 4.611 Test Acc: 0.254
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.9673616886138916
Epoch: 30, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.654 Vali Acc: 0.252 Test Loss: 4.654 Test Acc: 0.252
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps12_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2576470588235294
model parameter : 414298
model size : 1.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.3636767864227295
Epoch: 1, Steps: 10 | Train Loss: 3.270 Vali Loss: 3.256 Vali Acc: 0.044 Test Loss: 3.256 Test Acc: 0.044
Validation loss decreased (inf --> -0.043497).  Saving model ...
Epoch: 2 cost time: 0.8484597206115723
Epoch: 2, Steps: 10 | Train Loss: 3.198 Vali Loss: 3.246 Vali Acc: 0.048 Test Loss: 3.246 Test Acc: 0.048
Validation loss decreased (-0.043497 --> -0.048203).  Saving model ...
Epoch: 3 cost time: 0.856564998626709
Epoch: 3, Steps: 10 | Train Loss: 3.058 Vali Loss: 3.235 Vali Acc: 0.066 Test Loss: 3.235 Test Acc: 0.066
Validation loss decreased (-0.048203 --> -0.065850).  Saving model ...
Epoch: 4 cost time: 0.948908805847168
Epoch: 4, Steps: 10 | Train Loss: 2.905 Vali Loss: 3.232 Vali Acc: 0.079 Test Loss: 3.232 Test Acc: 0.079
Validation loss decreased (-0.065850 --> -0.078791).  Saving model ...
Epoch: 5 cost time: 0.8286178112030029
Epoch: 5, Steps: 10 | Train Loss: 2.747 Vali Loss: 3.224 Vali Acc: 0.101 Test Loss: 3.224 Test Acc: 0.101
Validation loss decreased (-0.078791 --> -0.101144).  Saving model ...
Epoch: 6 cost time: 0.872417688369751
Epoch: 6, Steps: 10 | Train Loss: 2.523 Vali Loss: 3.210 Vali Acc: 0.122 Test Loss: 3.210 Test Acc: 0.122
Validation loss decreased (-0.101144 --> -0.122321).  Saving model ...
Epoch: 7 cost time: 0.9320509433746338
Epoch: 7, Steps: 10 | Train Loss: 2.324 Vali Loss: 3.199 Vali Acc: 0.134 Test Loss: 3.199 Test Acc: 0.134
Validation loss decreased (-0.122321 --> -0.134086).  Saving model ...
Epoch: 8 cost time: 0.8227705955505371
Epoch: 8, Steps: 10 | Train Loss: 2.041 Vali Loss: 3.180 Vali Acc: 0.148 Test Loss: 3.180 Test Acc: 0.148
Validation loss decreased (-0.134086 --> -0.148203).  Saving model ...
Epoch: 9 cost time: 0.9188997745513916
Epoch: 9, Steps: 10 | Train Loss: 1.778 Vali Loss: 3.174 Vali Acc: 0.162 Test Loss: 3.174 Test Acc: 0.162
Validation loss decreased (-0.148203 --> -0.162321).  Saving model ...
Epoch: 10 cost time: 0.8719971179962158
Epoch: 10, Steps: 10 | Train Loss: 1.480 Vali Loss: 3.172 Vali Acc: 0.188 Test Loss: 3.172 Test Acc: 0.188
Validation loss decreased (-0.162321 --> -0.188204).  Saving model ...
Epoch: 11 cost time: 0.9767465591430664
Epoch: 11, Steps: 10 | Train Loss: 1.197 Vali Loss: 3.198 Vali Acc: 0.207 Test Loss: 3.198 Test Acc: 0.207
Validation loss decreased (-0.188204 --> -0.207027).  Saving model ...
Epoch: 12 cost time: 0.9845194816589355
Epoch: 12, Steps: 10 | Train Loss: 0.928 Vali Loss: 3.263 Vali Acc: 0.215 Test Loss: 3.263 Test Acc: 0.215
Validation loss decreased (-0.207027 --> -0.215261).  Saving model ...
Epoch: 13 cost time: 0.9815118312835693
Epoch: 13, Steps: 10 | Train Loss: 0.675 Vali Loss: 3.312 Vali Acc: 0.235 Test Loss: 3.312 Test Acc: 0.235
Validation loss decreased (-0.215261 --> -0.235261).  Saving model ...
Epoch: 14 cost time: 0.934807300567627
Epoch: 14, Steps: 10 | Train Loss: 0.539 Vali Loss: 3.391 Vali Acc: 0.249 Test Loss: 3.391 Test Acc: 0.249
Validation loss decreased (-0.235261 --> -0.249378).  Saving model ...
Epoch: 15 cost time: 0.9795176982879639
Epoch: 15, Steps: 10 | Train Loss: 0.346 Vali Loss: 3.504 Vali Acc: 0.255 Test Loss: 3.504 Test Acc: 0.255
Validation loss decreased (-0.249378 --> -0.255259).  Saving model ...
Epoch: 16 cost time: 0.9169447422027588
Epoch: 16, Steps: 10 | Train Loss: 0.243 Vali Loss: 3.601 Vali Acc: 0.255 Test Loss: 3.601 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8955843448638916
Epoch: 17, Steps: 10 | Train Loss: 0.160 Vali Loss: 3.714 Vali Acc: 0.256 Test Loss: 3.714 Test Acc: 0.256
Validation loss decreased (-0.255259 --> -0.256433).  Saving model ...
Epoch: 18 cost time: 0.9142012596130371
Epoch: 18, Steps: 10 | Train Loss: 0.119 Vali Loss: 3.829 Vali Acc: 0.258 Test Loss: 3.829 Test Acc: 0.258
Validation loss decreased (-0.256433 --> -0.257609).  Saving model ...
Epoch: 19 cost time: 0.8612306118011475
Epoch: 19, Steps: 10 | Train Loss: 0.089 Vali Loss: 3.907 Vali Acc: 0.261 Test Loss: 3.907 Test Acc: 0.261
Validation loss decreased (-0.257609 --> -0.261137).  Saving model ...
Epoch: 20 cost time: 0.8719370365142822
Epoch: 20, Steps: 10 | Train Loss: 0.066 Vali Loss: 3.992 Vali Acc: 0.259 Test Loss: 3.992 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8600835800170898
Epoch: 21, Steps: 10 | Train Loss: 0.052 Vali Loss: 4.038 Vali Acc: 0.271 Test Loss: 4.038 Test Acc: 0.271
Validation loss decreased (-0.261137 --> -0.270548).  Saving model ...
Epoch: 22 cost time: 1.0360543727874756
Epoch: 22, Steps: 10 | Train Loss: 0.041 Vali Loss: 4.090 Vali Acc: 0.268 Test Loss: 4.090 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0253958702087402
Epoch: 23, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.159 Vali Acc: 0.269 Test Loss: 4.159 Test Acc: 0.269
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.8785951137542725
Epoch: 24, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.212 Vali Acc: 0.265 Test Loss: 4.212 Test Acc: 0.265
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.8853111267089844
Epoch: 25, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.245 Vali Acc: 0.261 Test Loss: 4.245 Test Acc: 0.261
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.9491527080535889
Epoch: 26, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.288 Vali Acc: 0.262 Test Loss: 4.288 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.9459896087646484
Epoch: 27, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.320 Vali Acc: 0.262 Test Loss: 4.320 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.9771902561187744
Epoch: 28, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.356 Vali Acc: 0.269 Test Loss: 4.356 Test Acc: 0.269
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.9449119567871094
Epoch: 29, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.377 Vali Acc: 0.276 Test Loss: 4.377 Test Acc: 0.276
Validation loss decreased (-0.270548 --> -0.276427).  Saving model ...
Epoch: 30 cost time: 0.8641564846038818
Epoch: 30, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.424 Vali Acc: 0.275 Test Loss: 4.424 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8886737823486328
Epoch: 31, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.450 Vali Acc: 0.275 Test Loss: 4.450 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.8797316551208496
Epoch: 32, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.482 Vali Acc: 0.275 Test Loss: 4.482 Test Acc: 0.275
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.9896903038024902
Epoch: 33, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.521 Vali Acc: 0.274 Test Loss: 4.521 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.9485580921173096
Epoch: 34, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.561 Vali Acc: 0.272 Test Loss: 4.561 Test Acc: 0.272
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.8761904239654541
Epoch: 35, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.582 Vali Acc: 0.271 Test Loss: 4.582 Test Acc: 0.271
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.8566465377807617
Epoch: 36, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.604 Vali Acc: 0.276 Test Loss: 4.604 Test Acc: 0.276
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.937586784362793
Epoch: 37, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.631 Vali Acc: 0.269 Test Loss: 4.631 Test Acc: 0.269
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.8960731029510498
Epoch: 38, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.649 Vali Acc: 0.271 Test Loss: 4.649 Test Acc: 0.271
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.9797711372375488
Epoch: 39, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.675 Vali Acc: 0.274 Test Loss: 4.675 Test Acc: 0.274
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27647058823529413
model parameter : 384602
model size : 1.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps23_str12_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.576317310333252
Epoch: 1, Steps: 10 | Train Loss: 3.320 Vali Loss: 3.272 Vali Acc: 0.045 Test Loss: 3.272 Test Acc: 0.045
Validation loss decreased (inf --> -0.044673).  Saving model ...
Epoch: 2 cost time: 0.8681771755218506
Epoch: 2, Steps: 10 | Train Loss: 3.270 Vali Loss: 3.266 Vali Acc: 0.048 Test Loss: 3.266 Test Acc: 0.048
Validation loss decreased (-0.044673 --> -0.048203).  Saving model ...
Epoch: 3 cost time: 0.8994779586791992
Epoch: 3, Steps: 10 | Train Loss: 3.167 Vali Loss: 3.255 Vali Acc: 0.061 Test Loss: 3.255 Test Acc: 0.061
Validation loss decreased (-0.048203 --> -0.061144).  Saving model ...
Epoch: 4 cost time: 0.914421796798706
Epoch: 4, Steps: 10 | Train Loss: 3.061 Vali Loss: 3.246 Vali Acc: 0.073 Test Loss: 3.246 Test Acc: 0.073
Validation loss decreased (-0.061144 --> -0.072909).  Saving model ...
Epoch: 5 cost time: 0.843320369720459
Epoch: 5, Steps: 10 | Train Loss: 2.911 Vali Loss: 3.237 Vali Acc: 0.092 Test Loss: 3.237 Test Acc: 0.092
Validation loss decreased (-0.072909 --> -0.091732).  Saving model ...
Epoch: 6 cost time: 0.8249130249023438
Epoch: 6, Steps: 10 | Train Loss: 2.766 Vali Loss: 3.230 Vali Acc: 0.096 Test Loss: 3.230 Test Acc: 0.096
Validation loss decreased (-0.091732 --> -0.096438).  Saving model ...
Epoch: 7 cost time: 0.8779144287109375
Epoch: 7, Steps: 10 | Train Loss: 2.613 Vali Loss: 3.223 Vali Acc: 0.109 Test Loss: 3.223 Test Acc: 0.109
Validation loss decreased (-0.096438 --> -0.109380).  Saving model ...
Epoch: 8 cost time: 0.9255232810974121
Epoch: 8, Steps: 10 | Train Loss: 2.469 Vali Loss: 3.213 Vali Acc: 0.106 Test Loss: 3.213 Test Acc: 0.106
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8616766929626465
Epoch: 9, Steps: 10 | Train Loss: 2.257 Vali Loss: 3.196 Vali Acc: 0.134 Test Loss: 3.196 Test Acc: 0.134
Validation loss decreased (-0.109380 --> -0.134086).  Saving model ...
Epoch: 10 cost time: 0.8517940044403076
Epoch: 10, Steps: 10 | Train Loss: 2.040 Vali Loss: 3.185 Vali Acc: 0.149 Test Loss: 3.185 Test Acc: 0.149
Validation loss decreased (-0.134086 --> -0.149380).  Saving model ...
Epoch: 11 cost time: 0.9016811847686768
Epoch: 11, Steps: 10 | Train Loss: 1.819 Vali Loss: 3.177 Vali Acc: 0.164 Test Loss: 3.177 Test Acc: 0.164
Validation loss decreased (-0.149380 --> -0.163498).  Saving model ...
Epoch: 12 cost time: 0.9439136981964111
Epoch: 12, Steps: 10 | Train Loss: 1.608 Vali Loss: 3.173 Vali Acc: 0.176 Test Loss: 3.173 Test Acc: 0.176
Validation loss decreased (-0.163498 --> -0.176439).  Saving model ...
Epoch: 13 cost time: 0.8670332431793213
Epoch: 13, Steps: 10 | Train Loss: 1.398 Vali Loss: 3.182 Vali Acc: 0.196 Test Loss: 3.182 Test Acc: 0.196
Validation loss decreased (-0.176439 --> -0.196439).  Saving model ...
Epoch: 14 cost time: 0.9490816593170166
Epoch: 14, Steps: 10 | Train Loss: 1.181 Vali Loss: 3.203 Vali Acc: 0.205 Test Loss: 3.203 Test Acc: 0.205
Validation loss decreased (-0.196439 --> -0.204674).  Saving model ...
Epoch: 15 cost time: 0.993377685546875
Epoch: 15, Steps: 10 | Train Loss: 0.939 Vali Loss: 3.240 Vali Acc: 0.225 Test Loss: 3.240 Test Acc: 0.225
Validation loss decreased (-0.204674 --> -0.224673).  Saving model ...
Epoch: 16 cost time: 0.9401814937591553
Epoch: 16, Steps: 10 | Train Loss: 0.757 Vali Loss: 3.283 Vali Acc: 0.229 Test Loss: 3.283 Test Acc: 0.229
Validation loss decreased (-0.224673 --> -0.229379).  Saving model ...
Epoch: 17 cost time: 0.9930377006530762
Epoch: 17, Steps: 10 | Train Loss: 0.588 Vali Loss: 3.340 Vali Acc: 0.242 Test Loss: 3.340 Test Acc: 0.242
Validation loss decreased (-0.229379 --> -0.242320).  Saving model ...
Epoch: 18 cost time: 0.9267551898956299
Epoch: 18, Steps: 10 | Train Loss: 0.475 Vali Loss: 3.414 Vali Acc: 0.244 Test Loss: 3.414 Test Acc: 0.244
Validation loss decreased (-0.242320 --> -0.243495).  Saving model ...
Epoch: 19 cost time: 0.9748280048370361
Epoch: 19, Steps: 10 | Train Loss: 0.342 Vali Loss: 3.486 Vali Acc: 0.247 Test Loss: 3.486 Test Acc: 0.247
Validation loss decreased (-0.243495 --> -0.247024).  Saving model ...
Epoch: 20 cost time: 0.9266500473022461
Epoch: 20, Steps: 10 | Train Loss: 0.254 Vali Loss: 3.555 Vali Acc: 0.260 Test Loss: 3.555 Test Acc: 0.260
Validation loss decreased (-0.247024 --> -0.259964).  Saving model ...
Epoch: 21 cost time: 0.9555902481079102
Epoch: 21, Steps: 10 | Train Loss: 0.193 Vali Loss: 3.618 Vali Acc: 0.267 Test Loss: 3.618 Test Acc: 0.267
Validation loss decreased (-0.259964 --> -0.267023).  Saving model ...
Epoch: 22 cost time: 1.0127906799316406
Epoch: 22, Steps: 10 | Train Loss: 0.155 Vali Loss: 3.679 Vali Acc: 0.268 Test Loss: 3.679 Test Acc: 0.268
Validation loss decreased (-0.267023 --> -0.268199).  Saving model ...
Epoch: 23 cost time: 0.9356861114501953
Epoch: 23, Steps: 10 | Train Loss: 0.116 Vali Loss: 3.735 Vali Acc: 0.268 Test Loss: 3.735 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0173487663269043
Epoch: 24, Steps: 10 | Train Loss: 0.097 Vali Loss: 3.792 Vali Acc: 0.271 Test Loss: 3.792 Test Acc: 0.271
Validation loss decreased (-0.268199 --> -0.270550).  Saving model ...
Epoch: 25 cost time: 0.999755859375
Epoch: 25, Steps: 10 | Train Loss: 0.077 Vali Loss: 3.845 Vali Acc: 0.271 Test Loss: 3.845 Test Acc: 0.271
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9406168460845947
Epoch: 26, Steps: 10 | Train Loss: 0.065 Vali Loss: 3.892 Vali Acc: 0.274 Test Loss: 3.892 Test Acc: 0.274
Validation loss decreased (-0.270550 --> -0.274079).  Saving model ...
Epoch: 27 cost time: 1.0151276588439941
Epoch: 27, Steps: 10 | Train Loss: 0.056 Vali Loss: 3.938 Vali Acc: 0.279 Test Loss: 3.938 Test Acc: 0.279
Validation loss decreased (-0.274079 --> -0.278784).  Saving model ...
Epoch: 28 cost time: 1.0016248226165771
Epoch: 28, Steps: 10 | Train Loss: 0.043 Vali Loss: 3.978 Vali Acc: 0.273 Test Loss: 3.978 Test Acc: 0.273
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9135146141052246
Epoch: 29, Steps: 10 | Train Loss: 0.041 Vali Loss: 4.008 Vali Acc: 0.274 Test Loss: 4.008 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.9160490036010742
Epoch: 30, Steps: 10 | Train Loss: 0.038 Vali Loss: 4.038 Vali Acc: 0.278 Test Loss: 4.038 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.9693267345428467
Epoch: 31, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.060 Vali Acc: 0.275 Test Loss: 4.060 Test Acc: 0.275
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.9718317985534668
Epoch: 32, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.093 Vali Acc: 0.275 Test Loss: 4.093 Test Acc: 0.275
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.8874428272247314
Epoch: 33, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.133 Vali Acc: 0.274 Test Loss: 4.133 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.9503219127655029
Epoch: 34, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.163 Vali Acc: 0.272 Test Loss: 4.163 Test Acc: 0.272
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.8685119152069092
Epoch: 35, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.195 Vali Acc: 0.272 Test Loss: 4.195 Test Acc: 0.272
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.9159708023071289
Epoch: 36, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.218 Vali Acc: 0.276 Test Loss: 4.218 Test Acc: 0.276
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.9685297012329102
Epoch: 37, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.242 Vali Acc: 0.276 Test Loss: 4.242 Test Acc: 0.276
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps23_str12_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2788235294117647
model parameter : 345114
model size : 1.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.4507248401641846
Epoch: 1, Steps: 10 | Train Loss: 3.313 Vali Loss: 3.271 Vali Acc: 0.038 Test Loss: 3.271 Test Acc: 0.038
Validation loss decreased (inf --> -0.037614).  Saving model ...
Epoch: 2 cost time: 0.8310408592224121
Epoch: 2, Steps: 10 | Train Loss: 3.273 Vali Loss: 3.267 Vali Acc: 0.048 Test Loss: 3.267 Test Acc: 0.048
Validation loss decreased (-0.037614 --> -0.048203).  Saving model ...
Epoch: 3 cost time: 0.908414363861084
Epoch: 3, Steps: 10 | Train Loss: 3.183 Vali Loss: 3.260 Vali Acc: 0.055 Test Loss: 3.260 Test Acc: 0.055
Validation loss decreased (-0.048203 --> -0.055262).  Saving model ...
Epoch: 4 cost time: 0.9834747314453125
Epoch: 4, Steps: 10 | Train Loss: 3.088 Vali Loss: 3.252 Vali Acc: 0.056 Test Loss: 3.252 Test Acc: 0.056
Validation loss decreased (-0.055262 --> -0.056438).  Saving model ...
Epoch: 5 cost time: 0.9148027896881104
Epoch: 5, Steps: 10 | Train Loss: 2.980 Vali Loss: 3.246 Vali Acc: 0.069 Test Loss: 3.246 Test Acc: 0.069
Validation loss decreased (-0.056438 --> -0.069379).  Saving model ...
Epoch: 6 cost time: 0.7913198471069336
Epoch: 6, Steps: 10 | Train Loss: 2.833 Vali Loss: 3.238 Vali Acc: 0.086 Test Loss: 3.238 Test Acc: 0.086
Validation loss decreased (-0.069379 --> -0.085850).  Saving model ...
Epoch: 7 cost time: 0.9560213088989258
Epoch: 7, Steps: 10 | Train Loss: 2.711 Vali Loss: 3.234 Vali Acc: 0.100 Test Loss: 3.234 Test Acc: 0.100
Validation loss decreased (-0.085850 --> -0.099968).  Saving model ...
Epoch: 8 cost time: 0.9392843246459961
Epoch: 8, Steps: 10 | Train Loss: 2.555 Vali Loss: 3.225 Vali Acc: 0.118 Test Loss: 3.225 Test Acc: 0.118
Validation loss decreased (-0.099968 --> -0.117615).  Saving model ...
Epoch: 9 cost time: 1.0807414054870605
Epoch: 9, Steps: 10 | Train Loss: 2.427 Vali Loss: 3.211 Vali Acc: 0.134 Test Loss: 3.211 Test Acc: 0.134
Validation loss decreased (-0.117615 --> -0.134086).  Saving model ...
Epoch: 10 cost time: 0.9636178016662598
Epoch: 10, Steps: 10 | Train Loss: 2.237 Vali Loss: 3.202 Vali Acc: 0.158 Test Loss: 3.202 Test Acc: 0.158
Validation loss decreased (-0.134086 --> -0.157615).  Saving model ...
Epoch: 11 cost time: 0.9091129302978516
Epoch: 11, Steps: 10 | Train Loss: 2.062 Vali Loss: 3.192 Vali Acc: 0.168 Test Loss: 3.192 Test Acc: 0.168
Validation loss decreased (-0.157615 --> -0.168203).  Saving model ...
Epoch: 12 cost time: 0.9080948829650879
Epoch: 12, Steps: 10 | Train Loss: 1.870 Vali Loss: 3.187 Vali Acc: 0.176 Test Loss: 3.187 Test Acc: 0.176
Validation loss decreased (-0.168203 --> -0.176439).  Saving model ...
Epoch: 13 cost time: 0.8387362957000732
Epoch: 13, Steps: 10 | Train Loss: 1.682 Vali Loss: 3.177 Vali Acc: 0.192 Test Loss: 3.177 Test Acc: 0.192
Validation loss decreased (-0.176439 --> -0.191733).  Saving model ...
Epoch: 14 cost time: 0.9140024185180664
Epoch: 14, Steps: 10 | Train Loss: 1.485 Vali Loss: 3.184 Vali Acc: 0.206 Test Loss: 3.184 Test Acc: 0.206
Validation loss decreased (-0.191733 --> -0.205851).  Saving model ...
Epoch: 15 cost time: 0.8674197196960449
Epoch: 15, Steps: 10 | Train Loss: 1.293 Vali Loss: 3.198 Vali Acc: 0.213 Test Loss: 3.198 Test Acc: 0.213
Validation loss decreased (-0.205851 --> -0.212909).  Saving model ...
Epoch: 16 cost time: 0.8804483413696289
Epoch: 16, Steps: 10 | Train Loss: 1.076 Vali Loss: 3.217 Vali Acc: 0.218 Test Loss: 3.217 Test Acc: 0.218
Validation loss decreased (-0.212909 --> -0.217615).  Saving model ...
Epoch: 17 cost time: 0.937863826751709
Epoch: 17, Steps: 10 | Train Loss: 0.921 Vali Loss: 3.250 Vali Acc: 0.229 Test Loss: 3.250 Test Acc: 0.229
Validation loss decreased (-0.217615 --> -0.229379).  Saving model ...
Epoch: 18 cost time: 0.9615154266357422
Epoch: 18, Steps: 10 | Train Loss: 0.731 Vali Loss: 3.287 Vali Acc: 0.232 Test Loss: 3.287 Test Acc: 0.232
Validation loss decreased (-0.229379 --> -0.231732).  Saving model ...
Epoch: 19 cost time: 0.9602015018463135
Epoch: 19, Steps: 10 | Train Loss: 0.599 Vali Loss: 3.336 Vali Acc: 0.240 Test Loss: 3.336 Test Acc: 0.240
Validation loss decreased (-0.231732 --> -0.239967).  Saving model ...
Epoch: 20 cost time: 0.9531388282775879
Epoch: 20, Steps: 10 | Train Loss: 0.467 Vali Loss: 3.386 Vali Acc: 0.244 Test Loss: 3.386 Test Acc: 0.244
Validation loss decreased (-0.239967 --> -0.243496).  Saving model ...
Epoch: 21 cost time: 0.953131914138794
Epoch: 21, Steps: 10 | Train Loss: 0.359 Vali Loss: 3.447 Vali Acc: 0.251 Test Loss: 3.447 Test Acc: 0.251
Validation loss decreased (-0.243496 --> -0.250554).  Saving model ...
Epoch: 22 cost time: 0.9241352081298828
Epoch: 22, Steps: 10 | Train Loss: 0.295 Vali Loss: 3.521 Vali Acc: 0.248 Test Loss: 3.521 Test Acc: 0.248
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8616127967834473
Epoch: 23, Steps: 10 | Train Loss: 0.220 Vali Loss: 3.583 Vali Acc: 0.259 Test Loss: 3.583 Test Acc: 0.259
Validation loss decreased (-0.250554 --> -0.258788).  Saving model ...
Epoch: 24 cost time: 0.9003033638000488
Epoch: 24, Steps: 10 | Train Loss: 0.161 Vali Loss: 3.640 Vali Acc: 0.258 Test Loss: 3.640 Test Acc: 0.258
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8219583034515381
Epoch: 25, Steps: 10 | Train Loss: 0.133 Vali Loss: 3.680 Vali Acc: 0.259 Test Loss: 3.680 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.9071822166442871
Epoch: 26, Steps: 10 | Train Loss: 0.114 Vali Loss: 3.731 Vali Acc: 0.260 Test Loss: 3.731 Test Acc: 0.260
Validation loss decreased (-0.258788 --> -0.259963).  Saving model ...
Epoch: 27 cost time: 0.9978821277618408
Epoch: 27, Steps: 10 | Train Loss: 0.091 Vali Loss: 3.756 Vali Acc: 0.261 Test Loss: 3.756 Test Acc: 0.261
Validation loss decreased (-0.259963 --> -0.261139).  Saving model ...
Epoch: 28 cost time: 0.8738231658935547
Epoch: 28, Steps: 10 | Train Loss: 0.082 Vali Loss: 3.828 Vali Acc: 0.266 Test Loss: 3.828 Test Acc: 0.266
Validation loss decreased (-0.261139 --> -0.265844).  Saving model ...
Epoch: 29 cost time: 0.9659872055053711
Epoch: 29, Steps: 10 | Train Loss: 0.069 Vali Loss: 3.868 Vali Acc: 0.266 Test Loss: 3.868 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.0221211910247803
Epoch: 30, Steps: 10 | Train Loss: 0.057 Vali Loss: 3.914 Vali Acc: 0.264 Test Loss: 3.914 Test Acc: 0.264
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.0527968406677246
Epoch: 31, Steps: 10 | Train Loss: 0.046 Vali Loss: 3.960 Vali Acc: 0.262 Test Loss: 3.960 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.9427297115325928
Epoch: 32, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.986 Vali Acc: 0.269 Test Loss: 3.986 Test Acc: 0.269
Validation loss decreased (-0.265844 --> -0.269372).  Saving model ...
Epoch: 33 cost time: 1.0208687782287598
Epoch: 33, Steps: 10 | Train Loss: 0.039 Vali Loss: 4.026 Vali Acc: 0.264 Test Loss: 4.026 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.0771164894104004
Epoch: 34, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.063 Vali Acc: 0.265 Test Loss: 4.063 Test Acc: 0.265
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.0292327404022217
Epoch: 35, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.084 Vali Acc: 0.272 Test Loss: 4.084 Test Acc: 0.272
Validation loss decreased (-0.269372 --> -0.271724).  Saving model ...
Epoch: 36 cost time: 0.9628114700317383
Epoch: 36, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.109 Vali Acc: 0.267 Test Loss: 4.109 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.0520954132080078
Epoch: 37, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.140 Vali Acc: 0.269 Test Loss: 4.140 Test Acc: 0.269
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.0236561298370361
Epoch: 38, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.168 Vali Acc: 0.268 Test Loss: 4.168 Test Acc: 0.268
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.0376379489898682
Epoch: 39, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.193 Vali Acc: 0.272 Test Loss: 4.193 Test Acc: 0.272
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.9496560096740723
Epoch: 40, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.224 Vali Acc: 0.273 Test Loss: 4.224 Test Acc: 0.273
Validation loss decreased (-0.271724 --> -0.272899).  Saving model ...
Epoch: 41 cost time: 0.9354414939880371
Epoch: 41, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.255 Vali Acc: 0.269 Test Loss: 4.255 Test Acc: 0.269
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.880016565322876
Epoch: 42, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.283 Vali Acc: 0.267 Test Loss: 4.283 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.9904665946960449
Epoch: 43, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.296 Vali Acc: 0.267 Test Loss: 4.296 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.8825867176055908
Epoch: 44, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.307 Vali Acc: 0.267 Test Loss: 4.307 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.9752686023712158
Epoch: 45, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.315 Vali Acc: 0.268 Test Loss: 4.315 Test Acc: 0.268
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.9846694469451904
Epoch: 46, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.346 Vali Acc: 0.268 Test Loss: 4.346 Test Acc: 0.268
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.8579175472259521
Epoch: 47, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.373 Vali Acc: 0.269 Test Loss: 4.373 Test Acc: 0.269
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 0.9062671661376953
Epoch: 48, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.413 Vali Acc: 0.271 Test Loss: 4.413 Test Acc: 0.271
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 0.9219205379486084
Epoch: 49, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.438 Vali Acc: 0.276 Test Loss: 4.438 Test Acc: 0.276
Validation loss decreased (-0.272899 --> -0.276426).  Saving model ...
Epoch: 50 cost time: 0.8643715381622314
Epoch: 50, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.448 Vali Acc: 0.275 Test Loss: 4.448 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27647058823529413
model parameter : 335642
model size : 1.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps38_str19_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.5391976833343506
Epoch: 1, Steps: 10 | Train Loss: 3.296 Vali Loss: 3.267 Vali Acc: 0.042 Test Loss: 3.267 Test Acc: 0.042
Validation loss decreased (inf --> -0.042320).  Saving model ...
Epoch: 2 cost time: 0.8872294425964355
Epoch: 2, Steps: 10 | Train Loss: 3.244 Vali Loss: 3.263 Vali Acc: 0.040 Test Loss: 3.263 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9068996906280518
Epoch: 3, Steps: 10 | Train Loss: 3.177 Vali Loss: 3.255 Vali Acc: 0.046 Test Loss: 3.255 Test Acc: 0.046
Validation loss decreased (-0.042320 --> -0.045850).  Saving model ...
Epoch: 4 cost time: 0.8206789493560791
Epoch: 4, Steps: 10 | Train Loss: 3.070 Vali Loss: 3.246 Vali Acc: 0.056 Test Loss: 3.246 Test Acc: 0.056
Validation loss decreased (-0.045850 --> -0.056438).  Saving model ...
Epoch: 5 cost time: 0.8694057464599609
Epoch: 5, Steps: 10 | Train Loss: 2.961 Vali Loss: 3.238 Vali Acc: 0.068 Test Loss: 3.238 Test Acc: 0.068
Validation loss decreased (-0.056438 --> -0.068203).  Saving model ...
Epoch: 6 cost time: 0.8885233402252197
Epoch: 6, Steps: 10 | Train Loss: 2.837 Vali Loss: 3.231 Vali Acc: 0.080 Test Loss: 3.231 Test Acc: 0.080
Validation loss decreased (-0.068203 --> -0.079968).  Saving model ...
Epoch: 7 cost time: 0.9391138553619385
Epoch: 7, Steps: 10 | Train Loss: 2.731 Vali Loss: 3.226 Vali Acc: 0.104 Test Loss: 3.226 Test Acc: 0.104
Validation loss decreased (-0.079968 --> -0.103497).  Saving model ...
Epoch: 8 cost time: 0.9887027740478516
Epoch: 8, Steps: 10 | Train Loss: 2.615 Vali Loss: 3.221 Vali Acc: 0.111 Test Loss: 3.221 Test Acc: 0.111
Validation loss decreased (-0.103497 --> -0.110556).  Saving model ...
Epoch: 9 cost time: 0.9298138618469238
Epoch: 9, Steps: 10 | Train Loss: 2.469 Vali Loss: 3.214 Vali Acc: 0.131 Test Loss: 3.214 Test Acc: 0.131
Validation loss decreased (-0.110556 --> -0.130556).  Saving model ...
Epoch: 10 cost time: 0.8747785091400146
Epoch: 10, Steps: 10 | Train Loss: 2.340 Vali Loss: 3.208 Vali Acc: 0.138 Test Loss: 3.208 Test Acc: 0.138
Validation loss decreased (-0.130556 --> -0.137615).  Saving model ...
Epoch: 11 cost time: 0.9819860458374023
Epoch: 11, Steps: 10 | Train Loss: 2.182 Vali Loss: 3.201 Vali Acc: 0.152 Test Loss: 3.201 Test Acc: 0.152
Validation loss decreased (-0.137615 --> -0.151733).  Saving model ...
Epoch: 12 cost time: 0.976804256439209
Epoch: 12, Steps: 10 | Train Loss: 1.988 Vali Loss: 3.194 Vali Acc: 0.160 Test Loss: 3.194 Test Acc: 0.160
Validation loss decreased (-0.151733 --> -0.159968).  Saving model ...
Epoch: 13 cost time: 1.0053625106811523
Epoch: 13, Steps: 10 | Train Loss: 1.797 Vali Loss: 3.197 Vali Acc: 0.173 Test Loss: 3.197 Test Acc: 0.173
Validation loss decreased (-0.159968 --> -0.172909).  Saving model ...
Epoch: 14 cost time: 0.8424553871154785
Epoch: 14, Steps: 10 | Train Loss: 1.641 Vali Loss: 3.198 Vali Acc: 0.185 Test Loss: 3.198 Test Acc: 0.185
Validation loss decreased (-0.172909 --> -0.184674).  Saving model ...
Epoch: 15 cost time: 0.9033758640289307
Epoch: 15, Steps: 10 | Train Loss: 1.472 Vali Loss: 3.212 Vali Acc: 0.198 Test Loss: 3.212 Test Acc: 0.198
Validation loss decreased (-0.184674 --> -0.197615).  Saving model ...
Epoch: 16 cost time: 0.9532334804534912
Epoch: 16, Steps: 10 | Train Loss: 1.273 Vali Loss: 3.223 Vali Acc: 0.204 Test Loss: 3.223 Test Acc: 0.204
Validation loss decreased (-0.197615 --> -0.203497).  Saving model ...
Epoch: 17 cost time: 0.8981869220733643
Epoch: 17, Steps: 10 | Train Loss: 1.114 Vali Loss: 3.256 Vali Acc: 0.207 Test Loss: 3.256 Test Acc: 0.207
Validation loss decreased (-0.203497 --> -0.207026).  Saving model ...
Epoch: 18 cost time: 0.936464786529541
Epoch: 18, Steps: 10 | Train Loss: 0.975 Vali Loss: 3.295 Vali Acc: 0.214 Test Loss: 3.295 Test Acc: 0.214
Validation loss decreased (-0.207026 --> -0.214085).  Saving model ...
Epoch: 19 cost time: 0.8846495151519775
Epoch: 19, Steps: 10 | Train Loss: 0.810 Vali Loss: 3.313 Vali Acc: 0.227 Test Loss: 3.313 Test Acc: 0.227
Validation loss decreased (-0.214085 --> -0.227026).  Saving model ...
Epoch: 20 cost time: 0.8432474136352539
Epoch: 20, Steps: 10 | Train Loss: 0.650 Vali Loss: 3.346 Vali Acc: 0.232 Test Loss: 3.346 Test Acc: 0.232
Validation loss decreased (-0.227026 --> -0.231731).  Saving model ...
Epoch: 21 cost time: 0.9769465923309326
Epoch: 21, Steps: 10 | Train Loss: 0.529 Vali Loss: 3.398 Vali Acc: 0.233 Test Loss: 3.398 Test Acc: 0.233
Validation loss decreased (-0.231731 --> -0.232907).  Saving model ...
Epoch: 22 cost time: 0.9641976356506348
Epoch: 22, Steps: 10 | Train Loss: 0.420 Vali Loss: 3.454 Vali Acc: 0.244 Test Loss: 3.454 Test Acc: 0.244
Validation loss decreased (-0.232907 --> -0.243495).  Saving model ...
Epoch: 23 cost time: 0.9244165420532227
Epoch: 23, Steps: 10 | Train Loss: 0.324 Vali Loss: 3.499 Vali Acc: 0.246 Test Loss: 3.499 Test Acc: 0.246
Validation loss decreased (-0.243495 --> -0.245847).  Saving model ...
Epoch: 24 cost time: 0.9447698593139648
Epoch: 24, Steps: 10 | Train Loss: 0.286 Vali Loss: 3.579 Vali Acc: 0.247 Test Loss: 3.579 Test Acc: 0.247
Validation loss decreased (-0.245847 --> -0.247023).  Saving model ...
Epoch: 25 cost time: 1.0238778591156006
Epoch: 25, Steps: 10 | Train Loss: 0.233 Vali Loss: 3.619 Vali Acc: 0.249 Test Loss: 3.619 Test Acc: 0.249
Validation loss decreased (-0.247023 --> -0.249376).  Saving model ...
Epoch: 26 cost time: 0.9661366939544678
Epoch: 26, Steps: 10 | Train Loss: 0.192 Vali Loss: 3.655 Vali Acc: 0.248 Test Loss: 3.655 Test Acc: 0.248
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9298660755157471
Epoch: 27, Steps: 10 | Train Loss: 0.151 Vali Loss: 3.701 Vali Acc: 0.255 Test Loss: 3.701 Test Acc: 0.255
Validation loss decreased (-0.249376 --> -0.255257).  Saving model ...
Epoch: 28 cost time: 0.9383828639984131
Epoch: 28, Steps: 10 | Train Loss: 0.121 Vali Loss: 3.765 Vali Acc: 0.252 Test Loss: 3.765 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.899529218673706
Epoch: 29, Steps: 10 | Train Loss: 0.103 Vali Loss: 3.817 Vali Acc: 0.249 Test Loss: 3.817 Test Acc: 0.249
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.9478743076324463
Epoch: 30, Steps: 10 | Train Loss: 0.094 Vali Loss: 3.865 Vali Acc: 0.252 Test Loss: 3.865 Test Acc: 0.252
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.0376262664794922
Epoch: 31, Steps: 10 | Train Loss: 0.073 Vali Loss: 3.901 Vali Acc: 0.253 Test Loss: 3.901 Test Acc: 0.253
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.9502706527709961
Epoch: 32, Steps: 10 | Train Loss: 0.068 Vali Loss: 3.936 Vali Acc: 0.255 Test Loss: 3.936 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.8275811672210693
Epoch: 33, Steps: 10 | Train Loss: 0.059 Vali Loss: 3.982 Vali Acc: 0.254 Test Loss: 3.982 Test Acc: 0.254
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.9704697132110596
Epoch: 34, Steps: 10 | Train Loss: 0.052 Vali Loss: 4.014 Vali Acc: 0.254 Test Loss: 4.014 Test Acc: 0.254
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.9578056335449219
Epoch: 35, Steps: 10 | Train Loss: 0.041 Vali Loss: 4.064 Vali Acc: 0.253 Test Loss: 4.064 Test Acc: 0.253
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.9968018531799316
Epoch: 36, Steps: 10 | Train Loss: 0.041 Vali Loss: 4.098 Vali Acc: 0.256 Test Loss: 4.098 Test Acc: 0.256
Validation loss decreased (-0.255257 --> -0.256430).  Saving model ...
Epoch: 37 cost time: 0.9789474010467529
Epoch: 37, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.144 Vali Acc: 0.254 Test Loss: 4.144 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.9331419467926025
Epoch: 38, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.170 Vali Acc: 0.258 Test Loss: 4.170 Test Acc: 0.258
Validation loss decreased (-0.256430 --> -0.257605).  Saving model ...
Epoch: 39 cost time: 1.03021240234375
Epoch: 39, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.191 Vali Acc: 0.258 Test Loss: 4.191 Test Acc: 0.258
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.0129799842834473
Epoch: 40, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.204 Vali Acc: 0.259 Test Loss: 4.204 Test Acc: 0.259
Validation loss decreased (-0.257605 --> -0.258781).  Saving model ...
Epoch: 41 cost time: 1.103095293045044
Epoch: 41, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.226 Vali Acc: 0.262 Test Loss: 4.226 Test Acc: 0.262
Validation loss decreased (-0.258781 --> -0.262311).  Saving model ...
Epoch: 42 cost time: 1.0065536499023438
Epoch: 42, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.272 Vali Acc: 0.261 Test Loss: 4.272 Test Acc: 0.261
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.9966034889221191
Epoch: 43, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.306 Vali Acc: 0.260 Test Loss: 4.306 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.0266716480255127
Epoch: 44, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.332 Vali Acc: 0.261 Test Loss: 4.332 Test Acc: 0.261
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.9387946128845215
Epoch: 45, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.344 Vali Acc: 0.266 Test Loss: 4.344 Test Acc: 0.266
Validation loss decreased (-0.262311 --> -0.265839).  Saving model ...
Epoch: 46 cost time: 0.9916720390319824
Epoch: 46, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.361 Vali Acc: 0.266 Test Loss: 4.361 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.9225893020629883
Epoch: 47, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.384 Vali Acc: 0.266 Test Loss: 4.384 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.9822547435760498
Epoch: 48, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.416 Vali Acc: 0.271 Test Loss: 4.416 Test Acc: 0.271
Validation loss decreased (-0.265839 --> -0.270544).  Saving model ...
Epoch: 49 cost time: 1.0159742832183838
Epoch: 49, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.449 Vali Acc: 0.267 Test Loss: 4.449 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.017063856124878
Epoch: 50, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.470 Vali Acc: 0.269 Test Loss: 4.470 Test Acc: 0.269
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps38_str19_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27058823529411763
model parameter : 326106
model size : 1.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.5407979488372803
Epoch: 1, Steps: 10 | Train Loss: 3.259 Vali Loss: 3.260 Vali Acc: 0.040 Test Loss: 3.260 Test Acc: 0.040
Validation loss decreased (inf --> -0.039967).  Saving model ...
Epoch: 2 cost time: 0.9870221614837646
Epoch: 2, Steps: 10 | Train Loss: 3.112 Vali Loss: 3.252 Vali Acc: 0.072 Test Loss: 3.252 Test Acc: 0.072
Validation loss decreased (-0.039967 --> -0.071732).  Saving model ...
Epoch: 3 cost time: 0.9147589206695557
Epoch: 3, Steps: 10 | Train Loss: 2.917 Vali Loss: 3.256 Vali Acc: 0.102 Test Loss: 3.256 Test Acc: 0.102
Validation loss decreased (-0.071732 --> -0.102320).  Saving model ...
Epoch: 4 cost time: 0.8222823143005371
Epoch: 4, Steps: 10 | Train Loss: 2.645 Vali Loss: 3.243 Vali Acc: 0.114 Test Loss: 3.243 Test Acc: 0.114
Validation loss decreased (-0.102320 --> -0.114085).  Saving model ...
Epoch: 5 cost time: 0.8998751640319824
Epoch: 5, Steps: 10 | Train Loss: 2.371 Vali Loss: 3.217 Vali Acc: 0.147 Test Loss: 3.217 Test Acc: 0.147
Validation loss decreased (-0.114085 --> -0.147027).  Saving model ...
Epoch: 6 cost time: 0.9136126041412354
Epoch: 6, Steps: 10 | Train Loss: 2.005 Vali Loss: 3.183 Vali Acc: 0.161 Test Loss: 3.183 Test Acc: 0.161
Validation loss decreased (-0.147027 --> -0.161145).  Saving model ...
Epoch: 7 cost time: 0.8668506145477295
Epoch: 7, Steps: 10 | Train Loss: 1.616 Vali Loss: 3.171 Vali Acc: 0.186 Test Loss: 3.171 Test Acc: 0.186
Validation loss decreased (-0.161145 --> -0.185851).  Saving model ...
Epoch: 8 cost time: 0.8715260028839111
Epoch: 8, Steps: 10 | Train Loss: 1.245 Vali Loss: 3.186 Vali Acc: 0.207 Test Loss: 3.186 Test Acc: 0.207
Validation loss decreased (-0.185851 --> -0.207027).  Saving model ...
Epoch: 9 cost time: 0.7774643898010254
Epoch: 9, Steps: 10 | Train Loss: 0.867 Vali Loss: 3.274 Vali Acc: 0.213 Test Loss: 3.274 Test Acc: 0.213
Validation loss decreased (-0.207027 --> -0.212908).  Saving model ...
Epoch: 10 cost time: 0.8855853080749512
Epoch: 10, Steps: 10 | Train Loss: 0.598 Vali Loss: 3.413 Vali Acc: 0.222 Test Loss: 3.413 Test Acc: 0.222
Validation loss decreased (-0.212908 --> -0.222319).  Saving model ...
Epoch: 11 cost time: 0.8942131996154785
Epoch: 11, Steps: 10 | Train Loss: 0.371 Vali Loss: 3.525 Vali Acc: 0.249 Test Loss: 3.525 Test Acc: 0.249
Validation loss decreased (-0.222319 --> -0.249377).  Saving model ...
Epoch: 12 cost time: 0.8375282287597656
Epoch: 12, Steps: 10 | Train Loss: 0.229 Vali Loss: 3.676 Vali Acc: 0.249 Test Loss: 3.676 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8056085109710693
Epoch: 13, Steps: 10 | Train Loss: 0.124 Vali Loss: 3.837 Vali Acc: 0.253 Test Loss: 3.837 Test Acc: 0.253
Validation loss decreased (-0.249377 --> -0.252903).  Saving model ...
Epoch: 14 cost time: 0.7275967597961426
Epoch: 14, Steps: 10 | Train Loss: 0.069 Vali Loss: 3.989 Vali Acc: 0.258 Test Loss: 3.989 Test Acc: 0.258
Validation loss decreased (-0.252903 --> -0.257607).  Saving model ...
Epoch: 15 cost time: 0.8174741268157959
Epoch: 15, Steps: 10 | Train Loss: 0.045 Vali Loss: 4.092 Vali Acc: 0.274 Test Loss: 4.092 Test Acc: 0.274
Validation loss decreased (-0.257607 --> -0.274077).  Saving model ...
Epoch: 16 cost time: 0.8584671020507812
Epoch: 16, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.166 Vali Acc: 0.271 Test Loss: 4.166 Test Acc: 0.271
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9038465023040771
Epoch: 17, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.255 Vali Acc: 0.265 Test Loss: 4.255 Test Acc: 0.265
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9023098945617676
Epoch: 18, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.321 Vali Acc: 0.271 Test Loss: 4.321 Test Acc: 0.271
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.8499455451965332
Epoch: 19, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.371 Vali Acc: 0.273 Test Loss: 4.371 Test Acc: 0.273
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.9504497051239014
Epoch: 20, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.418 Vali Acc: 0.271 Test Loss: 4.418 Test Acc: 0.271
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.9101927280426025
Epoch: 21, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.459 Vali Acc: 0.268 Test Loss: 4.459 Test Acc: 0.268
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.9334867000579834
Epoch: 22, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.491 Vali Acc: 0.272 Test Loss: 4.491 Test Acc: 0.272
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.9177253246307373
Epoch: 23, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.535 Vali Acc: 0.268 Test Loss: 4.535 Test Acc: 0.268
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.8369472026824951
Epoch: 24, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.584 Vali Acc: 0.275 Test Loss: 4.584 Test Acc: 0.275
Validation loss decreased (-0.274077 --> -0.275248).  Saving model ...
Epoch: 25 cost time: 0.7772328853607178
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.621 Vali Acc: 0.273 Test Loss: 4.621 Test Acc: 0.273
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8631279468536377
Epoch: 26, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.644 Vali Acc: 0.275 Test Loss: 4.644 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.7918579578399658
Epoch: 27, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.672 Vali Acc: 0.278 Test Loss: 4.672 Test Acc: 0.278
Validation loss decreased (-0.275248 --> -0.277600).  Saving model ...
Epoch: 28 cost time: 0.6811764240264893
Epoch: 28, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.714 Vali Acc: 0.279 Test Loss: 4.714 Test Acc: 0.279
Validation loss decreased (-0.277600 --> -0.278776).  Saving model ...
Epoch: 29 cost time: 0.7036991119384766
Epoch: 29, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.745 Vali Acc: 0.275 Test Loss: 4.745 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.6145448684692383
Epoch: 30, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.784 Vali Acc: 0.274 Test Loss: 4.784 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.7961428165435791
Epoch: 31, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.813 Vali Acc: 0.275 Test Loss: 4.813 Test Acc: 0.275
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.8110976219177246
Epoch: 32, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.837 Vali Acc: 0.272 Test Loss: 4.837 Test Acc: 0.272
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.9091317653656006
Epoch: 33, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.860 Vali Acc: 0.274 Test Loss: 4.860 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.9236178398132324
Epoch: 34, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.875 Vali Acc: 0.274 Test Loss: 4.875 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.8754539489746094
Epoch: 35, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.901 Vali Acc: 0.275 Test Loss: 4.901 Test Acc: 0.275
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.7977571487426758
Epoch: 36, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.927 Vali Acc: 0.275 Test Loss: 4.927 Test Acc: 0.275
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.9053714275360107
Epoch: 37, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.958 Vali Acc: 0.274 Test Loss: 4.958 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.9149785041809082
Epoch: 38, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.987 Vali Acc: 0.276 Test Loss: 4.987 Test Acc: 0.276
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2788235294117647
model parameter : 266170
model size : 1.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.501268148422241
Epoch: 1, Steps: 10 | Train Loss: 3.287 Vali Loss: 3.276 Vali Acc: 0.036 Test Loss: 3.276 Test Acc: 0.036
Validation loss decreased (inf --> -0.036438).  Saving model ...
Epoch: 2 cost time: 0.9159960746765137
Epoch: 2, Steps: 10 | Train Loss: 3.202 Vali Loss: 3.266 Vali Acc: 0.042 Test Loss: 3.266 Test Acc: 0.042
Validation loss decreased (-0.036438 --> -0.042320).  Saving model ...
Epoch: 3 cost time: 0.8308937549591064
Epoch: 3, Steps: 10 | Train Loss: 3.098 Vali Loss: 3.253 Vali Acc: 0.055 Test Loss: 3.253 Test Acc: 0.055
Validation loss decreased (-0.042320 --> -0.055262).  Saving model ...
Epoch: 4 cost time: 0.76273512840271
Epoch: 4, Steps: 10 | Train Loss: 2.932 Vali Loss: 3.249 Vali Acc: 0.068 Test Loss: 3.249 Test Acc: 0.068
Validation loss decreased (-0.055262 --> -0.068203).  Saving model ...
Epoch: 5 cost time: 0.8192663192749023
Epoch: 5, Steps: 10 | Train Loss: 2.767 Vali Loss: 3.244 Vali Acc: 0.093 Test Loss: 3.244 Test Acc: 0.093
Validation loss decreased (-0.068203 --> -0.092909).  Saving model ...
Epoch: 6 cost time: 0.8312399387359619
Epoch: 6, Steps: 10 | Train Loss: 2.570 Vali Loss: 3.232 Vali Acc: 0.105 Test Loss: 3.232 Test Acc: 0.105
Validation loss decreased (-0.092909 --> -0.104674).  Saving model ...
Epoch: 7 cost time: 0.8553204536437988
Epoch: 7, Steps: 10 | Train Loss: 2.420 Vali Loss: 3.221 Vali Acc: 0.112 Test Loss: 3.221 Test Acc: 0.112
Validation loss decreased (-0.104674 --> -0.111732).  Saving model ...
Epoch: 8 cost time: 0.8205258846282959
Epoch: 8, Steps: 10 | Train Loss: 2.167 Vali Loss: 3.206 Vali Acc: 0.133 Test Loss: 3.206 Test Acc: 0.133
Validation loss decreased (-0.111732 --> -0.132909).  Saving model ...
Epoch: 9 cost time: 0.8191719055175781
Epoch: 9, Steps: 10 | Train Loss: 1.891 Vali Loss: 3.193 Vali Acc: 0.160 Test Loss: 3.193 Test Acc: 0.160
Validation loss decreased (-0.132909 --> -0.159968).  Saving model ...
Epoch: 10 cost time: 0.8352453708648682
Epoch: 10, Steps: 10 | Train Loss: 1.618 Vali Loss: 3.203 Vali Acc: 0.175 Test Loss: 3.203 Test Acc: 0.175
Validation loss decreased (-0.159968 --> -0.175262).  Saving model ...
Epoch: 11 cost time: 0.9015998840332031
Epoch: 11, Steps: 10 | Train Loss: 1.365 Vali Loss: 3.226 Vali Acc: 0.185 Test Loss: 3.226 Test Acc: 0.185
Validation loss decreased (-0.175262 --> -0.184674).  Saving model ...
Epoch: 12 cost time: 0.9993526935577393
Epoch: 12, Steps: 10 | Train Loss: 1.092 Vali Loss: 3.263 Vali Acc: 0.211 Test Loss: 3.263 Test Acc: 0.211
Validation loss decreased (-0.184674 --> -0.210556).  Saving model ...
Epoch: 13 cost time: 0.9868979454040527
Epoch: 13, Steps: 10 | Train Loss: 0.862 Vali Loss: 3.330 Vali Acc: 0.216 Test Loss: 3.330 Test Acc: 0.216
Validation loss decreased (-0.210556 --> -0.216437).  Saving model ...
Epoch: 14 cost time: 0.916536808013916
Epoch: 14, Steps: 10 | Train Loss: 0.622 Vali Loss: 3.388 Vali Acc: 0.231 Test Loss: 3.388 Test Acc: 0.231
Validation loss decreased (-0.216437 --> -0.230554).  Saving model ...
Epoch: 15 cost time: 1.0272722244262695
Epoch: 15, Steps: 10 | Train Loss: 0.434 Vali Loss: 3.485 Vali Acc: 0.249 Test Loss: 3.485 Test Acc: 0.249
Validation loss decreased (-0.230554 --> -0.249377).  Saving model ...
Epoch: 16 cost time: 0.9461727142333984
Epoch: 16, Steps: 10 | Train Loss: 0.332 Vali Loss: 3.599 Vali Acc: 0.252 Test Loss: 3.599 Test Acc: 0.252
Validation loss decreased (-0.249377 --> -0.251729).  Saving model ...
Epoch: 17 cost time: 0.9328789710998535
Epoch: 17, Steps: 10 | Train Loss: 0.226 Vali Loss: 3.695 Vali Acc: 0.269 Test Loss: 3.695 Test Acc: 0.269
Validation loss decreased (-0.251729 --> -0.269375).  Saving model ...
Epoch: 18 cost time: 0.9866917133331299
Epoch: 18, Steps: 10 | Train Loss: 0.170 Vali Loss: 3.810 Vali Acc: 0.260 Test Loss: 3.810 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9344387054443359
Epoch: 19, Steps: 10 | Train Loss: 0.115 Vali Loss: 3.943 Vali Acc: 0.266 Test Loss: 3.943 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9410207271575928
Epoch: 20, Steps: 10 | Train Loss: 0.083 Vali Loss: 4.011 Vali Acc: 0.268 Test Loss: 4.011 Test Acc: 0.268
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.9336295127868652
Epoch: 21, Steps: 10 | Train Loss: 0.062 Vali Loss: 4.073 Vali Acc: 0.272 Test Loss: 4.073 Test Acc: 0.272
Validation loss decreased (-0.269375 --> -0.271724).  Saving model ...
Epoch: 22 cost time: 0.8379218578338623
Epoch: 22, Steps: 10 | Train Loss: 0.053 Vali Loss: 4.153 Vali Acc: 0.273 Test Loss: 4.153 Test Acc: 0.273
Validation loss decreased (-0.271724 --> -0.272900).  Saving model ...
Epoch: 23 cost time: 0.937241792678833
Epoch: 23, Steps: 10 | Train Loss: 0.041 Vali Loss: 4.208 Vali Acc: 0.272 Test Loss: 4.208 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9204132556915283
Epoch: 24, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.253 Vali Acc: 0.273 Test Loss: 4.253 Test Acc: 0.273
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.0101304054260254
Epoch: 25, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.303 Vali Acc: 0.282 Test Loss: 4.303 Test Acc: 0.282
Validation loss decreased (-0.272900 --> -0.282310).  Saving model ...
Epoch: 26 cost time: 0.9834177494049072
Epoch: 26, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.355 Vali Acc: 0.279 Test Loss: 4.355 Test Acc: 0.279
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9771287441253662
Epoch: 27, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.405 Vali Acc: 0.278 Test Loss: 4.405 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.9109585285186768
Epoch: 28, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.457 Vali Acc: 0.278 Test Loss: 4.457 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.9532527923583984
Epoch: 29, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.488 Vali Acc: 0.278 Test Loss: 4.488 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.8970608711242676
Epoch: 30, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.517 Vali Acc: 0.278 Test Loss: 4.517 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.8766531944274902
Epoch: 31, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.552 Vali Acc: 0.280 Test Loss: 4.552 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.9883484840393066
Epoch: 32, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.588 Vali Acc: 0.281 Test Loss: 4.588 Test Acc: 0.281
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.9753460884094238
Epoch: 33, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.615 Vali Acc: 0.281 Test Loss: 4.615 Test Acc: 0.281
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.939037561416626
Epoch: 34, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.655 Vali Acc: 0.275 Test Loss: 4.655 Test Acc: 0.275
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.86830735206604
Epoch: 35, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.687 Vali Acc: 0.278 Test Loss: 4.687 Test Acc: 0.278
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2823529411764706
model parameter : 171450
model size : 0.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps12_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.512265205383301
Epoch: 1, Steps: 10 | Train Loss: 3.291 Vali Loss: 3.279 Vali Acc: 0.039 Test Loss: 3.279 Test Acc: 0.039
Validation loss decreased (inf --> -0.038791).  Saving model ...
Epoch: 2 cost time: 0.9312138557434082
Epoch: 2, Steps: 10 | Train Loss: 3.229 Vali Loss: 3.276 Vali Acc: 0.047 Test Loss: 3.276 Test Acc: 0.047
Validation loss decreased (-0.038791 --> -0.047026).  Saving model ...
Epoch: 3 cost time: 0.9122040271759033
Epoch: 3, Steps: 10 | Train Loss: 3.133 Vali Loss: 3.270 Vali Acc: 0.055 Test Loss: 3.270 Test Acc: 0.055
Validation loss decreased (-0.047026 --> -0.055261).  Saving model ...
Epoch: 4 cost time: 0.867915153503418
Epoch: 4, Steps: 10 | Train Loss: 3.030 Vali Loss: 3.264 Vali Acc: 0.067 Test Loss: 3.264 Test Acc: 0.067
Validation loss decreased (-0.055261 --> -0.067026).  Saving model ...
Epoch: 5 cost time: 0.8792245388031006
Epoch: 5, Steps: 10 | Train Loss: 2.915 Vali Loss: 3.261 Vali Acc: 0.072 Test Loss: 3.261 Test Acc: 0.072
Validation loss decreased (-0.067026 --> -0.071732).  Saving model ...
Epoch: 6 cost time: 0.8622260093688965
Epoch: 6, Steps: 10 | Train Loss: 2.786 Vali Loss: 3.260 Vali Acc: 0.072 Test Loss: 3.260 Test Acc: 0.072
Validation loss decreased (-0.071732 --> -0.071732).  Saving model ...
Epoch: 7 cost time: 0.8880548477172852
Epoch: 7, Steps: 10 | Train Loss: 2.634 Vali Loss: 3.251 Vali Acc: 0.084 Test Loss: 3.251 Test Acc: 0.084
Validation loss decreased (-0.071732 --> -0.083497).  Saving model ...
Epoch: 8 cost time: 0.9685018062591553
Epoch: 8, Steps: 10 | Train Loss: 2.457 Vali Loss: 3.245 Vali Acc: 0.094 Test Loss: 3.245 Test Acc: 0.094
Validation loss decreased (-0.083497 --> -0.094085).  Saving model ...
Epoch: 9 cost time: 0.9284100532531738
Epoch: 9, Steps: 10 | Train Loss: 2.272 Vali Loss: 3.228 Vali Acc: 0.107 Test Loss: 3.228 Test Acc: 0.107
Validation loss decreased (-0.094085 --> -0.107027).  Saving model ...
Epoch: 10 cost time: 0.9340817928314209
Epoch: 10, Steps: 10 | Train Loss: 2.087 Vali Loss: 3.214 Vali Acc: 0.114 Test Loss: 3.214 Test Acc: 0.114
Validation loss decreased (-0.107027 --> -0.114086).  Saving model ...
Epoch: 11 cost time: 0.8720004558563232
Epoch: 11, Steps: 10 | Train Loss: 1.852 Vali Loss: 3.212 Vali Acc: 0.128 Test Loss: 3.212 Test Acc: 0.128
Validation loss decreased (-0.114086 --> -0.128203).  Saving model ...
Epoch: 12 cost time: 0.8873860836029053
Epoch: 12, Steps: 10 | Train Loss: 1.652 Vali Loss: 3.208 Vali Acc: 0.155 Test Loss: 3.208 Test Acc: 0.155
Validation loss decreased (-0.128203 --> -0.155262).  Saving model ...
Epoch: 13 cost time: 0.8301823139190674
Epoch: 13, Steps: 10 | Train Loss: 1.412 Vali Loss: 3.210 Vali Acc: 0.176 Test Loss: 3.210 Test Acc: 0.176
Validation loss decreased (-0.155262 --> -0.176438).  Saving model ...
Epoch: 14 cost time: 0.8779029846191406
Epoch: 14, Steps: 10 | Train Loss: 1.186 Vali Loss: 3.235 Vali Acc: 0.191 Test Loss: 3.235 Test Acc: 0.191
Validation loss decreased (-0.176438 --> -0.190556).  Saving model ...
Epoch: 15 cost time: 0.922734260559082
Epoch: 15, Steps: 10 | Train Loss: 0.990 Vali Loss: 3.265 Vali Acc: 0.193 Test Loss: 3.265 Test Acc: 0.193
Validation loss decreased (-0.190556 --> -0.192909).  Saving model ...
Epoch: 16 cost time: 0.9366557598114014
Epoch: 16, Steps: 10 | Train Loss: 0.795 Vali Loss: 3.304 Vali Acc: 0.204 Test Loss: 3.304 Test Acc: 0.204
Validation loss decreased (-0.192909 --> -0.203496).  Saving model ...
Epoch: 17 cost time: 0.8284995555877686
Epoch: 17, Steps: 10 | Train Loss: 0.619 Vali Loss: 3.352 Vali Acc: 0.224 Test Loss: 3.352 Test Acc: 0.224
Validation loss decreased (-0.203496 --> -0.223496).  Saving model ...
Epoch: 18 cost time: 0.9043703079223633
Epoch: 18, Steps: 10 | Train Loss: 0.490 Vali Loss: 3.424 Vali Acc: 0.227 Test Loss: 3.424 Test Acc: 0.227
Validation loss decreased (-0.223496 --> -0.227025).  Saving model ...
Epoch: 19 cost time: 0.9679608345031738
Epoch: 19, Steps: 10 | Train Loss: 0.370 Vali Loss: 3.506 Vali Acc: 0.236 Test Loss: 3.506 Test Acc: 0.236
Validation loss decreased (-0.227025 --> -0.236436).  Saving model ...
Epoch: 20 cost time: 0.8801295757293701
Epoch: 20, Steps: 10 | Train Loss: 0.278 Vali Loss: 3.587 Vali Acc: 0.236 Test Loss: 3.587 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9713037014007568
Epoch: 21, Steps: 10 | Train Loss: 0.213 Vali Loss: 3.664 Vali Acc: 0.244 Test Loss: 3.664 Test Acc: 0.244
Validation loss decreased (-0.236436 --> -0.243493).  Saving model ...
Epoch: 22 cost time: 1.0125505924224854
Epoch: 22, Steps: 10 | Train Loss: 0.157 Vali Loss: 3.745 Vali Acc: 0.247 Test Loss: 3.745 Test Acc: 0.247
Validation loss decreased (-0.243493 --> -0.247021).  Saving model ...
Epoch: 23 cost time: 1.032346487045288
Epoch: 23, Steps: 10 | Train Loss: 0.121 Vali Loss: 3.820 Vali Acc: 0.242 Test Loss: 3.820 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9422733783721924
Epoch: 24, Steps: 10 | Train Loss: 0.101 Vali Loss: 3.855 Vali Acc: 0.254 Test Loss: 3.855 Test Acc: 0.254
Validation loss decreased (-0.247021 --> -0.254079).  Saving model ...
Epoch: 25 cost time: 1.020014762878418
Epoch: 25, Steps: 10 | Train Loss: 0.086 Vali Loss: 3.937 Vali Acc: 0.251 Test Loss: 3.937 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.994436502456665
Epoch: 26, Steps: 10 | Train Loss: 0.073 Vali Loss: 3.988 Vali Acc: 0.251 Test Loss: 3.988 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.9744021892547607
Epoch: 27, Steps: 10 | Train Loss: 0.069 Vali Loss: 4.022 Vali Acc: 0.255 Test Loss: 4.022 Test Acc: 0.255
Validation loss decreased (-0.254079 --> -0.255254).  Saving model ...
Epoch: 28 cost time: 1.065356969833374
Epoch: 28, Steps: 10 | Train Loss: 0.049 Vali Loss: 4.098 Vali Acc: 0.248 Test Loss: 4.098 Test Acc: 0.248
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.0230846405029297
Epoch: 29, Steps: 10 | Train Loss: 0.043 Vali Loss: 4.139 Vali Acc: 0.251 Test Loss: 4.139 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.0075573921203613
Epoch: 30, Steps: 10 | Train Loss: 0.038 Vali Loss: 4.163 Vali Acc: 0.255 Test Loss: 4.163 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.1156744956970215
Epoch: 31, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.197 Vali Acc: 0.254 Test Loss: 4.197 Test Acc: 0.254
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.032520055770874
Epoch: 32, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.231 Vali Acc: 0.255 Test Loss: 4.231 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.8824706077575684
Epoch: 33, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.262 Vali Acc: 0.256 Test Loss: 4.262 Test Acc: 0.256
Validation loss decreased (-0.255254 --> -0.256428).  Saving model ...
Epoch: 34 cost time: 0.9432382583618164
Epoch: 34, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.298 Vali Acc: 0.255 Test Loss: 4.298 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.9435369968414307
Epoch: 35, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.334 Vali Acc: 0.255 Test Loss: 4.334 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.9453990459442139
Epoch: 36, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.355 Vali Acc: 0.253 Test Loss: 4.355 Test Acc: 0.253
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.0396270751953125
Epoch: 37, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.381 Vali Acc: 0.255 Test Loss: 4.381 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.0531401634216309
Epoch: 38, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.394 Vali Acc: 0.258 Test Loss: 4.394 Test Acc: 0.258
Validation loss decreased (-0.256428 --> -0.257603).  Saving model ...
Epoch: 39 cost time: 0.9386248588562012
Epoch: 39, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.423 Vali Acc: 0.262 Test Loss: 4.423 Test Acc: 0.262
Validation loss decreased (-0.257603 --> -0.262309).  Saving model ...
Epoch: 40 cost time: 0.9582290649414062
Epoch: 40, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.450 Vali Acc: 0.261 Test Loss: 4.450 Test Acc: 0.261
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.8276612758636475
Epoch: 41, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.489 Vali Acc: 0.262 Test Loss: 4.489 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.9325251579284668
Epoch: 42, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.518 Vali Acc: 0.264 Test Loss: 4.518 Test Acc: 0.264
Validation loss decreased (-0.262309 --> -0.263484).  Saving model ...
Epoch: 43 cost time: 0.9492416381835938
Epoch: 43, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.539 Vali Acc: 0.261 Test Loss: 4.539 Test Acc: 0.261
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.1101181507110596
Epoch: 44, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.561 Vali Acc: 0.262 Test Loss: 4.561 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.8728358745574951
Epoch: 45, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.582 Vali Acc: 0.261 Test Loss: 4.582 Test Acc: 0.261
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.871671199798584
Epoch: 46, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.609 Vali Acc: 0.261 Test Loss: 4.609 Test Acc: 0.261
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.894864559173584
Epoch: 47, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.630 Vali Acc: 0.265 Test Loss: 4.630 Test Acc: 0.265
Validation loss decreased (-0.263484 --> -0.264660).  Saving model ...
Epoch: 48 cost time: 0.8912172317504883
Epoch: 48, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.648 Vali Acc: 0.265 Test Loss: 4.648 Test Acc: 0.265
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.9523575305938721
Epoch: 49, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.667 Vali Acc: 0.264 Test Loss: 4.667 Test Acc: 0.264
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.8683059215545654
Epoch: 50, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.691 Vali Acc: 0.264 Test Loss: 4.691 Test Acc: 0.264
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps12_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2647058823529412
model parameter : 141626
model size : 0.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.4396071434020996
Epoch: 1, Steps: 10 | Train Loss: 3.291 Vali Loss: 3.271 Vali Acc: 0.038 Test Loss: 3.271 Test Acc: 0.038
Validation loss decreased (inf --> -0.037614).  Saving model ...
Epoch: 2 cost time: 0.9529833793640137
Epoch: 2, Steps: 10 | Train Loss: 3.244 Vali Loss: 3.268 Vali Acc: 0.034 Test Loss: 3.268 Test Acc: 0.034
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8352682590484619
Epoch: 3, Steps: 10 | Train Loss: 3.172 Vali Loss: 3.259 Vali Acc: 0.040 Test Loss: 3.259 Test Acc: 0.040
Validation loss decreased (-0.037614 --> -0.039967).  Saving model ...
Epoch: 4 cost time: 0.8277702331542969
Epoch: 4, Steps: 10 | Train Loss: 3.091 Vali Loss: 3.250 Vali Acc: 0.049 Test Loss: 3.250 Test Acc: 0.049
Validation loss decreased (-0.039967 --> -0.049379).  Saving model ...
Epoch: 5 cost time: 0.7835307121276855
Epoch: 5, Steps: 10 | Train Loss: 2.980 Vali Loss: 3.244 Vali Acc: 0.058 Test Loss: 3.244 Test Acc: 0.058
Validation loss decreased (-0.049379 --> -0.057615).  Saving model ...
Epoch: 6 cost time: 0.8874075412750244
Epoch: 6, Steps: 10 | Train Loss: 2.886 Vali Loss: 3.238 Vali Acc: 0.069 Test Loss: 3.238 Test Acc: 0.069
Validation loss decreased (-0.057615 --> -0.069379).  Saving model ...
Epoch: 7 cost time: 0.8634035587310791
Epoch: 7, Steps: 10 | Train Loss: 2.775 Vali Loss: 3.230 Vali Acc: 0.078 Test Loss: 3.230 Test Acc: 0.078
Validation loss decreased (-0.069379 --> -0.077615).  Saving model ...
Epoch: 8 cost time: 0.8827543258666992
Epoch: 8, Steps: 10 | Train Loss: 2.654 Vali Loss: 3.222 Vali Acc: 0.093 Test Loss: 3.222 Test Acc: 0.093
Validation loss decreased (-0.077615 --> -0.092909).  Saving model ...
Epoch: 9 cost time: 0.8791408538818359
Epoch: 9, Steps: 10 | Train Loss: 2.517 Vali Loss: 3.210 Vali Acc: 0.119 Test Loss: 3.210 Test Acc: 0.119
Validation loss decreased (-0.092909 --> -0.118791).  Saving model ...
Epoch: 10 cost time: 0.8974156379699707
Epoch: 10, Steps: 10 | Train Loss: 2.349 Vali Loss: 3.201 Vali Acc: 0.126 Test Loss: 3.201 Test Acc: 0.126
Validation loss decreased (-0.118791 --> -0.125850).  Saving model ...
Epoch: 11 cost time: 0.8628890514373779
Epoch: 11, Steps: 10 | Train Loss: 2.190 Vali Loss: 3.187 Vali Acc: 0.144 Test Loss: 3.187 Test Acc: 0.144
Validation loss decreased (-0.125850 --> -0.143498).  Saving model ...
Epoch: 12 cost time: 0.8621127605438232
Epoch: 12, Steps: 10 | Train Loss: 2.009 Vali Loss: 3.166 Vali Acc: 0.152 Test Loss: 3.166 Test Acc: 0.152
Validation loss decreased (-0.143498 --> -0.151733).  Saving model ...
Epoch: 13 cost time: 0.8937633037567139
Epoch: 13, Steps: 10 | Train Loss: 1.811 Vali Loss: 3.156 Vali Acc: 0.166 Test Loss: 3.156 Test Acc: 0.166
Validation loss decreased (-0.151733 --> -0.165851).  Saving model ...
Epoch: 14 cost time: 0.8505659103393555
Epoch: 14, Steps: 10 | Train Loss: 1.606 Vali Loss: 3.155 Vali Acc: 0.181 Test Loss: 3.155 Test Acc: 0.181
Validation loss decreased (-0.165851 --> -0.181145).  Saving model ...
Epoch: 15 cost time: 0.8749103546142578
Epoch: 15, Steps: 10 | Train Loss: 1.397 Vali Loss: 3.156 Vali Acc: 0.199 Test Loss: 3.156 Test Acc: 0.199
Validation loss decreased (-0.181145 --> -0.198792).  Saving model ...
Epoch: 16 cost time: 0.740626335144043
Epoch: 16, Steps: 10 | Train Loss: 1.230 Vali Loss: 3.161 Vali Acc: 0.212 Test Loss: 3.161 Test Acc: 0.212
Validation loss decreased (-0.198792 --> -0.211733).  Saving model ...
Epoch: 17 cost time: 0.8639137744903564
Epoch: 17, Steps: 10 | Train Loss: 1.047 Vali Loss: 3.178 Vali Acc: 0.222 Test Loss: 3.178 Test Acc: 0.222
Validation loss decreased (-0.211733 --> -0.222321).  Saving model ...
Epoch: 18 cost time: 1.0223639011383057
Epoch: 18, Steps: 10 | Train Loss: 0.891 Vali Loss: 3.206 Vali Acc: 0.235 Test Loss: 3.206 Test Acc: 0.235
Validation loss decreased (-0.222321 --> -0.235262).  Saving model ...
Epoch: 19 cost time: 0.964073657989502
Epoch: 19, Steps: 10 | Train Loss: 0.700 Vali Loss: 3.251 Vali Acc: 0.241 Test Loss: 3.251 Test Acc: 0.241
Validation loss decreased (-0.235262 --> -0.241144).  Saving model ...
Epoch: 20 cost time: 0.8868691921234131
Epoch: 20, Steps: 10 | Train Loss: 0.556 Vali Loss: 3.301 Vali Acc: 0.246 Test Loss: 3.301 Test Acc: 0.246
Validation loss decreased (-0.241144 --> -0.245849).  Saving model ...
Epoch: 21 cost time: 0.8352799415588379
Epoch: 21, Steps: 10 | Train Loss: 0.454 Vali Loss: 3.356 Vali Acc: 0.251 Test Loss: 3.356 Test Acc: 0.251
Validation loss decreased (-0.245849 --> -0.250555).  Saving model ...
Epoch: 22 cost time: 0.8697140216827393
Epoch: 22, Steps: 10 | Train Loss: 0.357 Vali Loss: 3.403 Vali Acc: 0.258 Test Loss: 3.403 Test Acc: 0.258
Validation loss decreased (-0.250555 --> -0.257613).  Saving model ...
Epoch: 23 cost time: 0.8254377841949463
Epoch: 23, Steps: 10 | Train Loss: 0.268 Vali Loss: 3.475 Vali Acc: 0.264 Test Loss: 3.475 Test Acc: 0.264
Validation loss decreased (-0.257613 --> -0.263495).  Saving model ...
Epoch: 24 cost time: 0.8360309600830078
Epoch: 24, Steps: 10 | Train Loss: 0.211 Vali Loss: 3.532 Vali Acc: 0.265 Test Loss: 3.532 Test Acc: 0.265
Validation loss decreased (-0.263495 --> -0.264671).  Saving model ...
Epoch: 25 cost time: 0.8865876197814941
Epoch: 25, Steps: 10 | Train Loss: 0.176 Vali Loss: 3.576 Vali Acc: 0.266 Test Loss: 3.576 Test Acc: 0.266
Validation loss decreased (-0.264671 --> -0.265847).  Saving model ...
Epoch: 26 cost time: 0.7985098361968994
Epoch: 26, Steps: 10 | Train Loss: 0.158 Vali Loss: 3.639 Vali Acc: 0.268 Test Loss: 3.639 Test Acc: 0.268
Validation loss decreased (-0.265847 --> -0.268199).  Saving model ...
Epoch: 27 cost time: 0.7515692710876465
Epoch: 27, Steps: 10 | Train Loss: 0.116 Vali Loss: 3.700 Vali Acc: 0.268 Test Loss: 3.700 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7455987930297852
Epoch: 28, Steps: 10 | Train Loss: 0.099 Vali Loss: 3.744 Vali Acc: 0.269 Test Loss: 3.744 Test Acc: 0.269
Validation loss decreased (-0.268199 --> -0.269374).  Saving model ...
Epoch: 29 cost time: 0.9112787246704102
Epoch: 29, Steps: 10 | Train Loss: 0.082 Vali Loss: 3.780 Vali Acc: 0.275 Test Loss: 3.780 Test Acc: 0.275
Validation loss decreased (-0.269374 --> -0.275256).  Saving model ...
Epoch: 30 cost time: 0.8913919925689697
Epoch: 30, Steps: 10 | Train Loss: 0.073 Vali Loss: 3.806 Vali Acc: 0.279 Test Loss: 3.806 Test Acc: 0.279
Validation loss decreased (-0.275256 --> -0.278785).  Saving model ...
Epoch: 31 cost time: 0.8455719947814941
Epoch: 31, Steps: 10 | Train Loss: 0.068 Vali Loss: 3.842 Vali Acc: 0.281 Test Loss: 3.842 Test Acc: 0.281
Validation loss decreased (-0.278785 --> -0.281138).  Saving model ...
Epoch: 32 cost time: 0.8920791149139404
Epoch: 32, Steps: 10 | Train Loss: 0.057 Vali Loss: 3.881 Vali Acc: 0.278 Test Loss: 3.881 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.9624109268188477
Epoch: 33, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.920 Vali Acc: 0.282 Test Loss: 3.920 Test Acc: 0.282
Validation loss decreased (-0.281138 --> -0.282314).  Saving model ...
Epoch: 34 cost time: 0.886399507522583
Epoch: 34, Steps: 10 | Train Loss: 0.042 Vali Loss: 3.949 Vali Acc: 0.284 Test Loss: 3.949 Test Acc: 0.284
Validation loss decreased (-0.282314 --> -0.283490).  Saving model ...
Epoch: 35 cost time: 0.9162571430206299
Epoch: 35, Steps: 10 | Train Loss: 0.041 Vali Loss: 3.987 Vali Acc: 0.287 Test Loss: 3.987 Test Acc: 0.287
Validation loss decreased (-0.283490 --> -0.287019).  Saving model ...
Epoch: 36 cost time: 0.8715121746063232
Epoch: 36, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.015 Vali Acc: 0.286 Test Loss: 4.015 Test Acc: 0.286
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.8554301261901855
Epoch: 37, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.051 Vali Acc: 0.289 Test Loss: 4.051 Test Acc: 0.289
Validation loss decreased (-0.287019 --> -0.289371).  Saving model ...
Epoch: 38 cost time: 0.7568306922912598
Epoch: 38, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.079 Vali Acc: 0.287 Test Loss: 4.079 Test Acc: 0.287
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.8333601951599121
Epoch: 39, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.129 Vali Acc: 0.282 Test Loss: 4.129 Test Acc: 0.282
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.9023635387420654
Epoch: 40, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.163 Vali Acc: 0.284 Test Loss: 4.163 Test Acc: 0.284
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.9322504997253418
Epoch: 41, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.171 Vali Acc: 0.289 Test Loss: 4.171 Test Acc: 0.289
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.9776155948638916
Epoch: 42, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.184 Vali Acc: 0.289 Test Loss: 4.184 Test Acc: 0.289
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.8871407508850098
Epoch: 43, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.211 Vali Acc: 0.288 Test Loss: 4.211 Test Acc: 0.288
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.8173730373382568
Epoch: 44, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.221 Vali Acc: 0.285 Test Loss: 4.221 Test Acc: 0.285
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.8909964561462402
Epoch: 45, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.250 Vali Acc: 0.284 Test Loss: 4.250 Test Acc: 0.284
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.9538578987121582
Epoch: 46, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.263 Vali Acc: 0.285 Test Loss: 4.263 Test Acc: 0.285
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.8267273902893066
Epoch: 47, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.293 Vali Acc: 0.285 Test Loss: 4.293 Test Acc: 0.285
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.28941176470588237
model parameter : 126778
model size : 0.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps23_str12_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.6063990592956543
Epoch: 1, Steps: 10 | Train Loss: 3.276 Vali Loss: 3.271 Vali Acc: 0.049 Test Loss: 3.271 Test Acc: 0.049
Validation loss decreased (inf --> -0.049379).  Saving model ...
Epoch: 2 cost time: 0.8209888935089111
Epoch: 2, Steps: 10 | Train Loss: 3.250 Vali Loss: 3.268 Vali Acc: 0.055 Test Loss: 3.268 Test Acc: 0.055
Validation loss decreased (-0.049379 --> -0.055261).  Saving model ...
Epoch: 3 cost time: 0.8619241714477539
Epoch: 3, Steps: 10 | Train Loss: 3.198 Vali Loss: 3.263 Vali Acc: 0.065 Test Loss: 3.263 Test Acc: 0.065
Validation loss decreased (-0.055261 --> -0.064673).  Saving model ...
Epoch: 4 cost time: 0.8620789051055908
Epoch: 4, Steps: 10 | Train Loss: 3.145 Vali Loss: 3.257 Vali Acc: 0.071 Test Loss: 3.257 Test Acc: 0.071
Validation loss decreased (-0.064673 --> -0.070556).  Saving model ...
Epoch: 5 cost time: 0.8215258121490479
Epoch: 5, Steps: 10 | Train Loss: 3.072 Vali Loss: 3.253 Vali Acc: 0.074 Test Loss: 3.253 Test Acc: 0.074
Validation loss decreased (-0.070556 --> -0.074085).  Saving model ...
Epoch: 6 cost time: 0.8809466361999512
Epoch: 6, Steps: 10 | Train Loss: 2.987 Vali Loss: 3.248 Vali Acc: 0.071 Test Loss: 3.248 Test Acc: 0.071
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.86454176902771
Epoch: 7, Steps: 10 | Train Loss: 2.895 Vali Loss: 3.245 Vali Acc: 0.082 Test Loss: 3.245 Test Acc: 0.082
Validation loss decreased (-0.074085 --> -0.082320).  Saving model ...
Epoch: 8 cost time: 0.8785560131072998
Epoch: 8, Steps: 10 | Train Loss: 2.803 Vali Loss: 3.243 Vali Acc: 0.091 Test Loss: 3.243 Test Acc: 0.091
Validation loss decreased (-0.082320 --> -0.090556).  Saving model ...
Epoch: 9 cost time: 0.8472487926483154
Epoch: 9, Steps: 10 | Train Loss: 2.702 Vali Loss: 3.238 Vali Acc: 0.108 Test Loss: 3.238 Test Acc: 0.108
Validation loss decreased (-0.090556 --> -0.108203).  Saving model ...
Epoch: 10 cost time: 0.8067812919616699
Epoch: 10, Steps: 10 | Train Loss: 2.609 Vali Loss: 3.233 Vali Acc: 0.108 Test Loss: 3.233 Test Acc: 0.108
Validation loss decreased (-0.108203 --> -0.108203).  Saving model ...
Epoch: 11 cost time: 0.8207247257232666
Epoch: 11, Steps: 10 | Train Loss: 2.517 Vali Loss: 3.230 Vali Acc: 0.118 Test Loss: 3.230 Test Acc: 0.118
Validation loss decreased (-0.108203 --> -0.117615).  Saving model ...
Epoch: 12 cost time: 0.8655703067779541
Epoch: 12, Steps: 10 | Train Loss: 2.368 Vali Loss: 3.223 Vali Acc: 0.120 Test Loss: 3.223 Test Acc: 0.120
Validation loss decreased (-0.117615 --> -0.119968).  Saving model ...
Epoch: 13 cost time: 0.9531230926513672
Epoch: 13, Steps: 10 | Train Loss: 2.239 Vali Loss: 3.216 Vali Acc: 0.127 Test Loss: 3.216 Test Acc: 0.127
Validation loss decreased (-0.119968 --> -0.127027).  Saving model ...
Epoch: 14 cost time: 0.8762171268463135
Epoch: 14, Steps: 10 | Train Loss: 2.106 Vali Loss: 3.214 Vali Acc: 0.132 Test Loss: 3.214 Test Acc: 0.132
Validation loss decreased (-0.127027 --> -0.131733).  Saving model ...
Epoch: 15 cost time: 0.8504352569580078
Epoch: 15, Steps: 10 | Train Loss: 1.963 Vali Loss: 3.213 Vali Acc: 0.144 Test Loss: 3.213 Test Acc: 0.144
Validation loss decreased (-0.131733 --> -0.143497).  Saving model ...
Epoch: 16 cost time: 0.9163389205932617
Epoch: 16, Steps: 10 | Train Loss: 1.784 Vali Loss: 3.212 Vali Acc: 0.151 Test Loss: 3.212 Test Acc: 0.151
Validation loss decreased (-0.143497 --> -0.150556).  Saving model ...
Epoch: 17 cost time: 0.8476085662841797
Epoch: 17, Steps: 10 | Train Loss: 1.621 Vali Loss: 3.217 Vali Acc: 0.165 Test Loss: 3.217 Test Acc: 0.165
Validation loss decreased (-0.150556 --> -0.164674).  Saving model ...
Epoch: 18 cost time: 0.9251658916473389
Epoch: 18, Steps: 10 | Train Loss: 1.466 Vali Loss: 3.227 Vali Acc: 0.178 Test Loss: 3.227 Test Acc: 0.178
Validation loss decreased (-0.164674 --> -0.177615).  Saving model ...
Epoch: 19 cost time: 0.9240901470184326
Epoch: 19, Steps: 10 | Train Loss: 1.326 Vali Loss: 3.244 Vali Acc: 0.187 Test Loss: 3.244 Test Acc: 0.187
Validation loss decreased (-0.177615 --> -0.187026).  Saving model ...
Epoch: 20 cost time: 0.8808972835540771
Epoch: 20, Steps: 10 | Train Loss: 1.167 Vali Loss: 3.263 Vali Acc: 0.195 Test Loss: 3.263 Test Acc: 0.195
Validation loss decreased (-0.187026 --> -0.195261).  Saving model ...
Epoch: 21 cost time: 0.8818371295928955
Epoch: 21, Steps: 10 | Train Loss: 1.043 Vali Loss: 3.297 Vali Acc: 0.200 Test Loss: 3.297 Test Acc: 0.200
Validation loss decreased (-0.195261 --> -0.199967).  Saving model ...
Epoch: 22 cost time: 0.8771071434020996
Epoch: 22, Steps: 10 | Train Loss: 0.916 Vali Loss: 3.334 Vali Acc: 0.208 Test Loss: 3.334 Test Acc: 0.208
Validation loss decreased (-0.199967 --> -0.208202).  Saving model ...
Epoch: 23 cost time: 0.8557703495025635
Epoch: 23, Steps: 10 | Train Loss: 0.794 Vali Loss: 3.382 Vali Acc: 0.209 Test Loss: 3.382 Test Acc: 0.209
Validation loss decreased (-0.208202 --> -0.209378).  Saving model ...
Epoch: 24 cost time: 0.8664226531982422
Epoch: 24, Steps: 10 | Train Loss: 0.674 Vali Loss: 3.416 Vali Acc: 0.219 Test Loss: 3.416 Test Acc: 0.219
Validation loss decreased (-0.209378 --> -0.218789).  Saving model ...
Epoch: 25 cost time: 0.7336013317108154
Epoch: 25, Steps: 10 | Train Loss: 0.560 Vali Loss: 3.475 Vali Acc: 0.224 Test Loss: 3.475 Test Acc: 0.224
Validation loss decreased (-0.218789 --> -0.223495).  Saving model ...
Epoch: 26 cost time: 0.8554370403289795
Epoch: 26, Steps: 10 | Train Loss: 0.480 Vali Loss: 3.543 Vali Acc: 0.222 Test Loss: 3.543 Test Acc: 0.222
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8306386470794678
Epoch: 27, Steps: 10 | Train Loss: 0.389 Vali Loss: 3.594 Vali Acc: 0.228 Test Loss: 3.594 Test Acc: 0.228
Validation loss decreased (-0.223495 --> -0.228199).  Saving model ...
Epoch: 28 cost time: 0.8674278259277344
Epoch: 28, Steps: 10 | Train Loss: 0.335 Vali Loss: 3.640 Vali Acc: 0.231 Test Loss: 3.640 Test Acc: 0.231
Validation loss decreased (-0.228199 --> -0.230552).  Saving model ...
Epoch: 29 cost time: 0.8532195091247559
Epoch: 29, Steps: 10 | Train Loss: 0.282 Vali Loss: 3.686 Vali Acc: 0.233 Test Loss: 3.686 Test Acc: 0.233
Validation loss decreased (-0.230552 --> -0.232904).  Saving model ...
Epoch: 30 cost time: 0.7973346710205078
Epoch: 30, Steps: 10 | Train Loss: 0.238 Vali Loss: 3.760 Vali Acc: 0.226 Test Loss: 3.760 Test Acc: 0.226
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8253555297851562
Epoch: 31, Steps: 10 | Train Loss: 0.204 Vali Loss: 3.826 Vali Acc: 0.225 Test Loss: 3.826 Test Acc: 0.225
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.8604748249053955
Epoch: 32, Steps: 10 | Train Loss: 0.170 Vali Loss: 3.879 Vali Acc: 0.238 Test Loss: 3.879 Test Acc: 0.238
Validation loss decreased (-0.232904 --> -0.237608).  Saving model ...
Epoch: 33 cost time: 0.9381334781646729
Epoch: 33, Steps: 10 | Train Loss: 0.157 Vali Loss: 3.935 Vali Acc: 0.236 Test Loss: 3.935 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.943251371383667
Epoch: 34, Steps: 10 | Train Loss: 0.131 Vali Loss: 3.974 Vali Acc: 0.239 Test Loss: 3.974 Test Acc: 0.239
Validation loss decreased (-0.237608 --> -0.238784).  Saving model ...
Epoch: 35 cost time: 0.8695583343505859
Epoch: 35, Steps: 10 | Train Loss: 0.113 Vali Loss: 3.998 Vali Acc: 0.239 Test Loss: 3.998 Test Acc: 0.239
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.8738915920257568
Epoch: 36, Steps: 10 | Train Loss: 0.100 Vali Loss: 4.025 Vali Acc: 0.244 Test Loss: 4.025 Test Acc: 0.244
Validation loss decreased (-0.238784 --> -0.243489).  Saving model ...
Epoch: 37 cost time: 0.9375672340393066
Epoch: 37, Steps: 10 | Train Loss: 0.085 Vali Loss: 4.073 Vali Acc: 0.246 Test Loss: 4.073 Test Acc: 0.246
Validation loss decreased (-0.243489 --> -0.245842).  Saving model ...
Epoch: 38 cost time: 0.9357006549835205
Epoch: 38, Steps: 10 | Train Loss: 0.080 Vali Loss: 4.107 Vali Acc: 0.241 Test Loss: 4.107 Test Acc: 0.241
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.9310297966003418
Epoch: 39, Steps: 10 | Train Loss: 0.073 Vali Loss: 4.161 Vali Acc: 0.240 Test Loss: 4.161 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.8519384860992432
Epoch: 40, Steps: 10 | Train Loss: 0.061 Vali Loss: 4.195 Vali Acc: 0.240 Test Loss: 4.195 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.8241977691650391
Epoch: 41, Steps: 10 | Train Loss: 0.059 Vali Loss: 4.216 Vali Acc: 0.242 Test Loss: 4.216 Test Acc: 0.242
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.7937793731689453
Epoch: 42, Steps: 10 | Train Loss: 0.056 Vali Loss: 4.249 Vali Acc: 0.246 Test Loss: 4.249 Test Acc: 0.246
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.8767974376678467
Epoch: 43, Steps: 10 | Train Loss: 0.046 Vali Loss: 4.273 Vali Acc: 0.247 Test Loss: 4.273 Test Acc: 0.247
Validation loss decreased (-0.245842 --> -0.247016).  Saving model ...
Epoch: 44 cost time: 0.8831961154937744
Epoch: 44, Steps: 10 | Train Loss: 0.041 Vali Loss: 4.304 Vali Acc: 0.246 Test Loss: 4.304 Test Acc: 0.246
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.8976035118103027
Epoch: 45, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.351 Vali Acc: 0.248 Test Loss: 4.351 Test Acc: 0.248
Validation loss decreased (-0.247016 --> -0.248192).  Saving model ...
Epoch: 46 cost time: 0.8085548877716064
Epoch: 46, Steps: 10 | Train Loss: 0.037 Vali Loss: 4.377 Vali Acc: 0.246 Test Loss: 4.377 Test Acc: 0.246
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.9499363899230957
Epoch: 47, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.405 Vali Acc: 0.246 Test Loss: 4.405 Test Acc: 0.246
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.890244722366333
Epoch: 48, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.422 Vali Acc: 0.247 Test Loss: 4.422 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.919933557510376
Epoch: 49, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.436 Vali Acc: 0.247 Test Loss: 4.436 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.9138689041137695
Epoch: 50, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.467 Vali Acc: 0.252 Test Loss: 4.467 Test Acc: 0.252
Validation loss decreased (-0.248192 --> -0.251720).  Saving model ...
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps23_str12_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.25176470588235295
model parameter : 107034
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.3019795417785645
Epoch: 1, Steps: 10 | Train Loss: 3.304 Vali Loss: 3.266 Vali Acc: 0.039 Test Loss: 3.266 Test Acc: 0.039
Validation loss decreased (inf --> -0.038791).  Saving model ...
Epoch: 2 cost time: 0.8479466438293457
Epoch: 2, Steps: 10 | Train Loss: 3.268 Vali Loss: 3.264 Vali Acc: 0.033 Test Loss: 3.264 Test Acc: 0.033
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8783507347106934
Epoch: 3, Steps: 10 | Train Loss: 3.202 Vali Loss: 3.258 Vali Acc: 0.046 Test Loss: 3.258 Test Acc: 0.046
Validation loss decreased (-0.038791 --> -0.045850).  Saving model ...
Epoch: 4 cost time: 0.9465351104736328
Epoch: 4, Steps: 10 | Train Loss: 3.163 Vali Loss: 3.252 Vali Acc: 0.047 Test Loss: 3.252 Test Acc: 0.047
Validation loss decreased (-0.045850 --> -0.047026).  Saving model ...
Epoch: 5 cost time: 0.8952326774597168
Epoch: 5, Steps: 10 | Train Loss: 3.128 Vali Loss: 3.245 Vali Acc: 0.052 Test Loss: 3.245 Test Acc: 0.052
Validation loss decreased (-0.047026 --> -0.051732).  Saving model ...
Epoch: 6 cost time: 0.8499503135681152
Epoch: 6, Steps: 10 | Train Loss: 3.030 Vali Loss: 3.238 Vali Acc: 0.055 Test Loss: 3.238 Test Acc: 0.055
Validation loss decreased (-0.051732 --> -0.055262).  Saving model ...
Epoch: 7 cost time: 0.8614723682403564
Epoch: 7, Steps: 10 | Train Loss: 2.981 Vali Loss: 3.233 Vali Acc: 0.068 Test Loss: 3.233 Test Acc: 0.068
Validation loss decreased (-0.055262 --> -0.068203).  Saving model ...
Epoch: 8 cost time: 0.8746240139007568
Epoch: 8, Steps: 10 | Train Loss: 2.906 Vali Loss: 3.231 Vali Acc: 0.072 Test Loss: 3.231 Test Acc: 0.072
Validation loss decreased (-0.068203 --> -0.071732).  Saving model ...
Epoch: 9 cost time: 0.9587273597717285
Epoch: 9, Steps: 10 | Train Loss: 2.798 Vali Loss: 3.226 Vali Acc: 0.076 Test Loss: 3.226 Test Acc: 0.076
Validation loss decreased (-0.071732 --> -0.076438).  Saving model ...
Epoch: 10 cost time: 0.8799691200256348
Epoch: 10, Steps: 10 | Train Loss: 2.738 Vali Loss: 3.222 Vali Acc: 0.087 Test Loss: 3.222 Test Acc: 0.087
Validation loss decreased (-0.076438 --> -0.087027).  Saving model ...
Epoch: 11 cost time: 0.8505568504333496
Epoch: 11, Steps: 10 | Train Loss: 2.611 Vali Loss: 3.218 Vali Acc: 0.094 Test Loss: 3.218 Test Acc: 0.094
Validation loss decreased (-0.087027 --> -0.094085).  Saving model ...
Epoch: 12 cost time: 0.8280625343322754
Epoch: 12, Steps: 10 | Train Loss: 2.538 Vali Loss: 3.214 Vali Acc: 0.105 Test Loss: 3.214 Test Acc: 0.105
Validation loss decreased (-0.094085 --> -0.104674).  Saving model ...
Epoch: 13 cost time: 0.7898409366607666
Epoch: 13, Steps: 10 | Train Loss: 2.436 Vali Loss: 3.209 Vali Acc: 0.116 Test Loss: 3.209 Test Acc: 0.116
Validation loss decreased (-0.104674 --> -0.116438).  Saving model ...
Epoch: 14 cost time: 0.8924839496612549
Epoch: 14, Steps: 10 | Train Loss: 2.322 Vali Loss: 3.207 Vali Acc: 0.124 Test Loss: 3.207 Test Acc: 0.124
Validation loss decreased (-0.116438 --> -0.123497).  Saving model ...
Epoch: 15 cost time: 0.9378659725189209
Epoch: 15, Steps: 10 | Train Loss: 2.222 Vali Loss: 3.206 Vali Acc: 0.132 Test Loss: 3.206 Test Acc: 0.132
Validation loss decreased (-0.123497 --> -0.131733).  Saving model ...
Epoch: 16 cost time: 0.9159317016601562
Epoch: 16, Steps: 10 | Train Loss: 2.078 Vali Loss: 3.200 Vali Acc: 0.144 Test Loss: 3.200 Test Acc: 0.144
Validation loss decreased (-0.131733 --> -0.143497).  Saving model ...
Epoch: 17 cost time: 0.9121255874633789
Epoch: 17, Steps: 10 | Train Loss: 1.907 Vali Loss: 3.195 Vali Acc: 0.155 Test Loss: 3.195 Test Acc: 0.155
Validation loss decreased (-0.143497 --> -0.155262).  Saving model ...
Epoch: 18 cost time: 0.9813816547393799
Epoch: 18, Steps: 10 | Train Loss: 1.784 Vali Loss: 3.194 Vali Acc: 0.160 Test Loss: 3.194 Test Acc: 0.160
Validation loss decreased (-0.155262 --> -0.159968).  Saving model ...
Epoch: 19 cost time: 0.8300144672393799
Epoch: 19, Steps: 10 | Train Loss: 1.643 Vali Loss: 3.197 Vali Acc: 0.164 Test Loss: 3.197 Test Acc: 0.164
Validation loss decreased (-0.159968 --> -0.163497).  Saving model ...
Epoch: 20 cost time: 0.9118132591247559
Epoch: 20, Steps: 10 | Train Loss: 1.500 Vali Loss: 3.207 Vali Acc: 0.173 Test Loss: 3.207 Test Acc: 0.173
Validation loss decreased (-0.163497 --> -0.172909).  Saving model ...
Epoch: 21 cost time: 0.9063818454742432
Epoch: 21, Steps: 10 | Train Loss: 1.348 Vali Loss: 3.226 Vali Acc: 0.174 Test Loss: 3.226 Test Acc: 0.174
Validation loss decreased (-0.172909 --> -0.174085).  Saving model ...
Epoch: 22 cost time: 0.9845240116119385
Epoch: 22, Steps: 10 | Train Loss: 1.200 Vali Loss: 3.237 Vali Acc: 0.182 Test Loss: 3.237 Test Acc: 0.182
Validation loss decreased (-0.174085 --> -0.182321).  Saving model ...
Epoch: 23 cost time: 0.8302063941955566
Epoch: 23, Steps: 10 | Train Loss: 1.042 Vali Loss: 3.256 Vali Acc: 0.189 Test Loss: 3.256 Test Acc: 0.189
Validation loss decreased (-0.182321 --> -0.189379).  Saving model ...
Epoch: 24 cost time: 0.9551043510437012
Epoch: 24, Steps: 10 | Train Loss: 0.930 Vali Loss: 3.281 Vali Acc: 0.193 Test Loss: 3.281 Test Acc: 0.193
Validation loss decreased (-0.189379 --> -0.192908).  Saving model ...
Epoch: 25 cost time: 0.8791530132293701
Epoch: 25, Steps: 10 | Train Loss: 0.808 Vali Loss: 3.314 Vali Acc: 0.196 Test Loss: 3.314 Test Acc: 0.196
Validation loss decreased (-0.192908 --> -0.196437).  Saving model ...
Epoch: 26 cost time: 0.8354697227478027
Epoch: 26, Steps: 10 | Train Loss: 0.724 Vali Loss: 3.350 Vali Acc: 0.198 Test Loss: 3.350 Test Acc: 0.198
Validation loss decreased (-0.196437 --> -0.197614).  Saving model ...
Epoch: 27 cost time: 0.8858394622802734
Epoch: 27, Steps: 10 | Train Loss: 0.602 Vali Loss: 3.392 Vali Acc: 0.199 Test Loss: 3.392 Test Acc: 0.199
Validation loss decreased (-0.197614 --> -0.198790).  Saving model ...
Epoch: 28 cost time: 0.8269016742706299
Epoch: 28, Steps: 10 | Train Loss: 0.518 Vali Loss: 3.439 Vali Acc: 0.207 Test Loss: 3.439 Test Acc: 0.207
Validation loss decreased (-0.198790 --> -0.207024).  Saving model ...
Epoch: 29 cost time: 0.764704704284668
Epoch: 29, Steps: 10 | Train Loss: 0.452 Vali Loss: 3.471 Vali Acc: 0.208 Test Loss: 3.471 Test Acc: 0.208
Validation loss decreased (-0.207024 --> -0.208201).  Saving model ...
Epoch: 30 cost time: 0.7534112930297852
Epoch: 30, Steps: 10 | Train Loss: 0.385 Vali Loss: 3.516 Vali Acc: 0.224 Test Loss: 3.516 Test Acc: 0.224
Validation loss decreased (-0.208201 --> -0.223494).  Saving model ...
Epoch: 31 cost time: 0.8731105327606201
Epoch: 31, Steps: 10 | Train Loss: 0.343 Vali Loss: 3.564 Vali Acc: 0.221 Test Loss: 3.564 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.9311127662658691
Epoch: 32, Steps: 10 | Train Loss: 0.282 Vali Loss: 3.623 Vali Acc: 0.218 Test Loss: 3.623 Test Acc: 0.218
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.9051399230957031
Epoch: 33, Steps: 10 | Train Loss: 0.253 Vali Loss: 3.660 Vali Acc: 0.226 Test Loss: 3.660 Test Acc: 0.226
Validation loss decreased (-0.223494 --> -0.225846).  Saving model ...
Epoch: 34 cost time: 0.9124417304992676
Epoch: 34, Steps: 10 | Train Loss: 0.215 Vali Loss: 3.703 Vali Acc: 0.226 Test Loss: 3.703 Test Acc: 0.226
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.8414313793182373
Epoch: 35, Steps: 10 | Train Loss: 0.198 Vali Loss: 3.758 Vali Acc: 0.222 Test Loss: 3.758 Test Acc: 0.222
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.8539597988128662
Epoch: 36, Steps: 10 | Train Loss: 0.170 Vali Loss: 3.812 Vali Acc: 0.225 Test Loss: 3.812 Test Acc: 0.225
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.8319377899169922
Epoch: 37, Steps: 10 | Train Loss: 0.134 Vali Loss: 3.834 Vali Acc: 0.236 Test Loss: 3.834 Test Acc: 0.236
Validation loss decreased (-0.225846 --> -0.236432).  Saving model ...
Epoch: 38 cost time: 0.8201584815979004
Epoch: 38, Steps: 10 | Train Loss: 0.134 Vali Loss: 3.892 Vali Acc: 0.234 Test Loss: 3.892 Test Acc: 0.234
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.8975744247436523
Epoch: 39, Steps: 10 | Train Loss: 0.121 Vali Loss: 3.925 Vali Acc: 0.245 Test Loss: 3.925 Test Acc: 0.245
Validation loss decreased (-0.236432 --> -0.244667).  Saving model ...
Epoch: 40 cost time: 0.8049588203430176
Epoch: 40, Steps: 10 | Train Loss: 0.103 Vali Loss: 3.960 Vali Acc: 0.240 Test Loss: 3.960 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.8872241973876953
Epoch: 41, Steps: 10 | Train Loss: 0.094 Vali Loss: 4.000 Vali Acc: 0.241 Test Loss: 4.000 Test Acc: 0.241
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.9661691188812256
Epoch: 42, Steps: 10 | Train Loss: 0.077 Vali Loss: 4.017 Vali Acc: 0.245 Test Loss: 4.017 Test Acc: 0.245
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.9203383922576904
Epoch: 43, Steps: 10 | Train Loss: 0.083 Vali Loss: 4.054 Vali Acc: 0.245 Test Loss: 4.054 Test Acc: 0.245
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.936389684677124
Epoch: 44, Steps: 10 | Train Loss: 0.072 Vali Loss: 4.114 Vali Acc: 0.233 Test Loss: 4.114 Test Acc: 0.233
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.8883888721466064
Epoch: 45, Steps: 10 | Train Loss: 0.058 Vali Loss: 4.128 Vali Acc: 0.239 Test Loss: 4.128 Test Acc: 0.239
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.7871630191802979
Epoch: 46, Steps: 10 | Train Loss: 0.051 Vali Loss: 4.162 Vali Acc: 0.242 Test Loss: 4.162 Test Acc: 0.242
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.849571704864502
Epoch: 47, Steps: 10 | Train Loss: 0.050 Vali Loss: 4.171 Vali Acc: 0.242 Test Loss: 4.171 Test Acc: 0.242
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 0.8805530071258545
Epoch: 48, Steps: 10 | Train Loss: 0.046 Vali Loss: 4.211 Vali Acc: 0.244 Test Loss: 4.211 Test Acc: 0.244
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 0.8573238849639893
Epoch: 49, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.250 Vali Acc: 0.239 Test Loss: 4.250 Test Acc: 0.239
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2447058823529412
model parameter : 102298
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps38_str19_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.5458920001983643
Epoch: 1, Steps: 10 | Train Loss: 3.279 Vali Loss: 3.272 Vali Acc: 0.035 Test Loss: 3.272 Test Acc: 0.035
Validation loss decreased (inf --> -0.035261).  Saving model ...
Epoch: 2 cost time: 0.8083908557891846
Epoch: 2, Steps: 10 | Train Loss: 3.278 Vali Loss: 3.271 Vali Acc: 0.044 Test Loss: 3.271 Test Acc: 0.044
Validation loss decreased (-0.035261 --> -0.043497).  Saving model ...
Epoch: 3 cost time: 0.8450422286987305
Epoch: 3, Steps: 10 | Train Loss: 3.235 Vali Loss: 3.265 Vali Acc: 0.048 Test Loss: 3.265 Test Acc: 0.048
Validation loss decreased (-0.043497 --> -0.048203).  Saving model ...
Epoch: 4 cost time: 0.8302078247070312
Epoch: 4, Steps: 10 | Train Loss: 3.197 Vali Loss: 3.259 Vali Acc: 0.058 Test Loss: 3.259 Test Acc: 0.058
Validation loss decreased (-0.048203 --> -0.057614).  Saving model ...
Epoch: 5 cost time: 0.8692669868469238
Epoch: 5, Steps: 10 | Train Loss: 3.160 Vali Loss: 3.252 Vali Acc: 0.064 Test Loss: 3.252 Test Acc: 0.064
Validation loss decreased (-0.057614 --> -0.063497).  Saving model ...
Epoch: 6 cost time: 0.8761076927185059
Epoch: 6, Steps: 10 | Train Loss: 3.086 Vali Loss: 3.244 Vali Acc: 0.079 Test Loss: 3.244 Test Acc: 0.079
Validation loss decreased (-0.063497 --> -0.078791).  Saving model ...
Epoch: 7 cost time: 0.8359971046447754
Epoch: 7, Steps: 10 | Train Loss: 3.028 Vali Loss: 3.237 Vali Acc: 0.080 Test Loss: 3.237 Test Acc: 0.080
Validation loss decreased (-0.078791 --> -0.079968).  Saving model ...
Epoch: 8 cost time: 0.7667539119720459
Epoch: 8, Steps: 10 | Train Loss: 2.957 Vali Loss: 3.231 Vali Acc: 0.085 Test Loss: 3.231 Test Acc: 0.085
Validation loss decreased (-0.079968 --> -0.084674).  Saving model ...
Epoch: 9 cost time: 0.7919166088104248
Epoch: 9, Steps: 10 | Train Loss: 2.886 Vali Loss: 3.225 Vali Acc: 0.088 Test Loss: 3.225 Test Acc: 0.088
Validation loss decreased (-0.084674 --> -0.088203).  Saving model ...
Epoch: 10 cost time: 0.8255562782287598
Epoch: 10, Steps: 10 | Train Loss: 2.854 Vali Loss: 3.220 Vali Acc: 0.100 Test Loss: 3.220 Test Acc: 0.100
Validation loss decreased (-0.088203 --> -0.099968).  Saving model ...
Epoch: 11 cost time: 0.8570890426635742
Epoch: 11, Steps: 10 | Train Loss: 2.745 Vali Loss: 3.212 Vali Acc: 0.100 Test Loss: 3.212 Test Acc: 0.100
Validation loss decreased (-0.099968 --> -0.099968).  Saving model ...
Epoch: 12 cost time: 0.815098762512207
Epoch: 12, Steps: 10 | Train Loss: 2.657 Vali Loss: 3.205 Vali Acc: 0.099 Test Loss: 3.205 Test Acc: 0.099
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8971076011657715
Epoch: 13, Steps: 10 | Train Loss: 2.567 Vali Loss: 3.200 Vali Acc: 0.107 Test Loss: 3.200 Test Acc: 0.107
Validation loss decreased (-0.099968 --> -0.107027).  Saving model ...
Epoch: 14 cost time: 1.0299625396728516
Epoch: 14, Steps: 10 | Train Loss: 2.471 Vali Loss: 3.192 Vali Acc: 0.126 Test Loss: 3.192 Test Acc: 0.126
Validation loss decreased (-0.107027 --> -0.125850).  Saving model ...
Epoch: 15 cost time: 1.0112965106964111
Epoch: 15, Steps: 10 | Train Loss: 2.397 Vali Loss: 3.188 Vali Acc: 0.128 Test Loss: 3.188 Test Acc: 0.128
Validation loss decreased (-0.125850 --> -0.128203).  Saving model ...
Epoch: 16 cost time: 0.8708055019378662
Epoch: 16, Steps: 10 | Train Loss: 2.246 Vali Loss: 3.181 Vali Acc: 0.136 Test Loss: 3.181 Test Acc: 0.136
Validation loss decreased (-0.128203 --> -0.136439).  Saving model ...
Epoch: 17 cost time: 0.804940938949585
Epoch: 17, Steps: 10 | Train Loss: 2.097 Vali Loss: 3.176 Vali Acc: 0.138 Test Loss: 3.176 Test Acc: 0.138
Validation loss decreased (-0.136439 --> -0.137615).  Saving model ...
Epoch: 18 cost time: 1.0509469509124756
Epoch: 18, Steps: 10 | Train Loss: 1.996 Vali Loss: 3.175 Vali Acc: 0.149 Test Loss: 3.175 Test Acc: 0.149
Validation loss decreased (-0.137615 --> -0.149380).  Saving model ...
Epoch: 19 cost time: 1.0295264720916748
Epoch: 19, Steps: 10 | Train Loss: 1.885 Vali Loss: 3.175 Vali Acc: 0.153 Test Loss: 3.175 Test Acc: 0.153
Validation loss decreased (-0.149380 --> -0.152909).  Saving model ...
Epoch: 20 cost time: 1.0313551425933838
Epoch: 20, Steps: 10 | Train Loss: 1.693 Vali Loss: 3.172 Vali Acc: 0.166 Test Loss: 3.172 Test Acc: 0.166
Validation loss decreased (-0.152909 --> -0.165851).  Saving model ...
Epoch: 21 cost time: 0.8623971939086914
Epoch: 21, Steps: 10 | Train Loss: 1.603 Vali Loss: 3.177 Vali Acc: 0.173 Test Loss: 3.177 Test Acc: 0.173
Validation loss decreased (-0.165851 --> -0.172909).  Saving model ...
Epoch: 22 cost time: 0.9187667369842529
Epoch: 22, Steps: 10 | Train Loss: 1.444 Vali Loss: 3.185 Vali Acc: 0.186 Test Loss: 3.185 Test Acc: 0.186
Validation loss decreased (-0.172909 --> -0.185851).  Saving model ...
Epoch: 23 cost time: 0.9611160755157471
Epoch: 23, Steps: 10 | Train Loss: 1.288 Vali Loss: 3.201 Vali Acc: 0.193 Test Loss: 3.201 Test Acc: 0.193
Validation loss decreased (-0.185851 --> -0.192909).  Saving model ...
Epoch: 24 cost time: 0.9405694007873535
Epoch: 24, Steps: 10 | Train Loss: 1.154 Vali Loss: 3.220 Vali Acc: 0.195 Test Loss: 3.220 Test Acc: 0.195
Validation loss decreased (-0.192909 --> -0.195262).  Saving model ...
Epoch: 25 cost time: 0.9355473518371582
Epoch: 25, Steps: 10 | Train Loss: 1.048 Vali Loss: 3.251 Vali Acc: 0.200 Test Loss: 3.251 Test Acc: 0.200
Validation loss decreased (-0.195262 --> -0.199967).  Saving model ...
Epoch: 26 cost time: 0.7974357604980469
Epoch: 26, Steps: 10 | Train Loss: 0.917 Vali Loss: 3.276 Vali Acc: 0.204 Test Loss: 3.276 Test Acc: 0.204
Validation loss decreased (-0.199967 --> -0.203497).  Saving model ...
Epoch: 27 cost time: 0.8576984405517578
Epoch: 27, Steps: 10 | Train Loss: 0.810 Vali Loss: 3.287 Vali Acc: 0.206 Test Loss: 3.287 Test Acc: 0.206
Validation loss decreased (-0.203497 --> -0.205849).  Saving model ...
Epoch: 28 cost time: 0.9197425842285156
Epoch: 28, Steps: 10 | Train Loss: 0.743 Vali Loss: 3.317 Vali Acc: 0.218 Test Loss: 3.317 Test Acc: 0.218
Validation loss decreased (-0.205849 --> -0.217614).  Saving model ...
Epoch: 29 cost time: 0.9388267993927002
Epoch: 29, Steps: 10 | Train Loss: 0.621 Vali Loss: 3.365 Vali Acc: 0.228 Test Loss: 3.365 Test Acc: 0.228
Validation loss decreased (-0.217614 --> -0.228202).  Saving model ...
Epoch: 30 cost time: 0.9555201530456543
Epoch: 30, Steps: 10 | Train Loss: 0.542 Vali Loss: 3.405 Vali Acc: 0.232 Test Loss: 3.405 Test Acc: 0.232
Validation loss decreased (-0.228202 --> -0.231731).  Saving model ...
Epoch: 31 cost time: 0.9695432186126709
Epoch: 31, Steps: 10 | Train Loss: 0.462 Vali Loss: 3.450 Vali Acc: 0.229 Test Loss: 3.450 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.9387381076812744
Epoch: 32, Steps: 10 | Train Loss: 0.381 Vali Loss: 3.488 Vali Acc: 0.232 Test Loss: 3.488 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.8750901222229004
Epoch: 33, Steps: 10 | Train Loss: 0.364 Vali Loss: 3.550 Vali Acc: 0.241 Test Loss: 3.550 Test Acc: 0.241
Validation loss decreased (-0.231731 --> -0.241141).  Saving model ...
Epoch: 34 cost time: 0.9606466293334961
Epoch: 34, Steps: 10 | Train Loss: 0.276 Vali Loss: 3.572 Vali Acc: 0.245 Test Loss: 3.572 Test Acc: 0.245
Validation loss decreased (-0.241141 --> -0.244670).  Saving model ...
Epoch: 35 cost time: 0.9183900356292725
Epoch: 35, Steps: 10 | Train Loss: 0.246 Vali Loss: 3.632 Vali Acc: 0.242 Test Loss: 3.632 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.9522435665130615
Epoch: 36, Steps: 10 | Train Loss: 0.231 Vali Loss: 3.711 Vali Acc: 0.241 Test Loss: 3.711 Test Acc: 0.241
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.967942476272583
Epoch: 37, Steps: 10 | Train Loss: 0.217 Vali Loss: 3.748 Vali Acc: 0.246 Test Loss: 3.748 Test Acc: 0.246
Validation loss decreased (-0.244670 --> -0.245845).  Saving model ...
Epoch: 38 cost time: 0.9044432640075684
Epoch: 38, Steps: 10 | Train Loss: 0.171 Vali Loss: 3.786 Vali Acc: 0.239 Test Loss: 3.786 Test Acc: 0.239
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.951484203338623
Epoch: 39, Steps: 10 | Train Loss: 0.151 Vali Loss: 3.810 Vali Acc: 0.244 Test Loss: 3.810 Test Acc: 0.244
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.0490458011627197
Epoch: 40, Steps: 10 | Train Loss: 0.131 Vali Loss: 3.850 Vali Acc: 0.247 Test Loss: 3.850 Test Acc: 0.247
Validation loss decreased (-0.245845 --> -0.247020).  Saving model ...
Epoch: 41 cost time: 0.9919118881225586
Epoch: 41, Steps: 10 | Train Loss: 0.104 Vali Loss: 3.901 Vali Acc: 0.245 Test Loss: 3.901 Test Acc: 0.245
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.006117582321167
Epoch: 42, Steps: 10 | Train Loss: 0.098 Vali Loss: 3.936 Vali Acc: 0.247 Test Loss: 3.936 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.8899905681610107
Epoch: 43, Steps: 10 | Train Loss: 0.096 Vali Loss: 3.951 Vali Acc: 0.245 Test Loss: 3.951 Test Acc: 0.245
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.9142019748687744
Epoch: 44, Steps: 10 | Train Loss: 0.080 Vali Loss: 3.987 Vali Acc: 0.248 Test Loss: 3.987 Test Acc: 0.248
Validation loss decreased (-0.247020 --> -0.248195).  Saving model ...
Epoch: 45 cost time: 0.8920087814331055
Epoch: 45, Steps: 10 | Train Loss: 0.085 Vali Loss: 4.032 Vali Acc: 0.247 Test Loss: 4.032 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.0151255130767822
Epoch: 46, Steps: 10 | Train Loss: 0.074 Vali Loss: 4.079 Vali Acc: 0.253 Test Loss: 4.079 Test Acc: 0.253
Validation loss decreased (-0.248195 --> -0.252900).  Saving model ...
Epoch: 47 cost time: 0.9890275001525879
Epoch: 47, Steps: 10 | Train Loss: 0.062 Vali Loss: 4.133 Vali Acc: 0.248 Test Loss: 4.133 Test Acc: 0.248
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.9380812644958496
Epoch: 48, Steps: 10 | Train Loss: 0.059 Vali Loss: 4.171 Vali Acc: 0.247 Test Loss: 4.171 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.9190311431884766
Epoch: 49, Steps: 10 | Train Loss: 0.049 Vali Loss: 4.209 Vali Acc: 0.251 Test Loss: 4.209 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.8808653354644775
Epoch: 50, Steps: 10 | Train Loss: 0.045 Vali Loss: 4.238 Vali Acc: 0.247 Test Loss: 4.238 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps38_str19_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2529411764705882
model parameter : 97530
model size : 0.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.00999116897583
Epoch: 1, Steps: 10 | Train Loss: 3.321 Vali Loss: 3.233 Vali Acc: 0.098 Test Loss: 3.233 Test Acc: 0.098
Validation loss decreased (inf --> -0.097615).  Saving model ...
Epoch: 2 cost time: 1.4046320915222168
Epoch: 2, Steps: 10 | Train Loss: 2.044 Vali Loss: 3.224 Vali Acc: 0.186 Test Loss: 3.224 Test Acc: 0.186
Validation loss decreased (-0.097615 --> -0.185850).  Saving model ...
Epoch: 3 cost time: 1.4845399856567383
Epoch: 3, Steps: 10 | Train Loss: 0.806 Vali Loss: 3.408 Vali Acc: 0.239 Test Loss: 3.408 Test Acc: 0.239
Validation loss decreased (-0.185850 --> -0.238789).  Saving model ...
Epoch: 4 cost time: 1.3759911060333252
Epoch: 4, Steps: 10 | Train Loss: 0.226 Vali Loss: 3.987 Vali Acc: 0.238 Test Loss: 3.987 Test Acc: 0.238
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2444443702697754
Epoch: 5, Steps: 10 | Train Loss: 0.063 Vali Loss: 4.514 Vali Acc: 0.233 Test Loss: 4.514 Test Acc: 0.233
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.3196978569030762
Epoch: 6, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.757 Vali Acc: 0.234 Test Loss: 4.757 Test Acc: 0.234
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.2916767597198486
Epoch: 7, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.928 Vali Acc: 0.242 Test Loss: 4.928 Test Acc: 0.242
Validation loss decreased (-0.238789 --> -0.242304).  Saving model ...
Epoch: 8 cost time: 1.32594633102417
Epoch: 8, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.986 Vali Acc: 0.254 Test Loss: 4.986 Test Acc: 0.254
Validation loss decreased (-0.242304 --> -0.254068).  Saving model ...
Epoch: 9 cost time: 1.3959722518920898
Epoch: 9, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.018 Vali Acc: 0.260 Test Loss: 5.018 Test Acc: 0.260
Validation loss decreased (-0.254068 --> -0.259950).  Saving model ...
Epoch: 10 cost time: 1.310215950012207
Epoch: 10, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.025 Vali Acc: 0.256 Test Loss: 5.025 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4305133819580078
Epoch: 11, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.021 Vali Acc: 0.261 Test Loss: 5.021 Test Acc: 0.261
Validation loss decreased (-0.259950 --> -0.261126).  Saving model ...
Epoch: 12 cost time: 1.3234045505523682
Epoch: 12, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.017 Vali Acc: 0.265 Test Loss: 5.017 Test Acc: 0.265
Validation loss decreased (-0.261126 --> -0.264656).  Saving model ...
Epoch: 13 cost time: 1.3184318542480469
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.036 Vali Acc: 0.266 Test Loss: 5.036 Test Acc: 0.266
Validation loss decreased (-0.264656 --> -0.265832).  Saving model ...
Epoch: 14 cost time: 1.4114956855773926
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.055 Vali Acc: 0.260 Test Loss: 5.055 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4572105407714844
Epoch: 15, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.079 Vali Acc: 0.266 Test Loss: 5.079 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.495370864868164
Epoch: 16, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.099 Vali Acc: 0.266 Test Loss: 5.099 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.439849853515625
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.113 Vali Acc: 0.266 Test Loss: 5.113 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.4129626750946045
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.111 Vali Acc: 0.266 Test Loss: 5.111 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.334303617477417
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.119 Vali Acc: 0.267 Test Loss: 5.119 Test Acc: 0.267
Validation loss decreased (-0.265832 --> -0.267008).  Saving model ...
Epoch: 20 cost time: 1.5159003734588623
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.128 Vali Acc: 0.266 Test Loss: 5.128 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.5469915866851807
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.145 Vali Acc: 0.268 Test Loss: 5.145 Test Acc: 0.268
Validation loss decreased (-0.267008 --> -0.268184).  Saving model ...
Epoch: 22 cost time: 1.668445348739624
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.168 Vali Acc: 0.271 Test Loss: 5.168 Test Acc: 0.271
Validation loss decreased (-0.268184 --> -0.270537).  Saving model ...
Epoch: 23 cost time: 1.4414019584655762
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.188 Vali Acc: 0.271 Test Loss: 5.188 Test Acc: 0.271
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.4258511066436768
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.201 Vali Acc: 0.272 Test Loss: 5.201 Test Acc: 0.272
Validation loss decreased (-0.270537 --> -0.271713).  Saving model ...
Epoch: 25 cost time: 1.4696595668792725
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.208 Vali Acc: 0.271 Test Loss: 5.208 Test Acc: 0.271
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.6511173248291016
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.223 Vali Acc: 0.267 Test Loss: 5.223 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.4256031513214111
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.242 Vali Acc: 0.268 Test Loss: 5.242 Test Acc: 0.268
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.3705360889434814
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.250 Vali Acc: 0.267 Test Loss: 5.250 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.2546908855438232
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.253 Vali Acc: 0.269 Test Loss: 5.253 Test Acc: 0.269
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.4113173484802246
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.280 Vali Acc: 0.271 Test Loss: 5.280 Test Acc: 0.271
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.3207786083221436
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.301 Vali Acc: 0.268 Test Loss: 5.301 Test Acc: 0.268
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.3694570064544678
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.314 Vali Acc: 0.266 Test Loss: 5.314 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.5283186435699463
Epoch: 33, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.322 Vali Acc: 0.267 Test Loss: 5.322 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.5701794624328613
Epoch: 34, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.331 Vali Acc: 0.268 Test Loss: 5.331 Test Acc: 0.268
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27176470588235296
model parameter : 2337050
model size : 8.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.677576780319214
Epoch: 1, Steps: 10 | Train Loss: 3.299 Vali Loss: 3.247 Vali Acc: 0.066 Test Loss: 3.247 Test Acc: 0.066
Validation loss decreased (inf --> -0.065850).  Saving model ...
Epoch: 2 cost time: 1.1119422912597656
Epoch: 2, Steps: 10 | Train Loss: 2.542 Vali Loss: 3.270 Vali Acc: 0.129 Test Loss: 3.270 Test Acc: 0.129
Validation loss decreased (-0.065850 --> -0.129379).  Saving model ...
Epoch: 3 cost time: 1.1992125511169434
Epoch: 3, Steps: 10 | Train Loss: 1.495 Vali Loss: 3.221 Vali Acc: 0.193 Test Loss: 3.221 Test Acc: 0.193
Validation loss decreased (-0.129379 --> -0.192909).  Saving model ...
Epoch: 4 cost time: 1.0980544090270996
Epoch: 4, Steps: 10 | Train Loss: 0.698 Vali Loss: 3.385 Vali Acc: 0.220 Test Loss: 3.385 Test Acc: 0.220
Validation loss decreased (-0.192909 --> -0.219966).  Saving model ...
Epoch: 5 cost time: 1.2854876518249512
Epoch: 5, Steps: 10 | Train Loss: 0.305 Vali Loss: 3.721 Vali Acc: 0.238 Test Loss: 3.721 Test Acc: 0.238
Validation loss decreased (-0.219966 --> -0.237610).  Saving model ...
Epoch: 6 cost time: 1.139085054397583
Epoch: 6, Steps: 10 | Train Loss: 0.125 Vali Loss: 3.946 Vali Acc: 0.245 Test Loss: 3.946 Test Acc: 0.245
Validation loss decreased (-0.237610 --> -0.244666).  Saving model ...
Epoch: 7 cost time: 1.1508409976959229
Epoch: 7, Steps: 10 | Train Loss: 0.048 Vali Loss: 4.143 Vali Acc: 0.239 Test Loss: 4.143 Test Acc: 0.239
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1038155555725098
Epoch: 8, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.235 Vali Acc: 0.258 Test Loss: 4.235 Test Acc: 0.258
Validation loss decreased (-0.244666 --> -0.257605).  Saving model ...
Epoch: 9 cost time: 1.1282970905303955
Epoch: 9, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.417 Vali Acc: 0.252 Test Loss: 4.417 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2504572868347168
Epoch: 10, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.453 Vali Acc: 0.252 Test Loss: 4.453 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1767690181732178
Epoch: 11, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.496 Vali Acc: 0.264 Test Loss: 4.496 Test Acc: 0.264
Validation loss decreased (-0.257605 --> -0.263484).  Saving model ...
Epoch: 12 cost time: 1.136192798614502
Epoch: 12, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.490 Vali Acc: 0.268 Test Loss: 4.490 Test Acc: 0.268
Validation loss decreased (-0.263484 --> -0.268190).  Saving model ...
Epoch: 13 cost time: 1.2888522148132324
Epoch: 13, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.521 Vali Acc: 0.262 Test Loss: 4.521 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1801364421844482
Epoch: 14, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.549 Vali Acc: 0.259 Test Loss: 4.549 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.148179292678833
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.566 Vali Acc: 0.259 Test Loss: 4.566 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.163595199584961
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.588 Vali Acc: 0.261 Test Loss: 4.588 Test Acc: 0.261
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.1877501010894775
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.612 Vali Acc: 0.262 Test Loss: 4.612 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.1619305610656738
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.636 Vali Acc: 0.268 Test Loss: 4.636 Test Acc: 0.268
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.128157615661621
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.649 Vali Acc: 0.268 Test Loss: 4.649 Test Acc: 0.268
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.091799259185791
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.681 Vali Acc: 0.269 Test Loss: 4.681 Test Acc: 0.269
Validation loss decreased (-0.268190 --> -0.269365).  Saving model ...
Epoch: 21 cost time: 1.1044807434082031
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.697 Vali Acc: 0.268 Test Loss: 4.697 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1767113208770752
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.745 Vali Acc: 0.265 Test Loss: 4.745 Test Acc: 0.265
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.2630479335784912
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.761 Vali Acc: 0.268 Test Loss: 4.761 Test Acc: 0.268
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.1920263767242432
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.777 Vali Acc: 0.268 Test Loss: 4.777 Test Acc: 0.268
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.1027395725250244
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.790 Vali Acc: 0.268 Test Loss: 4.790 Test Acc: 0.268
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.0904831886291504
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.808 Vali Acc: 0.268 Test Loss: 4.808 Test Acc: 0.268
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.0946128368377686
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.822 Vali Acc: 0.267 Test Loss: 4.822 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.0793399810791016
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.859 Vali Acc: 0.266 Test Loss: 4.859 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.0880794525146484
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.881 Vali Acc: 0.267 Test Loss: 4.881 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.1534380912780762
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.892 Vali Acc: 0.267 Test Loss: 4.892 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26941176470588235
model parameter : 1579290
model size : 6.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps12_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.5206589698791504
Epoch: 1, Steps: 10 | Train Loss: 3.302 Vali Loss: 3.253 Vali Acc: 0.053 Test Loss: 3.253 Test Acc: 0.053
Validation loss decreased (inf --> -0.052909).  Saving model ...
Epoch: 2 cost time: 1.0191082954406738
Epoch: 2, Steps: 10 | Train Loss: 2.759 Vali Loss: 3.235 Vali Acc: 0.118 Test Loss: 3.235 Test Acc: 0.118
Validation loss decreased (-0.052909 --> -0.117615).  Saving model ...
Epoch: 3 cost time: 0.9318394660949707
Epoch: 3, Steps: 10 | Train Loss: 1.968 Vali Loss: 3.227 Vali Acc: 0.160 Test Loss: 3.227 Test Acc: 0.160
Validation loss decreased (-0.117615 --> -0.159968).  Saving model ...
Epoch: 4 cost time: 0.939277172088623
Epoch: 4, Steps: 10 | Train Loss: 1.177 Vali Loss: 3.184 Vali Acc: 0.225 Test Loss: 3.184 Test Acc: 0.225
Validation loss decreased (-0.159968 --> -0.224674).  Saving model ...
Epoch: 5 cost time: 0.9829542636871338
Epoch: 5, Steps: 10 | Train Loss: 0.653 Vali Loss: 3.313 Vali Acc: 0.234 Test Loss: 3.313 Test Acc: 0.234
Validation loss decreased (-0.224674 --> -0.234085).  Saving model ...
Epoch: 6 cost time: 1.0870482921600342
Epoch: 6, Steps: 10 | Train Loss: 0.305 Vali Loss: 3.474 Vali Acc: 0.266 Test Loss: 3.474 Test Acc: 0.266
Validation loss decreased (-0.234085 --> -0.265848).  Saving model ...
Epoch: 7 cost time: 1.0807781219482422
Epoch: 7, Steps: 10 | Train Loss: 0.152 Vali Loss: 3.687 Vali Acc: 0.256 Test Loss: 3.687 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.079467535018921
Epoch: 8, Steps: 10 | Train Loss: 0.073 Vali Loss: 3.850 Vali Acc: 0.254 Test Loss: 3.850 Test Acc: 0.254
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9901976585388184
Epoch: 9, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.916 Vali Acc: 0.276 Test Loss: 3.916 Test Acc: 0.276
Validation loss decreased (-0.265848 --> -0.276431).  Saving model ...
Epoch: 10 cost time: 1.0863053798675537
Epoch: 10, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.023 Vali Acc: 0.264 Test Loss: 4.023 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1271443367004395
Epoch: 11, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.054 Vali Acc: 0.269 Test Loss: 4.054 Test Acc: 0.269
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1511938571929932
Epoch: 12, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.097 Vali Acc: 0.268 Test Loss: 4.097 Test Acc: 0.268
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.02048659324646
Epoch: 13, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.150 Vali Acc: 0.271 Test Loss: 4.150 Test Acc: 0.271
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.9205887317657471
Epoch: 14, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.193 Vali Acc: 0.271 Test Loss: 4.193 Test Acc: 0.271
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.9776499271392822
Epoch: 15, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.231 Vali Acc: 0.273 Test Loss: 4.231 Test Acc: 0.273
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.083575963973999
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.261 Vali Acc: 0.273 Test Loss: 4.261 Test Acc: 0.273
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.1018590927124023
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.273 Vali Acc: 0.275 Test Loss: 4.273 Test Acc: 0.275
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.0535180568695068
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.320 Vali Acc: 0.274 Test Loss: 4.320 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.031360149383545
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.357 Vali Acc: 0.275 Test Loss: 4.357 Test Acc: 0.275
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps12_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27647058823529413
model parameter : 1320730
model size : 5.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.7043449878692627
Epoch: 1, Steps: 10 | Train Loss: 3.365 Vali Loss: 3.277 Vali Acc: 0.052 Test Loss: 3.277 Test Acc: 0.052
Validation loss decreased (inf --> -0.051732).  Saving model ...
Epoch: 2 cost time: 0.980597734451294
Epoch: 2, Steps: 10 | Train Loss: 2.907 Vali Loss: 3.260 Vali Acc: 0.091 Test Loss: 3.260 Test Acc: 0.091
Validation loss decreased (-0.051732 --> -0.090556).  Saving model ...
Epoch: 3 cost time: 0.9775760173797607
Epoch: 3, Steps: 10 | Train Loss: 2.219 Vali Loss: 3.242 Vali Acc: 0.146 Test Loss: 3.242 Test Acc: 0.146
Validation loss decreased (-0.090556 --> -0.145850).  Saving model ...
Epoch: 4 cost time: 0.9815688133239746
Epoch: 4, Steps: 10 | Train Loss: 1.552 Vali Loss: 3.195 Vali Acc: 0.198 Test Loss: 3.195 Test Acc: 0.198
Validation loss decreased (-0.145850 --> -0.197615).  Saving model ...
Epoch: 5 cost time: 1.0167696475982666
Epoch: 5, Steps: 10 | Train Loss: 0.954 Vali Loss: 3.209 Vali Acc: 0.227 Test Loss: 3.209 Test Acc: 0.227
Validation loss decreased (-0.197615 --> -0.227027).  Saving model ...
Epoch: 6 cost time: 0.9737396240234375
Epoch: 6, Steps: 10 | Train Loss: 0.564 Vali Loss: 3.315 Vali Acc: 0.259 Test Loss: 3.315 Test Acc: 0.259
Validation loss decreased (-0.227027 --> -0.258790).  Saving model ...
Epoch: 7 cost time: 0.995408296585083
Epoch: 7, Steps: 10 | Train Loss: 0.296 Vali Loss: 3.460 Vali Acc: 0.264 Test Loss: 3.460 Test Acc: 0.264
Validation loss decreased (-0.258790 --> -0.263495).  Saving model ...
Epoch: 8 cost time: 0.9911391735076904
Epoch: 8, Steps: 10 | Train Loss: 0.154 Vali Loss: 3.634 Vali Acc: 0.268 Test Loss: 3.634 Test Acc: 0.268
Validation loss decreased (-0.263495 --> -0.268199).  Saving model ...
Epoch: 9 cost time: 1.038172960281372
Epoch: 9, Steps: 10 | Train Loss: 0.079 Vali Loss: 3.787 Vali Acc: 0.261 Test Loss: 3.787 Test Acc: 0.261
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0608808994293213
Epoch: 10, Steps: 10 | Train Loss: 0.043 Vali Loss: 3.821 Vali Acc: 0.269 Test Loss: 3.821 Test Acc: 0.269
Validation loss decreased (-0.268199 --> -0.269374).  Saving model ...
Epoch: 11 cost time: 1.071497917175293
Epoch: 11, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.872 Vali Acc: 0.279 Test Loss: 3.872 Test Acc: 0.279
Validation loss decreased (-0.269374 --> -0.278785).  Saving model ...
Epoch: 12 cost time: 1.1382219791412354
Epoch: 12, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.956 Vali Acc: 0.267 Test Loss: 3.956 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0915777683258057
Epoch: 13, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.001 Vali Acc: 0.271 Test Loss: 4.001 Test Acc: 0.271
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0598409175872803
Epoch: 14, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.033 Vali Acc: 0.275 Test Loss: 4.033 Test Acc: 0.275
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.1045310497283936
Epoch: 15, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.051 Vali Acc: 0.278 Test Loss: 4.051 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.168959140777588
Epoch: 16, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.093 Vali Acc: 0.279 Test Loss: 4.093 Test Acc: 0.279
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.0658798217773438
Epoch: 17, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.133 Vali Acc: 0.279 Test Loss: 4.133 Test Acc: 0.279
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.1146290302276611
Epoch: 18, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.168 Vali Acc: 0.278 Test Loss: 4.168 Test Acc: 0.278
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.1941657066345215
Epoch: 19, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.179 Vali Acc: 0.278 Test Loss: 4.179 Test Acc: 0.278
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.0805625915527344
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.210 Vali Acc: 0.276 Test Loss: 4.210 Test Acc: 0.276
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.1122450828552246
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.234 Vali Acc: 0.280 Test Loss: 4.234 Test Acc: 0.280
Validation loss decreased (-0.278785 --> -0.279958).  Saving model ...
Epoch: 22 cost time: 0.9572756290435791
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.266 Vali Acc: 0.281 Test Loss: 4.266 Test Acc: 0.281
Validation loss decreased (-0.279958 --> -0.281134).  Saving model ...
Epoch: 23 cost time: 1.04655122756958
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.274 Vali Acc: 0.279 Test Loss: 4.274 Test Acc: 0.279
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0456128120422363
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.294 Vali Acc: 0.280 Test Loss: 4.294 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.0718724727630615
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.332 Vali Acc: 0.280 Test Loss: 4.332 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.2157773971557617
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.362 Vali Acc: 0.281 Test Loss: 4.362 Test Acc: 0.281
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.0006625652313232
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.376 Vali Acc: 0.281 Test Loss: 4.376 Test Acc: 0.281
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.1108665466308594
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.395 Vali Acc: 0.285 Test Loss: 4.395 Test Acc: 0.285
Validation loss decreased (-0.281134 --> -0.284662).  Saving model ...
Epoch: 29 cost time: 1.1055803298950195
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.431 Vali Acc: 0.281 Test Loss: 4.431 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.1376750469207764
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.454 Vali Acc: 0.284 Test Loss: 4.454 Test Acc: 0.284
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.0992069244384766
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.474 Vali Acc: 0.281 Test Loss: 4.474 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.090306043624878
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.491 Vali Acc: 0.286 Test Loss: 4.491 Test Acc: 0.286
Validation loss decreased (-0.284662 --> -0.285837).  Saving model ...
Epoch: 33 cost time: 1.140364408493042
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.512 Vali Acc: 0.286 Test Loss: 4.512 Test Acc: 0.286
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.0789039134979248
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.536 Vali Acc: 0.291 Test Loss: 4.536 Test Acc: 0.291
Validation loss decreased (-0.285837 --> -0.290543).  Saving model ...
Epoch: 35 cost time: 1.096818447113037
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.555 Vali Acc: 0.286 Test Loss: 4.555 Test Acc: 0.286
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.167081356048584
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.585 Vali Acc: 0.282 Test Loss: 4.585 Test Acc: 0.282
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.0516748428344727
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.601 Vali Acc: 0.282 Test Loss: 4.601 Test Acc: 0.282
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.9701881408691406
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.618 Vali Acc: 0.286 Test Loss: 4.618 Test Acc: 0.286
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.0412242412567139
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.636 Vali Acc: 0.286 Test Loss: 4.636 Test Acc: 0.286
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.0082075595855713
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.650 Vali Acc: 0.284 Test Loss: 4.650 Test Acc: 0.284
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.0673847198486328
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.668 Vali Acc: 0.284 Test Loss: 4.668 Test Acc: 0.284
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.1500296592712402
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.679 Vali Acc: 0.286 Test Loss: 4.679 Test Acc: 0.286
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.9842500686645508
Epoch: 43, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.696 Vali Acc: 0.285 Test Loss: 4.696 Test Acc: 0.285
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 1.0633256435394287
Epoch: 44, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.719 Vali Acc: 0.285 Test Loss: 4.719 Test Acc: 0.285
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.29058823529411765
model parameter : 1201946
model size : 4.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps23_str12_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.546752452850342
Epoch: 1, Steps: 10 | Train Loss: 3.336 Vali Loss: 3.290 Vali Acc: 0.035 Test Loss: 3.290 Test Acc: 0.035
Validation loss decreased (inf --> -0.035261).  Saving model ...
Epoch: 2 cost time: 0.9675178527832031
Epoch: 2, Steps: 10 | Train Loss: 3.046 Vali Loss: 3.274 Vali Acc: 0.069 Test Loss: 3.274 Test Acc: 0.069
Validation loss decreased (-0.035261 --> -0.069379).  Saving model ...
Epoch: 3 cost time: 1.010103702545166
Epoch: 3, Steps: 10 | Train Loss: 2.537 Vali Loss: 3.246 Vali Acc: 0.119 Test Loss: 3.246 Test Acc: 0.119
Validation loss decreased (-0.069379 --> -0.118791).  Saving model ...
Epoch: 4 cost time: 0.9242708683013916
Epoch: 4, Steps: 10 | Train Loss: 2.030 Vali Loss: 3.200 Vali Acc: 0.169 Test Loss: 3.200 Test Acc: 0.169
Validation loss decreased (-0.118791 --> -0.169380).  Saving model ...
Epoch: 5 cost time: 0.9896163940429688
Epoch: 5, Steps: 10 | Train Loss: 1.490 Vali Loss: 3.150 Vali Acc: 0.207 Test Loss: 3.150 Test Acc: 0.207
Validation loss decreased (-0.169380 --> -0.207027).  Saving model ...
Epoch: 6 cost time: 1.0681757926940918
Epoch: 6, Steps: 10 | Train Loss: 1.085 Vali Loss: 3.185 Vali Acc: 0.227 Test Loss: 3.185 Test Acc: 0.227
Validation loss decreased (-0.207027 --> -0.227027).  Saving model ...
Epoch: 7 cost time: 0.9593720436096191
Epoch: 7, Steps: 10 | Train Loss: 0.691 Vali Loss: 3.200 Vali Acc: 0.258 Test Loss: 3.200 Test Acc: 0.258
Validation loss decreased (-0.227027 --> -0.257615).  Saving model ...
Epoch: 8 cost time: 0.9958736896514893
Epoch: 8, Steps: 10 | Train Loss: 0.466 Vali Loss: 3.289 Vali Acc: 0.266 Test Loss: 3.289 Test Acc: 0.266
Validation loss decreased (-0.257615 --> -0.265849).  Saving model ...
Epoch: 9 cost time: 1.1086010932922363
Epoch: 9, Steps: 10 | Train Loss: 0.281 Vali Loss: 3.437 Vali Acc: 0.264 Test Loss: 3.437 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1271817684173584
Epoch: 10, Steps: 10 | Train Loss: 0.156 Vali Loss: 3.503 Vali Acc: 0.276 Test Loss: 3.503 Test Acc: 0.276
Validation loss decreased (-0.265849 --> -0.276436).  Saving model ...
Epoch: 11 cost time: 1.1036231517791748
Epoch: 11, Steps: 10 | Train Loss: 0.096 Vali Loss: 3.612 Vali Acc: 0.275 Test Loss: 3.612 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0150487422943115
Epoch: 12, Steps: 10 | Train Loss: 0.060 Vali Loss: 3.660 Vali Acc: 0.275 Test Loss: 3.660 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.0174155235290527
Epoch: 13, Steps: 10 | Train Loss: 0.044 Vali Loss: 3.688 Vali Acc: 0.285 Test Loss: 3.688 Test Acc: 0.285
Validation loss decreased (-0.276436 --> -0.284669).  Saving model ...
Epoch: 14 cost time: 0.9680037498474121
Epoch: 14, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.735 Vali Acc: 0.291 Test Loss: 3.735 Test Acc: 0.291
Validation loss decreased (-0.284669 --> -0.290551).  Saving model ...
Epoch: 15 cost time: 1.0570330619812012
Epoch: 15, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.798 Vali Acc: 0.287 Test Loss: 3.798 Test Acc: 0.287
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.061068058013916
Epoch: 16, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.841 Vali Acc: 0.287 Test Loss: 3.841 Test Acc: 0.287
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.1230823993682861
Epoch: 17, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.870 Vali Acc: 0.288 Test Loss: 3.870 Test Acc: 0.288
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.1259710788726807
Epoch: 18, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.899 Vali Acc: 0.291 Test Loss: 3.899 Test Acc: 0.291
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.9757659435272217
Epoch: 19, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.931 Vali Acc: 0.293 Test Loss: 3.931 Test Acc: 0.293
Validation loss decreased (-0.290551 --> -0.292902).  Saving model ...
Epoch: 20 cost time: 0.9778707027435303
Epoch: 20, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.961 Vali Acc: 0.293 Test Loss: 3.961 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0558977127075195
Epoch: 21, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.994 Vali Acc: 0.293 Test Loss: 3.994 Test Acc: 0.293
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.0555217266082764
Epoch: 22, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.022 Vali Acc: 0.293 Test Loss: 4.022 Test Acc: 0.293
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.1020071506500244
Epoch: 23, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.060 Vali Acc: 0.292 Test Loss: 4.060 Test Acc: 0.292
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.0164432525634766
Epoch: 24, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.086 Vali Acc: 0.289 Test Loss: 4.086 Test Acc: 0.289
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.0712337493896484
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.111 Vali Acc: 0.289 Test Loss: 4.111 Test Acc: 0.289
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.1079514026641846
Epoch: 26, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.123 Vali Acc: 0.294 Test Loss: 4.123 Test Acc: 0.294
Validation loss decreased (-0.292902 --> -0.294076).  Saving model ...
Epoch: 27 cost time: 0.9334843158721924
Epoch: 27, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.140 Vali Acc: 0.289 Test Loss: 4.140 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9013574123382568
Epoch: 28, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.159 Vali Acc: 0.291 Test Loss: 4.159 Test Acc: 0.291
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.097430944442749
Epoch: 29, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.177 Vali Acc: 0.293 Test Loss: 4.177 Test Acc: 0.293
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.0038645267486572
Epoch: 30, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.195 Vali Acc: 0.293 Test Loss: 4.195 Test Acc: 0.293
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.9987051486968994
Epoch: 31, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.219 Vali Acc: 0.293 Test Loss: 4.219 Test Acc: 0.293
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.0513792037963867
Epoch: 32, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.241 Vali Acc: 0.293 Test Loss: 4.241 Test Acc: 0.293
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.9691073894500732
Epoch: 33, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.282 Vali Acc: 0.292 Test Loss: 4.282 Test Acc: 0.292
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.0138599872589111
Epoch: 34, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.291 Vali Acc: 0.293 Test Loss: 4.291 Test Acc: 0.293
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.0042762756347656
Epoch: 35, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.313 Vali Acc: 0.293 Test Loss: 4.313 Test Acc: 0.293
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.8972880840301514
Epoch: 36, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.322 Vali Acc: 0.293 Test Loss: 4.322 Test Acc: 0.293
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps23_str12_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.29411764705882354
model parameter : 1063962
model size : 4.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.6406168937683105
Epoch: 1, Steps: 10 | Train Loss: 3.352 Vali Loss: 3.272 Vali Acc: 0.049 Test Loss: 3.272 Test Acc: 0.049
Validation loss decreased (inf --> -0.049379).  Saving model ...
Epoch: 2 cost time: 0.9948287010192871
Epoch: 2, Steps: 10 | Train Loss: 3.128 Vali Loss: 3.253 Vali Acc: 0.069 Test Loss: 3.253 Test Acc: 0.069
Validation loss decreased (-0.049379 --> -0.069379).  Saving model ...
Epoch: 3 cost time: 1.0096445083618164
Epoch: 3, Steps: 10 | Train Loss: 2.726 Vali Loss: 3.246 Vali Acc: 0.111 Test Loss: 3.246 Test Acc: 0.111
Validation loss decreased (-0.069379 --> -0.110556).  Saving model ...
Epoch: 4 cost time: 0.8897161483764648
Epoch: 4, Steps: 10 | Train Loss: 2.258 Vali Loss: 3.210 Vali Acc: 0.159 Test Loss: 3.210 Test Acc: 0.159
Validation loss decreased (-0.110556 --> -0.158791).  Saving model ...
Epoch: 5 cost time: 1.0622954368591309
Epoch: 5, Steps: 10 | Train Loss: 1.866 Vali Loss: 3.188 Vali Acc: 0.174 Test Loss: 3.188 Test Acc: 0.174
Validation loss decreased (-0.158791 --> -0.174086).  Saving model ...
Epoch: 6 cost time: 0.9913733005523682
Epoch: 6, Steps: 10 | Train Loss: 1.420 Vali Loss: 3.171 Vali Acc: 0.206 Test Loss: 3.171 Test Acc: 0.206
Validation loss decreased (-0.174086 --> -0.205851).  Saving model ...
Epoch: 7 cost time: 0.9735195636749268
Epoch: 7, Steps: 10 | Train Loss: 1.046 Vali Loss: 3.193 Vali Acc: 0.225 Test Loss: 3.193 Test Acc: 0.225
Validation loss decreased (-0.205851 --> -0.224674).  Saving model ...
Epoch: 8 cost time: 0.9181728363037109
Epoch: 8, Steps: 10 | Train Loss: 0.738 Vali Loss: 3.224 Vali Acc: 0.241 Test Loss: 3.224 Test Acc: 0.241
Validation loss decreased (-0.224674 --> -0.241144).  Saving model ...
Epoch: 9 cost time: 0.9108467102050781
Epoch: 9, Steps: 10 | Train Loss: 0.498 Vali Loss: 3.299 Vali Acc: 0.247 Test Loss: 3.299 Test Acc: 0.247
Validation loss decreased (-0.241144 --> -0.247026).  Saving model ...
Epoch: 10 cost time: 1.028473138809204
Epoch: 10, Steps: 10 | Train Loss: 0.354 Vali Loss: 3.381 Vali Acc: 0.260 Test Loss: 3.381 Test Acc: 0.260
Validation loss decreased (-0.247026 --> -0.259966).  Saving model ...
Epoch: 11 cost time: 0.9626946449279785
Epoch: 11, Steps: 10 | Train Loss: 0.219 Vali Loss: 3.447 Vali Acc: 0.254 Test Loss: 3.447 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0562574863433838
Epoch: 12, Steps: 10 | Train Loss: 0.144 Vali Loss: 3.519 Vali Acc: 0.264 Test Loss: 3.519 Test Acc: 0.264
Validation loss decreased (-0.259966 --> -0.263494).  Saving model ...
Epoch: 13 cost time: 0.9072208404541016
Epoch: 13, Steps: 10 | Train Loss: 0.096 Vali Loss: 3.614 Vali Acc: 0.268 Test Loss: 3.614 Test Acc: 0.268
Validation loss decreased (-0.263494 --> -0.268199).  Saving model ...
Epoch: 14 cost time: 0.953636646270752
Epoch: 14, Steps: 10 | Train Loss: 0.063 Vali Loss: 3.677 Vali Acc: 0.264 Test Loss: 3.677 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1215956211090088
Epoch: 15, Steps: 10 | Train Loss: 0.050 Vali Loss: 3.698 Vali Acc: 0.271 Test Loss: 3.698 Test Acc: 0.271
Validation loss decreased (-0.268199 --> -0.270551).  Saving model ...
Epoch: 16 cost time: 0.9810709953308105
Epoch: 16, Steps: 10 | Train Loss: 0.039 Vali Loss: 3.744 Vali Acc: 0.271 Test Loss: 3.744 Test Acc: 0.271
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9992814064025879
Epoch: 17, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.778 Vali Acc: 0.271 Test Loss: 3.778 Test Acc: 0.271
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0103135108947754
Epoch: 18, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.821 Vali Acc: 0.272 Test Loss: 3.821 Test Acc: 0.272
Validation loss decreased (-0.270551 --> -0.271727).  Saving model ...
Epoch: 19 cost time: 1.0679733753204346
Epoch: 19, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.853 Vali Acc: 0.269 Test Loss: 3.853 Test Acc: 0.269
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.026679515838623
Epoch: 20, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.881 Vali Acc: 0.268 Test Loss: 3.881 Test Acc: 0.268
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.0881195068359375
Epoch: 21, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.927 Vali Acc: 0.268 Test Loss: 3.927 Test Acc: 0.268
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.072995662689209
Epoch: 22, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.955 Vali Acc: 0.272 Test Loss: 3.955 Test Acc: 0.272
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.9686810970306396
Epoch: 23, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.990 Vali Acc: 0.272 Test Loss: 3.990 Test Acc: 0.272
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.8722240924835205
Epoch: 24, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.017 Vali Acc: 0.271 Test Loss: 4.017 Test Acc: 0.271
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.0418062210083008
Epoch: 25, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.031 Vali Acc: 0.272 Test Loss: 4.031 Test Acc: 0.272
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.9731881618499756
Epoch: 26, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.069 Vali Acc: 0.274 Test Loss: 4.069 Test Acc: 0.274
Validation loss decreased (-0.271727 --> -0.274077).  Saving model ...
Epoch: 27 cost time: 1.008157730102539
Epoch: 27, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.104 Vali Acc: 0.273 Test Loss: 4.104 Test Acc: 0.273
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9013073444366455
Epoch: 28, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.106 Vali Acc: 0.274 Test Loss: 4.106 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.9761886596679688
Epoch: 29, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.142 Vali Acc: 0.279 Test Loss: 4.142 Test Acc: 0.279
Validation loss decreased (-0.274077 --> -0.278782).  Saving model ...
Epoch: 30 cost time: 1.0331525802612305
Epoch: 30, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.158 Vali Acc: 0.278 Test Loss: 4.158 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.012397050857544
Epoch: 31, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.182 Vali Acc: 0.278 Test Loss: 4.182 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.0085625648498535
Epoch: 32, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.215 Vali Acc: 0.278 Test Loss: 4.215 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.1045632362365723
Epoch: 33, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.233 Vali Acc: 0.282 Test Loss: 4.233 Test Acc: 0.282
Validation loss decreased (-0.278782 --> -0.282311).  Saving model ...
Epoch: 34 cost time: 1.0522863864898682
Epoch: 34, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.265 Vali Acc: 0.278 Test Loss: 4.265 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.024097204208374
Epoch: 35, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.266 Vali Acc: 0.280 Test Loss: 4.266 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.9853122234344482
Epoch: 36, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.302 Vali Acc: 0.278 Test Loss: 4.302 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.9707436561584473
Epoch: 37, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.328 Vali Acc: 0.278 Test Loss: 4.328 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.0049865245819092
Epoch: 38, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.344 Vali Acc: 0.278 Test Loss: 4.344 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.042135238647461
Epoch: 39, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.365 Vali Acc: 0.280 Test Loss: 4.365 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.0464370250701904
Epoch: 40, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.376 Vali Acc: 0.279 Test Loss: 4.376 Test Acc: 0.279
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.0396368503570557
Epoch: 41, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.395 Vali Acc: 0.276 Test Loss: 4.395 Test Acc: 0.276
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.0126161575317383
Epoch: 42, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.418 Vali Acc: 0.275 Test Loss: 4.418 Test Acc: 0.275
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.0441539287567139
Epoch: 43, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.449 Vali Acc: 0.276 Test Loss: 4.449 Test Acc: 0.276
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2823529411764706
model parameter : 1006106
model size : 3.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps38_str19_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.6815614700317383
Epoch: 1, Steps: 10 | Train Loss: 3.261 Vali Loss: 3.292 Vali Acc: 0.041 Test Loss: 3.292 Test Acc: 0.041
Validation loss decreased (inf --> -0.041144).  Saving model ...
Epoch: 2 cost time: 1.0706555843353271
Epoch: 2, Steps: 10 | Train Loss: 3.071 Vali Loss: 3.273 Vali Acc: 0.074 Test Loss: 3.273 Test Acc: 0.074
Validation loss decreased (-0.041144 --> -0.074085).  Saving model ...
Epoch: 3 cost time: 1.0193064212799072
Epoch: 3, Steps: 10 | Train Loss: 2.747 Vali Loss: 3.250 Vali Acc: 0.113 Test Loss: 3.250 Test Acc: 0.113
Validation loss decreased (-0.074085 --> -0.112909).  Saving model ...
Epoch: 4 cost time: 1.0334861278533936
Epoch: 4, Steps: 10 | Train Loss: 2.354 Vali Loss: 3.218 Vali Acc: 0.135 Test Loss: 3.218 Test Acc: 0.135
Validation loss decreased (-0.112909 --> -0.135262).  Saving model ...
Epoch: 5 cost time: 1.0045678615570068
Epoch: 5, Steps: 10 | Train Loss: 1.916 Vali Loss: 3.188 Vali Acc: 0.179 Test Loss: 3.188 Test Acc: 0.179
Validation loss decreased (-0.135262 --> -0.178792).  Saving model ...
Epoch: 6 cost time: 0.9951190948486328
Epoch: 6, Steps: 10 | Train Loss: 1.546 Vali Loss: 3.177 Vali Acc: 0.185 Test Loss: 3.177 Test Acc: 0.185
Validation loss decreased (-0.178792 --> -0.184674).  Saving model ...
Epoch: 7 cost time: 0.9636249542236328
Epoch: 7, Steps: 10 | Train Loss: 1.160 Vali Loss: 3.169 Vali Acc: 0.219 Test Loss: 3.169 Test Acc: 0.219
Validation loss decreased (-0.184674 --> -0.218792).  Saving model ...
Epoch: 8 cost time: 0.9917604923248291
Epoch: 8, Steps: 10 | Train Loss: 0.876 Vali Loss: 3.192 Vali Acc: 0.227 Test Loss: 3.192 Test Acc: 0.227
Validation loss decreased (-0.218792 --> -0.227027).  Saving model ...
Epoch: 9 cost time: 0.9669795036315918
Epoch: 9, Steps: 10 | Train Loss: 0.633 Vali Loss: 3.256 Vali Acc: 0.240 Test Loss: 3.256 Test Acc: 0.240
Validation loss decreased (-0.227027 --> -0.239967).  Saving model ...
Epoch: 10 cost time: 1.0395193099975586
Epoch: 10, Steps: 10 | Train Loss: 0.444 Vali Loss: 3.328 Vali Acc: 0.249 Test Loss: 3.328 Test Acc: 0.249
Validation loss decreased (-0.239967 --> -0.249378).  Saving model ...
Epoch: 11 cost time: 1.0077037811279297
Epoch: 11, Steps: 10 | Train Loss: 0.301 Vali Loss: 3.371 Vali Acc: 0.264 Test Loss: 3.371 Test Acc: 0.264
Validation loss decreased (-0.249378 --> -0.263496).  Saving model ...
Epoch: 12 cost time: 1.029050350189209
Epoch: 12, Steps: 10 | Train Loss: 0.198 Vali Loss: 3.436 Vali Acc: 0.269 Test Loss: 3.436 Test Acc: 0.269
Validation loss decreased (-0.263496 --> -0.269377).  Saving model ...
Epoch: 13 cost time: 1.117415189743042
Epoch: 13, Steps: 10 | Train Loss: 0.130 Vali Loss: 3.583 Vali Acc: 0.253 Test Loss: 3.583 Test Acc: 0.253
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0144758224487305
Epoch: 14, Steps: 10 | Train Loss: 0.094 Vali Loss: 3.601 Vali Acc: 0.268 Test Loss: 3.601 Test Acc: 0.268
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.109457015991211
Epoch: 15, Steps: 10 | Train Loss: 0.065 Vali Loss: 3.653 Vali Acc: 0.272 Test Loss: 3.653 Test Acc: 0.272
Validation loss decreased (-0.269377 --> -0.271728).  Saving model ...
Epoch: 16 cost time: 1.205106496810913
Epoch: 16, Steps: 10 | Train Loss: 0.051 Vali Loss: 3.681 Vali Acc: 0.271 Test Loss: 3.681 Test Acc: 0.271
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.067718505859375
Epoch: 17, Steps: 10 | Train Loss: 0.040 Vali Loss: 3.723 Vali Acc: 0.271 Test Loss: 3.723 Test Acc: 0.271
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.032092809677124
Epoch: 18, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.757 Vali Acc: 0.273 Test Loss: 3.757 Test Acc: 0.273
Validation loss decreased (-0.271728 --> -0.272904).  Saving model ...
Epoch: 19 cost time: 1.22117280960083
Epoch: 19, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.795 Vali Acc: 0.275 Test Loss: 3.795 Test Acc: 0.275
Validation loss decreased (-0.272904 --> -0.275256).  Saving model ...
Epoch: 20 cost time: 1.0607476234436035
Epoch: 20, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.849 Vali Acc: 0.273 Test Loss: 3.849 Test Acc: 0.273
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0552678108215332
Epoch: 21, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.877 Vali Acc: 0.275 Test Loss: 3.877 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.0047369003295898
Epoch: 22, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.897 Vali Acc: 0.281 Test Loss: 3.897 Test Acc: 0.281
Validation loss decreased (-0.275256 --> -0.281138).  Saving model ...
Epoch: 23 cost time: 1.111609935760498
Epoch: 23, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.918 Vali Acc: 0.282 Test Loss: 3.918 Test Acc: 0.282
Validation loss decreased (-0.281138 --> -0.282314).  Saving model ...
Epoch: 24 cost time: 1.0684096813201904
Epoch: 24, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.950 Vali Acc: 0.278 Test Loss: 3.950 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0026767253875732
Epoch: 25, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.994 Vali Acc: 0.275 Test Loss: 3.994 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.079319715499878
Epoch: 26, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.026 Vali Acc: 0.279 Test Loss: 4.026 Test Acc: 0.279
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.0061488151550293
Epoch: 27, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.055 Vali Acc: 0.273 Test Loss: 4.055 Test Acc: 0.273
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.0289065837860107
Epoch: 28, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.079 Vali Acc: 0.278 Test Loss: 4.079 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.9539384841918945
Epoch: 29, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.091 Vali Acc: 0.278 Test Loss: 4.091 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.2381348609924316
Epoch: 30, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.111 Vali Acc: 0.280 Test Loss: 4.111 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.9944698810577393
Epoch: 31, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.127 Vali Acc: 0.273 Test Loss: 4.127 Test Acc: 0.273
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.0559089183807373
Epoch: 32, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.136 Vali Acc: 0.274 Test Loss: 4.136 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.2249839305877686
Epoch: 33, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.156 Vali Acc: 0.280 Test Loss: 4.156 Test Acc: 0.280
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps38_str19_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2823529411764706
model parameter : 987930
model size : 3.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.5269062519073486
Epoch: 1, Steps: 10 | Train Loss: 3.346 Vali Loss: 3.266 Vali Acc: 0.059 Test Loss: 3.266 Test Acc: 0.059
Validation loss decreased (inf --> -0.058791).  Saving model ...
Epoch: 2 cost time: 1.0960524082183838
Epoch: 2, Steps: 10 | Train Loss: 2.561 Vali Loss: 3.245 Vali Acc: 0.119 Test Loss: 3.245 Test Acc: 0.119
Validation loss decreased (-0.058791 --> -0.118791).  Saving model ...
Epoch: 3 cost time: 1.0932140350341797
Epoch: 3, Steps: 10 | Train Loss: 1.551 Vali Loss: 3.249 Vali Acc: 0.176 Test Loss: 3.249 Test Acc: 0.176
Validation loss decreased (-0.118791 --> -0.176438).  Saving model ...
Epoch: 4 cost time: 1.093156337738037
Epoch: 4, Steps: 10 | Train Loss: 0.723 Vali Loss: 3.364 Vali Acc: 0.232 Test Loss: 3.364 Test Acc: 0.232
Validation loss decreased (-0.176438 --> -0.231731).  Saving model ...
Epoch: 5 cost time: 1.1171753406524658
Epoch: 5, Steps: 10 | Train Loss: 0.302 Vali Loss: 3.541 Vali Acc: 0.249 Test Loss: 3.541 Test Acc: 0.249
Validation loss decreased (-0.231731 --> -0.249376).  Saving model ...
Epoch: 6 cost time: 1.0910065174102783
Epoch: 6, Steps: 10 | Train Loss: 0.112 Vali Loss: 3.980 Vali Acc: 0.242 Test Loss: 3.980 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0053398609161377
Epoch: 7, Steps: 10 | Train Loss: 0.049 Vali Loss: 4.080 Vali Acc: 0.264 Test Loss: 4.080 Test Acc: 0.264
Validation loss decreased (-0.249376 --> -0.263489).  Saving model ...
Epoch: 8 cost time: 1.1935040950775146
Epoch: 8, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.213 Vali Acc: 0.262 Test Loss: 4.213 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.017765998840332
Epoch: 9, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.359 Vali Acc: 0.259 Test Loss: 4.359 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9684782028198242
Epoch: 10, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.362 Vali Acc: 0.261 Test Loss: 4.362 Test Acc: 0.261
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9853875637054443
Epoch: 11, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.396 Vali Acc: 0.267 Test Loss: 4.396 Test Acc: 0.267
Validation loss decreased (-0.263489 --> -0.267015).  Saving model ...
Epoch: 12 cost time: 1.0147967338562012
Epoch: 12, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.414 Vali Acc: 0.272 Test Loss: 4.414 Test Acc: 0.272
Validation loss decreased (-0.267015 --> -0.271721).  Saving model ...
Epoch: 13 cost time: 0.9870686531066895
Epoch: 13, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.435 Vali Acc: 0.272 Test Loss: 4.435 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0710833072662354
Epoch: 14, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.456 Vali Acc: 0.272 Test Loss: 4.456 Test Acc: 0.272
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1656932830810547
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.491 Vali Acc: 0.265 Test Loss: 4.491 Test Acc: 0.265
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9838531017303467
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.525 Vali Acc: 0.262 Test Loss: 4.525 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.1798317432403564
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.545 Vali Acc: 0.265 Test Loss: 4.545 Test Acc: 0.265
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.0213298797607422
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.553 Vali Acc: 0.269 Test Loss: 4.553 Test Acc: 0.269
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.0467872619628906
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.570 Vali Acc: 0.275 Test Loss: 4.570 Test Acc: 0.275
Validation loss decreased (-0.271721 --> -0.275248).  Saving model ...
Epoch: 20 cost time: 0.9870812892913818
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.598 Vali Acc: 0.275 Test Loss: 4.598 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0033671855926514
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.637 Vali Acc: 0.267 Test Loss: 4.637 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.0466830730438232
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.649 Vali Acc: 0.267 Test Loss: 4.649 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.0325438976287842
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.644 Vali Acc: 0.272 Test Loss: 4.644 Test Acc: 0.272
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.066631555557251
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.669 Vali Acc: 0.271 Test Loss: 4.669 Test Acc: 0.271
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.0544285774230957
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.696 Vali Acc: 0.271 Test Loss: 4.696 Test Acc: 0.271
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.052757978439331
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.715 Vali Acc: 0.271 Test Loss: 4.715 Test Acc: 0.271
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.1019675731658936
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.748 Vali Acc: 0.269 Test Loss: 4.748 Test Acc: 0.269
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.0373568534851074
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.770 Vali Acc: 0.267 Test Loss: 4.770 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.1091110706329346
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.788 Vali Acc: 0.268 Test Loss: 4.788 Test Acc: 0.268
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2752941176470588
model parameter : 971930
model size : 3.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.315159797668457
Epoch: 1, Steps: 10 | Train Loss: 3.259 Vali Loss: 3.277 Vali Acc: 0.054 Test Loss: 3.277 Test Acc: 0.054
Validation loss decreased (inf --> -0.054085).  Saving model ...
Epoch: 2 cost time: 0.9376399517059326
Epoch: 2, Steps: 10 | Train Loss: 2.878 Vali Loss: 3.265 Vali Acc: 0.078 Test Loss: 3.265 Test Acc: 0.078
Validation loss decreased (-0.054085 --> -0.077614).  Saving model ...
Epoch: 3 cost time: 1.0125153064727783
Epoch: 3, Steps: 10 | Train Loss: 2.191 Vali Loss: 3.231 Vali Acc: 0.128 Test Loss: 3.231 Test Acc: 0.128
Validation loss decreased (-0.077614 --> -0.128203).  Saving model ...
Epoch: 4 cost time: 1.0309827327728271
Epoch: 4, Steps: 10 | Train Loss: 1.519 Vali Loss: 3.204 Vali Acc: 0.174 Test Loss: 3.204 Test Acc: 0.174
Validation loss decreased (-0.128203 --> -0.174086).  Saving model ...
Epoch: 5 cost time: 0.9775550365447998
Epoch: 5, Steps: 10 | Train Loss: 0.960 Vali Loss: 3.255 Vali Acc: 0.204 Test Loss: 3.255 Test Acc: 0.204
Validation loss decreased (-0.174086 --> -0.203497).  Saving model ...
Epoch: 6 cost time: 0.9474825859069824
Epoch: 6, Steps: 10 | Train Loss: 0.566 Vali Loss: 3.378 Vali Acc: 0.216 Test Loss: 3.378 Test Acc: 0.216
Validation loss decreased (-0.203497 --> -0.216437).  Saving model ...
Epoch: 7 cost time: 0.9290177822113037
Epoch: 7, Steps: 10 | Train Loss: 0.334 Vali Loss: 3.532 Vali Acc: 0.239 Test Loss: 3.532 Test Acc: 0.239
Validation loss decreased (-0.216437 --> -0.238788).  Saving model ...
Epoch: 8 cost time: 0.8955192565917969
Epoch: 8, Steps: 10 | Train Loss: 0.187 Vali Loss: 3.751 Vali Acc: 0.235 Test Loss: 3.751 Test Acc: 0.235
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8731095790863037
Epoch: 9, Steps: 10 | Train Loss: 0.096 Vali Loss: 3.728 Vali Acc: 0.249 Test Loss: 3.728 Test Acc: 0.249
Validation loss decreased (-0.238788 --> -0.249374).  Saving model ...
Epoch: 10 cost time: 0.6430938243865967
Epoch: 10, Steps: 10 | Train Loss: 0.051 Vali Loss: 3.843 Vali Acc: 0.254 Test Loss: 3.843 Test Acc: 0.254
Validation loss decreased (-0.249374 --> -0.254079).  Saving model ...
Epoch: 11 cost time: 0.9247467517852783
Epoch: 11, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.956 Vali Acc: 0.261 Test Loss: 3.956 Test Acc: 0.261
Validation loss decreased (-0.254079 --> -0.261137).  Saving model ...
Epoch: 12 cost time: 0.8358559608459473
Epoch: 12, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.961 Vali Acc: 0.264 Test Loss: 3.961 Test Acc: 0.264
Validation loss decreased (-0.261137 --> -0.263490).  Saving model ...
Epoch: 13 cost time: 0.8933877944946289
Epoch: 13, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.995 Vali Acc: 0.262 Test Loss: 3.995 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9405655860900879
Epoch: 14, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.077 Vali Acc: 0.261 Test Loss: 4.077 Test Acc: 0.261
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0197336673736572
Epoch: 15, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.122 Vali Acc: 0.261 Test Loss: 4.122 Test Acc: 0.261
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9757900238037109
Epoch: 16, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.137 Vali Acc: 0.265 Test Loss: 4.137 Test Acc: 0.265
Validation loss decreased (-0.263490 --> -0.264665).  Saving model ...
Epoch: 17 cost time: 0.9584555625915527
Epoch: 17, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.167 Vali Acc: 0.259 Test Loss: 4.167 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.844113826751709
Epoch: 18, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.190 Vali Acc: 0.266 Test Loss: 4.190 Test Acc: 0.266
Validation loss decreased (-0.264665 --> -0.265840).  Saving model ...
Epoch: 19 cost time: 0.9350266456604004
Epoch: 19, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.244 Vali Acc: 0.264 Test Loss: 4.244 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9003496170043945
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.262 Vali Acc: 0.268 Test Loss: 4.262 Test Acc: 0.268
Validation loss decreased (-0.265840 --> -0.268193).  Saving model ...
Epoch: 21 cost time: 0.9193754196166992
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.261 Vali Acc: 0.268 Test Loss: 4.261 Test Acc: 0.268
Validation loss decreased (-0.268193 --> -0.268193).  Saving model ...
Epoch: 22 cost time: 0.862647294998169
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.284 Vali Acc: 0.272 Test Loss: 4.284 Test Acc: 0.272
Validation loss decreased (-0.268193 --> -0.271722).  Saving model ...
Epoch: 23 cost time: 0.8642134666442871
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.310 Vali Acc: 0.268 Test Loss: 4.310 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9206175804138184
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.337 Vali Acc: 0.267 Test Loss: 4.337 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.0137550830841064
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.370 Vali Acc: 0.267 Test Loss: 4.370 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.9267024993896484
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.400 Vali Acc: 0.267 Test Loss: 4.400 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.0067496299743652
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.419 Vali Acc: 0.272 Test Loss: 4.419 Test Acc: 0.272
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.8354229927062988
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.441 Vali Acc: 0.272 Test Loss: 4.441 Test Acc: 0.272
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.9357075691223145
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.467 Vali Acc: 0.274 Test Loss: 4.467 Test Acc: 0.274
Validation loss decreased (-0.271722 --> -0.274073).  Saving model ...
Epoch: 30 cost time: 0.9406707286834717
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.478 Vali Acc: 0.271 Test Loss: 4.478 Test Acc: 0.271
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.9553077220916748
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.492 Vali Acc: 0.269 Test Loss: 4.492 Test Acc: 0.269
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.9357743263244629
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.513 Vali Acc: 0.272 Test Loss: 4.513 Test Acc: 0.272
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.9233865737915039
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.537 Vali Acc: 0.273 Test Loss: 4.537 Test Acc: 0.273
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.8704068660736084
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.559 Vali Acc: 0.273 Test Loss: 4.559 Test Acc: 0.273
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.8282375335693359
Epoch: 35, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.586 Vali Acc: 0.273 Test Loss: 4.586 Test Acc: 0.273
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.0048792362213135
Epoch: 36, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.599 Vali Acc: 0.274 Test Loss: 4.599 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.0001904964447021
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.618 Vali Acc: 0.269 Test Loss: 4.618 Test Acc: 0.269
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.9161186218261719
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.636 Vali Acc: 0.272 Test Loss: 4.636 Test Acc: 0.272
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.933068037033081
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.654 Vali Acc: 0.271 Test Loss: 4.654 Test Acc: 0.271
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2741176470588235
model parameter : 593050
model size : 2.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps12_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.566162586212158
Epoch: 1, Steps: 10 | Train Loss: 3.349 Vali Loss: 3.294 Vali Acc: 0.036 Test Loss: 3.294 Test Acc: 0.036
Validation loss decreased (inf --> -0.036438).  Saving model ...
Epoch: 2 cost time: 0.8847525119781494
Epoch: 2, Steps: 10 | Train Loss: 3.014 Vali Loss: 3.268 Vali Acc: 0.076 Test Loss: 3.268 Test Acc: 0.076
Validation loss decreased (-0.036438 --> -0.076438).  Saving model ...
Epoch: 3 cost time: 0.8754875659942627
Epoch: 3, Steps: 10 | Train Loss: 2.498 Vali Loss: 3.252 Vali Acc: 0.125 Test Loss: 3.252 Test Acc: 0.125
Validation loss decreased (-0.076438 --> -0.124673).  Saving model ...
Epoch: 4 cost time: 0.79250168800354
Epoch: 4, Steps: 10 | Train Loss: 1.987 Vali Loss: 3.225 Vali Acc: 0.155 Test Loss: 3.225 Test Acc: 0.155
Validation loss decreased (-0.124673 --> -0.155262).  Saving model ...
Epoch: 5 cost time: 0.8283863067626953
Epoch: 5, Steps: 10 | Train Loss: 1.450 Vali Loss: 3.190 Vali Acc: 0.192 Test Loss: 3.190 Test Acc: 0.192
Validation loss decreased (-0.155262 --> -0.191733).  Saving model ...
Epoch: 6 cost time: 0.798454999923706
Epoch: 6, Steps: 10 | Train Loss: 0.995 Vali Loss: 3.219 Vali Acc: 0.212 Test Loss: 3.219 Test Acc: 0.212
Validation loss decreased (-0.191733 --> -0.211733).  Saving model ...
Epoch: 7 cost time: 0.8178305625915527
Epoch: 7, Steps: 10 | Train Loss: 0.657 Vali Loss: 3.289 Vali Acc: 0.241 Test Loss: 3.289 Test Acc: 0.241
Validation loss decreased (-0.211733 --> -0.241144).  Saving model ...
Epoch: 8 cost time: 0.942786693572998
Epoch: 8, Steps: 10 | Train Loss: 0.427 Vali Loss: 3.355 Vali Acc: 0.246 Test Loss: 3.355 Test Acc: 0.246
Validation loss decreased (-0.241144 --> -0.245849).  Saving model ...
Epoch: 9 cost time: 0.8242597579956055
Epoch: 9, Steps: 10 | Train Loss: 0.263 Vali Loss: 3.500 Vali Acc: 0.239 Test Loss: 3.500 Test Acc: 0.239
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.792365550994873
Epoch: 10, Steps: 10 | Train Loss: 0.151 Vali Loss: 3.585 Vali Acc: 0.246 Test Loss: 3.585 Test Acc: 0.246
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7887756824493408
Epoch: 11, Steps: 10 | Train Loss: 0.098 Vali Loss: 3.716 Vali Acc: 0.249 Test Loss: 3.716 Test Acc: 0.249
Validation loss decreased (-0.245849 --> -0.249375).  Saving model ...
Epoch: 12 cost time: 0.815201997756958
Epoch: 12, Steps: 10 | Train Loss: 0.059 Vali Loss: 3.826 Vali Acc: 0.253 Test Loss: 3.826 Test Acc: 0.253
Validation loss decreased (-0.249375 --> -0.252903).  Saving model ...
Epoch: 13 cost time: 0.8261470794677734
Epoch: 13, Steps: 10 | Train Loss: 0.042 Vali Loss: 3.849 Vali Acc: 0.252 Test Loss: 3.849 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8844318389892578
Epoch: 14, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.874 Vali Acc: 0.252 Test Loss: 3.874 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9054908752441406
Epoch: 15, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.898 Vali Acc: 0.253 Test Loss: 3.898 Test Acc: 0.253
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.7509174346923828
Epoch: 16, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.965 Vali Acc: 0.252 Test Loss: 3.965 Test Acc: 0.252
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.7780301570892334
Epoch: 17, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.012 Vali Acc: 0.253 Test Loss: 4.012 Test Acc: 0.253
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.8429884910583496
Epoch: 18, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.031 Vali Acc: 0.256 Test Loss: 4.031 Test Acc: 0.256
Validation loss decreased (-0.252903 --> -0.256430).  Saving model ...
Epoch: 19 cost time: 0.8768982887268066
Epoch: 19, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.053 Vali Acc: 0.258 Test Loss: 4.053 Test Acc: 0.258
Validation loss decreased (-0.256430 --> -0.257607).  Saving model ...
Epoch: 20 cost time: 0.9102177619934082
Epoch: 20, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.077 Vali Acc: 0.256 Test Loss: 4.077 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9547281265258789
Epoch: 21, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.115 Vali Acc: 0.252 Test Loss: 4.115 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.9244399070739746
Epoch: 22, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.142 Vali Acc: 0.255 Test Loss: 4.142 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.8556830883026123
Epoch: 23, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.162 Vali Acc: 0.259 Test Loss: 4.162 Test Acc: 0.259
Validation loss decreased (-0.257607 --> -0.258782).  Saving model ...
Epoch: 24 cost time: 0.9395415782928467
Epoch: 24, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.185 Vali Acc: 0.254 Test Loss: 4.185 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8652298450469971
Epoch: 25, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.229 Vali Acc: 0.259 Test Loss: 4.229 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.9326732158660889
Epoch: 26, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.254 Vali Acc: 0.259 Test Loss: 4.254 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.887836217880249
Epoch: 27, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.263 Vali Acc: 0.259 Test Loss: 4.263 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.8935089111328125
Epoch: 28, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.281 Vali Acc: 0.261 Test Loss: 4.281 Test Acc: 0.261
Validation loss decreased (-0.258782 --> -0.261134).  Saving model ...
Epoch: 29 cost time: 0.8801319599151611
Epoch: 29, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.311 Vali Acc: 0.258 Test Loss: 4.311 Test Acc: 0.258
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.8361830711364746
Epoch: 30, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.347 Vali Acc: 0.256 Test Loss: 4.347 Test Acc: 0.256
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.9162275791168213
Epoch: 31, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.369 Vali Acc: 0.258 Test Loss: 4.369 Test Acc: 0.258
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.9444847106933594
Epoch: 32, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.381 Vali Acc: 0.259 Test Loss: 4.381 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.8293395042419434
Epoch: 33, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.395 Vali Acc: 0.261 Test Loss: 4.395 Test Acc: 0.261
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.886277437210083
Epoch: 34, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.418 Vali Acc: 0.264 Test Loss: 4.418 Test Acc: 0.264
Validation loss decreased (-0.261134 --> -0.263485).  Saving model ...
Epoch: 35 cost time: 0.9860868453979492
Epoch: 35, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.430 Vali Acc: 0.260 Test Loss: 4.430 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.9638881683349609
Epoch: 36, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.453 Vali Acc: 0.260 Test Loss: 4.453 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.9926989078521729
Epoch: 37, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.482 Vali Acc: 0.261 Test Loss: 4.482 Test Acc: 0.261
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.943946123123169
Epoch: 38, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.514 Vali Acc: 0.258 Test Loss: 4.514 Test Acc: 0.258
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.852684497833252
Epoch: 39, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.540 Vali Acc: 0.261 Test Loss: 4.540 Test Acc: 0.261
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.9354860782623291
Epoch: 40, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.552 Vali Acc: 0.261 Test Loss: 4.552 Test Acc: 0.261
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.9153120517730713
Epoch: 41, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.578 Vali Acc: 0.262 Test Loss: 4.578 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.98758864402771
Epoch: 42, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.604 Vali Acc: 0.260 Test Loss: 4.604 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.9191172122955322
Epoch: 43, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.610 Vali Acc: 0.264 Test Loss: 4.610 Test Acc: 0.264
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.9398190975189209
Epoch: 44, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.634 Vali Acc: 0.262 Test Loss: 4.634 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps12_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2635294117647059
model parameter : 463770
model size : 1.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.3063559532165527
Epoch: 1, Steps: 10 | Train Loss: 3.341 Vali Loss: 3.276 Vali Acc: 0.040 Test Loss: 3.276 Test Acc: 0.040
Validation loss decreased (inf --> -0.039967).  Saving model ...
Epoch: 2 cost time: 0.8857364654541016
Epoch: 2, Steps: 10 | Train Loss: 3.113 Vali Loss: 3.255 Vali Acc: 0.074 Test Loss: 3.255 Test Acc: 0.074
Validation loss decreased (-0.039967 --> -0.074085).  Saving model ...
Epoch: 3 cost time: 0.8952081203460693
Epoch: 3, Steps: 10 | Train Loss: 2.672 Vali Loss: 3.247 Vali Acc: 0.082 Test Loss: 3.247 Test Acc: 0.082
Validation loss decreased (-0.074085 --> -0.082320).  Saving model ...
Epoch: 4 cost time: 0.912893533706665
Epoch: 4, Steps: 10 | Train Loss: 2.297 Vali Loss: 3.253 Vali Acc: 0.115 Test Loss: 3.253 Test Acc: 0.115
Validation loss decreased (-0.082320 --> -0.115262).  Saving model ...
Epoch: 5 cost time: 0.7724084854125977
Epoch: 5, Steps: 10 | Train Loss: 1.844 Vali Loss: 3.201 Vali Acc: 0.154 Test Loss: 3.201 Test Acc: 0.154
Validation loss decreased (-0.115262 --> -0.154086).  Saving model ...
Epoch: 6 cost time: 0.8241384029388428
Epoch: 6, Steps: 10 | Train Loss: 1.408 Vali Loss: 3.164 Vali Acc: 0.189 Test Loss: 3.164 Test Acc: 0.189
Validation loss decreased (-0.154086 --> -0.189380).  Saving model ...
Epoch: 7 cost time: 0.8083901405334473
Epoch: 7, Steps: 10 | Train Loss: 1.053 Vali Loss: 3.171 Vali Acc: 0.213 Test Loss: 3.171 Test Acc: 0.213
Validation loss decreased (-0.189380 --> -0.212909).  Saving model ...
Epoch: 8 cost time: 0.8758294582366943
Epoch: 8, Steps: 10 | Train Loss: 0.715 Vali Loss: 3.226 Vali Acc: 0.218 Test Loss: 3.226 Test Acc: 0.218
Validation loss decreased (-0.212909 --> -0.217615).  Saving model ...
Epoch: 9 cost time: 0.8627395629882812
Epoch: 9, Steps: 10 | Train Loss: 0.504 Vali Loss: 3.327 Vali Acc: 0.241 Test Loss: 3.327 Test Acc: 0.241
Validation loss decreased (-0.217615 --> -0.241143).  Saving model ...
Epoch: 10 cost time: 0.8119504451751709
Epoch: 10, Steps: 10 | Train Loss: 0.344 Vali Loss: 3.365 Vali Acc: 0.244 Test Loss: 3.365 Test Acc: 0.244
Validation loss decreased (-0.241143 --> -0.243496).  Saving model ...
Epoch: 11 cost time: 0.74074387550354
Epoch: 11, Steps: 10 | Train Loss: 0.223 Vali Loss: 3.457 Vali Acc: 0.253 Test Loss: 3.457 Test Acc: 0.253
Validation loss decreased (-0.243496 --> -0.252907).  Saving model ...
Epoch: 12 cost time: 0.7439041137695312
Epoch: 12, Steps: 10 | Train Loss: 0.144 Vali Loss: 3.567 Vali Acc: 0.242 Test Loss: 3.567 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7850463390350342
Epoch: 13, Steps: 10 | Train Loss: 0.094 Vali Loss: 3.634 Vali Acc: 0.249 Test Loss: 3.634 Test Acc: 0.249
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8687911033630371
Epoch: 14, Steps: 10 | Train Loss: 0.069 Vali Loss: 3.651 Vali Acc: 0.258 Test Loss: 3.651 Test Acc: 0.258
Validation loss decreased (-0.252907 --> -0.257611).  Saving model ...
Epoch: 15 cost time: 0.7970714569091797
Epoch: 15, Steps: 10 | Train Loss: 0.052 Vali Loss: 3.697 Vali Acc: 0.264 Test Loss: 3.697 Test Acc: 0.264
Validation loss decreased (-0.257611 --> -0.263492).  Saving model ...
Epoch: 16 cost time: 0.9304366111755371
Epoch: 16, Steps: 10 | Train Loss: 0.042 Vali Loss: 3.748 Vali Acc: 0.256 Test Loss: 3.748 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9234998226165771
Epoch: 17, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.783 Vali Acc: 0.264 Test Loss: 3.783 Test Acc: 0.264
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9507174491882324
Epoch: 18, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.804 Vali Acc: 0.264 Test Loss: 3.804 Test Acc: 0.264
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.9149880409240723
Epoch: 19, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.850 Vali Acc: 0.260 Test Loss: 3.850 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.8428564071655273
Epoch: 20, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.896 Vali Acc: 0.259 Test Loss: 3.896 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.7757503986358643
Epoch: 21, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.946 Vali Acc: 0.256 Test Loss: 3.946 Test Acc: 0.256
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.8414590358734131
Epoch: 22, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.977 Vali Acc: 0.259 Test Loss: 3.977 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.7841167449951172
Epoch: 23, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.994 Vali Acc: 0.264 Test Loss: 3.994 Test Acc: 0.264
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.8403987884521484
Epoch: 24, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.005 Vali Acc: 0.262 Test Loss: 4.005 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.8343753814697266
Epoch: 25, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.034 Vali Acc: 0.265 Test Loss: 4.034 Test Acc: 0.265
Validation loss decreased (-0.263492 --> -0.264666).  Saving model ...
Epoch: 26 cost time: 0.8027033805847168
Epoch: 26, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.052 Vali Acc: 0.264 Test Loss: 4.052 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8412876129150391
Epoch: 27, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.078 Vali Acc: 0.269 Test Loss: 4.078 Test Acc: 0.269
Validation loss decreased (-0.264666 --> -0.269371).  Saving model ...
Epoch: 28 cost time: 0.8973462581634521
Epoch: 28, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.107 Vali Acc: 0.267 Test Loss: 4.107 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9198272228240967
Epoch: 29, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.134 Vali Acc: 0.267 Test Loss: 4.134 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.9457180500030518
Epoch: 30, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.179 Vali Acc: 0.264 Test Loss: 4.179 Test Acc: 0.264
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.8260855674743652
Epoch: 31, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.210 Vali Acc: 0.262 Test Loss: 4.210 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.842125415802002
Epoch: 32, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.214 Vali Acc: 0.268 Test Loss: 4.214 Test Acc: 0.268
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.8589556217193604
Epoch: 33, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.225 Vali Acc: 0.267 Test Loss: 4.225 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.8480179309844971
Epoch: 34, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.248 Vali Acc: 0.265 Test Loss: 4.248 Test Acc: 0.265
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.9304673671722412
Epoch: 35, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.266 Vali Acc: 0.268 Test Loss: 4.266 Test Acc: 0.268
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.8851532936096191
Epoch: 36, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.291 Vali Acc: 0.268 Test Loss: 4.291 Test Acc: 0.268
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.9497959613800049
Epoch: 37, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.319 Vali Acc: 0.267 Test Loss: 4.319 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26941176470588235
model parameter : 404378
model size : 1.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps23_str12_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.328075885772705
Epoch: 1, Steps: 10 | Train Loss: 3.357 Vali Loss: 3.302 Vali Acc: 0.026 Test Loss: 3.302 Test Acc: 0.026
Validation loss decreased (inf --> -0.025849).  Saving model ...
Epoch: 2 cost time: 0.8676297664642334
Epoch: 2, Steps: 10 | Train Loss: 3.173 Vali Loss: 3.284 Vali Acc: 0.038 Test Loss: 3.284 Test Acc: 0.038
Validation loss decreased (-0.025849 --> -0.037614).  Saving model ...
Epoch: 3 cost time: 0.8848316669464111
Epoch: 3, Steps: 10 | Train Loss: 2.881 Vali Loss: 3.269 Vali Acc: 0.080 Test Loss: 3.269 Test Acc: 0.080
Validation loss decreased (-0.037614 --> -0.079967).  Saving model ...
Epoch: 4 cost time: 0.9189302921295166
Epoch: 4, Steps: 10 | Train Loss: 2.556 Vali Loss: 3.259 Vali Acc: 0.114 Test Loss: 3.259 Test Acc: 0.114
Validation loss decreased (-0.079967 --> -0.114085).  Saving model ...
Epoch: 5 cost time: 0.8556232452392578
Epoch: 5, Steps: 10 | Train Loss: 2.213 Vali Loss: 3.238 Vali Acc: 0.148 Test Loss: 3.238 Test Acc: 0.148
Validation loss decreased (-0.114085 --> -0.148203).  Saving model ...
Epoch: 6 cost time: 0.7864377498626709
Epoch: 6, Steps: 10 | Train Loss: 1.867 Vali Loss: 3.212 Vali Acc: 0.167 Test Loss: 3.212 Test Acc: 0.167
Validation loss decreased (-0.148203 --> -0.167027).  Saving model ...
Epoch: 7 cost time: 0.826737642288208
Epoch: 7, Steps: 10 | Train Loss: 1.565 Vali Loss: 3.193 Vali Acc: 0.176 Test Loss: 3.193 Test Acc: 0.176
Validation loss decreased (-0.167027 --> -0.176439).  Saving model ...
Epoch: 8 cost time: 0.9974849224090576
Epoch: 8, Steps: 10 | Train Loss: 1.214 Vali Loss: 3.192 Vali Acc: 0.196 Test Loss: 3.192 Test Acc: 0.196
Validation loss decreased (-0.176439 --> -0.196439).  Saving model ...
Epoch: 9 cost time: 0.9422521591186523
Epoch: 9, Steps: 10 | Train Loss: 0.968 Vali Loss: 3.216 Vali Acc: 0.215 Test Loss: 3.216 Test Acc: 0.215
Validation loss decreased (-0.196439 --> -0.215262).  Saving model ...
Epoch: 10 cost time: 0.9772446155548096
Epoch: 10, Steps: 10 | Train Loss: 0.755 Vali Loss: 3.261 Vali Acc: 0.219 Test Loss: 3.261 Test Acc: 0.219
Validation loss decreased (-0.215262 --> -0.218791).  Saving model ...
Epoch: 11 cost time: 0.9521725177764893
Epoch: 11, Steps: 10 | Train Loss: 0.562 Vali Loss: 3.294 Vali Acc: 0.239 Test Loss: 3.294 Test Acc: 0.239
Validation loss decreased (-0.218791 --> -0.238791).  Saving model ...
Epoch: 12 cost time: 0.8669676780700684
Epoch: 12, Steps: 10 | Train Loss: 0.439 Vali Loss: 3.342 Vali Acc: 0.247 Test Loss: 3.342 Test Acc: 0.247
Validation loss decreased (-0.238791 --> -0.247025).  Saving model ...
Epoch: 13 cost time: 0.9512641429901123
Epoch: 13, Steps: 10 | Train Loss: 0.301 Vali Loss: 3.416 Vali Acc: 0.246 Test Loss: 3.416 Test Acc: 0.246
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8961355686187744
Epoch: 14, Steps: 10 | Train Loss: 0.228 Vali Loss: 3.463 Vali Acc: 0.254 Test Loss: 3.463 Test Acc: 0.254
Validation loss decreased (-0.247025 --> -0.254083).  Saving model ...
Epoch: 15 cost time: 0.8817574977874756
Epoch: 15, Steps: 10 | Train Loss: 0.160 Vali Loss: 3.528 Vali Acc: 0.255 Test Loss: 3.528 Test Acc: 0.255
Validation loss decreased (-0.254083 --> -0.255259).  Saving model ...
Epoch: 16 cost time: 0.9666802883148193
Epoch: 16, Steps: 10 | Train Loss: 0.119 Vali Loss: 3.570 Vali Acc: 0.265 Test Loss: 3.570 Test Acc: 0.265
Validation loss decreased (-0.255259 --> -0.264670).  Saving model ...
Epoch: 17 cost time: 0.8505859375
Epoch: 17, Steps: 10 | Train Loss: 0.091 Vali Loss: 3.598 Vali Acc: 0.265 Test Loss: 3.598 Test Acc: 0.265
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8796830177307129
Epoch: 18, Steps: 10 | Train Loss: 0.070 Vali Loss: 3.641 Vali Acc: 0.262 Test Loss: 3.641 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.873781681060791
Epoch: 19, Steps: 10 | Train Loss: 0.059 Vali Loss: 3.683 Vali Acc: 0.265 Test Loss: 3.683 Test Acc: 0.265
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.7791275978088379
Epoch: 20, Steps: 10 | Train Loss: 0.053 Vali Loss: 3.715 Vali Acc: 0.265 Test Loss: 3.715 Test Acc: 0.265
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.9254536628723145
Epoch: 21, Steps: 10 | Train Loss: 0.043 Vali Loss: 3.740 Vali Acc: 0.265 Test Loss: 3.740 Test Acc: 0.265
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.8593730926513672
Epoch: 22, Steps: 10 | Train Loss: 0.037 Vali Loss: 3.778 Vali Acc: 0.266 Test Loss: 3.778 Test Acc: 0.266
Validation loss decreased (-0.264670 --> -0.265845).  Saving model ...
Epoch: 23 cost time: 0.8309218883514404
Epoch: 23, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.798 Vali Acc: 0.274 Test Loss: 3.798 Test Acc: 0.274
Validation loss decreased (-0.265845 --> -0.274080).  Saving model ...
Epoch: 24 cost time: 0.8068997859954834
Epoch: 24, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.837 Vali Acc: 0.273 Test Loss: 3.837 Test Acc: 0.273
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8418076038360596
Epoch: 25, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.865 Vali Acc: 0.271 Test Loss: 3.865 Test Acc: 0.271
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.8799099922180176
Epoch: 26, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.885 Vali Acc: 0.269 Test Loss: 3.885 Test Acc: 0.269
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.8652260303497314
Epoch: 27, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.912 Vali Acc: 0.269 Test Loss: 3.912 Test Acc: 0.269
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.9124045372009277
Epoch: 28, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.930 Vali Acc: 0.272 Test Loss: 3.930 Test Acc: 0.272
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.8494150638580322
Epoch: 29, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.954 Vali Acc: 0.274 Test Loss: 3.954 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.9242665767669678
Epoch: 30, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.970 Vali Acc: 0.273 Test Loss: 3.970 Test Acc: 0.273
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.880950927734375
Epoch: 31, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.998 Vali Acc: 0.272 Test Loss: 3.998 Test Acc: 0.272
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.8403923511505127
Epoch: 32, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.006 Vali Acc: 0.272 Test Loss: 4.006 Test Acc: 0.272
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.9716179370880127
Epoch: 33, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.026 Vali Acc: 0.275 Test Loss: 4.026 Test Acc: 0.275
Validation loss decreased (-0.274080 --> -0.275254).  Saving model ...
Epoch: 34 cost time: 1.0103113651275635
Epoch: 34, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.047 Vali Acc: 0.276 Test Loss: 4.047 Test Acc: 0.276
Validation loss decreased (-0.275254 --> -0.276430).  Saving model ...
Epoch: 35 cost time: 1.0456433296203613
Epoch: 35, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.064 Vali Acc: 0.268 Test Loss: 4.064 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.8939967155456543
Epoch: 36, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.096 Vali Acc: 0.271 Test Loss: 4.096 Test Acc: 0.271
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.9466466903686523
Epoch: 37, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.115 Vali Acc: 0.275 Test Loss: 4.115 Test Acc: 0.275
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.922065258026123
Epoch: 38, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.145 Vali Acc: 0.278 Test Loss: 4.145 Test Acc: 0.278
Validation loss decreased (-0.276430 --> -0.277606).  Saving model ...
Epoch: 39 cost time: 0.9758124351501465
Epoch: 39, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.173 Vali Acc: 0.276 Test Loss: 4.173 Test Acc: 0.276
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.8656256198883057
Epoch: 40, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.169 Vali Acc: 0.280 Test Loss: 4.169 Test Acc: 0.280
Validation loss decreased (-0.277606 --> -0.279958).  Saving model ...
Epoch: 41 cost time: 0.934767484664917
Epoch: 41, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.187 Vali Acc: 0.279 Test Loss: 4.187 Test Acc: 0.279
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.9370756149291992
Epoch: 42, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.225 Vali Acc: 0.278 Test Loss: 4.225 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.8568708896636963
Epoch: 43, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.239 Vali Acc: 0.276 Test Loss: 4.239 Test Acc: 0.276
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.8609459400177002
Epoch: 44, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.264 Vali Acc: 0.275 Test Loss: 4.264 Test Acc: 0.275
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.9795713424682617
Epoch: 45, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.268 Vali Acc: 0.275 Test Loss: 4.268 Test Acc: 0.275
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.0496597290039062
Epoch: 46, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.309 Vali Acc: 0.273 Test Loss: 4.309 Test Acc: 0.273
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.006469488143921
Epoch: 47, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.303 Vali Acc: 0.275 Test Loss: 4.303 Test Acc: 0.275
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 0.8046705722808838
Epoch: 48, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.318 Vali Acc: 0.275 Test Loss: 4.318 Test Acc: 0.275
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 0.8793272972106934
Epoch: 49, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.346 Vali Acc: 0.272 Test Loss: 4.346 Test Acc: 0.272
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 0.8671424388885498
Epoch: 50, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.364 Vali Acc: 0.275 Test Loss: 4.364 Test Acc: 0.275
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps23_str12_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.28
model parameter : 335386
model size : 1.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.4715335369110107
Epoch: 1, Steps: 10 | Train Loss: 3.367 Vali Loss: 3.299 Vali Acc: 0.047 Test Loss: 3.299 Test Acc: 0.047
Validation loss decreased (inf --> -0.047026).  Saving model ...
Epoch: 2 cost time: 0.837897539138794
Epoch: 2, Steps: 10 | Train Loss: 3.216 Vali Loss: 3.287 Vali Acc: 0.048 Test Loss: 3.287 Test Acc: 0.048
Validation loss decreased (-0.047026 --> -0.048202).  Saving model ...
Epoch: 3 cost time: 0.7811665534973145
Epoch: 3, Steps: 10 | Train Loss: 2.996 Vali Loss: 3.271 Vali Acc: 0.065 Test Loss: 3.271 Test Acc: 0.065
Validation loss decreased (-0.048202 --> -0.064673).  Saving model ...
Epoch: 4 cost time: 0.7961664199829102
Epoch: 4, Steps: 10 | Train Loss: 2.727 Vali Loss: 3.247 Vali Acc: 0.084 Test Loss: 3.247 Test Acc: 0.084
Validation loss decreased (-0.064673 --> -0.083497).  Saving model ...
Epoch: 5 cost time: 0.7805709838867188
Epoch: 5, Steps: 10 | Train Loss: 2.495 Vali Loss: 3.220 Vali Acc: 0.113 Test Loss: 3.220 Test Acc: 0.113
Validation loss decreased (-0.083497 --> -0.112909).  Saving model ...
Epoch: 6 cost time: 0.8235666751861572
Epoch: 6, Steps: 10 | Train Loss: 2.202 Vali Loss: 3.195 Vali Acc: 0.134 Test Loss: 3.195 Test Acc: 0.134
Validation loss decreased (-0.112909 --> -0.134086).  Saving model ...
Epoch: 7 cost time: 0.8127439022064209
Epoch: 7, Steps: 10 | Train Loss: 1.909 Vali Loss: 3.185 Vali Acc: 0.149 Test Loss: 3.185 Test Acc: 0.149
Validation loss decreased (-0.134086 --> -0.149380).  Saving model ...
Epoch: 8 cost time: 0.8780794143676758
Epoch: 8, Steps: 10 | Train Loss: 1.626 Vali Loss: 3.171 Vali Acc: 0.173 Test Loss: 3.171 Test Acc: 0.173
Validation loss decreased (-0.149380 --> -0.172909).  Saving model ...
Epoch: 9 cost time: 0.8821163177490234
Epoch: 9, Steps: 10 | Train Loss: 1.365 Vali Loss: 3.155 Vali Acc: 0.200 Test Loss: 3.155 Test Acc: 0.200
Validation loss decreased (-0.172909 --> -0.199968).  Saving model ...
Epoch: 10 cost time: 0.8169457912445068
Epoch: 10, Steps: 10 | Train Loss: 1.133 Vali Loss: 3.147 Vali Acc: 0.219 Test Loss: 3.147 Test Acc: 0.219
Validation loss decreased (-0.199968 --> -0.218792).  Saving model ...
Epoch: 11 cost time: 0.7299644947052002
Epoch: 11, Steps: 10 | Train Loss: 0.923 Vali Loss: 3.181 Vali Acc: 0.227 Test Loss: 3.181 Test Acc: 0.227
Validation loss decreased (-0.218792 --> -0.227027).  Saving model ...
Epoch: 12 cost time: 0.7801430225372314
Epoch: 12, Steps: 10 | Train Loss: 0.729 Vali Loss: 3.208 Vali Acc: 0.234 Test Loss: 3.208 Test Acc: 0.234
Validation loss decreased (-0.227027 --> -0.234086).  Saving model ...
Epoch: 13 cost time: 0.8170218467712402
Epoch: 13, Steps: 10 | Train Loss: 0.575 Vali Loss: 3.231 Vali Acc: 0.238 Test Loss: 3.231 Test Acc: 0.238
Validation loss decreased (-0.234086 --> -0.237615).  Saving model ...
Epoch: 14 cost time: 0.7560610771179199
Epoch: 14, Steps: 10 | Train Loss: 0.432 Vali Loss: 3.265 Vali Acc: 0.259 Test Loss: 3.265 Test Acc: 0.259
Validation loss decreased (-0.237615 --> -0.258791).  Saving model ...
Epoch: 15 cost time: 0.819901704788208
Epoch: 15, Steps: 10 | Train Loss: 0.343 Vali Loss: 3.345 Vali Acc: 0.255 Test Loss: 3.345 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7787964344024658
Epoch: 16, Steps: 10 | Train Loss: 0.266 Vali Loss: 3.372 Vali Acc: 0.264 Test Loss: 3.372 Test Acc: 0.264
Validation loss decreased (-0.258791 --> -0.263496).  Saving model ...
Epoch: 17 cost time: 0.8122208118438721
Epoch: 17, Steps: 10 | Train Loss: 0.191 Vali Loss: 3.433 Vali Acc: 0.265 Test Loss: 3.433 Test Acc: 0.265
Validation loss decreased (-0.263496 --> -0.264672).  Saving model ...
Epoch: 18 cost time: 0.7715246677398682
Epoch: 18, Steps: 10 | Train Loss: 0.148 Vali Loss: 3.500 Vali Acc: 0.260 Test Loss: 3.500 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.810335636138916
Epoch: 19, Steps: 10 | Train Loss: 0.117 Vali Loss: 3.520 Vali Acc: 0.269 Test Loss: 3.520 Test Acc: 0.269
Validation loss decreased (-0.264672 --> -0.269377).  Saving model ...
Epoch: 20 cost time: 0.806884765625
Epoch: 20, Steps: 10 | Train Loss: 0.094 Vali Loss: 3.553 Vali Acc: 0.269 Test Loss: 3.553 Test Acc: 0.269
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8348822593688965
Epoch: 21, Steps: 10 | Train Loss: 0.082 Vali Loss: 3.602 Vali Acc: 0.267 Test Loss: 3.602 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.862844705581665
Epoch: 22, Steps: 10 | Train Loss: 0.067 Vali Loss: 3.639 Vali Acc: 0.271 Test Loss: 3.639 Test Acc: 0.271
Validation loss decreased (-0.269377 --> -0.270552).  Saving model ...
Epoch: 23 cost time: 0.8274540901184082
Epoch: 23, Steps: 10 | Train Loss: 0.059 Vali Loss: 3.687 Vali Acc: 0.271 Test Loss: 3.687 Test Acc: 0.271
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9328041076660156
Epoch: 24, Steps: 10 | Train Loss: 0.049 Vali Loss: 3.723 Vali Acc: 0.267 Test Loss: 3.723 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.9358084201812744
Epoch: 25, Steps: 10 | Train Loss: 0.042 Vali Loss: 3.742 Vali Acc: 0.274 Test Loss: 3.742 Test Acc: 0.274
Validation loss decreased (-0.270552 --> -0.274080).  Saving model ...
Epoch: 26 cost time: 0.8095128536224365
Epoch: 26, Steps: 10 | Train Loss: 0.037 Vali Loss: 3.761 Vali Acc: 0.275 Test Loss: 3.761 Test Acc: 0.275
Validation loss decreased (-0.274080 --> -0.275257).  Saving model ...
Epoch: 27 cost time: 0.9139795303344727
Epoch: 27, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.800 Vali Acc: 0.276 Test Loss: 3.800 Test Acc: 0.276
Validation loss decreased (-0.275257 --> -0.276433).  Saving model ...
Epoch: 28 cost time: 0.9738264083862305
Epoch: 28, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.828 Vali Acc: 0.274 Test Loss: 3.828 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.8680722713470459
Epoch: 29, Steps: 10 | Train Loss: 0.027 Vali Loss: 3.880 Vali Acc: 0.275 Test Loss: 3.880 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.8679735660552979
Epoch: 30, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.896 Vali Acc: 0.273 Test Loss: 3.896 Test Acc: 0.273
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.8572385311126709
Epoch: 31, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.930 Vali Acc: 0.275 Test Loss: 3.930 Test Acc: 0.275
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.8254117965698242
Epoch: 32, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.970 Vali Acc: 0.275 Test Loss: 3.970 Test Acc: 0.275
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.8806159496307373
Epoch: 33, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.001 Vali Acc: 0.278 Test Loss: 4.001 Test Acc: 0.278
Validation loss decreased (-0.276433 --> -0.277607).  Saving model ...
Epoch: 34 cost time: 0.8855361938476562
Epoch: 34, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.031 Vali Acc: 0.269 Test Loss: 4.031 Test Acc: 0.269
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.8434407711029053
Epoch: 35, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.055 Vali Acc: 0.274 Test Loss: 4.055 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.9356794357299805
Epoch: 36, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.051 Vali Acc: 0.273 Test Loss: 4.051 Test Acc: 0.273
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.8681683540344238
Epoch: 37, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.070 Vali Acc: 0.276 Test Loss: 4.070 Test Acc: 0.276
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.8200421333312988
Epoch: 38, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.104 Vali Acc: 0.273 Test Loss: 4.104 Test Acc: 0.273
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.7765140533447266
Epoch: 39, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.121 Vali Acc: 0.275 Test Loss: 4.121 Test Acc: 0.275
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.8226485252380371
Epoch: 40, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.137 Vali Acc: 0.274 Test Loss: 4.137 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.8045346736907959
Epoch: 41, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.153 Vali Acc: 0.276 Test Loss: 4.153 Test Acc: 0.276
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.8769924640655518
Epoch: 42, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.192 Vali Acc: 0.276 Test Loss: 4.192 Test Acc: 0.276
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.8347630500793457
Epoch: 43, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.230 Vali Acc: 0.271 Test Loss: 4.230 Test Acc: 0.271
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2776470588235294
model parameter : 306458
model size : 1.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps38_str19_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.609653949737549
Epoch: 1, Steps: 10 | Train Loss: 3.352 Vali Loss: 3.302 Vali Acc: 0.041 Test Loss: 3.302 Test Acc: 0.041
Validation loss decreased (inf --> -0.041143).  Saving model ...
Epoch: 2 cost time: 0.886725664138794
Epoch: 2, Steps: 10 | Train Loss: 3.248 Vali Loss: 3.295 Vali Acc: 0.052 Test Loss: 3.295 Test Acc: 0.052
Validation loss decreased (-0.041143 --> -0.051732).  Saving model ...
Epoch: 3 cost time: 0.930422306060791
Epoch: 3, Steps: 10 | Train Loss: 3.035 Vali Loss: 3.281 Vali Acc: 0.068 Test Loss: 3.281 Test Acc: 0.068
Validation loss decreased (-0.051732 --> -0.068202).  Saving model ...
Epoch: 4 cost time: 0.9552743434906006
Epoch: 4, Steps: 10 | Train Loss: 2.807 Vali Loss: 3.267 Vali Acc: 0.088 Test Loss: 3.267 Test Acc: 0.088
Validation loss decreased (-0.068202 --> -0.088203).  Saving model ...
Epoch: 5 cost time: 0.8376030921936035
Epoch: 5, Steps: 10 | Train Loss: 2.574 Vali Loss: 3.254 Vali Acc: 0.099 Test Loss: 3.254 Test Acc: 0.099
Validation loss decreased (-0.088203 --> -0.098791).  Saving model ...
Epoch: 6 cost time: 0.8565967082977295
Epoch: 6, Steps: 10 | Train Loss: 2.301 Vali Loss: 3.231 Vali Acc: 0.134 Test Loss: 3.231 Test Acc: 0.134
Validation loss decreased (-0.098791 --> -0.134085).  Saving model ...
Epoch: 7 cost time: 0.8378438949584961
Epoch: 7, Steps: 10 | Train Loss: 2.031 Vali Loss: 3.211 Vali Acc: 0.147 Test Loss: 3.211 Test Acc: 0.147
Validation loss decreased (-0.134085 --> -0.147027).  Saving model ...
Epoch: 8 cost time: 0.8817403316497803
Epoch: 8, Steps: 10 | Train Loss: 1.804 Vali Loss: 3.192 Vali Acc: 0.164 Test Loss: 3.192 Test Acc: 0.164
Validation loss decreased (-0.147027 --> -0.163497).  Saving model ...
Epoch: 9 cost time: 0.9230895042419434
Epoch: 9, Steps: 10 | Train Loss: 1.535 Vali Loss: 3.174 Vali Acc: 0.179 Test Loss: 3.174 Test Acc: 0.179
Validation loss decreased (-0.163497 --> -0.178792).  Saving model ...
Epoch: 10 cost time: 0.7900979518890381
Epoch: 10, Steps: 10 | Train Loss: 1.287 Vali Loss: 3.177 Vali Acc: 0.184 Test Loss: 3.177 Test Acc: 0.184
Validation loss decreased (-0.178792 --> -0.183498).  Saving model ...
Epoch: 11 cost time: 0.8267645835876465
Epoch: 11, Steps: 10 | Train Loss: 1.101 Vali Loss: 3.176 Vali Acc: 0.195 Test Loss: 3.176 Test Acc: 0.195
Validation loss decreased (-0.183498 --> -0.195262).  Saving model ...
Epoch: 12 cost time: 0.7938094139099121
Epoch: 12, Steps: 10 | Train Loss: 0.910 Vali Loss: 3.206 Vali Acc: 0.219 Test Loss: 3.206 Test Acc: 0.219
Validation loss decreased (-0.195262 --> -0.218791).  Saving model ...
Epoch: 13 cost time: 0.967029333114624
Epoch: 13, Steps: 10 | Train Loss: 0.728 Vali Loss: 3.227 Vali Acc: 0.216 Test Loss: 3.227 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.894606351852417
Epoch: 14, Steps: 10 | Train Loss: 0.581 Vali Loss: 3.271 Vali Acc: 0.228 Test Loss: 3.271 Test Acc: 0.228
Validation loss decreased (-0.218791 --> -0.228203).  Saving model ...
Epoch: 15 cost time: 0.9206135272979736
Epoch: 15, Steps: 10 | Train Loss: 0.453 Vali Loss: 3.304 Vali Acc: 0.235 Test Loss: 3.304 Test Acc: 0.235
Validation loss decreased (-0.228203 --> -0.235261).  Saving model ...
Epoch: 16 cost time: 0.873856782913208
Epoch: 16, Steps: 10 | Train Loss: 0.355 Vali Loss: 3.371 Vali Acc: 0.240 Test Loss: 3.371 Test Acc: 0.240
Validation loss decreased (-0.235261 --> -0.239966).  Saving model ...
Epoch: 17 cost time: 0.9426271915435791
Epoch: 17, Steps: 10 | Train Loss: 0.270 Vali Loss: 3.424 Vali Acc: 0.245 Test Loss: 3.424 Test Acc: 0.245
Validation loss decreased (-0.239966 --> -0.244672).  Saving model ...
Epoch: 18 cost time: 0.8832578659057617
Epoch: 18, Steps: 10 | Train Loss: 0.212 Vali Loss: 3.464 Vali Acc: 0.253 Test Loss: 3.464 Test Acc: 0.253
Validation loss decreased (-0.244672 --> -0.252907).  Saving model ...
Epoch: 19 cost time: 0.9708993434906006
Epoch: 19, Steps: 10 | Train Loss: 0.164 Vali Loss: 3.497 Vali Acc: 0.254 Test Loss: 3.497 Test Acc: 0.254
Validation loss decreased (-0.252907 --> -0.254083).  Saving model ...
Epoch: 20 cost time: 0.8482820987701416
Epoch: 20, Steps: 10 | Train Loss: 0.136 Vali Loss: 3.525 Vali Acc: 0.249 Test Loss: 3.525 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8077139854431152
Epoch: 21, Steps: 10 | Train Loss: 0.109 Vali Loss: 3.566 Vali Acc: 0.254 Test Loss: 3.566 Test Acc: 0.254
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.8476498126983643
Epoch: 22, Steps: 10 | Train Loss: 0.088 Vali Loss: 3.603 Vali Acc: 0.259 Test Loss: 3.603 Test Acc: 0.259
Validation loss decreased (-0.254083 --> -0.258787).  Saving model ...
Epoch: 23 cost time: 0.8218319416046143
Epoch: 23, Steps: 10 | Train Loss: 0.071 Vali Loss: 3.633 Vali Acc: 0.258 Test Loss: 3.633 Test Acc: 0.258
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0334446430206299
Epoch: 24, Steps: 10 | Train Loss: 0.064 Vali Loss: 3.664 Vali Acc: 0.261 Test Loss: 3.664 Test Acc: 0.261
Validation loss decreased (-0.258787 --> -0.261140).  Saving model ...
Epoch: 25 cost time: 0.8734407424926758
Epoch: 25, Steps: 10 | Train Loss: 0.056 Vali Loss: 3.708 Vali Acc: 0.259 Test Loss: 3.708 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.00099515914917
Epoch: 26, Steps: 10 | Train Loss: 0.050 Vali Loss: 3.735 Vali Acc: 0.254 Test Loss: 3.735 Test Acc: 0.254
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.9956333637237549
Epoch: 27, Steps: 10 | Train Loss: 0.042 Vali Loss: 3.767 Vali Acc: 0.258 Test Loss: 3.767 Test Acc: 0.258
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.9623191356658936
Epoch: 28, Steps: 10 | Train Loss: 0.036 Vali Loss: 3.786 Vali Acc: 0.265 Test Loss: 3.786 Test Acc: 0.265
Validation loss decreased (-0.261140 --> -0.264668).  Saving model ...
Epoch: 29 cost time: 0.8738076686859131
Epoch: 29, Steps: 10 | Train Loss: 0.033 Vali Loss: 3.830 Vali Acc: 0.265 Test Loss: 3.830 Test Acc: 0.265
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.8267972469329834
Epoch: 30, Steps: 10 | Train Loss: 0.031 Vali Loss: 3.861 Vali Acc: 0.264 Test Loss: 3.861 Test Acc: 0.264
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.81903076171875
Epoch: 31, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.867 Vali Acc: 0.266 Test Loss: 3.867 Test Acc: 0.266
Validation loss decreased (-0.264668 --> -0.265844).  Saving model ...
Epoch: 32 cost time: 0.8745574951171875
Epoch: 32, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.914 Vali Acc: 0.262 Test Loss: 3.914 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.8247873783111572
Epoch: 33, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.928 Vali Acc: 0.264 Test Loss: 3.928 Test Acc: 0.264
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.8996949195861816
Epoch: 34, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.975 Vali Acc: 0.262 Test Loss: 3.975 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.9311685562133789
Epoch: 35, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.000 Vali Acc: 0.267 Test Loss: 4.000 Test Acc: 0.267
Validation loss decreased (-0.265844 --> -0.267019).  Saving model ...
Epoch: 36 cost time: 0.7958781719207764
Epoch: 36, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.999 Vali Acc: 0.264 Test Loss: 3.999 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.0353798866271973
Epoch: 37, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.021 Vali Acc: 0.264 Test Loss: 4.021 Test Acc: 0.264
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.8652784824371338
Epoch: 38, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.036 Vali Acc: 0.264 Test Loss: 4.036 Test Acc: 0.264
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.8575983047485352
Epoch: 39, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.064 Vali Acc: 0.265 Test Loss: 4.064 Test Acc: 0.265
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.8432435989379883
Epoch: 40, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.092 Vali Acc: 0.264 Test Loss: 4.092 Test Acc: 0.264
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.8678567409515381
Epoch: 41, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.118 Vali Acc: 0.266 Test Loss: 4.118 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.7769513130187988
Epoch: 42, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.139 Vali Acc: 0.266 Test Loss: 4.139 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.735680341720581
Epoch: 43, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.152 Vali Acc: 0.272 Test Loss: 4.152 Test Acc: 0.272
Validation loss decreased (-0.267019 --> -0.271723).  Saving model ...
Epoch: 44 cost time: 0.8315677642822266
Epoch: 44, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.166 Vali Acc: 0.271 Test Loss: 4.166 Test Acc: 0.271
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.8905181884765625
Epoch: 45, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.188 Vali Acc: 0.268 Test Loss: 4.188 Test Acc: 0.268
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.7565617561340332
Epoch: 46, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.216 Vali Acc: 0.271 Test Loss: 4.216 Test Acc: 0.271
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.7815885543823242
Epoch: 47, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.240 Vali Acc: 0.269 Test Loss: 4.240 Test Acc: 0.269
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.7202229499816895
Epoch: 48, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.252 Vali Acc: 0.265 Test Loss: 4.252 Test Acc: 0.265
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.7484941482543945
Epoch: 49, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.282 Vali Acc: 0.267 Test Loss: 4.282 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.7707540988922119
Epoch: 50, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.288 Vali Acc: 0.268 Test Loss: 4.288 Test Acc: 0.268
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps38_str19_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27176470588235296
model parameter : 297370
model size : 1.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.554434299468994
Epoch: 1, Steps: 10 | Train Loss: 3.408 Vali Loss: 3.294 Vali Acc: 0.042 Test Loss: 3.294 Test Acc: 0.042
Validation loss decreased (inf --> -0.042320).  Saving model ...
Epoch: 2 cost time: 0.8186907768249512
Epoch: 2, Steps: 10 | Train Loss: 2.935 Vali Loss: 3.282 Vali Acc: 0.080 Test Loss: 3.282 Test Acc: 0.080
Validation loss decreased (-0.042320 --> -0.079967).  Saving model ...
Epoch: 3 cost time: 0.7717044353485107
Epoch: 3, Steps: 10 | Train Loss: 2.265 Vali Loss: 3.245 Vali Acc: 0.135 Test Loss: 3.245 Test Acc: 0.135
Validation loss decreased (-0.079967 --> -0.135262).  Saving model ...
Epoch: 4 cost time: 0.7399964332580566
Epoch: 4, Steps: 10 | Train Loss: 1.567 Vali Loss: 3.203 Vali Acc: 0.169 Test Loss: 3.203 Test Acc: 0.169
Validation loss decreased (-0.135262 --> -0.169380).  Saving model ...
Epoch: 5 cost time: 0.7591996192932129
Epoch: 5, Steps: 10 | Train Loss: 1.006 Vali Loss: 3.248 Vali Acc: 0.202 Test Loss: 3.248 Test Acc: 0.202
Validation loss decreased (-0.169380 --> -0.202320).  Saving model ...
Epoch: 6 cost time: 0.8303179740905762
Epoch: 6, Steps: 10 | Train Loss: 0.614 Vali Loss: 3.364 Vali Acc: 0.226 Test Loss: 3.364 Test Acc: 0.226
Validation loss decreased (-0.202320 --> -0.225849).  Saving model ...
Epoch: 7 cost time: 0.7773549556732178
Epoch: 7, Steps: 10 | Train Loss: 0.335 Vali Loss: 3.493 Vali Acc: 0.231 Test Loss: 3.493 Test Acc: 0.231
Validation loss decreased (-0.225849 --> -0.230553).  Saving model ...
Epoch: 8 cost time: 0.7845568656921387
Epoch: 8, Steps: 10 | Train Loss: 0.160 Vali Loss: 3.607 Vali Acc: 0.248 Test Loss: 3.607 Test Acc: 0.248
Validation loss decreased (-0.230553 --> -0.248199).  Saving model ...
Epoch: 9 cost time: 0.7977128028869629
Epoch: 9, Steps: 10 | Train Loss: 0.078 Vali Loss: 3.778 Vali Acc: 0.244 Test Loss: 3.778 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7919528484344482
Epoch: 10, Steps: 10 | Train Loss: 0.045 Vali Loss: 3.865 Vali Acc: 0.245 Test Loss: 3.865 Test Acc: 0.245
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8829209804534912
Epoch: 11, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.947 Vali Acc: 0.252 Test Loss: 3.947 Test Acc: 0.252
Validation loss decreased (-0.248199 --> -0.251725).  Saving model ...
Epoch: 12 cost time: 0.8118386268615723
Epoch: 12, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.010 Vali Acc: 0.251 Test Loss: 4.010 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7556631565093994
Epoch: 13, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.053 Vali Acc: 0.245 Test Loss: 4.053 Test Acc: 0.245
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9142875671386719
Epoch: 14, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.087 Vali Acc: 0.246 Test Loss: 4.087 Test Acc: 0.246
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8948726654052734
Epoch: 15, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.116 Vali Acc: 0.249 Test Loss: 4.116 Test Acc: 0.249
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.8664047718048096
Epoch: 16, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.137 Vali Acc: 0.249 Test Loss: 4.137 Test Acc: 0.249
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.8759901523590088
Epoch: 17, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.158 Vali Acc: 0.249 Test Loss: 4.158 Test Acc: 0.249
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.7757563591003418
Epoch: 18, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.195 Vali Acc: 0.247 Test Loss: 4.195 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.8118414878845215
Epoch: 19, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.239 Vali Acc: 0.246 Test Loss: 4.239 Test Acc: 0.246
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.9644351005554199
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.265 Vali Acc: 0.244 Test Loss: 4.265 Test Acc: 0.244
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.8646700382232666
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.278 Vali Acc: 0.251 Test Loss: 4.278 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.25176470588235295
model parameter : 436826
model size : 1.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.3238351345062256
Epoch: 1, Steps: 10 | Train Loss: 3.350 Vali Loss: 3.286 Vali Acc: 0.042 Test Loss: 3.286 Test Acc: 0.042
Validation loss decreased (inf --> -0.042320).  Saving model ...
Epoch: 2 cost time: 0.8483791351318359
Epoch: 2, Steps: 10 | Train Loss: 3.061 Vali Loss: 3.261 Vali Acc: 0.069 Test Loss: 3.261 Test Acc: 0.069
Validation loss decreased (-0.042320 --> -0.069379).  Saving model ...
Epoch: 3 cost time: 0.8600070476531982
Epoch: 3, Steps: 10 | Train Loss: 2.680 Vali Loss: 3.264 Vali Acc: 0.088 Test Loss: 3.264 Test Acc: 0.088
Validation loss decreased (-0.069379 --> -0.088203).  Saving model ...
Epoch: 4 cost time: 0.7998402118682861
Epoch: 4, Steps: 10 | Train Loss: 2.241 Vali Loss: 3.239 Vali Acc: 0.128 Test Loss: 3.239 Test Acc: 0.128
Validation loss decreased (-0.088203 --> -0.128203).  Saving model ...
Epoch: 5 cost time: 0.8370273113250732
Epoch: 5, Steps: 10 | Train Loss: 1.780 Vali Loss: 3.195 Vali Acc: 0.144 Test Loss: 3.195 Test Acc: 0.144
Validation loss decreased (-0.128203 --> -0.143497).  Saving model ...
Epoch: 6 cost time: 0.8898046016693115
Epoch: 6, Steps: 10 | Train Loss: 1.391 Vali Loss: 3.176 Vali Acc: 0.199 Test Loss: 3.176 Test Acc: 0.199
Validation loss decreased (-0.143497 --> -0.198792).  Saving model ...
Epoch: 7 cost time: 0.8207902908325195
Epoch: 7, Steps: 10 | Train Loss: 1.032 Vali Loss: 3.201 Vali Acc: 0.219 Test Loss: 3.201 Test Acc: 0.219
Validation loss decreased (-0.198792 --> -0.218792).  Saving model ...
Epoch: 8 cost time: 0.8784353733062744
Epoch: 8, Steps: 10 | Train Loss: 0.730 Vali Loss: 3.260 Vali Acc: 0.216 Test Loss: 3.260 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.866741418838501
Epoch: 9, Steps: 10 | Train Loss: 0.499 Vali Loss: 3.305 Vali Acc: 0.245 Test Loss: 3.305 Test Acc: 0.245
Validation loss decreased (-0.218792 --> -0.244673).  Saving model ...
Epoch: 10 cost time: 0.8449745178222656
Epoch: 10, Steps: 10 | Train Loss: 0.355 Vali Loss: 3.397 Vali Acc: 0.238 Test Loss: 3.397 Test Acc: 0.238
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8763303756713867
Epoch: 11, Steps: 10 | Train Loss: 0.225 Vali Loss: 3.490 Vali Acc: 0.245 Test Loss: 3.490 Test Acc: 0.245
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8498058319091797
Epoch: 12, Steps: 10 | Train Loss: 0.153 Vali Loss: 3.535 Vali Acc: 0.261 Test Loss: 3.535 Test Acc: 0.261
Validation loss decreased (-0.244673 --> -0.261141).  Saving model ...
Epoch: 13 cost time: 0.873380184173584
Epoch: 13, Steps: 10 | Train Loss: 0.099 Vali Loss: 3.682 Vali Acc: 0.245 Test Loss: 3.682 Test Acc: 0.245
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8451459407806396
Epoch: 14, Steps: 10 | Train Loss: 0.072 Vali Loss: 3.706 Vali Acc: 0.259 Test Loss: 3.706 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8253674507141113
Epoch: 15, Steps: 10 | Train Loss: 0.054 Vali Loss: 3.706 Vali Acc: 0.265 Test Loss: 3.706 Test Acc: 0.265
Validation loss decreased (-0.261141 --> -0.264669).  Saving model ...
Epoch: 16 cost time: 0.8718178272247314
Epoch: 16, Steps: 10 | Train Loss: 0.041 Vali Loss: 3.756 Vali Acc: 0.255 Test Loss: 3.756 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8754265308380127
Epoch: 17, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.809 Vali Acc: 0.259 Test Loss: 3.809 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8530645370483398
Epoch: 18, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.839 Vali Acc: 0.259 Test Loss: 3.839 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.8734915256500244
Epoch: 19, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.881 Vali Acc: 0.254 Test Loss: 3.881 Test Acc: 0.254
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.863605260848999
Epoch: 20, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.912 Vali Acc: 0.255 Test Loss: 3.912 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.9196667671203613
Epoch: 21, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.945 Vali Acc: 0.258 Test Loss: 3.945 Test Acc: 0.258
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.8352787494659424
Epoch: 22, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.968 Vali Acc: 0.259 Test Loss: 3.968 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.0066578388214111
Epoch: 23, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.996 Vali Acc: 0.258 Test Loss: 3.996 Test Acc: 0.258
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.9193515777587891
Epoch: 24, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.028 Vali Acc: 0.261 Test Loss: 4.028 Test Acc: 0.261
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.957857608795166
Epoch: 25, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.054 Vali Acc: 0.256 Test Loss: 4.054 Test Acc: 0.256
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2647058823529412
model parameter : 247386
model size : 0.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps12_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.71488094329834
Epoch: 1, Steps: 10 | Train Loss: 3.379 Vali Loss: 3.278 Vali Acc: 0.061 Test Loss: 3.278 Test Acc: 0.061
Validation loss decreased (inf --> -0.061144).  Saving model ...
Epoch: 2 cost time: 0.8014068603515625
Epoch: 2, Steps: 10 | Train Loss: 3.210 Vali Loss: 3.255 Vali Acc: 0.079 Test Loss: 3.255 Test Acc: 0.079
Validation loss decreased (-0.061144 --> -0.078791).  Saving model ...
Epoch: 3 cost time: 0.7736184597015381
Epoch: 3, Steps: 10 | Train Loss: 2.920 Vali Loss: 3.242 Vali Acc: 0.095 Test Loss: 3.242 Test Acc: 0.095
Validation loss decreased (-0.078791 --> -0.095262).  Saving model ...
Epoch: 4 cost time: 0.756263017654419
Epoch: 4, Steps: 10 | Train Loss: 2.607 Vali Loss: 3.235 Vali Acc: 0.109 Test Loss: 3.235 Test Acc: 0.109
Validation loss decreased (-0.095262 --> -0.109379).  Saving model ...
Epoch: 5 cost time: 0.8637359142303467
Epoch: 5, Steps: 10 | Train Loss: 2.276 Vali Loss: 3.213 Vali Acc: 0.135 Test Loss: 3.213 Test Acc: 0.135
Validation loss decreased (-0.109379 --> -0.135262).  Saving model ...
Epoch: 6 cost time: 0.881345272064209
Epoch: 6, Steps: 10 | Train Loss: 1.930 Vali Loss: 3.185 Vali Acc: 0.164 Test Loss: 3.185 Test Acc: 0.164
Validation loss decreased (-0.135262 --> -0.163498).  Saving model ...
Epoch: 7 cost time: 0.8736701011657715
Epoch: 7, Steps: 10 | Train Loss: 1.602 Vali Loss: 3.166 Vali Acc: 0.174 Test Loss: 3.166 Test Acc: 0.174
Validation loss decreased (-0.163498 --> -0.174086).  Saving model ...
Epoch: 8 cost time: 0.9640040397644043
Epoch: 8, Steps: 10 | Train Loss: 1.322 Vali Loss: 3.171 Vali Acc: 0.191 Test Loss: 3.171 Test Acc: 0.191
Validation loss decreased (-0.174086 --> -0.190557).  Saving model ...
Epoch: 9 cost time: 0.8943967819213867
Epoch: 9, Steps: 10 | Train Loss: 1.024 Vali Loss: 3.187 Vali Acc: 0.214 Test Loss: 3.187 Test Acc: 0.214
Validation loss decreased (-0.190557 --> -0.214086).  Saving model ...
Epoch: 10 cost time: 0.9325685501098633
Epoch: 10, Steps: 10 | Train Loss: 0.783 Vali Loss: 3.210 Vali Acc: 0.228 Test Loss: 3.210 Test Acc: 0.228
Validation loss decreased (-0.214086 --> -0.228203).  Saving model ...
Epoch: 11 cost time: 0.989849328994751
Epoch: 11, Steps: 10 | Train Loss: 0.589 Vali Loss: 3.269 Vali Acc: 0.232 Test Loss: 3.269 Test Acc: 0.232
Validation loss decreased (-0.228203 --> -0.231732).  Saving model ...
Epoch: 12 cost time: 0.7396149635314941
Epoch: 12, Steps: 10 | Train Loss: 0.429 Vali Loss: 3.352 Vali Acc: 0.235 Test Loss: 3.352 Test Acc: 0.235
Validation loss decreased (-0.231732 --> -0.235261).  Saving model ...
Epoch: 13 cost time: 0.7967181205749512
Epoch: 13, Steps: 10 | Train Loss: 0.317 Vali Loss: 3.380 Vali Acc: 0.242 Test Loss: 3.380 Test Acc: 0.242
Validation loss decreased (-0.235261 --> -0.242319).  Saving model ...
Epoch: 14 cost time: 0.8258998394012451
Epoch: 14, Steps: 10 | Train Loss: 0.225 Vali Loss: 3.455 Vali Acc: 0.251 Test Loss: 3.455 Test Acc: 0.251
Validation loss decreased (-0.242319 --> -0.250554).  Saving model ...
Epoch: 15 cost time: 0.9442827701568604
Epoch: 15, Steps: 10 | Train Loss: 0.162 Vali Loss: 3.521 Vali Acc: 0.253 Test Loss: 3.521 Test Acc: 0.253
Validation loss decreased (-0.250554 --> -0.252906).  Saving model ...
Epoch: 16 cost time: 0.7968399524688721
Epoch: 16, Steps: 10 | Train Loss: 0.120 Vali Loss: 3.583 Vali Acc: 0.249 Test Loss: 3.583 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8736534118652344
Epoch: 17, Steps: 10 | Train Loss: 0.098 Vali Loss: 3.632 Vali Acc: 0.251 Test Loss: 3.632 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.85723876953125
Epoch: 18, Steps: 10 | Train Loss: 0.078 Vali Loss: 3.666 Vali Acc: 0.255 Test Loss: 3.666 Test Acc: 0.255
Validation loss decreased (-0.252906 --> -0.255257).  Saving model ...
Epoch: 19 cost time: 0.8577890396118164
Epoch: 19, Steps: 10 | Train Loss: 0.061 Vali Loss: 3.718 Vali Acc: 0.256 Test Loss: 3.718 Test Acc: 0.256
Validation loss decreased (-0.255257 --> -0.256433).  Saving model ...
Epoch: 20 cost time: 0.8874719142913818
Epoch: 20, Steps: 10 | Train Loss: 0.053 Vali Loss: 3.758 Vali Acc: 0.259 Test Loss: 3.758 Test Acc: 0.259
Validation loss decreased (-0.256433 --> -0.258786).  Saving model ...
Epoch: 21 cost time: 0.8529791831970215
Epoch: 21, Steps: 10 | Train Loss: 0.045 Vali Loss: 3.800 Vali Acc: 0.256 Test Loss: 3.800 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8676621913909912
Epoch: 22, Steps: 10 | Train Loss: 0.037 Vali Loss: 3.837 Vali Acc: 0.253 Test Loss: 3.837 Test Acc: 0.253
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.8753166198730469
Epoch: 23, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.877 Vali Acc: 0.255 Test Loss: 3.877 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.7768573760986328
Epoch: 24, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.902 Vali Acc: 0.258 Test Loss: 3.902 Test Acc: 0.258
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.8984646797180176
Epoch: 25, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.935 Vali Acc: 0.258 Test Loss: 3.935 Test Acc: 0.258
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.0079407691955566
Epoch: 26, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.970 Vali Acc: 0.256 Test Loss: 3.970 Test Acc: 0.256
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.9201829433441162
Epoch: 27, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.004 Vali Acc: 0.258 Test Loss: 4.004 Test Acc: 0.258
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.8597395420074463
Epoch: 28, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.033 Vali Acc: 0.259 Test Loss: 4.033 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.9396209716796875
Epoch: 29, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.044 Vali Acc: 0.256 Test Loss: 4.044 Test Acc: 0.256
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.8890523910522461
Epoch: 30, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.081 Vali Acc: 0.256 Test Loss: 4.081 Test Acc: 0.256
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps12_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.25882352941176473
model parameter : 182746
model size : 0.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.6634361743927
Epoch: 1, Steps: 10 | Train Loss: 3.347 Vali Loss: 3.326 Vali Acc: 0.054 Test Loss: 3.326 Test Acc: 0.054
Validation loss decreased (inf --> -0.054084).  Saving model ...
Epoch: 2 cost time: 1.0155134201049805
Epoch: 2, Steps: 10 | Train Loss: 3.235 Vali Loss: 3.309 Vali Acc: 0.065 Test Loss: 3.309 Test Acc: 0.065
Validation loss decreased (-0.054084 --> -0.064673).  Saving model ...
Epoch: 3 cost time: 1.0783703327178955
Epoch: 3, Steps: 10 | Train Loss: 3.007 Vali Loss: 3.287 Vali Acc: 0.071 Test Loss: 3.287 Test Acc: 0.071
Validation loss decreased (-0.064673 --> -0.070555).  Saving model ...
Epoch: 4 cost time: 1.0653066635131836
Epoch: 4, Steps: 10 | Train Loss: 2.718 Vali Loss: 3.274 Vali Acc: 0.089 Test Loss: 3.274 Test Acc: 0.089
Validation loss decreased (-0.070555 --> -0.089379).  Saving model ...
Epoch: 5 cost time: 1.0637662410736084
Epoch: 5, Steps: 10 | Train Loss: 2.444 Vali Loss: 3.250 Vali Acc: 0.125 Test Loss: 3.250 Test Acc: 0.125
Validation loss decreased (-0.089379 --> -0.124673).  Saving model ...
Epoch: 6 cost time: 0.9617650508880615
Epoch: 6, Steps: 10 | Train Loss: 2.164 Vali Loss: 3.227 Vali Acc: 0.132 Test Loss: 3.227 Test Acc: 0.132
Validation loss decreased (-0.124673 --> -0.131732).  Saving model ...
Epoch: 7 cost time: 0.9074044227600098
Epoch: 7, Steps: 10 | Train Loss: 1.899 Vali Loss: 3.219 Vali Acc: 0.152 Test Loss: 3.219 Test Acc: 0.152
Validation loss decreased (-0.131732 --> -0.151733).  Saving model ...
Epoch: 8 cost time: 1.0480015277862549
Epoch: 8, Steps: 10 | Train Loss: 1.631 Vali Loss: 3.207 Vali Acc: 0.171 Test Loss: 3.207 Test Acc: 0.171
Validation loss decreased (-0.151733 --> -0.170556).  Saving model ...
Epoch: 9 cost time: 0.9201464653015137
Epoch: 9, Steps: 10 | Train Loss: 1.369 Vali Loss: 3.192 Vali Acc: 0.181 Test Loss: 3.192 Test Acc: 0.181
Validation loss decreased (-0.170556 --> -0.181145).  Saving model ...
Epoch: 10 cost time: 0.960360050201416
Epoch: 10, Steps: 10 | Train Loss: 1.126 Vali Loss: 3.198 Vali Acc: 0.212 Test Loss: 3.198 Test Acc: 0.212
Validation loss decreased (-0.181145 --> -0.211733).  Saving model ...
Epoch: 11 cost time: 0.9431724548339844
Epoch: 11, Steps: 10 | Train Loss: 0.885 Vali Loss: 3.222 Vali Acc: 0.219 Test Loss: 3.222 Test Acc: 0.219
Validation loss decreased (-0.211733 --> -0.218791).  Saving model ...
Epoch: 12 cost time: 1.0374443531036377
Epoch: 12, Steps: 10 | Train Loss: 0.716 Vali Loss: 3.258 Vali Acc: 0.224 Test Loss: 3.258 Test Acc: 0.224
Validation loss decreased (-0.218791 --> -0.223497).  Saving model ...
Epoch: 13 cost time: 0.969282865524292
Epoch: 13, Steps: 10 | Train Loss: 0.619 Vali Loss: 3.305 Vali Acc: 0.229 Test Loss: 3.305 Test Acc: 0.229
Validation loss decreased (-0.223497 --> -0.229379).  Saving model ...
Epoch: 14 cost time: 0.9934389591217041
Epoch: 14, Steps: 10 | Train Loss: 0.438 Vali Loss: 3.338 Vali Acc: 0.242 Test Loss: 3.338 Test Acc: 0.242
Validation loss decreased (-0.229379 --> -0.242320).  Saving model ...
Epoch: 15 cost time: 1.0103390216827393
Epoch: 15, Steps: 10 | Train Loss: 0.338 Vali Loss: 3.387 Vali Acc: 0.247 Test Loss: 3.387 Test Acc: 0.247
Validation loss decreased (-0.242320 --> -0.247025).  Saving model ...
Epoch: 16 cost time: 0.9697151184082031
Epoch: 16, Steps: 10 | Train Loss: 0.263 Vali Loss: 3.423 Vali Acc: 0.251 Test Loss: 3.423 Test Acc: 0.251
Validation loss decreased (-0.247025 --> -0.250554).  Saving model ...
Epoch: 17 cost time: 1.0519154071807861
Epoch: 17, Steps: 10 | Train Loss: 0.205 Vali Loss: 3.500 Vali Acc: 0.253 Test Loss: 3.500 Test Acc: 0.253
Validation loss decreased (-0.250554 --> -0.252906).  Saving model ...
Epoch: 18 cost time: 0.9565644264221191
Epoch: 18, Steps: 10 | Train Loss: 0.158 Vali Loss: 3.540 Vali Acc: 0.261 Test Loss: 3.540 Test Acc: 0.261
Validation loss decreased (-0.252906 --> -0.261141).  Saving model ...
Epoch: 19 cost time: 0.9051711559295654
Epoch: 19, Steps: 10 | Train Loss: 0.126 Vali Loss: 3.572 Vali Acc: 0.261 Test Loss: 3.572 Test Acc: 0.261
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9010591506958008
Epoch: 20, Steps: 10 | Train Loss: 0.104 Vali Loss: 3.611 Vali Acc: 0.264 Test Loss: 3.611 Test Acc: 0.264
Validation loss decreased (-0.261141 --> -0.263493).  Saving model ...
Epoch: 21 cost time: 0.8994631767272949
Epoch: 21, Steps: 10 | Train Loss: 0.085 Vali Loss: 3.648 Vali Acc: 0.262 Test Loss: 3.648 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9538741111755371
Epoch: 22, Steps: 10 | Train Loss: 0.072 Vali Loss: 3.689 Vali Acc: 0.260 Test Loss: 3.689 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.858687162399292
Epoch: 23, Steps: 10 | Train Loss: 0.062 Vali Loss: 3.716 Vali Acc: 0.261 Test Loss: 3.716 Test Acc: 0.261
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.9806323051452637
Epoch: 24, Steps: 10 | Train Loss: 0.052 Vali Loss: 3.749 Vali Acc: 0.261 Test Loss: 3.749 Test Acc: 0.261
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.9828128814697266
Epoch: 25, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.783 Vali Acc: 0.264 Test Loss: 3.783 Test Acc: 0.264
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.8689870834350586
Epoch: 26, Steps: 10 | Train Loss: 0.043 Vali Loss: 3.821 Vali Acc: 0.265 Test Loss: 3.821 Test Acc: 0.265
Validation loss decreased (-0.263493 --> -0.264668).  Saving model ...
Epoch: 27 cost time: 0.8764896392822266
Epoch: 27, Steps: 10 | Train Loss: 0.038 Vali Loss: 3.846 Vali Acc: 0.259 Test Loss: 3.846 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8028602600097656
Epoch: 28, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.892 Vali Acc: 0.258 Test Loss: 3.892 Test Acc: 0.258
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.7363598346710205
Epoch: 29, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.917 Vali Acc: 0.267 Test Loss: 3.917 Test Acc: 0.267
Validation loss decreased (-0.264668 --> -0.267020).  Saving model ...
Epoch: 30 cost time: 0.935309648513794
Epoch: 30, Steps: 10 | Train Loss: 0.027 Vali Loss: 3.940 Vali Acc: 0.265 Test Loss: 3.940 Test Acc: 0.265
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.9095888137817383
Epoch: 31, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.971 Vali Acc: 0.265 Test Loss: 3.971 Test Acc: 0.265
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.9453074932098389
Epoch: 32, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.993 Vali Acc: 0.269 Test Loss: 3.993 Test Acc: 0.269
Validation loss decreased (-0.267020 --> -0.269372).  Saving model ...
Epoch: 33 cost time: 0.9563276767730713
Epoch: 33, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.018 Vali Acc: 0.268 Test Loss: 4.018 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.004889726638794
Epoch: 34, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.021 Vali Acc: 0.262 Test Loss: 4.021 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.9893839359283447
Epoch: 35, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.040 Vali Acc: 0.265 Test Loss: 4.040 Test Acc: 0.265
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.8019654750823975
Epoch: 36, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.068 Vali Acc: 0.268 Test Loss: 4.068 Test Acc: 0.268
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.9497776031494141
Epoch: 37, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.099 Vali Acc: 0.268 Test Loss: 4.099 Test Acc: 0.268
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.9436554908752441
Epoch: 38, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.136 Vali Acc: 0.269 Test Loss: 4.136 Test Acc: 0.269
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.8848378658294678
Epoch: 39, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.145 Vali Acc: 0.271 Test Loss: 4.145 Test Acc: 0.271
Validation loss decreased (-0.269372 --> -0.270547).  Saving model ...
Epoch: 40 cost time: 0.9639015197753906
Epoch: 40, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.175 Vali Acc: 0.268 Test Loss: 4.175 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.9337973594665527
Epoch: 41, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.201 Vali Acc: 0.266 Test Loss: 4.201 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.0303459167480469
Epoch: 42, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.222 Vali Acc: 0.264 Test Loss: 4.222 Test Acc: 0.264
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.1814935207366943
Epoch: 43, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.239 Vali Acc: 0.266 Test Loss: 4.239 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.0090110301971436
Epoch: 44, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.263 Vali Acc: 0.266 Test Loss: 4.263 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.8226230144500732
Epoch: 45, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.283 Vali Acc: 0.269 Test Loss: 4.283 Test Acc: 0.269
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.9420473575592041
Epoch: 46, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.306 Vali Acc: 0.268 Test Loss: 4.306 Test Acc: 0.268
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.8612842559814453
Epoch: 47, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.320 Vali Acc: 0.269 Test Loss: 4.320 Test Acc: 0.269
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 1.0325546264648438
Epoch: 48, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.351 Vali Acc: 0.271 Test Loss: 4.351 Test Acc: 0.271
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 0.9806914329528809
Epoch: 49, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.374 Vali Acc: 0.268 Test Loss: 4.374 Test Acc: 0.268
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27058823529411763
model parameter : 153050
model size : 0.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps23_str12_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.877225160598755
Epoch: 1, Steps: 10 | Train Loss: 3.326 Vali Loss: 3.300 Vali Acc: 0.039 Test Loss: 3.300 Test Acc: 0.039
Validation loss decreased (inf --> -0.038791).  Saving model ...
Epoch: 2 cost time: 1.044992446899414
Epoch: 2, Steps: 10 | Train Loss: 3.271 Vali Loss: 3.295 Vali Acc: 0.045 Test Loss: 3.295 Test Acc: 0.045
Validation loss decreased (-0.038791 --> -0.044673).  Saving model ...
Epoch: 3 cost time: 0.9511501789093018
Epoch: 3, Steps: 10 | Train Loss: 3.033 Vali Loss: 3.280 Vali Acc: 0.045 Test Loss: 3.280 Test Acc: 0.045
Validation loss decreased (-0.044673 --> -0.044673).  Saving model ...
Epoch: 4 cost time: 1.0328295230865479
Epoch: 4, Steps: 10 | Train Loss: 2.875 Vali Loss: 3.268 Vali Acc: 0.061 Test Loss: 3.268 Test Acc: 0.061
Validation loss decreased (-0.044673 --> -0.061144).  Saving model ...
Epoch: 5 cost time: 0.8423318862915039
Epoch: 5, Steps: 10 | Train Loss: 2.695 Vali Loss: 3.257 Vali Acc: 0.082 Test Loss: 3.257 Test Acc: 0.082
Validation loss decreased (-0.061144 --> -0.082320).  Saving model ...
Epoch: 6 cost time: 1.0379679203033447
Epoch: 6, Steps: 10 | Train Loss: 2.467 Vali Loss: 3.238 Vali Acc: 0.094 Test Loss: 3.238 Test Acc: 0.094
Validation loss decreased (-0.082320 --> -0.094085).  Saving model ...
Epoch: 7 cost time: 1.198711633682251
Epoch: 7, Steps: 10 | Train Loss: 2.282 Vali Loss: 3.216 Vali Acc: 0.124 Test Loss: 3.216 Test Acc: 0.124
Validation loss decreased (-0.094085 --> -0.123497).  Saving model ...
Epoch: 8 cost time: 0.8030095100402832
Epoch: 8, Steps: 10 | Train Loss: 2.034 Vali Loss: 3.199 Vali Acc: 0.136 Test Loss: 3.199 Test Acc: 0.136
Validation loss decreased (-0.123497 --> -0.136439).  Saving model ...
Epoch: 9 cost time: 0.9728760719299316
Epoch: 9, Steps: 10 | Train Loss: 1.790 Vali Loss: 3.185 Vali Acc: 0.142 Test Loss: 3.185 Test Acc: 0.142
Validation loss decreased (-0.136439 --> -0.142321).  Saving model ...
Epoch: 10 cost time: 0.941098690032959
Epoch: 10, Steps: 10 | Train Loss: 1.616 Vali Loss: 3.176 Vali Acc: 0.159 Test Loss: 3.176 Test Acc: 0.159
Validation loss decreased (-0.142321 --> -0.158792).  Saving model ...
Epoch: 11 cost time: 0.8520653247833252
Epoch: 11, Steps: 10 | Train Loss: 1.401 Vali Loss: 3.173 Vali Acc: 0.175 Test Loss: 3.173 Test Acc: 0.175
Validation loss decreased (-0.158792 --> -0.175262).  Saving model ...
Epoch: 12 cost time: 1.0078859329223633
Epoch: 12, Steps: 10 | Train Loss: 1.193 Vali Loss: 3.172 Vali Acc: 0.192 Test Loss: 3.172 Test Acc: 0.192
Validation loss decreased (-0.175262 --> -0.191733).  Saving model ...
Epoch: 13 cost time: 1.0176970958709717
Epoch: 13, Steps: 10 | Train Loss: 1.040 Vali Loss: 3.175 Vali Acc: 0.209 Test Loss: 3.175 Test Acc: 0.209
Validation loss decreased (-0.191733 --> -0.209380).  Saving model ...
Epoch: 14 cost time: 0.9985973834991455
Epoch: 14, Steps: 10 | Train Loss: 0.891 Vali Loss: 3.193 Vali Acc: 0.218 Test Loss: 3.193 Test Acc: 0.218
Validation loss decreased (-0.209380 --> -0.217615).  Saving model ...
Epoch: 15 cost time: 1.0725858211517334
Epoch: 15, Steps: 10 | Train Loss: 0.715 Vali Loss: 3.223 Vali Acc: 0.226 Test Loss: 3.223 Test Acc: 0.226
Validation loss decreased (-0.217615 --> -0.225850).  Saving model ...
Epoch: 16 cost time: 1.1187717914581299
Epoch: 16, Steps: 10 | Train Loss: 0.596 Vali Loss: 3.253 Vali Acc: 0.231 Test Loss: 3.253 Test Acc: 0.231
Validation loss decreased (-0.225850 --> -0.230556).  Saving model ...
Epoch: 17 cost time: 0.9989223480224609
Epoch: 17, Steps: 10 | Train Loss: 0.499 Vali Loss: 3.281 Vali Acc: 0.240 Test Loss: 3.281 Test Acc: 0.240
Validation loss decreased (-0.230556 --> -0.239967).  Saving model ...
Epoch: 18 cost time: 1.0050616264343262
Epoch: 18, Steps: 10 | Train Loss: 0.382 Vali Loss: 3.311 Vali Acc: 0.247 Test Loss: 3.311 Test Acc: 0.247
Validation loss decreased (-0.239967 --> -0.247026).  Saving model ...
Epoch: 19 cost time: 0.98736572265625
Epoch: 19, Steps: 10 | Train Loss: 0.316 Vali Loss: 3.360 Vali Acc: 0.244 Test Loss: 3.360 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9315924644470215
Epoch: 20, Steps: 10 | Train Loss: 0.246 Vali Loss: 3.398 Vali Acc: 0.252 Test Loss: 3.398 Test Acc: 0.252
Validation loss decreased (-0.247026 --> -0.251731).  Saving model ...
Epoch: 21 cost time: 1.1075146198272705
Epoch: 21, Steps: 10 | Train Loss: 0.212 Vali Loss: 3.444 Vali Acc: 0.252 Test Loss: 3.444 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.3115489482879639
Epoch: 22, Steps: 10 | Train Loss: 0.187 Vali Loss: 3.475 Vali Acc: 0.253 Test Loss: 3.475 Test Acc: 0.253
Validation loss decreased (-0.251731 --> -0.252906).  Saving model ...
Epoch: 23 cost time: 0.9663994312286377
Epoch: 23, Steps: 10 | Train Loss: 0.151 Vali Loss: 3.508 Vali Acc: 0.248 Test Loss: 3.508 Test Acc: 0.248
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.145613670349121
Epoch: 24, Steps: 10 | Train Loss: 0.124 Vali Loss: 3.540 Vali Acc: 0.255 Test Loss: 3.540 Test Acc: 0.255
Validation loss decreased (-0.252906 --> -0.255259).  Saving model ...
Epoch: 25 cost time: 1.029200553894043
Epoch: 25, Steps: 10 | Train Loss: 0.114 Vali Loss: 3.590 Vali Acc: 0.252 Test Loss: 3.590 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0077848434448242
Epoch: 26, Steps: 10 | Train Loss: 0.097 Vali Loss: 3.645 Vali Acc: 0.242 Test Loss: 3.645 Test Acc: 0.242
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.061326503753662
Epoch: 27, Steps: 10 | Train Loss: 0.080 Vali Loss: 3.674 Vali Acc: 0.246 Test Loss: 3.674 Test Acc: 0.246
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.0823712348937988
Epoch: 28, Steps: 10 | Train Loss: 0.069 Vali Loss: 3.678 Vali Acc: 0.252 Test Loss: 3.678 Test Acc: 0.252
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.973252534866333
Epoch: 29, Steps: 10 | Train Loss: 0.061 Vali Loss: 3.692 Vali Acc: 0.253 Test Loss: 3.692 Test Acc: 0.253
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.8837831020355225
Epoch: 30, Steps: 10 | Train Loss: 0.060 Vali Loss: 3.736 Vali Acc: 0.254 Test Loss: 3.736 Test Acc: 0.254
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.1563193798065186
Epoch: 31, Steps: 10 | Train Loss: 0.050 Vali Loss: 3.770 Vali Acc: 0.255 Test Loss: 3.770 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.2190170288085938
Epoch: 32, Steps: 10 | Train Loss: 0.046 Vali Loss: 3.807 Vali Acc: 0.256 Test Loss: 3.807 Test Acc: 0.256
Validation loss decreased (-0.255259 --> -0.256433).  Saving model ...
Epoch: 33 cost time: 1.0904245376586914
Epoch: 33, Steps: 10 | Train Loss: 0.041 Vali Loss: 3.832 Vali Acc: 0.252 Test Loss: 3.832 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.9758174419403076
Epoch: 34, Steps: 10 | Train Loss: 0.037 Vali Loss: 3.863 Vali Acc: 0.252 Test Loss: 3.863 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.0802414417266846
Epoch: 35, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.887 Vali Acc: 0.247 Test Loss: 3.887 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.045478343963623
Epoch: 36, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.904 Vali Acc: 0.251 Test Loss: 3.904 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.9553999900817871
Epoch: 37, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.921 Vali Acc: 0.258 Test Loss: 3.921 Test Acc: 0.258
Validation loss decreased (-0.256433 --> -0.257608).  Saving model ...
Epoch: 38 cost time: 0.9860131740570068
Epoch: 38, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.944 Vali Acc: 0.253 Test Loss: 3.944 Test Acc: 0.253
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.012768030166626
Epoch: 39, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.964 Vali Acc: 0.253 Test Loss: 3.964 Test Acc: 0.253
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.9652748107910156
Epoch: 40, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.994 Vali Acc: 0.253 Test Loss: 3.994 Test Acc: 0.253
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.0293757915496826
Epoch: 41, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.019 Vali Acc: 0.254 Test Loss: 4.019 Test Acc: 0.254
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.030940055847168
Epoch: 42, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.043 Vali Acc: 0.254 Test Loss: 4.043 Test Acc: 0.254
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.9656400680541992
Epoch: 43, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.072 Vali Acc: 0.255 Test Loss: 4.072 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.9952595233917236
Epoch: 44, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.100 Vali Acc: 0.253 Test Loss: 4.100 Test Acc: 0.253
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.0553817749023438
Epoch: 45, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.139 Vali Acc: 0.255 Test Loss: 4.139 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.9736087322235107
Epoch: 46, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.158 Vali Acc: 0.244 Test Loss: 4.158 Test Acc: 0.244
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 1.1997096538543701
Epoch: 47, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.171 Vali Acc: 0.245 Test Loss: 4.171 Test Acc: 0.245
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps23_str12_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2576470588235294
model parameter : 118554
model size : 0.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.114567518234253
Epoch: 1, Steps: 10 | Train Loss: 3.374 Vali Loss: 3.281 Vali Acc: 0.046 Test Loss: 3.281 Test Acc: 0.046
Validation loss decreased (inf --> -0.045850).  Saving model ...
Epoch: 2 cost time: 1.0238337516784668
Epoch: 2, Steps: 10 | Train Loss: 3.316 Vali Loss: 3.277 Vali Acc: 0.052 Test Loss: 3.277 Test Acc: 0.052
Validation loss decreased (-0.045850 --> -0.051732).  Saving model ...
Epoch: 3 cost time: 1.0456643104553223
Epoch: 3, Steps: 10 | Train Loss: 3.175 Vali Loss: 3.266 Vali Acc: 0.052 Test Loss: 3.266 Test Acc: 0.052
Validation loss decreased (-0.051732 --> -0.051732).  Saving model ...
Epoch: 4 cost time: 1.1360094547271729
Epoch: 4, Steps: 10 | Train Loss: 3.026 Vali Loss: 3.254 Vali Acc: 0.068 Test Loss: 3.254 Test Acc: 0.068
Validation loss decreased (-0.051732 --> -0.068203).  Saving model ...
Epoch: 5 cost time: 1.0455753803253174
Epoch: 5, Steps: 10 | Train Loss: 2.887 Vali Loss: 3.244 Vali Acc: 0.080 Test Loss: 3.244 Test Acc: 0.080
Validation loss decreased (-0.068203 --> -0.079968).  Saving model ...
Epoch: 6 cost time: 1.0683443546295166
Epoch: 6, Steps: 10 | Train Loss: 2.692 Vali Loss: 3.234 Vali Acc: 0.088 Test Loss: 3.234 Test Acc: 0.088
Validation loss decreased (-0.079968 --> -0.088203).  Saving model ...
Epoch: 7 cost time: 1.1137926578521729
Epoch: 7, Steps: 10 | Train Loss: 2.532 Vali Loss: 3.223 Vali Acc: 0.108 Test Loss: 3.223 Test Acc: 0.108
Validation loss decreased (-0.088203 --> -0.108203).  Saving model ...
Epoch: 8 cost time: 1.0988960266113281
Epoch: 8, Steps: 10 | Train Loss: 2.337 Vali Loss: 3.214 Vali Acc: 0.119 Test Loss: 3.214 Test Acc: 0.119
Validation loss decreased (-0.108203 --> -0.118791).  Saving model ...
Epoch: 9 cost time: 1.0173485279083252
Epoch: 9, Steps: 10 | Train Loss: 2.156 Vali Loss: 3.200 Vali Acc: 0.136 Test Loss: 3.200 Test Acc: 0.136
Validation loss decreased (-0.118791 --> -0.136439).  Saving model ...
Epoch: 10 cost time: 1.0554230213165283
Epoch: 10, Steps: 10 | Train Loss: 2.001 Vali Loss: 3.192 Vali Acc: 0.152 Test Loss: 3.192 Test Acc: 0.152
Validation loss decreased (-0.136439 --> -0.151733).  Saving model ...
Epoch: 11 cost time: 1.09653639793396
Epoch: 11, Steps: 10 | Train Loss: 1.796 Vali Loss: 3.183 Vali Acc: 0.165 Test Loss: 3.183 Test Acc: 0.165
Validation loss decreased (-0.151733 --> -0.164674).  Saving model ...
Epoch: 12 cost time: 1.0032176971435547
Epoch: 12, Steps: 10 | Train Loss: 1.611 Vali Loss: 3.172 Vali Acc: 0.169 Test Loss: 3.172 Test Acc: 0.169
Validation loss decreased (-0.164674 --> -0.169380).  Saving model ...
Epoch: 13 cost time: 1.0740153789520264
Epoch: 13, Steps: 10 | Train Loss: 1.453 Vali Loss: 3.166 Vali Acc: 0.184 Test Loss: 3.166 Test Acc: 0.184
Validation loss decreased (-0.169380 --> -0.183498).  Saving model ...
Epoch: 14 cost time: 1.0161001682281494
Epoch: 14, Steps: 10 | Train Loss: 1.268 Vali Loss: 3.171 Vali Acc: 0.189 Test Loss: 3.171 Test Acc: 0.189
Validation loss decreased (-0.183498 --> -0.189380).  Saving model ...
Epoch: 15 cost time: 1.049806833267212
Epoch: 15, Steps: 10 | Train Loss: 1.142 Vali Loss: 3.178 Vali Acc: 0.196 Test Loss: 3.178 Test Acc: 0.196
Validation loss decreased (-0.189380 --> -0.196439).  Saving model ...
Epoch: 16 cost time: 0.9635982513427734
Epoch: 16, Steps: 10 | Train Loss: 0.972 Vali Loss: 3.190 Vali Acc: 0.209 Test Loss: 3.190 Test Acc: 0.209
Validation loss decreased (-0.196439 --> -0.209380).  Saving model ...
Epoch: 17 cost time: 1.0011060237884521
Epoch: 17, Steps: 10 | Train Loss: 0.852 Vali Loss: 3.209 Vali Acc: 0.219 Test Loss: 3.209 Test Acc: 0.219
Validation loss decreased (-0.209380 --> -0.218791).  Saving model ...
Epoch: 18 cost time: 1.0989718437194824
Epoch: 18, Steps: 10 | Train Loss: 0.746 Vali Loss: 3.211 Vali Acc: 0.221 Test Loss: 3.211 Test Acc: 0.221
Validation loss decreased (-0.218791 --> -0.221144).  Saving model ...
Epoch: 19 cost time: 1.033937692642212
Epoch: 19, Steps: 10 | Train Loss: 0.631 Vali Loss: 3.236 Vali Acc: 0.231 Test Loss: 3.236 Test Acc: 0.231
Validation loss decreased (-0.221144 --> -0.230556).  Saving model ...
Epoch: 20 cost time: 0.8641855716705322
Epoch: 20, Steps: 10 | Train Loss: 0.520 Vali Loss: 3.267 Vali Acc: 0.234 Test Loss: 3.267 Test Acc: 0.234
Validation loss decreased (-0.230556 --> -0.234085).  Saving model ...
Epoch: 21 cost time: 1.0657932758331299
Epoch: 21, Steps: 10 | Train Loss: 0.445 Vali Loss: 3.290 Vali Acc: 0.242 Test Loss: 3.290 Test Acc: 0.242
Validation loss decreased (-0.234085 --> -0.242320).  Saving model ...
Epoch: 22 cost time: 1.024263858795166
Epoch: 22, Steps: 10 | Train Loss: 0.361 Vali Loss: 3.334 Vali Acc: 0.240 Test Loss: 3.334 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.08622145652771
Epoch: 23, Steps: 10 | Train Loss: 0.302 Vali Loss: 3.382 Vali Acc: 0.249 Test Loss: 3.382 Test Acc: 0.249
Validation loss decreased (-0.242320 --> -0.249378).  Saving model ...
Epoch: 24 cost time: 0.9625673294067383
Epoch: 24, Steps: 10 | Train Loss: 0.256 Vali Loss: 3.401 Vali Acc: 0.254 Test Loss: 3.401 Test Acc: 0.254
Validation loss decreased (-0.249378 --> -0.254084).  Saving model ...
Epoch: 25 cost time: 0.8542377948760986
Epoch: 25, Steps: 10 | Train Loss: 0.212 Vali Loss: 3.437 Vali Acc: 0.249 Test Loss: 3.437 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0124680995941162
Epoch: 26, Steps: 10 | Train Loss: 0.182 Vali Loss: 3.469 Vali Acc: 0.254 Test Loss: 3.469 Test Acc: 0.254
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.9871604442596436
Epoch: 27, Steps: 10 | Train Loss: 0.153 Vali Loss: 3.504 Vali Acc: 0.253 Test Loss: 3.504 Test Acc: 0.253
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.9143021106719971
Epoch: 28, Steps: 10 | Train Loss: 0.129 Vali Loss: 3.536 Vali Acc: 0.264 Test Loss: 3.536 Test Acc: 0.264
Validation loss decreased (-0.254084 --> -0.263494).  Saving model ...
Epoch: 29 cost time: 1.266108751296997
Epoch: 29, Steps: 10 | Train Loss: 0.115 Vali Loss: 3.585 Vali Acc: 0.268 Test Loss: 3.585 Test Acc: 0.268
Validation loss decreased (-0.263494 --> -0.268199).  Saving model ...
Epoch: 30 cost time: 1.100231409072876
Epoch: 30, Steps: 10 | Train Loss: 0.100 Vali Loss: 3.627 Vali Acc: 0.265 Test Loss: 3.627 Test Acc: 0.265
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.053443193435669
Epoch: 31, Steps: 10 | Train Loss: 0.101 Vali Loss: 3.659 Vali Acc: 0.265 Test Loss: 3.659 Test Acc: 0.265
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.1128041744232178
Epoch: 32, Steps: 10 | Train Loss: 0.077 Vali Loss: 3.703 Vali Acc: 0.258 Test Loss: 3.703 Test Acc: 0.258
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.2056305408477783
Epoch: 33, Steps: 10 | Train Loss: 0.074 Vali Loss: 3.708 Vali Acc: 0.262 Test Loss: 3.708 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.2106928825378418
Epoch: 34, Steps: 10 | Train Loss: 0.061 Vali Loss: 3.712 Vali Acc: 0.271 Test Loss: 3.712 Test Acc: 0.271
Validation loss decreased (-0.268199 --> -0.270551).  Saving model ...
Epoch: 35 cost time: 1.024404525756836
Epoch: 35, Steps: 10 | Train Loss: 0.062 Vali Loss: 3.761 Vali Acc: 0.267 Test Loss: 3.761 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.2620487213134766
Epoch: 36, Steps: 10 | Train Loss: 0.048 Vali Loss: 3.798 Vali Acc: 0.269 Test Loss: 3.798 Test Acc: 0.269
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.9984071254730225
Epoch: 37, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.838 Vali Acc: 0.273 Test Loss: 3.838 Test Acc: 0.273
Validation loss decreased (-0.270551 --> -0.272903).  Saving model ...
Epoch: 38 cost time: 1.1515014171600342
Epoch: 38, Steps: 10 | Train Loss: 0.046 Vali Loss: 3.879 Vali Acc: 0.273 Test Loss: 3.879 Test Acc: 0.273
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.9285018444061279
Epoch: 39, Steps: 10 | Train Loss: 0.045 Vali Loss: 3.889 Vali Acc: 0.272 Test Loss: 3.889 Test Acc: 0.272
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.086510181427002
Epoch: 40, Steps: 10 | Train Loss: 0.038 Vali Loss: 3.889 Vali Acc: 0.275 Test Loss: 3.889 Test Acc: 0.275
Validation loss decreased (-0.272903 --> -0.275255).  Saving model ...
Epoch: 41 cost time: 1.2195634841918945
Epoch: 41, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.920 Vali Acc: 0.275 Test Loss: 3.920 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.1314334869384766
Epoch: 42, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.952 Vali Acc: 0.279 Test Loss: 3.952 Test Acc: 0.279
Validation loss decreased (-0.275255 --> -0.278784).  Saving model ...
Epoch: 43 cost time: 1.1482696533203125
Epoch: 43, Steps: 10 | Train Loss: 0.027 Vali Loss: 3.984 Vali Acc: 0.279 Test Loss: 3.984 Test Acc: 0.279
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.133934497833252
Epoch: 44, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.993 Vali Acc: 0.278 Test Loss: 3.993 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.188521385192871
Epoch: 45, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.011 Vali Acc: 0.276 Test Loss: 4.011 Test Acc: 0.276
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.05485200881958
Epoch: 46, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.023 Vali Acc: 0.274 Test Loss: 4.023 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.085597038269043
Epoch: 47, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.069 Vali Acc: 0.278 Test Loss: 4.069 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.2001473903656006
Epoch: 48, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.100 Vali Acc: 0.279 Test Loss: 4.100 Test Acc: 0.279
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 1.014089822769165
Epoch: 49, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.116 Vali Acc: 0.279 Test Loss: 4.116 Test Acc: 0.279
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 1.1293952465057373
Epoch: 50, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.126 Vali Acc: 0.280 Test Loss: 4.126 Test Acc: 0.280
Validation loss decreased (-0.278784 --> -0.279959).  Saving model ...
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.28
model parameter : 104090
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps38_str19_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.944705009460449
Epoch: 1, Steps: 10 | Train Loss: 3.233 Vali Loss: 3.277 Vali Acc: 0.040 Test Loss: 3.277 Test Acc: 0.040
Validation loss decreased (inf --> -0.039967).  Saving model ...
Epoch: 2 cost time: 0.8680381774902344
Epoch: 2, Steps: 10 | Train Loss: 3.176 Vali Loss: 3.280 Vali Acc: 0.049 Test Loss: 3.280 Test Acc: 0.049
Validation loss decreased (-0.039967 --> -0.049379).  Saving model ...
Epoch: 3 cost time: 0.9949014186859131
Epoch: 3, Steps: 10 | Train Loss: 3.080 Vali Loss: 3.275 Vali Acc: 0.065 Test Loss: 3.275 Test Acc: 0.065
Validation loss decreased (-0.049379 --> -0.064673).  Saving model ...
Epoch: 4 cost time: 1.365811824798584
Epoch: 4, Steps: 10 | Train Loss: 2.926 Vali Loss: 3.265 Vali Acc: 0.076 Test Loss: 3.265 Test Acc: 0.076
Validation loss decreased (-0.064673 --> -0.076438).  Saving model ...
Epoch: 5 cost time: 1.0325706005096436
Epoch: 5, Steps: 10 | Train Loss: 2.827 Vali Loss: 3.259 Vali Acc: 0.089 Test Loss: 3.259 Test Acc: 0.089
Validation loss decreased (-0.076438 --> -0.089379).  Saving model ...
Epoch: 6 cost time: 1.0107042789459229
Epoch: 6, Steps: 10 | Train Loss: 2.682 Vali Loss: 3.252 Vali Acc: 0.100 Test Loss: 3.252 Test Acc: 0.100
Validation loss decreased (-0.089379 --> -0.099967).  Saving model ...
Epoch: 7 cost time: 1.1347498893737793
Epoch: 7, Steps: 10 | Train Loss: 2.512 Vali Loss: 3.242 Vali Acc: 0.106 Test Loss: 3.242 Test Acc: 0.106
Validation loss decreased (-0.099967 --> -0.105850).  Saving model ...
Epoch: 8 cost time: 1.2701561450958252
Epoch: 8, Steps: 10 | Train Loss: 2.364 Vali Loss: 3.229 Vali Acc: 0.118 Test Loss: 3.229 Test Acc: 0.118
Validation loss decreased (-0.105850 --> -0.117615).  Saving model ...
Epoch: 9 cost time: 1.0657458305358887
Epoch: 9, Steps: 10 | Train Loss: 2.162 Vali Loss: 3.212 Vali Acc: 0.133 Test Loss: 3.212 Test Acc: 0.133
Validation loss decreased (-0.117615 --> -0.132909).  Saving model ...
Epoch: 10 cost time: 1.0898845195770264
Epoch: 10, Steps: 10 | Train Loss: 2.012 Vali Loss: 3.201 Vali Acc: 0.146 Test Loss: 3.201 Test Acc: 0.146
Validation loss decreased (-0.132909 --> -0.145850).  Saving model ...
Epoch: 11 cost time: 1.0418648719787598
Epoch: 11, Steps: 10 | Train Loss: 1.851 Vali Loss: 3.193 Vali Acc: 0.158 Test Loss: 3.193 Test Acc: 0.158
Validation loss decreased (-0.145850 --> -0.157615).  Saving model ...
Epoch: 12 cost time: 1.190781831741333
Epoch: 12, Steps: 10 | Train Loss: 1.710 Vali Loss: 3.185 Vali Acc: 0.178 Test Loss: 3.185 Test Acc: 0.178
Validation loss decreased (-0.157615 --> -0.177615).  Saving model ...
Epoch: 13 cost time: 1.1141953468322754
Epoch: 13, Steps: 10 | Train Loss: 1.530 Vali Loss: 3.178 Vali Acc: 0.181 Test Loss: 3.178 Test Acc: 0.181
Validation loss decreased (-0.177615 --> -0.181145).  Saving model ...
Epoch: 14 cost time: 1.2275867462158203
Epoch: 14, Steps: 10 | Train Loss: 1.406 Vali Loss: 3.177 Vali Acc: 0.186 Test Loss: 3.177 Test Acc: 0.186
Validation loss decreased (-0.181145 --> -0.185851).  Saving model ...
Epoch: 15 cost time: 1.1937830448150635
Epoch: 15, Steps: 10 | Train Loss: 1.236 Vali Loss: 3.183 Vali Acc: 0.199 Test Loss: 3.183 Test Acc: 0.199
Validation loss decreased (-0.185851 --> -0.198792).  Saving model ...
Epoch: 16 cost time: 1.2167975902557373
Epoch: 16, Steps: 10 | Train Loss: 1.071 Vali Loss: 3.188 Vali Acc: 0.211 Test Loss: 3.188 Test Acc: 0.211
Validation loss decreased (-0.198792 --> -0.210556).  Saving model ...
Epoch: 17 cost time: 1.045067548751831
Epoch: 17, Steps: 10 | Train Loss: 0.979 Vali Loss: 3.193 Vali Acc: 0.215 Test Loss: 3.193 Test Acc: 0.215
Validation loss decreased (-0.210556 --> -0.215262).  Saving model ...
Epoch: 18 cost time: 1.100914716720581
Epoch: 18, Steps: 10 | Train Loss: 0.838 Vali Loss: 3.216 Vali Acc: 0.220 Test Loss: 3.216 Test Acc: 0.220
Validation loss decreased (-0.215262 --> -0.219968).  Saving model ...
Epoch: 19 cost time: 1.0688366889953613
Epoch: 19, Steps: 10 | Train Loss: 0.735 Vali Loss: 3.233 Vali Acc: 0.225 Test Loss: 3.233 Test Acc: 0.225
Validation loss decreased (-0.219968 --> -0.224674).  Saving model ...
Epoch: 20 cost time: 1.2008016109466553
Epoch: 20, Steps: 10 | Train Loss: 0.608 Vali Loss: 3.246 Vali Acc: 0.229 Test Loss: 3.246 Test Acc: 0.229
Validation loss decreased (-0.224674 --> -0.229379).  Saving model ...
Epoch: 21 cost time: 1.0948700904846191
Epoch: 21, Steps: 10 | Train Loss: 0.516 Vali Loss: 3.284 Vali Acc: 0.238 Test Loss: 3.284 Test Acc: 0.238
Validation loss decreased (-0.229379 --> -0.237614).  Saving model ...
Epoch: 22 cost time: 1.151148796081543
Epoch: 22, Steps: 10 | Train Loss: 0.461 Vali Loss: 3.318 Vali Acc: 0.239 Test Loss: 3.318 Test Acc: 0.239
Validation loss decreased (-0.237614 --> -0.238790).  Saving model ...
Epoch: 23 cost time: 1.1768386363983154
Epoch: 23, Steps: 10 | Train Loss: 0.391 Vali Loss: 3.333 Vali Acc: 0.240 Test Loss: 3.333 Test Acc: 0.240
Validation loss decreased (-0.238790 --> -0.239967).  Saving model ...
Epoch: 24 cost time: 1.1070678234100342
Epoch: 24, Steps: 10 | Train Loss: 0.334 Vali Loss: 3.337 Vali Acc: 0.244 Test Loss: 3.337 Test Acc: 0.244
Validation loss decreased (-0.239967 --> -0.243496).  Saving model ...
Epoch: 25 cost time: 1.1234993934631348
Epoch: 25, Steps: 10 | Train Loss: 0.282 Vali Loss: 3.386 Vali Acc: 0.242 Test Loss: 3.386 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0899853706359863
Epoch: 26, Steps: 10 | Train Loss: 0.252 Vali Loss: 3.410 Vali Acc: 0.246 Test Loss: 3.410 Test Acc: 0.246
Validation loss decreased (-0.243496 --> -0.245848).  Saving model ...
Epoch: 27 cost time: 1.2254066467285156
Epoch: 27, Steps: 10 | Train Loss: 0.218 Vali Loss: 3.440 Vali Acc: 0.249 Test Loss: 3.440 Test Acc: 0.249
Validation loss decreased (-0.245848 --> -0.249377).  Saving model ...
Epoch: 28 cost time: 1.1000375747680664
Epoch: 28, Steps: 10 | Train Loss: 0.186 Vali Loss: 3.481 Vali Acc: 0.247 Test Loss: 3.481 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.010453462600708
Epoch: 29, Steps: 10 | Train Loss: 0.168 Vali Loss: 3.509 Vali Acc: 0.251 Test Loss: 3.509 Test Acc: 0.251
Validation loss decreased (-0.249377 --> -0.250553).  Saving model ...
Epoch: 30 cost time: 1.1486282348632812
Epoch: 30, Steps: 10 | Train Loss: 0.148 Vali Loss: 3.543 Vali Acc: 0.247 Test Loss: 3.543 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.0749011039733887
Epoch: 31, Steps: 10 | Train Loss: 0.130 Vali Loss: 3.541 Vali Acc: 0.253 Test Loss: 3.541 Test Acc: 0.253
Validation loss decreased (-0.250553 --> -0.252906).  Saving model ...
Epoch: 32 cost time: 1.2371244430541992
Epoch: 32, Steps: 10 | Train Loss: 0.120 Vali Loss: 3.568 Vali Acc: 0.253 Test Loss: 3.568 Test Acc: 0.253
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.1212925910949707
Epoch: 33, Steps: 10 | Train Loss: 0.109 Vali Loss: 3.599 Vali Acc: 0.256 Test Loss: 3.599 Test Acc: 0.256
Validation loss decreased (-0.252906 --> -0.256435).  Saving model ...
Epoch: 34 cost time: 1.1571824550628662
Epoch: 34, Steps: 10 | Train Loss: 0.090 Vali Loss: 3.647 Vali Acc: 0.255 Test Loss: 3.647 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.150573968887329
Epoch: 35, Steps: 10 | Train Loss: 0.081 Vali Loss: 3.680 Vali Acc: 0.252 Test Loss: 3.680 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.2398335933685303
Epoch: 36, Steps: 10 | Train Loss: 0.073 Vali Loss: 3.687 Vali Acc: 0.256 Test Loss: 3.687 Test Acc: 0.256
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.9965009689331055
Epoch: 37, Steps: 10 | Train Loss: 0.072 Vali Loss: 3.720 Vali Acc: 0.256 Test Loss: 3.720 Test Acc: 0.256
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.8936398029327393
Epoch: 38, Steps: 10 | Train Loss: 0.062 Vali Loss: 3.755 Vali Acc: 0.256 Test Loss: 3.755 Test Acc: 0.256
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.1223132610321045
Epoch: 39, Steps: 10 | Train Loss: 0.061 Vali Loss: 3.787 Vali Acc: 0.258 Test Loss: 3.787 Test Acc: 0.258
Validation loss decreased (-0.256435 --> -0.257609).  Saving model ...
Epoch: 40 cost time: 1.0871036052703857
Epoch: 40, Steps: 10 | Train Loss: 0.051 Vali Loss: 3.802 Vali Acc: 0.258 Test Loss: 3.802 Test Acc: 0.258
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.0235214233398438
Epoch: 41, Steps: 10 | Train Loss: 0.043 Vali Loss: 3.829 Vali Acc: 0.260 Test Loss: 3.829 Test Acc: 0.260
Validation loss decreased (-0.257609 --> -0.259962).  Saving model ...
Epoch: 42 cost time: 0.9317989349365234
Epoch: 42, Steps: 10 | Train Loss: 0.041 Vali Loss: 3.841 Vali Acc: 0.259 Test Loss: 3.841 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.00718092918396
Epoch: 43, Steps: 10 | Train Loss: 0.042 Vali Loss: 3.864 Vali Acc: 0.261 Test Loss: 3.864 Test Acc: 0.261
Validation loss decreased (-0.259962 --> -0.261138).  Saving model ...
Epoch: 44 cost time: 0.9525783061981201
Epoch: 44, Steps: 10 | Train Loss: 0.035 Vali Loss: 3.888 Vali Acc: 0.260 Test Loss: 3.888 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.9820911884307861
Epoch: 45, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.912 Vali Acc: 0.260 Test Loss: 3.912 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.9832162857055664
Epoch: 46, Steps: 10 | Train Loss: 0.031 Vali Loss: 3.937 Vali Acc: 0.256 Test Loss: 3.937 Test Acc: 0.256
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.9568233489990234
Epoch: 47, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.956 Vali Acc: 0.258 Test Loss: 3.956 Test Acc: 0.258
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.0196893215179443
Epoch: 48, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.979 Vali Acc: 0.256 Test Loss: 3.979 Test Acc: 0.256
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.9221286773681641
Epoch: 49, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.991 Vali Acc: 0.261 Test Loss: 3.991 Test Acc: 0.261
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.9532995223999023
Epoch: 50, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.016 Vali Acc: 0.265 Test Loss: 4.016 Test Acc: 0.265
Validation loss decreased (-0.261138 --> -0.264666).  Saving model ...
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps38_str19_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2647058823529412
model parameter : 99546
model size : 0.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.1332380771636963
Epoch: 1, Steps: 10 | Train Loss: 3.323 Vali Loss: 3.283 Vali Acc: 0.047 Test Loss: 3.283 Test Acc: 0.047
Validation loss decreased (inf --> -0.047026).  Saving model ...
Epoch: 2 cost time: 1.0215859413146973
Epoch: 2, Steps: 10 | Train Loss: 3.089 Vali Loss: 3.251 Vali Acc: 0.068 Test Loss: 3.251 Test Acc: 0.068
Validation loss decreased (-0.047026 --> -0.068203).  Saving model ...
Epoch: 3 cost time: 1.0809776782989502
Epoch: 3, Steps: 10 | Train Loss: 2.693 Vali Loss: 3.237 Vali Acc: 0.094 Test Loss: 3.237 Test Acc: 0.094
Validation loss decreased (-0.068203 --> -0.094085).  Saving model ...
Epoch: 4 cost time: 1.041365623474121
Epoch: 4, Steps: 10 | Train Loss: 2.254 Vali Loss: 3.214 Vali Acc: 0.127 Test Loss: 3.214 Test Acc: 0.127
Validation loss decreased (-0.094085 --> -0.127027).  Saving model ...
Epoch: 5 cost time: 1.0495963096618652
Epoch: 5, Steps: 10 | Train Loss: 1.815 Vali Loss: 3.197 Vali Acc: 0.151 Test Loss: 3.197 Test Acc: 0.151
Validation loss decreased (-0.127027 --> -0.150556).  Saving model ...
Epoch: 6 cost time: 0.9917874336242676
Epoch: 6, Steps: 10 | Train Loss: 1.423 Vali Loss: 3.203 Vali Acc: 0.176 Test Loss: 3.203 Test Acc: 0.176
Validation loss decreased (-0.150556 --> -0.176439).  Saving model ...
Epoch: 7 cost time: 0.9250760078430176
Epoch: 7, Steps: 10 | Train Loss: 1.041 Vali Loss: 3.193 Vali Acc: 0.202 Test Loss: 3.193 Test Acc: 0.202
Validation loss decreased (-0.176439 --> -0.202321).  Saving model ...
Epoch: 8 cost time: 1.069244384765625
Epoch: 8, Steps: 10 | Train Loss: 0.780 Vali Loss: 3.248 Vali Acc: 0.218 Test Loss: 3.248 Test Acc: 0.218
Validation loss decreased (-0.202321 --> -0.217615).  Saving model ...
Epoch: 9 cost time: 0.9450099468231201
Epoch: 9, Steps: 10 | Train Loss: 0.532 Vali Loss: 3.338 Vali Acc: 0.226 Test Loss: 3.338 Test Acc: 0.226
Validation loss decreased (-0.217615 --> -0.225849).  Saving model ...
Epoch: 10 cost time: 0.9763412475585938
Epoch: 10, Steps: 10 | Train Loss: 0.340 Vali Loss: 3.438 Vali Acc: 0.236 Test Loss: 3.438 Test Acc: 0.236
Validation loss decreased (-0.225849 --> -0.236436).  Saving model ...
Epoch: 11 cost time: 0.9683992862701416
Epoch: 11, Steps: 10 | Train Loss: 0.240 Vali Loss: 3.501 Vali Acc: 0.241 Test Loss: 3.501 Test Acc: 0.241
Validation loss decreased (-0.236436 --> -0.241141).  Saving model ...
Epoch: 12 cost time: 1.051039218902588
Epoch: 12, Steps: 10 | Train Loss: 0.155 Vali Loss: 3.593 Vali Acc: 0.247 Test Loss: 3.593 Test Acc: 0.247
Validation loss decreased (-0.241141 --> -0.247023).  Saving model ...
Epoch: 13 cost time: 1.1416652202606201
Epoch: 13, Steps: 10 | Train Loss: 0.101 Vali Loss: 3.642 Vali Acc: 0.248 Test Loss: 3.642 Test Acc: 0.248
Validation loss decreased (-0.247023 --> -0.248199).  Saving model ...
Epoch: 14 cost time: 0.9785411357879639
Epoch: 14, Steps: 10 | Train Loss: 0.071 Vali Loss: 3.724 Vali Acc: 0.255 Test Loss: 3.724 Test Acc: 0.255
Validation loss decreased (-0.248199 --> -0.255257).  Saving model ...
Epoch: 15 cost time: 1.0941698551177979
Epoch: 15, Steps: 10 | Train Loss: 0.054 Vali Loss: 3.769 Vali Acc: 0.264 Test Loss: 3.769 Test Acc: 0.264
Validation loss decreased (-0.255257 --> -0.263492).  Saving model ...
Epoch: 16 cost time: 1.061868667602539
Epoch: 16, Steps: 10 | Train Loss: 0.042 Vali Loss: 3.842 Vali Acc: 0.253 Test Loss: 3.842 Test Acc: 0.253
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.051645278930664
Epoch: 17, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.861 Vali Acc: 0.255 Test Loss: 3.861 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0747230052947998
Epoch: 18, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.879 Vali Acc: 0.261 Test Loss: 3.879 Test Acc: 0.261
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.149303674697876
Epoch: 19, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.920 Vali Acc: 0.258 Test Loss: 3.920 Test Acc: 0.258
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.1161656379699707
Epoch: 20, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.948 Vali Acc: 0.255 Test Loss: 3.948 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.141010046005249
Epoch: 21, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.005 Vali Acc: 0.256 Test Loss: 4.005 Test Acc: 0.256
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.1240952014923096
Epoch: 22, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.043 Vali Acc: 0.258 Test Loss: 4.043 Test Acc: 0.258
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.114469289779663
Epoch: 23, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.061 Vali Acc: 0.258 Test Loss: 4.061 Test Acc: 0.258
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.0981059074401855
Epoch: 24, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.077 Vali Acc: 0.258 Test Loss: 4.077 Test Acc: 0.258
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.8936951160430908
Epoch: 25, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.117 Vali Acc: 0.256 Test Loss: 4.117 Test Acc: 0.256
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2635294117647059
model parameter : 206138
model size : 0.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.7851455211639404
Epoch: 1, Steps: 10 | Train Loss: 3.361 Vali Loss: 3.280 Vali Acc: 0.041 Test Loss: 3.280 Test Acc: 0.041
Validation loss decreased (inf --> -0.041144).  Saving model ...
Epoch: 2 cost time: 0.9493443965911865
Epoch: 2, Steps: 10 | Train Loss: 3.211 Vali Loss: 3.262 Vali Acc: 0.054 Test Loss: 3.262 Test Acc: 0.054
Validation loss decreased (-0.041144 --> -0.054085).  Saving model ...
Epoch: 3 cost time: 0.9193997383117676
Epoch: 3, Steps: 10 | Train Loss: 2.955 Vali Loss: 3.248 Vali Acc: 0.071 Test Loss: 3.248 Test Acc: 0.071
Validation loss decreased (-0.054085 --> -0.070556).  Saving model ...
Epoch: 4 cost time: 0.9144840240478516
Epoch: 4, Steps: 10 | Train Loss: 2.731 Vali Loss: 3.244 Vali Acc: 0.096 Test Loss: 3.244 Test Acc: 0.096
Validation loss decreased (-0.070556 --> -0.096438).  Saving model ...
Epoch: 5 cost time: 0.9221048355102539
Epoch: 5, Steps: 10 | Train Loss: 2.464 Vali Loss: 3.220 Vali Acc: 0.112 Test Loss: 3.220 Test Acc: 0.112
Validation loss decreased (-0.096438 --> -0.111733).  Saving model ...
Epoch: 6 cost time: 1.002650260925293
Epoch: 6, Steps: 10 | Train Loss: 2.173 Vali Loss: 3.205 Vali Acc: 0.122 Test Loss: 3.205 Test Acc: 0.122
Validation loss decreased (-0.111733 --> -0.122321).  Saving model ...
Epoch: 7 cost time: 0.9878525733947754
Epoch: 7, Steps: 10 | Train Loss: 1.908 Vali Loss: 3.182 Vali Acc: 0.135 Test Loss: 3.182 Test Acc: 0.135
Validation loss decreased (-0.122321 --> -0.135262).  Saving model ...
Epoch: 8 cost time: 1.126072883605957
Epoch: 8, Steps: 10 | Train Loss: 1.616 Vali Loss: 3.166 Vali Acc: 0.160 Test Loss: 3.166 Test Acc: 0.160
Validation loss decreased (-0.135262 --> -0.159968).  Saving model ...
Epoch: 9 cost time: 1.0502512454986572
Epoch: 9, Steps: 10 | Train Loss: 1.400 Vali Loss: 3.157 Vali Acc: 0.180 Test Loss: 3.157 Test Acc: 0.180
Validation loss decreased (-0.159968 --> -0.179968).  Saving model ...
Epoch: 10 cost time: 1.118093490600586
Epoch: 10, Steps: 10 | Train Loss: 1.104 Vali Loss: 3.178 Vali Acc: 0.185 Test Loss: 3.178 Test Acc: 0.185
Validation loss decreased (-0.179968 --> -0.184674).  Saving model ...
Epoch: 11 cost time: 1.2078406810760498
Epoch: 11, Steps: 10 | Train Loss: 0.927 Vali Loss: 3.197 Vali Acc: 0.199 Test Loss: 3.197 Test Acc: 0.199
Validation loss decreased (-0.184674 --> -0.198792).  Saving model ...
Epoch: 12 cost time: 1.0210645198822021
Epoch: 12, Steps: 10 | Train Loss: 0.739 Vali Loss: 3.243 Vali Acc: 0.214 Test Loss: 3.243 Test Acc: 0.214
Validation loss decreased (-0.198792 --> -0.214085).  Saving model ...
Epoch: 13 cost time: 1.1681766510009766
Epoch: 13, Steps: 10 | Train Loss: 0.601 Vali Loss: 3.269 Vali Acc: 0.227 Test Loss: 3.269 Test Acc: 0.227
Validation loss decreased (-0.214085 --> -0.227026).  Saving model ...
Epoch: 14 cost time: 1.2567343711853027
Epoch: 14, Steps: 10 | Train Loss: 0.442 Vali Loss: 3.318 Vali Acc: 0.234 Test Loss: 3.318 Test Acc: 0.234
Validation loss decreased (-0.227026 --> -0.234084).  Saving model ...
Epoch: 15 cost time: 1.1096646785736084
Epoch: 15, Steps: 10 | Train Loss: 0.373 Vali Loss: 3.351 Vali Acc: 0.245 Test Loss: 3.351 Test Acc: 0.245
Validation loss decreased (-0.234084 --> -0.244672).  Saving model ...
Epoch: 16 cost time: 1.0100576877593994
Epoch: 16, Steps: 10 | Train Loss: 0.263 Vali Loss: 3.414 Vali Acc: 0.245 Test Loss: 3.414 Test Acc: 0.245
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0563304424285889
Epoch: 17, Steps: 10 | Train Loss: 0.201 Vali Loss: 3.453 Vali Acc: 0.252 Test Loss: 3.453 Test Acc: 0.252
Validation loss decreased (-0.244672 --> -0.251730).  Saving model ...
Epoch: 18 cost time: 1.196181058883667
Epoch: 18, Steps: 10 | Train Loss: 0.158 Vali Loss: 3.500 Vali Acc: 0.251 Test Loss: 3.500 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1114459037780762
Epoch: 19, Steps: 10 | Train Loss: 0.130 Vali Loss: 3.553 Vali Acc: 0.247 Test Loss: 3.553 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.0496509075164795
Epoch: 20, Steps: 10 | Train Loss: 0.112 Vali Loss: 3.597 Vali Acc: 0.248 Test Loss: 3.597 Test Acc: 0.248
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.265890121459961
Epoch: 21, Steps: 10 | Train Loss: 0.093 Vali Loss: 3.622 Vali Acc: 0.255 Test Loss: 3.622 Test Acc: 0.255
Validation loss decreased (-0.251730 --> -0.255258).  Saving model ...
Epoch: 22 cost time: 1.1436431407928467
Epoch: 22, Steps: 10 | Train Loss: 0.078 Vali Loss: 3.666 Vali Acc: 0.251 Test Loss: 3.666 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.4348499774932861
Epoch: 23, Steps: 10 | Train Loss: 0.066 Vali Loss: 3.700 Vali Acc: 0.252 Test Loss: 3.700 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.1244637966156006
Epoch: 24, Steps: 10 | Train Loss: 0.061 Vali Loss: 3.757 Vali Acc: 0.255 Test Loss: 3.757 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.093289852142334
Epoch: 25, Steps: 10 | Train Loss: 0.050 Vali Loss: 3.804 Vali Acc: 0.255 Test Loss: 3.804 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.2530443668365479
Epoch: 26, Steps: 10 | Train Loss: 0.046 Vali Loss: 3.806 Vali Acc: 0.254 Test Loss: 3.806 Test Acc: 0.254
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.2144198417663574
Epoch: 27, Steps: 10 | Train Loss: 0.038 Vali Loss: 3.821 Vali Acc: 0.260 Test Loss: 3.821 Test Acc: 0.260
Validation loss decreased (-0.255258 --> -0.259962).  Saving model ...
Epoch: 28 cost time: 1.3181562423706055
Epoch: 28, Steps: 10 | Train Loss: 0.037 Vali Loss: 3.851 Vali Acc: 0.256 Test Loss: 3.851 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.2090253829956055
Epoch: 29, Steps: 10 | Train Loss: 0.036 Vali Loss: 3.880 Vali Acc: 0.258 Test Loss: 3.880 Test Acc: 0.258
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.1239650249481201
Epoch: 30, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.898 Vali Acc: 0.260 Test Loss: 3.898 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.0674083232879639
Epoch: 31, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.930 Vali Acc: 0.259 Test Loss: 3.930 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.1571204662322998
Epoch: 32, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.955 Vali Acc: 0.259 Test Loss: 3.955 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.1373145580291748
Epoch: 33, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.974 Vali Acc: 0.258 Test Loss: 3.974 Test Acc: 0.258
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.1732356548309326
Epoch: 34, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.997 Vali Acc: 0.261 Test Loss: 3.997 Test Acc: 0.261
Validation loss decreased (-0.259962 --> -0.261137).  Saving model ...
Epoch: 35 cost time: 1.1747169494628906
Epoch: 35, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.007 Vali Acc: 0.264 Test Loss: 4.007 Test Acc: 0.264
Validation loss decreased (-0.261137 --> -0.263489).  Saving model ...
Epoch: 36 cost time: 1.2481584548950195
Epoch: 36, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.039 Vali Acc: 0.266 Test Loss: 4.039 Test Acc: 0.266
Validation loss decreased (-0.263489 --> -0.265842).  Saving model ...
Epoch: 37 cost time: 1.1710920333862305
Epoch: 37, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.071 Vali Acc: 0.258 Test Loss: 4.071 Test Acc: 0.258
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.0928823947906494
Epoch: 38, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.102 Vali Acc: 0.258 Test Loss: 4.102 Test Acc: 0.258
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.2464148998260498
Epoch: 39, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.113 Vali Acc: 0.261 Test Loss: 4.113 Test Acc: 0.261
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.3750216960906982
Epoch: 40, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.122 Vali Acc: 0.258 Test Loss: 4.122 Test Acc: 0.258
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.1795082092285156
Epoch: 41, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.139 Vali Acc: 0.260 Test Loss: 4.139 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.3036150932312012
Epoch: 42, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.163 Vali Acc: 0.260 Test Loss: 4.163 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.2323696613311768
Epoch: 43, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.183 Vali Acc: 0.258 Test Loss: 4.183 Test Acc: 0.258
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.0661523342132568
Epoch: 44, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.211 Vali Acc: 0.260 Test Loss: 4.211 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 1.1080377101898193
Epoch: 45, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.240 Vali Acc: 0.261 Test Loss: 4.240 Test Acc: 0.261
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 1.0284762382507324
Epoch: 46, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.257 Vali Acc: 0.261 Test Loss: 4.257 Test Acc: 0.261
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26588235294117646
model parameter : 111418
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps12_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.870938539505005
Epoch: 1, Steps: 10 | Train Loss: 3.329 Vali Loss: 3.300 Vali Acc: 0.033 Test Loss: 3.300 Test Acc: 0.033
Validation loss decreased (inf --> -0.032908).  Saving model ...
Epoch: 2 cost time: 0.8971049785614014
Epoch: 2, Steps: 10 | Train Loss: 3.248 Vali Loss: 3.296 Vali Acc: 0.042 Test Loss: 3.296 Test Acc: 0.042
Validation loss decreased (-0.032908 --> -0.042320).  Saving model ...
Epoch: 3 cost time: 0.9848153591156006
Epoch: 3, Steps: 10 | Train Loss: 3.090 Vali Loss: 3.286 Vali Acc: 0.055 Test Loss: 3.286 Test Acc: 0.055
Validation loss decreased (-0.042320 --> -0.055261).  Saving model ...
Epoch: 4 cost time: 0.9638299942016602
Epoch: 4, Steps: 10 | Train Loss: 2.894 Vali Loss: 3.274 Vali Acc: 0.074 Test Loss: 3.274 Test Acc: 0.074
Validation loss decreased (-0.055261 --> -0.074085).  Saving model ...
Epoch: 5 cost time: 0.9528841972351074
Epoch: 5, Steps: 10 | Train Loss: 2.722 Vali Loss: 3.257 Vali Acc: 0.082 Test Loss: 3.257 Test Acc: 0.082
Validation loss decreased (-0.074085 --> -0.082320).  Saving model ...
Epoch: 6 cost time: 0.9912674427032471
Epoch: 6, Steps: 10 | Train Loss: 2.527 Vali Loss: 3.242 Vali Acc: 0.108 Test Loss: 3.242 Test Acc: 0.108
Validation loss decreased (-0.082320 --> -0.108203).  Saving model ...
Epoch: 7 cost time: 0.9588522911071777
Epoch: 7, Steps: 10 | Train Loss: 2.309 Vali Loss: 3.236 Vali Acc: 0.125 Test Loss: 3.236 Test Acc: 0.125
Validation loss decreased (-0.108203 --> -0.124674).  Saving model ...
Epoch: 8 cost time: 1.1655640602111816
Epoch: 8, Steps: 10 | Train Loss: 2.056 Vali Loss: 3.216 Vali Acc: 0.145 Test Loss: 3.216 Test Acc: 0.145
Validation loss decreased (-0.124674 --> -0.144674).  Saving model ...
Epoch: 9 cost time: 1.048210620880127
Epoch: 9, Steps: 10 | Train Loss: 1.846 Vali Loss: 3.196 Vali Acc: 0.154 Test Loss: 3.196 Test Acc: 0.154
Validation loss decreased (-0.144674 --> -0.154086).  Saving model ...
Epoch: 10 cost time: 0.9181184768676758
Epoch: 10, Steps: 10 | Train Loss: 1.604 Vali Loss: 3.190 Vali Acc: 0.162 Test Loss: 3.190 Test Acc: 0.162
Validation loss decreased (-0.154086 --> -0.162321).  Saving model ...
Epoch: 11 cost time: 1.0578503608703613
Epoch: 11, Steps: 10 | Train Loss: 1.446 Vali Loss: 3.187 Vali Acc: 0.174 Test Loss: 3.187 Test Acc: 0.174
Validation loss decreased (-0.162321 --> -0.174086).  Saving model ...
Epoch: 12 cost time: 0.9375820159912109
Epoch: 12, Steps: 10 | Train Loss: 1.221 Vali Loss: 3.183 Vali Acc: 0.181 Test Loss: 3.183 Test Acc: 0.181
Validation loss decreased (-0.174086 --> -0.181145).  Saving model ...
Epoch: 13 cost time: 0.9924252033233643
Epoch: 13, Steps: 10 | Train Loss: 1.045 Vali Loss: 3.184 Vali Acc: 0.199 Test Loss: 3.184 Test Acc: 0.199
Validation loss decreased (-0.181145 --> -0.198792).  Saving model ...
Epoch: 14 cost time: 0.9931235313415527
Epoch: 14, Steps: 10 | Train Loss: 0.875 Vali Loss: 3.204 Vali Acc: 0.214 Test Loss: 3.204 Test Acc: 0.214
Validation loss decreased (-0.198792 --> -0.214086).  Saving model ...
Epoch: 15 cost time: 1.0480921268463135
Epoch: 15, Steps: 10 | Train Loss: 0.755 Vali Loss: 3.227 Vali Acc: 0.218 Test Loss: 3.227 Test Acc: 0.218
Validation loss decreased (-0.214086 --> -0.217615).  Saving model ...
Epoch: 16 cost time: 0.9332113265991211
Epoch: 16, Steps: 10 | Train Loss: 0.612 Vali Loss: 3.248 Vali Acc: 0.226 Test Loss: 3.248 Test Acc: 0.226
Validation loss decreased (-0.217615 --> -0.225850).  Saving model ...
Epoch: 17 cost time: 0.949103593826294
Epoch: 17, Steps: 10 | Train Loss: 0.497 Vali Loss: 3.302 Vali Acc: 0.225 Test Loss: 3.302 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8515830039978027
Epoch: 18, Steps: 10 | Train Loss: 0.411 Vali Loss: 3.342 Vali Acc: 0.232 Test Loss: 3.342 Test Acc: 0.232
Validation loss decreased (-0.225850 --> -0.231731).  Saving model ...
Epoch: 19 cost time: 1.017256736755371
Epoch: 19, Steps: 10 | Train Loss: 0.345 Vali Loss: 3.376 Vali Acc: 0.232 Test Loss: 3.376 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0473945140838623
Epoch: 20, Steps: 10 | Train Loss: 0.283 Vali Loss: 3.388 Vali Acc: 0.233 Test Loss: 3.388 Test Acc: 0.233
Validation loss decreased (-0.231731 --> -0.232907).  Saving model ...
Epoch: 21 cost time: 0.9625585079193115
Epoch: 21, Steps: 10 | Train Loss: 0.232 Vali Loss: 3.443 Vali Acc: 0.240 Test Loss: 3.443 Test Acc: 0.240
Validation loss decreased (-0.232907 --> -0.239966).  Saving model ...
Epoch: 22 cost time: 0.9043056964874268
Epoch: 22, Steps: 10 | Train Loss: 0.194 Vali Loss: 3.472 Vali Acc: 0.238 Test Loss: 3.472 Test Acc: 0.238
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0528326034545898
Epoch: 23, Steps: 10 | Train Loss: 0.166 Vali Loss: 3.489 Vali Acc: 0.242 Test Loss: 3.489 Test Acc: 0.242
Validation loss decreased (-0.239966 --> -0.242318).  Saving model ...
Epoch: 24 cost time: 0.9400918483734131
Epoch: 24, Steps: 10 | Train Loss: 0.146 Vali Loss: 3.541 Vali Acc: 0.241 Test Loss: 3.541 Test Acc: 0.241
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9819002151489258
Epoch: 25, Steps: 10 | Train Loss: 0.118 Vali Loss: 3.585 Vali Acc: 0.245 Test Loss: 3.585 Test Acc: 0.245
Validation loss decreased (-0.242318 --> -0.244670).  Saving model ...
Epoch: 26 cost time: 1.1110191345214844
Epoch: 26, Steps: 10 | Train Loss: 0.103 Vali Loss: 3.612 Vali Acc: 0.240 Test Loss: 3.612 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9987170696258545
Epoch: 27, Steps: 10 | Train Loss: 0.096 Vali Loss: 3.639 Vali Acc: 0.239 Test Loss: 3.639 Test Acc: 0.239
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.9651238918304443
Epoch: 28, Steps: 10 | Train Loss: 0.080 Vali Loss: 3.661 Vali Acc: 0.245 Test Loss: 3.661 Test Acc: 0.245
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.9753947257995605
Epoch: 29, Steps: 10 | Train Loss: 0.069 Vali Loss: 3.686 Vali Acc: 0.244 Test Loss: 3.686 Test Acc: 0.244
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.0442125797271729
Epoch: 30, Steps: 10 | Train Loss: 0.065 Vali Loss: 3.734 Vali Acc: 0.247 Test Loss: 3.734 Test Acc: 0.247
Validation loss decreased (-0.244670 --> -0.247021).  Saving model ...
Epoch: 31 cost time: 0.9295365810394287
Epoch: 31, Steps: 10 | Train Loss: 0.056 Vali Loss: 3.763 Vali Acc: 0.244 Test Loss: 3.763 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.9415061473846436
Epoch: 32, Steps: 10 | Train Loss: 0.052 Vali Loss: 3.772 Vali Acc: 0.252 Test Loss: 3.772 Test Acc: 0.252
Validation loss decreased (-0.247021 --> -0.251727).  Saving model ...
Epoch: 33 cost time: 1.2564947605133057
Epoch: 33, Steps: 10 | Train Loss: 0.048 Vali Loss: 3.788 Vali Acc: 0.249 Test Loss: 3.788 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.0651695728302002
Epoch: 34, Steps: 10 | Train Loss: 0.046 Vali Loss: 3.825 Vali Acc: 0.245 Test Loss: 3.825 Test Acc: 0.245
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.0094821453094482
Epoch: 35, Steps: 10 | Train Loss: 0.039 Vali Loss: 3.836 Vali Acc: 0.248 Test Loss: 3.836 Test Acc: 0.248
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.0722322463989258
Epoch: 36, Steps: 10 | Train Loss: 0.036 Vali Loss: 3.863 Vali Acc: 0.249 Test Loss: 3.863 Test Acc: 0.249
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.99125075340271
Epoch: 37, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.888 Vali Acc: 0.251 Test Loss: 3.888 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.1005134582519531
Epoch: 38, Steps: 10 | Train Loss: 0.033 Vali Loss: 3.925 Vali Acc: 0.248 Test Loss: 3.925 Test Acc: 0.248
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.9960122108459473
Epoch: 39, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.953 Vali Acc: 0.249 Test Loss: 3.953 Test Acc: 0.249
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.99530029296875
Epoch: 40, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.984 Vali Acc: 0.251 Test Loss: 3.984 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.1382114887237549
Epoch: 41, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.002 Vali Acc: 0.249 Test Loss: 4.002 Test Acc: 0.249
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.0023868083953857
Epoch: 42, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.012 Vali Acc: 0.247 Test Loss: 4.012 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps12_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.25176470588235295
model parameter : 79098
model size : 0.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.2453503608703613
Epoch: 1, Steps: 10 | Train Loss: 3.326 Vali Loss: 3.278 Vali Acc: 0.041 Test Loss: 3.278 Test Acc: 0.041
Validation loss decreased (inf --> -0.041144).  Saving model ...
Epoch: 2 cost time: 1.0004065036773682
Epoch: 2, Steps: 10 | Train Loss: 3.238 Vali Loss: 3.269 Vali Acc: 0.045 Test Loss: 3.269 Test Acc: 0.045
Validation loss decreased (-0.041144 --> -0.044673).  Saving model ...
Epoch: 3 cost time: 1.2419123649597168
Epoch: 3, Steps: 10 | Train Loss: 3.112 Vali Loss: 3.254 Vali Acc: 0.062 Test Loss: 3.254 Test Acc: 0.062
Validation loss decreased (-0.044673 --> -0.062320).  Saving model ...
Epoch: 4 cost time: 0.9657940864562988
Epoch: 4, Steps: 10 | Train Loss: 2.978 Vali Loss: 3.242 Vali Acc: 0.067 Test Loss: 3.242 Test Acc: 0.067
Validation loss decreased (-0.062320 --> -0.067026).  Saving model ...
Epoch: 5 cost time: 1.0422377586364746
Epoch: 5, Steps: 10 | Train Loss: 2.792 Vali Loss: 3.231 Vali Acc: 0.091 Test Loss: 3.231 Test Acc: 0.091
Validation loss decreased (-0.067026 --> -0.090556).  Saving model ...
Epoch: 6 cost time: 0.9640300273895264
Epoch: 6, Steps: 10 | Train Loss: 2.645 Vali Loss: 3.223 Vali Acc: 0.100 Test Loss: 3.223 Test Acc: 0.100
Validation loss decreased (-0.090556 --> -0.099968).  Saving model ...
Epoch: 7 cost time: 0.9992082118988037
Epoch: 7, Steps: 10 | Train Loss: 2.494 Vali Loss: 3.213 Vali Acc: 0.116 Test Loss: 3.213 Test Acc: 0.116
Validation loss decreased (-0.099968 --> -0.116438).  Saving model ...
Epoch: 8 cost time: 0.967073917388916
Epoch: 8, Steps: 10 | Train Loss: 2.284 Vali Loss: 3.201 Vali Acc: 0.129 Test Loss: 3.201 Test Acc: 0.129
Validation loss decreased (-0.116438 --> -0.129380).  Saving model ...
Epoch: 9 cost time: 0.95809006690979
Epoch: 9, Steps: 10 | Train Loss: 2.118 Vali Loss: 3.180 Vali Acc: 0.153 Test Loss: 3.180 Test Acc: 0.153
Validation loss decreased (-0.129380 --> -0.152909).  Saving model ...
Epoch: 10 cost time: 0.8782250881195068
Epoch: 10, Steps: 10 | Train Loss: 1.916 Vali Loss: 3.164 Vali Acc: 0.167 Test Loss: 3.164 Test Acc: 0.167
Validation loss decreased (-0.152909 --> -0.167027).  Saving model ...
Epoch: 11 cost time: 0.9497957229614258
Epoch: 11, Steps: 10 | Train Loss: 1.768 Vali Loss: 3.155 Vali Acc: 0.169 Test Loss: 3.155 Test Acc: 0.169
Validation loss decreased (-0.167027 --> -0.169380).  Saving model ...
Epoch: 12 cost time: 0.8879883289337158
Epoch: 12, Steps: 10 | Train Loss: 1.569 Vali Loss: 3.154 Vali Acc: 0.180 Test Loss: 3.154 Test Acc: 0.180
Validation loss decreased (-0.169380 --> -0.179968).  Saving model ...
Epoch: 13 cost time: 0.8247857093811035
Epoch: 13, Steps: 10 | Train Loss: 1.429 Vali Loss: 3.156 Vali Acc: 0.195 Test Loss: 3.156 Test Acc: 0.195
Validation loss decreased (-0.179968 --> -0.195263).  Saving model ...
Epoch: 14 cost time: 0.9203512668609619
Epoch: 14, Steps: 10 | Train Loss: 1.270 Vali Loss: 3.156 Vali Acc: 0.201 Test Loss: 3.156 Test Acc: 0.201
Validation loss decreased (-0.195263 --> -0.201145).  Saving model ...
Epoch: 15 cost time: 1.0170197486877441
Epoch: 15, Steps: 10 | Train Loss: 1.127 Vali Loss: 3.164 Vali Acc: 0.214 Test Loss: 3.164 Test Acc: 0.214
Validation loss decreased (-0.201145 --> -0.214086).  Saving model ...
Epoch: 16 cost time: 0.886533260345459
Epoch: 16, Steps: 10 | Train Loss: 0.954 Vali Loss: 3.183 Vali Acc: 0.219 Test Loss: 3.183 Test Acc: 0.219
Validation loss decreased (-0.214086 --> -0.218792).  Saving model ...
Epoch: 17 cost time: 1.0841808319091797
Epoch: 17, Steps: 10 | Train Loss: 0.866 Vali Loss: 3.208 Vali Acc: 0.218 Test Loss: 3.208 Test Acc: 0.218
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8808369636535645
Epoch: 18, Steps: 10 | Train Loss: 0.721 Vali Loss: 3.227 Vali Acc: 0.226 Test Loss: 3.227 Test Acc: 0.226
Validation loss decreased (-0.218792 --> -0.225850).  Saving model ...
Epoch: 19 cost time: 0.957582950592041
Epoch: 19, Steps: 10 | Train Loss: 0.611 Vali Loss: 3.254 Vali Acc: 0.233 Test Loss: 3.254 Test Acc: 0.233
Validation loss decreased (-0.225850 --> -0.232909).  Saving model ...
Epoch: 20 cost time: 0.934124231338501
Epoch: 20, Steps: 10 | Train Loss: 0.523 Vali Loss: 3.274 Vali Acc: 0.235 Test Loss: 3.274 Test Acc: 0.235
Validation loss decreased (-0.232909 --> -0.235261).  Saving model ...
Epoch: 21 cost time: 0.9737498760223389
Epoch: 21, Steps: 10 | Train Loss: 0.450 Vali Loss: 3.314 Vali Acc: 0.240 Test Loss: 3.314 Test Acc: 0.240
Validation loss decreased (-0.235261 --> -0.239967).  Saving model ...
Epoch: 22 cost time: 0.9416890144348145
Epoch: 22, Steps: 10 | Train Loss: 0.380 Vali Loss: 3.352 Vali Acc: 0.238 Test Loss: 3.352 Test Acc: 0.238
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0128660202026367
Epoch: 23, Steps: 10 | Train Loss: 0.332 Vali Loss: 3.377 Vali Acc: 0.246 Test Loss: 3.377 Test Acc: 0.246
Validation loss decreased (-0.239967 --> -0.245849).  Saving model ...
Epoch: 24 cost time: 0.8392455577850342
Epoch: 24, Steps: 10 | Train Loss: 0.279 Vali Loss: 3.402 Vali Acc: 0.241 Test Loss: 3.402 Test Acc: 0.241
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8561310768127441
Epoch: 25, Steps: 10 | Train Loss: 0.250 Vali Loss: 3.442 Vali Acc: 0.245 Test Loss: 3.442 Test Acc: 0.245
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.9012272357940674
Epoch: 26, Steps: 10 | Train Loss: 0.208 Vali Loss: 3.488 Vali Acc: 0.246 Test Loss: 3.488 Test Acc: 0.246
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.93072509765625
Epoch: 27, Steps: 10 | Train Loss: 0.178 Vali Loss: 3.503 Vali Acc: 0.259 Test Loss: 3.503 Test Acc: 0.259
Validation loss decreased (-0.245849 --> -0.258789).  Saving model ...
Epoch: 28 cost time: 0.9508090019226074
Epoch: 28, Steps: 10 | Train Loss: 0.159 Vali Loss: 3.551 Vali Acc: 0.255 Test Loss: 3.551 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.0868029594421387
Epoch: 29, Steps: 10 | Train Loss: 0.138 Vali Loss: 3.588 Vali Acc: 0.253 Test Loss: 3.588 Test Acc: 0.253
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.9809083938598633
Epoch: 30, Steps: 10 | Train Loss: 0.124 Vali Loss: 3.625 Vali Acc: 0.252 Test Loss: 3.625 Test Acc: 0.252
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.9170897006988525
Epoch: 31, Steps: 10 | Train Loss: 0.111 Vali Loss: 3.644 Vali Acc: 0.256 Test Loss: 3.644 Test Acc: 0.256
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.8345353603363037
Epoch: 32, Steps: 10 | Train Loss: 0.097 Vali Loss: 3.680 Vali Acc: 0.259 Test Loss: 3.680 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.9011564254760742
Epoch: 33, Steps: 10 | Train Loss: 0.087 Vali Loss: 3.714 Vali Acc: 0.262 Test Loss: 3.714 Test Acc: 0.262
Validation loss decreased (-0.258789 --> -0.262316).  Saving model ...
Epoch: 34 cost time: 0.8924150466918945
Epoch: 34, Steps: 10 | Train Loss: 0.077 Vali Loss: 3.732 Vali Acc: 0.262 Test Loss: 3.732 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.9883244037628174
Epoch: 35, Steps: 10 | Train Loss: 0.069 Vali Loss: 3.767 Vali Acc: 0.259 Test Loss: 3.767 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.9728002548217773
Epoch: 36, Steps: 10 | Train Loss: 0.065 Vali Loss: 3.807 Vali Acc: 0.262 Test Loss: 3.807 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.899341344833374
Epoch: 37, Steps: 10 | Train Loss: 0.060 Vali Loss: 3.825 Vali Acc: 0.266 Test Loss: 3.825 Test Acc: 0.266
Validation loss decreased (-0.262316 --> -0.265844).  Saving model ...
Epoch: 38 cost time: 1.0310008525848389
Epoch: 38, Steps: 10 | Train Loss: 0.056 Vali Loss: 3.864 Vali Acc: 0.262 Test Loss: 3.864 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.9723556041717529
Epoch: 39, Steps: 10 | Train Loss: 0.050 Vali Loss: 3.901 Vali Acc: 0.265 Test Loss: 3.901 Test Acc: 0.265
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.9950389862060547
Epoch: 40, Steps: 10 | Train Loss: 0.046 Vali Loss: 3.919 Vali Acc: 0.267 Test Loss: 3.919 Test Acc: 0.267
Validation loss decreased (-0.265844 --> -0.267020).  Saving model ...
Epoch: 41 cost time: 1.0532608032226562
Epoch: 41, Steps: 10 | Train Loss: 0.041 Vali Loss: 3.962 Vali Acc: 0.269 Test Loss: 3.962 Test Acc: 0.269
Validation loss decreased (-0.267020 --> -0.269372).  Saving model ...
Epoch: 42 cost time: 0.8464429378509521
Epoch: 42, Steps: 10 | Train Loss: 0.039 Vali Loss: 3.995 Vali Acc: 0.268 Test Loss: 3.995 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.9717719554901123
Epoch: 43, Steps: 10 | Train Loss: 0.037 Vali Loss: 4.019 Vali Acc: 0.267 Test Loss: 4.019 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.0031960010528564
Epoch: 44, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.060 Vali Acc: 0.268 Test Loss: 4.060 Test Acc: 0.268
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.0909860134124756
Epoch: 45, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.083 Vali Acc: 0.262 Test Loss: 4.083 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.9220113754272461
Epoch: 46, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.111 Vali Acc: 0.264 Test Loss: 4.111 Test Acc: 0.264
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.9283349514007568
Epoch: 47, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.122 Vali Acc: 0.261 Test Loss: 4.122 Test Acc: 0.261
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.8970687389373779
Epoch: 48, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.155 Vali Acc: 0.260 Test Loss: 4.155 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.9567229747772217
Epoch: 49, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.178 Vali Acc: 0.266 Test Loss: 4.178 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 0.9240128993988037
Epoch: 50, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.202 Vali Acc: 0.268 Test Loss: 4.202 Test Acc: 0.268
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26941176470588235
model parameter : 64250
model size : 0.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps23_str12_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.005542278289795
Epoch: 1, Steps: 10 | Train Loss: 3.329 Vali Loss: 3.291 Vali Acc: 0.034 Test Loss: 3.291 Test Acc: 0.034
Validation loss decreased (inf --> -0.034085).  Saving model ...
Epoch: 2 cost time: 1.078608512878418
Epoch: 2, Steps: 10 | Train Loss: 3.277 Vali Loss: 3.293 Vali Acc: 0.040 Test Loss: 3.293 Test Acc: 0.040
Validation loss decreased (-0.034085 --> -0.039967).  Saving model ...
Epoch: 3 cost time: 0.8842034339904785
Epoch: 3, Steps: 10 | Train Loss: 3.192 Vali Loss: 3.286 Vali Acc: 0.051 Test Loss: 3.286 Test Acc: 0.051
Validation loss decreased (-0.039967 --> -0.050555).  Saving model ...
Epoch: 4 cost time: 0.9748611450195312
Epoch: 4, Steps: 10 | Train Loss: 3.103 Vali Loss: 3.275 Vali Acc: 0.054 Test Loss: 3.275 Test Acc: 0.054
Validation loss decreased (-0.050555 --> -0.054085).  Saving model ...
Epoch: 5 cost time: 0.8948397636413574
Epoch: 5, Steps: 10 | Train Loss: 2.934 Vali Loss: 3.263 Vali Acc: 0.074 Test Loss: 3.263 Test Acc: 0.074
Validation loss decreased (-0.054085 --> -0.074085).  Saving model ...
Epoch: 6 cost time: 1.0349724292755127
Epoch: 6, Steps: 10 | Train Loss: 2.835 Vali Loss: 3.254 Vali Acc: 0.091 Test Loss: 3.254 Test Acc: 0.091
Validation loss decreased (-0.074085 --> -0.090556).  Saving model ...
Epoch: 7 cost time: 1.0104925632476807
Epoch: 7, Steps: 10 | Train Loss: 2.709 Vali Loss: 3.246 Vali Acc: 0.095 Test Loss: 3.246 Test Acc: 0.095
Validation loss decreased (-0.090556 --> -0.095262).  Saving model ...
Epoch: 8 cost time: 0.9669201374053955
Epoch: 8, Steps: 10 | Train Loss: 2.582 Vali Loss: 3.239 Vali Acc: 0.106 Test Loss: 3.239 Test Acc: 0.106
Validation loss decreased (-0.095262 --> -0.105850).  Saving model ...
Epoch: 9 cost time: 1.1393115520477295
Epoch: 9, Steps: 10 | Train Loss: 2.435 Vali Loss: 3.229 Vali Acc: 0.111 Test Loss: 3.229 Test Acc: 0.111
Validation loss decreased (-0.105850 --> -0.110556).  Saving model ...
Epoch: 10 cost time: 1.0283534526824951
Epoch: 10, Steps: 10 | Train Loss: 2.316 Vali Loss: 3.224 Vali Acc: 0.119 Test Loss: 3.224 Test Acc: 0.119
Validation loss decreased (-0.110556 --> -0.118791).  Saving model ...
Epoch: 11 cost time: 0.8391761779785156
Epoch: 11, Steps: 10 | Train Loss: 2.202 Vali Loss: 3.217 Vali Acc: 0.124 Test Loss: 3.217 Test Acc: 0.124
Validation loss decreased (-0.118791 --> -0.123497).  Saving model ...
Epoch: 12 cost time: 0.8499608039855957
Epoch: 12, Steps: 10 | Train Loss: 2.041 Vali Loss: 3.205 Vali Acc: 0.134 Test Loss: 3.205 Test Acc: 0.134
Validation loss decreased (-0.123497 --> -0.134086).  Saving model ...
Epoch: 13 cost time: 0.933497428894043
Epoch: 13, Steps: 10 | Train Loss: 1.904 Vali Loss: 3.201 Vali Acc: 0.139 Test Loss: 3.201 Test Acc: 0.139
Validation loss decreased (-0.134086 --> -0.138792).  Saving model ...
Epoch: 14 cost time: 0.9054396152496338
Epoch: 14, Steps: 10 | Train Loss: 1.756 Vali Loss: 3.194 Vali Acc: 0.153 Test Loss: 3.194 Test Acc: 0.153
Validation loss decreased (-0.138792 --> -0.152909).  Saving model ...
Epoch: 15 cost time: 0.9787857532501221
Epoch: 15, Steps: 10 | Train Loss: 1.611 Vali Loss: 3.195 Vali Acc: 0.161 Test Loss: 3.195 Test Acc: 0.161
Validation loss decreased (-0.152909 --> -0.161145).  Saving model ...
Epoch: 16 cost time: 0.9119892120361328
Epoch: 16, Steps: 10 | Train Loss: 1.515 Vali Loss: 3.201 Vali Acc: 0.169 Test Loss: 3.201 Test Acc: 0.169
Validation loss decreased (-0.161145 --> -0.169380).  Saving model ...
Epoch: 17 cost time: 0.8598682880401611
Epoch: 17, Steps: 10 | Train Loss: 1.375 Vali Loss: 3.196 Vali Acc: 0.181 Test Loss: 3.196 Test Acc: 0.181
Validation loss decreased (-0.169380 --> -0.181145).  Saving model ...
Epoch: 18 cost time: 1.0480594635009766
Epoch: 18, Steps: 10 | Train Loss: 1.253 Vali Loss: 3.203 Vali Acc: 0.186 Test Loss: 3.203 Test Acc: 0.186
Validation loss decreased (-0.181145 --> -0.185850).  Saving model ...
Epoch: 19 cost time: 1.0305469036102295
Epoch: 19, Steps: 10 | Train Loss: 1.161 Vali Loss: 3.210 Vali Acc: 0.199 Test Loss: 3.210 Test Acc: 0.199
Validation loss decreased (-0.185850 --> -0.198791).  Saving model ...
Epoch: 20 cost time: 0.9309220314025879
Epoch: 20, Steps: 10 | Train Loss: 1.024 Vali Loss: 3.216 Vali Acc: 0.209 Test Loss: 3.216 Test Acc: 0.209
Validation loss decreased (-0.198791 --> -0.209380).  Saving model ...
Epoch: 21 cost time: 1.1160101890563965
Epoch: 21, Steps: 10 | Train Loss: 0.934 Vali Loss: 3.231 Vali Acc: 0.219 Test Loss: 3.231 Test Acc: 0.219
Validation loss decreased (-0.209380 --> -0.218791).  Saving model ...
Epoch: 22 cost time: 0.9837982654571533
Epoch: 22, Steps: 10 | Train Loss: 0.839 Vali Loss: 3.254 Vali Acc: 0.227 Test Loss: 3.254 Test Acc: 0.227
Validation loss decreased (-0.218791 --> -0.227026).  Saving model ...
Epoch: 23 cost time: 1.1291849613189697
Epoch: 23, Steps: 10 | Train Loss: 0.723 Vali Loss: 3.271 Vali Acc: 0.222 Test Loss: 3.271 Test Acc: 0.222
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9100170135498047
Epoch: 24, Steps: 10 | Train Loss: 0.685 Vali Loss: 3.292 Vali Acc: 0.229 Test Loss: 3.292 Test Acc: 0.229
Validation loss decreased (-0.227026 --> -0.229379).  Saving model ...
Epoch: 25 cost time: 1.1466867923736572
Epoch: 25, Steps: 10 | Train Loss: 0.587 Vali Loss: 3.314 Vali Acc: 0.233 Test Loss: 3.314 Test Acc: 0.233
Validation loss decreased (-0.229379 --> -0.232908).  Saving model ...
Epoch: 26 cost time: 0.9847538471221924
Epoch: 26, Steps: 10 | Train Loss: 0.508 Vali Loss: 3.335 Vali Acc: 0.245 Test Loss: 3.335 Test Acc: 0.245
Validation loss decreased (-0.232908 --> -0.244673).  Saving model ...
Epoch: 27 cost time: 0.9089860916137695
Epoch: 27, Steps: 10 | Train Loss: 0.451 Vali Loss: 3.372 Vali Acc: 0.236 Test Loss: 3.372 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9918477535247803
Epoch: 28, Steps: 10 | Train Loss: 0.394 Vali Loss: 3.389 Vali Acc: 0.244 Test Loss: 3.389 Test Acc: 0.244
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.9231443405151367
Epoch: 29, Steps: 10 | Train Loss: 0.337 Vali Loss: 3.405 Vali Acc: 0.245 Test Loss: 3.405 Test Acc: 0.245
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.9622032642364502
Epoch: 30, Steps: 10 | Train Loss: 0.311 Vali Loss: 3.428 Vali Acc: 0.244 Test Loss: 3.428 Test Acc: 0.244
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.0208818912506104
Epoch: 31, Steps: 10 | Train Loss: 0.283 Vali Loss: 3.465 Vali Acc: 0.245 Test Loss: 3.465 Test Acc: 0.245
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.0017876625061035
Epoch: 32, Steps: 10 | Train Loss: 0.246 Vali Loss: 3.511 Vali Acc: 0.236 Test Loss: 3.511 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.9598503112792969
Epoch: 33, Steps: 10 | Train Loss: 0.232 Vali Loss: 3.540 Vali Acc: 0.242 Test Loss: 3.540 Test Acc: 0.242
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.918708086013794
Epoch: 34, Steps: 10 | Train Loss: 0.210 Vali Loss: 3.575 Vali Acc: 0.239 Test Loss: 3.575 Test Acc: 0.239
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.9259231090545654
Epoch: 35, Steps: 10 | Train Loss: 0.187 Vali Loss: 3.597 Vali Acc: 0.238 Test Loss: 3.597 Test Acc: 0.238
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.9095265865325928
Epoch: 36, Steps: 10 | Train Loss: 0.164 Vali Loss: 3.623 Vali Acc: 0.239 Test Loss: 3.623 Test Acc: 0.239
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps23_str12_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2447058823529412
model parameter : 47002
model size : 0.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.008760929107666
Epoch: 1, Steps: 10 | Train Loss: 3.434 Vali Loss: 3.317 Vali Acc: 0.039 Test Loss: 3.317 Test Acc: 0.039
Validation loss decreased (inf --> -0.038790).  Saving model ...
Epoch: 2 cost time: 0.9199185371398926
Epoch: 2, Steps: 10 | Train Loss: 3.349 Vali Loss: 3.324 Vali Acc: 0.039 Test Loss: 3.324 Test Acc: 0.039
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.04215407371521
Epoch: 3, Steps: 10 | Train Loss: 3.296 Vali Loss: 3.321 Vali Acc: 0.042 Test Loss: 3.321 Test Acc: 0.042
Validation loss decreased (-0.038790 --> -0.042320).  Saving model ...
Epoch: 4 cost time: 0.8615107536315918
Epoch: 4, Steps: 10 | Train Loss: 3.200 Vali Loss: 3.311 Vali Acc: 0.046 Test Loss: 3.311 Test Acc: 0.046
Validation loss decreased (-0.042320 --> -0.045849).  Saving model ...
Epoch: 5 cost time: 0.9659163951873779
Epoch: 5, Steps: 10 | Train Loss: 3.089 Vali Loss: 3.300 Vali Acc: 0.053 Test Loss: 3.300 Test Acc: 0.053
Validation loss decreased (-0.045849 --> -0.052908).  Saving model ...
Epoch: 6 cost time: 0.8421187400817871
Epoch: 6, Steps: 10 | Train Loss: 3.044 Vali Loss: 3.292 Vali Acc: 0.056 Test Loss: 3.292 Test Acc: 0.056
Validation loss decreased (-0.052908 --> -0.056438).  Saving model ...
Epoch: 7 cost time: 1.0061354637145996
Epoch: 7, Steps: 10 | Train Loss: 2.926 Vali Loss: 3.281 Vali Acc: 0.056 Test Loss: 3.281 Test Acc: 0.056
Validation loss decreased (-0.056438 --> -0.056438).  Saving model ...
Epoch: 8 cost time: 0.9649984836578369
Epoch: 8, Steps: 10 | Train Loss: 2.829 Vali Loss: 3.272 Vali Acc: 0.069 Test Loss: 3.272 Test Acc: 0.069
Validation loss decreased (-0.056438 --> -0.069379).  Saving model ...
Epoch: 9 cost time: 0.8515119552612305
Epoch: 9, Steps: 10 | Train Loss: 2.720 Vali Loss: 3.261 Vali Acc: 0.080 Test Loss: 3.261 Test Acc: 0.080
Validation loss decreased (-0.069379 --> -0.079967).  Saving model ...
Epoch: 10 cost time: 0.9765591621398926
Epoch: 10, Steps: 10 | Train Loss: 2.597 Vali Loss: 3.253 Vali Acc: 0.092 Test Loss: 3.253 Test Acc: 0.092
Validation loss decreased (-0.079967 --> -0.091732).  Saving model ...
Epoch: 11 cost time: 0.8213589191436768
Epoch: 11, Steps: 10 | Train Loss: 2.493 Vali Loss: 3.245 Vali Acc: 0.096 Test Loss: 3.245 Test Acc: 0.096
Validation loss decreased (-0.091732 --> -0.096438).  Saving model ...
Epoch: 12 cost time: 0.8621330261230469
Epoch: 12, Steps: 10 | Train Loss: 2.343 Vali Loss: 3.236 Vali Acc: 0.111 Test Loss: 3.236 Test Acc: 0.111
Validation loss decreased (-0.096438 --> -0.110556).  Saving model ...
Epoch: 13 cost time: 1.1818301677703857
Epoch: 13, Steps: 10 | Train Loss: 2.247 Vali Loss: 3.230 Vali Acc: 0.124 Test Loss: 3.230 Test Acc: 0.124
Validation loss decreased (-0.110556 --> -0.123497).  Saving model ...
Epoch: 14 cost time: 0.9548342227935791
Epoch: 14, Steps: 10 | Train Loss: 2.146 Vali Loss: 3.222 Vali Acc: 0.131 Test Loss: 3.222 Test Acc: 0.131
Validation loss decreased (-0.123497 --> -0.130556).  Saving model ...
Epoch: 15 cost time: 0.9377031326293945
Epoch: 15, Steps: 10 | Train Loss: 2.028 Vali Loss: 3.217 Vali Acc: 0.133 Test Loss: 3.217 Test Acc: 0.133
Validation loss decreased (-0.130556 --> -0.132909).  Saving model ...
Epoch: 16 cost time: 0.8696675300598145
Epoch: 16, Steps: 10 | Train Loss: 1.938 Vali Loss: 3.208 Vali Acc: 0.148 Test Loss: 3.208 Test Acc: 0.148
Validation loss decreased (-0.132909 --> -0.148203).  Saving model ...
Epoch: 17 cost time: 0.8410263061523438
Epoch: 17, Steps: 10 | Train Loss: 1.789 Vali Loss: 3.208 Vali Acc: 0.151 Test Loss: 3.208 Test Acc: 0.151
Validation loss decreased (-0.148203 --> -0.150556).  Saving model ...
Epoch: 18 cost time: 0.9370617866516113
Epoch: 18, Steps: 10 | Train Loss: 1.691 Vali Loss: 3.199 Vali Acc: 0.160 Test Loss: 3.199 Test Acc: 0.160
Validation loss decreased (-0.150556 --> -0.159968).  Saving model ...
Epoch: 19 cost time: 0.902524471282959
Epoch: 19, Steps: 10 | Train Loss: 1.559 Vali Loss: 3.195 Vali Acc: 0.164 Test Loss: 3.195 Test Acc: 0.164
Validation loss decreased (-0.159968 --> -0.163497).  Saving model ...
Epoch: 20 cost time: 0.9665126800537109
Epoch: 20, Steps: 10 | Train Loss: 1.471 Vali Loss: 3.193 Vali Acc: 0.172 Test Loss: 3.193 Test Acc: 0.172
Validation loss decreased (-0.163497 --> -0.171733).  Saving model ...
Epoch: 21 cost time: 0.9349324703216553
Epoch: 21, Steps: 10 | Train Loss: 1.339 Vali Loss: 3.204 Vali Acc: 0.179 Test Loss: 3.204 Test Acc: 0.179
Validation loss decreased (-0.171733 --> -0.178791).  Saving model ...
Epoch: 22 cost time: 1.014162540435791
Epoch: 22, Steps: 10 | Train Loss: 1.230 Vali Loss: 3.206 Vali Acc: 0.184 Test Loss: 3.206 Test Acc: 0.184
Validation loss decreased (-0.178791 --> -0.183497).  Saving model ...
Epoch: 23 cost time: 0.9209940433502197
Epoch: 23, Steps: 10 | Train Loss: 1.137 Vali Loss: 3.210 Vali Acc: 0.186 Test Loss: 3.210 Test Acc: 0.186
Validation loss decreased (-0.183497 --> -0.185850).  Saving model ...
Epoch: 24 cost time: 1.0388691425323486
Epoch: 24, Steps: 10 | Train Loss: 1.043 Vali Loss: 3.216 Vali Acc: 0.191 Test Loss: 3.216 Test Acc: 0.191
Validation loss decreased (-0.185850 --> -0.190556).  Saving model ...
Epoch: 25 cost time: 0.9108130931854248
Epoch: 25, Steps: 10 | Train Loss: 0.965 Vali Loss: 3.227 Vali Acc: 0.198 Test Loss: 3.227 Test Acc: 0.198
Validation loss decreased (-0.190556 --> -0.197615).  Saving model ...
Epoch: 26 cost time: 0.9168806076049805
Epoch: 26, Steps: 10 | Train Loss: 0.834 Vali Loss: 3.239 Vali Acc: 0.202 Test Loss: 3.239 Test Acc: 0.202
Validation loss decreased (-0.197615 --> -0.202321).  Saving model ...
Epoch: 27 cost time: 0.9707164764404297
Epoch: 27, Steps: 10 | Train Loss: 0.768 Vali Loss: 3.258 Vali Acc: 0.209 Test Loss: 3.258 Test Acc: 0.209
Validation loss decreased (-0.202321 --> -0.209379).  Saving model ...
Epoch: 28 cost time: 1.026348352432251
Epoch: 28, Steps: 10 | Train Loss: 0.678 Vali Loss: 3.273 Vali Acc: 0.218 Test Loss: 3.273 Test Acc: 0.218
Validation loss decreased (-0.209379 --> -0.217614).  Saving model ...
Epoch: 29 cost time: 1.0036773681640625
Epoch: 29, Steps: 10 | Train Loss: 0.615 Vali Loss: 3.301 Vali Acc: 0.224 Test Loss: 3.301 Test Acc: 0.224
Validation loss decreased (-0.217614 --> -0.223496).  Saving model ...
Epoch: 30 cost time: 0.908597469329834
Epoch: 30, Steps: 10 | Train Loss: 0.541 Vali Loss: 3.319 Vali Acc: 0.233 Test Loss: 3.319 Test Acc: 0.233
Validation loss decreased (-0.223496 --> -0.232908).  Saving model ...
Epoch: 31 cost time: 0.9727396965026855
Epoch: 31, Steps: 10 | Train Loss: 0.470 Vali Loss: 3.347 Vali Acc: 0.232 Test Loss: 3.347 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.8952522277832031
Epoch: 32, Steps: 10 | Train Loss: 0.442 Vali Loss: 3.366 Vali Acc: 0.231 Test Loss: 3.366 Test Acc: 0.231
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.0442206859588623
Epoch: 33, Steps: 10 | Train Loss: 0.395 Vali Loss: 3.385 Vali Acc: 0.238 Test Loss: 3.385 Test Acc: 0.238
Validation loss decreased (-0.232908 --> -0.237613).  Saving model ...
Epoch: 34 cost time: 0.8451452255249023
Epoch: 34, Steps: 10 | Train Loss: 0.345 Vali Loss: 3.409 Vali Acc: 0.246 Test Loss: 3.409 Test Acc: 0.246
Validation loss decreased (-0.237613 --> -0.245848).  Saving model ...
Epoch: 35 cost time: 0.792391300201416
Epoch: 35, Steps: 10 | Train Loss: 0.313 Vali Loss: 3.445 Vali Acc: 0.238 Test Loss: 3.445 Test Acc: 0.238
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.8200411796569824
Epoch: 36, Steps: 10 | Train Loss: 0.268 Vali Loss: 3.476 Vali Acc: 0.242 Test Loss: 3.476 Test Acc: 0.242
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.9500060081481934
Epoch: 37, Steps: 10 | Train Loss: 0.244 Vali Loss: 3.519 Vali Acc: 0.239 Test Loss: 3.519 Test Acc: 0.239
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.0737106800079346
Epoch: 38, Steps: 10 | Train Loss: 0.231 Vali Loss: 3.557 Vali Acc: 0.239 Test Loss: 3.557 Test Acc: 0.239
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.9535913467407227
Epoch: 39, Steps: 10 | Train Loss: 0.211 Vali Loss: 3.565 Vali Acc: 0.245 Test Loss: 3.565 Test Acc: 0.245
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.0472586154937744
Epoch: 40, Steps: 10 | Train Loss: 0.180 Vali Loss: 3.580 Vali Acc: 0.238 Test Loss: 3.580 Test Acc: 0.238
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.0357956886291504
Epoch: 41, Steps: 10 | Train Loss: 0.169 Vali Loss: 3.606 Vali Acc: 0.233 Test Loss: 3.606 Test Acc: 0.233
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.1139490604400635
Epoch: 42, Steps: 10 | Train Loss: 0.142 Vali Loss: 3.658 Vali Acc: 0.235 Test Loss: 3.658 Test Acc: 0.235
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 1.1083219051361084
Epoch: 43, Steps: 10 | Train Loss: 0.139 Vali Loss: 3.690 Vali Acc: 0.235 Test Loss: 3.690 Test Acc: 0.235
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 1.0565276145935059
Epoch: 44, Steps: 10 | Train Loss: 0.118 Vali Loss: 3.697 Vali Acc: 0.244 Test Loss: 3.697 Test Acc: 0.244
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.24588235294117647
model parameter : 39770
model size : 0.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps38_str19_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.676649808883667
Epoch: 1, Steps: 10 | Train Loss: 3.302 Vali Loss: 3.281 Vali Acc: 0.044 Test Loss: 3.281 Test Acc: 0.044
Validation loss decreased (inf --> -0.043497).  Saving model ...
Epoch: 2 cost time: 1.094010829925537
Epoch: 2, Steps: 10 | Train Loss: 3.287 Vali Loss: 3.290 Vali Acc: 0.046 Test Loss: 3.290 Test Acc: 0.046
Validation loss decreased (-0.043497 --> -0.045849).  Saving model ...
Epoch: 3 cost time: 0.7589101791381836
Epoch: 3, Steps: 10 | Train Loss: 3.236 Vali Loss: 3.291 Vali Acc: 0.047 Test Loss: 3.291 Test Acc: 0.047
Validation loss decreased (-0.045849 --> -0.047026).  Saving model ...
Epoch: 4 cost time: 0.8069396018981934
Epoch: 4, Steps: 10 | Train Loss: 3.158 Vali Loss: 3.286 Vali Acc: 0.052 Test Loss: 3.286 Test Acc: 0.052
Validation loss decreased (-0.047026 --> -0.051732).  Saving model ...
Epoch: 5 cost time: 0.7745673656463623
Epoch: 5, Steps: 10 | Train Loss: 3.120 Vali Loss: 3.279 Vali Acc: 0.058 Test Loss: 3.279 Test Acc: 0.058
Validation loss decreased (-0.051732 --> -0.057614).  Saving model ...
Epoch: 6 cost time: 1.0212616920471191
Epoch: 6, Steps: 10 | Train Loss: 3.028 Vali Loss: 3.271 Vali Acc: 0.062 Test Loss: 3.271 Test Acc: 0.062
Validation loss decreased (-0.057614 --> -0.062320).  Saving model ...
Epoch: 7 cost time: 0.971865177154541
Epoch: 7, Steps: 10 | Train Loss: 2.925 Vali Loss: 3.263 Vali Acc: 0.068 Test Loss: 3.263 Test Acc: 0.068
Validation loss decreased (-0.062320 --> -0.068203).  Saving model ...
Epoch: 8 cost time: 0.9163732528686523
Epoch: 8, Steps: 10 | Train Loss: 2.814 Vali Loss: 3.255 Vali Acc: 0.080 Test Loss: 3.255 Test Acc: 0.080
Validation loss decreased (-0.068203 --> -0.079967).  Saving model ...
Epoch: 9 cost time: 0.7931172847747803
Epoch: 9, Steps: 10 | Train Loss: 2.753 Vali Loss: 3.249 Vali Acc: 0.093 Test Loss: 3.249 Test Acc: 0.093
Validation loss decreased (-0.079967 --> -0.092909).  Saving model ...
Epoch: 10 cost time: 1.0146472454071045
Epoch: 10, Steps: 10 | Train Loss: 2.650 Vali Loss: 3.241 Vali Acc: 0.095 Test Loss: 3.241 Test Acc: 0.095
Validation loss decreased (-0.092909 --> -0.095262).  Saving model ...
Epoch: 11 cost time: 0.916419267654419
Epoch: 11, Steps: 10 | Train Loss: 2.539 Vali Loss: 3.235 Vali Acc: 0.108 Test Loss: 3.235 Test Acc: 0.108
Validation loss decreased (-0.095262 --> -0.108203).  Saving model ...
Epoch: 12 cost time: 0.92447829246521
Epoch: 12, Steps: 10 | Train Loss: 2.437 Vali Loss: 3.228 Vali Acc: 0.119 Test Loss: 3.228 Test Acc: 0.119
Validation loss decreased (-0.108203 --> -0.118791).  Saving model ...
Epoch: 13 cost time: 0.9976191520690918
Epoch: 13, Steps: 10 | Train Loss: 2.352 Vali Loss: 3.221 Vali Acc: 0.122 Test Loss: 3.221 Test Acc: 0.122
Validation loss decreased (-0.118791 --> -0.122321).  Saving model ...
Epoch: 14 cost time: 0.8146672248840332
Epoch: 14, Steps: 10 | Train Loss: 2.233 Vali Loss: 3.213 Vali Acc: 0.140 Test Loss: 3.213 Test Acc: 0.140
Validation loss decreased (-0.122321 --> -0.139968).  Saving model ...
Epoch: 15 cost time: 0.9334278106689453
Epoch: 15, Steps: 10 | Train Loss: 2.109 Vali Loss: 3.206 Vali Acc: 0.145 Test Loss: 3.206 Test Acc: 0.145
Validation loss decreased (-0.139968 --> -0.144674).  Saving model ...
Epoch: 16 cost time: 0.9935863018035889
Epoch: 16, Steps: 10 | Train Loss: 2.009 Vali Loss: 3.202 Vali Acc: 0.153 Test Loss: 3.202 Test Acc: 0.153
Validation loss decreased (-0.144674 --> -0.152909).  Saving model ...
Epoch: 17 cost time: 0.8555080890655518
Epoch: 17, Steps: 10 | Train Loss: 1.884 Vali Loss: 3.194 Vali Acc: 0.156 Test Loss: 3.194 Test Acc: 0.156
Validation loss decreased (-0.152909 --> -0.156439).  Saving model ...
Epoch: 18 cost time: 0.87650465965271
Epoch: 18, Steps: 10 | Train Loss: 1.797 Vali Loss: 3.188 Vali Acc: 0.165 Test Loss: 3.188 Test Acc: 0.165
Validation loss decreased (-0.156439 --> -0.164674).  Saving model ...
Epoch: 19 cost time: 0.9506227970123291
Epoch: 19, Steps: 10 | Train Loss: 1.686 Vali Loss: 3.186 Vali Acc: 0.171 Test Loss: 3.186 Test Acc: 0.171
Validation loss decreased (-0.164674 --> -0.170556).  Saving model ...
Epoch: 20 cost time: 0.9231455326080322
Epoch: 20, Steps: 10 | Train Loss: 1.565 Vali Loss: 3.185 Vali Acc: 0.168 Test Loss: 3.185 Test Acc: 0.168
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0390629768371582
Epoch: 21, Steps: 10 | Train Loss: 1.465 Vali Loss: 3.186 Vali Acc: 0.172 Test Loss: 3.186 Test Acc: 0.172
Validation loss decreased (-0.170556 --> -0.171733).  Saving model ...
Epoch: 22 cost time: 0.9039933681488037
Epoch: 22, Steps: 10 | Train Loss: 1.348 Vali Loss: 3.187 Vali Acc: 0.182 Test Loss: 3.187 Test Acc: 0.182
Validation loss decreased (-0.171733 --> -0.182321).  Saving model ...
Epoch: 23 cost time: 0.8296427726745605
Epoch: 23, Steps: 10 | Train Loss: 1.247 Vali Loss: 3.189 Vali Acc: 0.191 Test Loss: 3.189 Test Acc: 0.191
Validation loss decreased (-0.182321 --> -0.190556).  Saving model ...
Epoch: 24 cost time: 0.9872417449951172
Epoch: 24, Steps: 10 | Train Loss: 1.170 Vali Loss: 3.191 Vali Acc: 0.198 Test Loss: 3.191 Test Acc: 0.198
Validation loss decreased (-0.190556 --> -0.197615).  Saving model ...
Epoch: 25 cost time: 1.0266587734222412
Epoch: 25, Steps: 10 | Train Loss: 1.048 Vali Loss: 3.191 Vali Acc: 0.211 Test Loss: 3.191 Test Acc: 0.211
Validation loss decreased (-0.197615 --> -0.210556).  Saving model ...
Epoch: 26 cost time: 1.0263540744781494
Epoch: 26, Steps: 10 | Train Loss: 0.963 Vali Loss: 3.201 Vali Acc: 0.214 Test Loss: 3.201 Test Acc: 0.214
Validation loss decreased (-0.210556 --> -0.214086).  Saving model ...
Epoch: 27 cost time: 0.9906413555145264
Epoch: 27, Steps: 10 | Train Loss: 0.923 Vali Loss: 3.212 Vali Acc: 0.226 Test Loss: 3.212 Test Acc: 0.226
Validation loss decreased (-0.214086 --> -0.225850).  Saving model ...
Epoch: 28 cost time: 0.9360904693603516
Epoch: 28, Steps: 10 | Train Loss: 0.815 Vali Loss: 3.220 Vali Acc: 0.226 Test Loss: 3.220 Test Acc: 0.226
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9031314849853516
Epoch: 29, Steps: 10 | Train Loss: 0.723 Vali Loss: 3.235 Vali Acc: 0.231 Test Loss: 3.235 Test Acc: 0.231
Validation loss decreased (-0.225850 --> -0.230556).  Saving model ...
Epoch: 30 cost time: 0.8373708724975586
Epoch: 30, Steps: 10 | Train Loss: 0.675 Vali Loss: 3.253 Vali Acc: 0.232 Test Loss: 3.253 Test Acc: 0.232
Validation loss decreased (-0.230556 --> -0.231732).  Saving model ...
Epoch: 31 cost time: 1.1210310459136963
Epoch: 31, Steps: 10 | Train Loss: 0.609 Vali Loss: 3.270 Vali Acc: 0.239 Test Loss: 3.270 Test Acc: 0.239
Validation loss decreased (-0.231732 --> -0.238791).  Saving model ...
Epoch: 32 cost time: 0.9964940547943115
Epoch: 32, Steps: 10 | Train Loss: 0.538 Vali Loss: 3.292 Vali Acc: 0.239 Test Loss: 3.292 Test Acc: 0.239
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.3574683666229248
Epoch: 33, Steps: 10 | Train Loss: 0.504 Vali Loss: 3.309 Vali Acc: 0.231 Test Loss: 3.309 Test Acc: 0.231
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.9344861507415771
Epoch: 34, Steps: 10 | Train Loss: 0.441 Vali Loss: 3.341 Vali Acc: 0.227 Test Loss: 3.341 Test Acc: 0.227
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.164074182510376
Epoch: 35, Steps: 10 | Train Loss: 0.397 Vali Loss: 3.358 Vali Acc: 0.236 Test Loss: 3.358 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.03489089012146
Epoch: 36, Steps: 10 | Train Loss: 0.380 Vali Loss: 3.380 Vali Acc: 0.246 Test Loss: 3.380 Test Acc: 0.246
Validation loss decreased (-0.238791 --> -0.245849).  Saving model ...
Epoch: 37 cost time: 1.0402679443359375
Epoch: 37, Steps: 10 | Train Loss: 0.345 Vali Loss: 3.408 Vali Acc: 0.249 Test Loss: 3.408 Test Acc: 0.249
Validation loss decreased (-0.245849 --> -0.249378).  Saving model ...
Epoch: 38 cost time: 0.93355393409729
Epoch: 38, Steps: 10 | Train Loss: 0.288 Vali Loss: 3.454 Vali Acc: 0.247 Test Loss: 3.454 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.8900573253631592
Epoch: 39, Steps: 10 | Train Loss: 0.269 Vali Loss: 3.467 Vali Acc: 0.241 Test Loss: 3.467 Test Acc: 0.241
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.9010424613952637
Epoch: 40, Steps: 10 | Train Loss: 0.240 Vali Loss: 3.500 Vali Acc: 0.244 Test Loss: 3.500 Test Acc: 0.244
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.9337062835693359
Epoch: 41, Steps: 10 | Train Loss: 0.235 Vali Loss: 3.529 Vali Acc: 0.246 Test Loss: 3.529 Test Acc: 0.246
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.8897080421447754
Epoch: 42, Steps: 10 | Train Loss: 0.208 Vali Loss: 3.573 Vali Acc: 0.238 Test Loss: 3.573 Test Acc: 0.238
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.034590721130371
Epoch: 43, Steps: 10 | Train Loss: 0.188 Vali Loss: 3.592 Vali Acc: 0.248 Test Loss: 3.592 Test Acc: 0.248
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.0670783519744873
Epoch: 44, Steps: 10 | Train Loss: 0.155 Vali Loss: 3.617 Vali Acc: 0.245 Test Loss: 3.617 Test Acc: 0.245
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.9837865829467773
Epoch: 45, Steps: 10 | Train Loss: 0.159 Vali Loss: 3.629 Vali Acc: 0.246 Test Loss: 3.629 Test Acc: 0.246
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 1.0860846042633057
Epoch: 46, Steps: 10 | Train Loss: 0.147 Vali Loss: 3.644 Vali Acc: 0.245 Test Loss: 3.644 Test Acc: 0.245
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.9249141216278076
Epoch: 47, Steps: 10 | Train Loss: 0.140 Vali Loss: 3.661 Vali Acc: 0.246 Test Loss: 3.661 Test Acc: 0.246
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps38_str19_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.24941176470588236
model parameter : 37498
model size : 0.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.129459857940674
Epoch: 1, Steps: 10 | Train Loss: 3.259 Vali Loss: 3.263 Vali Acc: 0.048 Test Loss: 3.263 Test Acc: 0.048
Validation loss decreased (inf --> -0.048203).  Saving model ...
Epoch: 2 cost time: 1.0763401985168457
Epoch: 2, Steps: 10 | Train Loss: 3.145 Vali Loss: 3.269 Vali Acc: 0.065 Test Loss: 3.269 Test Acc: 0.065
Validation loss decreased (-0.048203 --> -0.064673).  Saving model ...
Epoch: 3 cost time: 1.1428380012512207
Epoch: 3, Steps: 10 | Train Loss: 2.991 Vali Loss: 3.292 Vali Acc: 0.065 Test Loss: 3.292 Test Acc: 0.065
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3404417037963867
Epoch: 4, Steps: 10 | Train Loss: 2.817 Vali Loss: 3.294 Vali Acc: 0.079 Test Loss: 3.294 Test Acc: 0.079
Validation loss decreased (-0.064673 --> -0.078791).  Saving model ...
Epoch: 5 cost time: 1.0776481628417969
Epoch: 5, Steps: 10 | Train Loss: 2.627 Vali Loss: 3.248 Vali Acc: 0.100 Test Loss: 3.248 Test Acc: 0.100
Validation loss decreased (-0.078791 --> -0.099968).  Saving model ...
Epoch: 6 cost time: 1.1784107685089111
Epoch: 6, Steps: 10 | Train Loss: 2.335 Vali Loss: 3.213 Vali Acc: 0.129 Test Loss: 3.213 Test Acc: 0.129
Validation loss decreased (-0.099968 --> -0.129380).  Saving model ...
Epoch: 7 cost time: 1.220717191696167
Epoch: 7, Steps: 10 | Train Loss: 1.979 Vali Loss: 3.181 Vali Acc: 0.154 Test Loss: 3.181 Test Acc: 0.154
Validation loss decreased (-0.129380 --> -0.154086).  Saving model ...
Epoch: 8 cost time: 1.0318028926849365
Epoch: 8, Steps: 10 | Train Loss: 1.565 Vali Loss: 3.193 Vali Acc: 0.188 Test Loss: 3.193 Test Acc: 0.188
Validation loss decreased (-0.154086 --> -0.188203).  Saving model ...
Epoch: 9 cost time: 1.1608595848083496
Epoch: 9, Steps: 10 | Train Loss: 1.167 Vali Loss: 3.271 Vali Acc: 0.195 Test Loss: 3.271 Test Acc: 0.195
Validation loss decreased (-0.188203 --> -0.195261).  Saving model ...
Epoch: 10 cost time: 1.1431663036346436
Epoch: 10, Steps: 10 | Train Loss: 0.793 Vali Loss: 3.365 Vali Acc: 0.234 Test Loss: 3.365 Test Acc: 0.234
Validation loss decreased (-0.195261 --> -0.234084).  Saving model ...
Epoch: 11 cost time: 1.1262717247009277
Epoch: 11, Steps: 10 | Train Loss: 0.506 Vali Loss: 3.521 Vali Acc: 0.232 Test Loss: 3.521 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0510599613189697
Epoch: 12, Steps: 10 | Train Loss: 0.295 Vali Loss: 3.686 Vali Acc: 0.253 Test Loss: 3.686 Test Acc: 0.253
Validation loss decreased (-0.234084 --> -0.252904).  Saving model ...
Epoch: 13 cost time: 1.236341953277588
Epoch: 13, Steps: 10 | Train Loss: 0.173 Vali Loss: 3.908 Vali Acc: 0.253 Test Loss: 3.908 Test Acc: 0.253
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2922782897949219
Epoch: 14, Steps: 10 | Train Loss: 0.086 Vali Loss: 4.088 Vali Acc: 0.247 Test Loss: 4.088 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.356900930404663
Epoch: 15, Steps: 10 | Train Loss: 0.052 Vali Loss: 4.210 Vali Acc: 0.254 Test Loss: 4.210 Test Acc: 0.254
Validation loss decreased (-0.252904 --> -0.254076).  Saving model ...
Epoch: 16 cost time: 1.1658029556274414
Epoch: 16, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.284 Vali Acc: 0.256 Test Loss: 4.284 Test Acc: 0.256
Validation loss decreased (-0.254076 --> -0.256428).  Saving model ...
Epoch: 17 cost time: 1.0283656120300293
Epoch: 17, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.355 Vali Acc: 0.255 Test Loss: 4.355 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.205951452255249
Epoch: 18, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.413 Vali Acc: 0.260 Test Loss: 4.413 Test Acc: 0.260
Validation loss decreased (-0.256428 --> -0.259956).  Saving model ...
Epoch: 19 cost time: 1.071213960647583
Epoch: 19, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.486 Vali Acc: 0.261 Test Loss: 4.486 Test Acc: 0.261
Validation loss decreased (-0.259956 --> -0.261132).  Saving model ...
Epoch: 20 cost time: 1.2930920124053955
Epoch: 20, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.546 Vali Acc: 0.262 Test Loss: 4.546 Test Acc: 0.262
Validation loss decreased (-0.261132 --> -0.262307).  Saving model ...
Epoch: 21 cost time: 1.1585826873779297
Epoch: 21, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.583 Vali Acc: 0.262 Test Loss: 4.583 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.157843828201294
Epoch: 22, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.602 Vali Acc: 0.264 Test Loss: 4.602 Test Acc: 0.264
Validation loss decreased (-0.262307 --> -0.263483).  Saving model ...
Epoch: 23 cost time: 1.1320950984954834
Epoch: 23, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.641 Vali Acc: 0.265 Test Loss: 4.641 Test Acc: 0.265
Validation loss decreased (-0.263483 --> -0.264659).  Saving model ...
Epoch: 24 cost time: 1.1820478439331055
Epoch: 24, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.686 Vali Acc: 0.266 Test Loss: 4.686 Test Acc: 0.266
Validation loss decreased (-0.264659 --> -0.265835).  Saving model ...
Epoch: 25 cost time: 1.0794880390167236
Epoch: 25, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.735 Vali Acc: 0.264 Test Loss: 4.735 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.2054941654205322
Epoch: 26, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.753 Vali Acc: 0.264 Test Loss: 4.753 Test Acc: 0.264
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.2656302452087402
Epoch: 27, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.779 Vali Acc: 0.266 Test Loss: 4.779 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.253432035446167
Epoch: 28, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.813 Vali Acc: 0.268 Test Loss: 4.813 Test Acc: 0.268
Validation loss decreased (-0.265835 --> -0.268187).  Saving model ...
Epoch: 29 cost time: 1.2673084735870361
Epoch: 29, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.843 Vali Acc: 0.264 Test Loss: 4.843 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.4767274856567383
Epoch: 30, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.876 Vali Acc: 0.262 Test Loss: 4.876 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.1896567344665527
Epoch: 31, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.902 Vali Acc: 0.266 Test Loss: 4.902 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.2931854724884033
Epoch: 32, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.923 Vali Acc: 0.266 Test Loss: 4.923 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.367729663848877
Epoch: 33, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.942 Vali Acc: 0.267 Test Loss: 4.942 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.0666396617889404
Epoch: 34, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.962 Vali Acc: 0.267 Test Loss: 4.962 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.1736009120941162
Epoch: 35, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.991 Vali Acc: 0.268 Test Loss: 4.991 Test Acc: 0.268
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.3854451179504395
Epoch: 36, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.018 Vali Acc: 0.271 Test Loss: 5.018 Test Acc: 0.271
Validation loss decreased (-0.268187 --> -0.270538).  Saving model ...
Epoch: 37 cost time: 1.2666165828704834
Epoch: 37, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.041 Vali Acc: 0.271 Test Loss: 5.041 Test Acc: 0.271
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.3519411087036133
Epoch: 38, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.064 Vali Acc: 0.271 Test Loss: 5.064 Test Acc: 0.271
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.2459185123443604
Epoch: 39, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.095 Vali Acc: 0.267 Test Loss: 5.095 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.3485753536224365
Epoch: 40, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.113 Vali Acc: 0.265 Test Loss: 5.113 Test Acc: 0.265
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.223318338394165
Epoch: 41, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.134 Vali Acc: 0.272 Test Loss: 5.134 Test Acc: 0.272
Validation loss decreased (-0.270538 --> -0.271713).  Saving model ...
Epoch: 42 cost time: 1.330786943435669
Epoch: 42, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.146 Vali Acc: 0.272 Test Loss: 5.146 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.1762936115264893
Epoch: 43, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.171 Vali Acc: 0.273 Test Loss: 5.171 Test Acc: 0.273
Validation loss decreased (-0.271713 --> -0.272889).  Saving model ...
Epoch: 44 cost time: 1.162858486175537
Epoch: 44, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.198 Vali Acc: 0.268 Test Loss: 5.198 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.3474080562591553
Epoch: 45, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.219 Vali Acc: 0.269 Test Loss: 5.219 Test Acc: 0.269
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.3187975883483887
Epoch: 46, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.226 Vali Acc: 0.271 Test Loss: 5.226 Test Acc: 0.271
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.3071024417877197
Epoch: 47, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.247 Vali Acc: 0.269 Test Loss: 5.247 Test Acc: 0.269
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.4692771434783936
Epoch: 48, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.264 Vali Acc: 0.269 Test Loss: 5.264 Test Acc: 0.269
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.227041244506836
Epoch: 49, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.283 Vali Acc: 0.269 Test Loss: 5.283 Test Acc: 0.269
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 1.2699527740478516
Epoch: 50, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.299 Vali Acc: 0.271 Test Loss: 5.299 Test Acc: 0.271
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27294117647058824
model parameter : 361786
model size : 1.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.348501205444336
Epoch: 1, Steps: 10 | Train Loss: 3.291 Vali Loss: 3.272 Vali Acc: 0.034 Test Loss: 3.272 Test Acc: 0.034
Validation loss decreased (inf --> -0.034085).  Saving model ...
Epoch: 2 cost time: 1.2850093841552734
Epoch: 2, Steps: 10 | Train Loss: 3.210 Vali Loss: 3.263 Vali Acc: 0.052 Test Loss: 3.263 Test Acc: 0.052
Validation loss decreased (-0.034085 --> -0.051732).  Saving model ...
Epoch: 3 cost time: 1.2322604656219482
Epoch: 3, Steps: 10 | Train Loss: 3.082 Vali Loss: 3.265 Vali Acc: 0.062 Test Loss: 3.265 Test Acc: 0.062
Validation loss decreased (-0.051732 --> -0.062320).  Saving model ...
Epoch: 4 cost time: 1.0992777347564697
Epoch: 4, Steps: 10 | Train Loss: 2.948 Vali Loss: 3.264 Vali Acc: 0.087 Test Loss: 3.264 Test Acc: 0.087
Validation loss decreased (-0.062320 --> -0.087026).  Saving model ...
Epoch: 5 cost time: 1.0670952796936035
Epoch: 5, Steps: 10 | Train Loss: 2.814 Vali Loss: 3.266 Vali Acc: 0.093 Test Loss: 3.266 Test Acc: 0.093
Validation loss decreased (-0.087026 --> -0.092909).  Saving model ...
Epoch: 6 cost time: 1.1614172458648682
Epoch: 6, Steps: 10 | Train Loss: 2.661 Vali Loss: 3.243 Vali Acc: 0.104 Test Loss: 3.243 Test Acc: 0.104
Validation loss decreased (-0.092909 --> -0.103497).  Saving model ...
Epoch: 7 cost time: 1.2066311836242676
Epoch: 7, Steps: 10 | Train Loss: 2.463 Vali Loss: 3.217 Vali Acc: 0.114 Test Loss: 3.217 Test Acc: 0.114
Validation loss decreased (-0.103497 --> -0.114085).  Saving model ...
Epoch: 8 cost time: 1.2655222415924072
Epoch: 8, Steps: 10 | Train Loss: 2.251 Vali Loss: 3.203 Vali Acc: 0.115 Test Loss: 3.203 Test Acc: 0.115
Validation loss decreased (-0.114085 --> -0.115262).  Saving model ...
Epoch: 9 cost time: 1.1201841831207275
Epoch: 9, Steps: 10 | Train Loss: 1.981 Vali Loss: 3.188 Vali Acc: 0.139 Test Loss: 3.188 Test Acc: 0.139
Validation loss decreased (-0.115262 --> -0.138792).  Saving model ...
Epoch: 10 cost time: 1.0001943111419678
Epoch: 10, Steps: 10 | Train Loss: 1.727 Vali Loss: 3.183 Vali Acc: 0.156 Test Loss: 3.183 Test Acc: 0.156
Validation loss decreased (-0.138792 --> -0.156439).  Saving model ...
Epoch: 11 cost time: 1.1511118412017822
Epoch: 11, Steps: 10 | Train Loss: 1.428 Vali Loss: 3.218 Vali Acc: 0.182 Test Loss: 3.218 Test Acc: 0.182
Validation loss decreased (-0.156439 --> -0.182321).  Saving model ...
Epoch: 12 cost time: 1.1965246200561523
Epoch: 12, Steps: 10 | Train Loss: 1.136 Vali Loss: 3.263 Vali Acc: 0.205 Test Loss: 3.263 Test Acc: 0.205
Validation loss decreased (-0.182321 --> -0.204673).  Saving model ...
Epoch: 13 cost time: 1.0791091918945312
Epoch: 13, Steps: 10 | Train Loss: 0.891 Vali Loss: 3.329 Vali Acc: 0.221 Test Loss: 3.329 Test Acc: 0.221
Validation loss decreased (-0.204673 --> -0.221143).  Saving model ...
Epoch: 14 cost time: 1.1265227794647217
Epoch: 14, Steps: 10 | Train Loss: 0.680 Vali Loss: 3.409 Vali Acc: 0.231 Test Loss: 3.409 Test Acc: 0.231
Validation loss decreased (-0.221143 --> -0.230554).  Saving model ...
Epoch: 15 cost time: 1.1503551006317139
Epoch: 15, Steps: 10 | Train Loss: 0.475 Vali Loss: 3.520 Vali Acc: 0.245 Test Loss: 3.520 Test Acc: 0.245
Validation loss decreased (-0.230554 --> -0.244671).  Saving model ...
Epoch: 16 cost time: 1.2384474277496338
Epoch: 16, Steps: 10 | Train Loss: 0.325 Vali Loss: 3.653 Vali Acc: 0.244 Test Loss: 3.653 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.229891300201416
Epoch: 17, Steps: 10 | Train Loss: 0.218 Vali Loss: 3.762 Vali Acc: 0.255 Test Loss: 3.762 Test Acc: 0.255
Validation loss decreased (-0.244671 --> -0.255256).  Saving model ...
Epoch: 18 cost time: 1.196833848953247
Epoch: 18, Steps: 10 | Train Loss: 0.141 Vali Loss: 3.888 Vali Acc: 0.264 Test Loss: 3.888 Test Acc: 0.264
Validation loss decreased (-0.255256 --> -0.263491).  Saving model ...
Epoch: 19 cost time: 1.1888165473937988
Epoch: 19, Steps: 10 | Train Loss: 0.104 Vali Loss: 4.002 Vali Acc: 0.264 Test Loss: 4.002 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0820739269256592
Epoch: 20, Steps: 10 | Train Loss: 0.071 Vali Loss: 4.055 Vali Acc: 0.267 Test Loss: 4.055 Test Acc: 0.267
Validation loss decreased (-0.263491 --> -0.267018).  Saving model ...
Epoch: 21 cost time: 1.2164068222045898
Epoch: 21, Steps: 10 | Train Loss: 0.055 Vali Loss: 4.156 Vali Acc: 0.271 Test Loss: 4.156 Test Acc: 0.271
Validation loss decreased (-0.267018 --> -0.270547).  Saving model ...
Epoch: 22 cost time: 1.2153830528259277
Epoch: 22, Steps: 10 | Train Loss: 0.048 Vali Loss: 4.229 Vali Acc: 0.269 Test Loss: 4.229 Test Acc: 0.269
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2439563274383545
Epoch: 23, Steps: 10 | Train Loss: 0.037 Vali Loss: 4.293 Vali Acc: 0.266 Test Loss: 4.293 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.1232001781463623
Epoch: 24, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.339 Vali Acc: 0.261 Test Loss: 4.339 Test Acc: 0.261
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.1907973289489746
Epoch: 25, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.384 Vali Acc: 0.267 Test Loss: 4.384 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.2161026000976562
Epoch: 26, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.430 Vali Acc: 0.269 Test Loss: 4.430 Test Acc: 0.269
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.301886796951294
Epoch: 27, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.483 Vali Acc: 0.271 Test Loss: 4.483 Test Acc: 0.271
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.2141098976135254
Epoch: 28, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.522 Vali Acc: 0.268 Test Loss: 4.522 Test Acc: 0.268
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.084517478942871
Epoch: 29, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.564 Vali Acc: 0.267 Test Loss: 4.564 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.1659049987792969
Epoch: 30, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.604 Vali Acc: 0.271 Test Loss: 4.604 Test Acc: 0.271
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.313492774963379
Epoch: 31, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.642 Vali Acc: 0.266 Test Loss: 4.642 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27058823529411763
model parameter : 272058
model size : 1.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps12_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.0544114112854004
Epoch: 1, Steps: 10 | Train Loss: 3.289 Vali Loss: 3.271 Vali Acc: 0.045 Test Loss: 3.271 Test Acc: 0.045
Validation loss decreased (inf --> -0.044673).  Saving model ...
Epoch: 2 cost time: 1.2201604843139648
Epoch: 2, Steps: 10 | Train Loss: 3.229 Vali Loss: 3.265 Vali Acc: 0.041 Test Loss: 3.265 Test Acc: 0.041
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1415395736694336
Epoch: 3, Steps: 10 | Train Loss: 3.162 Vali Loss: 3.262 Vali Acc: 0.056 Test Loss: 3.262 Test Acc: 0.056
Validation loss decreased (-0.044673 --> -0.056438).  Saving model ...
Epoch: 4 cost time: 1.0336847305297852
Epoch: 4, Steps: 10 | Train Loss: 3.035 Vali Loss: 3.264 Vali Acc: 0.066 Test Loss: 3.264 Test Acc: 0.066
Validation loss decreased (-0.056438 --> -0.065850).  Saving model ...
Epoch: 5 cost time: 1.09222412109375
Epoch: 5, Steps: 10 | Train Loss: 2.949 Vali Loss: 3.268 Vali Acc: 0.071 Test Loss: 3.268 Test Acc: 0.071
Validation loss decreased (-0.065850 --> -0.070556).  Saving model ...
Epoch: 6 cost time: 1.0582256317138672
Epoch: 6, Steps: 10 | Train Loss: 2.798 Vali Loss: 3.264 Vali Acc: 0.081 Test Loss: 3.264 Test Acc: 0.081
Validation loss decreased (-0.070556 --> -0.081144).  Saving model ...
Epoch: 7 cost time: 1.199303388595581
Epoch: 7, Steps: 10 | Train Loss: 2.687 Vali Loss: 3.251 Vali Acc: 0.093 Test Loss: 3.251 Test Acc: 0.093
Validation loss decreased (-0.081144 --> -0.092909).  Saving model ...
Epoch: 8 cost time: 1.1462457180023193
Epoch: 8, Steps: 10 | Train Loss: 2.551 Vali Loss: 3.235 Vali Acc: 0.113 Test Loss: 3.235 Test Acc: 0.113
Validation loss decreased (-0.092909 --> -0.112909).  Saving model ...
Epoch: 9 cost time: 1.2117176055908203
Epoch: 9, Steps: 10 | Train Loss: 2.341 Vali Loss: 3.215 Vali Acc: 0.125 Test Loss: 3.215 Test Acc: 0.125
Validation loss decreased (-0.112909 --> -0.124674).  Saving model ...
Epoch: 10 cost time: 1.2010765075683594
Epoch: 10, Steps: 10 | Train Loss: 2.132 Vali Loss: 3.199 Vali Acc: 0.142 Test Loss: 3.199 Test Acc: 0.142
Validation loss decreased (-0.124674 --> -0.142321).  Saving model ...
Epoch: 11 cost time: 1.1476976871490479
Epoch: 11, Steps: 10 | Train Loss: 1.923 Vali Loss: 3.193 Vali Acc: 0.149 Test Loss: 3.193 Test Acc: 0.149
Validation loss decreased (-0.142321 --> -0.149380).  Saving model ...
Epoch: 12 cost time: 1.2149159908294678
Epoch: 12, Steps: 10 | Train Loss: 1.655 Vali Loss: 3.190 Vali Acc: 0.165 Test Loss: 3.190 Test Acc: 0.165
Validation loss decreased (-0.149380 --> -0.164674).  Saving model ...
Epoch: 13 cost time: 1.2935242652893066
Epoch: 13, Steps: 10 | Train Loss: 1.459 Vali Loss: 3.201 Vali Acc: 0.180 Test Loss: 3.201 Test Acc: 0.180
Validation loss decreased (-0.164674 --> -0.179968).  Saving model ...
Epoch: 14 cost time: 1.4163522720336914
Epoch: 14, Steps: 10 | Train Loss: 1.183 Vali Loss: 3.235 Vali Acc: 0.192 Test Loss: 3.235 Test Acc: 0.192
Validation loss decreased (-0.179968 --> -0.191732).  Saving model ...
Epoch: 15 cost time: 1.3332173824310303
Epoch: 15, Steps: 10 | Train Loss: 0.984 Vali Loss: 3.284 Vali Acc: 0.206 Test Loss: 3.284 Test Acc: 0.206
Validation loss decreased (-0.191732 --> -0.205850).  Saving model ...
Epoch: 16 cost time: 1.4806327819824219
Epoch: 16, Steps: 10 | Train Loss: 0.821 Vali Loss: 3.339 Vali Acc: 0.222 Test Loss: 3.339 Test Acc: 0.222
Validation loss decreased (-0.205850 --> -0.222320).  Saving model ...
Epoch: 17 cost time: 1.2646069526672363
Epoch: 17, Steps: 10 | Train Loss: 0.615 Vali Loss: 3.393 Vali Acc: 0.239 Test Loss: 3.393 Test Acc: 0.239
Validation loss decreased (-0.222320 --> -0.238790).  Saving model ...
Epoch: 18 cost time: 1.245638370513916
Epoch: 18, Steps: 10 | Train Loss: 0.458 Vali Loss: 3.483 Vali Acc: 0.241 Test Loss: 3.483 Test Acc: 0.241
Validation loss decreased (-0.238790 --> -0.241142).  Saving model ...
Epoch: 19 cost time: 1.306894302368164
Epoch: 19, Steps: 10 | Train Loss: 0.342 Vali Loss: 3.552 Vali Acc: 0.245 Test Loss: 3.552 Test Acc: 0.245
Validation loss decreased (-0.241142 --> -0.244670).  Saving model ...
Epoch: 20 cost time: 1.3199853897094727
Epoch: 20, Steps: 10 | Train Loss: 0.253 Vali Loss: 3.646 Vali Acc: 0.242 Test Loss: 3.646 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2543175220489502
Epoch: 21, Steps: 10 | Train Loss: 0.194 Vali Loss: 3.728 Vali Acc: 0.244 Test Loss: 3.728 Test Acc: 0.244
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.3241751194000244
Epoch: 22, Steps: 10 | Train Loss: 0.143 Vali Loss: 3.824 Vali Acc: 0.245 Test Loss: 3.824 Test Acc: 0.245
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.311619520187378
Epoch: 23, Steps: 10 | Train Loss: 0.106 Vali Loss: 3.879 Vali Acc: 0.246 Test Loss: 3.879 Test Acc: 0.246
Validation loss decreased (-0.244670 --> -0.245844).  Saving model ...
Epoch: 24 cost time: 1.3234593868255615
Epoch: 24, Steps: 10 | Train Loss: 0.084 Vali Loss: 3.937 Vali Acc: 0.246 Test Loss: 3.937 Test Acc: 0.246
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.3536489009857178
Epoch: 25, Steps: 10 | Train Loss: 0.064 Vali Loss: 3.992 Vali Acc: 0.247 Test Loss: 3.992 Test Acc: 0.247
Validation loss decreased (-0.245844 --> -0.247019).  Saving model ...
Epoch: 26 cost time: 1.2452449798583984
Epoch: 26, Steps: 10 | Train Loss: 0.060 Vali Loss: 4.034 Vali Acc: 0.249 Test Loss: 4.034 Test Acc: 0.249
Validation loss decreased (-0.247019 --> -0.249371).  Saving model ...
Epoch: 27 cost time: 1.3785068988800049
Epoch: 27, Steps: 10 | Train Loss: 0.047 Vali Loss: 4.092 Vali Acc: 0.246 Test Loss: 4.092 Test Acc: 0.246
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.390944242477417
Epoch: 28, Steps: 10 | Train Loss: 0.043 Vali Loss: 4.148 Vali Acc: 0.249 Test Loss: 4.148 Test Acc: 0.249
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.376408576965332
Epoch: 29, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.188 Vali Acc: 0.245 Test Loss: 4.188 Test Acc: 0.245
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.1627886295318604
Epoch: 30, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.235 Vali Acc: 0.248 Test Loss: 4.235 Test Acc: 0.248
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.3919963836669922
Epoch: 31, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.277 Vali Acc: 0.251 Test Loss: 4.277 Test Acc: 0.251
Validation loss decreased (-0.249371 --> -0.250545).  Saving model ...
Epoch: 32 cost time: 1.2536039352416992
Epoch: 32, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.313 Vali Acc: 0.249 Test Loss: 4.313 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.4020404815673828
Epoch: 33, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.334 Vali Acc: 0.253 Test Loss: 4.334 Test Acc: 0.253
Validation loss decreased (-0.250545 --> -0.252898).  Saving model ...
Epoch: 34 cost time: 1.4115641117095947
Epoch: 34, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.363 Vali Acc: 0.255 Test Loss: 4.363 Test Acc: 0.255
Validation loss decreased (-0.252898 --> -0.255250).  Saving model ...
Epoch: 35 cost time: 1.3452582359313965
Epoch: 35, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.395 Vali Acc: 0.249 Test Loss: 4.395 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.2411634922027588
Epoch: 36, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.432 Vali Acc: 0.253 Test Loss: 4.432 Test Acc: 0.253
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.1880967617034912
Epoch: 37, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.474 Vali Acc: 0.253 Test Loss: 4.474 Test Acc: 0.253
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.199026107788086
Epoch: 38, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.491 Vali Acc: 0.253 Test Loss: 4.491 Test Acc: 0.253
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.261899471282959
Epoch: 39, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.501 Vali Acc: 0.256 Test Loss: 4.501 Test Acc: 0.256
Validation loss decreased (-0.255250 --> -0.256426).  Saving model ...
Epoch: 40 cost time: 1.4424612522125244
Epoch: 40, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.529 Vali Acc: 0.253 Test Loss: 4.529 Test Acc: 0.253
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.2740716934204102
Epoch: 41, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.553 Vali Acc: 0.255 Test Loss: 4.553 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.3566665649414062
Epoch: 42, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.575 Vali Acc: 0.254 Test Loss: 4.575 Test Acc: 0.254
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.0803918838500977
Epoch: 43, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.601 Vali Acc: 0.252 Test Loss: 4.601 Test Acc: 0.252
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.1954269409179688
Epoch: 44, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.626 Vali Acc: 0.252 Test Loss: 4.626 Test Acc: 0.252
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.1868255138397217
Epoch: 45, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.634 Vali Acc: 0.252 Test Loss: 4.634 Test Acc: 0.252
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.1998772621154785
Epoch: 46, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.669 Vali Acc: 0.252 Test Loss: 4.669 Test Acc: 0.252
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.2778477668762207
Epoch: 47, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.683 Vali Acc: 0.254 Test Loss: 4.683 Test Acc: 0.254
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 1.247178554534912
Epoch: 48, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.700 Vali Acc: 0.256 Test Loss: 4.700 Test Acc: 0.256
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 0.9997115135192871
Epoch: 49, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.710 Vali Acc: 0.258 Test Loss: 4.710 Test Acc: 0.258
Validation loss decreased (-0.256426 --> -0.257600).  Saving model ...
Epoch: 50 cost time: 1.1635196208953857
Epoch: 50, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.738 Vali Acc: 0.261 Test Loss: 4.738 Test Acc: 0.261
Validation loss decreased (-0.257600 --> -0.261129).  Saving model ...
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps12_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2611764705882353
model parameter : 242234
model size : 0.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.0942893028259277
Epoch: 1, Steps: 10 | Train Loss: 3.307 Vali Loss: 3.269 Vali Acc: 0.040 Test Loss: 3.269 Test Acc: 0.040
Validation loss decreased (inf --> -0.039967).  Saving model ...
Epoch: 2 cost time: 1.1559028625488281
Epoch: 2, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.261 Vali Acc: 0.046 Test Loss: 3.261 Test Acc: 0.046
Validation loss decreased (-0.039967 --> -0.045850).  Saving model ...
Epoch: 3 cost time: 1.1478891372680664
Epoch: 3, Steps: 10 | Train Loss: 3.187 Vali Loss: 3.256 Vali Acc: 0.052 Test Loss: 3.256 Test Acc: 0.052
Validation loss decreased (-0.045850 --> -0.051732).  Saving model ...
Epoch: 4 cost time: 1.116518497467041
Epoch: 4, Steps: 10 | Train Loss: 3.107 Vali Loss: 3.256 Vali Acc: 0.073 Test Loss: 3.256 Test Acc: 0.073
Validation loss decreased (-0.051732 --> -0.072909).  Saving model ...
Epoch: 5 cost time: 1.2513225078582764
Epoch: 5, Steps: 10 | Train Loss: 2.999 Vali Loss: 3.259 Vali Acc: 0.079 Test Loss: 3.259 Test Acc: 0.079
Validation loss decreased (-0.072909 --> -0.078791).  Saving model ...
Epoch: 6 cost time: 1.2296411991119385
Epoch: 6, Steps: 10 | Train Loss: 2.913 Vali Loss: 3.256 Vali Acc: 0.091 Test Loss: 3.256 Test Acc: 0.091
Validation loss decreased (-0.078791 --> -0.090556).  Saving model ...
Epoch: 7 cost time: 1.0954864025115967
Epoch: 7, Steps: 10 | Train Loss: 2.787 Vali Loss: 3.252 Vali Acc: 0.096 Test Loss: 3.252 Test Acc: 0.096
Validation loss decreased (-0.090556 --> -0.096438).  Saving model ...
Epoch: 8 cost time: 1.1660792827606201
Epoch: 8, Steps: 10 | Train Loss: 2.681 Vali Loss: 3.241 Vali Acc: 0.106 Test Loss: 3.241 Test Acc: 0.106
Validation loss decreased (-0.096438 --> -0.105850).  Saving model ...
Epoch: 9 cost time: 1.2599067687988281
Epoch: 9, Steps: 10 | Train Loss: 2.536 Vali Loss: 3.229 Vali Acc: 0.115 Test Loss: 3.229 Test Acc: 0.115
Validation loss decreased (-0.105850 --> -0.115262).  Saving model ...
Epoch: 10 cost time: 1.259659767150879
Epoch: 10, Steps: 10 | Train Loss: 2.380 Vali Loss: 3.216 Vali Acc: 0.120 Test Loss: 3.216 Test Acc: 0.120
Validation loss decreased (-0.115262 --> -0.119968).  Saving model ...
Epoch: 11 cost time: 1.170595407485962
Epoch: 11, Steps: 10 | Train Loss: 2.224 Vali Loss: 3.202 Vali Acc: 0.128 Test Loss: 3.202 Test Acc: 0.128
Validation loss decreased (-0.119968 --> -0.128203).  Saving model ...
Epoch: 12 cost time: 1.1846003532409668
Epoch: 12, Steps: 10 | Train Loss: 2.035 Vali Loss: 3.199 Vali Acc: 0.139 Test Loss: 3.199 Test Acc: 0.139
Validation loss decreased (-0.128203 --> -0.138792).  Saving model ...
Epoch: 13 cost time: 1.2111542224884033
Epoch: 13, Steps: 10 | Train Loss: 1.832 Vali Loss: 3.188 Vali Acc: 0.156 Test Loss: 3.188 Test Acc: 0.156
Validation loss decreased (-0.138792 --> -0.156439).  Saving model ...
Epoch: 14 cost time: 1.0690171718597412
Epoch: 14, Steps: 10 | Train Loss: 1.672 Vali Loss: 3.198 Vali Acc: 0.154 Test Loss: 3.198 Test Acc: 0.154
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.212712287902832
Epoch: 15, Steps: 10 | Train Loss: 1.416 Vali Loss: 3.203 Vali Acc: 0.164 Test Loss: 3.203 Test Acc: 0.164
Validation loss decreased (-0.156439 --> -0.163497).  Saving model ...
Epoch: 16 cost time: 1.2052645683288574
Epoch: 16, Steps: 10 | Train Loss: 1.205 Vali Loss: 3.220 Vali Acc: 0.172 Test Loss: 3.220 Test Acc: 0.172
Validation loss decreased (-0.163497 --> -0.171733).  Saving model ...
Epoch: 17 cost time: 1.1642401218414307
Epoch: 17, Steps: 10 | Train Loss: 1.039 Vali Loss: 3.254 Vali Acc: 0.181 Test Loss: 3.254 Test Acc: 0.181
Validation loss decreased (-0.171733 --> -0.181144).  Saving model ...
Epoch: 18 cost time: 1.1255888938903809
Epoch: 18, Steps: 10 | Train Loss: 0.833 Vali Loss: 3.295 Vali Acc: 0.193 Test Loss: 3.295 Test Acc: 0.193
Validation loss decreased (-0.181144 --> -0.192908).  Saving model ...
Epoch: 19 cost time: 1.0299527645111084
Epoch: 19, Steps: 10 | Train Loss: 0.667 Vali Loss: 3.319 Vali Acc: 0.202 Test Loss: 3.319 Test Acc: 0.202
Validation loss decreased (-0.192908 --> -0.202320).  Saving model ...
Epoch: 20 cost time: 1.274221658706665
Epoch: 20, Steps: 10 | Train Loss: 0.538 Vali Loss: 3.382 Vali Acc: 0.213 Test Loss: 3.382 Test Acc: 0.213
Validation loss decreased (-0.202320 --> -0.212907).  Saving model ...
Epoch: 21 cost time: 1.2206852436065674
Epoch: 21, Steps: 10 | Train Loss: 0.412 Vali Loss: 3.442 Vali Acc: 0.221 Test Loss: 3.442 Test Acc: 0.221
Validation loss decreased (-0.212907 --> -0.221142).  Saving model ...
Epoch: 22 cost time: 1.0798091888427734
Epoch: 22, Steps: 10 | Train Loss: 0.315 Vali Loss: 3.524 Vali Acc: 0.232 Test Loss: 3.524 Test Acc: 0.232
Validation loss decreased (-0.221142 --> -0.231729).  Saving model ...
Epoch: 23 cost time: 1.1047122478485107
Epoch: 23, Steps: 10 | Train Loss: 0.238 Vali Loss: 3.593 Vali Acc: 0.229 Test Loss: 3.593 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.23046875
Epoch: 24, Steps: 10 | Train Loss: 0.182 Vali Loss: 3.647 Vali Acc: 0.235 Test Loss: 3.647 Test Acc: 0.235
Validation loss decreased (-0.231729 --> -0.235258).  Saving model ...
Epoch: 25 cost time: 1.113203525543213
Epoch: 25, Steps: 10 | Train Loss: 0.159 Vali Loss: 3.699 Vali Acc: 0.241 Test Loss: 3.699 Test Acc: 0.241
Validation loss decreased (-0.235258 --> -0.241139).  Saving model ...
Epoch: 26 cost time: 1.149890661239624
Epoch: 26, Steps: 10 | Train Loss: 0.122 Vali Loss: 3.755 Vali Acc: 0.246 Test Loss: 3.755 Test Acc: 0.246
Validation loss decreased (-0.241139 --> -0.245845).  Saving model ...
Epoch: 27 cost time: 1.131894588470459
Epoch: 27, Steps: 10 | Train Loss: 0.105 Vali Loss: 3.820 Vali Acc: 0.241 Test Loss: 3.820 Test Acc: 0.241
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0840098857879639
Epoch: 28, Steps: 10 | Train Loss: 0.081 Vali Loss: 3.866 Vali Acc: 0.244 Test Loss: 3.866 Test Acc: 0.244
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.06788969039917
Epoch: 29, Steps: 10 | Train Loss: 0.072 Vali Loss: 3.903 Vali Acc: 0.242 Test Loss: 3.903 Test Acc: 0.242
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.0793497562408447
Epoch: 30, Steps: 10 | Train Loss: 0.062 Vali Loss: 3.950 Vali Acc: 0.245 Test Loss: 3.950 Test Acc: 0.245
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.1236872673034668
Epoch: 31, Steps: 10 | Train Loss: 0.053 Vali Loss: 3.991 Vali Acc: 0.242 Test Loss: 3.991 Test Acc: 0.242
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.1509861946105957
Epoch: 32, Steps: 10 | Train Loss: 0.044 Vali Loss: 4.019 Vali Acc: 0.245 Test Loss: 4.019 Test Acc: 0.245
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.1245801448822021
Epoch: 33, Steps: 10 | Train Loss: 0.039 Vali Loss: 4.059 Vali Acc: 0.242 Test Loss: 4.059 Test Acc: 0.242
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.10994291305542
Epoch: 34, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.082 Vali Acc: 0.249 Test Loss: 4.082 Test Acc: 0.249
Validation loss decreased (-0.245845 --> -0.249371).  Saving model ...
Epoch: 35 cost time: 1.1267659664154053
Epoch: 35, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.124 Vali Acc: 0.246 Test Loss: 4.124 Test Acc: 0.246
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.060302972793579
Epoch: 36, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.151 Vali Acc: 0.249 Test Loss: 4.151 Test Acc: 0.249
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.2081797122955322
Epoch: 37, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.182 Vali Acc: 0.249 Test Loss: 4.182 Test Acc: 0.249
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.1159393787384033
Epoch: 38, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.211 Vali Acc: 0.246 Test Loss: 4.211 Test Acc: 0.246
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.1020302772521973
Epoch: 39, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.248 Vali Acc: 0.246 Test Loss: 4.248 Test Acc: 0.246
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.0547125339508057
Epoch: 40, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.269 Vali Acc: 0.245 Test Loss: 4.269 Test Acc: 0.245
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.9533953666687012
Epoch: 41, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.294 Vali Acc: 0.248 Test Loss: 4.294 Test Acc: 0.248
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.1083595752716064
Epoch: 42, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.307 Vali Acc: 0.247 Test Loss: 4.307 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 1.0167934894561768
Epoch: 43, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.337 Vali Acc: 0.247 Test Loss: 4.337 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 1.0455398559570312
Epoch: 44, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.363 Vali Acc: 0.249 Test Loss: 4.363 Test Acc: 0.249
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.24941176470588236
model parameter : 222394
model size : 0.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps23_str12_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.990201473236084
Epoch: 1, Steps: 10 | Train Loss: 3.352 Vali Loss: 3.273 Vali Acc: 0.052 Test Loss: 3.273 Test Acc: 0.052
Validation loss decreased (inf --> -0.051732).  Saving model ...
Epoch: 2 cost time: 1.0041651725769043
Epoch: 2, Steps: 10 | Train Loss: 3.308 Vali Loss: 3.268 Vali Acc: 0.047 Test Loss: 3.268 Test Acc: 0.047
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1506967544555664
Epoch: 3, Steps: 10 | Train Loss: 3.227 Vali Loss: 3.260 Vali Acc: 0.055 Test Loss: 3.260 Test Acc: 0.055
Validation loss decreased (-0.051732 --> -0.055262).  Saving model ...
Epoch: 4 cost time: 0.9156322479248047
Epoch: 4, Steps: 10 | Train Loss: 3.155 Vali Loss: 3.252 Vali Acc: 0.055 Test Loss: 3.252 Test Acc: 0.055
Validation loss decreased (-0.055262 --> -0.055262).  Saving model ...
Epoch: 5 cost time: 1.1141977310180664
Epoch: 5, Steps: 10 | Train Loss: 3.094 Vali Loss: 3.245 Vali Acc: 0.067 Test Loss: 3.245 Test Acc: 0.067
Validation loss decreased (-0.055262 --> -0.067026).  Saving model ...
Epoch: 6 cost time: 0.9833149909973145
Epoch: 6, Steps: 10 | Train Loss: 3.011 Vali Loss: 3.238 Vali Acc: 0.072 Test Loss: 3.238 Test Acc: 0.072
Validation loss decreased (-0.067026 --> -0.071732).  Saving model ...
Epoch: 7 cost time: 1.0851759910583496
Epoch: 7, Steps: 10 | Train Loss: 2.899 Vali Loss: 3.234 Vali Acc: 0.075 Test Loss: 3.234 Test Acc: 0.075
Validation loss decreased (-0.071732 --> -0.075262).  Saving model ...
Epoch: 8 cost time: 1.0051052570343018
Epoch: 8, Steps: 10 | Train Loss: 2.805 Vali Loss: 3.231 Vali Acc: 0.082 Test Loss: 3.231 Test Acc: 0.082
Validation loss decreased (-0.075262 --> -0.082321).  Saving model ...
Epoch: 9 cost time: 1.0534944534301758
Epoch: 9, Steps: 10 | Train Loss: 2.717 Vali Loss: 3.229 Vali Acc: 0.086 Test Loss: 3.229 Test Acc: 0.086
Validation loss decreased (-0.082321 --> -0.085850).  Saving model ...
Epoch: 10 cost time: 1.1172053813934326
Epoch: 10, Steps: 10 | Train Loss: 2.619 Vali Loss: 3.224 Vali Acc: 0.092 Test Loss: 3.224 Test Acc: 0.092
Validation loss decreased (-0.085850 --> -0.091732).  Saving model ...
Epoch: 11 cost time: 1.0569775104522705
Epoch: 11, Steps: 10 | Train Loss: 2.480 Vali Loss: 3.214 Vali Acc: 0.102 Test Loss: 3.214 Test Acc: 0.102
Validation loss decreased (-0.091732 --> -0.102321).  Saving model ...
Epoch: 12 cost time: 1.0776362419128418
Epoch: 12, Steps: 10 | Train Loss: 2.366 Vali Loss: 3.205 Vali Acc: 0.115 Test Loss: 3.205 Test Acc: 0.115
Validation loss decreased (-0.102321 --> -0.115262).  Saving model ...
Epoch: 13 cost time: 1.1091976165771484
Epoch: 13, Steps: 10 | Train Loss: 2.219 Vali Loss: 3.195 Vali Acc: 0.120 Test Loss: 3.195 Test Acc: 0.120
Validation loss decreased (-0.115262 --> -0.119968).  Saving model ...
Epoch: 14 cost time: 1.0036039352416992
Epoch: 14, Steps: 10 | Train Loss: 2.057 Vali Loss: 3.191 Vali Acc: 0.127 Test Loss: 3.191 Test Acc: 0.127
Validation loss decreased (-0.119968 --> -0.127027).  Saving model ...
Epoch: 15 cost time: 1.051708698272705
Epoch: 15, Steps: 10 | Train Loss: 1.911 Vali Loss: 3.192 Vali Acc: 0.146 Test Loss: 3.192 Test Acc: 0.146
Validation loss decreased (-0.127027 --> -0.145850).  Saving model ...
Epoch: 16 cost time: 1.05161714553833
Epoch: 16, Steps: 10 | Train Loss: 1.770 Vali Loss: 3.200 Vali Acc: 0.156 Test Loss: 3.200 Test Acc: 0.156
Validation loss decreased (-0.145850 --> -0.156439).  Saving model ...
Epoch: 17 cost time: 1.1261208057403564
Epoch: 17, Steps: 10 | Train Loss: 1.568 Vali Loss: 3.206 Vali Acc: 0.161 Test Loss: 3.206 Test Acc: 0.161
Validation loss decreased (-0.156439 --> -0.161144).  Saving model ...
Epoch: 18 cost time: 0.9079556465148926
Epoch: 18, Steps: 10 | Train Loss: 1.416 Vali Loss: 3.226 Vali Acc: 0.160 Test Loss: 3.226 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.089432716369629
Epoch: 19, Steps: 10 | Train Loss: 1.255 Vali Loss: 3.262 Vali Acc: 0.174 Test Loss: 3.262 Test Acc: 0.174
Validation loss decreased (-0.161144 --> -0.174085).  Saving model ...
Epoch: 20 cost time: 1.012108325958252
Epoch: 20, Steps: 10 | Train Loss: 1.102 Vali Loss: 3.279 Vali Acc: 0.182 Test Loss: 3.279 Test Acc: 0.182
Validation loss decreased (-0.174085 --> -0.182320).  Saving model ...
Epoch: 21 cost time: 1.1039319038391113
Epoch: 21, Steps: 10 | Train Loss: 0.941 Vali Loss: 3.319 Vali Acc: 0.186 Test Loss: 3.319 Test Acc: 0.186
Validation loss decreased (-0.182320 --> -0.185849).  Saving model ...
Epoch: 22 cost time: 1.1960947513580322
Epoch: 22, Steps: 10 | Train Loss: 0.827 Vali Loss: 3.366 Vali Acc: 0.185 Test Loss: 3.366 Test Acc: 0.185
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0567171573638916
Epoch: 23, Steps: 10 | Train Loss: 0.674 Vali Loss: 3.416 Vali Acc: 0.192 Test Loss: 3.416 Test Acc: 0.192
Validation loss decreased (-0.185849 --> -0.191731).  Saving model ...
Epoch: 24 cost time: 1.1277873516082764
Epoch: 24, Steps: 10 | Train Loss: 0.564 Vali Loss: 3.467 Vali Acc: 0.196 Test Loss: 3.467 Test Acc: 0.196
Validation loss decreased (-0.191731 --> -0.196436).  Saving model ...
Epoch: 25 cost time: 1.1397569179534912
Epoch: 25, Steps: 10 | Train Loss: 0.478 Vali Loss: 3.518 Vali Acc: 0.202 Test Loss: 3.518 Test Acc: 0.202
Validation loss decreased (-0.196436 --> -0.202318).  Saving model ...
Epoch: 26 cost time: 1.1280102729797363
Epoch: 26, Steps: 10 | Train Loss: 0.396 Vali Loss: 3.574 Vali Acc: 0.209 Test Loss: 3.574 Test Acc: 0.209
Validation loss decreased (-0.202318 --> -0.209376).  Saving model ...
Epoch: 27 cost time: 1.0861525535583496
Epoch: 27, Steps: 10 | Train Loss: 0.313 Vali Loss: 3.660 Vali Acc: 0.212 Test Loss: 3.660 Test Acc: 0.212
Validation loss decreased (-0.209376 --> -0.211728).  Saving model ...
Epoch: 28 cost time: 1.022322416305542
Epoch: 28, Steps: 10 | Train Loss: 0.291 Vali Loss: 3.715 Vali Acc: 0.221 Test Loss: 3.715 Test Acc: 0.221
Validation loss decreased (-0.211728 --> -0.221139).  Saving model ...
Epoch: 29 cost time: 1.042306661605835
Epoch: 29, Steps: 10 | Train Loss: 0.236 Vali Loss: 3.765 Vali Acc: 0.229 Test Loss: 3.765 Test Acc: 0.229
Validation loss decreased (-0.221139 --> -0.229374).  Saving model ...
Epoch: 30 cost time: 1.056593418121338
Epoch: 30, Steps: 10 | Train Loss: 0.201 Vali Loss: 3.823 Vali Acc: 0.224 Test Loss: 3.823 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.1924347877502441
Epoch: 31, Steps: 10 | Train Loss: 0.166 Vali Loss: 3.878 Vali Acc: 0.225 Test Loss: 3.878 Test Acc: 0.225
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.0706956386566162
Epoch: 32, Steps: 10 | Train Loss: 0.134 Vali Loss: 3.930 Vali Acc: 0.229 Test Loss: 3.930 Test Acc: 0.229
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.090470314025879
Epoch: 33, Steps: 10 | Train Loss: 0.114 Vali Loss: 3.980 Vali Acc: 0.232 Test Loss: 3.980 Test Acc: 0.232
Validation loss decreased (-0.229374 --> -0.231725).  Saving model ...
Epoch: 34 cost time: 1.2436082363128662
Epoch: 34, Steps: 10 | Train Loss: 0.094 Vali Loss: 4.026 Vali Acc: 0.233 Test Loss: 4.026 Test Acc: 0.233
Validation loss decreased (-0.231725 --> -0.232901).  Saving model ...
Epoch: 35 cost time: 1.0744311809539795
Epoch: 35, Steps: 10 | Train Loss: 0.091 Vali Loss: 4.055 Vali Acc: 0.239 Test Loss: 4.055 Test Acc: 0.239
Validation loss decreased (-0.232901 --> -0.238783).  Saving model ...
Epoch: 36 cost time: 1.1274020671844482
Epoch: 36, Steps: 10 | Train Loss: 0.083 Vali Loss: 4.102 Vali Acc: 0.236 Test Loss: 4.102 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.2481498718261719
Epoch: 37, Steps: 10 | Train Loss: 0.074 Vali Loss: 4.124 Vali Acc: 0.239 Test Loss: 4.124 Test Acc: 0.239
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.3017499446868896
Epoch: 38, Steps: 10 | Train Loss: 0.063 Vali Loss: 4.162 Vali Acc: 0.245 Test Loss: 4.162 Test Acc: 0.245
Validation loss decreased (-0.238783 --> -0.244664).  Saving model ...
Epoch: 39 cost time: 1.2475919723510742
Epoch: 39, Steps: 10 | Train Loss: 0.056 Vali Loss: 4.199 Vali Acc: 0.242 Test Loss: 4.199 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.1383626461029053
Epoch: 40, Steps: 10 | Train Loss: 0.049 Vali Loss: 4.236 Vali Acc: 0.238 Test Loss: 4.236 Test Acc: 0.238
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.2214810848236084
Epoch: 41, Steps: 10 | Train Loss: 0.049 Vali Loss: 4.268 Vali Acc: 0.242 Test Loss: 4.268 Test Acc: 0.242
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.1385304927825928
Epoch: 42, Steps: 10 | Train Loss: 0.045 Vali Loss: 4.296 Vali Acc: 0.240 Test Loss: 4.296 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.0558109283447266
Epoch: 43, Steps: 10 | Train Loss: 0.039 Vali Loss: 4.339 Vali Acc: 0.236 Test Loss: 4.339 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.0323081016540527
Epoch: 44, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.367 Vali Acc: 0.238 Test Loss: 4.367 Test Acc: 0.238
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.1098370552062988
Epoch: 45, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.395 Vali Acc: 0.245 Test Loss: 4.395 Test Acc: 0.245
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.1936802864074707
Epoch: 46, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.419 Vali Acc: 0.249 Test Loss: 4.419 Test Acc: 0.249
Validation loss decreased (-0.244664 --> -0.249368).  Saving model ...
Epoch: 47 cost time: 1.1504549980163574
Epoch: 47, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.475 Vali Acc: 0.245 Test Loss: 4.475 Test Acc: 0.245
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.1697330474853516
Epoch: 48, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.495 Vali Acc: 0.244 Test Loss: 4.495 Test Acc: 0.244
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.146545648574829
Epoch: 49, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.525 Vali Acc: 0.244 Test Loss: 4.525 Test Acc: 0.244
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.1026239395141602
Epoch: 50, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.538 Vali Acc: 0.242 Test Loss: 4.538 Test Acc: 0.242
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps23_str12_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.24941176470588236
model parameter : 202650
model size : 0.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.7887656688690186
Epoch: 1, Steps: 10 | Train Loss: 3.289 Vali Loss: 3.266 Vali Acc: 0.040 Test Loss: 3.266 Test Acc: 0.040
Validation loss decreased (inf --> -0.039967).  Saving model ...
Epoch: 2 cost time: 1.074756145477295
Epoch: 2, Steps: 10 | Train Loss: 3.231 Vali Loss: 3.266 Vali Acc: 0.042 Test Loss: 3.266 Test Acc: 0.042
Validation loss decreased (-0.039967 --> -0.042320).  Saving model ...
Epoch: 3 cost time: 1.1156737804412842
Epoch: 3, Steps: 10 | Train Loss: 3.171 Vali Loss: 3.264 Vali Acc: 0.054 Test Loss: 3.264 Test Acc: 0.054
Validation loss decreased (-0.042320 --> -0.054085).  Saving model ...
Epoch: 4 cost time: 1.100480556488037
Epoch: 4, Steps: 10 | Train Loss: 3.148 Vali Loss: 3.262 Vali Acc: 0.073 Test Loss: 3.262 Test Acc: 0.073
Validation loss decreased (-0.054085 --> -0.072909).  Saving model ...
Epoch: 5 cost time: 0.971473217010498
Epoch: 5, Steps: 10 | Train Loss: 3.070 Vali Loss: 3.260 Vali Acc: 0.067 Test Loss: 3.260 Test Acc: 0.067
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.909984827041626
Epoch: 6, Steps: 10 | Train Loss: 2.998 Vali Loss: 3.256 Vali Acc: 0.075 Test Loss: 3.256 Test Acc: 0.075
Validation loss decreased (-0.072909 --> -0.075262).  Saving model ...
Epoch: 7 cost time: 1.1910109519958496
Epoch: 7, Steps: 10 | Train Loss: 2.909 Vali Loss: 3.255 Vali Acc: 0.082 Test Loss: 3.255 Test Acc: 0.082
Validation loss decreased (-0.075262 --> -0.082320).  Saving model ...
Epoch: 8 cost time: 1.138164758682251
Epoch: 8, Steps: 10 | Train Loss: 2.833 Vali Loss: 3.253 Vali Acc: 0.087 Test Loss: 3.253 Test Acc: 0.087
Validation loss decreased (-0.082320 --> -0.087026).  Saving model ...
Epoch: 9 cost time: 1.111823558807373
Epoch: 9, Steps: 10 | Train Loss: 2.741 Vali Loss: 3.247 Vali Acc: 0.094 Test Loss: 3.247 Test Acc: 0.094
Validation loss decreased (-0.087026 --> -0.094085).  Saving model ...
Epoch: 10 cost time: 1.1689116954803467
Epoch: 10, Steps: 10 | Train Loss: 2.624 Vali Loss: 3.242 Vali Acc: 0.098 Test Loss: 3.242 Test Acc: 0.098
Validation loss decreased (-0.094085 --> -0.097615).  Saving model ...
Epoch: 11 cost time: 1.0793821811676025
Epoch: 11, Steps: 10 | Train Loss: 2.567 Vali Loss: 3.234 Vali Acc: 0.106 Test Loss: 3.234 Test Acc: 0.106
Validation loss decreased (-0.097615 --> -0.105850).  Saving model ...
Epoch: 12 cost time: 0.9937005043029785
Epoch: 12, Steps: 10 | Train Loss: 2.421 Vali Loss: 3.226 Vali Acc: 0.114 Test Loss: 3.226 Test Acc: 0.114
Validation loss decreased (-0.105850 --> -0.114085).  Saving model ...
Epoch: 13 cost time: 0.9309108257293701
Epoch: 13, Steps: 10 | Train Loss: 2.287 Vali Loss: 3.214 Vali Acc: 0.124 Test Loss: 3.214 Test Acc: 0.124
Validation loss decreased (-0.114085 --> -0.123497).  Saving model ...
Epoch: 14 cost time: 1.0899996757507324
Epoch: 14, Steps: 10 | Train Loss: 2.132 Vali Loss: 3.206 Vali Acc: 0.142 Test Loss: 3.206 Test Acc: 0.142
Validation loss decreased (-0.123497 --> -0.142321).  Saving model ...
Epoch: 15 cost time: 0.991703987121582
Epoch: 15, Steps: 10 | Train Loss: 2.019 Vali Loss: 3.198 Vali Acc: 0.147 Test Loss: 3.198 Test Acc: 0.147
Validation loss decreased (-0.142321 --> -0.147027).  Saving model ...
Epoch: 16 cost time: 0.9956564903259277
Epoch: 16, Steps: 10 | Train Loss: 1.828 Vali Loss: 3.201 Vali Acc: 0.156 Test Loss: 3.201 Test Acc: 0.156
Validation loss decreased (-0.147027 --> -0.156439).  Saving model ...
Epoch: 17 cost time: 0.9749345779418945
Epoch: 17, Steps: 10 | Train Loss: 1.702 Vali Loss: 3.203 Vali Acc: 0.160 Test Loss: 3.203 Test Acc: 0.160
Validation loss decreased (-0.156439 --> -0.159968).  Saving model ...
Epoch: 18 cost time: 0.9876923561096191
Epoch: 18, Steps: 10 | Train Loss: 1.521 Vali Loss: 3.212 Vali Acc: 0.166 Test Loss: 3.212 Test Acc: 0.166
Validation loss decreased (-0.159968 --> -0.165850).  Saving model ...
Epoch: 19 cost time: 1.0558137893676758
Epoch: 19, Steps: 10 | Train Loss: 1.387 Vali Loss: 3.237 Vali Acc: 0.174 Test Loss: 3.237 Test Acc: 0.174
Validation loss decreased (-0.165850 --> -0.174085).  Saving model ...
Epoch: 20 cost time: 1.0191731452941895
Epoch: 20, Steps: 10 | Train Loss: 1.209 Vali Loss: 3.258 Vali Acc: 0.179 Test Loss: 3.258 Test Acc: 0.179
Validation loss decreased (-0.174085 --> -0.178791).  Saving model ...
Epoch: 21 cost time: 0.9357476234436035
Epoch: 21, Steps: 10 | Train Loss: 1.067 Vali Loss: 3.278 Vali Acc: 0.193 Test Loss: 3.278 Test Acc: 0.193
Validation loss decreased (-0.178791 --> -0.192908).  Saving model ...
Epoch: 22 cost time: 1.032649278640747
Epoch: 22, Steps: 10 | Train Loss: 0.921 Vali Loss: 3.307 Vali Acc: 0.196 Test Loss: 3.307 Test Acc: 0.196
Validation loss decreased (-0.192908 --> -0.196438).  Saving model ...
Epoch: 23 cost time: 1.0176479816436768
Epoch: 23, Steps: 10 | Train Loss: 0.793 Vali Loss: 3.349 Vali Acc: 0.207 Test Loss: 3.349 Test Acc: 0.207
Validation loss decreased (-0.196438 --> -0.207025).  Saving model ...
Epoch: 24 cost time: 1.016587495803833
Epoch: 24, Steps: 10 | Train Loss: 0.663 Vali Loss: 3.391 Vali Acc: 0.209 Test Loss: 3.391 Test Acc: 0.209
Validation loss decreased (-0.207025 --> -0.209378).  Saving model ...
Epoch: 25 cost time: 1.0185949802398682
Epoch: 25, Steps: 10 | Train Loss: 0.553 Vali Loss: 3.444 Vali Acc: 0.211 Test Loss: 3.444 Test Acc: 0.211
Validation loss decreased (-0.209378 --> -0.210554).  Saving model ...
Epoch: 26 cost time: 0.8875281810760498
Epoch: 26, Steps: 10 | Train Loss: 0.453 Vali Loss: 3.496 Vali Acc: 0.215 Test Loss: 3.496 Test Acc: 0.215
Validation loss decreased (-0.210554 --> -0.215259).  Saving model ...
Epoch: 27 cost time: 1.152625322341919
Epoch: 27, Steps: 10 | Train Loss: 0.405 Vali Loss: 3.524 Vali Acc: 0.218 Test Loss: 3.524 Test Acc: 0.218
Validation loss decreased (-0.215259 --> -0.217612).  Saving model ...
Epoch: 28 cost time: 0.8702187538146973
Epoch: 28, Steps: 10 | Train Loss: 0.337 Vali Loss: 3.599 Vali Acc: 0.208 Test Loss: 3.599 Test Acc: 0.208
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.070556879043579
Epoch: 29, Steps: 10 | Train Loss: 0.270 Vali Loss: 3.648 Vali Acc: 0.213 Test Loss: 3.648 Test Acc: 0.213
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.0803158283233643
Epoch: 30, Steps: 10 | Train Loss: 0.233 Vali Loss: 3.694 Vali Acc: 0.214 Test Loss: 3.694 Test Acc: 0.214
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.1470727920532227
Epoch: 31, Steps: 10 | Train Loss: 0.229 Vali Loss: 3.748 Vali Acc: 0.224 Test Loss: 3.748 Test Acc: 0.224
Validation loss decreased (-0.217612 --> -0.223492).  Saving model ...
Epoch: 32 cost time: 1.0867981910705566
Epoch: 32, Steps: 10 | Train Loss: 0.184 Vali Loss: 3.796 Vali Acc: 0.224 Test Loss: 3.796 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.1226165294647217
Epoch: 33, Steps: 10 | Train Loss: 0.149 Vali Loss: 3.832 Vali Acc: 0.231 Test Loss: 3.832 Test Acc: 0.231
Validation loss decreased (-0.223492 --> -0.230550).  Saving model ...
Epoch: 34 cost time: 0.9871306419372559
Epoch: 34, Steps: 10 | Train Loss: 0.129 Vali Loss: 3.875 Vali Acc: 0.225 Test Loss: 3.875 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.0515682697296143
Epoch: 35, Steps: 10 | Train Loss: 0.103 Vali Loss: 3.907 Vali Acc: 0.232 Test Loss: 3.907 Test Acc: 0.232
Validation loss decreased (-0.230550 --> -0.231726).  Saving model ...
Epoch: 36 cost time: 1.1460375785827637
Epoch: 36, Steps: 10 | Train Loss: 0.100 Vali Loss: 3.938 Vali Acc: 0.236 Test Loss: 3.938 Test Acc: 0.236
Validation loss decreased (-0.231726 --> -0.236431).  Saving model ...
Epoch: 37 cost time: 1.0816280841827393
Epoch: 37, Steps: 10 | Train Loss: 0.090 Vali Loss: 3.964 Vali Acc: 0.233 Test Loss: 3.964 Test Acc: 0.233
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.1814181804656982
Epoch: 38, Steps: 10 | Train Loss: 0.079 Vali Loss: 4.012 Vali Acc: 0.233 Test Loss: 4.012 Test Acc: 0.233
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.0903358459472656
Epoch: 39, Steps: 10 | Train Loss: 0.063 Vali Loss: 4.054 Vali Acc: 0.234 Test Loss: 4.054 Test Acc: 0.234
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.974524736404419
Epoch: 40, Steps: 10 | Train Loss: 0.068 Vali Loss: 4.092 Vali Acc: 0.233 Test Loss: 4.092 Test Acc: 0.233
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.9342405796051025
Epoch: 41, Steps: 10 | Train Loss: 0.060 Vali Loss: 4.125 Vali Acc: 0.239 Test Loss: 4.125 Test Acc: 0.239
Validation loss decreased (-0.236431 --> -0.238782).  Saving model ...
Epoch: 42 cost time: 1.0656969547271729
Epoch: 42, Steps: 10 | Train Loss: 0.052 Vali Loss: 4.131 Vali Acc: 0.233 Test Loss: 4.131 Test Acc: 0.233
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.05936861038208
Epoch: 43, Steps: 10 | Train Loss: 0.042 Vali Loss: 4.158 Vali Acc: 0.236 Test Loss: 4.158 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.996985673904419
Epoch: 44, Steps: 10 | Train Loss: 0.044 Vali Loss: 4.190 Vali Acc: 0.235 Test Loss: 4.190 Test Acc: 0.235
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.9717938899993896
Epoch: 45, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.225 Vali Acc: 0.235 Test Loss: 4.225 Test Acc: 0.235
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.0724749565124512
Epoch: 46, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.254 Vali Acc: 0.235 Test Loss: 4.254 Test Acc: 0.235
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.1316611766815186
Epoch: 47, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.272 Vali Acc: 0.234 Test Loss: 4.272 Test Acc: 0.234
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.9796669483184814
Epoch: 48, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.294 Vali Acc: 0.233 Test Loss: 4.294 Test Acc: 0.233
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 1.062851905822754
Epoch: 49, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.311 Vali Acc: 0.242 Test Loss: 4.311 Test Acc: 0.242
Validation loss decreased (-0.238782 --> -0.242310).  Saving model ...
Epoch: 50 cost time: 1.0801947116851807
Epoch: 50, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.344 Vali Acc: 0.246 Test Loss: 4.344 Test Acc: 0.246
Validation loss decreased (-0.242310 --> -0.245839).  Saving model ...
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.24588235294117647
model parameter : 202906
model size : 0.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps38_str19_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.741025924682617
Epoch: 1, Steps: 10 | Train Loss: 3.276 Vali Loss: 3.270 Vali Acc: 0.042 Test Loss: 3.270 Test Acc: 0.042
Validation loss decreased (inf --> -0.042320).  Saving model ...
Epoch: 2 cost time: 0.9717798233032227
Epoch: 2, Steps: 10 | Train Loss: 3.245 Vali Loss: 3.269 Vali Acc: 0.040 Test Loss: 3.269 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0477499961853027
Epoch: 3, Steps: 10 | Train Loss: 3.196 Vali Loss: 3.265 Vali Acc: 0.042 Test Loss: 3.265 Test Acc: 0.042
Validation loss decreased (-0.042320 --> -0.042320).  Saving model ...
Epoch: 4 cost time: 0.9574282169342041
Epoch: 4, Steps: 10 | Train Loss: 3.142 Vali Loss: 3.260 Vali Acc: 0.052 Test Loss: 3.260 Test Acc: 0.052
Validation loss decreased (-0.042320 --> -0.051732).  Saving model ...
Epoch: 5 cost time: 1.2616565227508545
Epoch: 5, Steps: 10 | Train Loss: 3.091 Vali Loss: 3.254 Vali Acc: 0.060 Test Loss: 3.254 Test Acc: 0.060
Validation loss decreased (-0.051732 --> -0.059967).  Saving model ...
Epoch: 6 cost time: 0.9403896331787109
Epoch: 6, Steps: 10 | Train Loss: 2.998 Vali Loss: 3.249 Vali Acc: 0.073 Test Loss: 3.249 Test Acc: 0.073
Validation loss decreased (-0.059967 --> -0.072909).  Saving model ...
Epoch: 7 cost time: 1.0329322814941406
Epoch: 7, Steps: 10 | Train Loss: 2.936 Vali Loss: 3.244 Vali Acc: 0.075 Test Loss: 3.244 Test Acc: 0.075
Validation loss decreased (-0.072909 --> -0.075262).  Saving model ...
Epoch: 8 cost time: 1.0475447177886963
Epoch: 8, Steps: 10 | Train Loss: 2.860 Vali Loss: 3.240 Vali Acc: 0.081 Test Loss: 3.240 Test Acc: 0.081
Validation loss decreased (-0.075262 --> -0.081144).  Saving model ...
Epoch: 9 cost time: 1.0862038135528564
Epoch: 9, Steps: 10 | Train Loss: 2.779 Vali Loss: 3.237 Vali Acc: 0.092 Test Loss: 3.237 Test Acc: 0.092
Validation loss decreased (-0.081144 --> -0.091732).  Saving model ...
Epoch: 10 cost time: 0.9020006656646729
Epoch: 10, Steps: 10 | Train Loss: 2.730 Vali Loss: 3.237 Vali Acc: 0.100 Test Loss: 3.237 Test Acc: 0.100
Validation loss decreased (-0.091732 --> -0.099968).  Saving model ...
Epoch: 11 cost time: 1.0226917266845703
Epoch: 11, Steps: 10 | Train Loss: 2.611 Vali Loss: 3.231 Vali Acc: 0.109 Test Loss: 3.231 Test Acc: 0.109
Validation loss decreased (-0.099968 --> -0.109379).  Saving model ...
Epoch: 12 cost time: 1.0195896625518799
Epoch: 12, Steps: 10 | Train Loss: 2.518 Vali Loss: 3.223 Vali Acc: 0.118 Test Loss: 3.223 Test Acc: 0.118
Validation loss decreased (-0.109379 --> -0.117615).  Saving model ...
Epoch: 13 cost time: 1.0875084400177002
Epoch: 13, Steps: 10 | Train Loss: 2.420 Vali Loss: 3.218 Vali Acc: 0.124 Test Loss: 3.218 Test Acc: 0.124
Validation loss decreased (-0.117615 --> -0.123497).  Saving model ...
Epoch: 14 cost time: 1.218381643295288
Epoch: 14, Steps: 10 | Train Loss: 2.288 Vali Loss: 3.213 Vali Acc: 0.132 Test Loss: 3.213 Test Acc: 0.132
Validation loss decreased (-0.123497 --> -0.131733).  Saving model ...
Epoch: 15 cost time: 1.092684030532837
Epoch: 15, Steps: 10 | Train Loss: 2.139 Vali Loss: 3.207 Vali Acc: 0.141 Test Loss: 3.207 Test Acc: 0.141
Validation loss decreased (-0.131733 --> -0.141144).  Saving model ...
Epoch: 16 cost time: 1.0401740074157715
Epoch: 16, Steps: 10 | Train Loss: 2.053 Vali Loss: 3.205 Vali Acc: 0.154 Test Loss: 3.205 Test Acc: 0.154
Validation loss decreased (-0.141144 --> -0.154086).  Saving model ...
Epoch: 17 cost time: 0.9344971179962158
Epoch: 17, Steps: 10 | Train Loss: 1.892 Vali Loss: 3.210 Vali Acc: 0.161 Test Loss: 3.210 Test Acc: 0.161
Validation loss decreased (-0.154086 --> -0.161144).  Saving model ...
Epoch: 18 cost time: 0.9934284687042236
Epoch: 18, Steps: 10 | Train Loss: 1.731 Vali Loss: 3.217 Vali Acc: 0.172 Test Loss: 3.217 Test Acc: 0.172
Validation loss decreased (-0.161144 --> -0.171733).  Saving model ...
Epoch: 19 cost time: 0.9775989055633545
Epoch: 19, Steps: 10 | Train Loss: 1.615 Vali Loss: 3.223 Vali Acc: 0.188 Test Loss: 3.223 Test Acc: 0.188
Validation loss decreased (-0.171733 --> -0.188203).  Saving model ...
Epoch: 20 cost time: 0.980712890625
Epoch: 20, Steps: 10 | Train Loss: 1.462 Vali Loss: 3.236 Vali Acc: 0.193 Test Loss: 3.236 Test Acc: 0.193
Validation loss decreased (-0.188203 --> -0.192909).  Saving model ...
Epoch: 21 cost time: 1.050597906112671
Epoch: 21, Steps: 10 | Train Loss: 1.285 Vali Loss: 3.248 Vali Acc: 0.209 Test Loss: 3.248 Test Acc: 0.209
Validation loss decreased (-0.192909 --> -0.209379).  Saving model ...
Epoch: 22 cost time: 1.044069766998291
Epoch: 22, Steps: 10 | Train Loss: 1.168 Vali Loss: 3.267 Vali Acc: 0.211 Test Loss: 3.267 Test Acc: 0.211
Validation loss decreased (-0.209379 --> -0.210556).  Saving model ...
Epoch: 23 cost time: 0.9524526596069336
Epoch: 23, Steps: 10 | Train Loss: 1.072 Vali Loss: 3.304 Vali Acc: 0.218 Test Loss: 3.304 Test Acc: 0.218
Validation loss decreased (-0.210556 --> -0.217614).  Saving model ...
Epoch: 24 cost time: 1.0062222480773926
Epoch: 24, Steps: 10 | Train Loss: 0.910 Vali Loss: 3.333 Vali Acc: 0.221 Test Loss: 3.333 Test Acc: 0.221
Validation loss decreased (-0.217614 --> -0.221143).  Saving model ...
Epoch: 25 cost time: 1.0369653701782227
Epoch: 25, Steps: 10 | Train Loss: 0.827 Vali Loss: 3.365 Vali Acc: 0.225 Test Loss: 3.365 Test Acc: 0.225
Validation loss decreased (-0.221143 --> -0.224672).  Saving model ...
Epoch: 26 cost time: 1.03572416305542
Epoch: 26, Steps: 10 | Train Loss: 0.714 Vali Loss: 3.397 Vali Acc: 0.236 Test Loss: 3.397 Test Acc: 0.236
Validation loss decreased (-0.224672 --> -0.236437).  Saving model ...
Epoch: 27 cost time: 0.9651072025299072
Epoch: 27, Steps: 10 | Train Loss: 0.627 Vali Loss: 3.440 Vali Acc: 0.235 Test Loss: 3.440 Test Acc: 0.235
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.994807243347168
Epoch: 28, Steps: 10 | Train Loss: 0.532 Vali Loss: 3.487 Vali Acc: 0.235 Test Loss: 3.487 Test Acc: 0.235
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.9728186130523682
Epoch: 29, Steps: 10 | Train Loss: 0.461 Vali Loss: 3.536 Vali Acc: 0.234 Test Loss: 3.536 Test Acc: 0.234
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.0177068710327148
Epoch: 30, Steps: 10 | Train Loss: 0.398 Vali Loss: 3.587 Vali Acc: 0.240 Test Loss: 3.587 Test Acc: 0.240
Validation loss decreased (-0.236437 --> -0.239964).  Saving model ...
Epoch: 31 cost time: 1.0235536098480225
Epoch: 31, Steps: 10 | Train Loss: 0.319 Vali Loss: 3.629 Vali Acc: 0.232 Test Loss: 3.629 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.9903488159179688
Epoch: 32, Steps: 10 | Train Loss: 0.272 Vali Loss: 3.674 Vali Acc: 0.239 Test Loss: 3.674 Test Acc: 0.239
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.9588494300842285
Epoch: 33, Steps: 10 | Train Loss: 0.228 Vali Loss: 3.707 Vali Acc: 0.235 Test Loss: 3.707 Test Acc: 0.235
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.9308881759643555
Epoch: 34, Steps: 10 | Train Loss: 0.205 Vali Loss: 3.744 Vali Acc: 0.240 Test Loss: 3.744 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.1355481147766113
Epoch: 35, Steps: 10 | Train Loss: 0.191 Vali Loss: 3.784 Vali Acc: 0.246 Test Loss: 3.784 Test Acc: 0.246
Validation loss decreased (-0.239964 --> -0.245845).  Saving model ...
Epoch: 36 cost time: 0.9518749713897705
Epoch: 36, Steps: 10 | Train Loss: 0.151 Vali Loss: 3.843 Vali Acc: 0.249 Test Loss: 3.843 Test Acc: 0.249
Validation loss decreased (-0.245845 --> -0.249373).  Saving model ...
Epoch: 37 cost time: 0.9821152687072754
Epoch: 37, Steps: 10 | Train Loss: 0.143 Vali Loss: 3.892 Vali Acc: 0.245 Test Loss: 3.892 Test Acc: 0.245
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.1548283100128174
Epoch: 38, Steps: 10 | Train Loss: 0.126 Vali Loss: 3.947 Vali Acc: 0.233 Test Loss: 3.947 Test Acc: 0.233
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.0282680988311768
Epoch: 39, Steps: 10 | Train Loss: 0.099 Vali Loss: 3.974 Vali Acc: 0.236 Test Loss: 3.974 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.9518015384674072
Epoch: 40, Steps: 10 | Train Loss: 0.089 Vali Loss: 4.016 Vali Acc: 0.239 Test Loss: 4.016 Test Acc: 0.239
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.1013689041137695
Epoch: 41, Steps: 10 | Train Loss: 0.085 Vali Loss: 4.053 Vali Acc: 0.245 Test Loss: 4.053 Test Acc: 0.245
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.1496665477752686
Epoch: 42, Steps: 10 | Train Loss: 0.068 Vali Loss: 4.091 Vali Acc: 0.244 Test Loss: 4.091 Test Acc: 0.244
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.105051040649414
Epoch: 43, Steps: 10 | Train Loss: 0.069 Vali Loss: 4.129 Vali Acc: 0.245 Test Loss: 4.129 Test Acc: 0.245
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.1963467597961426
Epoch: 44, Steps: 10 | Train Loss: 0.063 Vali Loss: 4.162 Vali Acc: 0.247 Test Loss: 4.162 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 1.137725591659546
Epoch: 45, Steps: 10 | Train Loss: 0.058 Vali Loss: 4.183 Vali Acc: 0.249 Test Loss: 4.183 Test Acc: 0.249
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 1.0800037384033203
Epoch: 46, Steps: 10 | Train Loss: 0.059 Vali Loss: 4.212 Vali Acc: 0.248 Test Loss: 4.212 Test Acc: 0.248
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps38_str19_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.24941176470588236
model parameter : 193146
model size : 0.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.491821527481079
Epoch: 1, Steps: 10 | Train Loss: 3.262 Vali Loss: 3.268 Vali Acc: 0.039 Test Loss: 3.268 Test Acc: 0.039
Validation loss decreased (inf --> -0.038791).  Saving model ...
Epoch: 2 cost time: 1.019881010055542
Epoch: 2, Steps: 10 | Train Loss: 3.148 Vali Loss: 3.278 Vali Acc: 0.059 Test Loss: 3.278 Test Acc: 0.059
Validation loss decreased (-0.038791 --> -0.058791).  Saving model ...
Epoch: 3 cost time: 0.9603447914123535
Epoch: 3, Steps: 10 | Train Loss: 2.983 Vali Loss: 3.292 Vali Acc: 0.074 Test Loss: 3.292 Test Acc: 0.074
Validation loss decreased (-0.058791 --> -0.074085).  Saving model ...
Epoch: 4 cost time: 0.9937102794647217
Epoch: 4, Steps: 10 | Train Loss: 2.825 Vali Loss: 3.286 Vali Acc: 0.084 Test Loss: 3.286 Test Acc: 0.084
Validation loss decreased (-0.074085 --> -0.083497).  Saving model ...
Epoch: 5 cost time: 1.0945792198181152
Epoch: 5, Steps: 10 | Train Loss: 2.598 Vali Loss: 3.248 Vali Acc: 0.112 Test Loss: 3.248 Test Acc: 0.112
Validation loss decreased (-0.083497 --> -0.111732).  Saving model ...
Epoch: 6 cost time: 1.076584815979004
Epoch: 6, Steps: 10 | Train Loss: 2.302 Vali Loss: 3.201 Vali Acc: 0.135 Test Loss: 3.201 Test Acc: 0.135
Validation loss decreased (-0.111732 --> -0.135262).  Saving model ...
Epoch: 7 cost time: 1.126744270324707
Epoch: 7, Steps: 10 | Train Loss: 1.935 Vali Loss: 3.175 Vali Acc: 0.152 Test Loss: 3.175 Test Acc: 0.152
Validation loss decreased (-0.135262 --> -0.151733).  Saving model ...
Epoch: 8 cost time: 1.048471450805664
Epoch: 8, Steps: 10 | Train Loss: 1.542 Vali Loss: 3.213 Vali Acc: 0.167 Test Loss: 3.213 Test Acc: 0.167
Validation loss decreased (-0.151733 --> -0.167027).  Saving model ...
Epoch: 9 cost time: 1.0162644386291504
Epoch: 9, Steps: 10 | Train Loss: 1.122 Vali Loss: 3.249 Vali Acc: 0.208 Test Loss: 3.249 Test Acc: 0.208
Validation loss decreased (-0.167027 --> -0.208203).  Saving model ...
Epoch: 10 cost time: 1.0228543281555176
Epoch: 10, Steps: 10 | Train Loss: 0.805 Vali Loss: 3.373 Vali Acc: 0.216 Test Loss: 3.373 Test Acc: 0.216
Validation loss decreased (-0.208203 --> -0.216437).  Saving model ...
Epoch: 11 cost time: 1.1094303131103516
Epoch: 11, Steps: 10 | Train Loss: 0.498 Vali Loss: 3.505 Vali Acc: 0.227 Test Loss: 3.505 Test Acc: 0.227
Validation loss decreased (-0.216437 --> -0.227024).  Saving model ...
Epoch: 12 cost time: 1.1149585247039795
Epoch: 12, Steps: 10 | Train Loss: 0.293 Vali Loss: 3.659 Vali Acc: 0.244 Test Loss: 3.659 Test Acc: 0.244
Validation loss decreased (-0.227024 --> -0.243493).  Saving model ...
Epoch: 13 cost time: 1.1472091674804688
Epoch: 13, Steps: 10 | Train Loss: 0.157 Vali Loss: 3.879 Vali Acc: 0.247 Test Loss: 3.879 Test Acc: 0.247
Validation loss decreased (-0.243493 --> -0.247020).  Saving model ...
Epoch: 14 cost time: 1.0293970108032227
Epoch: 14, Steps: 10 | Train Loss: 0.094 Vali Loss: 4.044 Vali Acc: 0.248 Test Loss: 4.044 Test Acc: 0.248
Validation loss decreased (-0.247020 --> -0.248195).  Saving model ...
Epoch: 15 cost time: 1.1223745346069336
Epoch: 15, Steps: 10 | Train Loss: 0.047 Vali Loss: 4.138 Vali Acc: 0.261 Test Loss: 4.138 Test Acc: 0.261
Validation loss decreased (-0.248195 --> -0.261135).  Saving model ...
Epoch: 16 cost time: 1.0073051452636719
Epoch: 16, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.268 Vali Acc: 0.261 Test Loss: 4.268 Test Acc: 0.261
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0454027652740479
Epoch: 17, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.317 Vali Acc: 0.266 Test Loss: 4.317 Test Acc: 0.266
Validation loss decreased (-0.261135 --> -0.265839).  Saving model ...
Epoch: 18 cost time: 1.0860381126403809
Epoch: 18, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.370 Vali Acc: 0.271 Test Loss: 4.370 Test Acc: 0.271
Validation loss decreased (-0.265839 --> -0.270545).  Saving model ...
Epoch: 19 cost time: 1.1381778717041016
Epoch: 19, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.424 Vali Acc: 0.268 Test Loss: 4.424 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0786030292510986
Epoch: 20, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.480 Vali Acc: 0.265 Test Loss: 4.480 Test Acc: 0.265
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.9429585933685303
Epoch: 21, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.546 Vali Acc: 0.262 Test Loss: 4.546 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.0538716316223145
Epoch: 22, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.569 Vali Acc: 0.264 Test Loss: 4.569 Test Acc: 0.264
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.1050081253051758
Epoch: 23, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.610 Vali Acc: 0.262 Test Loss: 4.610 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.146418809890747
Epoch: 24, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.640 Vali Acc: 0.264 Test Loss: 4.640 Test Acc: 0.264
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.1613562107086182
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.674 Vali Acc: 0.261 Test Loss: 4.674 Test Acc: 0.261
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.9946506023406982
Epoch: 26, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.693 Vali Acc: 0.264 Test Loss: 4.693 Test Acc: 0.264
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.024583339691162
Epoch: 27, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.719 Vali Acc: 0.267 Test Loss: 4.719 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.9804849624633789
Epoch: 28, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.757 Vali Acc: 0.265 Test Loss: 4.757 Test Acc: 0.265
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27058823529411763
model parameter : 359098
model size : 1.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.8445730209350586
Epoch: 1, Steps: 10 | Train Loss: 3.276 Vali Loss: 3.270 Vali Acc: 0.048 Test Loss: 3.270 Test Acc: 0.048
Validation loss decreased (inf --> -0.048203).  Saving model ...
Epoch: 2 cost time: 1.0114154815673828
Epoch: 2, Steps: 10 | Train Loss: 3.200 Vali Loss: 3.272 Vali Acc: 0.040 Test Loss: 3.272 Test Acc: 0.040
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0613102912902832
Epoch: 3, Steps: 10 | Train Loss: 3.087 Vali Loss: 3.283 Vali Acc: 0.047 Test Loss: 3.283 Test Acc: 0.047
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9732010364532471
Epoch: 4, Steps: 10 | Train Loss: 2.991 Vali Loss: 3.297 Vali Acc: 0.059 Test Loss: 3.297 Test Acc: 0.059
Validation loss decreased (-0.048203 --> -0.058791).  Saving model ...
Epoch: 5 cost time: 1.0964412689208984
Epoch: 5, Steps: 10 | Train Loss: 2.850 Vali Loss: 3.283 Vali Acc: 0.081 Test Loss: 3.283 Test Acc: 0.081
Validation loss decreased (-0.058791 --> -0.081144).  Saving model ...
Epoch: 6 cost time: 0.9537897109985352
Epoch: 6, Steps: 10 | Train Loss: 2.675 Vali Loss: 3.258 Vali Acc: 0.089 Test Loss: 3.258 Test Acc: 0.089
Validation loss decreased (-0.081144 --> -0.089379).  Saving model ...
Epoch: 7 cost time: 1.026383876800537
Epoch: 7, Steps: 10 | Train Loss: 2.509 Vali Loss: 3.235 Vali Acc: 0.114 Test Loss: 3.235 Test Acc: 0.114
Validation loss decreased (-0.089379 --> -0.114085).  Saving model ...
Epoch: 8 cost time: 1.050170660018921
Epoch: 8, Steps: 10 | Train Loss: 2.262 Vali Loss: 3.213 Vali Acc: 0.133 Test Loss: 3.213 Test Acc: 0.133
Validation loss decreased (-0.114085 --> -0.132909).  Saving model ...
Epoch: 9 cost time: 1.0426762104034424
Epoch: 9, Steps: 10 | Train Loss: 2.049 Vali Loss: 3.204 Vali Acc: 0.152 Test Loss: 3.204 Test Acc: 0.152
Validation loss decreased (-0.132909 --> -0.151733).  Saving model ...
Epoch: 10 cost time: 1.087989091873169
Epoch: 10, Steps: 10 | Train Loss: 1.767 Vali Loss: 3.208 Vali Acc: 0.164 Test Loss: 3.208 Test Acc: 0.164
Validation loss decreased (-0.151733 --> -0.163497).  Saving model ...
Epoch: 11 cost time: 1.0457885265350342
Epoch: 11, Steps: 10 | Train Loss: 1.473 Vali Loss: 3.229 Vali Acc: 0.178 Test Loss: 3.229 Test Acc: 0.178
Validation loss decreased (-0.163497 --> -0.177615).  Saving model ...
Epoch: 12 cost time: 0.9874653816223145
Epoch: 12, Steps: 10 | Train Loss: 1.174 Vali Loss: 3.249 Vali Acc: 0.201 Test Loss: 3.249 Test Acc: 0.201
Validation loss decreased (-0.177615 --> -0.201144).  Saving model ...
Epoch: 13 cost time: 1.0464861392974854
Epoch: 13, Steps: 10 | Train Loss: 0.918 Vali Loss: 3.321 Vali Acc: 0.214 Test Loss: 3.321 Test Acc: 0.214
Validation loss decreased (-0.201144 --> -0.214084).  Saving model ...
Epoch: 14 cost time: 0.997746467590332
Epoch: 14, Steps: 10 | Train Loss: 0.692 Vali Loss: 3.410 Vali Acc: 0.231 Test Loss: 3.410 Test Acc: 0.231
Validation loss decreased (-0.214084 --> -0.230554).  Saving model ...
Epoch: 15 cost time: 0.9577188491821289
Epoch: 15, Steps: 10 | Train Loss: 0.521 Vali Loss: 3.521 Vali Acc: 0.238 Test Loss: 3.521 Test Acc: 0.238
Validation loss decreased (-0.230554 --> -0.237612).  Saving model ...
Epoch: 16 cost time: 0.9380056858062744
Epoch: 16, Steps: 10 | Train Loss: 0.335 Vali Loss: 3.633 Vali Acc: 0.253 Test Loss: 3.633 Test Acc: 0.253
Validation loss decreased (-0.237612 --> -0.252905).  Saving model ...
Epoch: 17 cost time: 0.8728535175323486
Epoch: 17, Steps: 10 | Train Loss: 0.223 Vali Loss: 3.785 Vali Acc: 0.248 Test Loss: 3.785 Test Acc: 0.248
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0387790203094482
Epoch: 18, Steps: 10 | Train Loss: 0.158 Vali Loss: 3.926 Vali Acc: 0.258 Test Loss: 3.926 Test Acc: 0.258
Validation loss decreased (-0.252905 --> -0.257608).  Saving model ...
Epoch: 19 cost time: 1.0738661289215088
Epoch: 19, Steps: 10 | Train Loss: 0.107 Vali Loss: 4.025 Vali Acc: 0.256 Test Loss: 4.025 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.960707426071167
Epoch: 20, Steps: 10 | Train Loss: 0.080 Vali Loss: 4.081 Vali Acc: 0.253 Test Loss: 4.081 Test Acc: 0.253
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.8964154720306396
Epoch: 21, Steps: 10 | Train Loss: 0.060 Vali Loss: 4.191 Vali Acc: 0.249 Test Loss: 4.191 Test Acc: 0.249
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.9492087364196777
Epoch: 22, Steps: 10 | Train Loss: 0.047 Vali Loss: 4.267 Vali Acc: 0.260 Test Loss: 4.267 Test Acc: 0.260
Validation loss decreased (-0.257608 --> -0.259957).  Saving model ...
Epoch: 23 cost time: 0.9599995613098145
Epoch: 23, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.352 Vali Acc: 0.266 Test Loss: 4.352 Test Acc: 0.266
Validation loss decreased (-0.259957 --> -0.265839).  Saving model ...
Epoch: 24 cost time: 1.0813450813293457
Epoch: 24, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.396 Vali Acc: 0.268 Test Loss: 4.396 Test Acc: 0.268
Validation loss decreased (-0.265839 --> -0.268191).  Saving model ...
Epoch: 25 cost time: 1.0435612201690674
Epoch: 25, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.456 Vali Acc: 0.266 Test Loss: 4.456 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0129525661468506
Epoch: 26, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.492 Vali Acc: 0.265 Test Loss: 4.492 Test Acc: 0.265
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.9671196937561035
Epoch: 27, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.530 Vali Acc: 0.265 Test Loss: 4.530 Test Acc: 0.265
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.9250612258911133
Epoch: 28, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.568 Vali Acc: 0.267 Test Loss: 4.568 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.9534809589385986
Epoch: 29, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.614 Vali Acc: 0.264 Test Loss: 4.614 Test Acc: 0.264
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.0140984058380127
Epoch: 30, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.654 Vali Acc: 0.259 Test Loss: 4.654 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.0459210872650146
Epoch: 31, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.687 Vali Acc: 0.262 Test Loss: 4.687 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.937669038772583
Epoch: 32, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.731 Vali Acc: 0.261 Test Loss: 4.731 Test Acc: 0.261
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.073861837387085
Epoch: 33, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.761 Vali Acc: 0.260 Test Loss: 4.761 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.0037260055541992
Epoch: 34, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.806 Vali Acc: 0.262 Test Loss: 4.806 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26823529411764707
model parameter : 269370
model size : 1.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps12_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.7853527069091797
Epoch: 1, Steps: 10 | Train Loss: 3.306 Vali Loss: 3.262 Vali Acc: 0.035 Test Loss: 3.262 Test Acc: 0.035
Validation loss decreased (inf --> -0.035262).  Saving model ...
Epoch: 2 cost time: 0.992401123046875
Epoch: 2, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.257 Vali Acc: 0.045 Test Loss: 3.257 Test Acc: 0.045
Validation loss decreased (-0.035262 --> -0.044673).  Saving model ...
Epoch: 3 cost time: 1.0293545722961426
Epoch: 3, Steps: 10 | Train Loss: 3.146 Vali Loss: 3.259 Vali Acc: 0.076 Test Loss: 3.259 Test Acc: 0.076
Validation loss decreased (-0.044673 --> -0.076438).  Saving model ...
Epoch: 4 cost time: 0.9081053733825684
Epoch: 4, Steps: 10 | Train Loss: 3.034 Vali Loss: 3.267 Vali Acc: 0.075 Test Loss: 3.267 Test Acc: 0.075
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.97281813621521
Epoch: 5, Steps: 10 | Train Loss: 2.942 Vali Loss: 3.272 Vali Acc: 0.091 Test Loss: 3.272 Test Acc: 0.091
Validation loss decreased (-0.076438 --> -0.090556).  Saving model ...
Epoch: 6 cost time: 0.965526819229126
Epoch: 6, Steps: 10 | Train Loss: 2.837 Vali Loss: 3.264 Vali Acc: 0.089 Test Loss: 3.264 Test Acc: 0.089
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9906113147735596
Epoch: 7, Steps: 10 | Train Loss: 2.687 Vali Loss: 3.243 Vali Acc: 0.108 Test Loss: 3.243 Test Acc: 0.108
Validation loss decreased (-0.090556 --> -0.108203).  Saving model ...
Epoch: 8 cost time: 1.0280780792236328
Epoch: 8, Steps: 10 | Train Loss: 2.532 Vali Loss: 3.229 Vali Acc: 0.109 Test Loss: 3.229 Test Acc: 0.109
Validation loss decreased (-0.108203 --> -0.109379).  Saving model ...
Epoch: 9 cost time: 1.091890573501587
Epoch: 9, Steps: 10 | Train Loss: 2.349 Vali Loss: 3.211 Vali Acc: 0.119 Test Loss: 3.211 Test Acc: 0.119
Validation loss decreased (-0.109379 --> -0.118791).  Saving model ...
Epoch: 10 cost time: 0.9808688163757324
Epoch: 10, Steps: 10 | Train Loss: 2.157 Vali Loss: 3.192 Vali Acc: 0.148 Test Loss: 3.192 Test Acc: 0.148
Validation loss decreased (-0.118791 --> -0.148203).  Saving model ...
Epoch: 11 cost time: 1.009699821472168
Epoch: 11, Steps: 10 | Train Loss: 1.948 Vali Loss: 3.186 Vali Acc: 0.159 Test Loss: 3.186 Test Acc: 0.159
Validation loss decreased (-0.148203 --> -0.158792).  Saving model ...
Epoch: 12 cost time: 1.1688523292541504
Epoch: 12, Steps: 10 | Train Loss: 1.720 Vali Loss: 3.182 Vali Acc: 0.166 Test Loss: 3.182 Test Acc: 0.166
Validation loss decreased (-0.158792 --> -0.165851).  Saving model ...
Epoch: 13 cost time: 1.1137638092041016
Epoch: 13, Steps: 10 | Train Loss: 1.455 Vali Loss: 3.194 Vali Acc: 0.180 Test Loss: 3.194 Test Acc: 0.180
Validation loss decreased (-0.165851 --> -0.179968).  Saving model ...
Epoch: 14 cost time: 1.086897611618042
Epoch: 14, Steps: 10 | Train Loss: 1.244 Vali Loss: 3.230 Vali Acc: 0.193 Test Loss: 3.230 Test Acc: 0.193
Validation loss decreased (-0.179968 --> -0.192909).  Saving model ...
Epoch: 15 cost time: 1.2485907077789307
Epoch: 15, Steps: 10 | Train Loss: 0.998 Vali Loss: 3.276 Vali Acc: 0.204 Test Loss: 3.276 Test Acc: 0.204
Validation loss decreased (-0.192909 --> -0.203497).  Saving model ...
Epoch: 16 cost time: 1.2162599563598633
Epoch: 16, Steps: 10 | Train Loss: 0.799 Vali Loss: 3.338 Vali Acc: 0.221 Test Loss: 3.338 Test Acc: 0.221
Validation loss decreased (-0.203497 --> -0.221143).  Saving model ...
Epoch: 17 cost time: 1.046745777130127
Epoch: 17, Steps: 10 | Train Loss: 0.629 Vali Loss: 3.414 Vali Acc: 0.219 Test Loss: 3.414 Test Acc: 0.219
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0073728561401367
Epoch: 18, Steps: 10 | Train Loss: 0.470 Vali Loss: 3.497 Vali Acc: 0.231 Test Loss: 3.497 Test Acc: 0.231
Validation loss decreased (-0.221143 --> -0.230553).  Saving model ...
Epoch: 19 cost time: 1.063812494277954
Epoch: 19, Steps: 10 | Train Loss: 0.333 Vali Loss: 3.615 Vali Acc: 0.229 Test Loss: 3.615 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1415178775787354
Epoch: 20, Steps: 10 | Train Loss: 0.254 Vali Loss: 3.696 Vali Acc: 0.225 Test Loss: 3.696 Test Acc: 0.225
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.2275111675262451
Epoch: 21, Steps: 10 | Train Loss: 0.193 Vali Loss: 3.783 Vali Acc: 0.231 Test Loss: 3.783 Test Acc: 0.231
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.1771695613861084
Epoch: 22, Steps: 10 | Train Loss: 0.137 Vali Loss: 3.871 Vali Acc: 0.236 Test Loss: 3.871 Test Acc: 0.236
Validation loss decreased (-0.230553 --> -0.236432).  Saving model ...
Epoch: 23 cost time: 1.0877001285552979
Epoch: 23, Steps: 10 | Train Loss: 0.108 Vali Loss: 3.948 Vali Acc: 0.229 Test Loss: 3.948 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0888643264770508
Epoch: 24, Steps: 10 | Train Loss: 0.086 Vali Loss: 4.008 Vali Acc: 0.224 Test Loss: 4.008 Test Acc: 0.224
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.1229276657104492
Epoch: 25, Steps: 10 | Train Loss: 0.067 Vali Loss: 4.083 Vali Acc: 0.225 Test Loss: 4.083 Test Acc: 0.225
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.0053138732910156
Epoch: 26, Steps: 10 | Train Loss: 0.061 Vali Loss: 4.105 Vali Acc: 0.229 Test Loss: 4.105 Test Acc: 0.229
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.1230363845825195
Epoch: 27, Steps: 10 | Train Loss: 0.048 Vali Loss: 4.154 Vali Acc: 0.234 Test Loss: 4.154 Test Acc: 0.234
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.9818084239959717
Epoch: 28, Steps: 10 | Train Loss: 0.042 Vali Loss: 4.214 Vali Acc: 0.233 Test Loss: 4.214 Test Acc: 0.233
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.1515438556671143
Epoch: 29, Steps: 10 | Train Loss: 0.038 Vali Loss: 4.267 Vali Acc: 0.232 Test Loss: 4.267 Test Acc: 0.232
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.1722662448883057
Epoch: 30, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.309 Vali Acc: 0.229 Test Loss: 4.309 Test Acc: 0.229
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.1308465003967285
Epoch: 31, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.337 Vali Acc: 0.241 Test Loss: 4.337 Test Acc: 0.241
Validation loss decreased (-0.236432 --> -0.241133).  Saving model ...
Epoch: 32 cost time: 1.0131430625915527
Epoch: 32, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.379 Vali Acc: 0.241 Test Loss: 4.379 Test Acc: 0.241
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.9994299411773682
Epoch: 33, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.417 Vali Acc: 0.240 Test Loss: 4.417 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.0381696224212646
Epoch: 34, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.455 Vali Acc: 0.233 Test Loss: 4.455 Test Acc: 0.233
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.145427942276001
Epoch: 35, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.475 Vali Acc: 0.235 Test Loss: 4.475 Test Acc: 0.235
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.1296515464782715
Epoch: 36, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.509 Vali Acc: 0.235 Test Loss: 4.509 Test Acc: 0.235
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.0366556644439697
Epoch: 37, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.537 Vali Acc: 0.238 Test Loss: 4.537 Test Acc: 0.238
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.9330155849456787
Epoch: 38, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.563 Vali Acc: 0.236 Test Loss: 4.563 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.9754760265350342
Epoch: 39, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.588 Vali Acc: 0.238 Test Loss: 4.588 Test Acc: 0.238
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.0162272453308105
Epoch: 40, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.596 Vali Acc: 0.245 Test Loss: 4.596 Test Acc: 0.245
Validation loss decreased (-0.241133 --> -0.244660).  Saving model ...
Epoch: 41 cost time: 1.1102938652038574
Epoch: 41, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.620 Vali Acc: 0.246 Test Loss: 4.620 Test Acc: 0.246
Validation loss decreased (-0.244660 --> -0.245836).  Saving model ...
Epoch: 42 cost time: 1.0513553619384766
Epoch: 42, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.645 Vali Acc: 0.242 Test Loss: 4.645 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.2361631393432617
Epoch: 43, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.677 Vali Acc: 0.244 Test Loss: 4.677 Test Acc: 0.244
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.1878256797790527
Epoch: 44, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.690 Vali Acc: 0.245 Test Loss: 4.690 Test Acc: 0.245
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.0493674278259277
Epoch: 45, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.703 Vali Acc: 0.245 Test Loss: 4.703 Test Acc: 0.245
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.1157629489898682
Epoch: 46, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.732 Vali Acc: 0.246 Test Loss: 4.732 Test Acc: 0.246
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.0683448314666748
Epoch: 47, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.766 Vali Acc: 0.242 Test Loss: 4.766 Test Acc: 0.242
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.0598878860473633
Epoch: 48, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.780 Vali Acc: 0.245 Test Loss: 4.780 Test Acc: 0.245
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 1.018512487411499
Epoch: 49, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.808 Vali Acc: 0.248 Test Loss: 4.808 Test Acc: 0.248
Validation loss decreased (-0.245836 --> -0.248187).  Saving model ...
Epoch: 50 cost time: 1.0714163780212402
Epoch: 50, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.832 Vali Acc: 0.246 Test Loss: 4.832 Test Acc: 0.246
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps12_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.24823529411764705
model parameter : 239546
model size : 0.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.60392427444458
Epoch: 1, Steps: 10 | Train Loss: 3.316 Vali Loss: 3.270 Vali Acc: 0.046 Test Loss: 3.270 Test Acc: 0.046
Validation loss decreased (inf --> -0.045850).  Saving model ...
Epoch: 2 cost time: 1.0071625709533691
Epoch: 2, Steps: 10 | Train Loss: 3.279 Vali Loss: 3.268 Vali Acc: 0.045 Test Loss: 3.268 Test Acc: 0.045
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.017453670501709
Epoch: 3, Steps: 10 | Train Loss: 3.196 Vali Loss: 3.266 Vali Acc: 0.051 Test Loss: 3.266 Test Acc: 0.051
Validation loss decreased (-0.045850 --> -0.050556).  Saving model ...
Epoch: 4 cost time: 1.0593984127044678
Epoch: 4, Steps: 10 | Train Loss: 3.097 Vali Loss: 3.267 Vali Acc: 0.058 Test Loss: 3.267 Test Acc: 0.058
Validation loss decreased (-0.050556 --> -0.057614).  Saving model ...
Epoch: 5 cost time: 0.9334068298339844
Epoch: 5, Steps: 10 | Train Loss: 3.020 Vali Loss: 3.270 Vali Acc: 0.068 Test Loss: 3.270 Test Acc: 0.068
Validation loss decreased (-0.057614 --> -0.068203).  Saving model ...
Epoch: 6 cost time: 0.8976163864135742
Epoch: 6, Steps: 10 | Train Loss: 2.902 Vali Loss: 3.268 Vali Acc: 0.076 Test Loss: 3.268 Test Acc: 0.076
Validation loss decreased (-0.068203 --> -0.076438).  Saving model ...
Epoch: 7 cost time: 0.8912839889526367
Epoch: 7, Steps: 10 | Train Loss: 2.821 Vali Loss: 3.265 Vali Acc: 0.071 Test Loss: 3.265 Test Acc: 0.071
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.958733320236206
Epoch: 8, Steps: 10 | Train Loss: 2.731 Vali Loss: 3.253 Vali Acc: 0.087 Test Loss: 3.253 Test Acc: 0.087
Validation loss decreased (-0.076438 --> -0.087026).  Saving model ...
Epoch: 9 cost time: 1.1337428092956543
Epoch: 9, Steps: 10 | Train Loss: 2.579 Vali Loss: 3.233 Vali Acc: 0.102 Test Loss: 3.233 Test Acc: 0.102
Validation loss decreased (-0.087026 --> -0.102321).  Saving model ...
Epoch: 10 cost time: 1.1061666011810303
Epoch: 10, Steps: 10 | Train Loss: 2.415 Vali Loss: 3.217 Vali Acc: 0.120 Test Loss: 3.217 Test Acc: 0.120
Validation loss decreased (-0.102321 --> -0.119968).  Saving model ...
Epoch: 11 cost time: 1.066972017288208
Epoch: 11, Steps: 10 | Train Loss: 2.271 Vali Loss: 3.208 Vali Acc: 0.131 Test Loss: 3.208 Test Acc: 0.131
Validation loss decreased (-0.119968 --> -0.130556).  Saving model ...
Epoch: 12 cost time: 1.04093599319458
Epoch: 12, Steps: 10 | Train Loss: 2.068 Vali Loss: 3.192 Vali Acc: 0.145 Test Loss: 3.192 Test Acc: 0.145
Validation loss decreased (-0.130556 --> -0.144674).  Saving model ...
Epoch: 13 cost time: 1.0700812339782715
Epoch: 13, Steps: 10 | Train Loss: 1.855 Vali Loss: 3.185 Vali Acc: 0.147 Test Loss: 3.185 Test Acc: 0.147
Validation loss decreased (-0.144674 --> -0.147027).  Saving model ...
Epoch: 14 cost time: 1.0628492832183838
Epoch: 14, Steps: 10 | Train Loss: 1.684 Vali Loss: 3.179 Vali Acc: 0.160 Test Loss: 3.179 Test Acc: 0.160
Validation loss decreased (-0.147027 --> -0.159968).  Saving model ...
Epoch: 15 cost time: 1.1173021793365479
Epoch: 15, Steps: 10 | Train Loss: 1.459 Vali Loss: 3.182 Vali Acc: 0.179 Test Loss: 3.182 Test Acc: 0.179
Validation loss decreased (-0.159968 --> -0.178792).  Saving model ...
Epoch: 16 cost time: 1.045372486114502
Epoch: 16, Steps: 10 | Train Loss: 1.267 Vali Loss: 3.201 Vali Acc: 0.195 Test Loss: 3.201 Test Acc: 0.195
Validation loss decreased (-0.178792 --> -0.195262).  Saving model ...
Epoch: 17 cost time: 0.9606645107269287
Epoch: 17, Steps: 10 | Train Loss: 1.055 Vali Loss: 3.227 Vali Acc: 0.194 Test Loss: 3.227 Test Acc: 0.194
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0053067207336426
Epoch: 18, Steps: 10 | Train Loss: 0.892 Vali Loss: 3.269 Vali Acc: 0.206 Test Loss: 3.269 Test Acc: 0.206
Validation loss decreased (-0.195262 --> -0.205850).  Saving model ...
Epoch: 19 cost time: 0.9940845966339111
Epoch: 19, Steps: 10 | Train Loss: 0.721 Vali Loss: 3.320 Vali Acc: 0.224 Test Loss: 3.320 Test Acc: 0.224
Validation loss decreased (-0.205850 --> -0.223496).  Saving model ...
Epoch: 20 cost time: 1.0031871795654297
Epoch: 20, Steps: 10 | Train Loss: 0.554 Vali Loss: 3.373 Vali Acc: 0.224 Test Loss: 3.373 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9958930015563965
Epoch: 21, Steps: 10 | Train Loss: 0.477 Vali Loss: 3.424 Vali Acc: 0.234 Test Loss: 3.424 Test Acc: 0.234
Validation loss decreased (-0.223496 --> -0.234083).  Saving model ...
Epoch: 22 cost time: 0.9431416988372803
Epoch: 22, Steps: 10 | Train Loss: 0.351 Vali Loss: 3.487 Vali Acc: 0.236 Test Loss: 3.487 Test Acc: 0.236
Validation loss decreased (-0.234083 --> -0.236436).  Saving model ...
Epoch: 23 cost time: 0.9922139644622803
Epoch: 23, Steps: 10 | Train Loss: 0.253 Vali Loss: 3.572 Vali Acc: 0.244 Test Loss: 3.572 Test Acc: 0.244
Validation loss decreased (-0.236436 --> -0.243494).  Saving model ...
Epoch: 24 cost time: 0.8781425952911377
Epoch: 24, Steps: 10 | Train Loss: 0.216 Vali Loss: 3.652 Vali Acc: 0.241 Test Loss: 3.652 Test Acc: 0.241
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8636963367462158
Epoch: 25, Steps: 10 | Train Loss: 0.158 Vali Loss: 3.710 Vali Acc: 0.247 Test Loss: 3.710 Test Acc: 0.247
Validation loss decreased (-0.243494 --> -0.247022).  Saving model ...
Epoch: 26 cost time: 1.0043771266937256
Epoch: 26, Steps: 10 | Train Loss: 0.128 Vali Loss: 3.783 Vali Acc: 0.240 Test Loss: 3.783 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0786409378051758
Epoch: 27, Steps: 10 | Train Loss: 0.101 Vali Loss: 3.828 Vali Acc: 0.248 Test Loss: 3.828 Test Acc: 0.248
Validation loss decreased (-0.247022 --> -0.248197).  Saving model ...
Epoch: 28 cost time: 0.9714715480804443
Epoch: 28, Steps: 10 | Train Loss: 0.088 Vali Loss: 3.863 Vali Acc: 0.253 Test Loss: 3.863 Test Acc: 0.253
Validation loss decreased (-0.248197 --> -0.252903).  Saving model ...
Epoch: 29 cost time: 0.99365234375
Epoch: 29, Steps: 10 | Train Loss: 0.074 Vali Loss: 3.922 Vali Acc: 0.251 Test Loss: 3.922 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.8738422393798828
Epoch: 30, Steps: 10 | Train Loss: 0.062 Vali Loss: 3.964 Vali Acc: 0.248 Test Loss: 3.964 Test Acc: 0.248
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.9158914089202881
Epoch: 31, Steps: 10 | Train Loss: 0.053 Vali Loss: 4.008 Vali Acc: 0.249 Test Loss: 4.008 Test Acc: 0.249
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.0690248012542725
Epoch: 32, Steps: 10 | Train Loss: 0.049 Vali Loss: 4.041 Vali Acc: 0.253 Test Loss: 4.041 Test Acc: 0.253
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.0238876342773438
Epoch: 33, Steps: 10 | Train Loss: 0.046 Vali Loss: 4.084 Vali Acc: 0.255 Test Loss: 4.084 Test Acc: 0.255
Validation loss decreased (-0.252903 --> -0.255253).  Saving model ...
Epoch: 34 cost time: 1.1702585220336914
Epoch: 34, Steps: 10 | Train Loss: 0.037 Vali Loss: 4.118 Vali Acc: 0.254 Test Loss: 4.118 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.0434985160827637
Epoch: 35, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.144 Vali Acc: 0.259 Test Loss: 4.144 Test Acc: 0.259
Validation loss decreased (-0.255253 --> -0.258782).  Saving model ...
Epoch: 36 cost time: 0.9364323616027832
Epoch: 36, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.178 Vali Acc: 0.255 Test Loss: 4.178 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.9744839668273926
Epoch: 37, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.215 Vali Acc: 0.253 Test Loss: 4.215 Test Acc: 0.253
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.8976016044616699
Epoch: 38, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.253 Vali Acc: 0.252 Test Loss: 4.253 Test Acc: 0.252
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.065582036972046
Epoch: 39, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.261 Vali Acc: 0.256 Test Loss: 4.261 Test Acc: 0.256
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.1184380054473877
Epoch: 40, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.271 Vali Acc: 0.265 Test Loss: 4.271 Test Acc: 0.265
Validation loss decreased (-0.258782 --> -0.264663).  Saving model ...
Epoch: 41 cost time: 0.9735302925109863
Epoch: 41, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.302 Vali Acc: 0.260 Test Loss: 4.302 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.9877462387084961
Epoch: 42, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.327 Vali Acc: 0.261 Test Loss: 4.327 Test Acc: 0.261
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.0197105407714844
Epoch: 43, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.362 Vali Acc: 0.259 Test Loss: 4.362 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.0656225681304932
Epoch: 44, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.381 Vali Acc: 0.258 Test Loss: 4.381 Test Acc: 0.258
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.9956939220428467
Epoch: 45, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.411 Vali Acc: 0.260 Test Loss: 4.411 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.9720456600189209
Epoch: 46, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.437 Vali Acc: 0.258 Test Loss: 4.437 Test Acc: 0.258
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.8773136138916016
Epoch: 47, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.471 Vali Acc: 0.258 Test Loss: 4.471 Test Acc: 0.258
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 0.9311864376068115
Epoch: 48, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.485 Vali Acc: 0.259 Test Loss: 4.485 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 0.8163774013519287
Epoch: 49, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.498 Vali Acc: 0.258 Test Loss: 4.498 Test Acc: 0.258
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 0.8596653938293457
Epoch: 50, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.528 Vali Acc: 0.255 Test Loss: 4.528 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2647058823529412
model parameter : 219706
model size : 0.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps23_str12_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.6070334911346436
Epoch: 1, Steps: 10 | Train Loss: 3.273 Vali Loss: 3.267 Vali Acc: 0.042 Test Loss: 3.267 Test Acc: 0.042
Validation loss decreased (inf --> -0.042320).  Saving model ...
Epoch: 2 cost time: 0.8805296421051025
Epoch: 2, Steps: 10 | Train Loss: 3.237 Vali Loss: 3.263 Vali Acc: 0.051 Test Loss: 3.263 Test Acc: 0.051
Validation loss decreased (-0.042320 --> -0.050556).  Saving model ...
Epoch: 3 cost time: 0.8476607799530029
Epoch: 3, Steps: 10 | Train Loss: 3.161 Vali Loss: 3.258 Vali Acc: 0.051 Test Loss: 3.258 Test Acc: 0.051
Validation loss decreased (-0.050556 --> -0.050556).  Saving model ...
Epoch: 4 cost time: 0.8983280658721924
Epoch: 4, Steps: 10 | Train Loss: 3.094 Vali Loss: 3.253 Vali Acc: 0.053 Test Loss: 3.253 Test Acc: 0.053
Validation loss decreased (-0.050556 --> -0.052909).  Saving model ...
Epoch: 5 cost time: 0.907069206237793
Epoch: 5, Steps: 10 | Train Loss: 3.025 Vali Loss: 3.248 Vali Acc: 0.071 Test Loss: 3.248 Test Acc: 0.071
Validation loss decreased (-0.052909 --> -0.070556).  Saving model ...
Epoch: 6 cost time: 0.9814798831939697
Epoch: 6, Steps: 10 | Train Loss: 2.981 Vali Loss: 3.243 Vali Acc: 0.073 Test Loss: 3.243 Test Acc: 0.073
Validation loss decreased (-0.070556 --> -0.072909).  Saving model ...
Epoch: 7 cost time: 0.9412820339202881
Epoch: 7, Steps: 10 | Train Loss: 2.874 Vali Loss: 3.238 Vali Acc: 0.076 Test Loss: 3.238 Test Acc: 0.076
Validation loss decreased (-0.072909 --> -0.076438).  Saving model ...
Epoch: 8 cost time: 0.8749978542327881
Epoch: 8, Steps: 10 | Train Loss: 2.753 Vali Loss: 3.233 Vali Acc: 0.084 Test Loss: 3.233 Test Acc: 0.084
Validation loss decreased (-0.076438 --> -0.083497).  Saving model ...
Epoch: 9 cost time: 0.8374283313751221
Epoch: 9, Steps: 10 | Train Loss: 2.659 Vali Loss: 3.228 Vali Acc: 0.093 Test Loss: 3.228 Test Acc: 0.093
Validation loss decreased (-0.083497 --> -0.092909).  Saving model ...
Epoch: 10 cost time: 0.9007477760314941
Epoch: 10, Steps: 10 | Train Loss: 2.563 Vali Loss: 3.223 Vali Acc: 0.101 Test Loss: 3.223 Test Acc: 0.101
Validation loss decreased (-0.092909 --> -0.101144).  Saving model ...
Epoch: 11 cost time: 0.9392127990722656
Epoch: 11, Steps: 10 | Train Loss: 2.440 Vali Loss: 3.217 Vali Acc: 0.108 Test Loss: 3.217 Test Acc: 0.108
Validation loss decreased (-0.101144 --> -0.108203).  Saving model ...
Epoch: 12 cost time: 0.9308679103851318
Epoch: 12, Steps: 10 | Train Loss: 2.302 Vali Loss: 3.207 Vali Acc: 0.111 Test Loss: 3.207 Test Acc: 0.111
Validation loss decreased (-0.108203 --> -0.110556).  Saving model ...
Epoch: 13 cost time: 0.9767675399780273
Epoch: 13, Steps: 10 | Train Loss: 2.137 Vali Loss: 3.202 Vali Acc: 0.125 Test Loss: 3.202 Test Acc: 0.125
Validation loss decreased (-0.110556 --> -0.124674).  Saving model ...
Epoch: 14 cost time: 0.9963011741638184
Epoch: 14, Steps: 10 | Train Loss: 2.002 Vali Loss: 3.198 Vali Acc: 0.139 Test Loss: 3.198 Test Acc: 0.139
Validation loss decreased (-0.124674 --> -0.138792).  Saving model ...
Epoch: 15 cost time: 0.9524731636047363
Epoch: 15, Steps: 10 | Train Loss: 1.849 Vali Loss: 3.208 Vali Acc: 0.144 Test Loss: 3.208 Test Acc: 0.144
Validation loss decreased (-0.138792 --> -0.143497).  Saving model ...
Epoch: 16 cost time: 1.0873615741729736
Epoch: 16, Steps: 10 | Train Loss: 1.699 Vali Loss: 3.210 Vali Acc: 0.156 Test Loss: 3.210 Test Acc: 0.156
Validation loss decreased (-0.143497 --> -0.156438).  Saving model ...
Epoch: 17 cost time: 1.0121431350708008
Epoch: 17, Steps: 10 | Train Loss: 1.533 Vali Loss: 3.217 Vali Acc: 0.165 Test Loss: 3.217 Test Acc: 0.165
Validation loss decreased (-0.156438 --> -0.164674).  Saving model ...
Epoch: 18 cost time: 0.9988148212432861
Epoch: 18, Steps: 10 | Train Loss: 1.379 Vali Loss: 3.232 Vali Acc: 0.181 Test Loss: 3.232 Test Acc: 0.181
Validation loss decreased (-0.164674 --> -0.181144).  Saving model ...
Epoch: 19 cost time: 0.8951416015625
Epoch: 19, Steps: 10 | Train Loss: 1.235 Vali Loss: 3.252 Vali Acc: 0.188 Test Loss: 3.252 Test Acc: 0.188
Validation loss decreased (-0.181144 --> -0.188203).  Saving model ...
Epoch: 20 cost time: 0.8283555507659912
Epoch: 20, Steps: 10 | Train Loss: 1.056 Vali Loss: 3.279 Vali Acc: 0.185 Test Loss: 3.279 Test Acc: 0.185
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9100403785705566
Epoch: 21, Steps: 10 | Train Loss: 0.963 Vali Loss: 3.318 Vali Acc: 0.198 Test Loss: 3.318 Test Acc: 0.198
Validation loss decreased (-0.188203 --> -0.197614).  Saving model ...
Epoch: 22 cost time: 0.9923844337463379
Epoch: 22, Steps: 10 | Train Loss: 0.809 Vali Loss: 3.361 Vali Acc: 0.211 Test Loss: 3.361 Test Acc: 0.211
Validation loss decreased (-0.197614 --> -0.210555).  Saving model ...
Epoch: 23 cost time: 0.8940823078155518
Epoch: 23, Steps: 10 | Train Loss: 0.668 Vali Loss: 3.403 Vali Acc: 0.213 Test Loss: 3.403 Test Acc: 0.213
Validation loss decreased (-0.210555 --> -0.212907).  Saving model ...
Epoch: 24 cost time: 0.8717803955078125
Epoch: 24, Steps: 10 | Train Loss: 0.594 Vali Loss: 3.452 Vali Acc: 0.214 Test Loss: 3.452 Test Acc: 0.214
Validation loss decreased (-0.212907 --> -0.214083).  Saving model ...
Epoch: 25 cost time: 0.909146785736084
Epoch: 25, Steps: 10 | Train Loss: 0.487 Vali Loss: 3.509 Vali Acc: 0.216 Test Loss: 3.509 Test Acc: 0.216
Validation loss decreased (-0.214083 --> -0.216435).  Saving model ...
Epoch: 26 cost time: 1.0327949523925781
Epoch: 26, Steps: 10 | Train Loss: 0.406 Vali Loss: 3.577 Vali Acc: 0.216 Test Loss: 3.577 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9642043113708496
Epoch: 27, Steps: 10 | Train Loss: 0.321 Vali Loss: 3.658 Vali Acc: 0.208 Test Loss: 3.658 Test Acc: 0.208
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.88010573387146
Epoch: 28, Steps: 10 | Train Loss: 0.296 Vali Loss: 3.717 Vali Acc: 0.213 Test Loss: 3.717 Test Acc: 0.213
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.8233869075775146
Epoch: 29, Steps: 10 | Train Loss: 0.233 Vali Loss: 3.755 Vali Acc: 0.220 Test Loss: 3.755 Test Acc: 0.220
Validation loss decreased (-0.216435 --> -0.219962).  Saving model ...
Epoch: 30 cost time: 0.8023266792297363
Epoch: 30, Steps: 10 | Train Loss: 0.203 Vali Loss: 3.804 Vali Acc: 0.212 Test Loss: 3.804 Test Acc: 0.212
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8402743339538574
Epoch: 31, Steps: 10 | Train Loss: 0.174 Vali Loss: 3.868 Vali Acc: 0.221 Test Loss: 3.868 Test Acc: 0.221
Validation loss decreased (-0.219962 --> -0.221138).  Saving model ...
Epoch: 32 cost time: 0.9436626434326172
Epoch: 32, Steps: 10 | Train Loss: 0.150 Vali Loss: 3.916 Vali Acc: 0.220 Test Loss: 3.916 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.9332695007324219
Epoch: 33, Steps: 10 | Train Loss: 0.133 Vali Loss: 3.981 Vali Acc: 0.220 Test Loss: 3.981 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.9373562335968018
Epoch: 34, Steps: 10 | Train Loss: 0.104 Vali Loss: 4.019 Vali Acc: 0.226 Test Loss: 4.019 Test Acc: 0.226
Validation loss decreased (-0.221138 --> -0.225842).  Saving model ...
Epoch: 35 cost time: 0.8777215480804443
Epoch: 35, Steps: 10 | Train Loss: 0.093 Vali Loss: 4.028 Vali Acc: 0.232 Test Loss: 4.028 Test Acc: 0.232
Validation loss decreased (-0.225842 --> -0.231724).  Saving model ...
Epoch: 36 cost time: 0.7983739376068115
Epoch: 36, Steps: 10 | Train Loss: 0.082 Vali Loss: 4.070 Vali Acc: 0.233 Test Loss: 4.070 Test Acc: 0.233
Validation loss decreased (-0.231724 --> -0.232900).  Saving model ...
Epoch: 37 cost time: 0.8375086784362793
Epoch: 37, Steps: 10 | Train Loss: 0.073 Vali Loss: 4.122 Vali Acc: 0.236 Test Loss: 4.122 Test Acc: 0.236
Validation loss decreased (-0.232900 --> -0.236429).  Saving model ...
Epoch: 38 cost time: 0.9217140674591064
Epoch: 38, Steps: 10 | Train Loss: 0.073 Vali Loss: 4.152 Vali Acc: 0.238 Test Loss: 4.152 Test Acc: 0.238
Validation loss decreased (-0.236429 --> -0.237606).  Saving model ...
Epoch: 39 cost time: 0.9040601253509521
Epoch: 39, Steps: 10 | Train Loss: 0.055 Vali Loss: 4.213 Vali Acc: 0.235 Test Loss: 4.213 Test Acc: 0.235
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.910926342010498
Epoch: 40, Steps: 10 | Train Loss: 0.053 Vali Loss: 4.264 Vali Acc: 0.235 Test Loss: 4.264 Test Acc: 0.235
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.8579816818237305
Epoch: 41, Steps: 10 | Train Loss: 0.047 Vali Loss: 4.303 Vali Acc: 0.231 Test Loss: 4.303 Test Acc: 0.231
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.8316771984100342
Epoch: 42, Steps: 10 | Train Loss: 0.041 Vali Loss: 4.340 Vali Acc: 0.233 Test Loss: 4.340 Test Acc: 0.233
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.8963508605957031
Epoch: 43, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.347 Vali Acc: 0.232 Test Loss: 4.347 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.894965410232544
Epoch: 44, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.376 Vali Acc: 0.229 Test Loss: 4.376 Test Acc: 0.229
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.8986258506774902
Epoch: 45, Steps: 10 | Train Loss: 0.038 Vali Loss: 4.398 Vali Acc: 0.227 Test Loss: 4.398 Test Acc: 0.227
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.8830063343048096
Epoch: 46, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.428 Vali Acc: 0.233 Test Loss: 4.428 Test Acc: 0.233
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.8458588123321533
Epoch: 47, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.439 Vali Acc: 0.231 Test Loss: 4.439 Test Acc: 0.231
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 0.8378593921661377
Epoch: 48, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.473 Vali Acc: 0.232 Test Loss: 4.473 Test Acc: 0.232
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps23_str12_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2376470588235294
model parameter : 199962
model size : 0.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.4623584747314453
Epoch: 1, Steps: 10 | Train Loss: 3.267 Vali Loss: 3.277 Vali Acc: 0.039 Test Loss: 3.277 Test Acc: 0.039
Validation loss decreased (inf --> -0.038791).  Saving model ...
Epoch: 2 cost time: 0.868455171585083
Epoch: 2, Steps: 10 | Train Loss: 3.219 Vali Loss: 3.275 Vali Acc: 0.040 Test Loss: 3.275 Test Acc: 0.040
Validation loss decreased (-0.038791 --> -0.039967).  Saving model ...
Epoch: 3 cost time: 0.9685535430908203
Epoch: 3, Steps: 10 | Train Loss: 3.178 Vali Loss: 3.271 Vali Acc: 0.047 Test Loss: 3.271 Test Acc: 0.047
Validation loss decreased (-0.039967 --> -0.047026).  Saving model ...
Epoch: 4 cost time: 0.9450421333312988
Epoch: 4, Steps: 10 | Train Loss: 3.104 Vali Loss: 3.270 Vali Acc: 0.054 Test Loss: 3.270 Test Acc: 0.054
Validation loss decreased (-0.047026 --> -0.054085).  Saving model ...
Epoch: 5 cost time: 0.9145309925079346
Epoch: 5, Steps: 10 | Train Loss: 3.049 Vali Loss: 3.272 Vali Acc: 0.065 Test Loss: 3.272 Test Acc: 0.065
Validation loss decreased (-0.054085 --> -0.064673).  Saving model ...
Epoch: 6 cost time: 0.9176435470581055
Epoch: 6, Steps: 10 | Train Loss: 2.980 Vali Loss: 3.272 Vali Acc: 0.062 Test Loss: 3.272 Test Acc: 0.062
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8811049461364746
Epoch: 7, Steps: 10 | Train Loss: 2.947 Vali Loss: 3.271 Vali Acc: 0.073 Test Loss: 3.271 Test Acc: 0.073
Validation loss decreased (-0.064673 --> -0.072908).  Saving model ...
Epoch: 8 cost time: 0.9724874496459961
Epoch: 8, Steps: 10 | Train Loss: 2.833 Vali Loss: 3.269 Vali Acc: 0.078 Test Loss: 3.269 Test Acc: 0.078
Validation loss decreased (-0.072908 --> -0.077614).  Saving model ...
Epoch: 9 cost time: 0.9322638511657715
Epoch: 9, Steps: 10 | Train Loss: 2.754 Vali Loss: 3.263 Vali Acc: 0.084 Test Loss: 3.263 Test Acc: 0.084
Validation loss decreased (-0.077614 --> -0.083497).  Saving model ...
Epoch: 10 cost time: 0.9513380527496338
Epoch: 10, Steps: 10 | Train Loss: 2.646 Vali Loss: 3.251 Vali Acc: 0.087 Test Loss: 3.251 Test Acc: 0.087
Validation loss decreased (-0.083497 --> -0.087026).  Saving model ...
Epoch: 11 cost time: 0.9839272499084473
Epoch: 11, Steps: 10 | Train Loss: 2.558 Vali Loss: 3.244 Vali Acc: 0.096 Test Loss: 3.244 Test Acc: 0.096
Validation loss decreased (-0.087026 --> -0.096438).  Saving model ...
Epoch: 12 cost time: 0.9510011672973633
Epoch: 12, Steps: 10 | Train Loss: 2.453 Vali Loss: 3.235 Vali Acc: 0.107 Test Loss: 3.235 Test Acc: 0.107
Validation loss decreased (-0.096438 --> -0.107026).  Saving model ...
Epoch: 13 cost time: 0.9133119583129883
Epoch: 13, Steps: 10 | Train Loss: 2.393 Vali Loss: 3.226 Vali Acc: 0.114 Test Loss: 3.226 Test Acc: 0.114
Validation loss decreased (-0.107026 --> -0.114085).  Saving model ...
Epoch: 14 cost time: 0.9373354911804199
Epoch: 14, Steps: 10 | Train Loss: 2.258 Vali Loss: 3.215 Vali Acc: 0.128 Test Loss: 3.215 Test Acc: 0.128
Validation loss decreased (-0.114085 --> -0.128203).  Saving model ...
Epoch: 15 cost time: 1.0092930793762207
Epoch: 15, Steps: 10 | Train Loss: 2.055 Vali Loss: 3.210 Vali Acc: 0.134 Test Loss: 3.210 Test Acc: 0.134
Validation loss decreased (-0.128203 --> -0.134086).  Saving model ...
Epoch: 16 cost time: 0.9532051086425781
Epoch: 16, Steps: 10 | Train Loss: 1.947 Vali Loss: 3.212 Vali Acc: 0.141 Test Loss: 3.212 Test Acc: 0.141
Validation loss decreased (-0.134086 --> -0.141144).  Saving model ...
Epoch: 17 cost time: 0.9757356643676758
Epoch: 17, Steps: 10 | Train Loss: 1.788 Vali Loss: 3.208 Vali Acc: 0.148 Test Loss: 3.208 Test Acc: 0.148
Validation loss decreased (-0.141144 --> -0.148203).  Saving model ...
Epoch: 18 cost time: 0.9186999797821045
Epoch: 18, Steps: 10 | Train Loss: 1.638 Vali Loss: 3.211 Vali Acc: 0.164 Test Loss: 3.211 Test Acc: 0.164
Validation loss decreased (-0.148203 --> -0.163497).  Saving model ...
Epoch: 19 cost time: 0.9150311946868896
Epoch: 19, Steps: 10 | Train Loss: 1.455 Vali Loss: 3.223 Vali Acc: 0.172 Test Loss: 3.223 Test Acc: 0.172
Validation loss decreased (-0.163497 --> -0.171732).  Saving model ...
Epoch: 20 cost time: 0.9070556163787842
Epoch: 20, Steps: 10 | Train Loss: 1.331 Vali Loss: 3.232 Vali Acc: 0.181 Test Loss: 3.232 Test Acc: 0.181
Validation loss decreased (-0.171732 --> -0.181144).  Saving model ...
Epoch: 21 cost time: 0.8760623931884766
Epoch: 21, Steps: 10 | Train Loss: 1.158 Vali Loss: 3.260 Vali Acc: 0.187 Test Loss: 3.260 Test Acc: 0.187
Validation loss decreased (-0.181144 --> -0.187026).  Saving model ...
Epoch: 22 cost time: 0.8790953159332275
Epoch: 22, Steps: 10 | Train Loss: 1.032 Vali Loss: 3.293 Vali Acc: 0.206 Test Loss: 3.293 Test Acc: 0.206
Validation loss decreased (-0.187026 --> -0.205849).  Saving model ...
Epoch: 23 cost time: 0.901752233505249
Epoch: 23, Steps: 10 | Train Loss: 0.883 Vali Loss: 3.325 Vali Acc: 0.209 Test Loss: 3.325 Test Acc: 0.209
Validation loss decreased (-0.205849 --> -0.209379).  Saving model ...
Epoch: 24 cost time: 0.9101722240447998
Epoch: 24, Steps: 10 | Train Loss: 0.724 Vali Loss: 3.366 Vali Acc: 0.218 Test Loss: 3.366 Test Acc: 0.218
Validation loss decreased (-0.209379 --> -0.217613).  Saving model ...
Epoch: 25 cost time: 0.9699206352233887
Epoch: 25, Steps: 10 | Train Loss: 0.638 Vali Loss: 3.403 Vali Acc: 0.219 Test Loss: 3.403 Test Acc: 0.219
Validation loss decreased (-0.217613 --> -0.218790).  Saving model ...
Epoch: 26 cost time: 0.9656472206115723
Epoch: 26, Steps: 10 | Train Loss: 0.524 Vali Loss: 3.450 Vali Acc: 0.227 Test Loss: 3.450 Test Acc: 0.227
Validation loss decreased (-0.218790 --> -0.227024).  Saving model ...
Epoch: 27 cost time: 0.9984772205352783
Epoch: 27, Steps: 10 | Train Loss: 0.424 Vali Loss: 3.506 Vali Acc: 0.224 Test Loss: 3.506 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9300427436828613
Epoch: 28, Steps: 10 | Train Loss: 0.363 Vali Loss: 3.558 Vali Acc: 0.224 Test Loss: 3.558 Test Acc: 0.224
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.906118631362915
Epoch: 29, Steps: 10 | Train Loss: 0.311 Vali Loss: 3.618 Vali Acc: 0.225 Test Loss: 3.618 Test Acc: 0.225
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.00028395652771
Epoch: 30, Steps: 10 | Train Loss: 0.251 Vali Loss: 3.661 Vali Acc: 0.227 Test Loss: 3.661 Test Acc: 0.227
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.9318633079528809
Epoch: 31, Steps: 10 | Train Loss: 0.220 Vali Loss: 3.706 Vali Acc: 0.236 Test Loss: 3.706 Test Acc: 0.236
Validation loss decreased (-0.227024 --> -0.236434).  Saving model ...
Epoch: 32 cost time: 1.0177366733551025
Epoch: 32, Steps: 10 | Train Loss: 0.181 Vali Loss: 3.738 Vali Acc: 0.242 Test Loss: 3.738 Test Acc: 0.242
Validation loss decreased (-0.236434 --> -0.242316).  Saving model ...
Epoch: 33 cost time: 0.9476625919342041
Epoch: 33, Steps: 10 | Train Loss: 0.156 Vali Loss: 3.790 Vali Acc: 0.236 Test Loss: 3.790 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.9187874794006348
Epoch: 34, Steps: 10 | Train Loss: 0.135 Vali Loss: 3.833 Vali Acc: 0.245 Test Loss: 3.833 Test Acc: 0.245
Validation loss decreased (-0.242316 --> -0.244668).  Saving model ...
Epoch: 35 cost time: 0.9547865390777588
Epoch: 35, Steps: 10 | Train Loss: 0.113 Vali Loss: 3.885 Vali Acc: 0.240 Test Loss: 3.885 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.043973445892334
Epoch: 36, Steps: 10 | Train Loss: 0.101 Vali Loss: 3.942 Vali Acc: 0.244 Test Loss: 3.942 Test Acc: 0.244
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.000626802444458
Epoch: 37, Steps: 10 | Train Loss: 0.092 Vali Loss: 3.975 Vali Acc: 0.248 Test Loss: 3.975 Test Acc: 0.248
Validation loss decreased (-0.244668 --> -0.248196).  Saving model ...
Epoch: 38 cost time: 0.9606184959411621
Epoch: 38, Steps: 10 | Train Loss: 0.075 Vali Loss: 4.000 Vali Acc: 0.252 Test Loss: 4.000 Test Acc: 0.252
Validation loss decreased (-0.248196 --> -0.251725).  Saving model ...
Epoch: 39 cost time: 0.8702073097229004
Epoch: 39, Steps: 10 | Train Loss: 0.066 Vali Loss: 4.016 Vali Acc: 0.254 Test Loss: 4.016 Test Acc: 0.254
Validation loss decreased (-0.251725 --> -0.254077).  Saving model ...
Epoch: 40 cost time: 0.9477107524871826
Epoch: 40, Steps: 10 | Train Loss: 0.067 Vali Loss: 4.061 Vali Acc: 0.254 Test Loss: 4.061 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.0590052604675293
Epoch: 41, Steps: 10 | Train Loss: 0.054 Vali Loss: 4.101 Vali Acc: 0.249 Test Loss: 4.101 Test Acc: 0.249
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.9673817157745361
Epoch: 42, Steps: 10 | Train Loss: 0.052 Vali Loss: 4.132 Vali Acc: 0.249 Test Loss: 4.132 Test Acc: 0.249
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.9305963516235352
Epoch: 43, Steps: 10 | Train Loss: 0.046 Vali Loss: 4.154 Vali Acc: 0.247 Test Loss: 4.154 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.905646800994873
Epoch: 44, Steps: 10 | Train Loss: 0.039 Vali Loss: 4.177 Vali Acc: 0.249 Test Loss: 4.177 Test Acc: 0.249
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.9297466278076172
Epoch: 45, Steps: 10 | Train Loss: 0.037 Vali Loss: 4.207 Vali Acc: 0.252 Test Loss: 4.207 Test Acc: 0.252
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.9552981853485107
Epoch: 46, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.232 Vali Acc: 0.249 Test Loss: 4.232 Test Acc: 0.249
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.0097730159759521
Epoch: 47, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.251 Vali Acc: 0.249 Test Loss: 4.251 Test Acc: 0.249
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 0.9907004833221436
Epoch: 48, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.282 Vali Acc: 0.251 Test Loss: 4.282 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 0.9768226146697998
Epoch: 49, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.294 Vali Acc: 0.252 Test Loss: 4.294 Test Acc: 0.252
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2541176470588235
model parameter : 200218
model size : 0.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps38_str19_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.545853853225708
Epoch: 1, Steps: 10 | Train Loss: 3.292 Vali Loss: 3.270 Vali Acc: 0.036 Test Loss: 3.270 Test Acc: 0.036
Validation loss decreased (inf --> -0.036438).  Saving model ...
Epoch: 2 cost time: 0.9481122493743896
Epoch: 2, Steps: 10 | Train Loss: 3.266 Vali Loss: 3.267 Vali Acc: 0.038 Test Loss: 3.267 Test Acc: 0.038
Validation loss decreased (-0.036438 --> -0.037614).  Saving model ...
Epoch: 3 cost time: 0.9530236721038818
Epoch: 3, Steps: 10 | Train Loss: 3.244 Vali Loss: 3.261 Vali Acc: 0.041 Test Loss: 3.261 Test Acc: 0.041
Validation loss decreased (-0.037614 --> -0.041144).  Saving model ...
Epoch: 4 cost time: 0.9529855251312256
Epoch: 4, Steps: 10 | Train Loss: 3.149 Vali Loss: 3.256 Vali Acc: 0.056 Test Loss: 3.256 Test Acc: 0.056
Validation loss decreased (-0.041144 --> -0.056438).  Saving model ...
Epoch: 5 cost time: 1.0585908889770508
Epoch: 5, Steps: 10 | Train Loss: 3.089 Vali Loss: 3.252 Vali Acc: 0.068 Test Loss: 3.252 Test Acc: 0.068
Validation loss decreased (-0.056438 --> -0.068203).  Saving model ...
Epoch: 6 cost time: 0.9693701267242432
Epoch: 6, Steps: 10 | Train Loss: 3.018 Vali Loss: 3.248 Vali Acc: 0.074 Test Loss: 3.248 Test Acc: 0.074
Validation loss decreased (-0.068203 --> -0.074085).  Saving model ...
Epoch: 7 cost time: 0.9604790210723877
Epoch: 7, Steps: 10 | Train Loss: 2.950 Vali Loss: 3.246 Vali Acc: 0.080 Test Loss: 3.246 Test Acc: 0.080
Validation loss decreased (-0.074085 --> -0.079968).  Saving model ...
Epoch: 8 cost time: 0.927086353302002
Epoch: 8, Steps: 10 | Train Loss: 2.864 Vali Loss: 3.244 Vali Acc: 0.089 Test Loss: 3.244 Test Acc: 0.089
Validation loss decreased (-0.079968 --> -0.089379).  Saving model ...
Epoch: 9 cost time: 0.9212675094604492
Epoch: 9, Steps: 10 | Train Loss: 2.814 Vali Loss: 3.241 Vali Acc: 0.093 Test Loss: 3.241 Test Acc: 0.093
Validation loss decreased (-0.089379 --> -0.092909).  Saving model ...
Epoch: 10 cost time: 0.9898874759674072
Epoch: 10, Steps: 10 | Train Loss: 2.712 Vali Loss: 3.234 Vali Acc: 0.102 Test Loss: 3.234 Test Acc: 0.102
Validation loss decreased (-0.092909 --> -0.102321).  Saving model ...
Epoch: 11 cost time: 0.9587712287902832
Epoch: 11, Steps: 10 | Train Loss: 2.641 Vali Loss: 3.227 Vali Acc: 0.115 Test Loss: 3.227 Test Acc: 0.115
Validation loss decreased (-0.102321 --> -0.115262).  Saving model ...
Epoch: 12 cost time: 0.9588901996612549
Epoch: 12, Steps: 10 | Train Loss: 2.499 Vali Loss: 3.219 Vali Acc: 0.128 Test Loss: 3.219 Test Acc: 0.128
Validation loss decreased (-0.115262 --> -0.128203).  Saving model ...
Epoch: 13 cost time: 0.9648866653442383
Epoch: 13, Steps: 10 | Train Loss: 2.455 Vali Loss: 3.215 Vali Acc: 0.126 Test Loss: 3.215 Test Acc: 0.126
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.993319034576416
Epoch: 14, Steps: 10 | Train Loss: 2.322 Vali Loss: 3.210 Vali Acc: 0.129 Test Loss: 3.210 Test Acc: 0.129
Validation loss decreased (-0.128203 --> -0.129380).  Saving model ...
Epoch: 15 cost time: 1.0064287185668945
Epoch: 15, Steps: 10 | Train Loss: 2.210 Vali Loss: 3.203 Vali Acc: 0.146 Test Loss: 3.203 Test Acc: 0.146
Validation loss decreased (-0.129380 --> -0.145850).  Saving model ...
Epoch: 16 cost time: 0.9863851070404053
Epoch: 16, Steps: 10 | Train Loss: 2.078 Vali Loss: 3.198 Vali Acc: 0.152 Test Loss: 3.198 Test Acc: 0.152
Validation loss decreased (-0.145850 --> -0.151733).  Saving model ...
Epoch: 17 cost time: 0.9364426136016846
Epoch: 17, Steps: 10 | Train Loss: 1.937 Vali Loss: 3.192 Vali Acc: 0.166 Test Loss: 3.192 Test Acc: 0.166
Validation loss decreased (-0.151733 --> -0.165850).  Saving model ...
Epoch: 18 cost time: 0.904914140701294
Epoch: 18, Steps: 10 | Train Loss: 1.804 Vali Loss: 3.199 Vali Acc: 0.174 Test Loss: 3.199 Test Acc: 0.174
Validation loss decreased (-0.165850 --> -0.174086).  Saving model ...
Epoch: 19 cost time: 1.0801494121551514
Epoch: 19, Steps: 10 | Train Loss: 1.637 Vali Loss: 3.202 Vali Acc: 0.179 Test Loss: 3.202 Test Acc: 0.179
Validation loss decreased (-0.174086 --> -0.178792).  Saving model ...
Epoch: 20 cost time: 0.8963663578033447
Epoch: 20, Steps: 10 | Train Loss: 1.532 Vali Loss: 3.210 Vali Acc: 0.191 Test Loss: 3.210 Test Acc: 0.191
Validation loss decreased (-0.178792 --> -0.190556).  Saving model ...
Epoch: 21 cost time: 0.9600663185119629
Epoch: 21, Steps: 10 | Train Loss: 1.365 Vali Loss: 3.215 Vali Acc: 0.199 Test Loss: 3.215 Test Acc: 0.199
Validation loss decreased (-0.190556 --> -0.198791).  Saving model ...
Epoch: 22 cost time: 0.9206278324127197
Epoch: 22, Steps: 10 | Train Loss: 1.214 Vali Loss: 3.229 Vali Acc: 0.204 Test Loss: 3.229 Test Acc: 0.204
Validation loss decreased (-0.198791 --> -0.203497).  Saving model ...
Epoch: 23 cost time: 0.9291658401489258
Epoch: 23, Steps: 10 | Train Loss: 1.088 Vali Loss: 3.255 Vali Acc: 0.214 Test Loss: 3.255 Test Acc: 0.214
Validation loss decreased (-0.203497 --> -0.214085).  Saving model ...
Epoch: 24 cost time: 0.9806137084960938
Epoch: 24, Steps: 10 | Train Loss: 0.964 Vali Loss: 3.288 Vali Acc: 0.215 Test Loss: 3.288 Test Acc: 0.215
Validation loss decreased (-0.214085 --> -0.215261).  Saving model ...
Epoch: 25 cost time: 0.8956389427185059
Epoch: 25, Steps: 10 | Train Loss: 0.862 Vali Loss: 3.330 Vali Acc: 0.211 Test Loss: 3.330 Test Acc: 0.211
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9223124980926514
Epoch: 26, Steps: 10 | Train Loss: 0.768 Vali Loss: 3.373 Vali Acc: 0.209 Test Loss: 3.373 Test Acc: 0.209
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.8509163856506348
Epoch: 27, Steps: 10 | Train Loss: 0.673 Vali Loss: 3.396 Vali Acc: 0.220 Test Loss: 3.396 Test Acc: 0.220
Validation loss decreased (-0.215261 --> -0.219966).  Saving model ...
Epoch: 28 cost time: 0.8810782432556152
Epoch: 28, Steps: 10 | Train Loss: 0.567 Vali Loss: 3.421 Vali Acc: 0.224 Test Loss: 3.421 Test Acc: 0.224
Validation loss decreased (-0.219966 --> -0.223495).  Saving model ...
Epoch: 29 cost time: 1.0974454879760742
Epoch: 29, Steps: 10 | Train Loss: 0.469 Vali Loss: 3.480 Vali Acc: 0.231 Test Loss: 3.480 Test Acc: 0.231
Validation loss decreased (-0.223495 --> -0.230553).  Saving model ...
Epoch: 30 cost time: 0.968228816986084
Epoch: 30, Steps: 10 | Train Loss: 0.389 Vali Loss: 3.535 Vali Acc: 0.225 Test Loss: 3.535 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.9241750240325928
Epoch: 31, Steps: 10 | Train Loss: 0.348 Vali Loss: 3.580 Vali Acc: 0.231 Test Loss: 3.580 Test Acc: 0.231
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.0119678974151611
Epoch: 32, Steps: 10 | Train Loss: 0.278 Vali Loss: 3.634 Vali Acc: 0.220 Test Loss: 3.634 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.0477139949798584
Epoch: 33, Steps: 10 | Train Loss: 0.256 Vali Loss: 3.682 Vali Acc: 0.226 Test Loss: 3.682 Test Acc: 0.226
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.0023078918457031
Epoch: 34, Steps: 10 | Train Loss: 0.214 Vali Loss: 3.734 Vali Acc: 0.219 Test Loss: 3.734 Test Acc: 0.219
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.922490119934082
Epoch: 35, Steps: 10 | Train Loss: 0.209 Vali Loss: 3.776 Vali Acc: 0.228 Test Loss: 3.776 Test Acc: 0.228
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.9144430160522461
Epoch: 36, Steps: 10 | Train Loss: 0.156 Vali Loss: 3.817 Vali Acc: 0.226 Test Loss: 3.817 Test Acc: 0.226
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.8631117343902588
Epoch: 37, Steps: 10 | Train Loss: 0.145 Vali Loss: 3.868 Vali Acc: 0.227 Test Loss: 3.868 Test Acc: 0.227
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.9159374237060547
Epoch: 38, Steps: 10 | Train Loss: 0.125 Vali Loss: 3.905 Vali Acc: 0.234 Test Loss: 3.905 Test Acc: 0.234
Validation loss decreased (-0.230553 --> -0.234079).  Saving model ...
Epoch: 39 cost time: 0.9647247791290283
Epoch: 39, Steps: 10 | Train Loss: 0.121 Vali Loss: 3.933 Vali Acc: 0.232 Test Loss: 3.933 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.9455509185791016
Epoch: 40, Steps: 10 | Train Loss: 0.100 Vali Loss: 3.971 Vali Acc: 0.228 Test Loss: 3.971 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.8632278442382812
Epoch: 41, Steps: 10 | Train Loss: 0.079 Vali Loss: 4.027 Vali Acc: 0.228 Test Loss: 4.027 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.9438486099243164
Epoch: 42, Steps: 10 | Train Loss: 0.080 Vali Loss: 4.064 Vali Acc: 0.226 Test Loss: 4.064 Test Acc: 0.226
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.0190644264221191
Epoch: 43, Steps: 10 | Train Loss: 0.076 Vali Loss: 4.097 Vali Acc: 0.229 Test Loss: 4.097 Test Acc: 0.229
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.0873181819915771
Epoch: 44, Steps: 10 | Train Loss: 0.066 Vali Loss: 4.112 Vali Acc: 0.231 Test Loss: 4.112 Test Acc: 0.231
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.9937243461608887
Epoch: 45, Steps: 10 | Train Loss: 0.056 Vali Loss: 4.156 Vali Acc: 0.229 Test Loss: 4.156 Test Acc: 0.229
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.9212355613708496
Epoch: 46, Steps: 10 | Train Loss: 0.054 Vali Loss: 4.200 Vali Acc: 0.227 Test Loss: 4.200 Test Acc: 0.227
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.8703234195709229
Epoch: 47, Steps: 10 | Train Loss: 0.058 Vali Loss: 4.248 Vali Acc: 0.232 Test Loss: 4.248 Test Acc: 0.232
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 0.978724479675293
Epoch: 48, Steps: 10 | Train Loss: 0.045 Vali Loss: 4.257 Vali Acc: 0.235 Test Loss: 4.257 Test Acc: 0.235
Validation loss decreased (-0.234079 --> -0.235252).  Saving model ...
Epoch: 49 cost time: 0.9531681537628174
Epoch: 49, Steps: 10 | Train Loss: 0.043 Vali Loss: 4.288 Vali Acc: 0.232 Test Loss: 4.288 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.980294942855835
Epoch: 50, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.296 Vali Acc: 0.235 Test Loss: 4.296 Test Acc: 0.235
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps38_str19_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.23529411764705882
model parameter : 190458
model size : 0.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.461296319961548
Epoch: 1, Steps: 10 | Train Loss: 3.245 Vali Loss: 3.271 Vali Acc: 0.067 Test Loss: 3.271 Test Acc: 0.067
Validation loss decreased (inf --> -0.067026).  Saving model ...
Epoch: 2 cost time: 1.2437081336975098
Epoch: 2, Steps: 10 | Train Loss: 2.884 Vali Loss: 3.352 Vali Acc: 0.095 Test Loss: 3.352 Test Acc: 0.095
Validation loss decreased (-0.067026 --> -0.095261).  Saving model ...
Epoch: 3 cost time: 1.0469944477081299
Epoch: 3, Steps: 10 | Train Loss: 2.288 Vali Loss: 3.223 Vali Acc: 0.154 Test Loss: 3.223 Test Acc: 0.154
Validation loss decreased (-0.095261 --> -0.154085).  Saving model ...
Epoch: 4 cost time: 1.23567795753479
Epoch: 4, Steps: 10 | Train Loss: 1.545 Vali Loss: 3.254 Vali Acc: 0.182 Test Loss: 3.254 Test Acc: 0.182
Validation loss decreased (-0.154085 --> -0.182320).  Saving model ...
Epoch: 5 cost time: 1.1628165245056152
Epoch: 5, Steps: 10 | Train Loss: 0.783 Vali Loss: 3.502 Vali Acc: 0.211 Test Loss: 3.502 Test Acc: 0.211
Validation loss decreased (-0.182320 --> -0.210553).  Saving model ...
Epoch: 6 cost time: 1.21535062789917
Epoch: 6, Steps: 10 | Train Loss: 0.318 Vali Loss: 3.863 Vali Acc: 0.240 Test Loss: 3.863 Test Acc: 0.240
Validation loss decreased (-0.210553 --> -0.239961).  Saving model ...
Epoch: 7 cost time: 1.164806604385376
Epoch: 7, Steps: 10 | Train Loss: 0.113 Vali Loss: 4.271 Vali Acc: 0.258 Test Loss: 4.271 Test Acc: 0.258
Validation loss decreased (-0.239961 --> -0.257604).  Saving model ...
Epoch: 8 cost time: 1.171151876449585
Epoch: 8, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.823 Vali Acc: 0.239 Test Loss: 4.823 Test Acc: 0.239
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2431981563568115
Epoch: 9, Steps: 10 | Train Loss: 0.016 Vali Loss: 5.041 Vali Acc: 0.267 Test Loss: 5.041 Test Acc: 0.267
Validation loss decreased (-0.257604 --> -0.267008).  Saving model ...
Epoch: 10 cost time: 1.1213252544403076
Epoch: 10, Steps: 10 | Train Loss: 0.020 Vali Loss: 5.213 Vali Acc: 0.266 Test Loss: 5.213 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.233328104019165
Epoch: 11, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.380 Vali Acc: 0.271 Test Loss: 5.380 Test Acc: 0.271
Validation loss decreased (-0.267008 --> -0.270534).  Saving model ...
Epoch: 12 cost time: 1.212890863418579
Epoch: 12, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.386 Vali Acc: 0.279 Test Loss: 5.386 Test Acc: 0.279
Validation loss decreased (-0.270534 --> -0.278770).  Saving model ...
Epoch: 13 cost time: 1.2030086517333984
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.414 Vali Acc: 0.275 Test Loss: 5.414 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1694085597991943
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.450 Vali Acc: 0.275 Test Loss: 5.450 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1256322860717773
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.471 Vali Acc: 0.274 Test Loss: 5.471 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.1026852130889893
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.510 Vali Acc: 0.273 Test Loss: 5.510 Test Acc: 0.273
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.2315216064453125
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.541 Vali Acc: 0.273 Test Loss: 5.541 Test Acc: 0.273
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.2783310413360596
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.581 Vali Acc: 0.275 Test Loss: 5.581 Test Acc: 0.275
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.107743263244629
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.593 Vali Acc: 0.272 Test Loss: 5.593 Test Acc: 0.272
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.066107988357544
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.619 Vali Acc: 0.275 Test Loss: 5.619 Test Acc: 0.275
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.295696496963501
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.646 Vali Acc: 0.273 Test Loss: 5.646 Test Acc: 0.273
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.2568438053131104
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.655 Vali Acc: 0.273 Test Loss: 5.655 Test Acc: 0.273
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2788235294117647
model parameter : 1354906
model size : 5.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.7722268104553223
Epoch: 1, Steps: 10 | Train Loss: 3.287 Vali Loss: 3.261 Vali Acc: 0.046 Test Loss: 3.261 Test Acc: 0.046
Validation loss decreased (inf --> -0.045850).  Saving model ...
Epoch: 2 cost time: 1.1765048503875732
Epoch: 2, Steps: 10 | Train Loss: 3.023 Vali Loss: 3.294 Vali Acc: 0.071 Test Loss: 3.294 Test Acc: 0.071
Validation loss decreased (-0.045850 --> -0.070555).  Saving model ...
Epoch: 3 cost time: 1.2144932746887207
Epoch: 3, Steps: 10 | Train Loss: 2.698 Vali Loss: 3.294 Vali Acc: 0.108 Test Loss: 3.294 Test Acc: 0.108
Validation loss decreased (-0.070555 --> -0.108202).  Saving model ...
Epoch: 4 cost time: 1.0117757320404053
Epoch: 4, Steps: 10 | Train Loss: 2.231 Vali Loss: 3.218 Vali Acc: 0.166 Test Loss: 3.218 Test Acc: 0.166
Validation loss decreased (-0.108202 --> -0.165850).  Saving model ...
Epoch: 5 cost time: 1.1266944408416748
Epoch: 5, Steps: 10 | Train Loss: 1.741 Vali Loss: 3.198 Vali Acc: 0.191 Test Loss: 3.198 Test Acc: 0.191
Validation loss decreased (-0.165850 --> -0.190556).  Saving model ...
Epoch: 6 cost time: 1.1280646324157715
Epoch: 6, Steps: 10 | Train Loss: 1.151 Vali Loss: 3.297 Vali Acc: 0.194 Test Loss: 3.297 Test Acc: 0.194
Validation loss decreased (-0.190556 --> -0.194085).  Saving model ...
Epoch: 7 cost time: 1.060981273651123
Epoch: 7, Steps: 10 | Train Loss: 0.758 Vali Loss: 3.445 Vali Acc: 0.232 Test Loss: 3.445 Test Acc: 0.232
Validation loss decreased (-0.194085 --> -0.231730).  Saving model ...
Epoch: 8 cost time: 1.134260654449463
Epoch: 8, Steps: 10 | Train Loss: 0.341 Vali Loss: 3.738 Vali Acc: 0.242 Test Loss: 3.738 Test Acc: 0.242
Validation loss decreased (-0.231730 --> -0.242316).  Saving model ...
Epoch: 9 cost time: 1.0875835418701172
Epoch: 9, Steps: 10 | Train Loss: 0.164 Vali Loss: 3.970 Vali Acc: 0.247 Test Loss: 3.970 Test Acc: 0.247
Validation loss decreased (-0.242316 --> -0.247019).  Saving model ...
Epoch: 10 cost time: 1.0605976581573486
Epoch: 10, Steps: 10 | Train Loss: 0.069 Vali Loss: 4.345 Vali Acc: 0.253 Test Loss: 4.345 Test Acc: 0.253
Validation loss decreased (-0.247019 --> -0.252898).  Saving model ...
Epoch: 11 cost time: 1.074308156967163
Epoch: 11, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.562 Vali Acc: 0.256 Test Loss: 4.562 Test Acc: 0.256
Validation loss decreased (-0.252898 --> -0.256425).  Saving model ...
Epoch: 12 cost time: 1.0679044723510742
Epoch: 12, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.634 Vali Acc: 0.264 Test Loss: 4.634 Test Acc: 0.264
Validation loss decreased (-0.256425 --> -0.263483).  Saving model ...
Epoch: 13 cost time: 1.1253070831298828
Epoch: 13, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.716 Vali Acc: 0.268 Test Loss: 4.716 Test Acc: 0.268
Validation loss decreased (-0.263483 --> -0.268188).  Saving model ...
Epoch: 14 cost time: 1.0915093421936035
Epoch: 14, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.794 Vali Acc: 0.268 Test Loss: 4.794 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.062753677368164
Epoch: 15, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.852 Vali Acc: 0.272 Test Loss: 4.852 Test Acc: 0.272
Validation loss decreased (-0.268188 --> -0.271716).  Saving model ...
Epoch: 16 cost time: 1.055161952972412
Epoch: 16, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.901 Vali Acc: 0.269 Test Loss: 4.901 Test Acc: 0.269
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0741899013519287
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.946 Vali Acc: 0.272 Test Loss: 4.946 Test Acc: 0.272
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0910887718200684
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.979 Vali Acc: 0.271 Test Loss: 4.979 Test Acc: 0.271
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.1629486083984375
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.019 Vali Acc: 0.275 Test Loss: 5.019 Test Acc: 0.275
Validation loss decreased (-0.271716 --> -0.275244).  Saving model ...
Epoch: 20 cost time: 0.9854342937469482
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.064 Vali Acc: 0.272 Test Loss: 5.064 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9961843490600586
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.092 Vali Acc: 0.272 Test Loss: 5.092 Test Acc: 0.272
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.1587450504302979
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.124 Vali Acc: 0.269 Test Loss: 5.124 Test Acc: 0.269
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.1861369609832764
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.161 Vali Acc: 0.275 Test Loss: 5.161 Test Acc: 0.275
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.0415129661560059
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.200 Vali Acc: 0.274 Test Loss: 5.200 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.0728745460510254
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.239 Vali Acc: 0.274 Test Loss: 5.239 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.0950946807861328
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.269 Vali Acc: 0.274 Test Loss: 5.269 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.1695787906646729
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.297 Vali Acc: 0.273 Test Loss: 5.297 Test Acc: 0.273
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.0064094066619873
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.318 Vali Acc: 0.274 Test Loss: 5.318 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.0746471881866455
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.335 Vali Acc: 0.272 Test Loss: 5.335 Test Acc: 0.272
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2752941176470588
model parameter : 976026
model size : 3.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps12_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.550055503845215
Epoch: 1, Steps: 10 | Train Loss: 3.350 Vali Loss: 3.259 Vali Acc: 0.034 Test Loss: 3.259 Test Acc: 0.034
Validation loss decreased (inf --> -0.034085).  Saving model ...
Epoch: 2 cost time: 1.0847315788269043
Epoch: 2, Steps: 10 | Train Loss: 3.150 Vali Loss: 3.262 Vali Acc: 0.060 Test Loss: 3.262 Test Acc: 0.060
Validation loss decreased (-0.034085 --> -0.059967).  Saving model ...
Epoch: 3 cost time: 0.9894156455993652
Epoch: 3, Steps: 10 | Train Loss: 2.876 Vali Loss: 3.277 Vali Acc: 0.089 Test Loss: 3.277 Test Acc: 0.089
Validation loss decreased (-0.059967 --> -0.089379).  Saving model ...
Epoch: 4 cost time: 1.0294995307922363
Epoch: 4, Steps: 10 | Train Loss: 2.548 Vali Loss: 3.243 Vali Acc: 0.120 Test Loss: 3.243 Test Acc: 0.120
Validation loss decreased (-0.089379 --> -0.119968).  Saving model ...
Epoch: 5 cost time: 1.069957971572876
Epoch: 5, Steps: 10 | Train Loss: 2.130 Vali Loss: 3.176 Vali Acc: 0.158 Test Loss: 3.176 Test Acc: 0.158
Validation loss decreased (-0.119968 --> -0.157615).  Saving model ...
Epoch: 6 cost time: 1.0925958156585693
Epoch: 6, Steps: 10 | Train Loss: 1.667 Vali Loss: 3.178 Vali Acc: 0.184 Test Loss: 3.178 Test Acc: 0.184
Validation loss decreased (-0.157615 --> -0.183498).  Saving model ...
Epoch: 7 cost time: 1.1401424407958984
Epoch: 7, Steps: 10 | Train Loss: 1.182 Vali Loss: 3.213 Vali Acc: 0.205 Test Loss: 3.213 Test Acc: 0.205
Validation loss decreased (-0.183498 --> -0.204674).  Saving model ...
Epoch: 8 cost time: 1.0209903717041016
Epoch: 8, Steps: 10 | Train Loss: 0.747 Vali Loss: 3.330 Vali Acc: 0.226 Test Loss: 3.330 Test Acc: 0.226
Validation loss decreased (-0.204674 --> -0.225849).  Saving model ...
Epoch: 9 cost time: 1.0152511596679688
Epoch: 9, Steps: 10 | Train Loss: 0.456 Vali Loss: 3.492 Vali Acc: 0.235 Test Loss: 3.492 Test Acc: 0.235
Validation loss decreased (-0.225849 --> -0.235259).  Saving model ...
Epoch: 10 cost time: 1.0884418487548828
Epoch: 10, Steps: 10 | Train Loss: 0.236 Vali Loss: 3.700 Vali Acc: 0.254 Test Loss: 3.700 Test Acc: 0.254
Validation loss decreased (-0.235259 --> -0.254081).  Saving model ...
Epoch: 11 cost time: 1.0064709186553955
Epoch: 11, Steps: 10 | Train Loss: 0.113 Vali Loss: 3.952 Vali Acc: 0.252 Test Loss: 3.952 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.959953784942627
Epoch: 12, Steps: 10 | Train Loss: 0.053 Vali Loss: 4.119 Vali Acc: 0.261 Test Loss: 4.119 Test Acc: 0.261
Validation loss decreased (-0.254081 --> -0.261135).  Saving model ...
Epoch: 13 cost time: 1.0052027702331543
Epoch: 13, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.215 Vali Acc: 0.265 Test Loss: 4.215 Test Acc: 0.265
Validation loss decreased (-0.261135 --> -0.264664).  Saving model ...
Epoch: 14 cost time: 1.1501402854919434
Epoch: 14, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.325 Vali Acc: 0.267 Test Loss: 4.325 Test Acc: 0.267
Validation loss decreased (-0.264664 --> -0.267016).  Saving model ...
Epoch: 15 cost time: 1.0878472328186035
Epoch: 15, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.430 Vali Acc: 0.259 Test Loss: 4.430 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0333929061889648
Epoch: 16, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.496 Vali Acc: 0.266 Test Loss: 4.496 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0527429580688477
Epoch: 17, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.529 Vali Acc: 0.271 Test Loss: 4.529 Test Acc: 0.271
Validation loss decreased (-0.267016 --> -0.270543).  Saving model ...
Epoch: 18 cost time: 1.234370470046997
Epoch: 18, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.578 Vali Acc: 0.271 Test Loss: 4.578 Test Acc: 0.271
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1222643852233887
Epoch: 19, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.623 Vali Acc: 0.269 Test Loss: 4.623 Test Acc: 0.269
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1984622478485107
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.666 Vali Acc: 0.267 Test Loss: 4.666 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.0444574356079102
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.710 Vali Acc: 0.266 Test Loss: 4.710 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.0782716274261475
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.750 Vali Acc: 0.266 Test Loss: 4.750 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.0468175411224365
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.782 Vali Acc: 0.265 Test Loss: 4.782 Test Acc: 0.265
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.1450567245483398
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.819 Vali Acc: 0.266 Test Loss: 4.819 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.0137560367584229
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.840 Vali Acc: 0.267 Test Loss: 4.840 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.163773775100708
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.878 Vali Acc: 0.267 Test Loss: 4.878 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.138291597366333
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.903 Vali Acc: 0.268 Test Loss: 4.903 Test Acc: 0.268
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps12_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27058823529411763
model parameter : 856730
model size : 3.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.729785442352295
Epoch: 1, Steps: 10 | Train Loss: 3.269 Vali Loss: 3.272 Vali Acc: 0.036 Test Loss: 3.272 Test Acc: 0.036
Validation loss decreased (inf --> -0.036438).  Saving model ...
Epoch: 2 cost time: 0.9977266788482666
Epoch: 2, Steps: 10 | Train Loss: 3.098 Vali Loss: 3.266 Vali Acc: 0.051 Test Loss: 3.266 Test Acc: 0.051
Validation loss decreased (-0.036438 --> -0.050556).  Saving model ...
Epoch: 3 cost time: 0.9598169326782227
Epoch: 3, Steps: 10 | Train Loss: 2.890 Vali Loss: 3.274 Vali Acc: 0.081 Test Loss: 3.274 Test Acc: 0.081
Validation loss decreased (-0.050556 --> -0.081144).  Saving model ...
Epoch: 4 cost time: 0.9855141639709473
Epoch: 4, Steps: 10 | Train Loss: 2.606 Vali Loss: 3.261 Vali Acc: 0.112 Test Loss: 3.261 Test Acc: 0.112
Validation loss decreased (-0.081144 --> -0.111732).  Saving model ...
Epoch: 5 cost time: 1.1526551246643066
Epoch: 5, Steps: 10 | Train Loss: 2.289 Vali Loss: 3.225 Vali Acc: 0.149 Test Loss: 3.225 Test Acc: 0.149
Validation loss decreased (-0.111732 --> -0.149380).  Saving model ...
Epoch: 6 cost time: 1.0626845359802246
Epoch: 6, Steps: 10 | Train Loss: 1.911 Vali Loss: 3.177 Vali Acc: 0.166 Test Loss: 3.177 Test Acc: 0.166
Validation loss decreased (-0.149380 --> -0.165851).  Saving model ...
Epoch: 7 cost time: 1.0247318744659424
Epoch: 7, Steps: 10 | Train Loss: 1.523 Vali Loss: 3.175 Vali Acc: 0.180 Test Loss: 3.175 Test Acc: 0.180
Validation loss decreased (-0.165851 --> -0.179968).  Saving model ...
Epoch: 8 cost time: 1.1680686473846436
Epoch: 8, Steps: 10 | Train Loss: 1.125 Vali Loss: 3.204 Vali Acc: 0.209 Test Loss: 3.204 Test Acc: 0.209
Validation loss decreased (-0.179968 --> -0.209380).  Saving model ...
Epoch: 9 cost time: 1.0758910179138184
Epoch: 9, Steps: 10 | Train Loss: 0.784 Vali Loss: 3.333 Vali Acc: 0.225 Test Loss: 3.333 Test Acc: 0.225
Validation loss decreased (-0.209380 --> -0.224673).  Saving model ...
Epoch: 10 cost time: 1.12615966796875
Epoch: 10, Steps: 10 | Train Loss: 0.497 Vali Loss: 3.430 Vali Acc: 0.235 Test Loss: 3.430 Test Acc: 0.235
Validation loss decreased (-0.224673 --> -0.235260).  Saving model ...
Epoch: 11 cost time: 1.0777406692504883
Epoch: 11, Steps: 10 | Train Loss: 0.305 Vali Loss: 3.574 Vali Acc: 0.248 Test Loss: 3.574 Test Acc: 0.248
Validation loss decreased (-0.235260 --> -0.248200).  Saving model ...
Epoch: 12 cost time: 1.1194713115692139
Epoch: 12, Steps: 10 | Train Loss: 0.163 Vali Loss: 3.805 Vali Acc: 0.261 Test Loss: 3.805 Test Acc: 0.261
Validation loss decreased (-0.248200 --> -0.261138).  Saving model ...
Epoch: 13 cost time: 1.0464024543762207
Epoch: 13, Steps: 10 | Train Loss: 0.095 Vali Loss: 3.981 Vali Acc: 0.261 Test Loss: 3.981 Test Acc: 0.261
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2302896976470947
Epoch: 14, Steps: 10 | Train Loss: 0.055 Vali Loss: 4.043 Vali Acc: 0.266 Test Loss: 4.043 Test Acc: 0.266
Validation loss decreased (-0.261138 --> -0.265842).  Saving model ...
Epoch: 15 cost time: 1.1080665588378906
Epoch: 15, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.065 Vali Acc: 0.282 Test Loss: 4.065 Test Acc: 0.282
Validation loss decreased (-0.265842 --> -0.282312).  Saving model ...
Epoch: 16 cost time: 1.0505824089050293
Epoch: 16, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.164 Vali Acc: 0.280 Test Loss: 4.164 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0241353511810303
Epoch: 17, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.261 Vali Acc: 0.271 Test Loss: 4.261 Test Acc: 0.271
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.1038281917572021
Epoch: 18, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.323 Vali Acc: 0.276 Test Loss: 4.323 Test Acc: 0.276
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.9345128536224365
Epoch: 19, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.368 Vali Acc: 0.275 Test Loss: 4.368 Test Acc: 0.275
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.9593489170074463
Epoch: 20, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.410 Vali Acc: 0.278 Test Loss: 4.410 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.1098072528839111
Epoch: 21, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.457 Vali Acc: 0.272 Test Loss: 4.457 Test Acc: 0.272
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.0775370597839355
Epoch: 22, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.496 Vali Acc: 0.278 Test Loss: 4.496 Test Acc: 0.278
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.0857603549957275
Epoch: 23, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.520 Vali Acc: 0.276 Test Loss: 4.520 Test Acc: 0.276
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.0066802501678467
Epoch: 24, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.549 Vali Acc: 0.278 Test Loss: 4.549 Test Acc: 0.278
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.1764390468597412
Epoch: 25, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.583 Vali Acc: 0.278 Test Loss: 4.583 Test Acc: 0.278
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2823529411764706
model parameter : 797338
model size : 3.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps23_str12_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.8644089698791504
Epoch: 1, Steps: 10 | Train Loss: 3.296 Vali Loss: 3.267 Vali Acc: 0.059 Test Loss: 3.267 Test Acc: 0.059
Validation loss decreased (inf --> -0.058791).  Saving model ...
Epoch: 2 cost time: 1.1299262046813965
Epoch: 2, Steps: 10 | Train Loss: 3.182 Vali Loss: 3.250 Vali Acc: 0.053 Test Loss: 3.250 Test Acc: 0.053
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9757845401763916
Epoch: 3, Steps: 10 | Train Loss: 2.997 Vali Loss: 3.239 Vali Acc: 0.094 Test Loss: 3.239 Test Acc: 0.094
Validation loss decreased (-0.058791 --> -0.094085).  Saving model ...
Epoch: 4 cost time: 0.9698655605316162
Epoch: 4, Steps: 10 | Train Loss: 2.810 Vali Loss: 3.237 Vali Acc: 0.093 Test Loss: 3.237 Test Acc: 0.093
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1462397575378418
Epoch: 5, Steps: 10 | Train Loss: 2.537 Vali Loss: 3.221 Vali Acc: 0.132 Test Loss: 3.221 Test Acc: 0.132
Validation loss decreased (-0.094085 --> -0.131732).  Saving model ...
Epoch: 6 cost time: 1.2066328525543213
Epoch: 6, Steps: 10 | Train Loss: 2.304 Vali Loss: 3.200 Vali Acc: 0.148 Test Loss: 3.200 Test Acc: 0.148
Validation loss decreased (-0.131732 --> -0.148203).  Saving model ...
Epoch: 7 cost time: 1.0821006298065186
Epoch: 7, Steps: 10 | Train Loss: 2.002 Vali Loss: 3.175 Vali Acc: 0.152 Test Loss: 3.175 Test Acc: 0.152
Validation loss decreased (-0.148203 --> -0.151733).  Saving model ...
Epoch: 8 cost time: 1.0370166301727295
Epoch: 8, Steps: 10 | Train Loss: 1.675 Vali Loss: 3.170 Vali Acc: 0.173 Test Loss: 3.170 Test Acc: 0.173
Validation loss decreased (-0.151733 --> -0.172909).  Saving model ...
Epoch: 9 cost time: 0.9987869262695312
Epoch: 9, Steps: 10 | Train Loss: 1.381 Vali Loss: 3.179 Vali Acc: 0.205 Test Loss: 3.179 Test Acc: 0.205
Validation loss decreased (-0.172909 --> -0.204674).  Saving model ...
Epoch: 10 cost time: 1.0376741886138916
Epoch: 10, Steps: 10 | Train Loss: 1.088 Vali Loss: 3.206 Vali Acc: 0.216 Test Loss: 3.206 Test Acc: 0.216
Validation loss decreased (-0.204674 --> -0.216439).  Saving model ...
Epoch: 11 cost time: 1.0852272510528564
Epoch: 11, Steps: 10 | Train Loss: 0.773 Vali Loss: 3.293 Vali Acc: 0.233 Test Loss: 3.293 Test Acc: 0.233
Validation loss decreased (-0.216439 --> -0.232908).  Saving model ...
Epoch: 12 cost time: 0.9722561836242676
Epoch: 12, Steps: 10 | Train Loss: 0.567 Vali Loss: 3.400 Vali Acc: 0.241 Test Loss: 3.400 Test Acc: 0.241
Validation loss decreased (-0.232908 --> -0.241142).  Saving model ...
Epoch: 13 cost time: 1.0755953788757324
Epoch: 13, Steps: 10 | Train Loss: 0.380 Vali Loss: 3.483 Vali Acc: 0.251 Test Loss: 3.483 Test Acc: 0.251
Validation loss decreased (-0.241142 --> -0.250553).  Saving model ...
Epoch: 14 cost time: 1.1585619449615479
Epoch: 14, Steps: 10 | Train Loss: 0.242 Vali Loss: 3.569 Vali Acc: 0.264 Test Loss: 3.569 Test Acc: 0.264
Validation loss decreased (-0.250553 --> -0.263494).  Saving model ...
Epoch: 15 cost time: 1.1243164539337158
Epoch: 15, Steps: 10 | Train Loss: 0.153 Vali Loss: 3.699 Vali Acc: 0.266 Test Loss: 3.699 Test Acc: 0.266
Validation loss decreased (-0.263494 --> -0.265845).  Saving model ...
Epoch: 16 cost time: 1.0098788738250732
Epoch: 16, Steps: 10 | Train Loss: 0.105 Vali Loss: 3.821 Vali Acc: 0.264 Test Loss: 3.821 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.180222749710083
Epoch: 17, Steps: 10 | Train Loss: 0.063 Vali Loss: 3.952 Vali Acc: 0.252 Test Loss: 3.952 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9803006649017334
Epoch: 18, Steps: 10 | Train Loss: 0.052 Vali Loss: 4.014 Vali Acc: 0.265 Test Loss: 4.014 Test Acc: 0.265
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.0573711395263672
Epoch: 19, Steps: 10 | Train Loss: 0.038 Vali Loss: 4.043 Vali Acc: 0.271 Test Loss: 4.043 Test Acc: 0.271
Validation loss decreased (-0.265845 --> -0.270548).  Saving model ...
Epoch: 20 cost time: 1.0217137336730957
Epoch: 20, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.081 Vali Acc: 0.275 Test Loss: 4.081 Test Acc: 0.275
Validation loss decreased (-0.270548 --> -0.275253).  Saving model ...
Epoch: 21 cost time: 1.1015043258666992
Epoch: 21, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.128 Vali Acc: 0.273 Test Loss: 4.128 Test Acc: 0.273
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9211161136627197
Epoch: 22, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.172 Vali Acc: 0.275 Test Loss: 4.172 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0367257595062256
Epoch: 23, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.228 Vali Acc: 0.269 Test Loss: 4.228 Test Acc: 0.269
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.089134693145752
Epoch: 24, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.274 Vali Acc: 0.276 Test Loss: 4.274 Test Acc: 0.276
Validation loss decreased (-0.275253 --> -0.276428).  Saving model ...
Epoch: 25 cost time: 1.1534526348114014
Epoch: 25, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.306 Vali Acc: 0.279 Test Loss: 4.306 Test Acc: 0.279
Validation loss decreased (-0.276428 --> -0.278780).  Saving model ...
Epoch: 26 cost time: 1.001399040222168
Epoch: 26, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.352 Vali Acc: 0.279 Test Loss: 4.352 Test Acc: 0.279
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0493519306182861
Epoch: 27, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.368 Vali Acc: 0.275 Test Loss: 4.368 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.113548994064331
Epoch: 28, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.408 Vali Acc: 0.278 Test Loss: 4.408 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.1103267669677734
Epoch: 29, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.423 Vali Acc: 0.284 Test Loss: 4.423 Test Acc: 0.284
Validation loss decreased (-0.278780 --> -0.283485).  Saving model ...
Epoch: 30 cost time: 0.9612269401550293
Epoch: 30, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.454 Vali Acc: 0.281 Test Loss: 4.454 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.0635757446289062
Epoch: 31, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.492 Vali Acc: 0.280 Test Loss: 4.492 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.129183292388916
Epoch: 32, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.516 Vali Acc: 0.280 Test Loss: 4.516 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.0618245601654053
Epoch: 33, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.547 Vali Acc: 0.278 Test Loss: 4.547 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.0331509113311768
Epoch: 34, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.571 Vali Acc: 0.280 Test Loss: 4.571 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.098992109298706
Epoch: 35, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.606 Vali Acc: 0.281 Test Loss: 4.606 Test Acc: 0.281
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.0096843242645264
Epoch: 36, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.622 Vali Acc: 0.279 Test Loss: 4.622 Test Acc: 0.279
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.9628598690032959
Epoch: 37, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.641 Vali Acc: 0.279 Test Loss: 4.641 Test Acc: 0.279
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.008359670639038
Epoch: 38, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.658 Vali Acc: 0.280 Test Loss: 4.658 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.9748892784118652
Epoch: 39, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.675 Vali Acc: 0.280 Test Loss: 4.675 Test Acc: 0.280
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps23_str12_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.28352941176470586
model parameter : 718362
model size : 2.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.6247689723968506
Epoch: 1, Steps: 10 | Train Loss: 3.285 Vali Loss: 3.271 Vali Acc: 0.042 Test Loss: 3.271 Test Acc: 0.042
Validation loss decreased (inf --> -0.042320).  Saving model ...
Epoch: 2 cost time: 0.9993476867675781
Epoch: 2, Steps: 10 | Train Loss: 3.180 Vali Loss: 3.254 Vali Acc: 0.066 Test Loss: 3.254 Test Acc: 0.066
Validation loss decreased (-0.042320 --> -0.065850).  Saving model ...
Epoch: 3 cost time: 0.9454445838928223
Epoch: 3, Steps: 10 | Train Loss: 3.008 Vali Loss: 3.247 Vali Acc: 0.079 Test Loss: 3.247 Test Acc: 0.079
Validation loss decreased (-0.065850 --> -0.078791).  Saving model ...
Epoch: 4 cost time: 1.0807874202728271
Epoch: 4, Steps: 10 | Train Loss: 2.818 Vali Loss: 3.248 Vali Acc: 0.087 Test Loss: 3.248 Test Acc: 0.087
Validation loss decreased (-0.078791 --> -0.087026).  Saving model ...
Epoch: 5 cost time: 1.0299568176269531
Epoch: 5, Steps: 10 | Train Loss: 2.613 Vali Loss: 3.238 Vali Acc: 0.112 Test Loss: 3.238 Test Acc: 0.112
Validation loss decreased (-0.087026 --> -0.111732).  Saving model ...
Epoch: 6 cost time: 0.9207949638366699
Epoch: 6, Steps: 10 | Train Loss: 2.431 Vali Loss: 3.222 Vali Acc: 0.121 Test Loss: 3.222 Test Acc: 0.121
Validation loss decreased (-0.111732 --> -0.121144).  Saving model ...
Epoch: 7 cost time: 0.9087541103363037
Epoch: 7, Steps: 10 | Train Loss: 2.186 Vali Loss: 3.191 Vali Acc: 0.144 Test Loss: 3.191 Test Acc: 0.144
Validation loss decreased (-0.121144 --> -0.143498).  Saving model ...
Epoch: 8 cost time: 0.9220669269561768
Epoch: 8, Steps: 10 | Train Loss: 1.922 Vali Loss: 3.167 Vali Acc: 0.166 Test Loss: 3.167 Test Acc: 0.166
Validation loss decreased (-0.143498 --> -0.165851).  Saving model ...
Epoch: 9 cost time: 0.968801736831665
Epoch: 9, Steps: 10 | Train Loss: 1.622 Vali Loss: 3.162 Vali Acc: 0.196 Test Loss: 3.162 Test Acc: 0.196
Validation loss decreased (-0.165851 --> -0.196439).  Saving model ...
Epoch: 10 cost time: 1.0484416484832764
Epoch: 10, Steps: 10 | Train Loss: 1.369 Vali Loss: 3.171 Vali Acc: 0.200 Test Loss: 3.171 Test Acc: 0.200
Validation loss decreased (-0.196439 --> -0.199968).  Saving model ...
Epoch: 11 cost time: 0.9836235046386719
Epoch: 11, Steps: 10 | Train Loss: 1.080 Vali Loss: 3.193 Vali Acc: 0.218 Test Loss: 3.193 Test Acc: 0.218
Validation loss decreased (-0.199968 --> -0.217615).  Saving model ...
Epoch: 12 cost time: 0.9723737239837646
Epoch: 12, Steps: 10 | Train Loss: 0.855 Vali Loss: 3.240 Vali Acc: 0.229 Test Loss: 3.240 Test Acc: 0.229
Validation loss decreased (-0.217615 --> -0.229379).  Saving model ...
Epoch: 13 cost time: 0.9554574489593506
Epoch: 13, Steps: 10 | Train Loss: 0.618 Vali Loss: 3.310 Vali Acc: 0.244 Test Loss: 3.310 Test Acc: 0.244
Validation loss decreased (-0.229379 --> -0.243496).  Saving model ...
Epoch: 14 cost time: 1.0473058223724365
Epoch: 14, Steps: 10 | Train Loss: 0.437 Vali Loss: 3.368 Vali Acc: 0.253 Test Loss: 3.368 Test Acc: 0.253
Validation loss decreased (-0.243496 --> -0.252908).  Saving model ...
Epoch: 15 cost time: 0.9499361515045166
Epoch: 15, Steps: 10 | Train Loss: 0.296 Vali Loss: 3.471 Vali Acc: 0.259 Test Loss: 3.471 Test Acc: 0.259
Validation loss decreased (-0.252908 --> -0.258789).  Saving model ...
Epoch: 16 cost time: 0.8555574417114258
Epoch: 16, Steps: 10 | Train Loss: 0.221 Vali Loss: 3.593 Vali Acc: 0.254 Test Loss: 3.593 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9166762828826904
Epoch: 17, Steps: 10 | Train Loss: 0.143 Vali Loss: 3.670 Vali Acc: 0.258 Test Loss: 3.670 Test Acc: 0.258
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0228841304779053
Epoch: 18, Steps: 10 | Train Loss: 0.098 Vali Loss: 3.737 Vali Acc: 0.274 Test Loss: 3.737 Test Acc: 0.274
Validation loss decreased (-0.258789 --> -0.274080).  Saving model ...
Epoch: 19 cost time: 1.0319371223449707
Epoch: 19, Steps: 10 | Train Loss: 0.067 Vali Loss: 3.779 Vali Acc: 0.279 Test Loss: 3.779 Test Acc: 0.279
Validation loss decreased (-0.274080 --> -0.278786).  Saving model ...
Epoch: 20 cost time: 1.0967259407043457
Epoch: 20, Steps: 10 | Train Loss: 0.059 Vali Loss: 3.840 Vali Acc: 0.274 Test Loss: 3.840 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0061283111572266
Epoch: 21, Steps: 10 | Train Loss: 0.046 Vali Loss: 3.919 Vali Acc: 0.268 Test Loss: 3.919 Test Acc: 0.268
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.9911007881164551
Epoch: 22, Steps: 10 | Train Loss: 0.037 Vali Loss: 3.972 Vali Acc: 0.269 Test Loss: 3.972 Test Acc: 0.269
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.000840187072754
Epoch: 23, Steps: 10 | Train Loss: 0.031 Vali Loss: 3.998 Vali Acc: 0.279 Test Loss: 3.998 Test Acc: 0.279
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.0128319263458252
Epoch: 24, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.037 Vali Acc: 0.286 Test Loss: 4.037 Test Acc: 0.286
Validation loss decreased (-0.278786 --> -0.285842).  Saving model ...
Epoch: 25 cost time: 0.9864661693572998
Epoch: 25, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.082 Vali Acc: 0.280 Test Loss: 4.082 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.945831298828125
Epoch: 26, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.116 Vali Acc: 0.285 Test Loss: 4.116 Test Acc: 0.285
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.0631911754608154
Epoch: 27, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.146 Vali Acc: 0.280 Test Loss: 4.146 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.0611391067504883
Epoch: 28, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.178 Vali Acc: 0.278 Test Loss: 4.178 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.0320768356323242
Epoch: 29, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.217 Vali Acc: 0.285 Test Loss: 4.217 Test Acc: 0.285
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.9644176959991455
Epoch: 30, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.242 Vali Acc: 0.284 Test Loss: 4.242 Test Acc: 0.284
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.980405330657959
Epoch: 31, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.248 Vali Acc: 0.286 Test Loss: 4.248 Test Acc: 0.286
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.069530963897705
Epoch: 32, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.271 Vali Acc: 0.282 Test Loss: 4.271 Test Acc: 0.282
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.9869511127471924
Epoch: 33, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.298 Vali Acc: 0.291 Test Loss: 4.298 Test Acc: 0.291
Validation loss decreased (-0.285842 --> -0.290545).  Saving model ...
Epoch: 34 cost time: 0.9312183856964111
Epoch: 34, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.321 Vali Acc: 0.293 Test Loss: 4.321 Test Acc: 0.293
Validation loss decreased (-0.290545 --> -0.292898).  Saving model ...
Epoch: 35 cost time: 0.9916892051696777
Epoch: 35, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.338 Vali Acc: 0.291 Test Loss: 4.338 Test Acc: 0.291
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.1477153301239014
Epoch: 36, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.373 Vali Acc: 0.289 Test Loss: 4.373 Test Acc: 0.289
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.0422887802124023
Epoch: 37, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.390 Vali Acc: 0.288 Test Loss: 4.390 Test Acc: 0.288
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.047456979751587
Epoch: 38, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.424 Vali Acc: 0.286 Test Loss: 4.424 Test Acc: 0.286
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.9671783447265625
Epoch: 39, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.436 Vali Acc: 0.285 Test Loss: 4.436 Test Acc: 0.285
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.1140615940093994
Epoch: 40, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.464 Vali Acc: 0.287 Test Loss: 4.464 Test Acc: 0.287
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.0418243408203125
Epoch: 41, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.487 Vali Acc: 0.285 Test Loss: 4.487 Test Acc: 0.285
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.003119707107544
Epoch: 42, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.514 Vali Acc: 0.285 Test Loss: 4.514 Test Acc: 0.285
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.9356420040130615
Epoch: 43, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.516 Vali Acc: 0.286 Test Loss: 4.516 Test Acc: 0.286
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 1.0582096576690674
Epoch: 44, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.525 Vali Acc: 0.285 Test Loss: 4.525 Test Acc: 0.285
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.29294117647058826
model parameter : 699418
model size : 2.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps38_str19_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.3459339141845703
Epoch: 1, Steps: 10 | Train Loss: 3.259 Vali Loss: 3.276 Vali Acc: 0.034 Test Loss: 3.276 Test Acc: 0.034
Validation loss decreased (inf --> -0.034085).  Saving model ...
Epoch: 2 cost time: 1.0374431610107422
Epoch: 2, Steps: 10 | Train Loss: 3.193 Vali Loss: 3.266 Vali Acc: 0.044 Test Loss: 3.266 Test Acc: 0.044
Validation loss decreased (-0.034085 --> -0.043497).  Saving model ...
Epoch: 3 cost time: 1.0721826553344727
Epoch: 3, Steps: 10 | Train Loss: 3.049 Vali Loss: 3.258 Vali Acc: 0.064 Test Loss: 3.258 Test Acc: 0.064
Validation loss decreased (-0.043497 --> -0.063497).  Saving model ...
Epoch: 4 cost time: 0.9033637046813965
Epoch: 4, Steps: 10 | Train Loss: 2.859 Vali Loss: 3.249 Vali Acc: 0.080 Test Loss: 3.249 Test Acc: 0.080
Validation loss decreased (-0.063497 --> -0.079968).  Saving model ...
Epoch: 5 cost time: 0.9475796222686768
Epoch: 5, Steps: 10 | Train Loss: 2.667 Vali Loss: 3.242 Vali Acc: 0.101 Test Loss: 3.242 Test Acc: 0.101
Validation loss decreased (-0.079968 --> -0.101144).  Saving model ...
Epoch: 6 cost time: 0.9257183074951172
Epoch: 6, Steps: 10 | Train Loss: 2.487 Vali Loss: 3.235 Vali Acc: 0.115 Test Loss: 3.235 Test Acc: 0.115
Validation loss decreased (-0.101144 --> -0.115262).  Saving model ...
Epoch: 7 cost time: 0.8588495254516602
Epoch: 7, Steps: 10 | Train Loss: 2.277 Vali Loss: 3.215 Vali Acc: 0.127 Test Loss: 3.215 Test Acc: 0.127
Validation loss decreased (-0.115262 --> -0.127027).  Saving model ...
Epoch: 8 cost time: 0.9774320125579834
Epoch: 8, Steps: 10 | Train Loss: 2.025 Vali Loss: 3.193 Vali Acc: 0.164 Test Loss: 3.193 Test Acc: 0.164
Validation loss decreased (-0.127027 --> -0.163497).  Saving model ...
Epoch: 9 cost time: 0.9533529281616211
Epoch: 9, Steps: 10 | Train Loss: 1.770 Vali Loss: 3.181 Vali Acc: 0.175 Test Loss: 3.181 Test Acc: 0.175
Validation loss decreased (-0.163497 --> -0.175262).  Saving model ...
Epoch: 10 cost time: 1.0370292663574219
Epoch: 10, Steps: 10 | Train Loss: 1.499 Vali Loss: 3.187 Vali Acc: 0.192 Test Loss: 3.187 Test Acc: 0.192
Validation loss decreased (-0.175262 --> -0.191733).  Saving model ...
Epoch: 11 cost time: 1.0373687744140625
Epoch: 11, Steps: 10 | Train Loss: 1.272 Vali Loss: 3.225 Vali Acc: 0.192 Test Loss: 3.225 Test Acc: 0.192
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.981670618057251
Epoch: 12, Steps: 10 | Train Loss: 1.033 Vali Loss: 3.254 Vali Acc: 0.209 Test Loss: 3.254 Test Acc: 0.209
Validation loss decreased (-0.191733 --> -0.209379).  Saving model ...
Epoch: 13 cost time: 0.9758081436157227
Epoch: 13, Steps: 10 | Train Loss: 0.796 Vali Loss: 3.281 Vali Acc: 0.224 Test Loss: 3.281 Test Acc: 0.224
Validation loss decreased (-0.209379 --> -0.223497).  Saving model ...
Epoch: 14 cost time: 1.0730879306793213
Epoch: 14, Steps: 10 | Train Loss: 0.590 Vali Loss: 3.342 Vali Acc: 0.235 Test Loss: 3.342 Test Acc: 0.235
Validation loss decreased (-0.223497 --> -0.235261).  Saving model ...
Epoch: 15 cost time: 0.9367616176605225
Epoch: 15, Steps: 10 | Train Loss: 0.449 Vali Loss: 3.424 Vali Acc: 0.245 Test Loss: 3.424 Test Acc: 0.245
Validation loss decreased (-0.235261 --> -0.244672).  Saving model ...
Epoch: 16 cost time: 1.0859026908874512
Epoch: 16, Steps: 10 | Train Loss: 0.317 Vali Loss: 3.520 Vali Acc: 0.251 Test Loss: 3.520 Test Acc: 0.251
Validation loss decreased (-0.244672 --> -0.250553).  Saving model ...
Epoch: 17 cost time: 0.9945721626281738
Epoch: 17, Steps: 10 | Train Loss: 0.233 Vali Loss: 3.598 Vali Acc: 0.256 Test Loss: 3.598 Test Acc: 0.256
Validation loss decreased (-0.250553 --> -0.256435).  Saving model ...
Epoch: 18 cost time: 1.1443567276000977
Epoch: 18, Steps: 10 | Train Loss: 0.154 Vali Loss: 3.654 Vali Acc: 0.264 Test Loss: 3.654 Test Acc: 0.264
Validation loss decreased (-0.256435 --> -0.263493).  Saving model ...
Epoch: 19 cost time: 1.0557806491851807
Epoch: 19, Steps: 10 | Train Loss: 0.116 Vali Loss: 3.730 Vali Acc: 0.264 Test Loss: 3.730 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.022477149963379
Epoch: 20, Steps: 10 | Train Loss: 0.088 Vali Loss: 3.799 Vali Acc: 0.264 Test Loss: 3.799 Test Acc: 0.264
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.9653468132019043
Epoch: 21, Steps: 10 | Train Loss: 0.065 Vali Loss: 3.849 Vali Acc: 0.267 Test Loss: 3.849 Test Acc: 0.267
Validation loss decreased (-0.263493 --> -0.267020).  Saving model ...
Epoch: 22 cost time: 0.9425153732299805
Epoch: 22, Steps: 10 | Train Loss: 0.056 Vali Loss: 3.909 Vali Acc: 0.265 Test Loss: 3.909 Test Acc: 0.265
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0092191696166992
Epoch: 23, Steps: 10 | Train Loss: 0.046 Vali Loss: 3.967 Vali Acc: 0.265 Test Loss: 3.967 Test Acc: 0.265
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.0936915874481201
Epoch: 24, Steps: 10 | Train Loss: 0.042 Vali Loss: 4.037 Vali Acc: 0.275 Test Loss: 4.037 Test Acc: 0.275
Validation loss decreased (-0.267020 --> -0.275254).  Saving model ...
Epoch: 25 cost time: 0.9649689197540283
Epoch: 25, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.062 Vali Acc: 0.273 Test Loss: 4.062 Test Acc: 0.273
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.988090991973877
Epoch: 26, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.094 Vali Acc: 0.276 Test Loss: 4.094 Test Acc: 0.276
Validation loss decreased (-0.275254 --> -0.276430).  Saving model ...
Epoch: 27 cost time: 1.156425952911377
Epoch: 27, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.138 Vali Acc: 0.275 Test Loss: 4.138 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0229544639587402
Epoch: 28, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.158 Vali Acc: 0.276 Test Loss: 4.158 Test Acc: 0.276
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.9708156585693359
Epoch: 29, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.187 Vali Acc: 0.279 Test Loss: 4.187 Test Acc: 0.279
Validation loss decreased (-0.276430 --> -0.278782).  Saving model ...
Epoch: 30 cost time: 0.9604928493499756
Epoch: 30, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.251 Vali Acc: 0.275 Test Loss: 4.251 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.045919418334961
Epoch: 31, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.280 Vali Acc: 0.274 Test Loss: 4.280 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.023315668106079
Epoch: 32, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.307 Vali Acc: 0.278 Test Loss: 4.307 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.9652700424194336
Epoch: 33, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.320 Vali Acc: 0.282 Test Loss: 4.320 Test Acc: 0.282
Validation loss decreased (-0.278782 --> -0.282310).  Saving model ...
Epoch: 34 cost time: 0.9395885467529297
Epoch: 34, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.354 Vali Acc: 0.278 Test Loss: 4.354 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.0241765975952148
Epoch: 35, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.375 Vali Acc: 0.280 Test Loss: 4.375 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.0660614967346191
Epoch: 36, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.401 Vali Acc: 0.282 Test Loss: 4.401 Test Acc: 0.282
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.0403594970703125
Epoch: 37, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.428 Vali Acc: 0.280 Test Loss: 4.428 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.9525525569915771
Epoch: 38, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.446 Vali Acc: 0.279 Test Loss: 4.446 Test Acc: 0.279
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.9235506057739258
Epoch: 39, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.459 Vali Acc: 0.281 Test Loss: 4.459 Test Acc: 0.281
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.9815664291381836
Epoch: 40, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.481 Vali Acc: 0.282 Test Loss: 4.481 Test Acc: 0.282
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.038642168045044
Epoch: 41, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.500 Vali Acc: 0.281 Test Loss: 4.500 Test Acc: 0.281
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.9776721000671387
Epoch: 42, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.521 Vali Acc: 0.282 Test Loss: 4.521 Test Acc: 0.282
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.9708325862884521
Epoch: 43, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.533 Vali Acc: 0.282 Test Loss: 4.533 Test Acc: 0.282
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps38_str19_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2823529411764706
model parameter : 680346
model size : 2.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.5446832180023193
Epoch: 1, Steps: 10 | Train Loss: 3.281 Vali Loss: 3.257 Vali Acc: 0.045 Test Loss: 3.257 Test Acc: 0.045
Validation loss decreased (inf --> -0.044673).  Saving model ...
Epoch: 2 cost time: 0.9321463108062744
Epoch: 2, Steps: 10 | Train Loss: 3.058 Vali Loss: 3.272 Vali Acc: 0.052 Test Loss: 3.272 Test Acc: 0.052
Validation loss decreased (-0.044673 --> -0.051732).  Saving model ...
Epoch: 3 cost time: 0.858912467956543
Epoch: 3, Steps: 10 | Train Loss: 2.724 Vali Loss: 3.298 Vali Acc: 0.071 Test Loss: 3.298 Test Acc: 0.071
Validation loss decreased (-0.051732 --> -0.070555).  Saving model ...
Epoch: 4 cost time: 0.8894448280334473
Epoch: 4, Steps: 10 | Train Loss: 2.328 Vali Loss: 3.189 Vali Acc: 0.114 Test Loss: 3.189 Test Acc: 0.114
Validation loss decreased (-0.070555 --> -0.114086).  Saving model ...
Epoch: 5 cost time: 0.9417812824249268
Epoch: 5, Steps: 10 | Train Loss: 1.826 Vali Loss: 3.143 Vali Acc: 0.158 Test Loss: 3.143 Test Acc: 0.158
Validation loss decreased (-0.114086 --> -0.157616).  Saving model ...
Epoch: 6 cost time: 0.9897618293762207
Epoch: 6, Steps: 10 | Train Loss: 1.253 Vali Loss: 3.219 Vali Acc: 0.185 Test Loss: 3.219 Test Acc: 0.185
Validation loss decreased (-0.157616 --> -0.184674).  Saving model ...
Epoch: 7 cost time: 0.9182264804840088
Epoch: 7, Steps: 10 | Train Loss: 0.743 Vali Loss: 3.320 Vali Acc: 0.221 Test Loss: 3.320 Test Acc: 0.221
Validation loss decreased (-0.184674 --> -0.221143).  Saving model ...
Epoch: 8 cost time: 0.8653624057769775
Epoch: 8, Steps: 10 | Train Loss: 0.369 Vali Loss: 3.565 Vali Acc: 0.231 Test Loss: 3.565 Test Acc: 0.231
Validation loss decreased (-0.221143 --> -0.230553).  Saving model ...
Epoch: 9 cost time: 0.7935657501220703
Epoch: 9, Steps: 10 | Train Loss: 0.206 Vali Loss: 3.841 Vali Acc: 0.261 Test Loss: 3.841 Test Acc: 0.261
Validation loss decreased (-0.230553 --> -0.261138).  Saving model ...
Epoch: 10 cost time: 0.9878747463226318
Epoch: 10, Steps: 10 | Train Loss: 0.069 Vali Loss: 4.161 Vali Acc: 0.239 Test Loss: 4.161 Test Acc: 0.239
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9226360321044922
Epoch: 11, Steps: 10 | Train Loss: 0.041 Vali Loss: 4.268 Vali Acc: 0.256 Test Loss: 4.268 Test Acc: 0.256
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8588385581970215
Epoch: 12, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.363 Vali Acc: 0.265 Test Loss: 4.363 Test Acc: 0.265
Validation loss decreased (-0.261138 --> -0.264662).  Saving model ...
Epoch: 13 cost time: 0.8883056640625
Epoch: 13, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.613 Vali Acc: 0.249 Test Loss: 4.613 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9943728446960449
Epoch: 14, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.647 Vali Acc: 0.249 Test Loss: 4.647 Test Acc: 0.249
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0042295455932617
Epoch: 15, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.618 Vali Acc: 0.265 Test Loss: 4.618 Test Acc: 0.265
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.8692281246185303
Epoch: 16, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.641 Vali Acc: 0.264 Test Loss: 4.641 Test Acc: 0.264
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.9276983737945557
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.705 Vali Acc: 0.261 Test Loss: 4.705 Test Acc: 0.261
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.9227149486541748
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.756 Vali Acc: 0.259 Test Loss: 4.756 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.9476151466369629
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.779 Vali Acc: 0.260 Test Loss: 4.779 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.885068416595459
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.796 Vali Acc: 0.262 Test Loss: 4.796 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.8319838047027588
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.831 Vali Acc: 0.265 Test Loss: 4.831 Test Acc: 0.265
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.8283030986785889
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.862 Vali Acc: 0.264 Test Loss: 4.862 Test Acc: 0.264
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2647058823529412
model parameter : 538202
model size : 2.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.4761035442352295
Epoch: 1, Steps: 10 | Train Loss: 3.302 Vali Loss: 3.269 Vali Acc: 0.036 Test Loss: 3.269 Test Acc: 0.036
Validation loss decreased (inf --> -0.036438).  Saving model ...
Epoch: 2 cost time: 0.8503692150115967
Epoch: 2, Steps: 10 | Train Loss: 3.152 Vali Loss: 3.258 Vali Acc: 0.055 Test Loss: 3.258 Test Acc: 0.055
Validation loss decreased (-0.036438 --> -0.055262).  Saving model ...
Epoch: 3 cost time: 0.8142681121826172
Epoch: 3, Steps: 10 | Train Loss: 2.941 Vali Loss: 3.270 Vali Acc: 0.073 Test Loss: 3.270 Test Acc: 0.073
Validation loss decreased (-0.055262 --> -0.072908).  Saving model ...
Epoch: 4 cost time: 0.8660435676574707
Epoch: 4, Steps: 10 | Train Loss: 2.697 Vali Loss: 3.258 Vali Acc: 0.101 Test Loss: 3.258 Test Acc: 0.101
Validation loss decreased (-0.072908 --> -0.101144).  Saving model ...
Epoch: 5 cost time: 0.9765603542327881
Epoch: 5, Steps: 10 | Train Loss: 2.424 Vali Loss: 3.221 Vali Acc: 0.133 Test Loss: 3.221 Test Acc: 0.133
Validation loss decreased (-0.101144 --> -0.132909).  Saving model ...
Epoch: 6 cost time: 0.9628167152404785
Epoch: 6, Steps: 10 | Train Loss: 2.084 Vali Loss: 3.178 Vali Acc: 0.155 Test Loss: 3.178 Test Acc: 0.155
Validation loss decreased (-0.132909 --> -0.155262).  Saving model ...
Epoch: 7 cost time: 0.8295156955718994
Epoch: 7, Steps: 10 | Train Loss: 1.696 Vali Loss: 3.178 Vali Acc: 0.165 Test Loss: 3.178 Test Acc: 0.165
Validation loss decreased (-0.155262 --> -0.164674).  Saving model ...
Epoch: 8 cost time: 0.9629645347595215
Epoch: 8, Steps: 10 | Train Loss: 1.302 Vali Loss: 3.214 Vali Acc: 0.186 Test Loss: 3.214 Test Acc: 0.186
Validation loss decreased (-0.164674 --> -0.185850).  Saving model ...
Epoch: 9 cost time: 0.9677233695983887
Epoch: 9, Steps: 10 | Train Loss: 0.903 Vali Loss: 3.270 Vali Acc: 0.222 Test Loss: 3.270 Test Acc: 0.222
Validation loss decreased (-0.185850 --> -0.222320).  Saving model ...
Epoch: 10 cost time: 0.9035172462463379
Epoch: 10, Steps: 10 | Train Loss: 0.612 Vali Loss: 3.393 Vali Acc: 0.235 Test Loss: 3.393 Test Acc: 0.235
Validation loss decreased (-0.222320 --> -0.235260).  Saving model ...
Epoch: 11 cost time: 0.9047412872314453
Epoch: 11, Steps: 10 | Train Loss: 0.382 Vali Loss: 3.573 Vali Acc: 0.239 Test Loss: 3.573 Test Acc: 0.239
Validation loss decreased (-0.235260 --> -0.238788).  Saving model ...
Epoch: 12 cost time: 0.9817535877227783
Epoch: 12, Steps: 10 | Train Loss: 0.218 Vali Loss: 3.750 Vali Acc: 0.254 Test Loss: 3.750 Test Acc: 0.254
Validation loss decreased (-0.238788 --> -0.254080).  Saving model ...
Epoch: 13 cost time: 1.0037775039672852
Epoch: 13, Steps: 10 | Train Loss: 0.149 Vali Loss: 3.878 Vali Acc: 0.266 Test Loss: 3.878 Test Acc: 0.266
Validation loss decreased (-0.254080 --> -0.265844).  Saving model ...
Epoch: 14 cost time: 0.9239912033081055
Epoch: 14, Steps: 10 | Train Loss: 0.066 Vali Loss: 4.097 Vali Acc: 0.254 Test Loss: 4.097 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8888883590698242
Epoch: 15, Steps: 10 | Train Loss: 0.046 Vali Loss: 4.224 Vali Acc: 0.255 Test Loss: 4.224 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8642113208770752
Epoch: 16, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.262 Vali Acc: 0.271 Test Loss: 4.262 Test Acc: 0.271
Validation loss decreased (-0.265844 --> -0.270546).  Saving model ...
Epoch: 17 cost time: 0.9496359825134277
Epoch: 17, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.362 Vali Acc: 0.261 Test Loss: 4.362 Test Acc: 0.261
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.969080924987793
Epoch: 18, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.438 Vali Acc: 0.259 Test Loss: 4.438 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9436006546020508
Epoch: 19, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.484 Vali Acc: 0.268 Test Loss: 4.484 Test Acc: 0.268
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.8599956035614014
Epoch: 20, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.542 Vali Acc: 0.273 Test Loss: 4.542 Test Acc: 0.273
Validation loss decreased (-0.270546 --> -0.272896).  Saving model ...
Epoch: 21 cost time: 0.8111169338226318
Epoch: 21, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.612 Vali Acc: 0.264 Test Loss: 4.612 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.894503116607666
Epoch: 22, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.653 Vali Acc: 0.267 Test Loss: 4.653 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.9574730396270752
Epoch: 23, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.680 Vali Acc: 0.267 Test Loss: 4.680 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.882321834564209
Epoch: 24, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.725 Vali Acc: 0.269 Test Loss: 4.725 Test Acc: 0.269
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.9262635707855225
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.778 Vali Acc: 0.274 Test Loss: 4.778 Test Acc: 0.274
Validation loss decreased (-0.272896 --> -0.274070).  Saving model ...
Epoch: 26 cost time: 0.832301139831543
Epoch: 26, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.807 Vali Acc: 0.272 Test Loss: 4.807 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.909466028213501
Epoch: 27, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.841 Vali Acc: 0.272 Test Loss: 4.841 Test Acc: 0.272
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.9516026973724365
Epoch: 28, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.852 Vali Acc: 0.275 Test Loss: 4.852 Test Acc: 0.275
Validation loss decreased (-0.274070 --> -0.275246).  Saving model ...
Epoch: 29 cost time: 0.8195149898529053
Epoch: 29, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.882 Vali Acc: 0.280 Test Loss: 4.882 Test Acc: 0.280
Validation loss decreased (-0.275246 --> -0.279951).  Saving model ...
Epoch: 30 cost time: 0.7888894081115723
Epoch: 30, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.918 Vali Acc: 0.280 Test Loss: 4.918 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.9591054916381836
Epoch: 31, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.948 Vali Acc: 0.278 Test Loss: 4.948 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.9509143829345703
Epoch: 32, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.970 Vali Acc: 0.279 Test Loss: 4.970 Test Acc: 0.279
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.9220283031463623
Epoch: 33, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.992 Vali Acc: 0.279 Test Loss: 4.992 Test Acc: 0.279
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.9256622791290283
Epoch: 34, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.021 Vali Acc: 0.278 Test Loss: 5.021 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.8917770385742188
Epoch: 35, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.033 Vali Acc: 0.275 Test Loss: 5.033 Test Acc: 0.275
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.8503515720367432
Epoch: 36, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.066 Vali Acc: 0.279 Test Loss: 5.066 Test Acc: 0.279
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.8912715911865234
Epoch: 37, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.090 Vali Acc: 0.279 Test Loss: 5.090 Test Acc: 0.279
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.7985186576843262
Epoch: 38, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.106 Vali Acc: 0.280 Test Loss: 5.106 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.865734338760376
Epoch: 39, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.134 Vali Acc: 0.284 Test Loss: 5.134 Test Acc: 0.284
Validation loss decreased (-0.279951 --> -0.283478).  Saving model ...
Epoch: 40 cost time: 0.9141442775726318
Epoch: 40, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.155 Vali Acc: 0.282 Test Loss: 5.155 Test Acc: 0.282
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.8905630111694336
Epoch: 41, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.179 Vali Acc: 0.281 Test Loss: 5.179 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.9594931602478027
Epoch: 42, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.201 Vali Acc: 0.281 Test Loss: 5.201 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.8935515880584717
Epoch: 43, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.205 Vali Acc: 0.282 Test Loss: 5.205 Test Acc: 0.282
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.8988890647888184
Epoch: 44, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.232 Vali Acc: 0.282 Test Loss: 5.232 Test Acc: 0.282
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.8563685417175293
Epoch: 45, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.252 Vali Acc: 0.281 Test Loss: 5.252 Test Acc: 0.281
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.9639892578125
Epoch: 46, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.270 Vali Acc: 0.278 Test Loss: 5.270 Test Acc: 0.278
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.9323287010192871
Epoch: 47, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.295 Vali Acc: 0.279 Test Loss: 5.295 Test Acc: 0.279
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 0.9704997539520264
Epoch: 48, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.316 Vali Acc: 0.280 Test Loss: 5.316 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 0.908597469329834
Epoch: 49, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.333 Vali Acc: 0.282 Test Loss: 5.333 Test Acc: 0.282
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.28352941176470586
model parameter : 348762
model size : 1.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps12_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.555631637573242
Epoch: 1, Steps: 10 | Train Loss: 3.258 Vali Loss: 3.254 Vali Acc: 0.039 Test Loss: 3.254 Test Acc: 0.039
Validation loss decreased (inf --> -0.038791).  Saving model ...
Epoch: 2 cost time: 0.99180006980896
Epoch: 2, Steps: 10 | Train Loss: 3.173 Vali Loss: 3.240 Vali Acc: 0.065 Test Loss: 3.240 Test Acc: 0.065
Validation loss decreased (-0.038791 --> -0.064673).  Saving model ...
Epoch: 3 cost time: 0.9016633033752441
Epoch: 3, Steps: 10 | Train Loss: 2.996 Vali Loss: 3.235 Vali Acc: 0.089 Test Loss: 3.235 Test Acc: 0.089
Validation loss decreased (-0.064673 --> -0.089379).  Saving model ...
Epoch: 4 cost time: 0.8824930191040039
Epoch: 4, Steps: 10 | Train Loss: 2.791 Vali Loss: 3.238 Vali Acc: 0.098 Test Loss: 3.238 Test Acc: 0.098
Validation loss decreased (-0.089379 --> -0.097615).  Saving model ...
Epoch: 5 cost time: 1.0955700874328613
Epoch: 5, Steps: 10 | Train Loss: 2.593 Vali Loss: 3.228 Vali Acc: 0.105 Test Loss: 3.228 Test Acc: 0.105
Validation loss decreased (-0.097615 --> -0.104674).  Saving model ...
Epoch: 6 cost time: 0.9634499549865723
Epoch: 6, Steps: 10 | Train Loss: 2.342 Vali Loss: 3.212 Vali Acc: 0.128 Test Loss: 3.212 Test Acc: 0.128
Validation loss decreased (-0.104674 --> -0.128203).  Saving model ...
Epoch: 7 cost time: 1.0734353065490723
Epoch: 7, Steps: 10 | Train Loss: 2.070 Vali Loss: 3.184 Vali Acc: 0.148 Test Loss: 3.184 Test Acc: 0.148
Validation loss decreased (-0.128203 --> -0.148203).  Saving model ...
Epoch: 8 cost time: 1.0545017719268799
Epoch: 8, Steps: 10 | Train Loss: 1.790 Vali Loss: 3.167 Vali Acc: 0.172 Test Loss: 3.167 Test Acc: 0.172
Validation loss decreased (-0.148203 --> -0.171733).  Saving model ...
Epoch: 9 cost time: 0.9254403114318848
Epoch: 9, Steps: 10 | Train Loss: 1.447 Vali Loss: 3.168 Vali Acc: 0.207 Test Loss: 3.168 Test Acc: 0.207
Validation loss decreased (-0.171733 --> -0.207027).  Saving model ...
Epoch: 10 cost time: 1.0060415267944336
Epoch: 10, Steps: 10 | Train Loss: 1.127 Vali Loss: 3.227 Vali Acc: 0.198 Test Loss: 3.227 Test Acc: 0.198
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0119163990020752
Epoch: 11, Steps: 10 | Train Loss: 0.820 Vali Loss: 3.284 Vali Acc: 0.222 Test Loss: 3.284 Test Acc: 0.222
Validation loss decreased (-0.207027 --> -0.222320).  Saving model ...
Epoch: 12 cost time: 1.0674123764038086
Epoch: 12, Steps: 10 | Train Loss: 0.593 Vali Loss: 3.378 Vali Acc: 0.235 Test Loss: 3.378 Test Acc: 0.235
Validation loss decreased (-0.222320 --> -0.235260).  Saving model ...
Epoch: 13 cost time: 0.9192728996276855
Epoch: 13, Steps: 10 | Train Loss: 0.377 Vali Loss: 3.495 Vali Acc: 0.239 Test Loss: 3.495 Test Acc: 0.239
Validation loss decreased (-0.235260 --> -0.238789).  Saving model ...
Epoch: 14 cost time: 0.9419612884521484
Epoch: 14, Steps: 10 | Train Loss: 0.244 Vali Loss: 3.623 Vali Acc: 0.251 Test Loss: 3.623 Test Acc: 0.251
Validation loss decreased (-0.238789 --> -0.250552).  Saving model ...
Epoch: 15 cost time: 0.8746418952941895
Epoch: 15, Steps: 10 | Train Loss: 0.161 Vali Loss: 3.768 Vali Acc: 0.258 Test Loss: 3.768 Test Acc: 0.258
Validation loss decreased (-0.250552 --> -0.257609).  Saving model ...
Epoch: 16 cost time: 0.9442915916442871
Epoch: 16, Steps: 10 | Train Loss: 0.112 Vali Loss: 3.888 Vali Acc: 0.256 Test Loss: 3.888 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8885965347290039
Epoch: 17, Steps: 10 | Train Loss: 0.073 Vali Loss: 3.992 Vali Acc: 0.260 Test Loss: 3.992 Test Acc: 0.260
Validation loss decreased (-0.257609 --> -0.259960).  Saving model ...
Epoch: 18 cost time: 0.9355902671813965
Epoch: 18, Steps: 10 | Train Loss: 0.051 Vali Loss: 4.069 Vali Acc: 0.261 Test Loss: 4.069 Test Acc: 0.261
Validation loss decreased (-0.259960 --> -0.261136).  Saving model ...
Epoch: 19 cost time: 1.0807042121887207
Epoch: 19, Steps: 10 | Train Loss: 0.039 Vali Loss: 4.118 Vali Acc: 0.260 Test Loss: 4.118 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9335877895355225
Epoch: 20, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.174 Vali Acc: 0.259 Test Loss: 4.174 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.8793220520019531
Epoch: 21, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.239 Vali Acc: 0.255 Test Loss: 4.239 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.9523839950561523
Epoch: 22, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.308 Vali Acc: 0.264 Test Loss: 4.308 Test Acc: 0.264
Validation loss decreased (-0.261136 --> -0.263486).  Saving model ...
Epoch: 23 cost time: 0.8626699447631836
Epoch: 23, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.333 Vali Acc: 0.268 Test Loss: 4.333 Test Acc: 0.268
Validation loss decreased (-0.263486 --> -0.268192).  Saving model ...
Epoch: 24 cost time: 0.9755897521972656
Epoch: 24, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.356 Vali Acc: 0.267 Test Loss: 4.356 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9309053421020508
Epoch: 25, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.389 Vali Acc: 0.269 Test Loss: 4.389 Test Acc: 0.269
Validation loss decreased (-0.268192 --> -0.269368).  Saving model ...
Epoch: 26 cost time: 0.8808362483978271
Epoch: 26, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.429 Vali Acc: 0.267 Test Loss: 4.429 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8424251079559326
Epoch: 27, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.471 Vali Acc: 0.268 Test Loss: 4.471 Test Acc: 0.268
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.9165093898773193
Epoch: 28, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.509 Vali Acc: 0.268 Test Loss: 4.509 Test Acc: 0.268
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.9250156879425049
Epoch: 29, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.548 Vali Acc: 0.269 Test Loss: 4.548 Test Acc: 0.269
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.8267114162445068
Epoch: 30, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.579 Vali Acc: 0.267 Test Loss: 4.579 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.9494447708129883
Epoch: 31, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.610 Vali Acc: 0.271 Test Loss: 4.610 Test Acc: 0.271
Validation loss decreased (-0.269368 --> -0.270542).  Saving model ...
Epoch: 32 cost time: 0.8681313991546631
Epoch: 32, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.634 Vali Acc: 0.272 Test Loss: 4.634 Test Acc: 0.272
Validation loss decreased (-0.270542 --> -0.271718).  Saving model ...
Epoch: 33 cost time: 0.965632438659668
Epoch: 33, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.671 Vali Acc: 0.267 Test Loss: 4.671 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.9085836410522461
Epoch: 34, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.694 Vali Acc: 0.264 Test Loss: 4.694 Test Acc: 0.264
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.9201011657714844
Epoch: 35, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.722 Vali Acc: 0.267 Test Loss: 4.722 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.9278557300567627
Epoch: 36, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.742 Vali Acc: 0.267 Test Loss: 4.742 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.8362078666687012
Epoch: 37, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.774 Vali Acc: 0.266 Test Loss: 4.774 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.9716236591339111
Epoch: 38, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.786 Vali Acc: 0.262 Test Loss: 4.786 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.8951382637023926
Epoch: 39, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.821 Vali Acc: 0.265 Test Loss: 4.821 Test Acc: 0.265
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.947411298751831
Epoch: 40, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.849 Vali Acc: 0.265 Test Loss: 4.849 Test Acc: 0.265
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.9103820323944092
Epoch: 41, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.870 Vali Acc: 0.267 Test Loss: 4.870 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.875037431716919
Epoch: 42, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.889 Vali Acc: 0.267 Test Loss: 4.889 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps12_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27176470588235296
model parameter : 289114
model size : 1.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.297652006149292
Epoch: 1, Steps: 10 | Train Loss: 3.282 Vali Loss: 3.264 Vali Acc: 0.038 Test Loss: 3.264 Test Acc: 0.038
Validation loss decreased (inf --> -0.037614).  Saving model ...
Epoch: 2 cost time: 0.868349552154541
Epoch: 2, Steps: 10 | Train Loss: 3.184 Vali Loss: 3.257 Vali Acc: 0.055 Test Loss: 3.257 Test Acc: 0.055
Validation loss decreased (-0.037614 --> -0.055262).  Saving model ...
Epoch: 3 cost time: 0.94185471534729
Epoch: 3, Steps: 10 | Train Loss: 3.049 Vali Loss: 3.253 Vali Acc: 0.064 Test Loss: 3.253 Test Acc: 0.064
Validation loss decreased (-0.055262 --> -0.063497).  Saving model ...
Epoch: 4 cost time: 0.9604194164276123
Epoch: 4, Steps: 10 | Train Loss: 2.919 Vali Loss: 3.255 Vali Acc: 0.075 Test Loss: 3.255 Test Acc: 0.075
Validation loss decreased (-0.063497 --> -0.075262).  Saving model ...
Epoch: 5 cost time: 0.9151053428649902
Epoch: 5, Steps: 10 | Train Loss: 2.754 Vali Loss: 3.252 Vali Acc: 0.092 Test Loss: 3.252 Test Acc: 0.092
Validation loss decreased (-0.075262 --> -0.091732).  Saving model ...
Epoch: 6 cost time: 0.9111268520355225
Epoch: 6, Steps: 10 | Train Loss: 2.573 Vali Loss: 3.241 Vali Acc: 0.109 Test Loss: 3.241 Test Acc: 0.109
Validation loss decreased (-0.091732 --> -0.109379).  Saving model ...
Epoch: 7 cost time: 0.8948395252227783
Epoch: 7, Steps: 10 | Train Loss: 2.379 Vali Loss: 3.216 Vali Acc: 0.124 Test Loss: 3.216 Test Acc: 0.124
Validation loss decreased (-0.109379 --> -0.123497).  Saving model ...
Epoch: 8 cost time: 0.9002559185028076
Epoch: 8, Steps: 10 | Train Loss: 2.119 Vali Loss: 3.196 Vali Acc: 0.146 Test Loss: 3.196 Test Acc: 0.146
Validation loss decreased (-0.123497 --> -0.145850).  Saving model ...
Epoch: 9 cost time: 0.9595577716827393
Epoch: 9, Steps: 10 | Train Loss: 1.854 Vali Loss: 3.185 Vali Acc: 0.164 Test Loss: 3.185 Test Acc: 0.164
Validation loss decreased (-0.145850 --> -0.163498).  Saving model ...
Epoch: 10 cost time: 0.80161452293396
Epoch: 10, Steps: 10 | Train Loss: 1.575 Vali Loss: 3.192 Vali Acc: 0.175 Test Loss: 3.192 Test Acc: 0.175
Validation loss decreased (-0.163498 --> -0.175262).  Saving model ...
Epoch: 11 cost time: 0.9811079502105713
Epoch: 11, Steps: 10 | Train Loss: 1.256 Vali Loss: 3.207 Vali Acc: 0.182 Test Loss: 3.207 Test Acc: 0.182
Validation loss decreased (-0.175262 --> -0.182321).  Saving model ...
Epoch: 12 cost time: 0.8707149028778076
Epoch: 12, Steps: 10 | Train Loss: 1.025 Vali Loss: 3.267 Vali Acc: 0.206 Test Loss: 3.267 Test Acc: 0.206
Validation loss decreased (-0.182321 --> -0.205850).  Saving model ...
Epoch: 13 cost time: 0.8586115837097168
Epoch: 13, Steps: 10 | Train Loss: 0.782 Vali Loss: 3.335 Vali Acc: 0.219 Test Loss: 3.335 Test Acc: 0.219
Validation loss decreased (-0.205850 --> -0.218790).  Saving model ...
Epoch: 14 cost time: 0.85866379737854
Epoch: 14, Steps: 10 | Train Loss: 0.566 Vali Loss: 3.432 Vali Acc: 0.233 Test Loss: 3.432 Test Acc: 0.233
Validation loss decreased (-0.218790 --> -0.232907).  Saving model ...
Epoch: 15 cost time: 0.9425721168518066
Epoch: 15, Steps: 10 | Train Loss: 0.400 Vali Loss: 3.539 Vali Acc: 0.244 Test Loss: 3.539 Test Acc: 0.244
Validation loss decreased (-0.232907 --> -0.243494).  Saving model ...
Epoch: 16 cost time: 0.9970040321350098
Epoch: 16, Steps: 10 | Train Loss: 0.291 Vali Loss: 3.625 Vali Acc: 0.258 Test Loss: 3.625 Test Acc: 0.258
Validation loss decreased (-0.243494 --> -0.257611).  Saving model ...
Epoch: 17 cost time: 0.9457063674926758
Epoch: 17, Steps: 10 | Train Loss: 0.190 Vali Loss: 3.753 Vali Acc: 0.256 Test Loss: 3.753 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9653894901275635
Epoch: 18, Steps: 10 | Train Loss: 0.150 Vali Loss: 3.894 Vali Acc: 0.252 Test Loss: 3.894 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.869957447052002
Epoch: 19, Steps: 10 | Train Loss: 0.100 Vali Loss: 3.950 Vali Acc: 0.253 Test Loss: 3.950 Test Acc: 0.253
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.978482723236084
Epoch: 20, Steps: 10 | Train Loss: 0.074 Vali Loss: 4.025 Vali Acc: 0.260 Test Loss: 4.025 Test Acc: 0.260
Validation loss decreased (-0.257611 --> -0.259960).  Saving model ...
Epoch: 21 cost time: 0.9365417957305908
Epoch: 21, Steps: 10 | Train Loss: 0.061 Vali Loss: 4.095 Vali Acc: 0.262 Test Loss: 4.095 Test Acc: 0.262
Validation loss decreased (-0.259960 --> -0.262312).  Saving model ...
Epoch: 22 cost time: 0.9988200664520264
Epoch: 22, Steps: 10 | Train Loss: 0.047 Vali Loss: 4.190 Vali Acc: 0.260 Test Loss: 4.190 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9826719760894775
Epoch: 23, Steps: 10 | Train Loss: 0.037 Vali Loss: 4.224 Vali Acc: 0.262 Test Loss: 4.224 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.9490067958831787
Epoch: 24, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.263 Vali Acc: 0.267 Test Loss: 4.263 Test Acc: 0.267
Validation loss decreased (-0.262312 --> -0.267016).  Saving model ...
Epoch: 25 cost time: 0.8772964477539062
Epoch: 25, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.313 Vali Acc: 0.268 Test Loss: 4.313 Test Acc: 0.268
Validation loss decreased (-0.267016 --> -0.268192).  Saving model ...
Epoch: 26 cost time: 0.9078266620635986
Epoch: 26, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.358 Vali Acc: 0.268 Test Loss: 4.358 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9417390823364258
Epoch: 27, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.403 Vali Acc: 0.268 Test Loss: 4.403 Test Acc: 0.268
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.0624070167541504
Epoch: 28, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.440 Vali Acc: 0.268 Test Loss: 4.440 Test Acc: 0.268
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.9444761276245117
Epoch: 29, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.480 Vali Acc: 0.267 Test Loss: 4.480 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.9586129188537598
Epoch: 30, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.514 Vali Acc: 0.266 Test Loss: 4.514 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.8957774639129639
Epoch: 31, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.550 Vali Acc: 0.266 Test Loss: 4.550 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.019808292388916
Epoch: 32, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.555 Vali Acc: 0.265 Test Loss: 4.555 Test Acc: 0.265
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.87471604347229
Epoch: 33, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.589 Vali Acc: 0.268 Test Loss: 4.589 Test Acc: 0.268
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.9261090755462646
Epoch: 34, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.631 Vali Acc: 0.269 Test Loss: 4.631 Test Acc: 0.269
Validation loss decreased (-0.268192 --> -0.269365).  Saving model ...
Epoch: 35 cost time: 0.9405803680419922
Epoch: 35, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.658 Vali Acc: 0.268 Test Loss: 4.658 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.9749140739440918
Epoch: 36, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.682 Vali Acc: 0.266 Test Loss: 4.682 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.0591731071472168
Epoch: 37, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.708 Vali Acc: 0.266 Test Loss: 4.708 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.9573872089385986
Epoch: 38, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.730 Vali Acc: 0.265 Test Loss: 4.730 Test Acc: 0.265
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.9660437107086182
Epoch: 39, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.754 Vali Acc: 0.262 Test Loss: 4.754 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.9620749950408936
Epoch: 40, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.787 Vali Acc: 0.265 Test Loss: 4.787 Test Acc: 0.265
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.0125672817230225
Epoch: 41, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.831 Vali Acc: 0.266 Test Loss: 4.831 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.0195255279541016
Epoch: 42, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.852 Vali Acc: 0.267 Test Loss: 4.852 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.8675181865692139
Epoch: 43, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.870 Vali Acc: 0.267 Test Loss: 4.870 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.9798362255096436
Epoch: 44, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.882 Vali Acc: 0.268 Test Loss: 4.882 Test Acc: 0.268
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26941176470588235
model parameter : 259418
model size : 1.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps23_str12_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.3945937156677246
Epoch: 1, Steps: 10 | Train Loss: 3.285 Vali Loss: 3.272 Vali Acc: 0.045 Test Loss: 3.272 Test Acc: 0.045
Validation loss decreased (inf --> -0.044673).  Saving model ...
Epoch: 2 cost time: 0.8766498565673828
Epoch: 2, Steps: 10 | Train Loss: 3.221 Vali Loss: 3.265 Vali Acc: 0.046 Test Loss: 3.265 Test Acc: 0.046
Validation loss decreased (-0.044673 --> -0.045850).  Saving model ...
Epoch: 3 cost time: 0.7636950016021729
Epoch: 3, Steps: 10 | Train Loss: 3.140 Vali Loss: 3.260 Vali Acc: 0.067 Test Loss: 3.260 Test Acc: 0.067
Validation loss decreased (-0.045850 --> -0.067026).  Saving model ...
Epoch: 4 cost time: 0.8246309757232666
Epoch: 4, Steps: 10 | Train Loss: 3.031 Vali Loss: 3.255 Vali Acc: 0.074 Test Loss: 3.255 Test Acc: 0.074
Validation loss decreased (-0.067026 --> -0.074085).  Saving model ...
Epoch: 5 cost time: 0.7783827781677246
Epoch: 5, Steps: 10 | Train Loss: 2.925 Vali Loss: 3.253 Vali Acc: 0.084 Test Loss: 3.253 Test Acc: 0.084
Validation loss decreased (-0.074085 --> -0.083497).  Saving model ...
Epoch: 6 cost time: 0.961024284362793
Epoch: 6, Steps: 10 | Train Loss: 2.769 Vali Loss: 3.247 Vali Acc: 0.086 Test Loss: 3.247 Test Acc: 0.086
Validation loss decreased (-0.083497 --> -0.085850).  Saving model ...
Epoch: 7 cost time: 0.9367587566375732
Epoch: 7, Steps: 10 | Train Loss: 2.639 Vali Loss: 3.238 Vali Acc: 0.105 Test Loss: 3.238 Test Acc: 0.105
Validation loss decreased (-0.085850 --> -0.104674).  Saving model ...
Epoch: 8 cost time: 0.8696367740631104
Epoch: 8, Steps: 10 | Train Loss: 2.494 Vali Loss: 3.227 Vali Acc: 0.112 Test Loss: 3.227 Test Acc: 0.112
Validation loss decreased (-0.104674 --> -0.111732).  Saving model ...
Epoch: 9 cost time: 0.9956541061401367
Epoch: 9, Steps: 10 | Train Loss: 2.313 Vali Loss: 3.215 Vali Acc: 0.134 Test Loss: 3.215 Test Acc: 0.134
Validation loss decreased (-0.111732 --> -0.134085).  Saving model ...
Epoch: 10 cost time: 0.893965482711792
Epoch: 10, Steps: 10 | Train Loss: 2.108 Vali Loss: 3.197 Vali Acc: 0.146 Test Loss: 3.197 Test Acc: 0.146
Validation loss decreased (-0.134085 --> -0.145850).  Saving model ...
Epoch: 11 cost time: 0.9326953887939453
Epoch: 11, Steps: 10 | Train Loss: 1.895 Vali Loss: 3.188 Vali Acc: 0.156 Test Loss: 3.188 Test Acc: 0.156
Validation loss decreased (-0.145850 --> -0.156439).  Saving model ...
Epoch: 12 cost time: 0.9108452796936035
Epoch: 12, Steps: 10 | Train Loss: 1.658 Vali Loss: 3.188 Vali Acc: 0.164 Test Loss: 3.188 Test Acc: 0.164
Validation loss decreased (-0.156439 --> -0.163498).  Saving model ...
Epoch: 13 cost time: 0.8807754516601562
Epoch: 13, Steps: 10 | Train Loss: 1.463 Vali Loss: 3.197 Vali Acc: 0.187 Test Loss: 3.197 Test Acc: 0.187
Validation loss decreased (-0.163498 --> -0.187027).  Saving model ...
Epoch: 14 cost time: 0.9649877548217773
Epoch: 14, Steps: 10 | Train Loss: 1.218 Vali Loss: 3.217 Vali Acc: 0.182 Test Loss: 3.217 Test Acc: 0.182
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9604892730712891
Epoch: 15, Steps: 10 | Train Loss: 1.010 Vali Loss: 3.251 Vali Acc: 0.206 Test Loss: 3.251 Test Acc: 0.206
Validation loss decreased (-0.187027 --> -0.205850).  Saving model ...
Epoch: 16 cost time: 0.8949391841888428
Epoch: 16, Steps: 10 | Train Loss: 0.824 Vali Loss: 3.291 Vali Acc: 0.208 Test Loss: 3.291 Test Acc: 0.208
Validation loss decreased (-0.205850 --> -0.208202).  Saving model ...
Epoch: 17 cost time: 0.8945913314819336
Epoch: 17, Steps: 10 | Train Loss: 0.639 Vali Loss: 3.348 Vali Acc: 0.226 Test Loss: 3.348 Test Acc: 0.226
Validation loss decreased (-0.208202 --> -0.225849).  Saving model ...
Epoch: 18 cost time: 0.9111847877502441
Epoch: 18, Steps: 10 | Train Loss: 0.489 Vali Loss: 3.428 Vali Acc: 0.236 Test Loss: 3.428 Test Acc: 0.236
Validation loss decreased (-0.225849 --> -0.236436).  Saving model ...
Epoch: 19 cost time: 0.9402883052825928
Epoch: 19, Steps: 10 | Train Loss: 0.376 Vali Loss: 3.485 Vali Acc: 0.246 Test Loss: 3.485 Test Acc: 0.246
Validation loss decreased (-0.236436 --> -0.245848).  Saving model ...
Epoch: 20 cost time: 0.933910608291626
Epoch: 20, Steps: 10 | Train Loss: 0.298 Vali Loss: 3.579 Vali Acc: 0.247 Test Loss: 3.579 Test Acc: 0.247
Validation loss decreased (-0.245848 --> -0.247023).  Saving model ...
Epoch: 21 cost time: 0.9052388668060303
Epoch: 21, Steps: 10 | Train Loss: 0.213 Vali Loss: 3.642 Vali Acc: 0.247 Test Loss: 3.642 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9356553554534912
Epoch: 22, Steps: 10 | Train Loss: 0.176 Vali Loss: 3.705 Vali Acc: 0.245 Test Loss: 3.705 Test Acc: 0.245
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.850377082824707
Epoch: 23, Steps: 10 | Train Loss: 0.131 Vali Loss: 3.764 Vali Acc: 0.248 Test Loss: 3.764 Test Acc: 0.248
Validation loss decreased (-0.247023 --> -0.248198).  Saving model ...
Epoch: 24 cost time: 0.8871240615844727
Epoch: 24, Steps: 10 | Train Loss: 0.108 Vali Loss: 3.824 Vali Acc: 0.252 Test Loss: 3.824 Test Acc: 0.252
Validation loss decreased (-0.248198 --> -0.251726).  Saving model ...
Epoch: 25 cost time: 0.9686388969421387
Epoch: 25, Steps: 10 | Train Loss: 0.091 Vali Loss: 3.880 Vali Acc: 0.253 Test Loss: 3.880 Test Acc: 0.253
Validation loss decreased (-0.251726 --> -0.252902).  Saving model ...
Epoch: 26 cost time: 0.8919157981872559
Epoch: 26, Steps: 10 | Train Loss: 0.080 Vali Loss: 3.935 Vali Acc: 0.264 Test Loss: 3.935 Test Acc: 0.264
Validation loss decreased (-0.252902 --> -0.263490).  Saving model ...
Epoch: 27 cost time: 0.908008337020874
Epoch: 27, Steps: 10 | Train Loss: 0.059 Vali Loss: 3.988 Vali Acc: 0.258 Test Loss: 3.988 Test Acc: 0.258
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9284954071044922
Epoch: 28, Steps: 10 | Train Loss: 0.054 Vali Loss: 4.007 Vali Acc: 0.265 Test Loss: 4.007 Test Acc: 0.265
Validation loss decreased (-0.263490 --> -0.264666).  Saving model ...
Epoch: 29 cost time: 0.9421403408050537
Epoch: 29, Steps: 10 | Train Loss: 0.046 Vali Loss: 4.042 Vali Acc: 0.264 Test Loss: 4.042 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.8542971611022949
Epoch: 30, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.061 Vali Acc: 0.267 Test Loss: 4.061 Test Acc: 0.267
Validation loss decreased (-0.264666 --> -0.267018).  Saving model ...
Epoch: 31 cost time: 0.8766398429870605
Epoch: 31, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.095 Vali Acc: 0.269 Test Loss: 4.095 Test Acc: 0.269
Validation loss decreased (-0.267018 --> -0.269371).  Saving model ...
Epoch: 32 cost time: 0.9262728691101074
Epoch: 32, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.135 Vali Acc: 0.268 Test Loss: 4.135 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.9529790878295898
Epoch: 33, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.180 Vali Acc: 0.273 Test Loss: 4.180 Test Acc: 0.273
Validation loss decreased (-0.269371 --> -0.272899).  Saving model ...
Epoch: 34 cost time: 0.878420352935791
Epoch: 34, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.209 Vali Acc: 0.267 Test Loss: 4.209 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.9377012252807617
Epoch: 35, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.241 Vali Acc: 0.267 Test Loss: 4.241 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.8566074371337891
Epoch: 36, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.261 Vali Acc: 0.269 Test Loss: 4.261 Test Acc: 0.269
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.8318097591400146
Epoch: 37, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.292 Vali Acc: 0.271 Test Loss: 4.292 Test Acc: 0.271
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.8953094482421875
Epoch: 38, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.313 Vali Acc: 0.269 Test Loss: 4.313 Test Acc: 0.269
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.9613556861877441
Epoch: 39, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.340 Vali Acc: 0.271 Test Loss: 4.340 Test Acc: 0.271
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.8886854648590088
Epoch: 40, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.363 Vali Acc: 0.273 Test Loss: 4.363 Test Acc: 0.273
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.8432624340057373
Epoch: 41, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.376 Vali Acc: 0.274 Test Loss: 4.376 Test Acc: 0.274
Validation loss decreased (-0.272899 --> -0.274074).  Saving model ...
Epoch: 42 cost time: 0.8619308471679688
Epoch: 42, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.407 Vali Acc: 0.268 Test Loss: 4.407 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.8297758102416992
Epoch: 43, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.425 Vali Acc: 0.269 Test Loss: 4.425 Test Acc: 0.269
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.877194881439209
Epoch: 44, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.459 Vali Acc: 0.265 Test Loss: 4.459 Test Acc: 0.265
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.845569372177124
Epoch: 45, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.486 Vali Acc: 0.271 Test Loss: 4.486 Test Acc: 0.271
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.8712196350097656
Epoch: 46, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.506 Vali Acc: 0.273 Test Loss: 4.506 Test Acc: 0.273
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.9212009906768799
Epoch: 47, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.526 Vali Acc: 0.274 Test Loss: 4.526 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.9512276649475098
Epoch: 48, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.539 Vali Acc: 0.272 Test Loss: 4.539 Test Acc: 0.272
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.8817501068115234
Epoch: 49, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.569 Vali Acc: 0.273 Test Loss: 4.569 Test Acc: 0.273
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 0.9393820762634277
Epoch: 50, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.575 Vali Acc: 0.271 Test Loss: 4.575 Test Acc: 0.271
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps23_str12_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2741176470588235
model parameter : 219930
model size : 0.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.221498966217041
Epoch: 1, Steps: 10 | Train Loss: 3.324 Vali Loss: 3.278 Vali Acc: 0.026 Test Loss: 3.278 Test Acc: 0.026
Validation loss decreased (inf --> -0.025850).  Saving model ...
Epoch: 2 cost time: 0.802919864654541
Epoch: 2, Steps: 10 | Train Loss: 3.272 Vali Loss: 3.271 Vali Acc: 0.032 Test Loss: 3.271 Test Acc: 0.032
Validation loss decreased (-0.025850 --> -0.031732).  Saving model ...
Epoch: 3 cost time: 0.823218822479248
Epoch: 3, Steps: 10 | Train Loss: 3.180 Vali Loss: 3.261 Vali Acc: 0.048 Test Loss: 3.261 Test Acc: 0.048
Validation loss decreased (-0.031732 --> -0.048203).  Saving model ...
Epoch: 4 cost time: 0.8655614852905273
Epoch: 4, Steps: 10 | Train Loss: 3.084 Vali Loss: 3.253 Vali Acc: 0.062 Test Loss: 3.253 Test Acc: 0.062
Validation loss decreased (-0.048203 --> -0.062320).  Saving model ...
Epoch: 5 cost time: 0.8619141578674316
Epoch: 5, Steps: 10 | Train Loss: 2.965 Vali Loss: 3.250 Vali Acc: 0.069 Test Loss: 3.250 Test Acc: 0.069
Validation loss decreased (-0.062320 --> -0.069379).  Saving model ...
Epoch: 6 cost time: 0.8486442565917969
Epoch: 6, Steps: 10 | Train Loss: 2.887 Vali Loss: 3.249 Vali Acc: 0.079 Test Loss: 3.249 Test Acc: 0.079
Validation loss decreased (-0.069379 --> -0.078791).  Saving model ...
Epoch: 7 cost time: 0.7615518569946289
Epoch: 7, Steps: 10 | Train Loss: 2.748 Vali Loss: 3.245 Vali Acc: 0.089 Test Loss: 3.245 Test Acc: 0.089
Validation loss decreased (-0.078791 --> -0.089379).  Saving model ...
Epoch: 8 cost time: 0.8705844879150391
Epoch: 8, Steps: 10 | Train Loss: 2.619 Vali Loss: 3.232 Vali Acc: 0.108 Test Loss: 3.232 Test Acc: 0.108
Validation loss decreased (-0.089379 --> -0.108203).  Saving model ...
Epoch: 9 cost time: 0.8190360069274902
Epoch: 9, Steps: 10 | Train Loss: 2.478 Vali Loss: 3.220 Vali Acc: 0.131 Test Loss: 3.220 Test Acc: 0.131
Validation loss decreased (-0.108203 --> -0.130556).  Saving model ...
Epoch: 10 cost time: 0.8029985427856445
Epoch: 10, Steps: 10 | Train Loss: 2.314 Vali Loss: 3.211 Vali Acc: 0.141 Test Loss: 3.211 Test Acc: 0.141
Validation loss decreased (-0.130556 --> -0.141144).  Saving model ...
Epoch: 11 cost time: 0.8093187808990479
Epoch: 11, Steps: 10 | Train Loss: 2.173 Vali Loss: 3.206 Vali Acc: 0.156 Test Loss: 3.206 Test Acc: 0.156
Validation loss decreased (-0.141144 --> -0.156439).  Saving model ...
Epoch: 12 cost time: 0.7532534599304199
Epoch: 12, Steps: 10 | Train Loss: 1.969 Vali Loss: 3.192 Vali Acc: 0.172 Test Loss: 3.192 Test Acc: 0.172
Validation loss decreased (-0.156439 --> -0.171733).  Saving model ...
Epoch: 13 cost time: 0.9916563034057617
Epoch: 13, Steps: 10 | Train Loss: 1.786 Vali Loss: 3.183 Vali Acc: 0.185 Test Loss: 3.183 Test Acc: 0.185
Validation loss decreased (-0.171733 --> -0.184674).  Saving model ...
Epoch: 14 cost time: 0.8750166893005371
Epoch: 14, Steps: 10 | Train Loss: 1.594 Vali Loss: 3.191 Vali Acc: 0.187 Test Loss: 3.191 Test Acc: 0.187
Validation loss decreased (-0.184674 --> -0.187027).  Saving model ...
Epoch: 15 cost time: 0.8725993633270264
Epoch: 15, Steps: 10 | Train Loss: 1.386 Vali Loss: 3.202 Vali Acc: 0.188 Test Loss: 3.202 Test Acc: 0.188
Validation loss decreased (-0.187027 --> -0.188203).  Saving model ...
Epoch: 16 cost time: 0.8138542175292969
Epoch: 16, Steps: 10 | Train Loss: 1.180 Vali Loss: 3.209 Vali Acc: 0.206 Test Loss: 3.209 Test Acc: 0.206
Validation loss decreased (-0.188203 --> -0.205850).  Saving model ...
Epoch: 17 cost time: 0.8074846267700195
Epoch: 17, Steps: 10 | Train Loss: 1.001 Vali Loss: 3.235 Vali Acc: 0.215 Test Loss: 3.235 Test Acc: 0.215
Validation loss decreased (-0.205850 --> -0.215262).  Saving model ...
Epoch: 18 cost time: 0.9347763061523438
Epoch: 18, Steps: 10 | Train Loss: 0.851 Vali Loss: 3.285 Vali Acc: 0.216 Test Loss: 3.285 Test Acc: 0.216
Validation loss decreased (-0.215262 --> -0.216438).  Saving model ...
Epoch: 19 cost time: 0.9038069248199463
Epoch: 19, Steps: 10 | Train Loss: 0.690 Vali Loss: 3.331 Vali Acc: 0.224 Test Loss: 3.331 Test Acc: 0.224
Validation loss decreased (-0.216438 --> -0.223496).  Saving model ...
Epoch: 20 cost time: 0.7746970653533936
Epoch: 20, Steps: 10 | Train Loss: 0.551 Vali Loss: 3.385 Vali Acc: 0.229 Test Loss: 3.385 Test Acc: 0.229
Validation loss decreased (-0.223496 --> -0.229378).  Saving model ...
Epoch: 21 cost time: 0.8113570213317871
Epoch: 21, Steps: 10 | Train Loss: 0.458 Vali Loss: 3.436 Vali Acc: 0.234 Test Loss: 3.436 Test Acc: 0.234
Validation loss decreased (-0.229378 --> -0.234083).  Saving model ...
Epoch: 22 cost time: 0.8365311622619629
Epoch: 22, Steps: 10 | Train Loss: 0.344 Vali Loss: 3.486 Vali Acc: 0.245 Test Loss: 3.486 Test Acc: 0.245
Validation loss decreased (-0.234083 --> -0.244671).  Saving model ...
Epoch: 23 cost time: 0.8743021488189697
Epoch: 23, Steps: 10 | Train Loss: 0.270 Vali Loss: 3.552 Vali Acc: 0.247 Test Loss: 3.552 Test Acc: 0.247
Validation loss decreased (-0.244671 --> -0.247023).  Saving model ...
Epoch: 24 cost time: 0.8871595859527588
Epoch: 24, Steps: 10 | Train Loss: 0.211 Vali Loss: 3.613 Vali Acc: 0.247 Test Loss: 3.613 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.870039701461792
Epoch: 25, Steps: 10 | Train Loss: 0.172 Vali Loss: 3.658 Vali Acc: 0.251 Test Loss: 3.658 Test Acc: 0.251
Validation loss decreased (-0.247023 --> -0.250552).  Saving model ...
Epoch: 26 cost time: 0.8013865947723389
Epoch: 26, Steps: 10 | Train Loss: 0.135 Vali Loss: 3.699 Vali Acc: 0.251 Test Loss: 3.699 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8258910179138184
Epoch: 27, Steps: 10 | Train Loss: 0.109 Vali Loss: 3.750 Vali Acc: 0.247 Test Loss: 3.750 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.8590569496154785
Epoch: 28, Steps: 10 | Train Loss: 0.094 Vali Loss: 3.780 Vali Acc: 0.245 Test Loss: 3.780 Test Acc: 0.245
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.9015207290649414
Epoch: 29, Steps: 10 | Train Loss: 0.084 Vali Loss: 3.826 Vali Acc: 0.253 Test Loss: 3.826 Test Acc: 0.253
Validation loss decreased (-0.250552 --> -0.252903).  Saving model ...
Epoch: 30 cost time: 0.8164157867431641
Epoch: 30, Steps: 10 | Train Loss: 0.072 Vali Loss: 3.864 Vali Acc: 0.258 Test Loss: 3.864 Test Acc: 0.258
Validation loss decreased (-0.252903 --> -0.257608).  Saving model ...
Epoch: 31 cost time: 0.8010439872741699
Epoch: 31, Steps: 10 | Train Loss: 0.059 Vali Loss: 3.909 Vali Acc: 0.262 Test Loss: 3.909 Test Acc: 0.262
Validation loss decreased (-0.257608 --> -0.262314).  Saving model ...
Epoch: 32 cost time: 0.8361678123474121
Epoch: 32, Steps: 10 | Train Loss: 0.054 Vali Loss: 3.941 Vali Acc: 0.259 Test Loss: 3.941 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.8981602191925049
Epoch: 33, Steps: 10 | Train Loss: 0.049 Vali Loss: 3.976 Vali Acc: 0.258 Test Loss: 3.976 Test Acc: 0.258
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.8234937191009521
Epoch: 34, Steps: 10 | Train Loss: 0.042 Vali Loss: 4.003 Vali Acc: 0.260 Test Loss: 4.003 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.8689608573913574
Epoch: 35, Steps: 10 | Train Loss: 0.038 Vali Loss: 4.037 Vali Acc: 0.259 Test Loss: 4.037 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.9256782531738281
Epoch: 36, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.070 Vali Acc: 0.258 Test Loss: 4.070 Test Acc: 0.258
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.7957682609558105
Epoch: 37, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.096 Vali Acc: 0.265 Test Loss: 4.096 Test Acc: 0.265
Validation loss decreased (-0.262314 --> -0.264665).  Saving model ...
Epoch: 38 cost time: 0.8026623725891113
Epoch: 38, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.126 Vali Acc: 0.268 Test Loss: 4.126 Test Acc: 0.268
Validation loss decreased (-0.264665 --> -0.268194).  Saving model ...
Epoch: 39 cost time: 0.7158851623535156
Epoch: 39, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.148 Vali Acc: 0.268 Test Loss: 4.148 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.7447991371154785
Epoch: 40, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.181 Vali Acc: 0.268 Test Loss: 4.181 Test Acc: 0.268
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.7804844379425049
Epoch: 41, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.200 Vali Acc: 0.269 Test Loss: 4.200 Test Acc: 0.269
Validation loss decreased (-0.268194 --> -0.269370).  Saving model ...
Epoch: 42 cost time: 0.8465862274169922
Epoch: 42, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.228 Vali Acc: 0.269 Test Loss: 4.228 Test Acc: 0.269
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.8711450099945068
Epoch: 43, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.259 Vali Acc: 0.268 Test Loss: 4.259 Test Acc: 0.268
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.8246440887451172
Epoch: 44, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.277 Vali Acc: 0.267 Test Loss: 4.277 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.9302992820739746
Epoch: 45, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.293 Vali Acc: 0.268 Test Loss: 4.293 Test Acc: 0.268
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.867417573928833
Epoch: 46, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.312 Vali Acc: 0.266 Test Loss: 4.312 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.8368704319000244
Epoch: 47, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.331 Vali Acc: 0.266 Test Loss: 4.331 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.8757648468017578
Epoch: 48, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.345 Vali Acc: 0.267 Test Loss: 4.345 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.8374226093292236
Epoch: 49, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.364 Vali Acc: 0.269 Test Loss: 4.364 Test Acc: 0.269
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 0.8136632442474365
Epoch: 50, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.372 Vali Acc: 0.271 Test Loss: 4.372 Test Acc: 0.271
Validation loss decreased (-0.269370 --> -0.270545).  Saving model ...
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27058823529411763
model parameter : 210458
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps38_str19_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.0820021629333496
Epoch: 1, Steps: 10 | Train Loss: 3.281 Vali Loss: 3.272 Vali Acc: 0.038 Test Loss: 3.272 Test Acc: 0.038
Validation loss decreased (inf --> -0.037614).  Saving model ...
Epoch: 2 cost time: 0.802401065826416
Epoch: 2, Steps: 10 | Train Loss: 3.235 Vali Loss: 3.269 Vali Acc: 0.042 Test Loss: 3.269 Test Acc: 0.042
Validation loss decreased (-0.037614 --> -0.042320).  Saving model ...
Epoch: 3 cost time: 0.8442440032958984
Epoch: 3, Steps: 10 | Train Loss: 3.174 Vali Loss: 3.263 Vali Acc: 0.052 Test Loss: 3.263 Test Acc: 0.052
Validation loss decreased (-0.042320 --> -0.051732).  Saving model ...
Epoch: 4 cost time: 0.8621711730957031
Epoch: 4, Steps: 10 | Train Loss: 3.068 Vali Loss: 3.257 Vali Acc: 0.065 Test Loss: 3.257 Test Acc: 0.065
Validation loss decreased (-0.051732 --> -0.064673).  Saving model ...
Epoch: 5 cost time: 0.8184413909912109
Epoch: 5, Steps: 10 | Train Loss: 2.993 Vali Loss: 3.253 Vali Acc: 0.078 Test Loss: 3.253 Test Acc: 0.078
Validation loss decreased (-0.064673 --> -0.077615).  Saving model ...
Epoch: 6 cost time: 0.8239054679870605
Epoch: 6, Steps: 10 | Train Loss: 2.887 Vali Loss: 3.249 Vali Acc: 0.081 Test Loss: 3.249 Test Acc: 0.081
Validation loss decreased (-0.077615 --> -0.081144).  Saving model ...
Epoch: 7 cost time: 0.8840246200561523
Epoch: 7, Steps: 10 | Train Loss: 2.770 Vali Loss: 3.247 Vali Acc: 0.088 Test Loss: 3.247 Test Acc: 0.088
Validation loss decreased (-0.081144 --> -0.088203).  Saving model ...
Epoch: 8 cost time: 0.7730987071990967
Epoch: 8, Steps: 10 | Train Loss: 2.681 Vali Loss: 3.240 Vali Acc: 0.104 Test Loss: 3.240 Test Acc: 0.104
Validation loss decreased (-0.088203 --> -0.103497).  Saving model ...
Epoch: 9 cost time: 0.8150215148925781
Epoch: 9, Steps: 10 | Train Loss: 2.536 Vali Loss: 3.233 Vali Acc: 0.126 Test Loss: 3.233 Test Acc: 0.126
Validation loss decreased (-0.103497 --> -0.125850).  Saving model ...
Epoch: 10 cost time: 0.7744028568267822
Epoch: 10, Steps: 10 | Train Loss: 2.405 Vali Loss: 3.221 Vali Acc: 0.140 Test Loss: 3.221 Test Acc: 0.140
Validation loss decreased (-0.125850 --> -0.139968).  Saving model ...
Epoch: 11 cost time: 0.8649742603302002
Epoch: 11, Steps: 10 | Train Loss: 2.257 Vali Loss: 3.202 Vali Acc: 0.155 Test Loss: 3.202 Test Acc: 0.155
Validation loss decreased (-0.139968 --> -0.155262).  Saving model ...
Epoch: 12 cost time: 0.900731086730957
Epoch: 12, Steps: 10 | Train Loss: 2.076 Vali Loss: 3.191 Vali Acc: 0.168 Test Loss: 3.191 Test Acc: 0.168
Validation loss decreased (-0.155262 --> -0.168203).  Saving model ...
Epoch: 13 cost time: 0.8373241424560547
Epoch: 13, Steps: 10 | Train Loss: 1.905 Vali Loss: 3.194 Vali Acc: 0.173 Test Loss: 3.194 Test Acc: 0.173
Validation loss decreased (-0.168203 --> -0.172909).  Saving model ...
Epoch: 14 cost time: 0.8357217311859131
Epoch: 14, Steps: 10 | Train Loss: 1.739 Vali Loss: 3.194 Vali Acc: 0.188 Test Loss: 3.194 Test Acc: 0.188
Validation loss decreased (-0.172909 --> -0.188203).  Saving model ...
Epoch: 15 cost time: 0.8245315551757812
Epoch: 15, Steps: 10 | Train Loss: 1.548 Vali Loss: 3.197 Vali Acc: 0.198 Test Loss: 3.197 Test Acc: 0.198
Validation loss decreased (-0.188203 --> -0.197615).  Saving model ...
Epoch: 16 cost time: 0.8269131183624268
Epoch: 16, Steps: 10 | Train Loss: 1.377 Vali Loss: 3.203 Vali Acc: 0.204 Test Loss: 3.203 Test Acc: 0.204
Validation loss decreased (-0.197615 --> -0.203497).  Saving model ...
Epoch: 17 cost time: 0.8904519081115723
Epoch: 17, Steps: 10 | Train Loss: 1.177 Vali Loss: 3.224 Vali Acc: 0.212 Test Loss: 3.224 Test Acc: 0.212
Validation loss decreased (-0.203497 --> -0.211732).  Saving model ...
Epoch: 18 cost time: 0.8465943336486816
Epoch: 18, Steps: 10 | Train Loss: 1.018 Vali Loss: 3.255 Vali Acc: 0.220 Test Loss: 3.255 Test Acc: 0.220
Validation loss decreased (-0.211732 --> -0.219967).  Saving model ...
Epoch: 19 cost time: 0.8182077407836914
Epoch: 19, Steps: 10 | Train Loss: 0.874 Vali Loss: 3.290 Vali Acc: 0.221 Test Loss: 3.290 Test Acc: 0.221
Validation loss decreased (-0.219967 --> -0.221144).  Saving model ...
Epoch: 20 cost time: 0.8364303112030029
Epoch: 20, Steps: 10 | Train Loss: 0.730 Vali Loss: 3.328 Vali Acc: 0.226 Test Loss: 3.328 Test Acc: 0.226
Validation loss decreased (-0.221144 --> -0.225849).  Saving model ...
Epoch: 21 cost time: 0.9263429641723633
Epoch: 21, Steps: 10 | Train Loss: 0.596 Vali Loss: 3.368 Vali Acc: 0.241 Test Loss: 3.368 Test Acc: 0.241
Validation loss decreased (-0.225849 --> -0.241143).  Saving model ...
Epoch: 22 cost time: 0.8345489501953125
Epoch: 22, Steps: 10 | Train Loss: 0.472 Vali Loss: 3.420 Vali Acc: 0.246 Test Loss: 3.420 Test Acc: 0.246
Validation loss decreased (-0.241143 --> -0.245848).  Saving model ...
Epoch: 23 cost time: 0.8681461811065674
Epoch: 23, Steps: 10 | Train Loss: 0.385 Vali Loss: 3.481 Vali Acc: 0.245 Test Loss: 3.481 Test Acc: 0.245
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7825844287872314
Epoch: 24, Steps: 10 | Train Loss: 0.300 Vali Loss: 3.549 Vali Acc: 0.244 Test Loss: 3.549 Test Acc: 0.244
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.8066153526306152
Epoch: 25, Steps: 10 | Train Loss: 0.263 Vali Loss: 3.605 Vali Acc: 0.246 Test Loss: 3.605 Test Acc: 0.246
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.869821310043335
Epoch: 26, Steps: 10 | Train Loss: 0.214 Vali Loss: 3.668 Vali Acc: 0.244 Test Loss: 3.668 Test Acc: 0.244
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.8953800201416016
Epoch: 27, Steps: 10 | Train Loss: 0.187 Vali Loss: 3.716 Vali Acc: 0.251 Test Loss: 3.716 Test Acc: 0.251
Validation loss decreased (-0.245848 --> -0.250551).  Saving model ...
Epoch: 28 cost time: 0.7944035530090332
Epoch: 28, Steps: 10 | Train Loss: 0.140 Vali Loss: 3.750 Vali Acc: 0.246 Test Loss: 3.750 Test Acc: 0.246
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.8209009170532227
Epoch: 29, Steps: 10 | Train Loss: 0.124 Vali Loss: 3.803 Vali Acc: 0.246 Test Loss: 3.803 Test Acc: 0.246
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.8367528915405273
Epoch: 30, Steps: 10 | Train Loss: 0.104 Vali Loss: 3.848 Vali Acc: 0.255 Test Loss: 3.848 Test Acc: 0.255
Validation loss decreased (-0.250551 --> -0.255256).  Saving model ...
Epoch: 31 cost time: 0.8619911670684814
Epoch: 31, Steps: 10 | Train Loss: 0.090 Vali Loss: 3.901 Vali Acc: 0.260 Test Loss: 3.901 Test Acc: 0.260
Validation loss decreased (-0.255256 --> -0.259961).  Saving model ...
Epoch: 32 cost time: 0.8646631240844727
Epoch: 32, Steps: 10 | Train Loss: 0.076 Vali Loss: 3.939 Vali Acc: 0.256 Test Loss: 3.939 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.8270275592803955
Epoch: 33, Steps: 10 | Train Loss: 0.066 Vali Loss: 3.971 Vali Acc: 0.256 Test Loss: 3.971 Test Acc: 0.256
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.8446044921875
Epoch: 34, Steps: 10 | Train Loss: 0.058 Vali Loss: 4.003 Vali Acc: 0.259 Test Loss: 4.003 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.8588168621063232
Epoch: 35, Steps: 10 | Train Loss: 0.054 Vali Loss: 4.056 Vali Acc: 0.259 Test Loss: 4.056 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.8749587535858154
Epoch: 36, Steps: 10 | Train Loss: 0.048 Vali Loss: 4.075 Vali Acc: 0.261 Test Loss: 4.075 Test Acc: 0.261
Validation loss decreased (-0.259961 --> -0.261136).  Saving model ...
Epoch: 37 cost time: 0.7878031730651855
Epoch: 37, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.119 Vali Acc: 0.258 Test Loss: 4.119 Test Acc: 0.258
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.7704038619995117
Epoch: 38, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.131 Vali Acc: 0.256 Test Loss: 4.131 Test Acc: 0.256
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.7815570831298828
Epoch: 39, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.166 Vali Acc: 0.259 Test Loss: 4.166 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.901616096496582
Epoch: 40, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.198 Vali Acc: 0.261 Test Loss: 4.198 Test Acc: 0.261
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.8972885608673096
Epoch: 41, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.242 Vali Acc: 0.259 Test Loss: 4.242 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.8503255844116211
Epoch: 42, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.266 Vali Acc: 0.256 Test Loss: 4.266 Test Acc: 0.256
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.8160092830657959
Epoch: 43, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.294 Vali Acc: 0.258 Test Loss: 4.294 Test Acc: 0.258
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.8941795825958252
Epoch: 44, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.303 Vali Acc: 0.256 Test Loss: 4.303 Test Acc: 0.256
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.8826115131378174
Epoch: 45, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.331 Vali Acc: 0.258 Test Loss: 4.331 Test Acc: 0.258
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 0.869147539138794
Epoch: 46, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.355 Vali Acc: 0.262 Test Loss: 4.355 Test Acc: 0.262
Validation loss decreased (-0.261136 --> -0.262309).  Saving model ...
Epoch: 47 cost time: 0.850306510925293
Epoch: 47, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.398 Vali Acc: 0.262 Test Loss: 4.398 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.8166477680206299
Epoch: 48, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.415 Vali Acc: 0.265 Test Loss: 4.415 Test Acc: 0.265
Validation loss decreased (-0.262309 --> -0.264662).  Saving model ...
Epoch: 49 cost time: 0.8184957504272461
Epoch: 49, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.435 Vali Acc: 0.267 Test Loss: 4.435 Test Acc: 0.267
Validation loss decreased (-0.264662 --> -0.267014).  Saving model ...
Epoch: 50 cost time: 0.8084321022033691
Epoch: 50, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.450 Vali Acc: 0.264 Test Loss: 4.450 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps38_str19_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26705882352941174
model parameter : 200922
model size : 0.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.9867231845855713
Epoch: 1, Steps: 10 | Train Loss: 3.301 Vali Loss: 3.270 Vali Acc: 0.044 Test Loss: 3.270 Test Acc: 0.044
Validation loss decreased (inf --> -0.043497).  Saving model ...
Epoch: 2 cost time: 0.7861366271972656
Epoch: 2, Steps: 10 | Train Loss: 3.161 Vali Loss: 3.259 Vali Acc: 0.044 Test Loss: 3.259 Test Acc: 0.044
Validation loss decreased (-0.043497 --> -0.043497).  Saving model ...
Epoch: 3 cost time: 0.8129568099975586
Epoch: 3, Steps: 10 | Train Loss: 2.978 Vali Loss: 3.271 Vali Acc: 0.054 Test Loss: 3.271 Test Acc: 0.054
Validation loss decreased (-0.043497 --> -0.054085).  Saving model ...
Epoch: 4 cost time: 0.8135733604431152
Epoch: 4, Steps: 10 | Train Loss: 2.753 Vali Loss: 3.268 Vali Acc: 0.081 Test Loss: 3.268 Test Acc: 0.081
Validation loss decreased (-0.054085 --> -0.081144).  Saving model ...
Epoch: 5 cost time: 0.7477571964263916
Epoch: 5, Steps: 10 | Train Loss: 2.462 Vali Loss: 3.226 Vali Acc: 0.109 Test Loss: 3.226 Test Acc: 0.109
Validation loss decreased (-0.081144 --> -0.109380).  Saving model ...
Epoch: 6 cost time: 0.7758445739746094
Epoch: 6, Steps: 10 | Train Loss: 2.127 Vali Loss: 3.188 Vali Acc: 0.147 Test Loss: 3.188 Test Acc: 0.147
Validation loss decreased (-0.109380 --> -0.147027).  Saving model ...
Epoch: 7 cost time: 0.7370791435241699
Epoch: 7, Steps: 10 | Train Loss: 1.789 Vali Loss: 3.179 Vali Acc: 0.169 Test Loss: 3.179 Test Acc: 0.169
Validation loss decreased (-0.147027 --> -0.169380).  Saving model ...
Epoch: 8 cost time: 0.8127448558807373
Epoch: 8, Steps: 10 | Train Loss: 1.389 Vali Loss: 3.170 Vali Acc: 0.191 Test Loss: 3.170 Test Acc: 0.191
Validation loss decreased (-0.169380 --> -0.190557).  Saving model ...
Epoch: 9 cost time: 0.7557690143585205
Epoch: 9, Steps: 10 | Train Loss: 1.017 Vali Loss: 3.213 Vali Acc: 0.225 Test Loss: 3.213 Test Acc: 0.225
Validation loss decreased (-0.190557 --> -0.224674).  Saving model ...
Epoch: 10 cost time: 0.736419677734375
Epoch: 10, Steps: 10 | Train Loss: 0.711 Vali Loss: 3.348 Vali Acc: 0.228 Test Loss: 3.348 Test Acc: 0.228
Validation loss decreased (-0.224674 --> -0.228202).  Saving model ...
Epoch: 11 cost time: 0.7515294551849365
Epoch: 11, Steps: 10 | Train Loss: 0.488 Vali Loss: 3.482 Vali Acc: 0.244 Test Loss: 3.482 Test Acc: 0.244
Validation loss decreased (-0.228202 --> -0.243495).  Saving model ...
Epoch: 12 cost time: 0.7433791160583496
Epoch: 12, Steps: 10 | Train Loss: 0.275 Vali Loss: 3.644 Vali Acc: 0.264 Test Loss: 3.644 Test Acc: 0.264
Validation loss decreased (-0.243495 --> -0.263493).  Saving model ...
Epoch: 13 cost time: 0.7741055488586426
Epoch: 13, Steps: 10 | Train Loss: 0.153 Vali Loss: 3.782 Vali Acc: 0.273 Test Loss: 3.782 Test Acc: 0.273
Validation loss decreased (-0.263493 --> -0.272903).  Saving model ...
Epoch: 14 cost time: 0.7825136184692383
Epoch: 14, Steps: 10 | Train Loss: 0.083 Vali Loss: 3.916 Vali Acc: 0.274 Test Loss: 3.916 Test Acc: 0.274
Validation loss decreased (-0.272903 --> -0.274078).  Saving model ...
Epoch: 15 cost time: 0.7761471271514893
Epoch: 15, Steps: 10 | Train Loss: 0.054 Vali Loss: 4.068 Vali Acc: 0.273 Test Loss: 4.068 Test Acc: 0.273
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.784874677658081
Epoch: 16, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.153 Vali Acc: 0.280 Test Loss: 4.153 Test Acc: 0.280
Validation loss decreased (-0.274078 --> -0.279958).  Saving model ...
Epoch: 17 cost time: 0.6989550590515137
Epoch: 17, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.250 Vali Acc: 0.274 Test Loss: 4.250 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7072658538818359
Epoch: 18, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.297 Vali Acc: 0.276 Test Loss: 4.297 Test Acc: 0.276
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7658531665802002
Epoch: 19, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.344 Vali Acc: 0.281 Test Loss: 4.344 Test Acc: 0.281
Validation loss decreased (-0.279958 --> -0.281133).  Saving model ...
Epoch: 20 cost time: 0.8067226409912109
Epoch: 20, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.385 Vali Acc: 0.282 Test Loss: 4.385 Test Acc: 0.282
Validation loss decreased (-0.281133 --> -0.282309).  Saving model ...
Epoch: 21 cost time: 0.7306702136993408
Epoch: 21, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.429 Vali Acc: 0.282 Test Loss: 4.429 Test Acc: 0.282
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7018682956695557
Epoch: 22, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.488 Vali Acc: 0.287 Test Loss: 4.488 Test Acc: 0.287
Validation loss decreased (-0.282309 --> -0.287014).  Saving model ...
Epoch: 23 cost time: 0.7091238498687744
Epoch: 23, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.539 Vali Acc: 0.286 Test Loss: 4.539 Test Acc: 0.286
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7466208934783936
Epoch: 24, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.577 Vali Acc: 0.287 Test Loss: 4.577 Test Acc: 0.287
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.7775936126708984
Epoch: 25, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.617 Vali Acc: 0.286 Test Loss: 4.617 Test Acc: 0.286
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.800412654876709
Epoch: 26, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.641 Vali Acc: 0.286 Test Loss: 4.641 Test Acc: 0.286
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.7548384666442871
Epoch: 27, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.672 Vali Acc: 0.286 Test Loss: 4.672 Test Acc: 0.286
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.7611877918243408
Epoch: 28, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.688 Vali Acc: 0.289 Test Loss: 4.688 Test Acc: 0.289
Validation loss decreased (-0.287014 --> -0.289365).  Saving model ...
Epoch: 29 cost time: 0.767488956451416
Epoch: 29, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.718 Vali Acc: 0.289 Test Loss: 4.718 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.786048173904419
Epoch: 30, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.755 Vali Acc: 0.288 Test Loss: 4.755 Test Acc: 0.288
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.7543563842773438
Epoch: 31, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.792 Vali Acc: 0.287 Test Loss: 4.792 Test Acc: 0.287
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.697606086730957
Epoch: 32, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.822 Vali Acc: 0.287 Test Loss: 4.822 Test Acc: 0.287
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.747394323348999
Epoch: 33, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.848 Vali Acc: 0.288 Test Loss: 4.848 Test Acc: 0.288
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.7453920841217041
Epoch: 34, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.852 Vali Acc: 0.288 Test Loss: 4.852 Test Acc: 0.288
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.7948005199432373
Epoch: 35, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.886 Vali Acc: 0.289 Test Loss: 4.886 Test Acc: 0.289
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.8244414329528809
Epoch: 36, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.924 Vali Acc: 0.291 Test Loss: 4.924 Test Acc: 0.291
Validation loss decreased (-0.289365 --> -0.290539).  Saving model ...
Epoch: 37 cost time: 0.7604334354400635
Epoch: 37, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.948 Vali Acc: 0.292 Test Loss: 4.948 Test Acc: 0.292
Validation loss decreased (-0.290539 --> -0.291715).  Saving model ...
Epoch: 38 cost time: 0.7243731021881104
Epoch: 38, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.970 Vali Acc: 0.292 Test Loss: 4.970 Test Acc: 0.292
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.76426100730896
Epoch: 39, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.997 Vali Acc: 0.287 Test Loss: 4.997 Test Acc: 0.287
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.7788770198822021
Epoch: 40, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.019 Vali Acc: 0.291 Test Loss: 5.019 Test Acc: 0.291
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.8360230922698975
Epoch: 41, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.050 Vali Acc: 0.287 Test Loss: 5.050 Test Acc: 0.287
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.8100235462188721
Epoch: 42, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.067 Vali Acc: 0.291 Test Loss: 5.067 Test Acc: 0.291
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.7175700664520264
Epoch: 43, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.088 Vali Acc: 0.289 Test Loss: 5.088 Test Acc: 0.289
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.7863795757293701
Epoch: 44, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.106 Vali Acc: 0.289 Test Loss: 5.106 Test Acc: 0.289
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.8125615119934082
Epoch: 45, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.127 Vali Acc: 0.291 Test Loss: 5.127 Test Acc: 0.291
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.7973544597625732
Epoch: 46, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.146 Vali Acc: 0.288 Test Loss: 5.146 Test Acc: 0.288
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.7520866394042969
Epoch: 47, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.165 Vali Acc: 0.287 Test Loss: 5.165 Test Acc: 0.287
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2917647058823529
model parameter : 234298
model size : 0.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.114628791809082
Epoch: 1, Steps: 10 | Train Loss: 3.247 Vali Loss: 3.259 Vali Acc: 0.046 Test Loss: 3.259 Test Acc: 0.046
Validation loss decreased (inf --> -0.045850).  Saving model ...
Epoch: 2 cost time: 0.8180947303771973
Epoch: 2, Steps: 10 | Train Loss: 3.169 Vali Loss: 3.252 Vali Acc: 0.062 Test Loss: 3.252 Test Acc: 0.062
Validation loss decreased (-0.045850 --> -0.062320).  Saving model ...
Epoch: 3 cost time: 0.8539588451385498
Epoch: 3, Steps: 10 | Train Loss: 3.054 Vali Loss: 3.248 Vali Acc: 0.075 Test Loss: 3.248 Test Acc: 0.075
Validation loss decreased (-0.062320 --> -0.075262).  Saving model ...
Epoch: 4 cost time: 0.7900612354278564
Epoch: 4, Steps: 10 | Train Loss: 2.929 Vali Loss: 3.252 Vali Acc: 0.093 Test Loss: 3.252 Test Acc: 0.093
Validation loss decreased (-0.075262 --> -0.092909).  Saving model ...
Epoch: 5 cost time: 0.6962852478027344
Epoch: 5, Steps: 10 | Train Loss: 2.764 Vali Loss: 3.248 Vali Acc: 0.104 Test Loss: 3.248 Test Acc: 0.104
Validation loss decreased (-0.092909 --> -0.103497).  Saving model ...
Epoch: 6 cost time: 0.749823808670044
Epoch: 6, Steps: 10 | Train Loss: 2.594 Vali Loss: 3.236 Vali Acc: 0.116 Test Loss: 3.236 Test Acc: 0.116
Validation loss decreased (-0.103497 --> -0.116438).  Saving model ...
Epoch: 7 cost time: 0.7673430442810059
Epoch: 7, Steps: 10 | Train Loss: 2.416 Vali Loss: 3.220 Vali Acc: 0.141 Test Loss: 3.220 Test Acc: 0.141
Validation loss decreased (-0.116438 --> -0.141144).  Saving model ...
Epoch: 8 cost time: 0.782891035079956
Epoch: 8, Steps: 10 | Train Loss: 2.176 Vali Loss: 3.203 Vali Acc: 0.149 Test Loss: 3.203 Test Acc: 0.149
Validation loss decreased (-0.141144 --> -0.149380).  Saving model ...
Epoch: 9 cost time: 0.7807087898254395
Epoch: 9, Steps: 10 | Train Loss: 1.916 Vali Loss: 3.191 Vali Acc: 0.159 Test Loss: 3.191 Test Acc: 0.159
Validation loss decreased (-0.149380 --> -0.158792).  Saving model ...
Epoch: 10 cost time: 0.720691442489624
Epoch: 10, Steps: 10 | Train Loss: 1.691 Vali Loss: 3.188 Vali Acc: 0.167 Test Loss: 3.188 Test Acc: 0.167
Validation loss decreased (-0.158792 --> -0.167027).  Saving model ...
Epoch: 11 cost time: 0.7479281425476074
Epoch: 11, Steps: 10 | Train Loss: 1.406 Vali Loss: 3.213 Vali Acc: 0.182 Test Loss: 3.213 Test Acc: 0.182
Validation loss decreased (-0.167027 --> -0.182321).  Saving model ...
Epoch: 12 cost time: 0.8034763336181641
Epoch: 12, Steps: 10 | Train Loss: 1.129 Vali Loss: 3.241 Vali Acc: 0.209 Test Loss: 3.241 Test Acc: 0.209
Validation loss decreased (-0.182321 --> -0.209379).  Saving model ...
Epoch: 13 cost time: 0.7760508060455322
Epoch: 13, Steps: 10 | Train Loss: 0.901 Vali Loss: 3.296 Vali Acc: 0.226 Test Loss: 3.296 Test Acc: 0.226
Validation loss decreased (-0.209379 --> -0.225849).  Saving model ...
Epoch: 14 cost time: 0.8369941711425781
Epoch: 14, Steps: 10 | Train Loss: 0.665 Vali Loss: 3.368 Vali Acc: 0.240 Test Loss: 3.368 Test Acc: 0.240
Validation loss decreased (-0.225849 --> -0.239966).  Saving model ...
Epoch: 15 cost time: 0.7248125076293945
Epoch: 15, Steps: 10 | Train Loss: 0.492 Vali Loss: 3.475 Vali Acc: 0.242 Test Loss: 3.475 Test Acc: 0.242
Validation loss decreased (-0.239966 --> -0.242318).  Saving model ...
Epoch: 16 cost time: 0.7139382362365723
Epoch: 16, Steps: 10 | Train Loss: 0.350 Vali Loss: 3.564 Vali Acc: 0.265 Test Loss: 3.564 Test Acc: 0.265
Validation loss decreased (-0.242318 --> -0.264670).  Saving model ...
Epoch: 17 cost time: 0.7376885414123535
Epoch: 17, Steps: 10 | Train Loss: 0.255 Vali Loss: 3.675 Vali Acc: 0.259 Test Loss: 3.675 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.795102596282959
Epoch: 18, Steps: 10 | Train Loss: 0.172 Vali Loss: 3.826 Vali Acc: 0.258 Test Loss: 3.826 Test Acc: 0.258
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8170008659362793
Epoch: 19, Steps: 10 | Train Loss: 0.119 Vali Loss: 3.895 Vali Acc: 0.276 Test Loss: 3.895 Test Acc: 0.276
Validation loss decreased (-0.264670 --> -0.276432).  Saving model ...
Epoch: 20 cost time: 0.7277805805206299
Epoch: 20, Steps: 10 | Train Loss: 0.085 Vali Loss: 3.971 Vali Acc: 0.279 Test Loss: 3.971 Test Acc: 0.279
Validation loss decreased (-0.276432 --> -0.278784).  Saving model ...
Epoch: 21 cost time: 0.6991605758666992
Epoch: 21, Steps: 10 | Train Loss: 0.069 Vali Loss: 4.061 Vali Acc: 0.273 Test Loss: 4.061 Test Acc: 0.273
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7738997936248779
Epoch: 22, Steps: 10 | Train Loss: 0.061 Vali Loss: 4.147 Vali Acc: 0.273 Test Loss: 4.147 Test Acc: 0.273
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.7196276187896729
Epoch: 23, Steps: 10 | Train Loss: 0.046 Vali Loss: 4.204 Vali Acc: 0.280 Test Loss: 4.204 Test Acc: 0.280
Validation loss decreased (-0.278784 --> -0.279958).  Saving model ...
Epoch: 24 cost time: 0.7895395755767822
Epoch: 24, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.277 Vali Acc: 0.276 Test Loss: 4.277 Test Acc: 0.276
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8032264709472656
Epoch: 25, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.320 Vali Acc: 0.279 Test Loss: 4.320 Test Acc: 0.279
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.7611744403839111
Epoch: 26, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.348 Vali Acc: 0.282 Test Loss: 4.348 Test Acc: 0.282
Validation loss decreased (-0.279958 --> -0.282309).  Saving model ...
Epoch: 27 cost time: 0.7164421081542969
Epoch: 27, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.403 Vali Acc: 0.279 Test Loss: 4.403 Test Acc: 0.279
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7100427150726318
Epoch: 28, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.452 Vali Acc: 0.279 Test Loss: 4.452 Test Acc: 0.279
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.7525119781494141
Epoch: 29, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.492 Vali Acc: 0.280 Test Loss: 4.492 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.8204150199890137
Epoch: 30, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.522 Vali Acc: 0.281 Test Loss: 4.522 Test Acc: 0.281
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.7118642330169678
Epoch: 31, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.563 Vali Acc: 0.280 Test Loss: 4.563 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.7467598915100098
Epoch: 32, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.589 Vali Acc: 0.278 Test Loss: 4.589 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.6592669486999512
Epoch: 33, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.620 Vali Acc: 0.282 Test Loss: 4.620 Test Acc: 0.282
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.7438335418701172
Epoch: 34, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.653 Vali Acc: 0.285 Test Loss: 4.653 Test Acc: 0.285
Validation loss decreased (-0.282309 --> -0.284659).  Saving model ...
Epoch: 35 cost time: 0.7140405178070068
Epoch: 35, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.684 Vali Acc: 0.287 Test Loss: 4.684 Test Acc: 0.287
Validation loss decreased (-0.284659 --> -0.287012).  Saving model ...
Epoch: 36 cost time: 0.7686367034912109
Epoch: 36, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.716 Vali Acc: 0.284 Test Loss: 4.716 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.7803494930267334
Epoch: 37, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.762 Vali Acc: 0.279 Test Loss: 4.762 Test Acc: 0.279
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.7156691551208496
Epoch: 38, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.793 Vali Acc: 0.278 Test Loss: 4.793 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.7292304039001465
Epoch: 39, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.803 Vali Acc: 0.280 Test Loss: 4.803 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.7677097320556641
Epoch: 40, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.822 Vali Acc: 0.278 Test Loss: 4.822 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.7867190837860107
Epoch: 41, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.853 Vali Acc: 0.279 Test Loss: 4.853 Test Acc: 0.279
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.7695431709289551
Epoch: 42, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.883 Vali Acc: 0.282 Test Loss: 4.883 Test Acc: 0.282
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.7754566669464111
Epoch: 43, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.896 Vali Acc: 0.281 Test Loss: 4.896 Test Acc: 0.281
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.7384533882141113
Epoch: 44, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.918 Vali Acc: 0.282 Test Loss: 4.918 Test Acc: 0.282
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.7874867916107178
Epoch: 45, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.939 Vali Acc: 0.286 Test Loss: 4.939 Test Acc: 0.286
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.28705882352941176
model parameter : 139578
model size : 0.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps12_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.40310001373291
Epoch: 1, Steps: 10 | Train Loss: 3.313 Vali Loss: 3.265 Vali Acc: 0.047 Test Loss: 3.265 Test Acc: 0.047
Validation loss decreased (inf --> -0.047026).  Saving model ...
Epoch: 2 cost time: 0.7341902256011963
Epoch: 2, Steps: 10 | Train Loss: 3.227 Vali Loss: 3.258 Vali Acc: 0.046 Test Loss: 3.258 Test Acc: 0.046
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7569694519042969
Epoch: 3, Steps: 10 | Train Loss: 3.136 Vali Loss: 3.249 Vali Acc: 0.061 Test Loss: 3.249 Test Acc: 0.061
Validation loss decreased (-0.047026 --> -0.061144).  Saving model ...
Epoch: 4 cost time: 0.7184188365936279
Epoch: 4, Steps: 10 | Train Loss: 3.043 Vali Loss: 3.244 Vali Acc: 0.078 Test Loss: 3.244 Test Acc: 0.078
Validation loss decreased (-0.061144 --> -0.077615).  Saving model ...
Epoch: 5 cost time: 0.7819457054138184
Epoch: 5, Steps: 10 | Train Loss: 2.934 Vali Loss: 3.245 Vali Acc: 0.085 Test Loss: 3.245 Test Acc: 0.085
Validation loss decreased (-0.077615 --> -0.084673).  Saving model ...
Epoch: 6 cost time: 0.7620141506195068
Epoch: 6, Steps: 10 | Train Loss: 2.791 Vali Loss: 3.242 Vali Acc: 0.092 Test Loss: 3.242 Test Acc: 0.092
Validation loss decreased (-0.084673 --> -0.091732).  Saving model ...
Epoch: 7 cost time: 0.7600240707397461
Epoch: 7, Steps: 10 | Train Loss: 2.677 Vali Loss: 3.237 Vali Acc: 0.094 Test Loss: 3.237 Test Acc: 0.094
Validation loss decreased (-0.091732 --> -0.094085).  Saving model ...
Epoch: 8 cost time: 0.7672672271728516
Epoch: 8, Steps: 10 | Train Loss: 2.483 Vali Loss: 3.219 Vali Acc: 0.104 Test Loss: 3.219 Test Acc: 0.104
Validation loss decreased (-0.094085 --> -0.103497).  Saving model ...
Epoch: 9 cost time: 0.6767411231994629
Epoch: 9, Steps: 10 | Train Loss: 2.363 Vali Loss: 3.210 Vali Acc: 0.107 Test Loss: 3.210 Test Acc: 0.107
Validation loss decreased (-0.103497 --> -0.107027).  Saving model ...
Epoch: 10 cost time: 0.7728118896484375
Epoch: 10, Steps: 10 | Train Loss: 2.155 Vali Loss: 3.191 Vali Acc: 0.119 Test Loss: 3.191 Test Acc: 0.119
Validation loss decreased (-0.107027 --> -0.118792).  Saving model ...
Epoch: 11 cost time: 0.8222260475158691
Epoch: 11, Steps: 10 | Train Loss: 1.946 Vali Loss: 3.183 Vali Acc: 0.139 Test Loss: 3.183 Test Acc: 0.139
Validation loss decreased (-0.118792 --> -0.138792).  Saving model ...
Epoch: 12 cost time: 0.7705378532409668
Epoch: 12, Steps: 10 | Train Loss: 1.728 Vali Loss: 3.183 Vali Acc: 0.171 Test Loss: 3.183 Test Acc: 0.171
Validation loss decreased (-0.138792 --> -0.170556).  Saving model ...
Epoch: 13 cost time: 0.7593259811401367
Epoch: 13, Steps: 10 | Train Loss: 1.494 Vali Loss: 3.181 Vali Acc: 0.179 Test Loss: 3.181 Test Acc: 0.179
Validation loss decreased (-0.170556 --> -0.178792).  Saving model ...
Epoch: 14 cost time: 0.7429609298706055
Epoch: 14, Steps: 10 | Train Loss: 1.271 Vali Loss: 3.190 Vali Acc: 0.188 Test Loss: 3.190 Test Acc: 0.188
Validation loss decreased (-0.178792 --> -0.188203).  Saving model ...
Epoch: 15 cost time: 0.7526869773864746
Epoch: 15, Steps: 10 | Train Loss: 1.067 Vali Loss: 3.220 Vali Acc: 0.206 Test Loss: 3.220 Test Acc: 0.206
Validation loss decreased (-0.188203 --> -0.205850).  Saving model ...
Epoch: 16 cost time: 0.7204663753509521
Epoch: 16, Steps: 10 | Train Loss: 0.855 Vali Loss: 3.251 Vali Acc: 0.213 Test Loss: 3.251 Test Acc: 0.213
Validation loss decreased (-0.205850 --> -0.212909).  Saving model ...
Epoch: 17 cost time: 0.7957553863525391
Epoch: 17, Steps: 10 | Train Loss: 0.670 Vali Loss: 3.310 Vali Acc: 0.221 Test Loss: 3.310 Test Acc: 0.221
Validation loss decreased (-0.212909 --> -0.221143).  Saving model ...
Epoch: 18 cost time: 0.6837306022644043
Epoch: 18, Steps: 10 | Train Loss: 0.532 Vali Loss: 3.388 Vali Acc: 0.222 Test Loss: 3.388 Test Acc: 0.222
Validation loss decreased (-0.221143 --> -0.222319).  Saving model ...
Epoch: 19 cost time: 0.7605822086334229
Epoch: 19, Steps: 10 | Train Loss: 0.410 Vali Loss: 3.433 Vali Acc: 0.239 Test Loss: 3.433 Test Acc: 0.239
Validation loss decreased (-0.222319 --> -0.238789).  Saving model ...
Epoch: 20 cost time: 0.7468457221984863
Epoch: 20, Steps: 10 | Train Loss: 0.295 Vali Loss: 3.512 Vali Acc: 0.246 Test Loss: 3.512 Test Acc: 0.246
Validation loss decreased (-0.238789 --> -0.245847).  Saving model ...
Epoch: 21 cost time: 0.7348635196685791
Epoch: 21, Steps: 10 | Train Loss: 0.226 Vali Loss: 3.609 Vali Acc: 0.236 Test Loss: 3.609 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7576785087585449
Epoch: 22, Steps: 10 | Train Loss: 0.182 Vali Loss: 3.674 Vali Acc: 0.234 Test Loss: 3.674 Test Acc: 0.234
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.7541813850402832
Epoch: 23, Steps: 10 | Train Loss: 0.154 Vali Loss: 3.742 Vali Acc: 0.234 Test Loss: 3.742 Test Acc: 0.234
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.7114419937133789
Epoch: 24, Steps: 10 | Train Loss: 0.123 Vali Loss: 3.821 Vali Acc: 0.236 Test Loss: 3.821 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.7644331455230713
Epoch: 25, Steps: 10 | Train Loss: 0.090 Vali Loss: 3.886 Vali Acc: 0.233 Test Loss: 3.886 Test Acc: 0.233
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.8367831707000732
Epoch: 26, Steps: 10 | Train Loss: 0.078 Vali Loss: 3.906 Vali Acc: 0.238 Test Loss: 3.906 Test Acc: 0.238
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.7656300067901611
Epoch: 27, Steps: 10 | Train Loss: 0.067 Vali Loss: 3.969 Vali Acc: 0.241 Test Loss: 3.969 Test Acc: 0.241
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.8004660606384277
Epoch: 28, Steps: 10 | Train Loss: 0.053 Vali Loss: 3.995 Vali Acc: 0.244 Test Loss: 3.995 Test Acc: 0.244
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.7924792766571045
Epoch: 29, Steps: 10 | Train Loss: 0.047 Vali Loss: 4.009 Vali Acc: 0.247 Test Loss: 4.009 Test Acc: 0.247
Validation loss decreased (-0.245847 --> -0.247019).  Saving model ...
Epoch: 30 cost time: 0.8317217826843262
Epoch: 30, Steps: 10 | Train Loss: 0.042 Vali Loss: 4.057 Vali Acc: 0.247 Test Loss: 4.057 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8021845817565918
Epoch: 31, Steps: 10 | Train Loss: 0.041 Vali Loss: 4.106 Vali Acc: 0.246 Test Loss: 4.106 Test Acc: 0.246
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.8583378791809082
Epoch: 32, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.150 Vali Acc: 0.245 Test Loss: 4.150 Test Acc: 0.245
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.9008252620697021
Epoch: 33, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.187 Vali Acc: 0.246 Test Loss: 4.187 Test Acc: 0.246
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.830207109451294
Epoch: 34, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.207 Vali Acc: 0.244 Test Loss: 4.207 Test Acc: 0.244
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.8059463500976562
Epoch: 35, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.226 Vali Acc: 0.242 Test Loss: 4.226 Test Acc: 0.242
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.8258731365203857
Epoch: 36, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.263 Vali Acc: 0.247 Test Loss: 4.263 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.8986198902130127
Epoch: 37, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.293 Vali Acc: 0.244 Test Loss: 4.293 Test Acc: 0.244
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.9297668933868408
Epoch: 38, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.335 Vali Acc: 0.245 Test Loss: 4.335 Test Acc: 0.245
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.8546972274780273
Epoch: 39, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.359 Vali Acc: 0.247 Test Loss: 4.359 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps12_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.24705882352941178
model parameter : 109754
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.097611665725708
Epoch: 1, Steps: 10 | Train Loss: 3.279 Vali Loss: 3.273 Vali Acc: 0.034 Test Loss: 3.273 Test Acc: 0.034
Validation loss decreased (inf --> -0.034085).  Saving model ...
Epoch: 2 cost time: 0.7131063938140869
Epoch: 2, Steps: 10 | Train Loss: 3.238 Vali Loss: 3.270 Vali Acc: 0.042 Test Loss: 3.270 Test Acc: 0.042
Validation loss decreased (-0.034085 --> -0.042320).  Saving model ...
Epoch: 3 cost time: 0.785923957824707
Epoch: 3, Steps: 10 | Train Loss: 3.172 Vali Loss: 3.268 Vali Acc: 0.041 Test Loss: 3.268 Test Acc: 0.041
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6994776725769043
Epoch: 4, Steps: 10 | Train Loss: 3.081 Vali Loss: 3.263 Vali Acc: 0.048 Test Loss: 3.263 Test Acc: 0.048
Validation loss decreased (-0.042320 --> -0.048203).  Saving model ...
Epoch: 5 cost time: 0.7609634399414062
Epoch: 5, Steps: 10 | Train Loss: 2.990 Vali Loss: 3.259 Vali Acc: 0.061 Test Loss: 3.259 Test Acc: 0.061
Validation loss decreased (-0.048203 --> -0.061144).  Saving model ...
Epoch: 6 cost time: 0.7583165168762207
Epoch: 6, Steps: 10 | Train Loss: 2.899 Vali Loss: 3.253 Vali Acc: 0.075 Test Loss: 3.253 Test Acc: 0.075
Validation loss decreased (-0.061144 --> -0.075262).  Saving model ...
Epoch: 7 cost time: 0.7812674045562744
Epoch: 7, Steps: 10 | Train Loss: 2.819 Vali Loss: 3.248 Vali Acc: 0.087 Test Loss: 3.248 Test Acc: 0.087
Validation loss decreased (-0.075262 --> -0.087026).  Saving model ...
Epoch: 8 cost time: 0.763681173324585
Epoch: 8, Steps: 10 | Train Loss: 2.706 Vali Loss: 3.235 Vali Acc: 0.093 Test Loss: 3.235 Test Acc: 0.093
Validation loss decreased (-0.087026 --> -0.092909).  Saving model ...
Epoch: 9 cost time: 0.7509064674377441
Epoch: 9, Steps: 10 | Train Loss: 2.599 Vali Loss: 3.224 Vali Acc: 0.111 Test Loss: 3.224 Test Acc: 0.111
Validation loss decreased (-0.092909 --> -0.110556).  Saving model ...
Epoch: 10 cost time: 0.7377176284790039
Epoch: 10, Steps: 10 | Train Loss: 2.427 Vali Loss: 3.207 Vali Acc: 0.124 Test Loss: 3.207 Test Acc: 0.124
Validation loss decreased (-0.110556 --> -0.123497).  Saving model ...
Epoch: 11 cost time: 0.7367494106292725
Epoch: 11, Steps: 10 | Train Loss: 2.275 Vali Loss: 3.188 Vali Acc: 0.138 Test Loss: 3.188 Test Acc: 0.138
Validation loss decreased (-0.123497 --> -0.137615).  Saving model ...
Epoch: 12 cost time: 0.7074534893035889
Epoch: 12, Steps: 10 | Train Loss: 2.111 Vali Loss: 3.173 Vali Acc: 0.146 Test Loss: 3.173 Test Acc: 0.146
Validation loss decreased (-0.137615 --> -0.145851).  Saving model ...
Epoch: 13 cost time: 0.7618145942687988
Epoch: 13, Steps: 10 | Train Loss: 1.910 Vali Loss: 3.167 Vali Acc: 0.162 Test Loss: 3.167 Test Acc: 0.162
Validation loss decreased (-0.145851 --> -0.162321).  Saving model ...
Epoch: 14 cost time: 0.7399671077728271
Epoch: 14, Steps: 10 | Train Loss: 1.727 Vali Loss: 3.158 Vali Acc: 0.173 Test Loss: 3.158 Test Acc: 0.173
Validation loss decreased (-0.162321 --> -0.172910).  Saving model ...
Epoch: 15 cost time: 0.7954370975494385
Epoch: 15, Steps: 10 | Train Loss: 1.538 Vali Loss: 3.156 Vali Acc: 0.188 Test Loss: 3.156 Test Acc: 0.188
Validation loss decreased (-0.172910 --> -0.188204).  Saving model ...
Epoch: 16 cost time: 0.6899487972259521
Epoch: 16, Steps: 10 | Train Loss: 1.356 Vali Loss: 3.159 Vali Acc: 0.192 Test Loss: 3.159 Test Acc: 0.192
Validation loss decreased (-0.188204 --> -0.191733).  Saving model ...
Epoch: 17 cost time: 0.761467695236206
Epoch: 17, Steps: 10 | Train Loss: 1.152 Vali Loss: 3.180 Vali Acc: 0.221 Test Loss: 3.180 Test Acc: 0.221
Validation loss decreased (-0.191733 --> -0.221145).  Saving model ...
Epoch: 18 cost time: 0.8137271404266357
Epoch: 18, Steps: 10 | Train Loss: 1.006 Vali Loss: 3.207 Vali Acc: 0.232 Test Loss: 3.207 Test Acc: 0.232
Validation loss decreased (-0.221145 --> -0.231733).  Saving model ...
Epoch: 19 cost time: 0.7754101753234863
Epoch: 19, Steps: 10 | Train Loss: 0.825 Vali Loss: 3.245 Vali Acc: 0.232 Test Loss: 3.245 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8395190238952637
Epoch: 20, Steps: 10 | Train Loss: 0.668 Vali Loss: 3.300 Vali Acc: 0.240 Test Loss: 3.300 Test Acc: 0.240
Validation loss decreased (-0.231733 --> -0.239967).  Saving model ...
Epoch: 21 cost time: 0.718677282333374
Epoch: 21, Steps: 10 | Train Loss: 0.516 Vali Loss: 3.354 Vali Acc: 0.252 Test Loss: 3.354 Test Acc: 0.252
Validation loss decreased (-0.239967 --> -0.251731).  Saving model ...
Epoch: 22 cost time: 0.7336840629577637
Epoch: 22, Steps: 10 | Train Loss: 0.411 Vali Loss: 3.401 Vali Acc: 0.264 Test Loss: 3.401 Test Acc: 0.264
Validation loss decreased (-0.251731 --> -0.263495).  Saving model ...
Epoch: 23 cost time: 0.6959211826324463
Epoch: 23, Steps: 10 | Train Loss: 0.327 Vali Loss: 3.456 Vali Acc: 0.276 Test Loss: 3.456 Test Acc: 0.276
Validation loss decreased (-0.263495 --> -0.276436).  Saving model ...
Epoch: 24 cost time: 0.696927547454834
Epoch: 24, Steps: 10 | Train Loss: 0.259 Vali Loss: 3.543 Vali Acc: 0.266 Test Loss: 3.543 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7371630668640137
Epoch: 25, Steps: 10 | Train Loss: 0.208 Vali Loss: 3.600 Vali Acc: 0.268 Test Loss: 3.600 Test Acc: 0.268
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.7645797729492188
Epoch: 26, Steps: 10 | Train Loss: 0.177 Vali Loss: 3.654 Vali Acc: 0.268 Test Loss: 3.654 Test Acc: 0.268
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.7020623683929443
Epoch: 27, Steps: 10 | Train Loss: 0.160 Vali Loss: 3.670 Vali Acc: 0.282 Test Loss: 3.670 Test Acc: 0.282
Validation loss decreased (-0.276436 --> -0.282316).  Saving model ...
Epoch: 28 cost time: 0.7623884677886963
Epoch: 28, Steps: 10 | Train Loss: 0.125 Vali Loss: 3.728 Vali Acc: 0.285 Test Loss: 3.728 Test Acc: 0.285
Validation loss decreased (-0.282316 --> -0.284669).  Saving model ...
Epoch: 29 cost time: 0.7552597522735596
Epoch: 29, Steps: 10 | Train Loss: 0.101 Vali Loss: 3.785 Vali Acc: 0.285 Test Loss: 3.785 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.8099803924560547
Epoch: 30, Steps: 10 | Train Loss: 0.087 Vali Loss: 3.835 Vali Acc: 0.284 Test Loss: 3.835 Test Acc: 0.284
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.7625079154968262
Epoch: 31, Steps: 10 | Train Loss: 0.074 Vali Loss: 3.858 Vali Acc: 0.284 Test Loss: 3.858 Test Acc: 0.284
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.7315130233764648
Epoch: 32, Steps: 10 | Train Loss: 0.068 Vali Loss: 3.907 Vali Acc: 0.287 Test Loss: 3.907 Test Acc: 0.287
Validation loss decreased (-0.284669 --> -0.287020).  Saving model ...
Epoch: 33 cost time: 0.7166736125946045
Epoch: 33, Steps: 10 | Train Loss: 0.056 Vali Loss: 3.941 Vali Acc: 0.280 Test Loss: 3.941 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.7363848686218262
Epoch: 34, Steps: 10 | Train Loss: 0.049 Vali Loss: 3.970 Vali Acc: 0.282 Test Loss: 3.970 Test Acc: 0.282
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.708829402923584
Epoch: 35, Steps: 10 | Train Loss: 0.041 Vali Loss: 3.984 Vali Acc: 0.288 Test Loss: 3.984 Test Acc: 0.288
Validation loss decreased (-0.287020 --> -0.288195).  Saving model ...
Epoch: 36 cost time: 0.7507040500640869
Epoch: 36, Steps: 10 | Train Loss: 0.042 Vali Loss: 4.007 Vali Acc: 0.298 Test Loss: 4.007 Test Acc: 0.298
Validation loss decreased (-0.288195 --> -0.297607).  Saving model ...
Epoch: 37 cost time: 0.7554044723510742
Epoch: 37, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.052 Vali Acc: 0.289 Test Loss: 4.052 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.7373268604278564
Epoch: 38, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.090 Vali Acc: 0.289 Test Loss: 4.090 Test Acc: 0.289
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.7002177238464355
Epoch: 39, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.126 Vali Acc: 0.288 Test Loss: 4.126 Test Acc: 0.288
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.7468421459197998
Epoch: 40, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.150 Vali Acc: 0.291 Test Loss: 4.150 Test Acc: 0.291
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.7326748371124268
Epoch: 41, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.169 Vali Acc: 0.292 Test Loss: 4.169 Test Acc: 0.292
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.7773959636688232
Epoch: 42, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.188 Vali Acc: 0.291 Test Loss: 4.188 Test Acc: 0.291
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.814359188079834
Epoch: 43, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.220 Vali Acc: 0.288 Test Loss: 4.220 Test Acc: 0.288
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.7454509735107422
Epoch: 44, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.251 Vali Acc: 0.289 Test Loss: 4.251 Test Acc: 0.289
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.7383055686950684
Epoch: 45, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.263 Vali Acc: 0.291 Test Loss: 4.263 Test Acc: 0.291
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 0.7063541412353516
Epoch: 46, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.293 Vali Acc: 0.292 Test Loss: 4.293 Test Acc: 0.292
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.29764705882352943
model parameter : 94906
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps23_str12_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.0222296714782715
Epoch: 1, Steps: 10 | Train Loss: 3.302 Vali Loss: 3.277 Vali Acc: 0.028 Test Loss: 3.277 Test Acc: 0.028
Validation loss decreased (inf --> -0.028203).  Saving model ...
Epoch: 2 cost time: 0.6946730613708496
Epoch: 2, Steps: 10 | Train Loss: 3.246 Vali Loss: 3.273 Vali Acc: 0.033 Test Loss: 3.273 Test Acc: 0.033
Validation loss decreased (-0.028203 --> -0.032908).  Saving model ...
Epoch: 3 cost time: 0.719508171081543
Epoch: 3, Steps: 10 | Train Loss: 3.203 Vali Loss: 3.267 Vali Acc: 0.032 Test Loss: 3.267 Test Acc: 0.032
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7027382850646973
Epoch: 4, Steps: 10 | Train Loss: 3.155 Vali Loss: 3.261 Vali Acc: 0.048 Test Loss: 3.261 Test Acc: 0.048
Validation loss decreased (-0.032908 --> -0.048203).  Saving model ...
Epoch: 5 cost time: 0.715907096862793
Epoch: 5, Steps: 10 | Train Loss: 3.085 Vali Loss: 3.257 Vali Acc: 0.056 Test Loss: 3.257 Test Acc: 0.056
Validation loss decreased (-0.048203 --> -0.056438).  Saving model ...
Epoch: 6 cost time: 0.763188362121582
Epoch: 6, Steps: 10 | Train Loss: 2.997 Vali Loss: 3.253 Vali Acc: 0.069 Test Loss: 3.253 Test Acc: 0.069
Validation loss decreased (-0.056438 --> -0.069379).  Saving model ...
Epoch: 7 cost time: 0.7837765216827393
Epoch: 7, Steps: 10 | Train Loss: 2.924 Vali Loss: 3.250 Vali Acc: 0.074 Test Loss: 3.250 Test Acc: 0.074
Validation loss decreased (-0.069379 --> -0.074085).  Saving model ...
Epoch: 8 cost time: 0.7387886047363281
Epoch: 8, Steps: 10 | Train Loss: 2.848 Vali Loss: 3.246 Vali Acc: 0.085 Test Loss: 3.246 Test Acc: 0.085
Validation loss decreased (-0.074085 --> -0.084673).  Saving model ...
Epoch: 9 cost time: 0.7546865940093994
Epoch: 9, Steps: 10 | Train Loss: 2.759 Vali Loss: 3.240 Vali Acc: 0.085 Test Loss: 3.240 Test Acc: 0.085
Validation loss decreased (-0.084673 --> -0.084673).  Saving model ...
Epoch: 10 cost time: 0.6952862739562988
Epoch: 10, Steps: 10 | Train Loss: 2.633 Vali Loss: 3.234 Vali Acc: 0.099 Test Loss: 3.234 Test Acc: 0.099
Validation loss decreased (-0.084673 --> -0.098791).  Saving model ...
Epoch: 11 cost time: 0.7827343940734863
Epoch: 11, Steps: 10 | Train Loss: 2.545 Vali Loss: 3.232 Vali Acc: 0.100 Test Loss: 3.232 Test Acc: 0.100
Validation loss decreased (-0.098791 --> -0.099968).  Saving model ...
Epoch: 12 cost time: 0.7271497249603271
Epoch: 12, Steps: 10 | Train Loss: 2.416 Vali Loss: 3.228 Vali Acc: 0.107 Test Loss: 3.228 Test Acc: 0.107
Validation loss decreased (-0.099968 --> -0.107027).  Saving model ...
Epoch: 13 cost time: 0.6977062225341797
Epoch: 13, Steps: 10 | Train Loss: 2.281 Vali Loss: 3.221 Vali Acc: 0.113 Test Loss: 3.221 Test Acc: 0.113
Validation loss decreased (-0.107027 --> -0.112909).  Saving model ...
Epoch: 14 cost time: 0.7356100082397461
Epoch: 14, Steps: 10 | Train Loss: 2.164 Vali Loss: 3.212 Vali Acc: 0.121 Test Loss: 3.212 Test Acc: 0.121
Validation loss decreased (-0.112909 --> -0.121144).  Saving model ...
Epoch: 15 cost time: 0.6747632026672363
Epoch: 15, Steps: 10 | Train Loss: 2.027 Vali Loss: 3.211 Vali Acc: 0.127 Test Loss: 3.211 Test Acc: 0.127
Validation loss decreased (-0.121144 --> -0.127027).  Saving model ...
Epoch: 16 cost time: 0.802248477935791
Epoch: 16, Steps: 10 | Train Loss: 1.870 Vali Loss: 3.213 Vali Acc: 0.140 Test Loss: 3.213 Test Acc: 0.140
Validation loss decreased (-0.127027 --> -0.139968).  Saving model ...
Epoch: 17 cost time: 0.7809538841247559
Epoch: 17, Steps: 10 | Train Loss: 1.725 Vali Loss: 3.212 Vali Acc: 0.159 Test Loss: 3.212 Test Acc: 0.159
Validation loss decreased (-0.139968 --> -0.158791).  Saving model ...
Epoch: 18 cost time: 0.7468562126159668
Epoch: 18, Steps: 10 | Train Loss: 1.599 Vali Loss: 3.224 Vali Acc: 0.174 Test Loss: 3.224 Test Acc: 0.174
Validation loss decreased (-0.158791 --> -0.174085).  Saving model ...
Epoch: 19 cost time: 0.7819583415985107
Epoch: 19, Steps: 10 | Train Loss: 1.439 Vali Loss: 3.237 Vali Acc: 0.185 Test Loss: 3.237 Test Acc: 0.185
Validation loss decreased (-0.174085 --> -0.184674).  Saving model ...
Epoch: 20 cost time: 0.8414723873138428
Epoch: 20, Steps: 10 | Train Loss: 1.268 Vali Loss: 3.258 Vali Acc: 0.191 Test Loss: 3.258 Test Acc: 0.191
Validation loss decreased (-0.184674 --> -0.190556).  Saving model ...
Epoch: 21 cost time: 0.8049850463867188
Epoch: 21, Steps: 10 | Train Loss: 1.133 Vali Loss: 3.279 Vali Acc: 0.199 Test Loss: 3.279 Test Acc: 0.199
Validation loss decreased (-0.190556 --> -0.198791).  Saving model ...
Epoch: 22 cost time: 0.8239114284515381
Epoch: 22, Steps: 10 | Train Loss: 0.987 Vali Loss: 3.309 Vali Acc: 0.202 Test Loss: 3.309 Test Acc: 0.202
Validation loss decreased (-0.198791 --> -0.202320).  Saving model ...
Epoch: 23 cost time: 0.7729361057281494
Epoch: 23, Steps: 10 | Train Loss: 0.877 Vali Loss: 3.351 Vali Acc: 0.211 Test Loss: 3.351 Test Acc: 0.211
Validation loss decreased (-0.202320 --> -0.210555).  Saving model ...
Epoch: 24 cost time: 0.7870538234710693
Epoch: 24, Steps: 10 | Train Loss: 0.765 Vali Loss: 3.397 Vali Acc: 0.215 Test Loss: 3.397 Test Acc: 0.215
Validation loss decreased (-0.210555 --> -0.215260).  Saving model ...
Epoch: 25 cost time: 0.8096439838409424
Epoch: 25, Steps: 10 | Train Loss: 0.642 Vali Loss: 3.449 Vali Acc: 0.226 Test Loss: 3.449 Test Acc: 0.226
Validation loss decreased (-0.215260 --> -0.225848).  Saving model ...
Epoch: 26 cost time: 0.74269700050354
Epoch: 26, Steps: 10 | Train Loss: 0.609 Vali Loss: 3.506 Vali Acc: 0.216 Test Loss: 3.506 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.7722432613372803
Epoch: 27, Steps: 10 | Train Loss: 0.475 Vali Loss: 3.556 Vali Acc: 0.226 Test Loss: 3.556 Test Acc: 0.226
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.7180075645446777
Epoch: 28, Steps: 10 | Train Loss: 0.415 Vali Loss: 3.611 Vali Acc: 0.220 Test Loss: 3.611 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.7943713665008545
Epoch: 29, Steps: 10 | Train Loss: 0.347 Vali Loss: 3.663 Vali Acc: 0.229 Test Loss: 3.663 Test Acc: 0.229
Validation loss decreased (-0.225848 --> -0.229375).  Saving model ...
Epoch: 30 cost time: 0.7173013687133789
Epoch: 30, Steps: 10 | Train Loss: 0.295 Vali Loss: 3.739 Vali Acc: 0.229 Test Loss: 3.739 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.7359356880187988
Epoch: 31, Steps: 10 | Train Loss: 0.252 Vali Loss: 3.781 Vali Acc: 0.233 Test Loss: 3.781 Test Acc: 0.233
Validation loss decreased (-0.229375 --> -0.232903).  Saving model ...
Epoch: 32 cost time: 0.7588095664978027
Epoch: 32, Steps: 10 | Train Loss: 0.221 Vali Loss: 3.836 Vali Acc: 0.231 Test Loss: 3.836 Test Acc: 0.231
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.7982745170593262
Epoch: 33, Steps: 10 | Train Loss: 0.186 Vali Loss: 3.872 Vali Acc: 0.234 Test Loss: 3.872 Test Acc: 0.234
Validation loss decreased (-0.232903 --> -0.234079).  Saving model ...
Epoch: 34 cost time: 0.64605712890625
Epoch: 34, Steps: 10 | Train Loss: 0.163 Vali Loss: 3.919 Vali Acc: 0.236 Test Loss: 3.919 Test Acc: 0.236
Validation loss decreased (-0.234079 --> -0.236431).  Saving model ...
Epoch: 35 cost time: 0.6782114505767822
Epoch: 35, Steps: 10 | Train Loss: 0.146 Vali Loss: 3.970 Vali Acc: 0.240 Test Loss: 3.970 Test Acc: 0.240
Validation loss decreased (-0.236431 --> -0.239960).  Saving model ...
Epoch: 36 cost time: 0.6861114501953125
Epoch: 36, Steps: 10 | Train Loss: 0.125 Vali Loss: 4.009 Vali Acc: 0.244 Test Loss: 4.009 Test Acc: 0.244
Validation loss decreased (-0.239960 --> -0.243489).  Saving model ...
Epoch: 37 cost time: 0.7107477188110352
Epoch: 37, Steps: 10 | Train Loss: 0.110 Vali Loss: 4.049 Vali Acc: 0.249 Test Loss: 4.049 Test Acc: 0.249
Validation loss decreased (-0.243489 --> -0.249371).  Saving model ...
Epoch: 38 cost time: 0.7808337211608887
Epoch: 38, Steps: 10 | Train Loss: 0.086 Vali Loss: 4.081 Vali Acc: 0.249 Test Loss: 4.081 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.7407116889953613
Epoch: 39, Steps: 10 | Train Loss: 0.087 Vali Loss: 4.115 Vali Acc: 0.252 Test Loss: 4.115 Test Acc: 0.252
Validation loss decreased (-0.249371 --> -0.251724).  Saving model ...
Epoch: 40 cost time: 0.69427490234375
Epoch: 40, Steps: 10 | Train Loss: 0.081 Vali Loss: 4.143 Vali Acc: 0.254 Test Loss: 4.143 Test Acc: 0.254
Validation loss decreased (-0.251724 --> -0.254076).  Saving model ...
Epoch: 41 cost time: 0.7997891902923584
Epoch: 41, Steps: 10 | Train Loss: 0.070 Vali Loss: 4.179 Vali Acc: 0.255 Test Loss: 4.179 Test Acc: 0.255
Validation loss decreased (-0.254076 --> -0.255252).  Saving model ...
Epoch: 42 cost time: 0.7388401031494141
Epoch: 42, Steps: 10 | Train Loss: 0.067 Vali Loss: 4.206 Vali Acc: 0.253 Test Loss: 4.206 Test Acc: 0.253
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.8522701263427734
Epoch: 43, Steps: 10 | Train Loss: 0.056 Vali Loss: 4.240 Vali Acc: 0.254 Test Loss: 4.240 Test Acc: 0.254
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.7678103446960449
Epoch: 44, Steps: 10 | Train Loss: 0.057 Vali Loss: 4.275 Vali Acc: 0.256 Test Loss: 4.275 Test Acc: 0.256
Validation loss decreased (-0.255252 --> -0.256428).  Saving model ...
Epoch: 45 cost time: 0.7941615581512451
Epoch: 45, Steps: 10 | Train Loss: 0.046 Vali Loss: 4.305 Vali Acc: 0.255 Test Loss: 4.305 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.7609808444976807
Epoch: 46, Steps: 10 | Train Loss: 0.044 Vali Loss: 4.340 Vali Acc: 0.256 Test Loss: 4.340 Test Acc: 0.256
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.7387890815734863
Epoch: 47, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.353 Vali Acc: 0.255 Test Loss: 4.353 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.7779843807220459
Epoch: 48, Steps: 10 | Train Loss: 0.038 Vali Loss: 4.364 Vali Acc: 0.255 Test Loss: 4.364 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.900303840637207
Epoch: 49, Steps: 10 | Train Loss: 0.037 Vali Loss: 4.393 Vali Acc: 0.258 Test Loss: 4.393 Test Acc: 0.258
Validation loss decreased (-0.256428 --> -0.257603).  Saving model ...
Epoch: 50 cost time: 0.8539276123046875
Epoch: 50, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.424 Vali Acc: 0.259 Test Loss: 4.424 Test Acc: 0.259
Validation loss decreased (-0.257603 --> -0.258779).  Saving model ...
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps23_str12_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.25882352941176473
model parameter : 75162
model size : 0.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.068899393081665
Epoch: 1, Steps: 10 | Train Loss: 3.305 Vali Loss: 3.275 Vali Acc: 0.035 Test Loss: 3.275 Test Acc: 0.035
Validation loss decreased (inf --> -0.035261).  Saving model ...
Epoch: 2 cost time: 0.7109375
Epoch: 2, Steps: 10 | Train Loss: 3.289 Vali Loss: 3.273 Vali Acc: 0.036 Test Loss: 3.273 Test Acc: 0.036
Validation loss decreased (-0.035261 --> -0.036438).  Saving model ...
Epoch: 3 cost time: 0.7691860198974609
Epoch: 3, Steps: 10 | Train Loss: 3.248 Vali Loss: 3.268 Vali Acc: 0.038 Test Loss: 3.268 Test Acc: 0.038
Validation loss decreased (-0.036438 --> -0.037614).  Saving model ...
Epoch: 4 cost time: 0.750941276550293
Epoch: 4, Steps: 10 | Train Loss: 3.186 Vali Loss: 3.261 Vali Acc: 0.044 Test Loss: 3.261 Test Acc: 0.044
Validation loss decreased (-0.037614 --> -0.043497).  Saving model ...
Epoch: 5 cost time: 0.7321035861968994
Epoch: 5, Steps: 10 | Train Loss: 3.120 Vali Loss: 3.255 Vali Acc: 0.048 Test Loss: 3.255 Test Acc: 0.048
Validation loss decreased (-0.043497 --> -0.048203).  Saving model ...
Epoch: 6 cost time: 0.7143917083740234
Epoch: 6, Steps: 10 | Train Loss: 3.075 Vali Loss: 3.251 Vali Acc: 0.056 Test Loss: 3.251 Test Acc: 0.056
Validation loss decreased (-0.048203 --> -0.056438).  Saving model ...
Epoch: 7 cost time: 0.7466390132904053
Epoch: 7, Steps: 10 | Train Loss: 3.028 Vali Loss: 3.247 Vali Acc: 0.060 Test Loss: 3.247 Test Acc: 0.060
Validation loss decreased (-0.056438 --> -0.059968).  Saving model ...
Epoch: 8 cost time: 0.7390375137329102
Epoch: 8, Steps: 10 | Train Loss: 2.936 Vali Loss: 3.242 Vali Acc: 0.072 Test Loss: 3.242 Test Acc: 0.072
Validation loss decreased (-0.059968 --> -0.071732).  Saving model ...
Epoch: 9 cost time: 0.7937326431274414
Epoch: 9, Steps: 10 | Train Loss: 2.856 Vali Loss: 3.242 Vali Acc: 0.084 Test Loss: 3.242 Test Acc: 0.084
Validation loss decreased (-0.071732 --> -0.083497).  Saving model ...
Epoch: 10 cost time: 0.8112313747406006
Epoch: 10, Steps: 10 | Train Loss: 2.789 Vali Loss: 3.238 Vali Acc: 0.096 Test Loss: 3.238 Test Acc: 0.096
Validation loss decreased (-0.083497 --> -0.096438).  Saving model ...
Epoch: 11 cost time: 0.6807248592376709
Epoch: 11, Steps: 10 | Train Loss: 2.687 Vali Loss: 3.232 Vali Acc: 0.099 Test Loss: 3.232 Test Acc: 0.099
Validation loss decreased (-0.096438 --> -0.098791).  Saving model ...
Epoch: 12 cost time: 0.7028908729553223
Epoch: 12, Steps: 10 | Train Loss: 2.595 Vali Loss: 3.229 Vali Acc: 0.107 Test Loss: 3.229 Test Acc: 0.107
Validation loss decreased (-0.098791 --> -0.107027).  Saving model ...
Epoch: 13 cost time: 0.6305720806121826
Epoch: 13, Steps: 10 | Train Loss: 2.486 Vali Loss: 3.224 Vali Acc: 0.113 Test Loss: 3.224 Test Acc: 0.113
Validation loss decreased (-0.107027 --> -0.112909).  Saving model ...
Epoch: 14 cost time: 0.7091100215911865
Epoch: 14, Steps: 10 | Train Loss: 2.366 Vali Loss: 3.219 Vali Acc: 0.118 Test Loss: 3.219 Test Acc: 0.118
Validation loss decreased (-0.112909 --> -0.117615).  Saving model ...
Epoch: 15 cost time: 0.743793249130249
Epoch: 15, Steps: 10 | Train Loss: 2.261 Vali Loss: 3.213 Vali Acc: 0.132 Test Loss: 3.213 Test Acc: 0.132
Validation loss decreased (-0.117615 --> -0.131733).  Saving model ...
Epoch: 16 cost time: 0.757286548614502
Epoch: 16, Steps: 10 | Train Loss: 2.148 Vali Loss: 3.210 Vali Acc: 0.140 Test Loss: 3.210 Test Acc: 0.140
Validation loss decreased (-0.131733 --> -0.139968).  Saving model ...
Epoch: 17 cost time: 0.7347011566162109
Epoch: 17, Steps: 10 | Train Loss: 2.038 Vali Loss: 3.210 Vali Acc: 0.142 Test Loss: 3.210 Test Acc: 0.142
Validation loss decreased (-0.139968 --> -0.142321).  Saving model ...
Epoch: 18 cost time: 0.7752933502197266
Epoch: 18, Steps: 10 | Train Loss: 1.868 Vali Loss: 3.213 Vali Acc: 0.145 Test Loss: 3.213 Test Acc: 0.145
Validation loss decreased (-0.142321 --> -0.144674).  Saving model ...
Epoch: 19 cost time: 0.8354499340057373
Epoch: 19, Steps: 10 | Train Loss: 1.691 Vali Loss: 3.220 Vali Acc: 0.158 Test Loss: 3.220 Test Acc: 0.158
Validation loss decreased (-0.144674 --> -0.157615).  Saving model ...
Epoch: 20 cost time: 0.7705671787261963
Epoch: 20, Steps: 10 | Train Loss: 1.601 Vali Loss: 3.232 Vali Acc: 0.158 Test Loss: 3.232 Test Acc: 0.158
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8181138038635254
Epoch: 21, Steps: 10 | Train Loss: 1.429 Vali Loss: 3.242 Vali Acc: 0.178 Test Loss: 3.242 Test Acc: 0.178
Validation loss decreased (-0.157615 --> -0.177615).  Saving model ...
Epoch: 22 cost time: 0.812570333480835
Epoch: 22, Steps: 10 | Train Loss: 1.304 Vali Loss: 3.255 Vali Acc: 0.178 Test Loss: 3.255 Test Acc: 0.178
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8013195991516113
Epoch: 23, Steps: 10 | Train Loss: 1.165 Vali Loss: 3.278 Vali Acc: 0.187 Test Loss: 3.278 Test Acc: 0.187
Validation loss decreased (-0.177615 --> -0.187026).  Saving model ...
Epoch: 24 cost time: 0.753075361251831
Epoch: 24, Steps: 10 | Train Loss: 1.051 Vali Loss: 3.304 Vali Acc: 0.188 Test Loss: 3.304 Test Acc: 0.188
Validation loss decreased (-0.187026 --> -0.188202).  Saving model ...
Epoch: 25 cost time: 0.7350685596466064
Epoch: 25, Steps: 10 | Train Loss: 0.903 Vali Loss: 3.337 Vali Acc: 0.195 Test Loss: 3.337 Test Acc: 0.195
Validation loss decreased (-0.188202 --> -0.195261).  Saving model ...
Epoch: 26 cost time: 0.8318729400634766
Epoch: 26, Steps: 10 | Train Loss: 0.836 Vali Loss: 3.363 Vali Acc: 0.202 Test Loss: 3.363 Test Acc: 0.202
Validation loss decreased (-0.195261 --> -0.202319).  Saving model ...
Epoch: 27 cost time: 0.7497696876525879
Epoch: 27, Steps: 10 | Train Loss: 0.680 Vali Loss: 3.396 Vali Acc: 0.206 Test Loss: 3.396 Test Acc: 0.206
Validation loss decreased (-0.202319 --> -0.205848).  Saving model ...
Epoch: 28 cost time: 0.7475569248199463
Epoch: 28, Steps: 10 | Train Loss: 0.614 Vali Loss: 3.435 Vali Acc: 0.204 Test Loss: 3.435 Test Acc: 0.204
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7233178615570068
Epoch: 29, Steps: 10 | Train Loss: 0.520 Vali Loss: 3.479 Vali Acc: 0.209 Test Loss: 3.479 Test Acc: 0.209
Validation loss decreased (-0.205848 --> -0.209377).  Saving model ...
Epoch: 30 cost time: 0.7115833759307861
Epoch: 30, Steps: 10 | Train Loss: 0.436 Vali Loss: 3.531 Vali Acc: 0.207 Test Loss: 3.531 Test Acc: 0.207
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.7253339290618896
Epoch: 31, Steps: 10 | Train Loss: 0.405 Vali Loss: 3.582 Vali Acc: 0.206 Test Loss: 3.582 Test Acc: 0.206
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.7914853096008301
Epoch: 32, Steps: 10 | Train Loss: 0.343 Vali Loss: 3.628 Vali Acc: 0.213 Test Loss: 3.628 Test Acc: 0.213
Validation loss decreased (-0.209377 --> -0.212905).  Saving model ...
Epoch: 33 cost time: 0.7297594547271729
Epoch: 33, Steps: 10 | Train Loss: 0.289 Vali Loss: 3.664 Vali Acc: 0.211 Test Loss: 3.664 Test Acc: 0.211
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.811105489730835
Epoch: 34, Steps: 10 | Train Loss: 0.249 Vali Loss: 3.702 Vali Acc: 0.219 Test Loss: 3.702 Test Acc: 0.219
Validation loss decreased (-0.212905 --> -0.218787).  Saving model ...
Epoch: 35 cost time: 0.8002378940582275
Epoch: 35, Steps: 10 | Train Loss: 0.213 Vali Loss: 3.752 Vali Acc: 0.221 Test Loss: 3.752 Test Acc: 0.221
Validation loss decreased (-0.218787 --> -0.221139).  Saving model ...
Epoch: 36 cost time: 0.800081729888916
Epoch: 36, Steps: 10 | Train Loss: 0.215 Vali Loss: 3.789 Vali Acc: 0.221 Test Loss: 3.789 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.8690807819366455
Epoch: 37, Steps: 10 | Train Loss: 0.173 Vali Loss: 3.832 Vali Acc: 0.227 Test Loss: 3.832 Test Acc: 0.227
Validation loss decreased (-0.221139 --> -0.227020).  Saving model ...
Epoch: 38 cost time: 0.9247655868530273
Epoch: 38, Steps: 10 | Train Loss: 0.154 Vali Loss: 3.872 Vali Acc: 0.228 Test Loss: 3.872 Test Acc: 0.228
Validation loss decreased (-0.227020 --> -0.228197).  Saving model ...
Epoch: 39 cost time: 0.8342058658599854
Epoch: 39, Steps: 10 | Train Loss: 0.131 Vali Loss: 3.930 Vali Acc: 0.226 Test Loss: 3.930 Test Acc: 0.226
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.7674438953399658
Epoch: 40, Steps: 10 | Train Loss: 0.126 Vali Loss: 3.966 Vali Acc: 0.229 Test Loss: 3.966 Test Acc: 0.229
Validation loss decreased (-0.228197 --> -0.229372).  Saving model ...
Epoch: 41 cost time: 0.8669764995574951
Epoch: 41, Steps: 10 | Train Loss: 0.103 Vali Loss: 3.994 Vali Acc: 0.229 Test Loss: 3.994 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.7794809341430664
Epoch: 42, Steps: 10 | Train Loss: 0.091 Vali Loss: 4.028 Vali Acc: 0.229 Test Loss: 4.028 Test Acc: 0.229
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.8902428150177002
Epoch: 43, Steps: 10 | Train Loss: 0.084 Vali Loss: 4.051 Vali Acc: 0.233 Test Loss: 4.051 Test Acc: 0.233
Validation loss decreased (-0.229372 --> -0.232901).  Saving model ...
Epoch: 44 cost time: 0.8661842346191406
Epoch: 44, Steps: 10 | Train Loss: 0.074 Vali Loss: 4.084 Vali Acc: 0.232 Test Loss: 4.084 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.7960193157196045
Epoch: 45, Steps: 10 | Train Loss: 0.072 Vali Loss: 4.120 Vali Acc: 0.235 Test Loss: 4.120 Test Acc: 0.235
Validation loss decreased (-0.232901 --> -0.235253).  Saving model ...
Epoch: 46 cost time: 0.8176422119140625
Epoch: 46, Steps: 10 | Train Loss: 0.067 Vali Loss: 4.133 Vali Acc: 0.232 Test Loss: 4.133 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.8454031944274902
Epoch: 47, Steps: 10 | Train Loss: 0.065 Vali Loss: 4.161 Vali Acc: 0.232 Test Loss: 4.161 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.8056957721710205
Epoch: 48, Steps: 10 | Train Loss: 0.054 Vali Loss: 4.205 Vali Acc: 0.231 Test Loss: 4.205 Test Acc: 0.231
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.8679656982421875
Epoch: 49, Steps: 10 | Train Loss: 0.053 Vali Loss: 4.229 Vali Acc: 0.238 Test Loss: 4.229 Test Acc: 0.238
Validation loss decreased (-0.235253 --> -0.237605).  Saving model ...
Epoch: 50 cost time: 0.7813546657562256
Epoch: 50, Steps: 10 | Train Loss: 0.045 Vali Loss: 4.248 Vali Acc: 0.240 Test Loss: 4.248 Test Acc: 0.240
Validation loss decreased (-0.237605 --> -0.239958).  Saving model ...
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.24
model parameter : 70426
model size : 0.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps38_str19_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.3803515434265137
Epoch: 1, Steps: 10 | Train Loss: 3.289 Vali Loss: 3.272 Vali Acc: 0.025 Test Loss: 3.272 Test Acc: 0.025
Validation loss decreased (inf --> -0.024673).  Saving model ...
Epoch: 2 cost time: 0.7614824771881104
Epoch: 2, Steps: 10 | Train Loss: 3.263 Vali Loss: 3.272 Vali Acc: 0.026 Test Loss: 3.272 Test Acc: 0.026
Validation loss decreased (-0.024673 --> -0.025850).  Saving model ...
Epoch: 3 cost time: 0.7337117195129395
Epoch: 3, Steps: 10 | Train Loss: 3.232 Vali Loss: 3.269 Vali Acc: 0.033 Test Loss: 3.269 Test Acc: 0.033
Validation loss decreased (-0.025850 --> -0.032908).  Saving model ...
Epoch: 4 cost time: 0.7456002235412598
Epoch: 4, Steps: 10 | Train Loss: 3.183 Vali Loss: 3.265 Vali Acc: 0.036 Test Loss: 3.265 Test Acc: 0.036
Validation loss decreased (-0.032908 --> -0.036438).  Saving model ...
Epoch: 5 cost time: 0.6938681602478027
Epoch: 5, Steps: 10 | Train Loss: 3.138 Vali Loss: 3.260 Vali Acc: 0.047 Test Loss: 3.260 Test Acc: 0.047
Validation loss decreased (-0.036438 --> -0.047026).  Saving model ...
Epoch: 6 cost time: 0.7091710567474365
Epoch: 6, Steps: 10 | Train Loss: 3.082 Vali Loss: 3.255 Vali Acc: 0.059 Test Loss: 3.255 Test Acc: 0.059
Validation loss decreased (-0.047026 --> -0.058791).  Saving model ...
Epoch: 7 cost time: 0.7542178630828857
Epoch: 7, Steps: 10 | Train Loss: 3.031 Vali Loss: 3.251 Vali Acc: 0.062 Test Loss: 3.251 Test Acc: 0.062
Validation loss decreased (-0.058791 --> -0.062320).  Saving model ...
Epoch: 8 cost time: 0.7837271690368652
Epoch: 8, Steps: 10 | Train Loss: 2.987 Vali Loss: 3.248 Vali Acc: 0.068 Test Loss: 3.248 Test Acc: 0.068
Validation loss decreased (-0.062320 --> -0.068203).  Saving model ...
Epoch: 9 cost time: 0.733018159866333
Epoch: 9, Steps: 10 | Train Loss: 2.920 Vali Loss: 3.244 Vali Acc: 0.072 Test Loss: 3.244 Test Acc: 0.072
Validation loss decreased (-0.068203 --> -0.071732).  Saving model ...
Epoch: 10 cost time: 0.7290253639221191
Epoch: 10, Steps: 10 | Train Loss: 2.860 Vali Loss: 3.239 Vali Acc: 0.079 Test Loss: 3.239 Test Acc: 0.079
Validation loss decreased (-0.071732 --> -0.078791).  Saving model ...
Epoch: 11 cost time: 0.7433364391326904
Epoch: 11, Steps: 10 | Train Loss: 2.764 Vali Loss: 3.234 Vali Acc: 0.100 Test Loss: 3.234 Test Acc: 0.100
Validation loss decreased (-0.078791 --> -0.099968).  Saving model ...
Epoch: 12 cost time: 0.7517874240875244
Epoch: 12, Steps: 10 | Train Loss: 2.697 Vali Loss: 3.228 Vali Acc: 0.107 Test Loss: 3.228 Test Acc: 0.107
Validation loss decreased (-0.099968 --> -0.107027).  Saving model ...
Epoch: 13 cost time: 0.8233747482299805
Epoch: 13, Steps: 10 | Train Loss: 2.596 Vali Loss: 3.226 Vali Acc: 0.113 Test Loss: 3.226 Test Acc: 0.113
Validation loss decreased (-0.107027 --> -0.112909).  Saving model ...
Epoch: 14 cost time: 0.719750165939331
Epoch: 14, Steps: 10 | Train Loss: 2.507 Vali Loss: 3.222 Vali Acc: 0.114 Test Loss: 3.222 Test Acc: 0.114
Validation loss decreased (-0.112909 --> -0.114085).  Saving model ...
Epoch: 15 cost time: 0.7521936893463135
Epoch: 15, Steps: 10 | Train Loss: 2.404 Vali Loss: 3.218 Vali Acc: 0.124 Test Loss: 3.218 Test Acc: 0.124
Validation loss decreased (-0.114085 --> -0.123497).  Saving model ...
Epoch: 16 cost time: 0.745171070098877
Epoch: 16, Steps: 10 | Train Loss: 2.309 Vali Loss: 3.211 Vali Acc: 0.131 Test Loss: 3.211 Test Acc: 0.131
Validation loss decreased (-0.123497 --> -0.130556).  Saving model ...
Epoch: 17 cost time: 0.7198214530944824
Epoch: 17, Steps: 10 | Train Loss: 2.181 Vali Loss: 3.213 Vali Acc: 0.142 Test Loss: 3.213 Test Acc: 0.142
Validation loss decreased (-0.130556 --> -0.142321).  Saving model ...
Epoch: 18 cost time: 0.6937425136566162
Epoch: 18, Steps: 10 | Train Loss: 2.080 Vali Loss: 3.211 Vali Acc: 0.147 Test Loss: 3.211 Test Acc: 0.147
Validation loss decreased (-0.142321 --> -0.147027).  Saving model ...
Epoch: 19 cost time: 0.6918139457702637
Epoch: 19, Steps: 10 | Train Loss: 1.919 Vali Loss: 3.209 Vali Acc: 0.149 Test Loss: 3.209 Test Acc: 0.149
Validation loss decreased (-0.147027 --> -0.149380).  Saving model ...
Epoch: 20 cost time: 0.7170164585113525
Epoch: 20, Steps: 10 | Train Loss: 1.803 Vali Loss: 3.214 Vali Acc: 0.158 Test Loss: 3.214 Test Acc: 0.158
Validation loss decreased (-0.149380 --> -0.157615).  Saving model ...
Epoch: 21 cost time: 0.7627949714660645
Epoch: 21, Steps: 10 | Train Loss: 1.720 Vali Loss: 3.218 Vali Acc: 0.162 Test Loss: 3.218 Test Acc: 0.162
Validation loss decreased (-0.157615 --> -0.162321).  Saving model ...
Epoch: 22 cost time: 0.832200288772583
Epoch: 22, Steps: 10 | Train Loss: 1.534 Vali Loss: 3.223 Vali Acc: 0.168 Test Loss: 3.223 Test Acc: 0.168
Validation loss decreased (-0.162321 --> -0.168203).  Saving model ...
Epoch: 23 cost time: 0.7235755920410156
Epoch: 23, Steps: 10 | Train Loss: 1.390 Vali Loss: 3.232 Vali Acc: 0.176 Test Loss: 3.232 Test Acc: 0.176
Validation loss decreased (-0.168203 --> -0.176438).  Saving model ...
Epoch: 24 cost time: 0.6878390312194824
Epoch: 24, Steps: 10 | Train Loss: 1.282 Vali Loss: 3.254 Vali Acc: 0.179 Test Loss: 3.254 Test Acc: 0.179
Validation loss decreased (-0.176438 --> -0.178791).  Saving model ...
Epoch: 25 cost time: 0.73569655418396
Epoch: 25, Steps: 10 | Train Loss: 1.148 Vali Loss: 3.270 Vali Acc: 0.181 Test Loss: 3.270 Test Acc: 0.181
Validation loss decreased (-0.178791 --> -0.181144).  Saving model ...
Epoch: 26 cost time: 0.7320585250854492
Epoch: 26, Steps: 10 | Train Loss: 1.025 Vali Loss: 3.293 Vali Acc: 0.188 Test Loss: 3.293 Test Acc: 0.188
Validation loss decreased (-0.181144 --> -0.188202).  Saving model ...
Epoch: 27 cost time: 0.7129709720611572
Epoch: 27, Steps: 10 | Train Loss: 0.903 Vali Loss: 3.314 Vali Acc: 0.193 Test Loss: 3.314 Test Acc: 0.193
Validation loss decreased (-0.188202 --> -0.192908).  Saving model ...
Epoch: 28 cost time: 0.8273220062255859
Epoch: 28, Steps: 10 | Train Loss: 0.818 Vali Loss: 3.343 Vali Acc: 0.202 Test Loss: 3.343 Test Acc: 0.202
Validation loss decreased (-0.192908 --> -0.202320).  Saving model ...
Epoch: 29 cost time: 0.7817628383636475
Epoch: 29, Steps: 10 | Train Loss: 0.701 Vali Loss: 3.382 Vali Acc: 0.207 Test Loss: 3.382 Test Acc: 0.207
Validation loss decreased (-0.202320 --> -0.207025).  Saving model ...
Epoch: 30 cost time: 0.7934174537658691
Epoch: 30, Steps: 10 | Train Loss: 0.614 Vali Loss: 3.422 Vali Acc: 0.214 Test Loss: 3.422 Test Acc: 0.214
Validation loss decreased (-0.207025 --> -0.214083).  Saving model ...
Epoch: 31 cost time: 0.8003408908843994
Epoch: 31, Steps: 10 | Train Loss: 0.532 Vali Loss: 3.471 Vali Acc: 0.221 Test Loss: 3.471 Test Acc: 0.221
Validation loss decreased (-0.214083 --> -0.221142).  Saving model ...
Epoch: 32 cost time: 0.7920856475830078
Epoch: 32, Steps: 10 | Train Loss: 0.471 Vali Loss: 3.505 Vali Acc: 0.222 Test Loss: 3.505 Test Acc: 0.222
Validation loss decreased (-0.221142 --> -0.222318).  Saving model ...
Epoch: 33 cost time: 0.8541452884674072
Epoch: 33, Steps: 10 | Train Loss: 0.405 Vali Loss: 3.557 Vali Acc: 0.226 Test Loss: 3.557 Test Acc: 0.226
Validation loss decreased (-0.222318 --> -0.225847).  Saving model ...
Epoch: 34 cost time: 0.7921192646026611
Epoch: 34, Steps: 10 | Train Loss: 0.361 Vali Loss: 3.603 Vali Acc: 0.227 Test Loss: 3.603 Test Acc: 0.227
Validation loss decreased (-0.225847 --> -0.227023).  Saving model ...
Epoch: 35 cost time: 0.8015480041503906
Epoch: 35, Steps: 10 | Train Loss: 0.308 Vali Loss: 3.645 Vali Acc: 0.233 Test Loss: 3.645 Test Acc: 0.233
Validation loss decreased (-0.227023 --> -0.232905).  Saving model ...
Epoch: 36 cost time: 0.7721641063690186
Epoch: 36, Steps: 10 | Train Loss: 0.277 Vali Loss: 3.703 Vali Acc: 0.235 Test Loss: 3.703 Test Acc: 0.235
Validation loss decreased (-0.232905 --> -0.235257).  Saving model ...
Epoch: 37 cost time: 0.8106551170349121
Epoch: 37, Steps: 10 | Train Loss: 0.229 Vali Loss: 3.728 Vali Acc: 0.242 Test Loss: 3.728 Test Acc: 0.242
Validation loss decreased (-0.235257 --> -0.242316).  Saving model ...
Epoch: 38 cost time: 0.848438024520874
Epoch: 38, Steps: 10 | Train Loss: 0.205 Vali Loss: 3.764 Vali Acc: 0.241 Test Loss: 3.764 Test Acc: 0.241
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.8172473907470703
Epoch: 39, Steps: 10 | Train Loss: 0.190 Vali Loss: 3.790 Vali Acc: 0.240 Test Loss: 3.790 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.8122580051422119
Epoch: 40, Steps: 10 | Train Loss: 0.163 Vali Loss: 3.823 Vali Acc: 0.248 Test Loss: 3.823 Test Acc: 0.248
Validation loss decreased (-0.242316 --> -0.248197).  Saving model ...
Epoch: 41 cost time: 0.8250799179077148
Epoch: 41, Steps: 10 | Train Loss: 0.142 Vali Loss: 3.875 Vali Acc: 0.244 Test Loss: 3.875 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.7385656833648682
Epoch: 42, Steps: 10 | Train Loss: 0.138 Vali Loss: 3.911 Vali Acc: 0.240 Test Loss: 3.911 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.7823536396026611
Epoch: 43, Steps: 10 | Train Loss: 0.116 Vali Loss: 3.967 Vali Acc: 0.245 Test Loss: 3.967 Test Acc: 0.245
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.7894337177276611
Epoch: 44, Steps: 10 | Train Loss: 0.115 Vali Loss: 3.999 Vali Acc: 0.255 Test Loss: 3.999 Test Acc: 0.255
Validation loss decreased (-0.248197 --> -0.255254).  Saving model ...
Epoch: 45 cost time: 0.7906427383422852
Epoch: 45, Steps: 10 | Train Loss: 0.107 Vali Loss: 4.040 Vali Acc: 0.251 Test Loss: 4.040 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.7523708343505859
Epoch: 46, Steps: 10 | Train Loss: 0.089 Vali Loss: 4.077 Vali Acc: 0.247 Test Loss: 4.077 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.7550356388092041
Epoch: 47, Steps: 10 | Train Loss: 0.086 Vali Loss: 4.093 Vali Acc: 0.246 Test Loss: 4.093 Test Acc: 0.246
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.8271889686584473
Epoch: 48, Steps: 10 | Train Loss: 0.074 Vali Loss: 4.106 Vali Acc: 0.252 Test Loss: 4.106 Test Acc: 0.252
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.8019495010375977
Epoch: 49, Steps: 10 | Train Loss: 0.067 Vali Loss: 4.148 Vali Acc: 0.252 Test Loss: 4.148 Test Acc: 0.252
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.809777021408081
Epoch: 50, Steps: 10 | Train Loss: 0.058 Vali Loss: 4.179 Vali Acc: 0.253 Test Loss: 4.179 Test Acc: 0.253
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps38_str19_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.25529411764705884
model parameter : 65658
model size : 0.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.454582691192627
Epoch: 1, Steps: 10 | Train Loss: 3.283 Vali Loss: 3.275 Vali Acc: 0.045 Test Loss: 3.275 Test Acc: 0.045
Validation loss decreased (inf --> -0.044673).  Saving model ...
Epoch: 2 cost time: 1.0770859718322754
Epoch: 2, Steps: 10 | Train Loss: 2.909 Vali Loss: 3.356 Vali Acc: 0.086 Test Loss: 3.356 Test Acc: 0.086
Validation loss decreased (-0.044673 --> -0.085849).  Saving model ...
Epoch: 3 cost time: 1.179201364517212
Epoch: 3, Steps: 10 | Train Loss: 2.282 Vali Loss: 3.213 Vali Acc: 0.169 Test Loss: 3.213 Test Acc: 0.169
Validation loss decreased (-0.085849 --> -0.169380).  Saving model ...
Epoch: 4 cost time: 1.1149873733520508
Epoch: 4, Steps: 10 | Train Loss: 1.503 Vali Loss: 3.204 Vali Acc: 0.186 Test Loss: 3.204 Test Acc: 0.186
Validation loss decreased (-0.169380 --> -0.185850).  Saving model ...
Epoch: 5 cost time: 1.0515360832214355
Epoch: 5, Steps: 10 | Train Loss: 0.775 Vali Loss: 3.513 Vali Acc: 0.221 Test Loss: 3.513 Test Acc: 0.221
Validation loss decreased (-0.185850 --> -0.221141).  Saving model ...
Epoch: 6 cost time: 1.1458508968353271
Epoch: 6, Steps: 10 | Train Loss: 0.342 Vali Loss: 3.913 Vali Acc: 0.240 Test Loss: 3.913 Test Acc: 0.240
Validation loss decreased (-0.221141 --> -0.239961).  Saving model ...
Epoch: 7 cost time: 1.137439250946045
Epoch: 7, Steps: 10 | Train Loss: 0.134 Vali Loss: 4.347 Vali Acc: 0.255 Test Loss: 4.347 Test Acc: 0.255
Validation loss decreased (-0.239961 --> -0.255251).  Saving model ...
Epoch: 8 cost time: 1.110278606414795
Epoch: 8, Steps: 10 | Train Loss: 0.057 Vali Loss: 4.879 Vali Acc: 0.245 Test Loss: 4.879 Test Acc: 0.245
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2096483707427979
Epoch: 9, Steps: 10 | Train Loss: 0.014 Vali Loss: 5.021 Vali Acc: 0.262 Test Loss: 5.021 Test Acc: 0.262
Validation loss decreased (-0.255251 --> -0.262303).  Saving model ...
Epoch: 10 cost time: 1.268491506576538
Epoch: 10, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.166 Vali Acc: 0.254 Test Loss: 5.166 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.208970308303833
Epoch: 11, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.237 Vali Acc: 0.253 Test Loss: 5.237 Test Acc: 0.253
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2034695148468018
Epoch: 12, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.265 Vali Acc: 0.268 Test Loss: 5.265 Test Acc: 0.268
Validation loss decreased (-0.262303 --> -0.268183).  Saving model ...
Epoch: 13 cost time: 1.2339458465576172
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.320 Vali Acc: 0.269 Test Loss: 5.320 Test Acc: 0.269
Validation loss decreased (-0.268183 --> -0.269359).  Saving model ...
Epoch: 14 cost time: 1.236060380935669
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.356 Vali Acc: 0.273 Test Loss: 5.356 Test Acc: 0.273
Validation loss decreased (-0.269359 --> -0.272888).  Saving model ...
Epoch: 15 cost time: 1.1304233074188232
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.387 Vali Acc: 0.272 Test Loss: 5.387 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2036683559417725
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.422 Vali Acc: 0.272 Test Loss: 5.422 Test Acc: 0.272
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.1471734046936035
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.435 Vali Acc: 0.271 Test Loss: 5.435 Test Acc: 0.271
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.1563527584075928
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.463 Vali Acc: 0.272 Test Loss: 5.463 Test Acc: 0.272
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.1781883239746094
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.495 Vali Acc: 0.273 Test Loss: 5.495 Test Acc: 0.273
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.235950231552124
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.516 Vali Acc: 0.273 Test Loss: 5.516 Test Acc: 0.273
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.1816339492797852
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.532 Vali Acc: 0.274 Test Loss: 5.532 Test Acc: 0.274
Validation loss decreased (-0.272888 --> -0.274062).  Saving model ...
Epoch: 22 cost time: 1.1589725017547607
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.564 Vali Acc: 0.274 Test Loss: 5.564 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.1621270179748535
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.596 Vali Acc: 0.273 Test Loss: 5.596 Test Acc: 0.273
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.1327602863311768
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.626 Vali Acc: 0.274 Test Loss: 5.626 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.208265781402588
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.651 Vali Acc: 0.274 Test Loss: 5.651 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.2093291282653809
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.670 Vali Acc: 0.273 Test Loss: 5.670 Test Acc: 0.273
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.1656627655029297
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.681 Vali Acc: 0.275 Test Loss: 5.681 Test Acc: 0.275
Validation loss decreased (-0.274062 --> -0.275237).  Saving model ...
Epoch: 28 cost time: 1.175410509109497
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.713 Vali Acc: 0.274 Test Loss: 5.713 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.0861544609069824
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.742 Vali Acc: 0.275 Test Loss: 5.742 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.2001469135284424
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.763 Vali Acc: 0.272 Test Loss: 5.763 Test Acc: 0.272
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.1093502044677734
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.777 Vali Acc: 0.272 Test Loss: 5.777 Test Acc: 0.272
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.2076747417449951
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.793 Vali Acc: 0.273 Test Loss: 5.793 Test Acc: 0.273
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.1563022136688232
Epoch: 33, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.814 Vali Acc: 0.275 Test Loss: 5.814 Test Acc: 0.275
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.261723279953003
Epoch: 34, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.855 Vali Acc: 0.273 Test Loss: 5.855 Test Acc: 0.273
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.207958698272705
Epoch: 35, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.870 Vali Acc: 0.273 Test Loss: 5.870 Test Acc: 0.273
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.2178459167480469
Epoch: 36, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.891 Vali Acc: 0.273 Test Loss: 5.891 Test Acc: 0.273
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.169693946838379
Epoch: 37, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.893 Vali Acc: 0.272 Test Loss: 5.893 Test Acc: 0.272
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2752941176470588
model parameter : 1350298
model size : 5.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.394080400466919
Epoch: 1, Steps: 10 | Train Loss: 3.282 Vali Loss: 3.260 Vali Acc: 0.053 Test Loss: 3.260 Test Acc: 0.053
Validation loss decreased (inf --> -0.052909).  Saving model ...
Epoch: 2 cost time: 1.043273687362671
Epoch: 2, Steps: 10 | Train Loss: 3.051 Vali Loss: 3.289 Vali Acc: 0.078 Test Loss: 3.289 Test Acc: 0.078
Validation loss decreased (-0.052909 --> -0.077614).  Saving model ...
Epoch: 3 cost time: 1.0613844394683838
Epoch: 3, Steps: 10 | Train Loss: 2.725 Vali Loss: 3.300 Vali Acc: 0.098 Test Loss: 3.300 Test Acc: 0.098
Validation loss decreased (-0.077614 --> -0.097614).  Saving model ...
Epoch: 4 cost time: 1.1550073623657227
Epoch: 4, Steps: 10 | Train Loss: 2.284 Vali Loss: 3.216 Vali Acc: 0.156 Test Loss: 3.216 Test Acc: 0.156
Validation loss decreased (-0.097614 --> -0.156438).  Saving model ...
Epoch: 5 cost time: 1.1424283981323242
Epoch: 5, Steps: 10 | Train Loss: 1.732 Vali Loss: 3.168 Vali Acc: 0.185 Test Loss: 3.168 Test Acc: 0.185
Validation loss decreased (-0.156438 --> -0.184674).  Saving model ...
Epoch: 6 cost time: 1.0586800575256348
Epoch: 6, Steps: 10 | Train Loss: 1.148 Vali Loss: 3.297 Vali Acc: 0.196 Test Loss: 3.297 Test Acc: 0.196
Validation loss decreased (-0.184674 --> -0.196438).  Saving model ...
Epoch: 7 cost time: 1.074293613433838
Epoch: 7, Steps: 10 | Train Loss: 0.691 Vali Loss: 3.422 Vali Acc: 0.235 Test Loss: 3.422 Test Acc: 0.235
Validation loss decreased (-0.196438 --> -0.235260).  Saving model ...
Epoch: 8 cost time: 1.1022777557373047
Epoch: 8, Steps: 10 | Train Loss: 0.338 Vali Loss: 3.703 Vali Acc: 0.253 Test Loss: 3.703 Test Acc: 0.253
Validation loss decreased (-0.235260 --> -0.252904).  Saving model ...
Epoch: 9 cost time: 1.0599169731140137
Epoch: 9, Steps: 10 | Train Loss: 0.167 Vali Loss: 4.079 Vali Acc: 0.254 Test Loss: 4.079 Test Acc: 0.254
Validation loss decreased (-0.252904 --> -0.254077).  Saving model ...
Epoch: 10 cost time: 1.031207799911499
Epoch: 10, Steps: 10 | Train Loss: 0.062 Vali Loss: 4.327 Vali Acc: 0.262 Test Loss: 4.327 Test Acc: 0.262
Validation loss decreased (-0.254077 --> -0.262310).  Saving model ...
Epoch: 11 cost time: 1.1658096313476562
Epoch: 11, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.478 Vali Acc: 0.261 Test Loss: 4.478 Test Acc: 0.261
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0368187427520752
Epoch: 12, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.545 Vali Acc: 0.273 Test Loss: 4.545 Test Acc: 0.273
Validation loss decreased (-0.262310 --> -0.272896).  Saving model ...
Epoch: 13 cost time: 1.0692574977874756
Epoch: 13, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.739 Vali Acc: 0.271 Test Loss: 4.739 Test Acc: 0.271
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1410388946533203
Epoch: 14, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.873 Vali Acc: 0.261 Test Loss: 4.873 Test Acc: 0.261
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.106311559677124
Epoch: 15, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.847 Vali Acc: 0.269 Test Loss: 4.847 Test Acc: 0.269
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9768872261047363
Epoch: 16, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.892 Vali Acc: 0.275 Test Loss: 4.892 Test Acc: 0.275
Validation loss decreased (-0.272896 --> -0.275245).  Saving model ...
Epoch: 17 cost time: 1.068537712097168
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.951 Vali Acc: 0.276 Test Loss: 4.951 Test Acc: 0.276
Validation loss decreased (-0.275245 --> -0.276421).  Saving model ...
Epoch: 18 cost time: 1.0590362548828125
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.997 Vali Acc: 0.274 Test Loss: 4.997 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0582880973815918
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.038 Vali Acc: 0.273 Test Loss: 5.038 Test Acc: 0.273
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.0893514156341553
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.071 Vali Acc: 0.274 Test Loss: 5.071 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.1188209056854248
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.090 Vali Acc: 0.274 Test Loss: 5.090 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.095649003982544
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.117 Vali Acc: 0.275 Test Loss: 5.117 Test Acc: 0.275
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.142836332321167
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.153 Vali Acc: 0.278 Test Loss: 5.153 Test Acc: 0.278
Validation loss decreased (-0.276421 --> -0.277596).  Saving model ...
Epoch: 24 cost time: 1.1209642887115479
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.176 Vali Acc: 0.281 Test Loss: 5.176 Test Acc: 0.281
Validation loss decreased (-0.277596 --> -0.281125).  Saving model ...
Epoch: 25 cost time: 1.069288969039917
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.213 Vali Acc: 0.281 Test Loss: 5.213 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.126701831817627
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.250 Vali Acc: 0.282 Test Loss: 5.250 Test Acc: 0.282
Validation loss decreased (-0.281125 --> -0.282300).  Saving model ...
Epoch: 27 cost time: 1.098768949508667
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.280 Vali Acc: 0.281 Test Loss: 5.280 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.1133463382720947
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.295 Vali Acc: 0.279 Test Loss: 5.295 Test Acc: 0.279
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.0586073398590088
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.326 Vali Acc: 0.282 Test Loss: 5.326 Test Acc: 0.282
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.0583314895629883
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.362 Vali Acc: 0.281 Test Loss: 5.362 Test Acc: 0.281
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.0901455879211426
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.392 Vali Acc: 0.282 Test Loss: 5.392 Test Acc: 0.282
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.0319600105285645
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.409 Vali Acc: 0.281 Test Loss: 5.409 Test Acc: 0.281
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.9732096195220947
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.436 Vali Acc: 0.280 Test Loss: 5.436 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.0229246616363525
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.464 Vali Acc: 0.281 Test Loss: 5.464 Test Acc: 0.281
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.1097331047058105
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.485 Vali Acc: 0.280 Test Loss: 5.485 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.0849924087524414
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.501 Vali Acc: 0.280 Test Loss: 5.501 Test Acc: 0.280
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2823529411764706
model parameter : 971418
model size : 3.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps12_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.34539794921875
Epoch: 1, Steps: 10 | Train Loss: 3.311 Vali Loss: 3.274 Vali Acc: 0.040 Test Loss: 3.274 Test Acc: 0.040
Validation loss decreased (inf --> -0.039967).  Saving model ...
Epoch: 2 cost time: 1.0557470321655273
Epoch: 2, Steps: 10 | Train Loss: 3.106 Vali Loss: 3.270 Vali Acc: 0.053 Test Loss: 3.270 Test Acc: 0.053
Validation loss decreased (-0.039967 --> -0.052908).  Saving model ...
Epoch: 3 cost time: 1.0973467826843262
Epoch: 3, Steps: 10 | Train Loss: 2.843 Vali Loss: 3.287 Vali Acc: 0.065 Test Loss: 3.287 Test Acc: 0.065
Validation loss decreased (-0.052908 --> -0.064673).  Saving model ...
Epoch: 4 cost time: 1.0450170040130615
Epoch: 4, Steps: 10 | Train Loss: 2.483 Vali Loss: 3.250 Vali Acc: 0.134 Test Loss: 3.250 Test Acc: 0.134
Validation loss decreased (-0.064673 --> -0.134085).  Saving model ...
Epoch: 5 cost time: 1.0442194938659668
Epoch: 5, Steps: 10 | Train Loss: 2.084 Vali Loss: 3.195 Vali Acc: 0.144 Test Loss: 3.195 Test Acc: 0.144
Validation loss decreased (-0.134085 --> -0.143497).  Saving model ...
Epoch: 6 cost time: 1.0899629592895508
Epoch: 6, Steps: 10 | Train Loss: 1.621 Vali Loss: 3.174 Vali Acc: 0.168 Test Loss: 3.174 Test Acc: 0.168
Validation loss decreased (-0.143497 --> -0.168204).  Saving model ...
Epoch: 7 cost time: 1.0727932453155518
Epoch: 7, Steps: 10 | Train Loss: 1.174 Vali Loss: 3.222 Vali Acc: 0.204 Test Loss: 3.222 Test Acc: 0.204
Validation loss decreased (-0.168204 --> -0.203497).  Saving model ...
Epoch: 8 cost time: 1.1162729263305664
Epoch: 8, Steps: 10 | Train Loss: 0.720 Vali Loss: 3.335 Vali Acc: 0.225 Test Loss: 3.335 Test Acc: 0.225
Validation loss decreased (-0.203497 --> -0.224673).  Saving model ...
Epoch: 9 cost time: 1.1321041584014893
Epoch: 9, Steps: 10 | Train Loss: 0.451 Vali Loss: 3.526 Vali Acc: 0.244 Test Loss: 3.526 Test Acc: 0.244
Validation loss decreased (-0.224673 --> -0.243494).  Saving model ...
Epoch: 10 cost time: 1.119309902191162
Epoch: 10, Steps: 10 | Train Loss: 0.221 Vali Loss: 3.736 Vali Acc: 0.252 Test Loss: 3.736 Test Acc: 0.252
Validation loss decreased (-0.243494 --> -0.251727).  Saving model ...
Epoch: 11 cost time: 1.061138391494751
Epoch: 11, Steps: 10 | Train Loss: 0.113 Vali Loss: 3.952 Vali Acc: 0.251 Test Loss: 3.952 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0491738319396973
Epoch: 12, Steps: 10 | Train Loss: 0.053 Vali Loss: 4.137 Vali Acc: 0.256 Test Loss: 4.137 Test Acc: 0.256
Validation loss decreased (-0.251727 --> -0.256429).  Saving model ...
Epoch: 13 cost time: 1.116363525390625
Epoch: 13, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.301 Vali Acc: 0.254 Test Loss: 4.301 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1015944480895996
Epoch: 14, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.352 Vali Acc: 0.259 Test Loss: 4.352 Test Acc: 0.259
Validation loss decreased (-0.256429 --> -0.258780).  Saving model ...
Epoch: 15 cost time: 1.1572260856628418
Epoch: 15, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.393 Vali Acc: 0.264 Test Loss: 4.393 Test Acc: 0.264
Validation loss decreased (-0.258780 --> -0.263485).  Saving model ...
Epoch: 16 cost time: 1.208296298980713
Epoch: 16, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.468 Vali Acc: 0.266 Test Loss: 4.468 Test Acc: 0.266
Validation loss decreased (-0.263485 --> -0.265838).  Saving model ...
Epoch: 17 cost time: 1.0794267654418945
Epoch: 17, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.521 Vali Acc: 0.264 Test Loss: 4.521 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.065547227859497
Epoch: 18, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.577 Vali Acc: 0.259 Test Loss: 4.577 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.0826594829559326
Epoch: 19, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.609 Vali Acc: 0.261 Test Loss: 4.609 Test Acc: 0.261
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.989316463470459
Epoch: 20, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.662 Vali Acc: 0.260 Test Loss: 4.662 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.1067681312561035
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.705 Vali Acc: 0.262 Test Loss: 4.705 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.1165053844451904
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.742 Vali Acc: 0.264 Test Loss: 4.742 Test Acc: 0.264
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.2056388854980469
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.781 Vali Acc: 0.260 Test Loss: 4.781 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.1420762538909912
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.815 Vali Acc: 0.266 Test Loss: 4.815 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.0013151168823242
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.848 Vali Acc: 0.264 Test Loss: 4.848 Test Acc: 0.264
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.0675318241119385
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.877 Vali Acc: 0.261 Test Loss: 4.877 Test Acc: 0.261
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps12_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26588235294117646
model parameter : 852122
model size : 3.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.2260396480560303
Epoch: 1, Steps: 10 | Train Loss: 3.281 Vali Loss: 3.262 Vali Acc: 0.047 Test Loss: 3.262 Test Acc: 0.047
Validation loss decreased (inf --> -0.047026).  Saving model ...
Epoch: 2 cost time: 1.0281684398651123
Epoch: 2, Steps: 10 | Train Loss: 3.129 Vali Loss: 3.255 Vali Acc: 0.060 Test Loss: 3.255 Test Acc: 0.060
Validation loss decreased (-0.047026 --> -0.059967).  Saving model ...
Epoch: 3 cost time: 1.0337815284729004
Epoch: 3, Steps: 10 | Train Loss: 2.896 Vali Loss: 3.274 Vali Acc: 0.078 Test Loss: 3.274 Test Acc: 0.078
Validation loss decreased (-0.059967 --> -0.077614).  Saving model ...
Epoch: 4 cost time: 0.9309189319610596
Epoch: 4, Steps: 10 | Train Loss: 2.597 Vali Loss: 3.249 Vali Acc: 0.116 Test Loss: 3.249 Test Acc: 0.116
Validation loss decreased (-0.077614 --> -0.116438).  Saving model ...
Epoch: 5 cost time: 1.0036180019378662
Epoch: 5, Steps: 10 | Train Loss: 2.302 Vali Loss: 3.217 Vali Acc: 0.127 Test Loss: 3.217 Test Acc: 0.127
Validation loss decreased (-0.116438 --> -0.127027).  Saving model ...
Epoch: 6 cost time: 1.1410877704620361
Epoch: 6, Steps: 10 | Train Loss: 1.921 Vali Loss: 3.177 Vali Acc: 0.169 Test Loss: 3.177 Test Acc: 0.169
Validation loss decreased (-0.127027 --> -0.169380).  Saving model ...
Epoch: 7 cost time: 1.020742654800415
Epoch: 7, Steps: 10 | Train Loss: 1.546 Vali Loss: 3.174 Vali Acc: 0.195 Test Loss: 3.174 Test Acc: 0.195
Validation loss decreased (-0.169380 --> -0.195262).  Saving model ...
Epoch: 8 cost time: 0.9980273246765137
Epoch: 8, Steps: 10 | Train Loss: 1.118 Vali Loss: 3.215 Vali Acc: 0.222 Test Loss: 3.215 Test Acc: 0.222
Validation loss decreased (-0.195262 --> -0.222321).  Saving model ...
Epoch: 9 cost time: 1.0136642456054688
Epoch: 9, Steps: 10 | Train Loss: 0.762 Vali Loss: 3.318 Vali Acc: 0.231 Test Loss: 3.318 Test Acc: 0.231
Validation loss decreased (-0.222321 --> -0.230555).  Saving model ...
Epoch: 10 cost time: 1.049055576324463
Epoch: 10, Steps: 10 | Train Loss: 0.499 Vali Loss: 3.490 Vali Acc: 0.244 Test Loss: 3.490 Test Acc: 0.244
Validation loss decreased (-0.230555 --> -0.243495).  Saving model ...
Epoch: 11 cost time: 1.0213677883148193
Epoch: 11, Steps: 10 | Train Loss: 0.295 Vali Loss: 3.598 Vali Acc: 0.265 Test Loss: 3.598 Test Acc: 0.265
Validation loss decreased (-0.243495 --> -0.264670).  Saving model ...
Epoch: 12 cost time: 1.021960735321045
Epoch: 12, Steps: 10 | Train Loss: 0.156 Vali Loss: 3.795 Vali Acc: 0.252 Test Loss: 3.795 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0344223976135254
Epoch: 13, Steps: 10 | Train Loss: 0.097 Vali Loss: 3.923 Vali Acc: 0.271 Test Loss: 3.923 Test Acc: 0.271
Validation loss decreased (-0.264670 --> -0.270549).  Saving model ...
Epoch: 14 cost time: 1.0525245666503906
Epoch: 14, Steps: 10 | Train Loss: 0.052 Vali Loss: 4.045 Vali Acc: 0.271 Test Loss: 4.045 Test Acc: 0.271
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0186042785644531
Epoch: 15, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.168 Vali Acc: 0.269 Test Loss: 4.168 Test Acc: 0.269
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0551297664642334
Epoch: 16, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.266 Vali Acc: 0.269 Test Loss: 4.266 Test Acc: 0.269
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.954962968826294
Epoch: 17, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.312 Vali Acc: 0.278 Test Loss: 4.312 Test Acc: 0.278
Validation loss decreased (-0.270549 --> -0.277604).  Saving model ...
Epoch: 18 cost time: 0.96175217628479
Epoch: 18, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.364 Vali Acc: 0.281 Test Loss: 4.364 Test Acc: 0.281
Validation loss decreased (-0.277604 --> -0.281133).  Saving model ...
Epoch: 19 cost time: 1.086902141571045
Epoch: 19, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.419 Vali Acc: 0.279 Test Loss: 4.419 Test Acc: 0.279
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0528051853179932
Epoch: 20, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.462 Vali Acc: 0.276 Test Loss: 4.462 Test Acc: 0.276
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.0172317028045654
Epoch: 21, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.496 Vali Acc: 0.278 Test Loss: 4.496 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.0602002143859863
Epoch: 22, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.541 Vali Acc: 0.275 Test Loss: 4.541 Test Acc: 0.275
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.0575904846191406
Epoch: 23, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.585 Vali Acc: 0.276 Test Loss: 4.585 Test Acc: 0.276
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.0382132530212402
Epoch: 24, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.619 Vali Acc: 0.274 Test Loss: 4.619 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.9690284729003906
Epoch: 25, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.645 Vali Acc: 0.275 Test Loss: 4.645 Test Acc: 0.275
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.0521297454833984
Epoch: 26, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.685 Vali Acc: 0.275 Test Loss: 4.685 Test Acc: 0.275
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.1183767318725586
Epoch: 27, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.720 Vali Acc: 0.276 Test Loss: 4.720 Test Acc: 0.276
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.9967448711395264
Epoch: 28, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.734 Vali Acc: 0.275 Test Loss: 4.734 Test Acc: 0.275
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2811764705882353
model parameter : 792730
model size : 3.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps23_str12_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.579157829284668
Epoch: 1, Steps: 10 | Train Loss: 3.302 Vali Loss: 3.283 Vali Acc: 0.033 Test Loss: 3.283 Test Acc: 0.033
Validation loss decreased (inf --> -0.032908).  Saving model ...
Epoch: 2 cost time: 1.052591323852539
Epoch: 2, Steps: 10 | Train Loss: 3.203 Vali Loss: 3.268 Vali Acc: 0.048 Test Loss: 3.268 Test Acc: 0.048
Validation loss decreased (-0.032908 --> -0.048203).  Saving model ...
Epoch: 3 cost time: 1.069014310836792
Epoch: 3, Steps: 10 | Train Loss: 3.035 Vali Loss: 3.253 Vali Acc: 0.074 Test Loss: 3.253 Test Acc: 0.074
Validation loss decreased (-0.048203 --> -0.074085).  Saving model ...
Epoch: 4 cost time: 1.057119607925415
Epoch: 4, Steps: 10 | Train Loss: 2.809 Vali Loss: 3.242 Vali Acc: 0.093 Test Loss: 3.242 Test Acc: 0.093
Validation loss decreased (-0.074085 --> -0.092909).  Saving model ...
Epoch: 5 cost time: 1.0461416244506836
Epoch: 5, Steps: 10 | Train Loss: 2.597 Vali Loss: 3.224 Vali Acc: 0.102 Test Loss: 3.224 Test Acc: 0.102
Validation loss decreased (-0.092909 --> -0.102321).  Saving model ...
Epoch: 6 cost time: 1.0318889617919922
Epoch: 6, Steps: 10 | Train Loss: 2.339 Vali Loss: 3.190 Vali Acc: 0.119 Test Loss: 3.190 Test Acc: 0.119
Validation loss decreased (-0.102321 --> -0.118792).  Saving model ...
Epoch: 7 cost time: 1.1262531280517578
Epoch: 7, Steps: 10 | Train Loss: 2.013 Vali Loss: 3.168 Vali Acc: 0.161 Test Loss: 3.168 Test Acc: 0.161
Validation loss decreased (-0.118792 --> -0.161145).  Saving model ...
Epoch: 8 cost time: 1.0458242893218994
Epoch: 8, Steps: 10 | Train Loss: 1.736 Vali Loss: 3.170 Vali Acc: 0.174 Test Loss: 3.170 Test Acc: 0.174
Validation loss decreased (-0.161145 --> -0.174086).  Saving model ...
Epoch: 9 cost time: 1.0579540729522705
Epoch: 9, Steps: 10 | Train Loss: 1.400 Vali Loss: 3.190 Vali Acc: 0.200 Test Loss: 3.190 Test Acc: 0.200
Validation loss decreased (-0.174086 --> -0.199968).  Saving model ...
Epoch: 10 cost time: 1.1058971881866455
Epoch: 10, Steps: 10 | Train Loss: 1.062 Vali Loss: 3.218 Vali Acc: 0.221 Test Loss: 3.218 Test Acc: 0.221
Validation loss decreased (-0.199968 --> -0.221144).  Saving model ...
Epoch: 11 cost time: 1.0764291286468506
Epoch: 11, Steps: 10 | Train Loss: 0.827 Vali Loss: 3.287 Vali Acc: 0.228 Test Loss: 3.287 Test Acc: 0.228
Validation loss decreased (-0.221144 --> -0.228202).  Saving model ...
Epoch: 12 cost time: 0.9958064556121826
Epoch: 12, Steps: 10 | Train Loss: 0.576 Vali Loss: 3.380 Vali Acc: 0.247 Test Loss: 3.380 Test Acc: 0.247
Validation loss decreased (-0.228202 --> -0.247025).  Saving model ...
Epoch: 13 cost time: 1.0087497234344482
Epoch: 13, Steps: 10 | Train Loss: 0.405 Vali Loss: 3.498 Vali Acc: 0.249 Test Loss: 3.498 Test Acc: 0.249
Validation loss decreased (-0.247025 --> -0.249377).  Saving model ...
Epoch: 14 cost time: 1.1339311599731445
Epoch: 14, Steps: 10 | Train Loss: 0.254 Vali Loss: 3.626 Vali Acc: 0.253 Test Loss: 3.626 Test Acc: 0.253
Validation loss decreased (-0.249377 --> -0.252905).  Saving model ...
Epoch: 15 cost time: 1.1480183601379395
Epoch: 15, Steps: 10 | Train Loss: 0.168 Vali Loss: 3.755 Vali Acc: 0.253 Test Loss: 3.755 Test Acc: 0.253
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.060575008392334
Epoch: 16, Steps: 10 | Train Loss: 0.108 Vali Loss: 3.845 Vali Acc: 0.267 Test Loss: 3.845 Test Acc: 0.267
Validation loss decreased (-0.252905 --> -0.267020).  Saving model ...
Epoch: 17 cost time: 1.0418651103973389
Epoch: 17, Steps: 10 | Train Loss: 0.073 Vali Loss: 3.930 Vali Acc: 0.267 Test Loss: 3.930 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1577951908111572
Epoch: 18, Steps: 10 | Train Loss: 0.053 Vali Loss: 4.007 Vali Acc: 0.271 Test Loss: 4.007 Test Acc: 0.271
Validation loss decreased (-0.267020 --> -0.270548).  Saving model ...
Epoch: 19 cost time: 1.0680863857269287
Epoch: 19, Steps: 10 | Train Loss: 0.038 Vali Loss: 4.074 Vali Acc: 0.273 Test Loss: 4.074 Test Acc: 0.273
Validation loss decreased (-0.270548 --> -0.272900).  Saving model ...
Epoch: 20 cost time: 1.0393574237823486
Epoch: 20, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.133 Vali Acc: 0.275 Test Loss: 4.133 Test Acc: 0.275
Validation loss decreased (-0.272900 --> -0.275253).  Saving model ...
Epoch: 21 cost time: 0.9995672702789307
Epoch: 21, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.186 Vali Acc: 0.274 Test Loss: 4.186 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0915312767028809
Epoch: 22, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.237 Vali Acc: 0.274 Test Loss: 4.237 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.023336410522461
Epoch: 23, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.270 Vali Acc: 0.275 Test Loss: 4.270 Test Acc: 0.275
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.038191556930542
Epoch: 24, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.313 Vali Acc: 0.280 Test Loss: 4.313 Test Acc: 0.280
Validation loss decreased (-0.275253 --> -0.279957).  Saving model ...
Epoch: 25 cost time: 1.015671968460083
Epoch: 25, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.346 Vali Acc: 0.276 Test Loss: 4.346 Test Acc: 0.276
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9665286540985107
Epoch: 26, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.385 Vali Acc: 0.281 Test Loss: 4.385 Test Acc: 0.281
Validation loss decreased (-0.279957 --> -0.281133).  Saving model ...
Epoch: 27 cost time: 1.061819314956665
Epoch: 27, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.424 Vali Acc: 0.280 Test Loss: 4.424 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.043912410736084
Epoch: 28, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.450 Vali Acc: 0.278 Test Loss: 4.450 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.0300564765930176
Epoch: 29, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.497 Vali Acc: 0.281 Test Loss: 4.497 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.073096752166748
Epoch: 30, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.522 Vali Acc: 0.281 Test Loss: 4.522 Test Acc: 0.281
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.006364107131958
Epoch: 31, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.542 Vali Acc: 0.279 Test Loss: 4.542 Test Acc: 0.279
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.1076319217681885
Epoch: 32, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.573 Vali Acc: 0.282 Test Loss: 4.573 Test Acc: 0.282
Validation loss decreased (-0.281133 --> -0.282307).  Saving model ...
Epoch: 33 cost time: 1.044405221939087
Epoch: 33, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.604 Vali Acc: 0.280 Test Loss: 4.604 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.0569257736206055
Epoch: 34, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.616 Vali Acc: 0.281 Test Loss: 4.616 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.1140639781951904
Epoch: 35, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.631 Vali Acc: 0.282 Test Loss: 4.631 Test Acc: 0.282
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.0483670234680176
Epoch: 36, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.661 Vali Acc: 0.284 Test Loss: 4.661 Test Acc: 0.284
Validation loss decreased (-0.282307 --> -0.283483).  Saving model ...
Epoch: 37 cost time: 0.9578053951263428
Epoch: 37, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.685 Vali Acc: 0.284 Test Loss: 4.685 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.9741315841674805
Epoch: 38, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.704 Vali Acc: 0.287 Test Loss: 4.704 Test Acc: 0.287
Validation loss decreased (-0.283483 --> -0.287012).  Saving model ...
Epoch: 39 cost time: 1.0757033824920654
Epoch: 39, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.717 Vali Acc: 0.281 Test Loss: 4.717 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.0807607173919678
Epoch: 40, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.740 Vali Acc: 0.282 Test Loss: 4.740 Test Acc: 0.282
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.1102242469787598
Epoch: 41, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.769 Vali Acc: 0.280 Test Loss: 4.769 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.037365198135376
Epoch: 42, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.797 Vali Acc: 0.279 Test Loss: 4.797 Test Acc: 0.279
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.014638900756836
Epoch: 43, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.808 Vali Acc: 0.282 Test Loss: 4.808 Test Acc: 0.282
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.112630844116211
Epoch: 44, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.828 Vali Acc: 0.281 Test Loss: 4.828 Test Acc: 0.281
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.0330960750579834
Epoch: 45, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.838 Vali Acc: 0.285 Test Loss: 4.838 Test Acc: 0.285
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.021981954574585
Epoch: 46, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.859 Vali Acc: 0.282 Test Loss: 4.859 Test Acc: 0.282
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 1.0697441101074219
Epoch: 47, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.879 Vali Acc: 0.284 Test Loss: 4.879 Test Acc: 0.284
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 1.0722146034240723
Epoch: 48, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.898 Vali Acc: 0.282 Test Loss: 4.898 Test Acc: 0.282
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps23_str12_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.28705882352941176
model parameter : 713754
model size : 2.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.2699499130249023
Epoch: 1, Steps: 10 | Train Loss: 3.266 Vali Loss: 3.271 Vali Acc: 0.031 Test Loss: 3.271 Test Acc: 0.031
Validation loss decreased (inf --> -0.030556).  Saving model ...
Epoch: 2 cost time: 1.086181402206421
Epoch: 2, Steps: 10 | Train Loss: 3.207 Vali Loss: 3.261 Vali Acc: 0.048 Test Loss: 3.261 Test Acc: 0.048
Validation loss decreased (-0.030556 --> -0.048203).  Saving model ...
Epoch: 3 cost time: 1.0311508178710938
Epoch: 3, Steps: 10 | Train Loss: 3.046 Vali Loss: 3.255 Vali Acc: 0.085 Test Loss: 3.255 Test Acc: 0.085
Validation loss decreased (-0.048203 --> -0.084673).  Saving model ...
Epoch: 4 cost time: 1.0192461013793945
Epoch: 4, Steps: 10 | Train Loss: 2.854 Vali Loss: 3.248 Vali Acc: 0.082 Test Loss: 3.248 Test Acc: 0.082
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0816938877105713
Epoch: 5, Steps: 10 | Train Loss: 2.685 Vali Loss: 3.230 Vali Acc: 0.112 Test Loss: 3.230 Test Acc: 0.112
Validation loss decreased (-0.084673 --> -0.111732).  Saving model ...
Epoch: 6 cost time: 1.0277445316314697
Epoch: 6, Steps: 10 | Train Loss: 2.449 Vali Loss: 3.201 Vali Acc: 0.127 Test Loss: 3.201 Test Acc: 0.127
Validation loss decreased (-0.111732 --> -0.127027).  Saving model ...
Epoch: 7 cost time: 1.0011279582977295
Epoch: 7, Steps: 10 | Train Loss: 2.210 Vali Loss: 3.180 Vali Acc: 0.145 Test Loss: 3.180 Test Acc: 0.145
Validation loss decreased (-0.127027 --> -0.144674).  Saving model ...
Epoch: 8 cost time: 1.028149127960205
Epoch: 8, Steps: 10 | Train Loss: 1.973 Vali Loss: 3.165 Vali Acc: 0.168 Test Loss: 3.165 Test Acc: 0.168
Validation loss decreased (-0.144674 --> -0.168204).  Saving model ...
Epoch: 9 cost time: 1.0596044063568115
Epoch: 9, Steps: 10 | Train Loss: 1.651 Vali Loss: 3.148 Vali Acc: 0.185 Test Loss: 3.148 Test Acc: 0.185
Validation loss decreased (-0.168204 --> -0.184674).  Saving model ...
Epoch: 10 cost time: 1.0731849670410156
Epoch: 10, Steps: 10 | Train Loss: 1.410 Vali Loss: 3.148 Vali Acc: 0.199 Test Loss: 3.148 Test Acc: 0.199
Validation loss decreased (-0.184674 --> -0.198792).  Saving model ...
Epoch: 11 cost time: 1.0374867916107178
Epoch: 11, Steps: 10 | Train Loss: 1.095 Vali Loss: 3.180 Vali Acc: 0.214 Test Loss: 3.180 Test Acc: 0.214
Validation loss decreased (-0.198792 --> -0.214086).  Saving model ...
Epoch: 12 cost time: 1.0254371166229248
Epoch: 12, Steps: 10 | Train Loss: 0.853 Vali Loss: 3.229 Vali Acc: 0.224 Test Loss: 3.229 Test Acc: 0.224
Validation loss decreased (-0.214086 --> -0.223497).  Saving model ...
Epoch: 13 cost time: 0.979525089263916
Epoch: 13, Steps: 10 | Train Loss: 0.632 Vali Loss: 3.289 Vali Acc: 0.234 Test Loss: 3.289 Test Acc: 0.234
Validation loss decreased (-0.223497 --> -0.234085).  Saving model ...
Epoch: 14 cost time: 0.9982483386993408
Epoch: 14, Steps: 10 | Train Loss: 0.444 Vali Loss: 3.359 Vali Acc: 0.248 Test Loss: 3.359 Test Acc: 0.248
Validation loss decreased (-0.234085 --> -0.248202).  Saving model ...
Epoch: 15 cost time: 1.079883337020874
Epoch: 15, Steps: 10 | Train Loss: 0.303 Vali Loss: 3.474 Vali Acc: 0.251 Test Loss: 3.474 Test Acc: 0.251
Validation loss decreased (-0.248202 --> -0.250553).  Saving model ...
Epoch: 16 cost time: 1.0115306377410889
Epoch: 16, Steps: 10 | Train Loss: 0.220 Vali Loss: 3.570 Vali Acc: 0.254 Test Loss: 3.570 Test Acc: 0.254
Validation loss decreased (-0.250553 --> -0.254082).  Saving model ...
Epoch: 17 cost time: 1.0320484638214111
Epoch: 17, Steps: 10 | Train Loss: 0.143 Vali Loss: 3.624 Vali Acc: 0.268 Test Loss: 3.624 Test Acc: 0.268
Validation loss decreased (-0.254082 --> -0.268199).  Saving model ...
Epoch: 18 cost time: 1.109715461730957
Epoch: 18, Steps: 10 | Train Loss: 0.095 Vali Loss: 3.732 Vali Acc: 0.266 Test Loss: 3.732 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.017038345336914
Epoch: 19, Steps: 10 | Train Loss: 0.069 Vali Loss: 3.775 Vali Acc: 0.271 Test Loss: 3.775 Test Acc: 0.271
Validation loss decreased (-0.268199 --> -0.270550).  Saving model ...
Epoch: 20 cost time: 1.0164916515350342
Epoch: 20, Steps: 10 | Train Loss: 0.052 Vali Loss: 3.830 Vali Acc: 0.266 Test Loss: 3.830 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0868403911590576
Epoch: 21, Steps: 10 | Train Loss: 0.044 Vali Loss: 3.901 Vali Acc: 0.268 Test Loss: 3.901 Test Acc: 0.268
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.121901035308838
Epoch: 22, Steps: 10 | Train Loss: 0.036 Vali Loss: 3.941 Vali Acc: 0.273 Test Loss: 3.941 Test Acc: 0.273
Validation loss decreased (-0.270550 --> -0.272902).  Saving model ...
Epoch: 23 cost time: 1.0516736507415771
Epoch: 23, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.989 Vali Acc: 0.271 Test Loss: 3.989 Test Acc: 0.271
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9086794853210449
Epoch: 24, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.032 Vali Acc: 0.271 Test Loss: 4.032 Test Acc: 0.271
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.0096237659454346
Epoch: 25, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.060 Vali Acc: 0.276 Test Loss: 4.060 Test Acc: 0.276
Validation loss decreased (-0.272902 --> -0.276430).  Saving model ...
Epoch: 26 cost time: 1.0588366985321045
Epoch: 26, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.080 Vali Acc: 0.273 Test Loss: 4.080 Test Acc: 0.273
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9934341907501221
Epoch: 27, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.120 Vali Acc: 0.272 Test Loss: 4.120 Test Acc: 0.272
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.9691331386566162
Epoch: 28, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.153 Vali Acc: 0.275 Test Loss: 4.153 Test Acc: 0.275
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.0215308666229248
Epoch: 29, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.189 Vali Acc: 0.276 Test Loss: 4.189 Test Acc: 0.276
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.045473337173462
Epoch: 30, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.202 Vali Acc: 0.279 Test Loss: 4.202 Test Acc: 0.279
Validation loss decreased (-0.276430 --> -0.278782).  Saving model ...
Epoch: 31 cost time: 0.9957513809204102
Epoch: 31, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.235 Vali Acc: 0.276 Test Loss: 4.235 Test Acc: 0.276
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.0669746398925781
Epoch: 32, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.263 Vali Acc: 0.276 Test Loss: 4.263 Test Acc: 0.276
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.1013424396514893
Epoch: 33, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.280 Vali Acc: 0.276 Test Loss: 4.280 Test Acc: 0.276
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.0241878032684326
Epoch: 34, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.317 Vali Acc: 0.278 Test Loss: 4.317 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.096665859222412
Epoch: 35, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.345 Vali Acc: 0.278 Test Loss: 4.345 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.0375843048095703
Epoch: 36, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.363 Vali Acc: 0.278 Test Loss: 4.363 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.9328353404998779
Epoch: 37, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.400 Vali Acc: 0.280 Test Loss: 4.400 Test Acc: 0.280
Validation loss decreased (-0.278782 --> -0.279956).  Saving model ...
Epoch: 38 cost time: 1.0087571144104004
Epoch: 38, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.412 Vali Acc: 0.280 Test Loss: 4.412 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.9830005168914795
Epoch: 39, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.443 Vali Acc: 0.278 Test Loss: 4.443 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.0253207683563232
Epoch: 40, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.455 Vali Acc: 0.279 Test Loss: 4.455 Test Acc: 0.279
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.053485631942749
Epoch: 41, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.452 Vali Acc: 0.281 Test Loss: 4.452 Test Acc: 0.281
Validation loss decreased (-0.279956 --> -0.281132).  Saving model ...
Epoch: 42 cost time: 1.005488395690918
Epoch: 42, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.472 Vali Acc: 0.280 Test Loss: 4.472 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.0333929061889648
Epoch: 43, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.504 Vali Acc: 0.281 Test Loss: 4.504 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.0589821338653564
Epoch: 44, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.512 Vali Acc: 0.281 Test Loss: 4.512 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.0513930320739746
Epoch: 45, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.543 Vali Acc: 0.280 Test Loss: 4.543 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.9799909591674805
Epoch: 46, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.558 Vali Acc: 0.281 Test Loss: 4.558 Test Acc: 0.281
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.9409844875335693
Epoch: 47, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.577 Vali Acc: 0.280 Test Loss: 4.577 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.9981794357299805
Epoch: 48, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.592 Vali Acc: 0.281 Test Loss: 4.592 Test Acc: 0.281
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 1.0157763957977295
Epoch: 49, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.610 Vali Acc: 0.284 Test Loss: 4.610 Test Acc: 0.284
Validation loss decreased (-0.281132 --> -0.283483).  Saving model ...
Epoch: 50 cost time: 1.0056304931640625
Epoch: 50, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.623 Vali Acc: 0.280 Test Loss: 4.623 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.28352941176470586
model parameter : 694810
model size : 2.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps38_str19_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.245708703994751
Epoch: 1, Steps: 10 | Train Loss: 3.291 Vali Loss: 3.259 Vali Acc: 0.054 Test Loss: 3.259 Test Acc: 0.054
Validation loss decreased (inf --> -0.054085).  Saving model ...
Epoch: 2 cost time: 1.0328032970428467
Epoch: 2, Steps: 10 | Train Loss: 3.176 Vali Loss: 3.245 Vali Acc: 0.074 Test Loss: 3.245 Test Acc: 0.074
Validation loss decreased (-0.054085 --> -0.074085).  Saving model ...
Epoch: 3 cost time: 1.0712268352508545
Epoch: 3, Steps: 10 | Train Loss: 3.025 Vali Loss: 3.238 Vali Acc: 0.079 Test Loss: 3.238 Test Acc: 0.079
Validation loss decreased (-0.074085 --> -0.078791).  Saving model ...
Epoch: 4 cost time: 1.055964469909668
Epoch: 4, Steps: 10 | Train Loss: 2.875 Vali Loss: 3.237 Vali Acc: 0.091 Test Loss: 3.237 Test Acc: 0.091
Validation loss decreased (-0.078791 --> -0.090556).  Saving model ...
Epoch: 5 cost time: 1.025726079940796
Epoch: 5, Steps: 10 | Train Loss: 2.668 Vali Loss: 3.223 Vali Acc: 0.116 Test Loss: 3.223 Test Acc: 0.116
Validation loss decreased (-0.090556 --> -0.116438).  Saving model ...
Epoch: 6 cost time: 1.0662498474121094
Epoch: 6, Steps: 10 | Train Loss: 2.469 Vali Loss: 3.214 Vali Acc: 0.125 Test Loss: 3.214 Test Acc: 0.125
Validation loss decreased (-0.116438 --> -0.124674).  Saving model ...
Epoch: 7 cost time: 1.024413824081421
Epoch: 7, Steps: 10 | Train Loss: 2.268 Vali Loss: 3.202 Vali Acc: 0.145 Test Loss: 3.202 Test Acc: 0.145
Validation loss decreased (-0.124674 --> -0.144674).  Saving model ...
Epoch: 8 cost time: 1.0253396034240723
Epoch: 8, Steps: 10 | Train Loss: 2.024 Vali Loss: 3.182 Vali Acc: 0.173 Test Loss: 3.182 Test Acc: 0.173
Validation loss decreased (-0.144674 --> -0.172909).  Saving model ...
Epoch: 9 cost time: 1.0113797187805176
Epoch: 9, Steps: 10 | Train Loss: 1.797 Vali Loss: 3.183 Vali Acc: 0.185 Test Loss: 3.183 Test Acc: 0.185
Validation loss decreased (-0.172909 --> -0.184674).  Saving model ...
Epoch: 10 cost time: 1.0050334930419922
Epoch: 10, Steps: 10 | Train Loss: 1.512 Vali Loss: 3.176 Vali Acc: 0.199 Test Loss: 3.176 Test Acc: 0.199
Validation loss decreased (-0.184674 --> -0.198792).  Saving model ...
Epoch: 11 cost time: 0.9393594264984131
Epoch: 11, Steps: 10 | Train Loss: 1.273 Vali Loss: 3.204 Vali Acc: 0.218 Test Loss: 3.204 Test Acc: 0.218
Validation loss decreased (-0.198792 --> -0.217615).  Saving model ...
Epoch: 12 cost time: 0.9343161582946777
Epoch: 12, Steps: 10 | Train Loss: 1.046 Vali Loss: 3.253 Vali Acc: 0.215 Test Loss: 3.253 Test Acc: 0.215
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0372238159179688
Epoch: 13, Steps: 10 | Train Loss: 0.812 Vali Loss: 3.294 Vali Acc: 0.227 Test Loss: 3.294 Test Acc: 0.227
Validation loss decreased (-0.217615 --> -0.227026).  Saving model ...
Epoch: 14 cost time: 0.9736697673797607
Epoch: 14, Steps: 10 | Train Loss: 0.628 Vali Loss: 3.366 Vali Acc: 0.234 Test Loss: 3.366 Test Acc: 0.234
Validation loss decreased (-0.227026 --> -0.234084).  Saving model ...
Epoch: 15 cost time: 1.0508081912994385
Epoch: 15, Steps: 10 | Train Loss: 0.454 Vali Loss: 3.425 Vali Acc: 0.251 Test Loss: 3.425 Test Acc: 0.251
Validation loss decreased (-0.234084 --> -0.250554).  Saving model ...
Epoch: 16 cost time: 0.9150309562683105
Epoch: 16, Steps: 10 | Train Loss: 0.326 Vali Loss: 3.500 Vali Acc: 0.261 Test Loss: 3.500 Test Acc: 0.261
Validation loss decreased (-0.250554 --> -0.261141).  Saving model ...
Epoch: 17 cost time: 0.9493680000305176
Epoch: 17, Steps: 10 | Train Loss: 0.224 Vali Loss: 3.571 Vali Acc: 0.265 Test Loss: 3.571 Test Acc: 0.265
Validation loss decreased (-0.261141 --> -0.264670).  Saving model ...
Epoch: 18 cost time: 0.9663510322570801
Epoch: 18, Steps: 10 | Train Loss: 0.168 Vali Loss: 3.643 Vali Acc: 0.272 Test Loss: 3.643 Test Acc: 0.272
Validation loss decreased (-0.264670 --> -0.271728).  Saving model ...
Epoch: 19 cost time: 0.9977099895477295
Epoch: 19, Steps: 10 | Train Loss: 0.118 Vali Loss: 3.732 Vali Acc: 0.267 Test Loss: 3.732 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.071288824081421
Epoch: 20, Steps: 10 | Train Loss: 0.089 Vali Loss: 3.828 Vali Acc: 0.269 Test Loss: 3.828 Test Acc: 0.269
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.089264154434204
Epoch: 21, Steps: 10 | Train Loss: 0.068 Vali Loss: 3.895 Vali Acc: 0.273 Test Loss: 3.895 Test Acc: 0.273
Validation loss decreased (-0.271728 --> -0.272902).  Saving model ...
Epoch: 22 cost time: 1.0130164623260498
Epoch: 22, Steps: 10 | Train Loss: 0.055 Vali Loss: 3.944 Vali Acc: 0.267 Test Loss: 3.944 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.992133378982544
Epoch: 23, Steps: 10 | Train Loss: 0.046 Vali Loss: 3.969 Vali Acc: 0.273 Test Loss: 3.969 Test Acc: 0.273
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.9298574924468994
Epoch: 24, Steps: 10 | Train Loss: 0.040 Vali Loss: 3.996 Vali Acc: 0.276 Test Loss: 3.996 Test Acc: 0.276
Validation loss decreased (-0.272902 --> -0.276431).  Saving model ...
Epoch: 25 cost time: 0.9447536468505859
Epoch: 25, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.037 Vali Acc: 0.273 Test Loss: 4.037 Test Acc: 0.273
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9649379253387451
Epoch: 26, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.101 Vali Acc: 0.274 Test Loss: 4.101 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.0084233283996582
Epoch: 27, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.158 Vali Acc: 0.274 Test Loss: 4.158 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.02186918258667
Epoch: 28, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.156 Vali Acc: 0.274 Test Loss: 4.156 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.9544110298156738
Epoch: 29, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.192 Vali Acc: 0.275 Test Loss: 4.192 Test Acc: 0.275
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.9998643398284912
Epoch: 30, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.234 Vali Acc: 0.274 Test Loss: 4.234 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.0171515941619873
Epoch: 31, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.270 Vali Acc: 0.273 Test Loss: 4.270 Test Acc: 0.273
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.0460255146026611
Epoch: 32, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.310 Vali Acc: 0.273 Test Loss: 4.310 Test Acc: 0.273
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.9713854789733887
Epoch: 33, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.333 Vali Acc: 0.273 Test Loss: 4.333 Test Acc: 0.273
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.0545806884765625
Epoch: 34, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.366 Vali Acc: 0.274 Test Loss: 4.366 Test Acc: 0.274
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps38_str19_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27647058823529413
model parameter : 675738
model size : 2.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.3458924293518066
Epoch: 1, Steps: 10 | Train Loss: 3.289 Vali Loss: 3.275 Vali Acc: 0.044 Test Loss: 3.275 Test Acc: 0.044
Validation loss decreased (inf --> -0.043497).  Saving model ...
Epoch: 2 cost time: 0.8809428215026855
Epoch: 2, Steps: 10 | Train Loss: 3.108 Vali Loss: 3.301 Vali Acc: 0.061 Test Loss: 3.301 Test Acc: 0.061
Validation loss decreased (-0.043497 --> -0.061143).  Saving model ...
Epoch: 3 cost time: 0.9417531490325928
Epoch: 3, Steps: 10 | Train Loss: 2.756 Vali Loss: 3.273 Vali Acc: 0.096 Test Loss: 3.273 Test Acc: 0.096
Validation loss decreased (-0.061143 --> -0.096438).  Saving model ...
Epoch: 4 cost time: 0.8460772037506104
Epoch: 4, Steps: 10 | Train Loss: 2.335 Vali Loss: 3.243 Vali Acc: 0.122 Test Loss: 3.243 Test Acc: 0.122
Validation loss decreased (-0.096438 --> -0.122321).  Saving model ...
Epoch: 5 cost time: 0.8630948066711426
Epoch: 5, Steps: 10 | Train Loss: 1.841 Vali Loss: 3.197 Vali Acc: 0.145 Test Loss: 3.197 Test Acc: 0.145
Validation loss decreased (-0.122321 --> -0.144674).  Saving model ...
Epoch: 6 cost time: 0.9259033203125
Epoch: 6, Steps: 10 | Train Loss: 1.268 Vali Loss: 3.207 Vali Acc: 0.198 Test Loss: 3.207 Test Acc: 0.198
Validation loss decreased (-0.144674 --> -0.197615).  Saving model ...
Epoch: 7 cost time: 0.8931722640991211
Epoch: 7, Steps: 10 | Train Loss: 0.741 Vali Loss: 3.394 Vali Acc: 0.211 Test Loss: 3.394 Test Acc: 0.211
Validation loss decreased (-0.197615 --> -0.210554).  Saving model ...
Epoch: 8 cost time: 0.9568462371826172
Epoch: 8, Steps: 10 | Train Loss: 0.384 Vali Loss: 3.588 Vali Acc: 0.244 Test Loss: 3.588 Test Acc: 0.244
Validation loss decreased (-0.210554 --> -0.243494).  Saving model ...
Epoch: 9 cost time: 0.857893705368042
Epoch: 9, Steps: 10 | Train Loss: 0.159 Vali Loss: 3.909 Vali Acc: 0.233 Test Loss: 3.909 Test Acc: 0.233
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.905787467956543
Epoch: 10, Steps: 10 | Train Loss: 0.069 Vali Loss: 4.215 Vali Acc: 0.229 Test Loss: 4.215 Test Acc: 0.229
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9710071086883545
Epoch: 11, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.318 Vali Acc: 0.235 Test Loss: 4.318 Test Acc: 0.235
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.9125912189483643
Epoch: 12, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.444 Vali Acc: 0.246 Test Loss: 4.444 Test Acc: 0.246
Validation loss decreased (-0.243494 --> -0.245838).  Saving model ...
Epoch: 13 cost time: 0.8458445072174072
Epoch: 13, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.508 Vali Acc: 0.251 Test Loss: 4.508 Test Acc: 0.251
Validation loss decreased (-0.245838 --> -0.250543).  Saving model ...
Epoch: 14 cost time: 0.8792214393615723
Epoch: 14, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.582 Vali Acc: 0.249 Test Loss: 4.582 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9195723533630371
Epoch: 15, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.646 Vali Acc: 0.248 Test Loss: 4.646 Test Acc: 0.248
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.936176061630249
Epoch: 16, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.696 Vali Acc: 0.255 Test Loss: 4.696 Test Acc: 0.255
Validation loss decreased (-0.250543 --> -0.255247).  Saving model ...
Epoch: 17 cost time: 0.9269919395446777
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.721 Vali Acc: 0.256 Test Loss: 4.721 Test Acc: 0.256
Validation loss decreased (-0.255247 --> -0.256423).  Saving model ...
Epoch: 18 cost time: 0.8985576629638672
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.751 Vali Acc: 0.259 Test Loss: 4.751 Test Acc: 0.259
Validation loss decreased (-0.256423 --> -0.258776).  Saving model ...
Epoch: 19 cost time: 0.9275171756744385
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.785 Vali Acc: 0.255 Test Loss: 4.785 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9195816516876221
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.837 Vali Acc: 0.258 Test Loss: 4.837 Test Acc: 0.258
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.9256603717803955
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.868 Vali Acc: 0.260 Test Loss: 4.868 Test Acc: 0.260
Validation loss decreased (-0.258776 --> -0.259951).  Saving model ...
Epoch: 22 cost time: 0.859119176864624
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.907 Vali Acc: 0.262 Test Loss: 4.907 Test Acc: 0.262
Validation loss decreased (-0.259951 --> -0.262304).  Saving model ...
Epoch: 23 cost time: 0.8618550300598145
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.937 Vali Acc: 0.261 Test Loss: 4.937 Test Acc: 0.261
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8762819766998291
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.967 Vali Acc: 0.262 Test Loss: 4.967 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.9415619373321533
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.992 Vali Acc: 0.261 Test Loss: 4.992 Test Acc: 0.261
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.9706294536590576
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.013 Vali Acc: 0.262 Test Loss: 5.013 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.8997805118560791
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.049 Vali Acc: 0.260 Test Loss: 5.049 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.9432671070098877
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.077 Vali Acc: 0.255 Test Loss: 5.077 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.9484443664550781
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.106 Vali Acc: 0.254 Test Loss: 5.106 Test Acc: 0.254
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.860274076461792
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.122 Vali Acc: 0.256 Test Loss: 5.122 Test Acc: 0.256
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.8336477279663086
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.145 Vali Acc: 0.256 Test Loss: 5.145 Test Acc: 0.256
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.916236162185669
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.174 Vali Acc: 0.258 Test Loss: 5.174 Test Acc: 0.258
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26235294117647057
model parameter : 535898
model size : 2.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.4932355880737305
Epoch: 1, Steps: 10 | Train Loss: 3.293 Vali Loss: 3.259 Vali Acc: 0.059 Test Loss: 3.259 Test Acc: 0.059
Validation loss decreased (inf --> -0.058791).  Saving model ...
Epoch: 2 cost time: 0.8733251094818115
Epoch: 2, Steps: 10 | Train Loss: 3.112 Vali Loss: 3.251 Vali Acc: 0.064 Test Loss: 3.251 Test Acc: 0.064
Validation loss decreased (-0.058791 --> -0.063497).  Saving model ...
Epoch: 3 cost time: 0.8576102256774902
Epoch: 3, Steps: 10 | Train Loss: 2.907 Vali Loss: 3.264 Vali Acc: 0.076 Test Loss: 3.264 Test Acc: 0.076
Validation loss decreased (-0.063497 --> -0.076438).  Saving model ...
Epoch: 4 cost time: 0.9844765663146973
Epoch: 4, Steps: 10 | Train Loss: 2.694 Vali Loss: 3.255 Vali Acc: 0.101 Test Loss: 3.255 Test Acc: 0.101
Validation loss decreased (-0.076438 --> -0.101144).  Saving model ...
Epoch: 5 cost time: 1.0151636600494385
Epoch: 5, Steps: 10 | Train Loss: 2.399 Vali Loss: 3.210 Vali Acc: 0.125 Test Loss: 3.210 Test Acc: 0.125
Validation loss decreased (-0.101144 --> -0.124674).  Saving model ...
Epoch: 6 cost time: 1.0272433757781982
Epoch: 6, Steps: 10 | Train Loss: 2.078 Vali Loss: 3.171 Vali Acc: 0.141 Test Loss: 3.171 Test Acc: 0.141
Validation loss decreased (-0.124674 --> -0.141145).  Saving model ...
Epoch: 7 cost time: 0.8648252487182617
Epoch: 7, Steps: 10 | Train Loss: 1.691 Vali Loss: 3.157 Vali Acc: 0.161 Test Loss: 3.157 Test Acc: 0.161
Validation loss decreased (-0.141145 --> -0.161145).  Saving model ...
Epoch: 8 cost time: 0.8678162097930908
Epoch: 8, Steps: 10 | Train Loss: 1.280 Vali Loss: 3.207 Vali Acc: 0.193 Test Loss: 3.207 Test Acc: 0.193
Validation loss decreased (-0.161145 --> -0.192909).  Saving model ...
Epoch: 9 cost time: 1.003161907196045
Epoch: 9, Steps: 10 | Train Loss: 0.917 Vali Loss: 3.278 Vali Acc: 0.221 Test Loss: 3.278 Test Acc: 0.221
Validation loss decreased (-0.192909 --> -0.221144).  Saving model ...
Epoch: 10 cost time: 0.8631858825683594
Epoch: 10, Steps: 10 | Train Loss: 0.601 Vali Loss: 3.396 Vali Acc: 0.224 Test Loss: 3.396 Test Acc: 0.224
Validation loss decreased (-0.221144 --> -0.223495).  Saving model ...
Epoch: 11 cost time: 0.8897502422332764
Epoch: 11, Steps: 10 | Train Loss: 0.355 Vali Loss: 3.532 Vali Acc: 0.248 Test Loss: 3.532 Test Acc: 0.248
Validation loss decreased (-0.223495 --> -0.248200).  Saving model ...
Epoch: 12 cost time: 0.8511488437652588
Epoch: 12, Steps: 10 | Train Loss: 0.210 Vali Loss: 3.731 Vali Acc: 0.254 Test Loss: 3.731 Test Acc: 0.254
Validation loss decreased (-0.248200 --> -0.254080).  Saving model ...
Epoch: 13 cost time: 0.9053642749786377
Epoch: 13, Steps: 10 | Train Loss: 0.122 Vali Loss: 3.952 Vali Acc: 0.252 Test Loss: 3.952 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.902271032333374
Epoch: 14, Steps: 10 | Train Loss: 0.066 Vali Loss: 4.120 Vali Acc: 0.247 Test Loss: 4.120 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9066102504730225
Epoch: 15, Steps: 10 | Train Loss: 0.041 Vali Loss: 4.188 Vali Acc: 0.258 Test Loss: 4.188 Test Acc: 0.258
Validation loss decreased (-0.254080 --> -0.257605).  Saving model ...
Epoch: 16 cost time: 0.9177477359771729
Epoch: 16, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.271 Vali Acc: 0.272 Test Loss: 4.271 Test Acc: 0.272
Validation loss decreased (-0.257605 --> -0.271722).  Saving model ...
Epoch: 17 cost time: 0.8675282001495361
Epoch: 17, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.365 Vali Acc: 0.267 Test Loss: 4.365 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9060916900634766
Epoch: 18, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.419 Vali Acc: 0.267 Test Loss: 4.419 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.0256519317626953
Epoch: 19, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.469 Vali Acc: 0.265 Test Loss: 4.469 Test Acc: 0.265
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.8725144863128662
Epoch: 20, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.517 Vali Acc: 0.264 Test Loss: 4.517 Test Acc: 0.264
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.9228065013885498
Epoch: 21, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.561 Vali Acc: 0.265 Test Loss: 4.561 Test Acc: 0.265
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.8991413116455078
Epoch: 22, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.606 Vali Acc: 0.266 Test Loss: 4.606 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.8949968814849854
Epoch: 23, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.654 Vali Acc: 0.264 Test Loss: 4.654 Test Acc: 0.264
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.9296712875366211
Epoch: 24, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.693 Vali Acc: 0.262 Test Loss: 4.693 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.9110894203186035
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.725 Vali Acc: 0.271 Test Loss: 4.725 Test Acc: 0.271
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.9490523338317871
Epoch: 26, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.759 Vali Acc: 0.268 Test Loss: 4.759 Test Acc: 0.268
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27176470588235296
model parameter : 346458
model size : 1.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps12_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.170825719833374
Epoch: 1, Steps: 10 | Train Loss: 3.316 Vali Loss: 3.282 Vali Acc: 0.038 Test Loss: 3.282 Test Acc: 0.038
Validation loss decreased (inf --> -0.037614).  Saving model ...
Epoch: 2 cost time: 0.8255982398986816
Epoch: 2, Steps: 10 | Train Loss: 3.212 Vali Loss: 3.271 Vali Acc: 0.031 Test Loss: 3.271 Test Acc: 0.031
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8607461452484131
Epoch: 3, Steps: 10 | Train Loss: 3.034 Vali Loss: 3.272 Vali Acc: 0.049 Test Loss: 3.272 Test Acc: 0.049
Validation loss decreased (-0.037614 --> -0.049379).  Saving model ...
Epoch: 4 cost time: 0.8998017311096191
Epoch: 4, Steps: 10 | Train Loss: 2.845 Vali Loss: 3.273 Vali Acc: 0.061 Test Loss: 3.273 Test Acc: 0.061
Validation loss decreased (-0.049379 --> -0.061144).  Saving model ...
Epoch: 5 cost time: 0.8445432186126709
Epoch: 5, Steps: 10 | Train Loss: 2.624 Vali Loss: 3.255 Vali Acc: 0.092 Test Loss: 3.255 Test Acc: 0.092
Validation loss decreased (-0.061144 --> -0.091732).  Saving model ...
Epoch: 6 cost time: 0.8225150108337402
Epoch: 6, Steps: 10 | Train Loss: 2.418 Vali Loss: 3.235 Vali Acc: 0.108 Test Loss: 3.235 Test Acc: 0.108
Validation loss decreased (-0.091732 --> -0.108203).  Saving model ...
Epoch: 7 cost time: 0.8466460704803467
Epoch: 7, Steps: 10 | Train Loss: 2.113 Vali Loss: 3.205 Vali Acc: 0.147 Test Loss: 3.205 Test Acc: 0.147
Validation loss decreased (-0.108203 --> -0.147027).  Saving model ...
Epoch: 8 cost time: 0.8490631580352783
Epoch: 8, Steps: 10 | Train Loss: 1.821 Vali Loss: 3.190 Vali Acc: 0.175 Test Loss: 3.190 Test Acc: 0.175
Validation loss decreased (-0.147027 --> -0.175262).  Saving model ...
Epoch: 9 cost time: 0.875575065612793
Epoch: 9, Steps: 10 | Train Loss: 1.528 Vali Loss: 3.189 Vali Acc: 0.189 Test Loss: 3.189 Test Acc: 0.189
Validation loss decreased (-0.175262 --> -0.189380).  Saving model ...
Epoch: 10 cost time: 0.8523907661437988
Epoch: 10, Steps: 10 | Train Loss: 1.180 Vali Loss: 3.223 Vali Acc: 0.204 Test Loss: 3.223 Test Acc: 0.204
Validation loss decreased (-0.189380 --> -0.203497).  Saving model ...
Epoch: 11 cost time: 0.8233587741851807
Epoch: 11, Steps: 10 | Train Loss: 0.881 Vali Loss: 3.299 Vali Acc: 0.220 Test Loss: 3.299 Test Acc: 0.220
Validation loss decreased (-0.203497 --> -0.219967).  Saving model ...
Epoch: 12 cost time: 0.8574252128601074
Epoch: 12, Steps: 10 | Train Loss: 0.619 Vali Loss: 3.384 Vali Acc: 0.239 Test Loss: 3.384 Test Acc: 0.239
Validation loss decreased (-0.219967 --> -0.238790).  Saving model ...
Epoch: 13 cost time: 0.8741409778594971
Epoch: 13, Steps: 10 | Train Loss: 0.420 Vali Loss: 3.500 Vali Acc: 0.244 Test Loss: 3.500 Test Acc: 0.244
Validation loss decreased (-0.238790 --> -0.243494).  Saving model ...
Epoch: 14 cost time: 0.8274414539337158
Epoch: 14, Steps: 10 | Train Loss: 0.295 Vali Loss: 3.601 Vali Acc: 0.247 Test Loss: 3.601 Test Acc: 0.247
Validation loss decreased (-0.243494 --> -0.247023).  Saving model ...
Epoch: 15 cost time: 0.8546469211578369
Epoch: 15, Steps: 10 | Train Loss: 0.173 Vali Loss: 3.787 Vali Acc: 0.251 Test Loss: 3.787 Test Acc: 0.251
Validation loss decreased (-0.247023 --> -0.250550).  Saving model ...
Epoch: 16 cost time: 0.8090968132019043
Epoch: 16, Steps: 10 | Train Loss: 0.116 Vali Loss: 3.921 Vali Acc: 0.248 Test Loss: 3.921 Test Acc: 0.248
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.842287540435791
Epoch: 17, Steps: 10 | Train Loss: 0.074 Vali Loss: 3.993 Vali Acc: 0.260 Test Loss: 3.993 Test Acc: 0.260
Validation loss decreased (-0.250550 --> -0.259960).  Saving model ...
Epoch: 18 cost time: 0.8486051559448242
Epoch: 18, Steps: 10 | Train Loss: 0.056 Vali Loss: 4.074 Vali Acc: 0.253 Test Loss: 4.074 Test Acc: 0.253
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8340437412261963
Epoch: 19, Steps: 10 | Train Loss: 0.042 Vali Loss: 4.163 Vali Acc: 0.252 Test Loss: 4.163 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.841437816619873
Epoch: 20, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.210 Vali Acc: 0.255 Test Loss: 4.210 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.8263804912567139
Epoch: 21, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.270 Vali Acc: 0.258 Test Loss: 4.270 Test Acc: 0.258
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.8337550163269043
Epoch: 22, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.328 Vali Acc: 0.258 Test Loss: 4.328 Test Acc: 0.258
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.758131742477417
Epoch: 23, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.379 Vali Acc: 0.265 Test Loss: 4.379 Test Acc: 0.265
Validation loss decreased (-0.259960 --> -0.264662).  Saving model ...
Epoch: 24 cost time: 0.7536616325378418
Epoch: 24, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.416 Vali Acc: 0.264 Test Loss: 4.416 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6976933479309082
Epoch: 25, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.453 Vali Acc: 0.264 Test Loss: 4.453 Test Acc: 0.264
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.8275933265686035
Epoch: 26, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.492 Vali Acc: 0.260 Test Loss: 4.492 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.7242386341094971
Epoch: 27, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.534 Vali Acc: 0.264 Test Loss: 4.534 Test Acc: 0.264
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.8586282730102539
Epoch: 28, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.585 Vali Acc: 0.264 Test Loss: 4.585 Test Acc: 0.264
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.9088795185089111
Epoch: 29, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.606 Vali Acc: 0.262 Test Loss: 4.606 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.9445521831512451
Epoch: 30, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.641 Vali Acc: 0.266 Test Loss: 4.641 Test Acc: 0.266
Validation loss decreased (-0.264662 --> -0.265836).  Saving model ...
Epoch: 31 cost time: 0.8879971504211426
Epoch: 31, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.667 Vali Acc: 0.266 Test Loss: 4.667 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.9455268383026123
Epoch: 32, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.696 Vali Acc: 0.267 Test Loss: 4.696 Test Acc: 0.267
Validation loss decreased (-0.265836 --> -0.267012).  Saving model ...
Epoch: 33 cost time: 0.8213357925415039
Epoch: 33, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.717 Vali Acc: 0.266 Test Loss: 4.717 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.8604536056518555
Epoch: 34, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.755 Vali Acc: 0.266 Test Loss: 4.755 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.8325667381286621
Epoch: 35, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.792 Vali Acc: 0.267 Test Loss: 4.792 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.9077267646789551
Epoch: 36, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.821 Vali Acc: 0.266 Test Loss: 4.821 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.9035177230834961
Epoch: 37, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.837 Vali Acc: 0.267 Test Loss: 4.837 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.810096025466919
Epoch: 38, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.858 Vali Acc: 0.268 Test Loss: 4.858 Test Acc: 0.268
Validation loss decreased (-0.267012 --> -0.268187).  Saving model ...
Epoch: 39 cost time: 0.795874834060669
Epoch: 39, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.879 Vali Acc: 0.267 Test Loss: 4.879 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.885462760925293
Epoch: 40, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.899 Vali Acc: 0.266 Test Loss: 4.899 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.9001679420471191
Epoch: 41, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.929 Vali Acc: 0.262 Test Loss: 4.929 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.7749233245849609
Epoch: 42, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.942 Vali Acc: 0.262 Test Loss: 4.942 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.8295743465423584
Epoch: 43, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.984 Vali Acc: 0.266 Test Loss: 4.984 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.7910435199737549
Epoch: 44, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.996 Vali Acc: 0.267 Test Loss: 4.996 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.868513822555542
Epoch: 45, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.014 Vali Acc: 0.269 Test Loss: 5.014 Test Acc: 0.269
Validation loss decreased (-0.268187 --> -0.269362).  Saving model ...
Epoch: 46 cost time: 0.9027359485626221
Epoch: 46, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.039 Vali Acc: 0.269 Test Loss: 5.039 Test Acc: 0.269
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.9203059673309326
Epoch: 47, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.052 Vali Acc: 0.271 Test Loss: 5.052 Test Acc: 0.271
Validation loss decreased (-0.269362 --> -0.270538).  Saving model ...
Epoch: 48 cost time: 0.852532148361206
Epoch: 48, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.079 Vali Acc: 0.269 Test Loss: 5.079 Test Acc: 0.269
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.9065704345703125
Epoch: 49, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.095 Vali Acc: 0.271 Test Loss: 5.095 Test Acc: 0.271
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.916581392288208
Epoch: 50, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.113 Vali Acc: 0.268 Test Loss: 5.113 Test Acc: 0.268
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps12_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27058823529411763
model parameter : 286810
model size : 1.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.0760865211486816
Epoch: 1, Steps: 10 | Train Loss: 3.305 Vali Loss: 3.266 Vali Acc: 0.048 Test Loss: 3.266 Test Acc: 0.048
Validation loss decreased (inf --> -0.048203).  Saving model ...
Epoch: 2 cost time: 0.8776094913482666
Epoch: 2, Steps: 10 | Train Loss: 3.211 Vali Loss: 3.254 Vali Acc: 0.065 Test Loss: 3.254 Test Acc: 0.065
Validation loss decreased (-0.048203 --> -0.064673).  Saving model ...
Epoch: 3 cost time: 1.020806074142456
Epoch: 3, Steps: 10 | Train Loss: 3.045 Vali Loss: 3.251 Vali Acc: 0.059 Test Loss: 3.251 Test Acc: 0.059
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8608386516571045
Epoch: 4, Steps: 10 | Train Loss: 2.923 Vali Loss: 3.258 Vali Acc: 0.065 Test Loss: 3.258 Test Acc: 0.065
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8688807487487793
Epoch: 5, Steps: 10 | Train Loss: 2.762 Vali Loss: 3.261 Vali Acc: 0.074 Test Loss: 3.261 Test Acc: 0.074
Validation loss decreased (-0.064673 --> -0.074085).  Saving model ...
Epoch: 6 cost time: 1.0493955612182617
Epoch: 6, Steps: 10 | Train Loss: 2.570 Vali Loss: 3.246 Vali Acc: 0.092 Test Loss: 3.246 Test Acc: 0.092
Validation loss decreased (-0.074085 --> -0.091732).  Saving model ...
Epoch: 7 cost time: 0.9670336246490479
Epoch: 7, Steps: 10 | Train Loss: 2.354 Vali Loss: 3.223 Vali Acc: 0.116 Test Loss: 3.223 Test Acc: 0.116
Validation loss decreased (-0.091732 --> -0.116438).  Saving model ...
Epoch: 8 cost time: 0.9414231777191162
Epoch: 8, Steps: 10 | Train Loss: 2.127 Vali Loss: 3.191 Vali Acc: 0.142 Test Loss: 3.191 Test Acc: 0.142
Validation loss decreased (-0.116438 --> -0.142321).  Saving model ...
Epoch: 9 cost time: 0.9406609535217285
Epoch: 9, Steps: 10 | Train Loss: 1.872 Vali Loss: 3.186 Vali Acc: 0.167 Test Loss: 3.186 Test Acc: 0.167
Validation loss decreased (-0.142321 --> -0.167027).  Saving model ...
Epoch: 10 cost time: 0.8271775245666504
Epoch: 10, Steps: 10 | Train Loss: 1.575 Vali Loss: 3.191 Vali Acc: 0.173 Test Loss: 3.191 Test Acc: 0.173
Validation loss decreased (-0.167027 --> -0.172909).  Saving model ...
Epoch: 11 cost time: 0.8319332599639893
Epoch: 11, Steps: 10 | Train Loss: 1.289 Vali Loss: 3.225 Vali Acc: 0.193 Test Loss: 3.225 Test Acc: 0.193
Validation loss decreased (-0.172909 --> -0.192909).  Saving model ...
Epoch: 12 cost time: 0.8742513656616211
Epoch: 12, Steps: 10 | Train Loss: 1.031 Vali Loss: 3.270 Vali Acc: 0.211 Test Loss: 3.270 Test Acc: 0.211
Validation loss decreased (-0.192909 --> -0.210556).  Saving model ...
Epoch: 13 cost time: 0.9598438739776611
Epoch: 13, Steps: 10 | Train Loss: 0.806 Vali Loss: 3.325 Vali Acc: 0.224 Test Loss: 3.325 Test Acc: 0.224
Validation loss decreased (-0.210556 --> -0.223496).  Saving model ...
Epoch: 14 cost time: 0.9583590030670166
Epoch: 14, Steps: 10 | Train Loss: 0.609 Vali Loss: 3.409 Vali Acc: 0.235 Test Loss: 3.409 Test Acc: 0.235
Validation loss decreased (-0.223496 --> -0.235260).  Saving model ...
Epoch: 15 cost time: 0.8318161964416504
Epoch: 15, Steps: 10 | Train Loss: 0.440 Vali Loss: 3.514 Vali Acc: 0.252 Test Loss: 3.514 Test Acc: 0.252
Validation loss decreased (-0.235260 --> -0.251730).  Saving model ...
Epoch: 16 cost time: 0.8889510631561279
Epoch: 16, Steps: 10 | Train Loss: 0.301 Vali Loss: 3.616 Vali Acc: 0.253 Test Loss: 3.616 Test Acc: 0.253
Validation loss decreased (-0.251730 --> -0.252905).  Saving model ...
Epoch: 17 cost time: 0.8803794384002686
Epoch: 17, Steps: 10 | Train Loss: 0.199 Vali Loss: 3.755 Vali Acc: 0.248 Test Loss: 3.755 Test Acc: 0.248
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8789176940917969
Epoch: 18, Steps: 10 | Train Loss: 0.142 Vali Loss: 3.878 Vali Acc: 0.246 Test Loss: 3.878 Test Acc: 0.246
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7927050590515137
Epoch: 19, Steps: 10 | Train Loss: 0.102 Vali Loss: 3.957 Vali Acc: 0.253 Test Loss: 3.957 Test Acc: 0.253
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.8144776821136475
Epoch: 20, Steps: 10 | Train Loss: 0.076 Vali Loss: 4.010 Vali Acc: 0.254 Test Loss: 4.010 Test Acc: 0.254
Validation loss decreased (-0.252905 --> -0.254078).  Saving model ...
Epoch: 21 cost time: 0.8244268894195557
Epoch: 21, Steps: 10 | Train Loss: 0.056 Vali Loss: 4.097 Vali Acc: 0.258 Test Loss: 4.097 Test Acc: 0.258
Validation loss decreased (-0.254078 --> -0.257606).  Saving model ...
Epoch: 22 cost time: 0.9578652381896973
Epoch: 22, Steps: 10 | Train Loss: 0.045 Vali Loss: 4.157 Vali Acc: 0.252 Test Loss: 4.157 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9710555076599121
Epoch: 23, Steps: 10 | Train Loss: 0.038 Vali Loss: 4.213 Vali Acc: 0.259 Test Loss: 4.213 Test Acc: 0.259
Validation loss decreased (-0.257606 --> -0.258781).  Saving model ...
Epoch: 24 cost time: 0.9474442005157471
Epoch: 24, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.260 Vali Acc: 0.262 Test Loss: 4.260 Test Acc: 0.262
Validation loss decreased (-0.258781 --> -0.262310).  Saving model ...
Epoch: 25 cost time: 0.926304817199707
Epoch: 25, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.314 Vali Acc: 0.262 Test Loss: 4.314 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.90045166015625
Epoch: 26, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.352 Vali Acc: 0.267 Test Loss: 4.352 Test Acc: 0.267
Validation loss decreased (-0.262310 --> -0.267015).  Saving model ...
Epoch: 27 cost time: 0.8786067962646484
Epoch: 27, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.401 Vali Acc: 0.264 Test Loss: 4.401 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8614633083343506
Epoch: 28, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.430 Vali Acc: 0.256 Test Loss: 4.430 Test Acc: 0.256
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.8862850666046143
Epoch: 29, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.476 Vali Acc: 0.255 Test Loss: 4.476 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.9199912548065186
Epoch: 30, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.517 Vali Acc: 0.261 Test Loss: 4.517 Test Acc: 0.261
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.869619607925415
Epoch: 31, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.549 Vali Acc: 0.259 Test Loss: 4.549 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.9165396690368652
Epoch: 32, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.576 Vali Acc: 0.262 Test Loss: 4.576 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.922476053237915
Epoch: 33, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.612 Vali Acc: 0.261 Test Loss: 4.612 Test Acc: 0.261
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.9287800788879395
Epoch: 34, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.643 Vali Acc: 0.259 Test Loss: 4.643 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.9260737895965576
Epoch: 35, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.662 Vali Acc: 0.267 Test Loss: 4.662 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.0198051929473877
Epoch: 36, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.701 Vali Acc: 0.265 Test Loss: 4.701 Test Acc: 0.265
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26705882352941174
model parameter : 257114
model size : 1.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps23_str12_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.4000637531280518
Epoch: 1, Steps: 10 | Train Loss: 3.291 Vali Loss: 3.270 Vali Acc: 0.045 Test Loss: 3.270 Test Acc: 0.045
Validation loss decreased (inf --> -0.044673).  Saving model ...
Epoch: 2 cost time: 0.8831472396850586
Epoch: 2, Steps: 10 | Train Loss: 3.255 Vali Loss: 3.265 Vali Acc: 0.047 Test Loss: 3.265 Test Acc: 0.047
Validation loss decreased (-0.044673 --> -0.047026).  Saving model ...
Epoch: 3 cost time: 0.8585038185119629
Epoch: 3, Steps: 10 | Train Loss: 3.150 Vali Loss: 3.260 Vali Acc: 0.054 Test Loss: 3.260 Test Acc: 0.054
Validation loss decreased (-0.047026 --> -0.054085).  Saving model ...
Epoch: 4 cost time: 0.8515498638153076
Epoch: 4, Steps: 10 | Train Loss: 3.056 Vali Loss: 3.256 Vali Acc: 0.060 Test Loss: 3.256 Test Acc: 0.060
Validation loss decreased (-0.054085 --> -0.059967).  Saving model ...
Epoch: 5 cost time: 0.8307712078094482
Epoch: 5, Steps: 10 | Train Loss: 2.901 Vali Loss: 3.250 Vali Acc: 0.074 Test Loss: 3.250 Test Acc: 0.074
Validation loss decreased (-0.059967 --> -0.074085).  Saving model ...
Epoch: 6 cost time: 0.8946964740753174
Epoch: 6, Steps: 10 | Train Loss: 2.820 Vali Loss: 3.246 Vali Acc: 0.092 Test Loss: 3.246 Test Acc: 0.092
Validation loss decreased (-0.074085 --> -0.091732).  Saving model ...
Epoch: 7 cost time: 0.8103771209716797
Epoch: 7, Steps: 10 | Train Loss: 2.641 Vali Loss: 3.238 Vali Acc: 0.096 Test Loss: 3.238 Test Acc: 0.096
Validation loss decreased (-0.091732 --> -0.096438).  Saving model ...
Epoch: 8 cost time: 0.8679361343383789
Epoch: 8, Steps: 10 | Train Loss: 2.507 Vali Loss: 3.225 Vali Acc: 0.112 Test Loss: 3.225 Test Acc: 0.112
Validation loss decreased (-0.096438 --> -0.111732).  Saving model ...
Epoch: 9 cost time: 0.7472000122070312
Epoch: 9, Steps: 10 | Train Loss: 2.328 Vali Loss: 3.205 Vali Acc: 0.121 Test Loss: 3.205 Test Acc: 0.121
Validation loss decreased (-0.111732 --> -0.121144).  Saving model ...
Epoch: 10 cost time: 0.8679146766662598
Epoch: 10, Steps: 10 | Train Loss: 2.123 Vali Loss: 3.190 Vali Acc: 0.142 Test Loss: 3.190 Test Acc: 0.142
Validation loss decreased (-0.121144 --> -0.142321).  Saving model ...
Epoch: 11 cost time: 0.9255702495574951
Epoch: 11, Steps: 10 | Train Loss: 1.886 Vali Loss: 3.180 Vali Acc: 0.160 Test Loss: 3.180 Test Acc: 0.160
Validation loss decreased (-0.142321 --> -0.159968).  Saving model ...
Epoch: 12 cost time: 0.8699507713317871
Epoch: 12, Steps: 10 | Train Loss: 1.704 Vali Loss: 3.176 Vali Acc: 0.166 Test Loss: 3.176 Test Acc: 0.166
Validation loss decreased (-0.159968 --> -0.165851).  Saving model ...
Epoch: 13 cost time: 0.8680760860443115
Epoch: 13, Steps: 10 | Train Loss: 1.477 Vali Loss: 3.179 Vali Acc: 0.186 Test Loss: 3.179 Test Acc: 0.186
Validation loss decreased (-0.165851 --> -0.185851).  Saving model ...
Epoch: 14 cost time: 0.8697967529296875
Epoch: 14, Steps: 10 | Train Loss: 1.258 Vali Loss: 3.193 Vali Acc: 0.194 Test Loss: 3.193 Test Acc: 0.194
Validation loss decreased (-0.185851 --> -0.194086).  Saving model ...
Epoch: 15 cost time: 0.9101274013519287
Epoch: 15, Steps: 10 | Train Loss: 1.024 Vali Loss: 3.216 Vali Acc: 0.204 Test Loss: 3.216 Test Acc: 0.204
Validation loss decreased (-0.194086 --> -0.203497).  Saving model ...
Epoch: 16 cost time: 0.8237755298614502
Epoch: 16, Steps: 10 | Train Loss: 0.838 Vali Loss: 3.261 Vali Acc: 0.219 Test Loss: 3.261 Test Acc: 0.219
Validation loss decreased (-0.203497 --> -0.218791).  Saving model ...
Epoch: 17 cost time: 0.7790653705596924
Epoch: 17, Steps: 10 | Train Loss: 0.711 Vali Loss: 3.320 Vali Acc: 0.233 Test Loss: 3.320 Test Acc: 0.233
Validation loss decreased (-0.218791 --> -0.232908).  Saving model ...
Epoch: 18 cost time: 0.770500898361206
Epoch: 18, Steps: 10 | Train Loss: 0.531 Vali Loss: 3.382 Vali Acc: 0.247 Test Loss: 3.382 Test Acc: 0.247
Validation loss decreased (-0.232908 --> -0.247025).  Saving model ...
Epoch: 19 cost time: 0.8855926990509033
Epoch: 19, Steps: 10 | Train Loss: 0.400 Vali Loss: 3.439 Vali Acc: 0.254 Test Loss: 3.439 Test Acc: 0.254
Validation loss decreased (-0.247025 --> -0.254083).  Saving model ...
Epoch: 20 cost time: 0.9489939212799072
Epoch: 20, Steps: 10 | Train Loss: 0.321 Vali Loss: 3.504 Vali Acc: 0.266 Test Loss: 3.504 Test Acc: 0.266
Validation loss decreased (-0.254083 --> -0.265847).  Saving model ...
Epoch: 21 cost time: 0.8899133205413818
Epoch: 21, Steps: 10 | Train Loss: 0.230 Vali Loss: 3.593 Vali Acc: 0.260 Test Loss: 3.593 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9230575561523438
Epoch: 22, Steps: 10 | Train Loss: 0.176 Vali Loss: 3.646 Vali Acc: 0.260 Test Loss: 3.646 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.9406330585479736
Epoch: 23, Steps: 10 | Train Loss: 0.147 Vali Loss: 3.715 Vali Acc: 0.264 Test Loss: 3.715 Test Acc: 0.264
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.9327902793884277
Epoch: 24, Steps: 10 | Train Loss: 0.103 Vali Loss: 3.755 Vali Acc: 0.281 Test Loss: 3.755 Test Acc: 0.281
Validation loss decreased (-0.265847 --> -0.281139).  Saving model ...
Epoch: 25 cost time: 0.8817203044891357
Epoch: 25, Steps: 10 | Train Loss: 0.089 Vali Loss: 3.811 Vali Acc: 0.279 Test Loss: 3.811 Test Acc: 0.279
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8743722438812256
Epoch: 26, Steps: 10 | Train Loss: 0.079 Vali Loss: 3.852 Vali Acc: 0.279 Test Loss: 3.852 Test Acc: 0.279
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.8155064582824707
Epoch: 27, Steps: 10 | Train Loss: 0.066 Vali Loss: 3.903 Vali Acc: 0.271 Test Loss: 3.903 Test Acc: 0.271
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.8414411544799805
Epoch: 28, Steps: 10 | Train Loss: 0.055 Vali Loss: 3.967 Vali Acc: 0.272 Test Loss: 3.967 Test Acc: 0.272
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.8457460403442383
Epoch: 29, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.995 Vali Acc: 0.279 Test Loss: 3.995 Test Acc: 0.279
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.8644006252288818
Epoch: 30, Steps: 10 | Train Loss: 0.039 Vali Loss: 4.013 Vali Acc: 0.281 Test Loss: 4.013 Test Acc: 0.281
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.879852294921875
Epoch: 31, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.034 Vali Acc: 0.288 Test Loss: 4.034 Test Acc: 0.288
Validation loss decreased (-0.281139 --> -0.288195).  Saving model ...
Epoch: 32 cost time: 0.8397243022918701
Epoch: 32, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.061 Vali Acc: 0.289 Test Loss: 4.061 Test Acc: 0.289
Validation loss decreased (-0.288195 --> -0.289371).  Saving model ...
Epoch: 33 cost time: 0.8482379913330078
Epoch: 33, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.096 Vali Acc: 0.284 Test Loss: 4.096 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.8709502220153809
Epoch: 34, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.129 Vali Acc: 0.285 Test Loss: 4.129 Test Acc: 0.285
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.8554885387420654
Epoch: 35, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.149 Vali Acc: 0.287 Test Loss: 4.149 Test Acc: 0.287
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.9121904373168945
Epoch: 36, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.168 Vali Acc: 0.287 Test Loss: 4.168 Test Acc: 0.287
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.7872669696807861
Epoch: 37, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.197 Vali Acc: 0.287 Test Loss: 4.197 Test Acc: 0.287
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.7747297286987305
Epoch: 38, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.228 Vali Acc: 0.287 Test Loss: 4.228 Test Acc: 0.287
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.9487977027893066
Epoch: 39, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.264 Vali Acc: 0.291 Test Loss: 4.264 Test Acc: 0.291
Validation loss decreased (-0.289371 --> -0.290546).  Saving model ...
Epoch: 40 cost time: 0.8948104381561279
Epoch: 40, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.282 Vali Acc: 0.287 Test Loss: 4.282 Test Acc: 0.287
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.9579706192016602
Epoch: 41, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.304 Vali Acc: 0.286 Test Loss: 4.304 Test Acc: 0.286
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.8814384937286377
Epoch: 42, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.331 Vali Acc: 0.284 Test Loss: 4.331 Test Acc: 0.284
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.9422900676727295
Epoch: 43, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.346 Vali Acc: 0.285 Test Loss: 4.346 Test Acc: 0.285
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.8811373710632324
Epoch: 44, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.357 Vali Acc: 0.286 Test Loss: 4.357 Test Acc: 0.286
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.8915328979492188
Epoch: 45, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.383 Vali Acc: 0.285 Test Loss: 4.383 Test Acc: 0.285
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.7708086967468262
Epoch: 46, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.397 Vali Acc: 0.286 Test Loss: 4.397 Test Acc: 0.286
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.8104088306427002
Epoch: 47, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.421 Vali Acc: 0.287 Test Loss: 4.421 Test Acc: 0.287
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 0.932537317276001
Epoch: 48, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.431 Vali Acc: 0.291 Test Loss: 4.431 Test Acc: 0.291
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 0.9134249687194824
Epoch: 49, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.442 Vali Acc: 0.294 Test Loss: 4.442 Test Acc: 0.294
Validation loss decreased (-0.290546 --> -0.294073).  Saving model ...
Epoch: 50 cost time: 0.921837568283081
Epoch: 50, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.472 Vali Acc: 0.293 Test Loss: 4.472 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps23_str12_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.29411764705882354
model parameter : 217626
model size : 0.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.247382879257202
Epoch: 1, Steps: 10 | Train Loss: 3.265 Vali Loss: 3.274 Vali Acc: 0.046 Test Loss: 3.274 Test Acc: 0.046
Validation loss decreased (inf --> -0.045850).  Saving model ...
Epoch: 2 cost time: 0.9240174293518066
Epoch: 2, Steps: 10 | Train Loss: 3.232 Vali Loss: 3.268 Vali Acc: 0.058 Test Loss: 3.268 Test Acc: 0.058
Validation loss decreased (-0.045850 --> -0.057614).  Saving model ...
Epoch: 3 cost time: 0.8127954006195068
Epoch: 3, Steps: 10 | Train Loss: 3.170 Vali Loss: 3.263 Vali Acc: 0.059 Test Loss: 3.263 Test Acc: 0.059
Validation loss decreased (-0.057614 --> -0.058791).  Saving model ...
Epoch: 4 cost time: 0.7752618789672852
Epoch: 4, Steps: 10 | Train Loss: 3.082 Vali Loss: 3.258 Vali Acc: 0.081 Test Loss: 3.258 Test Acc: 0.081
Validation loss decreased (-0.058791 --> -0.081144).  Saving model ...
Epoch: 5 cost time: 0.8833489418029785
Epoch: 5, Steps: 10 | Train Loss: 2.955 Vali Loss: 3.254 Vali Acc: 0.080 Test Loss: 3.254 Test Acc: 0.080
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9447238445281982
Epoch: 6, Steps: 10 | Train Loss: 2.849 Vali Loss: 3.247 Vali Acc: 0.092 Test Loss: 3.247 Test Acc: 0.092
Validation loss decreased (-0.081144 --> -0.091732).  Saving model ...
Epoch: 7 cost time: 0.893582820892334
Epoch: 7, Steps: 10 | Train Loss: 2.747 Vali Loss: 3.238 Vali Acc: 0.100 Test Loss: 3.238 Test Acc: 0.100
Validation loss decreased (-0.091732 --> -0.099968).  Saving model ...
Epoch: 8 cost time: 0.8464150428771973
Epoch: 8, Steps: 10 | Train Loss: 2.619 Vali Loss: 3.228 Vali Acc: 0.114 Test Loss: 3.228 Test Acc: 0.114
Validation loss decreased (-0.099968 --> -0.114085).  Saving model ...
Epoch: 9 cost time: 0.8115699291229248
Epoch: 9, Steps: 10 | Train Loss: 2.473 Vali Loss: 3.219 Vali Acc: 0.133 Test Loss: 3.219 Test Acc: 0.133
Validation loss decreased (-0.114085 --> -0.132909).  Saving model ...
Epoch: 10 cost time: 0.8519001007080078
Epoch: 10, Steps: 10 | Train Loss: 2.347 Vali Loss: 3.200 Vali Acc: 0.136 Test Loss: 3.200 Test Acc: 0.136
Validation loss decreased (-0.132909 --> -0.136439).  Saving model ...
Epoch: 11 cost time: 0.879849910736084
Epoch: 11, Steps: 10 | Train Loss: 2.165 Vali Loss: 3.191 Vali Acc: 0.141 Test Loss: 3.191 Test Acc: 0.141
Validation loss decreased (-0.136439 --> -0.141145).  Saving model ...
Epoch: 12 cost time: 0.8913750648498535
Epoch: 12, Steps: 10 | Train Loss: 1.955 Vali Loss: 3.192 Vali Acc: 0.151 Test Loss: 3.192 Test Acc: 0.151
Validation loss decreased (-0.141145 --> -0.150556).  Saving model ...
Epoch: 13 cost time: 0.8273074626922607
Epoch: 13, Steps: 10 | Train Loss: 1.770 Vali Loss: 3.191 Vali Acc: 0.156 Test Loss: 3.191 Test Acc: 0.156
Validation loss decreased (-0.150556 --> -0.156439).  Saving model ...
Epoch: 14 cost time: 0.8361063003540039
Epoch: 14, Steps: 10 | Train Loss: 1.553 Vali Loss: 3.188 Vali Acc: 0.167 Test Loss: 3.188 Test Acc: 0.167
Validation loss decreased (-0.156439 --> -0.167027).  Saving model ...
Epoch: 15 cost time: 0.9049110412597656
Epoch: 15, Steps: 10 | Train Loss: 1.402 Vali Loss: 3.204 Vali Acc: 0.182 Test Loss: 3.204 Test Acc: 0.182
Validation loss decreased (-0.167027 --> -0.182321).  Saving model ...
Epoch: 16 cost time: 0.9153134822845459
Epoch: 16, Steps: 10 | Train Loss: 1.163 Vali Loss: 3.229 Vali Acc: 0.181 Test Loss: 3.229 Test Acc: 0.181
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8975131511688232
Epoch: 17, Steps: 10 | Train Loss: 1.024 Vali Loss: 3.264 Vali Acc: 0.191 Test Loss: 3.264 Test Acc: 0.191
Validation loss decreased (-0.182321 --> -0.190556).  Saving model ...
Epoch: 18 cost time: 0.8464109897613525
Epoch: 18, Steps: 10 | Train Loss: 0.859 Vali Loss: 3.295 Vali Acc: 0.205 Test Loss: 3.295 Test Acc: 0.205
Validation loss decreased (-0.190556 --> -0.204673).  Saving model ...
Epoch: 19 cost time: 0.9003746509552002
Epoch: 19, Steps: 10 | Train Loss: 0.719 Vali Loss: 3.331 Vali Acc: 0.222 Test Loss: 3.331 Test Acc: 0.222
Validation loss decreased (-0.204673 --> -0.222320).  Saving model ...
Epoch: 20 cost time: 0.9898815155029297
Epoch: 20, Steps: 10 | Train Loss: 0.564 Vali Loss: 3.389 Vali Acc: 0.228 Test Loss: 3.389 Test Acc: 0.228
Validation loss decreased (-0.222320 --> -0.228201).  Saving model ...
Epoch: 21 cost time: 0.8712217807769775
Epoch: 21, Steps: 10 | Train Loss: 0.436 Vali Loss: 3.461 Vali Acc: 0.234 Test Loss: 3.461 Test Acc: 0.234
Validation loss decreased (-0.228201 --> -0.234083).  Saving model ...
Epoch: 22 cost time: 0.77402663230896
Epoch: 22, Steps: 10 | Train Loss: 0.354 Vali Loss: 3.513 Vali Acc: 0.248 Test Loss: 3.513 Test Acc: 0.248
Validation loss decreased (-0.234083 --> -0.248200).  Saving model ...
Epoch: 23 cost time: 0.7966456413269043
Epoch: 23, Steps: 10 | Train Loss: 0.270 Vali Loss: 3.563 Vali Acc: 0.254 Test Loss: 3.563 Test Acc: 0.254
Validation loss decreased (-0.248200 --> -0.254082).  Saving model ...
Epoch: 24 cost time: 0.8792626857757568
Epoch: 24, Steps: 10 | Train Loss: 0.214 Vali Loss: 3.632 Vali Acc: 0.256 Test Loss: 3.632 Test Acc: 0.256
Validation loss decreased (-0.254082 --> -0.256434).  Saving model ...
Epoch: 25 cost time: 0.8924429416656494
Epoch: 25, Steps: 10 | Train Loss: 0.177 Vali Loss: 3.694 Vali Acc: 0.260 Test Loss: 3.694 Test Acc: 0.260
Validation loss decreased (-0.256434 --> -0.259963).  Saving model ...
Epoch: 26 cost time: 0.8710527420043945
Epoch: 26, Steps: 10 | Train Loss: 0.129 Vali Loss: 3.771 Vali Acc: 0.253 Test Loss: 3.771 Test Acc: 0.253
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8791391849517822
Epoch: 27, Steps: 10 | Train Loss: 0.121 Vali Loss: 3.813 Vali Acc: 0.253 Test Loss: 3.813 Test Acc: 0.253
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.9340460300445557
Epoch: 28, Steps: 10 | Train Loss: 0.097 Vali Loss: 3.849 Vali Acc: 0.264 Test Loss: 3.849 Test Acc: 0.264
Validation loss decreased (-0.259963 --> -0.263491).  Saving model ...
Epoch: 29 cost time: 0.8984427452087402
Epoch: 29, Steps: 10 | Train Loss: 0.086 Vali Loss: 3.892 Vali Acc: 0.266 Test Loss: 3.892 Test Acc: 0.266
Validation loss decreased (-0.263491 --> -0.265843).  Saving model ...
Epoch: 30 cost time: 0.886824369430542
Epoch: 30, Steps: 10 | Train Loss: 0.069 Vali Loss: 3.922 Vali Acc: 0.265 Test Loss: 3.922 Test Acc: 0.265
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.861933708190918
Epoch: 31, Steps: 10 | Train Loss: 0.060 Vali Loss: 3.960 Vali Acc: 0.266 Test Loss: 3.960 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.8214278221130371
Epoch: 32, Steps: 10 | Train Loss: 0.053 Vali Loss: 4.019 Vali Acc: 0.264 Test Loss: 4.019 Test Acc: 0.264
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.9330878257751465
Epoch: 33, Steps: 10 | Train Loss: 0.056 Vali Loss: 4.051 Vali Acc: 0.265 Test Loss: 4.051 Test Acc: 0.265
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.9007303714752197
Epoch: 34, Steps: 10 | Train Loss: 0.044 Vali Loss: 4.079 Vali Acc: 0.269 Test Loss: 4.079 Test Acc: 0.269
Validation loss decreased (-0.265843 --> -0.269371).  Saving model ...
Epoch: 35 cost time: 0.8598670959472656
Epoch: 35, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.109 Vali Acc: 0.276 Test Loss: 4.109 Test Acc: 0.276
Validation loss decreased (-0.269371 --> -0.276430).  Saving model ...
Epoch: 36 cost time: 0.8633866310119629
Epoch: 36, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.141 Vali Acc: 0.275 Test Loss: 4.141 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.9384944438934326
Epoch: 37, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.177 Vali Acc: 0.275 Test Loss: 4.177 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.9423432350158691
Epoch: 38, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.215 Vali Acc: 0.272 Test Loss: 4.215 Test Acc: 0.272
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.8790912628173828
Epoch: 39, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.225 Vali Acc: 0.273 Test Loss: 4.225 Test Acc: 0.273
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.8462238311767578
Epoch: 40, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.250 Vali Acc: 0.273 Test Loss: 4.250 Test Acc: 0.273
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.7966325283050537
Epoch: 41, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.260 Vali Acc: 0.275 Test Loss: 4.260 Test Acc: 0.275
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.8975679874420166
Epoch: 42, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.298 Vali Acc: 0.272 Test Loss: 4.298 Test Acc: 0.272
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.9470546245574951
Epoch: 43, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.317 Vali Acc: 0.273 Test Loss: 4.317 Test Acc: 0.273
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.928185224533081
Epoch: 44, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.326 Vali Acc: 0.275 Test Loss: 4.326 Test Acc: 0.275
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.9491024017333984
Epoch: 45, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.333 Vali Acc: 0.275 Test Loss: 4.333 Test Acc: 0.275
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27647058823529413
model parameter : 208154
model size : 0.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps38_str19_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.2820332050323486
Epoch: 1, Steps: 10 | Train Loss: 3.302 Vali Loss: 3.267 Vali Acc: 0.039 Test Loss: 3.267 Test Acc: 0.039
Validation loss decreased (inf --> -0.038791).  Saving model ...
Epoch: 2 cost time: 0.7898414134979248
Epoch: 2, Steps: 10 | Train Loss: 3.243 Vali Loss: 3.263 Vali Acc: 0.047 Test Loss: 3.263 Test Acc: 0.047
Validation loss decreased (-0.038791 --> -0.047026).  Saving model ...
Epoch: 3 cost time: 0.7883419990539551
Epoch: 3, Steps: 10 | Train Loss: 3.176 Vali Loss: 3.256 Vali Acc: 0.059 Test Loss: 3.256 Test Acc: 0.059
Validation loss decreased (-0.047026 --> -0.058791).  Saving model ...
Epoch: 4 cost time: 0.8023574352264404
Epoch: 4, Steps: 10 | Train Loss: 3.111 Vali Loss: 3.251 Vali Acc: 0.067 Test Loss: 3.251 Test Acc: 0.067
Validation loss decreased (-0.058791 --> -0.067026).  Saving model ...
Epoch: 5 cost time: 0.9039120674133301
Epoch: 5, Steps: 10 | Train Loss: 3.016 Vali Loss: 3.248 Vali Acc: 0.081 Test Loss: 3.248 Test Acc: 0.081
Validation loss decreased (-0.067026 --> -0.081144).  Saving model ...
Epoch: 6 cost time: 0.8944351673126221
Epoch: 6, Steps: 10 | Train Loss: 2.891 Vali Loss: 3.244 Vali Acc: 0.091 Test Loss: 3.244 Test Acc: 0.091
Validation loss decreased (-0.081144 --> -0.090556).  Saving model ...
Epoch: 7 cost time: 0.9425711631774902
Epoch: 7, Steps: 10 | Train Loss: 2.789 Vali Loss: 3.241 Vali Acc: 0.100 Test Loss: 3.241 Test Acc: 0.100
Validation loss decreased (-0.090556 --> -0.099968).  Saving model ...
Epoch: 8 cost time: 0.8947794437408447
Epoch: 8, Steps: 10 | Train Loss: 2.670 Vali Loss: 3.235 Vali Acc: 0.113 Test Loss: 3.235 Test Acc: 0.113
Validation loss decreased (-0.099968 --> -0.112909).  Saving model ...
Epoch: 9 cost time: 0.8543262481689453
Epoch: 9, Steps: 10 | Train Loss: 2.529 Vali Loss: 3.224 Vali Acc: 0.126 Test Loss: 3.224 Test Acc: 0.126
Validation loss decreased (-0.112909 --> -0.125850).  Saving model ...
Epoch: 10 cost time: 0.8442587852478027
Epoch: 10, Steps: 10 | Train Loss: 2.361 Vali Loss: 3.218 Vali Acc: 0.136 Test Loss: 3.218 Test Acc: 0.136
Validation loss decreased (-0.125850 --> -0.136438).  Saving model ...
Epoch: 11 cost time: 0.9629602432250977
Epoch: 11, Steps: 10 | Train Loss: 2.243 Vali Loss: 3.208 Vali Acc: 0.148 Test Loss: 3.208 Test Acc: 0.148
Validation loss decreased (-0.136438 --> -0.148203).  Saving model ...
Epoch: 12 cost time: 0.8231964111328125
Epoch: 12, Steps: 10 | Train Loss: 2.107 Vali Loss: 3.203 Vali Acc: 0.159 Test Loss: 3.203 Test Acc: 0.159
Validation loss decreased (-0.148203 --> -0.158791).  Saving model ...
Epoch: 13 cost time: 0.8315761089324951
Epoch: 13, Steps: 10 | Train Loss: 1.935 Vali Loss: 3.194 Vali Acc: 0.169 Test Loss: 3.194 Test Acc: 0.169
Validation loss decreased (-0.158791 --> -0.169380).  Saving model ...
Epoch: 14 cost time: 0.8701627254486084
Epoch: 14, Steps: 10 | Train Loss: 1.766 Vali Loss: 3.195 Vali Acc: 0.173 Test Loss: 3.195 Test Acc: 0.173
Validation loss decreased (-0.169380 --> -0.172909).  Saving model ...
Epoch: 15 cost time: 0.8997581005096436
Epoch: 15, Steps: 10 | Train Loss: 1.568 Vali Loss: 3.200 Vali Acc: 0.185 Test Loss: 3.200 Test Acc: 0.185
Validation loss decreased (-0.172909 --> -0.184674).  Saving model ...
Epoch: 16 cost time: 0.828035831451416
Epoch: 16, Steps: 10 | Train Loss: 1.377 Vali Loss: 3.213 Vali Acc: 0.187 Test Loss: 3.213 Test Acc: 0.187
Validation loss decreased (-0.184674 --> -0.187027).  Saving model ...
Epoch: 17 cost time: 0.8503365516662598
Epoch: 17, Steps: 10 | Train Loss: 1.210 Vali Loss: 3.225 Vali Acc: 0.199 Test Loss: 3.225 Test Acc: 0.199
Validation loss decreased (-0.187027 --> -0.198791).  Saving model ...
Epoch: 18 cost time: 0.873776912689209
Epoch: 18, Steps: 10 | Train Loss: 1.045 Vali Loss: 3.243 Vali Acc: 0.206 Test Loss: 3.243 Test Acc: 0.206
Validation loss decreased (-0.198791 --> -0.205850).  Saving model ...
Epoch: 19 cost time: 0.7968928813934326
Epoch: 19, Steps: 10 | Train Loss: 0.879 Vali Loss: 3.283 Vali Acc: 0.214 Test Loss: 3.283 Test Acc: 0.214
Validation loss decreased (-0.205850 --> -0.214085).  Saving model ...
Epoch: 20 cost time: 0.8452205657958984
Epoch: 20, Steps: 10 | Train Loss: 0.711 Vali Loss: 3.331 Vali Acc: 0.218 Test Loss: 3.331 Test Acc: 0.218
Validation loss decreased (-0.214085 --> -0.217614).  Saving model ...
Epoch: 21 cost time: 0.8377377986907959
Epoch: 21, Steps: 10 | Train Loss: 0.596 Vali Loss: 3.391 Vali Acc: 0.219 Test Loss: 3.391 Test Acc: 0.219
Validation loss decreased (-0.217614 --> -0.218790).  Saving model ...
Epoch: 22 cost time: 0.7936127185821533
Epoch: 22, Steps: 10 | Train Loss: 0.464 Vali Loss: 3.440 Vali Acc: 0.225 Test Loss: 3.440 Test Acc: 0.225
Validation loss decreased (-0.218790 --> -0.224671).  Saving model ...
Epoch: 23 cost time: 0.8337523937225342
Epoch: 23, Steps: 10 | Train Loss: 0.389 Vali Loss: 3.500 Vali Acc: 0.231 Test Loss: 3.500 Test Acc: 0.231
Validation loss decreased (-0.224671 --> -0.230553).  Saving model ...
Epoch: 24 cost time: 0.9117529392242432
Epoch: 24, Steps: 10 | Train Loss: 0.305 Vali Loss: 3.551 Vali Acc: 0.239 Test Loss: 3.551 Test Acc: 0.239
Validation loss decreased (-0.230553 --> -0.238788).  Saving model ...
Epoch: 25 cost time: 0.8616340160369873
Epoch: 25, Steps: 10 | Train Loss: 0.266 Vali Loss: 3.623 Vali Acc: 0.236 Test Loss: 3.623 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9186508655548096
Epoch: 26, Steps: 10 | Train Loss: 0.216 Vali Loss: 3.680 Vali Acc: 0.240 Test Loss: 3.680 Test Acc: 0.240
Validation loss decreased (-0.238788 --> -0.239963).  Saving model ...
Epoch: 27 cost time: 0.8649425506591797
Epoch: 27, Steps: 10 | Train Loss: 0.183 Vali Loss: 3.722 Vali Acc: 0.241 Test Loss: 3.722 Test Acc: 0.241
Validation loss decreased (-0.239963 --> -0.241139).  Saving model ...
Epoch: 28 cost time: 0.715073823928833
Epoch: 28, Steps: 10 | Train Loss: 0.147 Vali Loss: 3.776 Vali Acc: 0.245 Test Loss: 3.776 Test Acc: 0.245
Validation loss decreased (-0.241139 --> -0.244668).  Saving model ...
Epoch: 29 cost time: 0.8228373527526855
Epoch: 29, Steps: 10 | Train Loss: 0.119 Vali Loss: 3.802 Vali Acc: 0.247 Test Loss: 3.802 Test Acc: 0.247
Validation loss decreased (-0.244668 --> -0.247021).  Saving model ...
Epoch: 30 cost time: 0.925246000289917
Epoch: 30, Steps: 10 | Train Loss: 0.103 Vali Loss: 3.850 Vali Acc: 0.248 Test Loss: 3.850 Test Acc: 0.248
Validation loss decreased (-0.247021 --> -0.248197).  Saving model ...
Epoch: 31 cost time: 0.8867721557617188
Epoch: 31, Steps: 10 | Train Loss: 0.088 Vali Loss: 3.900 Vali Acc: 0.251 Test Loss: 3.900 Test Acc: 0.251
Validation loss decreased (-0.248197 --> -0.250549).  Saving model ...
Epoch: 32 cost time: 0.8152878284454346
Epoch: 32, Steps: 10 | Train Loss: 0.077 Vali Loss: 3.954 Vali Acc: 0.254 Test Loss: 3.954 Test Acc: 0.254
Validation loss decreased (-0.250549 --> -0.254078).  Saving model ...
Epoch: 33 cost time: 0.8710041046142578
Epoch: 33, Steps: 10 | Train Loss: 0.075 Vali Loss: 3.993 Vali Acc: 0.254 Test Loss: 3.993 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.8970987796783447
Epoch: 34, Steps: 10 | Train Loss: 0.063 Vali Loss: 4.030 Vali Acc: 0.254 Test Loss: 4.030 Test Acc: 0.254
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.9219322204589844
Epoch: 35, Steps: 10 | Train Loss: 0.051 Vali Loss: 4.065 Vali Acc: 0.254 Test Loss: 4.065 Test Acc: 0.254
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.9156429767608643
Epoch: 36, Steps: 10 | Train Loss: 0.055 Vali Loss: 4.088 Vali Acc: 0.254 Test Loss: 4.088 Test Acc: 0.254
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.8747906684875488
Epoch: 37, Steps: 10 | Train Loss: 0.046 Vali Loss: 4.141 Vali Acc: 0.254 Test Loss: 4.141 Test Acc: 0.254
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.8658881187438965
Epoch: 38, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.182 Vali Acc: 0.254 Test Loss: 4.182 Test Acc: 0.254
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.8758344650268555
Epoch: 39, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.214 Vali Acc: 0.254 Test Loss: 4.214 Test Acc: 0.254
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.782386064529419
Epoch: 40, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.257 Vali Acc: 0.254 Test Loss: 4.257 Test Acc: 0.254
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.9298350811004639
Epoch: 41, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.283 Vali Acc: 0.255 Test Loss: 4.283 Test Acc: 0.255
Validation loss decreased (-0.254078 --> -0.255251).  Saving model ...
Epoch: 42 cost time: 0.8956265449523926
Epoch: 42, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.314 Vali Acc: 0.253 Test Loss: 4.314 Test Acc: 0.253
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.863013744354248
Epoch: 43, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.330 Vali Acc: 0.254 Test Loss: 4.330 Test Acc: 0.254
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.9341752529144287
Epoch: 44, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.343 Vali Acc: 0.249 Test Loss: 4.343 Test Acc: 0.249
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.903519868850708
Epoch: 45, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.371 Vali Acc: 0.256 Test Loss: 4.371 Test Acc: 0.256
Validation loss decreased (-0.255251 --> -0.256427).  Saving model ...
Epoch: 46 cost time: 0.8803009986877441
Epoch: 46, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.394 Vali Acc: 0.260 Test Loss: 4.394 Test Acc: 0.260
Validation loss decreased (-0.256427 --> -0.259956).  Saving model ...
Epoch: 47 cost time: 0.834017276763916
Epoch: 47, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.411 Vali Acc: 0.259 Test Loss: 4.411 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.8841292858123779
Epoch: 48, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.453 Vali Acc: 0.259 Test Loss: 4.453 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.8727114200592041
Epoch: 49, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.468 Vali Acc: 0.261 Test Loss: 4.468 Test Acc: 0.261
Validation loss decreased (-0.259956 --> -0.261132).  Saving model ...
Epoch: 50 cost time: 0.8683831691741943
Epoch: 50, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.482 Vali Acc: 0.262 Test Loss: 4.482 Test Acc: 0.262
Validation loss decreased (-0.261132 --> -0.262308).  Saving model ...
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps38_str19_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26235294117647057
model parameter : 198618
model size : 0.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.9329006671905518
Epoch: 1, Steps: 10 | Train Loss: 3.291 Vali Loss: 3.268 Vali Acc: 0.058 Test Loss: 3.268 Test Acc: 0.058
Validation loss decreased (inf --> -0.057614).  Saving model ...
Epoch: 2 cost time: 0.7710232734680176
Epoch: 2, Steps: 10 | Train Loss: 3.149 Vali Loss: 3.267 Vali Acc: 0.067 Test Loss: 3.267 Test Acc: 0.067
Validation loss decreased (-0.057614 --> -0.067026).  Saving model ...
Epoch: 3 cost time: 0.8352787494659424
Epoch: 3, Steps: 10 | Train Loss: 2.986 Vali Loss: 3.280 Vali Acc: 0.086 Test Loss: 3.280 Test Acc: 0.086
Validation loss decreased (-0.067026 --> -0.085850).  Saving model ...
Epoch: 4 cost time: 0.7892630100250244
Epoch: 4, Steps: 10 | Train Loss: 2.754 Vali Loss: 3.275 Vali Acc: 0.094 Test Loss: 3.275 Test Acc: 0.094
Validation loss decreased (-0.085850 --> -0.094085).  Saving model ...
Epoch: 5 cost time: 0.8018364906311035
Epoch: 5, Steps: 10 | Train Loss: 2.461 Vali Loss: 3.226 Vali Acc: 0.135 Test Loss: 3.226 Test Acc: 0.135
Validation loss decreased (-0.094085 --> -0.135262).  Saving model ...
Epoch: 6 cost time: 0.7636845111846924
Epoch: 6, Steps: 10 | Train Loss: 2.162 Vali Loss: 3.176 Vali Acc: 0.162 Test Loss: 3.176 Test Acc: 0.162
Validation loss decreased (-0.135262 --> -0.162321).  Saving model ...
Epoch: 7 cost time: 0.7873659133911133
Epoch: 7, Steps: 10 | Train Loss: 1.840 Vali Loss: 3.166 Vali Acc: 0.169 Test Loss: 3.166 Test Acc: 0.169
Validation loss decreased (-0.162321 --> -0.169380).  Saving model ...
Epoch: 8 cost time: 0.7551913261413574
Epoch: 8, Steps: 10 | Train Loss: 1.436 Vali Loss: 3.171 Vali Acc: 0.192 Test Loss: 3.171 Test Acc: 0.192
Validation loss decreased (-0.169380 --> -0.191733).  Saving model ...
Epoch: 9 cost time: 0.748892068862915
Epoch: 9, Steps: 10 | Train Loss: 1.101 Vali Loss: 3.244 Vali Acc: 0.212 Test Loss: 3.244 Test Acc: 0.212
Validation loss decreased (-0.191733 --> -0.211732).  Saving model ...
Epoch: 10 cost time: 0.7190475463867188
Epoch: 10, Steps: 10 | Train Loss: 0.753 Vali Loss: 3.326 Vali Acc: 0.224 Test Loss: 3.326 Test Acc: 0.224
Validation loss decreased (-0.211732 --> -0.223496).  Saving model ...
Epoch: 11 cost time: 0.694744348526001
Epoch: 11, Steps: 10 | Train Loss: 0.479 Vali Loss: 3.479 Vali Acc: 0.234 Test Loss: 3.479 Test Acc: 0.234
Validation loss decreased (-0.223496 --> -0.234083).  Saving model ...
Epoch: 12 cost time: 0.6823265552520752
Epoch: 12, Steps: 10 | Train Loss: 0.311 Vali Loss: 3.649 Vali Acc: 0.242 Test Loss: 3.649 Test Acc: 0.242
Validation loss decreased (-0.234083 --> -0.242316).  Saving model ...
Epoch: 13 cost time: 0.8153436183929443
Epoch: 13, Steps: 10 | Train Loss: 0.156 Vali Loss: 3.774 Vali Acc: 0.264 Test Loss: 3.774 Test Acc: 0.264
Validation loss decreased (-0.242316 --> -0.263492).  Saving model ...
Epoch: 14 cost time: 0.782599925994873
Epoch: 14, Steps: 10 | Train Loss: 0.097 Vali Loss: 3.973 Vali Acc: 0.259 Test Loss: 3.973 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.785059928894043
Epoch: 15, Steps: 10 | Train Loss: 0.051 Vali Loss: 4.111 Vali Acc: 0.252 Test Loss: 4.111 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7373929023742676
Epoch: 16, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.156 Vali Acc: 0.269 Test Loss: 4.156 Test Acc: 0.269
Validation loss decreased (-0.263492 --> -0.269370).  Saving model ...
Epoch: 17 cost time: 0.7159361839294434
Epoch: 17, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.193 Vali Acc: 0.278 Test Loss: 4.193 Test Acc: 0.278
Validation loss decreased (-0.269370 --> -0.277605).  Saving model ...
Epoch: 18 cost time: 0.7758078575134277
Epoch: 18, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.263 Vali Acc: 0.284 Test Loss: 4.263 Test Acc: 0.284
Validation loss decreased (-0.277605 --> -0.283487).  Saving model ...
Epoch: 19 cost time: 0.7989089488983154
Epoch: 19, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.338 Vali Acc: 0.285 Test Loss: 4.338 Test Acc: 0.285
Validation loss decreased (-0.283487 --> -0.284663).  Saving model ...
Epoch: 20 cost time: 0.8225541114807129
Epoch: 20, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.415 Vali Acc: 0.276 Test Loss: 4.415 Test Acc: 0.276
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7748725414276123
Epoch: 21, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.471 Vali Acc: 0.274 Test Loss: 4.471 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7681536674499512
Epoch: 22, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.505 Vali Acc: 0.274 Test Loss: 4.505 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.7811417579650879
Epoch: 23, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.529 Vali Acc: 0.275 Test Loss: 4.529 Test Acc: 0.275
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.8070707321166992
Epoch: 24, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.559 Vali Acc: 0.280 Test Loss: 4.559 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.8118395805358887
Epoch: 25, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.610 Vali Acc: 0.280 Test Loss: 4.610 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.754683256149292
Epoch: 26, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.654 Vali Acc: 0.276 Test Loss: 4.654 Test Acc: 0.276
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.7626852989196777
Epoch: 27, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.678 Vali Acc: 0.278 Test Loss: 4.678 Test Acc: 0.278
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.7520463466644287
Epoch: 28, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.709 Vali Acc: 0.280 Test Loss: 4.709 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.7932047843933105
Epoch: 29, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.725 Vali Acc: 0.280 Test Loss: 4.725 Test Acc: 0.280
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2847058823529412
model parameter : 233146
model size : 0.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.1048221588134766
Epoch: 1, Steps: 10 | Train Loss: 3.306 Vali Loss: 3.288 Vali Acc: 0.039 Test Loss: 3.288 Test Acc: 0.039
Validation loss decreased (inf --> -0.038791).  Saving model ...
Epoch: 2 cost time: 0.769573450088501
Epoch: 2, Steps: 10 | Train Loss: 3.209 Vali Loss: 3.284 Vali Acc: 0.033 Test Loss: 3.284 Test Acc: 0.033
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7055432796478271
Epoch: 3, Steps: 10 | Train Loss: 3.076 Vali Loss: 3.285 Vali Acc: 0.048 Test Loss: 3.285 Test Acc: 0.048
Validation loss decreased (-0.038791 --> -0.048202).  Saving model ...
Epoch: 4 cost time: 0.7450063228607178
Epoch: 4, Steps: 10 | Train Loss: 2.956 Vali Loss: 3.289 Vali Acc: 0.062 Test Loss: 3.289 Test Acc: 0.062
Validation loss decreased (-0.048202 --> -0.062320).  Saving model ...
Epoch: 5 cost time: 0.747175931930542
Epoch: 5, Steps: 10 | Train Loss: 2.823 Vali Loss: 3.286 Vali Acc: 0.089 Test Loss: 3.286 Test Acc: 0.089
Validation loss decreased (-0.062320 --> -0.089379).  Saving model ...
Epoch: 6 cost time: 0.7354729175567627
Epoch: 6, Steps: 10 | Train Loss: 2.659 Vali Loss: 3.269 Vali Acc: 0.116 Test Loss: 3.269 Test Acc: 0.116
Validation loss decreased (-0.089379 --> -0.116438).  Saving model ...
Epoch: 7 cost time: 0.7806720733642578
Epoch: 7, Steps: 10 | Train Loss: 2.464 Vali Loss: 3.247 Vali Acc: 0.118 Test Loss: 3.247 Test Acc: 0.118
Validation loss decreased (-0.116438 --> -0.117615).  Saving model ...
Epoch: 8 cost time: 0.7959840297698975
Epoch: 8, Steps: 10 | Train Loss: 2.255 Vali Loss: 3.228 Vali Acc: 0.131 Test Loss: 3.228 Test Acc: 0.131
Validation loss decreased (-0.117615 --> -0.130556).  Saving model ...
Epoch: 9 cost time: 0.755300760269165
Epoch: 9, Steps: 10 | Train Loss: 1.988 Vali Loss: 3.213 Vali Acc: 0.145 Test Loss: 3.213 Test Acc: 0.145
Validation loss decreased (-0.130556 --> -0.144674).  Saving model ...
Epoch: 10 cost time: 0.7356250286102295
Epoch: 10, Steps: 10 | Train Loss: 1.720 Vali Loss: 3.210 Vali Acc: 0.164 Test Loss: 3.210 Test Acc: 0.164
Validation loss decreased (-0.144674 --> -0.163497).  Saving model ...
Epoch: 11 cost time: 0.7053577899932861
Epoch: 11, Steps: 10 | Train Loss: 1.451 Vali Loss: 3.228 Vali Acc: 0.185 Test Loss: 3.228 Test Acc: 0.185
Validation loss decreased (-0.163497 --> -0.184674).  Saving model ...
Epoch: 12 cost time: 0.7287962436676025
Epoch: 12, Steps: 10 | Train Loss: 1.187 Vali Loss: 3.267 Vali Acc: 0.206 Test Loss: 3.267 Test Acc: 0.206
Validation loss decreased (-0.184674 --> -0.205850).  Saving model ...
Epoch: 13 cost time: 0.7638614177703857
Epoch: 13, Steps: 10 | Train Loss: 0.911 Vali Loss: 3.323 Vali Acc: 0.227 Test Loss: 3.323 Test Acc: 0.227
Validation loss decreased (-0.205850 --> -0.227026).  Saving model ...
Epoch: 14 cost time: 0.7930028438568115
Epoch: 14, Steps: 10 | Train Loss: 0.746 Vali Loss: 3.400 Vali Acc: 0.228 Test Loss: 3.400 Test Acc: 0.228
Validation loss decreased (-0.227026 --> -0.228201).  Saving model ...
Epoch: 15 cost time: 0.7612531185150146
Epoch: 15, Steps: 10 | Train Loss: 0.520 Vali Loss: 3.477 Vali Acc: 0.241 Test Loss: 3.477 Test Acc: 0.241
Validation loss decreased (-0.228201 --> -0.241142).  Saving model ...
Epoch: 16 cost time: 0.7187950611114502
Epoch: 16, Steps: 10 | Train Loss: 0.373 Vali Loss: 3.586 Vali Acc: 0.247 Test Loss: 3.586 Test Acc: 0.247
Validation loss decreased (-0.241142 --> -0.247023).  Saving model ...
Epoch: 17 cost time: 0.7449648380279541
Epoch: 17, Steps: 10 | Train Loss: 0.268 Vali Loss: 3.719 Vali Acc: 0.261 Test Loss: 3.719 Test Acc: 0.261
Validation loss decreased (-0.247023 --> -0.261139).  Saving model ...
Epoch: 18 cost time: 0.7090058326721191
Epoch: 18, Steps: 10 | Train Loss: 0.187 Vali Loss: 3.862 Vali Acc: 0.254 Test Loss: 3.862 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7395179271697998
Epoch: 19, Steps: 10 | Train Loss: 0.130 Vali Loss: 3.934 Vali Acc: 0.264 Test Loss: 3.934 Test Acc: 0.264
Validation loss decreased (-0.261139 --> -0.263490).  Saving model ...
Epoch: 20 cost time: 0.7887561321258545
Epoch: 20, Steps: 10 | Train Loss: 0.105 Vali Loss: 4.041 Vali Acc: 0.259 Test Loss: 4.041 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7658324241638184
Epoch: 21, Steps: 10 | Train Loss: 0.071 Vali Loss: 4.120 Vali Acc: 0.259 Test Loss: 4.120 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.730278491973877
Epoch: 22, Steps: 10 | Train Loss: 0.056 Vali Loss: 4.177 Vali Acc: 0.264 Test Loss: 4.177 Test Acc: 0.264
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.7366623878479004
Epoch: 23, Steps: 10 | Train Loss: 0.045 Vali Loss: 4.236 Vali Acc: 0.264 Test Loss: 4.236 Test Acc: 0.264
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.756373405456543
Epoch: 24, Steps: 10 | Train Loss: 0.039 Vali Loss: 4.323 Vali Acc: 0.266 Test Loss: 4.323 Test Acc: 0.266
Validation loss decreased (-0.263490 --> -0.265839).  Saving model ...
Epoch: 25 cost time: 0.7816591262817383
Epoch: 25, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.375 Vali Acc: 0.265 Test Loss: 4.375 Test Acc: 0.265
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7824504375457764
Epoch: 26, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.416 Vali Acc: 0.266 Test Loss: 4.416 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.7207069396972656
Epoch: 27, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.482 Vali Acc: 0.261 Test Loss: 4.482 Test Acc: 0.261
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.7356913089752197
Epoch: 28, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.501 Vali Acc: 0.267 Test Loss: 4.501 Test Acc: 0.267
Validation loss decreased (-0.265839 --> -0.267014).  Saving model ...
Epoch: 29 cost time: 0.7622420787811279
Epoch: 29, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.526 Vali Acc: 0.272 Test Loss: 4.526 Test Acc: 0.272
Validation loss decreased (-0.267014 --> -0.271719).  Saving model ...
Epoch: 30 cost time: 0.7643940448760986
Epoch: 30, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.554 Vali Acc: 0.272 Test Loss: 4.554 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8144910335540771
Epoch: 31, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.582 Vali Acc: 0.273 Test Loss: 4.582 Test Acc: 0.273
Validation loss decreased (-0.271719 --> -0.272895).  Saving model ...
Epoch: 32 cost time: 0.7306005954742432
Epoch: 32, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.622 Vali Acc: 0.274 Test Loss: 4.622 Test Acc: 0.274
Validation loss decreased (-0.272895 --> -0.274071).  Saving model ...
Epoch: 33 cost time: 0.824195384979248
Epoch: 33, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.667 Vali Acc: 0.267 Test Loss: 4.667 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.7323815822601318
Epoch: 34, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.702 Vali Acc: 0.267 Test Loss: 4.702 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.801659345626831
Epoch: 35, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.727 Vali Acc: 0.273 Test Loss: 4.727 Test Acc: 0.273
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.7399876117706299
Epoch: 36, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.751 Vali Acc: 0.276 Test Loss: 4.751 Test Acc: 0.276
Validation loss decreased (-0.274071 --> -0.276423).  Saving model ...
Epoch: 37 cost time: 0.7864000797271729
Epoch: 37, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.779 Vali Acc: 0.280 Test Loss: 4.779 Test Acc: 0.280
Validation loss decreased (-0.276423 --> -0.279952).  Saving model ...
Epoch: 38 cost time: 0.7395038604736328
Epoch: 38, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.809 Vali Acc: 0.276 Test Loss: 4.809 Test Acc: 0.276
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.7695531845092773
Epoch: 39, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.841 Vali Acc: 0.278 Test Loss: 4.841 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.7718625068664551
Epoch: 40, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.869 Vali Acc: 0.276 Test Loss: 4.869 Test Acc: 0.276
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.8085470199584961
Epoch: 41, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.899 Vali Acc: 0.275 Test Loss: 4.899 Test Acc: 0.275
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.8126533031463623
Epoch: 42, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.919 Vali Acc: 0.272 Test Loss: 4.919 Test Acc: 0.272
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.7430305480957031
Epoch: 43, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.940 Vali Acc: 0.274 Test Loss: 4.940 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.776618242263794
Epoch: 44, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.966 Vali Acc: 0.275 Test Loss: 4.966 Test Acc: 0.275
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.7900004386901855
Epoch: 45, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.991 Vali Acc: 0.276 Test Loss: 4.991 Test Acc: 0.276
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.8070943355560303
Epoch: 46, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.016 Vali Acc: 0.276 Test Loss: 5.016 Test Acc: 0.276
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.7504322528839111
Epoch: 47, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.038 Vali Acc: 0.278 Test Loss: 5.038 Test Acc: 0.278
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.28
model parameter : 138426
model size : 0.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps12_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.098191499710083
Epoch: 1, Steps: 10 | Train Loss: 3.273 Vali Loss: 3.280 Vali Acc: 0.042 Test Loss: 3.280 Test Acc: 0.042
Validation loss decreased (inf --> -0.042320).  Saving model ...
Epoch: 2 cost time: 0.7818934917449951
Epoch: 2, Steps: 10 | Train Loss: 3.218 Vali Loss: 3.273 Vali Acc: 0.056 Test Loss: 3.273 Test Acc: 0.056
Validation loss decreased (-0.042320 --> -0.056438).  Saving model ...
Epoch: 3 cost time: 0.8011989593505859
Epoch: 3, Steps: 10 | Train Loss: 3.107 Vali Loss: 3.268 Vali Acc: 0.069 Test Loss: 3.268 Test Acc: 0.069
Validation loss decreased (-0.056438 --> -0.069379).  Saving model ...
Epoch: 4 cost time: 0.8075079917907715
Epoch: 4, Steps: 10 | Train Loss: 3.009 Vali Loss: 3.269 Vali Acc: 0.075 Test Loss: 3.269 Test Acc: 0.075
Validation loss decreased (-0.069379 --> -0.075261).  Saving model ...
Epoch: 5 cost time: 0.7416119575500488
Epoch: 5, Steps: 10 | Train Loss: 2.916 Vali Loss: 3.268 Vali Acc: 0.082 Test Loss: 3.268 Test Acc: 0.082
Validation loss decreased (-0.075261 --> -0.082320).  Saving model ...
Epoch: 6 cost time: 0.7064158916473389
Epoch: 6, Steps: 10 | Train Loss: 2.788 Vali Loss: 3.265 Vali Acc: 0.093 Test Loss: 3.265 Test Acc: 0.093
Validation loss decreased (-0.082320 --> -0.092909).  Saving model ...
Epoch: 7 cost time: 0.7273604869842529
Epoch: 7, Steps: 10 | Train Loss: 2.658 Vali Loss: 3.253 Vali Acc: 0.101 Test Loss: 3.253 Test Acc: 0.101
Validation loss decreased (-0.092909 --> -0.101144).  Saving model ...
Epoch: 8 cost time: 0.7720420360565186
Epoch: 8, Steps: 10 | Train Loss: 2.495 Vali Loss: 3.235 Vali Acc: 0.107 Test Loss: 3.235 Test Acc: 0.107
Validation loss decreased (-0.101144 --> -0.107026).  Saving model ...
Epoch: 9 cost time: 0.7840499877929688
Epoch: 9, Steps: 10 | Train Loss: 2.337 Vali Loss: 3.212 Vali Acc: 0.124 Test Loss: 3.212 Test Acc: 0.124
Validation loss decreased (-0.107026 --> -0.123497).  Saving model ...
Epoch: 10 cost time: 0.7692663669586182
Epoch: 10, Steps: 10 | Train Loss: 2.144 Vali Loss: 3.205 Vali Acc: 0.136 Test Loss: 3.205 Test Acc: 0.136
Validation loss decreased (-0.123497 --> -0.136439).  Saving model ...
Epoch: 11 cost time: 0.7313511371612549
Epoch: 11, Steps: 10 | Train Loss: 1.942 Vali Loss: 3.198 Vali Acc: 0.149 Test Loss: 3.198 Test Acc: 0.149
Validation loss decreased (-0.136439 --> -0.149380).  Saving model ...
Epoch: 12 cost time: 0.7035629749298096
Epoch: 12, Steps: 10 | Train Loss: 1.703 Vali Loss: 3.192 Vali Acc: 0.161 Test Loss: 3.192 Test Acc: 0.161
Validation loss decreased (-0.149380 --> -0.161145).  Saving model ...
Epoch: 13 cost time: 0.715339183807373
Epoch: 13, Steps: 10 | Train Loss: 1.489 Vali Loss: 3.217 Vali Acc: 0.167 Test Loss: 3.217 Test Acc: 0.167
Validation loss decreased (-0.161145 --> -0.167027).  Saving model ...
Epoch: 14 cost time: 0.7728700637817383
Epoch: 14, Steps: 10 | Train Loss: 1.267 Vali Loss: 3.239 Vali Acc: 0.179 Test Loss: 3.239 Test Acc: 0.179
Validation loss decreased (-0.167027 --> -0.178791).  Saving model ...
Epoch: 15 cost time: 0.7428834438323975
Epoch: 15, Steps: 10 | Train Loss: 1.068 Vali Loss: 3.266 Vali Acc: 0.196 Test Loss: 3.266 Test Acc: 0.196
Validation loss decreased (-0.178791 --> -0.196438).  Saving model ...
Epoch: 16 cost time: 0.7635905742645264
Epoch: 16, Steps: 10 | Train Loss: 0.859 Vali Loss: 3.305 Vali Acc: 0.208 Test Loss: 3.305 Test Acc: 0.208
Validation loss decreased (-0.196438 --> -0.208202).  Saving model ...
Epoch: 17 cost time: 0.7148528099060059
Epoch: 17, Steps: 10 | Train Loss: 0.669 Vali Loss: 3.379 Vali Acc: 0.219 Test Loss: 3.379 Test Acc: 0.219
Validation loss decreased (-0.208202 --> -0.218790).  Saving model ...
Epoch: 18 cost time: 0.7365758419036865
Epoch: 18, Steps: 10 | Train Loss: 0.525 Vali Loss: 3.457 Vali Acc: 0.221 Test Loss: 3.457 Test Acc: 0.221
Validation loss decreased (-0.218790 --> -0.221142).  Saving model ...
Epoch: 19 cost time: 0.7755296230316162
Epoch: 19, Steps: 10 | Train Loss: 0.399 Vali Loss: 3.534 Vali Acc: 0.232 Test Loss: 3.534 Test Acc: 0.232
Validation loss decreased (-0.221142 --> -0.231729).  Saving model ...
Epoch: 20 cost time: 0.7390420436859131
Epoch: 20, Steps: 10 | Train Loss: 0.320 Vali Loss: 3.628 Vali Acc: 0.245 Test Loss: 3.628 Test Acc: 0.245
Validation loss decreased (-0.231729 --> -0.244670).  Saving model ...
Epoch: 21 cost time: 0.6854813098907471
Epoch: 21, Steps: 10 | Train Loss: 0.229 Vali Loss: 3.723 Vali Acc: 0.246 Test Loss: 3.723 Test Acc: 0.246
Validation loss decreased (-0.244670 --> -0.245845).  Saving model ...
Epoch: 22 cost time: 0.6465287208557129
Epoch: 22, Steps: 10 | Train Loss: 0.178 Vali Loss: 3.795 Vali Acc: 0.245 Test Loss: 3.795 Test Acc: 0.245
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7329797744750977
Epoch: 23, Steps: 10 | Train Loss: 0.142 Vali Loss: 3.880 Vali Acc: 0.234 Test Loss: 3.880 Test Acc: 0.234
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.7337212562561035
Epoch: 24, Steps: 10 | Train Loss: 0.107 Vali Loss: 3.960 Vali Acc: 0.240 Test Loss: 3.960 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.8022990226745605
Epoch: 25, Steps: 10 | Train Loss: 0.088 Vali Loss: 4.010 Vali Acc: 0.241 Test Loss: 4.010 Test Acc: 0.241
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.8020944595336914
Epoch: 26, Steps: 10 | Train Loss: 0.077 Vali Loss: 4.064 Vali Acc: 0.244 Test Loss: 4.064 Test Acc: 0.244
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.7165813446044922
Epoch: 27, Steps: 10 | Train Loss: 0.065 Vali Loss: 4.127 Vali Acc: 0.244 Test Loss: 4.127 Test Acc: 0.244
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.7247343063354492
Epoch: 28, Steps: 10 | Train Loss: 0.051 Vali Loss: 4.174 Vali Acc: 0.245 Test Loss: 4.174 Test Acc: 0.245
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.7710599899291992
Epoch: 29, Steps: 10 | Train Loss: 0.050 Vali Loss: 4.207 Vali Acc: 0.242 Test Loss: 4.207 Test Acc: 0.242
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.7011833190917969
Epoch: 30, Steps: 10 | Train Loss: 0.039 Vali Loss: 4.247 Vali Acc: 0.236 Test Loss: 4.247 Test Acc: 0.236
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.7520556449890137
Epoch: 31, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.287 Vali Acc: 0.239 Test Loss: 4.287 Test Acc: 0.239
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps12_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.24588235294117647
model parameter : 108602
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.277111291885376
Epoch: 1, Steps: 10 | Train Loss: 3.296 Vali Loss: 3.270 Vali Acc: 0.054 Test Loss: 3.270 Test Acc: 0.054
Validation loss decreased (inf --> -0.054085).  Saving model ...
Epoch: 2 cost time: 0.7804937362670898
Epoch: 2, Steps: 10 | Train Loss: 3.248 Vali Loss: 3.267 Vali Acc: 0.053 Test Loss: 3.267 Test Acc: 0.053
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7237935066223145
Epoch: 3, Steps: 10 | Train Loss: 3.183 Vali Loss: 3.262 Vali Acc: 0.060 Test Loss: 3.262 Test Acc: 0.060
Validation loss decreased (-0.054085 --> -0.059967).  Saving model ...
Epoch: 4 cost time: 0.7749145030975342
Epoch: 4, Steps: 10 | Train Loss: 3.095 Vali Loss: 3.261 Vali Acc: 0.067 Test Loss: 3.261 Test Acc: 0.067
Validation loss decreased (-0.059967 --> -0.067026).  Saving model ...
Epoch: 5 cost time: 0.7385225296020508
Epoch: 5, Steps: 10 | Train Loss: 3.008 Vali Loss: 3.260 Vali Acc: 0.080 Test Loss: 3.260 Test Acc: 0.080
Validation loss decreased (-0.067026 --> -0.079967).  Saving model ...
Epoch: 6 cost time: 0.7217915058135986
Epoch: 6, Steps: 10 | Train Loss: 2.896 Vali Loss: 3.257 Vali Acc: 0.079 Test Loss: 3.257 Test Acc: 0.079
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7466006278991699
Epoch: 7, Steps: 10 | Train Loss: 2.806 Vali Loss: 3.259 Vali Acc: 0.095 Test Loss: 3.259 Test Acc: 0.095
Validation loss decreased (-0.079967 --> -0.095262).  Saving model ...
Epoch: 8 cost time: 0.8131430149078369
Epoch: 8, Steps: 10 | Train Loss: 2.696 Vali Loss: 3.250 Vali Acc: 0.099 Test Loss: 3.250 Test Acc: 0.099
Validation loss decreased (-0.095262 --> -0.098791).  Saving model ...
Epoch: 9 cost time: 0.7343556880950928
Epoch: 9, Steps: 10 | Train Loss: 2.578 Vali Loss: 3.237 Vali Acc: 0.108 Test Loss: 3.237 Test Acc: 0.108
Validation loss decreased (-0.098791 --> -0.108203).  Saving model ...
Epoch: 10 cost time: 0.7045440673828125
Epoch: 10, Steps: 10 | Train Loss: 2.425 Vali Loss: 3.225 Vali Acc: 0.113 Test Loss: 3.225 Test Acc: 0.113
Validation loss decreased (-0.108203 --> -0.112909).  Saving model ...
Epoch: 11 cost time: 0.7488658428192139
Epoch: 11, Steps: 10 | Train Loss: 2.234 Vali Loss: 3.205 Vali Acc: 0.136 Test Loss: 3.205 Test Acc: 0.136
Validation loss decreased (-0.112909 --> -0.136439).  Saving model ...
Epoch: 12 cost time: 0.7404892444610596
Epoch: 12, Steps: 10 | Train Loss: 2.078 Vali Loss: 3.187 Vali Acc: 0.144 Test Loss: 3.187 Test Acc: 0.144
Validation loss decreased (-0.136439 --> -0.143498).  Saving model ...
Epoch: 13 cost time: 0.7782785892486572
Epoch: 13, Steps: 10 | Train Loss: 1.884 Vali Loss: 3.178 Vali Acc: 0.161 Test Loss: 3.178 Test Acc: 0.161
Validation loss decreased (-0.143498 --> -0.161145).  Saving model ...
Epoch: 14 cost time: 0.8048422336578369
Epoch: 14, Steps: 10 | Train Loss: 1.713 Vali Loss: 3.175 Vali Acc: 0.180 Test Loss: 3.175 Test Acc: 0.180
Validation loss decreased (-0.161145 --> -0.179968).  Saving model ...
Epoch: 15 cost time: 0.7079195976257324
Epoch: 15, Steps: 10 | Train Loss: 1.519 Vali Loss: 3.171 Vali Acc: 0.192 Test Loss: 3.171 Test Acc: 0.192
Validation loss decreased (-0.179968 --> -0.191733).  Saving model ...
Epoch: 16 cost time: 0.7905838489532471
Epoch: 16, Steps: 10 | Train Loss: 1.290 Vali Loss: 3.187 Vali Acc: 0.196 Test Loss: 3.187 Test Acc: 0.196
Validation loss decreased (-0.191733 --> -0.196439).  Saving model ...
Epoch: 17 cost time: 0.7425217628479004
Epoch: 17, Steps: 10 | Train Loss: 1.089 Vali Loss: 3.199 Vali Acc: 0.205 Test Loss: 3.199 Test Acc: 0.205
Validation loss decreased (-0.196439 --> -0.204674).  Saving model ...
Epoch: 18 cost time: 0.7649483680725098
Epoch: 18, Steps: 10 | Train Loss: 0.921 Vali Loss: 3.235 Vali Acc: 0.209 Test Loss: 3.235 Test Acc: 0.209
Validation loss decreased (-0.204674 --> -0.209379).  Saving model ...
Epoch: 19 cost time: 0.7654402256011963
Epoch: 19, Steps: 10 | Train Loss: 0.742 Vali Loss: 3.274 Vali Acc: 0.224 Test Loss: 3.274 Test Acc: 0.224
Validation loss decreased (-0.209379 --> -0.223497).  Saving model ...
Epoch: 20 cost time: 0.7890262603759766
Epoch: 20, Steps: 10 | Train Loss: 0.617 Vali Loss: 3.337 Vali Acc: 0.226 Test Loss: 3.337 Test Acc: 0.226
Validation loss decreased (-0.223497 --> -0.225849).  Saving model ...
Epoch: 21 cost time: 0.7301013469696045
Epoch: 21, Steps: 10 | Train Loss: 0.484 Vali Loss: 3.384 Vali Acc: 0.232 Test Loss: 3.384 Test Acc: 0.232
Validation loss decreased (-0.225849 --> -0.231731).  Saving model ...
Epoch: 22 cost time: 0.7054061889648438
Epoch: 22, Steps: 10 | Train Loss: 0.393 Vali Loss: 3.435 Vali Acc: 0.241 Test Loss: 3.435 Test Acc: 0.241
Validation loss decreased (-0.231731 --> -0.241142).  Saving model ...
Epoch: 23 cost time: 0.6783974170684814
Epoch: 23, Steps: 10 | Train Loss: 0.298 Vali Loss: 3.511 Vali Acc: 0.248 Test Loss: 3.511 Test Acc: 0.248
Validation loss decreased (-0.241142 --> -0.248200).  Saving model ...
Epoch: 24 cost time: 0.7339627742767334
Epoch: 24, Steps: 10 | Train Loss: 0.253 Vali Loss: 3.589 Vali Acc: 0.245 Test Loss: 3.589 Test Acc: 0.245
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7277989387512207
Epoch: 25, Steps: 10 | Train Loss: 0.195 Vali Loss: 3.645 Vali Acc: 0.244 Test Loss: 3.645 Test Acc: 0.244
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.8078117370605469
Epoch: 26, Steps: 10 | Train Loss: 0.161 Vali Loss: 3.701 Vali Acc: 0.248 Test Loss: 3.701 Test Acc: 0.248
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.8705215454101562
Epoch: 27, Steps: 10 | Train Loss: 0.142 Vali Loss: 3.767 Vali Acc: 0.252 Test Loss: 3.767 Test Acc: 0.252
Validation loss decreased (-0.248200 --> -0.251727).  Saving model ...
Epoch: 28 cost time: 0.7246131896972656
Epoch: 28, Steps: 10 | Train Loss: 0.112 Vali Loss: 3.811 Vali Acc: 0.256 Test Loss: 3.811 Test Acc: 0.256
Validation loss decreased (-0.251727 --> -0.256432).  Saving model ...
Epoch: 29 cost time: 0.7444331645965576
Epoch: 29, Steps: 10 | Train Loss: 0.096 Vali Loss: 3.848 Vali Acc: 0.260 Test Loss: 3.848 Test Acc: 0.260
Validation loss decreased (-0.256432 --> -0.259962).  Saving model ...
Epoch: 30 cost time: 0.7850725650787354
Epoch: 30, Steps: 10 | Train Loss: 0.088 Vali Loss: 3.896 Vali Acc: 0.264 Test Loss: 3.896 Test Acc: 0.264
Validation loss decreased (-0.259962 --> -0.263490).  Saving model ...
Epoch: 31 cost time: 0.7848682403564453
Epoch: 31, Steps: 10 | Train Loss: 0.070 Vali Loss: 3.944 Vali Acc: 0.260 Test Loss: 3.944 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.8122217655181885
Epoch: 32, Steps: 10 | Train Loss: 0.062 Vali Loss: 3.979 Vali Acc: 0.260 Test Loss: 3.979 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.7726500034332275
Epoch: 33, Steps: 10 | Train Loss: 0.056 Vali Loss: 4.015 Vali Acc: 0.262 Test Loss: 4.015 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.7948286533355713
Epoch: 34, Steps: 10 | Train Loss: 0.050 Vali Loss: 4.054 Vali Acc: 0.262 Test Loss: 4.054 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.7514975070953369
Epoch: 35, Steps: 10 | Train Loss: 0.042 Vali Loss: 4.093 Vali Acc: 0.264 Test Loss: 4.093 Test Acc: 0.264
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.8395748138427734
Epoch: 36, Steps: 10 | Train Loss: 0.037 Vali Loss: 4.123 Vali Acc: 0.264 Test Loss: 4.123 Test Acc: 0.264
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.7684230804443359
Epoch: 37, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.155 Vali Acc: 0.264 Test Loss: 4.155 Test Acc: 0.264
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.7800643444061279
Epoch: 38, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.185 Vali Acc: 0.266 Test Loss: 4.185 Test Acc: 0.266
Validation loss decreased (-0.263490 --> -0.265841).  Saving model ...
Epoch: 39 cost time: 0.7465455532073975
Epoch: 39, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.208 Vali Acc: 0.264 Test Loss: 4.208 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.756176233291626
Epoch: 40, Steps: 10 | Train Loss: 0.025 Vali Loss: 4.224 Vali Acc: 0.262 Test Loss: 4.224 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.7987802028656006
Epoch: 41, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.259 Vali Acc: 0.262 Test Loss: 4.259 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.7571709156036377
Epoch: 42, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.279 Vali Acc: 0.267 Test Loss: 4.279 Test Acc: 0.267
Validation loss decreased (-0.265841 --> -0.267016).  Saving model ...
Epoch: 43 cost time: 0.7512202262878418
Epoch: 43, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.309 Vali Acc: 0.267 Test Loss: 4.309 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.7414283752441406
Epoch: 44, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.337 Vali Acc: 0.268 Test Loss: 4.337 Test Acc: 0.268
Validation loss decreased (-0.267016 --> -0.268192).  Saving model ...
Epoch: 45 cost time: 0.7114129066467285
Epoch: 45, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.369 Vali Acc: 0.266 Test Loss: 4.369 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.7276630401611328
Epoch: 46, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.389 Vali Acc: 0.266 Test Loss: 4.389 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.707611083984375
Epoch: 47, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.413 Vali Acc: 0.267 Test Loss: 4.413 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.8299760818481445
Epoch: 48, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.433 Vali Acc: 0.268 Test Loss: 4.433 Test Acc: 0.268
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.8171670436859131
Epoch: 49, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.459 Vali Acc: 0.269 Test Loss: 4.459 Test Acc: 0.269
Validation loss decreased (-0.268192 --> -0.269367).  Saving model ...
Epoch: 50 cost time: 0.7470781803131104
Epoch: 50, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.483 Vali Acc: 0.268 Test Loss: 4.483 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26941176470588235
model parameter : 93754
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps23_str12_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.962589979171753
Epoch: 1, Steps: 10 | Train Loss: 3.282 Vali Loss: 3.287 Vali Acc: 0.053 Test Loss: 3.287 Test Acc: 0.053
Validation loss decreased (inf --> -0.052908).  Saving model ...
Epoch: 2 cost time: 0.7992246150970459
Epoch: 2, Steps: 10 | Train Loss: 3.267 Vali Loss: 3.285 Vali Acc: 0.056 Test Loss: 3.285 Test Acc: 0.056
Validation loss decreased (-0.052908 --> -0.056438).  Saving model ...
Epoch: 3 cost time: 0.7815389633178711
Epoch: 3, Steps: 10 | Train Loss: 3.186 Vali Loss: 3.281 Vali Acc: 0.055 Test Loss: 3.281 Test Acc: 0.055
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6899406909942627
Epoch: 4, Steps: 10 | Train Loss: 3.148 Vali Loss: 3.276 Vali Acc: 0.064 Test Loss: 3.276 Test Acc: 0.064
Validation loss decreased (-0.056438 --> -0.063497).  Saving model ...
Epoch: 5 cost time: 0.7582967281341553
Epoch: 5, Steps: 10 | Train Loss: 3.057 Vali Loss: 3.272 Vali Acc: 0.069 Test Loss: 3.272 Test Acc: 0.069
Validation loss decreased (-0.063497 --> -0.069379).  Saving model ...
Epoch: 6 cost time: 0.7383100986480713
Epoch: 6, Steps: 10 | Train Loss: 2.990 Vali Loss: 3.268 Vali Acc: 0.079 Test Loss: 3.268 Test Acc: 0.079
Validation loss decreased (-0.069379 --> -0.078791).  Saving model ...
Epoch: 7 cost time: 0.7646749019622803
Epoch: 7, Steps: 10 | Train Loss: 2.914 Vali Loss: 3.264 Vali Acc: 0.094 Test Loss: 3.264 Test Acc: 0.094
Validation loss decreased (-0.078791 --> -0.094085).  Saving model ...
Epoch: 8 cost time: 0.732496976852417
Epoch: 8, Steps: 10 | Train Loss: 2.814 Vali Loss: 3.260 Vali Acc: 0.095 Test Loss: 3.260 Test Acc: 0.095
Validation loss decreased (-0.094085 --> -0.095262).  Saving model ...
Epoch: 9 cost time: 0.7942299842834473
Epoch: 9, Steps: 10 | Train Loss: 2.705 Vali Loss: 3.256 Vali Acc: 0.100 Test Loss: 3.256 Test Acc: 0.100
Validation loss decreased (-0.095262 --> -0.099967).  Saving model ...
Epoch: 10 cost time: 0.7194235324859619
Epoch: 10, Steps: 10 | Train Loss: 2.645 Vali Loss: 3.250 Vali Acc: 0.109 Test Loss: 3.250 Test Acc: 0.109
Validation loss decreased (-0.099967 --> -0.109379).  Saving model ...
Epoch: 11 cost time: 0.7109506130218506
Epoch: 11, Steps: 10 | Train Loss: 2.510 Vali Loss: 3.243 Vali Acc: 0.120 Test Loss: 3.243 Test Acc: 0.120
Validation loss decreased (-0.109379 --> -0.119968).  Saving model ...
Epoch: 12 cost time: 0.7368793487548828
Epoch: 12, Steps: 10 | Train Loss: 2.426 Vali Loss: 3.235 Vali Acc: 0.126 Test Loss: 3.235 Test Acc: 0.126
Validation loss decreased (-0.119968 --> -0.125850).  Saving model ...
Epoch: 13 cost time: 0.7776565551757812
Epoch: 13, Steps: 10 | Train Loss: 2.301 Vali Loss: 3.228 Vali Acc: 0.139 Test Loss: 3.228 Test Acc: 0.139
Validation loss decreased (-0.125850 --> -0.138791).  Saving model ...
Epoch: 14 cost time: 0.7735898494720459
Epoch: 14, Steps: 10 | Train Loss: 2.143 Vali Loss: 3.222 Vali Acc: 0.139 Test Loss: 3.222 Test Acc: 0.139
Validation loss decreased (-0.138791 --> -0.138791).  Saving model ...
Epoch: 15 cost time: 0.8061807155609131
Epoch: 15, Steps: 10 | Train Loss: 2.025 Vali Loss: 3.220 Vali Acc: 0.145 Test Loss: 3.220 Test Acc: 0.145
Validation loss decreased (-0.138791 --> -0.144674).  Saving model ...
Epoch: 16 cost time: 0.712958812713623
Epoch: 16, Steps: 10 | Train Loss: 1.870 Vali Loss: 3.214 Vali Acc: 0.159 Test Loss: 3.214 Test Acc: 0.159
Validation loss decreased (-0.144674 --> -0.158791).  Saving model ...
Epoch: 17 cost time: 0.7268271446228027
Epoch: 17, Steps: 10 | Train Loss: 1.733 Vali Loss: 3.218 Vali Acc: 0.168 Test Loss: 3.218 Test Acc: 0.168
Validation loss decreased (-0.158791 --> -0.168203).  Saving model ...
Epoch: 18 cost time: 0.7278604507446289
Epoch: 18, Steps: 10 | Train Loss: 1.574 Vali Loss: 3.223 Vali Acc: 0.184 Test Loss: 3.223 Test Acc: 0.184
Validation loss decreased (-0.168203 --> -0.183497).  Saving model ...
Epoch: 19 cost time: 0.7263402938842773
Epoch: 19, Steps: 10 | Train Loss: 1.419 Vali Loss: 3.236 Vali Acc: 0.192 Test Loss: 3.236 Test Acc: 0.192
Validation loss decreased (-0.183497 --> -0.191732).  Saving model ...
Epoch: 20 cost time: 0.7224512100219727
Epoch: 20, Steps: 10 | Train Loss: 1.313 Vali Loss: 3.255 Vali Acc: 0.199 Test Loss: 3.255 Test Acc: 0.199
Validation loss decreased (-0.191732 --> -0.198791).  Saving model ...
Epoch: 21 cost time: 0.8103475570678711
Epoch: 21, Steps: 10 | Train Loss: 1.148 Vali Loss: 3.275 Vali Acc: 0.205 Test Loss: 3.275 Test Acc: 0.205
Validation loss decreased (-0.198791 --> -0.204673).  Saving model ...
Epoch: 22 cost time: 0.8092713356018066
Epoch: 22, Steps: 10 | Train Loss: 1.002 Vali Loss: 3.299 Vali Acc: 0.213 Test Loss: 3.299 Test Acc: 0.213
Validation loss decreased (-0.204673 --> -0.212908).  Saving model ...
Epoch: 23 cost time: 0.7400434017181396
Epoch: 23, Steps: 10 | Train Loss: 0.883 Vali Loss: 3.330 Vali Acc: 0.219 Test Loss: 3.330 Test Acc: 0.219
Validation loss decreased (-0.212908 --> -0.218790).  Saving model ...
Epoch: 24 cost time: 0.7685942649841309
Epoch: 24, Steps: 10 | Train Loss: 0.756 Vali Loss: 3.379 Vali Acc: 0.232 Test Loss: 3.379 Test Acc: 0.232
Validation loss decreased (-0.218790 --> -0.231731).  Saving model ...
Epoch: 25 cost time: 0.7212197780609131
Epoch: 25, Steps: 10 | Train Loss: 0.657 Vali Loss: 3.428 Vali Acc: 0.231 Test Loss: 3.428 Test Acc: 0.231
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6857337951660156
Epoch: 26, Steps: 10 | Train Loss: 0.550 Vali Loss: 3.471 Vali Acc: 0.241 Test Loss: 3.471 Test Acc: 0.241
Validation loss decreased (-0.231731 --> -0.241142).  Saving model ...
Epoch: 27 cost time: 0.7088277339935303
Epoch: 27, Steps: 10 | Train Loss: 0.465 Vali Loss: 3.506 Vali Acc: 0.241 Test Loss: 3.506 Test Acc: 0.241
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7355070114135742
Epoch: 28, Steps: 10 | Train Loss: 0.398 Vali Loss: 3.557 Vali Acc: 0.247 Test Loss: 3.557 Test Acc: 0.247
Validation loss decreased (-0.241142 --> -0.247023).  Saving model ...
Epoch: 29 cost time: 0.7038500308990479
Epoch: 29, Steps: 10 | Train Loss: 0.336 Vali Loss: 3.608 Vali Acc: 0.247 Test Loss: 3.608 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.7680873870849609
Epoch: 30, Steps: 10 | Train Loss: 0.296 Vali Loss: 3.669 Vali Acc: 0.252 Test Loss: 3.669 Test Acc: 0.252
Validation loss decreased (-0.247023 --> -0.251728).  Saving model ...
Epoch: 31 cost time: 0.7393174171447754
Epoch: 31, Steps: 10 | Train Loss: 0.242 Vali Loss: 3.720 Vali Acc: 0.253 Test Loss: 3.720 Test Acc: 0.253
Validation loss decreased (-0.251728 --> -0.252904).  Saving model ...
Epoch: 32 cost time: 0.6831724643707275
Epoch: 32, Steps: 10 | Train Loss: 0.213 Vali Loss: 3.769 Vali Acc: 0.251 Test Loss: 3.769 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.7323391437530518
Epoch: 33, Steps: 10 | Train Loss: 0.181 Vali Loss: 3.809 Vali Acc: 0.251 Test Loss: 3.809 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.695824384689331
Epoch: 34, Steps: 10 | Train Loss: 0.154 Vali Loss: 3.855 Vali Acc: 0.248 Test Loss: 3.855 Test Acc: 0.248
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.6848678588867188
Epoch: 35, Steps: 10 | Train Loss: 0.130 Vali Loss: 3.912 Vali Acc: 0.255 Test Loss: 3.912 Test Acc: 0.255
Validation loss decreased (-0.252904 --> -0.255255).  Saving model ...
Epoch: 36 cost time: 0.7831108570098877
Epoch: 36, Steps: 10 | Train Loss: 0.115 Vali Loss: 3.955 Vali Acc: 0.252 Test Loss: 3.955 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.7377917766571045
Epoch: 37, Steps: 10 | Train Loss: 0.098 Vali Loss: 3.992 Vali Acc: 0.255 Test Loss: 3.992 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.7848167419433594
Epoch: 38, Steps: 10 | Train Loss: 0.098 Vali Loss: 4.012 Vali Acc: 0.254 Test Loss: 4.012 Test Acc: 0.254
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.6764786243438721
Epoch: 39, Steps: 10 | Train Loss: 0.084 Vali Loss: 4.028 Vali Acc: 0.255 Test Loss: 4.028 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.8088092803955078
Epoch: 40, Steps: 10 | Train Loss: 0.075 Vali Loss: 4.044 Vali Acc: 0.255 Test Loss: 4.044 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.7859971523284912
Epoch: 41, Steps: 10 | Train Loss: 0.068 Vali Loss: 4.082 Vali Acc: 0.256 Test Loss: 4.082 Test Acc: 0.256
Validation loss decreased (-0.255255 --> -0.256430).  Saving model ...
Epoch: 42 cost time: 0.6441950798034668
Epoch: 42, Steps: 10 | Train Loss: 0.059 Vali Loss: 4.119 Vali Acc: 0.255 Test Loss: 4.119 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.7630877494812012
Epoch: 43, Steps: 10 | Train Loss: 0.057 Vali Loss: 4.152 Vali Acc: 0.259 Test Loss: 4.152 Test Acc: 0.259
Validation loss decreased (-0.256430 --> -0.258782).  Saving model ...
Epoch: 44 cost time: 0.7376623153686523
Epoch: 44, Steps: 10 | Train Loss: 0.051 Vali Loss: 4.187 Vali Acc: 0.256 Test Loss: 4.187 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.6987240314483643
Epoch: 45, Steps: 10 | Train Loss: 0.045 Vali Loss: 4.218 Vali Acc: 0.260 Test Loss: 4.218 Test Acc: 0.260
Validation loss decreased (-0.258782 --> -0.259958).  Saving model ...
Epoch: 46 cost time: 0.7595174312591553
Epoch: 46, Steps: 10 | Train Loss: 0.042 Vali Loss: 4.251 Vali Acc: 0.260 Test Loss: 4.251 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.7787847518920898
Epoch: 47, Steps: 10 | Train Loss: 0.039 Vali Loss: 4.273 Vali Acc: 0.258 Test Loss: 4.273 Test Acc: 0.258
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.7563533782958984
Epoch: 48, Steps: 10 | Train Loss: 0.038 Vali Loss: 4.302 Vali Acc: 0.258 Test Loss: 4.302 Test Acc: 0.258
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.7444314956665039
Epoch: 49, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.323 Vali Acc: 0.255 Test Loss: 4.323 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.7301335334777832
Epoch: 50, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.355 Vali Acc: 0.256 Test Loss: 4.355 Test Acc: 0.256
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps23_str12_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26
model parameter : 74010
model size : 0.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.0286054611206055
Epoch: 1, Steps: 10 | Train Loss: 3.331 Vali Loss: 3.266 Vali Acc: 0.052 Test Loss: 3.266 Test Acc: 0.052
Validation loss decreased (inf --> -0.051732).  Saving model ...
Epoch: 2 cost time: 0.7666707038879395
Epoch: 2, Steps: 10 | Train Loss: 3.277 Vali Loss: 3.265 Vali Acc: 0.062 Test Loss: 3.265 Test Acc: 0.062
Validation loss decreased (-0.051732 --> -0.062320).  Saving model ...
Epoch: 3 cost time: 0.7424535751342773
Epoch: 3, Steps: 10 | Train Loss: 3.241 Vali Loss: 3.260 Vali Acc: 0.059 Test Loss: 3.260 Test Acc: 0.059
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7427046298980713
Epoch: 4, Steps: 10 | Train Loss: 3.195 Vali Loss: 3.254 Vali Acc: 0.060 Test Loss: 3.254 Test Acc: 0.060
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7459485530853271
Epoch: 5, Steps: 10 | Train Loss: 3.154 Vali Loss: 3.247 Vali Acc: 0.060 Test Loss: 3.247 Test Acc: 0.060
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.7880446910858154
Epoch: 6, Steps: 10 | Train Loss: 3.076 Vali Loss: 3.242 Vali Acc: 0.061 Test Loss: 3.242 Test Acc: 0.061
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.7713057994842529
Epoch: 7, Steps: 10 | Train Loss: 2.996 Vali Loss: 3.240 Vali Acc: 0.061 Test Loss: 3.240 Test Acc: 0.061
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.7450871467590332
Epoch: 8, Steps: 10 | Train Loss: 2.926 Vali Loss: 3.240 Vali Acc: 0.073 Test Loss: 3.240 Test Acc: 0.073
Validation loss decreased (-0.062320 --> -0.072909).  Saving model ...
Epoch: 9 cost time: 0.7555050849914551
Epoch: 9, Steps: 10 | Train Loss: 2.863 Vali Loss: 3.233 Vali Acc: 0.081 Test Loss: 3.233 Test Acc: 0.081
Validation loss decreased (-0.072909 --> -0.081144).  Saving model ...
Epoch: 10 cost time: 0.7203824520111084
Epoch: 10, Steps: 10 | Train Loss: 2.772 Vali Loss: 3.229 Vali Acc: 0.089 Test Loss: 3.229 Test Acc: 0.089
Validation loss decreased (-0.081144 --> -0.089379).  Saving model ...
Epoch: 11 cost time: 0.7002558708190918
Epoch: 11, Steps: 10 | Train Loss: 2.670 Vali Loss: 3.226 Vali Acc: 0.101 Test Loss: 3.226 Test Acc: 0.101
Validation loss decreased (-0.089379 --> -0.101144).  Saving model ...
Epoch: 12 cost time: 0.7914302349090576
Epoch: 12, Steps: 10 | Train Loss: 2.588 Vali Loss: 3.218 Vali Acc: 0.109 Test Loss: 3.218 Test Acc: 0.109
Validation loss decreased (-0.101144 --> -0.109380).  Saving model ...
Epoch: 13 cost time: 0.7735283374786377
Epoch: 13, Steps: 10 | Train Loss: 2.518 Vali Loss: 3.212 Vali Acc: 0.114 Test Loss: 3.212 Test Acc: 0.114
Validation loss decreased (-0.109380 --> -0.114086).  Saving model ...
Epoch: 14 cost time: 0.7570247650146484
Epoch: 14, Steps: 10 | Train Loss: 2.411 Vali Loss: 3.201 Vali Acc: 0.124 Test Loss: 3.201 Test Acc: 0.124
Validation loss decreased (-0.114086 --> -0.123497).  Saving model ...
Epoch: 15 cost time: 0.8164646625518799
Epoch: 15, Steps: 10 | Train Loss: 2.268 Vali Loss: 3.193 Vali Acc: 0.133 Test Loss: 3.193 Test Acc: 0.133
Validation loss decreased (-0.123497 --> -0.132909).  Saving model ...
Epoch: 16 cost time: 0.7046871185302734
Epoch: 16, Steps: 10 | Train Loss: 2.146 Vali Loss: 3.184 Vali Acc: 0.148 Test Loss: 3.184 Test Acc: 0.148
Validation loss decreased (-0.132909 --> -0.148203).  Saving model ...
Epoch: 17 cost time: 0.7600347995758057
Epoch: 17, Steps: 10 | Train Loss: 2.043 Vali Loss: 3.178 Vali Acc: 0.154 Test Loss: 3.178 Test Acc: 0.154
Validation loss decreased (-0.148203 --> -0.154086).  Saving model ...
Epoch: 18 cost time: 0.8395311832427979
Epoch: 18, Steps: 10 | Train Loss: 1.888 Vali Loss: 3.175 Vali Acc: 0.167 Test Loss: 3.175 Test Acc: 0.167
Validation loss decreased (-0.154086 --> -0.167027).  Saving model ...
Epoch: 19 cost time: 0.741004228591919
Epoch: 19, Steps: 10 | Train Loss: 1.770 Vali Loss: 3.179 Vali Acc: 0.169 Test Loss: 3.179 Test Acc: 0.169
Validation loss decreased (-0.167027 --> -0.169380).  Saving model ...
Epoch: 20 cost time: 0.7245192527770996
Epoch: 20, Steps: 10 | Train Loss: 1.606 Vali Loss: 3.177 Vali Acc: 0.182 Test Loss: 3.177 Test Acc: 0.182
Validation loss decreased (-0.169380 --> -0.182321).  Saving model ...
Epoch: 21 cost time: 0.7173182964324951
Epoch: 21, Steps: 10 | Train Loss: 1.451 Vali Loss: 3.188 Vali Acc: 0.188 Test Loss: 3.188 Test Acc: 0.188
Validation loss decreased (-0.182321 --> -0.188203).  Saving model ...
Epoch: 22 cost time: 0.7045996189117432
Epoch: 22, Steps: 10 | Train Loss: 1.361 Vali Loss: 3.196 Vali Acc: 0.196 Test Loss: 3.196 Test Acc: 0.196
Validation loss decreased (-0.188203 --> -0.196439).  Saving model ...
Epoch: 23 cost time: 0.7344820499420166
Epoch: 23, Steps: 10 | Train Loss: 1.173 Vali Loss: 3.214 Vali Acc: 0.200 Test Loss: 3.214 Test Acc: 0.200
Validation loss decreased (-0.196439 --> -0.199968).  Saving model ...
Epoch: 24 cost time: 0.7999701499938965
Epoch: 24, Steps: 10 | Train Loss: 1.085 Vali Loss: 3.234 Vali Acc: 0.204 Test Loss: 3.234 Test Acc: 0.204
Validation loss decreased (-0.199968 --> -0.203497).  Saving model ...
Epoch: 25 cost time: 0.7895421981811523
Epoch: 25, Steps: 10 | Train Loss: 0.951 Vali Loss: 3.254 Vali Acc: 0.219 Test Loss: 3.254 Test Acc: 0.219
Validation loss decreased (-0.203497 --> -0.218791).  Saving model ...
Epoch: 26 cost time: 0.7660515308380127
Epoch: 26, Steps: 10 | Train Loss: 0.832 Vali Loss: 3.280 Vali Acc: 0.224 Test Loss: 3.280 Test Acc: 0.224
Validation loss decreased (-0.218791 --> -0.223497).  Saving model ...
Epoch: 27 cost time: 0.7394886016845703
Epoch: 27, Steps: 10 | Train Loss: 0.724 Vali Loss: 3.307 Vali Acc: 0.234 Test Loss: 3.307 Test Acc: 0.234
Validation loss decreased (-0.223497 --> -0.234085).  Saving model ...
Epoch: 28 cost time: 0.756035327911377
Epoch: 28, Steps: 10 | Train Loss: 0.612 Vali Loss: 3.347 Vali Acc: 0.236 Test Loss: 3.347 Test Acc: 0.236
Validation loss decreased (-0.234085 --> -0.236437).  Saving model ...
Epoch: 29 cost time: 0.7697219848632812
Epoch: 29, Steps: 10 | Train Loss: 0.530 Vali Loss: 3.383 Vali Acc: 0.241 Test Loss: 3.383 Test Acc: 0.241
Validation loss decreased (-0.236437 --> -0.241143).  Saving model ...
Epoch: 30 cost time: 0.773296594619751
Epoch: 30, Steps: 10 | Train Loss: 0.462 Vali Loss: 3.422 Vali Acc: 0.245 Test Loss: 3.422 Test Acc: 0.245
Validation loss decreased (-0.241143 --> -0.244672).  Saving model ...
Epoch: 31 cost time: 0.6932811737060547
Epoch: 31, Steps: 10 | Train Loss: 0.385 Vali Loss: 3.464 Vali Acc: 0.246 Test Loss: 3.464 Test Acc: 0.246
Validation loss decreased (-0.244672 --> -0.245848).  Saving model ...
Epoch: 32 cost time: 0.6682720184326172
Epoch: 32, Steps: 10 | Train Loss: 0.343 Vali Loss: 3.506 Vali Acc: 0.246 Test Loss: 3.506 Test Acc: 0.246
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.7125403881072998
Epoch: 33, Steps: 10 | Train Loss: 0.303 Vali Loss: 3.541 Vali Acc: 0.251 Test Loss: 3.541 Test Acc: 0.251
Validation loss decreased (-0.245848 --> -0.250553).  Saving model ...
Epoch: 34 cost time: 0.7061827182769775
Epoch: 34, Steps: 10 | Train Loss: 0.254 Vali Loss: 3.586 Vali Acc: 0.251 Test Loss: 3.586 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.8082535266876221
Epoch: 35, Steps: 10 | Train Loss: 0.236 Vali Loss: 3.624 Vali Acc: 0.253 Test Loss: 3.624 Test Acc: 0.253
Validation loss decreased (-0.250553 --> -0.252905).  Saving model ...
Epoch: 36 cost time: 0.7938666343688965
Epoch: 36, Steps: 10 | Train Loss: 0.199 Vali Loss: 3.673 Vali Acc: 0.254 Test Loss: 3.673 Test Acc: 0.254
Validation loss decreased (-0.252905 --> -0.254081).  Saving model ...
Epoch: 37 cost time: 0.746178150177002
Epoch: 37, Steps: 10 | Train Loss: 0.190 Vali Loss: 3.699 Vali Acc: 0.254 Test Loss: 3.699 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.7146079540252686
Epoch: 38, Steps: 10 | Train Loss: 0.155 Vali Loss: 3.736 Vali Acc: 0.255 Test Loss: 3.736 Test Acc: 0.255
Validation loss decreased (-0.254081 --> -0.255257).  Saving model ...
Epoch: 39 cost time: 0.7218790054321289
Epoch: 39, Steps: 10 | Train Loss: 0.136 Vali Loss: 3.776 Vali Acc: 0.260 Test Loss: 3.776 Test Acc: 0.260
Validation loss decreased (-0.255257 --> -0.259962).  Saving model ...
Epoch: 40 cost time: 0.7861382961273193
Epoch: 40, Steps: 10 | Train Loss: 0.114 Vali Loss: 3.825 Vali Acc: 0.254 Test Loss: 3.825 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.7758045196533203
Epoch: 41, Steps: 10 | Train Loss: 0.104 Vali Loss: 3.851 Vali Acc: 0.255 Test Loss: 3.851 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.6908652782440186
Epoch: 42, Steps: 10 | Train Loss: 0.101 Vali Loss: 3.883 Vali Acc: 0.256 Test Loss: 3.883 Test Acc: 0.256
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.6972546577453613
Epoch: 43, Steps: 10 | Train Loss: 0.082 Vali Loss: 3.907 Vali Acc: 0.253 Test Loss: 3.907 Test Acc: 0.253
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.7790329456329346
Epoch: 44, Steps: 10 | Train Loss: 0.082 Vali Loss: 3.931 Vali Acc: 0.253 Test Loss: 3.931 Test Acc: 0.253
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.7385668754577637
Epoch: 45, Steps: 10 | Train Loss: 0.074 Vali Loss: 3.956 Vali Acc: 0.254 Test Loss: 3.956 Test Acc: 0.254
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.8622786998748779
Epoch: 46, Steps: 10 | Train Loss: 0.065 Vali Loss: 3.974 Vali Acc: 0.258 Test Loss: 3.974 Test Acc: 0.258
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.828016996383667
Epoch: 47, Steps: 10 | Train Loss: 0.061 Vali Loss: 4.001 Vali Acc: 0.255 Test Loss: 4.001 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 0.7513232231140137
Epoch: 48, Steps: 10 | Train Loss: 0.058 Vali Loss: 4.028 Vali Acc: 0.254 Test Loss: 4.028 Test Acc: 0.254
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 0.7543594837188721
Epoch: 49, Steps: 10 | Train Loss: 0.051 Vali Loss: 4.052 Vali Acc: 0.252 Test Loss: 4.052 Test Acc: 0.252
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26
model parameter : 69274
model size : 0.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps38_str19_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.191314935684204
Epoch: 1, Steps: 10 | Train Loss: 3.251 Vali Loss: 3.265 Vali Acc: 0.036 Test Loss: 3.265 Test Acc: 0.036
Validation loss decreased (inf --> -0.036438).  Saving model ...
Epoch: 2 cost time: 0.746699333190918
Epoch: 2, Steps: 10 | Train Loss: 3.232 Vali Loss: 3.263 Vali Acc: 0.036 Test Loss: 3.263 Test Acc: 0.036
Validation loss decreased (-0.036438 --> -0.036438).  Saving model ...
Epoch: 3 cost time: 0.7153666019439697
Epoch: 3, Steps: 10 | Train Loss: 3.204 Vali Loss: 3.260 Vali Acc: 0.047 Test Loss: 3.260 Test Acc: 0.047
Validation loss decreased (-0.036438 --> -0.047026).  Saving model ...
Epoch: 4 cost time: 0.7433087825775146
Epoch: 4, Steps: 10 | Train Loss: 3.181 Vali Loss: 3.255 Vali Acc: 0.058 Test Loss: 3.255 Test Acc: 0.058
Validation loss decreased (-0.047026 --> -0.057615).  Saving model ...
Epoch: 5 cost time: 0.6762065887451172
Epoch: 5, Steps: 10 | Train Loss: 3.125 Vali Loss: 3.250 Vali Acc: 0.061 Test Loss: 3.250 Test Acc: 0.061
Validation loss decreased (-0.057615 --> -0.061144).  Saving model ...
Epoch: 6 cost time: 0.7671072483062744
Epoch: 6, Steps: 10 | Train Loss: 3.055 Vali Loss: 3.247 Vali Acc: 0.066 Test Loss: 3.247 Test Acc: 0.066
Validation loss decreased (-0.061144 --> -0.065850).  Saving model ...
Epoch: 7 cost time: 0.7415673732757568
Epoch: 7, Steps: 10 | Train Loss: 3.017 Vali Loss: 3.242 Vali Acc: 0.069 Test Loss: 3.242 Test Acc: 0.069
Validation loss decreased (-0.065850 --> -0.069379).  Saving model ...
Epoch: 8 cost time: 0.746953010559082
Epoch: 8, Steps: 10 | Train Loss: 2.951 Vali Loss: 3.239 Vali Acc: 0.080 Test Loss: 3.239 Test Acc: 0.080
Validation loss decreased (-0.069379 --> -0.079968).  Saving model ...
Epoch: 9 cost time: 0.672797679901123
Epoch: 9, Steps: 10 | Train Loss: 2.876 Vali Loss: 3.235 Vali Acc: 0.088 Test Loss: 3.235 Test Acc: 0.088
Validation loss decreased (-0.079968 --> -0.088203).  Saving model ...
Epoch: 10 cost time: 0.7244915962219238
Epoch: 10, Steps: 10 | Train Loss: 2.819 Vali Loss: 3.231 Vali Acc: 0.092 Test Loss: 3.231 Test Acc: 0.092
Validation loss decreased (-0.088203 --> -0.091732).  Saving model ...
Epoch: 11 cost time: 0.6791582107543945
Epoch: 11, Steps: 10 | Train Loss: 2.762 Vali Loss: 3.229 Vali Acc: 0.102 Test Loss: 3.229 Test Acc: 0.102
Validation loss decreased (-0.091732 --> -0.102321).  Saving model ...
Epoch: 12 cost time: 0.722278356552124
Epoch: 12, Steps: 10 | Train Loss: 2.648 Vali Loss: 3.224 Vali Acc: 0.105 Test Loss: 3.224 Test Acc: 0.105
Validation loss decreased (-0.102321 --> -0.104674).  Saving model ...
Epoch: 13 cost time: 0.7186412811279297
Epoch: 13, Steps: 10 | Train Loss: 2.597 Vali Loss: 3.219 Vali Acc: 0.112 Test Loss: 3.219 Test Acc: 0.112
Validation loss decreased (-0.104674 --> -0.111733).  Saving model ...
Epoch: 14 cost time: 0.7158691883087158
Epoch: 14, Steps: 10 | Train Loss: 2.493 Vali Loss: 3.210 Vali Acc: 0.118 Test Loss: 3.210 Test Acc: 0.118
Validation loss decreased (-0.111733 --> -0.117615).  Saving model ...
Epoch: 15 cost time: 0.7079401016235352
Epoch: 15, Steps: 10 | Train Loss: 2.386 Vali Loss: 3.208 Vali Acc: 0.125 Test Loss: 3.208 Test Acc: 0.125
Validation loss decreased (-0.117615 --> -0.124674).  Saving model ...
Epoch: 16 cost time: 0.8508410453796387
Epoch: 16, Steps: 10 | Train Loss: 2.319 Vali Loss: 3.204 Vali Acc: 0.128 Test Loss: 3.204 Test Acc: 0.128
Validation loss decreased (-0.124674 --> -0.128203).  Saving model ...
Epoch: 17 cost time: 0.8189272880554199
Epoch: 17, Steps: 10 | Train Loss: 2.158 Vali Loss: 3.197 Vali Acc: 0.131 Test Loss: 3.197 Test Acc: 0.131
Validation loss decreased (-0.128203 --> -0.130556).  Saving model ...
Epoch: 18 cost time: 0.7381734848022461
Epoch: 18, Steps: 10 | Train Loss: 2.057 Vali Loss: 3.191 Vali Acc: 0.139 Test Loss: 3.191 Test Acc: 0.139
Validation loss decreased (-0.130556 --> -0.138792).  Saving model ...
Epoch: 19 cost time: 0.7154557704925537
Epoch: 19, Steps: 10 | Train Loss: 1.914 Vali Loss: 3.185 Vali Acc: 0.158 Test Loss: 3.185 Test Acc: 0.158
Validation loss decreased (-0.138792 --> -0.157615).  Saving model ...
Epoch: 20 cost time: 0.7287096977233887
Epoch: 20, Steps: 10 | Train Loss: 1.781 Vali Loss: 3.186 Vali Acc: 0.169 Test Loss: 3.186 Test Acc: 0.169
Validation loss decreased (-0.157615 --> -0.169380).  Saving model ...
Epoch: 21 cost time: 0.7034378051757812
Epoch: 21, Steps: 10 | Train Loss: 1.657 Vali Loss: 3.189 Vali Acc: 0.172 Test Loss: 3.189 Test Acc: 0.172
Validation loss decreased (-0.169380 --> -0.171733).  Saving model ...
Epoch: 22 cost time: 0.7890987396240234
Epoch: 22, Steps: 10 | Train Loss: 1.536 Vali Loss: 3.191 Vali Acc: 0.178 Test Loss: 3.191 Test Acc: 0.178
Validation loss decreased (-0.171733 --> -0.177615).  Saving model ...
Epoch: 23 cost time: 0.7905058860778809
Epoch: 23, Steps: 10 | Train Loss: 1.394 Vali Loss: 3.203 Vali Acc: 0.191 Test Loss: 3.203 Test Acc: 0.191
Validation loss decreased (-0.177615 --> -0.190556).  Saving model ...
Epoch: 24 cost time: 0.7369017601013184
Epoch: 24, Steps: 10 | Train Loss: 1.275 Vali Loss: 3.220 Vali Acc: 0.191 Test Loss: 3.220 Test Acc: 0.191
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7331104278564453
Epoch: 25, Steps: 10 | Train Loss: 1.101 Vali Loss: 3.224 Vali Acc: 0.199 Test Loss: 3.224 Test Acc: 0.199
Validation loss decreased (-0.190556 --> -0.198791).  Saving model ...
Epoch: 26 cost time: 0.810992956161499
Epoch: 26, Steps: 10 | Train Loss: 1.023 Vali Loss: 3.245 Vali Acc: 0.199 Test Loss: 3.245 Test Acc: 0.199
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8072464466094971
Epoch: 27, Steps: 10 | Train Loss: 0.916 Vali Loss: 3.273 Vali Acc: 0.204 Test Loss: 3.273 Test Acc: 0.204
Validation loss decreased (-0.198791 --> -0.203497).  Saving model ...
Epoch: 28 cost time: 0.7452692985534668
Epoch: 28, Steps: 10 | Train Loss: 0.809 Vali Loss: 3.302 Vali Acc: 0.208 Test Loss: 3.302 Test Acc: 0.208
Validation loss decreased (-0.203497 --> -0.208202).  Saving model ...
Epoch: 29 cost time: 0.7113122940063477
Epoch: 29, Steps: 10 | Train Loss: 0.699 Vali Loss: 3.334 Vali Acc: 0.212 Test Loss: 3.334 Test Acc: 0.212
Validation loss decreased (-0.208202 --> -0.211731).  Saving model ...
Epoch: 30 cost time: 0.6939058303833008
Epoch: 30, Steps: 10 | Train Loss: 0.625 Vali Loss: 3.366 Vali Acc: 0.220 Test Loss: 3.366 Test Acc: 0.220
Validation loss decreased (-0.211731 --> -0.219966).  Saving model ...
Epoch: 31 cost time: 0.6527087688446045
Epoch: 31, Steps: 10 | Train Loss: 0.551 Vali Loss: 3.394 Vali Acc: 0.226 Test Loss: 3.394 Test Acc: 0.226
Validation loss decreased (-0.219966 --> -0.225848).  Saving model ...
Epoch: 32 cost time: 0.7167019844055176
Epoch: 32, Steps: 10 | Train Loss: 0.472 Vali Loss: 3.427 Vali Acc: 0.232 Test Loss: 3.427 Test Acc: 0.232
Validation loss decreased (-0.225848 --> -0.231730).  Saving model ...
Epoch: 33 cost time: 0.705878496170044
Epoch: 33, Steps: 10 | Train Loss: 0.413 Vali Loss: 3.461 Vali Acc: 0.229 Test Loss: 3.461 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.7263228893280029
Epoch: 34, Steps: 10 | Train Loss: 0.371 Vali Loss: 3.500 Vali Acc: 0.240 Test Loss: 3.500 Test Acc: 0.240
Validation loss decreased (-0.231730 --> -0.239965).  Saving model ...
Epoch: 35 cost time: 0.6850907802581787
Epoch: 35, Steps: 10 | Train Loss: 0.326 Vali Loss: 3.541 Vali Acc: 0.242 Test Loss: 3.541 Test Acc: 0.242
Validation loss decreased (-0.239965 --> -0.242318).  Saving model ...
Epoch: 36 cost time: 0.6742744445800781
Epoch: 36, Steps: 10 | Train Loss: 0.279 Vali Loss: 3.576 Vali Acc: 0.248 Test Loss: 3.576 Test Acc: 0.248
Validation loss decreased (-0.242318 --> -0.248200).  Saving model ...
Epoch: 37 cost time: 0.7165005207061768
Epoch: 37, Steps: 10 | Train Loss: 0.271 Vali Loss: 3.615 Vali Acc: 0.248 Test Loss: 3.615 Test Acc: 0.248
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.7026734352111816
Epoch: 38, Steps: 10 | Train Loss: 0.223 Vali Loss: 3.643 Vali Acc: 0.246 Test Loss: 3.643 Test Acc: 0.246
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.7543261051177979
Epoch: 39, Steps: 10 | Train Loss: 0.189 Vali Loss: 3.669 Vali Acc: 0.249 Test Loss: 3.669 Test Acc: 0.249
Validation loss decreased (-0.248200 --> -0.249375).  Saving model ...
Epoch: 40 cost time: 0.7495584487915039
Epoch: 40, Steps: 10 | Train Loss: 0.169 Vali Loss: 3.722 Vali Acc: 0.255 Test Loss: 3.722 Test Acc: 0.255
Validation loss decreased (-0.249375 --> -0.255257).  Saving model ...
Epoch: 41 cost time: 0.6972718238830566
Epoch: 41, Steps: 10 | Train Loss: 0.157 Vali Loss: 3.762 Vali Acc: 0.254 Test Loss: 3.762 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.735926628112793
Epoch: 42, Steps: 10 | Train Loss: 0.143 Vali Loss: 3.814 Vali Acc: 0.255 Test Loss: 3.814 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.7608356475830078
Epoch: 43, Steps: 10 | Train Loss: 0.134 Vali Loss: 3.851 Vali Acc: 0.252 Test Loss: 3.851 Test Acc: 0.252
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.8107943534851074
Epoch: 44, Steps: 10 | Train Loss: 0.122 Vali Loss: 3.874 Vali Acc: 0.254 Test Loss: 3.874 Test Acc: 0.254
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.6856682300567627
Epoch: 45, Steps: 10 | Train Loss: 0.102 Vali Loss: 3.888 Vali Acc: 0.259 Test Loss: 3.888 Test Acc: 0.259
Validation loss decreased (-0.255257 --> -0.258785).  Saving model ...
Epoch: 46 cost time: 0.7689509391784668
Epoch: 46, Steps: 10 | Train Loss: 0.094 Vali Loss: 3.910 Vali Acc: 0.261 Test Loss: 3.910 Test Acc: 0.261
Validation loss decreased (-0.258785 --> -0.261137).  Saving model ...
Epoch: 47 cost time: 0.7327542304992676
Epoch: 47, Steps: 10 | Train Loss: 0.082 Vali Loss: 3.956 Vali Acc: 0.258 Test Loss: 3.956 Test Acc: 0.258
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.7554416656494141
Epoch: 48, Steps: 10 | Train Loss: 0.077 Vali Loss: 3.989 Vali Acc: 0.255 Test Loss: 3.989 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.7540850639343262
Epoch: 49, Steps: 10 | Train Loss: 0.066 Vali Loss: 4.004 Vali Acc: 0.256 Test Loss: 4.004 Test Acc: 0.256
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.773169994354248
Epoch: 50, Steps: 10 | Train Loss: 0.066 Vali Loss: 4.028 Vali Acc: 0.253 Test Loss: 4.028 Test Acc: 0.253
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps38_str19_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2611764705882353
model parameter : 64506
model size : 0.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.4434502124786377
Epoch: 1, Steps: 10 | Train Loss: 3.357 Vali Loss: 3.288 Vali Acc: 0.089 Test Loss: 3.288 Test Acc: 0.089
Validation loss decreased (inf --> -0.089379).  Saving model ...
Epoch: 2 cost time: 1.0882463455200195
Epoch: 2, Steps: 10 | Train Loss: 2.111 Vali Loss: 3.236 Vali Acc: 0.179 Test Loss: 3.236 Test Acc: 0.179
Validation loss decreased (-0.089379 --> -0.178791).  Saving model ...
Epoch: 3 cost time: 1.121145248413086
Epoch: 3, Steps: 10 | Train Loss: 0.789 Vali Loss: 3.650 Vali Acc: 0.204 Test Loss: 3.650 Test Acc: 0.204
Validation loss decreased (-0.178791 --> -0.203493).  Saving model ...
Epoch: 4 cost time: 1.1229493618011475
Epoch: 4, Steps: 10 | Train Loss: 0.248 Vali Loss: 4.010 Vali Acc: 0.241 Test Loss: 4.010 Test Acc: 0.241
Validation loss decreased (-0.203493 --> -0.241136).  Saving model ...
Epoch: 5 cost time: 1.10245680809021
Epoch: 5, Steps: 10 | Train Loss: 0.073 Vali Loss: 4.720 Vali Acc: 0.219 Test Loss: 4.720 Test Acc: 0.219
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0719773769378662
Epoch: 6, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.901 Vali Acc: 0.248 Test Loss: 4.901 Test Acc: 0.248
Validation loss decreased (-0.241136 --> -0.248186).  Saving model ...
Epoch: 7 cost time: 1.0879795551300049
Epoch: 7, Steps: 10 | Train Loss: 0.019 Vali Loss: 5.095 Vali Acc: 0.248 Test Loss: 5.095 Test Acc: 0.248
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.059725046157837
Epoch: 8, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.171 Vali Acc: 0.246 Test Loss: 5.171 Test Acc: 0.246
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0664482116699219
Epoch: 9, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.122 Vali Acc: 0.251 Test Loss: 5.122 Test Acc: 0.251
Validation loss decreased (-0.248186 --> -0.250537).  Saving model ...
Epoch: 10 cost time: 1.0777130126953125
Epoch: 10, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.129 Vali Acc: 0.256 Test Loss: 5.129 Test Acc: 0.256
Validation loss decreased (-0.250537 --> -0.256419).  Saving model ...
Epoch: 11 cost time: 1.11441969871521
Epoch: 11, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.151 Vali Acc: 0.258 Test Loss: 5.151 Test Acc: 0.258
Validation loss decreased (-0.256419 --> -0.257596).  Saving model ...
Epoch: 12 cost time: 1.1264457702636719
Epoch: 12, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.152 Vali Acc: 0.264 Test Loss: 5.152 Test Acc: 0.264
Validation loss decreased (-0.257596 --> -0.263478).  Saving model ...
Epoch: 13 cost time: 1.0707623958587646
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.153 Vali Acc: 0.262 Test Loss: 5.153 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0435972213745117
Epoch: 14, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.158 Vali Acc: 0.271 Test Loss: 5.158 Test Acc: 0.271
Validation loss decreased (-0.263478 --> -0.270537).  Saving model ...
Epoch: 15 cost time: 1.0221037864685059
Epoch: 15, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.169 Vali Acc: 0.269 Test Loss: 5.169 Test Acc: 0.269
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8481271266937256
Epoch: 16, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.172 Vali Acc: 0.268 Test Loss: 5.172 Test Acc: 0.268
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0923271179199219
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.175 Vali Acc: 0.269 Test Loss: 5.175 Test Acc: 0.269
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.1088776588439941
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.172 Vali Acc: 0.273 Test Loss: 5.172 Test Acc: 0.273
Validation loss decreased (-0.270537 --> -0.272889).  Saving model ...
Epoch: 19 cost time: 1.1046857833862305
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.186 Vali Acc: 0.272 Test Loss: 5.186 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.09767484664917
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.191 Vali Acc: 0.273 Test Loss: 5.191 Test Acc: 0.273
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.0585391521453857
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.216 Vali Acc: 0.274 Test Loss: 5.216 Test Acc: 0.274
Validation loss decreased (-0.272889 --> -0.274065).  Saving model ...
Epoch: 22 cost time: 1.0623059272766113
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.223 Vali Acc: 0.274 Test Loss: 5.223 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0439138412475586
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.234 Vali Acc: 0.275 Test Loss: 5.234 Test Acc: 0.275
Validation loss decreased (-0.274065 --> -0.275242).  Saving model ...
Epoch: 24 cost time: 1.149090051651001
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.247 Vali Acc: 0.275 Test Loss: 5.247 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.1177031993865967
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.267 Vali Acc: 0.275 Test Loss: 5.267 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.0918447971343994
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.291 Vali Acc: 0.271 Test Loss: 5.291 Test Acc: 0.271
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.1027066707611084
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.301 Vali Acc: 0.269 Test Loss: 5.301 Test Acc: 0.269
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.044734001159668
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.313 Vali Acc: 0.273 Test Loss: 5.313 Test Acc: 0.273
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.964177131652832
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.301 Vali Acc: 0.275 Test Loss: 5.301 Test Acc: 0.275
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.0469119548797607
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.318 Vali Acc: 0.275 Test Loss: 5.318 Test Acc: 0.275
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.0901873111724854
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.320 Vali Acc: 0.276 Test Loss: 5.320 Test Acc: 0.276
Validation loss decreased (-0.275242 --> -0.276417).  Saving model ...
Epoch: 32 cost time: 1.152350664138794
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.329 Vali Acc: 0.274 Test Loss: 5.329 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.1551299095153809
Epoch: 33, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.342 Vali Acc: 0.275 Test Loss: 5.342 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.1227924823760986
Epoch: 34, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.370 Vali Acc: 0.275 Test Loss: 5.370 Test Acc: 0.275
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.0429441928863525
Epoch: 35, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.383 Vali Acc: 0.275 Test Loss: 5.383 Test Acc: 0.275
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.178154468536377
Epoch: 36, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.392 Vali Acc: 0.275 Test Loss: 5.392 Test Acc: 0.275
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.0831332206726074
Epoch: 37, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.404 Vali Acc: 0.275 Test Loss: 5.404 Test Acc: 0.275
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.0663397312164307
Epoch: 38, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.416 Vali Acc: 0.274 Test Loss: 5.416 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.1729087829589844
Epoch: 39, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.422 Vali Acc: 0.275 Test Loss: 5.422 Test Acc: 0.275
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.1423933506011963
Epoch: 40, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.418 Vali Acc: 0.275 Test Loss: 5.418 Test Acc: 0.275
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.1437840461730957
Epoch: 41, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.427 Vali Acc: 0.274 Test Loss: 5.427 Test Acc: 0.274
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27647058823529413
model parameter : 1937690
model size : 7.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.9072136878967285
Epoch: 1, Steps: 10 | Train Loss: 3.328 Vali Loss: 3.270 Vali Acc: 0.042 Test Loss: 3.270 Test Acc: 0.042
Validation loss decreased (inf --> -0.042320).  Saving model ...
Epoch: 2 cost time: 0.8335826396942139
Epoch: 2, Steps: 10 | Train Loss: 2.564 Vali Loss: 3.265 Vali Acc: 0.124 Test Loss: 3.265 Test Acc: 0.124
Validation loss decreased (-0.042320 --> -0.123497).  Saving model ...
Epoch: 3 cost time: 0.8118877410888672
Epoch: 3, Steps: 10 | Train Loss: 1.587 Vali Loss: 3.210 Vali Acc: 0.202 Test Loss: 3.210 Test Acc: 0.202
Validation loss decreased (-0.123497 --> -0.202321).  Saving model ...
Epoch: 4 cost time: 0.8584015369415283
Epoch: 4, Steps: 10 | Train Loss: 0.774 Vali Loss: 3.332 Vali Acc: 0.229 Test Loss: 3.332 Test Acc: 0.229
Validation loss decreased (-0.202321 --> -0.229378).  Saving model ...
Epoch: 5 cost time: 0.860283613204956
Epoch: 5, Steps: 10 | Train Loss: 0.325 Vali Loss: 3.611 Vali Acc: 0.238 Test Loss: 3.611 Test Acc: 0.238
Validation loss decreased (-0.229378 --> -0.237611).  Saving model ...
Epoch: 6 cost time: 0.795867919921875
Epoch: 6, Steps: 10 | Train Loss: 0.134 Vali Loss: 3.847 Vali Acc: 0.253 Test Loss: 3.847 Test Acc: 0.253
Validation loss decreased (-0.237611 --> -0.252903).  Saving model ...
Epoch: 7 cost time: 0.7718124389648438
Epoch: 7, Steps: 10 | Train Loss: 0.057 Vali Loss: 4.004 Vali Acc: 0.260 Test Loss: 4.004 Test Acc: 0.260
Validation loss decreased (-0.252903 --> -0.259960).  Saving model ...
Epoch: 8 cost time: 0.7849302291870117
Epoch: 8, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.237 Vali Acc: 0.249 Test Loss: 4.237 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8187081813812256
Epoch: 9, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.309 Vali Acc: 0.258 Test Loss: 4.309 Test Acc: 0.258
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.841524600982666
Epoch: 10, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.323 Vali Acc: 0.264 Test Loss: 4.323 Test Acc: 0.264
Validation loss decreased (-0.259960 --> -0.263486).  Saving model ...
Epoch: 11 cost time: 0.8015322685241699
Epoch: 11, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.353 Vali Acc: 0.271 Test Loss: 4.353 Test Acc: 0.271
Validation loss decreased (-0.263486 --> -0.270545).  Saving model ...
Epoch: 12 cost time: 0.8096938133239746
Epoch: 12, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.386 Vali Acc: 0.275 Test Loss: 4.386 Test Acc: 0.275
Validation loss decreased (-0.270545 --> -0.275250).  Saving model ...
Epoch: 13 cost time: 0.798302173614502
Epoch: 13, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.409 Vali Acc: 0.269 Test Loss: 4.409 Test Acc: 0.269
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8402025699615479
Epoch: 14, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.437 Vali Acc: 0.264 Test Loss: 4.437 Test Acc: 0.264
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8178236484527588
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.453 Vali Acc: 0.264 Test Loss: 4.453 Test Acc: 0.264
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.7663826942443848
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.481 Vali Acc: 0.265 Test Loss: 4.481 Test Acc: 0.265
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.7911169528961182
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.503 Vali Acc: 0.264 Test Loss: 4.503 Test Acc: 0.264
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.774777889251709
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.525 Vali Acc: 0.272 Test Loss: 4.525 Test Acc: 0.272
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.8176319599151611
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.544 Vali Acc: 0.269 Test Loss: 4.544 Test Acc: 0.269
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.7626798152923584
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.564 Vali Acc: 0.266 Test Loss: 4.564 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.8220658302307129
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.577 Vali Acc: 0.273 Test Loss: 4.577 Test Acc: 0.273
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.8392469882965088
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.600 Vali Acc: 0.273 Test Loss: 4.600 Test Acc: 0.273
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2752941176470588
model parameter : 1179930
model size : 4.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps12_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.3288204669952393
Epoch: 1, Steps: 10 | Train Loss: 3.317 Vali Loss: 3.253 Vali Acc: 0.060 Test Loss: 3.253 Test Acc: 0.060
Validation loss decreased (inf --> -0.059967).  Saving model ...
Epoch: 2 cost time: 0.8434691429138184
Epoch: 2, Steps: 10 | Train Loss: 2.785 Vali Loss: 3.256 Vali Acc: 0.106 Test Loss: 3.256 Test Acc: 0.106
Validation loss decreased (-0.059967 --> -0.105850).  Saving model ...
Epoch: 3 cost time: 0.7847931385040283
Epoch: 3, Steps: 10 | Train Loss: 1.995 Vali Loss: 3.240 Vali Acc: 0.164 Test Loss: 3.240 Test Acc: 0.164
Validation loss decreased (-0.105850 --> -0.163497).  Saving model ...
Epoch: 4 cost time: 0.8059871196746826
Epoch: 4, Steps: 10 | Train Loss: 1.271 Vali Loss: 3.182 Vali Acc: 0.219 Test Loss: 3.182 Test Acc: 0.219
Validation loss decreased (-0.163497 --> -0.218792).  Saving model ...
Epoch: 5 cost time: 0.8316771984100342
Epoch: 5, Steps: 10 | Train Loss: 0.680 Vali Loss: 3.337 Vali Acc: 0.208 Test Loss: 3.337 Test Acc: 0.208
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8048698902130127
Epoch: 6, Steps: 10 | Train Loss: 0.358 Vali Loss: 3.440 Vali Acc: 0.260 Test Loss: 3.440 Test Acc: 0.260
Validation loss decreased (-0.218792 --> -0.259966).  Saving model ...
Epoch: 7 cost time: 0.7903938293457031
Epoch: 7, Steps: 10 | Train Loss: 0.175 Vali Loss: 3.678 Vali Acc: 0.253 Test Loss: 3.678 Test Acc: 0.253
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7951855659484863
Epoch: 8, Steps: 10 | Train Loss: 0.093 Vali Loss: 3.903 Vali Acc: 0.241 Test Loss: 3.903 Test Acc: 0.241
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8554198741912842
Epoch: 9, Steps: 10 | Train Loss: 0.042 Vali Loss: 3.956 Vali Acc: 0.268 Test Loss: 3.956 Test Acc: 0.268
Validation loss decreased (-0.259966 --> -0.268196).  Saving model ...
Epoch: 10 cost time: 0.8076400756835938
Epoch: 10, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.996 Vali Acc: 0.264 Test Loss: 3.996 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7727818489074707
Epoch: 11, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.077 Vali Acc: 0.265 Test Loss: 4.077 Test Acc: 0.265
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7761209011077881
Epoch: 12, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.114 Vali Acc: 0.266 Test Loss: 4.114 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.8044862747192383
Epoch: 13, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.148 Vali Acc: 0.267 Test Loss: 4.148 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.8647396564483643
Epoch: 14, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.163 Vali Acc: 0.274 Test Loss: 4.163 Test Acc: 0.274
Validation loss decreased (-0.268196 --> -0.274076).  Saving model ...
Epoch: 15 cost time: 0.8238687515258789
Epoch: 15, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.210 Vali Acc: 0.268 Test Loss: 4.210 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7861244678497314
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.246 Vali Acc: 0.267 Test Loss: 4.246 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7829432487487793
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.261 Vali Acc: 0.276 Test Loss: 4.261 Test Acc: 0.276
Validation loss decreased (-0.274076 --> -0.276428).  Saving model ...
Epoch: 18 cost time: 0.7364034652709961
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.285 Vali Acc: 0.271 Test Loss: 4.285 Test Acc: 0.271
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8184170722961426
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.317 Vali Acc: 0.272 Test Loss: 4.317 Test Acc: 0.272
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7948050498962402
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.331 Vali Acc: 0.274 Test Loss: 4.331 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.7864885330200195
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.351 Vali Acc: 0.278 Test Loss: 4.351 Test Acc: 0.278
Validation loss decreased (-0.276428 --> -0.277604).  Saving model ...
Epoch: 22 cost time: 0.8089988231658936
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.379 Vali Acc: 0.271 Test Loss: 4.379 Test Acc: 0.271
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7752444744110107
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.402 Vali Acc: 0.271 Test Loss: 4.402 Test Acc: 0.271
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.8104996681213379
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.424 Vali Acc: 0.274 Test Loss: 4.424 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.8279669284820557
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.449 Vali Acc: 0.274 Test Loss: 4.449 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.7201297283172607
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.477 Vali Acc: 0.273 Test Loss: 4.477 Test Acc: 0.273
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.7661664485931396
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.492 Vali Acc: 0.274 Test Loss: 4.492 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.791982889175415
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.496 Vali Acc: 0.274 Test Loss: 4.496 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.859431266784668
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.517 Vali Acc: 0.276 Test Loss: 4.517 Test Acc: 0.276
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.8756320476531982
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.542 Vali Acc: 0.278 Test Loss: 4.542 Test Acc: 0.278
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.8274366855621338
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.551 Vali Acc: 0.273 Test Loss: 4.551 Test Acc: 0.273
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps12_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2776470588235294
model parameter : 921370
model size : 3.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.1809988021850586
Epoch: 1, Steps: 10 | Train Loss: 3.312 Vali Loss: 3.274 Vali Acc: 0.066 Test Loss: 3.274 Test Acc: 0.066
Validation loss decreased (inf --> -0.065850).  Saving model ...
Epoch: 2 cost time: 0.840507984161377
Epoch: 2, Steps: 10 | Train Loss: 2.865 Vali Loss: 3.260 Vali Acc: 0.104 Test Loss: 3.260 Test Acc: 0.104
Validation loss decreased (-0.065850 --> -0.103497).  Saving model ...
Epoch: 3 cost time: 0.7664384841918945
Epoch: 3, Steps: 10 | Train Loss: 2.255 Vali Loss: 3.255 Vali Acc: 0.147 Test Loss: 3.255 Test Acc: 0.147
Validation loss decreased (-0.103497 --> -0.147026).  Saving model ...
Epoch: 4 cost time: 0.7370245456695557
Epoch: 4, Steps: 10 | Train Loss: 1.567 Vali Loss: 3.195 Vali Acc: 0.194 Test Loss: 3.195 Test Acc: 0.194
Validation loss decreased (-0.147026 --> -0.194086).  Saving model ...
Epoch: 5 cost time: 0.7544076442718506
Epoch: 5, Steps: 10 | Train Loss: 1.072 Vali Loss: 3.192 Vali Acc: 0.233 Test Loss: 3.192 Test Acc: 0.233
Validation loss decreased (-0.194086 --> -0.232909).  Saving model ...
Epoch: 6 cost time: 0.8342301845550537
Epoch: 6, Steps: 10 | Train Loss: 0.605 Vali Loss: 3.352 Vali Acc: 0.226 Test Loss: 3.352 Test Acc: 0.226
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8241229057312012
Epoch: 7, Steps: 10 | Train Loss: 0.343 Vali Loss: 3.463 Vali Acc: 0.256 Test Loss: 3.463 Test Acc: 0.256
Validation loss decreased (-0.232909 --> -0.256436).  Saving model ...
Epoch: 8 cost time: 0.7964613437652588
Epoch: 8, Steps: 10 | Train Loss: 0.172 Vali Loss: 3.635 Vali Acc: 0.254 Test Loss: 3.635 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8335516452789307
Epoch: 9, Steps: 10 | Train Loss: 0.085 Vali Loss: 3.704 Vali Acc: 0.261 Test Loss: 3.704 Test Acc: 0.261
Validation loss decreased (-0.256436 --> -0.261139).  Saving model ...
Epoch: 10 cost time: 0.8227901458740234
Epoch: 10, Steps: 10 | Train Loss: 0.049 Vali Loss: 3.812 Vali Acc: 0.269 Test Loss: 3.812 Test Acc: 0.269
Validation loss decreased (-0.261139 --> -0.269374).  Saving model ...
Epoch: 11 cost time: 0.8044857978820801
Epoch: 11, Steps: 10 | Train Loss: 0.031 Vali Loss: 3.879 Vali Acc: 0.276 Test Loss: 3.879 Test Acc: 0.276
Validation loss decreased (-0.269374 --> -0.276432).  Saving model ...
Epoch: 12 cost time: 0.8029656410217285
Epoch: 12, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.914 Vali Acc: 0.266 Test Loss: 3.914 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7708799839019775
Epoch: 13, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.999 Vali Acc: 0.266 Test Loss: 3.999 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8539566993713379
Epoch: 14, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.018 Vali Acc: 0.272 Test Loss: 4.018 Test Acc: 0.272
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8168606758117676
Epoch: 15, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.023 Vali Acc: 0.275 Test Loss: 4.023 Test Acc: 0.275
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.7773683071136475
Epoch: 16, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.059 Vali Acc: 0.278 Test Loss: 4.059 Test Acc: 0.278
Validation loss decreased (-0.276432 --> -0.277606).  Saving model ...
Epoch: 17 cost time: 0.8083395957946777
Epoch: 17, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.070 Vali Acc: 0.282 Test Loss: 4.070 Test Acc: 0.282
Validation loss decreased (-0.277606 --> -0.282312).  Saving model ...
Epoch: 18 cost time: 0.7780566215515137
Epoch: 18, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.122 Vali Acc: 0.273 Test Loss: 4.122 Test Acc: 0.273
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8230772018432617
Epoch: 19, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.147 Vali Acc: 0.276 Test Loss: 4.147 Test Acc: 0.276
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8170998096466064
Epoch: 20, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.170 Vali Acc: 0.274 Test Loss: 4.170 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.7779533863067627
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.196 Vali Acc: 0.276 Test Loss: 4.196 Test Acc: 0.276
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.8168330192565918
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.220 Vali Acc: 0.274 Test Loss: 4.220 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.8010237216949463
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.249 Vali Acc: 0.276 Test Loss: 4.249 Test Acc: 0.276
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.8599319458007812
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.271 Vali Acc: 0.274 Test Loss: 4.271 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.8633136749267578
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.284 Vali Acc: 0.274 Test Loss: 4.284 Test Acc: 0.274
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.7690422534942627
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.308 Vali Acc: 0.275 Test Loss: 4.308 Test Acc: 0.275
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.7962160110473633
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.325 Vali Acc: 0.274 Test Loss: 4.325 Test Acc: 0.274
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2823529411764706
model parameter : 802586
model size : 3.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps23_str12_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.222877025604248
Epoch: 1, Steps: 10 | Train Loss: 3.310 Vali Loss: 3.280 Vali Acc: 0.044 Test Loss: 3.280 Test Acc: 0.044
Validation loss decreased (inf --> -0.043497).  Saving model ...
Epoch: 2 cost time: 0.7680230140686035
Epoch: 2, Steps: 10 | Train Loss: 2.992 Vali Loss: 3.268 Vali Acc: 0.105 Test Loss: 3.268 Test Acc: 0.105
Validation loss decreased (-0.043497 --> -0.104673).  Saving model ...
Epoch: 3 cost time: 0.8086497783660889
Epoch: 3, Steps: 10 | Train Loss: 2.508 Vali Loss: 3.253 Vali Acc: 0.119 Test Loss: 3.253 Test Acc: 0.119
Validation loss decreased (-0.104673 --> -0.118791).  Saving model ...
Epoch: 4 cost time: 0.7892043590545654
Epoch: 4, Steps: 10 | Train Loss: 2.038 Vali Loss: 3.236 Vali Acc: 0.154 Test Loss: 3.236 Test Acc: 0.154
Validation loss decreased (-0.118791 --> -0.154085).  Saving model ...
Epoch: 5 cost time: 0.8173091411590576
Epoch: 5, Steps: 10 | Train Loss: 1.544 Vali Loss: 3.212 Vali Acc: 0.187 Test Loss: 3.212 Test Acc: 0.187
Validation loss decreased (-0.154085 --> -0.187027).  Saving model ...
Epoch: 6 cost time: 0.8652462959289551
Epoch: 6, Steps: 10 | Train Loss: 1.076 Vali Loss: 3.204 Vali Acc: 0.229 Test Loss: 3.204 Test Acc: 0.229
Validation loss decreased (-0.187027 --> -0.229380).  Saving model ...
Epoch: 7 cost time: 0.7821459770202637
Epoch: 7, Steps: 10 | Train Loss: 0.738 Vali Loss: 3.271 Vali Acc: 0.228 Test Loss: 3.271 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7893233299255371
Epoch: 8, Steps: 10 | Train Loss: 0.475 Vali Loss: 3.357 Vali Acc: 0.245 Test Loss: 3.357 Test Acc: 0.245
Validation loss decreased (-0.229380 --> -0.244672).  Saving model ...
Epoch: 9 cost time: 0.8737654685974121
Epoch: 9, Steps: 10 | Train Loss: 0.316 Vali Loss: 3.424 Vali Acc: 0.259 Test Loss: 3.424 Test Acc: 0.259
Validation loss decreased (-0.244672 --> -0.258789).  Saving model ...
Epoch: 10 cost time: 0.8440320491790771
Epoch: 10, Steps: 10 | Train Loss: 0.194 Vali Loss: 3.484 Vali Acc: 0.272 Test Loss: 3.484 Test Acc: 0.272
Validation loss decreased (-0.258789 --> -0.271730).  Saving model ...
Epoch: 11 cost time: 0.8548679351806641
Epoch: 11, Steps: 10 | Train Loss: 0.113 Vali Loss: 3.641 Vali Acc: 0.259 Test Loss: 3.641 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8331301212310791
Epoch: 12, Steps: 10 | Train Loss: 0.070 Vali Loss: 3.712 Vali Acc: 0.261 Test Loss: 3.712 Test Acc: 0.261
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8290133476257324
Epoch: 13, Steps: 10 | Train Loss: 0.049 Vali Loss: 3.723 Vali Acc: 0.279 Test Loss: 3.723 Test Acc: 0.279
Validation loss decreased (-0.271730 --> -0.278786).  Saving model ...
Epoch: 14 cost time: 0.9149162769317627
Epoch: 14, Steps: 10 | Train Loss: 0.036 Vali Loss: 3.806 Vali Acc: 0.276 Test Loss: 3.806 Test Acc: 0.276
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8940670490264893
Epoch: 15, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.823 Vali Acc: 0.287 Test Loss: 3.823 Test Acc: 0.287
Validation loss decreased (-0.278786 --> -0.287021).  Saving model ...
Epoch: 16 cost time: 0.7823915481567383
Epoch: 16, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.863 Vali Acc: 0.276 Test Loss: 3.863 Test Acc: 0.276
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8132748603820801
Epoch: 17, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.885 Vali Acc: 0.282 Test Loss: 3.885 Test Acc: 0.282
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8541374206542969
Epoch: 18, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.900 Vali Acc: 0.278 Test Loss: 3.900 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.8645801544189453
Epoch: 19, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.938 Vali Acc: 0.281 Test Loss: 3.938 Test Acc: 0.281
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.8691182136535645
Epoch: 20, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.982 Vali Acc: 0.276 Test Loss: 3.982 Test Acc: 0.276
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.7770242691040039
Epoch: 21, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.006 Vali Acc: 0.280 Test Loss: 4.006 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.7924630641937256
Epoch: 22, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.042 Vali Acc: 0.282 Test Loss: 4.042 Test Acc: 0.282
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.7617490291595459
Epoch: 23, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.043 Vali Acc: 0.280 Test Loss: 4.043 Test Acc: 0.280
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.8288400173187256
Epoch: 24, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.061 Vali Acc: 0.284 Test Loss: 4.061 Test Acc: 0.284
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.8478596210479736
Epoch: 25, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.087 Vali Acc: 0.288 Test Loss: 4.087 Test Acc: 0.288
Validation loss decreased (-0.287021 --> -0.288194).  Saving model ...
Epoch: 26 cost time: 0.8035178184509277
Epoch: 26, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.102 Vali Acc: 0.293 Test Loss: 4.102 Test Acc: 0.293
Validation loss decreased (-0.288194 --> -0.292900).  Saving model ...
Epoch: 27 cost time: 0.8173353672027588
Epoch: 27, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.134 Vali Acc: 0.289 Test Loss: 4.134 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8220713138580322
Epoch: 28, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.155 Vali Acc: 0.292 Test Loss: 4.155 Test Acc: 0.292
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.8307571411132812
Epoch: 29, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.178 Vali Acc: 0.289 Test Loss: 4.178 Test Acc: 0.289
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.8329014778137207
Epoch: 30, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.203 Vali Acc: 0.286 Test Loss: 4.203 Test Acc: 0.286
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.7904889583587646
Epoch: 31, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.228 Vali Acc: 0.287 Test Loss: 4.228 Test Acc: 0.287
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.7864334583282471
Epoch: 32, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.245 Vali Acc: 0.286 Test Loss: 4.245 Test Acc: 0.286
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.8112397193908691
Epoch: 33, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.257 Vali Acc: 0.288 Test Loss: 4.257 Test Acc: 0.288
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.834989070892334
Epoch: 34, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.274 Vali Acc: 0.292 Test Loss: 4.274 Test Acc: 0.292
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.8472530841827393
Epoch: 35, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.273 Vali Acc: 0.289 Test Loss: 4.273 Test Acc: 0.289
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.821904182434082
Epoch: 36, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.314 Vali Acc: 0.286 Test Loss: 4.314 Test Acc: 0.286
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps23_str12_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.29294117647058826
model parameter : 664602
model size : 2.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.1639068126678467
Epoch: 1, Steps: 10 | Train Loss: 3.321 Vali Loss: 3.281 Vali Acc: 0.045 Test Loss: 3.281 Test Acc: 0.045
Validation loss decreased (inf --> -0.044673).  Saving model ...
Epoch: 2 cost time: 0.772451639175415
Epoch: 2, Steps: 10 | Train Loss: 3.041 Vali Loss: 3.254 Vali Acc: 0.091 Test Loss: 3.254 Test Acc: 0.091
Validation loss decreased (-0.044673 --> -0.090556).  Saving model ...
Epoch: 3 cost time: 0.8790864944458008
Epoch: 3, Steps: 10 | Train Loss: 2.697 Vali Loss: 3.259 Vali Acc: 0.107 Test Loss: 3.259 Test Acc: 0.107
Validation loss decreased (-0.090556 --> -0.107026).  Saving model ...
Epoch: 4 cost time: 0.7993738651275635
Epoch: 4, Steps: 10 | Train Loss: 2.311 Vali Loss: 3.226 Vali Acc: 0.142 Test Loss: 3.226 Test Acc: 0.142
Validation loss decreased (-0.107026 --> -0.142321).  Saving model ...
Epoch: 5 cost time: 0.7980082035064697
Epoch: 5, Steps: 10 | Train Loss: 1.854 Vali Loss: 3.201 Vali Acc: 0.178 Test Loss: 3.201 Test Acc: 0.178
Validation loss decreased (-0.142321 --> -0.177615).  Saving model ...
Epoch: 6 cost time: 0.847252368927002
Epoch: 6, Steps: 10 | Train Loss: 1.433 Vali Loss: 3.193 Vali Acc: 0.186 Test Loss: 3.193 Test Acc: 0.186
Validation loss decreased (-0.177615 --> -0.185850).  Saving model ...
Epoch: 7 cost time: 0.807685136795044
Epoch: 7, Steps: 10 | Train Loss: 1.083 Vali Loss: 3.198 Vali Acc: 0.201 Test Loss: 3.198 Test Acc: 0.201
Validation loss decreased (-0.185850 --> -0.201144).  Saving model ...
Epoch: 8 cost time: 0.7735404968261719
Epoch: 8, Steps: 10 | Train Loss: 0.799 Vali Loss: 3.225 Vali Acc: 0.231 Test Loss: 3.225 Test Acc: 0.231
Validation loss decreased (-0.201144 --> -0.230556).  Saving model ...
Epoch: 9 cost time: 0.8033599853515625
Epoch: 9, Steps: 10 | Train Loss: 0.578 Vali Loss: 3.309 Vali Acc: 0.247 Test Loss: 3.309 Test Acc: 0.247
Validation loss decreased (-0.230556 --> -0.247026).  Saving model ...
Epoch: 10 cost time: 0.7628302574157715
Epoch: 10, Steps: 10 | Train Loss: 0.388 Vali Loss: 3.413 Vali Acc: 0.247 Test Loss: 3.413 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7897796630859375
Epoch: 11, Steps: 10 | Train Loss: 0.272 Vali Loss: 3.443 Vali Acc: 0.253 Test Loss: 3.443 Test Acc: 0.253
Validation loss decreased (-0.247026 --> -0.252907).  Saving model ...
Epoch: 12 cost time: 0.7817323207855225
Epoch: 12, Steps: 10 | Train Loss: 0.177 Vali Loss: 3.498 Vali Acc: 0.255 Test Loss: 3.498 Test Acc: 0.255
Validation loss decreased (-0.252907 --> -0.255259).  Saving model ...
Epoch: 13 cost time: 0.8014287948608398
Epoch: 13, Steps: 10 | Train Loss: 0.117 Vali Loss: 3.595 Vali Acc: 0.267 Test Loss: 3.595 Test Acc: 0.267
Validation loss decreased (-0.255259 --> -0.267023).  Saving model ...
Epoch: 14 cost time: 0.8307678699493408
Epoch: 14, Steps: 10 | Train Loss: 0.079 Vali Loss: 3.682 Vali Acc: 0.255 Test Loss: 3.682 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7661380767822266
Epoch: 15, Steps: 10 | Train Loss: 0.059 Vali Loss: 3.717 Vali Acc: 0.262 Test Loss: 3.717 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7646658420562744
Epoch: 16, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.735 Vali Acc: 0.265 Test Loss: 3.735 Test Acc: 0.265
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.7493343353271484
Epoch: 17, Steps: 10 | Train Loss: 0.036 Vali Loss: 3.772 Vali Acc: 0.267 Test Loss: 3.772 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.7458658218383789
Epoch: 18, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.807 Vali Acc: 0.267 Test Loss: 3.807 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.8055334091186523
Epoch: 19, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.846 Vali Acc: 0.264 Test Loss: 3.846 Test Acc: 0.264
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.8170301914215088
Epoch: 20, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.865 Vali Acc: 0.267 Test Loss: 3.865 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.7889909744262695
Epoch: 21, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.901 Vali Acc: 0.266 Test Loss: 3.901 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.8207550048828125
Epoch: 22, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.909 Vali Acc: 0.264 Test Loss: 3.909 Test Acc: 0.264
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.7445125579833984
Epoch: 23, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.939 Vali Acc: 0.272 Test Loss: 3.939 Test Acc: 0.272
Validation loss decreased (-0.267023 --> -0.271725).  Saving model ...
Epoch: 24 cost time: 0.7904415130615234
Epoch: 24, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.957 Vali Acc: 0.273 Test Loss: 3.957 Test Acc: 0.273
Validation loss decreased (-0.271725 --> -0.272902).  Saving model ...
Epoch: 25 cost time: 0.7774455547332764
Epoch: 25, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.979 Vali Acc: 0.271 Test Loss: 3.979 Test Acc: 0.271
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.747227668762207
Epoch: 26, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.005 Vali Acc: 0.268 Test Loss: 4.005 Test Acc: 0.268
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.7739007472991943
Epoch: 27, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.038 Vali Acc: 0.271 Test Loss: 4.038 Test Acc: 0.271
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.8009133338928223
Epoch: 28, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.057 Vali Acc: 0.271 Test Loss: 4.057 Test Acc: 0.271
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.8207728862762451
Epoch: 29, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.086 Vali Acc: 0.273 Test Loss: 4.086 Test Acc: 0.273
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.777674674987793
Epoch: 30, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.096 Vali Acc: 0.269 Test Loss: 4.096 Test Acc: 0.269
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.7819688320159912
Epoch: 31, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.110 Vali Acc: 0.268 Test Loss: 4.110 Test Acc: 0.268
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.7878701686859131
Epoch: 32, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.141 Vali Acc: 0.267 Test Loss: 4.141 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.7667124271392822
Epoch: 33, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.169 Vali Acc: 0.271 Test Loss: 4.169 Test Acc: 0.271
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.7638602256774902
Epoch: 34, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.178 Vali Acc: 0.271 Test Loss: 4.178 Test Acc: 0.271
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27294117647058824
model parameter : 606746
model size : 2.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps38_str19_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.9584569931030273
Epoch: 1, Steps: 10 | Train Loss: 3.379 Vali Loss: 3.297 Vali Acc: 0.047 Test Loss: 3.297 Test Acc: 0.047
Validation loss decreased (inf --> -0.047026).  Saving model ...
Epoch: 2 cost time: 0.8261754512786865
Epoch: 2, Steps: 10 | Train Loss: 3.151 Vali Loss: 3.272 Vali Acc: 0.059 Test Loss: 3.272 Test Acc: 0.059
Validation loss decreased (-0.047026 --> -0.058791).  Saving model ...
Epoch: 3 cost time: 0.8115756511688232
Epoch: 3, Steps: 10 | Train Loss: 2.844 Vali Loss: 3.278 Vali Acc: 0.089 Test Loss: 3.278 Test Acc: 0.089
Validation loss decreased (-0.058791 --> -0.089379).  Saving model ...
Epoch: 4 cost time: 0.7756063938140869
Epoch: 4, Steps: 10 | Train Loss: 2.389 Vali Loss: 3.239 Vali Acc: 0.129 Test Loss: 3.239 Test Acc: 0.129
Validation loss decreased (-0.089379 --> -0.129379).  Saving model ...
Epoch: 5 cost time: 0.7124018669128418
Epoch: 5, Steps: 10 | Train Loss: 2.007 Vali Loss: 3.193 Vali Acc: 0.152 Test Loss: 3.193 Test Acc: 0.152
Validation loss decreased (-0.129379 --> -0.151733).  Saving model ...
Epoch: 6 cost time: 0.7499358654022217
Epoch: 6, Steps: 10 | Train Loss: 1.618 Vali Loss: 3.177 Vali Acc: 0.165 Test Loss: 3.177 Test Acc: 0.165
Validation loss decreased (-0.151733 --> -0.164674).  Saving model ...
Epoch: 7 cost time: 0.8015146255493164
Epoch: 7, Steps: 10 | Train Loss: 1.298 Vali Loss: 3.173 Vali Acc: 0.194 Test Loss: 3.173 Test Acc: 0.194
Validation loss decreased (-0.164674 --> -0.194086).  Saving model ...
Epoch: 8 cost time: 0.8145816326141357
Epoch: 8, Steps: 10 | Train Loss: 0.957 Vali Loss: 3.198 Vali Acc: 0.208 Test Loss: 3.198 Test Acc: 0.208
Validation loss decreased (-0.194086 --> -0.208203).  Saving model ...
Epoch: 9 cost time: 0.8178865909576416
Epoch: 9, Steps: 10 | Train Loss: 0.699 Vali Loss: 3.232 Vali Acc: 0.226 Test Loss: 3.232 Test Acc: 0.226
Validation loss decreased (-0.208203 --> -0.225850).  Saving model ...
Epoch: 10 cost time: 0.845412015914917
Epoch: 10, Steps: 10 | Train Loss: 0.516 Vali Loss: 3.267 Vali Acc: 0.234 Test Loss: 3.267 Test Acc: 0.234
Validation loss decreased (-0.225850 --> -0.234085).  Saving model ...
Epoch: 11 cost time: 0.8265471458435059
Epoch: 11, Steps: 10 | Train Loss: 0.401 Vali Loss: 3.374 Vali Acc: 0.246 Test Loss: 3.374 Test Acc: 0.246
Validation loss decreased (-0.234085 --> -0.245849).  Saving model ...
Epoch: 12 cost time: 0.7754731178283691
Epoch: 12, Steps: 10 | Train Loss: 0.253 Vali Loss: 3.418 Vali Acc: 0.253 Test Loss: 3.418 Test Acc: 0.253
Validation loss decreased (-0.245849 --> -0.252907).  Saving model ...
Epoch: 13 cost time: 0.7768063545227051
Epoch: 13, Steps: 10 | Train Loss: 0.168 Vali Loss: 3.467 Vali Acc: 0.254 Test Loss: 3.467 Test Acc: 0.254
Validation loss decreased (-0.252907 --> -0.254083).  Saving model ...
Epoch: 14 cost time: 0.8012149333953857
Epoch: 14, Steps: 10 | Train Loss: 0.120 Vali Loss: 3.539 Vali Acc: 0.260 Test Loss: 3.539 Test Acc: 0.260
Validation loss decreased (-0.254083 --> -0.259965).  Saving model ...
Epoch: 15 cost time: 0.781423807144165
Epoch: 15, Steps: 10 | Train Loss: 0.084 Vali Loss: 3.554 Vali Acc: 0.264 Test Loss: 3.554 Test Acc: 0.264
Validation loss decreased (-0.259965 --> -0.263494).  Saving model ...
Epoch: 16 cost time: 0.813042402267456
Epoch: 16, Steps: 10 | Train Loss: 0.063 Vali Loss: 3.616 Vali Acc: 0.262 Test Loss: 3.616 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7445640563964844
Epoch: 17, Steps: 10 | Train Loss: 0.053 Vali Loss: 3.653 Vali Acc: 0.273 Test Loss: 3.653 Test Acc: 0.273
Validation loss decreased (-0.263494 --> -0.272905).  Saving model ...
Epoch: 18 cost time: 0.729684591293335
Epoch: 18, Steps: 10 | Train Loss: 0.044 Vali Loss: 3.664 Vali Acc: 0.272 Test Loss: 3.664 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8240039348602295
Epoch: 19, Steps: 10 | Train Loss: 0.035 Vali Loss: 3.714 Vali Acc: 0.269 Test Loss: 3.714 Test Acc: 0.269
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8146169185638428
Epoch: 20, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.767 Vali Acc: 0.266 Test Loss: 3.767 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.8174526691436768
Epoch: 21, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.802 Vali Acc: 0.267 Test Loss: 3.802 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.7671289443969727
Epoch: 22, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.814 Vali Acc: 0.269 Test Loss: 3.814 Test Acc: 0.269
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.8062586784362793
Epoch: 23, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.824 Vali Acc: 0.272 Test Loss: 3.824 Test Acc: 0.272
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.7394638061523438
Epoch: 24, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.850 Vali Acc: 0.274 Test Loss: 3.850 Test Acc: 0.274
Validation loss decreased (-0.272905 --> -0.274079).  Saving model ...
Epoch: 25 cost time: 0.7936966419219971
Epoch: 25, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.863 Vali Acc: 0.278 Test Loss: 3.863 Test Acc: 0.278
Validation loss decreased (-0.274079 --> -0.277608).  Saving model ...
Epoch: 26 cost time: 0.7447798252105713
Epoch: 26, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.888 Vali Acc: 0.273 Test Loss: 3.888 Test Acc: 0.273
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.6653780937194824
Epoch: 27, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.919 Vali Acc: 0.276 Test Loss: 3.919 Test Acc: 0.276
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.7941513061523438
Epoch: 28, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.960 Vali Acc: 0.271 Test Loss: 3.960 Test Acc: 0.271
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.802053689956665
Epoch: 29, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.976 Vali Acc: 0.273 Test Loss: 3.976 Test Acc: 0.273
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.7977733612060547
Epoch: 30, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.995 Vali Acc: 0.275 Test Loss: 3.995 Test Acc: 0.275
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.8070242404937744
Epoch: 31, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.016 Vali Acc: 0.275 Test Loss: 4.016 Test Acc: 0.275
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.7641992568969727
Epoch: 32, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.043 Vali Acc: 0.273 Test Loss: 4.043 Test Acc: 0.273
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.7801826000213623
Epoch: 33, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.050 Vali Acc: 0.274 Test Loss: 4.050 Test Acc: 0.274
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.778855562210083
Epoch: 34, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.057 Vali Acc: 0.279 Test Loss: 4.057 Test Acc: 0.279
Validation loss decreased (-0.277608 --> -0.278783).  Saving model ...
Epoch: 35 cost time: 0.7260243892669678
Epoch: 35, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.065 Vali Acc: 0.279 Test Loss: 4.065 Test Acc: 0.279
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.7691876888275146
Epoch: 36, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.090 Vali Acc: 0.274 Test Loss: 4.090 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.6823818683624268
Epoch: 37, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.116 Vali Acc: 0.275 Test Loss: 4.116 Test Acc: 0.275
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.743095874786377
Epoch: 38, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.134 Vali Acc: 0.281 Test Loss: 4.134 Test Acc: 0.281
Validation loss decreased (-0.278783 --> -0.281135).  Saving model ...
Epoch: 39 cost time: 0.7911245822906494
Epoch: 39, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.175 Vali Acc: 0.280 Test Loss: 4.175 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.7731020450592041
Epoch: 40, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.177 Vali Acc: 0.279 Test Loss: 4.177 Test Acc: 0.279
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.8166561126708984
Epoch: 41, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.206 Vali Acc: 0.279 Test Loss: 4.206 Test Acc: 0.279
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.7461493015289307
Epoch: 42, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.211 Vali Acc: 0.279 Test Loss: 4.211 Test Acc: 0.279
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.7159826755523682
Epoch: 43, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.231 Vali Acc: 0.276 Test Loss: 4.231 Test Acc: 0.276
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.8158712387084961
Epoch: 44, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.243 Vali Acc: 0.273 Test Loss: 4.243 Test Acc: 0.273
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.7860748767852783
Epoch: 45, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.272 Vali Acc: 0.279 Test Loss: 4.272 Test Acc: 0.279
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.8344402313232422
Epoch: 46, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.284 Vali Acc: 0.280 Test Loss: 4.284 Test Acc: 0.280
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.7991724014282227
Epoch: 47, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.286 Vali Acc: 0.279 Test Loss: 4.286 Test Acc: 0.279
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 0.776252031326294
Epoch: 48, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.314 Vali Acc: 0.279 Test Loss: 4.314 Test Acc: 0.279
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps38_str19_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2811764705882353
model parameter : 588570
model size : 2.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.1621029376983643
Epoch: 1, Steps: 10 | Train Loss: 3.417 Vali Loss: 3.267 Vali Acc: 0.059 Test Loss: 3.267 Test Acc: 0.059
Validation loss decreased (inf --> -0.058791).  Saving model ...
Epoch: 2 cost time: 0.7812280654907227
Epoch: 2, Steps: 10 | Train Loss: 2.635 Vali Loss: 3.286 Vali Acc: 0.118 Test Loss: 3.286 Test Acc: 0.118
Validation loss decreased (-0.058791 --> -0.117614).  Saving model ...
Epoch: 3 cost time: 0.7900955677032471
Epoch: 3, Steps: 10 | Train Loss: 1.603 Vali Loss: 3.192 Vali Acc: 0.205 Test Loss: 3.192 Test Acc: 0.205
Validation loss decreased (-0.117614 --> -0.204674).  Saving model ...
Epoch: 4 cost time: 0.7933375835418701
Epoch: 4, Steps: 10 | Train Loss: 0.785 Vali Loss: 3.321 Vali Acc: 0.225 Test Loss: 3.321 Test Acc: 0.225
Validation loss decreased (-0.204674 --> -0.224673).  Saving model ...
Epoch: 5 cost time: 0.7669885158538818
Epoch: 5, Steps: 10 | Train Loss: 0.341 Vali Loss: 3.608 Vali Acc: 0.234 Test Loss: 3.608 Test Acc: 0.234
Validation loss decreased (-0.224673 --> -0.234082).  Saving model ...
Epoch: 6 cost time: 0.7537631988525391
Epoch: 6, Steps: 10 | Train Loss: 0.131 Vali Loss: 3.877 Vali Acc: 0.248 Test Loss: 3.877 Test Acc: 0.248
Validation loss decreased (-0.234082 --> -0.248197).  Saving model ...
Epoch: 7 cost time: 0.7484285831451416
Epoch: 7, Steps: 10 | Train Loss: 0.056 Vali Loss: 3.981 Vali Acc: 0.281 Test Loss: 3.981 Test Acc: 0.281
Validation loss decreased (-0.248197 --> -0.281137).  Saving model ...
Epoch: 8 cost time: 0.7732083797454834
Epoch: 8, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.057 Vali Acc: 0.264 Test Loss: 4.057 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7215235233306885
Epoch: 9, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.381 Vali Acc: 0.238 Test Loss: 4.381 Test Acc: 0.238
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.781867265701294
Epoch: 10, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.362 Vali Acc: 0.254 Test Loss: 4.362 Test Acc: 0.254
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.7644009590148926
Epoch: 11, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.341 Vali Acc: 0.268 Test Loss: 4.341 Test Acc: 0.268
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.7828991413116455
Epoch: 12, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.368 Vali Acc: 0.269 Test Loss: 4.368 Test Acc: 0.269
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.7644860744476318
Epoch: 13, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.405 Vali Acc: 0.265 Test Loss: 4.405 Test Acc: 0.265
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.7164328098297119
Epoch: 14, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.446 Vali Acc: 0.262 Test Loss: 4.446 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.7469949722290039
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.467 Vali Acc: 0.267 Test Loss: 4.467 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.7344646453857422
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.484 Vali Acc: 0.262 Test Loss: 4.484 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.7491152286529541
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.518 Vali Acc: 0.265 Test Loss: 4.518 Test Acc: 0.265
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2811764705882353
model parameter : 870554
model size : 3.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.889631986618042
Epoch: 1, Steps: 10 | Train Loss: 3.345 Vali Loss: 3.261 Vali Acc: 0.058 Test Loss: 3.261 Test Acc: 0.058
Validation loss decreased (inf --> -0.057614).  Saving model ...
Epoch: 2 cost time: 0.7638900279998779
Epoch: 2, Steps: 10 | Train Loss: 2.889 Vali Loss: 3.248 Vali Acc: 0.096 Test Loss: 3.248 Test Acc: 0.096
Validation loss decreased (-0.057614 --> -0.096438).  Saving model ...
Epoch: 3 cost time: 0.7320291996002197
Epoch: 3, Steps: 10 | Train Loss: 2.250 Vali Loss: 3.215 Vali Acc: 0.164 Test Loss: 3.215 Test Acc: 0.164
Validation loss decreased (-0.096438 --> -0.163497).  Saving model ...
Epoch: 4 cost time: 0.7144782543182373
Epoch: 4, Steps: 10 | Train Loss: 1.540 Vali Loss: 3.165 Vali Acc: 0.198 Test Loss: 3.165 Test Acc: 0.198
Validation loss decreased (-0.163497 --> -0.197615).  Saving model ...
Epoch: 5 cost time: 0.72296142578125
Epoch: 5, Steps: 10 | Train Loss: 0.984 Vali Loss: 3.225 Vali Acc: 0.218 Test Loss: 3.225 Test Acc: 0.218
Validation loss decreased (-0.197615 --> -0.217615).  Saving model ...
Epoch: 6 cost time: 0.7521743774414062
Epoch: 6, Steps: 10 | Train Loss: 0.582 Vali Loss: 3.343 Vali Acc: 0.232 Test Loss: 3.343 Test Acc: 0.232
Validation loss decreased (-0.217615 --> -0.231731).  Saving model ...
Epoch: 7 cost time: 0.7233860492706299
Epoch: 7, Steps: 10 | Train Loss: 0.330 Vali Loss: 3.471 Vali Acc: 0.261 Test Loss: 3.471 Test Acc: 0.261
Validation loss decreased (-0.231731 --> -0.261142).  Saving model ...
Epoch: 8 cost time: 0.7567198276519775
Epoch: 8, Steps: 10 | Train Loss: 0.195 Vali Loss: 3.629 Vali Acc: 0.264 Test Loss: 3.629 Test Acc: 0.264
Validation loss decreased (-0.261142 --> -0.263493).  Saving model ...
Epoch: 9 cost time: 0.7684481143951416
Epoch: 9, Steps: 10 | Train Loss: 0.093 Vali Loss: 3.817 Vali Acc: 0.242 Test Loss: 3.817 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7273659706115723
Epoch: 10, Steps: 10 | Train Loss: 0.053 Vali Loss: 3.864 Vali Acc: 0.260 Test Loss: 3.864 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7415506839752197
Epoch: 11, Steps: 10 | Train Loss: 0.033 Vali Loss: 3.962 Vali Acc: 0.256 Test Loss: 3.962 Test Acc: 0.256
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.7072114944458008
Epoch: 12, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.106 Vali Acc: 0.244 Test Loss: 4.106 Test Acc: 0.244
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.7159745693206787
Epoch: 13, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.057 Vali Acc: 0.265 Test Loss: 4.057 Test Acc: 0.265
Validation loss decreased (-0.263493 --> -0.264665).  Saving model ...
Epoch: 14 cost time: 0.7290158271789551
Epoch: 14, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.083 Vali Acc: 0.268 Test Loss: 4.083 Test Acc: 0.268
Validation loss decreased (-0.264665 --> -0.268194).  Saving model ...
Epoch: 15 cost time: 0.7379672527313232
Epoch: 15, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.101 Vali Acc: 0.269 Test Loss: 4.101 Test Acc: 0.269
Validation loss decreased (-0.268194 --> -0.269371).  Saving model ...
Epoch: 16 cost time: 0.7442882061004639
Epoch: 16, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.131 Vali Acc: 0.264 Test Loss: 4.131 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7643318176269531
Epoch: 17, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.172 Vali Acc: 0.259 Test Loss: 4.172 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7525808811187744
Epoch: 18, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.213 Vali Acc: 0.262 Test Loss: 4.213 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.7646784782409668
Epoch: 19, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.225 Vali Acc: 0.264 Test Loss: 4.225 Test Acc: 0.264
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.7594516277313232
Epoch: 20, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.239 Vali Acc: 0.265 Test Loss: 4.239 Test Acc: 0.265
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.7662534713745117
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.267 Vali Acc: 0.264 Test Loss: 4.267 Test Acc: 0.264
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.7648665904998779
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.289 Vali Acc: 0.265 Test Loss: 4.289 Test Acc: 0.265
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.7445850372314453
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.298 Vali Acc: 0.267 Test Loss: 4.298 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.823136568069458
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.317 Vali Acc: 0.267 Test Loss: 4.317 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.8502230644226074
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.344 Vali Acc: 0.264 Test Loss: 4.344 Test Acc: 0.264
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26941176470588235
model parameter : 491674
model size : 1.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps12_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.8483545780181885
Epoch: 1, Steps: 10 | Train Loss: 3.398 Vali Loss: 3.283 Vali Acc: 0.031 Test Loss: 3.283 Test Acc: 0.031
Validation loss decreased (inf --> -0.030555).  Saving model ...
Epoch: 2 cost time: 0.7277486324310303
Epoch: 2, Steps: 10 | Train Loss: 3.076 Vali Loss: 3.273 Vali Acc: 0.072 Test Loss: 3.273 Test Acc: 0.072
Validation loss decreased (-0.030555 --> -0.071732).  Saving model ...
Epoch: 3 cost time: 0.7053327560424805
Epoch: 3, Steps: 10 | Train Loss: 2.583 Vali Loss: 3.265 Vali Acc: 0.134 Test Loss: 3.265 Test Acc: 0.134
Validation loss decreased (-0.071732 --> -0.134085).  Saving model ...
Epoch: 4 cost time: 0.6711673736572266
Epoch: 4, Steps: 10 | Train Loss: 2.078 Vali Loss: 3.223 Vali Acc: 0.166 Test Loss: 3.223 Test Acc: 0.166
Validation loss decreased (-0.134085 --> -0.165850).  Saving model ...
Epoch: 5 cost time: 0.6670942306518555
Epoch: 5, Steps: 10 | Train Loss: 1.590 Vali Loss: 3.182 Vali Acc: 0.186 Test Loss: 3.182 Test Acc: 0.186
Validation loss decreased (-0.165850 --> -0.185851).  Saving model ...
Epoch: 6 cost time: 0.6765811443328857
Epoch: 6, Steps: 10 | Train Loss: 1.120 Vali Loss: 3.205 Vali Acc: 0.207 Test Loss: 3.205 Test Acc: 0.207
Validation loss decreased (-0.185851 --> -0.207027).  Saving model ...
Epoch: 7 cost time: 0.6688475608825684
Epoch: 7, Steps: 10 | Train Loss: 0.748 Vali Loss: 3.261 Vali Acc: 0.224 Test Loss: 3.261 Test Acc: 0.224
Validation loss decreased (-0.207027 --> -0.223497).  Saving model ...
Epoch: 8 cost time: 0.7289390563964844
Epoch: 8, Steps: 10 | Train Loss: 0.470 Vali Loss: 3.361 Vali Acc: 0.232 Test Loss: 3.361 Test Acc: 0.232
Validation loss decreased (-0.223497 --> -0.231731).  Saving model ...
Epoch: 9 cost time: 0.6792774200439453
Epoch: 9, Steps: 10 | Train Loss: 0.297 Vali Loss: 3.485 Vali Acc: 0.245 Test Loss: 3.485 Test Acc: 0.245
Validation loss decreased (-0.231731 --> -0.244671).  Saving model ...
Epoch: 10 cost time: 0.6861193180084229
Epoch: 10, Steps: 10 | Train Loss: 0.181 Vali Loss: 3.588 Vali Acc: 0.247 Test Loss: 3.588 Test Acc: 0.247
Validation loss decreased (-0.244671 --> -0.247023).  Saving model ...
Epoch: 11 cost time: 0.6829278469085693
Epoch: 11, Steps: 10 | Train Loss: 0.103 Vali Loss: 3.717 Vali Acc: 0.251 Test Loss: 3.717 Test Acc: 0.251
Validation loss decreased (-0.247023 --> -0.250551).  Saving model ...
Epoch: 12 cost time: 0.6963818073272705
Epoch: 12, Steps: 10 | Train Loss: 0.070 Vali Loss: 3.787 Vali Acc: 0.252 Test Loss: 3.787 Test Acc: 0.252
Validation loss decreased (-0.250551 --> -0.251727).  Saving model ...
Epoch: 13 cost time: 0.6725356578826904
Epoch: 13, Steps: 10 | Train Loss: 0.053 Vali Loss: 3.802 Vali Acc: 0.255 Test Loss: 3.802 Test Acc: 0.255
Validation loss decreased (-0.251727 --> -0.255256).  Saving model ...
Epoch: 14 cost time: 0.6689975261688232
Epoch: 14, Steps: 10 | Train Loss: 0.035 Vali Loss: 3.893 Vali Acc: 0.251 Test Loss: 3.893 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6907515525817871
Epoch: 15, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.900 Vali Acc: 0.258 Test Loss: 3.900 Test Acc: 0.258
Validation loss decreased (-0.255256 --> -0.257608).  Saving model ...
Epoch: 16 cost time: 0.6585235595703125
Epoch: 16, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.916 Vali Acc: 0.259 Test Loss: 3.916 Test Acc: 0.259
Validation loss decreased (-0.257608 --> -0.258784).  Saving model ...
Epoch: 17 cost time: 0.7321376800537109
Epoch: 17, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.964 Vali Acc: 0.256 Test Loss: 3.964 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.706456184387207
Epoch: 18, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.016 Vali Acc: 0.259 Test Loss: 4.016 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6951961517333984
Epoch: 19, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.052 Vali Acc: 0.262 Test Loss: 4.052 Test Acc: 0.262
Validation loss decreased (-0.258784 --> -0.262312).  Saving model ...
Epoch: 20 cost time: 0.6961169242858887
Epoch: 20, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.068 Vali Acc: 0.262 Test Loss: 4.068 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6765413284301758
Epoch: 21, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.099 Vali Acc: 0.261 Test Loss: 4.099 Test Acc: 0.261
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.684516429901123
Epoch: 22, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.121 Vali Acc: 0.264 Test Loss: 4.121 Test Acc: 0.264
Validation loss decreased (-0.262312 --> -0.263488).  Saving model ...
Epoch: 23 cost time: 0.7013213634490967
Epoch: 23, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.140 Vali Acc: 0.256 Test Loss: 4.140 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7505178451538086
Epoch: 24, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.191 Vali Acc: 0.256 Test Loss: 4.191 Test Acc: 0.256
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.6885764598846436
Epoch: 25, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.199 Vali Acc: 0.260 Test Loss: 4.199 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.6907610893249512
Epoch: 26, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.211 Vali Acc: 0.260 Test Loss: 4.211 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.7013547420501709
Epoch: 27, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.228 Vali Acc: 0.261 Test Loss: 4.228 Test Acc: 0.261
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.6815552711486816
Epoch: 28, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.254 Vali Acc: 0.262 Test Loss: 4.254 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.6619317531585693
Epoch: 29, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.288 Vali Acc: 0.264 Test Loss: 4.288 Test Acc: 0.264
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.69716477394104
Epoch: 30, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.301 Vali Acc: 0.260 Test Loss: 4.301 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.7117412090301514
Epoch: 31, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.335 Vali Acc: 0.260 Test Loss: 4.335 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.6881933212280273
Epoch: 32, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.355 Vali Acc: 0.262 Test Loss: 4.355 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps12_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2635294117647059
model parameter : 362394
model size : 1.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.8521673679351807
Epoch: 1, Steps: 10 | Train Loss: 3.331 Vali Loss: 3.271 Vali Acc: 0.051 Test Loss: 3.271 Test Acc: 0.051
Validation loss decreased (inf --> -0.050556).  Saving model ...
Epoch: 2 cost time: 0.6709864139556885
Epoch: 2, Steps: 10 | Train Loss: 3.116 Vali Loss: 3.265 Vali Acc: 0.076 Test Loss: 3.265 Test Acc: 0.076
Validation loss decreased (-0.050556 --> -0.076438).  Saving model ...
Epoch: 3 cost time: 0.7069473266601562
Epoch: 3, Steps: 10 | Train Loss: 2.714 Vali Loss: 3.274 Vali Acc: 0.104 Test Loss: 3.274 Test Acc: 0.104
Validation loss decreased (-0.076438 --> -0.103497).  Saving model ...
Epoch: 4 cost time: 0.708174467086792
Epoch: 4, Steps: 10 | Train Loss: 2.322 Vali Loss: 3.252 Vali Acc: 0.139 Test Loss: 3.252 Test Acc: 0.139
Validation loss decreased (-0.103497 --> -0.138791).  Saving model ...
Epoch: 5 cost time: 0.6886920928955078
Epoch: 5, Steps: 10 | Train Loss: 1.831 Vali Loss: 3.204 Vali Acc: 0.171 Test Loss: 3.204 Test Acc: 0.171
Validation loss decreased (-0.138791 --> -0.170556).  Saving model ...
Epoch: 6 cost time: 0.6922483444213867
Epoch: 6, Steps: 10 | Train Loss: 1.434 Vali Loss: 3.179 Vali Acc: 0.195 Test Loss: 3.179 Test Acc: 0.195
Validation loss decreased (-0.170556 --> -0.195262).  Saving model ...
Epoch: 7 cost time: 0.700458288192749
Epoch: 7, Steps: 10 | Train Loss: 1.075 Vali Loss: 3.208 Vali Acc: 0.214 Test Loss: 3.208 Test Acc: 0.214
Validation loss decreased (-0.195262 --> -0.214086).  Saving model ...
Epoch: 8 cost time: 0.7012460231781006
Epoch: 8, Steps: 10 | Train Loss: 0.750 Vali Loss: 3.266 Vali Acc: 0.231 Test Loss: 3.266 Test Acc: 0.231
Validation loss decreased (-0.214086 --> -0.230556).  Saving model ...
Epoch: 9 cost time: 0.698918342590332
Epoch: 9, Steps: 10 | Train Loss: 0.554 Vali Loss: 3.317 Vali Acc: 0.247 Test Loss: 3.317 Test Acc: 0.247
Validation loss decreased (-0.230556 --> -0.247026).  Saving model ...
Epoch: 10 cost time: 0.6574516296386719
Epoch: 10, Steps: 10 | Train Loss: 0.382 Vali Loss: 3.406 Vali Acc: 0.249 Test Loss: 3.406 Test Acc: 0.249
Validation loss decreased (-0.247026 --> -0.249378).  Saving model ...
Epoch: 11 cost time: 0.6652424335479736
Epoch: 11, Steps: 10 | Train Loss: 0.254 Vali Loss: 3.523 Vali Acc: 0.256 Test Loss: 3.523 Test Acc: 0.256
Validation loss decreased (-0.249378 --> -0.256435).  Saving model ...
Epoch: 12 cost time: 0.6573197841644287
Epoch: 12, Steps: 10 | Train Loss: 0.161 Vali Loss: 3.526 Vali Acc: 0.254 Test Loss: 3.526 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6885495185852051
Epoch: 13, Steps: 10 | Train Loss: 0.106 Vali Loss: 3.591 Vali Acc: 0.262 Test Loss: 3.591 Test Acc: 0.262
Validation loss decreased (-0.256435 --> -0.262317).  Saving model ...
Epoch: 14 cost time: 0.626523494720459
Epoch: 14, Steps: 10 | Train Loss: 0.080 Vali Loss: 3.710 Vali Acc: 0.255 Test Loss: 3.710 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6815364360809326
Epoch: 15, Steps: 10 | Train Loss: 0.058 Vali Loss: 3.755 Vali Acc: 0.251 Test Loss: 3.755 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.685173511505127
Epoch: 16, Steps: 10 | Train Loss: 0.044 Vali Loss: 3.774 Vali Acc: 0.261 Test Loss: 3.774 Test Acc: 0.261
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.7116258144378662
Epoch: 17, Steps: 10 | Train Loss: 0.038 Vali Loss: 3.808 Vali Acc: 0.266 Test Loss: 3.808 Test Acc: 0.266
Validation loss decreased (-0.262317 --> -0.265844).  Saving model ...
Epoch: 18 cost time: 0.6993427276611328
Epoch: 18, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.855 Vali Acc: 0.258 Test Loss: 3.855 Test Acc: 0.258
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6835246086120605
Epoch: 19, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.884 Vali Acc: 0.264 Test Loss: 3.884 Test Acc: 0.264
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7163081169128418
Epoch: 20, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.923 Vali Acc: 0.262 Test Loss: 3.923 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.7831740379333496
Epoch: 21, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.942 Vali Acc: 0.266 Test Loss: 3.942 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.7443478107452393
Epoch: 22, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.969 Vali Acc: 0.265 Test Loss: 3.969 Test Acc: 0.265
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.7325336933135986
Epoch: 23, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.990 Vali Acc: 0.273 Test Loss: 3.990 Test Acc: 0.273
Validation loss decreased (-0.265844 --> -0.272901).  Saving model ...
Epoch: 24 cost time: 0.75522780418396
Epoch: 24, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.013 Vali Acc: 0.268 Test Loss: 4.013 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7507948875427246
Epoch: 25, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.027 Vali Acc: 0.271 Test Loss: 4.027 Test Acc: 0.271
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.7789292335510254
Epoch: 26, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.063 Vali Acc: 0.267 Test Loss: 4.063 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.7835121154785156
Epoch: 27, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.091 Vali Acc: 0.266 Test Loss: 4.091 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.7515089511871338
Epoch: 28, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.115 Vali Acc: 0.262 Test Loss: 4.115 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.7782900333404541
Epoch: 29, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.137 Vali Acc: 0.267 Test Loss: 4.137 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.7702412605285645
Epoch: 30, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.149 Vali Acc: 0.265 Test Loss: 4.149 Test Acc: 0.265
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.7254383563995361
Epoch: 31, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.169 Vali Acc: 0.267 Test Loss: 4.169 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.7620208263397217
Epoch: 32, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.186 Vali Acc: 0.268 Test Loss: 4.186 Test Acc: 0.268
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.7419168949127197
Epoch: 33, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.215 Vali Acc: 0.269 Test Loss: 4.215 Test Acc: 0.269
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27294117647058824
model parameter : 303002
model size : 1.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps23_str12_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.8699493408203125
Epoch: 1, Steps: 10 | Train Loss: 3.354 Vali Loss: 3.291 Vali Acc: 0.027 Test Loss: 3.291 Test Acc: 0.027
Validation loss decreased (inf --> -0.027026).  Saving model ...
Epoch: 2 cost time: 0.6984317302703857
Epoch: 2, Steps: 10 | Train Loss: 3.188 Vali Loss: 3.272 Vali Acc: 0.045 Test Loss: 3.272 Test Acc: 0.045
Validation loss decreased (-0.027026 --> -0.044673).  Saving model ...
Epoch: 3 cost time: 0.6968240737915039
Epoch: 3, Steps: 10 | Train Loss: 2.905 Vali Loss: 3.268 Vali Acc: 0.073 Test Loss: 3.268 Test Acc: 0.073
Validation loss decreased (-0.044673 --> -0.072908).  Saving model ...
Epoch: 4 cost time: 0.7464966773986816
Epoch: 4, Steps: 10 | Train Loss: 2.554 Vali Loss: 3.255 Vali Acc: 0.096 Test Loss: 3.255 Test Acc: 0.096
Validation loss decreased (-0.072908 --> -0.096438).  Saving model ...
Epoch: 5 cost time: 0.6946659088134766
Epoch: 5, Steps: 10 | Train Loss: 2.257 Vali Loss: 3.222 Vali Acc: 0.125 Test Loss: 3.222 Test Acc: 0.125
Validation loss decreased (-0.096438 --> -0.124674).  Saving model ...
Epoch: 6 cost time: 0.6867058277130127
Epoch: 6, Steps: 10 | Train Loss: 1.895 Vali Loss: 3.192 Vali Acc: 0.141 Test Loss: 3.192 Test Acc: 0.141
Validation loss decreased (-0.124674 --> -0.141145).  Saving model ...
Epoch: 7 cost time: 0.6790001392364502
Epoch: 7, Steps: 10 | Train Loss: 1.564 Vali Loss: 3.171 Vali Acc: 0.166 Test Loss: 3.171 Test Acc: 0.166
Validation loss decreased (-0.141145 --> -0.165851).  Saving model ...
Epoch: 8 cost time: 0.678520679473877
Epoch: 8, Steps: 10 | Train Loss: 1.302 Vali Loss: 3.168 Vali Acc: 0.191 Test Loss: 3.168 Test Acc: 0.191
Validation loss decreased (-0.165851 --> -0.190557).  Saving model ...
Epoch: 9 cost time: 0.6733582019805908
Epoch: 9, Steps: 10 | Train Loss: 1.031 Vali Loss: 3.167 Vali Acc: 0.205 Test Loss: 3.167 Test Acc: 0.205
Validation loss decreased (-0.190557 --> -0.204674).  Saving model ...
Epoch: 10 cost time: 0.7042417526245117
Epoch: 10, Steps: 10 | Train Loss: 0.808 Vali Loss: 3.226 Vali Acc: 0.224 Test Loss: 3.226 Test Acc: 0.224
Validation loss decreased (-0.204674 --> -0.223497).  Saving model ...
Epoch: 11 cost time: 0.7077744007110596
Epoch: 11, Steps: 10 | Train Loss: 0.627 Vali Loss: 3.243 Vali Acc: 0.233 Test Loss: 3.243 Test Acc: 0.233
Validation loss decreased (-0.223497 --> -0.232909).  Saving model ...
Epoch: 12 cost time: 0.6962018013000488
Epoch: 12, Steps: 10 | Train Loss: 0.456 Vali Loss: 3.294 Vali Acc: 0.242 Test Loss: 3.294 Test Acc: 0.242
Validation loss decreased (-0.232909 --> -0.242320).  Saving model ...
Epoch: 13 cost time: 0.6662552356719971
Epoch: 13, Steps: 10 | Train Loss: 0.344 Vali Loss: 3.333 Vali Acc: 0.254 Test Loss: 3.333 Test Acc: 0.254
Validation loss decreased (-0.242320 --> -0.254084).  Saving model ...
Epoch: 14 cost time: 0.6909513473510742
Epoch: 14, Steps: 10 | Train Loss: 0.238 Vali Loss: 3.391 Vali Acc: 0.269 Test Loss: 3.391 Test Acc: 0.269
Validation loss decreased (-0.254084 --> -0.269378).  Saving model ...
Epoch: 15 cost time: 0.7133455276489258
Epoch: 15, Steps: 10 | Train Loss: 0.183 Vali Loss: 3.438 Vali Acc: 0.266 Test Loss: 3.438 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7011444568634033
Epoch: 16, Steps: 10 | Train Loss: 0.135 Vali Loss: 3.503 Vali Acc: 0.261 Test Loss: 3.503 Test Acc: 0.261
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.6623392105102539
Epoch: 17, Steps: 10 | Train Loss: 0.108 Vali Loss: 3.535 Vali Acc: 0.256 Test Loss: 3.535 Test Acc: 0.256
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.6915478706359863
Epoch: 18, Steps: 10 | Train Loss: 0.086 Vali Loss: 3.558 Vali Acc: 0.268 Test Loss: 3.558 Test Acc: 0.268
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.6181380748748779
Epoch: 19, Steps: 10 | Train Loss: 0.069 Vali Loss: 3.595 Vali Acc: 0.261 Test Loss: 3.595 Test Acc: 0.261
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.7115311622619629
Epoch: 20, Steps: 10 | Train Loss: 0.060 Vali Loss: 3.640 Vali Acc: 0.265 Test Loss: 3.640 Test Acc: 0.265
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.6623373031616211
Epoch: 21, Steps: 10 | Train Loss: 0.052 Vali Loss: 3.663 Vali Acc: 0.261 Test Loss: 3.663 Test Acc: 0.261
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.6821269989013672
Epoch: 22, Steps: 10 | Train Loss: 0.045 Vali Loss: 3.683 Vali Acc: 0.266 Test Loss: 3.683 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.6813778877258301
Epoch: 23, Steps: 10 | Train Loss: 0.038 Vali Loss: 3.707 Vali Acc: 0.268 Test Loss: 3.707 Test Acc: 0.268
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.7069952487945557
Epoch: 24, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.725 Vali Acc: 0.272 Test Loss: 3.725 Test Acc: 0.272
Validation loss decreased (-0.269378 --> -0.271727).  Saving model ...
Epoch: 25 cost time: 0.6786317825317383
Epoch: 25, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.749 Vali Acc: 0.269 Test Loss: 3.749 Test Acc: 0.269
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6799106597900391
Epoch: 26, Steps: 10 | Train Loss: 0.027 Vali Loss: 3.764 Vali Acc: 0.275 Test Loss: 3.764 Test Acc: 0.275
Validation loss decreased (-0.271727 --> -0.275256).  Saving model ...
Epoch: 27 cost time: 0.6655900478363037
Epoch: 27, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.782 Vali Acc: 0.278 Test Loss: 3.782 Test Acc: 0.278
Validation loss decreased (-0.275256 --> -0.277609).  Saving model ...
Epoch: 28 cost time: 0.7027580738067627
Epoch: 28, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.798 Vali Acc: 0.275 Test Loss: 3.798 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6897463798522949
Epoch: 29, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.821 Vali Acc: 0.276 Test Loss: 3.821 Test Acc: 0.276
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.6570603847503662
Epoch: 30, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.854 Vali Acc: 0.278 Test Loss: 3.854 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.6972255706787109
Epoch: 31, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.874 Vali Acc: 0.278 Test Loss: 3.874 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.6878261566162109
Epoch: 32, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.896 Vali Acc: 0.273 Test Loss: 3.896 Test Acc: 0.273
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.7033224105834961
Epoch: 33, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.902 Vali Acc: 0.274 Test Loss: 3.902 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.7012617588043213
Epoch: 34, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.918 Vali Acc: 0.274 Test Loss: 3.918 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.6724047660827637
Epoch: 35, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.943 Vali Acc: 0.279 Test Loss: 3.943 Test Acc: 0.279
Validation loss decreased (-0.277609 --> -0.278784).  Saving model ...
Epoch: 36 cost time: 0.6823410987854004
Epoch: 36, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.955 Vali Acc: 0.281 Test Loss: 3.955 Test Acc: 0.281
Validation loss decreased (-0.278784 --> -0.281137).  Saving model ...
Epoch: 37 cost time: 0.6735103130340576
Epoch: 37, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.978 Vali Acc: 0.278 Test Loss: 3.978 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.6572034358978271
Epoch: 38, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.993 Vali Acc: 0.278 Test Loss: 3.993 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.7220458984375
Epoch: 39, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.018 Vali Acc: 0.276 Test Loss: 4.018 Test Acc: 0.276
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.7005400657653809
Epoch: 40, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.036 Vali Acc: 0.276 Test Loss: 4.036 Test Acc: 0.276
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.7145872116088867
Epoch: 41, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.047 Vali Acc: 0.278 Test Loss: 4.047 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.7220346927642822
Epoch: 42, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.050 Vali Acc: 0.281 Test Loss: 4.050 Test Acc: 0.281
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.7100381851196289
Epoch: 43, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.079 Vali Acc: 0.282 Test Loss: 4.079 Test Acc: 0.282
Validation loss decreased (-0.281137 --> -0.282312).  Saving model ...
Epoch: 44 cost time: 0.7152547836303711
Epoch: 44, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.101 Vali Acc: 0.281 Test Loss: 4.101 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.6744790077209473
Epoch: 45, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.110 Vali Acc: 0.282 Test Loss: 4.110 Test Acc: 0.282
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.6890859603881836
Epoch: 46, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.132 Vali Acc: 0.284 Test Loss: 4.132 Test Acc: 0.284
Validation loss decreased (-0.282312 --> -0.283488).  Saving model ...
Epoch: 47 cost time: 0.6379172801971436
Epoch: 47, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.149 Vali Acc: 0.281 Test Loss: 4.149 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.6489503383636475
Epoch: 48, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.162 Vali Acc: 0.281 Test Loss: 4.162 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.6945197582244873
Epoch: 49, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.183 Vali Acc: 0.278 Test Loss: 4.183 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.7313134670257568
Epoch: 50, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.182 Vali Acc: 0.280 Test Loss: 4.182 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps23_str12_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.28352941176470586
model parameter : 234010
model size : 0.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.9199576377868652
Epoch: 1, Steps: 10 | Train Loss: 3.331 Vali Loss: 3.289 Vali Acc: 0.042 Test Loss: 3.289 Test Acc: 0.042
Validation loss decreased (inf --> -0.042320).  Saving model ...
Epoch: 2 cost time: 0.705113410949707
Epoch: 2, Steps: 10 | Train Loss: 3.213 Vali Loss: 3.276 Vali Acc: 0.049 Test Loss: 3.276 Test Acc: 0.049
Validation loss decreased (-0.042320 --> -0.049379).  Saving model ...
Epoch: 3 cost time: 0.6746881008148193
Epoch: 3, Steps: 10 | Train Loss: 2.967 Vali Loss: 3.257 Vali Acc: 0.081 Test Loss: 3.257 Test Acc: 0.081
Validation loss decreased (-0.049379 --> -0.081144).  Saving model ...
Epoch: 4 cost time: 0.6673774719238281
Epoch: 4, Steps: 10 | Train Loss: 2.730 Vali Loss: 3.248 Vali Acc: 0.105 Test Loss: 3.248 Test Acc: 0.105
Validation loss decreased (-0.081144 --> -0.104673).  Saving model ...
Epoch: 5 cost time: 0.652214765548706
Epoch: 5, Steps: 10 | Train Loss: 2.471 Vali Loss: 3.232 Vali Acc: 0.115 Test Loss: 3.232 Test Acc: 0.115
Validation loss decreased (-0.104673 --> -0.115262).  Saving model ...
Epoch: 6 cost time: 0.6593930721282959
Epoch: 6, Steps: 10 | Train Loss: 2.156 Vali Loss: 3.201 Vali Acc: 0.140 Test Loss: 3.201 Test Acc: 0.140
Validation loss decreased (-0.115262 --> -0.139968).  Saving model ...
Epoch: 7 cost time: 0.6655430793762207
Epoch: 7, Steps: 10 | Train Loss: 1.895 Vali Loss: 3.180 Vali Acc: 0.156 Test Loss: 3.180 Test Acc: 0.156
Validation loss decreased (-0.139968 --> -0.156439).  Saving model ...
Epoch: 8 cost time: 0.6834349632263184
Epoch: 8, Steps: 10 | Train Loss: 1.665 Vali Loss: 3.158 Vali Acc: 0.175 Test Loss: 3.158 Test Acc: 0.175
Validation loss decreased (-0.156439 --> -0.175263).  Saving model ...
Epoch: 9 cost time: 0.7003166675567627
Epoch: 9, Steps: 10 | Train Loss: 1.430 Vali Loss: 3.149 Vali Acc: 0.192 Test Loss: 3.149 Test Acc: 0.192
Validation loss decreased (-0.175263 --> -0.191733).  Saving model ...
Epoch: 10 cost time: 0.7016282081604004
Epoch: 10, Steps: 10 | Train Loss: 1.160 Vali Loss: 3.159 Vali Acc: 0.204 Test Loss: 3.159 Test Acc: 0.204
Validation loss decreased (-0.191733 --> -0.203498).  Saving model ...
Epoch: 11 cost time: 0.6829497814178467
Epoch: 11, Steps: 10 | Train Loss: 0.950 Vali Loss: 3.170 Vali Acc: 0.215 Test Loss: 3.170 Test Acc: 0.215
Validation loss decreased (-0.203498 --> -0.215262).  Saving model ...
Epoch: 12 cost time: 0.6806244850158691
Epoch: 12, Steps: 10 | Train Loss: 0.765 Vali Loss: 3.197 Vali Acc: 0.221 Test Loss: 3.197 Test Acc: 0.221
Validation loss decreased (-0.215262 --> -0.221144).  Saving model ...
Epoch: 13 cost time: 0.6702110767364502
Epoch: 13, Steps: 10 | Train Loss: 0.588 Vali Loss: 3.253 Vali Acc: 0.226 Test Loss: 3.253 Test Acc: 0.226
Validation loss decreased (-0.221144 --> -0.225850).  Saving model ...
Epoch: 14 cost time: 0.6766226291656494
Epoch: 14, Steps: 10 | Train Loss: 0.480 Vali Loss: 3.274 Vali Acc: 0.234 Test Loss: 3.274 Test Acc: 0.234
Validation loss decreased (-0.225850 --> -0.234085).  Saving model ...
Epoch: 15 cost time: 0.6538732051849365
Epoch: 15, Steps: 10 | Train Loss: 0.367 Vali Loss: 3.315 Vali Acc: 0.241 Test Loss: 3.315 Test Acc: 0.241
Validation loss decreased (-0.234085 --> -0.241143).  Saving model ...
Epoch: 16 cost time: 0.6353778839111328
Epoch: 16, Steps: 10 | Train Loss: 0.299 Vali Loss: 3.372 Vali Acc: 0.245 Test Loss: 3.372 Test Acc: 0.245
Validation loss decreased (-0.241143 --> -0.244672).  Saving model ...
Epoch: 17 cost time: 0.6812422275543213
Epoch: 17, Steps: 10 | Train Loss: 0.224 Vali Loss: 3.410 Vali Acc: 0.244 Test Loss: 3.410 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7027194499969482
Epoch: 18, Steps: 10 | Train Loss: 0.174 Vali Loss: 3.440 Vali Acc: 0.249 Test Loss: 3.440 Test Acc: 0.249
Validation loss decreased (-0.244672 --> -0.249377).  Saving model ...
Epoch: 19 cost time: 0.6646418571472168
Epoch: 19, Steps: 10 | Train Loss: 0.137 Vali Loss: 3.493 Vali Acc: 0.251 Test Loss: 3.493 Test Acc: 0.251
Validation loss decreased (-0.249377 --> -0.250553).  Saving model ...
Epoch: 20 cost time: 0.6579635143280029
Epoch: 20, Steps: 10 | Train Loss: 0.117 Vali Loss: 3.523 Vali Acc: 0.254 Test Loss: 3.523 Test Acc: 0.254
Validation loss decreased (-0.250553 --> -0.254082).  Saving model ...
Epoch: 21 cost time: 0.6817626953125
Epoch: 21, Steps: 10 | Train Loss: 0.093 Vali Loss: 3.562 Vali Acc: 0.259 Test Loss: 3.562 Test Acc: 0.259
Validation loss decreased (-0.254082 --> -0.258788).  Saving model ...
Epoch: 22 cost time: 0.6682877540588379
Epoch: 22, Steps: 10 | Train Loss: 0.083 Vali Loss: 3.582 Vali Acc: 0.259 Test Loss: 3.582 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6341402530670166
Epoch: 23, Steps: 10 | Train Loss: 0.068 Vali Loss: 3.615 Vali Acc: 0.260 Test Loss: 3.615 Test Acc: 0.260
Validation loss decreased (-0.258788 --> -0.259964).  Saving model ...
Epoch: 24 cost time: 0.7186636924743652
Epoch: 24, Steps: 10 | Train Loss: 0.060 Vali Loss: 3.643 Vali Acc: 0.260 Test Loss: 3.643 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6692361831665039
Epoch: 25, Steps: 10 | Train Loss: 0.053 Vali Loss: 3.645 Vali Acc: 0.265 Test Loss: 3.645 Test Acc: 0.265
Validation loss decreased (-0.259964 --> -0.264669).  Saving model ...
Epoch: 26 cost time: 0.6697187423706055
Epoch: 26, Steps: 10 | Train Loss: 0.044 Vali Loss: 3.675 Vali Acc: 0.261 Test Loss: 3.675 Test Acc: 0.261
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.6686539649963379
Epoch: 27, Steps: 10 | Train Loss: 0.041 Vali Loss: 3.720 Vali Acc: 0.259 Test Loss: 3.720 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.7044210433959961
Epoch: 28, Steps: 10 | Train Loss: 0.036 Vali Loss: 3.745 Vali Acc: 0.264 Test Loss: 3.745 Test Acc: 0.264
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.6730198860168457
Epoch: 29, Steps: 10 | Train Loss: 0.033 Vali Loss: 3.752 Vali Acc: 0.267 Test Loss: 3.752 Test Acc: 0.267
Validation loss decreased (-0.264669 --> -0.267021).  Saving model ...
Epoch: 30 cost time: 0.6396915912628174
Epoch: 30, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.773 Vali Acc: 0.267 Test Loss: 3.773 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.6424071788787842
Epoch: 31, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.803 Vali Acc: 0.265 Test Loss: 3.803 Test Acc: 0.265
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.6533749103546143
Epoch: 32, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.810 Vali Acc: 0.266 Test Loss: 3.810 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.6287841796875
Epoch: 33, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.852 Vali Acc: 0.267 Test Loss: 3.852 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.6569647789001465
Epoch: 34, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.882 Vali Acc: 0.267 Test Loss: 3.882 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.6853420734405518
Epoch: 35, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.915 Vali Acc: 0.269 Test Loss: 3.915 Test Acc: 0.269
Validation loss decreased (-0.267021 --> -0.269373).  Saving model ...
Epoch: 36 cost time: 0.6377866268157959
Epoch: 36, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.936 Vali Acc: 0.269 Test Loss: 3.936 Test Acc: 0.269
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.6811695098876953
Epoch: 37, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.966 Vali Acc: 0.273 Test Loss: 3.966 Test Acc: 0.273
Validation loss decreased (-0.269373 --> -0.272902).  Saving model ...
Epoch: 38 cost time: 0.7651987075805664
Epoch: 38, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.981 Vali Acc: 0.273 Test Loss: 3.981 Test Acc: 0.273
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.667872428894043
Epoch: 39, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.008 Vali Acc: 0.268 Test Loss: 4.008 Test Acc: 0.268
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.7120907306671143
Epoch: 40, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.021 Vali Acc: 0.271 Test Loss: 4.021 Test Acc: 0.271
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.7027127742767334
Epoch: 41, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.042 Vali Acc: 0.273 Test Loss: 4.042 Test Acc: 0.273
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.6642653942108154
Epoch: 42, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.053 Vali Acc: 0.275 Test Loss: 4.053 Test Acc: 0.275
Validation loss decreased (-0.272902 --> -0.275254).  Saving model ...
Epoch: 43 cost time: 0.6276977062225342
Epoch: 43, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.075 Vali Acc: 0.278 Test Loss: 4.075 Test Acc: 0.278
Validation loss decreased (-0.275254 --> -0.277606).  Saving model ...
Epoch: 44 cost time: 0.6770052909851074
Epoch: 44, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.086 Vali Acc: 0.278 Test Loss: 4.086 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.6625094413757324
Epoch: 45, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.088 Vali Acc: 0.279 Test Loss: 4.088 Test Acc: 0.279
Validation loss decreased (-0.277606 --> -0.278783).  Saving model ...
Epoch: 46 cost time: 0.6529550552368164
Epoch: 46, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.115 Vali Acc: 0.280 Test Loss: 4.115 Test Acc: 0.280
Validation loss decreased (-0.278783 --> -0.279959).  Saving model ...
Epoch: 47 cost time: 0.6844265460968018
Epoch: 47, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.131 Vali Acc: 0.276 Test Loss: 4.131 Test Acc: 0.276
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.6757690906524658
Epoch: 48, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.160 Vali Acc: 0.278 Test Loss: 4.160 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.6705973148345947
Epoch: 49, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.168 Vali Acc: 0.275 Test Loss: 4.168 Test Acc: 0.275
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.680943489074707
Epoch: 50, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.194 Vali Acc: 0.272 Test Loss: 4.194 Test Acc: 0.272
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.28
model parameter : 205082
model size : 0.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps38_str19_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.9589455127716064
Epoch: 1, Steps: 10 | Train Loss: 3.341 Vali Loss: 3.280 Vali Acc: 0.047 Test Loss: 3.280 Test Acc: 0.047
Validation loss decreased (inf --> -0.047026).  Saving model ...
Epoch: 2 cost time: 0.6550092697143555
Epoch: 2, Steps: 10 | Train Loss: 3.214 Vali Loss: 3.255 Vali Acc: 0.064 Test Loss: 3.255 Test Acc: 0.064
Validation loss decreased (-0.047026 --> -0.063497).  Saving model ...
Epoch: 3 cost time: 0.6581470966339111
Epoch: 3, Steps: 10 | Train Loss: 2.972 Vali Loss: 3.238 Vali Acc: 0.088 Test Loss: 3.238 Test Acc: 0.088
Validation loss decreased (-0.063497 --> -0.088203).  Saving model ...
Epoch: 4 cost time: 0.6808390617370605
Epoch: 4, Steps: 10 | Train Loss: 2.801 Vali Loss: 3.230 Vali Acc: 0.105 Test Loss: 3.230 Test Acc: 0.105
Validation loss decreased (-0.088203 --> -0.104674).  Saving model ...
Epoch: 5 cost time: 0.6805121898651123
Epoch: 5, Steps: 10 | Train Loss: 2.530 Vali Loss: 3.215 Vali Acc: 0.118 Test Loss: 3.215 Test Acc: 0.118
Validation loss decreased (-0.104674 --> -0.117615).  Saving model ...
Epoch: 6 cost time: 0.6881310939788818
Epoch: 6, Steps: 10 | Train Loss: 2.298 Vali Loss: 3.188 Vali Acc: 0.139 Test Loss: 3.188 Test Acc: 0.139
Validation loss decreased (-0.117615 --> -0.138792).  Saving model ...
Epoch: 7 cost time: 0.6807351112365723
Epoch: 7, Steps: 10 | Train Loss: 2.021 Vali Loss: 3.168 Vali Acc: 0.164 Test Loss: 3.168 Test Acc: 0.164
Validation loss decreased (-0.138792 --> -0.163498).  Saving model ...
Epoch: 8 cost time: 0.6688797473907471
Epoch: 8, Steps: 10 | Train Loss: 1.809 Vali Loss: 3.154 Vali Acc: 0.178 Test Loss: 3.154 Test Acc: 0.178
Validation loss decreased (-0.163498 --> -0.177616).  Saving model ...
Epoch: 9 cost time: 0.6853208541870117
Epoch: 9, Steps: 10 | Train Loss: 1.563 Vali Loss: 3.148 Vali Acc: 0.191 Test Loss: 3.148 Test Acc: 0.191
Validation loss decreased (-0.177616 --> -0.190557).  Saving model ...
Epoch: 10 cost time: 0.6918623447418213
Epoch: 10, Steps: 10 | Train Loss: 1.321 Vali Loss: 3.133 Vali Acc: 0.211 Test Loss: 3.133 Test Acc: 0.211
Validation loss decreased (-0.190557 --> -0.210557).  Saving model ...
Epoch: 11 cost time: 0.6478109359741211
Epoch: 11, Steps: 10 | Train Loss: 1.118 Vali Loss: 3.139 Vali Acc: 0.215 Test Loss: 3.139 Test Acc: 0.215
Validation loss decreased (-0.210557 --> -0.215263).  Saving model ...
Epoch: 12 cost time: 0.6517767906188965
Epoch: 12, Steps: 10 | Train Loss: 0.928 Vali Loss: 3.168 Vali Acc: 0.221 Test Loss: 3.168 Test Acc: 0.221
Validation loss decreased (-0.215263 --> -0.221145).  Saving model ...
Epoch: 13 cost time: 0.6538960933685303
Epoch: 13, Steps: 10 | Train Loss: 0.751 Vali Loss: 3.192 Vali Acc: 0.238 Test Loss: 3.192 Test Acc: 0.238
Validation loss decreased (-0.221145 --> -0.237615).  Saving model ...
Epoch: 14 cost time: 0.6878082752227783
Epoch: 14, Steps: 10 | Train Loss: 0.615 Vali Loss: 3.213 Vali Acc: 0.245 Test Loss: 3.213 Test Acc: 0.245
Validation loss decreased (-0.237615 --> -0.244674).  Saving model ...
Epoch: 15 cost time: 0.6773502826690674
Epoch: 15, Steps: 10 | Train Loss: 0.482 Vali Loss: 3.271 Vali Acc: 0.253 Test Loss: 3.271 Test Acc: 0.253
Validation loss decreased (-0.244674 --> -0.252908).  Saving model ...
Epoch: 16 cost time: 0.6762402057647705
Epoch: 16, Steps: 10 | Train Loss: 0.389 Vali Loss: 3.303 Vali Acc: 0.259 Test Loss: 3.303 Test Acc: 0.259
Validation loss decreased (-0.252908 --> -0.258790).  Saving model ...
Epoch: 17 cost time: 0.6857984066009521
Epoch: 17, Steps: 10 | Train Loss: 0.304 Vali Loss: 3.344 Vali Acc: 0.268 Test Loss: 3.344 Test Acc: 0.268
Validation loss decreased (-0.258790 --> -0.268202).  Saving model ...
Epoch: 18 cost time: 0.7942123413085938
Epoch: 18, Steps: 10 | Train Loss: 0.242 Vali Loss: 3.387 Vali Acc: 0.267 Test Loss: 3.387 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7717878818511963
Epoch: 19, Steps: 10 | Train Loss: 0.191 Vali Loss: 3.421 Vali Acc: 0.271 Test Loss: 3.421 Test Acc: 0.271
Validation loss decreased (-0.268202 --> -0.270554).  Saving model ...
Epoch: 20 cost time: 0.7722156047821045
Epoch: 20, Steps: 10 | Train Loss: 0.162 Vali Loss: 3.457 Vali Acc: 0.265 Test Loss: 3.457 Test Acc: 0.265
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7339682579040527
Epoch: 21, Steps: 10 | Train Loss: 0.132 Vali Loss: 3.486 Vali Acc: 0.268 Test Loss: 3.486 Test Acc: 0.268
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7331643104553223
Epoch: 22, Steps: 10 | Train Loss: 0.117 Vali Loss: 3.531 Vali Acc: 0.267 Test Loss: 3.531 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.7390718460083008
Epoch: 23, Steps: 10 | Train Loss: 0.092 Vali Loss: 3.591 Vali Acc: 0.262 Test Loss: 3.591 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.762042760848999
Epoch: 24, Steps: 10 | Train Loss: 0.084 Vali Loss: 3.594 Vali Acc: 0.266 Test Loss: 3.594 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.7824428081512451
Epoch: 25, Steps: 10 | Train Loss: 0.066 Vali Loss: 3.626 Vali Acc: 0.265 Test Loss: 3.626 Test Acc: 0.265
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.7533786296844482
Epoch: 26, Steps: 10 | Train Loss: 0.059 Vali Loss: 3.645 Vali Acc: 0.265 Test Loss: 3.645 Test Acc: 0.265
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.7367441654205322
Epoch: 27, Steps: 10 | Train Loss: 0.053 Vali Loss: 3.662 Vali Acc: 0.265 Test Loss: 3.662 Test Acc: 0.265
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.7734119892120361
Epoch: 28, Steps: 10 | Train Loss: 0.045 Vali Loss: 3.675 Vali Acc: 0.265 Test Loss: 3.675 Test Acc: 0.265
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.7723948955535889
Epoch: 29, Steps: 10 | Train Loss: 0.042 Vali Loss: 3.705 Vali Acc: 0.266 Test Loss: 3.705 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps38_str19_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27058823529411763
model parameter : 195994
model size : 0.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.8230443000793457
Epoch: 1, Steps: 10 | Train Loss: 3.276 Vali Loss: 3.252 Vali Acc: 0.051 Test Loss: 3.252 Test Acc: 0.051
Validation loss decreased (inf --> -0.050556).  Saving model ...
Epoch: 2 cost time: 0.6616318225860596
Epoch: 2, Steps: 10 | Train Loss: 2.848 Vali Loss: 3.241 Vali Acc: 0.099 Test Loss: 3.241 Test Acc: 0.099
Validation loss decreased (-0.050556 --> -0.098791).  Saving model ...
Epoch: 3 cost time: 0.6741139888763428
Epoch: 3, Steps: 10 | Train Loss: 2.234 Vali Loss: 3.222 Vali Acc: 0.134 Test Loss: 3.222 Test Acc: 0.134
Validation loss decreased (-0.098791 --> -0.134085).  Saving model ...
Epoch: 4 cost time: 0.6732542514801025
Epoch: 4, Steps: 10 | Train Loss: 1.588 Vali Loss: 3.178 Vali Acc: 0.188 Test Loss: 3.178 Test Acc: 0.188
Validation loss decreased (-0.134085 --> -0.188204).  Saving model ...
Epoch: 5 cost time: 0.666654109954834
Epoch: 5, Steps: 10 | Train Loss: 1.001 Vali Loss: 3.218 Vali Acc: 0.214 Test Loss: 3.218 Test Acc: 0.214
Validation loss decreased (-0.188204 --> -0.214085).  Saving model ...
Epoch: 6 cost time: 0.664086103439331
Epoch: 6, Steps: 10 | Train Loss: 0.600 Vali Loss: 3.299 Vali Acc: 0.225 Test Loss: 3.299 Test Acc: 0.225
Validation loss decreased (-0.214085 --> -0.224673).  Saving model ...
Epoch: 7 cost time: 0.6013858318328857
Epoch: 7, Steps: 10 | Train Loss: 0.338 Vali Loss: 3.481 Vali Acc: 0.227 Test Loss: 3.481 Test Acc: 0.227
Validation loss decreased (-0.224673 --> -0.227024).  Saving model ...
Epoch: 8 cost time: 0.5495963096618652
Epoch: 8, Steps: 10 | Train Loss: 0.176 Vali Loss: 3.624 Vali Acc: 0.236 Test Loss: 3.624 Test Acc: 0.236
Validation loss decreased (-0.227024 --> -0.236434).  Saving model ...
Epoch: 9 cost time: 0.6318457126617432
Epoch: 9, Steps: 10 | Train Loss: 0.097 Vali Loss: 3.774 Vali Acc: 0.238 Test Loss: 3.774 Test Acc: 0.238
Validation loss decreased (-0.236434 --> -0.237609).  Saving model ...
Epoch: 10 cost time: 0.6567556858062744
Epoch: 10, Steps: 10 | Train Loss: 0.049 Vali Loss: 3.816 Vali Acc: 0.242 Test Loss: 3.816 Test Acc: 0.242
Validation loss decreased (-0.237609 --> -0.242315).  Saving model ...
Epoch: 11 cost time: 0.6657373905181885
Epoch: 11, Steps: 10 | Train Loss: 0.031 Vali Loss: 3.884 Vali Acc: 0.252 Test Loss: 3.884 Test Acc: 0.252
Validation loss decreased (-0.242315 --> -0.251726).  Saving model ...
Epoch: 12 cost time: 0.6854090690612793
Epoch: 12, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.948 Vali Acc: 0.247 Test Loss: 3.948 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6890220642089844
Epoch: 13, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.038 Vali Acc: 0.244 Test Loss: 4.038 Test Acc: 0.244
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6906833648681641
Epoch: 14, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.045 Vali Acc: 0.246 Test Loss: 4.045 Test Acc: 0.246
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.6769459247589111
Epoch: 15, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.058 Vali Acc: 0.248 Test Loss: 4.058 Test Acc: 0.248
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.6925263404846191
Epoch: 16, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.101 Vali Acc: 0.251 Test Loss: 4.101 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.6588032245635986
Epoch: 17, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.146 Vali Acc: 0.246 Test Loss: 4.146 Test Acc: 0.246
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.6199362277984619
Epoch: 18, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.181 Vali Acc: 0.246 Test Loss: 4.181 Test Acc: 0.246
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.6617612838745117
Epoch: 19, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.209 Vali Acc: 0.251 Test Loss: 4.209 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.6756582260131836
Epoch: 20, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.208 Vali Acc: 0.253 Test Loss: 4.208 Test Acc: 0.253
Validation loss decreased (-0.251726 --> -0.252899).  Saving model ...
Epoch: 21 cost time: 0.6696689128875732
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.237 Vali Acc: 0.253 Test Loss: 4.237 Test Acc: 0.253
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7032740116119385
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.261 Vali Acc: 0.255 Test Loss: 4.261 Test Acc: 0.255
Validation loss decreased (-0.252899 --> -0.255252).  Saving model ...
Epoch: 23 cost time: 0.6831891536712646
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.283 Vali Acc: 0.254 Test Loss: 4.283 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6875414848327637
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.307 Vali Acc: 0.252 Test Loss: 4.307 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.6882994174957275
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.327 Vali Acc: 0.252 Test Loss: 4.327 Test Acc: 0.252
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.6613748073577881
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.329 Vali Acc: 0.253 Test Loss: 4.329 Test Acc: 0.253
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.6751189231872559
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.352 Vali Acc: 0.256 Test Loss: 4.352 Test Acc: 0.256
Validation loss decreased (-0.255252 --> -0.256427).  Saving model ...
Epoch: 28 cost time: 0.6459531784057617
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.371 Vali Acc: 0.259 Test Loss: 4.371 Test Acc: 0.259
Validation loss decreased (-0.256427 --> -0.258780).  Saving model ...
Epoch: 29 cost time: 0.6481702327728271
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.395 Vali Acc: 0.255 Test Loss: 4.395 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.6326878070831299
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.411 Vali Acc: 0.255 Test Loss: 4.411 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.6400861740112305
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.422 Vali Acc: 0.256 Test Loss: 4.422 Test Acc: 0.256
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.6757304668426514
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.452 Vali Acc: 0.260 Test Loss: 4.452 Test Acc: 0.260
Validation loss decreased (-0.258780 --> -0.259955).  Saving model ...
Epoch: 33 cost time: 0.7143807411193848
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.482 Vali Acc: 0.259 Test Loss: 4.482 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.656775951385498
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.500 Vali Acc: 0.260 Test Loss: 4.500 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.6561033725738525
Epoch: 35, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.505 Vali Acc: 0.259 Test Loss: 4.505 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.6718330383300781
Epoch: 36, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.512 Vali Acc: 0.261 Test Loss: 4.512 Test Acc: 0.261
Validation loss decreased (-0.259955 --> -0.261131).  Saving model ...
Epoch: 37 cost time: 0.6884458065032959
Epoch: 37, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.531 Vali Acc: 0.261 Test Loss: 4.531 Test Acc: 0.261
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.6646995544433594
Epoch: 38, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.565 Vali Acc: 0.256 Test Loss: 4.565 Test Acc: 0.256
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.6420578956604004
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.573 Vali Acc: 0.258 Test Loss: 4.573 Test Acc: 0.258
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.6105642318725586
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.594 Vali Acc: 0.259 Test Loss: 4.594 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.6558773517608643
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.609 Vali Acc: 0.256 Test Loss: 4.609 Test Acc: 0.256
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.6853697299957275
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.617 Vali Acc: 0.259 Test Loss: 4.617 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.6737980842590332
Epoch: 43, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.639 Vali Acc: 0.258 Test Loss: 4.639 Test Acc: 0.258
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.6947073936462402
Epoch: 44, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.670 Vali Acc: 0.256 Test Loss: 4.670 Test Acc: 0.256
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.6953086853027344
Epoch: 45, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.675 Vali Acc: 0.254 Test Loss: 4.675 Test Acc: 0.254
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 0.6769671440124512
Epoch: 46, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.693 Vali Acc: 0.255 Test Loss: 4.693 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2611764705882353
model parameter : 410714
model size : 1.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.8535387516021729
Epoch: 1, Steps: 10 | Train Loss: 3.330 Vali Loss: 3.284 Vali Acc: 0.047 Test Loss: 3.284 Test Acc: 0.047
Validation loss decreased (inf --> -0.047026).  Saving model ...
Epoch: 2 cost time: 0.5691711902618408
Epoch: 2, Steps: 10 | Train Loss: 3.067 Vali Loss: 3.264 Vali Acc: 0.079 Test Loss: 3.264 Test Acc: 0.079
Validation loss decreased (-0.047026 --> -0.078791).  Saving model ...
Epoch: 3 cost time: 0.6535882949829102
Epoch: 3, Steps: 10 | Train Loss: 2.700 Vali Loss: 3.249 Vali Acc: 0.102 Test Loss: 3.249 Test Acc: 0.102
Validation loss decreased (-0.078791 --> -0.102320).  Saving model ...
Epoch: 4 cost time: 0.6520161628723145
Epoch: 4, Steps: 10 | Train Loss: 2.274 Vali Loss: 3.214 Vali Acc: 0.138 Test Loss: 3.214 Test Acc: 0.138
Validation loss decreased (-0.102320 --> -0.137615).  Saving model ...
Epoch: 5 cost time: 0.6015279293060303
Epoch: 5, Steps: 10 | Train Loss: 1.859 Vali Loss: 3.191 Vali Acc: 0.152 Test Loss: 3.191 Test Acc: 0.152
Validation loss decreased (-0.137615 --> -0.151733).  Saving model ...
Epoch: 6 cost time: 0.6686825752258301
Epoch: 6, Steps: 10 | Train Loss: 1.449 Vali Loss: 3.177 Vali Acc: 0.192 Test Loss: 3.177 Test Acc: 0.192
Validation loss decreased (-0.151733 --> -0.191733).  Saving model ...
Epoch: 7 cost time: 0.6643602848052979
Epoch: 7, Steps: 10 | Train Loss: 1.090 Vali Loss: 3.196 Vali Acc: 0.208 Test Loss: 3.196 Test Acc: 0.208
Validation loss decreased (-0.191733 --> -0.208203).  Saving model ...
Epoch: 8 cost time: 0.6603851318359375
Epoch: 8, Steps: 10 | Train Loss: 0.787 Vali Loss: 3.243 Vali Acc: 0.216 Test Loss: 3.243 Test Acc: 0.216
Validation loss decreased (-0.208203 --> -0.216438).  Saving model ...
Epoch: 9 cost time: 0.6483960151672363
Epoch: 9, Steps: 10 | Train Loss: 0.556 Vali Loss: 3.293 Vali Acc: 0.229 Test Loss: 3.293 Test Acc: 0.229
Validation loss decreased (-0.216438 --> -0.229379).  Saving model ...
Epoch: 10 cost time: 0.6432414054870605
Epoch: 10, Steps: 10 | Train Loss: 0.378 Vali Loss: 3.394 Vali Acc: 0.238 Test Loss: 3.394 Test Acc: 0.238
Validation loss decreased (-0.229379 --> -0.237613).  Saving model ...
Epoch: 11 cost time: 0.673750638961792
Epoch: 11, Steps: 10 | Train Loss: 0.263 Vali Loss: 3.452 Vali Acc: 0.244 Test Loss: 3.452 Test Acc: 0.244
Validation loss decreased (-0.237613 --> -0.243495).  Saving model ...
Epoch: 12 cost time: 0.6558246612548828
Epoch: 12, Steps: 10 | Train Loss: 0.170 Vali Loss: 3.565 Vali Acc: 0.244 Test Loss: 3.565 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6252729892730713
Epoch: 13, Steps: 10 | Train Loss: 0.114 Vali Loss: 3.608 Vali Acc: 0.253 Test Loss: 3.608 Test Acc: 0.253
Validation loss decreased (-0.243495 --> -0.252905).  Saving model ...
Epoch: 14 cost time: 0.6249246597290039
Epoch: 14, Steps: 10 | Train Loss: 0.082 Vali Loss: 3.669 Vali Acc: 0.239 Test Loss: 3.669 Test Acc: 0.239
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6215176582336426
Epoch: 15, Steps: 10 | Train Loss: 0.061 Vali Loss: 3.726 Vali Acc: 0.249 Test Loss: 3.726 Test Acc: 0.249
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.620734453201294
Epoch: 16, Steps: 10 | Train Loss: 0.054 Vali Loss: 3.765 Vali Acc: 0.252 Test Loss: 3.765 Test Acc: 0.252
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.6301784515380859
Epoch: 17, Steps: 10 | Train Loss: 0.038 Vali Loss: 3.822 Vali Acc: 0.253 Test Loss: 3.822 Test Acc: 0.253
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.677527666091919
Epoch: 18, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.859 Vali Acc: 0.247 Test Loss: 3.859 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.6863915920257568
Epoch: 19, Steps: 10 | Train Loss: 0.027 Vali Loss: 3.867 Vali Acc: 0.247 Test Loss: 3.867 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.6635856628417969
Epoch: 20, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.900 Vali Acc: 0.249 Test Loss: 3.900 Test Acc: 0.249
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.6539380550384521
Epoch: 21, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.930 Vali Acc: 0.251 Test Loss: 3.930 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.6156654357910156
Epoch: 22, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.952 Vali Acc: 0.248 Test Loss: 3.952 Test Acc: 0.248
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.6956000328063965
Epoch: 23, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.977 Vali Acc: 0.247 Test Loss: 3.977 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2529411764705882
model parameter : 221274
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps12_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.8532180786132812
Epoch: 1, Steps: 10 | Train Loss: 3.340 Vali Loss: 3.273 Vali Acc: 0.044 Test Loss: 3.273 Test Acc: 0.044
Validation loss decreased (inf --> -0.043497).  Saving model ...
Epoch: 2 cost time: 0.721590518951416
Epoch: 2, Steps: 10 | Train Loss: 3.177 Vali Loss: 3.248 Vali Acc: 0.068 Test Loss: 3.248 Test Acc: 0.068
Validation loss decreased (-0.043497 --> -0.068203).  Saving model ...
Epoch: 3 cost time: 0.6737451553344727
Epoch: 3, Steps: 10 | Train Loss: 2.854 Vali Loss: 3.235 Vali Acc: 0.096 Test Loss: 3.235 Test Acc: 0.096
Validation loss decreased (-0.068203 --> -0.096438).  Saving model ...
Epoch: 4 cost time: 0.6793527603149414
Epoch: 4, Steps: 10 | Train Loss: 2.571 Vali Loss: 3.231 Vali Acc: 0.118 Test Loss: 3.231 Test Acc: 0.118
Validation loss decreased (-0.096438 --> -0.117615).  Saving model ...
Epoch: 5 cost time: 0.6561319828033447
Epoch: 5, Steps: 10 | Train Loss: 2.250 Vali Loss: 3.209 Vali Acc: 0.147 Test Loss: 3.209 Test Acc: 0.147
Validation loss decreased (-0.117615 --> -0.147027).  Saving model ...
Epoch: 6 cost time: 0.6214673519134521
Epoch: 6, Steps: 10 | Train Loss: 1.915 Vali Loss: 3.174 Vali Acc: 0.165 Test Loss: 3.174 Test Acc: 0.165
Validation loss decreased (-0.147027 --> -0.164674).  Saving model ...
Epoch: 7 cost time: 0.6350200176239014
Epoch: 7, Steps: 10 | Train Loss: 1.609 Vali Loss: 3.159 Vali Acc: 0.188 Test Loss: 3.159 Test Acc: 0.188
Validation loss decreased (-0.164674 --> -0.188204).  Saving model ...
Epoch: 8 cost time: 0.6725273132324219
Epoch: 8, Steps: 10 | Train Loss: 1.310 Vali Loss: 3.167 Vali Acc: 0.204 Test Loss: 3.167 Test Acc: 0.204
Validation loss decreased (-0.188204 --> -0.203498).  Saving model ...
Epoch: 9 cost time: 0.64571213722229
Epoch: 9, Steps: 10 | Train Loss: 1.009 Vali Loss: 3.181 Vali Acc: 0.231 Test Loss: 3.181 Test Acc: 0.231
Validation loss decreased (-0.203498 --> -0.230556).  Saving model ...
Epoch: 10 cost time: 0.6923081874847412
Epoch: 10, Steps: 10 | Train Loss: 0.800 Vali Loss: 3.221 Vali Acc: 0.225 Test Loss: 3.221 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6734488010406494
Epoch: 11, Steps: 10 | Train Loss: 0.601 Vali Loss: 3.269 Vali Acc: 0.238 Test Loss: 3.269 Test Acc: 0.238
Validation loss decreased (-0.230556 --> -0.237614).  Saving model ...
Epoch: 12 cost time: 0.6628966331481934
Epoch: 12, Steps: 10 | Train Loss: 0.460 Vali Loss: 3.345 Vali Acc: 0.239 Test Loss: 3.345 Test Acc: 0.239
Validation loss decreased (-0.237614 --> -0.238790).  Saving model ...
Epoch: 13 cost time: 0.6631259918212891
Epoch: 13, Steps: 10 | Train Loss: 0.326 Vali Loss: 3.363 Vali Acc: 0.248 Test Loss: 3.363 Test Acc: 0.248
Validation loss decreased (-0.238790 --> -0.248202).  Saving model ...
Epoch: 14 cost time: 0.6632189750671387
Epoch: 14, Steps: 10 | Train Loss: 0.248 Vali Loss: 3.437 Vali Acc: 0.251 Test Loss: 3.437 Test Acc: 0.251
Validation loss decreased (-0.248202 --> -0.250554).  Saving model ...
Epoch: 15 cost time: 0.6773135662078857
Epoch: 15, Steps: 10 | Train Loss: 0.178 Vali Loss: 3.514 Vali Acc: 0.252 Test Loss: 3.514 Test Acc: 0.252
Validation loss decreased (-0.250554 --> -0.251730).  Saving model ...
Epoch: 16 cost time: 0.6416478157043457
Epoch: 16, Steps: 10 | Train Loss: 0.141 Vali Loss: 3.551 Vali Acc: 0.253 Test Loss: 3.551 Test Acc: 0.253
Validation loss decreased (-0.251730 --> -0.252906).  Saving model ...
Epoch: 17 cost time: 0.6099364757537842
Epoch: 17, Steps: 10 | Train Loss: 0.109 Vali Loss: 3.599 Vali Acc: 0.255 Test Loss: 3.599 Test Acc: 0.255
Validation loss decreased (-0.252906 --> -0.255258).  Saving model ...
Epoch: 18 cost time: 0.6632871627807617
Epoch: 18, Steps: 10 | Train Loss: 0.084 Vali Loss: 3.667 Vali Acc: 0.255 Test Loss: 3.667 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7163748741149902
Epoch: 19, Steps: 10 | Train Loss: 0.067 Vali Loss: 3.679 Vali Acc: 0.258 Test Loss: 3.679 Test Acc: 0.258
Validation loss decreased (-0.255258 --> -0.257610).  Saving model ...
Epoch: 20 cost time: 0.6545846462249756
Epoch: 20, Steps: 10 | Train Loss: 0.059 Vali Loss: 3.690 Vali Acc: 0.252 Test Loss: 3.690 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6830058097839355
Epoch: 21, Steps: 10 | Train Loss: 0.050 Vali Loss: 3.725 Vali Acc: 0.256 Test Loss: 3.725 Test Acc: 0.256
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.6599819660186768
Epoch: 22, Steps: 10 | Train Loss: 0.044 Vali Loss: 3.763 Vali Acc: 0.253 Test Loss: 3.763 Test Acc: 0.253
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.672067403793335
Epoch: 23, Steps: 10 | Train Loss: 0.039 Vali Loss: 3.799 Vali Acc: 0.260 Test Loss: 3.799 Test Acc: 0.260
Validation loss decreased (-0.257610 --> -0.259962).  Saving model ...
Epoch: 24 cost time: 0.6774861812591553
Epoch: 24, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.844 Vali Acc: 0.254 Test Loss: 3.844 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6485750675201416
Epoch: 25, Steps: 10 | Train Loss: 0.031 Vali Loss: 3.863 Vali Acc: 0.258 Test Loss: 3.863 Test Acc: 0.258
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.6413993835449219
Epoch: 26, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.867 Vali Acc: 0.255 Test Loss: 3.867 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.6424264907836914
Epoch: 27, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.876 Vali Acc: 0.260 Test Loss: 3.876 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.6181585788726807
Epoch: 28, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.902 Vali Acc: 0.260 Test Loss: 3.902 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.6189160346984863
Epoch: 29, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.950 Vali Acc: 0.260 Test Loss: 3.950 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.6359648704528809
Epoch: 30, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.971 Vali Acc: 0.259 Test Loss: 3.971 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.6722052097320557
Epoch: 31, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.990 Vali Acc: 0.264 Test Loss: 3.990 Test Acc: 0.264
Validation loss decreased (-0.259962 --> -0.263490).  Saving model ...
Epoch: 32 cost time: 0.670635461807251
Epoch: 32, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.017 Vali Acc: 0.261 Test Loss: 4.017 Test Acc: 0.261
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.6751573085784912
Epoch: 33, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.019 Vali Acc: 0.258 Test Loss: 4.019 Test Acc: 0.258
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.6632387638092041
Epoch: 34, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.037 Vali Acc: 0.261 Test Loss: 4.037 Test Acc: 0.261
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.6862564086914062
Epoch: 35, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.060 Vali Acc: 0.259 Test Loss: 4.060 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.6302876472473145
Epoch: 36, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.089 Vali Acc: 0.260 Test Loss: 4.089 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.6549537181854248
Epoch: 37, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.103 Vali Acc: 0.259 Test Loss: 4.103 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.656585693359375
Epoch: 38, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.111 Vali Acc: 0.261 Test Loss: 4.111 Test Acc: 0.261
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.635991096496582
Epoch: 39, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.132 Vali Acc: 0.258 Test Loss: 4.132 Test Acc: 0.258
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.6676836013793945
Epoch: 40, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.155 Vali Acc: 0.259 Test Loss: 4.155 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.7586667537689209
Epoch: 41, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.173 Vali Acc: 0.265 Test Loss: 4.173 Test Acc: 0.265
Validation loss decreased (-0.263490 --> -0.264664).  Saving model ...
Epoch: 42 cost time: 0.6811733245849609
Epoch: 42, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.191 Vali Acc: 0.264 Test Loss: 4.191 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.6717567443847656
Epoch: 43, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.208 Vali Acc: 0.258 Test Loss: 4.208 Test Acc: 0.258
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.6519134044647217
Epoch: 44, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.227 Vali Acc: 0.259 Test Loss: 4.227 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.6924376487731934
Epoch: 45, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.254 Vali Acc: 0.260 Test Loss: 4.254 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.6615667343139648
Epoch: 46, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.262 Vali Acc: 0.259 Test Loss: 4.262 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.6409447193145752
Epoch: 47, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.271 Vali Acc: 0.264 Test Loss: 4.271 Test Acc: 0.264
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.691328763961792
Epoch: 48, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.288 Vali Acc: 0.259 Test Loss: 4.288 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.657883882522583
Epoch: 49, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.300 Vali Acc: 0.261 Test Loss: 4.300 Test Acc: 0.261
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 0.6835615634918213
Epoch: 50, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.325 Vali Acc: 0.261 Test Loss: 4.325 Test Acc: 0.261
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps12_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2647058823529412
model parameter : 156634
model size : 0.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.7806401252746582
Epoch: 1, Steps: 10 | Train Loss: 3.319 Vali Loss: 3.296 Vali Acc: 0.053 Test Loss: 3.296 Test Acc: 0.053
Validation loss decreased (inf --> -0.052908).  Saving model ...
Epoch: 2 cost time: 0.6745166778564453
Epoch: 2, Steps: 10 | Train Loss: 3.166 Vali Loss: 3.285 Vali Acc: 0.061 Test Loss: 3.285 Test Acc: 0.061
Validation loss decreased (-0.052908 --> -0.061144).  Saving model ...
Epoch: 3 cost time: 0.6632513999938965
Epoch: 3, Steps: 10 | Train Loss: 2.943 Vali Loss: 3.276 Vali Acc: 0.080 Test Loss: 3.276 Test Acc: 0.080
Validation loss decreased (-0.061144 --> -0.079967).  Saving model ...
Epoch: 4 cost time: 0.666679859161377
Epoch: 4, Steps: 10 | Train Loss: 2.683 Vali Loss: 3.269 Vali Acc: 0.099 Test Loss: 3.269 Test Acc: 0.099
Validation loss decreased (-0.079967 --> -0.098791).  Saving model ...
Epoch: 5 cost time: 0.6556298732757568
Epoch: 5, Steps: 10 | Train Loss: 2.449 Vali Loss: 3.252 Vali Acc: 0.124 Test Loss: 3.252 Test Acc: 0.124
Validation loss decreased (-0.098791 --> -0.123497).  Saving model ...
Epoch: 6 cost time: 0.6191809177398682
Epoch: 6, Steps: 10 | Train Loss: 2.113 Vali Loss: 3.229 Vali Acc: 0.154 Test Loss: 3.229 Test Acc: 0.154
Validation loss decreased (-0.123497 --> -0.154085).  Saving model ...
Epoch: 7 cost time: 0.6664481163024902
Epoch: 7, Steps: 10 | Train Loss: 1.863 Vali Loss: 3.214 Vali Acc: 0.161 Test Loss: 3.214 Test Acc: 0.161
Validation loss decreased (-0.154085 --> -0.161144).  Saving model ...
Epoch: 8 cost time: 0.6683263778686523
Epoch: 8, Steps: 10 | Train Loss: 1.625 Vali Loss: 3.206 Vali Acc: 0.176 Test Loss: 3.206 Test Acc: 0.176
Validation loss decreased (-0.161144 --> -0.176439).  Saving model ...
Epoch: 9 cost time: 0.6664397716522217
Epoch: 9, Steps: 10 | Train Loss: 1.356 Vali Loss: 3.199 Vali Acc: 0.199 Test Loss: 3.199 Test Acc: 0.199
Validation loss decreased (-0.176439 --> -0.198792).  Saving model ...
Epoch: 10 cost time: 0.6561472415924072
Epoch: 10, Steps: 10 | Train Loss: 1.121 Vali Loss: 3.203 Vali Acc: 0.204 Test Loss: 3.203 Test Acc: 0.204
Validation loss decreased (-0.198792 --> -0.203497).  Saving model ...
Epoch: 11 cost time: 0.6718168258666992
Epoch: 11, Steps: 10 | Train Loss: 0.937 Vali Loss: 3.238 Vali Acc: 0.211 Test Loss: 3.238 Test Acc: 0.211
Validation loss decreased (-0.203497 --> -0.210556).  Saving model ...
Epoch: 12 cost time: 0.6735689640045166
Epoch: 12, Steps: 10 | Train Loss: 0.764 Vali Loss: 3.280 Vali Acc: 0.224 Test Loss: 3.280 Test Acc: 0.224
Validation loss decreased (-0.210556 --> -0.223497).  Saving model ...
Epoch: 13 cost time: 0.6473679542541504
Epoch: 13, Steps: 10 | Train Loss: 0.609 Vali Loss: 3.304 Vali Acc: 0.242 Test Loss: 3.304 Test Acc: 0.242
Validation loss decreased (-0.223497 --> -0.242320).  Saving model ...
Epoch: 14 cost time: 0.7020876407623291
Epoch: 14, Steps: 10 | Train Loss: 0.478 Vali Loss: 3.362 Vali Acc: 0.241 Test Loss: 3.362 Test Acc: 0.241
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7450037002563477
Epoch: 15, Steps: 10 | Train Loss: 0.368 Vali Loss: 3.410 Vali Acc: 0.252 Test Loss: 3.410 Test Acc: 0.252
Validation loss decreased (-0.242320 --> -0.251731).  Saving model ...
Epoch: 16 cost time: 0.6110043525695801
Epoch: 16, Steps: 10 | Train Loss: 0.288 Vali Loss: 3.475 Vali Acc: 0.255 Test Loss: 3.475 Test Acc: 0.255
Validation loss decreased (-0.251731 --> -0.255259).  Saving model ...
Epoch: 17 cost time: 0.6331162452697754
Epoch: 17, Steps: 10 | Train Loss: 0.223 Vali Loss: 3.496 Vali Acc: 0.261 Test Loss: 3.496 Test Acc: 0.261
Validation loss decreased (-0.255259 --> -0.261142).  Saving model ...
Epoch: 18 cost time: 0.6697165966033936
Epoch: 18, Steps: 10 | Train Loss: 0.173 Vali Loss: 3.559 Vali Acc: 0.252 Test Loss: 3.559 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6409008502960205
Epoch: 19, Steps: 10 | Train Loss: 0.143 Vali Loss: 3.586 Vali Acc: 0.265 Test Loss: 3.586 Test Acc: 0.265
Validation loss decreased (-0.261142 --> -0.264670).  Saving model ...
Epoch: 20 cost time: 0.6082727909088135
Epoch: 20, Steps: 10 | Train Loss: 0.123 Vali Loss: 3.631 Vali Acc: 0.268 Test Loss: 3.631 Test Acc: 0.268
Validation loss decreased (-0.264670 --> -0.268199).  Saving model ...
Epoch: 21 cost time: 0.5757052898406982
Epoch: 21, Steps: 10 | Train Loss: 0.096 Vali Loss: 3.690 Vali Acc: 0.265 Test Loss: 3.690 Test Acc: 0.265
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6918363571166992
Epoch: 22, Steps: 10 | Train Loss: 0.086 Vali Loss: 3.705 Vali Acc: 0.259 Test Loss: 3.705 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.6793801784515381
Epoch: 23, Steps: 10 | Train Loss: 0.072 Vali Loss: 3.726 Vali Acc: 0.262 Test Loss: 3.726 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.6542623043060303
Epoch: 24, Steps: 10 | Train Loss: 0.061 Vali Loss: 3.754 Vali Acc: 0.264 Test Loss: 3.754 Test Acc: 0.264
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.6861135959625244
Epoch: 25, Steps: 10 | Train Loss: 0.052 Vali Loss: 3.785 Vali Acc: 0.265 Test Loss: 3.785 Test Acc: 0.265
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.6379673480987549
Epoch: 26, Steps: 10 | Train Loss: 0.046 Vali Loss: 3.811 Vali Acc: 0.265 Test Loss: 3.811 Test Acc: 0.265
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.6474907398223877
Epoch: 27, Steps: 10 | Train Loss: 0.045 Vali Loss: 3.833 Vali Acc: 0.267 Test Loss: 3.833 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.6532399654388428
Epoch: 28, Steps: 10 | Train Loss: 0.040 Vali Loss: 3.867 Vali Acc: 0.264 Test Loss: 3.867 Test Acc: 0.264
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.6413753032684326
Epoch: 29, Steps: 10 | Train Loss: 0.035 Vali Loss: 3.895 Vali Acc: 0.266 Test Loss: 3.895 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.6531994342803955
Epoch: 30, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.903 Vali Acc: 0.260 Test Loss: 3.903 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26823529411764707
model parameter : 126938
model size : 0.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps23_str12_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.907559871673584
Epoch: 1, Steps: 10 | Train Loss: 3.427 Vali Loss: 3.302 Vali Acc: 0.040 Test Loss: 3.302 Test Acc: 0.040
Validation loss decreased (inf --> -0.039967).  Saving model ...
Epoch: 2 cost time: 0.6516194343566895
Epoch: 2, Steps: 10 | Train Loss: 3.310 Vali Loss: 3.295 Vali Acc: 0.044 Test Loss: 3.295 Test Acc: 0.044
Validation loss decreased (-0.039967 --> -0.043496).  Saving model ...
Epoch: 3 cost time: 0.6701693534851074
Epoch: 3, Steps: 10 | Train Loss: 3.147 Vali Loss: 3.277 Vali Acc: 0.061 Test Loss: 3.277 Test Acc: 0.061
Validation loss decreased (-0.043496 --> -0.061144).  Saving model ...
Epoch: 4 cost time: 0.653944730758667
Epoch: 4, Steps: 10 | Train Loss: 2.974 Vali Loss: 3.266 Vali Acc: 0.087 Test Loss: 3.266 Test Acc: 0.087
Validation loss decreased (-0.061144 --> -0.087026).  Saving model ...
Epoch: 5 cost time: 0.6281216144561768
Epoch: 5, Steps: 10 | Train Loss: 2.765 Vali Loss: 3.255 Vali Acc: 0.111 Test Loss: 3.255 Test Acc: 0.111
Validation loss decreased (-0.087026 --> -0.110556).  Saving model ...
Epoch: 6 cost time: 0.6598615646362305
Epoch: 6, Steps: 10 | Train Loss: 2.555 Vali Loss: 3.240 Vali Acc: 0.124 Test Loss: 3.240 Test Acc: 0.124
Validation loss decreased (-0.110556 --> -0.123497).  Saving model ...
Epoch: 7 cost time: 0.6387279033660889
Epoch: 7, Steps: 10 | Train Loss: 2.327 Vali Loss: 3.226 Vali Acc: 0.132 Test Loss: 3.226 Test Acc: 0.132
Validation loss decreased (-0.123497 --> -0.131732).  Saving model ...
Epoch: 8 cost time: 0.679797887802124
Epoch: 8, Steps: 10 | Train Loss: 2.158 Vali Loss: 3.195 Vali Acc: 0.144 Test Loss: 3.195 Test Acc: 0.144
Validation loss decreased (-0.131732 --> -0.143497).  Saving model ...
Epoch: 9 cost time: 0.6638798713684082
Epoch: 9, Steps: 10 | Train Loss: 1.921 Vali Loss: 3.183 Vali Acc: 0.161 Test Loss: 3.183 Test Acc: 0.161
Validation loss decreased (-0.143497 --> -0.161145).  Saving model ...
Epoch: 10 cost time: 0.6331734657287598
Epoch: 10, Steps: 10 | Train Loss: 1.676 Vali Loss: 3.167 Vali Acc: 0.167 Test Loss: 3.167 Test Acc: 0.167
Validation loss decreased (-0.161145 --> -0.167027).  Saving model ...
Epoch: 11 cost time: 0.6613645553588867
Epoch: 11, Steps: 10 | Train Loss: 1.478 Vali Loss: 3.161 Vali Acc: 0.180 Test Loss: 3.161 Test Acc: 0.180
Validation loss decreased (-0.167027 --> -0.179968).  Saving model ...
Epoch: 12 cost time: 0.6412734985351562
Epoch: 12, Steps: 10 | Train Loss: 1.299 Vali Loss: 3.166 Vali Acc: 0.194 Test Loss: 3.166 Test Acc: 0.194
Validation loss decreased (-0.179968 --> -0.194086).  Saving model ...
Epoch: 13 cost time: 0.6119184494018555
Epoch: 13, Steps: 10 | Train Loss: 1.088 Vali Loss: 3.173 Vali Acc: 0.199 Test Loss: 3.173 Test Acc: 0.199
Validation loss decreased (-0.194086 --> -0.198792).  Saving model ...
Epoch: 14 cost time: 0.6931910514831543
Epoch: 14, Steps: 10 | Train Loss: 0.933 Vali Loss: 3.181 Vali Acc: 0.215 Test Loss: 3.181 Test Acc: 0.215
Validation loss decreased (-0.198792 --> -0.215262).  Saving model ...
Epoch: 15 cost time: 0.67618727684021
Epoch: 15, Steps: 10 | Train Loss: 0.781 Vali Loss: 3.200 Vali Acc: 0.216 Test Loss: 3.200 Test Acc: 0.216
Validation loss decreased (-0.215262 --> -0.216439).  Saving model ...
Epoch: 16 cost time: 0.6699807643890381
Epoch: 16, Steps: 10 | Train Loss: 0.622 Vali Loss: 3.236 Vali Acc: 0.224 Test Loss: 3.236 Test Acc: 0.224
Validation loss decreased (-0.216439 --> -0.223497).  Saving model ...
Epoch: 17 cost time: 0.671741247177124
Epoch: 17, Steps: 10 | Train Loss: 0.540 Vali Loss: 3.269 Vali Acc: 0.239 Test Loss: 3.269 Test Acc: 0.239
Validation loss decreased (-0.223497 --> -0.238791).  Saving model ...
Epoch: 18 cost time: 0.6466803550720215
Epoch: 18, Steps: 10 | Train Loss: 0.446 Vali Loss: 3.291 Vali Acc: 0.240 Test Loss: 3.291 Test Acc: 0.240
Validation loss decreased (-0.238791 --> -0.239967).  Saving model ...
Epoch: 19 cost time: 0.6555297374725342
Epoch: 19, Steps: 10 | Train Loss: 0.371 Vali Loss: 3.349 Vali Acc: 0.235 Test Loss: 3.349 Test Acc: 0.235
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.640416145324707
Epoch: 20, Steps: 10 | Train Loss: 0.310 Vali Loss: 3.381 Vali Acc: 0.246 Test Loss: 3.381 Test Acc: 0.246
Validation loss decreased (-0.239967 --> -0.245849).  Saving model ...
Epoch: 21 cost time: 0.6793844699859619
Epoch: 21, Steps: 10 | Train Loss: 0.244 Vali Loss: 3.410 Vali Acc: 0.246 Test Loss: 3.410 Test Acc: 0.246
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6541228294372559
Epoch: 22, Steps: 10 | Train Loss: 0.206 Vali Loss: 3.456 Vali Acc: 0.249 Test Loss: 3.456 Test Acc: 0.249
Validation loss decreased (-0.245849 --> -0.249377).  Saving model ...
Epoch: 23 cost time: 0.6702537536621094
Epoch: 23, Steps: 10 | Train Loss: 0.174 Vali Loss: 3.473 Vali Acc: 0.255 Test Loss: 3.473 Test Acc: 0.255
Validation loss decreased (-0.249377 --> -0.255259).  Saving model ...
Epoch: 24 cost time: 0.726466178894043
Epoch: 24, Steps: 10 | Train Loss: 0.150 Vali Loss: 3.497 Vali Acc: 0.259 Test Loss: 3.497 Test Acc: 0.259
Validation loss decreased (-0.255259 --> -0.258789).  Saving model ...
Epoch: 25 cost time: 0.6623010635375977
Epoch: 25, Steps: 10 | Train Loss: 0.128 Vali Loss: 3.518 Vali Acc: 0.244 Test Loss: 3.518 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6416444778442383
Epoch: 26, Steps: 10 | Train Loss: 0.107 Vali Loss: 3.551 Vali Acc: 0.252 Test Loss: 3.551 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.6295661926269531
Epoch: 27, Steps: 10 | Train Loss: 0.097 Vali Loss: 3.579 Vali Acc: 0.252 Test Loss: 3.579 Test Acc: 0.252
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.6438586711883545
Epoch: 28, Steps: 10 | Train Loss: 0.092 Vali Loss: 3.593 Vali Acc: 0.260 Test Loss: 3.593 Test Acc: 0.260
Validation loss decreased (-0.258789 --> -0.259964).  Saving model ...
Epoch: 29 cost time: 0.6997816562652588
Epoch: 29, Steps: 10 | Train Loss: 0.080 Vali Loss: 3.628 Vali Acc: 0.249 Test Loss: 3.628 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.6632230281829834
Epoch: 30, Steps: 10 | Train Loss: 0.067 Vali Loss: 3.664 Vali Acc: 0.252 Test Loss: 3.664 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.6667945384979248
Epoch: 31, Steps: 10 | Train Loss: 0.061 Vali Loss: 3.686 Vali Acc: 0.255 Test Loss: 3.686 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.6751863956451416
Epoch: 32, Steps: 10 | Train Loss: 0.052 Vali Loss: 3.692 Vali Acc: 0.260 Test Loss: 3.692 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.6578888893127441
Epoch: 33, Steps: 10 | Train Loss: 0.050 Vali Loss: 3.728 Vali Acc: 0.253 Test Loss: 3.728 Test Acc: 0.253
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.6466734409332275
Epoch: 34, Steps: 10 | Train Loss: 0.045 Vali Loss: 3.745 Vali Acc: 0.255 Test Loss: 3.745 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.6395206451416016
Epoch: 35, Steps: 10 | Train Loss: 0.042 Vali Loss: 3.779 Vali Acc: 0.256 Test Loss: 3.779 Test Acc: 0.256
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.6385014057159424
Epoch: 36, Steps: 10 | Train Loss: 0.037 Vali Loss: 3.797 Vali Acc: 0.256 Test Loss: 3.797 Test Acc: 0.256
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.6314706802368164
Epoch: 37, Steps: 10 | Train Loss: 0.037 Vali Loss: 3.825 Vali Acc: 0.256 Test Loss: 3.825 Test Acc: 0.256
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.7046289443969727
Epoch: 38, Steps: 10 | Train Loss: 0.031 Vali Loss: 3.835 Vali Acc: 0.261 Test Loss: 3.835 Test Acc: 0.261
Validation loss decreased (-0.259964 --> -0.261138).  Saving model ...
Epoch: 39 cost time: 0.6652793884277344
Epoch: 39, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.850 Vali Acc: 0.265 Test Loss: 3.850 Test Acc: 0.265
Validation loss decreased (-0.261138 --> -0.264667).  Saving model ...
Epoch: 40 cost time: 0.6531186103820801
Epoch: 40, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.864 Vali Acc: 0.261 Test Loss: 3.864 Test Acc: 0.261
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.6996521949768066
Epoch: 41, Steps: 10 | Train Loss: 0.027 Vali Loss: 3.909 Vali Acc: 0.259 Test Loss: 3.909 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.682225227355957
Epoch: 42, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.934 Vali Acc: 0.260 Test Loss: 3.934 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.6412572860717773
Epoch: 43, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.953 Vali Acc: 0.264 Test Loss: 3.953 Test Acc: 0.264
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.6962356567382812
Epoch: 44, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.971 Vali Acc: 0.261 Test Loss: 3.971 Test Acc: 0.261
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.7563505172729492
Epoch: 45, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.984 Vali Acc: 0.260 Test Loss: 3.984 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.7361996173858643
Epoch: 46, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.991 Vali Acc: 0.261 Test Loss: 3.991 Test Acc: 0.261
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.6756327152252197
Epoch: 47, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.020 Vali Acc: 0.266 Test Loss: 4.020 Test Acc: 0.266
Validation loss decreased (-0.264667 --> -0.265842).  Saving model ...
Epoch: 48 cost time: 0.6635990142822266
Epoch: 48, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.041 Vali Acc: 0.264 Test Loss: 4.041 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.7253997325897217
Epoch: 49, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.069 Vali Acc: 0.262 Test Loss: 4.069 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.6904463768005371
Epoch: 50, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.100 Vali Acc: 0.261 Test Loss: 4.100 Test Acc: 0.261
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps23_str12_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26588235294117646
model parameter : 92442
model size : 0.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.8922533988952637
Epoch: 1, Steps: 10 | Train Loss: 3.276 Vali Loss: 3.290 Vali Acc: 0.027 Test Loss: 3.290 Test Acc: 0.027
Validation loss decreased (inf --> -0.027026).  Saving model ...
Epoch: 2 cost time: 0.6497266292572021
Epoch: 2, Steps: 10 | Train Loss: 3.172 Vali Loss: 3.291 Vali Acc: 0.033 Test Loss: 3.291 Test Acc: 0.033
Validation loss decreased (-0.027026 --> -0.032908).  Saving model ...
Epoch: 3 cost time: 0.6745481491088867
Epoch: 3, Steps: 10 | Train Loss: 3.112 Vali Loss: 3.289 Vali Acc: 0.045 Test Loss: 3.289 Test Acc: 0.045
Validation loss decreased (-0.032908 --> -0.044673).  Saving model ...
Epoch: 4 cost time: 0.694629430770874
Epoch: 4, Steps: 10 | Train Loss: 2.936 Vali Loss: 3.284 Vali Acc: 0.060 Test Loss: 3.284 Test Acc: 0.060
Validation loss decreased (-0.044673 --> -0.059967).  Saving model ...
Epoch: 5 cost time: 0.6597084999084473
Epoch: 5, Steps: 10 | Train Loss: 2.788 Vali Loss: 3.274 Vali Acc: 0.071 Test Loss: 3.274 Test Acc: 0.071
Validation loss decreased (-0.059967 --> -0.070555).  Saving model ...
Epoch: 6 cost time: 0.6381723880767822
Epoch: 6, Steps: 10 | Train Loss: 2.650 Vali Loss: 3.261 Vali Acc: 0.091 Test Loss: 3.261 Test Acc: 0.091
Validation loss decreased (-0.070555 --> -0.090556).  Saving model ...
Epoch: 7 cost time: 0.6901273727416992
Epoch: 7, Steps: 10 | Train Loss: 2.465 Vali Loss: 3.253 Vali Acc: 0.093 Test Loss: 3.253 Test Acc: 0.093
Validation loss decreased (-0.090556 --> -0.092909).  Saving model ...
Epoch: 8 cost time: 0.6468243598937988
Epoch: 8, Steps: 10 | Train Loss: 2.312 Vali Loss: 3.240 Vali Acc: 0.109 Test Loss: 3.240 Test Acc: 0.109
Validation loss decreased (-0.092909 --> -0.109379).  Saving model ...
Epoch: 9 cost time: 0.6539895534515381
Epoch: 9, Steps: 10 | Train Loss: 2.135 Vali Loss: 3.223 Vali Acc: 0.134 Test Loss: 3.223 Test Acc: 0.134
Validation loss decreased (-0.109379 --> -0.134085).  Saving model ...
Epoch: 10 cost time: 0.6647365093231201
Epoch: 10, Steps: 10 | Train Loss: 1.953 Vali Loss: 3.210 Vali Acc: 0.153 Test Loss: 3.210 Test Acc: 0.153
Validation loss decreased (-0.134085 --> -0.152909).  Saving model ...
Epoch: 11 cost time: 0.5697219371795654
Epoch: 11, Steps: 10 | Train Loss: 1.786 Vali Loss: 3.199 Vali Acc: 0.159 Test Loss: 3.199 Test Acc: 0.159
Validation loss decreased (-0.152909 --> -0.158792).  Saving model ...
Epoch: 12 cost time: 0.6090333461761475
Epoch: 12, Steps: 10 | Train Loss: 1.623 Vali Loss: 3.188 Vali Acc: 0.166 Test Loss: 3.188 Test Acc: 0.166
Validation loss decreased (-0.158792 --> -0.165850).  Saving model ...
Epoch: 13 cost time: 0.5702223777770996
Epoch: 13, Steps: 10 | Train Loss: 1.464 Vali Loss: 3.174 Vali Acc: 0.176 Test Loss: 3.174 Test Acc: 0.176
Validation loss decreased (-0.165850 --> -0.176439).  Saving model ...
Epoch: 14 cost time: 0.6406211853027344
Epoch: 14, Steps: 10 | Train Loss: 1.278 Vali Loss: 3.172 Vali Acc: 0.191 Test Loss: 3.172 Test Acc: 0.191
Validation loss decreased (-0.176439 --> -0.190557).  Saving model ...
Epoch: 15 cost time: 0.601529598236084
Epoch: 15, Steps: 10 | Train Loss: 1.137 Vali Loss: 3.182 Vali Acc: 0.200 Test Loss: 3.182 Test Acc: 0.200
Validation loss decreased (-0.190557 --> -0.199968).  Saving model ...
Epoch: 16 cost time: 0.6576650142669678
Epoch: 16, Steps: 10 | Train Loss: 0.968 Vali Loss: 3.186 Vali Acc: 0.198 Test Loss: 3.186 Test Acc: 0.198
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6559531688690186
Epoch: 17, Steps: 10 | Train Loss: 0.883 Vali Loss: 3.197 Vali Acc: 0.212 Test Loss: 3.197 Test Acc: 0.212
Validation loss decreased (-0.199968 --> -0.211733).  Saving model ...
Epoch: 18 cost time: 0.6663429737091064
Epoch: 18, Steps: 10 | Train Loss: 0.754 Vali Loss: 3.211 Vali Acc: 0.222 Test Loss: 3.211 Test Acc: 0.222
Validation loss decreased (-0.211733 --> -0.222321).  Saving model ...
Epoch: 19 cost time: 0.6381721496582031
Epoch: 19, Steps: 10 | Train Loss: 0.641 Vali Loss: 3.231 Vali Acc: 0.225 Test Loss: 3.231 Test Acc: 0.225
Validation loss decreased (-0.222321 --> -0.224674).  Saving model ...
Epoch: 20 cost time: 0.6028347015380859
Epoch: 20, Steps: 10 | Train Loss: 0.536 Vali Loss: 3.250 Vali Acc: 0.226 Test Loss: 3.250 Test Acc: 0.226
Validation loss decreased (-0.224674 --> -0.225850).  Saving model ...
Epoch: 21 cost time: 0.5719127655029297
Epoch: 21, Steps: 10 | Train Loss: 0.457 Vali Loss: 3.265 Vali Acc: 0.242 Test Loss: 3.265 Test Acc: 0.242
Validation loss decreased (-0.225850 --> -0.242320).  Saving model ...
Epoch: 22 cost time: 0.6361181735992432
Epoch: 22, Steps: 10 | Train Loss: 0.404 Vali Loss: 3.288 Vali Acc: 0.242 Test Loss: 3.288 Test Acc: 0.242
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6558725833892822
Epoch: 23, Steps: 10 | Train Loss: 0.326 Vali Loss: 3.334 Vali Acc: 0.236 Test Loss: 3.334 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.6633517742156982
Epoch: 24, Steps: 10 | Train Loss: 0.281 Vali Loss: 3.371 Vali Acc: 0.245 Test Loss: 3.371 Test Acc: 0.245
Validation loss decreased (-0.242320 --> -0.244672).  Saving model ...
Epoch: 25 cost time: 0.6599853038787842
Epoch: 25, Steps: 10 | Train Loss: 0.255 Vali Loss: 3.397 Vali Acc: 0.244 Test Loss: 3.397 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6359732151031494
Epoch: 26, Steps: 10 | Train Loss: 0.211 Vali Loss: 3.402 Vali Acc: 0.251 Test Loss: 3.402 Test Acc: 0.251
Validation loss decreased (-0.244672 --> -0.250554).  Saving model ...
Epoch: 27 cost time: 0.6432638168334961
Epoch: 27, Steps: 10 | Train Loss: 0.196 Vali Loss: 3.412 Vali Acc: 0.247 Test Loss: 3.412 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6166186332702637
Epoch: 28, Steps: 10 | Train Loss: 0.173 Vali Loss: 3.451 Vali Acc: 0.245 Test Loss: 3.451 Test Acc: 0.245
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.6310603618621826
Epoch: 29, Steps: 10 | Train Loss: 0.142 Vali Loss: 3.477 Vali Acc: 0.249 Test Loss: 3.477 Test Acc: 0.249
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.633683443069458
Epoch: 30, Steps: 10 | Train Loss: 0.129 Vali Loss: 3.503 Vali Acc: 0.254 Test Loss: 3.503 Test Acc: 0.254
Validation loss decreased (-0.250554 --> -0.254083).  Saving model ...
Epoch: 31 cost time: 0.6444830894470215
Epoch: 31, Steps: 10 | Train Loss: 0.114 Vali Loss: 3.511 Vali Acc: 0.256 Test Loss: 3.511 Test Acc: 0.256
Validation loss decreased (-0.254083 --> -0.256435).  Saving model ...
Epoch: 32 cost time: 0.6568794250488281
Epoch: 32, Steps: 10 | Train Loss: 0.107 Vali Loss: 3.537 Vali Acc: 0.256 Test Loss: 3.537 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.6598086357116699
Epoch: 33, Steps: 10 | Train Loss: 0.097 Vali Loss: 3.552 Vali Acc: 0.255 Test Loss: 3.552 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.6576073169708252
Epoch: 34, Steps: 10 | Train Loss: 0.087 Vali Loss: 3.577 Vali Acc: 0.254 Test Loss: 3.577 Test Acc: 0.254
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.6161775588989258
Epoch: 35, Steps: 10 | Train Loss: 0.075 Vali Loss: 3.595 Vali Acc: 0.260 Test Loss: 3.595 Test Acc: 0.260
Validation loss decreased (-0.256435 --> -0.259964).  Saving model ...
Epoch: 36 cost time: 0.6150813102722168
Epoch: 36, Steps: 10 | Train Loss: 0.066 Vali Loss: 3.614 Vali Acc: 0.252 Test Loss: 3.614 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.6483180522918701
Epoch: 37, Steps: 10 | Train Loss: 0.064 Vali Loss: 3.636 Vali Acc: 0.259 Test Loss: 3.636 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.6358540058135986
Epoch: 38, Steps: 10 | Train Loss: 0.061 Vali Loss: 3.659 Vali Acc: 0.259 Test Loss: 3.659 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.6638472080230713
Epoch: 39, Steps: 10 | Train Loss: 0.054 Vali Loss: 3.687 Vali Acc: 0.260 Test Loss: 3.687 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.6823382377624512
Epoch: 40, Steps: 10 | Train Loss: 0.052 Vali Loss: 3.708 Vali Acc: 0.258 Test Loss: 3.708 Test Acc: 0.258
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.6578888893127441
Epoch: 41, Steps: 10 | Train Loss: 0.044 Vali Loss: 3.739 Vali Acc: 0.259 Test Loss: 3.739 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.6547653675079346
Epoch: 42, Steps: 10 | Train Loss: 0.043 Vali Loss: 3.760 Vali Acc: 0.258 Test Loss: 3.760 Test Acc: 0.258
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.6349613666534424
Epoch: 43, Steps: 10 | Train Loss: 0.038 Vali Loss: 3.757 Vali Acc: 0.262 Test Loss: 3.757 Test Acc: 0.262
Validation loss decreased (-0.259964 --> -0.262315).  Saving model ...
Epoch: 44 cost time: 0.6329679489135742
Epoch: 44, Steps: 10 | Train Loss: 0.036 Vali Loss: 3.773 Vali Acc: 0.262 Test Loss: 3.773 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.6884770393371582
Epoch: 45, Steps: 10 | Train Loss: 0.035 Vali Loss: 3.774 Vali Acc: 0.265 Test Loss: 3.774 Test Acc: 0.265
Validation loss decreased (-0.262315 --> -0.264668).  Saving model ...
Epoch: 46 cost time: 0.6184210777282715
Epoch: 46, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.805 Vali Acc: 0.262 Test Loss: 3.805 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.6572489738464355
Epoch: 47, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.837 Vali Acc: 0.264 Test Loss: 3.837 Test Acc: 0.264
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.6641719341278076
Epoch: 48, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.855 Vali Acc: 0.261 Test Loss: 3.855 Test Acc: 0.261
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.689281702041626
Epoch: 49, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.870 Vali Acc: 0.262 Test Loss: 3.870 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.6495711803436279
Epoch: 50, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.877 Vali Acc: 0.268 Test Loss: 3.877 Test Acc: 0.268
Validation loss decreased (-0.264668 --> -0.268197).  Saving model ...
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26823529411764707
model parameter : 77978
model size : 0.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps38_str19_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.9120547771453857
Epoch: 1, Steps: 10 | Train Loss: 3.351 Vali Loss: 3.286 Vali Acc: 0.054 Test Loss: 3.286 Test Acc: 0.054
Validation loss decreased (inf --> -0.054085).  Saving model ...
Epoch: 2 cost time: 0.627464771270752
Epoch: 2, Steps: 10 | Train Loss: 3.257 Vali Loss: 3.285 Vali Acc: 0.062 Test Loss: 3.285 Test Acc: 0.062
Validation loss decreased (-0.054085 --> -0.062320).  Saving model ...
Epoch: 3 cost time: 0.6397945880889893
Epoch: 3, Steps: 10 | Train Loss: 3.150 Vali Loss: 3.274 Vali Acc: 0.066 Test Loss: 3.274 Test Acc: 0.066
Validation loss decreased (-0.062320 --> -0.065850).  Saving model ...
Epoch: 4 cost time: 0.6080124378204346
Epoch: 4, Steps: 10 | Train Loss: 3.025 Vali Loss: 3.265 Vali Acc: 0.085 Test Loss: 3.265 Test Acc: 0.085
Validation loss decreased (-0.065850 --> -0.084673).  Saving model ...
Epoch: 5 cost time: 0.6381392478942871
Epoch: 5, Steps: 10 | Train Loss: 2.849 Vali Loss: 3.260 Vali Acc: 0.087 Test Loss: 3.260 Test Acc: 0.087
Validation loss decreased (-0.084673 --> -0.087026).  Saving model ...
Epoch: 6 cost time: 0.6190533638000488
Epoch: 6, Steps: 10 | Train Loss: 2.705 Vali Loss: 3.252 Vali Acc: 0.109 Test Loss: 3.252 Test Acc: 0.109
Validation loss decreased (-0.087026 --> -0.109379).  Saving model ...
Epoch: 7 cost time: 0.6186492443084717
Epoch: 7, Steps: 10 | Train Loss: 2.565 Vali Loss: 3.247 Vali Acc: 0.120 Test Loss: 3.247 Test Acc: 0.120
Validation loss decreased (-0.109379 --> -0.119968).  Saving model ...
Epoch: 8 cost time: 0.6067328453063965
Epoch: 8, Steps: 10 | Train Loss: 2.458 Vali Loss: 3.233 Vali Acc: 0.134 Test Loss: 3.233 Test Acc: 0.134
Validation loss decreased (-0.119968 --> -0.134085).  Saving model ...
Epoch: 9 cost time: 0.5956549644470215
Epoch: 9, Steps: 10 | Train Loss: 2.259 Vali Loss: 3.217 Vali Acc: 0.144 Test Loss: 3.217 Test Acc: 0.144
Validation loss decreased (-0.134085 --> -0.143497).  Saving model ...
Epoch: 10 cost time: 0.6311132907867432
Epoch: 10, Steps: 10 | Train Loss: 2.068 Vali Loss: 3.200 Vali Acc: 0.154 Test Loss: 3.200 Test Acc: 0.154
Validation loss decreased (-0.143497 --> -0.154086).  Saving model ...
Epoch: 11 cost time: 0.6664214134216309
Epoch: 11, Steps: 10 | Train Loss: 1.935 Vali Loss: 3.182 Vali Acc: 0.168 Test Loss: 3.182 Test Acc: 0.168
Validation loss decreased (-0.154086 --> -0.168203).  Saving model ...
Epoch: 12 cost time: 0.6220710277557373
Epoch: 12, Steps: 10 | Train Loss: 1.776 Vali Loss: 3.175 Vali Acc: 0.176 Test Loss: 3.175 Test Acc: 0.176
Validation loss decreased (-0.168203 --> -0.176439).  Saving model ...
Epoch: 13 cost time: 0.5349318981170654
Epoch: 13, Steps: 10 | Train Loss: 1.595 Vali Loss: 3.170 Vali Acc: 0.192 Test Loss: 3.170 Test Acc: 0.192
Validation loss decreased (-0.176439 --> -0.191733).  Saving model ...
Epoch: 14 cost time: 0.5457875728607178
Epoch: 14, Steps: 10 | Train Loss: 1.448 Vali Loss: 3.164 Vali Acc: 0.200 Test Loss: 3.164 Test Acc: 0.200
Validation loss decreased (-0.191733 --> -0.199968).  Saving model ...
Epoch: 15 cost time: 0.6565055847167969
Epoch: 15, Steps: 10 | Train Loss: 1.287 Vali Loss: 3.176 Vali Acc: 0.207 Test Loss: 3.176 Test Acc: 0.207
Validation loss decreased (-0.199968 --> -0.207027).  Saving model ...
Epoch: 16 cost time: 0.6153559684753418
Epoch: 16, Steps: 10 | Train Loss: 1.183 Vali Loss: 3.177 Vali Acc: 0.209 Test Loss: 3.177 Test Acc: 0.209
Validation loss decreased (-0.207027 --> -0.209380).  Saving model ...
Epoch: 17 cost time: 0.6212749481201172
Epoch: 17, Steps: 10 | Train Loss: 1.032 Vali Loss: 3.195 Vali Acc: 0.209 Test Loss: 3.195 Test Acc: 0.209
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6180670261383057
Epoch: 18, Steps: 10 | Train Loss: 0.922 Vali Loss: 3.200 Vali Acc: 0.216 Test Loss: 3.200 Test Acc: 0.216
Validation loss decreased (-0.209380 --> -0.216439).  Saving model ...
Epoch: 19 cost time: 0.6374008655548096
Epoch: 19, Steps: 10 | Train Loss: 0.807 Vali Loss: 3.212 Vali Acc: 0.218 Test Loss: 3.212 Test Acc: 0.218
Validation loss decreased (-0.216439 --> -0.217615).  Saving model ...
Epoch: 20 cost time: 0.6263346672058105
Epoch: 20, Steps: 10 | Train Loss: 0.701 Vali Loss: 3.235 Vali Acc: 0.227 Test Loss: 3.235 Test Acc: 0.227
Validation loss decreased (-0.217615 --> -0.227026).  Saving model ...
Epoch: 21 cost time: 0.630990743637085
Epoch: 21, Steps: 10 | Train Loss: 0.581 Vali Loss: 3.256 Vali Acc: 0.238 Test Loss: 3.256 Test Acc: 0.238
Validation loss decreased (-0.227026 --> -0.237615).  Saving model ...
Epoch: 22 cost time: 0.5855438709259033
Epoch: 22, Steps: 10 | Train Loss: 0.515 Vali Loss: 3.275 Vali Acc: 0.242 Test Loss: 3.275 Test Acc: 0.242
Validation loss decreased (-0.237615 --> -0.242320).  Saving model ...
Epoch: 23 cost time: 0.5998899936676025
Epoch: 23, Steps: 10 | Train Loss: 0.442 Vali Loss: 3.294 Vali Acc: 0.245 Test Loss: 3.294 Test Acc: 0.245
Validation loss decreased (-0.242320 --> -0.244673).  Saving model ...
Epoch: 24 cost time: 0.611900806427002
Epoch: 24, Steps: 10 | Train Loss: 0.381 Vali Loss: 3.328 Vali Acc: 0.248 Test Loss: 3.328 Test Acc: 0.248
Validation loss decreased (-0.244673 --> -0.248202).  Saving model ...
Epoch: 25 cost time: 0.6007881164550781
Epoch: 25, Steps: 10 | Train Loss: 0.330 Vali Loss: 3.359 Vali Acc: 0.245 Test Loss: 3.359 Test Acc: 0.245
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6129324436187744
Epoch: 26, Steps: 10 | Train Loss: 0.284 Vali Loss: 3.398 Vali Acc: 0.244 Test Loss: 3.398 Test Acc: 0.244
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.6495723724365234
Epoch: 27, Steps: 10 | Train Loss: 0.260 Vali Loss: 3.423 Vali Acc: 0.248 Test Loss: 3.423 Test Acc: 0.248
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.6307854652404785
Epoch: 28, Steps: 10 | Train Loss: 0.220 Vali Loss: 3.439 Vali Acc: 0.245 Test Loss: 3.439 Test Acc: 0.245
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.6099734306335449
Epoch: 29, Steps: 10 | Train Loss: 0.217 Vali Loss: 3.466 Vali Acc: 0.245 Test Loss: 3.466 Test Acc: 0.245
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.6274323463439941
Epoch: 30, Steps: 10 | Train Loss: 0.169 Vali Loss: 3.493 Vali Acc: 0.252 Test Loss: 3.493 Test Acc: 0.252
Validation loss decreased (-0.248202 --> -0.251730).  Saving model ...
Epoch: 31 cost time: 0.6104130744934082
Epoch: 31, Steps: 10 | Train Loss: 0.154 Vali Loss: 3.522 Vali Acc: 0.249 Test Loss: 3.522 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.6038646697998047
Epoch: 32, Steps: 10 | Train Loss: 0.140 Vali Loss: 3.526 Vali Acc: 0.255 Test Loss: 3.526 Test Acc: 0.255
Validation loss decreased (-0.251730 --> -0.255259).  Saving model ...
Epoch: 33 cost time: 0.6554968357086182
Epoch: 33, Steps: 10 | Train Loss: 0.130 Vali Loss: 3.535 Vali Acc: 0.251 Test Loss: 3.535 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.6724193096160889
Epoch: 34, Steps: 10 | Train Loss: 0.114 Vali Loss: 3.571 Vali Acc: 0.248 Test Loss: 3.571 Test Acc: 0.248
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.6188919544219971
Epoch: 35, Steps: 10 | Train Loss: 0.100 Vali Loss: 3.609 Vali Acc: 0.252 Test Loss: 3.609 Test Acc: 0.252
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.631141185760498
Epoch: 36, Steps: 10 | Train Loss: 0.086 Vali Loss: 3.626 Vali Acc: 0.249 Test Loss: 3.626 Test Acc: 0.249
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.619962215423584
Epoch: 37, Steps: 10 | Train Loss: 0.083 Vali Loss: 3.653 Vali Acc: 0.255 Test Loss: 3.653 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.6293947696685791
Epoch: 38, Steps: 10 | Train Loss: 0.078 Vali Loss: 3.663 Vali Acc: 0.258 Test Loss: 3.663 Test Acc: 0.258
Validation loss decreased (-0.255259 --> -0.257610).  Saving model ...
Epoch: 39 cost time: 0.6571531295776367
Epoch: 39, Steps: 10 | Train Loss: 0.073 Vali Loss: 3.678 Vali Acc: 0.262 Test Loss: 3.678 Test Acc: 0.262
Validation loss decreased (-0.257610 --> -0.262316).  Saving model ...
Epoch: 40 cost time: 0.6031777858734131
Epoch: 40, Steps: 10 | Train Loss: 0.064 Vali Loss: 3.714 Vali Acc: 0.256 Test Loss: 3.714 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.6361258029937744
Epoch: 41, Steps: 10 | Train Loss: 0.066 Vali Loss: 3.744 Vali Acc: 0.254 Test Loss: 3.744 Test Acc: 0.254
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.6419053077697754
Epoch: 42, Steps: 10 | Train Loss: 0.057 Vali Loss: 3.765 Vali Acc: 0.246 Test Loss: 3.765 Test Acc: 0.246
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.6289041042327881
Epoch: 43, Steps: 10 | Train Loss: 0.049 Vali Loss: 3.769 Vali Acc: 0.255 Test Loss: 3.769 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.6323065757751465
Epoch: 44, Steps: 10 | Train Loss: 0.051 Vali Loss: 3.792 Vali Acc: 0.259 Test Loss: 3.792 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.6404402256011963
Epoch: 45, Steps: 10 | Train Loss: 0.046 Vali Loss: 3.801 Vali Acc: 0.254 Test Loss: 3.801 Test Acc: 0.254
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.6100521087646484
Epoch: 46, Steps: 10 | Train Loss: 0.039 Vali Loss: 3.828 Vali Acc: 0.254 Test Loss: 3.828 Test Acc: 0.254
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.6439802646636963
Epoch: 47, Steps: 10 | Train Loss: 0.040 Vali Loss: 3.853 Vali Acc: 0.252 Test Loss: 3.853 Test Acc: 0.252
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 0.6445116996765137
Epoch: 48, Steps: 10 | Train Loss: 0.036 Vali Loss: 3.881 Vali Acc: 0.252 Test Loss: 3.881 Test Acc: 0.252
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 0.7279391288757324
Epoch: 49, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.898 Vali Acc: 0.252 Test Loss: 3.898 Test Acc: 0.252
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps38_str19_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26235294117647057
model parameter : 73434
model size : 0.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.0437092781066895
Epoch: 1, Steps: 10 | Train Loss: 3.409 Vali Loss: 3.293 Vali Acc: 0.042 Test Loss: 3.293 Test Acc: 0.042
Validation loss decreased (inf --> -0.042320).  Saving model ...
Epoch: 2 cost time: 0.6777913570404053
Epoch: 2, Steps: 10 | Train Loss: 3.147 Vali Loss: 3.267 Vali Acc: 0.061 Test Loss: 3.267 Test Acc: 0.061
Validation loss decreased (-0.042320 --> -0.061144).  Saving model ...
Epoch: 3 cost time: 0.6610000133514404
Epoch: 3, Steps: 10 | Train Loss: 2.772 Vali Loss: 3.259 Vali Acc: 0.106 Test Loss: 3.259 Test Acc: 0.106
Validation loss decreased (-0.061144 --> -0.105850).  Saving model ...
Epoch: 4 cost time: 0.6119024753570557
Epoch: 4, Steps: 10 | Train Loss: 2.367 Vali Loss: 3.236 Vali Acc: 0.139 Test Loss: 3.236 Test Acc: 0.139
Validation loss decreased (-0.105850 --> -0.138791).  Saving model ...
Epoch: 5 cost time: 0.576575756072998
Epoch: 5, Steps: 10 | Train Loss: 1.931 Vali Loss: 3.195 Vali Acc: 0.159 Test Loss: 3.195 Test Acc: 0.159
Validation loss decreased (-0.138791 --> -0.158792).  Saving model ...
Epoch: 6 cost time: 0.6000370979309082
Epoch: 6, Steps: 10 | Train Loss: 1.482 Vali Loss: 3.167 Vali Acc: 0.196 Test Loss: 3.167 Test Acc: 0.196
Validation loss decreased (-0.158792 --> -0.196439).  Saving model ...
Epoch: 7 cost time: 0.6231124401092529
Epoch: 7, Steps: 10 | Train Loss: 1.103 Vali Loss: 3.194 Vali Acc: 0.209 Test Loss: 3.194 Test Acc: 0.209
Validation loss decreased (-0.196439 --> -0.209380).  Saving model ...
Epoch: 8 cost time: 0.6018702983856201
Epoch: 8, Steps: 10 | Train Loss: 0.801 Vali Loss: 3.247 Vali Acc: 0.221 Test Loss: 3.247 Test Acc: 0.221
Validation loss decreased (-0.209380 --> -0.221144).  Saving model ...
Epoch: 9 cost time: 0.6006937026977539
Epoch: 9, Steps: 10 | Train Loss: 0.555 Vali Loss: 3.332 Vali Acc: 0.228 Test Loss: 3.332 Test Acc: 0.228
Validation loss decreased (-0.221144 --> -0.228202).  Saving model ...
Epoch: 10 cost time: 0.5947601795196533
Epoch: 10, Steps: 10 | Train Loss: 0.370 Vali Loss: 3.379 Vali Acc: 0.244 Test Loss: 3.379 Test Acc: 0.244
Validation loss decreased (-0.228202 --> -0.243496).  Saving model ...
Epoch: 11 cost time: 0.5782067775726318
Epoch: 11, Steps: 10 | Train Loss: 0.255 Vali Loss: 3.470 Vali Acc: 0.245 Test Loss: 3.470 Test Acc: 0.245
Validation loss decreased (-0.243496 --> -0.244671).  Saving model ...
Epoch: 12 cost time: 0.5463273525238037
Epoch: 12, Steps: 10 | Train Loss: 0.172 Vali Loss: 3.590 Vali Acc: 0.231 Test Loss: 3.590 Test Acc: 0.231
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5952799320220947
Epoch: 13, Steps: 10 | Train Loss: 0.112 Vali Loss: 3.629 Vali Acc: 0.241 Test Loss: 3.629 Test Acc: 0.241
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6696822643280029
Epoch: 14, Steps: 10 | Train Loss: 0.078 Vali Loss: 3.678 Vali Acc: 0.260 Test Loss: 3.678 Test Acc: 0.260
Validation loss decreased (-0.244671 --> -0.259963).  Saving model ...
Epoch: 15 cost time: 0.6151762008666992
Epoch: 15, Steps: 10 | Train Loss: 0.059 Vali Loss: 3.734 Vali Acc: 0.259 Test Loss: 3.734 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6214964389801025
Epoch: 16, Steps: 10 | Train Loss: 0.045 Vali Loss: 3.793 Vali Acc: 0.254 Test Loss: 3.793 Test Acc: 0.254
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.5587117671966553
Epoch: 17, Steps: 10 | Train Loss: 0.038 Vali Loss: 3.823 Vali Acc: 0.256 Test Loss: 3.823 Test Acc: 0.256
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.617943286895752
Epoch: 18, Steps: 10 | Train Loss: 0.031 Vali Loss: 3.900 Vali Acc: 0.252 Test Loss: 3.900 Test Acc: 0.252
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.5457429885864258
Epoch: 19, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.913 Vali Acc: 0.254 Test Loss: 3.913 Test Acc: 0.254
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.6326701641082764
Epoch: 20, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.934 Vali Acc: 0.255 Test Loss: 3.934 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.6364567279815674
Epoch: 21, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.963 Vali Acc: 0.260 Test Loss: 3.963 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.5969269275665283
Epoch: 22, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.976 Vali Acc: 0.258 Test Loss: 3.976 Test Acc: 0.258
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.6060550212860107
Epoch: 23, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.995 Vali Acc: 0.266 Test Loss: 3.995 Test Acc: 0.266
Validation loss decreased (-0.259963 --> -0.265842).  Saving model ...
Epoch: 24 cost time: 0.6460182666778564
Epoch: 24, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.035 Vali Acc: 0.260 Test Loss: 4.035 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.5947492122650146
Epoch: 25, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.057 Vali Acc: 0.259 Test Loss: 4.057 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.596776008605957
Epoch: 26, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.062 Vali Acc: 0.266 Test Loss: 4.062 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.6153850555419922
Epoch: 27, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.080 Vali Acc: 0.266 Test Loss: 4.080 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.6413793563842773
Epoch: 28, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.109 Vali Acc: 0.267 Test Loss: 4.109 Test Acc: 0.267
Validation loss decreased (-0.265842 --> -0.267018).  Saving model ...
Epoch: 29 cost time: 0.626755952835083
Epoch: 29, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.147 Vali Acc: 0.260 Test Loss: 4.147 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.5683584213256836
Epoch: 30, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.162 Vali Acc: 0.261 Test Loss: 4.162 Test Acc: 0.261
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.6054651737213135
Epoch: 31, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.172 Vali Acc: 0.262 Test Loss: 4.172 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.5869042873382568
Epoch: 32, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.196 Vali Acc: 0.264 Test Loss: 4.196 Test Acc: 0.264
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.6321399211883545
Epoch: 33, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.230 Vali Acc: 0.264 Test Loss: 4.230 Test Acc: 0.264
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.6066362857818604
Epoch: 34, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.251 Vali Acc: 0.264 Test Loss: 4.251 Test Acc: 0.264
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.5539941787719727
Epoch: 35, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.264 Vali Acc: 0.264 Test Loss: 4.264 Test Acc: 0.264
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.6111512184143066
Epoch: 36, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.286 Vali Acc: 0.265 Test Loss: 4.286 Test Acc: 0.265
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.6727886199951172
Epoch: 37, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.305 Vali Acc: 0.266 Test Loss: 4.305 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.6368019580841064
Epoch: 38, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.319 Vali Acc: 0.265 Test Loss: 4.319 Test Acc: 0.265
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps4_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26705882352941174
model parameter : 199226
model size : 0.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.8479223251342773
Epoch: 1, Steps: 10 | Train Loss: 3.336 Vali Loss: 3.294 Vali Acc: 0.058 Test Loss: 3.294 Test Acc: 0.058
Validation loss decreased (inf --> -0.057614).  Saving model ...
Epoch: 2 cost time: 0.6793649196624756
Epoch: 2, Steps: 10 | Train Loss: 3.200 Vali Loss: 3.274 Vali Acc: 0.072 Test Loss: 3.274 Test Acc: 0.072
Validation loss decreased (-0.057614 --> -0.071732).  Saving model ...
Epoch: 3 cost time: 0.6487207412719727
Epoch: 3, Steps: 10 | Train Loss: 2.945 Vali Loss: 3.260 Vali Acc: 0.087 Test Loss: 3.260 Test Acc: 0.087
Validation loss decreased (-0.071732 --> -0.087026).  Saving model ...
Epoch: 4 cost time: 0.6991386413574219
Epoch: 4, Steps: 10 | Train Loss: 2.681 Vali Loss: 3.254 Vali Acc: 0.099 Test Loss: 3.254 Test Acc: 0.099
Validation loss decreased (-0.087026 --> -0.098791).  Saving model ...
Epoch: 5 cost time: 0.666602611541748
Epoch: 5, Steps: 10 | Train Loss: 2.445 Vali Loss: 3.243 Vali Acc: 0.108 Test Loss: 3.243 Test Acc: 0.108
Validation loss decreased (-0.098791 --> -0.108203).  Saving model ...
Epoch: 6 cost time: 0.6275572776794434
Epoch: 6, Steps: 10 | Train Loss: 2.166 Vali Loss: 3.218 Vali Acc: 0.125 Test Loss: 3.218 Test Acc: 0.125
Validation loss decreased (-0.108203 --> -0.124674).  Saving model ...
Epoch: 7 cost time: 0.578495979309082
Epoch: 7, Steps: 10 | Train Loss: 1.907 Vali Loss: 3.194 Vali Acc: 0.149 Test Loss: 3.194 Test Acc: 0.149
Validation loss decreased (-0.124674 --> -0.149380).  Saving model ...
Epoch: 8 cost time: 0.6272034645080566
Epoch: 8, Steps: 10 | Train Loss: 1.642 Vali Loss: 3.185 Vali Acc: 0.165 Test Loss: 3.185 Test Acc: 0.165
Validation loss decreased (-0.149380 --> -0.164674).  Saving model ...
Epoch: 9 cost time: 0.618457555770874
Epoch: 9, Steps: 10 | Train Loss: 1.356 Vali Loss: 3.182 Vali Acc: 0.182 Test Loss: 3.182 Test Acc: 0.182
Validation loss decreased (-0.164674 --> -0.182321).  Saving model ...
Epoch: 10 cost time: 0.6168432235717773
Epoch: 10, Steps: 10 | Train Loss: 1.134 Vali Loss: 3.190 Vali Acc: 0.196 Test Loss: 3.190 Test Acc: 0.196
Validation loss decreased (-0.182321 --> -0.196439).  Saving model ...
Epoch: 11 cost time: 0.5863971710205078
Epoch: 11, Steps: 10 | Train Loss: 0.946 Vali Loss: 3.213 Vali Acc: 0.216 Test Loss: 3.213 Test Acc: 0.216
Validation loss decreased (-0.196439 --> -0.216438).  Saving model ...
Epoch: 12 cost time: 0.6197149753570557
Epoch: 12, Steps: 10 | Train Loss: 0.758 Vali Loss: 3.234 Vali Acc: 0.219 Test Loss: 3.234 Test Acc: 0.219
Validation loss decreased (-0.216438 --> -0.218791).  Saving model ...
Epoch: 13 cost time: 0.5714268684387207
Epoch: 13, Steps: 10 | Train Loss: 0.644 Vali Loss: 3.275 Vali Acc: 0.227 Test Loss: 3.275 Test Acc: 0.227
Validation loss decreased (-0.218791 --> -0.227026).  Saving model ...
Epoch: 14 cost time: 0.6121237277984619
Epoch: 14, Steps: 10 | Train Loss: 0.482 Vali Loss: 3.323 Vali Acc: 0.235 Test Loss: 3.323 Test Acc: 0.235
Validation loss decreased (-0.227026 --> -0.235261).  Saving model ...
Epoch: 15 cost time: 0.6232166290283203
Epoch: 15, Steps: 10 | Train Loss: 0.365 Vali Loss: 3.381 Vali Acc: 0.247 Test Loss: 3.381 Test Acc: 0.247
Validation loss decreased (-0.235261 --> -0.247025).  Saving model ...
Epoch: 16 cost time: 0.646547794342041
Epoch: 16, Steps: 10 | Train Loss: 0.280 Vali Loss: 3.427 Vali Acc: 0.244 Test Loss: 3.427 Test Acc: 0.244
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6089789867401123
Epoch: 17, Steps: 10 | Train Loss: 0.228 Vali Loss: 3.482 Vali Acc: 0.244 Test Loss: 3.482 Test Acc: 0.244
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.6161129474639893
Epoch: 18, Steps: 10 | Train Loss: 0.188 Vali Loss: 3.506 Vali Acc: 0.253 Test Loss: 3.506 Test Acc: 0.253
Validation loss decreased (-0.247025 --> -0.252906).  Saving model ...
Epoch: 19 cost time: 0.6216213703155518
Epoch: 19, Steps: 10 | Train Loss: 0.143 Vali Loss: 3.558 Vali Acc: 0.252 Test Loss: 3.558 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5742230415344238
Epoch: 20, Steps: 10 | Train Loss: 0.119 Vali Loss: 3.585 Vali Acc: 0.247 Test Loss: 3.585 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.551971435546875
Epoch: 21, Steps: 10 | Train Loss: 0.101 Vali Loss: 3.620 Vali Acc: 0.253 Test Loss: 3.620 Test Acc: 0.253
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.6361875534057617
Epoch: 22, Steps: 10 | Train Loss: 0.081 Vali Loss: 3.661 Vali Acc: 0.253 Test Loss: 3.661 Test Acc: 0.253
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.6614797115325928
Epoch: 23, Steps: 10 | Train Loss: 0.075 Vali Loss: 3.687 Vali Acc: 0.251 Test Loss: 3.687 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.6290609836578369
Epoch: 24, Steps: 10 | Train Loss: 0.067 Vali Loss: 3.706 Vali Acc: 0.252 Test Loss: 3.706 Test Acc: 0.252
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.5951492786407471
Epoch: 25, Steps: 10 | Train Loss: 0.057 Vali Loss: 3.745 Vali Acc: 0.255 Test Loss: 3.745 Test Acc: 0.255
Validation loss decreased (-0.252906 --> -0.255257).  Saving model ...
Epoch: 26 cost time: 0.6343026161193848
Epoch: 26, Steps: 10 | Train Loss: 0.048 Vali Loss: 3.766 Vali Acc: 0.252 Test Loss: 3.766 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.6022589206695557
Epoch: 27, Steps: 10 | Train Loss: 0.044 Vali Loss: 3.786 Vali Acc: 0.251 Test Loss: 3.786 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.6010861396789551
Epoch: 28, Steps: 10 | Train Loss: 0.043 Vali Loss: 3.815 Vali Acc: 0.254 Test Loss: 3.815 Test Acc: 0.254
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.6225454807281494
Epoch: 29, Steps: 10 | Train Loss: 0.037 Vali Loss: 3.859 Vali Acc: 0.252 Test Loss: 3.859 Test Acc: 0.252
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.596919059753418
Epoch: 30, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.873 Vali Acc: 0.254 Test Loss: 3.873 Test Acc: 0.254
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.6446783542633057
Epoch: 31, Steps: 10 | Train Loss: 0.031 Vali Loss: 3.881 Vali Acc: 0.255 Test Loss: 3.881 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.6949794292449951
Epoch: 32, Steps: 10 | Train Loss: 0.027 Vali Loss: 3.898 Vali Acc: 0.259 Test Loss: 3.898 Test Acc: 0.259
Validation loss decreased (-0.255257 --> -0.258785).  Saving model ...
Epoch: 33 cost time: 0.6368486881256104
Epoch: 33, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.916 Vali Acc: 0.259 Test Loss: 3.916 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.6306869983673096
Epoch: 34, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.929 Vali Acc: 0.258 Test Loss: 3.929 Test Acc: 0.258
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.6234714984893799
Epoch: 35, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.955 Vali Acc: 0.253 Test Loss: 3.955 Test Acc: 0.253
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.5866920948028564
Epoch: 36, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.969 Vali Acc: 0.253 Test Loss: 3.969 Test Acc: 0.253
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.6055011749267578
Epoch: 37, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.983 Vali Acc: 0.252 Test Loss: 3.983 Test Acc: 0.252
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.6102128028869629
Epoch: 38, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.011 Vali Acc: 0.254 Test Loss: 4.011 Test Acc: 0.254
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.6141610145568848
Epoch: 39, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.031 Vali Acc: 0.259 Test Loss: 4.031 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.5990753173828125
Epoch: 40, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.050 Vali Acc: 0.256 Test Loss: 4.050 Test Acc: 0.256
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.5595409870147705
Epoch: 41, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.071 Vali Acc: 0.256 Test Loss: 4.071 Test Acc: 0.256
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.588620662689209
Epoch: 42, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.081 Vali Acc: 0.253 Test Loss: 4.081 Test Acc: 0.253
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.25882352941176473
model parameter : 104506
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps12_str6_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.7427523136138916
Epoch: 1, Steps: 10 | Train Loss: 3.389 Vali Loss: 3.305 Vali Acc: 0.044 Test Loss: 3.305 Test Acc: 0.044
Validation loss decreased (inf --> -0.043496).  Saving model ...
Epoch: 2 cost time: 0.6293349266052246
Epoch: 2, Steps: 10 | Train Loss: 3.299 Vali Loss: 3.304 Vali Acc: 0.053 Test Loss: 3.304 Test Acc: 0.053
Validation loss decreased (-0.043496 --> -0.052908).  Saving model ...
Epoch: 3 cost time: 0.6339237689971924
Epoch: 3, Steps: 10 | Train Loss: 3.105 Vali Loss: 3.298 Vali Acc: 0.069 Test Loss: 3.298 Test Acc: 0.069
Validation loss decreased (-0.052908 --> -0.069379).  Saving model ...
Epoch: 4 cost time: 0.6425871849060059
Epoch: 4, Steps: 10 | Train Loss: 2.931 Vali Loss: 3.287 Vali Acc: 0.086 Test Loss: 3.287 Test Acc: 0.086
Validation loss decreased (-0.069379 --> -0.085849).  Saving model ...
Epoch: 5 cost time: 0.630692720413208
Epoch: 5, Steps: 10 | Train Loss: 2.739 Vali Loss: 3.273 Vali Acc: 0.098 Test Loss: 3.273 Test Acc: 0.098
Validation loss decreased (-0.085849 --> -0.097614).  Saving model ...
Epoch: 6 cost time: 0.648961067199707
Epoch: 6, Steps: 10 | Train Loss: 2.556 Vali Loss: 3.258 Vali Acc: 0.113 Test Loss: 3.258 Test Acc: 0.113
Validation loss decreased (-0.097614 --> -0.112909).  Saving model ...
Epoch: 7 cost time: 0.6295950412750244
Epoch: 7, Steps: 10 | Train Loss: 2.349 Vali Loss: 3.239 Vali Acc: 0.120 Test Loss: 3.239 Test Acc: 0.120
Validation loss decreased (-0.112909 --> -0.119968).  Saving model ...
Epoch: 8 cost time: 0.6221771240234375
Epoch: 8, Steps: 10 | Train Loss: 2.127 Vali Loss: 3.205 Vali Acc: 0.148 Test Loss: 3.205 Test Acc: 0.148
Validation loss decreased (-0.119968 --> -0.148203).  Saving model ...
Epoch: 9 cost time: 0.6411311626434326
Epoch: 9, Steps: 10 | Train Loss: 1.909 Vali Loss: 3.201 Vali Acc: 0.152 Test Loss: 3.201 Test Acc: 0.152
Validation loss decreased (-0.148203 --> -0.151733).  Saving model ...
Epoch: 10 cost time: 0.6263158321380615
Epoch: 10, Steps: 10 | Train Loss: 1.666 Vali Loss: 3.190 Vali Acc: 0.167 Test Loss: 3.190 Test Acc: 0.167
Validation loss decreased (-0.151733 --> -0.167027).  Saving model ...
Epoch: 11 cost time: 0.6605682373046875
Epoch: 11, Steps: 10 | Train Loss: 1.507 Vali Loss: 3.193 Vali Acc: 0.169 Test Loss: 3.193 Test Acc: 0.169
Validation loss decreased (-0.167027 --> -0.169380).  Saving model ...
Epoch: 12 cost time: 0.6424963474273682
Epoch: 12, Steps: 10 | Train Loss: 1.309 Vali Loss: 3.201 Vali Acc: 0.191 Test Loss: 3.201 Test Acc: 0.191
Validation loss decreased (-0.169380 --> -0.190556).  Saving model ...
Epoch: 13 cost time: 0.6348378658294678
Epoch: 13, Steps: 10 | Train Loss: 1.103 Vali Loss: 3.197 Vali Acc: 0.192 Test Loss: 3.197 Test Acc: 0.192
Validation loss decreased (-0.190556 --> -0.191733).  Saving model ...
Epoch: 14 cost time: 0.6398558616638184
Epoch: 14, Steps: 10 | Train Loss: 0.954 Vali Loss: 3.197 Vali Acc: 0.208 Test Loss: 3.197 Test Acc: 0.208
Validation loss decreased (-0.191733 --> -0.208203).  Saving model ...
Epoch: 15 cost time: 0.6469957828521729
Epoch: 15, Steps: 10 | Train Loss: 0.793 Vali Loss: 3.222 Vali Acc: 0.216 Test Loss: 3.222 Test Acc: 0.216
Validation loss decreased (-0.208203 --> -0.216438).  Saving model ...
Epoch: 16 cost time: 0.6373071670532227
Epoch: 16, Steps: 10 | Train Loss: 0.675 Vali Loss: 3.262 Vali Acc: 0.224 Test Loss: 3.262 Test Acc: 0.224
Validation loss decreased (-0.216438 --> -0.223497).  Saving model ...
Epoch: 17 cost time: 0.5767550468444824
Epoch: 17, Steps: 10 | Train Loss: 0.591 Vali Loss: 3.286 Vali Acc: 0.239 Test Loss: 3.286 Test Acc: 0.239
Validation loss decreased (-0.223497 --> -0.238791).  Saving model ...
Epoch: 18 cost time: 0.5960135459899902
Epoch: 18, Steps: 10 | Train Loss: 0.450 Vali Loss: 3.328 Vali Acc: 0.240 Test Loss: 3.328 Test Acc: 0.240
Validation loss decreased (-0.238791 --> -0.239967).  Saving model ...
Epoch: 19 cost time: 0.7185473442077637
Epoch: 19, Steps: 10 | Train Loss: 0.359 Vali Loss: 3.376 Vali Acc: 0.236 Test Loss: 3.376 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6636865139007568
Epoch: 20, Steps: 10 | Train Loss: 0.304 Vali Loss: 3.398 Vali Acc: 0.242 Test Loss: 3.398 Test Acc: 0.242
Validation loss decreased (-0.239967 --> -0.242319).  Saving model ...
Epoch: 21 cost time: 0.6605219841003418
Epoch: 21, Steps: 10 | Train Loss: 0.244 Vali Loss: 3.435 Vali Acc: 0.238 Test Loss: 3.435 Test Acc: 0.238
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6329300403594971
Epoch: 22, Steps: 10 | Train Loss: 0.205 Vali Loss: 3.463 Vali Acc: 0.244 Test Loss: 3.463 Test Acc: 0.244
Validation loss decreased (-0.242319 --> -0.243495).  Saving model ...
Epoch: 23 cost time: 0.6322791576385498
Epoch: 23, Steps: 10 | Train Loss: 0.170 Vali Loss: 3.503 Vali Acc: 0.246 Test Loss: 3.503 Test Acc: 0.246
Validation loss decreased (-0.243495 --> -0.245847).  Saving model ...
Epoch: 24 cost time: 0.5723466873168945
Epoch: 24, Steps: 10 | Train Loss: 0.158 Vali Loss: 3.546 Vali Acc: 0.240 Test Loss: 3.546 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.627194881439209
Epoch: 25, Steps: 10 | Train Loss: 0.139 Vali Loss: 3.569 Vali Acc: 0.244 Test Loss: 3.569 Test Acc: 0.244
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.6476879119873047
Epoch: 26, Steps: 10 | Train Loss: 0.116 Vali Loss: 3.590 Vali Acc: 0.251 Test Loss: 3.590 Test Acc: 0.251
Validation loss decreased (-0.245847 --> -0.250552).  Saving model ...
Epoch: 27 cost time: 0.6442945003509521
Epoch: 27, Steps: 10 | Train Loss: 0.107 Vali Loss: 3.626 Vali Acc: 0.248 Test Loss: 3.626 Test Acc: 0.248
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6650967597961426
Epoch: 28, Steps: 10 | Train Loss: 0.093 Vali Loss: 3.656 Vali Acc: 0.253 Test Loss: 3.656 Test Acc: 0.253
Validation loss decreased (-0.250552 --> -0.252905).  Saving model ...
Epoch: 29 cost time: 0.6428883075714111
Epoch: 29, Steps: 10 | Train Loss: 0.081 Vali Loss: 3.690 Vali Acc: 0.247 Test Loss: 3.690 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.6282544136047363
Epoch: 30, Steps: 10 | Train Loss: 0.073 Vali Loss: 3.724 Vali Acc: 0.241 Test Loss: 3.724 Test Acc: 0.241
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.6188020706176758
Epoch: 31, Steps: 10 | Train Loss: 0.065 Vali Loss: 3.733 Vali Acc: 0.241 Test Loss: 3.733 Test Acc: 0.241
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.6566245555877686
Epoch: 32, Steps: 10 | Train Loss: 0.057 Vali Loss: 3.749 Vali Acc: 0.245 Test Loss: 3.749 Test Acc: 0.245
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.6780514717102051
Epoch: 33, Steps: 10 | Train Loss: 0.052 Vali Loss: 3.771 Vali Acc: 0.247 Test Loss: 3.771 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.6434476375579834
Epoch: 34, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.792 Vali Acc: 0.247 Test Loss: 3.792 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.6627111434936523
Epoch: 35, Steps: 10 | Train Loss: 0.044 Vali Loss: 3.815 Vali Acc: 0.246 Test Loss: 3.815 Test Acc: 0.246
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.655419111251831
Epoch: 36, Steps: 10 | Train Loss: 0.039 Vali Loss: 3.847 Vali Acc: 0.244 Test Loss: 3.847 Test Acc: 0.244
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.6646370887756348
Epoch: 37, Steps: 10 | Train Loss: 0.038 Vali Loss: 3.856 Vali Acc: 0.242 Test Loss: 3.856 Test Acc: 0.242
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.6330358982086182
Epoch: 38, Steps: 10 | Train Loss: 0.035 Vali Loss: 3.871 Vali Acc: 0.245 Test Loss: 3.871 Test Acc: 0.245
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps12_str6_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2529411764705882
model parameter : 72186
model size : 0.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps16_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.7388978004455566
Epoch: 1, Steps: 10 | Train Loss: 3.331 Vali Loss: 3.303 Vali Acc: 0.034 Test Loss: 3.303 Test Acc: 0.034
Validation loss decreased (inf --> -0.034085).  Saving model ...
Epoch: 2 cost time: 0.6206634044647217
Epoch: 2, Steps: 10 | Train Loss: 3.254 Vali Loss: 3.302 Vali Acc: 0.045 Test Loss: 3.302 Test Acc: 0.045
Validation loss decreased (-0.034085 --> -0.044673).  Saving model ...
Epoch: 3 cost time: 0.6054134368896484
Epoch: 3, Steps: 10 | Train Loss: 3.152 Vali Loss: 3.291 Vali Acc: 0.054 Test Loss: 3.291 Test Acc: 0.054
Validation loss decreased (-0.044673 --> -0.054085).  Saving model ...
Epoch: 4 cost time: 0.6473689079284668
Epoch: 4, Steps: 10 | Train Loss: 3.010 Vali Loss: 3.278 Vali Acc: 0.062 Test Loss: 3.278 Test Acc: 0.062
Validation loss decreased (-0.054085 --> -0.062320).  Saving model ...
Epoch: 5 cost time: 0.6581666469573975
Epoch: 5, Steps: 10 | Train Loss: 2.847 Vali Loss: 3.269 Vali Acc: 0.069 Test Loss: 3.269 Test Acc: 0.069
Validation loss decreased (-0.062320 --> -0.069379).  Saving model ...
Epoch: 6 cost time: 0.6339399814605713
Epoch: 6, Steps: 10 | Train Loss: 2.675 Vali Loss: 3.252 Vali Acc: 0.081 Test Loss: 3.252 Test Acc: 0.081
Validation loss decreased (-0.069379 --> -0.081144).  Saving model ...
Epoch: 7 cost time: 0.6097838878631592
Epoch: 7, Steps: 10 | Train Loss: 2.509 Vali Loss: 3.238 Vali Acc: 0.104 Test Loss: 3.238 Test Acc: 0.104
Validation loss decreased (-0.081144 --> -0.103497).  Saving model ...
Epoch: 8 cost time: 0.6327927112579346
Epoch: 8, Steps: 10 | Train Loss: 2.311 Vali Loss: 3.219 Vali Acc: 0.119 Test Loss: 3.219 Test Acc: 0.119
Validation loss decreased (-0.103497 --> -0.118791).  Saving model ...
Epoch: 9 cost time: 0.6295609474182129
Epoch: 9, Steps: 10 | Train Loss: 2.165 Vali Loss: 3.209 Vali Acc: 0.122 Test Loss: 3.209 Test Acc: 0.122
Validation loss decreased (-0.118791 --> -0.122321).  Saving model ...
Epoch: 10 cost time: 0.6318252086639404
Epoch: 10, Steps: 10 | Train Loss: 1.993 Vali Loss: 3.192 Vali Acc: 0.140 Test Loss: 3.192 Test Acc: 0.140
Validation loss decreased (-0.122321 --> -0.139968).  Saving model ...
Epoch: 11 cost time: 0.6356158256530762
Epoch: 11, Steps: 10 | Train Loss: 1.836 Vali Loss: 3.190 Vali Acc: 0.151 Test Loss: 3.190 Test Acc: 0.151
Validation loss decreased (-0.139968 --> -0.150556).  Saving model ...
Epoch: 12 cost time: 0.6522226333618164
Epoch: 12, Steps: 10 | Train Loss: 1.639 Vali Loss: 3.182 Vali Acc: 0.167 Test Loss: 3.182 Test Acc: 0.167
Validation loss decreased (-0.150556 --> -0.167027).  Saving model ...
Epoch: 13 cost time: 0.6431241035461426
Epoch: 13, Steps: 10 | Train Loss: 1.462 Vali Loss: 3.179 Vali Acc: 0.180 Test Loss: 3.179 Test Acc: 0.180
Validation loss decreased (-0.167027 --> -0.179968).  Saving model ...
Epoch: 14 cost time: 0.6368205547332764
Epoch: 14, Steps: 10 | Train Loss: 1.336 Vali Loss: 3.180 Vali Acc: 0.187 Test Loss: 3.180 Test Acc: 0.187
Validation loss decreased (-0.179968 --> -0.187027).  Saving model ...
Epoch: 15 cost time: 0.6567819118499756
Epoch: 15, Steps: 10 | Train Loss: 1.182 Vali Loss: 3.180 Vali Acc: 0.195 Test Loss: 3.180 Test Acc: 0.195
Validation loss decreased (-0.187027 --> -0.195262).  Saving model ...
Epoch: 16 cost time: 0.6070923805236816
Epoch: 16, Steps: 10 | Train Loss: 1.026 Vali Loss: 3.195 Vali Acc: 0.209 Test Loss: 3.195 Test Acc: 0.209
Validation loss decreased (-0.195262 --> -0.209380).  Saving model ...
Epoch: 17 cost time: 0.6323237419128418
Epoch: 17, Steps: 10 | Train Loss: 0.905 Vali Loss: 3.213 Vali Acc: 0.208 Test Loss: 3.213 Test Acc: 0.208
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6339631080627441
Epoch: 18, Steps: 10 | Train Loss: 0.777 Vali Loss: 3.225 Vali Acc: 0.218 Test Loss: 3.225 Test Acc: 0.218
Validation loss decreased (-0.209380 --> -0.217615).  Saving model ...
Epoch: 19 cost time: 0.6385674476623535
Epoch: 19, Steps: 10 | Train Loss: 0.667 Vali Loss: 3.241 Vali Acc: 0.228 Test Loss: 3.241 Test Acc: 0.228
Validation loss decreased (-0.217615 --> -0.228203).  Saving model ...
Epoch: 20 cost time: 0.6495966911315918
Epoch: 20, Steps: 10 | Train Loss: 0.580 Vali Loss: 3.289 Vali Acc: 0.227 Test Loss: 3.289 Test Acc: 0.227
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6394953727722168
Epoch: 21, Steps: 10 | Train Loss: 0.501 Vali Loss: 3.325 Vali Acc: 0.233 Test Loss: 3.325 Test Acc: 0.233
Validation loss decreased (-0.228203 --> -0.232908).  Saving model ...
Epoch: 22 cost time: 0.5969929695129395
Epoch: 22, Steps: 10 | Train Loss: 0.431 Vali Loss: 3.351 Vali Acc: 0.239 Test Loss: 3.351 Test Acc: 0.239
Validation loss decreased (-0.232908 --> -0.238790).  Saving model ...
Epoch: 23 cost time: 0.6387779712677002
Epoch: 23, Steps: 10 | Train Loss: 0.363 Vali Loss: 3.382 Vali Acc: 0.234 Test Loss: 3.382 Test Acc: 0.234
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6527976989746094
Epoch: 24, Steps: 10 | Train Loss: 0.311 Vali Loss: 3.413 Vali Acc: 0.240 Test Loss: 3.413 Test Acc: 0.240
Validation loss decreased (-0.238790 --> -0.239966).  Saving model ...
Epoch: 25 cost time: 0.6661779880523682
Epoch: 25, Steps: 10 | Train Loss: 0.264 Vali Loss: 3.427 Vali Acc: 0.253 Test Loss: 3.427 Test Acc: 0.253
Validation loss decreased (-0.239966 --> -0.252907).  Saving model ...
Epoch: 26 cost time: 0.6450397968292236
Epoch: 26, Steps: 10 | Train Loss: 0.235 Vali Loss: 3.463 Vali Acc: 0.253 Test Loss: 3.463 Test Acc: 0.253
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.6210947036743164
Epoch: 27, Steps: 10 | Train Loss: 0.201 Vali Loss: 3.491 Vali Acc: 0.252 Test Loss: 3.491 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.6450076103210449
Epoch: 28, Steps: 10 | Train Loss: 0.188 Vali Loss: 3.520 Vali Acc: 0.253 Test Loss: 3.520 Test Acc: 0.253
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.6262612342834473
Epoch: 29, Steps: 10 | Train Loss: 0.159 Vali Loss: 3.549 Vali Acc: 0.253 Test Loss: 3.549 Test Acc: 0.253
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.638404369354248
Epoch: 30, Steps: 10 | Train Loss: 0.142 Vali Loss: 3.580 Vali Acc: 0.252 Test Loss: 3.580 Test Acc: 0.252
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.6678957939147949
Epoch: 31, Steps: 10 | Train Loss: 0.129 Vali Loss: 3.626 Vali Acc: 0.249 Test Loss: 3.626 Test Acc: 0.249
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.6373188495635986
Epoch: 32, Steps: 10 | Train Loss: 0.113 Vali Loss: 3.641 Vali Acc: 0.251 Test Loss: 3.641 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.7030429840087891
Epoch: 33, Steps: 10 | Train Loss: 0.101 Vali Loss: 3.653 Vali Acc: 0.251 Test Loss: 3.653 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.6025657653808594
Epoch: 34, Steps: 10 | Train Loss: 0.092 Vali Loss: 3.681 Vali Acc: 0.253 Test Loss: 3.681 Test Acc: 0.253
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.6081130504608154
Epoch: 35, Steps: 10 | Train Loss: 0.082 Vali Loss: 3.709 Vali Acc: 0.251 Test Loss: 3.709 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps16_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2529411764705882
model parameter : 57338
model size : 0.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps23_str12_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.773613691329956
Epoch: 1, Steps: 10 | Train Loss: 3.361 Vali Loss: 3.287 Vali Acc: 0.027 Test Loss: 3.287 Test Acc: 0.027
Validation loss decreased (inf --> -0.027026).  Saving model ...
Epoch: 2 cost time: 0.6199300289154053
Epoch: 2, Steps: 10 | Train Loss: 3.278 Vali Loss: 3.288 Vali Acc: 0.029 Test Loss: 3.288 Test Acc: 0.029
Validation loss decreased (-0.027026 --> -0.029379).  Saving model ...
Epoch: 3 cost time: 0.6273975372314453
Epoch: 3, Steps: 10 | Train Loss: 3.206 Vali Loss: 3.283 Vali Acc: 0.032 Test Loss: 3.283 Test Acc: 0.032
Validation loss decreased (-0.029379 --> -0.031732).  Saving model ...
Epoch: 4 cost time: 0.628380537033081
Epoch: 4, Steps: 10 | Train Loss: 3.098 Vali Loss: 3.273 Vali Acc: 0.040 Test Loss: 3.273 Test Acc: 0.040
Validation loss decreased (-0.031732 --> -0.039967).  Saving model ...
Epoch: 5 cost time: 0.6050500869750977
Epoch: 5, Steps: 10 | Train Loss: 2.991 Vali Loss: 3.264 Vali Acc: 0.051 Test Loss: 3.264 Test Acc: 0.051
Validation loss decreased (-0.039967 --> -0.050556).  Saving model ...
Epoch: 6 cost time: 0.6542775630950928
Epoch: 6, Steps: 10 | Train Loss: 2.879 Vali Loss: 3.250 Vali Acc: 0.074 Test Loss: 3.250 Test Acc: 0.074
Validation loss decreased (-0.050556 --> -0.074085).  Saving model ...
Epoch: 7 cost time: 0.6213617324829102
Epoch: 7, Steps: 10 | Train Loss: 2.774 Vali Loss: 3.239 Vali Acc: 0.081 Test Loss: 3.239 Test Acc: 0.081
Validation loss decreased (-0.074085 --> -0.081144).  Saving model ...
Epoch: 8 cost time: 0.6547138690948486
Epoch: 8, Steps: 10 | Train Loss: 2.666 Vali Loss: 3.228 Vali Acc: 0.087 Test Loss: 3.228 Test Acc: 0.087
Validation loss decreased (-0.081144 --> -0.087027).  Saving model ...
Epoch: 9 cost time: 0.6354835033416748
Epoch: 9, Steps: 10 | Train Loss: 2.514 Vali Loss: 3.214 Vali Acc: 0.095 Test Loss: 3.214 Test Acc: 0.095
Validation loss decreased (-0.087027 --> -0.095262).  Saving model ...
Epoch: 10 cost time: 0.6347346305847168
Epoch: 10, Steps: 10 | Train Loss: 2.403 Vali Loss: 3.202 Vali Acc: 0.111 Test Loss: 3.202 Test Acc: 0.111
Validation loss decreased (-0.095262 --> -0.110556).  Saving model ...
Epoch: 11 cost time: 0.6081538200378418
Epoch: 11, Steps: 10 | Train Loss: 2.253 Vali Loss: 3.185 Vali Acc: 0.119 Test Loss: 3.185 Test Acc: 0.119
Validation loss decreased (-0.110556 --> -0.118792).  Saving model ...
Epoch: 12 cost time: 0.6304492950439453
Epoch: 12, Steps: 10 | Train Loss: 2.124 Vali Loss: 3.174 Vali Acc: 0.124 Test Loss: 3.174 Test Acc: 0.124
Validation loss decreased (-0.118792 --> -0.123498).  Saving model ...
Epoch: 13 cost time: 0.6235780715942383
Epoch: 13, Steps: 10 | Train Loss: 2.003 Vali Loss: 3.168 Vali Acc: 0.133 Test Loss: 3.168 Test Acc: 0.133
Validation loss decreased (-0.123498 --> -0.132909).  Saving model ...
Epoch: 14 cost time: 0.6378042697906494
Epoch: 14, Steps: 10 | Train Loss: 1.831 Vali Loss: 3.162 Vali Acc: 0.141 Test Loss: 3.162 Test Acc: 0.141
Validation loss decreased (-0.132909 --> -0.141145).  Saving model ...
Epoch: 15 cost time: 0.6420505046844482
Epoch: 15, Steps: 10 | Train Loss: 1.717 Vali Loss: 3.154 Vali Acc: 0.155 Test Loss: 3.154 Test Acc: 0.155
Validation loss decreased (-0.141145 --> -0.155263).  Saving model ...
Epoch: 16 cost time: 0.641768217086792
Epoch: 16, Steps: 10 | Train Loss: 1.576 Vali Loss: 3.153 Vali Acc: 0.158 Test Loss: 3.153 Test Acc: 0.158
Validation loss decreased (-0.155263 --> -0.157616).  Saving model ...
Epoch: 17 cost time: 0.6374890804290771
Epoch: 17, Steps: 10 | Train Loss: 1.463 Vali Loss: 3.150 Vali Acc: 0.166 Test Loss: 3.150 Test Acc: 0.166
Validation loss decreased (-0.157616 --> -0.165851).  Saving model ...
Epoch: 18 cost time: 0.6485297679901123
Epoch: 18, Steps: 10 | Train Loss: 1.341 Vali Loss: 3.154 Vali Acc: 0.178 Test Loss: 3.154 Test Acc: 0.178
Validation loss decreased (-0.165851 --> -0.177616).  Saving model ...
Epoch: 19 cost time: 0.6526601314544678
Epoch: 19, Steps: 10 | Train Loss: 1.233 Vali Loss: 3.160 Vali Acc: 0.188 Test Loss: 3.160 Test Acc: 0.188
Validation loss decreased (-0.177616 --> -0.188204).  Saving model ...
Epoch: 20 cost time: 0.6519548892974854
Epoch: 20, Steps: 10 | Train Loss: 1.068 Vali Loss: 3.165 Vali Acc: 0.199 Test Loss: 3.165 Test Acc: 0.199
Validation loss decreased (-0.188204 --> -0.198792).  Saving model ...
Epoch: 21 cost time: 0.6481359004974365
Epoch: 21, Steps: 10 | Train Loss: 0.979 Vali Loss: 3.171 Vali Acc: 0.200 Test Loss: 3.171 Test Acc: 0.200
Validation loss decreased (-0.198792 --> -0.199968).  Saving model ...
Epoch: 22 cost time: 0.6227972507476807
Epoch: 22, Steps: 10 | Train Loss: 0.880 Vali Loss: 3.179 Vali Acc: 0.207 Test Loss: 3.179 Test Acc: 0.207
Validation loss decreased (-0.199968 --> -0.207027).  Saving model ...
Epoch: 23 cost time: 0.588529109954834
Epoch: 23, Steps: 10 | Train Loss: 0.767 Vali Loss: 3.197 Vali Acc: 0.214 Test Loss: 3.197 Test Acc: 0.214
Validation loss decreased (-0.207027 --> -0.214086).  Saving model ...
Epoch: 24 cost time: 0.6012208461761475
Epoch: 24, Steps: 10 | Train Loss: 0.721 Vali Loss: 3.213 Vali Acc: 0.219 Test Loss: 3.213 Test Acc: 0.219
Validation loss decreased (-0.214086 --> -0.218791).  Saving model ...
Epoch: 25 cost time: 0.6706042289733887
Epoch: 25, Steps: 10 | Train Loss: 0.617 Vali Loss: 3.240 Vali Acc: 0.219 Test Loss: 3.240 Test Acc: 0.219
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6657187938690186
Epoch: 26, Steps: 10 | Train Loss: 0.547 Vali Loss: 3.253 Vali Acc: 0.219 Test Loss: 3.253 Test Acc: 0.219
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.6204178333282471
Epoch: 27, Steps: 10 | Train Loss: 0.511 Vali Loss: 3.274 Vali Acc: 0.231 Test Loss: 3.274 Test Acc: 0.231
Validation loss decreased (-0.218791 --> -0.230555).  Saving model ...
Epoch: 28 cost time: 0.6176869869232178
Epoch: 28, Steps: 10 | Train Loss: 0.453 Vali Loss: 3.304 Vali Acc: 0.233 Test Loss: 3.304 Test Acc: 0.233
Validation loss decreased (-0.230555 --> -0.232908).  Saving model ...
Epoch: 29 cost time: 0.6415791511535645
Epoch: 29, Steps: 10 | Train Loss: 0.382 Vali Loss: 3.334 Vali Acc: 0.232 Test Loss: 3.334 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.6491625308990479
Epoch: 30, Steps: 10 | Train Loss: 0.331 Vali Loss: 3.360 Vali Acc: 0.236 Test Loss: 3.360 Test Acc: 0.236
Validation loss decreased (-0.232908 --> -0.236437).  Saving model ...
Epoch: 31 cost time: 0.632878303527832
Epoch: 31, Steps: 10 | Train Loss: 0.315 Vali Loss: 3.377 Vali Acc: 0.247 Test Loss: 3.377 Test Acc: 0.247
Validation loss decreased (-0.236437 --> -0.247025).  Saving model ...
Epoch: 32 cost time: 0.5861871242523193
Epoch: 32, Steps: 10 | Train Loss: 0.272 Vali Loss: 3.400 Vali Acc: 0.251 Test Loss: 3.400 Test Acc: 0.251
Validation loss decreased (-0.247025 --> -0.250554).  Saving model ...
Epoch: 33 cost time: 0.6927189826965332
Epoch: 33, Steps: 10 | Train Loss: 0.252 Vali Loss: 3.424 Vali Acc: 0.249 Test Loss: 3.424 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.6492581367492676
Epoch: 34, Steps: 10 | Train Loss: 0.234 Vali Loss: 3.438 Vali Acc: 0.256 Test Loss: 3.438 Test Acc: 0.256
Validation loss decreased (-0.250554 --> -0.256436).  Saving model ...
Epoch: 35 cost time: 0.7118203639984131
Epoch: 35, Steps: 10 | Train Loss: 0.209 Vali Loss: 3.464 Vali Acc: 0.254 Test Loss: 3.464 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.7139267921447754
Epoch: 36, Steps: 10 | Train Loss: 0.187 Vali Loss: 3.494 Vali Acc: 0.258 Test Loss: 3.494 Test Acc: 0.258
Validation loss decreased (-0.256436 --> -0.257612).  Saving model ...
Epoch: 37 cost time: 0.6911652088165283
Epoch: 37, Steps: 10 | Train Loss: 0.168 Vali Loss: 3.515 Vali Acc: 0.259 Test Loss: 3.515 Test Acc: 0.259
Validation loss decreased (-0.257612 --> -0.258788).  Saving model ...
Epoch: 38 cost time: 0.6800434589385986
Epoch: 38, Steps: 10 | Train Loss: 0.150 Vali Loss: 3.541 Vali Acc: 0.259 Test Loss: 3.541 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.6893355846405029
Epoch: 39, Steps: 10 | Train Loss: 0.139 Vali Loss: 3.566 Vali Acc: 0.265 Test Loss: 3.566 Test Acc: 0.265
Validation loss decreased (-0.258788 --> -0.264670).  Saving model ...
Epoch: 40 cost time: 0.6566081047058105
Epoch: 40, Steps: 10 | Train Loss: 0.126 Vali Loss: 3.588 Vali Acc: 0.262 Test Loss: 3.588 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.6199777126312256
Epoch: 41, Steps: 10 | Train Loss: 0.123 Vali Loss: 3.623 Vali Acc: 0.264 Test Loss: 3.623 Test Acc: 0.264
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.6510612964630127
Epoch: 42, Steps: 10 | Train Loss: 0.108 Vali Loss: 3.635 Vali Acc: 0.265 Test Loss: 3.635 Test Acc: 0.265
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.6470720767974854
Epoch: 43, Steps: 10 | Train Loss: 0.106 Vali Loss: 3.656 Vali Acc: 0.260 Test Loss: 3.656 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.699561357498169
Epoch: 44, Steps: 10 | Train Loss: 0.091 Vali Loss: 3.674 Vali Acc: 0.265 Test Loss: 3.674 Test Acc: 0.265
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.6709244251251221
Epoch: 45, Steps: 10 | Train Loss: 0.090 Vali Loss: 3.712 Vali Acc: 0.259 Test Loss: 3.712 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.6968381404876709
Epoch: 46, Steps: 10 | Train Loss: 0.086 Vali Loss: 3.721 Vali Acc: 0.265 Test Loss: 3.721 Test Acc: 0.265
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.721137285232544
Epoch: 47, Steps: 10 | Train Loss: 0.075 Vali Loss: 3.722 Vali Acc: 0.269 Test Loss: 3.722 Test Acc: 0.269
Validation loss decreased (-0.264670 --> -0.269375).  Saving model ...
Epoch: 48 cost time: 0.6895434856414795
Epoch: 48, Steps: 10 | Train Loss: 0.069 Vali Loss: 3.754 Vali Acc: 0.268 Test Loss: 3.754 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.6958379745483398
Epoch: 49, Steps: 10 | Train Loss: 0.067 Vali Loss: 3.774 Vali Acc: 0.262 Test Loss: 3.774 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.7141177654266357
Epoch: 50, Steps: 10 | Train Loss: 0.065 Vali Loss: 3.795 Vali Acc: 0.262 Test Loss: 3.795 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps23_str12_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26941176470588235
model parameter : 40090
model size : 0.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps31_str16_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.7779221534729004
Epoch: 1, Steps: 10 | Train Loss: 3.400 Vali Loss: 3.304 Vali Acc: 0.029 Test Loss: 3.304 Test Acc: 0.029
Validation loss decreased (inf --> -0.029379).  Saving model ...
Epoch: 2 cost time: 0.6173572540283203
Epoch: 2, Steps: 10 | Train Loss: 3.368 Vali Loss: 3.301 Vali Acc: 0.034 Test Loss: 3.301 Test Acc: 0.034
Validation loss decreased (-0.029379 --> -0.034085).  Saving model ...
Epoch: 3 cost time: 0.6893532276153564
Epoch: 3, Steps: 10 | Train Loss: 3.301 Vali Loss: 3.289 Vali Acc: 0.038 Test Loss: 3.289 Test Acc: 0.038
Validation loss decreased (-0.034085 --> -0.037614).  Saving model ...
Epoch: 4 cost time: 0.6122231483459473
Epoch: 4, Steps: 10 | Train Loss: 3.201 Vali Loss: 3.275 Vali Acc: 0.036 Test Loss: 3.275 Test Acc: 0.036
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6362221240997314
Epoch: 5, Steps: 10 | Train Loss: 3.114 Vali Loss: 3.263 Vali Acc: 0.036 Test Loss: 3.263 Test Acc: 0.036
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.6169230937957764
Epoch: 6, Steps: 10 | Train Loss: 3.032 Vali Loss: 3.253 Vali Acc: 0.060 Test Loss: 3.253 Test Acc: 0.060
Validation loss decreased (-0.037614 --> -0.059967).  Saving model ...
Epoch: 7 cost time: 0.6289956569671631
Epoch: 7, Steps: 10 | Train Loss: 2.930 Vali Loss: 3.246 Vali Acc: 0.085 Test Loss: 3.246 Test Acc: 0.085
Validation loss decreased (-0.059967 --> -0.084673).  Saving model ...
Epoch: 8 cost time: 0.6102230548858643
Epoch: 8, Steps: 10 | Train Loss: 2.795 Vali Loss: 3.239 Vali Acc: 0.095 Test Loss: 3.239 Test Acc: 0.095
Validation loss decreased (-0.084673 --> -0.095262).  Saving model ...
Epoch: 9 cost time: 0.7009327411651611
Epoch: 9, Steps: 10 | Train Loss: 2.728 Vali Loss: 3.234 Vali Acc: 0.094 Test Loss: 3.234 Test Acc: 0.094
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6040077209472656
Epoch: 10, Steps: 10 | Train Loss: 2.591 Vali Loss: 3.227 Vali Acc: 0.102 Test Loss: 3.227 Test Acc: 0.102
Validation loss decreased (-0.095262 --> -0.102321).  Saving model ...
Epoch: 11 cost time: 0.61222243309021
Epoch: 11, Steps: 10 | Train Loss: 2.499 Vali Loss: 3.219 Vali Acc: 0.115 Test Loss: 3.219 Test Acc: 0.115
Validation loss decreased (-0.102321 --> -0.115262).  Saving model ...
Epoch: 12 cost time: 0.6198816299438477
Epoch: 12, Steps: 10 | Train Loss: 2.392 Vali Loss: 3.210 Vali Acc: 0.124 Test Loss: 3.210 Test Acc: 0.124
Validation loss decreased (-0.115262 --> -0.123497).  Saving model ...
Epoch: 13 cost time: 0.6789376735687256
Epoch: 13, Steps: 10 | Train Loss: 2.270 Vali Loss: 3.202 Vali Acc: 0.128 Test Loss: 3.202 Test Acc: 0.128
Validation loss decreased (-0.123497 --> -0.128203).  Saving model ...
Epoch: 14 cost time: 0.6680638790130615
Epoch: 14, Steps: 10 | Train Loss: 2.130 Vali Loss: 3.195 Vali Acc: 0.136 Test Loss: 3.195 Test Acc: 0.136
Validation loss decreased (-0.128203 --> -0.136439).  Saving model ...
Epoch: 15 cost time: 0.6252243518829346
Epoch: 15, Steps: 10 | Train Loss: 2.046 Vali Loss: 3.193 Vali Acc: 0.140 Test Loss: 3.193 Test Acc: 0.140
Validation loss decreased (-0.136439 --> -0.139968).  Saving model ...
Epoch: 16 cost time: 0.5820121765136719
Epoch: 16, Steps: 10 | Train Loss: 1.894 Vali Loss: 3.185 Vali Acc: 0.142 Test Loss: 3.185 Test Acc: 0.142
Validation loss decreased (-0.139968 --> -0.142321).  Saving model ...
Epoch: 17 cost time: 0.6389760971069336
Epoch: 17, Steps: 10 | Train Loss: 1.789 Vali Loss: 3.178 Vali Acc: 0.153 Test Loss: 3.178 Test Acc: 0.153
Validation loss decreased (-0.142321 --> -0.152909).  Saving model ...
Epoch: 18 cost time: 0.6172561645507812
Epoch: 18, Steps: 10 | Train Loss: 1.691 Vali Loss: 3.179 Vali Acc: 0.159 Test Loss: 3.179 Test Acc: 0.159
Validation loss decreased (-0.152909 --> -0.158792).  Saving model ...
Epoch: 19 cost time: 0.5686910152435303
Epoch: 19, Steps: 10 | Train Loss: 1.602 Vali Loss: 3.174 Vali Acc: 0.165 Test Loss: 3.174 Test Acc: 0.165
Validation loss decreased (-0.158792 --> -0.164674).  Saving model ...
Epoch: 20 cost time: 0.6140930652618408
Epoch: 20, Steps: 10 | Train Loss: 1.453 Vali Loss: 3.176 Vali Acc: 0.173 Test Loss: 3.176 Test Acc: 0.173
Validation loss decreased (-0.164674 --> -0.172909).  Saving model ...
Epoch: 21 cost time: 0.637272834777832
Epoch: 21, Steps: 10 | Train Loss: 1.346 Vali Loss: 3.179 Vali Acc: 0.182 Test Loss: 3.179 Test Acc: 0.182
Validation loss decreased (-0.172909 --> -0.182321).  Saving model ...
Epoch: 22 cost time: 0.6122057437896729
Epoch: 22, Steps: 10 | Train Loss: 1.297 Vali Loss: 3.177 Vali Acc: 0.189 Test Loss: 3.177 Test Acc: 0.189
Validation loss decreased (-0.182321 --> -0.189380).  Saving model ...
Epoch: 23 cost time: 0.59751296043396
Epoch: 23, Steps: 10 | Train Loss: 1.203 Vali Loss: 3.176 Vali Acc: 0.204 Test Loss: 3.176 Test Acc: 0.204
Validation loss decreased (-0.189380 --> -0.203498).  Saving model ...
Epoch: 24 cost time: 0.6001036167144775
Epoch: 24, Steps: 10 | Train Loss: 1.060 Vali Loss: 3.183 Vali Acc: 0.211 Test Loss: 3.183 Test Acc: 0.211
Validation loss decreased (-0.203498 --> -0.210556).  Saving model ...
Epoch: 25 cost time: 0.6318948268890381
Epoch: 25, Steps: 10 | Train Loss: 0.980 Vali Loss: 3.197 Vali Acc: 0.204 Test Loss: 3.197 Test Acc: 0.204
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.640615701675415
Epoch: 26, Steps: 10 | Train Loss: 0.913 Vali Loss: 3.208 Vali Acc: 0.218 Test Loss: 3.208 Test Acc: 0.218
Validation loss decreased (-0.210556 --> -0.217615).  Saving model ...
Epoch: 27 cost time: 0.6307101249694824
Epoch: 27, Steps: 10 | Train Loss: 0.812 Vali Loss: 3.209 Vali Acc: 0.221 Test Loss: 3.209 Test Acc: 0.221
Validation loss decreased (-0.217615 --> -0.221144).  Saving model ...
Epoch: 28 cost time: 0.6874349117279053
Epoch: 28, Steps: 10 | Train Loss: 0.775 Vali Loss: 3.221 Vali Acc: 0.227 Test Loss: 3.221 Test Acc: 0.227
Validation loss decreased (-0.221144 --> -0.227027).  Saving model ...
Epoch: 29 cost time: 0.6718587875366211
Epoch: 29, Steps: 10 | Train Loss: 0.679 Vali Loss: 3.241 Vali Acc: 0.231 Test Loss: 3.241 Test Acc: 0.231
Validation loss decreased (-0.227027 --> -0.230556).  Saving model ...
Epoch: 30 cost time: 0.6056795120239258
Epoch: 30, Steps: 10 | Train Loss: 0.614 Vali Loss: 3.255 Vali Acc: 0.234 Test Loss: 3.255 Test Acc: 0.234
Validation loss decreased (-0.230556 --> -0.234085).  Saving model ...
Epoch: 31 cost time: 0.6247293949127197
Epoch: 31, Steps: 10 | Train Loss: 0.581 Vali Loss: 3.270 Vali Acc: 0.240 Test Loss: 3.270 Test Acc: 0.240
Validation loss decreased (-0.234085 --> -0.239967).  Saving model ...
Epoch: 32 cost time: 0.6981074810028076
Epoch: 32, Steps: 10 | Train Loss: 0.495 Vali Loss: 3.282 Vali Acc: 0.244 Test Loss: 3.282 Test Acc: 0.244
Validation loss decreased (-0.239967 --> -0.243497).  Saving model ...
Epoch: 33 cost time: 0.6666877269744873
Epoch: 33, Steps: 10 | Train Loss: 0.456 Vali Loss: 3.297 Vali Acc: 0.246 Test Loss: 3.297 Test Acc: 0.246
Validation loss decreased (-0.243497 --> -0.245849).  Saving model ...
Epoch: 34 cost time: 0.6150915622711182
Epoch: 34, Steps: 10 | Train Loss: 0.430 Vali Loss: 3.313 Vali Acc: 0.246 Test Loss: 3.313 Test Acc: 0.246
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.6130833625793457
Epoch: 35, Steps: 10 | Train Loss: 0.402 Vali Loss: 3.332 Vali Acc: 0.247 Test Loss: 3.332 Test Acc: 0.247
Validation loss decreased (-0.245849 --> -0.247025).  Saving model ...
Epoch: 36 cost time: 0.61407470703125
Epoch: 36, Steps: 10 | Train Loss: 0.353 Vali Loss: 3.354 Vali Acc: 0.249 Test Loss: 3.354 Test Acc: 0.249
Validation loss decreased (-0.247025 --> -0.249378).  Saving model ...
Epoch: 37 cost time: 0.6202266216278076
Epoch: 37, Steps: 10 | Train Loss: 0.320 Vali Loss: 3.382 Vali Acc: 0.256 Test Loss: 3.382 Test Acc: 0.256
Validation loss decreased (-0.249378 --> -0.256437).  Saving model ...
Epoch: 38 cost time: 0.6357660293579102
Epoch: 38, Steps: 10 | Train Loss: 0.293 Vali Loss: 3.402 Vali Acc: 0.251 Test Loss: 3.402 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.6321244239807129
Epoch: 39, Steps: 10 | Train Loss: 0.274 Vali Loss: 3.419 Vali Acc: 0.253 Test Loss: 3.419 Test Acc: 0.253
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.6940226554870605
Epoch: 40, Steps: 10 | Train Loss: 0.253 Vali Loss: 3.435 Vali Acc: 0.265 Test Loss: 3.435 Test Acc: 0.265
Validation loss decreased (-0.256437 --> -0.264672).  Saving model ...
Epoch: 41 cost time: 0.64211106300354
Epoch: 41, Steps: 10 | Train Loss: 0.229 Vali Loss: 3.441 Vali Acc: 0.262 Test Loss: 3.441 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.5975947380065918
Epoch: 42, Steps: 10 | Train Loss: 0.210 Vali Loss: 3.475 Vali Acc: 0.261 Test Loss: 3.475 Test Acc: 0.261
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.6308679580688477
Epoch: 43, Steps: 10 | Train Loss: 0.181 Vali Loss: 3.503 Vali Acc: 0.258 Test Loss: 3.503 Test Acc: 0.258
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.6374478340148926
Epoch: 44, Steps: 10 | Train Loss: 0.176 Vali Loss: 3.521 Vali Acc: 0.258 Test Loss: 3.521 Test Acc: 0.258
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.6240859031677246
Epoch: 45, Steps: 10 | Train Loss: 0.171 Vali Loss: 3.547 Vali Acc: 0.258 Test Loss: 3.547 Test Acc: 0.258
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.6330766677856445
Epoch: 46, Steps: 10 | Train Loss: 0.162 Vali Loss: 3.556 Vali Acc: 0.261 Test Loss: 3.556 Test Acc: 0.261
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.5879144668579102
Epoch: 47, Steps: 10 | Train Loss: 0.142 Vali Loss: 3.568 Vali Acc: 0.264 Test Loss: 3.568 Test Acc: 0.264
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 0.62538743019104
Epoch: 48, Steps: 10 | Train Loss: 0.126 Vali Loss: 3.582 Vali Acc: 0.260 Test Loss: 3.582 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 0.6325945854187012
Epoch: 49, Steps: 10 | Train Loss: 0.123 Vali Loss: 3.618 Vali Acc: 0.259 Test Loss: 3.618 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 0.6388757228851318
Epoch: 50, Steps: 10 | Train Loss: 0.116 Vali Loss: 3.643 Vali Acc: 0.262 Test Loss: 3.643 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps31_str16_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2647058823529412
model parameter : 32858
model size : 0.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps38_str19_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 1.796069860458374
Epoch: 1, Steps: 10 | Train Loss: 3.273 Vali Loss: 3.306 Vali Acc: 0.033 Test Loss: 3.306 Test Acc: 0.033
Validation loss decreased (inf --> -0.032908).  Saving model ...
Epoch: 2 cost time: 0.6064445972442627
Epoch: 2, Steps: 10 | Train Loss: 3.267 Vali Loss: 3.315 Vali Acc: 0.035 Test Loss: 3.315 Test Acc: 0.035
Validation loss decreased (-0.032908 --> -0.035261).  Saving model ...
Epoch: 3 cost time: 0.6208517551422119
Epoch: 3, Steps: 10 | Train Loss: 3.240 Vali Loss: 3.314 Vali Acc: 0.049 Test Loss: 3.314 Test Acc: 0.049
Validation loss decreased (-0.035261 --> -0.049379).  Saving model ...
Epoch: 4 cost time: 0.6138923168182373
Epoch: 4, Steps: 10 | Train Loss: 3.152 Vali Loss: 3.308 Vali Acc: 0.047 Test Loss: 3.308 Test Acc: 0.047
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6274890899658203
Epoch: 5, Steps: 10 | Train Loss: 3.055 Vali Loss: 3.299 Vali Acc: 0.049 Test Loss: 3.299 Test Acc: 0.049
Validation loss decreased (-0.049379 --> -0.049379).  Saving model ...
Epoch: 6 cost time: 0.5911529064178467
Epoch: 6, Steps: 10 | Train Loss: 2.979 Vali Loss: 3.293 Vali Acc: 0.061 Test Loss: 3.293 Test Acc: 0.061
Validation loss decreased (-0.049379 --> -0.061144).  Saving model ...
Epoch: 7 cost time: 0.5657811164855957
Epoch: 7, Steps: 10 | Train Loss: 2.909 Vali Loss: 3.288 Vali Acc: 0.067 Test Loss: 3.288 Test Acc: 0.067
Validation loss decreased (-0.061144 --> -0.067026).  Saving model ...
Epoch: 8 cost time: 0.5998713970184326
Epoch: 8, Steps: 10 | Train Loss: 2.799 Vali Loss: 3.284 Vali Acc: 0.071 Test Loss: 3.284 Test Acc: 0.071
Validation loss decreased (-0.067026 --> -0.070555).  Saving model ...
Epoch: 9 cost time: 0.5943789482116699
Epoch: 9, Steps: 10 | Train Loss: 2.703 Vali Loss: 3.277 Vali Acc: 0.076 Test Loss: 3.277 Test Acc: 0.076
Validation loss decreased (-0.070555 --> -0.076438).  Saving model ...
Epoch: 10 cost time: 0.5856668949127197
Epoch: 10, Steps: 10 | Train Loss: 2.620 Vali Loss: 3.271 Vali Acc: 0.074 Test Loss: 3.271 Test Acc: 0.074
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5868597030639648
Epoch: 11, Steps: 10 | Train Loss: 2.543 Vali Loss: 3.265 Vali Acc: 0.088 Test Loss: 3.265 Test Acc: 0.088
Validation loss decreased (-0.076438 --> -0.088203).  Saving model ...
Epoch: 12 cost time: 0.5875418186187744
Epoch: 12, Steps: 10 | Train Loss: 2.425 Vali Loss: 3.256 Vali Acc: 0.101 Test Loss: 3.256 Test Acc: 0.101
Validation loss decreased (-0.088203 --> -0.101144).  Saving model ...
Epoch: 13 cost time: 0.5746099948883057
Epoch: 13, Steps: 10 | Train Loss: 2.315 Vali Loss: 3.247 Vali Acc: 0.102 Test Loss: 3.247 Test Acc: 0.102
Validation loss decreased (-0.101144 --> -0.102320).  Saving model ...
Epoch: 14 cost time: 0.5951037406921387
Epoch: 14, Steps: 10 | Train Loss: 2.192 Vali Loss: 3.240 Vali Acc: 0.106 Test Loss: 3.240 Test Acc: 0.106
Validation loss decreased (-0.102320 --> -0.105850).  Saving model ...
Epoch: 15 cost time: 0.6221840381622314
Epoch: 15, Steps: 10 | Train Loss: 2.141 Vali Loss: 3.236 Vali Acc: 0.111 Test Loss: 3.236 Test Acc: 0.111
Validation loss decreased (-0.105850 --> -0.110556).  Saving model ...
Epoch: 16 cost time: 0.6178631782531738
Epoch: 16, Steps: 10 | Train Loss: 1.978 Vali Loss: 3.229 Vali Acc: 0.121 Test Loss: 3.229 Test Acc: 0.121
Validation loss decreased (-0.110556 --> -0.121144).  Saving model ...
Epoch: 17 cost time: 0.5918374061584473
Epoch: 17, Steps: 10 | Train Loss: 1.893 Vali Loss: 3.216 Vali Acc: 0.126 Test Loss: 3.216 Test Acc: 0.126
Validation loss decreased (-0.121144 --> -0.125850).  Saving model ...
Epoch: 18 cost time: 0.5990052223205566
Epoch: 18, Steps: 10 | Train Loss: 1.785 Vali Loss: 3.216 Vali Acc: 0.126 Test Loss: 3.216 Test Acc: 0.126
Validation loss decreased (-0.125850 --> -0.125850).  Saving model ...
Epoch: 19 cost time: 0.5400969982147217
Epoch: 19, Steps: 10 | Train Loss: 1.678 Vali Loss: 3.209 Vali Acc: 0.136 Test Loss: 3.209 Test Acc: 0.136
Validation loss decreased (-0.125850 --> -0.136438).  Saving model ...
Epoch: 20 cost time: 0.6126434803009033
Epoch: 20, Steps: 10 | Train Loss: 1.571 Vali Loss: 3.205 Vali Acc: 0.144 Test Loss: 3.205 Test Acc: 0.144
Validation loss decreased (-0.136438 --> -0.143497).  Saving model ...
Epoch: 21 cost time: 0.6515567302703857
Epoch: 21, Steps: 10 | Train Loss: 1.491 Vali Loss: 3.199 Vali Acc: 0.153 Test Loss: 3.199 Test Acc: 0.153
Validation loss decreased (-0.143497 --> -0.152909).  Saving model ...
Epoch: 22 cost time: 0.5885732173919678
Epoch: 22, Steps: 10 | Train Loss: 1.377 Vali Loss: 3.202 Vali Acc: 0.156 Test Loss: 3.202 Test Acc: 0.156
Validation loss decreased (-0.152909 --> -0.156439).  Saving model ...
Epoch: 23 cost time: 0.6110961437225342
Epoch: 23, Steps: 10 | Train Loss: 1.273 Vali Loss: 3.204 Vali Acc: 0.167 Test Loss: 3.204 Test Acc: 0.167
Validation loss decreased (-0.156439 --> -0.167027).  Saving model ...
Epoch: 24 cost time: 0.6355962753295898
Epoch: 24, Steps: 10 | Train Loss: 1.176 Vali Loss: 3.213 Vali Acc: 0.175 Test Loss: 3.213 Test Acc: 0.175
Validation loss decreased (-0.167027 --> -0.175262).  Saving model ...
Epoch: 25 cost time: 0.644620418548584
Epoch: 25, Steps: 10 | Train Loss: 1.091 Vali Loss: 3.208 Vali Acc: 0.181 Test Loss: 3.208 Test Acc: 0.181
Validation loss decreased (-0.175262 --> -0.181144).  Saving model ...
Epoch: 26 cost time: 0.6339752674102783
Epoch: 26, Steps: 10 | Train Loss: 1.004 Vali Loss: 3.217 Vali Acc: 0.184 Test Loss: 3.217 Test Acc: 0.184
Validation loss decreased (-0.181144 --> -0.183497).  Saving model ...
Epoch: 27 cost time: 0.6599133014678955
Epoch: 27, Steps: 10 | Train Loss: 0.908 Vali Loss: 3.225 Vali Acc: 0.187 Test Loss: 3.225 Test Acc: 0.187
Validation loss decreased (-0.183497 --> -0.187027).  Saving model ...
Epoch: 28 cost time: 0.6293363571166992
Epoch: 28, Steps: 10 | Train Loss: 0.860 Vali Loss: 3.240 Vali Acc: 0.199 Test Loss: 3.240 Test Acc: 0.199
Validation loss decreased (-0.187027 --> -0.198791).  Saving model ...
Epoch: 29 cost time: 0.6395053863525391
Epoch: 29, Steps: 10 | Train Loss: 0.773 Vali Loss: 3.256 Vali Acc: 0.205 Test Loss: 3.256 Test Acc: 0.205
Validation loss decreased (-0.198791 --> -0.204673).  Saving model ...
Epoch: 30 cost time: 0.5450174808502197
Epoch: 30, Steps: 10 | Train Loss: 0.717 Vali Loss: 3.271 Vali Acc: 0.204 Test Loss: 3.271 Test Acc: 0.204
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.5786099433898926
Epoch: 31, Steps: 10 | Train Loss: 0.648 Vali Loss: 3.281 Vali Acc: 0.206 Test Loss: 3.281 Test Acc: 0.206
Validation loss decreased (-0.204673 --> -0.205850).  Saving model ...
Epoch: 32 cost time: 0.5836348533630371
Epoch: 32, Steps: 10 | Train Loss: 0.574 Vali Loss: 3.291 Vali Acc: 0.213 Test Loss: 3.291 Test Acc: 0.213
Validation loss decreased (-0.205850 --> -0.212908).  Saving model ...
Epoch: 33 cost time: 0.6455833911895752
Epoch: 33, Steps: 10 | Train Loss: 0.540 Vali Loss: 3.312 Vali Acc: 0.216 Test Loss: 3.312 Test Acc: 0.216
Validation loss decreased (-0.212908 --> -0.216437).  Saving model ...
Epoch: 34 cost time: 0.6509559154510498
Epoch: 34, Steps: 10 | Train Loss: 0.506 Vali Loss: 3.325 Vali Acc: 0.216 Test Loss: 3.325 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.6539034843444824
Epoch: 35, Steps: 10 | Train Loss: 0.472 Vali Loss: 3.344 Vali Acc: 0.215 Test Loss: 3.344 Test Acc: 0.215
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.6307229995727539
Epoch: 36, Steps: 10 | Train Loss: 0.406 Vali Loss: 3.364 Vali Acc: 0.224 Test Loss: 3.364 Test Acc: 0.224
Validation loss decreased (-0.216437 --> -0.223496).  Saving model ...
Epoch: 37 cost time: 0.6305925846099854
Epoch: 37, Steps: 10 | Train Loss: 0.396 Vali Loss: 3.376 Vali Acc: 0.222 Test Loss: 3.376 Test Acc: 0.222
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.6488592624664307
Epoch: 38, Steps: 10 | Train Loss: 0.382 Vali Loss: 3.404 Vali Acc: 0.225 Test Loss: 3.404 Test Acc: 0.225
Validation loss decreased (-0.223496 --> -0.224672).  Saving model ...
Epoch: 39 cost time: 0.6355705261230469
Epoch: 39, Steps: 10 | Train Loss: 0.301 Vali Loss: 3.425 Vali Acc: 0.232 Test Loss: 3.425 Test Acc: 0.232
Validation loss decreased (-0.224672 --> -0.231730).  Saving model ...
Epoch: 40 cost time: 0.6729404926300049
Epoch: 40, Steps: 10 | Train Loss: 0.281 Vali Loss: 3.451 Vali Acc: 0.224 Test Loss: 3.451 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.6540939807891846
Epoch: 41, Steps: 10 | Train Loss: 0.265 Vali Loss: 3.467 Vali Acc: 0.233 Test Loss: 3.467 Test Acc: 0.233
Validation loss decreased (-0.231730 --> -0.232907).  Saving model ...
Epoch: 42 cost time: 0.6331310272216797
Epoch: 42, Steps: 10 | Train Loss: 0.237 Vali Loss: 3.473 Vali Acc: 0.231 Test Loss: 3.473 Test Acc: 0.231
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.6707029342651367
Epoch: 43, Steps: 10 | Train Loss: 0.227 Vali Loss: 3.489 Vali Acc: 0.239 Test Loss: 3.489 Test Acc: 0.239
Validation loss decreased (-0.232907 --> -0.238789).  Saving model ...
Epoch: 44 cost time: 0.6474995613098145
Epoch: 44, Steps: 10 | Train Loss: 0.191 Vali Loss: 3.521 Vali Acc: 0.233 Test Loss: 3.521 Test Acc: 0.233
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.6616480350494385
Epoch: 45, Steps: 10 | Train Loss: 0.181 Vali Loss: 3.531 Vali Acc: 0.235 Test Loss: 3.531 Test Acc: 0.235
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.6484420299530029
Epoch: 46, Steps: 10 | Train Loss: 0.188 Vali Loss: 3.555 Vali Acc: 0.227 Test Loss: 3.555 Test Acc: 0.227
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.6330063343048096
Epoch: 47, Steps: 10 | Train Loss: 0.155 Vali Loss: 3.570 Vali Acc: 0.236 Test Loss: 3.570 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.685570240020752
Epoch: 48, Steps: 10 | Train Loss: 0.146 Vali Loss: 3.592 Vali Acc: 0.239 Test Loss: 3.592 Test Acc: 0.239
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.6487162113189697
Epoch: 49, Steps: 10 | Train Loss: 0.134 Vali Loss: 3.635 Vali Acc: 0.233 Test Loss: 3.635 Test Acc: 0.233
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.6391172409057617
Epoch: 50, Steps: 10 | Train Loss: 0.132 Vali Loss: 3.640 Vali Acc: 0.242 Test Loss: 3.640 Test Acc: 0.242
Validation loss decreased (-0.238789 --> -0.242317).  Saving model ...
>>>>>>>testing : classification_CLS_Handwriting_ModernTCN_UEA_ftM_sl152_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps38_str19_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.24235294117647058
model parameter : 30586
model size : 0.13MB
