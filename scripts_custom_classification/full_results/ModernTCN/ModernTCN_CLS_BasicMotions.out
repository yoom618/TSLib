Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.6195893287658691
Epoch: 1, Steps: 3 | Train Loss: 1.428 Vali Loss: 1.384 Vali Acc: 0.375 Test Loss: 1.384 Test Acc: 0.375
Validation loss decreased (inf --> -0.374986).  Saving model ...
Epoch: 2 cost time: 0.3436143398284912
Epoch: 2, Steps: 3 | Train Loss: 1.384 Vali Loss: 1.364 Vali Acc: 0.425 Test Loss: 1.364 Test Acc: 0.425
Validation loss decreased (-0.374986 --> -0.424986).  Saving model ...
Epoch: 3 cost time: 0.3703911304473877
Epoch: 3, Steps: 3 | Train Loss: 1.317 Vali Loss: 1.331 Vali Acc: 0.475 Test Loss: 1.331 Test Acc: 0.475
Validation loss decreased (-0.424986 --> -0.474987).  Saving model ...
Epoch: 4 cost time: 0.35416436195373535
Epoch: 4, Steps: 3 | Train Loss: 1.213 Vali Loss: 1.277 Vali Acc: 0.625 Test Loss: 1.277 Test Acc: 0.625
Validation loss decreased (-0.474987 --> -0.624987).  Saving model ...
Epoch: 5 cost time: 0.42841124534606934
Epoch: 5, Steps: 3 | Train Loss: 1.150 Vali Loss: 1.209 Vali Acc: 0.750 Test Loss: 1.209 Test Acc: 0.750
Validation loss decreased (-0.624987 --> -0.749988).  Saving model ...
Epoch: 6 cost time: 0.3652665615081787
Epoch: 6, Steps: 3 | Train Loss: 1.014 Vali Loss: 1.126 Vali Acc: 0.750 Test Loss: 1.126 Test Acc: 0.750
Validation loss decreased (-0.749988 --> -0.749989).  Saving model ...
Epoch: 7 cost time: 0.3643796443939209
Epoch: 7, Steps: 3 | Train Loss: 0.937 Vali Loss: 1.034 Vali Acc: 0.775 Test Loss: 1.034 Test Acc: 0.775
Validation loss decreased (-0.749989 --> -0.774990).  Saving model ...
Epoch: 8 cost time: 0.3653442859649658
Epoch: 8, Steps: 3 | Train Loss: 0.813 Vali Loss: 0.947 Vali Acc: 0.800 Test Loss: 0.947 Test Acc: 0.800
Validation loss decreased (-0.774990 --> -0.799991).  Saving model ...
Epoch: 9 cost time: 0.39275145530700684
Epoch: 9, Steps: 3 | Train Loss: 0.716 Vali Loss: 0.869 Vali Acc: 0.850 Test Loss: 0.869 Test Acc: 0.850
Validation loss decreased (-0.799991 --> -0.849991).  Saving model ...
Epoch: 10 cost time: 0.3691110610961914
Epoch: 10, Steps: 3 | Train Loss: 0.660 Vali Loss: 0.782 Vali Acc: 0.875 Test Loss: 0.782 Test Acc: 0.875
Validation loss decreased (-0.849991 --> -0.874992).  Saving model ...
Epoch: 11 cost time: 0.44853854179382324
Epoch: 11, Steps: 3 | Train Loss: 0.580 Vali Loss: 0.707 Vali Acc: 0.925 Test Loss: 0.707 Test Acc: 0.925
Validation loss decreased (-0.874992 --> -0.924993).  Saving model ...
Epoch: 12 cost time: 0.39243149757385254
Epoch: 12, Steps: 3 | Train Loss: 0.480 Vali Loss: 0.640 Vali Acc: 0.925 Test Loss: 0.640 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924994).  Saving model ...
Epoch: 13 cost time: 0.4186108112335205
Epoch: 13, Steps: 3 | Train Loss: 0.457 Vali Loss: 0.571 Vali Acc: 0.975 Test Loss: 0.571 Test Acc: 0.975
Validation loss decreased (-0.924994 --> -0.974994).  Saving model ...
Epoch: 14 cost time: 0.39664435386657715
Epoch: 14, Steps: 3 | Train Loss: 0.393 Vali Loss: 0.507 Vali Acc: 0.975 Test Loss: 0.507 Test Acc: 0.975
Validation loss decreased (-0.974994 --> -0.974995).  Saving model ...
Epoch: 15 cost time: 0.3452787399291992
Epoch: 15, Steps: 3 | Train Loss: 0.352 Vali Loss: 0.450 Vali Acc: 0.950 Test Loss: 0.450 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.41205716133117676
Epoch: 16, Steps: 3 | Train Loss: 0.312 Vali Loss: 0.405 Vali Acc: 0.975 Test Loss: 0.405 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 17 cost time: 0.40292787551879883
Epoch: 17, Steps: 3 | Train Loss: 0.302 Vali Loss: 0.372 Vali Acc: 0.950 Test Loss: 0.372 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.4349548816680908
Epoch: 18, Steps: 3 | Train Loss: 0.258 Vali Loss: 0.349 Vali Acc: 0.975 Test Loss: 0.349 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 19 cost time: 0.38314223289489746
Epoch: 19, Steps: 3 | Train Loss: 0.244 Vali Loss: 0.322 Vali Acc: 0.975 Test Loss: 0.322 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 20 cost time: 0.4155733585357666
Epoch: 20, Steps: 3 | Train Loss: 0.210 Vali Loss: 0.296 Vali Acc: 0.975 Test Loss: 0.296 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 21 cost time: 0.3553917407989502
Epoch: 21, Steps: 3 | Train Loss: 0.185 Vali Loss: 0.280 Vali Acc: 0.950 Test Loss: 0.280 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.39272499084472656
Epoch: 22, Steps: 3 | Train Loss: 0.171 Vali Loss: 0.271 Vali Acc: 0.950 Test Loss: 0.271 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.3536534309387207
Epoch: 23, Steps: 3 | Train Loss: 0.147 Vali Loss: 0.254 Vali Acc: 0.950 Test Loss: 0.254 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.39571142196655273
Epoch: 24, Steps: 3 | Train Loss: 0.139 Vali Loss: 0.234 Vali Acc: 0.950 Test Loss: 0.234 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.38741302490234375
Epoch: 25, Steps: 3 | Train Loss: 0.130 Vali Loss: 0.220 Vali Acc: 0.950 Test Loss: 0.220 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.39139223098754883
Epoch: 26, Steps: 3 | Train Loss: 0.114 Vali Loss: 0.209 Vali Acc: 0.950 Test Loss: 0.209 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.3676292896270752
Epoch: 27, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.198 Vali Acc: 0.950 Test Loss: 0.198 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.36664247512817383
Epoch: 28, Steps: 3 | Train Loss: 0.092 Vali Loss: 0.195 Vali Acc: 0.950 Test Loss: 0.195 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.39818286895751953
Epoch: 29, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.189 Vali Acc: 0.950 Test Loss: 0.189 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.41141796112060547
Epoch: 30, Steps: 3 | Train Loss: 0.068 Vali Loss: 0.182 Vali Acc: 0.950 Test Loss: 0.182 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 1201156
model size : 4.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.3770127296447754
Epoch: 1, Steps: 3 | Train Loss: 1.407 Vali Loss: 1.366 Vali Acc: 0.225 Test Loss: 1.366 Test Acc: 0.225
Validation loss decreased (inf --> -0.224986).  Saving model ...
Epoch: 2 cost time: 0.41272592544555664
Epoch: 2, Steps: 3 | Train Loss: 1.338 Vali Loss: 1.352 Vali Acc: 0.225 Test Loss: 1.352 Test Acc: 0.225
Validation loss decreased (-0.224986 --> -0.224986).  Saving model ...
Epoch: 3 cost time: 0.4174048900604248
Epoch: 3, Steps: 3 | Train Loss: 1.307 Vali Loss: 1.327 Vali Acc: 0.300 Test Loss: 1.327 Test Acc: 0.300
Validation loss decreased (-0.224986 --> -0.299987).  Saving model ...
Epoch: 4 cost time: 0.4245948791503906
Epoch: 4, Steps: 3 | Train Loss: 1.253 Vali Loss: 1.288 Vali Acc: 0.525 Test Loss: 1.288 Test Acc: 0.525
Validation loss decreased (-0.299987 --> -0.524987).  Saving model ...
Epoch: 5 cost time: 0.3934617042541504
Epoch: 5, Steps: 3 | Train Loss: 1.169 Vali Loss: 1.235 Vali Acc: 0.575 Test Loss: 1.235 Test Acc: 0.575
Validation loss decreased (-0.524987 --> -0.574988).  Saving model ...
Epoch: 6 cost time: 0.38780760765075684
Epoch: 6, Steps: 3 | Train Loss: 1.055 Vali Loss: 1.163 Vali Acc: 0.600 Test Loss: 1.163 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599988).  Saving model ...
Epoch: 7 cost time: 0.38816189765930176
Epoch: 7, Steps: 3 | Train Loss: 0.965 Vali Loss: 1.087 Vali Acc: 0.600 Test Loss: 1.087 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599989).  Saving model ...
Epoch: 8 cost time: 0.42676734924316406
Epoch: 8, Steps: 3 | Train Loss: 0.872 Vali Loss: 1.002 Vali Acc: 0.650 Test Loss: 1.002 Test Acc: 0.650
Validation loss decreased (-0.599989 --> -0.649990).  Saving model ...
Epoch: 9 cost time: 0.38927149772644043
Epoch: 9, Steps: 3 | Train Loss: 0.808 Vali Loss: 0.913 Vali Acc: 0.850 Test Loss: 0.913 Test Acc: 0.850
Validation loss decreased (-0.649990 --> -0.849991).  Saving model ...
Epoch: 10 cost time: 0.4377286434173584
Epoch: 10, Steps: 3 | Train Loss: 0.718 Vali Loss: 0.825 Vali Acc: 0.850 Test Loss: 0.825 Test Acc: 0.850
Validation loss decreased (-0.849991 --> -0.849992).  Saving model ...
Epoch: 11 cost time: 0.3985252380371094
Epoch: 11, Steps: 3 | Train Loss: 0.646 Vali Loss: 0.751 Vali Acc: 0.875 Test Loss: 0.751 Test Acc: 0.875
Validation loss decreased (-0.849992 --> -0.874992).  Saving model ...
Epoch: 12 cost time: 0.40154266357421875
Epoch: 12, Steps: 3 | Train Loss: 0.591 Vali Loss: 0.683 Vali Acc: 0.925 Test Loss: 0.683 Test Acc: 0.925
Validation loss decreased (-0.874992 --> -0.924993).  Saving model ...
Epoch: 13 cost time: 0.4261465072631836
Epoch: 13, Steps: 3 | Train Loss: 0.515 Vali Loss: 0.613 Vali Acc: 0.975 Test Loss: 0.613 Test Acc: 0.975
Validation loss decreased (-0.924993 --> -0.974994).  Saving model ...
Epoch: 14 cost time: 0.4136335849761963
Epoch: 14, Steps: 3 | Train Loss: 0.459 Vali Loss: 0.560 Vali Acc: 0.950 Test Loss: 0.560 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.4347422122955322
Epoch: 15, Steps: 3 | Train Loss: 0.403 Vali Loss: 0.512 Vali Acc: 0.950 Test Loss: 0.512 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.4110300540924072
Epoch: 16, Steps: 3 | Train Loss: 0.367 Vali Loss: 0.468 Vali Acc: 0.950 Test Loss: 0.468 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.4197688102722168
Epoch: 17, Steps: 3 | Train Loss: 0.327 Vali Loss: 0.427 Vali Acc: 0.950 Test Loss: 0.427 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.46085143089294434
Epoch: 18, Steps: 3 | Train Loss: 0.302 Vali Loss: 0.395 Vali Acc: 0.950 Test Loss: 0.395 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.4281430244445801
Epoch: 19, Steps: 3 | Train Loss: 0.275 Vali Loss: 0.375 Vali Acc: 0.950 Test Loss: 0.375 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.4454784393310547
Epoch: 20, Steps: 3 | Train Loss: 0.252 Vali Loss: 0.342 Vali Acc: 0.950 Test Loss: 0.342 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.42368102073669434
Epoch: 21, Steps: 3 | Train Loss: 0.225 Vali Loss: 0.317 Vali Acc: 0.975 Test Loss: 0.317 Test Acc: 0.975
Validation loss decreased (-0.974994 --> -0.974997).  Saving model ...
Epoch: 22 cost time: 0.37946033477783203
Epoch: 22, Steps: 3 | Train Loss: 0.212 Vali Loss: 0.296 Vali Acc: 0.975 Test Loss: 0.296 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 23 cost time: 0.4110701084136963
Epoch: 23, Steps: 3 | Train Loss: 0.191 Vali Loss: 0.274 Vali Acc: 0.975 Test Loss: 0.274 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 24 cost time: 0.41788315773010254
Epoch: 24, Steps: 3 | Train Loss: 0.160 Vali Loss: 0.261 Vali Acc: 0.975 Test Loss: 0.261 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 25 cost time: 0.41068339347839355
Epoch: 25, Steps: 3 | Train Loss: 0.161 Vali Loss: 0.245 Vali Acc: 0.975 Test Loss: 0.245 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 26 cost time: 0.41063475608825684
Epoch: 26, Steps: 3 | Train Loss: 0.149 Vali Loss: 0.227 Vali Acc: 0.975 Test Loss: 0.227 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 27 cost time: 0.40773820877075195
Epoch: 27, Steps: 3 | Train Loss: 0.142 Vali Loss: 0.215 Vali Acc: 0.975 Test Loss: 0.215 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 28 cost time: 0.3685297966003418
Epoch: 28, Steps: 3 | Train Loss: 0.134 Vali Loss: 0.199 Vali Acc: 0.975 Test Loss: 0.199 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 29 cost time: 0.4056217670440674
Epoch: 29, Steps: 3 | Train Loss: 0.119 Vali Loss: 0.188 Vali Acc: 0.975 Test Loss: 0.188 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 30 cost time: 0.4084444046020508
Epoch: 30, Steps: 3 | Train Loss: 0.102 Vali Loss: 0.184 Vali Acc: 0.975 Test Loss: 0.184 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 31 cost time: 0.39218664169311523
Epoch: 31, Steps: 3 | Train Loss: 0.093 Vali Loss: 0.174 Vali Acc: 0.975 Test Loss: 0.174 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 32 cost time: 0.40686917304992676
Epoch: 32, Steps: 3 | Train Loss: 0.079 Vali Loss: 0.162 Vali Acc: 0.975 Test Loss: 0.162 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 33 cost time: 0.4736318588256836
Epoch: 33, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.155 Vali Acc: 0.975 Test Loss: 0.155 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 34 cost time: 0.42247581481933594
Epoch: 34, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.150 Vali Acc: 0.975 Test Loss: 0.150 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974999).  Saving model ...
Epoch: 35 cost time: 0.40800023078918457
Epoch: 35, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.149 Vali Acc: 0.975 Test Loss: 0.149 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 36 cost time: 0.4602925777435303
Epoch: 36, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.149 Vali Acc: 0.975 Test Loss: 0.149 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.3868904113769531
Epoch: 37, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.140 Vali Acc: 0.975 Test Loss: 0.140 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 38 cost time: 0.4095938205718994
Epoch: 38, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.137 Vali Acc: 0.975 Test Loss: 0.137 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 39 cost time: 0.43305325508117676
Epoch: 39, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.129 Vali Acc: 0.975 Test Loss: 0.129 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 40 cost time: 0.4114806652069092
Epoch: 40, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.124 Vali Acc: 0.975 Test Loss: 0.124 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 41 cost time: 0.3733823299407959
Epoch: 41, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.120 Vali Acc: 0.975 Test Loss: 0.120 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 42 cost time: 0.43233156204223633
Epoch: 42, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.116 Vali Acc: 0.975 Test Loss: 0.116 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 43 cost time: 0.4131135940551758
Epoch: 43, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.114 Vali Acc: 0.975 Test Loss: 0.114 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 44 cost time: 0.4039950370788574
Epoch: 44, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.111 Vali Acc: 0.975 Test Loss: 0.111 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 45 cost time: 0.4068176746368408
Epoch: 45, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.113 Vali Acc: 0.975 Test Loss: 0.113 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.41782617568969727
Epoch: 46, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.112 Vali Acc: 0.975 Test Loss: 0.112 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.39879798889160156
Epoch: 47, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.111 Vali Acc: 0.975 Test Loss: 0.111 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.4254591464996338
Epoch: 48, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.109 Vali Acc: 0.975 Test Loss: 0.109 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 49 cost time: 0.41582489013671875
Epoch: 49, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.105 Vali Acc: 0.975 Test Loss: 0.105 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 50 cost time: 0.4630162715911865
Epoch: 50, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.105 Vali Acc: 0.975 Test Loss: 0.105 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 1188932
model size : 4.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.4918246269226074
Epoch: 1, Steps: 3 | Train Loss: 1.432 Vali Loss: 1.395 Vali Acc: 0.275 Test Loss: 1.395 Test Acc: 0.275
Validation loss decreased (inf --> -0.274986).  Saving model ...
Epoch: 2 cost time: 0.3593461513519287
Epoch: 2, Steps: 3 | Train Loss: 1.415 Vali Loss: 1.383 Vali Acc: 0.350 Test Loss: 1.383 Test Acc: 0.350
Validation loss decreased (-0.274986 --> -0.349986).  Saving model ...
Epoch: 3 cost time: 0.3592402935028076
Epoch: 3, Steps: 3 | Train Loss: 1.356 Vali Loss: 1.363 Vali Acc: 0.425 Test Loss: 1.363 Test Acc: 0.425
Validation loss decreased (-0.349986 --> -0.424986).  Saving model ...
Epoch: 4 cost time: 0.34462547302246094
Epoch: 4, Steps: 3 | Train Loss: 1.324 Vali Loss: 1.331 Vali Acc: 0.500 Test Loss: 1.331 Test Acc: 0.500
Validation loss decreased (-0.424986 --> -0.499987).  Saving model ...
Epoch: 5 cost time: 0.38538050651550293
Epoch: 5, Steps: 3 | Train Loss: 1.233 Vali Loss: 1.288 Vali Acc: 0.600 Test Loss: 1.288 Test Acc: 0.600
Validation loss decreased (-0.499987 --> -0.599987).  Saving model ...
Epoch: 6 cost time: 0.35574769973754883
Epoch: 6, Steps: 3 | Train Loss: 1.145 Vali Loss: 1.231 Vali Acc: 0.650 Test Loss: 1.231 Test Acc: 0.650
Validation loss decreased (-0.599987 --> -0.649988).  Saving model ...
Epoch: 7 cost time: 0.38599228858947754
Epoch: 7, Steps: 3 | Train Loss: 1.031 Vali Loss: 1.171 Vali Acc: 0.700 Test Loss: 1.171 Test Acc: 0.700
Validation loss decreased (-0.649988 --> -0.699988).  Saving model ...
Epoch: 8 cost time: 0.3489382266998291
Epoch: 8, Steps: 3 | Train Loss: 0.984 Vali Loss: 1.104 Vali Acc: 0.800 Test Loss: 1.104 Test Acc: 0.800
Validation loss decreased (-0.699988 --> -0.799989).  Saving model ...
Epoch: 9 cost time: 0.379896879196167
Epoch: 9, Steps: 3 | Train Loss: 0.902 Vali Loss: 1.035 Vali Acc: 0.850 Test Loss: 1.035 Test Acc: 0.850
Validation loss decreased (-0.799989 --> -0.849990).  Saving model ...
Epoch: 10 cost time: 0.33707761764526367
Epoch: 10, Steps: 3 | Train Loss: 0.812 Vali Loss: 0.965 Vali Acc: 0.875 Test Loss: 0.965 Test Acc: 0.875
Validation loss decreased (-0.849990 --> -0.874990).  Saving model ...
Epoch: 11 cost time: 0.3612794876098633
Epoch: 11, Steps: 3 | Train Loss: 0.761 Vali Loss: 0.892 Vali Acc: 0.900 Test Loss: 0.892 Test Acc: 0.900
Validation loss decreased (-0.874990 --> -0.899991).  Saving model ...
Epoch: 12 cost time: 0.34273672103881836
Epoch: 12, Steps: 3 | Train Loss: 0.679 Vali Loss: 0.844 Vali Acc: 0.925 Test Loss: 0.844 Test Acc: 0.925
Validation loss decreased (-0.899991 --> -0.924992).  Saving model ...
Epoch: 13 cost time: 0.3201427459716797
Epoch: 13, Steps: 3 | Train Loss: 0.621 Vali Loss: 0.786 Vali Acc: 0.925 Test Loss: 0.786 Test Acc: 0.925
Validation loss decreased (-0.924992 --> -0.924992).  Saving model ...
Epoch: 14 cost time: 0.3204066753387451
Epoch: 14, Steps: 3 | Train Loss: 0.561 Vali Loss: 0.721 Vali Acc: 0.900 Test Loss: 0.721 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.34282398223876953
Epoch: 15, Steps: 3 | Train Loss: 0.536 Vali Loss: 0.669 Vali Acc: 0.875 Test Loss: 0.669 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.34410548210144043
Epoch: 16, Steps: 3 | Train Loss: 0.472 Vali Loss: 0.622 Vali Acc: 0.875 Test Loss: 0.622 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.3397848606109619
Epoch: 17, Steps: 3 | Train Loss: 0.411 Vali Loss: 0.585 Vali Acc: 0.875 Test Loss: 0.585 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.34201884269714355
Epoch: 18, Steps: 3 | Train Loss: 0.400 Vali Loss: 0.540 Vali Acc: 0.875 Test Loss: 0.540 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.3694310188293457
Epoch: 19, Steps: 3 | Train Loss: 0.340 Vali Loss: 0.513 Vali Acc: 0.875 Test Loss: 0.513 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.370361328125
Epoch: 20, Steps: 3 | Train Loss: 0.326 Vali Loss: 0.493 Vali Acc: 0.875 Test Loss: 0.493 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.37767601013183594
Epoch: 21, Steps: 3 | Train Loss: 0.324 Vali Loss: 0.465 Vali Acc: 0.875 Test Loss: 0.465 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.35151124000549316
Epoch: 22, Steps: 3 | Train Loss: 0.293 Vali Loss: 0.437 Vali Acc: 0.900 Test Loss: 0.437 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.3723306655883789
Epoch: 23, Steps: 3 | Train Loss: 0.255 Vali Loss: 0.421 Vali Acc: 0.925 Test Loss: 0.421 Test Acc: 0.925
Validation loss decreased (-0.924992 --> -0.924996).  Saving model ...
Epoch: 24 cost time: 0.359130859375
Epoch: 24, Steps: 3 | Train Loss: 0.251 Vali Loss: 0.400 Vali Acc: 0.900 Test Loss: 0.400 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.40037035942077637
Epoch: 25, Steps: 3 | Train Loss: 0.215 Vali Loss: 0.381 Vali Acc: 0.925 Test Loss: 0.381 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 26 cost time: 0.37055230140686035
Epoch: 26, Steps: 3 | Train Loss: 0.205 Vali Loss: 0.362 Vali Acc: 0.925 Test Loss: 0.362 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 27 cost time: 0.3742258548736572
Epoch: 27, Steps: 3 | Train Loss: 0.184 Vali Loss: 0.338 Vali Acc: 0.925 Test Loss: 0.338 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924997).  Saving model ...
Epoch: 28 cost time: 0.3461463451385498
Epoch: 28, Steps: 3 | Train Loss: 0.172 Vali Loss: 0.322 Vali Acc: 0.925 Test Loss: 0.322 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 29 cost time: 0.3324861526489258
Epoch: 29, Steps: 3 | Train Loss: 0.179 Vali Loss: 0.304 Vali Acc: 0.925 Test Loss: 0.304 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 30 cost time: 0.3888823986053467
Epoch: 30, Steps: 3 | Train Loss: 0.136 Vali Loss: 0.293 Vali Acc: 0.925 Test Loss: 0.293 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 31 cost time: 0.3844180107116699
Epoch: 31, Steps: 3 | Train Loss: 0.135 Vali Loss: 0.278 Vali Acc: 0.925 Test Loss: 0.278 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 32 cost time: 0.3867957592010498
Epoch: 32, Steps: 3 | Train Loss: 0.138 Vali Loss: 0.270 Vali Acc: 0.925 Test Loss: 0.270 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 33 cost time: 0.37261033058166504
Epoch: 33, Steps: 3 | Train Loss: 0.121 Vali Loss: 0.262 Vali Acc: 0.925 Test Loss: 0.262 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 34 cost time: 0.3780641555786133
Epoch: 34, Steps: 3 | Train Loss: 0.098 Vali Loss: 0.254 Vali Acc: 0.925 Test Loss: 0.254 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 35 cost time: 0.3669905662536621
Epoch: 35, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.245 Vali Acc: 0.925 Test Loss: 0.245 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924998).  Saving model ...
Epoch: 36 cost time: 0.40015220642089844
Epoch: 36, Steps: 3 | Train Loss: 0.080 Vali Loss: 0.233 Vali Acc: 0.925 Test Loss: 0.233 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 37 cost time: 0.4812943935394287
Epoch: 37, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.230 Vali Acc: 0.925 Test Loss: 0.230 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 38 cost time: 0.49294352531433105
Epoch: 38, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.221 Vali Acc: 0.925 Test Loss: 0.221 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 39 cost time: 0.47933006286621094
Epoch: 39, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.210 Vali Acc: 0.925 Test Loss: 0.210 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 40 cost time: 0.4861478805541992
Epoch: 40, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.199 Vali Acc: 0.950 Test Loss: 0.199 Test Acc: 0.950
Validation loss decreased (-0.924998 --> -0.949998).  Saving model ...
Epoch: 41 cost time: 0.47026634216308594
Epoch: 41, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.195 Vali Acc: 0.950 Test Loss: 0.195 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 42 cost time: 0.40973567962646484
Epoch: 42, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.195 Vali Acc: 0.950 Test Loss: 0.195 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.48406267166137695
Epoch: 43, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.195 Vali Acc: 0.925 Test Loss: 0.195 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.4406454563140869
Epoch: 44, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.191 Vali Acc: 0.925 Test Loss: 0.191 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.4574925899505615
Epoch: 45, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.185 Vali Acc: 0.925 Test Loss: 0.185 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.4620180130004883
Epoch: 46, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.177 Vali Acc: 0.925 Test Loss: 0.177 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.4588949680328369
Epoch: 47, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.180 Vali Acc: 0.925 Test Loss: 0.180 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.39800214767456055
Epoch: 48, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.174 Vali Acc: 0.925 Test Loss: 0.174 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.39766955375671387
Epoch: 49, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.168 Vali Acc: 0.950 Test Loss: 0.168 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 50 cost time: 0.41452646255493164
Epoch: 50, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.167 Vali Acc: 0.950 Test Loss: 0.167 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 1182884
model size : 4.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.9586281776428223
Epoch: 1, Steps: 3 | Train Loss: 1.477 Vali Loss: 1.407 Vali Acc: 0.125 Test Loss: 1.407 Test Acc: 0.125
Validation loss decreased (inf --> -0.124986).  Saving model ...
Epoch: 2 cost time: 0.5168943405151367
Epoch: 2, Steps: 3 | Train Loss: 1.423 Vali Loss: 1.402 Vali Acc: 0.125 Test Loss: 1.402 Test Acc: 0.125
Validation loss decreased (-0.124986 --> -0.124986).  Saving model ...
Epoch: 3 cost time: 0.4602785110473633
Epoch: 3, Steps: 3 | Train Loss: 1.397 Vali Loss: 1.393 Vali Acc: 0.150 Test Loss: 1.393 Test Acc: 0.150
Validation loss decreased (-0.124986 --> -0.149986).  Saving model ...
Epoch: 4 cost time: 0.43059611320495605
Epoch: 4, Steps: 3 | Train Loss: 1.330 Vali Loss: 1.373 Vali Acc: 0.200 Test Loss: 1.373 Test Acc: 0.200
Validation loss decreased (-0.149986 --> -0.199986).  Saving model ...
Epoch: 5 cost time: 0.5217864513397217
Epoch: 5, Steps: 3 | Train Loss: 1.267 Vali Loss: 1.343 Vali Acc: 0.350 Test Loss: 1.343 Test Acc: 0.350
Validation loss decreased (-0.199986 --> -0.349987).  Saving model ...
Epoch: 6 cost time: 0.48066043853759766
Epoch: 6, Steps: 3 | Train Loss: 1.218 Vali Loss: 1.303 Vali Acc: 0.400 Test Loss: 1.303 Test Acc: 0.400
Validation loss decreased (-0.349987 --> -0.399987).  Saving model ...
Epoch: 7 cost time: 0.49892663955688477
Epoch: 7, Steps: 3 | Train Loss: 1.131 Vali Loss: 1.257 Vali Acc: 0.400 Test Loss: 1.257 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 8 cost time: 0.45928192138671875
Epoch: 8, Steps: 3 | Train Loss: 1.072 Vali Loss: 1.210 Vali Acc: 0.475 Test Loss: 1.210 Test Acc: 0.475
Validation loss decreased (-0.399987 --> -0.474988).  Saving model ...
Epoch: 9 cost time: 0.49939584732055664
Epoch: 9, Steps: 3 | Train Loss: 1.001 Vali Loss: 1.157 Vali Acc: 0.525 Test Loss: 1.157 Test Acc: 0.525
Validation loss decreased (-0.474988 --> -0.524988).  Saving model ...
Epoch: 10 cost time: 0.5101597309112549
Epoch: 10, Steps: 3 | Train Loss: 0.927 Vali Loss: 1.100 Vali Acc: 0.575 Test Loss: 1.100 Test Acc: 0.575
Validation loss decreased (-0.524988 --> -0.574989).  Saving model ...
Epoch: 11 cost time: 0.5079538822174072
Epoch: 11, Steps: 3 | Train Loss: 0.859 Vali Loss: 1.043 Vali Acc: 0.650 Test Loss: 1.043 Test Acc: 0.650
Validation loss decreased (-0.574989 --> -0.649990).  Saving model ...
Epoch: 12 cost time: 0.42817234992980957
Epoch: 12, Steps: 3 | Train Loss: 0.869 Vali Loss: 0.981 Vali Acc: 0.650 Test Loss: 0.981 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649990).  Saving model ...
Epoch: 13 cost time: 0.42407941818237305
Epoch: 13, Steps: 3 | Train Loss: 0.787 Vali Loss: 0.922 Vali Acc: 0.675 Test Loss: 0.922 Test Acc: 0.675
Validation loss decreased (-0.649990 --> -0.674991).  Saving model ...
Epoch: 14 cost time: 0.4144599437713623
Epoch: 14, Steps: 3 | Train Loss: 0.706 Vali Loss: 0.876 Vali Acc: 0.725 Test Loss: 0.876 Test Acc: 0.725
Validation loss decreased (-0.674991 --> -0.724991).  Saving model ...
Epoch: 15 cost time: 0.44528651237487793
Epoch: 15, Steps: 3 | Train Loss: 0.639 Vali Loss: 0.833 Vali Acc: 0.750 Test Loss: 0.833 Test Acc: 0.750
Validation loss decreased (-0.724991 --> -0.749992).  Saving model ...
Epoch: 16 cost time: 0.4428229331970215
Epoch: 16, Steps: 3 | Train Loss: 0.595 Vali Loss: 0.788 Vali Acc: 0.775 Test Loss: 0.788 Test Acc: 0.775
Validation loss decreased (-0.749992 --> -0.774992).  Saving model ...
Epoch: 17 cost time: 0.4219639301300049
Epoch: 17, Steps: 3 | Train Loss: 0.559 Vali Loss: 0.755 Vali Acc: 0.875 Test Loss: 0.755 Test Acc: 0.875
Validation loss decreased (-0.774992 --> -0.874992).  Saving model ...
Epoch: 18 cost time: 0.3951265811920166
Epoch: 18, Steps: 3 | Train Loss: 0.541 Vali Loss: 0.710 Vali Acc: 0.900 Test Loss: 0.710 Test Acc: 0.900
Validation loss decreased (-0.874992 --> -0.899993).  Saving model ...
Epoch: 19 cost time: 0.4278593063354492
Epoch: 19, Steps: 3 | Train Loss: 0.480 Vali Loss: 0.678 Vali Acc: 0.925 Test Loss: 0.678 Test Acc: 0.925
Validation loss decreased (-0.899993 --> -0.924993).  Saving model ...
Epoch: 20 cost time: 0.5080339908599854
Epoch: 20, Steps: 3 | Train Loss: 0.447 Vali Loss: 0.639 Vali Acc: 0.925 Test Loss: 0.639 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924994).  Saving model ...
Epoch: 21 cost time: 0.46990489959716797
Epoch: 21, Steps: 3 | Train Loss: 0.402 Vali Loss: 0.612 Vali Acc: 0.900 Test Loss: 0.612 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.44907259941101074
Epoch: 22, Steps: 3 | Train Loss: 0.395 Vali Loss: 0.582 Vali Acc: 0.900 Test Loss: 0.582 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.4519379138946533
Epoch: 23, Steps: 3 | Train Loss: 0.366 Vali Loss: 0.564 Vali Acc: 0.850 Test Loss: 0.564 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.46578550338745117
Epoch: 24, Steps: 3 | Train Loss: 0.344 Vali Loss: 0.541 Vali Acc: 0.900 Test Loss: 0.541 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.5172555446624756
Epoch: 25, Steps: 3 | Train Loss: 0.322 Vali Loss: 0.513 Vali Acc: 0.900 Test Loss: 0.513 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.49715542793273926
Epoch: 26, Steps: 3 | Train Loss: 0.308 Vali Loss: 0.485 Vali Acc: 0.900 Test Loss: 0.485 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.4667093753814697
Epoch: 27, Steps: 3 | Train Loss: 0.272 Vali Loss: 0.471 Vali Acc: 0.900 Test Loss: 0.471 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.47304415702819824
Epoch: 28, Steps: 3 | Train Loss: 0.250 Vali Loss: 0.462 Vali Acc: 0.875 Test Loss: 0.462 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.5096502304077148
Epoch: 29, Steps: 3 | Train Loss: 0.263 Vali Loss: 0.446 Vali Acc: 0.900 Test Loss: 0.446 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.5012192726135254
Epoch: 30, Steps: 3 | Train Loss: 0.236 Vali Loss: 0.424 Vali Acc: 0.900 Test Loss: 0.424 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 1176804
model size : 4.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.7756707668304443
Epoch: 1, Steps: 3 | Train Loss: 1.372 Vali Loss: 1.352 Vali Acc: 0.300 Test Loss: 1.352 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 0.5215499401092529
Epoch: 2, Steps: 3 | Train Loss: 1.307 Vali Loss: 1.341 Vali Acc: 0.325 Test Loss: 1.341 Test Acc: 0.325
Validation loss decreased (-0.299986 --> -0.324987).  Saving model ...
Epoch: 3 cost time: 0.5230309963226318
Epoch: 3, Steps: 3 | Train Loss: 1.323 Vali Loss: 1.325 Vali Acc: 0.350 Test Loss: 1.325 Test Acc: 0.350
Validation loss decreased (-0.324987 --> -0.349987).  Saving model ...
Epoch: 4 cost time: 0.5200114250183105
Epoch: 4, Steps: 3 | Train Loss: 1.248 Vali Loss: 1.303 Vali Acc: 0.325 Test Loss: 1.303 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5222783088684082
Epoch: 5, Steps: 3 | Train Loss: 1.222 Vali Loss: 1.274 Vali Acc: 0.375 Test Loss: 1.274 Test Acc: 0.375
Validation loss decreased (-0.349987 --> -0.374987).  Saving model ...
Epoch: 6 cost time: 0.5185954570770264
Epoch: 6, Steps: 3 | Train Loss: 1.172 Vali Loss: 1.239 Vali Acc: 0.525 Test Loss: 1.239 Test Acc: 0.525
Validation loss decreased (-0.374987 --> -0.524988).  Saving model ...
Epoch: 7 cost time: 0.5537581443786621
Epoch: 7, Steps: 3 | Train Loss: 1.117 Vali Loss: 1.200 Vali Acc: 0.575 Test Loss: 1.200 Test Acc: 0.575
Validation loss decreased (-0.524988 --> -0.574988).  Saving model ...
Epoch: 8 cost time: 0.4537951946258545
Epoch: 8, Steps: 3 | Train Loss: 1.064 Vali Loss: 1.155 Vali Acc: 0.575 Test Loss: 1.155 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 9 cost time: 0.44763827323913574
Epoch: 9, Steps: 3 | Train Loss: 1.011 Vali Loss: 1.111 Vali Acc: 0.675 Test Loss: 1.111 Test Acc: 0.675
Validation loss decreased (-0.574988 --> -0.674989).  Saving model ...
Epoch: 10 cost time: 0.5445528030395508
Epoch: 10, Steps: 3 | Train Loss: 0.956 Vali Loss: 1.061 Vali Acc: 0.675 Test Loss: 1.061 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674989).  Saving model ...
Epoch: 11 cost time: 0.531810998916626
Epoch: 11, Steps: 3 | Train Loss: 0.895 Vali Loss: 1.016 Vali Acc: 0.725 Test Loss: 1.016 Test Acc: 0.725
Validation loss decreased (-0.674989 --> -0.724990).  Saving model ...
Epoch: 12 cost time: 0.5227699279785156
Epoch: 12, Steps: 3 | Train Loss: 0.837 Vali Loss: 0.967 Vali Acc: 0.750 Test Loss: 0.967 Test Acc: 0.750
Validation loss decreased (-0.724990 --> -0.749990).  Saving model ...
Epoch: 13 cost time: 0.4839186668395996
Epoch: 13, Steps: 3 | Train Loss: 0.793 Vali Loss: 0.923 Vali Acc: 0.775 Test Loss: 0.923 Test Acc: 0.775
Validation loss decreased (-0.749990 --> -0.774991).  Saving model ...
Epoch: 14 cost time: 0.5522782802581787
Epoch: 14, Steps: 3 | Train Loss: 0.749 Vali Loss: 0.874 Vali Acc: 0.800 Test Loss: 0.874 Test Acc: 0.800
Validation loss decreased (-0.774991 --> -0.799991).  Saving model ...
Epoch: 15 cost time: 0.4605896472930908
Epoch: 15, Steps: 3 | Train Loss: 0.713 Vali Loss: 0.829 Vali Acc: 0.825 Test Loss: 0.829 Test Acc: 0.825
Validation loss decreased (-0.799991 --> -0.824992).  Saving model ...
Epoch: 16 cost time: 0.463223934173584
Epoch: 16, Steps: 3 | Train Loss: 0.677 Vali Loss: 0.791 Vali Acc: 0.875 Test Loss: 0.791 Test Acc: 0.875
Validation loss decreased (-0.824992 --> -0.874992).  Saving model ...
Epoch: 17 cost time: 0.5030820369720459
Epoch: 17, Steps: 3 | Train Loss: 0.616 Vali Loss: 0.747 Vali Acc: 0.875 Test Loss: 0.747 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874993).  Saving model ...
Epoch: 18 cost time: 0.4918675422668457
Epoch: 18, Steps: 3 | Train Loss: 0.556 Vali Loss: 0.712 Vali Acc: 0.925 Test Loss: 0.712 Test Acc: 0.925
Validation loss decreased (-0.874993 --> -0.924993).  Saving model ...
Epoch: 19 cost time: 0.47180747985839844
Epoch: 19, Steps: 3 | Train Loss: 0.519 Vali Loss: 0.671 Vali Acc: 0.925 Test Loss: 0.671 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924993).  Saving model ...
Epoch: 20 cost time: 0.4679412841796875
Epoch: 20, Steps: 3 | Train Loss: 0.489 Vali Loss: 0.644 Vali Acc: 0.925 Test Loss: 0.644 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924994).  Saving model ...
Epoch: 21 cost time: 0.558974027633667
Epoch: 21, Steps: 3 | Train Loss: 0.474 Vali Loss: 0.614 Vali Acc: 0.925 Test Loss: 0.614 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 22 cost time: 0.5188205242156982
Epoch: 22, Steps: 3 | Train Loss: 0.421 Vali Loss: 0.577 Vali Acc: 0.925 Test Loss: 0.577 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 23 cost time: 0.4845097064971924
Epoch: 23, Steps: 3 | Train Loss: 0.391 Vali Loss: 0.551 Vali Acc: 0.925 Test Loss: 0.551 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 24 cost time: 0.459716796875
Epoch: 24, Steps: 3 | Train Loss: 0.371 Vali Loss: 0.533 Vali Acc: 0.925 Test Loss: 0.533 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 25 cost time: 0.4392085075378418
Epoch: 25, Steps: 3 | Train Loss: 0.349 Vali Loss: 0.503 Vali Acc: 0.925 Test Loss: 0.503 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 26 cost time: 0.46503758430480957
Epoch: 26, Steps: 3 | Train Loss: 0.314 Vali Loss: 0.475 Vali Acc: 0.925 Test Loss: 0.475 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 27 cost time: 0.41712188720703125
Epoch: 27, Steps: 3 | Train Loss: 0.299 Vali Loss: 0.454 Vali Acc: 0.925 Test Loss: 0.454 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 28 cost time: 0.3887472152709961
Epoch: 28, Steps: 3 | Train Loss: 0.276 Vali Loss: 0.433 Vali Acc: 0.925 Test Loss: 0.433 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 29 cost time: 0.44212889671325684
Epoch: 29, Steps: 3 | Train Loss: 0.263 Vali Loss: 0.420 Vali Acc: 0.950 Test Loss: 0.420 Test Acc: 0.950
Validation loss decreased (-0.924996 --> -0.949996).  Saving model ...
Epoch: 30 cost time: 0.46305108070373535
Epoch: 30, Steps: 3 | Train Loss: 0.236 Vali Loss: 0.400 Vali Acc: 0.950 Test Loss: 0.400 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 31 cost time: 0.5390958786010742
Epoch: 31, Steps: 3 | Train Loss: 0.221 Vali Loss: 0.378 Vali Acc: 0.950 Test Loss: 0.378 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 32 cost time: 0.47392749786376953
Epoch: 32, Steps: 3 | Train Loss: 0.232 Vali Loss: 0.356 Vali Acc: 0.950 Test Loss: 0.356 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 33 cost time: 0.4941418170928955
Epoch: 33, Steps: 3 | Train Loss: 0.207 Vali Loss: 0.339 Vali Acc: 0.950 Test Loss: 0.339 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 34 cost time: 0.4787721633911133
Epoch: 34, Steps: 3 | Train Loss: 0.181 Vali Loss: 0.332 Vali Acc: 0.950 Test Loss: 0.332 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 35 cost time: 0.5660619735717773
Epoch: 35, Steps: 3 | Train Loss: 0.185 Vali Loss: 0.317 Vali Acc: 0.975 Test Loss: 0.317 Test Acc: 0.975
Validation loss decreased (-0.949997 --> -0.974997).  Saving model ...
Epoch: 36 cost time: 0.47547292709350586
Epoch: 36, Steps: 3 | Train Loss: 0.194 Vali Loss: 0.298 Vali Acc: 0.975 Test Loss: 0.298 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 37 cost time: 0.539844274520874
Epoch: 37, Steps: 3 | Train Loss: 0.153 Vali Loss: 0.289 Vali Acc: 0.975 Test Loss: 0.289 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 38 cost time: 0.5037682056427002
Epoch: 38, Steps: 3 | Train Loss: 0.165 Vali Loss: 0.285 Vali Acc: 0.975 Test Loss: 0.285 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 39 cost time: 0.47277092933654785
Epoch: 39, Steps: 3 | Train Loss: 0.125 Vali Loss: 0.276 Vali Acc: 0.975 Test Loss: 0.276 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 40 cost time: 0.5200560092926025
Epoch: 40, Steps: 3 | Train Loss: 0.128 Vali Loss: 0.259 Vali Acc: 0.975 Test Loss: 0.259 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 41 cost time: 0.4691038131713867
Epoch: 41, Steps: 3 | Train Loss: 0.099 Vali Loss: 0.257 Vali Acc: 0.975 Test Loss: 0.257 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 42 cost time: 0.5364892482757568
Epoch: 42, Steps: 3 | Train Loss: 0.128 Vali Loss: 0.249 Vali Acc: 0.975 Test Loss: 0.249 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 43 cost time: 0.5857384204864502
Epoch: 43, Steps: 3 | Train Loss: 0.095 Vali Loss: 0.246 Vali Acc: 0.975 Test Loss: 0.246 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 44 cost time: 0.4892416000366211
Epoch: 44, Steps: 3 | Train Loss: 0.102 Vali Loss: 0.237 Vali Acc: 0.975 Test Loss: 0.237 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 45 cost time: 0.5550754070281982
Epoch: 45, Steps: 3 | Train Loss: 0.086 Vali Loss: 0.225 Vali Acc: 0.975 Test Loss: 0.225 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 46 cost time: 0.49166059494018555
Epoch: 46, Steps: 3 | Train Loss: 0.081 Vali Loss: 0.215 Vali Acc: 0.975 Test Loss: 0.215 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 47 cost time: 0.5152888298034668
Epoch: 47, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.211 Vali Acc: 0.975 Test Loss: 0.211 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 48 cost time: 0.4647998809814453
Epoch: 48, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.201 Vali Acc: 0.975 Test Loss: 0.201 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 49 cost time: 0.46428942680358887
Epoch: 49, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.196 Vali Acc: 0.975 Test Loss: 0.196 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 50 cost time: 0.5409083366394043
Epoch: 50, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.181 Vali Acc: 0.975 Test Loss: 0.181 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 1170820
model size : 4.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps20_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.7559239864349365
Epoch: 1, Steps: 3 | Train Loss: 1.371 Vali Loss: 1.394 Vali Acc: 0.175 Test Loss: 1.394 Test Acc: 0.175
Validation loss decreased (inf --> -0.174986).  Saving model ...
Epoch: 2 cost time: 0.47173333168029785
Epoch: 2, Steps: 3 | Train Loss: 1.366 Vali Loss: 1.388 Vali Acc: 0.200 Test Loss: 1.388 Test Acc: 0.200
Validation loss decreased (-0.174986 --> -0.199986).  Saving model ...
Epoch: 3 cost time: 0.48085665702819824
Epoch: 3, Steps: 3 | Train Loss: 1.312 Vali Loss: 1.378 Vali Acc: 0.200 Test Loss: 1.378 Test Acc: 0.200
Validation loss decreased (-0.199986 --> -0.199986).  Saving model ...
Epoch: 4 cost time: 0.4495232105255127
Epoch: 4, Steps: 3 | Train Loss: 1.272 Vali Loss: 1.362 Vali Acc: 0.350 Test Loss: 1.362 Test Acc: 0.350
Validation loss decreased (-0.199986 --> -0.349986).  Saving model ...
Epoch: 5 cost time: 0.4558136463165283
Epoch: 5, Steps: 3 | Train Loss: 1.240 Vali Loss: 1.340 Vali Acc: 0.475 Test Loss: 1.340 Test Acc: 0.475
Validation loss decreased (-0.349986 --> -0.474987).  Saving model ...
Epoch: 6 cost time: 0.4440920352935791
Epoch: 6, Steps: 3 | Train Loss: 1.190 Vali Loss: 1.311 Vali Acc: 0.550 Test Loss: 1.311 Test Acc: 0.550
Validation loss decreased (-0.474987 --> -0.549987).  Saving model ...
Epoch: 7 cost time: 0.46794724464416504
Epoch: 7, Steps: 3 | Train Loss: 1.167 Vali Loss: 1.276 Vali Acc: 0.625 Test Loss: 1.276 Test Acc: 0.625
Validation loss decreased (-0.549987 --> -0.624987).  Saving model ...
Epoch: 8 cost time: 0.5401816368103027
Epoch: 8, Steps: 3 | Train Loss: 1.100 Vali Loss: 1.237 Vali Acc: 0.725 Test Loss: 1.237 Test Acc: 0.725
Validation loss decreased (-0.624987 --> -0.724988).  Saving model ...
Epoch: 9 cost time: 0.5110697746276855
Epoch: 9, Steps: 3 | Train Loss: 1.025 Vali Loss: 1.199 Vali Acc: 0.800 Test Loss: 1.199 Test Acc: 0.800
Validation loss decreased (-0.724988 --> -0.799988).  Saving model ...
Epoch: 10 cost time: 0.426710844039917
Epoch: 10, Steps: 3 | Train Loss: 0.992 Vali Loss: 1.155 Vali Acc: 0.800 Test Loss: 1.155 Test Acc: 0.800
Validation loss decreased (-0.799988 --> -0.799988).  Saving model ...
Epoch: 11 cost time: 0.4744431972503662
Epoch: 11, Steps: 3 | Train Loss: 0.910 Vali Loss: 1.108 Vali Acc: 0.800 Test Loss: 1.108 Test Acc: 0.800
Validation loss decreased (-0.799988 --> -0.799989).  Saving model ...
Epoch: 12 cost time: 0.4921138286590576
Epoch: 12, Steps: 3 | Train Loss: 0.880 Vali Loss: 1.062 Vali Acc: 0.800 Test Loss: 1.062 Test Acc: 0.800
Validation loss decreased (-0.799989 --> -0.799989).  Saving model ...
Epoch: 13 cost time: 0.4488697052001953
Epoch: 13, Steps: 3 | Train Loss: 0.845 Vali Loss: 1.017 Vali Acc: 0.825 Test Loss: 1.017 Test Acc: 0.825
Validation loss decreased (-0.799989 --> -0.824990).  Saving model ...
Epoch: 14 cost time: 0.46765589714050293
Epoch: 14, Steps: 3 | Train Loss: 0.763 Vali Loss: 0.981 Vali Acc: 0.875 Test Loss: 0.981 Test Acc: 0.875
Validation loss decreased (-0.824990 --> -0.874990).  Saving model ...
Epoch: 15 cost time: 0.4479067325592041
Epoch: 15, Steps: 3 | Train Loss: 0.722 Vali Loss: 0.942 Vali Acc: 0.875 Test Loss: 0.942 Test Acc: 0.875
Validation loss decreased (-0.874990 --> -0.874991).  Saving model ...
Epoch: 16 cost time: 0.50667405128479
Epoch: 16, Steps: 3 | Train Loss: 0.716 Vali Loss: 0.899 Vali Acc: 0.850 Test Loss: 0.899 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5134916305541992
Epoch: 17, Steps: 3 | Train Loss: 0.654 Vali Loss: 0.869 Vali Acc: 0.900 Test Loss: 0.869 Test Acc: 0.900
Validation loss decreased (-0.874991 --> -0.899991).  Saving model ...
Epoch: 18 cost time: 0.561518669128418
Epoch: 18, Steps: 3 | Train Loss: 0.599 Vali Loss: 0.844 Vali Acc: 0.900 Test Loss: 0.844 Test Acc: 0.900
Validation loss decreased (-0.899991 --> -0.899992).  Saving model ...
Epoch: 19 cost time: 0.4229393005371094
Epoch: 19, Steps: 3 | Train Loss: 0.554 Vali Loss: 0.811 Vali Acc: 0.900 Test Loss: 0.811 Test Acc: 0.900
Validation loss decreased (-0.899992 --> -0.899992).  Saving model ...
Epoch: 20 cost time: 0.4249851703643799
Epoch: 20, Steps: 3 | Train Loss: 0.548 Vali Loss: 0.773 Vali Acc: 0.900 Test Loss: 0.773 Test Acc: 0.900
Validation loss decreased (-0.899992 --> -0.899992).  Saving model ...
Epoch: 21 cost time: 0.44611597061157227
Epoch: 21, Steps: 3 | Train Loss: 0.486 Vali Loss: 0.748 Vali Acc: 0.900 Test Loss: 0.748 Test Acc: 0.900
Validation loss decreased (-0.899992 --> -0.899993).  Saving model ...
Epoch: 22 cost time: 0.49239087104797363
Epoch: 22, Steps: 3 | Train Loss: 0.483 Vali Loss: 0.723 Vali Acc: 0.900 Test Loss: 0.723 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 23 cost time: 0.4869043827056885
Epoch: 23, Steps: 3 | Train Loss: 0.438 Vali Loss: 0.704 Vali Acc: 0.900 Test Loss: 0.704 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 24 cost time: 0.5276806354522705
Epoch: 24, Steps: 3 | Train Loss: 0.432 Vali Loss: 0.677 Vali Acc: 0.900 Test Loss: 0.677 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 25 cost time: 0.5059502124786377
Epoch: 25, Steps: 3 | Train Loss: 0.399 Vali Loss: 0.646 Vali Acc: 0.875 Test Loss: 0.646 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6149189472198486
Epoch: 26, Steps: 3 | Train Loss: 0.404 Vali Loss: 0.617 Vali Acc: 0.875 Test Loss: 0.617 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.4870150089263916
Epoch: 27, Steps: 3 | Train Loss: 0.363 Vali Loss: 0.597 Vali Acc: 0.875 Test Loss: 0.597 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.5614871978759766
Epoch: 28, Steps: 3 | Train Loss: 0.340 Vali Loss: 0.570 Vali Acc: 0.875 Test Loss: 0.570 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.47024035453796387
Epoch: 29, Steps: 3 | Train Loss: 0.359 Vali Loss: 0.548 Vali Acc: 0.875 Test Loss: 0.548 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.4670565128326416
Epoch: 30, Steps: 3 | Train Loss: 0.296 Vali Loss: 0.518 Vali Acc: 0.875 Test Loss: 0.518 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.5373783111572266
Epoch: 31, Steps: 3 | Train Loss: 0.317 Vali Loss: 0.506 Vali Acc: 0.875 Test Loss: 0.506 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.5354394912719727
Epoch: 32, Steps: 3 | Train Loss: 0.283 Vali Loss: 0.497 Vali Acc: 0.875 Test Loss: 0.497 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.48377251625061035
Epoch: 33, Steps: 3 | Train Loss: 0.263 Vali Loss: 0.483 Vali Acc: 0.875 Test Loss: 0.483 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.5345842838287354
Epoch: 34, Steps: 3 | Train Loss: 0.255 Vali Loss: 0.464 Vali Acc: 0.875 Test Loss: 0.464 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps20_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 1170980
model size : 4.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps25_str13_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.96024751663208
Epoch: 1, Steps: 3 | Train Loss: 1.371 Vali Loss: 1.387 Vali Acc: 0.150 Test Loss: 1.387 Test Acc: 0.150
Validation loss decreased (inf --> -0.149986).  Saving model ...
Epoch: 2 cost time: 0.464336633682251
Epoch: 2, Steps: 3 | Train Loss: 1.333 Vali Loss: 1.381 Vali Acc: 0.150 Test Loss: 1.381 Test Acc: 0.150
Validation loss decreased (-0.149986 --> -0.149986).  Saving model ...
Epoch: 3 cost time: 0.48500847816467285
Epoch: 3, Steps: 3 | Train Loss: 1.336 Vali Loss: 1.374 Vali Acc: 0.150 Test Loss: 1.374 Test Acc: 0.150
Validation loss decreased (-0.149986 --> -0.149986).  Saving model ...
Epoch: 4 cost time: 0.44092464447021484
Epoch: 4, Steps: 3 | Train Loss: 1.292 Vali Loss: 1.361 Vali Acc: 0.150 Test Loss: 1.361 Test Acc: 0.150
Validation loss decreased (-0.149986 --> -0.149986).  Saving model ...
Epoch: 5 cost time: 0.49623560905456543
Epoch: 5, Steps: 3 | Train Loss: 1.259 Vali Loss: 1.344 Vali Acc: 0.250 Test Loss: 1.344 Test Acc: 0.250
Validation loss decreased (-0.149986 --> -0.249987).  Saving model ...
Epoch: 6 cost time: 0.47001147270202637
Epoch: 6, Steps: 3 | Train Loss: 1.242 Vali Loss: 1.321 Vali Acc: 0.325 Test Loss: 1.321 Test Acc: 0.325
Validation loss decreased (-0.249987 --> -0.324987).  Saving model ...
Epoch: 7 cost time: 0.5096096992492676
Epoch: 7, Steps: 3 | Train Loss: 1.206 Vali Loss: 1.293 Vali Acc: 0.375 Test Loss: 1.293 Test Acc: 0.375
Validation loss decreased (-0.324987 --> -0.374987).  Saving model ...
Epoch: 8 cost time: 0.5215697288513184
Epoch: 8, Steps: 3 | Train Loss: 1.125 Vali Loss: 1.264 Vali Acc: 0.400 Test Loss: 1.264 Test Acc: 0.400
Validation loss decreased (-0.374987 --> -0.399987).  Saving model ...
Epoch: 9 cost time: 0.5082097053527832
Epoch: 9, Steps: 3 | Train Loss: 1.090 Vali Loss: 1.233 Vali Acc: 0.475 Test Loss: 1.233 Test Acc: 0.475
Validation loss decreased (-0.399987 --> -0.474988).  Saving model ...
Epoch: 10 cost time: 0.4793071746826172
Epoch: 10, Steps: 3 | Train Loss: 1.061 Vali Loss: 1.199 Vali Acc: 0.525 Test Loss: 1.199 Test Acc: 0.525
Validation loss decreased (-0.474988 --> -0.524988).  Saving model ...
Epoch: 11 cost time: 0.4847099781036377
Epoch: 11, Steps: 3 | Train Loss: 1.011 Vali Loss: 1.165 Vali Acc: 0.625 Test Loss: 1.165 Test Acc: 0.625
Validation loss decreased (-0.524988 --> -0.624988).  Saving model ...
Epoch: 12 cost time: 0.4895751476287842
Epoch: 12, Steps: 3 | Train Loss: 0.963 Vali Loss: 1.128 Vali Acc: 0.775 Test Loss: 1.128 Test Acc: 0.775
Validation loss decreased (-0.624988 --> -0.774989).  Saving model ...
Epoch: 13 cost time: 0.45000505447387695
Epoch: 13, Steps: 3 | Train Loss: 0.911 Vali Loss: 1.096 Vali Acc: 0.725 Test Loss: 1.096 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.4902470111846924
Epoch: 14, Steps: 3 | Train Loss: 0.859 Vali Loss: 1.062 Vali Acc: 0.725 Test Loss: 1.062 Test Acc: 0.725
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.5741562843322754
Epoch: 15, Steps: 3 | Train Loss: 0.838 Vali Loss: 1.024 Vali Acc: 0.750 Test Loss: 1.024 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.5137276649475098
Epoch: 16, Steps: 3 | Train Loss: 0.789 Vali Loss: 0.987 Vali Acc: 0.750 Test Loss: 0.987 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.448012113571167
Epoch: 17, Steps: 3 | Train Loss: 0.732 Vali Loss: 0.954 Vali Acc: 0.725 Test Loss: 0.954 Test Acc: 0.725
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.44051241874694824
Epoch: 18, Steps: 3 | Train Loss: 0.696 Vali Loss: 0.926 Vali Acc: 0.700 Test Loss: 0.926 Test Acc: 0.700
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.40898871421813965
Epoch: 19, Steps: 3 | Train Loss: 0.710 Vali Loss: 0.890 Vali Acc: 0.700 Test Loss: 0.890 Test Acc: 0.700
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.4729292392730713
Epoch: 20, Steps: 3 | Train Loss: 0.630 Vali Loss: 0.865 Vali Acc: 0.700 Test Loss: 0.865 Test Acc: 0.700
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.44167184829711914
Epoch: 21, Steps: 3 | Train Loss: 0.601 Vali Loss: 0.829 Vali Acc: 0.700 Test Loss: 0.829 Test Acc: 0.700
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.493635892868042
Epoch: 22, Steps: 3 | Train Loss: 0.562 Vali Loss: 0.795 Vali Acc: 0.750 Test Loss: 0.795 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps25_str13_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.775
model parameter : 1168068
model size : 4.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.6221826076507568
Epoch: 1, Steps: 3 | Train Loss: 1.394 Vali Loss: 1.367 Vali Acc: 0.250 Test Loss: 1.367 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 0.41623926162719727
Epoch: 2, Steps: 3 | Train Loss: 1.365 Vali Loss: 1.351 Vali Acc: 0.225 Test Loss: 1.351 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5313937664031982
Epoch: 3, Steps: 3 | Train Loss: 1.298 Vali Loss: 1.323 Vali Acc: 0.375 Test Loss: 1.323 Test Acc: 0.375
Validation loss decreased (-0.249986 --> -0.374987).  Saving model ...
Epoch: 4 cost time: 0.4761803150177002
Epoch: 4, Steps: 3 | Train Loss: 1.201 Vali Loss: 1.278 Vali Acc: 0.650 Test Loss: 1.278 Test Acc: 0.650
Validation loss decreased (-0.374987 --> -0.649987).  Saving model ...
Epoch: 5 cost time: 0.4669327735900879
Epoch: 5, Steps: 3 | Train Loss: 1.098 Vali Loss: 1.218 Vali Acc: 0.625 Test Loss: 1.218 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5002663135528564
Epoch: 6, Steps: 3 | Train Loss: 1.015 Vali Loss: 1.144 Vali Acc: 0.725 Test Loss: 1.144 Test Acc: 0.725
Validation loss decreased (-0.649987 --> -0.724989).  Saving model ...
Epoch: 7 cost time: 0.6063268184661865
Epoch: 7, Steps: 3 | Train Loss: 0.896 Vali Loss: 1.061 Vali Acc: 0.725 Test Loss: 1.061 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724989).  Saving model ...
Epoch: 8 cost time: 0.47496485710144043
Epoch: 8, Steps: 3 | Train Loss: 0.813 Vali Loss: 0.968 Vali Acc: 0.850 Test Loss: 0.968 Test Acc: 0.850
Validation loss decreased (-0.724989 --> -0.849990).  Saving model ...
Epoch: 9 cost time: 0.5306956768035889
Epoch: 9, Steps: 3 | Train Loss: 0.706 Vali Loss: 0.872 Vali Acc: 0.950 Test Loss: 0.872 Test Acc: 0.950
Validation loss decreased (-0.849990 --> -0.949991).  Saving model ...
Epoch: 10 cost time: 0.4889864921569824
Epoch: 10, Steps: 3 | Train Loss: 0.620 Vali Loss: 0.786 Vali Acc: 0.950 Test Loss: 0.786 Test Acc: 0.950
Validation loss decreased (-0.949991 --> -0.949992).  Saving model ...
Epoch: 11 cost time: 0.49495601654052734
Epoch: 11, Steps: 3 | Train Loss: 0.516 Vali Loss: 0.717 Vali Acc: 0.950 Test Loss: 0.717 Test Acc: 0.950
Validation loss decreased (-0.949992 --> -0.949993).  Saving model ...
Epoch: 12 cost time: 0.5228376388549805
Epoch: 12, Steps: 3 | Train Loss: 0.455 Vali Loss: 0.636 Vali Acc: 0.950 Test Loss: 0.636 Test Acc: 0.950
Validation loss decreased (-0.949993 --> -0.949994).  Saving model ...
Epoch: 13 cost time: 0.44816136360168457
Epoch: 13, Steps: 3 | Train Loss: 0.401 Vali Loss: 0.571 Vali Acc: 0.950 Test Loss: 0.571 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949994).  Saving model ...
Epoch: 14 cost time: 0.517174243927002
Epoch: 14, Steps: 3 | Train Loss: 0.368 Vali Loss: 0.508 Vali Acc: 0.950 Test Loss: 0.508 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 15 cost time: 0.5636780261993408
Epoch: 15, Steps: 3 | Train Loss: 0.346 Vali Loss: 0.449 Vali Acc: 0.950 Test Loss: 0.449 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 16 cost time: 0.4944643974304199
Epoch: 16, Steps: 3 | Train Loss: 0.290 Vali Loss: 0.415 Vali Acc: 0.950 Test Loss: 0.415 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 17 cost time: 0.5045449733734131
Epoch: 17, Steps: 3 | Train Loss: 0.273 Vali Loss: 0.377 Vali Acc: 0.950 Test Loss: 0.377 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 18 cost time: 0.45972180366516113
Epoch: 18, Steps: 3 | Train Loss: 0.243 Vali Loss: 0.358 Vali Acc: 0.950 Test Loss: 0.358 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 19 cost time: 0.4715447425842285
Epoch: 19, Steps: 3 | Train Loss: 0.224 Vali Loss: 0.331 Vali Acc: 0.950 Test Loss: 0.331 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 20 cost time: 0.4694967269897461
Epoch: 20, Steps: 3 | Train Loss: 0.214 Vali Loss: 0.302 Vali Acc: 0.950 Test Loss: 0.302 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 21 cost time: 0.4922492504119873
Epoch: 21, Steps: 3 | Train Loss: 0.194 Vali Loss: 0.288 Vali Acc: 0.950 Test Loss: 0.288 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 22 cost time: 0.46494317054748535
Epoch: 22, Steps: 3 | Train Loss: 0.187 Vali Loss: 0.274 Vali Acc: 0.975 Test Loss: 0.274 Test Acc: 0.975
Validation loss decreased (-0.949997 --> -0.974997).  Saving model ...
Epoch: 23 cost time: 0.586740255355835
Epoch: 23, Steps: 3 | Train Loss: 0.163 Vali Loss: 0.270 Vali Acc: 0.975 Test Loss: 0.270 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 24 cost time: 0.45733046531677246
Epoch: 24, Steps: 3 | Train Loss: 0.164 Vali Loss: 0.245 Vali Acc: 0.950 Test Loss: 0.245 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.5524582862854004
Epoch: 25, Steps: 3 | Train Loss: 0.144 Vali Loss: 0.237 Vali Acc: 0.950 Test Loss: 0.237 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.4932234287261963
Epoch: 26, Steps: 3 | Train Loss: 0.111 Vali Loss: 0.218 Vali Acc: 0.975 Test Loss: 0.218 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 27 cost time: 0.4739956855773926
Epoch: 27, Steps: 3 | Train Loss: 0.107 Vali Loss: 0.206 Vali Acc: 0.975 Test Loss: 0.206 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 28 cost time: 0.4836409091949463
Epoch: 28, Steps: 3 | Train Loss: 0.101 Vali Loss: 0.191 Vali Acc: 0.975 Test Loss: 0.191 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 29 cost time: 0.4524729251861572
Epoch: 29, Steps: 3 | Train Loss: 0.093 Vali Loss: 0.183 Vali Acc: 0.950 Test Loss: 0.183 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.4409186840057373
Epoch: 30, Steps: 3 | Train Loss: 0.068 Vali Loss: 0.180 Vali Acc: 0.950 Test Loss: 0.180 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.4491555690765381
Epoch: 31, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.165 Vali Acc: 0.950 Test Loss: 0.165 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.4054300785064697
Epoch: 32, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.156 Vali Acc: 0.950 Test Loss: 0.156 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.45563364028930664
Epoch: 33, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.154 Vali Acc: 0.950 Test Loss: 0.154 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.6057455539703369
Epoch: 34, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.154 Vali Acc: 0.950 Test Loss: 0.154 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.4557008743286133
Epoch: 35, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.154 Vali Acc: 0.950 Test Loss: 0.154 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.4585452079772949
Epoch: 36, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.161 Vali Acc: 0.950 Test Loss: 0.161 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.5038845539093018
Epoch: 37, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.152 Vali Acc: 0.950 Test Loss: 0.152 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.4874532222747803
Epoch: 38, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.149 Vali Acc: 0.950 Test Loss: 0.149 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 1195780
model size : 4.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.7941932678222656
Epoch: 1, Steps: 3 | Train Loss: 1.456 Vali Loss: 1.389 Vali Acc: 0.325 Test Loss: 1.389 Test Acc: 0.325
Validation loss decreased (inf --> -0.324986).  Saving model ...
Epoch: 2 cost time: 0.5390450954437256
Epoch: 2, Steps: 3 | Train Loss: 1.390 Vali Loss: 1.377 Vali Acc: 0.325 Test Loss: 1.377 Test Acc: 0.325
Validation loss decreased (-0.324986 --> -0.324986).  Saving model ...
Epoch: 3 cost time: 0.42858099937438965
Epoch: 3, Steps: 3 | Train Loss: 1.326 Vali Loss: 1.353 Vali Acc: 0.350 Test Loss: 1.353 Test Acc: 0.350
Validation loss decreased (-0.324986 --> -0.349986).  Saving model ...
Epoch: 4 cost time: 0.508244514465332
Epoch: 4, Steps: 3 | Train Loss: 1.271 Vali Loss: 1.312 Vali Acc: 0.375 Test Loss: 1.312 Test Acc: 0.375
Validation loss decreased (-0.349986 --> -0.374987).  Saving model ...
Epoch: 5 cost time: 0.4737706184387207
Epoch: 5, Steps: 3 | Train Loss: 1.182 Vali Loss: 1.259 Vali Acc: 0.475 Test Loss: 1.259 Test Acc: 0.475
Validation loss decreased (-0.374987 --> -0.474987).  Saving model ...
Epoch: 6 cost time: 0.4791069030761719
Epoch: 6, Steps: 3 | Train Loss: 1.084 Vali Loss: 1.192 Vali Acc: 0.450 Test Loss: 1.192 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5048859119415283
Epoch: 7, Steps: 3 | Train Loss: 0.976 Vali Loss: 1.117 Vali Acc: 0.600 Test Loss: 1.117 Test Acc: 0.600
Validation loss decreased (-0.474987 --> -0.599989).  Saving model ...
Epoch: 8 cost time: 0.3901703357696533
Epoch: 8, Steps: 3 | Train Loss: 0.903 Vali Loss: 1.030 Vali Acc: 0.725 Test Loss: 1.030 Test Acc: 0.725
Validation loss decreased (-0.599989 --> -0.724990).  Saving model ...
Epoch: 9 cost time: 0.43448567390441895
Epoch: 9, Steps: 3 | Train Loss: 0.779 Vali Loss: 0.953 Vali Acc: 0.725 Test Loss: 0.953 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 10 cost time: 0.5482628345489502
Epoch: 10, Steps: 3 | Train Loss: 0.733 Vali Loss: 0.879 Vali Acc: 0.825 Test Loss: 0.879 Test Acc: 0.825
Validation loss decreased (-0.724990 --> -0.824991).  Saving model ...
Epoch: 11 cost time: 0.5352163314819336
Epoch: 11, Steps: 3 | Train Loss: 0.647 Vali Loss: 0.788 Vali Acc: 0.950 Test Loss: 0.788 Test Acc: 0.950
Validation loss decreased (-0.824991 --> -0.949992).  Saving model ...
Epoch: 12 cost time: 0.4676356315612793
Epoch: 12, Steps: 3 | Train Loss: 0.554 Vali Loss: 0.722 Vali Acc: 0.900 Test Loss: 0.722 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5153422355651855
Epoch: 13, Steps: 3 | Train Loss: 0.504 Vali Loss: 0.655 Vali Acc: 0.875 Test Loss: 0.655 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.5125131607055664
Epoch: 14, Steps: 3 | Train Loss: 0.463 Vali Loss: 0.603 Vali Acc: 0.875 Test Loss: 0.603 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.5077719688415527
Epoch: 15, Steps: 3 | Train Loss: 0.413 Vali Loss: 0.545 Vali Acc: 0.875 Test Loss: 0.545 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.5605154037475586
Epoch: 16, Steps: 3 | Train Loss: 0.377 Vali Loss: 0.499 Vali Acc: 0.925 Test Loss: 0.499 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.5236725807189941
Epoch: 17, Steps: 3 | Train Loss: 0.333 Vali Loss: 0.458 Vali Acc: 0.950 Test Loss: 0.458 Test Acc: 0.950
Validation loss decreased (-0.949992 --> -0.949995).  Saving model ...
Epoch: 18 cost time: 0.5256235599517822
Epoch: 18, Steps: 3 | Train Loss: 0.286 Vali Loss: 0.423 Vali Acc: 0.950 Test Loss: 0.423 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 19 cost time: 0.5037932395935059
Epoch: 19, Steps: 3 | Train Loss: 0.274 Vali Loss: 0.393 Vali Acc: 0.975 Test Loss: 0.393 Test Acc: 0.975
Validation loss decreased (-0.949996 --> -0.974996).  Saving model ...
Epoch: 20 cost time: 0.4661977291107178
Epoch: 20, Steps: 3 | Train Loss: 0.243 Vali Loss: 0.367 Vali Acc: 0.975 Test Loss: 0.367 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 21 cost time: 0.39165329933166504
Epoch: 21, Steps: 3 | Train Loss: 0.244 Vali Loss: 0.340 Vali Acc: 0.975 Test Loss: 0.340 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 22 cost time: 0.4417135715484619
Epoch: 22, Steps: 3 | Train Loss: 0.229 Vali Loss: 0.321 Vali Acc: 0.975 Test Loss: 0.321 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 23 cost time: 0.4513218402862549
Epoch: 23, Steps: 3 | Train Loss: 0.184 Vali Loss: 0.307 Vali Acc: 0.975 Test Loss: 0.307 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 24 cost time: 0.4485952854156494
Epoch: 24, Steps: 3 | Train Loss: 0.186 Vali Loss: 0.283 Vali Acc: 0.975 Test Loss: 0.283 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 25 cost time: 0.43521618843078613
Epoch: 25, Steps: 3 | Train Loss: 0.161 Vali Loss: 0.261 Vali Acc: 0.975 Test Loss: 0.261 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 26 cost time: 0.4887878894805908
Epoch: 26, Steps: 3 | Train Loss: 0.184 Vali Loss: 0.242 Vali Acc: 0.975 Test Loss: 0.242 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 27 cost time: 0.49867939949035645
Epoch: 27, Steps: 3 | Train Loss: 0.153 Vali Loss: 0.233 Vali Acc: 0.975 Test Loss: 0.233 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 28 cost time: 0.5321218967437744
Epoch: 28, Steps: 3 | Train Loss: 0.125 Vali Loss: 0.223 Vali Acc: 0.975 Test Loss: 0.223 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 29 cost time: 0.4555027484893799
Epoch: 29, Steps: 3 | Train Loss: 0.115 Vali Loss: 0.212 Vali Acc: 0.975 Test Loss: 0.212 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 30 cost time: 0.5230591297149658
Epoch: 30, Steps: 3 | Train Loss: 0.100 Vali Loss: 0.196 Vali Acc: 0.975 Test Loss: 0.196 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 31 cost time: 0.4839046001434326
Epoch: 31, Steps: 3 | Train Loss: 0.092 Vali Loss: 0.190 Vali Acc: 0.950 Test Loss: 0.190 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.5415396690368652
Epoch: 32, Steps: 3 | Train Loss: 0.080 Vali Loss: 0.185 Vali Acc: 0.950 Test Loss: 0.185 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.5877606868743896
Epoch: 33, Steps: 3 | Train Loss: 0.076 Vali Loss: 0.178 Vali Acc: 0.950 Test Loss: 0.178 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.4650566577911377
Epoch: 34, Steps: 3 | Train Loss: 0.063 Vali Loss: 0.167 Vali Acc: 0.950 Test Loss: 0.167 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.47886228561401367
Epoch: 35, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.159 Vali Acc: 0.950 Test Loss: 0.159 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.4540083408355713
Epoch: 36, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.162 Vali Acc: 0.950 Test Loss: 0.162 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.4982743263244629
Epoch: 37, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.158 Vali Acc: 0.950 Test Loss: 0.158 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.4919700622558594
Epoch: 38, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.159 Vali Acc: 0.950 Test Loss: 0.159 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.5412242412567139
Epoch: 39, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.161 Vali Acc: 0.950 Test Loss: 0.161 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.4624500274658203
Epoch: 40, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.160 Vali Acc: 0.950 Test Loss: 0.160 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 1183556
model size : 4.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.7085866928100586
Epoch: 1, Steps: 3 | Train Loss: 1.377 Vali Loss: 1.363 Vali Acc: 0.250 Test Loss: 1.363 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 0.5348110198974609
Epoch: 2, Steps: 3 | Train Loss: 1.367 Vali Loss: 1.346 Vali Acc: 0.325 Test Loss: 1.346 Test Acc: 0.325
Validation loss decreased (-0.249986 --> -0.324987).  Saving model ...
Epoch: 3 cost time: 0.5162909030914307
Epoch: 3, Steps: 3 | Train Loss: 1.298 Vali Loss: 1.324 Vali Acc: 0.375 Test Loss: 1.324 Test Acc: 0.375
Validation loss decreased (-0.324987 --> -0.374987).  Saving model ...
Epoch: 4 cost time: 0.5144774913787842
Epoch: 4, Steps: 3 | Train Loss: 1.237 Vali Loss: 1.288 Vali Acc: 0.475 Test Loss: 1.288 Test Acc: 0.475
Validation loss decreased (-0.374987 --> -0.474987).  Saving model ...
Epoch: 5 cost time: 0.49230313301086426
Epoch: 5, Steps: 3 | Train Loss: 1.170 Vali Loss: 1.241 Vali Acc: 0.625 Test Loss: 1.241 Test Acc: 0.625
Validation loss decreased (-0.474987 --> -0.624988).  Saving model ...
Epoch: 6 cost time: 0.47937655448913574
Epoch: 6, Steps: 3 | Train Loss: 1.103 Vali Loss: 1.181 Vali Acc: 0.725 Test Loss: 1.181 Test Acc: 0.725
Validation loss decreased (-0.624988 --> -0.724988).  Saving model ...
Epoch: 7 cost time: 0.5341310501098633
Epoch: 7, Steps: 3 | Train Loss: 1.013 Vali Loss: 1.119 Vali Acc: 0.800 Test Loss: 1.119 Test Acc: 0.800
Validation loss decreased (-0.724988 --> -0.799989).  Saving model ...
Epoch: 8 cost time: 0.49781107902526855
Epoch: 8, Steps: 3 | Train Loss: 0.920 Vali Loss: 1.061 Vali Acc: 0.800 Test Loss: 1.061 Test Acc: 0.800
Validation loss decreased (-0.799989 --> -0.799989).  Saving model ...
Epoch: 9 cost time: 0.48755931854248047
Epoch: 9, Steps: 3 | Train Loss: 0.868 Vali Loss: 0.989 Vali Acc: 0.825 Test Loss: 0.989 Test Acc: 0.825
Validation loss decreased (-0.799989 --> -0.824990).  Saving model ...
Epoch: 10 cost time: 0.44310617446899414
Epoch: 10, Steps: 3 | Train Loss: 0.781 Vali Loss: 0.922 Vali Acc: 0.875 Test Loss: 0.922 Test Acc: 0.875
Validation loss decreased (-0.824990 --> -0.874991).  Saving model ...
Epoch: 11 cost time: 0.494032621383667
Epoch: 11, Steps: 3 | Train Loss: 0.732 Vali Loss: 0.856 Vali Acc: 0.875 Test Loss: 0.856 Test Acc: 0.875
Validation loss decreased (-0.874991 --> -0.874991).  Saving model ...
Epoch: 12 cost time: 0.4812777042388916
Epoch: 12, Steps: 3 | Train Loss: 0.678 Vali Loss: 0.788 Vali Acc: 0.900 Test Loss: 0.788 Test Acc: 0.900
Validation loss decreased (-0.874991 --> -0.899992).  Saving model ...
Epoch: 13 cost time: 0.5020036697387695
Epoch: 13, Steps: 3 | Train Loss: 0.583 Vali Loss: 0.732 Vali Acc: 0.900 Test Loss: 0.732 Test Acc: 0.900
Validation loss decreased (-0.899992 --> -0.899993).  Saving model ...
Epoch: 14 cost time: 0.5332932472229004
Epoch: 14, Steps: 3 | Train Loss: 0.536 Vali Loss: 0.683 Vali Acc: 0.900 Test Loss: 0.683 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 15 cost time: 0.43996572494506836
Epoch: 15, Steps: 3 | Train Loss: 0.467 Vali Loss: 0.647 Vali Acc: 0.900 Test Loss: 0.647 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899994).  Saving model ...
Epoch: 16 cost time: 0.49063634872436523
Epoch: 16, Steps: 3 | Train Loss: 0.446 Vali Loss: 0.612 Vali Acc: 0.925 Test Loss: 0.612 Test Acc: 0.925
Validation loss decreased (-0.899994 --> -0.924994).  Saving model ...
Epoch: 17 cost time: 0.507260799407959
Epoch: 17, Steps: 3 | Train Loss: 0.406 Vali Loss: 0.574 Vali Acc: 0.850 Test Loss: 0.574 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.4901089668273926
Epoch: 18, Steps: 3 | Train Loss: 0.362 Vali Loss: 0.548 Vali Acc: 0.850 Test Loss: 0.548 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.45970726013183594
Epoch: 19, Steps: 3 | Train Loss: 0.380 Vali Loss: 0.521 Vali Acc: 0.825 Test Loss: 0.521 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.587188720703125
Epoch: 20, Steps: 3 | Train Loss: 0.319 Vali Loss: 0.490 Vali Acc: 0.850 Test Loss: 0.490 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.5335948467254639
Epoch: 21, Steps: 3 | Train Loss: 0.311 Vali Loss: 0.463 Vali Acc: 0.875 Test Loss: 0.463 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.5669927597045898
Epoch: 22, Steps: 3 | Train Loss: 0.269 Vali Loss: 0.432 Vali Acc: 0.875 Test Loss: 0.432 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.5215709209442139
Epoch: 23, Steps: 3 | Train Loss: 0.282 Vali Loss: 0.410 Vali Acc: 0.925 Test Loss: 0.410 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924996).  Saving model ...
Epoch: 24 cost time: 0.48522138595581055
Epoch: 24, Steps: 3 | Train Loss: 0.248 Vali Loss: 0.386 Vali Acc: 0.925 Test Loss: 0.386 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 25 cost time: 0.46160006523132324
Epoch: 25, Steps: 3 | Train Loss: 0.225 Vali Loss: 0.370 Vali Acc: 0.950 Test Loss: 0.370 Test Acc: 0.950
Validation loss decreased (-0.924996 --> -0.949996).  Saving model ...
Epoch: 26 cost time: 0.4794468879699707
Epoch: 26, Steps: 3 | Train Loss: 0.195 Vali Loss: 0.350 Vali Acc: 0.950 Test Loss: 0.350 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 27 cost time: 0.5461432933807373
Epoch: 27, Steps: 3 | Train Loss: 0.184 Vali Loss: 0.341 Vali Acc: 0.950 Test Loss: 0.341 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 28 cost time: 0.508699893951416
Epoch: 28, Steps: 3 | Train Loss: 0.193 Vali Loss: 0.332 Vali Acc: 0.950 Test Loss: 0.332 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 29 cost time: 0.4668846130371094
Epoch: 29, Steps: 3 | Train Loss: 0.175 Vali Loss: 0.319 Vali Acc: 0.950 Test Loss: 0.319 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 30 cost time: 0.4866645336151123
Epoch: 30, Steps: 3 | Train Loss: 0.157 Vali Loss: 0.308 Vali Acc: 0.950 Test Loss: 0.308 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 31 cost time: 0.5549960136413574
Epoch: 31, Steps: 3 | Train Loss: 0.139 Vali Loss: 0.290 Vali Acc: 0.950 Test Loss: 0.290 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 32 cost time: 0.5572154521942139
Epoch: 32, Steps: 3 | Train Loss: 0.129 Vali Loss: 0.282 Vali Acc: 0.925 Test Loss: 0.282 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.5729410648345947
Epoch: 33, Steps: 3 | Train Loss: 0.123 Vali Loss: 0.260 Vali Acc: 0.950 Test Loss: 0.260 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 34 cost time: 0.4860529899597168
Epoch: 34, Steps: 3 | Train Loss: 0.113 Vali Loss: 0.250 Vali Acc: 0.950 Test Loss: 0.250 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 35 cost time: 0.5859596729278564
Epoch: 35, Steps: 3 | Train Loss: 0.095 Vali Loss: 0.238 Vali Acc: 0.925 Test Loss: 0.238 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.4795081615447998
Epoch: 36, Steps: 3 | Train Loss: 0.076 Vali Loss: 0.240 Vali Acc: 0.925 Test Loss: 0.240 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.4800245761871338
Epoch: 37, Steps: 3 | Train Loss: 0.074 Vali Loss: 0.223 Vali Acc: 0.925 Test Loss: 0.223 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.6068050861358643
Epoch: 38, Steps: 3 | Train Loss: 0.080 Vali Loss: 0.213 Vali Acc: 0.925 Test Loss: 0.213 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.5239307880401611
Epoch: 39, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.205 Vali Acc: 0.925 Test Loss: 0.205 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.45243406295776367
Epoch: 40, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.203 Vali Acc: 0.925 Test Loss: 0.203 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.4393641948699951
Epoch: 41, Steps: 3 | Train Loss: 0.055 Vali Loss: 0.203 Vali Acc: 0.925 Test Loss: 0.203 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.4783661365509033
Epoch: 42, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.197 Vali Acc: 0.925 Test Loss: 0.197 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.5032732486724854
Epoch: 43, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.194 Vali Acc: 0.925 Test Loss: 0.194 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.4991636276245117
Epoch: 44, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.184 Vali Acc: 0.925 Test Loss: 0.184 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 1177508
model size : 4.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.8320214748382568
Epoch: 1, Steps: 3 | Train Loss: 1.337 Vali Loss: 1.373 Vali Acc: 0.350 Test Loss: 1.373 Test Acc: 0.350
Validation loss decreased (inf --> -0.349986).  Saving model ...
Epoch: 2 cost time: 0.4987502098083496
Epoch: 2, Steps: 3 | Train Loss: 1.305 Vali Loss: 1.361 Vali Acc: 0.375 Test Loss: 1.361 Test Acc: 0.375
Validation loss decreased (-0.349986 --> -0.374986).  Saving model ...
Epoch: 3 cost time: 0.49259328842163086
Epoch: 3, Steps: 3 | Train Loss: 1.259 Vali Loss: 1.343 Vali Acc: 0.425 Test Loss: 1.343 Test Acc: 0.425
Validation loss decreased (-0.374986 --> -0.424987).  Saving model ...
Epoch: 4 cost time: 0.5217933654785156
Epoch: 4, Steps: 3 | Train Loss: 1.237 Vali Loss: 1.316 Vali Acc: 0.475 Test Loss: 1.316 Test Acc: 0.475
Validation loss decreased (-0.424987 --> -0.474987).  Saving model ...
Epoch: 5 cost time: 0.5209946632385254
Epoch: 5, Steps: 3 | Train Loss: 1.188 Vali Loss: 1.280 Vali Acc: 0.525 Test Loss: 1.280 Test Acc: 0.525
Validation loss decreased (-0.474987 --> -0.524987).  Saving model ...
Epoch: 6 cost time: 0.4433557987213135
Epoch: 6, Steps: 3 | Train Loss: 1.109 Vali Loss: 1.238 Vali Acc: 0.550 Test Loss: 1.238 Test Acc: 0.550
Validation loss decreased (-0.524987 --> -0.549988).  Saving model ...
Epoch: 7 cost time: 0.45991086959838867
Epoch: 7, Steps: 3 | Train Loss: 1.044 Vali Loss: 1.189 Vali Acc: 0.650 Test Loss: 1.189 Test Acc: 0.650
Validation loss decreased (-0.549988 --> -0.649988).  Saving model ...
Epoch: 8 cost time: 0.422835111618042
Epoch: 8, Steps: 3 | Train Loss: 0.970 Vali Loss: 1.128 Vali Acc: 0.825 Test Loss: 1.128 Test Acc: 0.825
Validation loss decreased (-0.649988 --> -0.824989).  Saving model ...
Epoch: 9 cost time: 0.5294976234436035
Epoch: 9, Steps: 3 | Train Loss: 0.910 Vali Loss: 1.073 Vali Acc: 0.900 Test Loss: 1.073 Test Acc: 0.900
Validation loss decreased (-0.824989 --> -0.899989).  Saving model ...
Epoch: 10 cost time: 0.47173333168029785
Epoch: 10, Steps: 3 | Train Loss: 0.864 Vali Loss: 1.007 Vali Acc: 0.950 Test Loss: 1.007 Test Acc: 0.950
Validation loss decreased (-0.899989 --> -0.949990).  Saving model ...
Epoch: 11 cost time: 0.44265007972717285
Epoch: 11, Steps: 3 | Train Loss: 0.795 Vali Loss: 0.944 Vali Acc: 0.925 Test Loss: 0.944 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.4175379276275635
Epoch: 12, Steps: 3 | Train Loss: 0.735 Vali Loss: 0.887 Vali Acc: 0.925 Test Loss: 0.887 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.465137243270874
Epoch: 13, Steps: 3 | Train Loss: 0.663 Vali Loss: 0.831 Vali Acc: 0.900 Test Loss: 0.831 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.4926183223724365
Epoch: 14, Steps: 3 | Train Loss: 0.612 Vali Loss: 0.791 Vali Acc: 0.900 Test Loss: 0.791 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.5240364074707031
Epoch: 15, Steps: 3 | Train Loss: 0.577 Vali Loss: 0.739 Vali Acc: 0.900 Test Loss: 0.739 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.46091341972351074
Epoch: 16, Steps: 3 | Train Loss: 0.537 Vali Loss: 0.691 Vali Acc: 0.900 Test Loss: 0.691 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.42420148849487305
Epoch: 17, Steps: 3 | Train Loss: 0.488 Vali Loss: 0.645 Vali Acc: 0.900 Test Loss: 0.645 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.4575223922729492
Epoch: 18, Steps: 3 | Train Loss: 0.470 Vali Loss: 0.603 Vali Acc: 0.900 Test Loss: 0.603 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.5484824180603027
Epoch: 19, Steps: 3 | Train Loss: 0.435 Vali Loss: 0.567 Vali Acc: 0.925 Test Loss: 0.567 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.49459171295166016
Epoch: 20, Steps: 3 | Train Loss: 0.387 Vali Loss: 0.541 Vali Acc: 0.950 Test Loss: 0.541 Test Acc: 0.950
Validation loss decreased (-0.949990 --> -0.949995).  Saving model ...
Epoch: 21 cost time: 0.4937140941619873
Epoch: 21, Steps: 3 | Train Loss: 0.368 Vali Loss: 0.514 Vali Acc: 0.975 Test Loss: 0.514 Test Acc: 0.975
Validation loss decreased (-0.949995 --> -0.974995).  Saving model ...
Epoch: 22 cost time: 0.4953925609588623
Epoch: 22, Steps: 3 | Train Loss: 0.349 Vali Loss: 0.485 Vali Acc: 0.975 Test Loss: 0.485 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 23 cost time: 0.5137207508087158
Epoch: 23, Steps: 3 | Train Loss: 0.328 Vali Loss: 0.460 Vali Acc: 0.975 Test Loss: 0.460 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 24 cost time: 0.5389313697814941
Epoch: 24, Steps: 3 | Train Loss: 0.317 Vali Loss: 0.445 Vali Acc: 0.975 Test Loss: 0.445 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 25 cost time: 0.5362706184387207
Epoch: 25, Steps: 3 | Train Loss: 0.290 Vali Loss: 0.416 Vali Acc: 0.975 Test Loss: 0.416 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 26 cost time: 0.5148360729217529
Epoch: 26, Steps: 3 | Train Loss: 0.278 Vali Loss: 0.399 Vali Acc: 0.975 Test Loss: 0.399 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 27 cost time: 0.5041830539703369
Epoch: 27, Steps: 3 | Train Loss: 0.253 Vali Loss: 0.387 Vali Acc: 0.975 Test Loss: 0.387 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 28 cost time: 0.49221372604370117
Epoch: 28, Steps: 3 | Train Loss: 0.252 Vali Loss: 0.364 Vali Acc: 0.975 Test Loss: 0.364 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 29 cost time: 0.4938690662384033
Epoch: 29, Steps: 3 | Train Loss: 0.219 Vali Loss: 0.336 Vali Acc: 0.975 Test Loss: 0.336 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 30 cost time: 0.5058870315551758
Epoch: 30, Steps: 3 | Train Loss: 0.191 Vali Loss: 0.316 Vali Acc: 0.975 Test Loss: 0.316 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 31 cost time: 0.4551122188568115
Epoch: 31, Steps: 3 | Train Loss: 0.198 Vali Loss: 0.302 Vali Acc: 0.975 Test Loss: 0.302 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 32 cost time: 0.506009578704834
Epoch: 32, Steps: 3 | Train Loss: 0.191 Vali Loss: 0.291 Vali Acc: 0.975 Test Loss: 0.291 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 33 cost time: 0.47145748138427734
Epoch: 33, Steps: 3 | Train Loss: 0.159 Vali Loss: 0.275 Vali Acc: 0.975 Test Loss: 0.275 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 34 cost time: 0.483670711517334
Epoch: 34, Steps: 3 | Train Loss: 0.173 Vali Loss: 0.262 Vali Acc: 0.975 Test Loss: 0.262 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 35 cost time: 0.43841004371643066
Epoch: 35, Steps: 3 | Train Loss: 0.169 Vali Loss: 0.257 Vali Acc: 0.975 Test Loss: 0.257 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 36 cost time: 0.5380606651306152
Epoch: 36, Steps: 3 | Train Loss: 0.148 Vali Loss: 0.246 Vali Acc: 0.975 Test Loss: 0.246 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 37 cost time: 0.47429823875427246
Epoch: 37, Steps: 3 | Train Loss: 0.112 Vali Loss: 0.228 Vali Acc: 0.975 Test Loss: 0.228 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 38 cost time: 0.46973371505737305
Epoch: 38, Steps: 3 | Train Loss: 0.125 Vali Loss: 0.221 Vali Acc: 0.975 Test Loss: 0.221 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 39 cost time: 0.47045469284057617
Epoch: 39, Steps: 3 | Train Loss: 0.110 Vali Loss: 0.213 Vali Acc: 0.975 Test Loss: 0.213 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 40 cost time: 0.397266149520874
Epoch: 40, Steps: 3 | Train Loss: 0.092 Vali Loss: 0.210 Vali Acc: 0.975 Test Loss: 0.210 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 41 cost time: 0.5775859355926514
Epoch: 41, Steps: 3 | Train Loss: 0.085 Vali Loss: 0.196 Vali Acc: 0.975 Test Loss: 0.196 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 42 cost time: 0.5061142444610596
Epoch: 42, Steps: 3 | Train Loss: 0.070 Vali Loss: 0.202 Vali Acc: 0.975 Test Loss: 0.202 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.48676061630249023
Epoch: 43, Steps: 3 | Train Loss: 0.080 Vali Loss: 0.193 Vali Acc: 0.950 Test Loss: 0.193 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.47789502143859863
Epoch: 44, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.187 Vali Acc: 0.950 Test Loss: 0.187 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.5438828468322754
Epoch: 45, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.182 Vali Acc: 0.950 Test Loss: 0.182 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.5403769016265869
Epoch: 46, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.174 Vali Acc: 0.950 Test Loss: 0.174 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.5468463897705078
Epoch: 47, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.172 Vali Acc: 0.950 Test Loss: 0.172 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.5698325634002686
Epoch: 48, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.166 Vali Acc: 0.950 Test Loss: 0.166 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.5104207992553711
Epoch: 49, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.164 Vali Acc: 0.950 Test Loss: 0.164 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 0.47925543785095215
Epoch: 50, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.159 Vali Acc: 0.950 Test Loss: 0.159 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 1171428
model size : 4.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.90907883644104
Epoch: 1, Steps: 3 | Train Loss: 1.332 Vali Loss: 1.364 Vali Acc: 0.375 Test Loss: 1.364 Test Acc: 0.375
Validation loss decreased (inf --> -0.374986).  Saving model ...
Epoch: 2 cost time: 0.45825839042663574
Epoch: 2, Steps: 3 | Train Loss: 1.289 Vali Loss: 1.352 Vali Acc: 0.350 Test Loss: 1.352 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5552151203155518
Epoch: 3, Steps: 3 | Train Loss: 1.278 Vali Loss: 1.337 Vali Acc: 0.400 Test Loss: 1.337 Test Acc: 0.400
Validation loss decreased (-0.374986 --> -0.399987).  Saving model ...
Epoch: 4 cost time: 0.4689812660217285
Epoch: 4, Steps: 3 | Train Loss: 1.231 Vali Loss: 1.316 Vali Acc: 0.500 Test Loss: 1.316 Test Acc: 0.500
Validation loss decreased (-0.399987 --> -0.499987).  Saving model ...
Epoch: 5 cost time: 0.45157647132873535
Epoch: 5, Steps: 3 | Train Loss: 1.193 Vali Loss: 1.287 Vali Acc: 0.500 Test Loss: 1.287 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499987).  Saving model ...
Epoch: 6 cost time: 0.4690885543823242
Epoch: 6, Steps: 3 | Train Loss: 1.142 Vali Loss: 1.253 Vali Acc: 0.550 Test Loss: 1.253 Test Acc: 0.550
Validation loss decreased (-0.499987 --> -0.549987).  Saving model ...
Epoch: 7 cost time: 0.42058372497558594
Epoch: 7, Steps: 3 | Train Loss: 1.082 Vali Loss: 1.214 Vali Acc: 0.600 Test Loss: 1.214 Test Acc: 0.600
Validation loss decreased (-0.549987 --> -0.599988).  Saving model ...
Epoch: 8 cost time: 0.44165468215942383
Epoch: 8, Steps: 3 | Train Loss: 1.052 Vali Loss: 1.168 Vali Acc: 0.700 Test Loss: 1.168 Test Acc: 0.700
Validation loss decreased (-0.599988 --> -0.699988).  Saving model ...
Epoch: 9 cost time: 0.43565869331359863
Epoch: 9, Steps: 3 | Train Loss: 0.980 Vali Loss: 1.122 Vali Acc: 0.725 Test Loss: 1.122 Test Acc: 0.725
Validation loss decreased (-0.699988 --> -0.724989).  Saving model ...
Epoch: 10 cost time: 0.4604334831237793
Epoch: 10, Steps: 3 | Train Loss: 0.927 Vali Loss: 1.081 Vali Acc: 0.750 Test Loss: 1.081 Test Acc: 0.750
Validation loss decreased (-0.724989 --> -0.749989).  Saving model ...
Epoch: 11 cost time: 0.5068411827087402
Epoch: 11, Steps: 3 | Train Loss: 0.886 Vali Loss: 1.029 Vali Acc: 0.800 Test Loss: 1.029 Test Acc: 0.800
Validation loss decreased (-0.749989 --> -0.799990).  Saving model ...
Epoch: 12 cost time: 0.5157136917114258
Epoch: 12, Steps: 3 | Train Loss: 0.840 Vali Loss: 0.984 Vali Acc: 0.850 Test Loss: 0.984 Test Acc: 0.850
Validation loss decreased (-0.799990 --> -0.849990).  Saving model ...
Epoch: 13 cost time: 0.4159395694732666
Epoch: 13, Steps: 3 | Train Loss: 0.782 Vali Loss: 0.944 Vali Acc: 0.900 Test Loss: 0.944 Test Acc: 0.900
Validation loss decreased (-0.849990 --> -0.899991).  Saving model ...
Epoch: 14 cost time: 0.47299790382385254
Epoch: 14, Steps: 3 | Train Loss: 0.725 Vali Loss: 0.899 Vali Acc: 0.925 Test Loss: 0.899 Test Acc: 0.925
Validation loss decreased (-0.899991 --> -0.924991).  Saving model ...
Epoch: 15 cost time: 0.44890570640563965
Epoch: 15, Steps: 3 | Train Loss: 0.700 Vali Loss: 0.855 Vali Acc: 0.900 Test Loss: 0.855 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.663402795791626
Epoch: 16, Steps: 3 | Train Loss: 0.665 Vali Loss: 0.810 Vali Acc: 0.900 Test Loss: 0.810 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.5162339210510254
Epoch: 17, Steps: 3 | Train Loss: 0.594 Vali Loss: 0.772 Vali Acc: 0.900 Test Loss: 0.772 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.5238184928894043
Epoch: 18, Steps: 3 | Train Loss: 0.590 Vali Loss: 0.741 Vali Acc: 0.875 Test Loss: 0.741 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.4871046543121338
Epoch: 19, Steps: 3 | Train Loss: 0.543 Vali Loss: 0.699 Vali Acc: 0.900 Test Loss: 0.699 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.5649380683898926
Epoch: 20, Steps: 3 | Train Loss: 0.526 Vali Loss: 0.666 Vali Acc: 0.875 Test Loss: 0.666 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.4394385814666748
Epoch: 21, Steps: 3 | Train Loss: 0.456 Vali Loss: 0.641 Vali Acc: 0.900 Test Loss: 0.641 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.433978796005249
Epoch: 22, Steps: 3 | Train Loss: 0.453 Vali Loss: 0.610 Vali Acc: 0.900 Test Loss: 0.610 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.4801919460296631
Epoch: 23, Steps: 3 | Train Loss: 0.436 Vali Loss: 0.591 Vali Acc: 0.900 Test Loss: 0.591 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.433560848236084
Epoch: 24, Steps: 3 | Train Loss: 0.395 Vali Loss: 0.560 Vali Acc: 0.900 Test Loss: 0.560 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 1165444
model size : 4.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps20_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.7416446208953857
Epoch: 1, Steps: 3 | Train Loss: 1.361 Vali Loss: 1.390 Vali Acc: 0.475 Test Loss: 1.390 Test Acc: 0.475
Validation loss decreased (inf --> -0.474986).  Saving model ...
Epoch: 2 cost time: 0.5771951675415039
Epoch: 2, Steps: 3 | Train Loss: 1.329 Vali Loss: 1.380 Vali Acc: 0.500 Test Loss: 1.380 Test Acc: 0.500
Validation loss decreased (-0.474986 --> -0.499986).  Saving model ...
Epoch: 3 cost time: 0.5437250137329102
Epoch: 3, Steps: 3 | Train Loss: 1.330 Vali Loss: 1.367 Vali Acc: 0.500 Test Loss: 1.367 Test Acc: 0.500
Validation loss decreased (-0.499986 --> -0.499986).  Saving model ...
Epoch: 4 cost time: 0.43402624130249023
Epoch: 4, Steps: 3 | Train Loss: 1.293 Vali Loss: 1.346 Vali Acc: 0.550 Test Loss: 1.346 Test Acc: 0.550
Validation loss decreased (-0.499986 --> -0.549987).  Saving model ...
Epoch: 5 cost time: 0.5414865016937256
Epoch: 5, Steps: 3 | Train Loss: 1.249 Vali Loss: 1.319 Vali Acc: 0.600 Test Loss: 1.319 Test Acc: 0.600
Validation loss decreased (-0.549987 --> -0.599987).  Saving model ...
Epoch: 6 cost time: 0.4329550266265869
Epoch: 6, Steps: 3 | Train Loss: 1.189 Vali Loss: 1.285 Vali Acc: 0.625 Test Loss: 1.285 Test Acc: 0.625
Validation loss decreased (-0.599987 --> -0.624987).  Saving model ...
Epoch: 7 cost time: 0.5076987743377686
Epoch: 7, Steps: 3 | Train Loss: 1.119 Vali Loss: 1.247 Vali Acc: 0.650 Test Loss: 1.247 Test Acc: 0.650
Validation loss decreased (-0.624987 --> -0.649988).  Saving model ...
Epoch: 8 cost time: 0.44467902183532715
Epoch: 8, Steps: 3 | Train Loss: 1.096 Vali Loss: 1.202 Vali Acc: 0.750 Test Loss: 1.202 Test Acc: 0.750
Validation loss decreased (-0.649988 --> -0.749988).  Saving model ...
Epoch: 9 cost time: 0.4141972064971924
Epoch: 9, Steps: 3 | Train Loss: 1.017 Vali Loss: 1.157 Vali Acc: 0.800 Test Loss: 1.157 Test Acc: 0.800
Validation loss decreased (-0.749988 --> -0.799988).  Saving model ...
Epoch: 10 cost time: 0.5055768489837646
Epoch: 10, Steps: 3 | Train Loss: 0.935 Vali Loss: 1.110 Vali Acc: 0.800 Test Loss: 1.110 Test Acc: 0.800
Validation loss decreased (-0.799988 --> -0.799989).  Saving model ...
Epoch: 11 cost time: 0.45691752433776855
Epoch: 11, Steps: 3 | Train Loss: 0.883 Vali Loss: 1.072 Vali Acc: 0.825 Test Loss: 1.072 Test Acc: 0.825
Validation loss decreased (-0.799989 --> -0.824989).  Saving model ...
Epoch: 12 cost time: 0.4634230136871338
Epoch: 12, Steps: 3 | Train Loss: 0.840 Vali Loss: 1.024 Vali Acc: 0.825 Test Loss: 1.024 Test Acc: 0.825
Validation loss decreased (-0.824989 --> -0.824990).  Saving model ...
Epoch: 13 cost time: 0.4036424160003662
Epoch: 13, Steps: 3 | Train Loss: 0.787 Vali Loss: 0.980 Vali Acc: 0.825 Test Loss: 0.980 Test Acc: 0.825
Validation loss decreased (-0.824990 --> -0.824990).  Saving model ...
Epoch: 14 cost time: 0.3801097869873047
Epoch: 14, Steps: 3 | Train Loss: 0.767 Vali Loss: 0.932 Vali Acc: 0.850 Test Loss: 0.932 Test Acc: 0.850
Validation loss decreased (-0.824990 --> -0.849991).  Saving model ...
Epoch: 15 cost time: 0.4594714641571045
Epoch: 15, Steps: 3 | Train Loss: 0.718 Vali Loss: 0.892 Vali Acc: 0.875 Test Loss: 0.892 Test Acc: 0.875
Validation loss decreased (-0.849991 --> -0.874991).  Saving model ...
Epoch: 16 cost time: 0.475982666015625
Epoch: 16, Steps: 3 | Train Loss: 0.665 Vali Loss: 0.853 Vali Acc: 0.875 Test Loss: 0.853 Test Acc: 0.875
Validation loss decreased (-0.874991 --> -0.874991).  Saving model ...
Epoch: 17 cost time: 0.4430227279663086
Epoch: 17, Steps: 3 | Train Loss: 0.624 Vali Loss: 0.813 Vali Acc: 0.875 Test Loss: 0.813 Test Acc: 0.875
Validation loss decreased (-0.874991 --> -0.874992).  Saving model ...
Epoch: 18 cost time: 0.4999995231628418
Epoch: 18, Steps: 3 | Train Loss: 0.628 Vali Loss: 0.776 Vali Acc: 0.875 Test Loss: 0.776 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874992).  Saving model ...
Epoch: 19 cost time: 0.4119901657104492
Epoch: 19, Steps: 3 | Train Loss: 0.587 Vali Loss: 0.737 Vali Acc: 0.900 Test Loss: 0.737 Test Acc: 0.900
Validation loss decreased (-0.874992 --> -0.899993).  Saving model ...
Epoch: 20 cost time: 0.4272797107696533
Epoch: 20, Steps: 3 | Train Loss: 0.521 Vali Loss: 0.704 Vali Acc: 0.875 Test Loss: 0.704 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.44963955879211426
Epoch: 21, Steps: 3 | Train Loss: 0.483 Vali Loss: 0.690 Vali Acc: 0.900 Test Loss: 0.690 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 22 cost time: 0.43340206146240234
Epoch: 22, Steps: 3 | Train Loss: 0.475 Vali Loss: 0.665 Vali Acc: 0.900 Test Loss: 0.665 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 23 cost time: 0.5123896598815918
Epoch: 23, Steps: 3 | Train Loss: 0.436 Vali Loss: 0.634 Vali Acc: 0.900 Test Loss: 0.634 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899994).  Saving model ...
Epoch: 24 cost time: 0.4174184799194336
Epoch: 24, Steps: 3 | Train Loss: 0.439 Vali Loss: 0.603 Vali Acc: 0.900 Test Loss: 0.603 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 25 cost time: 0.502385139465332
Epoch: 25, Steps: 3 | Train Loss: 0.395 Vali Loss: 0.587 Vali Acc: 0.900 Test Loss: 0.587 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 26 cost time: 0.4502251148223877
Epoch: 26, Steps: 3 | Train Loss: 0.381 Vali Loss: 0.567 Vali Acc: 0.900 Test Loss: 0.567 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 27 cost time: 0.5256402492523193
Epoch: 27, Steps: 3 | Train Loss: 0.370 Vali Loss: 0.550 Vali Acc: 0.900 Test Loss: 0.550 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 28 cost time: 0.46180295944213867
Epoch: 28, Steps: 3 | Train Loss: 0.342 Vali Loss: 0.535 Vali Acc: 0.875 Test Loss: 0.535 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.5003504753112793
Epoch: 29, Steps: 3 | Train Loss: 0.303 Vali Loss: 0.505 Vali Acc: 0.875 Test Loss: 0.505 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.4516785144805908
Epoch: 30, Steps: 3 | Train Loss: 0.313 Vali Loss: 0.484 Vali Acc: 0.875 Test Loss: 0.484 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.47389841079711914
Epoch: 31, Steps: 3 | Train Loss: 0.307 Vali Loss: 0.468 Vali Acc: 0.875 Test Loss: 0.468 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.3969237804412842
Epoch: 32, Steps: 3 | Train Loss: 0.298 Vali Loss: 0.457 Vali Acc: 0.875 Test Loss: 0.457 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.44559454917907715
Epoch: 33, Steps: 3 | Train Loss: 0.270 Vali Loss: 0.444 Vali Acc: 0.875 Test Loss: 0.444 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.5343427658081055
Epoch: 34, Steps: 3 | Train Loss: 0.241 Vali Loss: 0.422 Vali Acc: 0.875 Test Loss: 0.422 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.4160583019256592
Epoch: 35, Steps: 3 | Train Loss: 0.240 Vali Loss: 0.405 Vali Acc: 0.875 Test Loss: 0.405 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.4907081127166748
Epoch: 36, Steps: 3 | Train Loss: 0.224 Vali Loss: 0.396 Vali Acc: 0.875 Test Loss: 0.396 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.5532815456390381
Epoch: 37, Steps: 3 | Train Loss: 0.223 Vali Loss: 0.377 Vali Acc: 0.875 Test Loss: 0.377 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps20_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 1165604
model size : 4.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps25_str13_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.643857717514038
Epoch: 1, Steps: 3 | Train Loss: 1.312 Vali Loss: 1.393 Vali Acc: 0.225 Test Loss: 1.393 Test Acc: 0.225
Validation loss decreased (inf --> -0.224986).  Saving model ...
Epoch: 2 cost time: 0.4879579544067383
Epoch: 2, Steps: 3 | Train Loss: 1.300 Vali Loss: 1.384 Vali Acc: 0.175 Test Loss: 1.384 Test Acc: 0.175
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4983532428741455
Epoch: 3, Steps: 3 | Train Loss: 1.278 Vali Loss: 1.372 Vali Acc: 0.200 Test Loss: 1.372 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.4594447612762451
Epoch: 4, Steps: 3 | Train Loss: 1.254 Vali Loss: 1.356 Vali Acc: 0.250 Test Loss: 1.356 Test Acc: 0.250
Validation loss decreased (-0.224986 --> -0.249986).  Saving model ...
Epoch: 5 cost time: 0.48282861709594727
Epoch: 5, Steps: 3 | Train Loss: 1.213 Vali Loss: 1.334 Vali Acc: 0.250 Test Loss: 1.334 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249987).  Saving model ...
Epoch: 6 cost time: 0.5152492523193359
Epoch: 6, Steps: 3 | Train Loss: 1.180 Vali Loss: 1.309 Vali Acc: 0.325 Test Loss: 1.309 Test Acc: 0.325
Validation loss decreased (-0.249987 --> -0.324987).  Saving model ...
Epoch: 7 cost time: 0.508324384689331
Epoch: 7, Steps: 3 | Train Loss: 1.128 Vali Loss: 1.278 Vali Acc: 0.375 Test Loss: 1.278 Test Acc: 0.375
Validation loss decreased (-0.324987 --> -0.374987).  Saving model ...
Epoch: 8 cost time: 0.4350132942199707
Epoch: 8, Steps: 3 | Train Loss: 1.058 Vali Loss: 1.245 Vali Acc: 0.400 Test Loss: 1.245 Test Acc: 0.400
Validation loss decreased (-0.374987 --> -0.399988).  Saving model ...
Epoch: 9 cost time: 0.5023899078369141
Epoch: 9, Steps: 3 | Train Loss: 1.027 Vali Loss: 1.209 Vali Acc: 0.450 Test Loss: 1.209 Test Acc: 0.450
Validation loss decreased (-0.399988 --> -0.449988).  Saving model ...
Epoch: 10 cost time: 0.5026438236236572
Epoch: 10, Steps: 3 | Train Loss: 0.991 Vali Loss: 1.169 Vali Acc: 0.550 Test Loss: 1.169 Test Acc: 0.550
Validation loss decreased (-0.449988 --> -0.549988).  Saving model ...
Epoch: 11 cost time: 0.5506589412689209
Epoch: 11, Steps: 3 | Train Loss: 0.962 Vali Loss: 1.125 Vali Acc: 0.650 Test Loss: 1.125 Test Acc: 0.650
Validation loss decreased (-0.549988 --> -0.649989).  Saving model ...
Epoch: 12 cost time: 0.5148952007293701
Epoch: 12, Steps: 3 | Train Loss: 0.932 Vali Loss: 1.078 Vali Acc: 0.700 Test Loss: 1.078 Test Acc: 0.700
Validation loss decreased (-0.649989 --> -0.699989).  Saving model ...
Epoch: 13 cost time: 0.5432901382446289
Epoch: 13, Steps: 3 | Train Loss: 0.841 Vali Loss: 1.039 Vali Acc: 0.725 Test Loss: 1.039 Test Acc: 0.725
Validation loss decreased (-0.699989 --> -0.724990).  Saving model ...
Epoch: 14 cost time: 0.45707225799560547
Epoch: 14, Steps: 3 | Train Loss: 0.822 Vali Loss: 1.003 Vali Acc: 0.800 Test Loss: 1.003 Test Acc: 0.800
Validation loss decreased (-0.724990 --> -0.799990).  Saving model ...
Epoch: 15 cost time: 0.5933723449707031
Epoch: 15, Steps: 3 | Train Loss: 0.793 Vali Loss: 0.962 Vali Acc: 0.825 Test Loss: 0.962 Test Acc: 0.825
Validation loss decreased (-0.799990 --> -0.824990).  Saving model ...
Epoch: 16 cost time: 0.5546445846557617
Epoch: 16, Steps: 3 | Train Loss: 0.733 Vali Loss: 0.926 Vali Acc: 0.825 Test Loss: 0.926 Test Acc: 0.825
Validation loss decreased (-0.824990 --> -0.824991).  Saving model ...
Epoch: 17 cost time: 0.611407995223999
Epoch: 17, Steps: 3 | Train Loss: 0.692 Vali Loss: 0.894 Vali Acc: 0.825 Test Loss: 0.894 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824991).  Saving model ...
Epoch: 18 cost time: 0.5975399017333984
Epoch: 18, Steps: 3 | Train Loss: 0.640 Vali Loss: 0.862 Vali Acc: 0.875 Test Loss: 0.862 Test Acc: 0.875
Validation loss decreased (-0.824991 --> -0.874991).  Saving model ...
Epoch: 19 cost time: 0.5677468776702881
Epoch: 19, Steps: 3 | Train Loss: 0.649 Vali Loss: 0.823 Vali Acc: 0.875 Test Loss: 0.823 Test Acc: 0.875
Validation loss decreased (-0.874991 --> -0.874992).  Saving model ...
Epoch: 20 cost time: 0.5191671848297119
Epoch: 20, Steps: 3 | Train Loss: 0.580 Vali Loss: 0.792 Vali Acc: 0.875 Test Loss: 0.792 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874992).  Saving model ...
Epoch: 21 cost time: 0.6380534172058105
Epoch: 21, Steps: 3 | Train Loss: 0.555 Vali Loss: 0.763 Vali Acc: 0.875 Test Loss: 0.763 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874992).  Saving model ...
Epoch: 22 cost time: 0.5069179534912109
Epoch: 22, Steps: 3 | Train Loss: 0.511 Vali Loss: 0.731 Vali Acc: 0.875 Test Loss: 0.731 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874993).  Saving model ...
Epoch: 23 cost time: 0.5565428733825684
Epoch: 23, Steps: 3 | Train Loss: 0.516 Vali Loss: 0.699 Vali Acc: 0.875 Test Loss: 0.699 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 24 cost time: 0.4805030822753906
Epoch: 24, Steps: 3 | Train Loss: 0.449 Vali Loss: 0.674 Vali Acc: 0.875 Test Loss: 0.674 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 25 cost time: 0.5347790718078613
Epoch: 25, Steps: 3 | Train Loss: 0.428 Vali Loss: 0.645 Vali Acc: 0.875 Test Loss: 0.645 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 26 cost time: 0.5313737392425537
Epoch: 26, Steps: 3 | Train Loss: 0.408 Vali Loss: 0.618 Vali Acc: 0.875 Test Loss: 0.618 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 27 cost time: 0.5508575439453125
Epoch: 27, Steps: 3 | Train Loss: 0.395 Vali Loss: 0.597 Vali Acc: 0.875 Test Loss: 0.597 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 28 cost time: 0.5784251689910889
Epoch: 28, Steps: 3 | Train Loss: 0.373 Vali Loss: 0.573 Vali Acc: 0.875 Test Loss: 0.573 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 29 cost time: 0.5595271587371826
Epoch: 29, Steps: 3 | Train Loss: 0.341 Vali Loss: 0.558 Vali Acc: 0.900 Test Loss: 0.558 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899994).  Saving model ...
Epoch: 30 cost time: 0.5826661586761475
Epoch: 30, Steps: 3 | Train Loss: 0.341 Vali Loss: 0.531 Vali Acc: 0.900 Test Loss: 0.531 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 31 cost time: 0.4841160774230957
Epoch: 31, Steps: 3 | Train Loss: 0.300 Vali Loss: 0.511 Vali Acc: 0.900 Test Loss: 0.511 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 32 cost time: 0.529979944229126
Epoch: 32, Steps: 3 | Train Loss: 0.282 Vali Loss: 0.494 Vali Acc: 0.900 Test Loss: 0.494 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 33 cost time: 0.5499515533447266
Epoch: 33, Steps: 3 | Train Loss: 0.290 Vali Loss: 0.482 Vali Acc: 0.900 Test Loss: 0.482 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 34 cost time: 0.5096549987792969
Epoch: 34, Steps: 3 | Train Loss: 0.291 Vali Loss: 0.475 Vali Acc: 0.900 Test Loss: 0.475 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 35 cost time: 0.509530782699585
Epoch: 35, Steps: 3 | Train Loss: 0.231 Vali Loss: 0.457 Vali Acc: 0.900 Test Loss: 0.457 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 36 cost time: 0.5892386436462402
Epoch: 36, Steps: 3 | Train Loss: 0.238 Vali Loss: 0.446 Vali Acc: 0.900 Test Loss: 0.446 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 37 cost time: 0.739966630935669
Epoch: 37, Steps: 3 | Train Loss: 0.219 Vali Loss: 0.433 Vali Acc: 0.900 Test Loss: 0.433 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 38 cost time: 0.5681746006011963
Epoch: 38, Steps: 3 | Train Loss: 0.194 Vali Loss: 0.420 Vali Acc: 0.900 Test Loss: 0.420 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 39 cost time: 0.5858051776885986
Epoch: 39, Steps: 3 | Train Loss: 0.175 Vali Loss: 0.411 Vali Acc: 0.900 Test Loss: 0.411 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 40 cost time: 0.5773515701293945
Epoch: 40, Steps: 3 | Train Loss: 0.172 Vali Loss: 0.393 Vali Acc: 0.900 Test Loss: 0.393 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 41 cost time: 0.5385968685150146
Epoch: 41, Steps: 3 | Train Loss: 0.156 Vali Loss: 0.371 Vali Acc: 0.900 Test Loss: 0.371 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 42 cost time: 0.5779085159301758
Epoch: 42, Steps: 3 | Train Loss: 0.147 Vali Loss: 0.349 Vali Acc: 0.925 Test Loss: 0.349 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924997).  Saving model ...
Epoch: 43 cost time: 0.5451326370239258
Epoch: 43, Steps: 3 | Train Loss: 0.165 Vali Loss: 0.345 Vali Acc: 0.950 Test Loss: 0.345 Test Acc: 0.950
Validation loss decreased (-0.924997 --> -0.949997).  Saving model ...
Epoch: 44 cost time: 0.5900685787200928
Epoch: 44, Steps: 3 | Train Loss: 0.119 Vali Loss: 0.329 Vali Acc: 0.950 Test Loss: 0.329 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 45 cost time: 0.5381298065185547
Epoch: 45, Steps: 3 | Train Loss: 0.104 Vali Loss: 0.327 Vali Acc: 0.950 Test Loss: 0.327 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 46 cost time: 0.5162158012390137
Epoch: 46, Steps: 3 | Train Loss: 0.100 Vali Loss: 0.322 Vali Acc: 0.950 Test Loss: 0.322 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 47 cost time: 0.7028021812438965
Epoch: 47, Steps: 3 | Train Loss: 0.090 Vali Loss: 0.325 Vali Acc: 0.950 Test Loss: 0.325 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.5611751079559326
Epoch: 48, Steps: 3 | Train Loss: 0.081 Vali Loss: 0.327 Vali Acc: 0.925 Test Loss: 0.327 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.6125273704528809
Epoch: 49, Steps: 3 | Train Loss: 0.078 Vali Loss: 0.325 Vali Acc: 0.925 Test Loss: 0.325 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.566319465637207
Epoch: 50, Steps: 3 | Train Loss: 0.078 Vali Loss: 0.311 Vali Acc: 0.925 Test Loss: 0.311 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps25_str13_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 1162692
model size : 4.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.8871712684631348
Epoch: 1, Steps: 3 | Train Loss: 1.354 Vali Loss: 1.354 Vali Acc: 0.225 Test Loss: 1.354 Test Acc: 0.225
Validation loss decreased (inf --> -0.224986).  Saving model ...
Epoch: 2 cost time: 0.5552124977111816
Epoch: 2, Steps: 3 | Train Loss: 1.243 Vali Loss: 1.291 Vali Acc: 0.325 Test Loss: 1.291 Test Acc: 0.325
Validation loss decreased (-0.224986 --> -0.324987).  Saving model ...
Epoch: 3 cost time: 0.6668558120727539
Epoch: 3, Steps: 3 | Train Loss: 1.079 Vali Loss: 1.166 Vali Acc: 0.525 Test Loss: 1.166 Test Acc: 0.525
Validation loss decreased (-0.324987 --> -0.524988).  Saving model ...
Epoch: 4 cost time: 0.5888893604278564
Epoch: 4, Steps: 3 | Train Loss: 0.872 Vali Loss: 1.003 Vali Acc: 0.800 Test Loss: 1.003 Test Acc: 0.800
Validation loss decreased (-0.524988 --> -0.799990).  Saving model ...
Epoch: 5 cost time: 0.6252415180206299
Epoch: 5, Steps: 3 | Train Loss: 0.688 Vali Loss: 0.834 Vali Acc: 0.875 Test Loss: 0.834 Test Acc: 0.875
Validation loss decreased (-0.799990 --> -0.874992).  Saving model ...
Epoch: 6 cost time: 0.5764532089233398
Epoch: 6, Steps: 3 | Train Loss: 0.527 Vali Loss: 0.679 Vali Acc: 0.900 Test Loss: 0.679 Test Acc: 0.900
Validation loss decreased (-0.874992 --> -0.899993).  Saving model ...
Epoch: 7 cost time: 0.5300371646881104
Epoch: 7, Steps: 3 | Train Loss: 0.402 Vali Loss: 0.543 Vali Acc: 0.900 Test Loss: 0.543 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899995).  Saving model ...
Epoch: 8 cost time: 0.582763671875
Epoch: 8, Steps: 3 | Train Loss: 0.304 Vali Loss: 0.430 Vali Acc: 0.950 Test Loss: 0.430 Test Acc: 0.950
Validation loss decreased (-0.899995 --> -0.949996).  Saving model ...
Epoch: 9 cost time: 0.5728499889373779
Epoch: 9, Steps: 3 | Train Loss: 0.226 Vali Loss: 0.338 Vali Acc: 0.975 Test Loss: 0.338 Test Acc: 0.975
Validation loss decreased (-0.949996 --> -0.974997).  Saving model ...
Epoch: 10 cost time: 0.6457812786102295
Epoch: 10, Steps: 3 | Train Loss: 0.173 Vali Loss: 0.283 Vali Acc: 0.975 Test Loss: 0.283 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 11 cost time: 0.6525976657867432
Epoch: 11, Steps: 3 | Train Loss: 0.141 Vali Loss: 0.243 Vali Acc: 0.975 Test Loss: 0.243 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 12 cost time: 0.5812561511993408
Epoch: 12, Steps: 3 | Train Loss: 0.113 Vali Loss: 0.217 Vali Acc: 0.975 Test Loss: 0.217 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 13 cost time: 0.633298397064209
Epoch: 13, Steps: 3 | Train Loss: 0.108 Vali Loss: 0.203 Vali Acc: 0.950 Test Loss: 0.203 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5551402568817139
Epoch: 14, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.205 Vali Acc: 0.950 Test Loss: 0.205 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.75624680519104
Epoch: 15, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.221 Vali Acc: 0.950 Test Loss: 0.221 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.5836312770843506
Epoch: 16, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.226 Vali Acc: 0.950 Test Loss: 0.226 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.62998366355896
Epoch: 17, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.229 Vali Acc: 0.925 Test Loss: 0.229 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.5482280254364014
Epoch: 18, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.226 Vali Acc: 0.950 Test Loss: 0.226 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.6340601444244385
Epoch: 19, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.242 Vali Acc: 0.925 Test Loss: 0.242 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.49863767623901367
Epoch: 20, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.249 Vali Acc: 0.950 Test Loss: 0.249 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.49277806282043457
Epoch: 21, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.247 Vali Acc: 0.950 Test Loss: 0.247 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.561516284942627
Epoch: 22, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.255 Vali Acc: 0.950 Test Loss: 0.255 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 4337668
model size : 16.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.724458932876587
Epoch: 1, Steps: 3 | Train Loss: 1.288 Vali Loss: 1.287 Vali Acc: 0.325 Test Loss: 1.287 Test Acc: 0.325
Validation loss decreased (inf --> -0.324987).  Saving model ...
Epoch: 2 cost time: 0.60345458984375
Epoch: 2, Steps: 3 | Train Loss: 1.197 Vali Loss: 1.235 Vali Acc: 0.400 Test Loss: 1.235 Test Acc: 0.400
Validation loss decreased (-0.324987 --> -0.399988).  Saving model ...
Epoch: 3 cost time: 0.5489101409912109
Epoch: 3, Steps: 3 | Train Loss: 1.089 Vali Loss: 1.133 Vali Acc: 0.775 Test Loss: 1.133 Test Acc: 0.775
Validation loss decreased (-0.399988 --> -0.774989).  Saving model ...
Epoch: 4 cost time: 0.5162646770477295
Epoch: 4, Steps: 3 | Train Loss: 0.939 Vali Loss: 0.997 Vali Acc: 0.850 Test Loss: 0.997 Test Acc: 0.850
Validation loss decreased (-0.774989 --> -0.849990).  Saving model ...
Epoch: 5 cost time: 0.4840376377105713
Epoch: 5, Steps: 3 | Train Loss: 0.778 Vali Loss: 0.848 Vali Acc: 0.875 Test Loss: 0.848 Test Acc: 0.875
Validation loss decreased (-0.849990 --> -0.874992).  Saving model ...
Epoch: 6 cost time: 0.6469013690948486
Epoch: 6, Steps: 3 | Train Loss: 0.590 Vali Loss: 0.718 Vali Acc: 0.900 Test Loss: 0.718 Test Acc: 0.900
Validation loss decreased (-0.874992 --> -0.899993).  Saving model ...
Epoch: 7 cost time: 0.6530694961547852
Epoch: 7, Steps: 3 | Train Loss: 0.489 Vali Loss: 0.586 Vali Acc: 0.950 Test Loss: 0.586 Test Acc: 0.950
Validation loss decreased (-0.899993 --> -0.949994).  Saving model ...
Epoch: 8 cost time: 0.6106462478637695
Epoch: 8, Steps: 3 | Train Loss: 0.358 Vali Loss: 0.486 Vali Acc: 0.925 Test Loss: 0.486 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5960588455200195
Epoch: 9, Steps: 3 | Train Loss: 0.295 Vali Loss: 0.395 Vali Acc: 0.950 Test Loss: 0.395 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949996).  Saving model ...
Epoch: 10 cost time: 0.4717447757720947
Epoch: 10, Steps: 3 | Train Loss: 0.204 Vali Loss: 0.316 Vali Acc: 0.950 Test Loss: 0.316 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 11 cost time: 0.5840938091278076
Epoch: 11, Steps: 3 | Train Loss: 0.198 Vali Loss: 0.268 Vali Acc: 0.950 Test Loss: 0.268 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 12 cost time: 0.5770962238311768
Epoch: 12, Steps: 3 | Train Loss: 0.149 Vali Loss: 0.224 Vali Acc: 0.950 Test Loss: 0.224 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 13 cost time: 0.5896828174591064
Epoch: 13, Steps: 3 | Train Loss: 0.153 Vali Loss: 0.194 Vali Acc: 0.975 Test Loss: 0.194 Test Acc: 0.975
Validation loss decreased (-0.949998 --> -0.974998).  Saving model ...
Epoch: 14 cost time: 0.5807535648345947
Epoch: 14, Steps: 3 | Train Loss: 0.100 Vali Loss: 0.174 Vali Acc: 0.975 Test Loss: 0.174 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 15 cost time: 0.5274989604949951
Epoch: 15, Steps: 3 | Train Loss: 0.100 Vali Loss: 0.154 Vali Acc: 0.975 Test Loss: 0.154 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 16 cost time: 0.5101525783538818
Epoch: 16, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.141 Vali Acc: 0.975 Test Loss: 0.141 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974999).  Saving model ...
Epoch: 17 cost time: 0.5909192562103271
Epoch: 17, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.126 Vali Acc: 0.975 Test Loss: 0.126 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 18 cost time: 0.5707635879516602
Epoch: 18, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.122 Vali Acc: 0.975 Test Loss: 0.122 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 19 cost time: 0.5975286960601807
Epoch: 19, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.117 Vali Acc: 0.975 Test Loss: 0.117 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 20 cost time: 0.5886733531951904
Epoch: 20, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.110 Vali Acc: 0.975 Test Loss: 0.110 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 21 cost time: 0.6450886726379395
Epoch: 21, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.111 Vali Acc: 0.975 Test Loss: 0.111 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6804244518280029
Epoch: 22, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.110 Vali Acc: 0.975 Test Loss: 0.110 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.6231377124786377
Epoch: 23, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.111 Vali Acc: 0.975 Test Loss: 0.111 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.5994408130645752
Epoch: 24, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.110 Vali Acc: 0.975 Test Loss: 0.110 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.611316442489624
Epoch: 25, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.105 Vali Acc: 0.975 Test Loss: 0.105 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 26 cost time: 0.5674312114715576
Epoch: 26, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.107 Vali Acc: 0.950 Test Loss: 0.107 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.7098729610443115
Epoch: 27, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.107 Vali Acc: 0.950 Test Loss: 0.107 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.6219346523284912
Epoch: 28, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.112 Vali Acc: 0.950 Test Loss: 0.112 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.6022803783416748
Epoch: 29, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.115 Vali Acc: 0.950 Test Loss: 0.115 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.641758918762207
Epoch: 30, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.118 Vali Acc: 0.950 Test Loss: 0.118 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.6738841533660889
Epoch: 31, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.124 Vali Acc: 0.950 Test Loss: 0.124 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.5347826480865479
Epoch: 32, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.127 Vali Acc: 0.950 Test Loss: 0.127 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.5313830375671387
Epoch: 33, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.130 Vali Acc: 0.950 Test Loss: 0.130 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.568631649017334
Epoch: 34, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.125 Vali Acc: 0.950 Test Loss: 0.125 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.5322744846343994
Epoch: 35, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.116 Vali Acc: 0.950 Test Loss: 0.116 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 4288772
model size : 16.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.6947641372680664
Epoch: 1, Steps: 3 | Train Loss: 1.320 Vali Loss: 1.320 Vali Acc: 0.400 Test Loss: 1.320 Test Acc: 0.400
Validation loss decreased (inf --> -0.399987).  Saving model ...
Epoch: 2 cost time: 0.47855305671691895
Epoch: 2, Steps: 3 | Train Loss: 1.244 Vali Loss: 1.274 Vali Acc: 0.525 Test Loss: 1.274 Test Acc: 0.525
Validation loss decreased (-0.399987 --> -0.524987).  Saving model ...
Epoch: 3 cost time: 0.5372312068939209
Epoch: 3, Steps: 3 | Train Loss: 1.141 Vali Loss: 1.189 Vali Acc: 0.675 Test Loss: 1.189 Test Acc: 0.675
Validation loss decreased (-0.524987 --> -0.674988).  Saving model ...
Epoch: 4 cost time: 0.5892238616943359
Epoch: 4, Steps: 3 | Train Loss: 1.019 Vali Loss: 1.082 Vali Acc: 0.775 Test Loss: 1.082 Test Acc: 0.775
Validation loss decreased (-0.674988 --> -0.774989).  Saving model ...
Epoch: 5 cost time: 0.4797823429107666
Epoch: 5, Steps: 3 | Train Loss: 0.851 Vali Loss: 0.956 Vali Acc: 0.850 Test Loss: 0.956 Test Acc: 0.850
Validation loss decreased (-0.774989 --> -0.849990).  Saving model ...
Epoch: 6 cost time: 0.580935001373291
Epoch: 6, Steps: 3 | Train Loss: 0.740 Vali Loss: 0.816 Vali Acc: 0.875 Test Loss: 0.816 Test Acc: 0.875
Validation loss decreased (-0.849990 --> -0.874992).  Saving model ...
Epoch: 7 cost time: 0.592780590057373
Epoch: 7, Steps: 3 | Train Loss: 0.581 Vali Loss: 0.692 Vali Acc: 0.950 Test Loss: 0.692 Test Acc: 0.950
Validation loss decreased (-0.874992 --> -0.949993).  Saving model ...
Epoch: 8 cost time: 0.5613272190093994
Epoch: 8, Steps: 3 | Train Loss: 0.507 Vali Loss: 0.578 Vali Acc: 0.900 Test Loss: 0.578 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5223257541656494
Epoch: 9, Steps: 3 | Train Loss: 0.403 Vali Loss: 0.487 Vali Acc: 0.950 Test Loss: 0.487 Test Acc: 0.950
Validation loss decreased (-0.949993 --> -0.949995).  Saving model ...
Epoch: 10 cost time: 0.5663926601409912
Epoch: 10, Steps: 3 | Train Loss: 0.320 Vali Loss: 0.414 Vali Acc: 0.950 Test Loss: 0.414 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 11 cost time: 0.5804057121276855
Epoch: 11, Steps: 3 | Train Loss: 0.267 Vali Loss: 0.365 Vali Acc: 0.975 Test Loss: 0.365 Test Acc: 0.975
Validation loss decreased (-0.949996 --> -0.974996).  Saving model ...
Epoch: 12 cost time: 0.5539734363555908
Epoch: 12, Steps: 3 | Train Loss: 0.182 Vali Loss: 0.326 Vali Acc: 0.975 Test Loss: 0.326 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 13 cost time: 0.624955415725708
Epoch: 13, Steps: 3 | Train Loss: 0.178 Vali Loss: 0.299 Vali Acc: 0.950 Test Loss: 0.299 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5687336921691895
Epoch: 14, Steps: 3 | Train Loss: 0.179 Vali Loss: 0.272 Vali Acc: 0.950 Test Loss: 0.272 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6664981842041016
Epoch: 15, Steps: 3 | Train Loss: 0.141 Vali Loss: 0.259 Vali Acc: 0.950 Test Loss: 0.259 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.6454012393951416
Epoch: 16, Steps: 3 | Train Loss: 0.116 Vali Loss: 0.244 Vali Acc: 0.950 Test Loss: 0.244 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.6347832679748535
Epoch: 17, Steps: 3 | Train Loss: 0.093 Vali Loss: 0.231 Vali Acc: 0.950 Test Loss: 0.231 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.5666539669036865
Epoch: 18, Steps: 3 | Train Loss: 0.071 Vali Loss: 0.223 Vali Acc: 0.950 Test Loss: 0.223 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.5893545150756836
Epoch: 19, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.216 Vali Acc: 0.950 Test Loss: 0.216 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.6219863891601562
Epoch: 20, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.207 Vali Acc: 0.950 Test Loss: 0.207 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.6720671653747559
Epoch: 21, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.194 Vali Acc: 0.950 Test Loss: 0.194 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.47634196281433105
Epoch: 22, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.195 Vali Acc: 0.950 Test Loss: 0.195 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 4264580
model size : 16.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.8742051124572754
Epoch: 1, Steps: 3 | Train Loss: 1.377 Vali Loss: 1.292 Vali Acc: 0.450 Test Loss: 1.292 Test Acc: 0.450
Validation loss decreased (inf --> -0.449987).  Saving model ...
Epoch: 2 cost time: 0.6349852085113525
Epoch: 2, Steps: 3 | Train Loss: 1.323 Vali Loss: 1.254 Vali Acc: 0.625 Test Loss: 1.254 Test Acc: 0.625
Validation loss decreased (-0.449987 --> -0.624987).  Saving model ...
Epoch: 3 cost time: 0.4723072052001953
Epoch: 3, Steps: 3 | Train Loss: 1.222 Vali Loss: 1.180 Vali Acc: 0.750 Test Loss: 1.180 Test Acc: 0.750
Validation loss decreased (-0.624987 --> -0.749988).  Saving model ...
Epoch: 4 cost time: 0.5005650520324707
Epoch: 4, Steps: 3 | Train Loss: 1.067 Vali Loss: 1.088 Vali Acc: 0.825 Test Loss: 1.088 Test Acc: 0.825
Validation loss decreased (-0.749988 --> -0.824989).  Saving model ...
Epoch: 5 cost time: 0.5532379150390625
Epoch: 5, Steps: 3 | Train Loss: 0.925 Vali Loss: 0.982 Vali Acc: 0.875 Test Loss: 0.982 Test Acc: 0.875
Validation loss decreased (-0.824989 --> -0.874990).  Saving model ...
Epoch: 6 cost time: 0.4972212314605713
Epoch: 6, Steps: 3 | Train Loss: 0.790 Vali Loss: 0.873 Vali Acc: 0.875 Test Loss: 0.873 Test Acc: 0.875
Validation loss decreased (-0.874990 --> -0.874991).  Saving model ...
Epoch: 7 cost time: 0.5582852363586426
Epoch: 7, Steps: 3 | Train Loss: 0.676 Vali Loss: 0.764 Vali Acc: 0.925 Test Loss: 0.764 Test Acc: 0.925
Validation loss decreased (-0.874991 --> -0.924992).  Saving model ...
Epoch: 8 cost time: 0.5372738838195801
Epoch: 8, Steps: 3 | Train Loss: 0.572 Vali Loss: 0.660 Vali Acc: 0.950 Test Loss: 0.660 Test Acc: 0.950
Validation loss decreased (-0.924992 --> -0.949993).  Saving model ...
Epoch: 9 cost time: 0.546626091003418
Epoch: 9, Steps: 3 | Train Loss: 0.502 Vali Loss: 0.568 Vali Acc: 0.950 Test Loss: 0.568 Test Acc: 0.950
Validation loss decreased (-0.949993 --> -0.949994).  Saving model ...
Epoch: 10 cost time: 0.5637505054473877
Epoch: 10, Steps: 3 | Train Loss: 0.373 Vali Loss: 0.498 Vali Acc: 0.950 Test Loss: 0.498 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 11 cost time: 0.6725430488586426
Epoch: 11, Steps: 3 | Train Loss: 0.367 Vali Loss: 0.434 Vali Acc: 0.950 Test Loss: 0.434 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 12 cost time: 0.7016634941101074
Epoch: 12, Steps: 3 | Train Loss: 0.276 Vali Loss: 0.383 Vali Acc: 0.950 Test Loss: 0.383 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 13 cost time: 0.6035211086273193
Epoch: 13, Steps: 3 | Train Loss: 0.249 Vali Loss: 0.337 Vali Acc: 0.950 Test Loss: 0.337 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 14 cost time: 0.568697452545166
Epoch: 14, Steps: 3 | Train Loss: 0.204 Vali Loss: 0.310 Vali Acc: 0.950 Test Loss: 0.310 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 15 cost time: 0.5899441242218018
Epoch: 15, Steps: 3 | Train Loss: 0.174 Vali Loss: 0.280 Vali Acc: 0.950 Test Loss: 0.280 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 16 cost time: 0.5608646869659424
Epoch: 16, Steps: 3 | Train Loss: 0.134 Vali Loss: 0.252 Vali Acc: 0.950 Test Loss: 0.252 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 17 cost time: 0.6029720306396484
Epoch: 17, Steps: 3 | Train Loss: 0.128 Vali Loss: 0.243 Vali Acc: 0.975 Test Loss: 0.243 Test Acc: 0.975
Validation loss decreased (-0.949997 --> -0.974998).  Saving model ...
Epoch: 18 cost time: 0.5887577533721924
Epoch: 18, Steps: 3 | Train Loss: 0.113 Vali Loss: 0.225 Vali Acc: 0.975 Test Loss: 0.225 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 19 cost time: 0.5168218612670898
Epoch: 19, Steps: 3 | Train Loss: 0.092 Vali Loss: 0.213 Vali Acc: 0.950 Test Loss: 0.213 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5883870124816895
Epoch: 20, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.204 Vali Acc: 0.950 Test Loss: 0.204 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.5773751735687256
Epoch: 21, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.201 Vali Acc: 0.950 Test Loss: 0.201 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.5622334480285645
Epoch: 22, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.206 Vali Acc: 0.950 Test Loss: 0.206 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.5876359939575195
Epoch: 23, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.190 Vali Acc: 0.950 Test Loss: 0.190 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.6322293281555176
Epoch: 24, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.182 Vali Acc: 0.950 Test Loss: 0.182 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.6114144325256348
Epoch: 25, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.162 Vali Acc: 0.950 Test Loss: 0.162 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.7020871639251709
Epoch: 26, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.164 Vali Acc: 0.950 Test Loss: 0.164 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.49467945098876953
Epoch: 27, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.167 Vali Acc: 0.950 Test Loss: 0.167 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.5663094520568848
Epoch: 28, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.162 Vali Acc: 0.950 Test Loss: 0.162 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 4246404
model size : 16.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.897773265838623
Epoch: 1, Steps: 3 | Train Loss: 1.402 Vali Loss: 1.340 Vali Acc: 0.200 Test Loss: 1.340 Test Acc: 0.200
Validation loss decreased (inf --> -0.199987).  Saving model ...
Epoch: 2 cost time: 0.551612377166748
Epoch: 2, Steps: 3 | Train Loss: 1.307 Vali Loss: 1.309 Vali Acc: 0.225 Test Loss: 1.309 Test Acc: 0.225
Validation loss decreased (-0.199987 --> -0.224987).  Saving model ...
Epoch: 3 cost time: 0.6061992645263672
Epoch: 3, Steps: 3 | Train Loss: 1.251 Vali Loss: 1.257 Vali Acc: 0.325 Test Loss: 1.257 Test Acc: 0.325
Validation loss decreased (-0.224987 --> -0.324987).  Saving model ...
Epoch: 4 cost time: 0.5973775386810303
Epoch: 4, Steps: 3 | Train Loss: 1.156 Vali Loss: 1.186 Vali Acc: 0.500 Test Loss: 1.186 Test Acc: 0.500
Validation loss decreased (-0.324987 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 0.5845894813537598
Epoch: 5, Steps: 3 | Train Loss: 1.032 Vali Loss: 1.097 Vali Acc: 0.750 Test Loss: 1.097 Test Acc: 0.750
Validation loss decreased (-0.499988 --> -0.749989).  Saving model ...
Epoch: 6 cost time: 0.6413681507110596
Epoch: 6, Steps: 3 | Train Loss: 0.898 Vali Loss: 1.009 Vali Acc: 0.925 Test Loss: 1.009 Test Acc: 0.925
Validation loss decreased (-0.749989 --> -0.924990).  Saving model ...
Epoch: 7 cost time: 0.620755672454834
Epoch: 7, Steps: 3 | Train Loss: 0.832 Vali Loss: 0.906 Vali Acc: 0.975 Test Loss: 0.906 Test Acc: 0.975
Validation loss decreased (-0.924990 --> -0.974991).  Saving model ...
Epoch: 8 cost time: 0.5923762321472168
Epoch: 8, Steps: 3 | Train Loss: 0.717 Vali Loss: 0.804 Vali Acc: 0.975 Test Loss: 0.804 Test Acc: 0.975
Validation loss decreased (-0.974991 --> -0.974992).  Saving model ...
Epoch: 9 cost time: 0.6178674697875977
Epoch: 9, Steps: 3 | Train Loss: 0.621 Vali Loss: 0.712 Vali Acc: 0.975 Test Loss: 0.712 Test Acc: 0.975
Validation loss decreased (-0.974992 --> -0.974993).  Saving model ...
Epoch: 10 cost time: 0.6612238883972168
Epoch: 10, Steps: 3 | Train Loss: 0.527 Vali Loss: 0.629 Vali Acc: 0.975 Test Loss: 0.629 Test Acc: 0.975
Validation loss decreased (-0.974993 --> -0.974994).  Saving model ...
Epoch: 11 cost time: 0.6595909595489502
Epoch: 11, Steps: 3 | Train Loss: 0.476 Vali Loss: 0.555 Vali Acc: 0.975 Test Loss: 0.555 Test Acc: 0.975
Validation loss decreased (-0.974994 --> -0.974994).  Saving model ...
Epoch: 12 cost time: 0.575531005859375
Epoch: 12, Steps: 3 | Train Loss: 0.394 Vali Loss: 0.495 Vali Acc: 0.975 Test Loss: 0.495 Test Acc: 0.975
Validation loss decreased (-0.974994 --> -0.974995).  Saving model ...
Epoch: 13 cost time: 0.6354703903198242
Epoch: 13, Steps: 3 | Train Loss: 0.372 Vali Loss: 0.436 Vali Acc: 0.975 Test Loss: 0.436 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 14 cost time: 0.624241828918457
Epoch: 14, Steps: 3 | Train Loss: 0.334 Vali Loss: 0.391 Vali Acc: 0.975 Test Loss: 0.391 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 15 cost time: 0.529930591583252
Epoch: 15, Steps: 3 | Train Loss: 0.269 Vali Loss: 0.351 Vali Acc: 0.975 Test Loss: 0.351 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 16 cost time: 0.5974464416503906
Epoch: 16, Steps: 3 | Train Loss: 0.229 Vali Loss: 0.323 Vali Acc: 0.975 Test Loss: 0.323 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 17 cost time: 0.5081861019134521
Epoch: 17, Steps: 3 | Train Loss: 0.225 Vali Loss: 0.304 Vali Acc: 0.975 Test Loss: 0.304 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 18 cost time: 0.545642614364624
Epoch: 18, Steps: 3 | Train Loss: 0.164 Vali Loss: 0.276 Vali Acc: 0.975 Test Loss: 0.276 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 19 cost time: 0.551701545715332
Epoch: 19, Steps: 3 | Train Loss: 0.165 Vali Loss: 0.266 Vali Acc: 0.975 Test Loss: 0.266 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 20 cost time: 0.6241116523742676
Epoch: 20, Steps: 3 | Train Loss: 0.148 Vali Loss: 0.254 Vali Acc: 0.975 Test Loss: 0.254 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 21 cost time: 0.683436393737793
Epoch: 21, Steps: 3 | Train Loss: 0.136 Vali Loss: 0.250 Vali Acc: 0.950 Test Loss: 0.250 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6118683815002441
Epoch: 22, Steps: 3 | Train Loss: 0.103 Vali Loss: 0.240 Vali Acc: 0.950 Test Loss: 0.240 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.5557682514190674
Epoch: 23, Steps: 3 | Train Loss: 0.114 Vali Loss: 0.242 Vali Acc: 0.950 Test Loss: 0.242 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.6152017116546631
Epoch: 24, Steps: 3 | Train Loss: 0.080 Vali Loss: 0.236 Vali Acc: 0.950 Test Loss: 0.236 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.49624085426330566
Epoch: 25, Steps: 3 | Train Loss: 0.075 Vali Loss: 0.232 Vali Acc: 0.925 Test Loss: 0.232 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.5765583515167236
Epoch: 26, Steps: 3 | Train Loss: 0.082 Vali Loss: 0.235 Vali Acc: 0.925 Test Loss: 0.235 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.6644985675811768
Epoch: 27, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.219 Vali Acc: 0.925 Test Loss: 0.219 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.5785167217254639
Epoch: 28, Steps: 3 | Train Loss: 0.058 Vali Loss: 0.213 Vali Acc: 0.925 Test Loss: 0.213 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.6179826259613037
Epoch: 29, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.205 Vali Acc: 0.950 Test Loss: 0.205 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.6672217845916748
Epoch: 30, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.201 Vali Acc: 0.950 Test Loss: 0.201 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 4222468
model size : 16.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps20_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.5625712871551514
Epoch: 1, Steps: 3 | Train Loss: 1.425 Vali Loss: 1.407 Vali Acc: 0.375 Test Loss: 1.407 Test Acc: 0.375
Validation loss decreased (inf --> -0.374986).  Saving model ...
Epoch: 2 cost time: 0.5582008361816406
Epoch: 2, Steps: 3 | Train Loss: 1.374 Vali Loss: 1.386 Vali Acc: 0.450 Test Loss: 1.386 Test Acc: 0.450
Validation loss decreased (-0.374986 --> -0.449986).  Saving model ...
Epoch: 3 cost time: 0.4743499755859375
Epoch: 3, Steps: 3 | Train Loss: 1.296 Vali Loss: 1.346 Vali Acc: 0.525 Test Loss: 1.346 Test Acc: 0.525
Validation loss decreased (-0.449986 --> -0.524987).  Saving model ...
Epoch: 4 cost time: 0.5453386306762695
Epoch: 4, Steps: 3 | Train Loss: 1.183 Vali Loss: 1.287 Vali Acc: 0.600 Test Loss: 1.287 Test Acc: 0.600
Validation loss decreased (-0.524987 --> -0.599987).  Saving model ...
Epoch: 5 cost time: 0.5361180305480957
Epoch: 5, Steps: 3 | Train Loss: 1.073 Vali Loss: 1.213 Vali Acc: 0.700 Test Loss: 1.213 Test Acc: 0.700
Validation loss decreased (-0.599987 --> -0.699988).  Saving model ...
Epoch: 6 cost time: 0.4814341068267822
Epoch: 6, Steps: 3 | Train Loss: 0.965 Vali Loss: 1.128 Vali Acc: 0.725 Test Loss: 1.128 Test Acc: 0.725
Validation loss decreased (-0.699988 --> -0.724989).  Saving model ...
Epoch: 7 cost time: 0.5208690166473389
Epoch: 7, Steps: 3 | Train Loss: 0.875 Vali Loss: 1.035 Vali Acc: 0.750 Test Loss: 1.035 Test Acc: 0.750
Validation loss decreased (-0.724989 --> -0.749990).  Saving model ...
Epoch: 8 cost time: 0.5675711631774902
Epoch: 8, Steps: 3 | Train Loss: 0.749 Vali Loss: 0.944 Vali Acc: 0.750 Test Loss: 0.944 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749991).  Saving model ...
Epoch: 9 cost time: 0.5481865406036377
Epoch: 9, Steps: 3 | Train Loss: 0.686 Vali Loss: 0.861 Vali Acc: 0.800 Test Loss: 0.861 Test Acc: 0.800
Validation loss decreased (-0.749991 --> -0.799991).  Saving model ...
Epoch: 10 cost time: 0.4711611270904541
Epoch: 10, Steps: 3 | Train Loss: 0.595 Vali Loss: 0.772 Vali Acc: 0.875 Test Loss: 0.772 Test Acc: 0.875
Validation loss decreased (-0.799991 --> -0.874992).  Saving model ...
Epoch: 11 cost time: 0.5721817016601562
Epoch: 11, Steps: 3 | Train Loss: 0.550 Vali Loss: 0.694 Vali Acc: 0.900 Test Loss: 0.694 Test Acc: 0.900
Validation loss decreased (-0.874992 --> -0.899993).  Saving model ...
Epoch: 12 cost time: 0.5672078132629395
Epoch: 12, Steps: 3 | Train Loss: 0.467 Vali Loss: 0.632 Vali Acc: 0.875 Test Loss: 0.632 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5386679172515869
Epoch: 13, Steps: 3 | Train Loss: 0.413 Vali Loss: 0.573 Vali Acc: 0.875 Test Loss: 0.573 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.5439915657043457
Epoch: 14, Steps: 3 | Train Loss: 0.381 Vali Loss: 0.529 Vali Acc: 0.875 Test Loss: 0.529 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.48149657249450684
Epoch: 15, Steps: 3 | Train Loss: 0.351 Vali Loss: 0.482 Vali Acc: 0.875 Test Loss: 0.482 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.6168563365936279
Epoch: 16, Steps: 3 | Train Loss: 0.309 Vali Loss: 0.449 Vali Acc: 0.900 Test Loss: 0.449 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899996).  Saving model ...
Epoch: 17 cost time: 0.500415563583374
Epoch: 17, Steps: 3 | Train Loss: 0.265 Vali Loss: 0.425 Vali Acc: 0.900 Test Loss: 0.425 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 18 cost time: 0.577033519744873
Epoch: 18, Steps: 3 | Train Loss: 0.225 Vali Loss: 0.414 Vali Acc: 0.875 Test Loss: 0.414 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.554774284362793
Epoch: 19, Steps: 3 | Train Loss: 0.242 Vali Loss: 0.396 Vali Acc: 0.900 Test Loss: 0.396 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 20 cost time: 0.6107101440429688
Epoch: 20, Steps: 3 | Train Loss: 0.203 Vali Loss: 0.379 Vali Acc: 0.900 Test Loss: 0.379 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 21 cost time: 0.5393428802490234
Epoch: 21, Steps: 3 | Train Loss: 0.169 Vali Loss: 0.362 Vali Acc: 0.900 Test Loss: 0.362 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 22 cost time: 0.5821390151977539
Epoch: 22, Steps: 3 | Train Loss: 0.156 Vali Loss: 0.346 Vali Acc: 0.900 Test Loss: 0.346 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899997).  Saving model ...
Epoch: 23 cost time: 0.589519739151001
Epoch: 23, Steps: 3 | Train Loss: 0.151 Vali Loss: 0.339 Vali Acc: 0.900 Test Loss: 0.339 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 24 cost time: 0.5512251853942871
Epoch: 24, Steps: 3 | Train Loss: 0.124 Vali Loss: 0.337 Vali Acc: 0.900 Test Loss: 0.337 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 25 cost time: 0.5081281661987305
Epoch: 25, Steps: 3 | Train Loss: 0.116 Vali Loss: 0.319 Vali Acc: 0.900 Test Loss: 0.319 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 26 cost time: 0.452007532119751
Epoch: 26, Steps: 3 | Train Loss: 0.112 Vali Loss: 0.305 Vali Acc: 0.900 Test Loss: 0.305 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 27 cost time: 0.5692310333251953
Epoch: 27, Steps: 3 | Train Loss: 0.097 Vali Loss: 0.290 Vali Acc: 0.900 Test Loss: 0.290 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 28 cost time: 0.5946457386016846
Epoch: 28, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.290 Vali Acc: 0.900 Test Loss: 0.290 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 29 cost time: 0.4882187843322754
Epoch: 29, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.292 Vali Acc: 0.900 Test Loss: 0.292 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.503690242767334
Epoch: 30, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.278 Vali Acc: 0.900 Test Loss: 0.278 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 31 cost time: 0.5365829467773438
Epoch: 31, Steps: 3 | Train Loss: 0.071 Vali Loss: 0.276 Vali Acc: 0.900 Test Loss: 0.276 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 32 cost time: 0.5940089225769043
Epoch: 32, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.269 Vali Acc: 0.900 Test Loss: 0.269 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 33 cost time: 0.48152780532836914
Epoch: 33, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.260 Vali Acc: 0.900 Test Loss: 0.260 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 34 cost time: 0.5092220306396484
Epoch: 34, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.257 Vali Acc: 0.900 Test Loss: 0.257 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 35 cost time: 0.4987008571624756
Epoch: 35, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.260 Vali Acc: 0.900 Test Loss: 0.260 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.5058307647705078
Epoch: 36, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.248 Vali Acc: 0.900 Test Loss: 0.248 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899998).  Saving model ...
Epoch: 37 cost time: 0.48487043380737305
Epoch: 37, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.248 Vali Acc: 0.900 Test Loss: 0.248 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.5449256896972656
Epoch: 38, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.249 Vali Acc: 0.900 Test Loss: 0.249 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.5101099014282227
Epoch: 39, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.246 Vali Acc: 0.900 Test Loss: 0.246 Test Acc: 0.900
Validation loss decreased (-0.899998 --> -0.899998).  Saving model ...
Epoch: 40 cost time: 0.5510127544403076
Epoch: 40, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.238 Vali Acc: 0.900 Test Loss: 0.238 Test Acc: 0.900
Validation loss decreased (-0.899998 --> -0.899998).  Saving model ...
Epoch: 41 cost time: 0.4884302616119385
Epoch: 41, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.242 Vali Acc: 0.900 Test Loss: 0.242 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.49622654914855957
Epoch: 42, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.241 Vali Acc: 0.900 Test Loss: 0.241 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.5067980289459229
Epoch: 43, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.238 Vali Acc: 0.900 Test Loss: 0.238 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.5687015056610107
Epoch: 44, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.245 Vali Acc: 0.900 Test Loss: 0.245 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.5497593879699707
Epoch: 45, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.251 Vali Acc: 0.900 Test Loss: 0.251 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.5244801044464111
Epoch: 46, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.253 Vali Acc: 0.900 Test Loss: 0.253 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.47944092750549316
Epoch: 47, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.250 Vali Acc: 0.925 Test Loss: 0.250 Test Acc: 0.925
Validation loss decreased (-0.899998 --> -0.924998).  Saving model ...
Epoch: 48 cost time: 0.4474303722381592
Epoch: 48, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.259 Vali Acc: 0.925 Test Loss: 0.259 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.5122389793395996
Epoch: 49, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.265 Vali Acc: 0.925 Test Loss: 0.265 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.48763418197631836
Epoch: 50, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.265 Vali Acc: 0.925 Test Loss: 0.265 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps20_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 4216964
model size : 16.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps25_str13_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.8891232013702393
Epoch: 1, Steps: 3 | Train Loss: 1.381 Vali Loss: 1.388 Vali Acc: 0.200 Test Loss: 1.388 Test Acc: 0.200
Validation loss decreased (inf --> -0.199986).  Saving model ...
Epoch: 2 cost time: 0.5748751163482666
Epoch: 2, Steps: 3 | Train Loss: 1.347 Vali Loss: 1.366 Vali Acc: 0.275 Test Loss: 1.366 Test Acc: 0.275
Validation loss decreased (-0.199986 --> -0.274986).  Saving model ...
Epoch: 3 cost time: 0.6355259418487549
Epoch: 3, Steps: 3 | Train Loss: 1.299 Vali Loss: 1.328 Vali Acc: 0.300 Test Loss: 1.328 Test Acc: 0.300
Validation loss decreased (-0.274986 --> -0.299987).  Saving model ...
Epoch: 4 cost time: 0.4749457836151123
Epoch: 4, Steps: 3 | Train Loss: 1.206 Vali Loss: 1.271 Vali Acc: 0.350 Test Loss: 1.271 Test Acc: 0.350
Validation loss decreased (-0.299987 --> -0.349987).  Saving model ...
Epoch: 5 cost time: 0.41597700119018555
Epoch: 5, Steps: 3 | Train Loss: 1.091 Vali Loss: 1.198 Vali Acc: 0.550 Test Loss: 1.198 Test Acc: 0.550
Validation loss decreased (-0.349987 --> -0.549988).  Saving model ...
Epoch: 6 cost time: 0.5237793922424316
Epoch: 6, Steps: 3 | Train Loss: 0.980 Vali Loss: 1.120 Vali Acc: 0.675 Test Loss: 1.120 Test Acc: 0.675
Validation loss decreased (-0.549988 --> -0.674989).  Saving model ...
Epoch: 7 cost time: 0.45717358589172363
Epoch: 7, Steps: 3 | Train Loss: 0.900 Vali Loss: 1.034 Vali Acc: 0.750 Test Loss: 1.034 Test Acc: 0.750
Validation loss decreased (-0.674989 --> -0.749990).  Saving model ...
Epoch: 8 cost time: 0.480194091796875
Epoch: 8, Steps: 3 | Train Loss: 0.774 Vali Loss: 0.947 Vali Acc: 0.850 Test Loss: 0.947 Test Acc: 0.850
Validation loss decreased (-0.749990 --> -0.849991).  Saving model ...
Epoch: 9 cost time: 0.5225646495819092
Epoch: 9, Steps: 3 | Train Loss: 0.702 Vali Loss: 0.861 Vali Acc: 0.875 Test Loss: 0.861 Test Acc: 0.875
Validation loss decreased (-0.849991 --> -0.874991).  Saving model ...
Epoch: 10 cost time: 0.4926896095275879
Epoch: 10, Steps: 3 | Train Loss: 0.643 Vali Loss: 0.785 Vali Acc: 0.850 Test Loss: 0.785 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5922415256500244
Epoch: 11, Steps: 3 | Train Loss: 0.554 Vali Loss: 0.711 Vali Acc: 0.875 Test Loss: 0.711 Test Acc: 0.875
Validation loss decreased (-0.874991 --> -0.874993).  Saving model ...
Epoch: 12 cost time: 0.5302474498748779
Epoch: 12, Steps: 3 | Train Loss: 0.500 Vali Loss: 0.644 Vali Acc: 0.875 Test Loss: 0.644 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 13 cost time: 0.6121044158935547
Epoch: 13, Steps: 3 | Train Loss: 0.456 Vali Loss: 0.593 Vali Acc: 0.900 Test Loss: 0.593 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899994).  Saving model ...
Epoch: 14 cost time: 0.5343058109283447
Epoch: 14, Steps: 3 | Train Loss: 0.402 Vali Loss: 0.538 Vali Acc: 0.900 Test Loss: 0.538 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 15 cost time: 0.46185779571533203
Epoch: 15, Steps: 3 | Train Loss: 0.348 Vali Loss: 0.492 Vali Acc: 0.900 Test Loss: 0.492 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 16 cost time: 0.5752699375152588
Epoch: 16, Steps: 3 | Train Loss: 0.323 Vali Loss: 0.464 Vali Acc: 0.900 Test Loss: 0.464 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 17 cost time: 0.5932962894439697
Epoch: 17, Steps: 3 | Train Loss: 0.285 Vali Loss: 0.439 Vali Acc: 0.900 Test Loss: 0.439 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 18 cost time: 0.5389173030853271
Epoch: 18, Steps: 3 | Train Loss: 0.274 Vali Loss: 0.410 Vali Acc: 0.925 Test Loss: 0.410 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924996).  Saving model ...
Epoch: 19 cost time: 0.548626184463501
Epoch: 19, Steps: 3 | Train Loss: 0.223 Vali Loss: 0.382 Vali Acc: 0.925 Test Loss: 0.382 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 20 cost time: 0.5715749263763428
Epoch: 20, Steps: 3 | Train Loss: 0.196 Vali Loss: 0.361 Vali Acc: 0.925 Test Loss: 0.361 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 21 cost time: 0.5622940063476562
Epoch: 21, Steps: 3 | Train Loss: 0.174 Vali Loss: 0.352 Vali Acc: 0.925 Test Loss: 0.352 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 22 cost time: 0.5724921226501465
Epoch: 22, Steps: 3 | Train Loss: 0.154 Vali Loss: 0.320 Vali Acc: 0.925 Test Loss: 0.320 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924997).  Saving model ...
Epoch: 23 cost time: 0.45963549613952637
Epoch: 23, Steps: 3 | Train Loss: 0.170 Vali Loss: 0.305 Vali Acc: 0.925 Test Loss: 0.305 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 24 cost time: 0.5329041481018066
Epoch: 24, Steps: 3 | Train Loss: 0.141 Vali Loss: 0.290 Vali Acc: 0.925 Test Loss: 0.290 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 25 cost time: 0.5285294055938721
Epoch: 25, Steps: 3 | Train Loss: 0.124 Vali Loss: 0.278 Vali Acc: 0.925 Test Loss: 0.278 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 26 cost time: 0.5843546390533447
Epoch: 26, Steps: 3 | Train Loss: 0.112 Vali Loss: 0.265 Vali Acc: 0.925 Test Loss: 0.265 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 27 cost time: 0.5782461166381836
Epoch: 27, Steps: 3 | Train Loss: 0.102 Vali Loss: 0.260 Vali Acc: 0.925 Test Loss: 0.260 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 28 cost time: 0.46253538131713867
Epoch: 28, Steps: 3 | Train Loss: 0.105 Vali Loss: 0.257 Vali Acc: 0.925 Test Loss: 0.257 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 29 cost time: 0.6031055450439453
Epoch: 29, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.257 Vali Acc: 0.925 Test Loss: 0.257 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.5041208267211914
Epoch: 30, Steps: 3 | Train Loss: 0.075 Vali Loss: 0.252 Vali Acc: 0.950 Test Loss: 0.252 Test Acc: 0.950
Validation loss decreased (-0.924997 --> -0.949997).  Saving model ...
Epoch: 31 cost time: 0.5200345516204834
Epoch: 31, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.243 Vali Acc: 0.950 Test Loss: 0.243 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 32 cost time: 0.5371017456054688
Epoch: 32, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.228 Vali Acc: 0.950 Test Loss: 0.228 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 33 cost time: 0.5276901721954346
Epoch: 33, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.222 Vali Acc: 0.950 Test Loss: 0.222 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 34 cost time: 0.478623628616333
Epoch: 34, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.218 Vali Acc: 0.950 Test Loss: 0.218 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 35 cost time: 0.47860288619995117
Epoch: 35, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.220 Vali Acc: 0.950 Test Loss: 0.220 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.515017032623291
Epoch: 36, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.212 Vali Acc: 0.950 Test Loss: 0.212 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 37 cost time: 0.5023157596588135
Epoch: 37, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.203 Vali Acc: 0.925 Test Loss: 0.203 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.579578161239624
Epoch: 38, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.204 Vali Acc: 0.925 Test Loss: 0.204 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.5527315139770508
Epoch: 39, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.199 Vali Acc: 0.925 Test Loss: 0.199 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.5541496276855469
Epoch: 40, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.195 Vali Acc: 0.925 Test Loss: 0.195 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.552093505859375
Epoch: 41, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.205 Vali Acc: 0.925 Test Loss: 0.205 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.5315332412719727
Epoch: 42, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.203 Vali Acc: 0.925 Test Loss: 0.203 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.5675592422485352
Epoch: 43, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.206 Vali Acc: 0.925 Test Loss: 0.206 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.5121150016784668
Epoch: 44, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.194 Vali Acc: 0.950 Test Loss: 0.194 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 45 cost time: 0.6313009262084961
Epoch: 45, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.200 Vali Acc: 0.925 Test Loss: 0.200 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.549654483795166
Epoch: 46, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.200 Vali Acc: 0.925 Test Loss: 0.200 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.5612320899963379
Epoch: 47, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.199 Vali Acc: 0.925 Test Loss: 0.199 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.4705524444580078
Epoch: 48, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.201 Vali Acc: 0.925 Test Loss: 0.201 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.5201523303985596
Epoch: 49, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.202 Vali Acc: 0.925 Test Loss: 0.202 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.4719710350036621
Epoch: 50, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.192 Vali Acc: 0.925 Test Loss: 0.192 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps25_str13_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 4211460
model size : 16.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.718780755996704
Epoch: 1, Steps: 3 | Train Loss: 1.353 Vali Loss: 1.407 Vali Acc: 0.250 Test Loss: 1.407 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 0.4588778018951416
Epoch: 2, Steps: 3 | Train Loss: 1.262 Vali Loss: 1.360 Vali Acc: 0.375 Test Loss: 1.360 Test Acc: 0.375
Validation loss decreased (-0.249986 --> -0.374986).  Saving model ...
Epoch: 3 cost time: 0.49419116973876953
Epoch: 3, Steps: 3 | Train Loss: 1.152 Vali Loss: 1.275 Vali Acc: 0.500 Test Loss: 1.275 Test Acc: 0.500
Validation loss decreased (-0.374986 --> -0.499987).  Saving model ...
Epoch: 4 cost time: 0.47548842430114746
Epoch: 4, Steps: 3 | Train Loss: 1.022 Vali Loss: 1.162 Vali Acc: 0.600 Test Loss: 1.162 Test Acc: 0.600
Validation loss decreased (-0.499987 --> -0.599988).  Saving model ...
Epoch: 5 cost time: 0.5117762088775635
Epoch: 5, Steps: 3 | Train Loss: 0.875 Vali Loss: 1.035 Vali Acc: 0.700 Test Loss: 1.035 Test Acc: 0.700
Validation loss decreased (-0.599988 --> -0.699990).  Saving model ...
Epoch: 6 cost time: 0.470412015914917
Epoch: 6, Steps: 3 | Train Loss: 0.758 Vali Loss: 0.904 Vali Acc: 0.825 Test Loss: 0.904 Test Acc: 0.825
Validation loss decreased (-0.699990 --> -0.824991).  Saving model ...
Epoch: 7 cost time: 0.4802544116973877
Epoch: 7, Steps: 3 | Train Loss: 0.611 Vali Loss: 0.780 Vali Acc: 0.850 Test Loss: 0.780 Test Acc: 0.850
Validation loss decreased (-0.824991 --> -0.849992).  Saving model ...
Epoch: 8 cost time: 0.46915268898010254
Epoch: 8, Steps: 3 | Train Loss: 0.511 Vali Loss: 0.658 Vali Acc: 0.900 Test Loss: 0.658 Test Acc: 0.900
Validation loss decreased (-0.849992 --> -0.899993).  Saving model ...
Epoch: 9 cost time: 0.5604038238525391
Epoch: 9, Steps: 3 | Train Loss: 0.423 Vali Loss: 0.564 Vali Acc: 0.925 Test Loss: 0.564 Test Acc: 0.925
Validation loss decreased (-0.899993 --> -0.924994).  Saving model ...
Epoch: 10 cost time: 0.5427169799804688
Epoch: 10, Steps: 3 | Train Loss: 0.371 Vali Loss: 0.494 Vali Acc: 0.925 Test Loss: 0.494 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 11 cost time: 0.5619950294494629
Epoch: 11, Steps: 3 | Train Loss: 0.284 Vali Loss: 0.429 Vali Acc: 0.925 Test Loss: 0.429 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 12 cost time: 0.46762609481811523
Epoch: 12, Steps: 3 | Train Loss: 0.257 Vali Loss: 0.377 Vali Acc: 0.925 Test Loss: 0.377 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 13 cost time: 0.518646240234375
Epoch: 13, Steps: 3 | Train Loss: 0.209 Vali Loss: 0.344 Vali Acc: 0.925 Test Loss: 0.344 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924997).  Saving model ...
Epoch: 14 cost time: 0.5432929992675781
Epoch: 14, Steps: 3 | Train Loss: 0.182 Vali Loss: 0.317 Vali Acc: 0.950 Test Loss: 0.317 Test Acc: 0.950
Validation loss decreased (-0.924997 --> -0.949997).  Saving model ...
Epoch: 15 cost time: 0.5419948101043701
Epoch: 15, Steps: 3 | Train Loss: 0.143 Vali Loss: 0.292 Vali Acc: 0.950 Test Loss: 0.292 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 16 cost time: 0.6123416423797607
Epoch: 16, Steps: 3 | Train Loss: 0.143 Vali Loss: 0.268 Vali Acc: 0.950 Test Loss: 0.268 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 17 cost time: 0.542853832244873
Epoch: 17, Steps: 3 | Train Loss: 0.120 Vali Loss: 0.257 Vali Acc: 0.950 Test Loss: 0.257 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 18 cost time: 0.5249190330505371
Epoch: 18, Steps: 3 | Train Loss: 0.102 Vali Loss: 0.240 Vali Acc: 0.950 Test Loss: 0.240 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 19 cost time: 0.46921801567077637
Epoch: 19, Steps: 3 | Train Loss: 0.088 Vali Loss: 0.229 Vali Acc: 0.950 Test Loss: 0.229 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 20 cost time: 0.5280866622924805
Epoch: 20, Steps: 3 | Train Loss: 0.072 Vali Loss: 0.220 Vali Acc: 0.950 Test Loss: 0.220 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 21 cost time: 0.5040073394775391
Epoch: 21, Steps: 3 | Train Loss: 0.055 Vali Loss: 0.218 Vali Acc: 0.950 Test Loss: 0.218 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 22 cost time: 0.48215579986572266
Epoch: 22, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.205 Vali Acc: 0.950 Test Loss: 0.205 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 23 cost time: 0.536247730255127
Epoch: 23, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.194 Vali Acc: 0.950 Test Loss: 0.194 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 24 cost time: 0.5988647937774658
Epoch: 24, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.194 Vali Acc: 0.950 Test Loss: 0.194 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.5423951148986816
Epoch: 25, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.200 Vali Acc: 0.950 Test Loss: 0.200 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.4558722972869873
Epoch: 26, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.189 Vali Acc: 0.950 Test Loss: 0.189 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 27 cost time: 0.5624980926513672
Epoch: 27, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.194 Vali Acc: 0.950 Test Loss: 0.194 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.49338722229003906
Epoch: 28, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.191 Vali Acc: 0.950 Test Loss: 0.191 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.5435028076171875
Epoch: 29, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.187 Vali Acc: 0.950 Test Loss: 0.187 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 30 cost time: 0.5164270401000977
Epoch: 30, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.187 Vali Acc: 0.950 Test Loss: 0.187 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.5870528221130371
Epoch: 31, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.188 Vali Acc: 0.950 Test Loss: 0.188 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.5511593818664551
Epoch: 32, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.188 Vali Acc: 0.950 Test Loss: 0.188 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.435805082321167
Epoch: 33, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.194 Vali Acc: 0.950 Test Loss: 0.194 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.569025993347168
Epoch: 34, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.197 Vali Acc: 0.950 Test Loss: 0.197 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.4927942752838135
Epoch: 35, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.203 Vali Acc: 0.950 Test Loss: 0.203 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.5100741386413574
Epoch: 36, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.204 Vali Acc: 0.950 Test Loss: 0.204 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.5018510818481445
Epoch: 37, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.205 Vali Acc: 0.950 Test Loss: 0.205 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.5376479625701904
Epoch: 38, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.212 Vali Acc: 0.950 Test Loss: 0.212 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.4928858280181885
Epoch: 39, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.216 Vali Acc: 0.950 Test Loss: 0.216 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 1169412
model size : 4.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.7062151432037354
Epoch: 1, Steps: 3 | Train Loss: 1.468 Vali Loss: 1.456 Vali Acc: 0.075 Test Loss: 1.456 Test Acc: 0.075
Validation loss decreased (inf --> -0.074985).  Saving model ...
Epoch: 2 cost time: 0.5659594535827637
Epoch: 2, Steps: 3 | Train Loss: 1.391 Vali Loss: 1.421 Vali Acc: 0.125 Test Loss: 1.421 Test Acc: 0.125
Validation loss decreased (-0.074985 --> -0.124986).  Saving model ...
Epoch: 3 cost time: 0.47521162033081055
Epoch: 3, Steps: 3 | Train Loss: 1.309 Vali Loss: 1.359 Vali Acc: 0.225 Test Loss: 1.359 Test Acc: 0.225
Validation loss decreased (-0.124986 --> -0.224986).  Saving model ...
Epoch: 4 cost time: 0.4103083610534668
Epoch: 4, Steps: 3 | Train Loss: 1.182 Vali Loss: 1.270 Vali Acc: 0.525 Test Loss: 1.270 Test Acc: 0.525
Validation loss decreased (-0.224986 --> -0.524987).  Saving model ...
Epoch: 5 cost time: 0.5001692771911621
Epoch: 5, Steps: 3 | Train Loss: 1.038 Vali Loss: 1.162 Vali Acc: 0.725 Test Loss: 1.162 Test Acc: 0.725
Validation loss decreased (-0.524987 --> -0.724988).  Saving model ...
Epoch: 6 cost time: 0.46072816848754883
Epoch: 6, Steps: 3 | Train Loss: 0.941 Vali Loss: 1.053 Vali Acc: 0.775 Test Loss: 1.053 Test Acc: 0.775
Validation loss decreased (-0.724988 --> -0.774989).  Saving model ...
Epoch: 7 cost time: 0.5149235725402832
Epoch: 7, Steps: 3 | Train Loss: 0.777 Vali Loss: 0.942 Vali Acc: 0.850 Test Loss: 0.942 Test Acc: 0.850
Validation loss decreased (-0.774989 --> -0.849991).  Saving model ...
Epoch: 8 cost time: 0.5115857124328613
Epoch: 8, Steps: 3 | Train Loss: 0.700 Vali Loss: 0.832 Vali Acc: 0.900 Test Loss: 0.832 Test Acc: 0.900
Validation loss decreased (-0.849991 --> -0.899992).  Saving model ...
Epoch: 9 cost time: 0.49999022483825684
Epoch: 9, Steps: 3 | Train Loss: 0.595 Vali Loss: 0.742 Vali Acc: 0.950 Test Loss: 0.742 Test Acc: 0.950
Validation loss decreased (-0.899992 --> -0.949993).  Saving model ...
Epoch: 10 cost time: 0.5495157241821289
Epoch: 10, Steps: 3 | Train Loss: 0.517 Vali Loss: 0.641 Vali Acc: 0.950 Test Loss: 0.641 Test Acc: 0.950
Validation loss decreased (-0.949993 --> -0.949994).  Saving model ...
Epoch: 11 cost time: 0.5162389278411865
Epoch: 11, Steps: 3 | Train Loss: 0.443 Vali Loss: 0.558 Vali Acc: 0.950 Test Loss: 0.558 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949994).  Saving model ...
Epoch: 12 cost time: 0.48026084899902344
Epoch: 12, Steps: 3 | Train Loss: 0.362 Vali Loss: 0.491 Vali Acc: 0.950 Test Loss: 0.491 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 13 cost time: 0.4882516860961914
Epoch: 13, Steps: 3 | Train Loss: 0.330 Vali Loss: 0.434 Vali Acc: 0.925 Test Loss: 0.434 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5387027263641357
Epoch: 14, Steps: 3 | Train Loss: 0.281 Vali Loss: 0.394 Vali Acc: 0.925 Test Loss: 0.394 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.5130603313446045
Epoch: 15, Steps: 3 | Train Loss: 0.253 Vali Loss: 0.354 Vali Acc: 0.950 Test Loss: 0.354 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 16 cost time: 0.44225358963012695
Epoch: 16, Steps: 3 | Train Loss: 0.238 Vali Loss: 0.313 Vali Acc: 0.950 Test Loss: 0.313 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 17 cost time: 0.4606747627258301
Epoch: 17, Steps: 3 | Train Loss: 0.178 Vali Loss: 0.285 Vali Acc: 0.950 Test Loss: 0.285 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 18 cost time: 0.43330931663513184
Epoch: 18, Steps: 3 | Train Loss: 0.158 Vali Loss: 0.262 Vali Acc: 0.975 Test Loss: 0.262 Test Acc: 0.975
Validation loss decreased (-0.949997 --> -0.974997).  Saving model ...
Epoch: 19 cost time: 0.45244288444519043
Epoch: 19, Steps: 3 | Train Loss: 0.144 Vali Loss: 0.245 Vali Acc: 0.975 Test Loss: 0.245 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 20 cost time: 0.4144594669342041
Epoch: 20, Steps: 3 | Train Loss: 0.151 Vali Loss: 0.230 Vali Acc: 0.975 Test Loss: 0.230 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 21 cost time: 0.4400756359100342
Epoch: 21, Steps: 3 | Train Loss: 0.124 Vali Loss: 0.221 Vali Acc: 0.975 Test Loss: 0.221 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 22 cost time: 0.46676135063171387
Epoch: 22, Steps: 3 | Train Loss: 0.091 Vali Loss: 0.216 Vali Acc: 0.950 Test Loss: 0.216 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.37546801567077637
Epoch: 23, Steps: 3 | Train Loss: 0.083 Vali Loss: 0.201 Vali Acc: 0.950 Test Loss: 0.201 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.4672544002532959
Epoch: 24, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.193 Vali Acc: 0.950 Test Loss: 0.193 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.4582209587097168
Epoch: 25, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.182 Vali Acc: 0.950 Test Loss: 0.182 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.47858548164367676
Epoch: 26, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.171 Vali Acc: 0.950 Test Loss: 0.171 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.4670124053955078
Epoch: 27, Steps: 3 | Train Loss: 0.055 Vali Loss: 0.172 Vali Acc: 0.950 Test Loss: 0.172 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.46445298194885254
Epoch: 28, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.169 Vali Acc: 0.950 Test Loss: 0.169 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.48020124435424805
Epoch: 29, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.167 Vali Acc: 0.950 Test Loss: 0.167 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.43334269523620605
Epoch: 30, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.170 Vali Acc: 0.950 Test Loss: 0.170 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.48767590522766113
Epoch: 31, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.175 Vali Acc: 0.950 Test Loss: 0.175 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 1144964
model size : 4.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.7236607074737549
Epoch: 1, Steps: 3 | Train Loss: 1.399 Vali Loss: 1.433 Vali Acc: 0.100 Test Loss: 1.433 Test Acc: 0.100
Validation loss decreased (inf --> -0.099986).  Saving model ...
Epoch: 2 cost time: 0.4490973949432373
Epoch: 2, Steps: 3 | Train Loss: 1.324 Vali Loss: 1.404 Vali Acc: 0.200 Test Loss: 1.404 Test Acc: 0.200
Validation loss decreased (-0.099986 --> -0.199986).  Saving model ...
Epoch: 3 cost time: 0.4685659408569336
Epoch: 3, Steps: 3 | Train Loss: 1.238 Vali Loss: 1.355 Vali Acc: 0.300 Test Loss: 1.355 Test Acc: 0.300
Validation loss decreased (-0.199986 --> -0.299986).  Saving model ...
Epoch: 4 cost time: 0.45461177825927734
Epoch: 4, Steps: 3 | Train Loss: 1.142 Vali Loss: 1.283 Vali Acc: 0.400 Test Loss: 1.283 Test Acc: 0.400
Validation loss decreased (-0.299986 --> -0.399987).  Saving model ...
Epoch: 5 cost time: 0.44702839851379395
Epoch: 5, Steps: 3 | Train Loss: 1.053 Vali Loss: 1.195 Vali Acc: 0.600 Test Loss: 1.195 Test Acc: 0.600
Validation loss decreased (-0.399987 --> -0.599988).  Saving model ...
Epoch: 6 cost time: 0.49949097633361816
Epoch: 6, Steps: 3 | Train Loss: 0.934 Vali Loss: 1.096 Vali Acc: 0.700 Test Loss: 1.096 Test Acc: 0.700
Validation loss decreased (-0.599988 --> -0.699989).  Saving model ...
Epoch: 7 cost time: 0.5072882175445557
Epoch: 7, Steps: 3 | Train Loss: 0.860 Vali Loss: 0.994 Vali Acc: 0.800 Test Loss: 0.994 Test Acc: 0.800
Validation loss decreased (-0.699989 --> -0.799990).  Saving model ...
Epoch: 8 cost time: 0.4572596549987793
Epoch: 8, Steps: 3 | Train Loss: 0.758 Vali Loss: 0.897 Vali Acc: 0.800 Test Loss: 0.897 Test Acc: 0.800
Validation loss decreased (-0.799990 --> -0.799991).  Saving model ...
Epoch: 9 cost time: 0.47212910652160645
Epoch: 9, Steps: 3 | Train Loss: 0.659 Vali Loss: 0.801 Vali Acc: 0.825 Test Loss: 0.801 Test Acc: 0.825
Validation loss decreased (-0.799991 --> -0.824992).  Saving model ...
Epoch: 10 cost time: 0.44934916496276855
Epoch: 10, Steps: 3 | Train Loss: 0.569 Vali Loss: 0.723 Vali Acc: 0.850 Test Loss: 0.723 Test Acc: 0.850
Validation loss decreased (-0.824992 --> -0.849993).  Saving model ...
Epoch: 11 cost time: 0.45238399505615234
Epoch: 11, Steps: 3 | Train Loss: 0.504 Vali Loss: 0.642 Vali Acc: 0.850 Test Loss: 0.642 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849994).  Saving model ...
Epoch: 12 cost time: 0.5073480606079102
Epoch: 12, Steps: 3 | Train Loss: 0.432 Vali Loss: 0.576 Vali Acc: 0.875 Test Loss: 0.576 Test Acc: 0.875
Validation loss decreased (-0.849994 --> -0.874994).  Saving model ...
Epoch: 13 cost time: 0.46860837936401367
Epoch: 13, Steps: 3 | Train Loss: 0.391 Vali Loss: 0.518 Vali Acc: 0.900 Test Loss: 0.518 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899995).  Saving model ...
Epoch: 14 cost time: 0.466871976852417
Epoch: 14, Steps: 3 | Train Loss: 0.353 Vali Loss: 0.468 Vali Acc: 0.925 Test Loss: 0.468 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924995).  Saving model ...
Epoch: 15 cost time: 0.5364506244659424
Epoch: 15, Steps: 3 | Train Loss: 0.298 Vali Loss: 0.436 Vali Acc: 0.925 Test Loss: 0.436 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 16 cost time: 0.487377405166626
Epoch: 16, Steps: 3 | Train Loss: 0.301 Vali Loss: 0.395 Vali Acc: 0.925 Test Loss: 0.395 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 17 cost time: 0.5731701850891113
Epoch: 17, Steps: 3 | Train Loss: 0.252 Vali Loss: 0.366 Vali Acc: 0.950 Test Loss: 0.366 Test Acc: 0.950
Validation loss decreased (-0.924996 --> -0.949996).  Saving model ...
Epoch: 18 cost time: 0.49201273918151855
Epoch: 18, Steps: 3 | Train Loss: 0.228 Vali Loss: 0.339 Vali Acc: 0.950 Test Loss: 0.339 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 19 cost time: 0.5571932792663574
Epoch: 19, Steps: 3 | Train Loss: 0.166 Vali Loss: 0.311 Vali Acc: 0.950 Test Loss: 0.311 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 20 cost time: 0.516124963760376
Epoch: 20, Steps: 3 | Train Loss: 0.184 Vali Loss: 0.293 Vali Acc: 0.950 Test Loss: 0.293 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 21 cost time: 0.5090820789337158
Epoch: 21, Steps: 3 | Train Loss: 0.157 Vali Loss: 0.293 Vali Acc: 0.950 Test Loss: 0.293 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 22 cost time: 0.48628926277160645
Epoch: 22, Steps: 3 | Train Loss: 0.148 Vali Loss: 0.278 Vali Acc: 0.975 Test Loss: 0.278 Test Acc: 0.975
Validation loss decreased (-0.949997 --> -0.974997).  Saving model ...
Epoch: 23 cost time: 0.4654676914215088
Epoch: 23, Steps: 3 | Train Loss: 0.131 Vali Loss: 0.271 Vali Acc: 0.950 Test Loss: 0.271 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.4702606201171875
Epoch: 24, Steps: 3 | Train Loss: 0.125 Vali Loss: 0.251 Vali Acc: 0.950 Test Loss: 0.251 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.587824821472168
Epoch: 25, Steps: 3 | Train Loss: 0.129 Vali Loss: 0.239 Vali Acc: 0.950 Test Loss: 0.239 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.4719810485839844
Epoch: 26, Steps: 3 | Train Loss: 0.100 Vali Loss: 0.221 Vali Acc: 0.950 Test Loss: 0.221 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.464400053024292
Epoch: 27, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.213 Vali Acc: 0.950 Test Loss: 0.213 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.4527709484100342
Epoch: 28, Steps: 3 | Train Loss: 0.080 Vali Loss: 0.202 Vali Acc: 0.950 Test Loss: 0.202 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.5601949691772461
Epoch: 29, Steps: 3 | Train Loss: 0.063 Vali Loss: 0.201 Vali Acc: 0.950 Test Loss: 0.201 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.4388749599456787
Epoch: 30, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.202 Vali Acc: 0.950 Test Loss: 0.202 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.4047224521636963
Epoch: 31, Steps: 3 | Train Loss: 0.055 Vali Loss: 0.190 Vali Acc: 0.950 Test Loss: 0.190 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.48494791984558105
Epoch: 32, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.178 Vali Acc: 0.950 Test Loss: 0.178 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 1132868
model size : 4.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.8758563995361328
Epoch: 1, Steps: 3 | Train Loss: 1.472 Vali Loss: 1.415 Vali Acc: 0.325 Test Loss: 1.415 Test Acc: 0.325
Validation loss decreased (inf --> -0.324986).  Saving model ...
Epoch: 2 cost time: 0.5047633647918701
Epoch: 2, Steps: 3 | Train Loss: 1.385 Vali Loss: 1.392 Vali Acc: 0.400 Test Loss: 1.392 Test Acc: 0.400
Validation loss decreased (-0.324986 --> -0.399986).  Saving model ...
Epoch: 3 cost time: 0.5581557750701904
Epoch: 3, Steps: 3 | Train Loss: 1.349 Vali Loss: 1.353 Vali Acc: 0.450 Test Loss: 1.353 Test Acc: 0.450
Validation loss decreased (-0.399986 --> -0.449986).  Saving model ...
Epoch: 4 cost time: 0.4324312210083008
Epoch: 4, Steps: 3 | Train Loss: 1.264 Vali Loss: 1.295 Vali Acc: 0.550 Test Loss: 1.295 Test Acc: 0.550
Validation loss decreased (-0.449986 --> -0.549987).  Saving model ...
Epoch: 5 cost time: 0.4926564693450928
Epoch: 5, Steps: 3 | Train Loss: 1.156 Vali Loss: 1.225 Vali Acc: 0.625 Test Loss: 1.225 Test Acc: 0.625
Validation loss decreased (-0.549987 --> -0.624988).  Saving model ...
Epoch: 6 cost time: 0.49527716636657715
Epoch: 6, Steps: 3 | Train Loss: 1.042 Vali Loss: 1.149 Vali Acc: 0.675 Test Loss: 1.149 Test Acc: 0.675
Validation loss decreased (-0.624988 --> -0.674989).  Saving model ...
Epoch: 7 cost time: 0.5749032497406006
Epoch: 7, Steps: 3 | Train Loss: 0.951 Vali Loss: 1.070 Vali Acc: 0.700 Test Loss: 1.070 Test Acc: 0.700
Validation loss decreased (-0.674989 --> -0.699989).  Saving model ...
Epoch: 8 cost time: 0.4235529899597168
Epoch: 8, Steps: 3 | Train Loss: 0.860 Vali Loss: 0.988 Vali Acc: 0.800 Test Loss: 0.988 Test Acc: 0.800
Validation loss decreased (-0.699989 --> -0.799990).  Saving model ...
Epoch: 9 cost time: 0.5517003536224365
Epoch: 9, Steps: 3 | Train Loss: 0.789 Vali Loss: 0.907 Vali Acc: 0.925 Test Loss: 0.907 Test Acc: 0.925
Validation loss decreased (-0.799990 --> -0.924991).  Saving model ...
Epoch: 10 cost time: 0.5421245098114014
Epoch: 10, Steps: 3 | Train Loss: 0.743 Vali Loss: 0.828 Vali Acc: 0.900 Test Loss: 0.828 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5391333103179932
Epoch: 11, Steps: 3 | Train Loss: 0.641 Vali Loss: 0.763 Vali Acc: 0.900 Test Loss: 0.763 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.5008080005645752
Epoch: 12, Steps: 3 | Train Loss: 0.554 Vali Loss: 0.698 Vali Acc: 0.900 Test Loss: 0.698 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.5531313419342041
Epoch: 13, Steps: 3 | Train Loss: 0.489 Vali Loss: 0.644 Vali Acc: 0.900 Test Loss: 0.644 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.5392413139343262
Epoch: 14, Steps: 3 | Train Loss: 0.452 Vali Loss: 0.590 Vali Acc: 0.900 Test Loss: 0.590 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.5670137405395508
Epoch: 15, Steps: 3 | Train Loss: 0.399 Vali Loss: 0.553 Vali Acc: 0.900 Test Loss: 0.553 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.5579068660736084
Epoch: 16, Steps: 3 | Train Loss: 0.355 Vali Loss: 0.522 Vali Acc: 0.925 Test Loss: 0.522 Test Acc: 0.925
Validation loss decreased (-0.924991 --> -0.924995).  Saving model ...
Epoch: 17 cost time: 0.550983190536499
Epoch: 17, Steps: 3 | Train Loss: 0.350 Vali Loss: 0.480 Vali Acc: 0.925 Test Loss: 0.480 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 18 cost time: 0.49393653869628906
Epoch: 18, Steps: 3 | Train Loss: 0.306 Vali Loss: 0.448 Vali Acc: 0.950 Test Loss: 0.448 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949996).  Saving model ...
Epoch: 19 cost time: 0.5082333087921143
Epoch: 19, Steps: 3 | Train Loss: 0.257 Vali Loss: 0.406 Vali Acc: 0.950 Test Loss: 0.406 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 20 cost time: 0.48805832862854004
Epoch: 20, Steps: 3 | Train Loss: 0.254 Vali Loss: 0.381 Vali Acc: 0.950 Test Loss: 0.381 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 21 cost time: 0.4667067527770996
Epoch: 21, Steps: 3 | Train Loss: 0.224 Vali Loss: 0.363 Vali Acc: 0.950 Test Loss: 0.363 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 22 cost time: 0.5298900604248047
Epoch: 22, Steps: 3 | Train Loss: 0.223 Vali Loss: 0.344 Vali Acc: 0.950 Test Loss: 0.344 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 23 cost time: 0.5312068462371826
Epoch: 23, Steps: 3 | Train Loss: 0.208 Vali Loss: 0.325 Vali Acc: 0.950 Test Loss: 0.325 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 24 cost time: 0.5644500255584717
Epoch: 24, Steps: 3 | Train Loss: 0.187 Vali Loss: 0.306 Vali Acc: 0.950 Test Loss: 0.306 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 25 cost time: 0.5267453193664551
Epoch: 25, Steps: 3 | Train Loss: 0.151 Vali Loss: 0.292 Vali Acc: 0.950 Test Loss: 0.292 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 26 cost time: 0.5890195369720459
Epoch: 26, Steps: 3 | Train Loss: 0.153 Vali Loss: 0.284 Vali Acc: 0.950 Test Loss: 0.284 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 27 cost time: 0.46169400215148926
Epoch: 27, Steps: 3 | Train Loss: 0.135 Vali Loss: 0.272 Vali Acc: 0.950 Test Loss: 0.272 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 28 cost time: 0.6020116806030273
Epoch: 28, Steps: 3 | Train Loss: 0.134 Vali Loss: 0.263 Vali Acc: 0.950 Test Loss: 0.263 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 29 cost time: 0.5912675857543945
Epoch: 29, Steps: 3 | Train Loss: 0.108 Vali Loss: 0.260 Vali Acc: 0.950 Test Loss: 0.260 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 30 cost time: 0.6141524314880371
Epoch: 30, Steps: 3 | Train Loss: 0.092 Vali Loss: 0.249 Vali Acc: 0.950 Test Loss: 0.249 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 31 cost time: 0.5914561748504639
Epoch: 31, Steps: 3 | Train Loss: 0.101 Vali Loss: 0.256 Vali Acc: 0.950 Test Loss: 0.256 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.4413478374481201
Epoch: 32, Steps: 3 | Train Loss: 0.080 Vali Loss: 0.240 Vali Acc: 0.950 Test Loss: 0.240 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 33 cost time: 0.5833849906921387
Epoch: 33, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.232 Vali Acc: 0.950 Test Loss: 0.232 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 34 cost time: 0.5524823665618896
Epoch: 34, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.225 Vali Acc: 0.950 Test Loss: 0.225 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 35 cost time: 0.5266447067260742
Epoch: 35, Steps: 3 | Train Loss: 0.061 Vali Loss: 0.227 Vali Acc: 0.950 Test Loss: 0.227 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.5243966579437256
Epoch: 36, Steps: 3 | Train Loss: 0.055 Vali Loss: 0.225 Vali Acc: 0.950 Test Loss: 0.225 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 37 cost time: 0.5244228839874268
Epoch: 37, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.214 Vali Acc: 0.950 Test Loss: 0.214 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 38 cost time: 0.4604029655456543
Epoch: 38, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.209 Vali Acc: 0.950 Test Loss: 0.209 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 39 cost time: 0.5289061069488525
Epoch: 39, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.208 Vali Acc: 0.950 Test Loss: 0.208 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 40 cost time: 0.4727950096130371
Epoch: 40, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.210 Vali Acc: 0.950 Test Loss: 0.210 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.4612891674041748
Epoch: 41, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.214 Vali Acc: 0.950 Test Loss: 0.214 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.6447896957397461
Epoch: 42, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.207 Vali Acc: 0.950 Test Loss: 0.207 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 43 cost time: 0.5215504169464111
Epoch: 43, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.208 Vali Acc: 0.950 Test Loss: 0.208 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.5088677406311035
Epoch: 44, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.212 Vali Acc: 0.950 Test Loss: 0.212 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.5328466892242432
Epoch: 45, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.207 Vali Acc: 0.950 Test Loss: 0.207 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 46 cost time: 0.46712207794189453
Epoch: 46, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.208 Vali Acc: 0.950 Test Loss: 0.208 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.5508317947387695
Epoch: 47, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.211 Vali Acc: 0.950 Test Loss: 0.211 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.4909946918487549
Epoch: 48, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.208 Vali Acc: 0.950 Test Loss: 0.208 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.5831043720245361
Epoch: 49, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.207 Vali Acc: 0.950 Test Loss: 0.207 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 50 cost time: 0.4945797920227051
Epoch: 50, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.208 Vali Acc: 0.950 Test Loss: 0.208 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 1123780
model size : 4.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.8025972843170166
Epoch: 1, Steps: 3 | Train Loss: 1.374 Vali Loss: 1.378 Vali Acc: 0.225 Test Loss: 1.378 Test Acc: 0.225
Validation loss decreased (inf --> -0.224986).  Saving model ...
Epoch: 2 cost time: 0.5021114349365234
Epoch: 2, Steps: 3 | Train Loss: 1.328 Vali Loss: 1.363 Vali Acc: 0.375 Test Loss: 1.363 Test Acc: 0.375
Validation loss decreased (-0.224986 --> -0.374986).  Saving model ...
Epoch: 3 cost time: 0.430283784866333
Epoch: 3, Steps: 3 | Train Loss: 1.282 Vali Loss: 1.338 Vali Acc: 0.400 Test Loss: 1.338 Test Acc: 0.400
Validation loss decreased (-0.374986 --> -0.399987).  Saving model ...
Epoch: 4 cost time: 0.46413087844848633
Epoch: 4, Steps: 3 | Train Loss: 1.244 Vali Loss: 1.300 Vali Acc: 0.425 Test Loss: 1.300 Test Acc: 0.425
Validation loss decreased (-0.399987 --> -0.424987).  Saving model ...
Epoch: 5 cost time: 0.4770541191101074
Epoch: 5, Steps: 3 | Train Loss: 1.189 Vali Loss: 1.251 Vali Acc: 0.475 Test Loss: 1.251 Test Acc: 0.475
Validation loss decreased (-0.424987 --> -0.474987).  Saving model ...
Epoch: 6 cost time: 0.4928908348083496
Epoch: 6, Steps: 3 | Train Loss: 1.148 Vali Loss: 1.195 Vali Acc: 0.550 Test Loss: 1.195 Test Acc: 0.550
Validation loss decreased (-0.474987 --> -0.549988).  Saving model ...
Epoch: 7 cost time: 0.475597620010376
Epoch: 7, Steps: 3 | Train Loss: 1.029 Vali Loss: 1.132 Vali Acc: 0.625 Test Loss: 1.132 Test Acc: 0.625
Validation loss decreased (-0.549988 --> -0.624989).  Saving model ...
Epoch: 8 cost time: 0.5032958984375
Epoch: 8, Steps: 3 | Train Loss: 0.966 Vali Loss: 1.069 Vali Acc: 0.650 Test Loss: 1.069 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649989).  Saving model ...
Epoch: 9 cost time: 0.46212148666381836
Epoch: 9, Steps: 3 | Train Loss: 0.883 Vali Loss: 1.004 Vali Acc: 0.650 Test Loss: 1.004 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649990).  Saving model ...
Epoch: 10 cost time: 0.45413899421691895
Epoch: 10, Steps: 3 | Train Loss: 0.805 Vali Loss: 0.942 Vali Acc: 0.750 Test Loss: 0.942 Test Acc: 0.750
Validation loss decreased (-0.649990 --> -0.749991).  Saving model ...
Epoch: 11 cost time: 0.4927988052368164
Epoch: 11, Steps: 3 | Train Loss: 0.784 Vali Loss: 0.869 Vali Acc: 0.875 Test Loss: 0.869 Test Acc: 0.875
Validation loss decreased (-0.749991 --> -0.874991).  Saving model ...
Epoch: 12 cost time: 0.5552730560302734
Epoch: 12, Steps: 3 | Train Loss: 0.700 Vali Loss: 0.809 Vali Acc: 0.875 Test Loss: 0.809 Test Acc: 0.875
Validation loss decreased (-0.874991 --> -0.874992).  Saving model ...
Epoch: 13 cost time: 0.4880380630493164
Epoch: 13, Steps: 3 | Train Loss: 0.645 Vali Loss: 0.755 Vali Acc: 0.925 Test Loss: 0.755 Test Acc: 0.925
Validation loss decreased (-0.874992 --> -0.924992).  Saving model ...
Epoch: 14 cost time: 0.48358654975891113
Epoch: 14, Steps: 3 | Train Loss: 0.593 Vali Loss: 0.704 Vali Acc: 0.950 Test Loss: 0.704 Test Acc: 0.950
Validation loss decreased (-0.924992 --> -0.949993).  Saving model ...
Epoch: 15 cost time: 0.5145931243896484
Epoch: 15, Steps: 3 | Train Loss: 0.562 Vali Loss: 0.651 Vali Acc: 0.950 Test Loss: 0.651 Test Acc: 0.950
Validation loss decreased (-0.949993 --> -0.949993).  Saving model ...
Epoch: 16 cost time: 0.46669816970825195
Epoch: 16, Steps: 3 | Train Loss: 0.508 Vali Loss: 0.607 Vali Acc: 0.950 Test Loss: 0.607 Test Acc: 0.950
Validation loss decreased (-0.949993 --> -0.949994).  Saving model ...
Epoch: 17 cost time: 0.4650425910949707
Epoch: 17, Steps: 3 | Train Loss: 0.457 Vali Loss: 0.573 Vali Acc: 0.950 Test Loss: 0.573 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949994).  Saving model ...
Epoch: 18 cost time: 0.4905056953430176
Epoch: 18, Steps: 3 | Train Loss: 0.428 Vali Loss: 0.536 Vali Acc: 0.950 Test Loss: 0.536 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 19 cost time: 0.4611797332763672
Epoch: 19, Steps: 3 | Train Loss: 0.388 Vali Loss: 0.515 Vali Acc: 0.950 Test Loss: 0.515 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 20 cost time: 0.4819498062133789
Epoch: 20, Steps: 3 | Train Loss: 0.369 Vali Loss: 0.491 Vali Acc: 0.950 Test Loss: 0.491 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 21 cost time: 0.4734485149383545
Epoch: 21, Steps: 3 | Train Loss: 0.318 Vali Loss: 0.460 Vali Acc: 0.950 Test Loss: 0.460 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 22 cost time: 0.4725790023803711
Epoch: 22, Steps: 3 | Train Loss: 0.292 Vali Loss: 0.441 Vali Acc: 0.950 Test Loss: 0.441 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 23 cost time: 0.4653940200805664
Epoch: 23, Steps: 3 | Train Loss: 0.271 Vali Loss: 0.417 Vali Acc: 0.950 Test Loss: 0.417 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 24 cost time: 0.4408104419708252
Epoch: 24, Steps: 3 | Train Loss: 0.278 Vali Loss: 0.397 Vali Acc: 0.950 Test Loss: 0.397 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 25 cost time: 0.4298579692840576
Epoch: 25, Steps: 3 | Train Loss: 0.270 Vali Loss: 0.372 Vali Acc: 0.950 Test Loss: 0.372 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 26 cost time: 0.437345027923584
Epoch: 26, Steps: 3 | Train Loss: 0.229 Vali Loss: 0.347 Vali Acc: 0.950 Test Loss: 0.347 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 27 cost time: 0.47171568870544434
Epoch: 27, Steps: 3 | Train Loss: 0.220 Vali Loss: 0.333 Vali Acc: 0.950 Test Loss: 0.333 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 28 cost time: 0.45209622383117676
Epoch: 28, Steps: 3 | Train Loss: 0.203 Vali Loss: 0.319 Vali Acc: 0.975 Test Loss: 0.319 Test Acc: 0.975
Validation loss decreased (-0.949997 --> -0.974997).  Saving model ...
Epoch: 29 cost time: 0.4239826202392578
Epoch: 29, Steps: 3 | Train Loss: 0.188 Vali Loss: 0.305 Vali Acc: 0.975 Test Loss: 0.305 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 30 cost time: 0.420698881149292
Epoch: 30, Steps: 3 | Train Loss: 0.166 Vali Loss: 0.290 Vali Acc: 0.975 Test Loss: 0.290 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 31 cost time: 0.41959357261657715
Epoch: 31, Steps: 3 | Train Loss: 0.172 Vali Loss: 0.282 Vali Acc: 0.975 Test Loss: 0.282 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 32 cost time: 0.46016955375671387
Epoch: 32, Steps: 3 | Train Loss: 0.158 Vali Loss: 0.277 Vali Acc: 0.975 Test Loss: 0.277 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 33 cost time: 0.524669885635376
Epoch: 33, Steps: 3 | Train Loss: 0.145 Vali Loss: 0.267 Vali Acc: 0.975 Test Loss: 0.267 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 34 cost time: 0.48204660415649414
Epoch: 34, Steps: 3 | Train Loss: 0.106 Vali Loss: 0.256 Vali Acc: 0.975 Test Loss: 0.256 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 35 cost time: 0.4245274066925049
Epoch: 35, Steps: 3 | Train Loss: 0.110 Vali Loss: 0.246 Vali Acc: 0.975 Test Loss: 0.246 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 36 cost time: 0.4496734142303467
Epoch: 36, Steps: 3 | Train Loss: 0.087 Vali Loss: 0.234 Vali Acc: 0.975 Test Loss: 0.234 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 37 cost time: 0.4487168788909912
Epoch: 37, Steps: 3 | Train Loss: 0.091 Vali Loss: 0.225 Vali Acc: 0.975 Test Loss: 0.225 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 38 cost time: 0.46591997146606445
Epoch: 38, Steps: 3 | Train Loss: 0.095 Vali Loss: 0.224 Vali Acc: 0.975 Test Loss: 0.224 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 39 cost time: 0.4938833713531494
Epoch: 39, Steps: 3 | Train Loss: 0.081 Vali Loss: 0.219 Vali Acc: 0.975 Test Loss: 0.219 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 40 cost time: 0.5312144756317139
Epoch: 40, Steps: 3 | Train Loss: 0.070 Vali Loss: 0.207 Vali Acc: 0.975 Test Loss: 0.207 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 41 cost time: 0.4769103527069092
Epoch: 41, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.203 Vali Acc: 0.975 Test Loss: 0.203 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 42 cost time: 0.5323526859283447
Epoch: 42, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.191 Vali Acc: 0.975 Test Loss: 0.191 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 43 cost time: 0.5085203647613525
Epoch: 43, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.191 Vali Acc: 0.975 Test Loss: 0.191 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 44 cost time: 0.5053086280822754
Epoch: 44, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.197 Vali Acc: 0.975 Test Loss: 0.197 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.4882032871246338
Epoch: 45, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.194 Vali Acc: 0.975 Test Loss: 0.194 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.4264199733734131
Epoch: 46, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.189 Vali Acc: 0.975 Test Loss: 0.189 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 47 cost time: 0.5370612144470215
Epoch: 47, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.184 Vali Acc: 0.950 Test Loss: 0.184 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.49681758880615234
Epoch: 48, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.188 Vali Acc: 0.950 Test Loss: 0.188 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.49672937393188477
Epoch: 49, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.178 Vali Acc: 0.950 Test Loss: 0.178 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.5343189239501953
Epoch: 50, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.174 Vali Acc: 0.950 Test Loss: 0.174 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 1111812
model size : 4.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps20_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.6349475383758545
Epoch: 1, Steps: 3 | Train Loss: 1.358 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 0.44466376304626465
Epoch: 2, Steps: 3 | Train Loss: 1.336 Vali Loss: 1.372 Vali Acc: 0.275 Test Loss: 1.372 Test Acc: 0.275
Validation loss decreased (-0.249986 --> -0.274986).  Saving model ...
Epoch: 3 cost time: 0.47251129150390625
Epoch: 3, Steps: 3 | Train Loss: 1.323 Vali Loss: 1.350 Vali Acc: 0.350 Test Loss: 1.350 Test Acc: 0.350
Validation loss decreased (-0.274986 --> -0.349986).  Saving model ...
Epoch: 4 cost time: 0.44600987434387207
Epoch: 4, Steps: 3 | Train Loss: 1.244 Vali Loss: 1.319 Vali Acc: 0.425 Test Loss: 1.319 Test Acc: 0.425
Validation loss decreased (-0.349986 --> -0.424987).  Saving model ...
Epoch: 5 cost time: 0.42848968505859375
Epoch: 5, Steps: 3 | Train Loss: 1.203 Vali Loss: 1.278 Vali Acc: 0.525 Test Loss: 1.278 Test Acc: 0.525
Validation loss decreased (-0.424987 --> -0.524987).  Saving model ...
Epoch: 6 cost time: 0.44990015029907227
Epoch: 6, Steps: 3 | Train Loss: 1.145 Vali Loss: 1.229 Vali Acc: 0.550 Test Loss: 1.229 Test Acc: 0.550
Validation loss decreased (-0.524987 --> -0.549988).  Saving model ...
Epoch: 7 cost time: 0.44934701919555664
Epoch: 7, Steps: 3 | Train Loss: 1.053 Vali Loss: 1.179 Vali Acc: 0.575 Test Loss: 1.179 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574988).  Saving model ...
Epoch: 8 cost time: 0.4932096004486084
Epoch: 8, Steps: 3 | Train Loss: 1.020 Vali Loss: 1.123 Vali Acc: 0.575 Test Loss: 1.123 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574989).  Saving model ...
Epoch: 9 cost time: 0.4822394847869873
Epoch: 9, Steps: 3 | Train Loss: 0.948 Vali Loss: 1.069 Vali Acc: 0.600 Test Loss: 1.069 Test Acc: 0.600
Validation loss decreased (-0.574989 --> -0.599989).  Saving model ...
Epoch: 10 cost time: 0.45590686798095703
Epoch: 10, Steps: 3 | Train Loss: 0.876 Vali Loss: 1.011 Vali Acc: 0.675 Test Loss: 1.011 Test Acc: 0.675
Validation loss decreased (-0.599989 --> -0.674990).  Saving model ...
Epoch: 11 cost time: 0.4392869472503662
Epoch: 11, Steps: 3 | Train Loss: 0.804 Vali Loss: 0.953 Vali Acc: 0.725 Test Loss: 0.953 Test Acc: 0.725
Validation loss decreased (-0.674990 --> -0.724990).  Saving model ...
Epoch: 12 cost time: 0.49741148948669434
Epoch: 12, Steps: 3 | Train Loss: 0.751 Vali Loss: 0.906 Vali Acc: 0.850 Test Loss: 0.906 Test Acc: 0.850
Validation loss decreased (-0.724990 --> -0.849991).  Saving model ...
Epoch: 13 cost time: 0.511892557144165
Epoch: 13, Steps: 3 | Train Loss: 0.681 Vali Loss: 0.856 Vali Acc: 0.900 Test Loss: 0.856 Test Acc: 0.900
Validation loss decreased (-0.849991 --> -0.899991).  Saving model ...
Epoch: 14 cost time: 0.46538424491882324
Epoch: 14, Steps: 3 | Train Loss: 0.667 Vali Loss: 0.799 Vali Acc: 0.900 Test Loss: 0.799 Test Acc: 0.900
Validation loss decreased (-0.899991 --> -0.899992).  Saving model ...
Epoch: 15 cost time: 0.4214060306549072
Epoch: 15, Steps: 3 | Train Loss: 0.618 Vali Loss: 0.757 Vali Acc: 0.875 Test Loss: 0.757 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.46214914321899414
Epoch: 16, Steps: 3 | Train Loss: 0.572 Vali Loss: 0.723 Vali Acc: 0.875 Test Loss: 0.723 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.4867746829986572
Epoch: 17, Steps: 3 | Train Loss: 0.518 Vali Loss: 0.683 Vali Acc: 0.825 Test Loss: 0.683 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.4674053192138672
Epoch: 18, Steps: 3 | Train Loss: 0.509 Vali Loss: 0.640 Vali Acc: 0.850 Test Loss: 0.640 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.4731907844543457
Epoch: 19, Steps: 3 | Train Loss: 0.463 Vali Loss: 0.608 Vali Acc: 0.875 Test Loss: 0.608 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.498640775680542
Epoch: 20, Steps: 3 | Train Loss: 0.427 Vali Loss: 0.566 Vali Acc: 0.875 Test Loss: 0.566 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.5202662944793701
Epoch: 21, Steps: 3 | Train Loss: 0.404 Vali Loss: 0.540 Vali Acc: 0.900 Test Loss: 0.540 Test Acc: 0.900
Validation loss decreased (-0.899992 --> -0.899995).  Saving model ...
Epoch: 22 cost time: 0.4663362503051758
Epoch: 22, Steps: 3 | Train Loss: 0.364 Vali Loss: 0.520 Vali Acc: 0.900 Test Loss: 0.520 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 23 cost time: 0.4921586513519287
Epoch: 23, Steps: 3 | Train Loss: 0.366 Vali Loss: 0.491 Vali Acc: 0.925 Test Loss: 0.491 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924995).  Saving model ...
Epoch: 24 cost time: 0.49967122077941895
Epoch: 24, Steps: 3 | Train Loss: 0.322 Vali Loss: 0.471 Vali Acc: 0.925 Test Loss: 0.471 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 25 cost time: 0.5364530086517334
Epoch: 25, Steps: 3 | Train Loss: 0.313 Vali Loss: 0.451 Vali Acc: 0.925 Test Loss: 0.451 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 26 cost time: 0.5329716205596924
Epoch: 26, Steps: 3 | Train Loss: 0.323 Vali Loss: 0.420 Vali Acc: 0.925 Test Loss: 0.420 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 27 cost time: 0.4838297367095947
Epoch: 27, Steps: 3 | Train Loss: 0.262 Vali Loss: 0.403 Vali Acc: 0.925 Test Loss: 0.403 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 28 cost time: 0.4956986904144287
Epoch: 28, Steps: 3 | Train Loss: 0.250 Vali Loss: 0.390 Vali Acc: 0.950 Test Loss: 0.390 Test Acc: 0.950
Validation loss decreased (-0.924996 --> -0.949996).  Saving model ...
Epoch: 29 cost time: 0.4792306423187256
Epoch: 29, Steps: 3 | Train Loss: 0.230 Vali Loss: 0.383 Vali Acc: 0.950 Test Loss: 0.383 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 30 cost time: 0.4509239196777344
Epoch: 30, Steps: 3 | Train Loss: 0.244 Vali Loss: 0.370 Vali Acc: 0.950 Test Loss: 0.370 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 31 cost time: 0.44630932807922363
Epoch: 31, Steps: 3 | Train Loss: 0.225 Vali Loss: 0.349 Vali Acc: 0.950 Test Loss: 0.349 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 32 cost time: 0.4764683246612549
Epoch: 32, Steps: 3 | Train Loss: 0.202 Vali Loss: 0.330 Vali Acc: 0.950 Test Loss: 0.330 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 33 cost time: 0.47690391540527344
Epoch: 33, Steps: 3 | Train Loss: 0.192 Vali Loss: 0.313 Vali Acc: 0.950 Test Loss: 0.313 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 34 cost time: 0.5011889934539795
Epoch: 34, Steps: 3 | Train Loss: 0.182 Vali Loss: 0.300 Vali Acc: 0.950 Test Loss: 0.300 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 35 cost time: 0.446155309677124
Epoch: 35, Steps: 3 | Train Loss: 0.172 Vali Loss: 0.287 Vali Acc: 0.950 Test Loss: 0.287 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 36 cost time: 0.40916919708251953
Epoch: 36, Steps: 3 | Train Loss: 0.154 Vali Loss: 0.281 Vali Acc: 0.950 Test Loss: 0.281 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 37 cost time: 0.46933746337890625
Epoch: 37, Steps: 3 | Train Loss: 0.129 Vali Loss: 0.263 Vali Acc: 0.950 Test Loss: 0.263 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 38 cost time: 0.5171835422515869
Epoch: 38, Steps: 3 | Train Loss: 0.156 Vali Loss: 0.256 Vali Acc: 0.950 Test Loss: 0.256 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 39 cost time: 0.4593639373779297
Epoch: 39, Steps: 3 | Train Loss: 0.135 Vali Loss: 0.249 Vali Acc: 0.950 Test Loss: 0.249 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 40 cost time: 0.44436192512512207
Epoch: 40, Steps: 3 | Train Loss: 0.116 Vali Loss: 0.239 Vali Acc: 0.950 Test Loss: 0.239 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 41 cost time: 0.44300150871276855
Epoch: 41, Steps: 3 | Train Loss: 0.108 Vali Loss: 0.231 Vali Acc: 0.950 Test Loss: 0.231 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 42 cost time: 0.5026509761810303
Epoch: 42, Steps: 3 | Train Loss: 0.107 Vali Loss: 0.225 Vali Acc: 0.950 Test Loss: 0.225 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 43 cost time: 0.42082929611206055
Epoch: 43, Steps: 3 | Train Loss: 0.071 Vali Loss: 0.211 Vali Acc: 0.950 Test Loss: 0.211 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 44 cost time: 0.608931303024292
Epoch: 44, Steps: 3 | Train Loss: 0.074 Vali Loss: 0.206 Vali Acc: 0.950 Test Loss: 0.206 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 45 cost time: 0.5136725902557373
Epoch: 45, Steps: 3 | Train Loss: 0.090 Vali Loss: 0.206 Vali Acc: 0.950 Test Loss: 0.206 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.4877490997314453
Epoch: 46, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.204 Vali Acc: 0.950 Test Loss: 0.204 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 47 cost time: 0.40480709075927734
Epoch: 47, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.198 Vali Acc: 0.975 Test Loss: 0.198 Test Acc: 0.975
Validation loss decreased (-0.949998 --> -0.974998).  Saving model ...
Epoch: 48 cost time: 0.4681065082550049
Epoch: 48, Steps: 3 | Train Loss: 0.058 Vali Loss: 0.192 Vali Acc: 0.975 Test Loss: 0.192 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 49 cost time: 0.4320204257965088
Epoch: 49, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.190 Vali Acc: 0.975 Test Loss: 0.190 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 50 cost time: 0.5060467720031738
Epoch: 50, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.183 Vali Acc: 0.975 Test Loss: 0.183 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps20_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 1109060
model size : 4.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps25_str13_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.7284679412841797
Epoch: 1, Steps: 3 | Train Loss: 1.485 Vali Loss: 1.430 Vali Acc: 0.150 Test Loss: 1.430 Test Acc: 0.150
Validation loss decreased (inf --> -0.149986).  Saving model ...
Epoch: 2 cost time: 0.4515254497528076
Epoch: 2, Steps: 3 | Train Loss: 1.473 Vali Loss: 1.421 Vali Acc: 0.150 Test Loss: 1.421 Test Acc: 0.150
Validation loss decreased (-0.149986 --> -0.149986).  Saving model ...
Epoch: 3 cost time: 0.47214388847351074
Epoch: 3, Steps: 3 | Train Loss: 1.382 Vali Loss: 1.407 Vali Acc: 0.150 Test Loss: 1.407 Test Acc: 0.150
Validation loss decreased (-0.149986 --> -0.149986).  Saving model ...
Epoch: 4 cost time: 0.48207855224609375
Epoch: 4, Steps: 3 | Train Loss: 1.367 Vali Loss: 1.384 Vali Acc: 0.200 Test Loss: 1.384 Test Acc: 0.200
Validation loss decreased (-0.149986 --> -0.199986).  Saving model ...
Epoch: 5 cost time: 0.46312737464904785
Epoch: 5, Steps: 3 | Train Loss: 1.311 Vali Loss: 1.352 Vali Acc: 0.225 Test Loss: 1.352 Test Acc: 0.225
Validation loss decreased (-0.199986 --> -0.224986).  Saving model ...
Epoch: 6 cost time: 0.5067300796508789
Epoch: 6, Steps: 3 | Train Loss: 1.253 Vali Loss: 1.315 Vali Acc: 0.275 Test Loss: 1.315 Test Acc: 0.275
Validation loss decreased (-0.224986 --> -0.274987).  Saving model ...
Epoch: 7 cost time: 0.45465755462646484
Epoch: 7, Steps: 3 | Train Loss: 1.245 Vali Loss: 1.270 Vali Acc: 0.300 Test Loss: 1.270 Test Acc: 0.300
Validation loss decreased (-0.274987 --> -0.299987).  Saving model ...
Epoch: 8 cost time: 0.5087339878082275
Epoch: 8, Steps: 3 | Train Loss: 1.105 Vali Loss: 1.225 Vali Acc: 0.350 Test Loss: 1.225 Test Acc: 0.350
Validation loss decreased (-0.299987 --> -0.349988).  Saving model ...
Epoch: 9 cost time: 0.47368788719177246
Epoch: 9, Steps: 3 | Train Loss: 1.081 Vali Loss: 1.172 Vali Acc: 0.400 Test Loss: 1.172 Test Acc: 0.400
Validation loss decreased (-0.349988 --> -0.399988).  Saving model ...
Epoch: 10 cost time: 0.46337342262268066
Epoch: 10, Steps: 3 | Train Loss: 0.995 Vali Loss: 1.121 Vali Acc: 0.600 Test Loss: 1.121 Test Acc: 0.600
Validation loss decreased (-0.399988 --> -0.599989).  Saving model ...
Epoch: 11 cost time: 0.5232400894165039
Epoch: 11, Steps: 3 | Train Loss: 0.936 Vali Loss: 1.072 Vali Acc: 0.725 Test Loss: 1.072 Test Acc: 0.725
Validation loss decreased (-0.599989 --> -0.724989).  Saving model ...
Epoch: 12 cost time: 0.4630403518676758
Epoch: 12, Steps: 3 | Train Loss: 0.864 Vali Loss: 1.019 Vali Acc: 0.750 Test Loss: 1.019 Test Acc: 0.750
Validation loss decreased (-0.724989 --> -0.749990).  Saving model ...
Epoch: 13 cost time: 0.5115797519683838
Epoch: 13, Steps: 3 | Train Loss: 0.847 Vali Loss: 0.971 Vali Acc: 0.825 Test Loss: 0.971 Test Acc: 0.825
Validation loss decreased (-0.749990 --> -0.824990).  Saving model ...
Epoch: 14 cost time: 0.4598124027252197
Epoch: 14, Steps: 3 | Train Loss: 0.801 Vali Loss: 0.921 Vali Acc: 0.875 Test Loss: 0.921 Test Acc: 0.875
Validation loss decreased (-0.824990 --> -0.874991).  Saving model ...
Epoch: 15 cost time: 0.48257875442504883
Epoch: 15, Steps: 3 | Train Loss: 0.730 Vali Loss: 0.885 Vali Acc: 0.900 Test Loss: 0.885 Test Acc: 0.900
Validation loss decreased (-0.874991 --> -0.899991).  Saving model ...
Epoch: 16 cost time: 0.42980384826660156
Epoch: 16, Steps: 3 | Train Loss: 0.690 Vali Loss: 0.852 Vali Acc: 0.900 Test Loss: 0.852 Test Acc: 0.900
Validation loss decreased (-0.899991 --> -0.899991).  Saving model ...
Epoch: 17 cost time: 0.43641042709350586
Epoch: 17, Steps: 3 | Train Loss: 0.613 Vali Loss: 0.823 Vali Acc: 0.900 Test Loss: 0.823 Test Acc: 0.900
Validation loss decreased (-0.899991 --> -0.899992).  Saving model ...
Epoch: 18 cost time: 0.45048999786376953
Epoch: 18, Steps: 3 | Train Loss: 0.558 Vali Loss: 0.792 Vali Acc: 0.900 Test Loss: 0.792 Test Acc: 0.900
Validation loss decreased (-0.899992 --> -0.899992).  Saving model ...
Epoch: 19 cost time: 0.5089797973632812
Epoch: 19, Steps: 3 | Train Loss: 0.576 Vali Loss: 0.753 Vali Acc: 0.900 Test Loss: 0.753 Test Acc: 0.900
Validation loss decreased (-0.899992 --> -0.899992).  Saving model ...
Epoch: 20 cost time: 0.445265531539917
Epoch: 20, Steps: 3 | Train Loss: 0.520 Vali Loss: 0.728 Vali Acc: 0.900 Test Loss: 0.728 Test Acc: 0.900
Validation loss decreased (-0.899992 --> -0.899993).  Saving model ...
Epoch: 21 cost time: 0.4183194637298584
Epoch: 21, Steps: 3 | Train Loss: 0.481 Vali Loss: 0.687 Vali Acc: 0.925 Test Loss: 0.687 Test Acc: 0.925
Validation loss decreased (-0.899993 --> -0.924993).  Saving model ...
Epoch: 22 cost time: 0.4136176109313965
Epoch: 22, Steps: 3 | Train Loss: 0.455 Vali Loss: 0.650 Vali Acc: 0.925 Test Loss: 0.650 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924994).  Saving model ...
Epoch: 23 cost time: 0.44133448600769043
Epoch: 23, Steps: 3 | Train Loss: 0.419 Vali Loss: 0.621 Vali Acc: 0.925 Test Loss: 0.621 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 24 cost time: 0.49456310272216797
Epoch: 24, Steps: 3 | Train Loss: 0.389 Vali Loss: 0.597 Vali Acc: 0.925 Test Loss: 0.597 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 25 cost time: 0.5101461410522461
Epoch: 25, Steps: 3 | Train Loss: 0.367 Vali Loss: 0.577 Vali Acc: 0.925 Test Loss: 0.577 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 26 cost time: 0.44307374954223633
Epoch: 26, Steps: 3 | Train Loss: 0.334 Vali Loss: 0.565 Vali Acc: 0.925 Test Loss: 0.565 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 27 cost time: 0.4468107223510742
Epoch: 27, Steps: 3 | Train Loss: 0.324 Vali Loss: 0.539 Vali Acc: 0.925 Test Loss: 0.539 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 28 cost time: 0.5065486431121826
Epoch: 28, Steps: 3 | Train Loss: 0.299 Vali Loss: 0.525 Vali Acc: 0.925 Test Loss: 0.525 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 29 cost time: 0.49754810333251953
Epoch: 29, Steps: 3 | Train Loss: 0.310 Vali Loss: 0.496 Vali Acc: 0.925 Test Loss: 0.496 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 30 cost time: 0.5231504440307617
Epoch: 30, Steps: 3 | Train Loss: 0.260 Vali Loss: 0.469 Vali Acc: 0.925 Test Loss: 0.469 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 31 cost time: 0.5094485282897949
Epoch: 31, Steps: 3 | Train Loss: 0.240 Vali Loss: 0.450 Vali Acc: 0.925 Test Loss: 0.450 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 32 cost time: 0.5431618690490723
Epoch: 32, Steps: 3 | Train Loss: 0.232 Vali Loss: 0.436 Vali Acc: 0.925 Test Loss: 0.436 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 33 cost time: 0.45873212814331055
Epoch: 33, Steps: 3 | Train Loss: 0.201 Vali Loss: 0.415 Vali Acc: 0.925 Test Loss: 0.415 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 34 cost time: 0.5102877616882324
Epoch: 34, Steps: 3 | Train Loss: 0.202 Vali Loss: 0.406 Vali Acc: 0.925 Test Loss: 0.406 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 35 cost time: 0.4682650566101074
Epoch: 35, Steps: 3 | Train Loss: 0.199 Vali Loss: 0.392 Vali Acc: 0.925 Test Loss: 0.392 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 36 cost time: 0.48148632049560547
Epoch: 36, Steps: 3 | Train Loss: 0.172 Vali Loss: 0.377 Vali Acc: 0.925 Test Loss: 0.377 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 37 cost time: 0.490039587020874
Epoch: 37, Steps: 3 | Train Loss: 0.172 Vali Loss: 0.363 Vali Acc: 0.925 Test Loss: 0.363 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 38 cost time: 0.5395970344543457
Epoch: 38, Steps: 3 | Train Loss: 0.148 Vali Loss: 0.359 Vali Acc: 0.925 Test Loss: 0.359 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 39 cost time: 0.48766350746154785
Epoch: 39, Steps: 3 | Train Loss: 0.170 Vali Loss: 0.348 Vali Acc: 0.925 Test Loss: 0.348 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924997).  Saving model ...
Epoch: 40 cost time: 0.47702527046203613
Epoch: 40, Steps: 3 | Train Loss: 0.126 Vali Loss: 0.340 Vali Acc: 0.925 Test Loss: 0.340 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 41 cost time: 0.4964115619659424
Epoch: 41, Steps: 3 | Train Loss: 0.117 Vali Loss: 0.337 Vali Acc: 0.925 Test Loss: 0.337 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 42 cost time: 0.4373953342437744
Epoch: 42, Steps: 3 | Train Loss: 0.102 Vali Loss: 0.324 Vali Acc: 0.925 Test Loss: 0.324 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 43 cost time: 0.4891018867492676
Epoch: 43, Steps: 3 | Train Loss: 0.131 Vali Loss: 0.317 Vali Acc: 0.925 Test Loss: 0.317 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 44 cost time: 0.4721076488494873
Epoch: 44, Steps: 3 | Train Loss: 0.108 Vali Loss: 0.313 Vali Acc: 0.925 Test Loss: 0.313 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 45 cost time: 0.5461604595184326
Epoch: 45, Steps: 3 | Train Loss: 0.091 Vali Loss: 0.308 Vali Acc: 0.925 Test Loss: 0.308 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 46 cost time: 0.5388624668121338
Epoch: 46, Steps: 3 | Train Loss: 0.085 Vali Loss: 0.302 Vali Acc: 0.925 Test Loss: 0.302 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 47 cost time: 0.4662184715270996
Epoch: 47, Steps: 3 | Train Loss: 0.104 Vali Loss: 0.299 Vali Acc: 0.925 Test Loss: 0.299 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 48 cost time: 0.42487072944641113
Epoch: 48, Steps: 3 | Train Loss: 0.063 Vali Loss: 0.292 Vali Acc: 0.925 Test Loss: 0.292 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 49 cost time: 0.47460460662841797
Epoch: 49, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.289 Vali Acc: 0.925 Test Loss: 0.289 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 50 cost time: 0.4849131107330322
Epoch: 50, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.279 Vali Acc: 0.925 Test Loss: 0.279 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps25_str13_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 1106308
model size : 4.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.7370917797088623
Epoch: 1, Steps: 3 | Train Loss: 1.371 Vali Loss: 1.359 Vali Acc: 0.250 Test Loss: 1.359 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 0.5160560607910156
Epoch: 2, Steps: 3 | Train Loss: 1.319 Vali Loss: 1.339 Vali Acc: 0.275 Test Loss: 1.339 Test Acc: 0.275
Validation loss decreased (-0.249986 --> -0.274987).  Saving model ...
Epoch: 3 cost time: 0.46041393280029297
Epoch: 3, Steps: 3 | Train Loss: 1.279 Vali Loss: 1.305 Vali Acc: 0.350 Test Loss: 1.305 Test Acc: 0.350
Validation loss decreased (-0.274987 --> -0.349987).  Saving model ...
Epoch: 4 cost time: 0.5447206497192383
Epoch: 4, Steps: 3 | Train Loss: 1.209 Vali Loss: 1.253 Vali Acc: 0.525 Test Loss: 1.253 Test Acc: 0.525
Validation loss decreased (-0.349987 --> -0.524987).  Saving model ...
Epoch: 5 cost time: 0.4710872173309326
Epoch: 5, Steps: 3 | Train Loss: 1.123 Vali Loss: 1.189 Vali Acc: 0.750 Test Loss: 1.189 Test Acc: 0.750
Validation loss decreased (-0.524987 --> -0.749988).  Saving model ...
Epoch: 6 cost time: 0.49105310440063477
Epoch: 6, Steps: 3 | Train Loss: 1.040 Vali Loss: 1.115 Vali Acc: 0.875 Test Loss: 1.115 Test Acc: 0.875
Validation loss decreased (-0.749988 --> -0.874989).  Saving model ...
Epoch: 7 cost time: 0.48625802993774414
Epoch: 7, Steps: 3 | Train Loss: 0.939 Vali Loss: 1.036 Vali Acc: 0.900 Test Loss: 1.036 Test Acc: 0.900
Validation loss decreased (-0.874989 --> -0.899990).  Saving model ...
Epoch: 8 cost time: 0.46491408348083496
Epoch: 8, Steps: 3 | Train Loss: 0.865 Vali Loss: 0.958 Vali Acc: 0.925 Test Loss: 0.958 Test Acc: 0.925
Validation loss decreased (-0.899990 --> -0.924990).  Saving model ...
Epoch: 9 cost time: 0.4302055835723877
Epoch: 9, Steps: 3 | Train Loss: 0.759 Vali Loss: 0.889 Vali Acc: 0.925 Test Loss: 0.889 Test Acc: 0.925
Validation loss decreased (-0.924990 --> -0.924991).  Saving model ...
Epoch: 10 cost time: 0.5568454265594482
Epoch: 10, Steps: 3 | Train Loss: 0.676 Vali Loss: 0.806 Vali Acc: 0.925 Test Loss: 0.806 Test Acc: 0.925
Validation loss decreased (-0.924991 --> -0.924992).  Saving model ...
Epoch: 11 cost time: 0.46459054946899414
Epoch: 11, Steps: 3 | Train Loss: 0.629 Vali Loss: 0.729 Vali Acc: 0.925 Test Loss: 0.729 Test Acc: 0.925
Validation loss decreased (-0.924992 --> -0.924993).  Saving model ...
Epoch: 12 cost time: 0.48618006706237793
Epoch: 12, Steps: 3 | Train Loss: 0.526 Vali Loss: 0.667 Vali Acc: 0.925 Test Loss: 0.667 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924993).  Saving model ...
Epoch: 13 cost time: 0.4335653781890869
Epoch: 13, Steps: 3 | Train Loss: 0.479 Vali Loss: 0.612 Vali Acc: 0.925 Test Loss: 0.612 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924994).  Saving model ...
Epoch: 14 cost time: 0.4817986488342285
Epoch: 14, Steps: 3 | Train Loss: 0.428 Vali Loss: 0.557 Vali Acc: 0.925 Test Loss: 0.557 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 15 cost time: 0.4425356388092041
Epoch: 15, Steps: 3 | Train Loss: 0.371 Vali Loss: 0.510 Vali Acc: 0.925 Test Loss: 0.510 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 16 cost time: 0.5288500785827637
Epoch: 16, Steps: 3 | Train Loss: 0.323 Vali Loss: 0.485 Vali Acc: 0.925 Test Loss: 0.485 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 17 cost time: 0.545393705368042
Epoch: 17, Steps: 3 | Train Loss: 0.312 Vali Loss: 0.452 Vali Acc: 0.925 Test Loss: 0.452 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 18 cost time: 0.43297410011291504
Epoch: 18, Steps: 3 | Train Loss: 0.252 Vali Loss: 0.427 Vali Acc: 0.925 Test Loss: 0.427 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 19 cost time: 0.4567885398864746
Epoch: 19, Steps: 3 | Train Loss: 0.280 Vali Loss: 0.398 Vali Acc: 0.925 Test Loss: 0.398 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 20 cost time: 0.46126484870910645
Epoch: 20, Steps: 3 | Train Loss: 0.224 Vali Loss: 0.378 Vali Acc: 0.925 Test Loss: 0.378 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 21 cost time: 0.452634334564209
Epoch: 21, Steps: 3 | Train Loss: 0.211 Vali Loss: 0.361 Vali Acc: 0.950 Test Loss: 0.361 Test Acc: 0.950
Validation loss decreased (-0.924996 --> -0.949996).  Saving model ...
Epoch: 22 cost time: 0.41786670684814453
Epoch: 22, Steps: 3 | Train Loss: 0.194 Vali Loss: 0.330 Vali Acc: 0.950 Test Loss: 0.330 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 23 cost time: 0.49014949798583984
Epoch: 23, Steps: 3 | Train Loss: 0.186 Vali Loss: 0.310 Vali Acc: 0.975 Test Loss: 0.310 Test Acc: 0.975
Validation loss decreased (-0.949997 --> -0.974997).  Saving model ...
Epoch: 24 cost time: 0.44525742530822754
Epoch: 24, Steps: 3 | Train Loss: 0.159 Vali Loss: 0.290 Vali Acc: 0.975 Test Loss: 0.290 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 25 cost time: 0.5157158374786377
Epoch: 25, Steps: 3 | Train Loss: 0.156 Vali Loss: 0.267 Vali Acc: 0.975 Test Loss: 0.267 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 26 cost time: 0.48085784912109375
Epoch: 26, Steps: 3 | Train Loss: 0.145 Vali Loss: 0.257 Vali Acc: 0.975 Test Loss: 0.257 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 27 cost time: 0.5615894794464111
Epoch: 27, Steps: 3 | Train Loss: 0.126 Vali Loss: 0.251 Vali Acc: 0.975 Test Loss: 0.251 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 28 cost time: 0.49600672721862793
Epoch: 28, Steps: 3 | Train Loss: 0.105 Vali Loss: 0.245 Vali Acc: 0.975 Test Loss: 0.245 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 29 cost time: 0.5400576591491699
Epoch: 29, Steps: 3 | Train Loss: 0.088 Vali Loss: 0.245 Vali Acc: 0.975 Test Loss: 0.245 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 30 cost time: 0.49109506607055664
Epoch: 30, Steps: 3 | Train Loss: 0.087 Vali Loss: 0.236 Vali Acc: 0.975 Test Loss: 0.236 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 31 cost time: 0.5743184089660645
Epoch: 31, Steps: 3 | Train Loss: 0.083 Vali Loss: 0.230 Vali Acc: 0.975 Test Loss: 0.230 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 32 cost time: 0.508634090423584
Epoch: 32, Steps: 3 | Train Loss: 0.078 Vali Loss: 0.223 Vali Acc: 0.975 Test Loss: 0.223 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 33 cost time: 0.5060856342315674
Epoch: 33, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.225 Vali Acc: 0.950 Test Loss: 0.225 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.5067024230957031
Epoch: 34, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.220 Vali Acc: 0.950 Test Loss: 0.220 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.46256470680236816
Epoch: 35, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.210 Vali Acc: 0.950 Test Loss: 0.210 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.4976470470428467
Epoch: 36, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.206 Vali Acc: 0.950 Test Loss: 0.206 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.4806849956512451
Epoch: 37, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.202 Vali Acc: 0.950 Test Loss: 0.202 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.4989297389984131
Epoch: 38, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.199 Vali Acc: 0.950 Test Loss: 0.199 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.5269789695739746
Epoch: 39, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.200 Vali Acc: 0.950 Test Loss: 0.200 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.5077841281890869
Epoch: 40, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.208 Vali Acc: 0.950 Test Loss: 0.208 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.5686759948730469
Epoch: 41, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.213 Vali Acc: 0.950 Test Loss: 0.213 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.479581356048584
Epoch: 42, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.200 Vali Acc: 0.950 Test Loss: 0.200 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 334852
model size : 1.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.6328039169311523
Epoch: 1, Steps: 3 | Train Loss: 1.301 Vali Loss: 1.321 Vali Acc: 0.350 Test Loss: 1.321 Test Acc: 0.350
Validation loss decreased (inf --> -0.349987).  Saving model ...
Epoch: 2 cost time: 0.40678906440734863
Epoch: 2, Steps: 3 | Train Loss: 1.278 Vali Loss: 1.295 Vali Acc: 0.475 Test Loss: 1.295 Test Acc: 0.475
Validation loss decreased (-0.349987 --> -0.474987).  Saving model ...
Epoch: 3 cost time: 0.3993566036224365
Epoch: 3, Steps: 3 | Train Loss: 1.243 Vali Loss: 1.262 Vali Acc: 0.500 Test Loss: 1.262 Test Acc: 0.500
Validation loss decreased (-0.474987 --> -0.499987).  Saving model ...
Epoch: 4 cost time: 0.46660757064819336
Epoch: 4, Steps: 3 | Train Loss: 1.175 Vali Loss: 1.216 Vali Acc: 0.550 Test Loss: 1.216 Test Acc: 0.550
Validation loss decreased (-0.499987 --> -0.549988).  Saving model ...
Epoch: 5 cost time: 0.4164094924926758
Epoch: 5, Steps: 3 | Train Loss: 1.110 Vali Loss: 1.160 Vali Acc: 0.600 Test Loss: 1.160 Test Acc: 0.600
Validation loss decreased (-0.549988 --> -0.599988).  Saving model ...
Epoch: 6 cost time: 0.448413610458374
Epoch: 6, Steps: 3 | Train Loss: 1.071 Vali Loss: 1.095 Vali Acc: 0.675 Test Loss: 1.095 Test Acc: 0.675
Validation loss decreased (-0.599988 --> -0.674989).  Saving model ...
Epoch: 7 cost time: 0.42804598808288574
Epoch: 7, Steps: 3 | Train Loss: 0.957 Vali Loss: 1.029 Vali Acc: 0.675 Test Loss: 1.029 Test Acc: 0.675
Validation loss decreased (-0.674989 --> -0.674990).  Saving model ...
Epoch: 8 cost time: 0.4506700038909912
Epoch: 8, Steps: 3 | Train Loss: 0.891 Vali Loss: 0.961 Vali Acc: 0.775 Test Loss: 0.961 Test Acc: 0.775
Validation loss decreased (-0.674990 --> -0.774990).  Saving model ...
Epoch: 9 cost time: 0.48778605461120605
Epoch: 9, Steps: 3 | Train Loss: 0.811 Vali Loss: 0.906 Vali Acc: 0.900 Test Loss: 0.906 Test Acc: 0.900
Validation loss decreased (-0.774990 --> -0.899991).  Saving model ...
Epoch: 10 cost time: 0.46111392974853516
Epoch: 10, Steps: 3 | Train Loss: 0.740 Vali Loss: 0.844 Vali Acc: 0.900 Test Loss: 0.844 Test Acc: 0.900
Validation loss decreased (-0.899991 --> -0.899992).  Saving model ...
Epoch: 11 cost time: 0.49883484840393066
Epoch: 11, Steps: 3 | Train Loss: 0.672 Vali Loss: 0.781 Vali Acc: 0.925 Test Loss: 0.781 Test Acc: 0.925
Validation loss decreased (-0.899992 --> -0.924992).  Saving model ...
Epoch: 12 cost time: 0.42448854446411133
Epoch: 12, Steps: 3 | Train Loss: 0.603 Vali Loss: 0.725 Vali Acc: 0.925 Test Loss: 0.725 Test Acc: 0.925
Validation loss decreased (-0.924992 --> -0.924993).  Saving model ...
Epoch: 13 cost time: 0.49076032638549805
Epoch: 13, Steps: 3 | Train Loss: 0.580 Vali Loss: 0.666 Vali Acc: 0.950 Test Loss: 0.666 Test Acc: 0.950
Validation loss decreased (-0.924993 --> -0.949993).  Saving model ...
Epoch: 14 cost time: 0.4368886947631836
Epoch: 14, Steps: 3 | Train Loss: 0.513 Vali Loss: 0.615 Vali Acc: 0.925 Test Loss: 0.615 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.53570556640625
Epoch: 15, Steps: 3 | Train Loss: 0.468 Vali Loss: 0.564 Vali Acc: 0.975 Test Loss: 0.564 Test Acc: 0.975
Validation loss decreased (-0.949993 --> -0.974994).  Saving model ...
Epoch: 16 cost time: 0.45894384384155273
Epoch: 16, Steps: 3 | Train Loss: 0.423 Vali Loss: 0.525 Vali Acc: 0.975 Test Loss: 0.525 Test Acc: 0.975
Validation loss decreased (-0.974994 --> -0.974995).  Saving model ...
Epoch: 17 cost time: 0.5216434001922607
Epoch: 17, Steps: 3 | Train Loss: 0.381 Vali Loss: 0.490 Vali Acc: 0.975 Test Loss: 0.490 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 18 cost time: 0.5299708843231201
Epoch: 18, Steps: 3 | Train Loss: 0.354 Vali Loss: 0.456 Vali Acc: 0.975 Test Loss: 0.456 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 19 cost time: 0.46646666526794434
Epoch: 19, Steps: 3 | Train Loss: 0.309 Vali Loss: 0.435 Vali Acc: 0.975 Test Loss: 0.435 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 20 cost time: 0.5089266300201416
Epoch: 20, Steps: 3 | Train Loss: 0.288 Vali Loss: 0.406 Vali Acc: 0.975 Test Loss: 0.406 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 21 cost time: 0.46582460403442383
Epoch: 21, Steps: 3 | Train Loss: 0.260 Vali Loss: 0.387 Vali Acc: 0.975 Test Loss: 0.387 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 22 cost time: 0.4194927215576172
Epoch: 22, Steps: 3 | Train Loss: 0.247 Vali Loss: 0.363 Vali Acc: 0.975 Test Loss: 0.363 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 23 cost time: 0.4856879711151123
Epoch: 23, Steps: 3 | Train Loss: 0.214 Vali Loss: 0.350 Vali Acc: 0.975 Test Loss: 0.350 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 24 cost time: 0.4485208988189697
Epoch: 24, Steps: 3 | Train Loss: 0.206 Vali Loss: 0.331 Vali Acc: 0.975 Test Loss: 0.331 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 25 cost time: 0.446319580078125
Epoch: 25, Steps: 3 | Train Loss: 0.190 Vali Loss: 0.316 Vali Acc: 0.975 Test Loss: 0.316 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 26 cost time: 0.5066430568695068
Epoch: 26, Steps: 3 | Train Loss: 0.170 Vali Loss: 0.291 Vali Acc: 0.975 Test Loss: 0.291 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 27 cost time: 0.5361557006835938
Epoch: 27, Steps: 3 | Train Loss: 0.165 Vali Loss: 0.276 Vali Acc: 0.975 Test Loss: 0.276 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 28 cost time: 0.4590022563934326
Epoch: 28, Steps: 3 | Train Loss: 0.160 Vali Loss: 0.259 Vali Acc: 0.975 Test Loss: 0.259 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 29 cost time: 0.4533052444458008
Epoch: 29, Steps: 3 | Train Loss: 0.138 Vali Loss: 0.249 Vali Acc: 0.975 Test Loss: 0.249 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 30 cost time: 0.47736310958862305
Epoch: 30, Steps: 3 | Train Loss: 0.131 Vali Loss: 0.240 Vali Acc: 0.975 Test Loss: 0.240 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 31 cost time: 0.455122709274292
Epoch: 31, Steps: 3 | Train Loss: 0.115 Vali Loss: 0.227 Vali Acc: 0.975 Test Loss: 0.227 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 32 cost time: 0.5352811813354492
Epoch: 32, Steps: 3 | Train Loss: 0.105 Vali Loss: 0.215 Vali Acc: 0.975 Test Loss: 0.215 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 33 cost time: 0.43847107887268066
Epoch: 33, Steps: 3 | Train Loss: 0.093 Vali Loss: 0.204 Vali Acc: 0.975 Test Loss: 0.204 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 34 cost time: 0.4724395275115967
Epoch: 34, Steps: 3 | Train Loss: 0.079 Vali Loss: 0.209 Vali Acc: 0.975 Test Loss: 0.209 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.4543004035949707
Epoch: 35, Steps: 3 | Train Loss: 0.092 Vali Loss: 0.201 Vali Acc: 0.975 Test Loss: 0.201 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 36 cost time: 0.5489282608032227
Epoch: 36, Steps: 3 | Train Loss: 0.079 Vali Loss: 0.194 Vali Acc: 0.975 Test Loss: 0.194 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 37 cost time: 0.4595947265625
Epoch: 37, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.188 Vali Acc: 0.975 Test Loss: 0.188 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 38 cost time: 0.5036146640777588
Epoch: 38, Steps: 3 | Train Loss: 0.068 Vali Loss: 0.186 Vali Acc: 0.975 Test Loss: 0.186 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 39 cost time: 0.4710698127746582
Epoch: 39, Steps: 3 | Train Loss: 0.061 Vali Loss: 0.183 Vali Acc: 0.975 Test Loss: 0.183 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 40 cost time: 0.43494105339050293
Epoch: 40, Steps: 3 | Train Loss: 0.070 Vali Loss: 0.181 Vali Acc: 0.950 Test Loss: 0.181 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.4020853042602539
Epoch: 41, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.181 Vali Acc: 0.950 Test Loss: 0.181 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.4329495429992676
Epoch: 42, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.178 Vali Acc: 0.950 Test Loss: 0.178 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.41742777824401855
Epoch: 43, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.174 Vali Acc: 0.950 Test Loss: 0.174 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.4612162113189697
Epoch: 44, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.171 Vali Acc: 0.950 Test Loss: 0.171 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.44611072540283203
Epoch: 45, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.173 Vali Acc: 0.950 Test Loss: 0.173 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.4188873767852783
Epoch: 46, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.175 Vali Acc: 0.950 Test Loss: 0.175 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.4916086196899414
Epoch: 47, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.167 Vali Acc: 0.950 Test Loss: 0.167 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 0.46736788749694824
Epoch: 48, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.167 Vali Acc: 0.950 Test Loss: 0.167 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 0.45479846000671387
Epoch: 49, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.170 Vali Acc: 0.950 Test Loss: 0.170 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 322628
model size : 1.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.5806028842926025
Epoch: 1, Steps: 3 | Train Loss: 1.373 Vali Loss: 1.350 Vali Acc: 0.525 Test Loss: 1.350 Test Acc: 0.525
Validation loss decreased (inf --> -0.524987).  Saving model ...
Epoch: 2 cost time: 0.4401545524597168
Epoch: 2, Steps: 3 | Train Loss: 1.306 Vali Loss: 1.329 Vali Acc: 0.575 Test Loss: 1.329 Test Acc: 0.575
Validation loss decreased (-0.524987 --> -0.574987).  Saving model ...
Epoch: 3 cost time: 0.438612699508667
Epoch: 3, Steps: 3 | Train Loss: 1.302 Vali Loss: 1.302 Vali Acc: 0.600 Test Loss: 1.302 Test Acc: 0.600
Validation loss decreased (-0.574987 --> -0.599987).  Saving model ...
Epoch: 4 cost time: 0.4278721809387207
Epoch: 4, Steps: 3 | Train Loss: 1.233 Vali Loss: 1.266 Vali Acc: 0.650 Test Loss: 1.266 Test Acc: 0.650
Validation loss decreased (-0.599987 --> -0.649987).  Saving model ...
Epoch: 5 cost time: 0.4679691791534424
Epoch: 5, Steps: 3 | Train Loss: 1.210 Vali Loss: 1.218 Vali Acc: 0.650 Test Loss: 1.218 Test Acc: 0.650
Validation loss decreased (-0.649987 --> -0.649988).  Saving model ...
Epoch: 6 cost time: 0.43123888969421387
Epoch: 6, Steps: 3 | Train Loss: 1.117 Vali Loss: 1.170 Vali Acc: 0.750 Test Loss: 1.170 Test Acc: 0.750
Validation loss decreased (-0.649988 --> -0.749988).  Saving model ...
Epoch: 7 cost time: 0.4420938491821289
Epoch: 7, Steps: 3 | Train Loss: 1.058 Vali Loss: 1.118 Vali Acc: 0.850 Test Loss: 1.118 Test Acc: 0.850
Validation loss decreased (-0.749988 --> -0.849989).  Saving model ...
Epoch: 8 cost time: 0.44779205322265625
Epoch: 8, Steps: 3 | Train Loss: 0.983 Vali Loss: 1.066 Vali Acc: 0.925 Test Loss: 1.066 Test Acc: 0.925
Validation loss decreased (-0.849989 --> -0.924989).  Saving model ...
Epoch: 9 cost time: 0.47095394134521484
Epoch: 9, Steps: 3 | Train Loss: 0.927 Vali Loss: 1.012 Vali Acc: 0.950 Test Loss: 1.012 Test Acc: 0.950
Validation loss decreased (-0.924989 --> -0.949990).  Saving model ...
Epoch: 10 cost time: 0.4159986972808838
Epoch: 10, Steps: 3 | Train Loss: 0.860 Vali Loss: 0.951 Vali Acc: 0.950 Test Loss: 0.951 Test Acc: 0.950
Validation loss decreased (-0.949990 --> -0.949990).  Saving model ...
Epoch: 11 cost time: 0.41907191276550293
Epoch: 11, Steps: 3 | Train Loss: 0.798 Vali Loss: 0.895 Vali Acc: 0.925 Test Loss: 0.895 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.4513881206512451
Epoch: 12, Steps: 3 | Train Loss: 0.752 Vali Loss: 0.840 Vali Acc: 0.925 Test Loss: 0.840 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.3901793956756592
Epoch: 13, Steps: 3 | Train Loss: 0.715 Vali Loss: 0.788 Vali Acc: 0.925 Test Loss: 0.788 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.44014978408813477
Epoch: 14, Steps: 3 | Train Loss: 0.625 Vali Loss: 0.742 Vali Acc: 0.925 Test Loss: 0.742 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.43872642517089844
Epoch: 15, Steps: 3 | Train Loss: 0.577 Vali Loss: 0.697 Vali Acc: 0.950 Test Loss: 0.697 Test Acc: 0.950
Validation loss decreased (-0.949990 --> -0.949993).  Saving model ...
Epoch: 16 cost time: 0.391033411026001
Epoch: 16, Steps: 3 | Train Loss: 0.537 Vali Loss: 0.658 Vali Acc: 0.950 Test Loss: 0.658 Test Acc: 0.950
Validation loss decreased (-0.949993 --> -0.949993).  Saving model ...
Epoch: 17 cost time: 0.4174983501434326
Epoch: 17, Steps: 3 | Train Loss: 0.487 Vali Loss: 0.619 Vali Acc: 0.950 Test Loss: 0.619 Test Acc: 0.950
Validation loss decreased (-0.949993 --> -0.949994).  Saving model ...
Epoch: 18 cost time: 0.4118521213531494
Epoch: 18, Steps: 3 | Train Loss: 0.435 Vali Loss: 0.577 Vali Acc: 0.950 Test Loss: 0.577 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949994).  Saving model ...
Epoch: 19 cost time: 0.501920223236084
Epoch: 19, Steps: 3 | Train Loss: 0.403 Vali Loss: 0.539 Vali Acc: 0.950 Test Loss: 0.539 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 20 cost time: 0.4094386100769043
Epoch: 20, Steps: 3 | Train Loss: 0.394 Vali Loss: 0.505 Vali Acc: 0.975 Test Loss: 0.505 Test Acc: 0.975
Validation loss decreased (-0.949995 --> -0.974995).  Saving model ...
Epoch: 21 cost time: 0.40677952766418457
Epoch: 21, Steps: 3 | Train Loss: 0.345 Vali Loss: 0.473 Vali Acc: 0.975 Test Loss: 0.473 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 22 cost time: 0.5431234836578369
Epoch: 22, Steps: 3 | Train Loss: 0.340 Vali Loss: 0.439 Vali Acc: 0.975 Test Loss: 0.439 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 23 cost time: 0.5313403606414795
Epoch: 23, Steps: 3 | Train Loss: 0.304 Vali Loss: 0.409 Vali Acc: 0.975 Test Loss: 0.409 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 24 cost time: 0.5138604640960693
Epoch: 24, Steps: 3 | Train Loss: 0.274 Vali Loss: 0.393 Vali Acc: 0.975 Test Loss: 0.393 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 25 cost time: 0.45047879219055176
Epoch: 25, Steps: 3 | Train Loss: 0.302 Vali Loss: 0.372 Vali Acc: 0.975 Test Loss: 0.372 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 26 cost time: 0.4697303771972656
Epoch: 26, Steps: 3 | Train Loss: 0.256 Vali Loss: 0.353 Vali Acc: 0.975 Test Loss: 0.353 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 27 cost time: 0.4653289318084717
Epoch: 27, Steps: 3 | Train Loss: 0.234 Vali Loss: 0.347 Vali Acc: 0.975 Test Loss: 0.347 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 28 cost time: 0.41019535064697266
Epoch: 28, Steps: 3 | Train Loss: 0.227 Vali Loss: 0.329 Vali Acc: 0.975 Test Loss: 0.329 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 29 cost time: 0.47029948234558105
Epoch: 29, Steps: 3 | Train Loss: 0.208 Vali Loss: 0.315 Vali Acc: 0.975 Test Loss: 0.315 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 30 cost time: 0.455655574798584
Epoch: 30, Steps: 3 | Train Loss: 0.179 Vali Loss: 0.304 Vali Acc: 0.975 Test Loss: 0.304 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 31 cost time: 0.43491411209106445
Epoch: 31, Steps: 3 | Train Loss: 0.171 Vali Loss: 0.298 Vali Acc: 0.975 Test Loss: 0.298 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 32 cost time: 0.4475977420806885
Epoch: 32, Steps: 3 | Train Loss: 0.155 Vali Loss: 0.286 Vali Acc: 0.975 Test Loss: 0.286 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 33 cost time: 0.44272327423095703
Epoch: 33, Steps: 3 | Train Loss: 0.147 Vali Loss: 0.276 Vali Acc: 0.975 Test Loss: 0.276 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 34 cost time: 0.4292776584625244
Epoch: 34, Steps: 3 | Train Loss: 0.140 Vali Loss: 0.259 Vali Acc: 0.975 Test Loss: 0.259 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 35 cost time: 0.4240841865539551
Epoch: 35, Steps: 3 | Train Loss: 0.125 Vali Loss: 0.241 Vali Acc: 0.975 Test Loss: 0.241 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 36 cost time: 0.5366883277893066
Epoch: 36, Steps: 3 | Train Loss: 0.107 Vali Loss: 0.226 Vali Acc: 0.975 Test Loss: 0.226 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 37 cost time: 0.4550814628601074
Epoch: 37, Steps: 3 | Train Loss: 0.105 Vali Loss: 0.229 Vali Acc: 0.975 Test Loss: 0.229 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.485872745513916
Epoch: 38, Steps: 3 | Train Loss: 0.103 Vali Loss: 0.217 Vali Acc: 0.975 Test Loss: 0.217 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 39 cost time: 0.5184719562530518
Epoch: 39, Steps: 3 | Train Loss: 0.104 Vali Loss: 0.210 Vali Acc: 0.975 Test Loss: 0.210 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 40 cost time: 0.5148134231567383
Epoch: 40, Steps: 3 | Train Loss: 0.094 Vali Loss: 0.207 Vali Acc: 0.950 Test Loss: 0.207 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.49413561820983887
Epoch: 41, Steps: 3 | Train Loss: 0.075 Vali Loss: 0.199 Vali Acc: 0.950 Test Loss: 0.199 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.43227386474609375
Epoch: 42, Steps: 3 | Train Loss: 0.078 Vali Loss: 0.197 Vali Acc: 0.950 Test Loss: 0.197 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.43157386779785156
Epoch: 43, Steps: 3 | Train Loss: 0.068 Vali Loss: 0.190 Vali Acc: 0.950 Test Loss: 0.190 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.4447643756866455
Epoch: 44, Steps: 3 | Train Loss: 0.076 Vali Loss: 0.187 Vali Acc: 0.950 Test Loss: 0.187 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.4910449981689453
Epoch: 45, Steps: 3 | Train Loss: 0.062 Vali Loss: 0.183 Vali Acc: 0.950 Test Loss: 0.183 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.45525670051574707
Epoch: 46, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.181 Vali Acc: 0.950 Test Loss: 0.181 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.4307100772857666
Epoch: 47, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.176 Vali Acc: 0.950 Test Loss: 0.176 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 0.43876075744628906
Epoch: 48, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.174 Vali Acc: 0.950 Test Loss: 0.174 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 0.4518589973449707
Epoch: 49, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.170 Vali Acc: 0.950 Test Loss: 0.170 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 316580
model size : 1.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.6596224308013916
Epoch: 1, Steps: 3 | Train Loss: 1.398 Vali Loss: 1.388 Vali Acc: 0.450 Test Loss: 1.388 Test Acc: 0.450
Validation loss decreased (inf --> -0.449986).  Saving model ...
Epoch: 2 cost time: 0.4761514663696289
Epoch: 2, Steps: 3 | Train Loss: 1.335 Vali Loss: 1.372 Vali Acc: 0.500 Test Loss: 1.372 Test Acc: 0.500
Validation loss decreased (-0.449986 --> -0.499986).  Saving model ...
Epoch: 3 cost time: 0.4744133949279785
Epoch: 3, Steps: 3 | Train Loss: 1.321 Vali Loss: 1.353 Vali Acc: 0.500 Test Loss: 1.353 Test Acc: 0.500
Validation loss decreased (-0.499986 --> -0.499986).  Saving model ...
Epoch: 4 cost time: 0.42786550521850586
Epoch: 4, Steps: 3 | Train Loss: 1.255 Vali Loss: 1.326 Vali Acc: 0.525 Test Loss: 1.326 Test Acc: 0.525
Validation loss decreased (-0.499986 --> -0.524987).  Saving model ...
Epoch: 5 cost time: 0.4993884563446045
Epoch: 5, Steps: 3 | Train Loss: 1.241 Vali Loss: 1.292 Vali Acc: 0.525 Test Loss: 1.292 Test Acc: 0.525
Validation loss decreased (-0.524987 --> -0.524987).  Saving model ...
Epoch: 6 cost time: 0.4976658821105957
Epoch: 6, Steps: 3 | Train Loss: 1.170 Vali Loss: 1.251 Vali Acc: 0.525 Test Loss: 1.251 Test Acc: 0.525
Validation loss decreased (-0.524987 --> -0.524987).  Saving model ...
Epoch: 7 cost time: 0.44310498237609863
Epoch: 7, Steps: 3 | Train Loss: 1.112 Vali Loss: 1.209 Vali Acc: 0.600 Test Loss: 1.209 Test Acc: 0.600
Validation loss decreased (-0.524987 --> -0.599988).  Saving model ...
Epoch: 8 cost time: 0.38474535942077637
Epoch: 8, Steps: 3 | Train Loss: 1.055 Vali Loss: 1.168 Vali Acc: 0.550 Test Loss: 1.168 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.511467456817627
Epoch: 9, Steps: 3 | Train Loss: 1.011 Vali Loss: 1.114 Vali Acc: 0.625 Test Loss: 1.114 Test Acc: 0.625
Validation loss decreased (-0.599988 --> -0.624989).  Saving model ...
Epoch: 10 cost time: 0.4234936237335205
Epoch: 10, Steps: 3 | Train Loss: 0.978 Vali Loss: 1.063 Vali Acc: 0.700 Test Loss: 1.063 Test Acc: 0.700
Validation loss decreased (-0.624989 --> -0.699989).  Saving model ...
Epoch: 11 cost time: 0.43715715408325195
Epoch: 11, Steps: 3 | Train Loss: 0.918 Vali Loss: 1.010 Vali Acc: 0.875 Test Loss: 1.010 Test Acc: 0.875
Validation loss decreased (-0.699989 --> -0.874990).  Saving model ...
Epoch: 12 cost time: 0.43109607696533203
Epoch: 12, Steps: 3 | Train Loss: 0.854 Vali Loss: 0.971 Vali Acc: 0.850 Test Loss: 0.971 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.4546067714691162
Epoch: 13, Steps: 3 | Train Loss: 0.846 Vali Loss: 0.916 Vali Acc: 0.875 Test Loss: 0.916 Test Acc: 0.875
Validation loss decreased (-0.874990 --> -0.874991).  Saving model ...
Epoch: 14 cost time: 0.5138325691223145
Epoch: 14, Steps: 3 | Train Loss: 0.769 Vali Loss: 0.875 Vali Acc: 0.875 Test Loss: 0.875 Test Acc: 0.875
Validation loss decreased (-0.874991 --> -0.874991).  Saving model ...
Epoch: 15 cost time: 0.42478489875793457
Epoch: 15, Steps: 3 | Train Loss: 0.710 Vali Loss: 0.838 Vali Acc: 0.900 Test Loss: 0.838 Test Acc: 0.900
Validation loss decreased (-0.874991 --> -0.899992).  Saving model ...
Epoch: 16 cost time: 0.5061087608337402
Epoch: 16, Steps: 3 | Train Loss: 0.653 Vali Loss: 0.801 Vali Acc: 0.900 Test Loss: 0.801 Test Acc: 0.900
Validation loss decreased (-0.899992 --> -0.899992).  Saving model ...
Epoch: 17 cost time: 0.42098236083984375
Epoch: 17, Steps: 3 | Train Loss: 0.635 Vali Loss: 0.761 Vali Acc: 0.925 Test Loss: 0.761 Test Acc: 0.925
Validation loss decreased (-0.899992 --> -0.924992).  Saving model ...
Epoch: 18 cost time: 0.5049998760223389
Epoch: 18, Steps: 3 | Train Loss: 0.586 Vali Loss: 0.722 Vali Acc: 0.925 Test Loss: 0.722 Test Acc: 0.925
Validation loss decreased (-0.924992 --> -0.924993).  Saving model ...
Epoch: 19 cost time: 0.4803600311279297
Epoch: 19, Steps: 3 | Train Loss: 0.549 Vali Loss: 0.684 Vali Acc: 0.925 Test Loss: 0.684 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924993).  Saving model ...
Epoch: 20 cost time: 0.45464444160461426
Epoch: 20, Steps: 3 | Train Loss: 0.520 Vali Loss: 0.649 Vali Acc: 0.925 Test Loss: 0.649 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924994).  Saving model ...
Epoch: 21 cost time: 0.49707961082458496
Epoch: 21, Steps: 3 | Train Loss: 0.471 Vali Loss: 0.623 Vali Acc: 0.925 Test Loss: 0.623 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 22 cost time: 0.46228837966918945
Epoch: 22, Steps: 3 | Train Loss: 0.442 Vali Loss: 0.595 Vali Acc: 0.925 Test Loss: 0.595 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 23 cost time: 0.4302666187286377
Epoch: 23, Steps: 3 | Train Loss: 0.419 Vali Loss: 0.573 Vali Acc: 0.925 Test Loss: 0.573 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 24 cost time: 0.5022897720336914
Epoch: 24, Steps: 3 | Train Loss: 0.415 Vali Loss: 0.552 Vali Acc: 0.925 Test Loss: 0.552 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 25 cost time: 0.49715161323547363
Epoch: 25, Steps: 3 | Train Loss: 0.366 Vali Loss: 0.522 Vali Acc: 0.925 Test Loss: 0.522 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 26 cost time: 0.46059679985046387
Epoch: 26, Steps: 3 | Train Loss: 0.365 Vali Loss: 0.503 Vali Acc: 0.925 Test Loss: 0.503 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 27 cost time: 0.38135409355163574
Epoch: 27, Steps: 3 | Train Loss: 0.350 Vali Loss: 0.482 Vali Acc: 0.925 Test Loss: 0.482 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 28 cost time: 0.4758279323577881
Epoch: 28, Steps: 3 | Train Loss: 0.311 Vali Loss: 0.477 Vali Acc: 0.925 Test Loss: 0.477 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 29 cost time: 0.5079293251037598
Epoch: 29, Steps: 3 | Train Loss: 0.311 Vali Loss: 0.454 Vali Acc: 0.925 Test Loss: 0.454 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 30 cost time: 0.5091583728790283
Epoch: 30, Steps: 3 | Train Loss: 0.286 Vali Loss: 0.432 Vali Acc: 0.950 Test Loss: 0.432 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949996).  Saving model ...
Epoch: 31 cost time: 0.42862629890441895
Epoch: 31, Steps: 3 | Train Loss: 0.275 Vali Loss: 0.415 Vali Acc: 0.950 Test Loss: 0.415 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 32 cost time: 0.46172165870666504
Epoch: 32, Steps: 3 | Train Loss: 0.264 Vali Loss: 0.399 Vali Acc: 0.950 Test Loss: 0.399 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 33 cost time: 0.4402332305908203
Epoch: 33, Steps: 3 | Train Loss: 0.256 Vali Loss: 0.390 Vali Acc: 0.950 Test Loss: 0.390 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 34 cost time: 0.4026217460632324
Epoch: 34, Steps: 3 | Train Loss: 0.234 Vali Loss: 0.378 Vali Acc: 0.950 Test Loss: 0.378 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 35 cost time: 0.5128254890441895
Epoch: 35, Steps: 3 | Train Loss: 0.221 Vali Loss: 0.365 Vali Acc: 0.975 Test Loss: 0.365 Test Acc: 0.975
Validation loss decreased (-0.949996 --> -0.974996).  Saving model ...
Epoch: 36 cost time: 0.4619565010070801
Epoch: 36, Steps: 3 | Train Loss: 0.224 Vali Loss: 0.361 Vali Acc: 0.950 Test Loss: 0.361 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.4885220527648926
Epoch: 37, Steps: 3 | Train Loss: 0.195 Vali Loss: 0.347 Vali Acc: 0.950 Test Loss: 0.347 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.4142937660217285
Epoch: 38, Steps: 3 | Train Loss: 0.212 Vali Loss: 0.323 Vali Acc: 0.975 Test Loss: 0.323 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 39 cost time: 0.41642165184020996
Epoch: 39, Steps: 3 | Train Loss: 0.173 Vali Loss: 0.315 Vali Acc: 0.950 Test Loss: 0.315 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.3641986846923828
Epoch: 40, Steps: 3 | Train Loss: 0.172 Vali Loss: 0.300 Vali Acc: 0.950 Test Loss: 0.300 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.5192434787750244
Epoch: 41, Steps: 3 | Train Loss: 0.186 Vali Loss: 0.293 Vali Acc: 0.950 Test Loss: 0.293 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.40392351150512695
Epoch: 42, Steps: 3 | Train Loss: 0.165 Vali Loss: 0.282 Vali Acc: 0.950 Test Loss: 0.282 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.4626729488372803
Epoch: 43, Steps: 3 | Train Loss: 0.139 Vali Loss: 0.281 Vali Acc: 0.950 Test Loss: 0.281 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.4974846839904785
Epoch: 44, Steps: 3 | Train Loss: 0.148 Vali Loss: 0.273 Vali Acc: 0.950 Test Loss: 0.273 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.5352587699890137
Epoch: 45, Steps: 3 | Train Loss: 0.146 Vali Loss: 0.269 Vali Acc: 0.950 Test Loss: 0.269 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.42627644538879395
Epoch: 46, Steps: 3 | Train Loss: 0.127 Vali Loss: 0.270 Vali Acc: 0.950 Test Loss: 0.270 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.479295015335083
Epoch: 47, Steps: 3 | Train Loss: 0.116 Vali Loss: 0.261 Vali Acc: 0.950 Test Loss: 0.261 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 0.47388315200805664
Epoch: 48, Steps: 3 | Train Loss: 0.114 Vali Loss: 0.266 Vali Acc: 0.950 Test Loss: 0.266 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 312036
model size : 1.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.696866512298584
Epoch: 1, Steps: 3 | Train Loss: 1.367 Vali Loss: 1.361 Vali Acc: 0.325 Test Loss: 1.361 Test Acc: 0.325
Validation loss decreased (inf --> -0.324986).  Saving model ...
Epoch: 2 cost time: 0.4344034194946289
Epoch: 2, Steps: 3 | Train Loss: 1.307 Vali Loss: 1.346 Vali Acc: 0.325 Test Loss: 1.346 Test Acc: 0.325
Validation loss decreased (-0.324986 --> -0.324987).  Saving model ...
Epoch: 3 cost time: 0.510812520980835
Epoch: 3, Steps: 3 | Train Loss: 1.292 Vali Loss: 1.331 Vali Acc: 0.325 Test Loss: 1.331 Test Acc: 0.325
Validation loss decreased (-0.324987 --> -0.324987).  Saving model ...
Epoch: 4 cost time: 0.457294225692749
Epoch: 4, Steps: 3 | Train Loss: 1.251 Vali Loss: 1.311 Vali Acc: 0.375 Test Loss: 1.311 Test Acc: 0.375
Validation loss decreased (-0.324987 --> -0.374987).  Saving model ...
Epoch: 5 cost time: 0.49844908714294434
Epoch: 5, Steps: 3 | Train Loss: 1.214 Vali Loss: 1.284 Vali Acc: 0.425 Test Loss: 1.284 Test Acc: 0.425
Validation loss decreased (-0.374987 --> -0.424987).  Saving model ...
Epoch: 6 cost time: 0.4478151798248291
Epoch: 6, Steps: 3 | Train Loss: 1.212 Vali Loss: 1.253 Vali Acc: 0.475 Test Loss: 1.253 Test Acc: 0.475
Validation loss decreased (-0.424987 --> -0.474987).  Saving model ...
Epoch: 7 cost time: 0.41055774688720703
Epoch: 7, Steps: 3 | Train Loss: 1.186 Vali Loss: 1.221 Vali Acc: 0.500 Test Loss: 1.221 Test Acc: 0.500
Validation loss decreased (-0.474987 --> -0.499988).  Saving model ...
Epoch: 8 cost time: 0.4881603717803955
Epoch: 8, Steps: 3 | Train Loss: 1.171 Vali Loss: 1.184 Vali Acc: 0.500 Test Loss: 1.184 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 9 cost time: 0.4306330680847168
Epoch: 9, Steps: 3 | Train Loss: 1.093 Vali Loss: 1.151 Vali Acc: 0.500 Test Loss: 1.151 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499988).  Saving model ...
Epoch: 10 cost time: 0.5043256282806396
Epoch: 10, Steps: 3 | Train Loss: 1.026 Vali Loss: 1.123 Vali Acc: 0.525 Test Loss: 1.123 Test Acc: 0.525
Validation loss decreased (-0.499988 --> -0.524989).  Saving model ...
Epoch: 11 cost time: 0.5395276546478271
Epoch: 11, Steps: 3 | Train Loss: 0.990 Vali Loss: 1.092 Vali Acc: 0.550 Test Loss: 1.092 Test Acc: 0.550
Validation loss decreased (-0.524989 --> -0.549989).  Saving model ...
Epoch: 12 cost time: 0.5579133033752441
Epoch: 12, Steps: 3 | Train Loss: 0.956 Vali Loss: 1.058 Vali Acc: 0.575 Test Loss: 1.058 Test Acc: 0.575
Validation loss decreased (-0.549989 --> -0.574989).  Saving model ...
Epoch: 13 cost time: 0.43586230278015137
Epoch: 13, Steps: 3 | Train Loss: 0.902 Vali Loss: 1.025 Vali Acc: 0.600 Test Loss: 1.025 Test Acc: 0.600
Validation loss decreased (-0.574989 --> -0.599990).  Saving model ...
Epoch: 14 cost time: 0.49063968658447266
Epoch: 14, Steps: 3 | Train Loss: 0.865 Vali Loss: 0.988 Vali Acc: 0.650 Test Loss: 0.988 Test Acc: 0.650
Validation loss decreased (-0.599990 --> -0.649990).  Saving model ...
Epoch: 15 cost time: 0.44359779357910156
Epoch: 15, Steps: 3 | Train Loss: 0.849 Vali Loss: 0.955 Vali Acc: 0.675 Test Loss: 0.955 Test Acc: 0.675
Validation loss decreased (-0.649990 --> -0.674990).  Saving model ...
Epoch: 16 cost time: 0.5480871200561523
Epoch: 16, Steps: 3 | Train Loss: 0.794 Vali Loss: 0.928 Vali Acc: 0.700 Test Loss: 0.928 Test Acc: 0.700
Validation loss decreased (-0.674990 --> -0.699991).  Saving model ...
Epoch: 17 cost time: 0.51590895652771
Epoch: 17, Steps: 3 | Train Loss: 0.750 Vali Loss: 0.892 Vali Acc: 0.700 Test Loss: 0.892 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 18 cost time: 0.5081570148468018
Epoch: 18, Steps: 3 | Train Loss: 0.730 Vali Loss: 0.857 Vali Acc: 0.725 Test Loss: 0.857 Test Acc: 0.725
Validation loss decreased (-0.699991 --> -0.724991).  Saving model ...
Epoch: 19 cost time: 0.5309090614318848
Epoch: 19, Steps: 3 | Train Loss: 0.699 Vali Loss: 0.824 Vali Acc: 0.750 Test Loss: 0.824 Test Acc: 0.750
Validation loss decreased (-0.724991 --> -0.749992).  Saving model ...
Epoch: 20 cost time: 0.4865741729736328
Epoch: 20, Steps: 3 | Train Loss: 0.635 Vali Loss: 0.794 Vali Acc: 0.850 Test Loss: 0.794 Test Acc: 0.850
Validation loss decreased (-0.749992 --> -0.849992).  Saving model ...
Epoch: 21 cost time: 0.4399409294128418
Epoch: 21, Steps: 3 | Train Loss: 0.630 Vali Loss: 0.767 Vali Acc: 0.875 Test Loss: 0.767 Test Acc: 0.875
Validation loss decreased (-0.849992 --> -0.874992).  Saving model ...
Epoch: 22 cost time: 0.48517894744873047
Epoch: 22, Steps: 3 | Train Loss: 0.575 Vali Loss: 0.736 Vali Acc: 0.925 Test Loss: 0.736 Test Acc: 0.925
Validation loss decreased (-0.874992 --> -0.924993).  Saving model ...
Epoch: 23 cost time: 0.5139226913452148
Epoch: 23, Steps: 3 | Train Loss: 0.556 Vali Loss: 0.707 Vali Acc: 0.950 Test Loss: 0.707 Test Acc: 0.950
Validation loss decreased (-0.924993 --> -0.949993).  Saving model ...
Epoch: 24 cost time: 0.4261300563812256
Epoch: 24, Steps: 3 | Train Loss: 0.592 Vali Loss: 0.674 Vali Acc: 0.950 Test Loss: 0.674 Test Acc: 0.950
Validation loss decreased (-0.949993 --> -0.949993).  Saving model ...
Epoch: 25 cost time: 0.44330263137817383
Epoch: 25, Steps: 3 | Train Loss: 0.503 Vali Loss: 0.652 Vali Acc: 0.950 Test Loss: 0.652 Test Acc: 0.950
Validation loss decreased (-0.949993 --> -0.949993).  Saving model ...
Epoch: 26 cost time: 0.4369795322418213
Epoch: 26, Steps: 3 | Train Loss: 0.482 Vali Loss: 0.628 Vali Acc: 0.950 Test Loss: 0.628 Test Acc: 0.950
Validation loss decreased (-0.949993 --> -0.949994).  Saving model ...
Epoch: 27 cost time: 0.4342348575592041
Epoch: 27, Steps: 3 | Train Loss: 0.458 Vali Loss: 0.608 Vali Acc: 0.950 Test Loss: 0.608 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949994).  Saving model ...
Epoch: 28 cost time: 0.4312911033630371
Epoch: 28, Steps: 3 | Train Loss: 0.436 Vali Loss: 0.589 Vali Acc: 0.950 Test Loss: 0.589 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949994).  Saving model ...
Epoch: 29 cost time: 0.44457006454467773
Epoch: 29, Steps: 3 | Train Loss: 0.401 Vali Loss: 0.573 Vali Acc: 0.925 Test Loss: 0.573 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.44597959518432617
Epoch: 30, Steps: 3 | Train Loss: 0.391 Vali Loss: 0.552 Vali Acc: 0.925 Test Loss: 0.552 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.40340614318847656
Epoch: 31, Steps: 3 | Train Loss: 0.362 Vali Loss: 0.524 Vali Acc: 0.925 Test Loss: 0.524 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.5462965965270996
Epoch: 32, Steps: 3 | Train Loss: 0.370 Vali Loss: 0.498 Vali Acc: 0.925 Test Loss: 0.498 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.49994659423828125
Epoch: 33, Steps: 3 | Train Loss: 0.338 Vali Loss: 0.480 Vali Acc: 0.925 Test Loss: 0.480 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.48767995834350586
Epoch: 34, Steps: 3 | Train Loss: 0.306 Vali Loss: 0.463 Vali Acc: 0.925 Test Loss: 0.463 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.44660210609436035
Epoch: 35, Steps: 3 | Train Loss: 0.289 Vali Loss: 0.450 Vali Acc: 0.925 Test Loss: 0.450 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.4622502326965332
Epoch: 36, Steps: 3 | Train Loss: 0.293 Vali Loss: 0.440 Vali Acc: 0.950 Test Loss: 0.440 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949996).  Saving model ...
Epoch: 37 cost time: 0.40361952781677246
Epoch: 37, Steps: 3 | Train Loss: 0.267 Vali Loss: 0.419 Vali Acc: 0.950 Test Loss: 0.419 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 38 cost time: 0.40895557403564453
Epoch: 38, Steps: 3 | Train Loss: 0.249 Vali Loss: 0.419 Vali Acc: 0.950 Test Loss: 0.419 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 39 cost time: 0.4741630554199219
Epoch: 39, Steps: 3 | Train Loss: 0.234 Vali Loss: 0.402 Vali Acc: 0.950 Test Loss: 0.402 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 40 cost time: 0.4596066474914551
Epoch: 40, Steps: 3 | Train Loss: 0.221 Vali Loss: 0.384 Vali Acc: 0.950 Test Loss: 0.384 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 41 cost time: 0.4320700168609619
Epoch: 41, Steps: 3 | Train Loss: 0.206 Vali Loss: 0.364 Vali Acc: 0.975 Test Loss: 0.364 Test Acc: 0.975
Validation loss decreased (-0.949996 --> -0.974996).  Saving model ...
Epoch: 42 cost time: 0.49408888816833496
Epoch: 42, Steps: 3 | Train Loss: 0.211 Vali Loss: 0.348 Vali Acc: 0.975 Test Loss: 0.348 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 43 cost time: 0.44245195388793945
Epoch: 43, Steps: 3 | Train Loss: 0.193 Vali Loss: 0.331 Vali Acc: 0.975 Test Loss: 0.331 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 44 cost time: 0.4159817695617676
Epoch: 44, Steps: 3 | Train Loss: 0.187 Vali Loss: 0.326 Vali Acc: 0.975 Test Loss: 0.326 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 45 cost time: 0.4981377124786377
Epoch: 45, Steps: 3 | Train Loss: 0.183 Vali Loss: 0.320 Vali Acc: 0.975 Test Loss: 0.320 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 46 cost time: 0.429654598236084
Epoch: 46, Steps: 3 | Train Loss: 0.153 Vali Loss: 0.299 Vali Acc: 0.975 Test Loss: 0.299 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 47 cost time: 0.5279066562652588
Epoch: 47, Steps: 3 | Train Loss: 0.151 Vali Loss: 0.289 Vali Acc: 0.975 Test Loss: 0.289 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 48 cost time: 0.4723191261291504
Epoch: 48, Steps: 3 | Train Loss: 0.150 Vali Loss: 0.284 Vali Acc: 0.975 Test Loss: 0.284 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 49 cost time: 0.4602198600769043
Epoch: 49, Steps: 3 | Train Loss: 0.128 Vali Loss: 0.267 Vali Acc: 0.975 Test Loss: 0.267 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 50 cost time: 0.43080806732177734
Epoch: 50, Steps: 3 | Train Loss: 0.134 Vali Loss: 0.263 Vali Acc: 0.975 Test Loss: 0.263 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 306052
model size : 1.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps20_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.6834282875061035
Epoch: 1, Steps: 3 | Train Loss: 1.435 Vali Loss: 1.364 Vali Acc: 0.300 Test Loss: 1.364 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 0.4695742130279541
Epoch: 2, Steps: 3 | Train Loss: 1.385 Vali Loss: 1.350 Vali Acc: 0.300 Test Loss: 1.350 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299987).  Saving model ...
Epoch: 3 cost time: 0.47897863388061523
Epoch: 3, Steps: 3 | Train Loss: 1.358 Vali Loss: 1.336 Vali Acc: 0.325 Test Loss: 1.336 Test Acc: 0.325
Validation loss decreased (-0.299987 --> -0.324987).  Saving model ...
Epoch: 4 cost time: 0.45081663131713867
Epoch: 4, Steps: 3 | Train Loss: 1.353 Vali Loss: 1.316 Vali Acc: 0.375 Test Loss: 1.316 Test Acc: 0.375
Validation loss decreased (-0.324987 --> -0.374987).  Saving model ...
Epoch: 5 cost time: 0.4526364803314209
Epoch: 5, Steps: 3 | Train Loss: 1.319 Vali Loss: 1.292 Vali Acc: 0.400 Test Loss: 1.292 Test Acc: 0.400
Validation loss decreased (-0.374987 --> -0.399987).  Saving model ...
Epoch: 6 cost time: 0.416522741317749
Epoch: 6, Steps: 3 | Train Loss: 1.265 Vali Loss: 1.264 Vali Acc: 0.550 Test Loss: 1.264 Test Acc: 0.550
Validation loss decreased (-0.399987 --> -0.549987).  Saving model ...
Epoch: 7 cost time: 0.4232146739959717
Epoch: 7, Steps: 3 | Train Loss: 1.217 Vali Loss: 1.233 Vali Acc: 0.625 Test Loss: 1.233 Test Acc: 0.625
Validation loss decreased (-0.549987 --> -0.624988).  Saving model ...
Epoch: 8 cost time: 0.47179102897644043
Epoch: 8, Steps: 3 | Train Loss: 1.171 Vali Loss: 1.200 Vali Acc: 0.700 Test Loss: 1.200 Test Acc: 0.700
Validation loss decreased (-0.624988 --> -0.699988).  Saving model ...
Epoch: 9 cost time: 0.595897912979126
Epoch: 9, Steps: 3 | Train Loss: 1.126 Vali Loss: 1.168 Vali Acc: 0.725 Test Loss: 1.168 Test Acc: 0.725
Validation loss decreased (-0.699988 --> -0.724988).  Saving model ...
Epoch: 10 cost time: 0.4474349021911621
Epoch: 10, Steps: 3 | Train Loss: 1.102 Vali Loss: 1.130 Vali Acc: 0.775 Test Loss: 1.130 Test Acc: 0.775
Validation loss decreased (-0.724988 --> -0.774989).  Saving model ...
Epoch: 11 cost time: 0.39530014991760254
Epoch: 11, Steps: 3 | Train Loss: 1.053 Vali Loss: 1.096 Vali Acc: 0.800 Test Loss: 1.096 Test Acc: 0.800
Validation loss decreased (-0.774989 --> -0.799989).  Saving model ...
Epoch: 12 cost time: 0.4267308712005615
Epoch: 12, Steps: 3 | Train Loss: 1.010 Vali Loss: 1.059 Vali Acc: 0.825 Test Loss: 1.059 Test Acc: 0.825
Validation loss decreased (-0.799989 --> -0.824989).  Saving model ...
Epoch: 13 cost time: 0.3851046562194824
Epoch: 13, Steps: 3 | Train Loss: 1.009 Vali Loss: 1.021 Vali Acc: 0.825 Test Loss: 1.021 Test Acc: 0.825
Validation loss decreased (-0.824989 --> -0.824990).  Saving model ...
Epoch: 14 cost time: 0.3948981761932373
Epoch: 14, Steps: 3 | Train Loss: 0.922 Vali Loss: 0.989 Vali Acc: 0.850 Test Loss: 0.989 Test Acc: 0.850
Validation loss decreased (-0.824990 --> -0.849990).  Saving model ...
Epoch: 15 cost time: 0.4561493396759033
Epoch: 15, Steps: 3 | Train Loss: 0.890 Vali Loss: 0.960 Vali Acc: 0.850 Test Loss: 0.960 Test Acc: 0.850
Validation loss decreased (-0.849990 --> -0.849990).  Saving model ...
Epoch: 16 cost time: 0.39520955085754395
Epoch: 16, Steps: 3 | Train Loss: 0.890 Vali Loss: 0.922 Vali Acc: 0.850 Test Loss: 0.922 Test Acc: 0.850
Validation loss decreased (-0.849990 --> -0.849991).  Saving model ...
Epoch: 17 cost time: 0.412365198135376
Epoch: 17, Steps: 3 | Train Loss: 0.834 Vali Loss: 0.889 Vali Acc: 0.875 Test Loss: 0.889 Test Acc: 0.875
Validation loss decreased (-0.849991 --> -0.874991).  Saving model ...
Epoch: 18 cost time: 0.4888267517089844
Epoch: 18, Steps: 3 | Train Loss: 0.794 Vali Loss: 0.860 Vali Acc: 0.900 Test Loss: 0.860 Test Acc: 0.900
Validation loss decreased (-0.874991 --> -0.899991).  Saving model ...
Epoch: 19 cost time: 0.46477484703063965
Epoch: 19, Steps: 3 | Train Loss: 0.761 Vali Loss: 0.826 Vali Acc: 0.900 Test Loss: 0.826 Test Acc: 0.900
Validation loss decreased (-0.899991 --> -0.899992).  Saving model ...
Epoch: 20 cost time: 0.4408283233642578
Epoch: 20, Steps: 3 | Train Loss: 0.699 Vali Loss: 0.798 Vali Acc: 0.925 Test Loss: 0.798 Test Acc: 0.925
Validation loss decreased (-0.899992 --> -0.924992).  Saving model ...
Epoch: 21 cost time: 0.47861266136169434
Epoch: 21, Steps: 3 | Train Loss: 0.690 Vali Loss: 0.763 Vali Acc: 0.925 Test Loss: 0.763 Test Acc: 0.925
Validation loss decreased (-0.924992 --> -0.924992).  Saving model ...
Epoch: 22 cost time: 0.42406606674194336
Epoch: 22, Steps: 3 | Train Loss: 0.648 Vali Loss: 0.732 Vali Acc: 0.925 Test Loss: 0.732 Test Acc: 0.925
Validation loss decreased (-0.924992 --> -0.924993).  Saving model ...
Epoch: 23 cost time: 0.4216804504394531
Epoch: 23, Steps: 3 | Train Loss: 0.602 Vali Loss: 0.717 Vali Acc: 0.925 Test Loss: 0.717 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924993).  Saving model ...
Epoch: 24 cost time: 0.46456313133239746
Epoch: 24, Steps: 3 | Train Loss: 0.598 Vali Loss: 0.696 Vali Acc: 0.925 Test Loss: 0.696 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924993).  Saving model ...
Epoch: 25 cost time: 0.4475092887878418
Epoch: 25, Steps: 3 | Train Loss: 0.565 Vali Loss: 0.667 Vali Acc: 0.925 Test Loss: 0.667 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924993).  Saving model ...
Epoch: 26 cost time: 0.45357489585876465
Epoch: 26, Steps: 3 | Train Loss: 0.536 Vali Loss: 0.648 Vali Acc: 0.925 Test Loss: 0.648 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924994).  Saving model ...
Epoch: 27 cost time: 0.45415234565734863
Epoch: 27, Steps: 3 | Train Loss: 0.502 Vali Loss: 0.631 Vali Acc: 0.950 Test Loss: 0.631 Test Acc: 0.950
Validation loss decreased (-0.924994 --> -0.949994).  Saving model ...
Epoch: 28 cost time: 0.4730536937713623
Epoch: 28, Steps: 3 | Train Loss: 0.500 Vali Loss: 0.609 Vali Acc: 0.950 Test Loss: 0.609 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949994).  Saving model ...
Epoch: 29 cost time: 0.4239215850830078
Epoch: 29, Steps: 3 | Train Loss: 0.468 Vali Loss: 0.581 Vali Acc: 0.950 Test Loss: 0.581 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949994).  Saving model ...
Epoch: 30 cost time: 0.4547247886657715
Epoch: 30, Steps: 3 | Train Loss: 0.454 Vali Loss: 0.560 Vali Acc: 0.950 Test Loss: 0.560 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949994).  Saving model ...
Epoch: 31 cost time: 0.4374275207519531
Epoch: 31, Steps: 3 | Train Loss: 0.447 Vali Loss: 0.532 Vali Acc: 0.950 Test Loss: 0.532 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 32 cost time: 0.4604659080505371
Epoch: 32, Steps: 3 | Train Loss: 0.408 Vali Loss: 0.510 Vali Acc: 0.950 Test Loss: 0.510 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 33 cost time: 0.47805333137512207
Epoch: 33, Steps: 3 | Train Loss: 0.384 Vali Loss: 0.493 Vali Acc: 0.950 Test Loss: 0.493 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 34 cost time: 0.5029211044311523
Epoch: 34, Steps: 3 | Train Loss: 0.381 Vali Loss: 0.479 Vali Acc: 0.950 Test Loss: 0.479 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 35 cost time: 0.4860877990722656
Epoch: 35, Steps: 3 | Train Loss: 0.348 Vali Loss: 0.468 Vali Acc: 0.950 Test Loss: 0.468 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 36 cost time: 0.4831202030181885
Epoch: 36, Steps: 3 | Train Loss: 0.333 Vali Loss: 0.445 Vali Acc: 0.950 Test Loss: 0.445 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 37 cost time: 0.42476415634155273
Epoch: 37, Steps: 3 | Train Loss: 0.325 Vali Loss: 0.428 Vali Acc: 0.950 Test Loss: 0.428 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 38 cost time: 0.4524703025817871
Epoch: 38, Steps: 3 | Train Loss: 0.305 Vali Loss: 0.412 Vali Acc: 0.950 Test Loss: 0.412 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 39 cost time: 0.4276564121246338
Epoch: 39, Steps: 3 | Train Loss: 0.312 Vali Loss: 0.410 Vali Acc: 0.950 Test Loss: 0.410 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 40 cost time: 0.5070469379425049
Epoch: 40, Steps: 3 | Train Loss: 0.293 Vali Loss: 0.394 Vali Acc: 0.950 Test Loss: 0.394 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 41 cost time: 0.43178582191467285
Epoch: 41, Steps: 3 | Train Loss: 0.268 Vali Loss: 0.377 Vali Acc: 0.975 Test Loss: 0.377 Test Acc: 0.975
Validation loss decreased (-0.949996 --> -0.974996).  Saving model ...
Epoch: 42 cost time: 0.5090460777282715
Epoch: 42, Steps: 3 | Train Loss: 0.265 Vali Loss: 0.364 Vali Acc: 0.975 Test Loss: 0.364 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 43 cost time: 0.5030245780944824
Epoch: 43, Steps: 3 | Train Loss: 0.236 Vali Loss: 0.355 Vali Acc: 0.975 Test Loss: 0.355 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 44 cost time: 0.4279141426086426
Epoch: 44, Steps: 3 | Train Loss: 0.244 Vali Loss: 0.344 Vali Acc: 0.975 Test Loss: 0.344 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 45 cost time: 0.4781816005706787
Epoch: 45, Steps: 3 | Train Loss: 0.227 Vali Loss: 0.328 Vali Acc: 0.975 Test Loss: 0.328 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 46 cost time: 0.404327392578125
Epoch: 46, Steps: 3 | Train Loss: 0.211 Vali Loss: 0.311 Vali Acc: 0.975 Test Loss: 0.311 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 47 cost time: 0.5081005096435547
Epoch: 47, Steps: 3 | Train Loss: 0.231 Vali Loss: 0.293 Vali Acc: 0.975 Test Loss: 0.293 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 48 cost time: 0.42703676223754883
Epoch: 48, Steps: 3 | Train Loss: 0.202 Vali Loss: 0.286 Vali Acc: 0.975 Test Loss: 0.286 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 49 cost time: 0.4306149482727051
Epoch: 49, Steps: 3 | Train Loss: 0.189 Vali Loss: 0.281 Vali Acc: 0.975 Test Loss: 0.281 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 50 cost time: 0.4124126434326172
Epoch: 50, Steps: 3 | Train Loss: 0.174 Vali Loss: 0.271 Vali Acc: 0.975 Test Loss: 0.271 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps20_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 304676
model size : 1.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps25_str13_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.7181987762451172
Epoch: 1, Steps: 3 | Train Loss: 1.331 Vali Loss: 1.304 Vali Acc: 0.400 Test Loss: 1.304 Test Acc: 0.400
Validation loss decreased (inf --> -0.399987).  Saving model ...
Epoch: 2 cost time: 0.4186413288116455
Epoch: 2, Steps: 3 | Train Loss: 1.310 Vali Loss: 1.289 Vali Acc: 0.400 Test Loss: 1.289 Test Acc: 0.400
Validation loss decreased (-0.399987 --> -0.399987).  Saving model ...
Epoch: 3 cost time: 0.38912343978881836
Epoch: 3, Steps: 3 | Train Loss: 1.271 Vali Loss: 1.275 Vali Acc: 0.425 Test Loss: 1.275 Test Acc: 0.425
Validation loss decreased (-0.399987 --> -0.424987).  Saving model ...
Epoch: 4 cost time: 0.42504024505615234
Epoch: 4, Steps: 3 | Train Loss: 1.247 Vali Loss: 1.254 Vali Acc: 0.450 Test Loss: 1.254 Test Acc: 0.450
Validation loss decreased (-0.424987 --> -0.449987).  Saving model ...
Epoch: 5 cost time: 0.4171757698059082
Epoch: 5, Steps: 3 | Train Loss: 1.243 Vali Loss: 1.231 Vali Acc: 0.450 Test Loss: 1.231 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449988).  Saving model ...
Epoch: 6 cost time: 0.4509086608886719
Epoch: 6, Steps: 3 | Train Loss: 1.225 Vali Loss: 1.209 Vali Acc: 0.475 Test Loss: 1.209 Test Acc: 0.475
Validation loss decreased (-0.449988 --> -0.474988).  Saving model ...
Epoch: 7 cost time: 0.49749016761779785
Epoch: 7, Steps: 3 | Train Loss: 1.213 Vali Loss: 1.182 Vali Acc: 0.475 Test Loss: 1.182 Test Acc: 0.475
Validation loss decreased (-0.474988 --> -0.474988).  Saving model ...
Epoch: 8 cost time: 0.4250674247741699
Epoch: 8, Steps: 3 | Train Loss: 1.145 Vali Loss: 1.156 Vali Acc: 0.475 Test Loss: 1.156 Test Acc: 0.475
Validation loss decreased (-0.474988 --> -0.474988).  Saving model ...
Epoch: 9 cost time: 0.4270787239074707
Epoch: 9, Steps: 3 | Train Loss: 1.130 Vali Loss: 1.130 Vali Acc: 0.500 Test Loss: 1.130 Test Acc: 0.500
Validation loss decreased (-0.474988 --> -0.499989).  Saving model ...
Epoch: 10 cost time: 0.3811464309692383
Epoch: 10, Steps: 3 | Train Loss: 1.051 Vali Loss: 1.104 Vali Acc: 0.525 Test Loss: 1.104 Test Acc: 0.525
Validation loss decreased (-0.499989 --> -0.524989).  Saving model ...
Epoch: 11 cost time: 0.44298648834228516
Epoch: 11, Steps: 3 | Train Loss: 1.047 Vali Loss: 1.071 Vali Acc: 0.575 Test Loss: 1.071 Test Acc: 0.575
Validation loss decreased (-0.524989 --> -0.574989).  Saving model ...
Epoch: 12 cost time: 0.4259943962097168
Epoch: 12, Steps: 3 | Train Loss: 1.082 Vali Loss: 1.035 Vali Acc: 0.575 Test Loss: 1.035 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574990).  Saving model ...
Epoch: 13 cost time: 0.4598276615142822
Epoch: 13, Steps: 3 | Train Loss: 0.978 Vali Loss: 1.014 Vali Acc: 0.600 Test Loss: 1.014 Test Acc: 0.600
Validation loss decreased (-0.574990 --> -0.599990).  Saving model ...
Epoch: 14 cost time: 0.41960954666137695
Epoch: 14, Steps: 3 | Train Loss: 1.002 Vali Loss: 0.980 Vali Acc: 0.650 Test Loss: 0.980 Test Acc: 0.650
Validation loss decreased (-0.599990 --> -0.649990).  Saving model ...
Epoch: 15 cost time: 0.4424123764038086
Epoch: 15, Steps: 3 | Train Loss: 0.938 Vali Loss: 0.952 Vali Acc: 0.700 Test Loss: 0.952 Test Acc: 0.700
Validation loss decreased (-0.649990 --> -0.699990).  Saving model ...
Epoch: 16 cost time: 0.44464898109436035
Epoch: 16, Steps: 3 | Train Loss: 0.881 Vali Loss: 0.927 Vali Acc: 0.750 Test Loss: 0.927 Test Acc: 0.750
Validation loss decreased (-0.699990 --> -0.749991).  Saving model ...
Epoch: 17 cost time: 0.4891693592071533
Epoch: 17, Steps: 3 | Train Loss: 0.843 Vali Loss: 0.907 Vali Acc: 0.825 Test Loss: 0.907 Test Acc: 0.825
Validation loss decreased (-0.749991 --> -0.824991).  Saving model ...
Epoch: 18 cost time: 0.4766671657562256
Epoch: 18, Steps: 3 | Train Loss: 0.816 Vali Loss: 0.880 Vali Acc: 0.850 Test Loss: 0.880 Test Acc: 0.850
Validation loss decreased (-0.824991 --> -0.849991).  Saving model ...
Epoch: 19 cost time: 0.49835658073425293
Epoch: 19, Steps: 3 | Train Loss: 0.799 Vali Loss: 0.848 Vali Acc: 0.875 Test Loss: 0.848 Test Acc: 0.875
Validation loss decreased (-0.849991 --> -0.874992).  Saving model ...
Epoch: 20 cost time: 0.43939781188964844
Epoch: 20, Steps: 3 | Train Loss: 0.770 Vali Loss: 0.836 Vali Acc: 0.875 Test Loss: 0.836 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874992).  Saving model ...
Epoch: 21 cost time: 0.4709892272949219
Epoch: 21, Steps: 3 | Train Loss: 0.751 Vali Loss: 0.801 Vali Acc: 0.875 Test Loss: 0.801 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874992).  Saving model ...
Epoch: 22 cost time: 0.4767477512359619
Epoch: 22, Steps: 3 | Train Loss: 0.694 Vali Loss: 0.779 Vali Acc: 0.875 Test Loss: 0.779 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874992).  Saving model ...
Epoch: 23 cost time: 0.46512627601623535
Epoch: 23, Steps: 3 | Train Loss: 0.665 Vali Loss: 0.758 Vali Acc: 0.875 Test Loss: 0.758 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874992).  Saving model ...
Epoch: 24 cost time: 0.4705038070678711
Epoch: 24, Steps: 3 | Train Loss: 0.686 Vali Loss: 0.735 Vali Acc: 0.875 Test Loss: 0.735 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874993).  Saving model ...
Epoch: 25 cost time: 0.4601132869720459
Epoch: 25, Steps: 3 | Train Loss: 0.629 Vali Loss: 0.706 Vali Acc: 0.875 Test Loss: 0.706 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 26 cost time: 0.4721992015838623
Epoch: 26, Steps: 3 | Train Loss: 0.604 Vali Loss: 0.684 Vali Acc: 0.925 Test Loss: 0.684 Test Acc: 0.925
Validation loss decreased (-0.874993 --> -0.924993).  Saving model ...
Epoch: 27 cost time: 0.41411662101745605
Epoch: 27, Steps: 3 | Train Loss: 0.583 Vali Loss: 0.666 Vali Acc: 0.925 Test Loss: 0.666 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924993).  Saving model ...
Epoch: 28 cost time: 0.4487781524658203
Epoch: 28, Steps: 3 | Train Loss: 0.567 Vali Loss: 0.646 Vali Acc: 0.925 Test Loss: 0.646 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924994).  Saving model ...
Epoch: 29 cost time: 0.48035168647766113
Epoch: 29, Steps: 3 | Train Loss: 0.550 Vali Loss: 0.632 Vali Acc: 0.925 Test Loss: 0.632 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 30 cost time: 0.4669017791748047
Epoch: 30, Steps: 3 | Train Loss: 0.520 Vali Loss: 0.602 Vali Acc: 0.925 Test Loss: 0.602 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 31 cost time: 0.42961812019348145
Epoch: 31, Steps: 3 | Train Loss: 0.474 Vali Loss: 0.584 Vali Acc: 0.950 Test Loss: 0.584 Test Acc: 0.950
Validation loss decreased (-0.924994 --> -0.949994).  Saving model ...
Epoch: 32 cost time: 0.4816780090332031
Epoch: 32, Steps: 3 | Train Loss: 0.476 Vali Loss: 0.559 Vali Acc: 0.950 Test Loss: 0.559 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949994).  Saving model ...
Epoch: 33 cost time: 0.4192328453063965
Epoch: 33, Steps: 3 | Train Loss: 0.450 Vali Loss: 0.552 Vali Acc: 0.950 Test Loss: 0.552 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949994).  Saving model ...
Epoch: 34 cost time: 0.45813798904418945
Epoch: 34, Steps: 3 | Train Loss: 0.409 Vali Loss: 0.526 Vali Acc: 0.950 Test Loss: 0.526 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 35 cost time: 0.5000026226043701
Epoch: 35, Steps: 3 | Train Loss: 0.398 Vali Loss: 0.517 Vali Acc: 0.950 Test Loss: 0.517 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 36 cost time: 0.45398402214050293
Epoch: 36, Steps: 3 | Train Loss: 0.389 Vali Loss: 0.496 Vali Acc: 0.950 Test Loss: 0.496 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 37 cost time: 0.45969629287719727
Epoch: 37, Steps: 3 | Train Loss: 0.369 Vali Loss: 0.478 Vali Acc: 0.950 Test Loss: 0.478 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 38 cost time: 0.43222689628601074
Epoch: 38, Steps: 3 | Train Loss: 0.367 Vali Loss: 0.461 Vali Acc: 0.950 Test Loss: 0.461 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 39 cost time: 0.4174811840057373
Epoch: 39, Steps: 3 | Train Loss: 0.335 Vali Loss: 0.443 Vali Acc: 0.925 Test Loss: 0.443 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.4574894905090332
Epoch: 40, Steps: 3 | Train Loss: 0.315 Vali Loss: 0.428 Vali Acc: 0.925 Test Loss: 0.428 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.3916201591491699
Epoch: 41, Steps: 3 | Train Loss: 0.315 Vali Loss: 0.423 Vali Acc: 0.925 Test Loss: 0.423 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.39458441734313965
Epoch: 42, Steps: 3 | Train Loss: 0.310 Vali Loss: 0.407 Vali Acc: 0.950 Test Loss: 0.407 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 43 cost time: 0.41770386695861816
Epoch: 43, Steps: 3 | Train Loss: 0.288 Vali Loss: 0.386 Vali Acc: 0.950 Test Loss: 0.386 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 44 cost time: 0.4635004997253418
Epoch: 44, Steps: 3 | Train Loss: 0.279 Vali Loss: 0.371 Vali Acc: 0.950 Test Loss: 0.371 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 45 cost time: 0.5803046226501465
Epoch: 45, Steps: 3 | Train Loss: 0.259 Vali Loss: 0.360 Vali Acc: 0.950 Test Loss: 0.360 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 46 cost time: 0.4121558666229248
Epoch: 46, Steps: 3 | Train Loss: 0.249 Vali Loss: 0.356 Vali Acc: 0.950 Test Loss: 0.356 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 47 cost time: 0.42660951614379883
Epoch: 47, Steps: 3 | Train Loss: 0.245 Vali Loss: 0.340 Vali Acc: 0.950 Test Loss: 0.340 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 48 cost time: 0.4050719738006592
Epoch: 48, Steps: 3 | Train Loss: 0.212 Vali Loss: 0.330 Vali Acc: 0.950 Test Loss: 0.330 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 49 cost time: 0.5169532299041748
Epoch: 49, Steps: 3 | Train Loss: 0.217 Vali Loss: 0.326 Vali Acc: 0.950 Test Loss: 0.326 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 50 cost time: 0.455045223236084
Epoch: 50, Steps: 3 | Train Loss: 0.224 Vali Loss: 0.311 Vali Acc: 0.975 Test Loss: 0.311 Test Acc: 0.975
Validation loss decreased (-0.949997 --> -0.974997).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps25_str13_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 303300
model size : 1.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.9397945404052734
Epoch: 1, Steps: 3 | Train Loss: 1.284 Vali Loss: 1.289 Vali Acc: 0.300 Test Loss: 1.289 Test Acc: 0.300
Validation loss decreased (inf --> -0.299987).  Saving model ...
Epoch: 2 cost time: 0.5939652919769287
Epoch: 2, Steps: 3 | Train Loss: 1.193 Vali Loss: 1.225 Vali Acc: 0.375 Test Loss: 1.225 Test Acc: 0.375
Validation loss decreased (-0.299987 --> -0.374988).  Saving model ...
Epoch: 3 cost time: 0.6703958511352539
Epoch: 3, Steps: 3 | Train Loss: 1.044 Vali Loss: 1.096 Vali Acc: 0.600 Test Loss: 1.096 Test Acc: 0.600
Validation loss decreased (-0.374988 --> -0.599989).  Saving model ...
Epoch: 4 cost time: 0.5810353755950928
Epoch: 4, Steps: 3 | Train Loss: 0.833 Vali Loss: 0.936 Vali Acc: 0.775 Test Loss: 0.936 Test Acc: 0.775
Validation loss decreased (-0.599989 --> -0.774991).  Saving model ...
Epoch: 5 cost time: 0.6768908500671387
Epoch: 5, Steps: 3 | Train Loss: 0.671 Vali Loss: 0.761 Vali Acc: 0.925 Test Loss: 0.761 Test Acc: 0.925
Validation loss decreased (-0.774991 --> -0.924992).  Saving model ...
Epoch: 6 cost time: 0.6508915424346924
Epoch: 6, Steps: 3 | Train Loss: 0.496 Vali Loss: 0.601 Vali Acc: 0.950 Test Loss: 0.601 Test Acc: 0.950
Validation loss decreased (-0.924992 --> -0.949994).  Saving model ...
Epoch: 7 cost time: 0.6200149059295654
Epoch: 7, Steps: 3 | Train Loss: 0.367 Vali Loss: 0.468 Vali Acc: 0.950 Test Loss: 0.468 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 8 cost time: 0.5699427127838135
Epoch: 8, Steps: 3 | Train Loss: 0.268 Vali Loss: 0.370 Vali Acc: 0.950 Test Loss: 0.370 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 9 cost time: 0.6488096714019775
Epoch: 9, Steps: 3 | Train Loss: 0.208 Vali Loss: 0.305 Vali Acc: 0.975 Test Loss: 0.305 Test Acc: 0.975
Validation loss decreased (-0.949996 --> -0.974997).  Saving model ...
Epoch: 10 cost time: 0.5568616390228271
Epoch: 10, Steps: 3 | Train Loss: 0.169 Vali Loss: 0.254 Vali Acc: 0.975 Test Loss: 0.254 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 11 cost time: 0.5792381763458252
Epoch: 11, Steps: 3 | Train Loss: 0.138 Vali Loss: 0.222 Vali Acc: 0.975 Test Loss: 0.222 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 12 cost time: 0.6499152183532715
Epoch: 12, Steps: 3 | Train Loss: 0.098 Vali Loss: 0.191 Vali Acc: 0.975 Test Loss: 0.191 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 13 cost time: 0.5830874443054199
Epoch: 13, Steps: 3 | Train Loss: 0.076 Vali Loss: 0.172 Vali Acc: 0.975 Test Loss: 0.172 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 14 cost time: 0.6273200511932373
Epoch: 14, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.160 Vali Acc: 0.975 Test Loss: 0.160 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 15 cost time: 0.526944637298584
Epoch: 15, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.150 Vali Acc: 0.950 Test Loss: 0.150 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5571286678314209
Epoch: 16, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.147 Vali Acc: 0.950 Test Loss: 0.147 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.4725608825683594
Epoch: 17, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.147 Vali Acc: 0.950 Test Loss: 0.147 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.4780232906341553
Epoch: 18, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.152 Vali Acc: 0.950 Test Loss: 0.152 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.4711337089538574
Epoch: 19, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.161 Vali Acc: 0.950 Test Loss: 0.161 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.5625231266021729
Epoch: 20, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.180 Vali Acc: 0.950 Test Loss: 0.180 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.5569217205047607
Epoch: 21, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.189 Vali Acc: 0.950 Test Loss: 0.189 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.5904271602630615
Epoch: 22, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.192 Vali Acc: 0.950 Test Loss: 0.192 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.5783059597015381
Epoch: 23, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.198 Vali Acc: 0.925 Test Loss: 0.198 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.589500904083252
Epoch: 24, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.213 Vali Acc: 0.925 Test Loss: 0.213 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 4328452
model size : 16.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.7946813106536865
Epoch: 1, Steps: 3 | Train Loss: 1.360 Vali Loss: 1.355 Vali Acc: 0.525 Test Loss: 1.355 Test Acc: 0.525
Validation loss decreased (inf --> -0.524986).  Saving model ...
Epoch: 2 cost time: 0.48882603645324707
Epoch: 2, Steps: 3 | Train Loss: 1.284 Vali Loss: 1.302 Vali Acc: 0.600 Test Loss: 1.302 Test Acc: 0.600
Validation loss decreased (-0.524986 --> -0.599987).  Saving model ...
Epoch: 3 cost time: 0.5090155601501465
Epoch: 3, Steps: 3 | Train Loss: 1.168 Vali Loss: 1.196 Vali Acc: 0.700 Test Loss: 1.196 Test Acc: 0.700
Validation loss decreased (-0.599987 --> -0.699988).  Saving model ...
Epoch: 4 cost time: 0.589780330657959
Epoch: 4, Steps: 3 | Train Loss: 0.998 Vali Loss: 1.061 Vali Acc: 0.800 Test Loss: 1.061 Test Acc: 0.800
Validation loss decreased (-0.699988 --> -0.799989).  Saving model ...
Epoch: 5 cost time: 0.49890613555908203
Epoch: 5, Steps: 3 | Train Loss: 0.802 Vali Loss: 0.912 Vali Acc: 0.875 Test Loss: 0.912 Test Acc: 0.875
Validation loss decreased (-0.799989 --> -0.874991).  Saving model ...
Epoch: 6 cost time: 0.6158344745635986
Epoch: 6, Steps: 3 | Train Loss: 0.637 Vali Loss: 0.771 Vali Acc: 0.950 Test Loss: 0.771 Test Acc: 0.950
Validation loss decreased (-0.874991 --> -0.949992).  Saving model ...
Epoch: 7 cost time: 0.5194506645202637
Epoch: 7, Steps: 3 | Train Loss: 0.566 Vali Loss: 0.621 Vali Acc: 0.950 Test Loss: 0.621 Test Acc: 0.950
Validation loss decreased (-0.949992 --> -0.949994).  Saving model ...
Epoch: 8 cost time: 0.5738086700439453
Epoch: 8, Steps: 3 | Train Loss: 0.414 Vali Loss: 0.505 Vali Acc: 0.975 Test Loss: 0.505 Test Acc: 0.975
Validation loss decreased (-0.949994 --> -0.974995).  Saving model ...
Epoch: 9 cost time: 0.6006717681884766
Epoch: 9, Steps: 3 | Train Loss: 0.317 Vali Loss: 0.418 Vali Acc: 0.950 Test Loss: 0.418 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5455212593078613
Epoch: 10, Steps: 3 | Train Loss: 0.261 Vali Loss: 0.358 Vali Acc: 0.950 Test Loss: 0.358 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5315477848052979
Epoch: 11, Steps: 3 | Train Loss: 0.241 Vali Loss: 0.315 Vali Acc: 0.975 Test Loss: 0.315 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974997).  Saving model ...
Epoch: 12 cost time: 0.5424022674560547
Epoch: 12, Steps: 3 | Train Loss: 0.193 Vali Loss: 0.283 Vali Acc: 0.975 Test Loss: 0.283 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 13 cost time: 0.557786226272583
Epoch: 13, Steps: 3 | Train Loss: 0.143 Vali Loss: 0.260 Vali Acc: 0.950 Test Loss: 0.260 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5304732322692871
Epoch: 14, Steps: 3 | Train Loss: 0.105 Vali Loss: 0.230 Vali Acc: 0.950 Test Loss: 0.230 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.578038215637207
Epoch: 15, Steps: 3 | Train Loss: 0.086 Vali Loss: 0.212 Vali Acc: 0.950 Test Loss: 0.212 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.4989931583404541
Epoch: 16, Steps: 3 | Train Loss: 0.071 Vali Loss: 0.200 Vali Acc: 0.950 Test Loss: 0.200 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.5106675624847412
Epoch: 17, Steps: 3 | Train Loss: 0.062 Vali Loss: 0.192 Vali Acc: 0.950 Test Loss: 0.192 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.5578911304473877
Epoch: 18, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.192 Vali Acc: 0.950 Test Loss: 0.192 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.6243395805358887
Epoch: 19, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.193 Vali Acc: 0.950 Test Loss: 0.193 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.517981767654419
Epoch: 20, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.191 Vali Acc: 0.950 Test Loss: 0.191 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.49774885177612305
Epoch: 21, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.190 Vali Acc: 0.950 Test Loss: 0.190 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.5441110134124756
Epoch: 22, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.194 Vali Acc: 0.950 Test Loss: 0.194 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 4279556
model size : 16.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.858064889907837
Epoch: 1, Steps: 3 | Train Loss: 1.333 Vali Loss: 1.347 Vali Acc: 0.475 Test Loss: 1.347 Test Acc: 0.475
Validation loss decreased (inf --> -0.474987).  Saving model ...
Epoch: 2 cost time: 0.5464754104614258
Epoch: 2, Steps: 3 | Train Loss: 1.287 Vali Loss: 1.300 Vali Acc: 0.550 Test Loss: 1.300 Test Acc: 0.550
Validation loss decreased (-0.474987 --> -0.549987).  Saving model ...
Epoch: 3 cost time: 0.6835830211639404
Epoch: 3, Steps: 3 | Train Loss: 1.139 Vali Loss: 1.211 Vali Acc: 0.575 Test Loss: 1.211 Test Acc: 0.575
Validation loss decreased (-0.549987 --> -0.574988).  Saving model ...
Epoch: 4 cost time: 0.6027352809906006
Epoch: 4, Steps: 3 | Train Loss: 1.000 Vali Loss: 1.089 Vali Acc: 0.750 Test Loss: 1.089 Test Acc: 0.750
Validation loss decreased (-0.574988 --> -0.749989).  Saving model ...
Epoch: 5 cost time: 0.6503138542175293
Epoch: 5, Steps: 3 | Train Loss: 0.839 Vali Loss: 0.960 Vali Acc: 0.875 Test Loss: 0.960 Test Acc: 0.875
Validation loss decreased (-0.749989 --> -0.874990).  Saving model ...
Epoch: 6 cost time: 0.537959098815918
Epoch: 6, Steps: 3 | Train Loss: 0.705 Vali Loss: 0.819 Vali Acc: 0.900 Test Loss: 0.819 Test Acc: 0.900
Validation loss decreased (-0.874990 --> -0.899992).  Saving model ...
Epoch: 7 cost time: 0.53965163230896
Epoch: 7, Steps: 3 | Train Loss: 0.595 Vali Loss: 0.688 Vali Acc: 0.925 Test Loss: 0.688 Test Acc: 0.925
Validation loss decreased (-0.899992 --> -0.924993).  Saving model ...
Epoch: 8 cost time: 0.5802028179168701
Epoch: 8, Steps: 3 | Train Loss: 0.490 Vali Loss: 0.575 Vali Acc: 0.950 Test Loss: 0.575 Test Acc: 0.950
Validation loss decreased (-0.924993 --> -0.949994).  Saving model ...
Epoch: 9 cost time: 0.582587480545044
Epoch: 9, Steps: 3 | Train Loss: 0.377 Vali Loss: 0.481 Vali Acc: 0.975 Test Loss: 0.481 Test Acc: 0.975
Validation loss decreased (-0.949994 --> -0.974995).  Saving model ...
Epoch: 10 cost time: 0.6150915622711182
Epoch: 10, Steps: 3 | Train Loss: 0.304 Vali Loss: 0.409 Vali Acc: 0.975 Test Loss: 0.409 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 11 cost time: 0.5451054573059082
Epoch: 11, Steps: 3 | Train Loss: 0.254 Vali Loss: 0.353 Vali Acc: 0.975 Test Loss: 0.353 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 12 cost time: 0.547398567199707
Epoch: 12, Steps: 3 | Train Loss: 0.202 Vali Loss: 0.311 Vali Acc: 0.975 Test Loss: 0.311 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 13 cost time: 0.49665188789367676
Epoch: 13, Steps: 3 | Train Loss: 0.179 Vali Loss: 0.282 Vali Acc: 0.975 Test Loss: 0.282 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 14 cost time: 0.5544097423553467
Epoch: 14, Steps: 3 | Train Loss: 0.150 Vali Loss: 0.252 Vali Acc: 0.975 Test Loss: 0.252 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 15 cost time: 0.5563125610351562
Epoch: 15, Steps: 3 | Train Loss: 0.125 Vali Loss: 0.237 Vali Acc: 0.975 Test Loss: 0.237 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 16 cost time: 0.5807673931121826
Epoch: 16, Steps: 3 | Train Loss: 0.119 Vali Loss: 0.222 Vali Acc: 0.975 Test Loss: 0.222 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 17 cost time: 0.6354374885559082
Epoch: 17, Steps: 3 | Train Loss: 0.100 Vali Loss: 0.208 Vali Acc: 0.975 Test Loss: 0.208 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 18 cost time: 0.4465959072113037
Epoch: 18, Steps: 3 | Train Loss: 0.074 Vali Loss: 0.197 Vali Acc: 0.975 Test Loss: 0.197 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 19 cost time: 0.5188517570495605
Epoch: 19, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.184 Vali Acc: 0.975 Test Loss: 0.184 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 20 cost time: 0.5311026573181152
Epoch: 20, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.183 Vali Acc: 0.975 Test Loss: 0.183 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 21 cost time: 0.583383321762085
Epoch: 21, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.172 Vali Acc: 0.975 Test Loss: 0.172 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 22 cost time: 0.5130312442779541
Epoch: 22, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.154 Vali Acc: 0.975 Test Loss: 0.154 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 23 cost time: 0.5431158542633057
Epoch: 23, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.146 Vali Acc: 0.975 Test Loss: 0.146 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974999).  Saving model ...
Epoch: 24 cost time: 0.49181532859802246
Epoch: 24, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.142 Vali Acc: 0.975 Test Loss: 0.142 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 25 cost time: 0.5140092372894287
Epoch: 25, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.140 Vali Acc: 0.975 Test Loss: 0.140 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 26 cost time: 0.47199130058288574
Epoch: 26, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.146 Vali Acc: 0.950 Test Loss: 0.146 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5307672023773193
Epoch: 27, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.142 Vali Acc: 0.950 Test Loss: 0.142 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.5198159217834473
Epoch: 28, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.139 Vali Acc: 0.950 Test Loss: 0.139 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.5335824489593506
Epoch: 29, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.128 Vali Acc: 0.950 Test Loss: 0.128 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.5437428951263428
Epoch: 30, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.126 Vali Acc: 0.950 Test Loss: 0.126 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.4477057456970215
Epoch: 31, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.127 Vali Acc: 0.950 Test Loss: 0.127 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.5821239948272705
Epoch: 32, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.129 Vali Acc: 0.950 Test Loss: 0.129 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.5960288047790527
Epoch: 33, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.131 Vali Acc: 0.950 Test Loss: 0.131 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.53853440284729
Epoch: 34, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.133 Vali Acc: 0.950 Test Loss: 0.133 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.5676419734954834
Epoch: 35, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.132 Vali Acc: 0.950 Test Loss: 0.132 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 4255364
model size : 16.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.910909652709961
Epoch: 1, Steps: 3 | Train Loss: 1.414 Vali Loss: 1.379 Vali Acc: 0.375 Test Loss: 1.379 Test Acc: 0.375
Validation loss decreased (inf --> -0.374986).  Saving model ...
Epoch: 2 cost time: 0.5036106109619141
Epoch: 2, Steps: 3 | Train Loss: 1.327 Vali Loss: 1.341 Vali Acc: 0.450 Test Loss: 1.341 Test Acc: 0.450
Validation loss decreased (-0.374986 --> -0.449987).  Saving model ...
Epoch: 3 cost time: 0.485105037689209
Epoch: 3, Steps: 3 | Train Loss: 1.233 Vali Loss: 1.269 Vali Acc: 0.550 Test Loss: 1.269 Test Acc: 0.550
Validation loss decreased (-0.449987 --> -0.549987).  Saving model ...
Epoch: 4 cost time: 0.564265251159668
Epoch: 4, Steps: 3 | Train Loss: 1.088 Vali Loss: 1.174 Vali Acc: 0.600 Test Loss: 1.174 Test Acc: 0.600
Validation loss decreased (-0.549987 --> -0.599988).  Saving model ...
Epoch: 5 cost time: 0.5268235206604004
Epoch: 5, Steps: 3 | Train Loss: 0.942 Vali Loss: 1.060 Vali Acc: 0.775 Test Loss: 1.060 Test Acc: 0.775
Validation loss decreased (-0.599988 --> -0.774989).  Saving model ...
Epoch: 6 cost time: 0.5312669277191162
Epoch: 6, Steps: 3 | Train Loss: 0.819 Vali Loss: 0.933 Vali Acc: 0.825 Test Loss: 0.933 Test Acc: 0.825
Validation loss decreased (-0.774989 --> -0.824991).  Saving model ...
Epoch: 7 cost time: 0.5134012699127197
Epoch: 7, Steps: 3 | Train Loss: 0.684 Vali Loss: 0.811 Vali Acc: 0.825 Test Loss: 0.811 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824992).  Saving model ...
Epoch: 8 cost time: 0.5002868175506592
Epoch: 8, Steps: 3 | Train Loss: 0.573 Vali Loss: 0.699 Vali Acc: 0.850 Test Loss: 0.699 Test Acc: 0.850
Validation loss decreased (-0.824992 --> -0.849993).  Saving model ...
Epoch: 9 cost time: 0.4976043701171875
Epoch: 9, Steps: 3 | Train Loss: 0.467 Vali Loss: 0.603 Vali Acc: 0.900 Test Loss: 0.603 Test Acc: 0.900
Validation loss decreased (-0.849993 --> -0.899994).  Saving model ...
Epoch: 10 cost time: 0.5237720012664795
Epoch: 10, Steps: 3 | Train Loss: 0.367 Vali Loss: 0.510 Vali Acc: 0.950 Test Loss: 0.510 Test Acc: 0.950
Validation loss decreased (-0.899994 --> -0.949995).  Saving model ...
Epoch: 11 cost time: 0.4255399703979492
Epoch: 11, Steps: 3 | Train Loss: 0.325 Vali Loss: 0.433 Vali Acc: 0.950 Test Loss: 0.433 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 12 cost time: 0.4932136535644531
Epoch: 12, Steps: 3 | Train Loss: 0.328 Vali Loss: 0.378 Vali Acc: 0.950 Test Loss: 0.378 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 13 cost time: 0.497434139251709
Epoch: 13, Steps: 3 | Train Loss: 0.242 Vali Loss: 0.342 Vali Acc: 0.950 Test Loss: 0.342 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 14 cost time: 0.5185134410858154
Epoch: 14, Steps: 3 | Train Loss: 0.201 Vali Loss: 0.314 Vali Acc: 0.950 Test Loss: 0.314 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 15 cost time: 0.5951666831970215
Epoch: 15, Steps: 3 | Train Loss: 0.180 Vali Loss: 0.285 Vali Acc: 0.975 Test Loss: 0.285 Test Acc: 0.975
Validation loss decreased (-0.949997 --> -0.974997).  Saving model ...
Epoch: 16 cost time: 0.5448529720306396
Epoch: 16, Steps: 3 | Train Loss: 0.156 Vali Loss: 0.263 Vali Acc: 0.975 Test Loss: 0.263 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 17 cost time: 0.6114025115966797
Epoch: 17, Steps: 3 | Train Loss: 0.133 Vali Loss: 0.239 Vali Acc: 0.975 Test Loss: 0.239 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 18 cost time: 0.538811206817627
Epoch: 18, Steps: 3 | Train Loss: 0.117 Vali Loss: 0.228 Vali Acc: 0.975 Test Loss: 0.228 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 19 cost time: 0.5332190990447998
Epoch: 19, Steps: 3 | Train Loss: 0.097 Vali Loss: 0.211 Vali Acc: 0.975 Test Loss: 0.211 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 20 cost time: 0.5119321346282959
Epoch: 20, Steps: 3 | Train Loss: 0.081 Vali Loss: 0.194 Vali Acc: 0.975 Test Loss: 0.194 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 21 cost time: 0.4841115474700928
Epoch: 21, Steps: 3 | Train Loss: 0.090 Vali Loss: 0.192 Vali Acc: 0.975 Test Loss: 0.192 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 22 cost time: 0.5471997261047363
Epoch: 22, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.181 Vali Acc: 0.975 Test Loss: 0.181 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 23 cost time: 0.45114779472351074
Epoch: 23, Steps: 3 | Train Loss: 0.058 Vali Loss: 0.181 Vali Acc: 0.950 Test Loss: 0.181 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.5636827945709229
Epoch: 24, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.181 Vali Acc: 0.950 Test Loss: 0.181 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.4812905788421631
Epoch: 25, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.187 Vali Acc: 0.950 Test Loss: 0.187 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.5865120887756348
Epoch: 26, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.188 Vali Acc: 0.950 Test Loss: 0.188 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.5179271697998047
Epoch: 27, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.187 Vali Acc: 0.950 Test Loss: 0.187 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.564488410949707
Epoch: 28, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.180 Vali Acc: 0.950 Test Loss: 0.180 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.4699273109436035
Epoch: 29, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.185 Vali Acc: 0.950 Test Loss: 0.185 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.5771071910858154
Epoch: 30, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.193 Vali Acc: 0.925 Test Loss: 0.193 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.550994873046875
Epoch: 31, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.194 Vali Acc: 0.925 Test Loss: 0.194 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.5760293006896973
Epoch: 32, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.193 Vali Acc: 0.925 Test Loss: 0.193 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 4237188
model size : 16.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.7240707874298096
Epoch: 1, Steps: 3 | Train Loss: 1.458 Vali Loss: 1.435 Vali Acc: 0.400 Test Loss: 1.435 Test Acc: 0.400
Validation loss decreased (inf --> -0.399986).  Saving model ...
Epoch: 2 cost time: 0.5432469844818115
Epoch: 2, Steps: 3 | Train Loss: 1.355 Vali Loss: 1.409 Vali Acc: 0.425 Test Loss: 1.409 Test Acc: 0.425
Validation loss decreased (-0.399986 --> -0.424986).  Saving model ...
Epoch: 3 cost time: 0.5155673027038574
Epoch: 3, Steps: 3 | Train Loss: 1.266 Vali Loss: 1.360 Vali Acc: 0.500 Test Loss: 1.360 Test Acc: 0.500
Validation loss decreased (-0.424986 --> -0.499986).  Saving model ...
Epoch: 4 cost time: 0.5055713653564453
Epoch: 4, Steps: 3 | Train Loss: 1.198 Vali Loss: 1.284 Vali Acc: 0.525 Test Loss: 1.284 Test Acc: 0.525
Validation loss decreased (-0.499986 --> -0.524987).  Saving model ...
Epoch: 5 cost time: 0.6299045085906982
Epoch: 5, Steps: 3 | Train Loss: 1.022 Vali Loss: 1.197 Vali Acc: 0.650 Test Loss: 1.197 Test Acc: 0.650
Validation loss decreased (-0.524987 --> -0.649988).  Saving model ...
Epoch: 6 cost time: 0.49367284774780273
Epoch: 6, Steps: 3 | Train Loss: 0.916 Vali Loss: 1.100 Vali Acc: 0.725 Test Loss: 1.100 Test Acc: 0.725
Validation loss decreased (-0.649988 --> -0.724989).  Saving model ...
Epoch: 7 cost time: 0.48260974884033203
Epoch: 7, Steps: 3 | Train Loss: 0.821 Vali Loss: 1.001 Vali Acc: 0.775 Test Loss: 1.001 Test Acc: 0.775
Validation loss decreased (-0.724989 --> -0.774990).  Saving model ...
Epoch: 8 cost time: 0.554495096206665
Epoch: 8, Steps: 3 | Train Loss: 0.724 Vali Loss: 0.906 Vali Acc: 0.775 Test Loss: 0.906 Test Acc: 0.775
Validation loss decreased (-0.774990 --> -0.774991).  Saving model ...
Epoch: 9 cost time: 0.46779799461364746
Epoch: 9, Steps: 3 | Train Loss: 0.656 Vali Loss: 0.815 Vali Acc: 0.825 Test Loss: 0.815 Test Acc: 0.825
Validation loss decreased (-0.774991 --> -0.824992).  Saving model ...
Epoch: 10 cost time: 0.5212504863739014
Epoch: 10, Steps: 3 | Train Loss: 0.572 Vali Loss: 0.725 Vali Acc: 0.875 Test Loss: 0.725 Test Acc: 0.875
Validation loss decreased (-0.824992 --> -0.874993).  Saving model ...
Epoch: 11 cost time: 0.509812593460083
Epoch: 11, Steps: 3 | Train Loss: 0.465 Vali Loss: 0.658 Vali Acc: 0.900 Test Loss: 0.658 Test Acc: 0.900
Validation loss decreased (-0.874993 --> -0.899993).  Saving model ...
Epoch: 12 cost time: 0.49425840377807617
Epoch: 12, Steps: 3 | Train Loss: 0.433 Vali Loss: 0.602 Vali Acc: 0.900 Test Loss: 0.602 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899994).  Saving model ...
Epoch: 13 cost time: 0.5004429817199707
Epoch: 13, Steps: 3 | Train Loss: 0.370 Vali Loss: 0.549 Vali Acc: 0.900 Test Loss: 0.549 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 14 cost time: 0.5047726631164551
Epoch: 14, Steps: 3 | Train Loss: 0.342 Vali Loss: 0.504 Vali Acc: 0.900 Test Loss: 0.504 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 15 cost time: 0.6523635387420654
Epoch: 15, Steps: 3 | Train Loss: 0.281 Vali Loss: 0.471 Vali Acc: 0.900 Test Loss: 0.471 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 16 cost time: 0.5546164512634277
Epoch: 16, Steps: 3 | Train Loss: 0.280 Vali Loss: 0.437 Vali Acc: 0.900 Test Loss: 0.437 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 17 cost time: 0.4459817409515381
Epoch: 17, Steps: 3 | Train Loss: 0.204 Vali Loss: 0.395 Vali Acc: 0.900 Test Loss: 0.395 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 18 cost time: 0.478161096572876
Epoch: 18, Steps: 3 | Train Loss: 0.191 Vali Loss: 0.367 Vali Acc: 0.900 Test Loss: 0.367 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 19 cost time: 0.5006649494171143
Epoch: 19, Steps: 3 | Train Loss: 0.180 Vali Loss: 0.353 Vali Acc: 0.925 Test Loss: 0.353 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924996).  Saving model ...
Epoch: 20 cost time: 0.4359924793243408
Epoch: 20, Steps: 3 | Train Loss: 0.168 Vali Loss: 0.339 Vali Acc: 0.925 Test Loss: 0.339 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924997).  Saving model ...
Epoch: 21 cost time: 0.5027472972869873
Epoch: 21, Steps: 3 | Train Loss: 0.176 Vali Loss: 0.328 Vali Acc: 0.925 Test Loss: 0.328 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 22 cost time: 0.5746605396270752
Epoch: 22, Steps: 3 | Train Loss: 0.138 Vali Loss: 0.319 Vali Acc: 0.950 Test Loss: 0.319 Test Acc: 0.950
Validation loss decreased (-0.924997 --> -0.949997).  Saving model ...
Epoch: 23 cost time: 0.48410677909851074
Epoch: 23, Steps: 3 | Train Loss: 0.115 Vali Loss: 0.303 Vali Acc: 0.950 Test Loss: 0.303 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 24 cost time: 0.46256017684936523
Epoch: 24, Steps: 3 | Train Loss: 0.116 Vali Loss: 0.295 Vali Acc: 0.950 Test Loss: 0.295 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 25 cost time: 0.5931074619293213
Epoch: 25, Steps: 3 | Train Loss: 0.109 Vali Loss: 0.294 Vali Acc: 0.950 Test Loss: 0.294 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 26 cost time: 0.5025358200073242
Epoch: 26, Steps: 3 | Train Loss: 0.080 Vali Loss: 0.287 Vali Acc: 0.950 Test Loss: 0.287 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 27 cost time: 0.5107779502868652
Epoch: 27, Steps: 3 | Train Loss: 0.070 Vali Loss: 0.278 Vali Acc: 0.950 Test Loss: 0.278 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 28 cost time: 0.5152742862701416
Epoch: 28, Steps: 3 | Train Loss: 0.063 Vali Loss: 0.275 Vali Acc: 0.950 Test Loss: 0.275 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 29 cost time: 0.5089130401611328
Epoch: 29, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.275 Vali Acc: 0.950 Test Loss: 0.275 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.49949049949645996
Epoch: 30, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.265 Vali Acc: 0.950 Test Loss: 0.265 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 31 cost time: 0.5084841251373291
Epoch: 31, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.271 Vali Acc: 0.950 Test Loss: 0.271 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.5020833015441895
Epoch: 32, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.251 Vali Acc: 0.950 Test Loss: 0.251 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 33 cost time: 0.48304295539855957
Epoch: 33, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.261 Vali Acc: 0.950 Test Loss: 0.261 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.49567317962646484
Epoch: 34, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.267 Vali Acc: 0.950 Test Loss: 0.267 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.521324872970581
Epoch: 35, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.268 Vali Acc: 0.950 Test Loss: 0.268 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.5506730079650879
Epoch: 36, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.264 Vali Acc: 0.950 Test Loss: 0.264 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.5568337440490723
Epoch: 37, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.256 Vali Acc: 0.950 Test Loss: 0.256 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.5469968318939209
Epoch: 38, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.250 Vali Acc: 0.950 Test Loss: 0.250 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 39 cost time: 0.4788992404937744
Epoch: 39, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.253 Vali Acc: 0.950 Test Loss: 0.253 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.4855532646179199
Epoch: 40, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.258 Vali Acc: 0.950 Test Loss: 0.258 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.5223839282989502
Epoch: 41, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.259 Vali Acc: 0.950 Test Loss: 0.259 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.50750732421875
Epoch: 42, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.246 Vali Acc: 0.950 Test Loss: 0.246 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 43 cost time: 0.6359915733337402
Epoch: 43, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.246 Vali Acc: 0.950 Test Loss: 0.246 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 44 cost time: 0.5026156902313232
Epoch: 44, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.238 Vali Acc: 0.950 Test Loss: 0.238 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 45 cost time: 0.5314795970916748
Epoch: 45, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.230 Vali Acc: 0.950 Test Loss: 0.230 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 46 cost time: 0.5200209617614746
Epoch: 46, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.224 Vali Acc: 0.950 Test Loss: 0.224 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 47 cost time: 0.4930574893951416
Epoch: 47, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.233 Vali Acc: 0.950 Test Loss: 0.233 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.5042870044708252
Epoch: 48, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.226 Vali Acc: 0.950 Test Loss: 0.226 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.5165443420410156
Epoch: 49, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.229 Vali Acc: 0.950 Test Loss: 0.229 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.47151875495910645
Epoch: 50, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.225 Vali Acc: 0.950 Test Loss: 0.225 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 4213252
model size : 16.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps20_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.7976508140563965
Epoch: 1, Steps: 3 | Train Loss: 1.484 Vali Loss: 1.434 Vali Acc: 0.225 Test Loss: 1.434 Test Acc: 0.225
Validation loss decreased (inf --> -0.224986).  Saving model ...
Epoch: 2 cost time: 0.5731768608093262
Epoch: 2, Steps: 3 | Train Loss: 1.379 Vali Loss: 1.414 Vali Acc: 0.300 Test Loss: 1.414 Test Acc: 0.300
Validation loss decreased (-0.224986 --> -0.299986).  Saving model ...
Epoch: 3 cost time: 0.5415384769439697
Epoch: 3, Steps: 3 | Train Loss: 1.315 Vali Loss: 1.373 Vali Acc: 0.400 Test Loss: 1.373 Test Acc: 0.400
Validation loss decreased (-0.299986 --> -0.399986).  Saving model ...
Epoch: 4 cost time: 0.6084914207458496
Epoch: 4, Steps: 3 | Train Loss: 1.241 Vali Loss: 1.312 Vali Acc: 0.550 Test Loss: 1.312 Test Acc: 0.550
Validation loss decreased (-0.399986 --> -0.549987).  Saving model ...
Epoch: 5 cost time: 0.5692477226257324
Epoch: 5, Steps: 3 | Train Loss: 1.147 Vali Loss: 1.228 Vali Acc: 0.650 Test Loss: 1.228 Test Acc: 0.650
Validation loss decreased (-0.549987 --> -0.649988).  Saving model ...
Epoch: 6 cost time: 0.5808441638946533
Epoch: 6, Steps: 3 | Train Loss: 1.000 Vali Loss: 1.131 Vali Acc: 0.725 Test Loss: 1.131 Test Acc: 0.725
Validation loss decreased (-0.649988 --> -0.724989).  Saving model ...
Epoch: 7 cost time: 0.6161148548126221
Epoch: 7, Steps: 3 | Train Loss: 0.889 Vali Loss: 1.032 Vali Acc: 0.750 Test Loss: 1.032 Test Acc: 0.750
Validation loss decreased (-0.724989 --> -0.749990).  Saving model ...
Epoch: 8 cost time: 0.514570951461792
Epoch: 8, Steps: 3 | Train Loss: 0.781 Vali Loss: 0.930 Vali Acc: 0.825 Test Loss: 0.930 Test Acc: 0.825
Validation loss decreased (-0.749990 --> -0.824991).  Saving model ...
Epoch: 9 cost time: 0.553720235824585
Epoch: 9, Steps: 3 | Train Loss: 0.694 Vali Loss: 0.827 Vali Acc: 0.850 Test Loss: 0.827 Test Acc: 0.850
Validation loss decreased (-0.824991 --> -0.849992).  Saving model ...
Epoch: 10 cost time: 0.48157286643981934
Epoch: 10, Steps: 3 | Train Loss: 0.607 Vali Loss: 0.736 Vali Acc: 0.850 Test Loss: 0.736 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849993).  Saving model ...
Epoch: 11 cost time: 0.4792947769165039
Epoch: 11, Steps: 3 | Train Loss: 0.529 Vali Loss: 0.660 Vali Acc: 0.900 Test Loss: 0.660 Test Acc: 0.900
Validation loss decreased (-0.849993 --> -0.899993).  Saving model ...
Epoch: 12 cost time: 0.5021998882293701
Epoch: 12, Steps: 3 | Train Loss: 0.449 Vali Loss: 0.591 Vali Acc: 0.850 Test Loss: 0.591 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5563526153564453
Epoch: 13, Steps: 3 | Train Loss: 0.401 Vali Loss: 0.527 Vali Acc: 0.900 Test Loss: 0.527 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899995).  Saving model ...
Epoch: 14 cost time: 0.5735411643981934
Epoch: 14, Steps: 3 | Train Loss: 0.364 Vali Loss: 0.474 Vali Acc: 0.925 Test Loss: 0.474 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924995).  Saving model ...
Epoch: 15 cost time: 0.5302047729492188
Epoch: 15, Steps: 3 | Train Loss: 0.350 Vali Loss: 0.434 Vali Acc: 0.925 Test Loss: 0.434 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 16 cost time: 0.5555484294891357
Epoch: 16, Steps: 3 | Train Loss: 0.294 Vali Loss: 0.405 Vali Acc: 0.925 Test Loss: 0.405 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 17 cost time: 0.6131668090820312
Epoch: 17, Steps: 3 | Train Loss: 0.262 Vali Loss: 0.374 Vali Acc: 0.925 Test Loss: 0.374 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 18 cost time: 0.49085211753845215
Epoch: 18, Steps: 3 | Train Loss: 0.228 Vali Loss: 0.343 Vali Acc: 0.925 Test Loss: 0.343 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924997).  Saving model ...
Epoch: 19 cost time: 0.5060884952545166
Epoch: 19, Steps: 3 | Train Loss: 0.213 Vali Loss: 0.329 Vali Acc: 0.925 Test Loss: 0.329 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 20 cost time: 0.5657978057861328
Epoch: 20, Steps: 3 | Train Loss: 0.196 Vali Loss: 0.309 Vali Acc: 0.925 Test Loss: 0.309 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 21 cost time: 0.4794607162475586
Epoch: 21, Steps: 3 | Train Loss: 0.194 Vali Loss: 0.295 Vali Acc: 0.925 Test Loss: 0.295 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 22 cost time: 0.4081454277038574
Epoch: 22, Steps: 3 | Train Loss: 0.158 Vali Loss: 0.275 Vali Acc: 0.950 Test Loss: 0.275 Test Acc: 0.950
Validation loss decreased (-0.924997 --> -0.949997).  Saving model ...
Epoch: 23 cost time: 0.45995569229125977
Epoch: 23, Steps: 3 | Train Loss: 0.169 Vali Loss: 0.267 Vali Acc: 0.950 Test Loss: 0.267 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 24 cost time: 0.4114377498626709
Epoch: 24, Steps: 3 | Train Loss: 0.153 Vali Loss: 0.260 Vali Acc: 0.950 Test Loss: 0.260 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 25 cost time: 0.4955151081085205
Epoch: 25, Steps: 3 | Train Loss: 0.118 Vali Loss: 0.248 Vali Acc: 0.975 Test Loss: 0.248 Test Acc: 0.975
Validation loss decreased (-0.949997 --> -0.974998).  Saving model ...
Epoch: 26 cost time: 0.606564998626709
Epoch: 26, Steps: 3 | Train Loss: 0.118 Vali Loss: 0.237 Vali Acc: 0.975 Test Loss: 0.237 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 27 cost time: 0.4932279586791992
Epoch: 27, Steps: 3 | Train Loss: 0.102 Vali Loss: 0.227 Vali Acc: 0.975 Test Loss: 0.227 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 28 cost time: 0.479442834854126
Epoch: 28, Steps: 3 | Train Loss: 0.094 Vali Loss: 0.221 Vali Acc: 0.975 Test Loss: 0.221 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 29 cost time: 0.4948108196258545
Epoch: 29, Steps: 3 | Train Loss: 0.080 Vali Loss: 0.217 Vali Acc: 0.975 Test Loss: 0.217 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 30 cost time: 0.4967827796936035
Epoch: 30, Steps: 3 | Train Loss: 0.063 Vali Loss: 0.209 Vali Acc: 0.975 Test Loss: 0.209 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 31 cost time: 0.5125143527984619
Epoch: 31, Steps: 3 | Train Loss: 0.058 Vali Loss: 0.201 Vali Acc: 0.975 Test Loss: 0.201 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 32 cost time: 0.533057451248169
Epoch: 32, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.205 Vali Acc: 0.975 Test Loss: 0.205 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.54443359375
Epoch: 33, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.201 Vali Acc: 0.975 Test Loss: 0.201 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 34 cost time: 0.4798624515533447
Epoch: 34, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.189 Vali Acc: 0.975 Test Loss: 0.189 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 35 cost time: 0.6423287391662598
Epoch: 35, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.182 Vali Acc: 0.975 Test Loss: 0.182 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 36 cost time: 0.5620326995849609
Epoch: 36, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.178 Vali Acc: 0.975 Test Loss: 0.178 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 37 cost time: 0.5760498046875
Epoch: 37, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.173 Vali Acc: 0.975 Test Loss: 0.173 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 38 cost time: 0.5355832576751709
Epoch: 38, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.167 Vali Acc: 0.975 Test Loss: 0.167 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 39 cost time: 0.5725948810577393
Epoch: 39, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.169 Vali Acc: 0.975 Test Loss: 0.169 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.5562100410461426
Epoch: 40, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.172 Vali Acc: 0.975 Test Loss: 0.172 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.5648834705352783
Epoch: 41, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.172 Vali Acc: 0.975 Test Loss: 0.172 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.4936869144439697
Epoch: 42, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.176 Vali Acc: 0.950 Test Loss: 0.176 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.5496337413787842
Epoch: 43, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.177 Vali Acc: 0.950 Test Loss: 0.177 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.5707545280456543
Epoch: 44, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.182 Vali Acc: 0.950 Test Loss: 0.182 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.5452454090118408
Epoch: 45, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.182 Vali Acc: 0.950 Test Loss: 0.182 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.5190393924713135
Epoch: 46, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.180 Vali Acc: 0.950 Test Loss: 0.180 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.51287841796875
Epoch: 47, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.168 Vali Acc: 0.950 Test Loss: 0.168 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 0.5836341381072998
Epoch: 48, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.171 Vali Acc: 0.950 Test Loss: 0.171 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps20_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 4207748
model size : 16.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps25_str13_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.8420653343200684
Epoch: 1, Steps: 3 | Train Loss: 1.429 Vali Loss: 1.393 Vali Acc: 0.225 Test Loss: 1.393 Test Acc: 0.225
Validation loss decreased (inf --> -0.224986).  Saving model ...
Epoch: 2 cost time: 0.5788211822509766
Epoch: 2, Steps: 3 | Train Loss: 1.390 Vali Loss: 1.370 Vali Acc: 0.250 Test Loss: 1.370 Test Acc: 0.250
Validation loss decreased (-0.224986 --> -0.249986).  Saving model ...
Epoch: 3 cost time: 0.5613393783569336
Epoch: 3, Steps: 3 | Train Loss: 1.348 Vali Loss: 1.331 Vali Acc: 0.350 Test Loss: 1.331 Test Acc: 0.350
Validation loss decreased (-0.249986 --> -0.349987).  Saving model ...
Epoch: 4 cost time: 0.5199947357177734
Epoch: 4, Steps: 3 | Train Loss: 1.243 Vali Loss: 1.273 Vali Acc: 0.350 Test Loss: 1.273 Test Acc: 0.350
Validation loss decreased (-0.349987 --> -0.349987).  Saving model ...
Epoch: 5 cost time: 0.479297399520874
Epoch: 5, Steps: 3 | Train Loss: 1.109 Vali Loss: 1.199 Vali Acc: 0.525 Test Loss: 1.199 Test Acc: 0.525
Validation loss decreased (-0.349987 --> -0.524988).  Saving model ...
Epoch: 6 cost time: 0.4757208824157715
Epoch: 6, Steps: 3 | Train Loss: 1.001 Vali Loss: 1.114 Vali Acc: 0.800 Test Loss: 1.114 Test Acc: 0.800
Validation loss decreased (-0.524988 --> -0.799989).  Saving model ...
Epoch: 7 cost time: 0.5349910259246826
Epoch: 7, Steps: 3 | Train Loss: 0.888 Vali Loss: 1.026 Vali Acc: 0.950 Test Loss: 1.026 Test Acc: 0.950
Validation loss decreased (-0.799989 --> -0.949990).  Saving model ...
Epoch: 8 cost time: 0.4783203601837158
Epoch: 8, Steps: 3 | Train Loss: 0.802 Vali Loss: 0.942 Vali Acc: 0.950 Test Loss: 0.942 Test Acc: 0.950
Validation loss decreased (-0.949990 --> -0.949991).  Saving model ...
Epoch: 9 cost time: 0.496596097946167
Epoch: 9, Steps: 3 | Train Loss: 0.726 Vali Loss: 0.851 Vali Acc: 0.950 Test Loss: 0.851 Test Acc: 0.950
Validation loss decreased (-0.949991 --> -0.949991).  Saving model ...
Epoch: 10 cost time: 0.546227216720581
Epoch: 10, Steps: 3 | Train Loss: 0.624 Vali Loss: 0.771 Vali Acc: 0.975 Test Loss: 0.771 Test Acc: 0.975
Validation loss decreased (-0.949991 --> -0.974992).  Saving model ...
Epoch: 11 cost time: 0.5568053722381592
Epoch: 11, Steps: 3 | Train Loss: 0.586 Vali Loss: 0.692 Vali Acc: 0.975 Test Loss: 0.692 Test Acc: 0.975
Validation loss decreased (-0.974992 --> -0.974993).  Saving model ...
Epoch: 12 cost time: 0.5774123668670654
Epoch: 12, Steps: 3 | Train Loss: 0.499 Vali Loss: 0.632 Vali Acc: 0.975 Test Loss: 0.632 Test Acc: 0.975
Validation loss decreased (-0.974993 --> -0.974994).  Saving model ...
Epoch: 13 cost time: 0.5166001319885254
Epoch: 13, Steps: 3 | Train Loss: 0.467 Vali Loss: 0.572 Vali Acc: 0.975 Test Loss: 0.572 Test Acc: 0.975
Validation loss decreased (-0.974994 --> -0.974994).  Saving model ...
Epoch: 14 cost time: 0.6043150424957275
Epoch: 14, Steps: 3 | Train Loss: 0.414 Vali Loss: 0.521 Vali Acc: 0.950 Test Loss: 0.521 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.45369529724121094
Epoch: 15, Steps: 3 | Train Loss: 0.356 Vali Loss: 0.487 Vali Acc: 0.950 Test Loss: 0.487 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.5482079982757568
Epoch: 16, Steps: 3 | Train Loss: 0.320 Vali Loss: 0.448 Vali Acc: 0.950 Test Loss: 0.448 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.5615887641906738
Epoch: 17, Steps: 3 | Train Loss: 0.300 Vali Loss: 0.413 Vali Acc: 0.950 Test Loss: 0.413 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.6062452793121338
Epoch: 18, Steps: 3 | Train Loss: 0.261 Vali Loss: 0.388 Vali Acc: 0.950 Test Loss: 0.388 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.5514845848083496
Epoch: 19, Steps: 3 | Train Loss: 0.237 Vali Loss: 0.367 Vali Acc: 0.950 Test Loss: 0.367 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.564277172088623
Epoch: 20, Steps: 3 | Train Loss: 0.201 Vali Loss: 0.336 Vali Acc: 0.975 Test Loss: 0.336 Test Acc: 0.975
Validation loss decreased (-0.974994 --> -0.974997).  Saving model ...
Epoch: 21 cost time: 0.524848222732544
Epoch: 21, Steps: 3 | Train Loss: 0.185 Vali Loss: 0.318 Vali Acc: 0.975 Test Loss: 0.318 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 22 cost time: 0.5448615550994873
Epoch: 22, Steps: 3 | Train Loss: 0.159 Vali Loss: 0.306 Vali Acc: 0.975 Test Loss: 0.306 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 23 cost time: 0.5926663875579834
Epoch: 23, Steps: 3 | Train Loss: 0.154 Vali Loss: 0.296 Vali Acc: 0.975 Test Loss: 0.296 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 24 cost time: 0.5532238483428955
Epoch: 24, Steps: 3 | Train Loss: 0.137 Vali Loss: 0.282 Vali Acc: 0.975 Test Loss: 0.282 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 25 cost time: 0.5621514320373535
Epoch: 25, Steps: 3 | Train Loss: 0.136 Vali Loss: 0.267 Vali Acc: 0.975 Test Loss: 0.267 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 26 cost time: 0.5299537181854248
Epoch: 26, Steps: 3 | Train Loss: 0.113 Vali Loss: 0.262 Vali Acc: 0.975 Test Loss: 0.262 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 27 cost time: 0.4944138526916504
Epoch: 27, Steps: 3 | Train Loss: 0.130 Vali Loss: 0.252 Vali Acc: 0.975 Test Loss: 0.252 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 28 cost time: 0.5431351661682129
Epoch: 28, Steps: 3 | Train Loss: 0.097 Vali Loss: 0.243 Vali Acc: 0.975 Test Loss: 0.243 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 29 cost time: 0.5201597213745117
Epoch: 29, Steps: 3 | Train Loss: 0.083 Vali Loss: 0.238 Vali Acc: 0.975 Test Loss: 0.238 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 30 cost time: 0.5259060859680176
Epoch: 30, Steps: 3 | Train Loss: 0.083 Vali Loss: 0.234 Vali Acc: 0.975 Test Loss: 0.234 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 31 cost time: 0.5057363510131836
Epoch: 31, Steps: 3 | Train Loss: 0.071 Vali Loss: 0.226 Vali Acc: 0.975 Test Loss: 0.226 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 32 cost time: 0.514507532119751
Epoch: 32, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.220 Vali Acc: 0.975 Test Loss: 0.220 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 33 cost time: 0.5488183498382568
Epoch: 33, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.209 Vali Acc: 0.975 Test Loss: 0.209 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 34 cost time: 0.555861234664917
Epoch: 34, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.206 Vali Acc: 0.975 Test Loss: 0.206 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 35 cost time: 0.4553234577178955
Epoch: 35, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.199 Vali Acc: 0.975 Test Loss: 0.199 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 36 cost time: 0.5396504402160645
Epoch: 36, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.200 Vali Acc: 0.975 Test Loss: 0.200 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.5039317607879639
Epoch: 37, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.201 Vali Acc: 0.975 Test Loss: 0.201 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.4948856830596924
Epoch: 38, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.198 Vali Acc: 0.975 Test Loss: 0.198 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 39 cost time: 0.5062236785888672
Epoch: 39, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.195 Vali Acc: 0.975 Test Loss: 0.195 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 40 cost time: 0.4911022186279297
Epoch: 40, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.192 Vali Acc: 0.975 Test Loss: 0.192 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 41 cost time: 0.5713405609130859
Epoch: 41, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.189 Vali Acc: 0.975 Test Loss: 0.189 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 42 cost time: 0.5593869686126709
Epoch: 42, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.188 Vali Acc: 0.975 Test Loss: 0.188 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 43 cost time: 0.5754547119140625
Epoch: 43, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.186 Vali Acc: 0.975 Test Loss: 0.186 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 44 cost time: 0.512537956237793
Epoch: 44, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.185 Vali Acc: 0.975 Test Loss: 0.185 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 45 cost time: 0.4830610752105713
Epoch: 45, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.184 Vali Acc: 0.975 Test Loss: 0.184 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 46 cost time: 0.5190320014953613
Epoch: 46, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.189 Vali Acc: 0.975 Test Loss: 0.189 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.5339353084564209
Epoch: 47, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.179 Vali Acc: 0.975 Test Loss: 0.179 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 48 cost time: 0.613581657409668
Epoch: 48, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.181 Vali Acc: 0.975 Test Loss: 0.181 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.49927306175231934
Epoch: 49, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.173 Vali Acc: 0.975 Test Loss: 0.173 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 50 cost time: 0.529618501663208
Epoch: 50, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.173 Vali Acc: 0.975 Test Loss: 0.173 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps25_str13_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 4202244
model size : 16.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.8223953247070312
Epoch: 1, Steps: 3 | Train Loss: 1.427 Vali Loss: 1.404 Vali Acc: 0.275 Test Loss: 1.404 Test Acc: 0.275
Validation loss decreased (inf --> -0.274986).  Saving model ...
Epoch: 2 cost time: 0.5364329814910889
Epoch: 2, Steps: 3 | Train Loss: 1.327 Vali Loss: 1.360 Vali Acc: 0.425 Test Loss: 1.360 Test Acc: 0.425
Validation loss decreased (-0.274986 --> -0.424986).  Saving model ...
Epoch: 3 cost time: 0.5161943435668945
Epoch: 3, Steps: 3 | Train Loss: 1.230 Vali Loss: 1.278 Vali Acc: 0.500 Test Loss: 1.278 Test Acc: 0.500
Validation loss decreased (-0.424986 --> -0.499987).  Saving model ...
Epoch: 4 cost time: 0.47916364669799805
Epoch: 4, Steps: 3 | Train Loss: 1.126 Vali Loss: 1.170 Vali Acc: 0.550 Test Loss: 1.170 Test Acc: 0.550
Validation loss decreased (-0.499987 --> -0.549988).  Saving model ...
Epoch: 5 cost time: 0.4719405174255371
Epoch: 5, Steps: 3 | Train Loss: 0.945 Vali Loss: 1.046 Vali Acc: 0.625 Test Loss: 1.046 Test Acc: 0.625
Validation loss decreased (-0.549988 --> -0.624990).  Saving model ...
Epoch: 6 cost time: 0.5022528171539307
Epoch: 6, Steps: 3 | Train Loss: 0.777 Vali Loss: 0.914 Vali Acc: 0.825 Test Loss: 0.914 Test Acc: 0.825
Validation loss decreased (-0.624990 --> -0.824991).  Saving model ...
Epoch: 7 cost time: 0.48973941802978516
Epoch: 7, Steps: 3 | Train Loss: 0.644 Vali Loss: 0.794 Vali Acc: 0.925 Test Loss: 0.794 Test Acc: 0.925
Validation loss decreased (-0.824991 --> -0.924992).  Saving model ...
Epoch: 8 cost time: 0.5455484390258789
Epoch: 8, Steps: 3 | Train Loss: 0.565 Vali Loss: 0.675 Vali Acc: 0.950 Test Loss: 0.675 Test Acc: 0.950
Validation loss decreased (-0.924992 --> -0.949993).  Saving model ...
Epoch: 9 cost time: 0.42986536026000977
Epoch: 9, Steps: 3 | Train Loss: 0.458 Vali Loss: 0.577 Vali Acc: 0.950 Test Loss: 0.577 Test Acc: 0.950
Validation loss decreased (-0.949993 --> -0.949994).  Saving model ...
Epoch: 10 cost time: 0.5791134834289551
Epoch: 10, Steps: 3 | Train Loss: 0.389 Vali Loss: 0.490 Vali Acc: 0.950 Test Loss: 0.490 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 11 cost time: 0.5149405002593994
Epoch: 11, Steps: 3 | Train Loss: 0.312 Vali Loss: 0.423 Vali Acc: 0.950 Test Loss: 0.423 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 12 cost time: 0.5590648651123047
Epoch: 12, Steps: 3 | Train Loss: 0.260 Vali Loss: 0.375 Vali Acc: 0.925 Test Loss: 0.375 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5021860599517822
Epoch: 13, Steps: 3 | Train Loss: 0.232 Vali Loss: 0.336 Vali Acc: 0.925 Test Loss: 0.336 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.5256333351135254
Epoch: 14, Steps: 3 | Train Loss: 0.212 Vali Loss: 0.308 Vali Acc: 0.925 Test Loss: 0.308 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.48665428161621094
Epoch: 15, Steps: 3 | Train Loss: 0.158 Vali Loss: 0.283 Vali Acc: 0.950 Test Loss: 0.283 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 16 cost time: 0.4885592460632324
Epoch: 16, Steps: 3 | Train Loss: 0.131 Vali Loss: 0.268 Vali Acc: 0.950 Test Loss: 0.268 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 17 cost time: 0.5744714736938477
Epoch: 17, Steps: 3 | Train Loss: 0.107 Vali Loss: 0.271 Vali Acc: 0.950 Test Loss: 0.271 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.522939920425415
Epoch: 18, Steps: 3 | Train Loss: 0.120 Vali Loss: 0.265 Vali Acc: 0.950 Test Loss: 0.265 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 19 cost time: 0.5636866092681885
Epoch: 19, Steps: 3 | Train Loss: 0.083 Vali Loss: 0.259 Vali Acc: 0.950 Test Loss: 0.259 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 20 cost time: 0.5173189640045166
Epoch: 20, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.254 Vali Acc: 0.950 Test Loss: 0.254 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 21 cost time: 0.5400543212890625
Epoch: 21, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.261 Vali Acc: 0.950 Test Loss: 0.261 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.5187938213348389
Epoch: 22, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.266 Vali Acc: 0.950 Test Loss: 0.266 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.5242013931274414
Epoch: 23, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.275 Vali Acc: 0.925 Test Loss: 0.275 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.39067530632019043
Epoch: 24, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.286 Vali Acc: 0.925 Test Loss: 0.286 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.5225260257720947
Epoch: 25, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.287 Vali Acc: 0.925 Test Loss: 0.287 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.5408766269683838
Epoch: 26, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.292 Vali Acc: 0.925 Test Loss: 0.292 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.5468623638153076
Epoch: 27, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.297 Vali Acc: 0.925 Test Loss: 0.297 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.46430039405822754
Epoch: 28, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.306 Vali Acc: 0.925 Test Loss: 0.306 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.45132923126220703
Epoch: 29, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.314 Vali Acc: 0.925 Test Loss: 0.314 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.48238325119018555
Epoch: 30, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.317 Vali Acc: 0.925 Test Loss: 0.317 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 1164804
model size : 4.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.882624864578247
Epoch: 1, Steps: 3 | Train Loss: 1.448 Vali Loss: 1.415 Vali Acc: 0.150 Test Loss: 1.415 Test Acc: 0.150
Validation loss decreased (inf --> -0.149986).  Saving model ...
Epoch: 2 cost time: 0.5021913051605225
Epoch: 2, Steps: 3 | Train Loss: 1.335 Vali Loss: 1.380 Vali Acc: 0.275 Test Loss: 1.380 Test Acc: 0.275
Validation loss decreased (-0.149986 --> -0.274986).  Saving model ...
Epoch: 3 cost time: 0.5360121726989746
Epoch: 3, Steps: 3 | Train Loss: 1.275 Vali Loss: 1.314 Vali Acc: 0.325 Test Loss: 1.314 Test Acc: 0.325
Validation loss decreased (-0.274986 --> -0.324987).  Saving model ...
Epoch: 4 cost time: 0.626896858215332
Epoch: 4, Steps: 3 | Train Loss: 1.160 Vali Loss: 1.220 Vali Acc: 0.500 Test Loss: 1.220 Test Acc: 0.500
Validation loss decreased (-0.324987 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 0.5063927173614502
Epoch: 5, Steps: 3 | Train Loss: 1.027 Vali Loss: 1.117 Vali Acc: 0.600 Test Loss: 1.117 Test Acc: 0.600
Validation loss decreased (-0.499988 --> -0.599989).  Saving model ...
Epoch: 6 cost time: 0.4988245964050293
Epoch: 6, Steps: 3 | Train Loss: 0.912 Vali Loss: 1.005 Vali Acc: 0.950 Test Loss: 1.005 Test Acc: 0.950
Validation loss decreased (-0.599989 --> -0.949990).  Saving model ...
Epoch: 7 cost time: 0.510873556137085
Epoch: 7, Steps: 3 | Train Loss: 0.783 Vali Loss: 0.894 Vali Acc: 0.950 Test Loss: 0.894 Test Acc: 0.950
Validation loss decreased (-0.949990 --> -0.949991).  Saving model ...
Epoch: 8 cost time: 0.5618062019348145
Epoch: 8, Steps: 3 | Train Loss: 0.678 Vali Loss: 0.787 Vali Acc: 0.975 Test Loss: 0.787 Test Acc: 0.975
Validation loss decreased (-0.949991 --> -0.974992).  Saving model ...
Epoch: 9 cost time: 0.5461995601654053
Epoch: 9, Steps: 3 | Train Loss: 0.589 Vali Loss: 0.684 Vali Acc: 0.975 Test Loss: 0.684 Test Acc: 0.975
Validation loss decreased (-0.974992 --> -0.974993).  Saving model ...
Epoch: 10 cost time: 0.6098675727844238
Epoch: 10, Steps: 3 | Train Loss: 0.505 Vali Loss: 0.592 Vali Acc: 0.975 Test Loss: 0.592 Test Acc: 0.975
Validation loss decreased (-0.974993 --> -0.974994).  Saving model ...
Epoch: 11 cost time: 0.4835782051086426
Epoch: 11, Steps: 3 | Train Loss: 0.420 Vali Loss: 0.514 Vali Acc: 0.975 Test Loss: 0.514 Test Acc: 0.975
Validation loss decreased (-0.974994 --> -0.974995).  Saving model ...
Epoch: 12 cost time: 0.45075297355651855
Epoch: 12, Steps: 3 | Train Loss: 0.360 Vali Loss: 0.451 Vali Acc: 0.975 Test Loss: 0.451 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 13 cost time: 0.49094367027282715
Epoch: 13, Steps: 3 | Train Loss: 0.286 Vali Loss: 0.406 Vali Acc: 0.975 Test Loss: 0.406 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 14 cost time: 0.479794979095459
Epoch: 14, Steps: 3 | Train Loss: 0.264 Vali Loss: 0.362 Vali Acc: 0.975 Test Loss: 0.362 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 15 cost time: 0.4316680431365967
Epoch: 15, Steps: 3 | Train Loss: 0.217 Vali Loss: 0.326 Vali Acc: 0.975 Test Loss: 0.326 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 16 cost time: 0.5821688175201416
Epoch: 16, Steps: 3 | Train Loss: 0.204 Vali Loss: 0.293 Vali Acc: 0.975 Test Loss: 0.293 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 17 cost time: 0.5065441131591797
Epoch: 17, Steps: 3 | Train Loss: 0.182 Vali Loss: 0.283 Vali Acc: 0.975 Test Loss: 0.283 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 18 cost time: 0.5372607707977295
Epoch: 18, Steps: 3 | Train Loss: 0.136 Vali Loss: 0.248 Vali Acc: 0.975 Test Loss: 0.248 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 19 cost time: 0.49678707122802734
Epoch: 19, Steps: 3 | Train Loss: 0.109 Vali Loss: 0.230 Vali Acc: 0.975 Test Loss: 0.230 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 20 cost time: 0.45297718048095703
Epoch: 20, Steps: 3 | Train Loss: 0.107 Vali Loss: 0.211 Vali Acc: 0.950 Test Loss: 0.211 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.4390387535095215
Epoch: 21, Steps: 3 | Train Loss: 0.087 Vali Loss: 0.211 Vali Acc: 0.950 Test Loss: 0.211 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.49492573738098145
Epoch: 22, Steps: 3 | Train Loss: 0.086 Vali Loss: 0.199 Vali Acc: 0.950 Test Loss: 0.199 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.5274093151092529
Epoch: 23, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.194 Vali Acc: 0.950 Test Loss: 0.194 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.46411657333374023
Epoch: 24, Steps: 3 | Train Loss: 0.062 Vali Loss: 0.184 Vali Acc: 0.950 Test Loss: 0.184 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.6078095436096191
Epoch: 25, Steps: 3 | Train Loss: 0.074 Vali Loss: 0.186 Vali Acc: 0.950 Test Loss: 0.186 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.48787379264831543
Epoch: 26, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.184 Vali Acc: 0.950 Test Loss: 0.184 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.5314881801605225
Epoch: 27, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.182 Vali Acc: 0.950 Test Loss: 0.182 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.5486717224121094
Epoch: 28, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.185 Vali Acc: 0.950 Test Loss: 0.185 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.5126368999481201
Epoch: 29, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.182 Vali Acc: 0.950 Test Loss: 0.182 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 1140356
model size : 4.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.7769215106964111
Epoch: 1, Steps: 3 | Train Loss: 1.481 Vali Loss: 1.425 Vali Acc: 0.325 Test Loss: 1.425 Test Acc: 0.325
Validation loss decreased (inf --> -0.324986).  Saving model ...
Epoch: 2 cost time: 0.5144777297973633
Epoch: 2, Steps: 3 | Train Loss: 1.429 Vali Loss: 1.394 Vali Acc: 0.375 Test Loss: 1.394 Test Acc: 0.375
Validation loss decreased (-0.324986 --> -0.374986).  Saving model ...
Epoch: 3 cost time: 0.5292153358459473
Epoch: 3, Steps: 3 | Train Loss: 1.329 Vali Loss: 1.342 Vali Acc: 0.400 Test Loss: 1.342 Test Acc: 0.400
Validation loss decreased (-0.374986 --> -0.399987).  Saving model ...
Epoch: 4 cost time: 0.507878303527832
Epoch: 4, Steps: 3 | Train Loss: 1.248 Vali Loss: 1.268 Vali Acc: 0.500 Test Loss: 1.268 Test Acc: 0.500
Validation loss decreased (-0.399987 --> -0.499987).  Saving model ...
Epoch: 5 cost time: 0.5450818538665771
Epoch: 5, Steps: 3 | Train Loss: 1.099 Vali Loss: 1.179 Vali Acc: 0.575 Test Loss: 1.179 Test Acc: 0.575
Validation loss decreased (-0.499987 --> -0.574988).  Saving model ...
Epoch: 6 cost time: 0.49435973167419434
Epoch: 6, Steps: 3 | Train Loss: 1.006 Vali Loss: 1.079 Vali Acc: 0.675 Test Loss: 1.079 Test Acc: 0.675
Validation loss decreased (-0.574988 --> -0.674989).  Saving model ...
Epoch: 7 cost time: 0.5086960792541504
Epoch: 7, Steps: 3 | Train Loss: 0.892 Vali Loss: 0.981 Vali Acc: 0.800 Test Loss: 0.981 Test Acc: 0.800
Validation loss decreased (-0.674989 --> -0.799990).  Saving model ...
Epoch: 8 cost time: 0.4731781482696533
Epoch: 8, Steps: 3 | Train Loss: 0.772 Vali Loss: 0.893 Vali Acc: 0.875 Test Loss: 0.893 Test Acc: 0.875
Validation loss decreased (-0.799990 --> -0.874991).  Saving model ...
Epoch: 9 cost time: 0.5404984951019287
Epoch: 9, Steps: 3 | Train Loss: 0.689 Vali Loss: 0.805 Vali Acc: 0.900 Test Loss: 0.805 Test Acc: 0.900
Validation loss decreased (-0.874991 --> -0.899992).  Saving model ...
Epoch: 10 cost time: 0.40508341789245605
Epoch: 10, Steps: 3 | Train Loss: 0.617 Vali Loss: 0.723 Vali Acc: 0.925 Test Loss: 0.723 Test Acc: 0.925
Validation loss decreased (-0.899992 --> -0.924993).  Saving model ...
Epoch: 11 cost time: 0.4410581588745117
Epoch: 11, Steps: 3 | Train Loss: 0.524 Vali Loss: 0.650 Vali Acc: 0.925 Test Loss: 0.650 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924993).  Saving model ...
Epoch: 12 cost time: 0.4030888080596924
Epoch: 12, Steps: 3 | Train Loss: 0.450 Vali Loss: 0.592 Vali Acc: 0.925 Test Loss: 0.592 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924994).  Saving model ...
Epoch: 13 cost time: 0.43938302993774414
Epoch: 13, Steps: 3 | Train Loss: 0.416 Vali Loss: 0.536 Vali Acc: 0.925 Test Loss: 0.536 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 14 cost time: 0.4543783664703369
Epoch: 14, Steps: 3 | Train Loss: 0.348 Vali Loss: 0.488 Vali Acc: 0.925 Test Loss: 0.488 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 15 cost time: 0.5086040496826172
Epoch: 15, Steps: 3 | Train Loss: 0.332 Vali Loss: 0.454 Vali Acc: 0.925 Test Loss: 0.454 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 16 cost time: 0.47405052185058594
Epoch: 16, Steps: 3 | Train Loss: 0.294 Vali Loss: 0.411 Vali Acc: 0.950 Test Loss: 0.411 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949996).  Saving model ...
Epoch: 17 cost time: 0.5786497592926025
Epoch: 17, Steps: 3 | Train Loss: 0.260 Vali Loss: 0.385 Vali Acc: 0.950 Test Loss: 0.385 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 18 cost time: 0.4973788261413574
Epoch: 18, Steps: 3 | Train Loss: 0.242 Vali Loss: 0.357 Vali Acc: 0.975 Test Loss: 0.357 Test Acc: 0.975
Validation loss decreased (-0.949996 --> -0.974996).  Saving model ...
Epoch: 19 cost time: 0.4913759231567383
Epoch: 19, Steps: 3 | Train Loss: 0.204 Vali Loss: 0.334 Vali Acc: 0.975 Test Loss: 0.334 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 20 cost time: 0.5898492336273193
Epoch: 20, Steps: 3 | Train Loss: 0.202 Vali Loss: 0.311 Vali Acc: 0.975 Test Loss: 0.311 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 21 cost time: 0.5151724815368652
Epoch: 21, Steps: 3 | Train Loss: 0.173 Vali Loss: 0.291 Vali Acc: 0.950 Test Loss: 0.291 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.46157360076904297
Epoch: 22, Steps: 3 | Train Loss: 0.150 Vali Loss: 0.278 Vali Acc: 0.950 Test Loss: 0.278 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.5702900886535645
Epoch: 23, Steps: 3 | Train Loss: 0.129 Vali Loss: 0.260 Vali Acc: 0.950 Test Loss: 0.260 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.5586907863616943
Epoch: 24, Steps: 3 | Train Loss: 0.134 Vali Loss: 0.249 Vali Acc: 0.950 Test Loss: 0.249 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.5288615226745605
Epoch: 25, Steps: 3 | Train Loss: 0.104 Vali Loss: 0.234 Vali Acc: 0.950 Test Loss: 0.234 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.5291483402252197
Epoch: 26, Steps: 3 | Train Loss: 0.099 Vali Loss: 0.221 Vali Acc: 0.950 Test Loss: 0.221 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.4935338497161865
Epoch: 27, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.222 Vali Acc: 0.950 Test Loss: 0.222 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.49300312995910645
Epoch: 28, Steps: 3 | Train Loss: 0.088 Vali Loss: 0.221 Vali Acc: 0.950 Test Loss: 0.221 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.4625260829925537
Epoch: 29, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.215 Vali Acc: 0.950 Test Loss: 0.215 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.5641293525695801
Epoch: 30, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.207 Vali Acc: 0.950 Test Loss: 0.207 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 1128260
model size : 4.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.7509636878967285
Epoch: 1, Steps: 3 | Train Loss: 1.418 Vali Loss: 1.418 Vali Acc: 0.425 Test Loss: 1.418 Test Acc: 0.425
Validation loss decreased (inf --> -0.424986).  Saving model ...
Epoch: 2 cost time: 0.4302034378051758
Epoch: 2, Steps: 3 | Train Loss: 1.361 Vali Loss: 1.397 Vali Acc: 0.500 Test Loss: 1.397 Test Acc: 0.500
Validation loss decreased (-0.424986 --> -0.499986).  Saving model ...
Epoch: 3 cost time: 0.4432075023651123
Epoch: 3, Steps: 3 | Train Loss: 1.300 Vali Loss: 1.357 Vali Acc: 0.550 Test Loss: 1.357 Test Acc: 0.550
Validation loss decreased (-0.499986 --> -0.549986).  Saving model ...
Epoch: 4 cost time: 0.5011100769042969
Epoch: 4, Steps: 3 | Train Loss: 1.228 Vali Loss: 1.296 Vali Acc: 0.625 Test Loss: 1.296 Test Acc: 0.625
Validation loss decreased (-0.549986 --> -0.624987).  Saving model ...
Epoch: 5 cost time: 0.49331068992614746
Epoch: 5, Steps: 3 | Train Loss: 1.119 Vali Loss: 1.221 Vali Acc: 0.725 Test Loss: 1.221 Test Acc: 0.725
Validation loss decreased (-0.624987 --> -0.724988).  Saving model ...
Epoch: 6 cost time: 0.5457756519317627
Epoch: 6, Steps: 3 | Train Loss: 1.031 Vali Loss: 1.138 Vali Acc: 0.775 Test Loss: 1.138 Test Acc: 0.775
Validation loss decreased (-0.724988 --> -0.774989).  Saving model ...
Epoch: 7 cost time: 0.5692112445831299
Epoch: 7, Steps: 3 | Train Loss: 0.938 Vali Loss: 1.049 Vali Acc: 0.825 Test Loss: 1.049 Test Acc: 0.825
Validation loss decreased (-0.774989 --> -0.824990).  Saving model ...
Epoch: 8 cost time: 0.5073230266571045
Epoch: 8, Steps: 3 | Train Loss: 0.856 Vali Loss: 0.959 Vali Acc: 0.875 Test Loss: 0.959 Test Acc: 0.875
Validation loss decreased (-0.824990 --> -0.874990).  Saving model ...
Epoch: 9 cost time: 0.47713398933410645
Epoch: 9, Steps: 3 | Train Loss: 0.775 Vali Loss: 0.872 Vali Acc: 0.900 Test Loss: 0.872 Test Acc: 0.900
Validation loss decreased (-0.874990 --> -0.899991).  Saving model ...
Epoch: 10 cost time: 0.5408473014831543
Epoch: 10, Steps: 3 | Train Loss: 0.708 Vali Loss: 0.786 Vali Acc: 0.950 Test Loss: 0.786 Test Acc: 0.950
Validation loss decreased (-0.899991 --> -0.949992).  Saving model ...
Epoch: 11 cost time: 0.5038149356842041
Epoch: 11, Steps: 3 | Train Loss: 0.637 Vali Loss: 0.711 Vali Acc: 0.950 Test Loss: 0.711 Test Acc: 0.950
Validation loss decreased (-0.949992 --> -0.949993).  Saving model ...
Epoch: 12 cost time: 0.4951639175415039
Epoch: 12, Steps: 3 | Train Loss: 0.565 Vali Loss: 0.650 Vali Acc: 0.925 Test Loss: 0.650 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5098464488983154
Epoch: 13, Steps: 3 | Train Loss: 0.509 Vali Loss: 0.593 Vali Acc: 0.925 Test Loss: 0.593 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.49784040451049805
Epoch: 14, Steps: 3 | Train Loss: 0.424 Vali Loss: 0.538 Vali Acc: 0.925 Test Loss: 0.538 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.5174005031585693
Epoch: 15, Steps: 3 | Train Loss: 0.400 Vali Loss: 0.497 Vali Acc: 0.925 Test Loss: 0.497 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.5365829467773438
Epoch: 16, Steps: 3 | Train Loss: 0.370 Vali Loss: 0.453 Vali Acc: 0.975 Test Loss: 0.453 Test Acc: 0.975
Validation loss decreased (-0.949993 --> -0.974995).  Saving model ...
Epoch: 17 cost time: 0.5163412094116211
Epoch: 17, Steps: 3 | Train Loss: 0.309 Vali Loss: 0.414 Vali Acc: 0.975 Test Loss: 0.414 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 18 cost time: 0.5507667064666748
Epoch: 18, Steps: 3 | Train Loss: 0.286 Vali Loss: 0.381 Vali Acc: 0.975 Test Loss: 0.381 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 19 cost time: 0.5626659393310547
Epoch: 19, Steps: 3 | Train Loss: 0.257 Vali Loss: 0.362 Vali Acc: 0.975 Test Loss: 0.362 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 20 cost time: 0.4873230457305908
Epoch: 20, Steps: 3 | Train Loss: 0.240 Vali Loss: 0.332 Vali Acc: 0.975 Test Loss: 0.332 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 21 cost time: 0.586374044418335
Epoch: 21, Steps: 3 | Train Loss: 0.216 Vali Loss: 0.319 Vali Acc: 0.975 Test Loss: 0.319 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 22 cost time: 0.5040180683135986
Epoch: 22, Steps: 3 | Train Loss: 0.211 Vali Loss: 0.290 Vali Acc: 0.975 Test Loss: 0.290 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 23 cost time: 0.474564790725708
Epoch: 23, Steps: 3 | Train Loss: 0.170 Vali Loss: 0.266 Vali Acc: 0.975 Test Loss: 0.266 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 24 cost time: 0.5539121627807617
Epoch: 24, Steps: 3 | Train Loss: 0.204 Vali Loss: 0.250 Vali Acc: 0.975 Test Loss: 0.250 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 25 cost time: 0.5448334217071533
Epoch: 25, Steps: 3 | Train Loss: 0.161 Vali Loss: 0.232 Vali Acc: 0.975 Test Loss: 0.232 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 26 cost time: 0.5419466495513916
Epoch: 26, Steps: 3 | Train Loss: 0.147 Vali Loss: 0.219 Vali Acc: 0.975 Test Loss: 0.219 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 27 cost time: 0.49156641960144043
Epoch: 27, Steps: 3 | Train Loss: 0.121 Vali Loss: 0.220 Vali Acc: 0.975 Test Loss: 0.220 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.5764703750610352
Epoch: 28, Steps: 3 | Train Loss: 0.118 Vali Loss: 0.206 Vali Acc: 0.975 Test Loss: 0.206 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 29 cost time: 0.5146722793579102
Epoch: 29, Steps: 3 | Train Loss: 0.103 Vali Loss: 0.196 Vali Acc: 0.975 Test Loss: 0.196 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 30 cost time: 0.46774911880493164
Epoch: 30, Steps: 3 | Train Loss: 0.112 Vali Loss: 0.186 Vali Acc: 0.975 Test Loss: 0.186 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 31 cost time: 0.5154924392700195
Epoch: 31, Steps: 3 | Train Loss: 0.093 Vali Loss: 0.178 Vali Acc: 0.975 Test Loss: 0.178 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 32 cost time: 0.49981117248535156
Epoch: 32, Steps: 3 | Train Loss: 0.081 Vali Loss: 0.169 Vali Acc: 0.975 Test Loss: 0.169 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 33 cost time: 0.5013420581817627
Epoch: 33, Steps: 3 | Train Loss: 0.079 Vali Loss: 0.169 Vali Acc: 0.975 Test Loss: 0.169 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 34 cost time: 0.6092362403869629
Epoch: 34, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.164 Vali Acc: 0.975 Test Loss: 0.164 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 35 cost time: 0.558037519454956
Epoch: 35, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.165 Vali Acc: 0.975 Test Loss: 0.165 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.5657033920288086
Epoch: 36, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.165 Vali Acc: 0.975 Test Loss: 0.165 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.5408782958984375
Epoch: 37, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.163 Vali Acc: 0.975 Test Loss: 0.163 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 38 cost time: 0.5354323387145996
Epoch: 38, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.158 Vali Acc: 0.950 Test Loss: 0.158 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.512056827545166
Epoch: 39, Steps: 3 | Train Loss: 0.061 Vali Loss: 0.160 Vali Acc: 0.950 Test Loss: 0.160 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.4890568256378174
Epoch: 40, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.158 Vali Acc: 0.950 Test Loss: 0.158 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.522428035736084
Epoch: 41, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.155 Vali Acc: 0.950 Test Loss: 0.155 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.5890884399414062
Epoch: 42, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.161 Vali Acc: 0.950 Test Loss: 0.161 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.5301508903503418
Epoch: 43, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.156 Vali Acc: 0.950 Test Loss: 0.156 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.4611201286315918
Epoch: 44, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.160 Vali Acc: 0.950 Test Loss: 0.160 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.44269585609436035
Epoch: 45, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.157 Vali Acc: 0.950 Test Loss: 0.157 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.5318303108215332
Epoch: 46, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.154 Vali Acc: 0.950 Test Loss: 0.154 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.5120162963867188
Epoch: 47, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.154 Vali Acc: 0.950 Test Loss: 0.154 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 1119172
model size : 4.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.7901875972747803
Epoch: 1, Steps: 3 | Train Loss: 1.402 Vali Loss: 1.418 Vali Acc: 0.325 Test Loss: 1.418 Test Acc: 0.325
Validation loss decreased (inf --> -0.324986).  Saving model ...
Epoch: 2 cost time: 0.51226806640625
Epoch: 2, Steps: 3 | Train Loss: 1.398 Vali Loss: 1.404 Vali Acc: 0.400 Test Loss: 1.404 Test Acc: 0.400
Validation loss decreased (-0.324986 --> -0.399986).  Saving model ...
Epoch: 3 cost time: 0.4483330249786377
Epoch: 3, Steps: 3 | Train Loss: 1.347 Vali Loss: 1.382 Vali Acc: 0.425 Test Loss: 1.382 Test Acc: 0.425
Validation loss decreased (-0.399986 --> -0.424986).  Saving model ...
Epoch: 4 cost time: 0.532869815826416
Epoch: 4, Steps: 3 | Train Loss: 1.281 Vali Loss: 1.347 Vali Acc: 0.450 Test Loss: 1.347 Test Acc: 0.450
Validation loss decreased (-0.424986 --> -0.449987).  Saving model ...
Epoch: 5 cost time: 0.4662973880767822
Epoch: 5, Steps: 3 | Train Loss: 1.218 Vali Loss: 1.302 Vali Acc: 0.525 Test Loss: 1.302 Test Acc: 0.525
Validation loss decreased (-0.449987 --> -0.524987).  Saving model ...
Epoch: 6 cost time: 0.47610926628112793
Epoch: 6, Steps: 3 | Train Loss: 1.137 Vali Loss: 1.247 Vali Acc: 0.600 Test Loss: 1.247 Test Acc: 0.600
Validation loss decreased (-0.524987 --> -0.599988).  Saving model ...
Epoch: 7 cost time: 0.5738368034362793
Epoch: 7, Steps: 3 | Train Loss: 1.059 Vali Loss: 1.189 Vali Acc: 0.700 Test Loss: 1.189 Test Acc: 0.700
Validation loss decreased (-0.599988 --> -0.699988).  Saving model ...
Epoch: 8 cost time: 0.5074543952941895
Epoch: 8, Steps: 3 | Train Loss: 1.033 Vali Loss: 1.123 Vali Acc: 0.725 Test Loss: 1.123 Test Acc: 0.725
Validation loss decreased (-0.699988 --> -0.724989).  Saving model ...
Epoch: 9 cost time: 0.5780344009399414
Epoch: 9, Steps: 3 | Train Loss: 0.928 Vali Loss: 1.059 Vali Acc: 0.800 Test Loss: 1.059 Test Acc: 0.800
Validation loss decreased (-0.724989 --> -0.799989).  Saving model ...
Epoch: 10 cost time: 0.5558500289916992
Epoch: 10, Steps: 3 | Train Loss: 0.865 Vali Loss: 0.992 Vali Acc: 0.850 Test Loss: 0.992 Test Acc: 0.850
Validation loss decreased (-0.799989 --> -0.849990).  Saving model ...
Epoch: 11 cost time: 0.540825605392456
Epoch: 11, Steps: 3 | Train Loss: 0.812 Vali Loss: 0.927 Vali Acc: 0.875 Test Loss: 0.927 Test Acc: 0.875
Validation loss decreased (-0.849990 --> -0.874991).  Saving model ...
Epoch: 12 cost time: 0.5159573554992676
Epoch: 12, Steps: 3 | Train Loss: 0.704 Vali Loss: 0.876 Vali Acc: 0.900 Test Loss: 0.876 Test Acc: 0.900
Validation loss decreased (-0.874991 --> -0.899991).  Saving model ...
Epoch: 13 cost time: 0.4965362548828125
Epoch: 13, Steps: 3 | Train Loss: 0.678 Vali Loss: 0.821 Vali Acc: 0.950 Test Loss: 0.821 Test Acc: 0.950
Validation loss decreased (-0.899991 --> -0.949992).  Saving model ...
Epoch: 14 cost time: 0.5501487255096436
Epoch: 14, Steps: 3 | Train Loss: 0.609 Vali Loss: 0.772 Vali Acc: 0.975 Test Loss: 0.772 Test Acc: 0.975
Validation loss decreased (-0.949992 --> -0.974992).  Saving model ...
Epoch: 15 cost time: 0.5151090621948242
Epoch: 15, Steps: 3 | Train Loss: 0.556 Vali Loss: 0.720 Vali Acc: 0.975 Test Loss: 0.720 Test Acc: 0.975
Validation loss decreased (-0.974992 --> -0.974993).  Saving model ...
Epoch: 16 cost time: 0.5480763912200928
Epoch: 16, Steps: 3 | Train Loss: 0.511 Vali Loss: 0.677 Vali Acc: 0.975 Test Loss: 0.677 Test Acc: 0.975
Validation loss decreased (-0.974993 --> -0.974993).  Saving model ...
Epoch: 17 cost time: 0.4744863510131836
Epoch: 17, Steps: 3 | Train Loss: 0.478 Vali Loss: 0.636 Vali Acc: 0.975 Test Loss: 0.636 Test Acc: 0.975
Validation loss decreased (-0.974993 --> -0.974994).  Saving model ...
Epoch: 18 cost time: 0.5189273357391357
Epoch: 18, Steps: 3 | Train Loss: 0.439 Vali Loss: 0.598 Vali Acc: 0.975 Test Loss: 0.598 Test Acc: 0.975
Validation loss decreased (-0.974994 --> -0.974994).  Saving model ...
Epoch: 19 cost time: 0.5263745784759521
Epoch: 19, Steps: 3 | Train Loss: 0.415 Vali Loss: 0.551 Vali Acc: 0.975 Test Loss: 0.551 Test Acc: 0.975
Validation loss decreased (-0.974994 --> -0.974994).  Saving model ...
Epoch: 20 cost time: 0.4844632148742676
Epoch: 20, Steps: 3 | Train Loss: 0.376 Vali Loss: 0.520 Vali Acc: 0.975 Test Loss: 0.520 Test Acc: 0.975
Validation loss decreased (-0.974994 --> -0.974995).  Saving model ...
Epoch: 21 cost time: 0.45620036125183105
Epoch: 21, Steps: 3 | Train Loss: 0.357 Vali Loss: 0.488 Vali Acc: 0.975 Test Loss: 0.488 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 22 cost time: 0.48646998405456543
Epoch: 22, Steps: 3 | Train Loss: 0.334 Vali Loss: 0.462 Vali Acc: 0.975 Test Loss: 0.462 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 23 cost time: 0.5692877769470215
Epoch: 23, Steps: 3 | Train Loss: 0.311 Vali Loss: 0.438 Vali Acc: 0.975 Test Loss: 0.438 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 24 cost time: 0.5329082012176514
Epoch: 24, Steps: 3 | Train Loss: 0.261 Vali Loss: 0.416 Vali Acc: 0.975 Test Loss: 0.416 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 25 cost time: 0.46535754203796387
Epoch: 25, Steps: 3 | Train Loss: 0.244 Vali Loss: 0.392 Vali Acc: 0.975 Test Loss: 0.392 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 26 cost time: 0.517427921295166
Epoch: 26, Steps: 3 | Train Loss: 0.228 Vali Loss: 0.377 Vali Acc: 0.975 Test Loss: 0.377 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 27 cost time: 0.47487664222717285
Epoch: 27, Steps: 3 | Train Loss: 0.211 Vali Loss: 0.358 Vali Acc: 0.975 Test Loss: 0.358 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 28 cost time: 0.5619580745697021
Epoch: 28, Steps: 3 | Train Loss: 0.195 Vali Loss: 0.342 Vali Acc: 0.975 Test Loss: 0.342 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 29 cost time: 0.41736841201782227
Epoch: 29, Steps: 3 | Train Loss: 0.187 Vali Loss: 0.329 Vali Acc: 0.975 Test Loss: 0.329 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 30 cost time: 0.4721183776855469
Epoch: 30, Steps: 3 | Train Loss: 0.166 Vali Loss: 0.316 Vali Acc: 0.975 Test Loss: 0.316 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 31 cost time: 0.5082442760467529
Epoch: 31, Steps: 3 | Train Loss: 0.182 Vali Loss: 0.308 Vali Acc: 0.975 Test Loss: 0.308 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 32 cost time: 0.5595996379852295
Epoch: 32, Steps: 3 | Train Loss: 0.146 Vali Loss: 0.294 Vali Acc: 0.975 Test Loss: 0.294 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 33 cost time: 0.4859328269958496
Epoch: 33, Steps: 3 | Train Loss: 0.133 Vali Loss: 0.285 Vali Acc: 0.975 Test Loss: 0.285 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 34 cost time: 0.582683801651001
Epoch: 34, Steps: 3 | Train Loss: 0.135 Vali Loss: 0.270 Vali Acc: 0.975 Test Loss: 0.270 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 35 cost time: 0.5096838474273682
Epoch: 35, Steps: 3 | Train Loss: 0.118 Vali Loss: 0.262 Vali Acc: 0.975 Test Loss: 0.262 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 36 cost time: 0.4833805561065674
Epoch: 36, Steps: 3 | Train Loss: 0.100 Vali Loss: 0.249 Vali Acc: 0.975 Test Loss: 0.249 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 37 cost time: 0.4792301654815674
Epoch: 37, Steps: 3 | Train Loss: 0.095 Vali Loss: 0.235 Vali Acc: 0.975 Test Loss: 0.235 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 38 cost time: 0.6145467758178711
Epoch: 38, Steps: 3 | Train Loss: 0.088 Vali Loss: 0.224 Vali Acc: 0.975 Test Loss: 0.224 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 39 cost time: 0.55299973487854
Epoch: 39, Steps: 3 | Train Loss: 0.090 Vali Loss: 0.230 Vali Acc: 0.975 Test Loss: 0.230 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.49295783042907715
Epoch: 40, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.220 Vali Acc: 0.975 Test Loss: 0.220 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 41 cost time: 0.5451047420501709
Epoch: 41, Steps: 3 | Train Loss: 0.062 Vali Loss: 0.212 Vali Acc: 0.975 Test Loss: 0.212 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 42 cost time: 0.5185139179229736
Epoch: 42, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.211 Vali Acc: 0.975 Test Loss: 0.211 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 43 cost time: 0.5523052215576172
Epoch: 43, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.212 Vali Acc: 0.975 Test Loss: 0.212 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.4593784809112549
Epoch: 44, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.218 Vali Acc: 0.975 Test Loss: 0.218 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.5315220355987549
Epoch: 45, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.210 Vali Acc: 0.975 Test Loss: 0.210 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 46 cost time: 0.5157871246337891
Epoch: 46, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.209 Vali Acc: 0.975 Test Loss: 0.209 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 47 cost time: 0.4922664165496826
Epoch: 47, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.197 Vali Acc: 0.975 Test Loss: 0.197 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 48 cost time: 0.4975852966308594
Epoch: 48, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.191 Vali Acc: 0.975 Test Loss: 0.191 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 49 cost time: 0.5092809200286865
Epoch: 49, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.188 Vali Acc: 0.975 Test Loss: 0.188 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 50 cost time: 0.44797730445861816
Epoch: 50, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.189 Vali Acc: 0.975 Test Loss: 0.189 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 1107204
model size : 4.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps20_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.8556897640228271
Epoch: 1, Steps: 3 | Train Loss: 1.464 Vali Loss: 1.416 Vali Acc: 0.075 Test Loss: 1.416 Test Acc: 0.075
Validation loss decreased (inf --> -0.074986).  Saving model ...
Epoch: 2 cost time: 0.4263453483581543
Epoch: 2, Steps: 3 | Train Loss: 1.407 Vali Loss: 1.404 Vali Acc: 0.075 Test Loss: 1.404 Test Acc: 0.075
Validation loss decreased (-0.074986 --> -0.074986).  Saving model ...
Epoch: 3 cost time: 0.45825982093811035
Epoch: 3, Steps: 3 | Train Loss: 1.409 Vali Loss: 1.386 Vali Acc: 0.125 Test Loss: 1.386 Test Acc: 0.125
Validation loss decreased (-0.074986 --> -0.124986).  Saving model ...
Epoch: 4 cost time: 0.489124059677124
Epoch: 4, Steps: 3 | Train Loss: 1.335 Vali Loss: 1.357 Vali Acc: 0.150 Test Loss: 1.357 Test Acc: 0.150
Validation loss decreased (-0.124986 --> -0.149986).  Saving model ...
Epoch: 5 cost time: 0.46452903747558594
Epoch: 5, Steps: 3 | Train Loss: 1.286 Vali Loss: 1.318 Vali Acc: 0.250 Test Loss: 1.318 Test Acc: 0.250
Validation loss decreased (-0.149986 --> -0.249987).  Saving model ...
Epoch: 6 cost time: 0.4878876209259033
Epoch: 6, Steps: 3 | Train Loss: 1.207 Vali Loss: 1.272 Vali Acc: 0.375 Test Loss: 1.272 Test Acc: 0.375
Validation loss decreased (-0.249987 --> -0.374987).  Saving model ...
Epoch: 7 cost time: 0.49135804176330566
Epoch: 7, Steps: 3 | Train Loss: 1.124 Vali Loss: 1.221 Vali Acc: 0.525 Test Loss: 1.221 Test Acc: 0.525
Validation loss decreased (-0.374987 --> -0.524988).  Saving model ...
Epoch: 8 cost time: 0.5061612129211426
Epoch: 8, Steps: 3 | Train Loss: 1.068 Vali Loss: 1.165 Vali Acc: 0.625 Test Loss: 1.165 Test Acc: 0.625
Validation loss decreased (-0.524988 --> -0.624988).  Saving model ...
Epoch: 9 cost time: 0.5187692642211914
Epoch: 9, Steps: 3 | Train Loss: 0.990 Vali Loss: 1.109 Vali Acc: 0.700 Test Loss: 1.109 Test Acc: 0.700
Validation loss decreased (-0.624988 --> -0.699989).  Saving model ...
Epoch: 10 cost time: 0.4452505111694336
Epoch: 10, Steps: 3 | Train Loss: 0.953 Vali Loss: 1.048 Vali Acc: 0.825 Test Loss: 1.048 Test Acc: 0.825
Validation loss decreased (-0.699989 --> -0.824990).  Saving model ...
Epoch: 11 cost time: 0.5224480628967285
Epoch: 11, Steps: 3 | Train Loss: 0.884 Vali Loss: 0.990 Vali Acc: 0.850 Test Loss: 0.990 Test Acc: 0.850
Validation loss decreased (-0.824990 --> -0.849990).  Saving model ...
Epoch: 12 cost time: 0.48134374618530273
Epoch: 12, Steps: 3 | Train Loss: 0.810 Vali Loss: 0.932 Vali Acc: 0.850 Test Loss: 0.932 Test Acc: 0.850
Validation loss decreased (-0.849990 --> -0.849991).  Saving model ...
Epoch: 13 cost time: 0.6502864360809326
Epoch: 13, Steps: 3 | Train Loss: 0.736 Vali Loss: 0.881 Vali Acc: 0.925 Test Loss: 0.881 Test Acc: 0.925
Validation loss decreased (-0.849991 --> -0.924991).  Saving model ...
Epoch: 14 cost time: 0.499591588973999
Epoch: 14, Steps: 3 | Train Loss: 0.710 Vali Loss: 0.828 Vali Acc: 0.925 Test Loss: 0.828 Test Acc: 0.925
Validation loss decreased (-0.924991 --> -0.924992).  Saving model ...
Epoch: 15 cost time: 0.48657870292663574
Epoch: 15, Steps: 3 | Train Loss: 0.637 Vali Loss: 0.788 Vali Acc: 0.925 Test Loss: 0.788 Test Acc: 0.925
Validation loss decreased (-0.924992 --> -0.924992).  Saving model ...
Epoch: 16 cost time: 0.5132861137390137
Epoch: 16, Steps: 3 | Train Loss: 0.608 Vali Loss: 0.738 Vali Acc: 0.925 Test Loss: 0.738 Test Acc: 0.925
Validation loss decreased (-0.924992 --> -0.924993).  Saving model ...
Epoch: 17 cost time: 0.4715232849121094
Epoch: 17, Steps: 3 | Train Loss: 0.545 Vali Loss: 0.704 Vali Acc: 0.900 Test Loss: 0.704 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.4922337532043457
Epoch: 18, Steps: 3 | Train Loss: 0.508 Vali Loss: 0.665 Vali Acc: 0.900 Test Loss: 0.665 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.5009276866912842
Epoch: 19, Steps: 3 | Train Loss: 0.467 Vali Loss: 0.641 Vali Acc: 0.900 Test Loss: 0.641 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.49176645278930664
Epoch: 20, Steps: 3 | Train Loss: 0.438 Vali Loss: 0.609 Vali Acc: 0.925 Test Loss: 0.609 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924994).  Saving model ...
Epoch: 21 cost time: 0.4763667583465576
Epoch: 21, Steps: 3 | Train Loss: 0.412 Vali Loss: 0.574 Vali Acc: 0.925 Test Loss: 0.574 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 22 cost time: 0.4660019874572754
Epoch: 22, Steps: 3 | Train Loss: 0.391 Vali Loss: 0.541 Vali Acc: 0.925 Test Loss: 0.541 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 23 cost time: 0.5191586017608643
Epoch: 23, Steps: 3 | Train Loss: 0.363 Vali Loss: 0.518 Vali Acc: 0.925 Test Loss: 0.518 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 24 cost time: 0.5532815456390381
Epoch: 24, Steps: 3 | Train Loss: 0.351 Vali Loss: 0.496 Vali Acc: 0.925 Test Loss: 0.496 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 25 cost time: 0.41490888595581055
Epoch: 25, Steps: 3 | Train Loss: 0.319 Vali Loss: 0.478 Vali Acc: 0.925 Test Loss: 0.478 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 26 cost time: 0.47119832038879395
Epoch: 26, Steps: 3 | Train Loss: 0.277 Vali Loss: 0.470 Vali Acc: 0.925 Test Loss: 0.470 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 27 cost time: 0.44844937324523926
Epoch: 27, Steps: 3 | Train Loss: 0.272 Vali Loss: 0.455 Vali Acc: 0.925 Test Loss: 0.455 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 28 cost time: 0.46168041229248047
Epoch: 28, Steps: 3 | Train Loss: 0.250 Vali Loss: 0.433 Vali Acc: 0.950 Test Loss: 0.433 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949996).  Saving model ...
Epoch: 29 cost time: 0.45787858963012695
Epoch: 29, Steps: 3 | Train Loss: 0.238 Vali Loss: 0.419 Vali Acc: 0.950 Test Loss: 0.419 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 30 cost time: 0.4786641597747803
Epoch: 30, Steps: 3 | Train Loss: 0.228 Vali Loss: 0.387 Vali Acc: 0.950 Test Loss: 0.387 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 31 cost time: 0.5153861045837402
Epoch: 31, Steps: 3 | Train Loss: 0.221 Vali Loss: 0.370 Vali Acc: 0.950 Test Loss: 0.370 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 32 cost time: 0.48926877975463867
Epoch: 32, Steps: 3 | Train Loss: 0.205 Vali Loss: 0.350 Vali Acc: 0.950 Test Loss: 0.350 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 33 cost time: 0.5029010772705078
Epoch: 33, Steps: 3 | Train Loss: 0.173 Vali Loss: 0.342 Vali Acc: 0.950 Test Loss: 0.342 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 34 cost time: 0.5567781925201416
Epoch: 34, Steps: 3 | Train Loss: 0.175 Vali Loss: 0.325 Vali Acc: 0.950 Test Loss: 0.325 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 35 cost time: 0.5901565551757812
Epoch: 35, Steps: 3 | Train Loss: 0.164 Vali Loss: 0.311 Vali Acc: 0.950 Test Loss: 0.311 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 36 cost time: 0.4966549873352051
Epoch: 36, Steps: 3 | Train Loss: 0.169 Vali Loss: 0.301 Vali Acc: 0.950 Test Loss: 0.301 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 37 cost time: 0.47053050994873047
Epoch: 37, Steps: 3 | Train Loss: 0.157 Vali Loss: 0.293 Vali Acc: 0.950 Test Loss: 0.293 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 38 cost time: 0.501802921295166
Epoch: 38, Steps: 3 | Train Loss: 0.129 Vali Loss: 0.290 Vali Acc: 0.950 Test Loss: 0.290 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 39 cost time: 0.5796365737915039
Epoch: 39, Steps: 3 | Train Loss: 0.131 Vali Loss: 0.279 Vali Acc: 0.950 Test Loss: 0.279 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 40 cost time: 0.45920896530151367
Epoch: 40, Steps: 3 | Train Loss: 0.107 Vali Loss: 0.269 Vali Acc: 0.950 Test Loss: 0.269 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 41 cost time: 0.4697887897491455
Epoch: 41, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.261 Vali Acc: 0.950 Test Loss: 0.261 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 42 cost time: 0.45622849464416504
Epoch: 42, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.257 Vali Acc: 0.950 Test Loss: 0.257 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 43 cost time: 0.4756174087524414
Epoch: 43, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.253 Vali Acc: 0.950 Test Loss: 0.253 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 44 cost time: 0.5235607624053955
Epoch: 44, Steps: 3 | Train Loss: 0.078 Vali Loss: 0.244 Vali Acc: 0.950 Test Loss: 0.244 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 45 cost time: 0.5461440086364746
Epoch: 45, Steps: 3 | Train Loss: 0.080 Vali Loss: 0.236 Vali Acc: 0.950 Test Loss: 0.236 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 46 cost time: 0.5539450645446777
Epoch: 46, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.231 Vali Acc: 0.950 Test Loss: 0.231 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 47 cost time: 0.5189952850341797
Epoch: 47, Steps: 3 | Train Loss: 0.061 Vali Loss: 0.231 Vali Acc: 0.950 Test Loss: 0.231 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.5697989463806152
Epoch: 48, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.224 Vali Acc: 0.950 Test Loss: 0.224 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 49 cost time: 0.579319953918457
Epoch: 49, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.221 Vali Acc: 0.950 Test Loss: 0.221 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 50 cost time: 0.5568032264709473
Epoch: 50, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.218 Vali Acc: 0.925 Test Loss: 0.218 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps20_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 1104452
model size : 4.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps25_str13_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.8056738376617432
Epoch: 1, Steps: 3 | Train Loss: 1.427 Vali Loss: 1.376 Vali Acc: 0.425 Test Loss: 1.376 Test Acc: 0.425
Validation loss decreased (inf --> -0.424986).  Saving model ...
Epoch: 2 cost time: 0.5282189846038818
Epoch: 2, Steps: 3 | Train Loss: 1.407 Vali Loss: 1.359 Vali Acc: 0.425 Test Loss: 1.359 Test Acc: 0.425
Validation loss decreased (-0.424986 --> -0.424986).  Saving model ...
Epoch: 3 cost time: 0.4439091682434082
Epoch: 3, Steps: 3 | Train Loss: 1.365 Vali Loss: 1.338 Vali Acc: 0.475 Test Loss: 1.338 Test Acc: 0.475
Validation loss decreased (-0.424986 --> -0.474987).  Saving model ...
Epoch: 4 cost time: 0.4594244956970215
Epoch: 4, Steps: 3 | Train Loss: 1.356 Vali Loss: 1.307 Vali Acc: 0.600 Test Loss: 1.307 Test Acc: 0.600
Validation loss decreased (-0.474987 --> -0.599987).  Saving model ...
Epoch: 5 cost time: 0.48185205459594727
Epoch: 5, Steps: 3 | Train Loss: 1.252 Vali Loss: 1.270 Vali Acc: 0.675 Test Loss: 1.270 Test Acc: 0.675
Validation loss decreased (-0.599987 --> -0.674987).  Saving model ...
Epoch: 6 cost time: 0.4281022548675537
Epoch: 6, Steps: 3 | Train Loss: 1.205 Vali Loss: 1.226 Vali Acc: 0.675 Test Loss: 1.226 Test Acc: 0.675
Validation loss decreased (-0.674987 --> -0.674988).  Saving model ...
Epoch: 7 cost time: 0.5010428428649902
Epoch: 7, Steps: 3 | Train Loss: 1.137 Vali Loss: 1.179 Vali Acc: 0.725 Test Loss: 1.179 Test Acc: 0.725
Validation loss decreased (-0.674988 --> -0.724988).  Saving model ...
Epoch: 8 cost time: 0.4921431541442871
Epoch: 8, Steps: 3 | Train Loss: 1.086 Vali Loss: 1.125 Vali Acc: 0.800 Test Loss: 1.125 Test Acc: 0.800
Validation loss decreased (-0.724988 --> -0.799989).  Saving model ...
Epoch: 9 cost time: 0.5298740863800049
Epoch: 9, Steps: 3 | Train Loss: 1.021 Vali Loss: 1.069 Vali Acc: 0.850 Test Loss: 1.069 Test Acc: 0.850
Validation loss decreased (-0.799989 --> -0.849989).  Saving model ...
Epoch: 10 cost time: 0.5983850955963135
Epoch: 10, Steps: 3 | Train Loss: 0.961 Vali Loss: 1.007 Vali Acc: 0.850 Test Loss: 1.007 Test Acc: 0.850
Validation loss decreased (-0.849989 --> -0.849990).  Saving model ...
Epoch: 11 cost time: 0.48612523078918457
Epoch: 11, Steps: 3 | Train Loss: 0.884 Vali Loss: 0.963 Vali Acc: 0.850 Test Loss: 0.963 Test Acc: 0.850
Validation loss decreased (-0.849990 --> -0.849990).  Saving model ...
Epoch: 12 cost time: 0.5104095935821533
Epoch: 12, Steps: 3 | Train Loss: 0.841 Vali Loss: 0.915 Vali Acc: 0.900 Test Loss: 0.915 Test Acc: 0.900
Validation loss decreased (-0.849990 --> -0.899991).  Saving model ...
Epoch: 13 cost time: 0.47388362884521484
Epoch: 13, Steps: 3 | Train Loss: 0.779 Vali Loss: 0.867 Vali Acc: 0.900 Test Loss: 0.867 Test Acc: 0.900
Validation loss decreased (-0.899991 --> -0.899991).  Saving model ...
Epoch: 14 cost time: 0.45758938789367676
Epoch: 14, Steps: 3 | Train Loss: 0.707 Vali Loss: 0.826 Vali Acc: 0.900 Test Loss: 0.826 Test Acc: 0.900
Validation loss decreased (-0.899991 --> -0.899992).  Saving model ...
Epoch: 15 cost time: 0.5086538791656494
Epoch: 15, Steps: 3 | Train Loss: 0.673 Vali Loss: 0.778 Vali Acc: 0.925 Test Loss: 0.778 Test Acc: 0.925
Validation loss decreased (-0.899992 --> -0.924992).  Saving model ...
Epoch: 16 cost time: 0.4504818916320801
Epoch: 16, Steps: 3 | Train Loss: 0.661 Vali Loss: 0.733 Vali Acc: 0.925 Test Loss: 0.733 Test Acc: 0.925
Validation loss decreased (-0.924992 --> -0.924993).  Saving model ...
Epoch: 17 cost time: 0.4910004138946533
Epoch: 17, Steps: 3 | Train Loss: 0.601 Vali Loss: 0.697 Vali Acc: 0.925 Test Loss: 0.697 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924993).  Saving model ...
Epoch: 18 cost time: 0.48706793785095215
Epoch: 18, Steps: 3 | Train Loss: 0.581 Vali Loss: 0.653 Vali Acc: 0.925 Test Loss: 0.653 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924993).  Saving model ...
Epoch: 19 cost time: 0.47277379035949707
Epoch: 19, Steps: 3 | Train Loss: 0.518 Vali Loss: 0.628 Vali Acc: 0.925 Test Loss: 0.628 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924994).  Saving model ...
Epoch: 20 cost time: 0.4893031120300293
Epoch: 20, Steps: 3 | Train Loss: 0.470 Vali Loss: 0.603 Vali Acc: 0.950 Test Loss: 0.603 Test Acc: 0.950
Validation loss decreased (-0.924994 --> -0.949994).  Saving model ...
Epoch: 21 cost time: 0.4825305938720703
Epoch: 21, Steps: 3 | Train Loss: 0.466 Vali Loss: 0.572 Vali Acc: 0.950 Test Loss: 0.572 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949994).  Saving model ...
Epoch: 22 cost time: 0.4732074737548828
Epoch: 22, Steps: 3 | Train Loss: 0.424 Vali Loss: 0.545 Vali Acc: 0.950 Test Loss: 0.545 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 23 cost time: 0.47954678535461426
Epoch: 23, Steps: 3 | Train Loss: 0.399 Vali Loss: 0.510 Vali Acc: 0.950 Test Loss: 0.510 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 24 cost time: 0.5800073146820068
Epoch: 24, Steps: 3 | Train Loss: 0.371 Vali Loss: 0.485 Vali Acc: 0.950 Test Loss: 0.485 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 25 cost time: 0.482269287109375
Epoch: 25, Steps: 3 | Train Loss: 0.329 Vali Loss: 0.468 Vali Acc: 0.950 Test Loss: 0.468 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 26 cost time: 0.42461347579956055
Epoch: 26, Steps: 3 | Train Loss: 0.293 Vali Loss: 0.445 Vali Acc: 0.950 Test Loss: 0.445 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 27 cost time: 0.5583832263946533
Epoch: 27, Steps: 3 | Train Loss: 0.303 Vali Loss: 0.432 Vali Acc: 0.950 Test Loss: 0.432 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 28 cost time: 0.4215245246887207
Epoch: 28, Steps: 3 | Train Loss: 0.267 Vali Loss: 0.410 Vali Acc: 0.950 Test Loss: 0.410 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 29 cost time: 0.47237634658813477
Epoch: 29, Steps: 3 | Train Loss: 0.246 Vali Loss: 0.387 Vali Acc: 0.950 Test Loss: 0.387 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 30 cost time: 0.4422342777252197
Epoch: 30, Steps: 3 | Train Loss: 0.217 Vali Loss: 0.362 Vali Acc: 0.950 Test Loss: 0.362 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 31 cost time: 0.44010114669799805
Epoch: 31, Steps: 3 | Train Loss: 0.228 Vali Loss: 0.349 Vali Acc: 0.950 Test Loss: 0.349 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 32 cost time: 0.5193402767181396
Epoch: 32, Steps: 3 | Train Loss: 0.196 Vali Loss: 0.338 Vali Acc: 0.950 Test Loss: 0.338 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 33 cost time: 0.5405874252319336
Epoch: 33, Steps: 3 | Train Loss: 0.212 Vali Loss: 0.320 Vali Acc: 0.950 Test Loss: 0.320 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 34 cost time: 0.4146606922149658
Epoch: 34, Steps: 3 | Train Loss: 0.189 Vali Loss: 0.312 Vali Acc: 0.950 Test Loss: 0.312 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 35 cost time: 0.4592316150665283
Epoch: 35, Steps: 3 | Train Loss: 0.168 Vali Loss: 0.307 Vali Acc: 0.950 Test Loss: 0.307 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 36 cost time: 0.49283432960510254
Epoch: 36, Steps: 3 | Train Loss: 0.165 Vali Loss: 0.292 Vali Acc: 0.975 Test Loss: 0.292 Test Acc: 0.975
Validation loss decreased (-0.949997 --> -0.974997).  Saving model ...
Epoch: 37 cost time: 0.5221331119537354
Epoch: 37, Steps: 3 | Train Loss: 0.140 Vali Loss: 0.280 Vali Acc: 0.975 Test Loss: 0.280 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 38 cost time: 0.5069923400878906
Epoch: 38, Steps: 3 | Train Loss: 0.125 Vali Loss: 0.269 Vali Acc: 0.975 Test Loss: 0.269 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 39 cost time: 0.4726834297180176
Epoch: 39, Steps: 3 | Train Loss: 0.114 Vali Loss: 0.252 Vali Acc: 0.975 Test Loss: 0.252 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 40 cost time: 0.4835011959075928
Epoch: 40, Steps: 3 | Train Loss: 0.112 Vali Loss: 0.251 Vali Acc: 0.975 Test Loss: 0.251 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 41 cost time: 0.5195963382720947
Epoch: 41, Steps: 3 | Train Loss: 0.116 Vali Loss: 0.237 Vali Acc: 0.975 Test Loss: 0.237 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 42 cost time: 0.45726728439331055
Epoch: 42, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.233 Vali Acc: 0.975 Test Loss: 0.233 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 43 cost time: 0.3989424705505371
Epoch: 43, Steps: 3 | Train Loss: 0.085 Vali Loss: 0.228 Vali Acc: 0.975 Test Loss: 0.228 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 44 cost time: 0.5562937259674072
Epoch: 44, Steps: 3 | Train Loss: 0.083 Vali Loss: 0.219 Vali Acc: 0.975 Test Loss: 0.219 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 45 cost time: 0.4353456497192383
Epoch: 45, Steps: 3 | Train Loss: 0.115 Vali Loss: 0.220 Vali Acc: 0.975 Test Loss: 0.220 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.47505807876586914
Epoch: 46, Steps: 3 | Train Loss: 0.073 Vali Loss: 0.205 Vali Acc: 0.975 Test Loss: 0.205 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 47 cost time: 0.4146687984466553
Epoch: 47, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.202 Vali Acc: 0.975 Test Loss: 0.202 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 48 cost time: 0.4440896511077881
Epoch: 48, Steps: 3 | Train Loss: 0.073 Vali Loss: 0.197 Vali Acc: 0.975 Test Loss: 0.197 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 49 cost time: 0.5437753200531006
Epoch: 49, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.190 Vali Acc: 0.975 Test Loss: 0.190 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 50 cost time: 0.5242147445678711
Epoch: 50, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.182 Vali Acc: 0.975 Test Loss: 0.182 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps25_str13_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 1101700
model size : 4.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.780329704284668
Epoch: 1, Steps: 3 | Train Loss: 1.362 Vali Loss: 1.333 Vali Acc: 0.275 Test Loss: 1.333 Test Acc: 0.275
Validation loss decreased (inf --> -0.274987).  Saving model ...
Epoch: 2 cost time: 0.4930710792541504
Epoch: 2, Steps: 3 | Train Loss: 1.301 Vali Loss: 1.310 Vali Acc: 0.325 Test Loss: 1.310 Test Acc: 0.325
Validation loss decreased (-0.274987 --> -0.324987).  Saving model ...
Epoch: 3 cost time: 0.4294109344482422
Epoch: 3, Steps: 3 | Train Loss: 1.290 Vali Loss: 1.272 Vali Acc: 0.425 Test Loss: 1.272 Test Acc: 0.425
Validation loss decreased (-0.324987 --> -0.424987).  Saving model ...
Epoch: 4 cost time: 0.4991929531097412
Epoch: 4, Steps: 3 | Train Loss: 1.211 Vali Loss: 1.218 Vali Acc: 0.525 Test Loss: 1.218 Test Acc: 0.525
Validation loss decreased (-0.424987 --> -0.524988).  Saving model ...
Epoch: 5 cost time: 0.4784963130950928
Epoch: 5, Steps: 3 | Train Loss: 1.113 Vali Loss: 1.156 Vali Acc: 0.550 Test Loss: 1.156 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549988).  Saving model ...
Epoch: 6 cost time: 0.4147300720214844
Epoch: 6, Steps: 3 | Train Loss: 1.037 Vali Loss: 1.084 Vali Acc: 0.575 Test Loss: 1.084 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574989).  Saving model ...
Epoch: 7 cost time: 0.4577925205230713
Epoch: 7, Steps: 3 | Train Loss: 0.933 Vali Loss: 1.018 Vali Acc: 0.600 Test Loss: 1.018 Test Acc: 0.600
Validation loss decreased (-0.574989 --> -0.599990).  Saving model ...
Epoch: 8 cost time: 0.4805281162261963
Epoch: 8, Steps: 3 | Train Loss: 0.837 Vali Loss: 0.944 Vali Acc: 0.850 Test Loss: 0.944 Test Acc: 0.850
Validation loss decreased (-0.599990 --> -0.849991).  Saving model ...
Epoch: 9 cost time: 0.4526379108428955
Epoch: 9, Steps: 3 | Train Loss: 0.757 Vali Loss: 0.866 Vali Acc: 0.925 Test Loss: 0.866 Test Acc: 0.925
Validation loss decreased (-0.849991 --> -0.924991).  Saving model ...
Epoch: 10 cost time: 0.4561879634857178
Epoch: 10, Steps: 3 | Train Loss: 0.653 Vali Loss: 0.800 Vali Acc: 0.925 Test Loss: 0.800 Test Acc: 0.925
Validation loss decreased (-0.924991 --> -0.924992).  Saving model ...
Epoch: 11 cost time: 0.45491838455200195
Epoch: 11, Steps: 3 | Train Loss: 0.616 Vali Loss: 0.720 Vali Acc: 0.925 Test Loss: 0.720 Test Acc: 0.925
Validation loss decreased (-0.924992 --> -0.924993).  Saving model ...
Epoch: 12 cost time: 0.42828917503356934
Epoch: 12, Steps: 3 | Train Loss: 0.544 Vali Loss: 0.657 Vali Acc: 0.925 Test Loss: 0.657 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924993).  Saving model ...
Epoch: 13 cost time: 0.5175762176513672
Epoch: 13, Steps: 3 | Train Loss: 0.452 Vali Loss: 0.606 Vali Acc: 0.925 Test Loss: 0.606 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924994).  Saving model ...
Epoch: 14 cost time: 0.4506964683532715
Epoch: 14, Steps: 3 | Train Loss: 0.414 Vali Loss: 0.561 Vali Acc: 0.950 Test Loss: 0.561 Test Acc: 0.950
Validation loss decreased (-0.924994 --> -0.949994).  Saving model ...
Epoch: 15 cost time: 0.46723341941833496
Epoch: 15, Steps: 3 | Train Loss: 0.365 Vali Loss: 0.518 Vali Acc: 0.950 Test Loss: 0.518 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 16 cost time: 0.44071006774902344
Epoch: 16, Steps: 3 | Train Loss: 0.352 Vali Loss: 0.488 Vali Acc: 0.950 Test Loss: 0.488 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 17 cost time: 0.5235819816589355
Epoch: 17, Steps: 3 | Train Loss: 0.286 Vali Loss: 0.454 Vali Acc: 0.950 Test Loss: 0.454 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 18 cost time: 0.42438840866088867
Epoch: 18, Steps: 3 | Train Loss: 0.236 Vali Loss: 0.428 Vali Acc: 0.950 Test Loss: 0.428 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 19 cost time: 0.5295536518096924
Epoch: 19, Steps: 3 | Train Loss: 0.240 Vali Loss: 0.406 Vali Acc: 0.950 Test Loss: 0.406 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 20 cost time: 0.4243948459625244
Epoch: 20, Steps: 3 | Train Loss: 0.216 Vali Loss: 0.392 Vali Acc: 0.950 Test Loss: 0.392 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 21 cost time: 0.3939487934112549
Epoch: 21, Steps: 3 | Train Loss: 0.209 Vali Loss: 0.362 Vali Acc: 0.950 Test Loss: 0.362 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 22 cost time: 0.40559887886047363
Epoch: 22, Steps: 3 | Train Loss: 0.190 Vali Loss: 0.339 Vali Acc: 0.950 Test Loss: 0.339 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 23 cost time: 0.3886106014251709
Epoch: 23, Steps: 3 | Train Loss: 0.199 Vali Loss: 0.318 Vali Acc: 0.950 Test Loss: 0.318 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 24 cost time: 0.4294719696044922
Epoch: 24, Steps: 3 | Train Loss: 0.175 Vali Loss: 0.306 Vali Acc: 0.950 Test Loss: 0.306 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 25 cost time: 0.4332084655761719
Epoch: 25, Steps: 3 | Train Loss: 0.150 Vali Loss: 0.305 Vali Acc: 0.950 Test Loss: 0.305 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 26 cost time: 0.4457392692565918
Epoch: 26, Steps: 3 | Train Loss: 0.142 Vali Loss: 0.297 Vali Acc: 0.950 Test Loss: 0.297 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 27 cost time: 0.4868776798248291
Epoch: 27, Steps: 3 | Train Loss: 0.128 Vali Loss: 0.297 Vali Acc: 0.950 Test Loss: 0.297 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.4669356346130371
Epoch: 28, Steps: 3 | Train Loss: 0.106 Vali Loss: 0.290 Vali Acc: 0.950 Test Loss: 0.290 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 29 cost time: 0.5193815231323242
Epoch: 29, Steps: 3 | Train Loss: 0.101 Vali Loss: 0.285 Vali Acc: 0.950 Test Loss: 0.285 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 30 cost time: 0.4560580253601074
Epoch: 30, Steps: 3 | Train Loss: 0.098 Vali Loss: 0.285 Vali Acc: 0.925 Test Loss: 0.285 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.45886731147766113
Epoch: 31, Steps: 3 | Train Loss: 0.074 Vali Loss: 0.294 Vali Acc: 0.925 Test Loss: 0.294 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.4065079689025879
Epoch: 32, Steps: 3 | Train Loss: 0.072 Vali Loss: 0.294 Vali Acc: 0.925 Test Loss: 0.294 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.47899460792541504
Epoch: 33, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.288 Vali Acc: 0.925 Test Loss: 0.288 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.467815637588501
Epoch: 34, Steps: 3 | Train Loss: 0.061 Vali Loss: 0.291 Vali Acc: 0.925 Test Loss: 0.291 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.42000293731689453
Epoch: 35, Steps: 3 | Train Loss: 0.068 Vali Loss: 0.295 Vali Acc: 0.925 Test Loss: 0.295 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.49181556701660156
Epoch: 36, Steps: 3 | Train Loss: 0.061 Vali Loss: 0.299 Vali Acc: 0.925 Test Loss: 0.299 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.45970821380615234
Epoch: 37, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.305 Vali Acc: 0.925 Test Loss: 0.305 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.460482120513916
Epoch: 38, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.301 Vali Acc: 0.925 Test Loss: 0.301 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.47915148735046387
Epoch: 39, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.291 Vali Acc: 0.925 Test Loss: 0.291 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 332548
model size : 1.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.7479519844055176
Epoch: 1, Steps: 3 | Train Loss: 1.267 Vali Loss: 1.318 Vali Acc: 0.525 Test Loss: 1.318 Test Acc: 0.525
Validation loss decreased (inf --> -0.524987).  Saving model ...
Epoch: 2 cost time: 0.44896483421325684
Epoch: 2, Steps: 3 | Train Loss: 1.234 Vali Loss: 1.290 Vali Acc: 0.550 Test Loss: 1.290 Test Acc: 0.550
Validation loss decreased (-0.524987 --> -0.549987).  Saving model ...
Epoch: 3 cost time: 0.4636855125427246
Epoch: 3, Steps: 3 | Train Loss: 1.186 Vali Loss: 1.255 Vali Acc: 0.600 Test Loss: 1.255 Test Acc: 0.600
Validation loss decreased (-0.549987 --> -0.599987).  Saving model ...
Epoch: 4 cost time: 0.4602513313293457
Epoch: 4, Steps: 3 | Train Loss: 1.171 Vali Loss: 1.207 Vali Acc: 0.625 Test Loss: 1.207 Test Acc: 0.625
Validation loss decreased (-0.599987 --> -0.624988).  Saving model ...
Epoch: 5 cost time: 0.47786426544189453
Epoch: 5, Steps: 3 | Train Loss: 1.087 Vali Loss: 1.150 Vali Acc: 0.625 Test Loss: 1.150 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624988).  Saving model ...
Epoch: 6 cost time: 0.5234105587005615
Epoch: 6, Steps: 3 | Train Loss: 1.028 Vali Loss: 1.087 Vali Acc: 0.650 Test Loss: 1.087 Test Acc: 0.650
Validation loss decreased (-0.624988 --> -0.649989).  Saving model ...
Epoch: 7 cost time: 0.5519623756408691
Epoch: 7, Steps: 3 | Train Loss: 0.946 Vali Loss: 1.015 Vali Acc: 0.775 Test Loss: 1.015 Test Acc: 0.775
Validation loss decreased (-0.649989 --> -0.774990).  Saving model ...
Epoch: 8 cost time: 0.5198588371276855
Epoch: 8, Steps: 3 | Train Loss: 0.860 Vali Loss: 0.948 Vali Acc: 0.775 Test Loss: 0.948 Test Acc: 0.775
Validation loss decreased (-0.774990 --> -0.774991).  Saving model ...
Epoch: 9 cost time: 0.43584489822387695
Epoch: 9, Steps: 3 | Train Loss: 0.795 Vali Loss: 0.873 Vali Acc: 0.800 Test Loss: 0.873 Test Acc: 0.800
Validation loss decreased (-0.774991 --> -0.799991).  Saving model ...
Epoch: 10 cost time: 0.3971846103668213
Epoch: 10, Steps: 3 | Train Loss: 0.704 Vali Loss: 0.802 Vali Acc: 0.850 Test Loss: 0.802 Test Acc: 0.850
Validation loss decreased (-0.799991 --> -0.849992).  Saving model ...
Epoch: 11 cost time: 0.4334542751312256
Epoch: 11, Steps: 3 | Train Loss: 0.661 Vali Loss: 0.737 Vali Acc: 0.850 Test Loss: 0.737 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849993).  Saving model ...
Epoch: 12 cost time: 0.4643557071685791
Epoch: 12, Steps: 3 | Train Loss: 0.575 Vali Loss: 0.684 Vali Acc: 0.850 Test Loss: 0.684 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 13 cost time: 0.3999485969543457
Epoch: 13, Steps: 3 | Train Loss: 0.548 Vali Loss: 0.625 Vali Acc: 0.900 Test Loss: 0.625 Test Acc: 0.900
Validation loss decreased (-0.849993 --> -0.899994).  Saving model ...
Epoch: 14 cost time: 0.42772459983825684
Epoch: 14, Steps: 3 | Train Loss: 0.475 Vali Loss: 0.580 Vali Acc: 0.950 Test Loss: 0.580 Test Acc: 0.950
Validation loss decreased (-0.899994 --> -0.949994).  Saving model ...
Epoch: 15 cost time: 0.43921637535095215
Epoch: 15, Steps: 3 | Train Loss: 0.437 Vali Loss: 0.534 Vali Acc: 0.950 Test Loss: 0.534 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 16 cost time: 0.44322776794433594
Epoch: 16, Steps: 3 | Train Loss: 0.396 Vali Loss: 0.495 Vali Acc: 0.950 Test Loss: 0.495 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 17 cost time: 0.4462394714355469
Epoch: 17, Steps: 3 | Train Loss: 0.374 Vali Loss: 0.463 Vali Acc: 0.950 Test Loss: 0.463 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 18 cost time: 0.4054269790649414
Epoch: 18, Steps: 3 | Train Loss: 0.328 Vali Loss: 0.436 Vali Acc: 0.950 Test Loss: 0.436 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 19 cost time: 0.44093799591064453
Epoch: 19, Steps: 3 | Train Loss: 0.295 Vali Loss: 0.411 Vali Acc: 0.925 Test Loss: 0.411 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.40546107292175293
Epoch: 20, Steps: 3 | Train Loss: 0.278 Vali Loss: 0.393 Vali Acc: 0.925 Test Loss: 0.393 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.5205180644989014
Epoch: 21, Steps: 3 | Train Loss: 0.253 Vali Loss: 0.372 Vali Acc: 0.950 Test Loss: 0.372 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 22 cost time: 0.43297719955444336
Epoch: 22, Steps: 3 | Train Loss: 0.248 Vali Loss: 0.353 Vali Acc: 0.950 Test Loss: 0.353 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 23 cost time: 0.4273257255554199
Epoch: 23, Steps: 3 | Train Loss: 0.209 Vali Loss: 0.340 Vali Acc: 0.950 Test Loss: 0.340 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 24 cost time: 0.40477585792541504
Epoch: 24, Steps: 3 | Train Loss: 0.201 Vali Loss: 0.308 Vali Acc: 0.950 Test Loss: 0.308 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 25 cost time: 0.42293667793273926
Epoch: 25, Steps: 3 | Train Loss: 0.195 Vali Loss: 0.289 Vali Acc: 0.950 Test Loss: 0.289 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 26 cost time: 0.4429450035095215
Epoch: 26, Steps: 3 | Train Loss: 0.195 Vali Loss: 0.271 Vali Acc: 0.950 Test Loss: 0.271 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 27 cost time: 0.43454551696777344
Epoch: 27, Steps: 3 | Train Loss: 0.176 Vali Loss: 0.257 Vali Acc: 0.975 Test Loss: 0.257 Test Acc: 0.975
Validation loss decreased (-0.949997 --> -0.974997).  Saving model ...
Epoch: 28 cost time: 0.436704158782959
Epoch: 28, Steps: 3 | Train Loss: 0.161 Vali Loss: 0.246 Vali Acc: 0.975 Test Loss: 0.246 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 29 cost time: 0.4894986152648926
Epoch: 29, Steps: 3 | Train Loss: 0.165 Vali Loss: 0.236 Vali Acc: 0.975 Test Loss: 0.236 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 30 cost time: 0.4206397533416748
Epoch: 30, Steps: 3 | Train Loss: 0.128 Vali Loss: 0.229 Vali Acc: 0.975 Test Loss: 0.229 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 31 cost time: 0.4557969570159912
Epoch: 31, Steps: 3 | Train Loss: 0.106 Vali Loss: 0.221 Vali Acc: 0.975 Test Loss: 0.221 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 32 cost time: 0.40486693382263184
Epoch: 32, Steps: 3 | Train Loss: 0.110 Vali Loss: 0.209 Vali Acc: 0.975 Test Loss: 0.209 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 33 cost time: 0.4363236427307129
Epoch: 33, Steps: 3 | Train Loss: 0.104 Vali Loss: 0.205 Vali Acc: 0.975 Test Loss: 0.205 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 34 cost time: 0.4197089672088623
Epoch: 34, Steps: 3 | Train Loss: 0.099 Vali Loss: 0.195 Vali Acc: 0.975 Test Loss: 0.195 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 35 cost time: 0.4666602611541748
Epoch: 35, Steps: 3 | Train Loss: 0.086 Vali Loss: 0.196 Vali Acc: 0.975 Test Loss: 0.196 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.3902878761291504
Epoch: 36, Steps: 3 | Train Loss: 0.085 Vali Loss: 0.189 Vali Acc: 0.975 Test Loss: 0.189 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 37 cost time: 0.5099465847015381
Epoch: 37, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.180 Vali Acc: 0.975 Test Loss: 0.180 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 38 cost time: 0.4210960865020752
Epoch: 38, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.174 Vali Acc: 0.975 Test Loss: 0.174 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 39 cost time: 0.4742097854614258
Epoch: 39, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.173 Vali Acc: 0.950 Test Loss: 0.173 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.427234411239624
Epoch: 40, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.174 Vali Acc: 0.950 Test Loss: 0.174 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.4359574317932129
Epoch: 41, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.170 Vali Acc: 0.950 Test Loss: 0.170 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.41275882720947266
Epoch: 42, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.166 Vali Acc: 0.950 Test Loss: 0.166 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.4700024127960205
Epoch: 43, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.165 Vali Acc: 0.950 Test Loss: 0.165 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.4840281009674072
Epoch: 44, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.167 Vali Acc: 0.950 Test Loss: 0.167 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.45633459091186523
Epoch: 45, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.168 Vali Acc: 0.950 Test Loss: 0.168 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.5278022289276123
Epoch: 46, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.167 Vali Acc: 0.950 Test Loss: 0.167 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.533966064453125
Epoch: 47, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.163 Vali Acc: 0.950 Test Loss: 0.163 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 0.5038883686065674
Epoch: 48, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.160 Vali Acc: 0.950 Test Loss: 0.160 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 320324
model size : 1.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.7928574085235596
Epoch: 1, Steps: 3 | Train Loss: 1.368 Vali Loss: 1.377 Vali Acc: 0.050 Test Loss: 1.377 Test Acc: 0.050
Validation loss decreased (inf --> -0.049986).  Saving model ...
Epoch: 2 cost time: 0.48474764823913574
Epoch: 2, Steps: 3 | Train Loss: 1.338 Vali Loss: 1.363 Vali Acc: 0.100 Test Loss: 1.363 Test Acc: 0.100
Validation loss decreased (-0.049986 --> -0.099986).  Saving model ...
Epoch: 3 cost time: 0.4695625305175781
Epoch: 3, Steps: 3 | Train Loss: 1.320 Vali Loss: 1.342 Vali Acc: 0.150 Test Loss: 1.342 Test Acc: 0.150
Validation loss decreased (-0.099986 --> -0.149987).  Saving model ...
Epoch: 4 cost time: 0.4486677646636963
Epoch: 4, Steps: 3 | Train Loss: 1.252 Vali Loss: 1.310 Vali Acc: 0.225 Test Loss: 1.310 Test Acc: 0.225
Validation loss decreased (-0.149987 --> -0.224987).  Saving model ...
Epoch: 5 cost time: 0.4083867073059082
Epoch: 5, Steps: 3 | Train Loss: 1.191 Vali Loss: 1.269 Vali Acc: 0.475 Test Loss: 1.269 Test Acc: 0.475
Validation loss decreased (-0.224987 --> -0.474987).  Saving model ...
Epoch: 6 cost time: 0.5042240619659424
Epoch: 6, Steps: 3 | Train Loss: 1.138 Vali Loss: 1.222 Vali Acc: 0.525 Test Loss: 1.222 Test Acc: 0.525
Validation loss decreased (-0.474987 --> -0.524988).  Saving model ...
Epoch: 7 cost time: 0.45254087448120117
Epoch: 7, Steps: 3 | Train Loss: 1.066 Vali Loss: 1.170 Vali Acc: 0.675 Test Loss: 1.170 Test Acc: 0.675
Validation loss decreased (-0.524988 --> -0.674988).  Saving model ...
Epoch: 8 cost time: 0.4932093620300293
Epoch: 8, Steps: 3 | Train Loss: 0.982 Vali Loss: 1.118 Vali Acc: 0.850 Test Loss: 1.118 Test Acc: 0.850
Validation loss decreased (-0.674988 --> -0.849989).  Saving model ...
Epoch: 9 cost time: 0.486675500869751
Epoch: 9, Steps: 3 | Train Loss: 0.942 Vali Loss: 1.056 Vali Acc: 0.850 Test Loss: 1.056 Test Acc: 0.850
Validation loss decreased (-0.849989 --> -0.849989).  Saving model ...
Epoch: 10 cost time: 0.4207193851470947
Epoch: 10, Steps: 3 | Train Loss: 0.855 Vali Loss: 0.995 Vali Acc: 0.875 Test Loss: 0.995 Test Acc: 0.875
Validation loss decreased (-0.849989 --> -0.874990).  Saving model ...
Epoch: 11 cost time: 0.44815969467163086
Epoch: 11, Steps: 3 | Train Loss: 0.807 Vali Loss: 0.937 Vali Acc: 0.900 Test Loss: 0.937 Test Acc: 0.900
Validation loss decreased (-0.874990 --> -0.899991).  Saving model ...
Epoch: 12 cost time: 0.4682035446166992
Epoch: 12, Steps: 3 | Train Loss: 0.741 Vali Loss: 0.877 Vali Acc: 0.900 Test Loss: 0.877 Test Acc: 0.900
Validation loss decreased (-0.899991 --> -0.899991).  Saving model ...
Epoch: 13 cost time: 0.387467622756958
Epoch: 13, Steps: 3 | Train Loss: 0.682 Vali Loss: 0.826 Vali Acc: 0.925 Test Loss: 0.826 Test Acc: 0.925
Validation loss decreased (-0.899991 --> -0.924992).  Saving model ...
Epoch: 14 cost time: 0.4277353286743164
Epoch: 14, Steps: 3 | Train Loss: 0.624 Vali Loss: 0.770 Vali Acc: 0.925 Test Loss: 0.770 Test Acc: 0.925
Validation loss decreased (-0.924992 --> -0.924992).  Saving model ...
Epoch: 15 cost time: 0.4933614730834961
Epoch: 15, Steps: 3 | Train Loss: 0.553 Vali Loss: 0.715 Vali Acc: 0.950 Test Loss: 0.715 Test Acc: 0.950
Validation loss decreased (-0.924992 --> -0.949993).  Saving model ...
Epoch: 16 cost time: 0.4595062732696533
Epoch: 16, Steps: 3 | Train Loss: 0.523 Vali Loss: 0.668 Vali Acc: 0.975 Test Loss: 0.668 Test Acc: 0.975
Validation loss decreased (-0.949993 --> -0.974993).  Saving model ...
Epoch: 17 cost time: 0.45027661323547363
Epoch: 17, Steps: 3 | Train Loss: 0.478 Vali Loss: 0.622 Vali Acc: 0.975 Test Loss: 0.622 Test Acc: 0.975
Validation loss decreased (-0.974993 --> -0.974994).  Saving model ...
Epoch: 18 cost time: 0.5054166316986084
Epoch: 18, Steps: 3 | Train Loss: 0.450 Vali Loss: 0.583 Vali Acc: 0.975 Test Loss: 0.583 Test Acc: 0.975
Validation loss decreased (-0.974994 --> -0.974994).  Saving model ...
Epoch: 19 cost time: 0.46001195907592773
Epoch: 19, Steps: 3 | Train Loss: 0.413 Vali Loss: 0.554 Vali Acc: 0.975 Test Loss: 0.554 Test Acc: 0.975
Validation loss decreased (-0.974994 --> -0.974994).  Saving model ...
Epoch: 20 cost time: 0.42696595191955566
Epoch: 20, Steps: 3 | Train Loss: 0.385 Vali Loss: 0.520 Vali Acc: 0.975 Test Loss: 0.520 Test Acc: 0.975
Validation loss decreased (-0.974994 --> -0.974995).  Saving model ...
Epoch: 21 cost time: 0.4340684413909912
Epoch: 21, Steps: 3 | Train Loss: 0.358 Vali Loss: 0.487 Vali Acc: 0.975 Test Loss: 0.487 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 22 cost time: 0.5096032619476318
Epoch: 22, Steps: 3 | Train Loss: 0.316 Vali Loss: 0.466 Vali Acc: 0.975 Test Loss: 0.466 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 23 cost time: 0.4397895336151123
Epoch: 23, Steps: 3 | Train Loss: 0.304 Vali Loss: 0.437 Vali Acc: 0.975 Test Loss: 0.437 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 24 cost time: 0.46568870544433594
Epoch: 24, Steps: 3 | Train Loss: 0.310 Vali Loss: 0.414 Vali Acc: 0.975 Test Loss: 0.414 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 25 cost time: 0.4273550510406494
Epoch: 25, Steps: 3 | Train Loss: 0.265 Vali Loss: 0.394 Vali Acc: 0.975 Test Loss: 0.394 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 26 cost time: 0.3993551731109619
Epoch: 26, Steps: 3 | Train Loss: 0.247 Vali Loss: 0.372 Vali Acc: 0.975 Test Loss: 0.372 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 27 cost time: 0.5207996368408203
Epoch: 27, Steps: 3 | Train Loss: 0.235 Vali Loss: 0.350 Vali Acc: 0.975 Test Loss: 0.350 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 28 cost time: 0.4088551998138428
Epoch: 28, Steps: 3 | Train Loss: 0.197 Vali Loss: 0.321 Vali Acc: 0.975 Test Loss: 0.321 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 29 cost time: 0.41121864318847656
Epoch: 29, Steps: 3 | Train Loss: 0.224 Vali Loss: 0.303 Vali Acc: 0.975 Test Loss: 0.303 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 30 cost time: 0.45552992820739746
Epoch: 30, Steps: 3 | Train Loss: 0.196 Vali Loss: 0.293 Vali Acc: 0.975 Test Loss: 0.293 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 31 cost time: 0.4509928226470947
Epoch: 31, Steps: 3 | Train Loss: 0.190 Vali Loss: 0.284 Vali Acc: 0.975 Test Loss: 0.284 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 32 cost time: 0.45197367668151855
Epoch: 32, Steps: 3 | Train Loss: 0.172 Vali Loss: 0.277 Vali Acc: 0.975 Test Loss: 0.277 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 33 cost time: 0.3952670097351074
Epoch: 33, Steps: 3 | Train Loss: 0.162 Vali Loss: 0.271 Vali Acc: 0.950 Test Loss: 0.271 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.47431230545043945
Epoch: 34, Steps: 3 | Train Loss: 0.132 Vali Loss: 0.257 Vali Acc: 0.950 Test Loss: 0.257 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.49070310592651367
Epoch: 35, Steps: 3 | Train Loss: 0.126 Vali Loss: 0.249 Vali Acc: 0.950 Test Loss: 0.249 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.429171085357666
Epoch: 36, Steps: 3 | Train Loss: 0.119 Vali Loss: 0.239 Vali Acc: 0.950 Test Loss: 0.239 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.4122457504272461
Epoch: 37, Steps: 3 | Train Loss: 0.116 Vali Loss: 0.235 Vali Acc: 0.950 Test Loss: 0.235 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.43936800956726074
Epoch: 38, Steps: 3 | Train Loss: 0.112 Vali Loss: 0.231 Vali Acc: 0.950 Test Loss: 0.231 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.4511868953704834
Epoch: 39, Steps: 3 | Train Loss: 0.090 Vali Loss: 0.230 Vali Acc: 0.950 Test Loss: 0.230 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.42654895782470703
Epoch: 40, Steps: 3 | Train Loss: 0.089 Vali Loss: 0.222 Vali Acc: 0.950 Test Loss: 0.222 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.47835779190063477
Epoch: 41, Steps: 3 | Train Loss: 0.090 Vali Loss: 0.220 Vali Acc: 0.950 Test Loss: 0.220 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.39557957649230957
Epoch: 42, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.224 Vali Acc: 0.950 Test Loss: 0.224 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 314276
model size : 1.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.9190421104431152
Epoch: 1, Steps: 3 | Train Loss: 1.383 Vali Loss: 1.393 Vali Acc: 0.450 Test Loss: 1.393 Test Acc: 0.450
Validation loss decreased (inf --> -0.449986).  Saving model ...
Epoch: 2 cost time: 0.4698643684387207
Epoch: 2, Steps: 3 | Train Loss: 1.321 Vali Loss: 1.377 Vali Acc: 0.500 Test Loss: 1.377 Test Acc: 0.500
Validation loss decreased (-0.449986 --> -0.499986).  Saving model ...
Epoch: 3 cost time: 0.4482309818267822
Epoch: 3, Steps: 3 | Train Loss: 1.300 Vali Loss: 1.359 Vali Acc: 0.525 Test Loss: 1.359 Test Acc: 0.525
Validation loss decreased (-0.499986 --> -0.524986).  Saving model ...
Epoch: 4 cost time: 0.4379913806915283
Epoch: 4, Steps: 3 | Train Loss: 1.262 Vali Loss: 1.332 Vali Acc: 0.550 Test Loss: 1.332 Test Acc: 0.550
Validation loss decreased (-0.524986 --> -0.549987).  Saving model ...
Epoch: 5 cost time: 0.49367189407348633
Epoch: 5, Steps: 3 | Train Loss: 1.221 Vali Loss: 1.299 Vali Acc: 0.575 Test Loss: 1.299 Test Acc: 0.575
Validation loss decreased (-0.549987 --> -0.574987).  Saving model ...
Epoch: 6 cost time: 0.5166962146759033
Epoch: 6, Steps: 3 | Train Loss: 1.185 Vali Loss: 1.264 Vali Acc: 0.575 Test Loss: 1.264 Test Acc: 0.575
Validation loss decreased (-0.574987 --> -0.574987).  Saving model ...
Epoch: 7 cost time: 0.42022228240966797
Epoch: 7, Steps: 3 | Train Loss: 1.116 Vali Loss: 1.221 Vali Acc: 0.650 Test Loss: 1.221 Test Acc: 0.650
Validation loss decreased (-0.574987 --> -0.649988).  Saving model ...
Epoch: 8 cost time: 0.4553077220916748
Epoch: 8, Steps: 3 | Train Loss: 1.056 Vali Loss: 1.177 Vali Acc: 0.675 Test Loss: 1.177 Test Acc: 0.675
Validation loss decreased (-0.649988 --> -0.674988).  Saving model ...
Epoch: 9 cost time: 0.4470546245574951
Epoch: 9, Steps: 3 | Train Loss: 1.028 Vali Loss: 1.134 Vali Acc: 0.725 Test Loss: 1.134 Test Acc: 0.725
Validation loss decreased (-0.674988 --> -0.724989).  Saving model ...
Epoch: 10 cost time: 0.44452428817749023
Epoch: 10, Steps: 3 | Train Loss: 0.967 Vali Loss: 1.083 Vali Acc: 0.725 Test Loss: 1.083 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724989).  Saving model ...
Epoch: 11 cost time: 0.4184417724609375
Epoch: 11, Steps: 3 | Train Loss: 0.944 Vali Loss: 1.033 Vali Acc: 0.750 Test Loss: 1.033 Test Acc: 0.750
Validation loss decreased (-0.724989 --> -0.749990).  Saving model ...
Epoch: 12 cost time: 0.413252592086792
Epoch: 12, Steps: 3 | Train Loss: 0.862 Vali Loss: 0.995 Vali Acc: 0.750 Test Loss: 0.995 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749990).  Saving model ...
Epoch: 13 cost time: 0.43286919593811035
Epoch: 13, Steps: 3 | Train Loss: 0.793 Vali Loss: 0.956 Vali Acc: 0.750 Test Loss: 0.956 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749990).  Saving model ...
Epoch: 14 cost time: 0.4040377140045166
Epoch: 14, Steps: 3 | Train Loss: 0.772 Vali Loss: 0.910 Vali Acc: 0.825 Test Loss: 0.910 Test Acc: 0.825
Validation loss decreased (-0.749990 --> -0.824991).  Saving model ...
Epoch: 15 cost time: 0.47089266777038574
Epoch: 15, Steps: 3 | Train Loss: 0.705 Vali Loss: 0.865 Vali Acc: 0.850 Test Loss: 0.865 Test Acc: 0.850
Validation loss decreased (-0.824991 --> -0.849991).  Saving model ...
Epoch: 16 cost time: 0.41008567810058594
Epoch: 16, Steps: 3 | Train Loss: 0.674 Vali Loss: 0.822 Vali Acc: 0.900 Test Loss: 0.822 Test Acc: 0.900
Validation loss decreased (-0.849991 --> -0.899992).  Saving model ...
Epoch: 17 cost time: 0.4807150363922119
Epoch: 17, Steps: 3 | Train Loss: 0.597 Vali Loss: 0.788 Vali Acc: 0.900 Test Loss: 0.788 Test Acc: 0.900
Validation loss decreased (-0.899992 --> -0.899992).  Saving model ...
Epoch: 18 cost time: 0.5102717876434326
Epoch: 18, Steps: 3 | Train Loss: 0.568 Vali Loss: 0.753 Vali Acc: 0.900 Test Loss: 0.753 Test Acc: 0.900
Validation loss decreased (-0.899992 --> -0.899992).  Saving model ...
Epoch: 19 cost time: 0.46558046340942383
Epoch: 19, Steps: 3 | Train Loss: 0.544 Vali Loss: 0.717 Vali Acc: 0.900 Test Loss: 0.717 Test Acc: 0.900
Validation loss decreased (-0.899992 --> -0.899993).  Saving model ...
Epoch: 20 cost time: 0.5202584266662598
Epoch: 20, Steps: 3 | Train Loss: 0.492 Vali Loss: 0.687 Vali Acc: 0.900 Test Loss: 0.687 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 21 cost time: 0.47981739044189453
Epoch: 21, Steps: 3 | Train Loss: 0.472 Vali Loss: 0.658 Vali Acc: 0.900 Test Loss: 0.658 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 22 cost time: 0.48290252685546875
Epoch: 22, Steps: 3 | Train Loss: 0.448 Vali Loss: 0.627 Vali Acc: 0.925 Test Loss: 0.627 Test Acc: 0.925
Validation loss decreased (-0.899993 --> -0.924994).  Saving model ...
Epoch: 23 cost time: 0.5272054672241211
Epoch: 23, Steps: 3 | Train Loss: 0.386 Vali Loss: 0.581 Vali Acc: 0.925 Test Loss: 0.581 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 24 cost time: 0.49745631217956543
Epoch: 24, Steps: 3 | Train Loss: 0.385 Vali Loss: 0.557 Vali Acc: 0.925 Test Loss: 0.557 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 25 cost time: 0.40273094177246094
Epoch: 25, Steps: 3 | Train Loss: 0.370 Vali Loss: 0.536 Vali Acc: 0.950 Test Loss: 0.536 Test Acc: 0.950
Validation loss decreased (-0.924994 --> -0.949995).  Saving model ...
Epoch: 26 cost time: 0.4974832534790039
Epoch: 26, Steps: 3 | Train Loss: 0.346 Vali Loss: 0.518 Vali Acc: 0.950 Test Loss: 0.518 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 27 cost time: 0.4346902370452881
Epoch: 27, Steps: 3 | Train Loss: 0.330 Vali Loss: 0.494 Vali Acc: 0.950 Test Loss: 0.494 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 28 cost time: 0.4530754089355469
Epoch: 28, Steps: 3 | Train Loss: 0.314 Vali Loss: 0.468 Vali Acc: 0.975 Test Loss: 0.468 Test Acc: 0.975
Validation loss decreased (-0.949995 --> -0.974995).  Saving model ...
Epoch: 29 cost time: 0.49124813079833984
Epoch: 29, Steps: 3 | Train Loss: 0.294 Vali Loss: 0.459 Vali Acc: 0.950 Test Loss: 0.459 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.45397162437438965
Epoch: 30, Steps: 3 | Train Loss: 0.318 Vali Loss: 0.443 Vali Acc: 0.950 Test Loss: 0.443 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.4064197540283203
Epoch: 31, Steps: 3 | Train Loss: 0.265 Vali Loss: 0.433 Vali Acc: 0.925 Test Loss: 0.433 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.434917688369751
Epoch: 32, Steps: 3 | Train Loss: 0.279 Vali Loss: 0.413 Vali Acc: 0.950 Test Loss: 0.413 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.4583272933959961
Epoch: 33, Steps: 3 | Train Loss: 0.236 Vali Loss: 0.400 Vali Acc: 0.950 Test Loss: 0.400 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.4401431083679199
Epoch: 34, Steps: 3 | Train Loss: 0.209 Vali Loss: 0.391 Vali Acc: 0.950 Test Loss: 0.391 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.5501680374145508
Epoch: 35, Steps: 3 | Train Loss: 0.214 Vali Loss: 0.379 Vali Acc: 0.950 Test Loss: 0.379 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.502539873123169
Epoch: 36, Steps: 3 | Train Loss: 0.197 Vali Loss: 0.360 Vali Acc: 0.950 Test Loss: 0.360 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.4521772861480713
Epoch: 37, Steps: 3 | Train Loss: 0.190 Vali Loss: 0.348 Vali Acc: 0.950 Test Loss: 0.348 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.4824247360229492
Epoch: 38, Steps: 3 | Train Loss: 0.190 Vali Loss: 0.336 Vali Acc: 0.950 Test Loss: 0.336 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 309732
model size : 1.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.7085120677947998
Epoch: 1, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.374 Vali Acc: 0.375 Test Loss: 1.374 Test Acc: 0.375
Validation loss decreased (inf --> -0.374986).  Saving model ...
Epoch: 2 cost time: 0.41126585006713867
Epoch: 2, Steps: 3 | Train Loss: 1.382 Vali Loss: 1.359 Vali Acc: 0.375 Test Loss: 1.359 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374986).  Saving model ...
Epoch: 3 cost time: 0.5001344680786133
Epoch: 3, Steps: 3 | Train Loss: 1.359 Vali Loss: 1.342 Vali Acc: 0.425 Test Loss: 1.342 Test Acc: 0.425
Validation loss decreased (-0.374986 --> -0.424987).  Saving model ...
Epoch: 4 cost time: 0.426008939743042
Epoch: 4, Steps: 3 | Train Loss: 1.325 Vali Loss: 1.320 Vali Acc: 0.475 Test Loss: 1.320 Test Acc: 0.475
Validation loss decreased (-0.424987 --> -0.474987).  Saving model ...
Epoch: 5 cost time: 0.4812135696411133
Epoch: 5, Steps: 3 | Train Loss: 1.269 Vali Loss: 1.294 Vali Acc: 0.525 Test Loss: 1.294 Test Acc: 0.525
Validation loss decreased (-0.474987 --> -0.524987).  Saving model ...
Epoch: 6 cost time: 0.4374887943267822
Epoch: 6, Steps: 3 | Train Loss: 1.274 Vali Loss: 1.260 Vali Acc: 0.575 Test Loss: 1.260 Test Acc: 0.575
Validation loss decreased (-0.524987 --> -0.574987).  Saving model ...
Epoch: 7 cost time: 0.4512827396392822
Epoch: 7, Steps: 3 | Train Loss: 1.216 Vali Loss: 1.224 Vali Acc: 0.650 Test Loss: 1.224 Test Acc: 0.650
Validation loss decreased (-0.574987 --> -0.649988).  Saving model ...
Epoch: 8 cost time: 0.5050079822540283
Epoch: 8, Steps: 3 | Train Loss: 1.170 Vali Loss: 1.186 Vali Acc: 0.650 Test Loss: 1.186 Test Acc: 0.650
Validation loss decreased (-0.649988 --> -0.649988).  Saving model ...
Epoch: 9 cost time: 0.4813079833984375
Epoch: 9, Steps: 3 | Train Loss: 1.121 Vali Loss: 1.147 Vali Acc: 0.725 Test Loss: 1.147 Test Acc: 0.725
Validation loss decreased (-0.649988 --> -0.724989).  Saving model ...
Epoch: 10 cost time: 0.4528920650482178
Epoch: 10, Steps: 3 | Train Loss: 1.100 Vali Loss: 1.104 Vali Acc: 0.750 Test Loss: 1.104 Test Acc: 0.750
Validation loss decreased (-0.724989 --> -0.749989).  Saving model ...
Epoch: 11 cost time: 0.4690108299255371
Epoch: 11, Steps: 3 | Train Loss: 1.028 Vali Loss: 1.067 Vali Acc: 0.750 Test Loss: 1.067 Test Acc: 0.750
Validation loss decreased (-0.749989 --> -0.749989).  Saving model ...
Epoch: 12 cost time: 0.4683830738067627
Epoch: 12, Steps: 3 | Train Loss: 0.988 Vali Loss: 1.028 Vali Acc: 0.775 Test Loss: 1.028 Test Acc: 0.775
Validation loss decreased (-0.749989 --> -0.774990).  Saving model ...
Epoch: 13 cost time: 0.42151904106140137
Epoch: 13, Steps: 3 | Train Loss: 0.959 Vali Loss: 0.988 Vali Acc: 0.825 Test Loss: 0.988 Test Acc: 0.825
Validation loss decreased (-0.774990 --> -0.824990).  Saving model ...
Epoch: 14 cost time: 0.40549302101135254
Epoch: 14, Steps: 3 | Train Loss: 0.918 Vali Loss: 0.955 Vali Acc: 0.850 Test Loss: 0.955 Test Acc: 0.850
Validation loss decreased (-0.824990 --> -0.849990).  Saving model ...
Epoch: 15 cost time: 0.4463465213775635
Epoch: 15, Steps: 3 | Train Loss: 0.845 Vali Loss: 0.923 Vali Acc: 0.850 Test Loss: 0.923 Test Acc: 0.850
Validation loss decreased (-0.849990 --> -0.849991).  Saving model ...
Epoch: 16 cost time: 0.44205760955810547
Epoch: 16, Steps: 3 | Train Loss: 0.834 Vali Loss: 0.882 Vali Acc: 0.850 Test Loss: 0.882 Test Acc: 0.850
Validation loss decreased (-0.849991 --> -0.849991).  Saving model ...
Epoch: 17 cost time: 0.37737393379211426
Epoch: 17, Steps: 3 | Train Loss: 0.785 Vali Loss: 0.853 Vali Acc: 0.850 Test Loss: 0.853 Test Acc: 0.850
Validation loss decreased (-0.849991 --> -0.849991).  Saving model ...
Epoch: 18 cost time: 0.4441053867340088
Epoch: 18, Steps: 3 | Train Loss: 0.764 Vali Loss: 0.822 Vali Acc: 0.850 Test Loss: 0.822 Test Acc: 0.850
Validation loss decreased (-0.849991 --> -0.849992).  Saving model ...
Epoch: 19 cost time: 0.38080406188964844
Epoch: 19, Steps: 3 | Train Loss: 0.709 Vali Loss: 0.792 Vali Acc: 0.850 Test Loss: 0.792 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 20 cost time: 0.4241676330566406
Epoch: 20, Steps: 3 | Train Loss: 0.692 Vali Loss: 0.755 Vali Acc: 0.850 Test Loss: 0.755 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 21 cost time: 0.4265573024749756
Epoch: 21, Steps: 3 | Train Loss: 0.664 Vali Loss: 0.725 Vali Acc: 0.850 Test Loss: 0.725 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849993).  Saving model ...
Epoch: 22 cost time: 0.4089634418487549
Epoch: 22, Steps: 3 | Train Loss: 0.626 Vali Loss: 0.704 Vali Acc: 0.875 Test Loss: 0.704 Test Acc: 0.875
Validation loss decreased (-0.849993 --> -0.874993).  Saving model ...
Epoch: 23 cost time: 0.42456483840942383
Epoch: 23, Steps: 3 | Train Loss: 0.596 Vali Loss: 0.669 Vali Acc: 0.875 Test Loss: 0.669 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 24 cost time: 0.4362187385559082
Epoch: 24, Steps: 3 | Train Loss: 0.567 Vali Loss: 0.646 Vali Acc: 0.900 Test Loss: 0.646 Test Acc: 0.900
Validation loss decreased (-0.874993 --> -0.899994).  Saving model ...
Epoch: 25 cost time: 0.4370567798614502
Epoch: 25, Steps: 3 | Train Loss: 0.526 Vali Loss: 0.637 Vali Acc: 0.900 Test Loss: 0.637 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 26 cost time: 0.4779326915740967
Epoch: 26, Steps: 3 | Train Loss: 0.493 Vali Loss: 0.614 Vali Acc: 0.900 Test Loss: 0.614 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 27 cost time: 0.41165661811828613
Epoch: 27, Steps: 3 | Train Loss: 0.480 Vali Loss: 0.588 Vali Acc: 0.900 Test Loss: 0.588 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 28 cost time: 0.42465996742248535
Epoch: 28, Steps: 3 | Train Loss: 0.443 Vali Loss: 0.562 Vali Acc: 0.900 Test Loss: 0.562 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 29 cost time: 0.4140360355377197
Epoch: 29, Steps: 3 | Train Loss: 0.445 Vali Loss: 0.541 Vali Acc: 0.900 Test Loss: 0.541 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 30 cost time: 0.5157761573791504
Epoch: 30, Steps: 3 | Train Loss: 0.394 Vali Loss: 0.516 Vali Acc: 0.950 Test Loss: 0.516 Test Acc: 0.950
Validation loss decreased (-0.899995 --> -0.949995).  Saving model ...
Epoch: 31 cost time: 0.475999116897583
Epoch: 31, Steps: 3 | Train Loss: 0.375 Vali Loss: 0.486 Vali Acc: 0.950 Test Loss: 0.486 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 32 cost time: 0.42535924911499023
Epoch: 32, Steps: 3 | Train Loss: 0.361 Vali Loss: 0.469 Vali Acc: 0.950 Test Loss: 0.469 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 33 cost time: 0.40616416931152344
Epoch: 33, Steps: 3 | Train Loss: 0.356 Vali Loss: 0.450 Vali Acc: 0.950 Test Loss: 0.450 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 34 cost time: 0.4080967903137207
Epoch: 34, Steps: 3 | Train Loss: 0.320 Vali Loss: 0.433 Vali Acc: 0.950 Test Loss: 0.433 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 35 cost time: 0.4381678104400635
Epoch: 35, Steps: 3 | Train Loss: 0.318 Vali Loss: 0.421 Vali Acc: 0.950 Test Loss: 0.421 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 36 cost time: 0.48807644844055176
Epoch: 36, Steps: 3 | Train Loss: 0.299 Vali Loss: 0.405 Vali Acc: 0.950 Test Loss: 0.405 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 37 cost time: 0.445662260055542
Epoch: 37, Steps: 3 | Train Loss: 0.273 Vali Loss: 0.385 Vali Acc: 0.950 Test Loss: 0.385 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 38 cost time: 0.4664485454559326
Epoch: 38, Steps: 3 | Train Loss: 0.264 Vali Loss: 0.370 Vali Acc: 0.950 Test Loss: 0.370 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 39 cost time: 0.42933011054992676
Epoch: 39, Steps: 3 | Train Loss: 0.239 Vali Loss: 0.359 Vali Acc: 0.950 Test Loss: 0.359 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 40 cost time: 0.4286012649536133
Epoch: 40, Steps: 3 | Train Loss: 0.241 Vali Loss: 0.354 Vali Acc: 0.950 Test Loss: 0.354 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 41 cost time: 0.5589523315429688
Epoch: 41, Steps: 3 | Train Loss: 0.228 Vali Loss: 0.340 Vali Acc: 0.950 Test Loss: 0.340 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 42 cost time: 0.45380210876464844
Epoch: 42, Steps: 3 | Train Loss: 0.235 Vali Loss: 0.337 Vali Acc: 0.950 Test Loss: 0.337 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 43 cost time: 0.4048886299133301
Epoch: 43, Steps: 3 | Train Loss: 0.204 Vali Loss: 0.320 Vali Acc: 0.950 Test Loss: 0.320 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 44 cost time: 0.43233466148376465
Epoch: 44, Steps: 3 | Train Loss: 0.203 Vali Loss: 0.306 Vali Acc: 0.950 Test Loss: 0.306 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 45 cost time: 0.4321267604827881
Epoch: 45, Steps: 3 | Train Loss: 0.194 Vali Loss: 0.299 Vali Acc: 0.950 Test Loss: 0.299 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 46 cost time: 0.4556889533996582
Epoch: 46, Steps: 3 | Train Loss: 0.165 Vali Loss: 0.290 Vali Acc: 0.950 Test Loss: 0.290 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 47 cost time: 0.4074289798736572
Epoch: 47, Steps: 3 | Train Loss: 0.168 Vali Loss: 0.280 Vali Acc: 0.975 Test Loss: 0.280 Test Acc: 0.975
Validation loss decreased (-0.949997 --> -0.974997).  Saving model ...
Epoch: 48 cost time: 0.43720245361328125
Epoch: 48, Steps: 3 | Train Loss: 0.170 Vali Loss: 0.281 Vali Acc: 0.975 Test Loss: 0.281 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.4947800636291504
Epoch: 49, Steps: 3 | Train Loss: 0.155 Vali Loss: 0.271 Vali Acc: 0.975 Test Loss: 0.271 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 50 cost time: 0.4718458652496338
Epoch: 50, Steps: 3 | Train Loss: 0.137 Vali Loss: 0.259 Vali Acc: 0.975 Test Loss: 0.259 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 303748
model size : 1.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps20_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.7254576683044434
Epoch: 1, Steps: 3 | Train Loss: 1.317 Vali Loss: 1.353 Vali Acc: 0.450 Test Loss: 1.353 Test Acc: 0.450
Validation loss decreased (inf --> -0.449986).  Saving model ...
Epoch: 2 cost time: 0.4650230407714844
Epoch: 2, Steps: 3 | Train Loss: 1.318 Vali Loss: 1.339 Vali Acc: 0.450 Test Loss: 1.339 Test Acc: 0.450
Validation loss decreased (-0.449986 --> -0.449987).  Saving model ...
Epoch: 3 cost time: 0.5268189907073975
Epoch: 3, Steps: 3 | Train Loss: 1.303 Vali Loss: 1.325 Vali Acc: 0.450 Test Loss: 1.325 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449987).  Saving model ...
Epoch: 4 cost time: 0.5135486125946045
Epoch: 4, Steps: 3 | Train Loss: 1.266 Vali Loss: 1.306 Vali Acc: 0.450 Test Loss: 1.306 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449987).  Saving model ...
Epoch: 5 cost time: 0.5043289661407471
Epoch: 5, Steps: 3 | Train Loss: 1.230 Vali Loss: 1.281 Vali Acc: 0.500 Test Loss: 1.281 Test Acc: 0.500
Validation loss decreased (-0.449987 --> -0.499987).  Saving model ...
Epoch: 6 cost time: 0.49277758598327637
Epoch: 6, Steps: 3 | Train Loss: 1.199 Vali Loss: 1.255 Vali Acc: 0.550 Test Loss: 1.255 Test Acc: 0.550
Validation loss decreased (-0.499987 --> -0.549987).  Saving model ...
Epoch: 7 cost time: 0.4746108055114746
Epoch: 7, Steps: 3 | Train Loss: 1.156 Vali Loss: 1.226 Vali Acc: 0.575 Test Loss: 1.226 Test Acc: 0.575
Validation loss decreased (-0.549987 --> -0.574988).  Saving model ...
Epoch: 8 cost time: 0.46283411979675293
Epoch: 8, Steps: 3 | Train Loss: 1.132 Vali Loss: 1.192 Vali Acc: 0.675 Test Loss: 1.192 Test Acc: 0.675
Validation loss decreased (-0.574988 --> -0.674988).  Saving model ...
Epoch: 9 cost time: 0.4366269111633301
Epoch: 9, Steps: 3 | Train Loss: 1.087 Vali Loss: 1.160 Vali Acc: 0.700 Test Loss: 1.160 Test Acc: 0.700
Validation loss decreased (-0.674988 --> -0.699988).  Saving model ...
Epoch: 10 cost time: 0.4117569923400879
Epoch: 10, Steps: 3 | Train Loss: 1.045 Vali Loss: 1.126 Vali Acc: 0.725 Test Loss: 1.126 Test Acc: 0.725
Validation loss decreased (-0.699988 --> -0.724989).  Saving model ...
Epoch: 11 cost time: 0.41425275802612305
Epoch: 11, Steps: 3 | Train Loss: 1.018 Vali Loss: 1.087 Vali Acc: 0.725 Test Loss: 1.087 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724989).  Saving model ...
Epoch: 12 cost time: 0.4022331237792969
Epoch: 12, Steps: 3 | Train Loss: 0.949 Vali Loss: 1.058 Vali Acc: 0.750 Test Loss: 1.058 Test Acc: 0.750
Validation loss decreased (-0.724989 --> -0.749989).  Saving model ...
Epoch: 13 cost time: 0.49756550788879395
Epoch: 13, Steps: 3 | Train Loss: 0.936 Vali Loss: 1.021 Vali Acc: 0.775 Test Loss: 1.021 Test Acc: 0.775
Validation loss decreased (-0.749989 --> -0.774990).  Saving model ...
Epoch: 14 cost time: 0.49201107025146484
Epoch: 14, Steps: 3 | Train Loss: 0.859 Vali Loss: 0.989 Vali Acc: 0.775 Test Loss: 0.989 Test Acc: 0.775
Validation loss decreased (-0.774990 --> -0.774990).  Saving model ...
Epoch: 15 cost time: 0.4491705894470215
Epoch: 15, Steps: 3 | Train Loss: 0.853 Vali Loss: 0.957 Vali Acc: 0.800 Test Loss: 0.957 Test Acc: 0.800
Validation loss decreased (-0.774990 --> -0.799990).  Saving model ...
Epoch: 16 cost time: 0.43572187423706055
Epoch: 16, Steps: 3 | Train Loss: 0.834 Vali Loss: 0.927 Vali Acc: 0.800 Test Loss: 0.927 Test Acc: 0.800
Validation loss decreased (-0.799990 --> -0.799991).  Saving model ...
Epoch: 17 cost time: 0.46694087982177734
Epoch: 17, Steps: 3 | Train Loss: 0.797 Vali Loss: 0.897 Vali Acc: 0.800 Test Loss: 0.897 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799991).  Saving model ...
Epoch: 18 cost time: 0.4463460445404053
Epoch: 18, Steps: 3 | Train Loss: 0.735 Vali Loss: 0.872 Vali Acc: 0.800 Test Loss: 0.872 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799991).  Saving model ...
Epoch: 19 cost time: 0.42465686798095703
Epoch: 19, Steps: 3 | Train Loss: 0.722 Vali Loss: 0.852 Vali Acc: 0.800 Test Loss: 0.852 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799991).  Saving model ...
Epoch: 20 cost time: 0.47562694549560547
Epoch: 20, Steps: 3 | Train Loss: 0.697 Vali Loss: 0.823 Vali Acc: 0.800 Test Loss: 0.823 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799992).  Saving model ...
Epoch: 21 cost time: 0.42476916313171387
Epoch: 21, Steps: 3 | Train Loss: 0.665 Vali Loss: 0.795 Vali Acc: 0.800 Test Loss: 0.795 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 22 cost time: 0.4307222366333008
Epoch: 22, Steps: 3 | Train Loss: 0.635 Vali Loss: 0.765 Vali Acc: 0.825 Test Loss: 0.765 Test Acc: 0.825
Validation loss decreased (-0.799992 --> -0.824992).  Saving model ...
Epoch: 23 cost time: 0.5076301097869873
Epoch: 23, Steps: 3 | Train Loss: 0.594 Vali Loss: 0.738 Vali Acc: 0.825 Test Loss: 0.738 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824993).  Saving model ...
Epoch: 24 cost time: 0.49163031578063965
Epoch: 24, Steps: 3 | Train Loss: 0.577 Vali Loss: 0.710 Vali Acc: 0.850 Test Loss: 0.710 Test Acc: 0.850
Validation loss decreased (-0.824993 --> -0.849993).  Saving model ...
Epoch: 25 cost time: 0.4423089027404785
Epoch: 25, Steps: 3 | Train Loss: 0.561 Vali Loss: 0.681 Vali Acc: 0.850 Test Loss: 0.681 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 26 cost time: 0.4102904796600342
Epoch: 26, Steps: 3 | Train Loss: 0.525 Vali Loss: 0.663 Vali Acc: 0.900 Test Loss: 0.663 Test Acc: 0.900
Validation loss decreased (-0.849993 --> -0.899993).  Saving model ...
Epoch: 27 cost time: 0.45664501190185547
Epoch: 27, Steps: 3 | Train Loss: 0.484 Vali Loss: 0.646 Vali Acc: 0.900 Test Loss: 0.646 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899994).  Saving model ...
Epoch: 28 cost time: 0.4592742919921875
Epoch: 28, Steps: 3 | Train Loss: 0.480 Vali Loss: 0.629 Vali Acc: 0.900 Test Loss: 0.629 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 29 cost time: 0.4462916851043701
Epoch: 29, Steps: 3 | Train Loss: 0.488 Vali Loss: 0.602 Vali Acc: 0.900 Test Loss: 0.602 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 30 cost time: 0.43460917472839355
Epoch: 30, Steps: 3 | Train Loss: 0.439 Vali Loss: 0.587 Vali Acc: 0.925 Test Loss: 0.587 Test Acc: 0.925
Validation loss decreased (-0.899994 --> -0.924994).  Saving model ...
Epoch: 31 cost time: 0.4873504638671875
Epoch: 31, Steps: 3 | Train Loss: 0.432 Vali Loss: 0.575 Vali Acc: 0.900 Test Loss: 0.575 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.44123077392578125
Epoch: 32, Steps: 3 | Train Loss: 0.406 Vali Loss: 0.551 Vali Acc: 0.925 Test Loss: 0.551 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 33 cost time: 0.5020360946655273
Epoch: 33, Steps: 3 | Train Loss: 0.408 Vali Loss: 0.533 Vali Acc: 0.925 Test Loss: 0.533 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 34 cost time: 0.4511547088623047
Epoch: 34, Steps: 3 | Train Loss: 0.382 Vali Loss: 0.513 Vali Acc: 0.925 Test Loss: 0.513 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 35 cost time: 0.5161395072937012
Epoch: 35, Steps: 3 | Train Loss: 0.373 Vali Loss: 0.497 Vali Acc: 0.925 Test Loss: 0.497 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 36 cost time: 0.4395890235900879
Epoch: 36, Steps: 3 | Train Loss: 0.338 Vali Loss: 0.485 Vali Acc: 0.925 Test Loss: 0.485 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 37 cost time: 0.4587242603302002
Epoch: 37, Steps: 3 | Train Loss: 0.343 Vali Loss: 0.476 Vali Acc: 0.900 Test Loss: 0.476 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.4400904178619385
Epoch: 38, Steps: 3 | Train Loss: 0.316 Vali Loss: 0.467 Vali Acc: 0.900 Test Loss: 0.467 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.47260022163391113
Epoch: 39, Steps: 3 | Train Loss: 0.329 Vali Loss: 0.449 Vali Acc: 0.925 Test Loss: 0.449 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 40 cost time: 0.5690634250640869
Epoch: 40, Steps: 3 | Train Loss: 0.291 Vali Loss: 0.447 Vali Acc: 0.925 Test Loss: 0.447 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 41 cost time: 0.4424738883972168
Epoch: 41, Steps: 3 | Train Loss: 0.290 Vali Loss: 0.433 Vali Acc: 0.925 Test Loss: 0.433 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 42 cost time: 0.40551042556762695
Epoch: 42, Steps: 3 | Train Loss: 0.280 Vali Loss: 0.418 Vali Acc: 0.925 Test Loss: 0.418 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 43 cost time: 0.39524340629577637
Epoch: 43, Steps: 3 | Train Loss: 0.259 Vali Loss: 0.406 Vali Acc: 0.925 Test Loss: 0.406 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 44 cost time: 0.5296008586883545
Epoch: 44, Steps: 3 | Train Loss: 0.251 Vali Loss: 0.391 Vali Acc: 0.925 Test Loss: 0.391 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 45 cost time: 0.4055955410003662
Epoch: 45, Steps: 3 | Train Loss: 0.236 Vali Loss: 0.378 Vali Acc: 0.925 Test Loss: 0.378 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 46 cost time: 0.5239167213439941
Epoch: 46, Steps: 3 | Train Loss: 0.230 Vali Loss: 0.365 Vali Acc: 0.925 Test Loss: 0.365 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 47 cost time: 0.3933405876159668
Epoch: 47, Steps: 3 | Train Loss: 0.225 Vali Loss: 0.356 Vali Acc: 0.950 Test Loss: 0.356 Test Acc: 0.950
Validation loss decreased (-0.924996 --> -0.949996).  Saving model ...
Epoch: 48 cost time: 0.38558053970336914
Epoch: 48, Steps: 3 | Train Loss: 0.215 Vali Loss: 0.348 Vali Acc: 0.950 Test Loss: 0.348 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 49 cost time: 0.5399026870727539
Epoch: 49, Steps: 3 | Train Loss: 0.204 Vali Loss: 0.331 Vali Acc: 0.950 Test Loss: 0.331 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 50 cost time: 0.4690401554107666
Epoch: 50, Steps: 3 | Train Loss: 0.200 Vali Loss: 0.324 Vali Acc: 0.950 Test Loss: 0.324 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps20_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 302372
model size : 1.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps25_str13_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.6356010437011719
Epoch: 1, Steps: 3 | Train Loss: 1.374 Vali Loss: 1.408 Vali Acc: 0.200 Test Loss: 1.408 Test Acc: 0.200
Validation loss decreased (inf --> -0.199986).  Saving model ...
Epoch: 2 cost time: 0.49762821197509766
Epoch: 2, Steps: 3 | Train Loss: 1.345 Vali Loss: 1.402 Vali Acc: 0.175 Test Loss: 1.402 Test Acc: 0.175
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4894895553588867
Epoch: 3, Steps: 3 | Train Loss: 1.311 Vali Loss: 1.395 Vali Acc: 0.275 Test Loss: 1.395 Test Acc: 0.275
Validation loss decreased (-0.199986 --> -0.274986).  Saving model ...
Epoch: 4 cost time: 0.41857218742370605
Epoch: 4, Steps: 3 | Train Loss: 1.312 Vali Loss: 1.384 Vali Acc: 0.375 Test Loss: 1.384 Test Acc: 0.375
Validation loss decreased (-0.274986 --> -0.374986).  Saving model ...
Epoch: 5 cost time: 0.4646587371826172
Epoch: 5, Steps: 3 | Train Loss: 1.310 Vali Loss: 1.367 Vali Acc: 0.425 Test Loss: 1.367 Test Acc: 0.425
Validation loss decreased (-0.374986 --> -0.424986).  Saving model ...
Epoch: 6 cost time: 0.4949209690093994
Epoch: 6, Steps: 3 | Train Loss: 1.278 Vali Loss: 1.346 Vali Acc: 0.475 Test Loss: 1.346 Test Acc: 0.475
Validation loss decreased (-0.424986 --> -0.474987).  Saving model ...
Epoch: 7 cost time: 0.3875741958618164
Epoch: 7, Steps: 3 | Train Loss: 1.242 Vali Loss: 1.321 Vali Acc: 0.475 Test Loss: 1.321 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474987).  Saving model ...
Epoch: 8 cost time: 0.38487982749938965
Epoch: 8, Steps: 3 | Train Loss: 1.198 Vali Loss: 1.293 Vali Acc: 0.500 Test Loss: 1.293 Test Acc: 0.500
Validation loss decreased (-0.474987 --> -0.499987).  Saving model ...
Epoch: 9 cost time: 0.4233229160308838
Epoch: 9, Steps: 3 | Train Loss: 1.160 Vali Loss: 1.264 Vali Acc: 0.500 Test Loss: 1.264 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499987).  Saving model ...
Epoch: 10 cost time: 0.42440295219421387
Epoch: 10, Steps: 3 | Train Loss: 1.129 Vali Loss: 1.238 Vali Acc: 0.600 Test Loss: 1.238 Test Acc: 0.600
Validation loss decreased (-0.499987 --> -0.599988).  Saving model ...
Epoch: 11 cost time: 0.376723051071167
Epoch: 11, Steps: 3 | Train Loss: 1.112 Vali Loss: 1.208 Vali Acc: 0.650 Test Loss: 1.208 Test Acc: 0.650
Validation loss decreased (-0.599988 --> -0.649988).  Saving model ...
Epoch: 12 cost time: 0.4089055061340332
Epoch: 12, Steps: 3 | Train Loss: 1.066 Vali Loss: 1.178 Vali Acc: 0.675 Test Loss: 1.178 Test Acc: 0.675
Validation loss decreased (-0.649988 --> -0.674988).  Saving model ...
Epoch: 13 cost time: 0.405562162399292
Epoch: 13, Steps: 3 | Train Loss: 1.045 Vali Loss: 1.146 Vali Acc: 0.675 Test Loss: 1.146 Test Acc: 0.675
Validation loss decreased (-0.674988 --> -0.674989).  Saving model ...
Epoch: 14 cost time: 0.4691140651702881
Epoch: 14, Steps: 3 | Train Loss: 0.974 Vali Loss: 1.117 Vali Acc: 0.700 Test Loss: 1.117 Test Acc: 0.700
Validation loss decreased (-0.674989 --> -0.699989).  Saving model ...
Epoch: 15 cost time: 0.43750667572021484
Epoch: 15, Steps: 3 | Train Loss: 0.948 Vali Loss: 1.090 Vali Acc: 0.800 Test Loss: 1.090 Test Acc: 0.800
Validation loss decreased (-0.699989 --> -0.799989).  Saving model ...
Epoch: 16 cost time: 0.41443610191345215
Epoch: 16, Steps: 3 | Train Loss: 0.923 Vali Loss: 1.055 Vali Acc: 0.825 Test Loss: 1.055 Test Acc: 0.825
Validation loss decreased (-0.799989 --> -0.824989).  Saving model ...
Epoch: 17 cost time: 0.45373034477233887
Epoch: 17, Steps: 3 | Train Loss: 0.891 Vali Loss: 1.023 Vali Acc: 0.825 Test Loss: 1.023 Test Acc: 0.825
Validation loss decreased (-0.824989 --> -0.824990).  Saving model ...
Epoch: 18 cost time: 0.44043564796447754
Epoch: 18, Steps: 3 | Train Loss: 0.896 Vali Loss: 0.990 Vali Acc: 0.825 Test Loss: 0.990 Test Acc: 0.825
Validation loss decreased (-0.824990 --> -0.824990).  Saving model ...
Epoch: 19 cost time: 0.43570947647094727
Epoch: 19, Steps: 3 | Train Loss: 0.817 Vali Loss: 0.966 Vali Acc: 0.825 Test Loss: 0.966 Test Acc: 0.825
Validation loss decreased (-0.824990 --> -0.824990).  Saving model ...
Epoch: 20 cost time: 0.4555172920227051
Epoch: 20, Steps: 3 | Train Loss: 0.814 Vali Loss: 0.940 Vali Acc: 0.850 Test Loss: 0.940 Test Acc: 0.850
Validation loss decreased (-0.824990 --> -0.849991).  Saving model ...
Epoch: 21 cost time: 0.39208149909973145
Epoch: 21, Steps: 3 | Train Loss: 0.769 Vali Loss: 0.912 Vali Acc: 0.850 Test Loss: 0.912 Test Acc: 0.850
Validation loss decreased (-0.849991 --> -0.849991).  Saving model ...
Epoch: 22 cost time: 0.3967163562774658
Epoch: 22, Steps: 3 | Train Loss: 0.729 Vali Loss: 0.887 Vali Acc: 0.875 Test Loss: 0.887 Test Acc: 0.875
Validation loss decreased (-0.849991 --> -0.874991).  Saving model ...
Epoch: 23 cost time: 0.4649200439453125
Epoch: 23, Steps: 3 | Train Loss: 0.702 Vali Loss: 0.870 Vali Acc: 0.875 Test Loss: 0.870 Test Acc: 0.875
Validation loss decreased (-0.874991 --> -0.874991).  Saving model ...
Epoch: 24 cost time: 0.40138721466064453
Epoch: 24, Steps: 3 | Train Loss: 0.677 Vali Loss: 0.848 Vali Acc: 0.875 Test Loss: 0.848 Test Acc: 0.875
Validation loss decreased (-0.874991 --> -0.874992).  Saving model ...
Epoch: 25 cost time: 0.4213986396789551
Epoch: 25, Steps: 3 | Train Loss: 0.661 Vali Loss: 0.818 Vali Acc: 0.875 Test Loss: 0.818 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874992).  Saving model ...
Epoch: 26 cost time: 0.44210243225097656
Epoch: 26, Steps: 3 | Train Loss: 0.623 Vali Loss: 0.793 Vali Acc: 0.875 Test Loss: 0.793 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874992).  Saving model ...
Epoch: 27 cost time: 0.40990328788757324
Epoch: 27, Steps: 3 | Train Loss: 0.586 Vali Loss: 0.773 Vali Acc: 0.875 Test Loss: 0.773 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874992).  Saving model ...
Epoch: 28 cost time: 0.4613785743713379
Epoch: 28, Steps: 3 | Train Loss: 0.595 Vali Loss: 0.749 Vali Acc: 0.875 Test Loss: 0.749 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874993).  Saving model ...
Epoch: 29 cost time: 0.4493684768676758
Epoch: 29, Steps: 3 | Train Loss: 0.549 Vali Loss: 0.730 Vali Acc: 0.875 Test Loss: 0.730 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 30 cost time: 0.4422934055328369
Epoch: 30, Steps: 3 | Train Loss: 0.528 Vali Loss: 0.708 Vali Acc: 0.875 Test Loss: 0.708 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 31 cost time: 0.42537403106689453
Epoch: 31, Steps: 3 | Train Loss: 0.500 Vali Loss: 0.699 Vali Acc: 0.875 Test Loss: 0.699 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 32 cost time: 0.4608643054962158
Epoch: 32, Steps: 3 | Train Loss: 0.509 Vali Loss: 0.679 Vali Acc: 0.875 Test Loss: 0.679 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 33 cost time: 0.4168112277984619
Epoch: 33, Steps: 3 | Train Loss: 0.439 Vali Loss: 0.665 Vali Acc: 0.875 Test Loss: 0.665 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 34 cost time: 0.44521403312683105
Epoch: 34, Steps: 3 | Train Loss: 0.440 Vali Loss: 0.644 Vali Acc: 0.875 Test Loss: 0.644 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 35 cost time: 0.4413130283355713
Epoch: 35, Steps: 3 | Train Loss: 0.423 Vali Loss: 0.610 Vali Acc: 0.900 Test Loss: 0.610 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899994).  Saving model ...
Epoch: 36 cost time: 0.4743990898132324
Epoch: 36, Steps: 3 | Train Loss: 0.407 Vali Loss: 0.597 Vali Acc: 0.900 Test Loss: 0.597 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 37 cost time: 0.4611399173736572
Epoch: 37, Steps: 3 | Train Loss: 0.416 Vali Loss: 0.580 Vali Acc: 0.900 Test Loss: 0.580 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 38 cost time: 0.5247483253479004
Epoch: 38, Steps: 3 | Train Loss: 0.369 Vali Loss: 0.559 Vali Acc: 0.900 Test Loss: 0.559 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 39 cost time: 0.4937307834625244
Epoch: 39, Steps: 3 | Train Loss: 0.347 Vali Loss: 0.542 Vali Acc: 0.900 Test Loss: 0.542 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 40 cost time: 0.47264623641967773
Epoch: 40, Steps: 3 | Train Loss: 0.346 Vali Loss: 0.517 Vali Acc: 0.900 Test Loss: 0.517 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 41 cost time: 0.4214355945587158
Epoch: 41, Steps: 3 | Train Loss: 0.317 Vali Loss: 0.511 Vali Acc: 0.900 Test Loss: 0.511 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 42 cost time: 0.5026247501373291
Epoch: 42, Steps: 3 | Train Loss: 0.331 Vali Loss: 0.492 Vali Acc: 0.900 Test Loss: 0.492 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 43 cost time: 0.48868894577026367
Epoch: 43, Steps: 3 | Train Loss: 0.288 Vali Loss: 0.477 Vali Acc: 0.900 Test Loss: 0.477 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 44 cost time: 0.42365312576293945
Epoch: 44, Steps: 3 | Train Loss: 0.274 Vali Loss: 0.457 Vali Acc: 0.900 Test Loss: 0.457 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 45 cost time: 0.4498724937438965
Epoch: 45, Steps: 3 | Train Loss: 0.268 Vali Loss: 0.452 Vali Acc: 0.900 Test Loss: 0.452 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 46 cost time: 0.3602461814880371
Epoch: 46, Steps: 3 | Train Loss: 0.261 Vali Loss: 0.438 Vali Acc: 0.900 Test Loss: 0.438 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 47 cost time: 0.350813627243042
Epoch: 47, Steps: 3 | Train Loss: 0.246 Vali Loss: 0.427 Vali Acc: 0.925 Test Loss: 0.427 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924996).  Saving model ...
Epoch: 48 cost time: 0.4329216480255127
Epoch: 48, Steps: 3 | Train Loss: 0.225 Vali Loss: 0.418 Vali Acc: 0.925 Test Loss: 0.418 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 49 cost time: 0.3862576484680176
Epoch: 49, Steps: 3 | Train Loss: 0.203 Vali Loss: 0.400 Vali Acc: 0.925 Test Loss: 0.400 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 50 cost time: 0.5281615257263184
Epoch: 50, Steps: 3 | Train Loss: 0.200 Vali Loss: 0.392 Vali Acc: 0.925 Test Loss: 0.392 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps25_str13_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 300996
model size : 1.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.6667847633361816
Epoch: 1, Steps: 3 | Train Loss: 1.371 Vali Loss: 1.289 Vali Acc: 0.350 Test Loss: 1.289 Test Acc: 0.350
Validation loss decreased (inf --> -0.349987).  Saving model ...
Epoch: 2 cost time: 0.6288704872131348
Epoch: 2, Steps: 3 | Train Loss: 1.122 Vali Loss: 1.106 Vali Acc: 0.500 Test Loss: 1.106 Test Acc: 0.500
Validation loss decreased (-0.349987 --> -0.499989).  Saving model ...
Epoch: 3 cost time: 0.4240000247955322
Epoch: 3, Steps: 3 | Train Loss: 0.753 Vali Loss: 0.787 Vali Acc: 0.850 Test Loss: 0.787 Test Acc: 0.850
Validation loss decreased (-0.499989 --> -0.849992).  Saving model ...
Epoch: 4 cost time: 0.5518417358398438
Epoch: 4, Steps: 3 | Train Loss: 0.493 Vali Loss: 0.534 Vali Acc: 0.975 Test Loss: 0.534 Test Acc: 0.975
Validation loss decreased (-0.849992 --> -0.974995).  Saving model ...
Epoch: 5 cost time: 0.536524772644043
Epoch: 5, Steps: 3 | Train Loss: 0.317 Vali Loss: 0.355 Vali Acc: 0.975 Test Loss: 0.355 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 6 cost time: 0.4862186908721924
Epoch: 6, Steps: 3 | Train Loss: 0.187 Vali Loss: 0.265 Vali Acc: 0.950 Test Loss: 0.265 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.43817687034606934
Epoch: 7, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.264 Vali Acc: 0.950 Test Loss: 0.264 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.5837101936340332
Epoch: 8, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.323 Vali Acc: 0.925 Test Loss: 0.323 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.5015428066253662
Epoch: 9, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.420 Vali Acc: 0.900 Test Loss: 0.420 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.48250246047973633
Epoch: 10, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.486 Vali Acc: 0.900 Test Loss: 0.486 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.497668981552124
Epoch: 11, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.501 Vali Acc: 0.900 Test Loss: 0.501 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.5888071060180664
Epoch: 12, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.431 Vali Acc: 0.900 Test Loss: 0.431 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.5695064067840576
Epoch: 13, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.391 Vali Acc: 0.950 Test Loss: 0.391 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.5550377368927002
Epoch: 14, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.373 Vali Acc: 0.950 Test Loss: 0.373 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.5036869049072266
Epoch: 15, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.365 Vali Acc: 0.950 Test Loss: 0.365 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 3577860
model size : 13.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.6883413791656494
Epoch: 1, Steps: 3 | Train Loss: 1.449 Vali Loss: 1.364 Vali Acc: 0.250 Test Loss: 1.364 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 0.5556449890136719
Epoch: 2, Steps: 3 | Train Loss: 1.192 Vali Loss: 1.208 Vali Acc: 0.350 Test Loss: 1.208 Test Acc: 0.350
Validation loss decreased (-0.249986 --> -0.349988).  Saving model ...
Epoch: 3 cost time: 0.575584888458252
Epoch: 3, Steps: 3 | Train Loss: 0.943 Vali Loss: 0.919 Vali Acc: 0.750 Test Loss: 0.919 Test Acc: 0.750
Validation loss decreased (-0.349988 --> -0.749991).  Saving model ...
Epoch: 4 cost time: 0.5348834991455078
Epoch: 4, Steps: 3 | Train Loss: 0.677 Vali Loss: 0.663 Vali Acc: 0.850 Test Loss: 0.663 Test Acc: 0.850
Validation loss decreased (-0.749991 --> -0.849993).  Saving model ...
Epoch: 5 cost time: 0.4939851760864258
Epoch: 5, Steps: 3 | Train Loss: 0.421 Vali Loss: 0.468 Vali Acc: 0.950 Test Loss: 0.468 Test Acc: 0.950
Validation loss decreased (-0.849993 --> -0.949995).  Saving model ...
Epoch: 6 cost time: 0.5370783805847168
Epoch: 6, Steps: 3 | Train Loss: 0.261 Vali Loss: 0.335 Vali Acc: 0.975 Test Loss: 0.335 Test Acc: 0.975
Validation loss decreased (-0.949995 --> -0.974997).  Saving model ...
Epoch: 7 cost time: 0.5184721946716309
Epoch: 7, Steps: 3 | Train Loss: 0.177 Vali Loss: 0.254 Vali Acc: 0.975 Test Loss: 0.254 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 8 cost time: 0.5165414810180664
Epoch: 8, Steps: 3 | Train Loss: 0.138 Vali Loss: 0.241 Vali Acc: 0.925 Test Loss: 0.241 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.4930093288421631
Epoch: 9, Steps: 3 | Train Loss: 0.082 Vali Loss: 0.271 Vali Acc: 0.925 Test Loss: 0.271 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.5239574909210205
Epoch: 10, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.308 Vali Acc: 0.925 Test Loss: 0.308 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.40546154975891113
Epoch: 11, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.340 Vali Acc: 0.925 Test Loss: 0.340 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.4077260494232178
Epoch: 12, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.373 Vali Acc: 0.925 Test Loss: 0.373 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.43030714988708496
Epoch: 13, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.396 Vali Acc: 0.925 Test Loss: 0.396 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.5110743045806885
Epoch: 14, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.407 Vali Acc: 0.925 Test Loss: 0.407 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.4911837577819824
Epoch: 15, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.417 Vali Acc: 0.925 Test Loss: 0.417 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.4847249984741211
Epoch: 16, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.427 Vali Acc: 0.925 Test Loss: 0.427 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.4555377960205078
Epoch: 17, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.435 Vali Acc: 0.925 Test Loss: 0.435 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 3473924
model size : 13.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.768122911453247
Epoch: 1, Steps: 3 | Train Loss: 1.552 Vali Loss: 1.465 Vali Acc: 0.050 Test Loss: 1.465 Test Acc: 0.050
Validation loss decreased (inf --> -0.049985).  Saving model ...
Epoch: 2 cost time: 0.44252824783325195
Epoch: 2, Steps: 3 | Train Loss: 1.338 Vali Loss: 1.315 Vali Acc: 0.350 Test Loss: 1.315 Test Acc: 0.350
Validation loss decreased (-0.049985 --> -0.349987).  Saving model ...
Epoch: 3 cost time: 0.5212793350219727
Epoch: 3, Steps: 3 | Train Loss: 1.070 Vali Loss: 1.026 Vali Acc: 0.575 Test Loss: 1.026 Test Acc: 0.575
Validation loss decreased (-0.349987 --> -0.574990).  Saving model ...
Epoch: 4 cost time: 0.4833078384399414
Epoch: 4, Steps: 3 | Train Loss: 0.752 Vali Loss: 0.776 Vali Acc: 0.825 Test Loss: 0.776 Test Acc: 0.825
Validation loss decreased (-0.574990 --> -0.824992).  Saving model ...
Epoch: 5 cost time: 0.5913031101226807
Epoch: 5, Steps: 3 | Train Loss: 0.559 Vali Loss: 0.569 Vali Acc: 0.950 Test Loss: 0.569 Test Acc: 0.950
Validation loss decreased (-0.824992 --> -0.949994).  Saving model ...
Epoch: 6 cost time: 0.5930459499359131
Epoch: 6, Steps: 3 | Train Loss: 0.422 Vali Loss: 0.405 Vali Acc: 0.975 Test Loss: 0.405 Test Acc: 0.975
Validation loss decreased (-0.949994 --> -0.974996).  Saving model ...
Epoch: 7 cost time: 0.5837130546569824
Epoch: 7, Steps: 3 | Train Loss: 0.292 Vali Loss: 0.303 Vali Acc: 0.975 Test Loss: 0.303 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 8 cost time: 0.587904691696167
Epoch: 8, Steps: 3 | Train Loss: 0.185 Vali Loss: 0.247 Vali Acc: 0.975 Test Loss: 0.247 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 9 cost time: 0.6810917854309082
Epoch: 9, Steps: 3 | Train Loss: 0.130 Vali Loss: 0.232 Vali Acc: 0.950 Test Loss: 0.232 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5236382484436035
Epoch: 10, Steps: 3 | Train Loss: 0.102 Vali Loss: 0.250 Vali Acc: 0.950 Test Loss: 0.250 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5774171352386475
Epoch: 11, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.271 Vali Acc: 0.925 Test Loss: 0.271 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.6016712188720703
Epoch: 12, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.294 Vali Acc: 0.925 Test Loss: 0.294 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.5215201377868652
Epoch: 13, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.308 Vali Acc: 0.925 Test Loss: 0.308 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.5266251564025879
Epoch: 14, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.318 Vali Acc: 0.925 Test Loss: 0.318 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.5704584121704102
Epoch: 15, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.326 Vali Acc: 0.925 Test Loss: 0.326 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.5080020427703857
Epoch: 16, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.333 Vali Acc: 0.925 Test Loss: 0.333 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.49315476417541504
Epoch: 17, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.336 Vali Acc: 0.925 Test Loss: 0.336 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.5152647495269775
Epoch: 18, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.340 Vali Acc: 0.925 Test Loss: 0.340 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 3425540
model size : 13.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.6560003757476807
Epoch: 1, Steps: 3 | Train Loss: 1.474 Vali Loss: 1.380 Vali Acc: 0.150 Test Loss: 1.380 Test Acc: 0.150
Validation loss decreased (inf --> -0.149986).  Saving model ...
Epoch: 2 cost time: 0.4916715621948242
Epoch: 2, Steps: 3 | Train Loss: 1.247 Vali Loss: 1.262 Vali Acc: 0.350 Test Loss: 1.262 Test Acc: 0.350
Validation loss decreased (-0.149986 --> -0.349987).  Saving model ...
Epoch: 3 cost time: 0.5075047016143799
Epoch: 3, Steps: 3 | Train Loss: 1.022 Vali Loss: 1.024 Vali Acc: 0.725 Test Loss: 1.024 Test Acc: 0.725
Validation loss decreased (-0.349987 --> -0.724990).  Saving model ...
Epoch: 4 cost time: 0.42987537384033203
Epoch: 4, Steps: 3 | Train Loss: 0.794 Vali Loss: 0.794 Vali Acc: 0.900 Test Loss: 0.794 Test Acc: 0.900
Validation loss decreased (-0.724990 --> -0.899992).  Saving model ...
Epoch: 5 cost time: 0.5364830493927002
Epoch: 5, Steps: 3 | Train Loss: 0.614 Vali Loss: 0.600 Vali Acc: 0.950 Test Loss: 0.600 Test Acc: 0.950
Validation loss decreased (-0.899992 --> -0.949994).  Saving model ...
Epoch: 6 cost time: 0.5194470882415771
Epoch: 6, Steps: 3 | Train Loss: 0.429 Vali Loss: 0.445 Vali Acc: 0.975 Test Loss: 0.445 Test Acc: 0.975
Validation loss decreased (-0.949994 --> -0.974996).  Saving model ...
Epoch: 7 cost time: 0.4607663154602051
Epoch: 7, Steps: 3 | Train Loss: 0.317 Vali Loss: 0.329 Vali Acc: 0.975 Test Loss: 0.329 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 8 cost time: 0.45732688903808594
Epoch: 8, Steps: 3 | Train Loss: 0.219 Vali Loss: 0.252 Vali Acc: 0.975 Test Loss: 0.252 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 9 cost time: 0.5030765533447266
Epoch: 9, Steps: 3 | Train Loss: 0.155 Vali Loss: 0.204 Vali Acc: 0.975 Test Loss: 0.204 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 10 cost time: 0.5668971538543701
Epoch: 10, Steps: 3 | Train Loss: 0.119 Vali Loss: 0.174 Vali Acc: 0.975 Test Loss: 0.174 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 11 cost time: 0.4501678943634033
Epoch: 11, Steps: 3 | Train Loss: 0.094 Vali Loss: 0.163 Vali Acc: 0.975 Test Loss: 0.163 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 12 cost time: 0.47344279289245605
Epoch: 12, Steps: 3 | Train Loss: 0.072 Vali Loss: 0.167 Vali Acc: 0.950 Test Loss: 0.167 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.4584193229675293
Epoch: 13, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.184 Vali Acc: 0.950 Test Loss: 0.184 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.48195767402648926
Epoch: 14, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.193 Vali Acc: 0.950 Test Loss: 0.193 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.47278928756713867
Epoch: 15, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.187 Vali Acc: 0.925 Test Loss: 0.187 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.47875189781188965
Epoch: 16, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.188 Vali Acc: 0.925 Test Loss: 0.188 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.4289841651916504
Epoch: 17, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.168 Vali Acc: 0.925 Test Loss: 0.168 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.4919860363006592
Epoch: 18, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.153 Vali Acc: 0.925 Test Loss: 0.153 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.4914836883544922
Epoch: 19, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.152 Vali Acc: 0.925 Test Loss: 0.152 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.48839235305786133
Epoch: 20, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.149 Vali Acc: 0.925 Test Loss: 0.149 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.5187065601348877
Epoch: 21, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.138 Vali Acc: 0.950 Test Loss: 0.138 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 3395332
model size : 12.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.8857264518737793
Epoch: 1, Steps: 3 | Train Loss: 1.462 Vali Loss: 1.351 Vali Acc: 0.400 Test Loss: 1.351 Test Acc: 0.400
Validation loss decreased (inf --> -0.399986).  Saving model ...
Epoch: 2 cost time: 0.48440098762512207
Epoch: 2, Steps: 3 | Train Loss: 1.261 Vali Loss: 1.251 Vali Acc: 0.500 Test Loss: 1.251 Test Acc: 0.500
Validation loss decreased (-0.399986 --> -0.499987).  Saving model ...
Epoch: 3 cost time: 0.46106505393981934
Epoch: 3, Steps: 3 | Train Loss: 1.061 Vali Loss: 1.076 Vali Acc: 0.625 Test Loss: 1.076 Test Acc: 0.625
Validation loss decreased (-0.499987 --> -0.624989).  Saving model ...
Epoch: 4 cost time: 0.4347362518310547
Epoch: 4, Steps: 3 | Train Loss: 0.836 Vali Loss: 0.907 Vali Acc: 0.700 Test Loss: 0.907 Test Acc: 0.700
Validation loss decreased (-0.624989 --> -0.699991).  Saving model ...
Epoch: 5 cost time: 0.4830765724182129
Epoch: 5, Steps: 3 | Train Loss: 0.695 Vali Loss: 0.751 Vali Acc: 0.925 Test Loss: 0.751 Test Acc: 0.925
Validation loss decreased (-0.699991 --> -0.924992).  Saving model ...
Epoch: 6 cost time: 0.5189719200134277
Epoch: 6, Steps: 3 | Train Loss: 0.588 Vali Loss: 0.613 Vali Acc: 0.925 Test Loss: 0.613 Test Acc: 0.925
Validation loss decreased (-0.924992 --> -0.924994).  Saving model ...
Epoch: 7 cost time: 0.5157773494720459
Epoch: 7, Steps: 3 | Train Loss: 0.454 Vali Loss: 0.505 Vali Acc: 0.975 Test Loss: 0.505 Test Acc: 0.975
Validation loss decreased (-0.924994 --> -0.974995).  Saving model ...
Epoch: 8 cost time: 0.4194302558898926
Epoch: 8, Steps: 3 | Train Loss: 0.371 Vali Loss: 0.399 Vali Acc: 0.975 Test Loss: 0.399 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 9 cost time: 0.5086898803710938
Epoch: 9, Steps: 3 | Train Loss: 0.298 Vali Loss: 0.333 Vali Acc: 0.975 Test Loss: 0.333 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 10 cost time: 0.5222024917602539
Epoch: 10, Steps: 3 | Train Loss: 0.216 Vali Loss: 0.296 Vali Acc: 0.950 Test Loss: 0.296 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5579848289489746
Epoch: 11, Steps: 3 | Train Loss: 0.156 Vali Loss: 0.284 Vali Acc: 0.950 Test Loss: 0.284 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.4715430736541748
Epoch: 12, Steps: 3 | Train Loss: 0.131 Vali Loss: 0.273 Vali Acc: 0.950 Test Loss: 0.273 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.5200636386871338
Epoch: 13, Steps: 3 | Train Loss: 0.108 Vali Loss: 0.279 Vali Acc: 0.950 Test Loss: 0.279 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.44161057472229004
Epoch: 14, Steps: 3 | Train Loss: 0.086 Vali Loss: 0.289 Vali Acc: 0.925 Test Loss: 0.289 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.4923238754272461
Epoch: 15, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.300 Vali Acc: 0.925 Test Loss: 0.300 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.3996865749359131
Epoch: 16, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.304 Vali Acc: 0.925 Test Loss: 0.304 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.567124605178833
Epoch: 17, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.302 Vali Acc: 0.925 Test Loss: 0.302 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.45423436164855957
Epoch: 18, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.303 Vali Acc: 0.925 Test Loss: 0.303 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.4542694091796875
Epoch: 19, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.304 Vali Acc: 0.925 Test Loss: 0.304 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 3347460
model size : 12.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps20_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.6791064739227295
Epoch: 1, Steps: 3 | Train Loss: 1.523 Vali Loss: 1.338 Vali Acc: 0.225 Test Loss: 1.338 Test Acc: 0.225
Validation loss decreased (inf --> -0.224987).  Saving model ...
Epoch: 2 cost time: 0.41794681549072266
Epoch: 2, Steps: 3 | Train Loss: 1.303 Vali Loss: 1.265 Vali Acc: 0.275 Test Loss: 1.265 Test Acc: 0.275
Validation loss decreased (-0.224987 --> -0.274987).  Saving model ...
Epoch: 3 cost time: 0.49613189697265625
Epoch: 3, Steps: 3 | Train Loss: 1.148 Vali Loss: 1.139 Vali Acc: 0.575 Test Loss: 1.139 Test Acc: 0.575
Validation loss decreased (-0.274987 --> -0.574989).  Saving model ...
Epoch: 4 cost time: 0.4731936454772949
Epoch: 4, Steps: 3 | Train Loss: 0.935 Vali Loss: 0.993 Vali Acc: 0.675 Test Loss: 0.993 Test Acc: 0.675
Validation loss decreased (-0.574989 --> -0.674990).  Saving model ...
Epoch: 5 cost time: 0.48523902893066406
Epoch: 5, Steps: 3 | Train Loss: 0.776 Vali Loss: 0.851 Vali Acc: 0.775 Test Loss: 0.851 Test Acc: 0.775
Validation loss decreased (-0.674990 --> -0.774991).  Saving model ...
Epoch: 6 cost time: 0.46793699264526367
Epoch: 6, Steps: 3 | Train Loss: 0.687 Vali Loss: 0.720 Vali Acc: 0.850 Test Loss: 0.720 Test Acc: 0.850
Validation loss decreased (-0.774991 --> -0.849993).  Saving model ...
Epoch: 7 cost time: 0.41115546226501465
Epoch: 7, Steps: 3 | Train Loss: 0.510 Vali Loss: 0.602 Vali Acc: 0.900 Test Loss: 0.602 Test Acc: 0.900
Validation loss decreased (-0.849993 --> -0.899994).  Saving model ...
Epoch: 8 cost time: 0.4429795742034912
Epoch: 8, Steps: 3 | Train Loss: 0.428 Vali Loss: 0.498 Vali Acc: 0.950 Test Loss: 0.498 Test Acc: 0.950
Validation loss decreased (-0.899994 --> -0.949995).  Saving model ...
Epoch: 9 cost time: 0.4908630847930908
Epoch: 9, Steps: 3 | Train Loss: 0.342 Vali Loss: 0.415 Vali Acc: 0.950 Test Loss: 0.415 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 10 cost time: 0.42570996284484863
Epoch: 10, Steps: 3 | Train Loss: 0.288 Vali Loss: 0.345 Vali Acc: 0.950 Test Loss: 0.345 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 11 cost time: 0.5055232048034668
Epoch: 11, Steps: 3 | Train Loss: 0.232 Vali Loss: 0.289 Vali Acc: 0.975 Test Loss: 0.289 Test Acc: 0.975
Validation loss decreased (-0.949997 --> -0.974997).  Saving model ...
Epoch: 12 cost time: 0.5276370048522949
Epoch: 12, Steps: 3 | Train Loss: 0.191 Vali Loss: 0.255 Vali Acc: 0.975 Test Loss: 0.255 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 13 cost time: 0.5055174827575684
Epoch: 13, Steps: 3 | Train Loss: 0.162 Vali Loss: 0.237 Vali Acc: 0.975 Test Loss: 0.237 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 14 cost time: 0.45534181594848633
Epoch: 14, Steps: 3 | Train Loss: 0.129 Vali Loss: 0.226 Vali Acc: 0.975 Test Loss: 0.226 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 15 cost time: 0.5284006595611572
Epoch: 15, Steps: 3 | Train Loss: 0.105 Vali Loss: 0.224 Vali Acc: 0.975 Test Loss: 0.224 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 16 cost time: 0.41725587844848633
Epoch: 16, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.204 Vali Acc: 0.975 Test Loss: 0.204 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 17 cost time: 0.5786128044128418
Epoch: 17, Steps: 3 | Train Loss: 0.068 Vali Loss: 0.197 Vali Acc: 0.975 Test Loss: 0.197 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 18 cost time: 0.4452178478240967
Epoch: 18, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.183 Vali Acc: 0.975 Test Loss: 0.183 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 19 cost time: 0.4307558536529541
Epoch: 19, Steps: 3 | Train Loss: 0.058 Vali Loss: 0.182 Vali Acc: 0.975 Test Loss: 0.182 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 20 cost time: 0.3898916244506836
Epoch: 20, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.171 Vali Acc: 0.975 Test Loss: 0.171 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 21 cost time: 0.4080228805541992
Epoch: 21, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.164 Vali Acc: 0.950 Test Loss: 0.164 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.46953678131103516
Epoch: 22, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.163 Vali Acc: 0.950 Test Loss: 0.163 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.3979189395904541
Epoch: 23, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.162 Vali Acc: 0.950 Test Loss: 0.162 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.5243310928344727
Epoch: 24, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.165 Vali Acc: 0.950 Test Loss: 0.165 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.4341390132904053
Epoch: 25, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.168 Vali Acc: 0.950 Test Loss: 0.168 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.4172375202178955
Epoch: 26, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.170 Vali Acc: 0.950 Test Loss: 0.170 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.4465947151184082
Epoch: 27, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.171 Vali Acc: 0.950 Test Loss: 0.171 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.4043731689453125
Epoch: 28, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.178 Vali Acc: 0.925 Test Loss: 0.178 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.46197009086608887
Epoch: 29, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.182 Vali Acc: 0.925 Test Loss: 0.182 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.5705327987670898
Epoch: 30, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.184 Vali Acc: 0.925 Test Loss: 0.184 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps20_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 3336452
model size : 12.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps25_str13_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.5629382133483887
Epoch: 1, Steps: 3 | Train Loss: 1.396 Vali Loss: 1.352 Vali Acc: 0.425 Test Loss: 1.352 Test Acc: 0.425
Validation loss decreased (inf --> -0.424986).  Saving model ...
Epoch: 2 cost time: 0.4389781951904297
Epoch: 2, Steps: 3 | Train Loss: 1.238 Vali Loss: 1.285 Vali Acc: 0.475 Test Loss: 1.285 Test Acc: 0.475
Validation loss decreased (-0.424986 --> -0.474987).  Saving model ...
Epoch: 3 cost time: 0.5145299434661865
Epoch: 3, Steps: 3 | Train Loss: 1.100 Vali Loss: 1.171 Vali Acc: 0.550 Test Loss: 1.171 Test Acc: 0.550
Validation loss decreased (-0.474987 --> -0.549988).  Saving model ...
Epoch: 4 cost time: 0.4356710910797119
Epoch: 4, Steps: 3 | Train Loss: 0.980 Vali Loss: 1.034 Vali Acc: 0.625 Test Loss: 1.034 Test Acc: 0.625
Validation loss decreased (-0.549988 --> -0.624990).  Saving model ...
Epoch: 5 cost time: 0.43180131912231445
Epoch: 5, Steps: 3 | Train Loss: 0.827 Vali Loss: 0.908 Vali Acc: 0.700 Test Loss: 0.908 Test Acc: 0.700
Validation loss decreased (-0.624990 --> -0.699991).  Saving model ...
Epoch: 6 cost time: 0.5099413394927979
Epoch: 6, Steps: 3 | Train Loss: 0.744 Vali Loss: 0.784 Vali Acc: 0.875 Test Loss: 0.784 Test Acc: 0.875
Validation loss decreased (-0.699991 --> -0.874992).  Saving model ...
Epoch: 7 cost time: 0.5574705600738525
Epoch: 7, Steps: 3 | Train Loss: 0.585 Vali Loss: 0.675 Vali Acc: 0.900 Test Loss: 0.675 Test Acc: 0.900
Validation loss decreased (-0.874992 --> -0.899993).  Saving model ...
Epoch: 8 cost time: 0.5113580226898193
Epoch: 8, Steps: 3 | Train Loss: 0.504 Vali Loss: 0.573 Vali Acc: 0.975 Test Loss: 0.573 Test Acc: 0.975
Validation loss decreased (-0.899993 --> -0.974994).  Saving model ...
Epoch: 9 cost time: 0.5011787414550781
Epoch: 9, Steps: 3 | Train Loss: 0.422 Vali Loss: 0.490 Vali Acc: 0.975 Test Loss: 0.490 Test Acc: 0.975
Validation loss decreased (-0.974994 --> -0.974995).  Saving model ...
Epoch: 10 cost time: 0.4996039867401123
Epoch: 10, Steps: 3 | Train Loss: 0.354 Vali Loss: 0.421 Vali Acc: 0.975 Test Loss: 0.421 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 11 cost time: 0.6122298240661621
Epoch: 11, Steps: 3 | Train Loss: 0.283 Vali Loss: 0.364 Vali Acc: 0.975 Test Loss: 0.364 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 12 cost time: 0.49884891510009766
Epoch: 12, Steps: 3 | Train Loss: 0.235 Vali Loss: 0.320 Vali Acc: 0.975 Test Loss: 0.320 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 13 cost time: 0.47422266006469727
Epoch: 13, Steps: 3 | Train Loss: 0.202 Vali Loss: 0.292 Vali Acc: 0.975 Test Loss: 0.292 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 14 cost time: 0.47231626510620117
Epoch: 14, Steps: 3 | Train Loss: 0.162 Vali Loss: 0.270 Vali Acc: 0.975 Test Loss: 0.270 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 15 cost time: 0.42807626724243164
Epoch: 15, Steps: 3 | Train Loss: 0.146 Vali Loss: 0.252 Vali Acc: 0.975 Test Loss: 0.252 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 16 cost time: 0.4217228889465332
Epoch: 16, Steps: 3 | Train Loss: 0.118 Vali Loss: 0.237 Vali Acc: 0.975 Test Loss: 0.237 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 17 cost time: 0.45915794372558594
Epoch: 17, Steps: 3 | Train Loss: 0.104 Vali Loss: 0.223 Vali Acc: 0.975 Test Loss: 0.223 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 18 cost time: 0.4633502960205078
Epoch: 18, Steps: 3 | Train Loss: 0.075 Vali Loss: 0.206 Vali Acc: 0.975 Test Loss: 0.206 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 19 cost time: 0.45470714569091797
Epoch: 19, Steps: 3 | Train Loss: 0.082 Vali Loss: 0.201 Vali Acc: 0.950 Test Loss: 0.201 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.4788663387298584
Epoch: 20, Steps: 3 | Train Loss: 0.071 Vali Loss: 0.196 Vali Acc: 0.950 Test Loss: 0.196 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.6174371242523193
Epoch: 21, Steps: 3 | Train Loss: 0.058 Vali Loss: 0.191 Vali Acc: 0.950 Test Loss: 0.191 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.4419236183166504
Epoch: 22, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.180 Vali Acc: 0.950 Test Loss: 0.180 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.47852230072021484
Epoch: 23, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.172 Vali Acc: 0.950 Test Loss: 0.172 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.39487314224243164
Epoch: 24, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.157 Vali Acc: 0.950 Test Loss: 0.157 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.475344181060791
Epoch: 25, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.151 Vali Acc: 0.950 Test Loss: 0.151 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.5136244297027588
Epoch: 26, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.150 Vali Acc: 0.950 Test Loss: 0.150 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.49518346786499023
Epoch: 27, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.147 Vali Acc: 0.950 Test Loss: 0.147 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.4162712097167969
Epoch: 28, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.152 Vali Acc: 0.950 Test Loss: 0.152 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps25_str13_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 3319300
model size : 12.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.6497790813446045
Epoch: 1, Steps: 3 | Train Loss: 1.353 Vali Loss: 1.360 Vali Acc: 0.400 Test Loss: 1.360 Test Acc: 0.400
Validation loss decreased (inf --> -0.399986).  Saving model ...
Epoch: 2 cost time: 0.5028891563415527
Epoch: 2, Steps: 3 | Train Loss: 1.130 Vali Loss: 1.234 Vali Acc: 0.425 Test Loss: 1.234 Test Acc: 0.425
Validation loss decreased (-0.399986 --> -0.424988).  Saving model ...
Epoch: 3 cost time: 0.45577335357666016
Epoch: 3, Steps: 3 | Train Loss: 0.920 Vali Loss: 1.010 Vali Acc: 0.650 Test Loss: 1.010 Test Acc: 0.650
Validation loss decreased (-0.424988 --> -0.649990).  Saving model ...
Epoch: 4 cost time: 0.42920541763305664
Epoch: 4, Steps: 3 | Train Loss: 0.712 Vali Loss: 0.799 Vali Acc: 0.875 Test Loss: 0.799 Test Acc: 0.875
Validation loss decreased (-0.649990 --> -0.874992).  Saving model ...
Epoch: 5 cost time: 0.4578971862792969
Epoch: 5, Steps: 3 | Train Loss: 0.534 Vali Loss: 0.602 Vali Acc: 0.900 Test Loss: 0.602 Test Acc: 0.900
Validation loss decreased (-0.874992 --> -0.899994).  Saving model ...
Epoch: 6 cost time: 0.43697023391723633
Epoch: 6, Steps: 3 | Train Loss: 0.374 Vali Loss: 0.454 Vali Acc: 0.900 Test Loss: 0.454 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 7 cost time: 0.5126829147338867
Epoch: 7, Steps: 3 | Train Loss: 0.251 Vali Loss: 0.352 Vali Acc: 0.900 Test Loss: 0.352 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 8 cost time: 0.4734213352203369
Epoch: 8, Steps: 3 | Train Loss: 0.173 Vali Loss: 0.295 Vali Acc: 0.925 Test Loss: 0.295 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924997).  Saving model ...
Epoch: 9 cost time: 0.46375274658203125
Epoch: 9, Steps: 3 | Train Loss: 0.135 Vali Loss: 0.273 Vali Acc: 0.950 Test Loss: 0.273 Test Acc: 0.950
Validation loss decreased (-0.924997 --> -0.949997).  Saving model ...
Epoch: 10 cost time: 0.4962596893310547
Epoch: 10, Steps: 3 | Train Loss: 0.074 Vali Loss: 0.271 Vali Acc: 0.950 Test Loss: 0.271 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 11 cost time: 0.48278093338012695
Epoch: 11, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.301 Vali Acc: 0.925 Test Loss: 0.301 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5361795425415039
Epoch: 12, Steps: 3 | Train Loss: 0.055 Vali Loss: 0.337 Vali Acc: 0.900 Test Loss: 0.337 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.4465141296386719
Epoch: 13, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.368 Vali Acc: 0.875 Test Loss: 0.368 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.48420166969299316
Epoch: 14, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.393 Vali Acc: 0.875 Test Loss: 0.393 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.4956667423248291
Epoch: 15, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.405 Vali Acc: 0.875 Test Loss: 0.405 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.46128201484680176
Epoch: 16, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.401 Vali Acc: 0.925 Test Loss: 0.401 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.5251796245574951
Epoch: 17, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.398 Vali Acc: 0.925 Test Loss: 0.398 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.455322265625
Epoch: 18, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.400 Vali Acc: 0.925 Test Loss: 0.400 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.5406501293182373
Epoch: 19, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.389 Vali Acc: 0.925 Test Loss: 0.389 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.4290018081665039
Epoch: 20, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.381 Vali Acc: 0.925 Test Loss: 0.381 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 1002500
model size : 3.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.5271472930908203
Epoch: 1, Steps: 3 | Train Loss: 1.366 Vali Loss: 1.303 Vali Acc: 0.400 Test Loss: 1.303 Test Acc: 0.400
Validation loss decreased (inf --> -0.399987).  Saving model ...
Epoch: 2 cost time: 0.45809173583984375
Epoch: 2, Steps: 3 | Train Loss: 1.162 Vali Loss: 1.185 Vali Acc: 0.600 Test Loss: 1.185 Test Acc: 0.600
Validation loss decreased (-0.399987 --> -0.599988).  Saving model ...
Epoch: 3 cost time: 0.40700650215148926
Epoch: 3, Steps: 3 | Train Loss: 0.994 Vali Loss: 0.983 Vali Acc: 0.700 Test Loss: 0.983 Test Acc: 0.700
Validation loss decreased (-0.599988 --> -0.699990).  Saving model ...
Epoch: 4 cost time: 0.42432475090026855
Epoch: 4, Steps: 3 | Train Loss: 0.778 Vali Loss: 0.798 Vali Acc: 0.900 Test Loss: 0.798 Test Acc: 0.900
Validation loss decreased (-0.699990 --> -0.899992).  Saving model ...
Epoch: 5 cost time: 0.4271280765533447
Epoch: 5, Steps: 3 | Train Loss: 0.659 Vali Loss: 0.627 Vali Acc: 0.950 Test Loss: 0.627 Test Acc: 0.950
Validation loss decreased (-0.899992 --> -0.949994).  Saving model ...
Epoch: 6 cost time: 0.40085268020629883
Epoch: 6, Steps: 3 | Train Loss: 0.470 Vali Loss: 0.484 Vali Acc: 0.975 Test Loss: 0.484 Test Acc: 0.975
Validation loss decreased (-0.949994 --> -0.974995).  Saving model ...
Epoch: 7 cost time: 0.47777605056762695
Epoch: 7, Steps: 3 | Train Loss: 0.379 Vali Loss: 0.371 Vali Acc: 0.975 Test Loss: 0.371 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 8 cost time: 0.4357154369354248
Epoch: 8, Steps: 3 | Train Loss: 0.277 Vali Loss: 0.290 Vali Acc: 0.975 Test Loss: 0.290 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 9 cost time: 0.4174652099609375
Epoch: 9, Steps: 3 | Train Loss: 0.204 Vali Loss: 0.235 Vali Acc: 0.975 Test Loss: 0.235 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 10 cost time: 0.44008922576904297
Epoch: 10, Steps: 3 | Train Loss: 0.148 Vali Loss: 0.207 Vali Acc: 0.975 Test Loss: 0.207 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 11 cost time: 0.44564294815063477
Epoch: 11, Steps: 3 | Train Loss: 0.114 Vali Loss: 0.202 Vali Acc: 0.950 Test Loss: 0.202 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.4624950885772705
Epoch: 12, Steps: 3 | Train Loss: 0.114 Vali Loss: 0.208 Vali Acc: 0.950 Test Loss: 0.208 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.41808438301086426
Epoch: 13, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.224 Vali Acc: 0.950 Test Loss: 0.224 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.44536590576171875
Epoch: 14, Steps: 3 | Train Loss: 0.055 Vali Loss: 0.235 Vali Acc: 0.950 Test Loss: 0.235 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.4399452209472656
Epoch: 15, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.231 Vali Acc: 0.950 Test Loss: 0.231 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.5003726482391357
Epoch: 16, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.223 Vali Acc: 0.950 Test Loss: 0.223 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.502434492111206
Epoch: 17, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.212 Vali Acc: 0.950 Test Loss: 0.212 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.42592883110046387
Epoch: 18, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.195 Vali Acc: 0.950 Test Loss: 0.195 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.47204089164733887
Epoch: 19, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.188 Vali Acc: 0.950 Test Loss: 0.188 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.39965009689331055
Epoch: 20, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.181 Vali Acc: 0.950 Test Loss: 0.181 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 950532
model size : 3.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.6778850555419922
Epoch: 1, Steps: 3 | Train Loss: 1.381 Vali Loss: 1.388 Vali Acc: 0.500 Test Loss: 1.388 Test Acc: 0.500
Validation loss decreased (inf --> -0.499986).  Saving model ...
Epoch: 2 cost time: 0.5753157138824463
Epoch: 2, Steps: 3 | Train Loss: 1.225 Vali Loss: 1.290 Vali Acc: 0.575 Test Loss: 1.290 Test Acc: 0.575
Validation loss decreased (-0.499986 --> -0.574987).  Saving model ...
Epoch: 3 cost time: 0.4222712516784668
Epoch: 3, Steps: 3 | Train Loss: 1.049 Vali Loss: 1.117 Vali Acc: 0.750 Test Loss: 1.117 Test Acc: 0.750
Validation loss decreased (-0.574987 --> -0.749989).  Saving model ...
Epoch: 4 cost time: 0.44318246841430664
Epoch: 4, Steps: 3 | Train Loss: 0.858 Vali Loss: 0.934 Vali Acc: 0.850 Test Loss: 0.934 Test Acc: 0.850
Validation loss decreased (-0.749989 --> -0.849991).  Saving model ...
Epoch: 5 cost time: 0.46864819526672363
Epoch: 5, Steps: 3 | Train Loss: 0.707 Vali Loss: 0.773 Vali Acc: 0.850 Test Loss: 0.773 Test Acc: 0.850
Validation loss decreased (-0.849991 --> -0.849992).  Saving model ...
Epoch: 6 cost time: 0.4843447208404541
Epoch: 6, Steps: 3 | Train Loss: 0.594 Vali Loss: 0.630 Vali Acc: 0.850 Test Loss: 0.630 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849994).  Saving model ...
Epoch: 7 cost time: 0.49001574516296387
Epoch: 7, Steps: 3 | Train Loss: 0.451 Vali Loss: 0.509 Vali Acc: 0.925 Test Loss: 0.509 Test Acc: 0.925
Validation loss decreased (-0.849994 --> -0.924995).  Saving model ...
Epoch: 8 cost time: 0.5870349407196045
Epoch: 8, Steps: 3 | Train Loss: 0.337 Vali Loss: 0.412 Vali Acc: 0.950 Test Loss: 0.412 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949996).  Saving model ...
Epoch: 9 cost time: 0.5304598808288574
Epoch: 9, Steps: 3 | Train Loss: 0.277 Vali Loss: 0.338 Vali Acc: 0.975 Test Loss: 0.338 Test Acc: 0.975
Validation loss decreased (-0.949996 --> -0.974997).  Saving model ...
Epoch: 10 cost time: 0.49947404861450195
Epoch: 10, Steps: 3 | Train Loss: 0.219 Vali Loss: 0.290 Vali Acc: 0.975 Test Loss: 0.290 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 11 cost time: 0.48964548110961914
Epoch: 11, Steps: 3 | Train Loss: 0.173 Vali Loss: 0.253 Vali Acc: 0.975 Test Loss: 0.253 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 12 cost time: 0.47620368003845215
Epoch: 12, Steps: 3 | Train Loss: 0.133 Vali Loss: 0.231 Vali Acc: 0.975 Test Loss: 0.231 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 13 cost time: 0.46910977363586426
Epoch: 13, Steps: 3 | Train Loss: 0.120 Vali Loss: 0.204 Vali Acc: 0.975 Test Loss: 0.204 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 14 cost time: 0.43798041343688965
Epoch: 14, Steps: 3 | Train Loss: 0.110 Vali Loss: 0.187 Vali Acc: 0.975 Test Loss: 0.187 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 15 cost time: 0.4925720691680908
Epoch: 15, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.177 Vali Acc: 0.975 Test Loss: 0.177 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 16 cost time: 0.46777796745300293
Epoch: 16, Steps: 3 | Train Loss: 0.063 Vali Loss: 0.165 Vali Acc: 0.975 Test Loss: 0.165 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 17 cost time: 0.4237957000732422
Epoch: 17, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.162 Vali Acc: 0.950 Test Loss: 0.162 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6415905952453613
Epoch: 18, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.165 Vali Acc: 0.950 Test Loss: 0.165 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.44215869903564453
Epoch: 19, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.156 Vali Acc: 0.950 Test Loss: 0.156 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.45522189140319824
Epoch: 20, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.152 Vali Acc: 0.950 Test Loss: 0.152 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.5004367828369141
Epoch: 21, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.152 Vali Acc: 0.950 Test Loss: 0.152 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.46900439262390137
Epoch: 22, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.157 Vali Acc: 0.950 Test Loss: 0.157 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.44982147216796875
Epoch: 23, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.160 Vali Acc: 0.925 Test Loss: 0.160 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.44843268394470215
Epoch: 24, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.166 Vali Acc: 0.925 Test Loss: 0.166 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.5276322364807129
Epoch: 25, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.168 Vali Acc: 0.925 Test Loss: 0.168 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.4362950325012207
Epoch: 26, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.173 Vali Acc: 0.925 Test Loss: 0.173 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 926340
model size : 3.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.7624573707580566
Epoch: 1, Steps: 3 | Train Loss: 1.319 Vali Loss: 1.345 Vali Acc: 0.475 Test Loss: 1.345 Test Acc: 0.475
Validation loss decreased (inf --> -0.474987).  Saving model ...
Epoch: 2 cost time: 0.41102004051208496
Epoch: 2, Steps: 3 | Train Loss: 1.210 Vali Loss: 1.267 Vali Acc: 0.500 Test Loss: 1.267 Test Acc: 0.500
Validation loss decreased (-0.474987 --> -0.499987).  Saving model ...
Epoch: 3 cost time: 0.4550318717956543
Epoch: 3, Steps: 3 | Train Loss: 1.050 Vali Loss: 1.130 Vali Acc: 0.600 Test Loss: 1.130 Test Acc: 0.600
Validation loss decreased (-0.499987 --> -0.599989).  Saving model ...
Epoch: 4 cost time: 0.4250516891479492
Epoch: 4, Steps: 3 | Train Loss: 0.913 Vali Loss: 0.972 Vali Acc: 0.725 Test Loss: 0.972 Test Acc: 0.725
Validation loss decreased (-0.599989 --> -0.724990).  Saving model ...
Epoch: 5 cost time: 0.4881000518798828
Epoch: 5, Steps: 3 | Train Loss: 0.733 Vali Loss: 0.827 Vali Acc: 0.875 Test Loss: 0.827 Test Acc: 0.875
Validation loss decreased (-0.724990 --> -0.874992).  Saving model ...
Epoch: 6 cost time: 0.433305025100708
Epoch: 6, Steps: 3 | Train Loss: 0.651 Vali Loss: 0.699 Vali Acc: 0.950 Test Loss: 0.699 Test Acc: 0.950
Validation loss decreased (-0.874992 --> -0.949993).  Saving model ...
Epoch: 7 cost time: 0.42415380477905273
Epoch: 7, Steps: 3 | Train Loss: 0.504 Vali Loss: 0.588 Vali Acc: 0.950 Test Loss: 0.588 Test Acc: 0.950
Validation loss decreased (-0.949993 --> -0.949994).  Saving model ...
Epoch: 8 cost time: 0.4071686267852783
Epoch: 8, Steps: 3 | Train Loss: 0.404 Vali Loss: 0.500 Vali Acc: 0.950 Test Loss: 0.500 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 9 cost time: 0.4333326816558838
Epoch: 9, Steps: 3 | Train Loss: 0.340 Vali Loss: 0.426 Vali Acc: 0.950 Test Loss: 0.426 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 10 cost time: 0.4255497455596924
Epoch: 10, Steps: 3 | Train Loss: 0.266 Vali Loss: 0.373 Vali Acc: 0.950 Test Loss: 0.373 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 11 cost time: 0.46277403831481934
Epoch: 11, Steps: 3 | Train Loss: 0.212 Vali Loss: 0.339 Vali Acc: 0.950 Test Loss: 0.339 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 12 cost time: 0.43614840507507324
Epoch: 12, Steps: 3 | Train Loss: 0.190 Vali Loss: 0.328 Vali Acc: 0.950 Test Loss: 0.328 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 13 cost time: 0.3844294548034668
Epoch: 13, Steps: 3 | Train Loss: 0.157 Vali Loss: 0.307 Vali Acc: 0.950 Test Loss: 0.307 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 14 cost time: 0.39768028259277344
Epoch: 14, Steps: 3 | Train Loss: 0.126 Vali Loss: 0.302 Vali Acc: 0.950 Test Loss: 0.302 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 15 cost time: 0.4714384078979492
Epoch: 15, Steps: 3 | Train Loss: 0.095 Vali Loss: 0.287 Vali Acc: 0.950 Test Loss: 0.287 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 16 cost time: 0.4556412696838379
Epoch: 16, Steps: 3 | Train Loss: 0.070 Vali Loss: 0.273 Vali Acc: 0.950 Test Loss: 0.273 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 17 cost time: 0.41992831230163574
Epoch: 17, Steps: 3 | Train Loss: 0.083 Vali Loss: 0.274 Vali Acc: 0.950 Test Loss: 0.274 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.49057459831237793
Epoch: 18, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.275 Vali Acc: 0.950 Test Loss: 0.275 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.4539072513580322
Epoch: 19, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.276 Vali Acc: 0.950 Test Loss: 0.276 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.47561144828796387
Epoch: 20, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.282 Vali Acc: 0.950 Test Loss: 0.282 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.487152099609375
Epoch: 21, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.291 Vali Acc: 0.950 Test Loss: 0.291 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.48907971382141113
Epoch: 22, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.291 Vali Acc: 0.950 Test Loss: 0.291 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.45720601081848145
Epoch: 23, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.296 Vali Acc: 0.950 Test Loss: 0.296 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.438417911529541
Epoch: 24, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.304 Vali Acc: 0.950 Test Loss: 0.304 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.43416786193847656
Epoch: 25, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.310 Vali Acc: 0.950 Test Loss: 0.310 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.5185956954956055
Epoch: 26, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.317 Vali Acc: 0.925 Test Loss: 0.317 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 911236
model size : 3.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.6693973541259766
Epoch: 1, Steps: 3 | Train Loss: 1.428 Vali Loss: 1.281 Vali Acc: 0.350 Test Loss: 1.281 Test Acc: 0.350
Validation loss decreased (inf --> -0.349987).  Saving model ...
Epoch: 2 cost time: 0.3967287540435791
Epoch: 2, Steps: 3 | Train Loss: 1.287 Vali Loss: 1.222 Vali Acc: 0.425 Test Loss: 1.222 Test Acc: 0.425
Validation loss decreased (-0.349987 --> -0.424988).  Saving model ...
Epoch: 3 cost time: 0.3893873691558838
Epoch: 3, Steps: 3 | Train Loss: 1.206 Vali Loss: 1.135 Vali Acc: 0.450 Test Loss: 1.135 Test Acc: 0.450
Validation loss decreased (-0.424988 --> -0.449989).  Saving model ...
Epoch: 4 cost time: 0.4449167251586914
Epoch: 4, Steps: 3 | Train Loss: 1.028 Vali Loss: 1.026 Vali Acc: 0.525 Test Loss: 1.026 Test Acc: 0.525
Validation loss decreased (-0.449989 --> -0.524990).  Saving model ...
Epoch: 5 cost time: 0.46184277534484863
Epoch: 5, Steps: 3 | Train Loss: 0.956 Vali Loss: 0.918 Vali Acc: 0.575 Test Loss: 0.918 Test Acc: 0.575
Validation loss decreased (-0.524990 --> -0.574991).  Saving model ...
Epoch: 6 cost time: 0.395740270614624
Epoch: 6, Steps: 3 | Train Loss: 0.829 Vali Loss: 0.819 Vali Acc: 0.600 Test Loss: 0.819 Test Acc: 0.600
Validation loss decreased (-0.574991 --> -0.599992).  Saving model ...
Epoch: 7 cost time: 0.44454407691955566
Epoch: 7, Steps: 3 | Train Loss: 0.728 Vali Loss: 0.727 Vali Acc: 0.775 Test Loss: 0.727 Test Acc: 0.775
Validation loss decreased (-0.599992 --> -0.774993).  Saving model ...
Epoch: 8 cost time: 0.41268086433410645
Epoch: 8, Steps: 3 | Train Loss: 0.643 Vali Loss: 0.639 Vali Acc: 0.900 Test Loss: 0.639 Test Acc: 0.900
Validation loss decreased (-0.774993 --> -0.899994).  Saving model ...
Epoch: 9 cost time: 0.40663957595825195
Epoch: 9, Steps: 3 | Train Loss: 0.543 Vali Loss: 0.556 Vali Acc: 0.925 Test Loss: 0.556 Test Acc: 0.925
Validation loss decreased (-0.899994 --> -0.924994).  Saving model ...
Epoch: 10 cost time: 0.4194769859313965
Epoch: 10, Steps: 3 | Train Loss: 0.450 Vali Loss: 0.486 Vali Acc: 0.950 Test Loss: 0.486 Test Acc: 0.950
Validation loss decreased (-0.924994 --> -0.949995).  Saving model ...
Epoch: 11 cost time: 0.4431438446044922
Epoch: 11, Steps: 3 | Train Loss: 0.378 Vali Loss: 0.428 Vali Acc: 0.950 Test Loss: 0.428 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 12 cost time: 0.4761025905609131
Epoch: 12, Steps: 3 | Train Loss: 0.318 Vali Loss: 0.380 Vali Acc: 0.950 Test Loss: 0.380 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 13 cost time: 0.40164828300476074
Epoch: 13, Steps: 3 | Train Loss: 0.279 Vali Loss: 0.338 Vali Acc: 0.950 Test Loss: 0.338 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 14 cost time: 0.45155954360961914
Epoch: 14, Steps: 3 | Train Loss: 0.228 Vali Loss: 0.308 Vali Acc: 0.950 Test Loss: 0.308 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 15 cost time: 0.49904465675354004
Epoch: 15, Steps: 3 | Train Loss: 0.196 Vali Loss: 0.295 Vali Acc: 0.975 Test Loss: 0.295 Test Acc: 0.975
Validation loss decreased (-0.949997 --> -0.974997).  Saving model ...
Epoch: 16 cost time: 0.43567609786987305
Epoch: 16, Steps: 3 | Train Loss: 0.197 Vali Loss: 0.286 Vali Acc: 0.950 Test Loss: 0.286 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.45905089378356934
Epoch: 17, Steps: 3 | Train Loss: 0.156 Vali Loss: 0.279 Vali Acc: 0.950 Test Loss: 0.279 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.4202110767364502
Epoch: 18, Steps: 3 | Train Loss: 0.140 Vali Loss: 0.275 Vali Acc: 0.950 Test Loss: 0.275 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.4718925952911377
Epoch: 19, Steps: 3 | Train Loss: 0.122 Vali Loss: 0.272 Vali Acc: 0.950 Test Loss: 0.272 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.4553523063659668
Epoch: 20, Steps: 3 | Train Loss: 0.104 Vali Loss: 0.262 Vali Acc: 0.950 Test Loss: 0.262 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.4441227912902832
Epoch: 21, Steps: 3 | Train Loss: 0.108 Vali Loss: 0.260 Vali Acc: 0.950 Test Loss: 0.260 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.42349863052368164
Epoch: 22, Steps: 3 | Train Loss: 0.073 Vali Loss: 0.248 Vali Acc: 0.950 Test Loss: 0.248 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.39570140838623047
Epoch: 23, Steps: 3 | Train Loss: 0.086 Vali Loss: 0.242 Vali Acc: 0.950 Test Loss: 0.242 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.43241333961486816
Epoch: 24, Steps: 3 | Train Loss: 0.074 Vali Loss: 0.240 Vali Acc: 0.950 Test Loss: 0.240 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.47358012199401855
Epoch: 25, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.226 Vali Acc: 0.950 Test Loss: 0.226 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 887300
model size : 3.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps20_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.603691816329956
Epoch: 1, Steps: 3 | Train Loss: 1.415 Vali Loss: 1.399 Vali Acc: 0.150 Test Loss: 1.399 Test Acc: 0.150
Validation loss decreased (inf --> -0.149986).  Saving model ...
Epoch: 2 cost time: 0.4416515827178955
Epoch: 2, Steps: 3 | Train Loss: 1.358 Vali Loss: 1.343 Vali Acc: 0.425 Test Loss: 1.343 Test Acc: 0.425
Validation loss decreased (-0.149986 --> -0.424987).  Saving model ...
Epoch: 3 cost time: 0.41176295280456543
Epoch: 3, Steps: 3 | Train Loss: 1.218 Vali Loss: 1.259 Vali Acc: 0.600 Test Loss: 1.259 Test Acc: 0.600
Validation loss decreased (-0.424987 --> -0.599987).  Saving model ...
Epoch: 4 cost time: 0.39429640769958496
Epoch: 4, Steps: 3 | Train Loss: 1.082 Vali Loss: 1.151 Vali Acc: 0.675 Test Loss: 1.151 Test Acc: 0.675
Validation loss decreased (-0.599987 --> -0.674988).  Saving model ...
Epoch: 5 cost time: 0.35211920738220215
Epoch: 5, Steps: 3 | Train Loss: 0.955 Vali Loss: 1.041 Vali Acc: 0.725 Test Loss: 1.041 Test Acc: 0.725
Validation loss decreased (-0.674988 --> -0.724990).  Saving model ...
Epoch: 6 cost time: 0.3919544219970703
Epoch: 6, Steps: 3 | Train Loss: 0.844 Vali Loss: 0.937 Vali Acc: 0.750 Test Loss: 0.937 Test Acc: 0.750
Validation loss decreased (-0.724990 --> -0.749991).  Saving model ...
Epoch: 7 cost time: 0.38376617431640625
Epoch: 7, Steps: 3 | Train Loss: 0.810 Vali Loss: 0.832 Vali Acc: 0.825 Test Loss: 0.832 Test Acc: 0.825
Validation loss decreased (-0.749991 --> -0.824992).  Saving model ...
Epoch: 8 cost time: 0.4301488399505615
Epoch: 8, Steps: 3 | Train Loss: 0.688 Vali Loss: 0.736 Vali Acc: 0.900 Test Loss: 0.736 Test Acc: 0.900
Validation loss decreased (-0.824992 --> -0.899993).  Saving model ...
Epoch: 9 cost time: 0.4726231098175049
Epoch: 9, Steps: 3 | Train Loss: 0.615 Vali Loss: 0.638 Vali Acc: 0.950 Test Loss: 0.638 Test Acc: 0.950
Validation loss decreased (-0.899993 --> -0.949994).  Saving model ...
Epoch: 10 cost time: 0.45630979537963867
Epoch: 10, Steps: 3 | Train Loss: 0.465 Vali Loss: 0.562 Vali Acc: 0.950 Test Loss: 0.562 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949994).  Saving model ...
Epoch: 11 cost time: 0.47037482261657715
Epoch: 11, Steps: 3 | Train Loss: 0.441 Vali Loss: 0.493 Vali Acc: 0.975 Test Loss: 0.493 Test Acc: 0.975
Validation loss decreased (-0.949994 --> -0.974995).  Saving model ...
Epoch: 12 cost time: 0.45378780364990234
Epoch: 12, Steps: 3 | Train Loss: 0.373 Vali Loss: 0.430 Vali Acc: 0.975 Test Loss: 0.430 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 13 cost time: 0.4454476833343506
Epoch: 13, Steps: 3 | Train Loss: 0.315 Vali Loss: 0.379 Vali Acc: 0.975 Test Loss: 0.379 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 14 cost time: 0.44748425483703613
Epoch: 14, Steps: 3 | Train Loss: 0.281 Vali Loss: 0.337 Vali Acc: 0.975 Test Loss: 0.337 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 15 cost time: 0.4347190856933594
Epoch: 15, Steps: 3 | Train Loss: 0.247 Vali Loss: 0.308 Vali Acc: 0.975 Test Loss: 0.308 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 16 cost time: 0.4157876968383789
Epoch: 16, Steps: 3 | Train Loss: 0.236 Vali Loss: 0.287 Vali Acc: 0.975 Test Loss: 0.287 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 17 cost time: 0.4317026138305664
Epoch: 17, Steps: 3 | Train Loss: 0.206 Vali Loss: 0.270 Vali Acc: 0.975 Test Loss: 0.270 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 18 cost time: 0.427837610244751
Epoch: 18, Steps: 3 | Train Loss: 0.171 Vali Loss: 0.260 Vali Acc: 0.975 Test Loss: 0.260 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 19 cost time: 0.49198341369628906
Epoch: 19, Steps: 3 | Train Loss: 0.146 Vali Loss: 0.242 Vali Acc: 0.975 Test Loss: 0.242 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 20 cost time: 0.4861569404602051
Epoch: 20, Steps: 3 | Train Loss: 0.139 Vali Loss: 0.234 Vali Acc: 0.975 Test Loss: 0.234 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 21 cost time: 0.46912145614624023
Epoch: 21, Steps: 3 | Train Loss: 0.112 Vali Loss: 0.228 Vali Acc: 0.975 Test Loss: 0.228 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 22 cost time: 0.5111510753631592
Epoch: 22, Steps: 3 | Train Loss: 0.099 Vali Loss: 0.223 Vali Acc: 0.975 Test Loss: 0.223 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 23 cost time: 0.4389760494232178
Epoch: 23, Steps: 3 | Train Loss: 0.101 Vali Loss: 0.220 Vali Acc: 0.975 Test Loss: 0.220 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 24 cost time: 0.4800686836242676
Epoch: 24, Steps: 3 | Train Loss: 0.076 Vali Loss: 0.213 Vali Acc: 0.975 Test Loss: 0.213 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 25 cost time: 0.4494202136993408
Epoch: 25, Steps: 3 | Train Loss: 0.070 Vali Loss: 0.210 Vali Acc: 0.975 Test Loss: 0.210 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 26 cost time: 0.40682291984558105
Epoch: 26, Steps: 3 | Train Loss: 0.083 Vali Loss: 0.200 Vali Acc: 0.975 Test Loss: 0.200 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 27 cost time: 0.5200109481811523
Epoch: 27, Steps: 3 | Train Loss: 0.068 Vali Loss: 0.190 Vali Acc: 0.975 Test Loss: 0.190 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 28 cost time: 0.5178709030151367
Epoch: 28, Steps: 3 | Train Loss: 0.070 Vali Loss: 0.181 Vali Acc: 0.975 Test Loss: 0.181 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 29 cost time: 0.40816402435302734
Epoch: 29, Steps: 3 | Train Loss: 0.062 Vali Loss: 0.174 Vali Acc: 0.975 Test Loss: 0.174 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 30 cost time: 0.47406816482543945
Epoch: 30, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.170 Vali Acc: 0.975 Test Loss: 0.170 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 31 cost time: 0.4183022975921631
Epoch: 31, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.166 Vali Acc: 0.975 Test Loss: 0.166 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 32 cost time: 0.48511791229248047
Epoch: 32, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.165 Vali Acc: 0.975 Test Loss: 0.165 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 33 cost time: 0.4363079071044922
Epoch: 33, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.166 Vali Acc: 0.975 Test Loss: 0.166 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.43467116355895996
Epoch: 34, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.168 Vali Acc: 0.950 Test Loss: 0.168 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.44678592681884766
Epoch: 35, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.169 Vali Acc: 0.950 Test Loss: 0.169 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.4084129333496094
Epoch: 36, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.164 Vali Acc: 0.950 Test Loss: 0.164 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.40356874465942383
Epoch: 37, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.161 Vali Acc: 0.950 Test Loss: 0.161 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.3809072971343994
Epoch: 38, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.158 Vali Acc: 0.950 Test Loss: 0.158 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.37514448165893555
Epoch: 39, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.159 Vali Acc: 0.950 Test Loss: 0.159 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.4441947937011719
Epoch: 40, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.157 Vali Acc: 0.950 Test Loss: 0.157 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.4142911434173584
Epoch: 41, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.155 Vali Acc: 0.950 Test Loss: 0.155 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.4342381954193115
Epoch: 42, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.158 Vali Acc: 0.950 Test Loss: 0.158 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps20_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 881796
model size : 3.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps25_str13_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.6419768333435059
Epoch: 1, Steps: 3 | Train Loss: 1.361 Vali Loss: 1.345 Vali Acc: 0.300 Test Loss: 1.345 Test Acc: 0.300
Validation loss decreased (inf --> -0.299987).  Saving model ...
Epoch: 2 cost time: 0.5113227367401123
Epoch: 2, Steps: 3 | Train Loss: 1.263 Vali Loss: 1.302 Vali Acc: 0.375 Test Loss: 1.302 Test Acc: 0.375
Validation loss decreased (-0.299987 --> -0.374987).  Saving model ...
Epoch: 3 cost time: 0.47393298149108887
Epoch: 3, Steps: 3 | Train Loss: 1.213 Vali Loss: 1.243 Vali Acc: 0.425 Test Loss: 1.243 Test Acc: 0.425
Validation loss decreased (-0.374987 --> -0.424988).  Saving model ...
Epoch: 4 cost time: 0.3915071487426758
Epoch: 4, Steps: 3 | Train Loss: 1.098 Vali Loss: 1.167 Vali Acc: 0.525 Test Loss: 1.167 Test Acc: 0.525
Validation loss decreased (-0.424988 --> -0.524988).  Saving model ...
Epoch: 5 cost time: 0.3814377784729004
Epoch: 5, Steps: 3 | Train Loss: 1.005 Vali Loss: 1.087 Vali Acc: 0.600 Test Loss: 1.087 Test Acc: 0.600
Validation loss decreased (-0.524988 --> -0.599989).  Saving model ...
Epoch: 6 cost time: 0.47272419929504395
Epoch: 6, Steps: 3 | Train Loss: 0.935 Vali Loss: 1.006 Vali Acc: 0.625 Test Loss: 1.006 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624990).  Saving model ...
Epoch: 7 cost time: 0.3798868656158447
Epoch: 7, Steps: 3 | Train Loss: 0.832 Vali Loss: 0.928 Vali Acc: 0.700 Test Loss: 0.928 Test Acc: 0.700
Validation loss decreased (-0.624990 --> -0.699991).  Saving model ...
Epoch: 8 cost time: 0.38376450538635254
Epoch: 8, Steps: 3 | Train Loss: 0.729 Vali Loss: 0.865 Vali Acc: 0.750 Test Loss: 0.865 Test Acc: 0.750
Validation loss decreased (-0.699991 --> -0.749991).  Saving model ...
Epoch: 9 cost time: 0.4539644718170166
Epoch: 9, Steps: 3 | Train Loss: 0.685 Vali Loss: 0.791 Vali Acc: 0.775 Test Loss: 0.791 Test Acc: 0.775
Validation loss decreased (-0.749991 --> -0.774992).  Saving model ...
Epoch: 10 cost time: 0.3830275535583496
Epoch: 10, Steps: 3 | Train Loss: 0.583 Vali Loss: 0.716 Vali Acc: 0.850 Test Loss: 0.716 Test Acc: 0.850
Validation loss decreased (-0.774992 --> -0.849993).  Saving model ...
Epoch: 11 cost time: 0.5430448055267334
Epoch: 11, Steps: 3 | Train Loss: 0.552 Vali Loss: 0.642 Vali Acc: 0.950 Test Loss: 0.642 Test Acc: 0.950
Validation loss decreased (-0.849993 --> -0.949994).  Saving model ...
Epoch: 12 cost time: 0.39745259284973145
Epoch: 12, Steps: 3 | Train Loss: 0.496 Vali Loss: 0.584 Vali Acc: 0.950 Test Loss: 0.584 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949994).  Saving model ...
Epoch: 13 cost time: 0.3954756259918213
Epoch: 13, Steps: 3 | Train Loss: 0.422 Vali Loss: 0.523 Vali Acc: 0.950 Test Loss: 0.523 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 14 cost time: 0.44934535026550293
Epoch: 14, Steps: 3 | Train Loss: 0.363 Vali Loss: 0.468 Vali Acc: 0.975 Test Loss: 0.468 Test Acc: 0.975
Validation loss decreased (-0.949995 --> -0.974995).  Saving model ...
Epoch: 15 cost time: 0.44649672508239746
Epoch: 15, Steps: 3 | Train Loss: 0.329 Vali Loss: 0.421 Vali Acc: 0.975 Test Loss: 0.421 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 16 cost time: 0.45546460151672363
Epoch: 16, Steps: 3 | Train Loss: 0.309 Vali Loss: 0.390 Vali Acc: 0.975 Test Loss: 0.390 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 17 cost time: 0.4659731388092041
Epoch: 17, Steps: 3 | Train Loss: 0.277 Vali Loss: 0.363 Vali Acc: 0.975 Test Loss: 0.363 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 18 cost time: 0.4687380790710449
Epoch: 18, Steps: 3 | Train Loss: 0.244 Vali Loss: 0.338 Vali Acc: 0.975 Test Loss: 0.338 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 19 cost time: 0.4486043453216553
Epoch: 19, Steps: 3 | Train Loss: 0.223 Vali Loss: 0.327 Vali Acc: 0.975 Test Loss: 0.327 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 20 cost time: 0.4671354293823242
Epoch: 20, Steps: 3 | Train Loss: 0.218 Vali Loss: 0.314 Vali Acc: 0.975 Test Loss: 0.314 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 21 cost time: 0.47460460662841797
Epoch: 21, Steps: 3 | Train Loss: 0.179 Vali Loss: 0.292 Vali Acc: 0.975 Test Loss: 0.292 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 22 cost time: 0.4289054870605469
Epoch: 22, Steps: 3 | Train Loss: 0.188 Vali Loss: 0.278 Vali Acc: 0.975 Test Loss: 0.278 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 23 cost time: 0.4666483402252197
Epoch: 23, Steps: 3 | Train Loss: 0.152 Vali Loss: 0.265 Vali Acc: 0.975 Test Loss: 0.265 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 24 cost time: 0.44871997833251953
Epoch: 24, Steps: 3 | Train Loss: 0.137 Vali Loss: 0.259 Vali Acc: 0.975 Test Loss: 0.259 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 25 cost time: 0.5959782600402832
Epoch: 25, Steps: 3 | Train Loss: 0.128 Vali Loss: 0.244 Vali Acc: 0.975 Test Loss: 0.244 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 26 cost time: 0.4603719711303711
Epoch: 26, Steps: 3 | Train Loss: 0.135 Vali Loss: 0.231 Vali Acc: 0.975 Test Loss: 0.231 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 27 cost time: 0.46849703788757324
Epoch: 27, Steps: 3 | Train Loss: 0.106 Vali Loss: 0.217 Vali Acc: 0.975 Test Loss: 0.217 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 28 cost time: 0.4905366897583008
Epoch: 28, Steps: 3 | Train Loss: 0.111 Vali Loss: 0.214 Vali Acc: 0.975 Test Loss: 0.214 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 29 cost time: 0.5010719299316406
Epoch: 29, Steps: 3 | Train Loss: 0.102 Vali Loss: 0.211 Vali Acc: 0.975 Test Loss: 0.211 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 30 cost time: 0.43115949630737305
Epoch: 30, Steps: 3 | Train Loss: 0.090 Vali Loss: 0.206 Vali Acc: 0.975 Test Loss: 0.206 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 31 cost time: 0.44199681282043457
Epoch: 31, Steps: 3 | Train Loss: 0.078 Vali Loss: 0.205 Vali Acc: 0.975 Test Loss: 0.205 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 32 cost time: 0.40152597427368164
Epoch: 32, Steps: 3 | Train Loss: 0.076 Vali Loss: 0.202 Vali Acc: 0.975 Test Loss: 0.202 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 33 cost time: 0.41649389266967773
Epoch: 33, Steps: 3 | Train Loss: 0.068 Vali Loss: 0.199 Vali Acc: 0.975 Test Loss: 0.199 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 34 cost time: 0.4111673831939697
Epoch: 34, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.186 Vali Acc: 0.975 Test Loss: 0.186 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 35 cost time: 0.4232292175292969
Epoch: 35, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.180 Vali Acc: 0.975 Test Loss: 0.180 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 36 cost time: 0.46549272537231445
Epoch: 36, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.172 Vali Acc: 0.975 Test Loss: 0.172 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 37 cost time: 0.4247865676879883
Epoch: 37, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.173 Vali Acc: 0.975 Test Loss: 0.173 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.5196676254272461
Epoch: 38, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.173 Vali Acc: 0.975 Test Loss: 0.173 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.4702329635620117
Epoch: 39, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.175 Vali Acc: 0.975 Test Loss: 0.175 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.5699293613433838
Epoch: 40, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.172 Vali Acc: 0.975 Test Loss: 0.172 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 41 cost time: 0.44330477714538574
Epoch: 41, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.166 Vali Acc: 0.975 Test Loss: 0.166 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 42 cost time: 0.5444216728210449
Epoch: 42, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.163 Vali Acc: 0.975 Test Loss: 0.163 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 43 cost time: 0.45856595039367676
Epoch: 43, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.161 Vali Acc: 0.975 Test Loss: 0.161 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 44 cost time: 0.45794129371643066
Epoch: 44, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.160 Vali Acc: 0.975 Test Loss: 0.160 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 45 cost time: 0.43549466133117676
Epoch: 45, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.155 Vali Acc: 0.975 Test Loss: 0.155 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 46 cost time: 0.502631425857544
Epoch: 46, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.147 Vali Acc: 0.975 Test Loss: 0.147 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974999).  Saving model ...
Epoch: 47 cost time: 0.4797050952911377
Epoch: 47, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.150 Vali Acc: 0.975 Test Loss: 0.150 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.5133192539215088
Epoch: 48, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.144 Vali Acc: 0.975 Test Loss: 0.144 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 49 cost time: 0.5090105533599854
Epoch: 49, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.137 Vali Acc: 0.975 Test Loss: 0.137 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 50 cost time: 0.45099592208862305
Epoch: 50, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.132 Vali Acc: 0.975 Test Loss: 0.132 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps25_str13_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 873220
model size : 3.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.8059039115905762
Epoch: 1, Steps: 3 | Train Loss: 1.344 Vali Loss: 1.361 Vali Acc: 0.250 Test Loss: 1.361 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 0.4426076412200928
Epoch: 2, Steps: 3 | Train Loss: 1.168 Vali Loss: 1.278 Vali Acc: 0.375 Test Loss: 1.278 Test Acc: 0.375
Validation loss decreased (-0.249986 --> -0.374987).  Saving model ...
Epoch: 3 cost time: 0.3802642822265625
Epoch: 3, Steps: 3 | Train Loss: 1.028 Vali Loss: 1.149 Vali Acc: 0.550 Test Loss: 1.149 Test Acc: 0.550
Validation loss decreased (-0.374987 --> -0.549989).  Saving model ...
Epoch: 4 cost time: 0.4445016384124756
Epoch: 4, Steps: 3 | Train Loss: 0.855 Vali Loss: 1.007 Vali Acc: 0.625 Test Loss: 1.007 Test Acc: 0.625
Validation loss decreased (-0.549989 --> -0.624990).  Saving model ...
Epoch: 5 cost time: 0.40561461448669434
Epoch: 5, Steps: 3 | Train Loss: 0.714 Vali Loss: 0.868 Vali Acc: 0.775 Test Loss: 0.868 Test Acc: 0.775
Validation loss decreased (-0.624990 --> -0.774991).  Saving model ...
Epoch: 6 cost time: 0.4483358860015869
Epoch: 6, Steps: 3 | Train Loss: 0.592 Vali Loss: 0.733 Vali Acc: 0.850 Test Loss: 0.733 Test Acc: 0.850
Validation loss decreased (-0.774991 --> -0.849993).  Saving model ...
Epoch: 7 cost time: 0.3763291835784912
Epoch: 7, Steps: 3 | Train Loss: 0.453 Vali Loss: 0.602 Vali Acc: 0.950 Test Loss: 0.602 Test Acc: 0.950
Validation loss decreased (-0.849993 --> -0.949994).  Saving model ...
Epoch: 8 cost time: 0.37762904167175293
Epoch: 8, Steps: 3 | Train Loss: 0.386 Vali Loss: 0.489 Vali Acc: 0.975 Test Loss: 0.489 Test Acc: 0.975
Validation loss decreased (-0.949994 --> -0.974995).  Saving model ...
Epoch: 9 cost time: 0.3524658679962158
Epoch: 9, Steps: 3 | Train Loss: 0.276 Vali Loss: 0.404 Vali Acc: 0.975 Test Loss: 0.404 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 10 cost time: 0.4718592166900635
Epoch: 10, Steps: 3 | Train Loss: 0.230 Vali Loss: 0.350 Vali Acc: 0.975 Test Loss: 0.350 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 11 cost time: 0.38919758796691895
Epoch: 11, Steps: 3 | Train Loss: 0.171 Vali Loss: 0.324 Vali Acc: 0.950 Test Loss: 0.324 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.3816239833831787
Epoch: 12, Steps: 3 | Train Loss: 0.135 Vali Loss: 0.307 Vali Acc: 0.950 Test Loss: 0.307 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.3565998077392578
Epoch: 13, Steps: 3 | Train Loss: 0.119 Vali Loss: 0.307 Vali Acc: 0.950 Test Loss: 0.307 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.41710567474365234
Epoch: 14, Steps: 3 | Train Loss: 0.116 Vali Loss: 0.314 Vali Acc: 0.950 Test Loss: 0.314 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.5279719829559326
Epoch: 15, Steps: 3 | Train Loss: 0.097 Vali Loss: 0.331 Vali Acc: 0.925 Test Loss: 0.331 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.4928004741668701
Epoch: 16, Steps: 3 | Train Loss: 0.073 Vali Loss: 0.347 Vali Acc: 0.900 Test Loss: 0.347 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.44124889373779297
Epoch: 17, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.355 Vali Acc: 0.900 Test Loss: 0.355 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.4157261848449707
Epoch: 18, Steps: 3 | Train Loss: 0.055 Vali Loss: 0.360 Vali Acc: 0.900 Test Loss: 0.360 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.46546030044555664
Epoch: 19, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.357 Vali Acc: 0.900 Test Loss: 0.357 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.5509483814239502
Epoch: 20, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.353 Vali Acc: 0.925 Test Loss: 0.353 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 304644
model size : 1.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.6842033863067627
Epoch: 1, Steps: 3 | Train Loss: 1.419 Vali Loss: 1.342 Vali Acc: 0.350 Test Loss: 1.342 Test Acc: 0.350
Validation loss decreased (inf --> -0.349987).  Saving model ...
Epoch: 2 cost time: 0.41904425621032715
Epoch: 2, Steps: 3 | Train Loss: 1.276 Vali Loss: 1.260 Vali Acc: 0.425 Test Loss: 1.260 Test Acc: 0.425
Validation loss decreased (-0.349987 --> -0.424987).  Saving model ...
Epoch: 3 cost time: 0.44605422019958496
Epoch: 3, Steps: 3 | Train Loss: 1.182 Vali Loss: 1.138 Vali Acc: 0.500 Test Loss: 1.138 Test Acc: 0.500
Validation loss decreased (-0.424987 --> -0.499989).  Saving model ...
Epoch: 4 cost time: 0.4979262351989746
Epoch: 4, Steps: 3 | Train Loss: 0.964 Vali Loss: 1.000 Vali Acc: 0.700 Test Loss: 1.000 Test Acc: 0.700
Validation loss decreased (-0.499989 --> -0.699990).  Saving model ...
Epoch: 5 cost time: 0.45058369636535645
Epoch: 5, Steps: 3 | Train Loss: 0.876 Vali Loss: 0.867 Vali Acc: 0.775 Test Loss: 0.867 Test Acc: 0.775
Validation loss decreased (-0.699990 --> -0.774991).  Saving model ...
Epoch: 6 cost time: 0.42098522186279297
Epoch: 6, Steps: 3 | Train Loss: 0.707 Vali Loss: 0.755 Vali Acc: 0.800 Test Loss: 0.755 Test Acc: 0.800
Validation loss decreased (-0.774991 --> -0.799992).  Saving model ...
Epoch: 7 cost time: 0.3876681327819824
Epoch: 7, Steps: 3 | Train Loss: 0.605 Vali Loss: 0.648 Vali Acc: 0.925 Test Loss: 0.648 Test Acc: 0.925
Validation loss decreased (-0.799992 --> -0.924994).  Saving model ...
Epoch: 8 cost time: 0.43292880058288574
Epoch: 8, Steps: 3 | Train Loss: 0.557 Vali Loss: 0.552 Vali Acc: 0.925 Test Loss: 0.552 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 9 cost time: 0.4260532855987549
Epoch: 9, Steps: 3 | Train Loss: 0.450 Vali Loss: 0.466 Vali Acc: 0.950 Test Loss: 0.466 Test Acc: 0.950
Validation loss decreased (-0.924994 --> -0.949995).  Saving model ...
Epoch: 10 cost time: 0.4246947765350342
Epoch: 10, Steps: 3 | Train Loss: 0.341 Vali Loss: 0.392 Vali Acc: 0.975 Test Loss: 0.392 Test Acc: 0.975
Validation loss decreased (-0.949995 --> -0.974996).  Saving model ...
Epoch: 11 cost time: 0.4523637294769287
Epoch: 11, Steps: 3 | Train Loss: 0.290 Vali Loss: 0.344 Vali Acc: 0.975 Test Loss: 0.344 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 12 cost time: 0.41889405250549316
Epoch: 12, Steps: 3 | Train Loss: 0.229 Vali Loss: 0.310 Vali Acc: 0.950 Test Loss: 0.310 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.3784477710723877
Epoch: 13, Steps: 3 | Train Loss: 0.190 Vali Loss: 0.289 Vali Acc: 0.950 Test Loss: 0.289 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.490541934967041
Epoch: 14, Steps: 3 | Train Loss: 0.162 Vali Loss: 0.273 Vali Acc: 0.975 Test Loss: 0.273 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 15 cost time: 0.39325618743896484
Epoch: 15, Steps: 3 | Train Loss: 0.136 Vali Loss: 0.258 Vali Acc: 0.950 Test Loss: 0.258 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.42415428161621094
Epoch: 16, Steps: 3 | Train Loss: 0.118 Vali Loss: 0.253 Vali Acc: 0.950 Test Loss: 0.253 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.35598134994506836
Epoch: 17, Steps: 3 | Train Loss: 0.094 Vali Loss: 0.250 Vali Acc: 0.950 Test Loss: 0.250 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.41409993171691895
Epoch: 18, Steps: 3 | Train Loss: 0.117 Vali Loss: 0.245 Vali Acc: 0.950 Test Loss: 0.245 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.36278653144836426
Epoch: 19, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.232 Vali Acc: 0.950 Test Loss: 0.232 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.4624626636505127
Epoch: 20, Steps: 3 | Train Loss: 0.075 Vali Loss: 0.224 Vali Acc: 0.950 Test Loss: 0.224 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.41051340103149414
Epoch: 21, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.218 Vali Acc: 0.950 Test Loss: 0.218 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.4206366539001465
Epoch: 22, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.210 Vali Acc: 0.950 Test Loss: 0.210 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.4697301387786865
Epoch: 23, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.206 Vali Acc: 0.950 Test Loss: 0.206 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.39960360527038574
Epoch: 24, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.206 Vali Acc: 0.950 Test Loss: 0.206 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 278660
model size : 1.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.676865816116333
Epoch: 1, Steps: 3 | Train Loss: 1.409 Vali Loss: 1.353 Vali Acc: 0.300 Test Loss: 1.353 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 0.43375086784362793
Epoch: 2, Steps: 3 | Train Loss: 1.238 Vali Loss: 1.299 Vali Acc: 0.400 Test Loss: 1.299 Test Acc: 0.400
Validation loss decreased (-0.299986 --> -0.399987).  Saving model ...
Epoch: 3 cost time: 0.4892911911010742
Epoch: 3, Steps: 3 | Train Loss: 1.164 Vali Loss: 1.211 Vali Acc: 0.425 Test Loss: 1.211 Test Acc: 0.425
Validation loss decreased (-0.399987 --> -0.424988).  Saving model ...
Epoch: 4 cost time: 0.4479696750640869
Epoch: 4, Steps: 3 | Train Loss: 0.991 Vali Loss: 1.099 Vali Acc: 0.575 Test Loss: 1.099 Test Acc: 0.575
Validation loss decreased (-0.424988 --> -0.574989).  Saving model ...
Epoch: 5 cost time: 0.4079253673553467
Epoch: 5, Steps: 3 | Train Loss: 0.876 Vali Loss: 0.979 Vali Acc: 0.675 Test Loss: 0.979 Test Acc: 0.675
Validation loss decreased (-0.574989 --> -0.674990).  Saving model ...
Epoch: 6 cost time: 0.42606544494628906
Epoch: 6, Steps: 3 | Train Loss: 0.756 Vali Loss: 0.865 Vali Acc: 0.775 Test Loss: 0.865 Test Acc: 0.775
Validation loss decreased (-0.674990 --> -0.774991).  Saving model ...
Epoch: 7 cost time: 0.39860010147094727
Epoch: 7, Steps: 3 | Train Loss: 0.648 Vali Loss: 0.760 Vali Acc: 0.900 Test Loss: 0.760 Test Acc: 0.900
Validation loss decreased (-0.774991 --> -0.899992).  Saving model ...
Epoch: 8 cost time: 0.39937663078308105
Epoch: 8, Steps: 3 | Train Loss: 0.551 Vali Loss: 0.666 Vali Acc: 0.975 Test Loss: 0.666 Test Acc: 0.975
Validation loss decreased (-0.899992 --> -0.974993).  Saving model ...
Epoch: 9 cost time: 0.3613731861114502
Epoch: 9, Steps: 3 | Train Loss: 0.477 Vali Loss: 0.583 Vali Acc: 0.975 Test Loss: 0.583 Test Acc: 0.975
Validation loss decreased (-0.974993 --> -0.974994).  Saving model ...
Epoch: 10 cost time: 0.4793238639831543
Epoch: 10, Steps: 3 | Train Loss: 0.413 Vali Loss: 0.505 Vali Acc: 0.975 Test Loss: 0.505 Test Acc: 0.975
Validation loss decreased (-0.974994 --> -0.974995).  Saving model ...
Epoch: 11 cost time: 0.3762979507446289
Epoch: 11, Steps: 3 | Train Loss: 0.358 Vali Loss: 0.437 Vali Acc: 0.975 Test Loss: 0.437 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 12 cost time: 0.43776607513427734
Epoch: 12, Steps: 3 | Train Loss: 0.320 Vali Loss: 0.381 Vali Acc: 0.975 Test Loss: 0.381 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 13 cost time: 0.3601851463317871
Epoch: 13, Steps: 3 | Train Loss: 0.264 Vali Loss: 0.341 Vali Acc: 0.975 Test Loss: 0.341 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 14 cost time: 0.3375239372253418
Epoch: 14, Steps: 3 | Train Loss: 0.229 Vali Loss: 0.311 Vali Acc: 0.975 Test Loss: 0.311 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 15 cost time: 0.4326038360595703
Epoch: 15, Steps: 3 | Train Loss: 0.218 Vali Loss: 0.286 Vali Acc: 0.975 Test Loss: 0.286 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 16 cost time: 0.4392819404602051
Epoch: 16, Steps: 3 | Train Loss: 0.176 Vali Loss: 0.264 Vali Acc: 0.975 Test Loss: 0.264 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 17 cost time: 0.3680243492126465
Epoch: 17, Steps: 3 | Train Loss: 0.163 Vali Loss: 0.246 Vali Acc: 0.975 Test Loss: 0.246 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 18 cost time: 0.3576388359069824
Epoch: 18, Steps: 3 | Train Loss: 0.144 Vali Loss: 0.230 Vali Acc: 0.975 Test Loss: 0.230 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 19 cost time: 0.3800699710845947
Epoch: 19, Steps: 3 | Train Loss: 0.143 Vali Loss: 0.223 Vali Acc: 0.975 Test Loss: 0.223 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 20 cost time: 0.38596248626708984
Epoch: 20, Steps: 3 | Train Loss: 0.117 Vali Loss: 0.217 Vali Acc: 0.950 Test Loss: 0.217 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.3473503589630127
Epoch: 21, Steps: 3 | Train Loss: 0.105 Vali Loss: 0.213 Vali Acc: 0.950 Test Loss: 0.213 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.4262096881866455
Epoch: 22, Steps: 3 | Train Loss: 0.098 Vali Loss: 0.215 Vali Acc: 0.950 Test Loss: 0.215 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.4416682720184326
Epoch: 23, Steps: 3 | Train Loss: 0.085 Vali Loss: 0.220 Vali Acc: 0.950 Test Loss: 0.220 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.4106161594390869
Epoch: 24, Steps: 3 | Train Loss: 0.074 Vali Loss: 0.206 Vali Acc: 0.950 Test Loss: 0.206 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.43303370475769043
Epoch: 25, Steps: 3 | Train Loss: 0.070 Vali Loss: 0.200 Vali Acc: 0.950 Test Loss: 0.200 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.38439083099365234
Epoch: 26, Steps: 3 | Train Loss: 0.063 Vali Loss: 0.192 Vali Acc: 0.950 Test Loss: 0.192 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.4254422187805176
Epoch: 27, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.183 Vali Acc: 0.950 Test Loss: 0.183 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.4524374008178711
Epoch: 28, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.180 Vali Acc: 0.950 Test Loss: 0.180 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.4443376064300537
Epoch: 29, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.176 Vali Acc: 0.950 Test Loss: 0.176 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 266564
model size : 1.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.7057433128356934
Epoch: 1, Steps: 3 | Train Loss: 1.501 Vali Loss: 1.370 Vali Acc: 0.375 Test Loss: 1.370 Test Acc: 0.375
Validation loss decreased (inf --> -0.374986).  Saving model ...
Epoch: 2 cost time: 0.3906693458557129
Epoch: 2, Steps: 3 | Train Loss: 1.374 Vali Loss: 1.315 Vali Acc: 0.450 Test Loss: 1.315 Test Acc: 0.450
Validation loss decreased (-0.374986 --> -0.449987).  Saving model ...
Epoch: 3 cost time: 0.42910051345825195
Epoch: 3, Steps: 3 | Train Loss: 1.302 Vali Loss: 1.229 Vali Acc: 0.475 Test Loss: 1.229 Test Acc: 0.475
Validation loss decreased (-0.449987 --> -0.474988).  Saving model ...
Epoch: 4 cost time: 0.4288299083709717
Epoch: 4, Steps: 3 | Train Loss: 1.139 Vali Loss: 1.120 Vali Acc: 0.550 Test Loss: 1.120 Test Acc: 0.550
Validation loss decreased (-0.474988 --> -0.549989).  Saving model ...
Epoch: 5 cost time: 0.49536967277526855
Epoch: 5, Steps: 3 | Train Loss: 1.042 Vali Loss: 1.005 Vali Acc: 0.650 Test Loss: 1.005 Test Acc: 0.650
Validation loss decreased (-0.549989 --> -0.649990).  Saving model ...
Epoch: 6 cost time: 0.47321629524230957
Epoch: 6, Steps: 3 | Train Loss: 0.890 Vali Loss: 0.899 Vali Acc: 0.725 Test Loss: 0.899 Test Acc: 0.725
Validation loss decreased (-0.649990 --> -0.724991).  Saving model ...
Epoch: 7 cost time: 0.41989827156066895
Epoch: 7, Steps: 3 | Train Loss: 0.778 Vali Loss: 0.807 Vali Acc: 0.725 Test Loss: 0.807 Test Acc: 0.725
Validation loss decreased (-0.724991 --> -0.724992).  Saving model ...
Epoch: 8 cost time: 0.4237537384033203
Epoch: 8, Steps: 3 | Train Loss: 0.678 Vali Loss: 0.724 Vali Acc: 0.800 Test Loss: 0.724 Test Acc: 0.800
Validation loss decreased (-0.724992 --> -0.799993).  Saving model ...
Epoch: 9 cost time: 0.5045948028564453
Epoch: 9, Steps: 3 | Train Loss: 0.605 Vali Loss: 0.641 Vali Acc: 0.925 Test Loss: 0.641 Test Acc: 0.925
Validation loss decreased (-0.799993 --> -0.924994).  Saving model ...
Epoch: 10 cost time: 0.37830162048339844
Epoch: 10, Steps: 3 | Train Loss: 0.552 Vali Loss: 0.563 Vali Acc: 0.975 Test Loss: 0.563 Test Acc: 0.975
Validation loss decreased (-0.924994 --> -0.974994).  Saving model ...
Epoch: 11 cost time: 0.5486340522766113
Epoch: 11, Steps: 3 | Train Loss: 0.447 Vali Loss: 0.496 Vali Acc: 0.975 Test Loss: 0.496 Test Acc: 0.975
Validation loss decreased (-0.974994 --> -0.974995).  Saving model ...
Epoch: 12 cost time: 0.4067983627319336
Epoch: 12, Steps: 3 | Train Loss: 0.401 Vali Loss: 0.439 Vali Acc: 0.975 Test Loss: 0.439 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 13 cost time: 0.4532482624053955
Epoch: 13, Steps: 3 | Train Loss: 0.331 Vali Loss: 0.389 Vali Acc: 0.975 Test Loss: 0.389 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 14 cost time: 0.4370265007019043
Epoch: 14, Steps: 3 | Train Loss: 0.302 Vali Loss: 0.349 Vali Acc: 0.975 Test Loss: 0.349 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 15 cost time: 0.39754295349121094
Epoch: 15, Steps: 3 | Train Loss: 0.283 Vali Loss: 0.310 Vali Acc: 0.975 Test Loss: 0.310 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 16 cost time: 0.36336755752563477
Epoch: 16, Steps: 3 | Train Loss: 0.242 Vali Loss: 0.290 Vali Acc: 0.975 Test Loss: 0.290 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 17 cost time: 0.35936665534973145
Epoch: 17, Steps: 3 | Train Loss: 0.212 Vali Loss: 0.263 Vali Acc: 0.975 Test Loss: 0.263 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 18 cost time: 0.38651585578918457
Epoch: 18, Steps: 3 | Train Loss: 0.178 Vali Loss: 0.248 Vali Acc: 0.975 Test Loss: 0.248 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 19 cost time: 0.4241828918457031
Epoch: 19, Steps: 3 | Train Loss: 0.191 Vali Loss: 0.239 Vali Acc: 0.975 Test Loss: 0.239 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 20 cost time: 0.41167569160461426
Epoch: 20, Steps: 3 | Train Loss: 0.161 Vali Loss: 0.235 Vali Acc: 0.975 Test Loss: 0.235 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 21 cost time: 0.4029572010040283
Epoch: 21, Steps: 3 | Train Loss: 0.128 Vali Loss: 0.228 Vali Acc: 0.975 Test Loss: 0.228 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 22 cost time: 0.489652156829834
Epoch: 22, Steps: 3 | Train Loss: 0.136 Vali Loss: 0.233 Vali Acc: 0.950 Test Loss: 0.233 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.393298864364624
Epoch: 23, Steps: 3 | Train Loss: 0.097 Vali Loss: 0.223 Vali Acc: 0.950 Test Loss: 0.223 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.4264190196990967
Epoch: 24, Steps: 3 | Train Loss: 0.102 Vali Loss: 0.224 Vali Acc: 0.950 Test Loss: 0.224 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.4022362232208252
Epoch: 25, Steps: 3 | Train Loss: 0.097 Vali Loss: 0.226 Vali Acc: 0.950 Test Loss: 0.226 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.3916809558868408
Epoch: 26, Steps: 3 | Train Loss: 0.078 Vali Loss: 0.217 Vali Acc: 0.950 Test Loss: 0.217 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.3885955810546875
Epoch: 27, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.209 Vali Acc: 0.950 Test Loss: 0.209 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.44191455841064453
Epoch: 28, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.203 Vali Acc: 0.950 Test Loss: 0.203 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.38121700286865234
Epoch: 29, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.198 Vali Acc: 0.950 Test Loss: 0.198 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.38666510581970215
Epoch: 30, Steps: 3 | Train Loss: 0.068 Vali Loss: 0.198 Vali Acc: 0.950 Test Loss: 0.198 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.3622169494628906
Epoch: 31, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.196 Vali Acc: 0.950 Test Loss: 0.196 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 259012
model size : 1.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.6752569675445557
Epoch: 1, Steps: 3 | Train Loss: 1.468 Vali Loss: 1.398 Vali Acc: 0.400 Test Loss: 1.398 Test Acc: 0.400
Validation loss decreased (inf --> -0.399986).  Saving model ...
Epoch: 2 cost time: 0.41257214546203613
Epoch: 2, Steps: 3 | Train Loss: 1.370 Vali Loss: 1.362 Vali Acc: 0.425 Test Loss: 1.362 Test Acc: 0.425
Validation loss decreased (-0.399986 --> -0.424986).  Saving model ...
Epoch: 3 cost time: 0.47061753273010254
Epoch: 3, Steps: 3 | Train Loss: 1.273 Vali Loss: 1.312 Vali Acc: 0.525 Test Loss: 1.312 Test Acc: 0.525
Validation loss decreased (-0.424986 --> -0.524987).  Saving model ...
Epoch: 4 cost time: 0.44091224670410156
Epoch: 4, Steps: 3 | Train Loss: 1.184 Vali Loss: 1.241 Vali Acc: 0.600 Test Loss: 1.241 Test Acc: 0.600
Validation loss decreased (-0.524987 --> -0.599988).  Saving model ...
Epoch: 5 cost time: 0.4523591995239258
Epoch: 5, Steps: 3 | Train Loss: 1.085 Vali Loss: 1.163 Vali Acc: 0.700 Test Loss: 1.163 Test Acc: 0.700
Validation loss decreased (-0.599988 --> -0.699988).  Saving model ...
Epoch: 6 cost time: 0.4778165817260742
Epoch: 6, Steps: 3 | Train Loss: 1.012 Vali Loss: 1.083 Vali Acc: 0.725 Test Loss: 1.083 Test Acc: 0.725
Validation loss decreased (-0.699988 --> -0.724989).  Saving model ...
Epoch: 7 cost time: 0.4353983402252197
Epoch: 7, Steps: 3 | Train Loss: 0.926 Vali Loss: 1.007 Vali Acc: 0.750 Test Loss: 1.007 Test Acc: 0.750
Validation loss decreased (-0.724989 --> -0.749990).  Saving model ...
Epoch: 8 cost time: 0.40670084953308105
Epoch: 8, Steps: 3 | Train Loss: 0.852 Vali Loss: 0.930 Vali Acc: 0.875 Test Loss: 0.930 Test Acc: 0.875
Validation loss decreased (-0.749990 --> -0.874991).  Saving model ...
Epoch: 9 cost time: 0.4070916175842285
Epoch: 9, Steps: 3 | Train Loss: 0.775 Vali Loss: 0.864 Vali Acc: 0.850 Test Loss: 0.864 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.4350011348724365
Epoch: 10, Steps: 3 | Train Loss: 0.735 Vali Loss: 0.803 Vali Acc: 0.850 Test Loss: 0.803 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.4436154365539551
Epoch: 11, Steps: 3 | Train Loss: 0.669 Vali Loss: 0.744 Vali Acc: 0.850 Test Loss: 0.744 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.3774573802947998
Epoch: 12, Steps: 3 | Train Loss: 0.597 Vali Loss: 0.687 Vali Acc: 0.875 Test Loss: 0.687 Test Acc: 0.875
Validation loss decreased (-0.874991 --> -0.874993).  Saving model ...
Epoch: 13 cost time: 0.43141889572143555
Epoch: 13, Steps: 3 | Train Loss: 0.513 Vali Loss: 0.640 Vali Acc: 0.925 Test Loss: 0.640 Test Acc: 0.925
Validation loss decreased (-0.874993 --> -0.924994).  Saving model ...
Epoch: 14 cost time: 0.40728116035461426
Epoch: 14, Steps: 3 | Train Loss: 0.481 Vali Loss: 0.599 Vali Acc: 0.925 Test Loss: 0.599 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 15 cost time: 0.46309947967529297
Epoch: 15, Steps: 3 | Train Loss: 0.444 Vali Loss: 0.559 Vali Acc: 0.925 Test Loss: 0.559 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 16 cost time: 0.5106844902038574
Epoch: 16, Steps: 3 | Train Loss: 0.414 Vali Loss: 0.521 Vali Acc: 0.925 Test Loss: 0.521 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 17 cost time: 0.4179050922393799
Epoch: 17, Steps: 3 | Train Loss: 0.384 Vali Loss: 0.486 Vali Acc: 0.925 Test Loss: 0.486 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 18 cost time: 0.43988895416259766
Epoch: 18, Steps: 3 | Train Loss: 0.327 Vali Loss: 0.462 Vali Acc: 0.925 Test Loss: 0.462 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 19 cost time: 0.3816092014312744
Epoch: 19, Steps: 3 | Train Loss: 0.289 Vali Loss: 0.445 Vali Acc: 0.925 Test Loss: 0.445 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 20 cost time: 0.4132978916168213
Epoch: 20, Steps: 3 | Train Loss: 0.274 Vali Loss: 0.423 Vali Acc: 0.925 Test Loss: 0.423 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 21 cost time: 0.45226478576660156
Epoch: 21, Steps: 3 | Train Loss: 0.247 Vali Loss: 0.402 Vali Acc: 0.925 Test Loss: 0.402 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 22 cost time: 0.39592766761779785
Epoch: 22, Steps: 3 | Train Loss: 0.266 Vali Loss: 0.385 Vali Acc: 0.925 Test Loss: 0.385 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 23 cost time: 0.42258262634277344
Epoch: 23, Steps: 3 | Train Loss: 0.219 Vali Loss: 0.375 Vali Acc: 0.925 Test Loss: 0.375 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 24 cost time: 0.37267208099365234
Epoch: 24, Steps: 3 | Train Loss: 0.178 Vali Loss: 0.359 Vali Acc: 0.925 Test Loss: 0.359 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 25 cost time: 0.41411519050598145
Epoch: 25, Steps: 3 | Train Loss: 0.167 Vali Loss: 0.342 Vali Acc: 0.950 Test Loss: 0.342 Test Acc: 0.950
Validation loss decreased (-0.924996 --> -0.949997).  Saving model ...
Epoch: 26 cost time: 0.4677455425262451
Epoch: 26, Steps: 3 | Train Loss: 0.170 Vali Loss: 0.337 Vali Acc: 0.950 Test Loss: 0.337 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 27 cost time: 0.44652652740478516
Epoch: 27, Steps: 3 | Train Loss: 0.157 Vali Loss: 0.330 Vali Acc: 0.950 Test Loss: 0.330 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 28 cost time: 0.46573376655578613
Epoch: 28, Steps: 3 | Train Loss: 0.153 Vali Loss: 0.327 Vali Acc: 0.950 Test Loss: 0.327 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 29 cost time: 0.4845423698425293
Epoch: 29, Steps: 3 | Train Loss: 0.132 Vali Loss: 0.316 Vali Acc: 0.950 Test Loss: 0.316 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 30 cost time: 0.45652008056640625
Epoch: 30, Steps: 3 | Train Loss: 0.140 Vali Loss: 0.308 Vali Acc: 0.950 Test Loss: 0.308 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 31 cost time: 0.3949856758117676
Epoch: 31, Steps: 3 | Train Loss: 0.136 Vali Loss: 0.303 Vali Acc: 0.950 Test Loss: 0.303 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 32 cost time: 0.39896106719970703
Epoch: 32, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.303 Vali Acc: 0.950 Test Loss: 0.303 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 33 cost time: 0.47055625915527344
Epoch: 33, Steps: 3 | Train Loss: 0.089 Vali Loss: 0.289 Vali Acc: 0.950 Test Loss: 0.289 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 34 cost time: 0.43798279762268066
Epoch: 34, Steps: 3 | Train Loss: 0.111 Vali Loss: 0.288 Vali Acc: 0.950 Test Loss: 0.288 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 35 cost time: 0.43442416191101074
Epoch: 35, Steps: 3 | Train Loss: 0.081 Vali Loss: 0.279 Vali Acc: 0.950 Test Loss: 0.279 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 36 cost time: 0.4599783420562744
Epoch: 36, Steps: 3 | Train Loss: 0.099 Vali Loss: 0.280 Vali Acc: 0.950 Test Loss: 0.280 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.39501285552978516
Epoch: 37, Steps: 3 | Train Loss: 0.082 Vali Loss: 0.275 Vali Acc: 0.950 Test Loss: 0.275 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 38 cost time: 0.4856724739074707
Epoch: 38, Steps: 3 | Train Loss: 0.081 Vali Loss: 0.277 Vali Acc: 0.950 Test Loss: 0.277 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.46323108673095703
Epoch: 39, Steps: 3 | Train Loss: 0.074 Vali Loss: 0.275 Vali Acc: 0.950 Test Loss: 0.275 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.5573248863220215
Epoch: 40, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.270 Vali Acc: 0.950 Test Loss: 0.270 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 41 cost time: 0.396437406539917
Epoch: 41, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.276 Vali Acc: 0.925 Test Loss: 0.276 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.5054848194122314
Epoch: 42, Steps: 3 | Train Loss: 0.061 Vali Loss: 0.281 Vali Acc: 0.925 Test Loss: 0.281 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.4003133773803711
Epoch: 43, Steps: 3 | Train Loss: 0.062 Vali Loss: 0.289 Vali Acc: 0.925 Test Loss: 0.289 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.41685009002685547
Epoch: 44, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.280 Vali Acc: 0.925 Test Loss: 0.280 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.388139009475708
Epoch: 45, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.273 Vali Acc: 0.925 Test Loss: 0.273 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.4364650249481201
Epoch: 46, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.270 Vali Acc: 0.925 Test Loss: 0.270 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.5100815296173096
Epoch: 47, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.272 Vali Acc: 0.925 Test Loss: 0.272 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 0.4718787670135498
Epoch: 48, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.274 Vali Acc: 0.925 Test Loss: 0.274 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 0.4832611083984375
Epoch: 49, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.274 Vali Acc: 0.925 Test Loss: 0.274 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 0.4015672206878662
Epoch: 50, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.275 Vali Acc: 0.925 Test Loss: 0.275 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 247044
model size : 0.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps20_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.7722244262695312
Epoch: 1, Steps: 3 | Train Loss: 1.426 Vali Loss: 1.444 Vali Acc: 0.175 Test Loss: 1.444 Test Acc: 0.175
Validation loss decreased (inf --> -0.174986).  Saving model ...
Epoch: 2 cost time: 0.41930484771728516
Epoch: 2, Steps: 3 | Train Loss: 1.310 Vali Loss: 1.412 Vali Acc: 0.200 Test Loss: 1.412 Test Acc: 0.200
Validation loss decreased (-0.174986 --> -0.199986).  Saving model ...
Epoch: 3 cost time: 0.42765021324157715
Epoch: 3, Steps: 3 | Train Loss: 1.274 Vali Loss: 1.370 Vali Acc: 0.250 Test Loss: 1.370 Test Acc: 0.250
Validation loss decreased (-0.199986 --> -0.249986).  Saving model ...
Epoch: 4 cost time: 0.42158961296081543
Epoch: 4, Steps: 3 | Train Loss: 1.219 Vali Loss: 1.308 Vali Acc: 0.350 Test Loss: 1.308 Test Acc: 0.350
Validation loss decreased (-0.249986 --> -0.349987).  Saving model ...
Epoch: 5 cost time: 0.556847333908081
Epoch: 5, Steps: 3 | Train Loss: 1.092 Vali Loss: 1.231 Vali Acc: 0.375 Test Loss: 1.231 Test Acc: 0.375
Validation loss decreased (-0.349987 --> -0.374988).  Saving model ...
Epoch: 6 cost time: 0.43859386444091797
Epoch: 6, Steps: 3 | Train Loss: 1.047 Vali Loss: 1.147 Vali Acc: 0.500 Test Loss: 1.147 Test Acc: 0.500
Validation loss decreased (-0.374988 --> -0.499989).  Saving model ...
Epoch: 7 cost time: 0.42459869384765625
Epoch: 7, Steps: 3 | Train Loss: 0.934 Vali Loss: 1.061 Vali Acc: 0.675 Test Loss: 1.061 Test Acc: 0.675
Validation loss decreased (-0.499989 --> -0.674989).  Saving model ...
Epoch: 8 cost time: 0.41480255126953125
Epoch: 8, Steps: 3 | Train Loss: 0.876 Vali Loss: 0.982 Vali Acc: 0.725 Test Loss: 0.982 Test Acc: 0.725
Validation loss decreased (-0.674989 --> -0.724990).  Saving model ...
Epoch: 9 cost time: 0.46160387992858887
Epoch: 9, Steps: 3 | Train Loss: 0.822 Vali Loss: 0.907 Vali Acc: 0.825 Test Loss: 0.907 Test Acc: 0.825
Validation loss decreased (-0.724990 --> -0.824991).  Saving model ...
Epoch: 10 cost time: 0.38523125648498535
Epoch: 10, Steps: 3 | Train Loss: 0.744 Vali Loss: 0.840 Vali Acc: 0.900 Test Loss: 0.840 Test Acc: 0.900
Validation loss decreased (-0.824991 --> -0.899992).  Saving model ...
Epoch: 11 cost time: 0.404437780380249
Epoch: 11, Steps: 3 | Train Loss: 0.702 Vali Loss: 0.781 Vali Acc: 0.950 Test Loss: 0.781 Test Acc: 0.950
Validation loss decreased (-0.899992 --> -0.949992).  Saving model ...
Epoch: 12 cost time: 0.42240071296691895
Epoch: 12, Steps: 3 | Train Loss: 0.623 Vali Loss: 0.730 Vali Acc: 0.950 Test Loss: 0.730 Test Acc: 0.950
Validation loss decreased (-0.949992 --> -0.949993).  Saving model ...
Epoch: 13 cost time: 0.43625664710998535
Epoch: 13, Steps: 3 | Train Loss: 0.601 Vali Loss: 0.676 Vali Acc: 0.950 Test Loss: 0.676 Test Acc: 0.950
Validation loss decreased (-0.949993 --> -0.949993).  Saving model ...
Epoch: 14 cost time: 0.4108705520629883
Epoch: 14, Steps: 3 | Train Loss: 0.528 Vali Loss: 0.631 Vali Acc: 0.950 Test Loss: 0.631 Test Acc: 0.950
Validation loss decreased (-0.949993 --> -0.949994).  Saving model ...
Epoch: 15 cost time: 0.40624308586120605
Epoch: 15, Steps: 3 | Train Loss: 0.510 Vali Loss: 0.594 Vali Acc: 0.950 Test Loss: 0.594 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949994).  Saving model ...
Epoch: 16 cost time: 0.40456104278564453
Epoch: 16, Steps: 3 | Train Loss: 0.451 Vali Loss: 0.552 Vali Acc: 0.950 Test Loss: 0.552 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949994).  Saving model ...
Epoch: 17 cost time: 0.3990311622619629
Epoch: 17, Steps: 3 | Train Loss: 0.461 Vali Loss: 0.512 Vali Acc: 0.975 Test Loss: 0.512 Test Acc: 0.975
Validation loss decreased (-0.949994 --> -0.974995).  Saving model ...
Epoch: 18 cost time: 0.44601988792419434
Epoch: 18, Steps: 3 | Train Loss: 0.379 Vali Loss: 0.488 Vali Acc: 0.975 Test Loss: 0.488 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 19 cost time: 0.3829667568206787
Epoch: 19, Steps: 3 | Train Loss: 0.401 Vali Loss: 0.457 Vali Acc: 0.975 Test Loss: 0.457 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 20 cost time: 0.44261860847473145
Epoch: 20, Steps: 3 | Train Loss: 0.302 Vali Loss: 0.441 Vali Acc: 0.975 Test Loss: 0.441 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 21 cost time: 0.42282676696777344
Epoch: 21, Steps: 3 | Train Loss: 0.297 Vali Loss: 0.420 Vali Acc: 0.975 Test Loss: 0.420 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 22 cost time: 0.4578089714050293
Epoch: 22, Steps: 3 | Train Loss: 0.297 Vali Loss: 0.396 Vali Acc: 0.975 Test Loss: 0.396 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 23 cost time: 0.509545087814331
Epoch: 23, Steps: 3 | Train Loss: 0.267 Vali Loss: 0.375 Vali Acc: 0.975 Test Loss: 0.375 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 24 cost time: 0.36429619789123535
Epoch: 24, Steps: 3 | Train Loss: 0.242 Vali Loss: 0.364 Vali Acc: 0.975 Test Loss: 0.364 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 25 cost time: 0.4498298168182373
Epoch: 25, Steps: 3 | Train Loss: 0.221 Vali Loss: 0.350 Vali Acc: 0.975 Test Loss: 0.350 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 26 cost time: 0.462554931640625
Epoch: 26, Steps: 3 | Train Loss: 0.204 Vali Loss: 0.339 Vali Acc: 0.975 Test Loss: 0.339 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 27 cost time: 0.43164682388305664
Epoch: 27, Steps: 3 | Train Loss: 0.204 Vali Loss: 0.332 Vali Acc: 0.975 Test Loss: 0.332 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 28 cost time: 0.4269258975982666
Epoch: 28, Steps: 3 | Train Loss: 0.193 Vali Loss: 0.318 Vali Acc: 0.975 Test Loss: 0.318 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 29 cost time: 0.3820788860321045
Epoch: 29, Steps: 3 | Train Loss: 0.176 Vali Loss: 0.310 Vali Acc: 0.975 Test Loss: 0.310 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 30 cost time: 0.5285887718200684
Epoch: 30, Steps: 3 | Train Loss: 0.162 Vali Loss: 0.294 Vali Acc: 0.975 Test Loss: 0.294 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 31 cost time: 0.3928096294403076
Epoch: 31, Steps: 3 | Train Loss: 0.178 Vali Loss: 0.290 Vali Acc: 0.975 Test Loss: 0.290 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 32 cost time: 0.5102550983428955
Epoch: 32, Steps: 3 | Train Loss: 0.148 Vali Loss: 0.278 Vali Acc: 0.975 Test Loss: 0.278 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 33 cost time: 0.4097898006439209
Epoch: 33, Steps: 3 | Train Loss: 0.140 Vali Loss: 0.277 Vali Acc: 0.975 Test Loss: 0.277 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 34 cost time: 0.39985060691833496
Epoch: 34, Steps: 3 | Train Loss: 0.138 Vali Loss: 0.273 Vali Acc: 0.975 Test Loss: 0.273 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 35 cost time: 0.45298337936401367
Epoch: 35, Steps: 3 | Train Loss: 0.123 Vali Loss: 0.265 Vali Acc: 0.975 Test Loss: 0.265 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 36 cost time: 0.46972060203552246
Epoch: 36, Steps: 3 | Train Loss: 0.119 Vali Loss: 0.252 Vali Acc: 0.975 Test Loss: 0.252 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 37 cost time: 0.5681092739105225
Epoch: 37, Steps: 3 | Train Loss: 0.112 Vali Loss: 0.245 Vali Acc: 0.975 Test Loss: 0.245 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 38 cost time: 0.4602997303009033
Epoch: 38, Steps: 3 | Train Loss: 0.133 Vali Loss: 0.242 Vali Acc: 0.975 Test Loss: 0.242 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 39 cost time: 0.47631311416625977
Epoch: 39, Steps: 3 | Train Loss: 0.092 Vali Loss: 0.235 Vali Acc: 0.975 Test Loss: 0.235 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 40 cost time: 0.4455704689025879
Epoch: 40, Steps: 3 | Train Loss: 0.097 Vali Loss: 0.232 Vali Acc: 0.975 Test Loss: 0.232 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 41 cost time: 0.4349038600921631
Epoch: 41, Steps: 3 | Train Loss: 0.107 Vali Loss: 0.231 Vali Acc: 0.975 Test Loss: 0.231 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 42 cost time: 0.47607946395874023
Epoch: 42, Steps: 3 | Train Loss: 0.078 Vali Loss: 0.236 Vali Acc: 0.975 Test Loss: 0.236 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.5776033401489258
Epoch: 43, Steps: 3 | Train Loss: 0.074 Vali Loss: 0.232 Vali Acc: 0.975 Test Loss: 0.232 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.4343900680541992
Epoch: 44, Steps: 3 | Train Loss: 0.074 Vali Loss: 0.224 Vali Acc: 0.975 Test Loss: 0.224 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 45 cost time: 0.40775203704833984
Epoch: 45, Steps: 3 | Train Loss: 0.074 Vali Loss: 0.225 Vali Acc: 0.975 Test Loss: 0.225 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.4613015651702881
Epoch: 46, Steps: 3 | Train Loss: 0.061 Vali Loss: 0.214 Vali Acc: 0.975 Test Loss: 0.214 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 47 cost time: 0.4325411319732666
Epoch: 47, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.206 Vali Acc: 0.975 Test Loss: 0.206 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 48 cost time: 0.42148542404174805
Epoch: 48, Steps: 3 | Train Loss: 0.062 Vali Loss: 0.203 Vali Acc: 0.975 Test Loss: 0.203 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 49 cost time: 0.5131392478942871
Epoch: 49, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.196 Vali Acc: 0.975 Test Loss: 0.196 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 50 cost time: 0.41277599334716797
Epoch: 50, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.199 Vali Acc: 0.975 Test Loss: 0.199 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps20_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 244292
model size : 0.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps25_str13_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.6753754615783691
Epoch: 1, Steps: 3 | Train Loss: 1.455 Vali Loss: 1.497 Vali Acc: 0.175 Test Loss: 1.497 Test Acc: 0.175
Validation loss decreased (inf --> -0.174985).  Saving model ...
Epoch: 2 cost time: 0.4224395751953125
Epoch: 2, Steps: 3 | Train Loss: 1.404 Vali Loss: 1.481 Vali Acc: 0.200 Test Loss: 1.481 Test Acc: 0.200
Validation loss decreased (-0.174985 --> -0.199985).  Saving model ...
Epoch: 3 cost time: 0.380596399307251
Epoch: 3, Steps: 3 | Train Loss: 1.303 Vali Loss: 1.459 Vali Acc: 0.225 Test Loss: 1.459 Test Acc: 0.225
Validation loss decreased (-0.199985 --> -0.224985).  Saving model ...
Epoch: 4 cost time: 0.3928828239440918
Epoch: 4, Steps: 3 | Train Loss: 1.334 Vali Loss: 1.419 Vali Acc: 0.250 Test Loss: 1.419 Test Acc: 0.250
Validation loss decreased (-0.224985 --> -0.249986).  Saving model ...
Epoch: 5 cost time: 0.4126913547515869
Epoch: 5, Steps: 3 | Train Loss: 1.256 Vali Loss: 1.363 Vali Acc: 0.325 Test Loss: 1.363 Test Acc: 0.325
Validation loss decreased (-0.249986 --> -0.324986).  Saving model ...
Epoch: 6 cost time: 0.40002012252807617
Epoch: 6, Steps: 3 | Train Loss: 1.182 Vali Loss: 1.297 Vali Acc: 0.425 Test Loss: 1.297 Test Acc: 0.425
Validation loss decreased (-0.324986 --> -0.424987).  Saving model ...
Epoch: 7 cost time: 0.4335911273956299
Epoch: 7, Steps: 3 | Train Loss: 1.081 Vali Loss: 1.229 Vali Acc: 0.475 Test Loss: 1.229 Test Acc: 0.475
Validation loss decreased (-0.424987 --> -0.474988).  Saving model ...
Epoch: 8 cost time: 0.3944816589355469
Epoch: 8, Steps: 3 | Train Loss: 1.090 Vali Loss: 1.156 Vali Acc: 0.550 Test Loss: 1.156 Test Acc: 0.550
Validation loss decreased (-0.474988 --> -0.549988).  Saving model ...
Epoch: 9 cost time: 0.3315849304199219
Epoch: 9, Steps: 3 | Train Loss: 0.951 Vali Loss: 1.089 Vali Acc: 0.625 Test Loss: 1.089 Test Acc: 0.625
Validation loss decreased (-0.549988 --> -0.624989).  Saving model ...
Epoch: 10 cost time: 0.3631579875946045
Epoch: 10, Steps: 3 | Train Loss: 0.884 Vali Loss: 1.022 Vali Acc: 0.650 Test Loss: 1.022 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649990).  Saving model ...
Epoch: 11 cost time: 0.33182501792907715
Epoch: 11, Steps: 3 | Train Loss: 0.845 Vali Loss: 0.961 Vali Acc: 0.700 Test Loss: 0.961 Test Acc: 0.700
Validation loss decreased (-0.649990 --> -0.699990).  Saving model ...
Epoch: 12 cost time: 0.32912373542785645
Epoch: 12, Steps: 3 | Train Loss: 0.803 Vali Loss: 0.899 Vali Acc: 0.750 Test Loss: 0.899 Test Acc: 0.750
Validation loss decreased (-0.699990 --> -0.749991).  Saving model ...
Epoch: 13 cost time: 0.3740270137786865
Epoch: 13, Steps: 3 | Train Loss: 0.716 Vali Loss: 0.849 Vali Acc: 0.750 Test Loss: 0.849 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749992).  Saving model ...
Epoch: 14 cost time: 0.34181976318359375
Epoch: 14, Steps: 3 | Train Loss: 0.688 Vali Loss: 0.797 Vali Acc: 0.825 Test Loss: 0.797 Test Acc: 0.825
Validation loss decreased (-0.749992 --> -0.824992).  Saving model ...
Epoch: 15 cost time: 0.34398651123046875
Epoch: 15, Steps: 3 | Train Loss: 0.634 Vali Loss: 0.747 Vali Acc: 0.850 Test Loss: 0.747 Test Acc: 0.850
Validation loss decreased (-0.824992 --> -0.849993).  Saving model ...
Epoch: 16 cost time: 0.3687756061553955
Epoch: 16, Steps: 3 | Train Loss: 0.569 Vali Loss: 0.713 Vali Acc: 0.850 Test Loss: 0.713 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 17 cost time: 0.4071478843688965
Epoch: 17, Steps: 3 | Train Loss: 0.526 Vali Loss: 0.682 Vali Acc: 0.850 Test Loss: 0.682 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 18 cost time: 0.3886239528656006
Epoch: 18, Steps: 3 | Train Loss: 0.488 Vali Loss: 0.646 Vali Acc: 0.925 Test Loss: 0.646 Test Acc: 0.925
Validation loss decreased (-0.849993 --> -0.924994).  Saving model ...
Epoch: 19 cost time: 0.38622355461120605
Epoch: 19, Steps: 3 | Train Loss: 0.470 Vali Loss: 0.615 Vali Acc: 0.925 Test Loss: 0.615 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 20 cost time: 0.34615063667297363
Epoch: 20, Steps: 3 | Train Loss: 0.442 Vali Loss: 0.595 Vali Acc: 0.925 Test Loss: 0.595 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 21 cost time: 0.4112894535064697
Epoch: 21, Steps: 3 | Train Loss: 0.403 Vali Loss: 0.566 Vali Acc: 0.925 Test Loss: 0.566 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 22 cost time: 0.4400813579559326
Epoch: 22, Steps: 3 | Train Loss: 0.375 Vali Loss: 0.543 Vali Acc: 0.925 Test Loss: 0.543 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 23 cost time: 0.4040374755859375
Epoch: 23, Steps: 3 | Train Loss: 0.369 Vali Loss: 0.518 Vali Acc: 0.925 Test Loss: 0.518 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 24 cost time: 0.4411947727203369
Epoch: 24, Steps: 3 | Train Loss: 0.350 Vali Loss: 0.496 Vali Acc: 0.925 Test Loss: 0.496 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 25 cost time: 0.41282224655151367
Epoch: 25, Steps: 3 | Train Loss: 0.316 Vali Loss: 0.487 Vali Acc: 0.925 Test Loss: 0.487 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 26 cost time: 0.4831366539001465
Epoch: 26, Steps: 3 | Train Loss: 0.320 Vali Loss: 0.456 Vali Acc: 0.950 Test Loss: 0.456 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949995).  Saving model ...
Epoch: 27 cost time: 0.4503917694091797
Epoch: 27, Steps: 3 | Train Loss: 0.284 Vali Loss: 0.441 Vali Acc: 0.975 Test Loss: 0.441 Test Acc: 0.975
Validation loss decreased (-0.949995 --> -0.974996).  Saving model ...
Epoch: 28 cost time: 0.4367096424102783
Epoch: 28, Steps: 3 | Train Loss: 0.274 Vali Loss: 0.426 Vali Acc: 0.975 Test Loss: 0.426 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 29 cost time: 0.462615966796875
Epoch: 29, Steps: 3 | Train Loss: 0.248 Vali Loss: 0.406 Vali Acc: 0.975 Test Loss: 0.406 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 30 cost time: 0.417921781539917
Epoch: 30, Steps: 3 | Train Loss: 0.255 Vali Loss: 0.397 Vali Acc: 0.975 Test Loss: 0.397 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 31 cost time: 0.531369686126709
Epoch: 31, Steps: 3 | Train Loss: 0.210 Vali Loss: 0.378 Vali Acc: 0.975 Test Loss: 0.378 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 32 cost time: 0.40497708320617676
Epoch: 32, Steps: 3 | Train Loss: 0.211 Vali Loss: 0.368 Vali Acc: 0.975 Test Loss: 0.368 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 33 cost time: 0.5095729827880859
Epoch: 33, Steps: 3 | Train Loss: 0.190 Vali Loss: 0.349 Vali Acc: 0.975 Test Loss: 0.349 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 34 cost time: 0.4869050979614258
Epoch: 34, Steps: 3 | Train Loss: 0.151 Vali Loss: 0.329 Vali Acc: 0.975 Test Loss: 0.329 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 35 cost time: 0.5158588886260986
Epoch: 35, Steps: 3 | Train Loss: 0.188 Vali Loss: 0.323 Vali Acc: 0.975 Test Loss: 0.323 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 36 cost time: 0.50235915184021
Epoch: 36, Steps: 3 | Train Loss: 0.162 Vali Loss: 0.318 Vali Acc: 0.975 Test Loss: 0.318 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 37 cost time: 0.4684727191925049
Epoch: 37, Steps: 3 | Train Loss: 0.154 Vali Loss: 0.311 Vali Acc: 0.975 Test Loss: 0.311 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 38 cost time: 0.4795105457305908
Epoch: 38, Steps: 3 | Train Loss: 0.150 Vali Loss: 0.303 Vali Acc: 0.975 Test Loss: 0.303 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 39 cost time: 0.4480249881744385
Epoch: 39, Steps: 3 | Train Loss: 0.156 Vali Loss: 0.303 Vali Acc: 0.950 Test Loss: 0.303 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.5052342414855957
Epoch: 40, Steps: 3 | Train Loss: 0.148 Vali Loss: 0.300 Vali Acc: 0.950 Test Loss: 0.300 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.45956873893737793
Epoch: 41, Steps: 3 | Train Loss: 0.125 Vali Loss: 0.294 Vali Acc: 0.950 Test Loss: 0.294 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.5108633041381836
Epoch: 42, Steps: 3 | Train Loss: 0.137 Vali Loss: 0.291 Vali Acc: 0.950 Test Loss: 0.291 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.4717416763305664
Epoch: 43, Steps: 3 | Train Loss: 0.124 Vali Loss: 0.282 Vali Acc: 0.950 Test Loss: 0.282 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.4788343906402588
Epoch: 44, Steps: 3 | Train Loss: 0.105 Vali Loss: 0.279 Vali Acc: 0.950 Test Loss: 0.279 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.46206188201904297
Epoch: 45, Steps: 3 | Train Loss: 0.094 Vali Loss: 0.271 Vali Acc: 0.950 Test Loss: 0.271 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.46997880935668945
Epoch: 46, Steps: 3 | Train Loss: 0.082 Vali Loss: 0.261 Vali Acc: 0.950 Test Loss: 0.261 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.4820852279663086
Epoch: 47, Steps: 3 | Train Loss: 0.091 Vali Loss: 0.255 Vali Acc: 0.950 Test Loss: 0.255 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 0.5332720279693604
Epoch: 48, Steps: 3 | Train Loss: 0.094 Vali Loss: 0.252 Vali Acc: 0.950 Test Loss: 0.252 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps25_str13_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 240004
model size : 0.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.512911081314087
Epoch: 1, Steps: 3 | Train Loss: 1.488 Vali Loss: 1.416 Vali Acc: 0.100 Test Loss: 1.416 Test Acc: 0.100
Validation loss decreased (inf --> -0.099986).  Saving model ...
Epoch: 2 cost time: 0.39831972122192383
Epoch: 2, Steps: 3 | Train Loss: 1.354 Vali Loss: 1.367 Vali Acc: 0.150 Test Loss: 1.367 Test Acc: 0.150
Validation loss decreased (-0.099986 --> -0.149986).  Saving model ...
Epoch: 3 cost time: 0.40573716163635254
Epoch: 3, Steps: 3 | Train Loss: 1.233 Vali Loss: 1.286 Vali Acc: 0.200 Test Loss: 1.286 Test Acc: 0.200
Validation loss decreased (-0.149986 --> -0.199987).  Saving model ...
Epoch: 4 cost time: 0.3636777400970459
Epoch: 4, Steps: 3 | Train Loss: 1.120 Vali Loss: 1.183 Vali Acc: 0.300 Test Loss: 1.183 Test Acc: 0.300
Validation loss decreased (-0.199987 --> -0.299988).  Saving model ...
Epoch: 5 cost time: 0.39415693283081055
Epoch: 5, Steps: 3 | Train Loss: 1.028 Vali Loss: 1.073 Vali Acc: 0.575 Test Loss: 1.073 Test Acc: 0.575
Validation loss decreased (-0.299988 --> -0.574989).  Saving model ...
Epoch: 6 cost time: 0.41133689880371094
Epoch: 6, Steps: 3 | Train Loss: 0.873 Vali Loss: 0.971 Vali Acc: 0.725 Test Loss: 0.971 Test Acc: 0.725
Validation loss decreased (-0.574989 --> -0.724990).  Saving model ...
Epoch: 7 cost time: 0.41721248626708984
Epoch: 7, Steps: 3 | Train Loss: 0.769 Vali Loss: 0.881 Vali Acc: 0.825 Test Loss: 0.881 Test Acc: 0.825
Validation loss decreased (-0.724990 --> -0.824991).  Saving model ...
Epoch: 8 cost time: 0.43007516860961914
Epoch: 8, Steps: 3 | Train Loss: 0.669 Vali Loss: 0.791 Vali Acc: 0.875 Test Loss: 0.791 Test Acc: 0.875
Validation loss decreased (-0.824991 --> -0.874992).  Saving model ...
Epoch: 9 cost time: 0.40061354637145996
Epoch: 9, Steps: 3 | Train Loss: 0.596 Vali Loss: 0.703 Vali Acc: 0.875 Test Loss: 0.703 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874993).  Saving model ...
Epoch: 10 cost time: 0.41806650161743164
Epoch: 10, Steps: 3 | Train Loss: 0.504 Vali Loss: 0.619 Vali Acc: 0.925 Test Loss: 0.619 Test Acc: 0.925
Validation loss decreased (-0.874993 --> -0.924994).  Saving model ...
Epoch: 11 cost time: 0.4519336223602295
Epoch: 11, Steps: 3 | Train Loss: 0.433 Vali Loss: 0.545 Vali Acc: 0.950 Test Loss: 0.545 Test Acc: 0.950
Validation loss decreased (-0.924994 --> -0.949995).  Saving model ...
Epoch: 12 cost time: 0.3864598274230957
Epoch: 12, Steps: 3 | Train Loss: 0.372 Vali Loss: 0.477 Vali Acc: 0.975 Test Loss: 0.477 Test Acc: 0.975
Validation loss decreased (-0.949995 --> -0.974995).  Saving model ...
Epoch: 13 cost time: 0.4819025993347168
Epoch: 13, Steps: 3 | Train Loss: 0.309 Vali Loss: 0.421 Vali Acc: 0.975 Test Loss: 0.421 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 14 cost time: 0.4562861919403076
Epoch: 14, Steps: 3 | Train Loss: 0.270 Vali Loss: 0.381 Vali Acc: 0.975 Test Loss: 0.381 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 15 cost time: 0.44191884994506836
Epoch: 15, Steps: 3 | Train Loss: 0.250 Vali Loss: 0.352 Vali Acc: 0.975 Test Loss: 0.352 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 16 cost time: 0.380509614944458
Epoch: 16, Steps: 3 | Train Loss: 0.220 Vali Loss: 0.332 Vali Acc: 0.975 Test Loss: 0.332 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 17 cost time: 0.42040348052978516
Epoch: 17, Steps: 3 | Train Loss: 0.162 Vali Loss: 0.320 Vali Acc: 0.975 Test Loss: 0.320 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 18 cost time: 0.37633252143859863
Epoch: 18, Steps: 3 | Train Loss: 0.196 Vali Loss: 0.308 Vali Acc: 0.975 Test Loss: 0.308 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 19 cost time: 0.4470674991607666
Epoch: 19, Steps: 3 | Train Loss: 0.172 Vali Loss: 0.300 Vali Acc: 0.950 Test Loss: 0.300 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.4541606903076172
Epoch: 20, Steps: 3 | Train Loss: 0.141 Vali Loss: 0.298 Vali Acc: 0.950 Test Loss: 0.298 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.39940905570983887
Epoch: 21, Steps: 3 | Train Loss: 0.127 Vali Loss: 0.292 Vali Acc: 0.950 Test Loss: 0.292 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.39107704162597656
Epoch: 22, Steps: 3 | Train Loss: 0.112 Vali Loss: 0.293 Vali Acc: 0.950 Test Loss: 0.293 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.39672136306762695
Epoch: 23, Steps: 3 | Train Loss: 0.117 Vali Loss: 0.292 Vali Acc: 0.950 Test Loss: 0.292 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.3904569149017334
Epoch: 24, Steps: 3 | Train Loss: 0.082 Vali Loss: 0.295 Vali Acc: 0.950 Test Loss: 0.295 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.3860135078430176
Epoch: 25, Steps: 3 | Train Loss: 0.081 Vali Loss: 0.287 Vali Acc: 0.950 Test Loss: 0.287 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.42181944847106934
Epoch: 26, Steps: 3 | Train Loss: 0.079 Vali Loss: 0.274 Vali Acc: 0.950 Test Loss: 0.274 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.4028337001800537
Epoch: 27, Steps: 3 | Train Loss: 0.071 Vali Loss: 0.263 Vali Acc: 0.950 Test Loss: 0.263 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.42397093772888184
Epoch: 28, Steps: 3 | Train Loss: 0.058 Vali Loss: 0.253 Vali Acc: 0.950 Test Loss: 0.253 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 103172
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.6249468326568604
Epoch: 1, Steps: 3 | Train Loss: 1.453 Vali Loss: 1.388 Vali Acc: 0.150 Test Loss: 1.388 Test Acc: 0.150
Validation loss decreased (inf --> -0.149986).  Saving model ...
Epoch: 2 cost time: 0.4117863178253174
Epoch: 2, Steps: 3 | Train Loss: 1.262 Vali Loss: 1.338 Vali Acc: 0.175 Test Loss: 1.338 Test Acc: 0.175
Validation loss decreased (-0.149986 --> -0.174987).  Saving model ...
Epoch: 3 cost time: 0.40809059143066406
Epoch: 3, Steps: 3 | Train Loss: 1.211 Vali Loss: 1.274 Vali Acc: 0.300 Test Loss: 1.274 Test Acc: 0.300
Validation loss decreased (-0.174987 --> -0.299987).  Saving model ...
Epoch: 4 cost time: 0.48797130584716797
Epoch: 4, Steps: 3 | Train Loss: 1.169 Vali Loss: 1.187 Vali Acc: 0.575 Test Loss: 1.187 Test Acc: 0.575
Validation loss decreased (-0.299987 --> -0.574988).  Saving model ...
Epoch: 5 cost time: 0.40376710891723633
Epoch: 5, Steps: 3 | Train Loss: 1.064 Vali Loss: 1.090 Vali Acc: 0.600 Test Loss: 1.090 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599989).  Saving model ...
Epoch: 6 cost time: 0.4571807384490967
Epoch: 6, Steps: 3 | Train Loss: 0.915 Vali Loss: 0.993 Vali Acc: 0.675 Test Loss: 0.993 Test Acc: 0.675
Validation loss decreased (-0.599989 --> -0.674990).  Saving model ...
Epoch: 7 cost time: 0.4183344841003418
Epoch: 7, Steps: 3 | Train Loss: 0.849 Vali Loss: 0.899 Vali Acc: 0.725 Test Loss: 0.899 Test Acc: 0.725
Validation loss decreased (-0.674990 --> -0.724991).  Saving model ...
Epoch: 8 cost time: 0.413776159286499
Epoch: 8, Steps: 3 | Train Loss: 0.718 Vali Loss: 0.810 Vali Acc: 0.775 Test Loss: 0.810 Test Acc: 0.775
Validation loss decreased (-0.724991 --> -0.774992).  Saving model ...
Epoch: 9 cost time: 0.49750256538391113
Epoch: 9, Steps: 3 | Train Loss: 0.654 Vali Loss: 0.732 Vali Acc: 0.750 Test Loss: 0.732 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.4640946388244629
Epoch: 10, Steps: 3 | Train Loss: 0.588 Vali Loss: 0.651 Vali Acc: 0.850 Test Loss: 0.651 Test Acc: 0.850
Validation loss decreased (-0.774992 --> -0.849993).  Saving model ...
Epoch: 11 cost time: 0.5095012187957764
Epoch: 11, Steps: 3 | Train Loss: 0.506 Vali Loss: 0.581 Vali Acc: 0.925 Test Loss: 0.581 Test Acc: 0.925
Validation loss decreased (-0.849993 --> -0.924994).  Saving model ...
Epoch: 12 cost time: 0.4163353443145752
Epoch: 12, Steps: 3 | Train Loss: 0.445 Vali Loss: 0.522 Vali Acc: 0.950 Test Loss: 0.522 Test Acc: 0.950
Validation loss decreased (-0.924994 --> -0.949995).  Saving model ...
Epoch: 13 cost time: 0.5584056377410889
Epoch: 13, Steps: 3 | Train Loss: 0.394 Vali Loss: 0.473 Vali Acc: 0.950 Test Loss: 0.473 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 14 cost time: 0.44090819358825684
Epoch: 14, Steps: 3 | Train Loss: 0.317 Vali Loss: 0.422 Vali Acc: 0.950 Test Loss: 0.422 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 15 cost time: 0.4539921283721924
Epoch: 15, Steps: 3 | Train Loss: 0.320 Vali Loss: 0.386 Vali Acc: 0.950 Test Loss: 0.386 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 16 cost time: 0.4658803939819336
Epoch: 16, Steps: 3 | Train Loss: 0.306 Vali Loss: 0.355 Vali Acc: 0.950 Test Loss: 0.355 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 17 cost time: 0.3898916244506836
Epoch: 17, Steps: 3 | Train Loss: 0.252 Vali Loss: 0.335 Vali Acc: 0.950 Test Loss: 0.335 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 18 cost time: 0.4027678966522217
Epoch: 18, Steps: 3 | Train Loss: 0.214 Vali Loss: 0.314 Vali Acc: 0.950 Test Loss: 0.314 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 19 cost time: 0.526634931564331
Epoch: 19, Steps: 3 | Train Loss: 0.223 Vali Loss: 0.296 Vali Acc: 0.975 Test Loss: 0.296 Test Acc: 0.975
Validation loss decreased (-0.949997 --> -0.974997).  Saving model ...
Epoch: 20 cost time: 0.38949084281921387
Epoch: 20, Steps: 3 | Train Loss: 0.195 Vali Loss: 0.284 Vali Acc: 0.975 Test Loss: 0.284 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 21 cost time: 0.486431360244751
Epoch: 21, Steps: 3 | Train Loss: 0.167 Vali Loss: 0.276 Vali Acc: 0.975 Test Loss: 0.276 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 22 cost time: 0.46494221687316895
Epoch: 22, Steps: 3 | Train Loss: 0.167 Vali Loss: 0.268 Vali Acc: 0.950 Test Loss: 0.268 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.46645665168762207
Epoch: 23, Steps: 3 | Train Loss: 0.149 Vali Loss: 0.264 Vali Acc: 0.950 Test Loss: 0.264 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.3874776363372803
Epoch: 24, Steps: 3 | Train Loss: 0.124 Vali Loss: 0.258 Vali Acc: 0.950 Test Loss: 0.258 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.39336609840393066
Epoch: 25, Steps: 3 | Train Loss: 0.117 Vali Loss: 0.260 Vali Acc: 0.950 Test Loss: 0.260 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.4362962245941162
Epoch: 26, Steps: 3 | Train Loss: 0.117 Vali Loss: 0.262 Vali Acc: 0.950 Test Loss: 0.262 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.44676947593688965
Epoch: 27, Steps: 3 | Train Loss: 0.105 Vali Loss: 0.258 Vali Acc: 0.950 Test Loss: 0.258 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.488222599029541
Epoch: 28, Steps: 3 | Train Loss: 0.099 Vali Loss: 0.255 Vali Acc: 0.950 Test Loss: 0.255 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.43430185317993164
Epoch: 29, Steps: 3 | Train Loss: 0.087 Vali Loss: 0.256 Vali Acc: 0.950 Test Loss: 0.256 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.4286785125732422
Epoch: 30, Steps: 3 | Train Loss: 0.085 Vali Loss: 0.250 Vali Acc: 0.950 Test Loss: 0.250 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.4365084171295166
Epoch: 31, Steps: 3 | Train Loss: 0.083 Vali Loss: 0.243 Vali Acc: 0.950 Test Loss: 0.243 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 90180
model size : 0.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.699188470840454
Epoch: 1, Steps: 3 | Train Loss: 1.325 Vali Loss: 1.428 Vali Acc: 0.125 Test Loss: 1.428 Test Acc: 0.125
Validation loss decreased (inf --> -0.124986).  Saving model ...
Epoch: 2 cost time: 0.45687437057495117
Epoch: 2, Steps: 3 | Train Loss: 1.239 Vali Loss: 1.390 Vali Acc: 0.175 Test Loss: 1.390 Test Acc: 0.175
Validation loss decreased (-0.124986 --> -0.174986).  Saving model ...
Epoch: 3 cost time: 0.44682741165161133
Epoch: 3, Steps: 3 | Train Loss: 1.219 Vali Loss: 1.340 Vali Acc: 0.225 Test Loss: 1.340 Test Acc: 0.225
Validation loss decreased (-0.174986 --> -0.224987).  Saving model ...
Epoch: 4 cost time: 0.48615550994873047
Epoch: 4, Steps: 3 | Train Loss: 1.132 Vali Loss: 1.273 Vali Acc: 0.250 Test Loss: 1.273 Test Acc: 0.250
Validation loss decreased (-0.224987 --> -0.249987).  Saving model ...
Epoch: 5 cost time: 0.4426097869873047
Epoch: 5, Steps: 3 | Train Loss: 1.028 Vali Loss: 1.193 Vali Acc: 0.325 Test Loss: 1.193 Test Acc: 0.325
Validation loss decreased (-0.249987 --> -0.324988).  Saving model ...
Epoch: 6 cost time: 0.45211148262023926
Epoch: 6, Steps: 3 | Train Loss: 0.967 Vali Loss: 1.108 Vali Acc: 0.375 Test Loss: 1.108 Test Acc: 0.375
Validation loss decreased (-0.324988 --> -0.374989).  Saving model ...
Epoch: 7 cost time: 0.442305326461792
Epoch: 7, Steps: 3 | Train Loss: 0.879 Vali Loss: 1.021 Vali Acc: 0.600 Test Loss: 1.021 Test Acc: 0.600
Validation loss decreased (-0.374989 --> -0.599990).  Saving model ...
Epoch: 8 cost time: 0.4326508045196533
Epoch: 8, Steps: 3 | Train Loss: 0.827 Vali Loss: 0.940 Vali Acc: 0.725 Test Loss: 0.940 Test Acc: 0.725
Validation loss decreased (-0.599990 --> -0.724991).  Saving model ...
Epoch: 9 cost time: 0.4537220001220703
Epoch: 9, Steps: 3 | Train Loss: 0.737 Vali Loss: 0.867 Vali Acc: 0.800 Test Loss: 0.867 Test Acc: 0.800
Validation loss decreased (-0.724991 --> -0.799991).  Saving model ...
Epoch: 10 cost time: 0.4702143669128418
Epoch: 10, Steps: 3 | Train Loss: 0.683 Vali Loss: 0.796 Vali Acc: 0.825 Test Loss: 0.796 Test Acc: 0.825
Validation loss decreased (-0.799991 --> -0.824992).  Saving model ...
Epoch: 11 cost time: 0.4666416645050049
Epoch: 11, Steps: 3 | Train Loss: 0.635 Vali Loss: 0.731 Vali Acc: 0.850 Test Loss: 0.731 Test Acc: 0.850
Validation loss decreased (-0.824992 --> -0.849993).  Saving model ...
Epoch: 12 cost time: 0.41999268531799316
Epoch: 12, Steps: 3 | Train Loss: 0.577 Vali Loss: 0.674 Vali Acc: 0.900 Test Loss: 0.674 Test Acc: 0.900
Validation loss decreased (-0.849993 --> -0.899993).  Saving model ...
Epoch: 13 cost time: 0.44353151321411133
Epoch: 13, Steps: 3 | Train Loss: 0.526 Vali Loss: 0.623 Vali Acc: 0.950 Test Loss: 0.623 Test Acc: 0.950
Validation loss decreased (-0.899993 --> -0.949994).  Saving model ...
Epoch: 14 cost time: 0.46625757217407227
Epoch: 14, Steps: 3 | Train Loss: 0.457 Vali Loss: 0.584 Vali Acc: 0.950 Test Loss: 0.584 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949994).  Saving model ...
Epoch: 15 cost time: 0.46692705154418945
Epoch: 15, Steps: 3 | Train Loss: 0.421 Vali Loss: 0.531 Vali Acc: 0.975 Test Loss: 0.531 Test Acc: 0.975
Validation loss decreased (-0.949994 --> -0.974995).  Saving model ...
Epoch: 16 cost time: 0.43158912658691406
Epoch: 16, Steps: 3 | Train Loss: 0.400 Vali Loss: 0.486 Vali Acc: 0.975 Test Loss: 0.486 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 17 cost time: 0.4470839500427246
Epoch: 17, Steps: 3 | Train Loss: 0.335 Vali Loss: 0.460 Vali Acc: 0.975 Test Loss: 0.460 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 18 cost time: 0.44390034675598145
Epoch: 18, Steps: 3 | Train Loss: 0.307 Vali Loss: 0.426 Vali Acc: 0.975 Test Loss: 0.426 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 19 cost time: 0.4395158290863037
Epoch: 19, Steps: 3 | Train Loss: 0.294 Vali Loss: 0.400 Vali Acc: 0.975 Test Loss: 0.400 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 20 cost time: 0.4162158966064453
Epoch: 20, Steps: 3 | Train Loss: 0.271 Vali Loss: 0.380 Vali Acc: 0.975 Test Loss: 0.380 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 21 cost time: 0.39544177055358887
Epoch: 21, Steps: 3 | Train Loss: 0.252 Vali Loss: 0.366 Vali Acc: 0.975 Test Loss: 0.366 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 22 cost time: 0.43762660026550293
Epoch: 22, Steps: 3 | Train Loss: 0.215 Vali Loss: 0.360 Vali Acc: 0.975 Test Loss: 0.360 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 23 cost time: 0.5350251197814941
Epoch: 23, Steps: 3 | Train Loss: 0.199 Vali Loss: 0.341 Vali Acc: 0.975 Test Loss: 0.341 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 24 cost time: 0.3963189125061035
Epoch: 24, Steps: 3 | Train Loss: 0.213 Vali Loss: 0.331 Vali Acc: 0.975 Test Loss: 0.331 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 25 cost time: 0.45221686363220215
Epoch: 25, Steps: 3 | Train Loss: 0.189 Vali Loss: 0.321 Vali Acc: 0.975 Test Loss: 0.321 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 26 cost time: 0.4241056442260742
Epoch: 26, Steps: 3 | Train Loss: 0.159 Vali Loss: 0.318 Vali Acc: 0.975 Test Loss: 0.318 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 27 cost time: 0.4162876605987549
Epoch: 27, Steps: 3 | Train Loss: 0.148 Vali Loss: 0.296 Vali Acc: 0.975 Test Loss: 0.296 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 28 cost time: 0.41893506050109863
Epoch: 28, Steps: 3 | Train Loss: 0.149 Vali Loss: 0.289 Vali Acc: 0.975 Test Loss: 0.289 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 29 cost time: 0.46614527702331543
Epoch: 29, Steps: 3 | Train Loss: 0.128 Vali Loss: 0.282 Vali Acc: 0.975 Test Loss: 0.282 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 30 cost time: 0.40224194526672363
Epoch: 30, Steps: 3 | Train Loss: 0.124 Vali Loss: 0.270 Vali Acc: 0.975 Test Loss: 0.270 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 31 cost time: 0.466292142868042
Epoch: 31, Steps: 3 | Train Loss: 0.116 Vali Loss: 0.264 Vali Acc: 0.975 Test Loss: 0.264 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 32 cost time: 0.41430020332336426
Epoch: 32, Steps: 3 | Train Loss: 0.110 Vali Loss: 0.255 Vali Acc: 0.975 Test Loss: 0.255 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 33 cost time: 0.3731212615966797
Epoch: 33, Steps: 3 | Train Loss: 0.095 Vali Loss: 0.240 Vali Acc: 0.975 Test Loss: 0.240 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 34 cost time: 0.46125030517578125
Epoch: 34, Steps: 3 | Train Loss: 0.093 Vali Loss: 0.232 Vali Acc: 0.975 Test Loss: 0.232 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 35 cost time: 0.4016587734222412
Epoch: 35, Steps: 3 | Train Loss: 0.091 Vali Loss: 0.221 Vali Acc: 0.975 Test Loss: 0.221 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 36 cost time: 0.43949151039123535
Epoch: 36, Steps: 3 | Train Loss: 0.098 Vali Loss: 0.223 Vali Acc: 0.975 Test Loss: 0.223 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.3926858901977539
Epoch: 37, Steps: 3 | Train Loss: 0.082 Vali Loss: 0.226 Vali Acc: 0.975 Test Loss: 0.226 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.396944522857666
Epoch: 38, Steps: 3 | Train Loss: 0.100 Vali Loss: 0.228 Vali Acc: 0.975 Test Loss: 0.228 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.4117870330810547
Epoch: 39, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.223 Vali Acc: 0.975 Test Loss: 0.223 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.41936159133911133
Epoch: 40, Steps: 3 | Train Loss: 0.062 Vali Loss: 0.209 Vali Acc: 0.975 Test Loss: 0.209 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 41 cost time: 0.35326218605041504
Epoch: 41, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.208 Vali Acc: 0.975 Test Loss: 0.208 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 42 cost time: 0.35675859451293945
Epoch: 42, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.204 Vali Acc: 0.975 Test Loss: 0.204 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 43 cost time: 0.42763447761535645
Epoch: 43, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.210 Vali Acc: 0.975 Test Loss: 0.210 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.4389510154724121
Epoch: 44, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.208 Vali Acc: 0.975 Test Loss: 0.208 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.47685956954956055
Epoch: 45, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.198 Vali Acc: 0.975 Test Loss: 0.198 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 46 cost time: 0.3755350112915039
Epoch: 46, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.196 Vali Acc: 0.975 Test Loss: 0.196 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 47 cost time: 0.3843870162963867
Epoch: 47, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.189 Vali Acc: 0.975 Test Loss: 0.189 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 48 cost time: 0.3818819522857666
Epoch: 48, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.191 Vali Acc: 0.975 Test Loss: 0.191 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.381791353225708
Epoch: 49, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.196 Vali Acc: 0.975 Test Loss: 0.196 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.4182870388031006
Epoch: 50, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.192 Vali Acc: 0.975 Test Loss: 0.192 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 84132
model size : 0.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.7062416076660156
Epoch: 1, Steps: 3 | Train Loss: 1.383 Vali Loss: 1.368 Vali Acc: 0.125 Test Loss: 1.368 Test Acc: 0.125
Validation loss decreased (inf --> -0.124986).  Saving model ...
Epoch: 2 cost time: 0.4147000312805176
Epoch: 2, Steps: 3 | Train Loss: 1.323 Vali Loss: 1.342 Vali Acc: 0.200 Test Loss: 1.342 Test Acc: 0.200
Validation loss decreased (-0.124986 --> -0.199987).  Saving model ...
Epoch: 3 cost time: 0.413466215133667
Epoch: 3, Steps: 3 | Train Loss: 1.299 Vali Loss: 1.309 Vali Acc: 0.200 Test Loss: 1.309 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199987).  Saving model ...
Epoch: 4 cost time: 0.37503695487976074
Epoch: 4, Steps: 3 | Train Loss: 1.183 Vali Loss: 1.265 Vali Acc: 0.250 Test Loss: 1.265 Test Acc: 0.250
Validation loss decreased (-0.199987 --> -0.249987).  Saving model ...
Epoch: 5 cost time: 0.37108373641967773
Epoch: 5, Steps: 3 | Train Loss: 1.219 Vali Loss: 1.209 Vali Acc: 0.275 Test Loss: 1.209 Test Acc: 0.275
Validation loss decreased (-0.249987 --> -0.274988).  Saving model ...
Epoch: 6 cost time: 0.40131044387817383
Epoch: 6, Steps: 3 | Train Loss: 1.080 Vali Loss: 1.151 Vali Acc: 0.275 Test Loss: 1.151 Test Acc: 0.275
Validation loss decreased (-0.274988 --> -0.274988).  Saving model ...
Epoch: 7 cost time: 0.3914504051208496
Epoch: 7, Steps: 3 | Train Loss: 1.004 Vali Loss: 1.094 Vali Acc: 0.350 Test Loss: 1.094 Test Acc: 0.350
Validation loss decreased (-0.274988 --> -0.349989).  Saving model ...
Epoch: 8 cost time: 0.43456530570983887
Epoch: 8, Steps: 3 | Train Loss: 0.936 Vali Loss: 1.040 Vali Acc: 0.400 Test Loss: 1.040 Test Acc: 0.400
Validation loss decreased (-0.349989 --> -0.399990).  Saving model ...
Epoch: 9 cost time: 0.39403319358825684
Epoch: 9, Steps: 3 | Train Loss: 0.880 Vali Loss: 0.981 Vali Acc: 0.500 Test Loss: 0.981 Test Acc: 0.500
Validation loss decreased (-0.399990 --> -0.499990).  Saving model ...
Epoch: 10 cost time: 0.3942296504974365
Epoch: 10, Steps: 3 | Train Loss: 0.779 Vali Loss: 0.926 Vali Acc: 0.600 Test Loss: 0.926 Test Acc: 0.600
Validation loss decreased (-0.499990 --> -0.599991).  Saving model ...
Epoch: 11 cost time: 0.4026961326599121
Epoch: 11, Steps: 3 | Train Loss: 0.746 Vali Loss: 0.863 Vali Acc: 0.700 Test Loss: 0.863 Test Acc: 0.700
Validation loss decreased (-0.599991 --> -0.699991).  Saving model ...
Epoch: 12 cost time: 0.43355417251586914
Epoch: 12, Steps: 3 | Train Loss: 0.682 Vali Loss: 0.800 Vali Acc: 0.750 Test Loss: 0.800 Test Acc: 0.750
Validation loss decreased (-0.699991 --> -0.749992).  Saving model ...
Epoch: 13 cost time: 0.3818678855895996
Epoch: 13, Steps: 3 | Train Loss: 0.597 Vali Loss: 0.746 Vali Acc: 0.825 Test Loss: 0.746 Test Acc: 0.825
Validation loss decreased (-0.749992 --> -0.824993).  Saving model ...
Epoch: 14 cost time: 0.38184309005737305
Epoch: 14, Steps: 3 | Train Loss: 0.550 Vali Loss: 0.699 Vali Acc: 0.900 Test Loss: 0.699 Test Acc: 0.900
Validation loss decreased (-0.824993 --> -0.899993).  Saving model ...
Epoch: 15 cost time: 0.37540197372436523
Epoch: 15, Steps: 3 | Train Loss: 0.510 Vali Loss: 0.652 Vali Acc: 0.925 Test Loss: 0.652 Test Acc: 0.925
Validation loss decreased (-0.899993 --> -0.924993).  Saving model ...
Epoch: 16 cost time: 0.42914533615112305
Epoch: 16, Steps: 3 | Train Loss: 0.439 Vali Loss: 0.616 Vali Acc: 0.950 Test Loss: 0.616 Test Acc: 0.950
Validation loss decreased (-0.924993 --> -0.949994).  Saving model ...
Epoch: 17 cost time: 0.4153258800506592
Epoch: 17, Steps: 3 | Train Loss: 0.433 Vali Loss: 0.577 Vali Acc: 0.975 Test Loss: 0.577 Test Acc: 0.975
Validation loss decreased (-0.949994 --> -0.974994).  Saving model ...
Epoch: 18 cost time: 0.3848128318786621
Epoch: 18, Steps: 3 | Train Loss: 0.405 Vali Loss: 0.545 Vali Acc: 0.975 Test Loss: 0.545 Test Acc: 0.975
Validation loss decreased (-0.974994 --> -0.974995).  Saving model ...
Epoch: 19 cost time: 0.3552699089050293
Epoch: 19, Steps: 3 | Train Loss: 0.378 Vali Loss: 0.509 Vali Acc: 0.975 Test Loss: 0.509 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 20 cost time: 0.3340275287628174
Epoch: 20, Steps: 3 | Train Loss: 0.328 Vali Loss: 0.484 Vali Acc: 0.975 Test Loss: 0.484 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 21 cost time: 0.38512754440307617
Epoch: 21, Steps: 3 | Train Loss: 0.322 Vali Loss: 0.461 Vali Acc: 0.975 Test Loss: 0.461 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 22 cost time: 0.4096982479095459
Epoch: 22, Steps: 3 | Train Loss: 0.290 Vali Loss: 0.440 Vali Acc: 0.975 Test Loss: 0.440 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 23 cost time: 0.4331035614013672
Epoch: 23, Steps: 3 | Train Loss: 0.273 Vali Loss: 0.419 Vali Acc: 0.975 Test Loss: 0.419 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 24 cost time: 0.4248545169830322
Epoch: 24, Steps: 3 | Train Loss: 0.254 Vali Loss: 0.396 Vali Acc: 0.975 Test Loss: 0.396 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 25 cost time: 0.40735554695129395
Epoch: 25, Steps: 3 | Train Loss: 0.237 Vali Loss: 0.386 Vali Acc: 0.975 Test Loss: 0.386 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 26 cost time: 0.4485287666320801
Epoch: 26, Steps: 3 | Train Loss: 0.215 Vali Loss: 0.377 Vali Acc: 0.975 Test Loss: 0.377 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 27 cost time: 0.40405917167663574
Epoch: 27, Steps: 3 | Train Loss: 0.198 Vali Loss: 0.367 Vali Acc: 0.975 Test Loss: 0.367 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 28 cost time: 0.37132859230041504
Epoch: 28, Steps: 3 | Train Loss: 0.189 Vali Loss: 0.360 Vali Acc: 0.975 Test Loss: 0.360 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 29 cost time: 0.3649563789367676
Epoch: 29, Steps: 3 | Train Loss: 0.204 Vali Loss: 0.348 Vali Acc: 0.975 Test Loss: 0.348 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 30 cost time: 0.5001366138458252
Epoch: 30, Steps: 3 | Train Loss: 0.175 Vali Loss: 0.341 Vali Acc: 0.975 Test Loss: 0.341 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 31 cost time: 0.444286584854126
Epoch: 31, Steps: 3 | Train Loss: 0.163 Vali Loss: 0.332 Vali Acc: 0.975 Test Loss: 0.332 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 32 cost time: 0.4450039863586426
Epoch: 32, Steps: 3 | Train Loss: 0.140 Vali Loss: 0.315 Vali Acc: 0.975 Test Loss: 0.315 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 33 cost time: 0.41356849670410156
Epoch: 33, Steps: 3 | Train Loss: 0.136 Vali Loss: 0.302 Vali Acc: 0.975 Test Loss: 0.302 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 34 cost time: 0.39740967750549316
Epoch: 34, Steps: 3 | Train Loss: 0.126 Vali Loss: 0.301 Vali Acc: 0.950 Test Loss: 0.301 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.395294189453125
Epoch: 35, Steps: 3 | Train Loss: 0.137 Vali Loss: 0.299 Vali Acc: 0.950 Test Loss: 0.299 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.4251878261566162
Epoch: 36, Steps: 3 | Train Loss: 0.115 Vali Loss: 0.288 Vali Acc: 0.950 Test Loss: 0.288 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.4852867126464844
Epoch: 37, Steps: 3 | Train Loss: 0.126 Vali Loss: 0.285 Vali Acc: 0.950 Test Loss: 0.285 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.3922576904296875
Epoch: 38, Steps: 3 | Train Loss: 0.108 Vali Loss: 0.277 Vali Acc: 0.950 Test Loss: 0.277 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.3874356746673584
Epoch: 39, Steps: 3 | Train Loss: 0.108 Vali Loss: 0.279 Vali Acc: 0.950 Test Loss: 0.279 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.4518454074859619
Epoch: 40, Steps: 3 | Train Loss: 0.119 Vali Loss: 0.280 Vali Acc: 0.950 Test Loss: 0.280 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.40424060821533203
Epoch: 41, Steps: 3 | Train Loss: 0.099 Vali Loss: 0.278 Vali Acc: 0.925 Test Loss: 0.278 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.39339756965637207
Epoch: 42, Steps: 3 | Train Loss: 0.092 Vali Loss: 0.271 Vali Acc: 0.950 Test Loss: 0.271 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.4925661087036133
Epoch: 43, Steps: 3 | Train Loss: 0.081 Vali Loss: 0.271 Vali Acc: 0.950 Test Loss: 0.271 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 80356
model size : 0.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.6205334663391113
Epoch: 1, Steps: 3 | Train Loss: 1.486 Vali Loss: 1.380 Vali Acc: 0.125 Test Loss: 1.380 Test Acc: 0.125
Validation loss decreased (inf --> -0.124986).  Saving model ...
Epoch: 2 cost time: 0.5863497257232666
Epoch: 2, Steps: 3 | Train Loss: 1.468 Vali Loss: 1.354 Vali Acc: 0.150 Test Loss: 1.354 Test Acc: 0.150
Validation loss decreased (-0.124986 --> -0.149986).  Saving model ...
Epoch: 3 cost time: 0.386460542678833
Epoch: 3, Steps: 3 | Train Loss: 1.451 Vali Loss: 1.326 Vali Acc: 0.200 Test Loss: 1.326 Test Acc: 0.200
Validation loss decreased (-0.149986 --> -0.199987).  Saving model ...
Epoch: 4 cost time: 0.4648160934448242
Epoch: 4, Steps: 3 | Train Loss: 1.377 Vali Loss: 1.288 Vali Acc: 0.300 Test Loss: 1.288 Test Acc: 0.300
Validation loss decreased (-0.199987 --> -0.299987).  Saving model ...
Epoch: 5 cost time: 0.3952326774597168
Epoch: 5, Steps: 3 | Train Loss: 1.255 Vali Loss: 1.241 Vali Acc: 0.425 Test Loss: 1.241 Test Acc: 0.425
Validation loss decreased (-0.299987 --> -0.424988).  Saving model ...
Epoch: 6 cost time: 0.3979165554046631
Epoch: 6, Steps: 3 | Train Loss: 1.237 Vali Loss: 1.190 Vali Acc: 0.425 Test Loss: 1.190 Test Acc: 0.425
Validation loss decreased (-0.424988 --> -0.424988).  Saving model ...
Epoch: 7 cost time: 0.4341607093811035
Epoch: 7, Steps: 3 | Train Loss: 1.195 Vali Loss: 1.133 Vali Acc: 0.450 Test Loss: 1.133 Test Acc: 0.450
Validation loss decreased (-0.424988 --> -0.449989).  Saving model ...
Epoch: 8 cost time: 0.3931870460510254
Epoch: 8, Steps: 3 | Train Loss: 1.096 Vali Loss: 1.078 Vali Acc: 0.525 Test Loss: 1.078 Test Acc: 0.525
Validation loss decreased (-0.449989 --> -0.524989).  Saving model ...
Epoch: 9 cost time: 0.4004068374633789
Epoch: 9, Steps: 3 | Train Loss: 1.021 Vali Loss: 1.024 Vali Acc: 0.575 Test Loss: 1.024 Test Acc: 0.575
Validation loss decreased (-0.524989 --> -0.574990).  Saving model ...
Epoch: 10 cost time: 0.4614243507385254
Epoch: 10, Steps: 3 | Train Loss: 0.978 Vali Loss: 0.977 Vali Acc: 0.600 Test Loss: 0.977 Test Acc: 0.600
Validation loss decreased (-0.574990 --> -0.599990).  Saving model ...
Epoch: 11 cost time: 0.4056859016418457
Epoch: 11, Steps: 3 | Train Loss: 0.942 Vali Loss: 0.927 Vali Acc: 0.625 Test Loss: 0.927 Test Acc: 0.625
Validation loss decreased (-0.599990 --> -0.624991).  Saving model ...
Epoch: 12 cost time: 0.36368346214294434
Epoch: 12, Steps: 3 | Train Loss: 0.887 Vali Loss: 0.880 Vali Acc: 0.675 Test Loss: 0.880 Test Acc: 0.675
Validation loss decreased (-0.624991 --> -0.674991).  Saving model ...
Epoch: 13 cost time: 0.4958319664001465
Epoch: 13, Steps: 3 | Train Loss: 0.846 Vali Loss: 0.842 Vali Acc: 0.775 Test Loss: 0.842 Test Acc: 0.775
Validation loss decreased (-0.674991 --> -0.774992).  Saving model ...
Epoch: 14 cost time: 0.4295332431793213
Epoch: 14, Steps: 3 | Train Loss: 0.781 Vali Loss: 0.801 Vali Acc: 0.825 Test Loss: 0.801 Test Acc: 0.825
Validation loss decreased (-0.774992 --> -0.824992).  Saving model ...
Epoch: 15 cost time: 0.44955897331237793
Epoch: 15, Steps: 3 | Train Loss: 0.766 Vali Loss: 0.760 Vali Acc: 0.825 Test Loss: 0.760 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 16 cost time: 0.4255192279815674
Epoch: 16, Steps: 3 | Train Loss: 0.690 Vali Loss: 0.727 Vali Acc: 0.850 Test Loss: 0.727 Test Acc: 0.850
Validation loss decreased (-0.824992 --> -0.849993).  Saving model ...
Epoch: 17 cost time: 0.40068960189819336
Epoch: 17, Steps: 3 | Train Loss: 0.720 Vali Loss: 0.686 Vali Acc: 0.900 Test Loss: 0.686 Test Acc: 0.900
Validation loss decreased (-0.849993 --> -0.899993).  Saving model ...
Epoch: 18 cost time: 0.524404764175415
Epoch: 18, Steps: 3 | Train Loss: 0.604 Vali Loss: 0.654 Vali Acc: 0.900 Test Loss: 0.654 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 19 cost time: 0.409771203994751
Epoch: 19, Steps: 3 | Train Loss: 0.592 Vali Loss: 0.625 Vali Acc: 0.925 Test Loss: 0.625 Test Acc: 0.925
Validation loss decreased (-0.899993 --> -0.924994).  Saving model ...
Epoch: 20 cost time: 0.4983799457550049
Epoch: 20, Steps: 3 | Train Loss: 0.537 Vali Loss: 0.601 Vali Acc: 0.925 Test Loss: 0.601 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 21 cost time: 0.4107375144958496
Epoch: 21, Steps: 3 | Train Loss: 0.531 Vali Loss: 0.578 Vali Acc: 0.925 Test Loss: 0.578 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 22 cost time: 0.43790388107299805
Epoch: 22, Steps: 3 | Train Loss: 0.486 Vali Loss: 0.557 Vali Acc: 0.925 Test Loss: 0.557 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 23 cost time: 0.44308972358703613
Epoch: 23, Steps: 3 | Train Loss: 0.452 Vali Loss: 0.539 Vali Acc: 0.925 Test Loss: 0.539 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 24 cost time: 0.45811891555786133
Epoch: 24, Steps: 3 | Train Loss: 0.445 Vali Loss: 0.515 Vali Acc: 0.925 Test Loss: 0.515 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 25 cost time: 0.415508508682251
Epoch: 25, Steps: 3 | Train Loss: 0.411 Vali Loss: 0.491 Vali Acc: 0.975 Test Loss: 0.491 Test Acc: 0.975
Validation loss decreased (-0.924995 --> -0.974995).  Saving model ...
Epoch: 26 cost time: 0.466536283493042
Epoch: 26, Steps: 3 | Train Loss: 0.391 Vali Loss: 0.465 Vali Acc: 0.975 Test Loss: 0.465 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 27 cost time: 0.4672837257385254
Epoch: 27, Steps: 3 | Train Loss: 0.332 Vali Loss: 0.450 Vali Acc: 0.975 Test Loss: 0.450 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 28 cost time: 0.46857213973999023
Epoch: 28, Steps: 3 | Train Loss: 0.343 Vali Loss: 0.426 Vali Acc: 0.975 Test Loss: 0.426 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 29 cost time: 0.4010772705078125
Epoch: 29, Steps: 3 | Train Loss: 0.327 Vali Loss: 0.409 Vali Acc: 0.975 Test Loss: 0.409 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 30 cost time: 0.4052238464355469
Epoch: 30, Steps: 3 | Train Loss: 0.313 Vali Loss: 0.396 Vali Acc: 0.975 Test Loss: 0.396 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 31 cost time: 0.4284360408782959
Epoch: 31, Steps: 3 | Train Loss: 0.295 Vali Loss: 0.380 Vali Acc: 0.975 Test Loss: 0.380 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 32 cost time: 0.37505555152893066
Epoch: 32, Steps: 3 | Train Loss: 0.279 Vali Loss: 0.375 Vali Acc: 0.975 Test Loss: 0.375 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 33 cost time: 0.3339540958404541
Epoch: 33, Steps: 3 | Train Loss: 0.267 Vali Loss: 0.358 Vali Acc: 0.975 Test Loss: 0.358 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 34 cost time: 0.4850952625274658
Epoch: 34, Steps: 3 | Train Loss: 0.253 Vali Loss: 0.344 Vali Acc: 0.975 Test Loss: 0.344 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 35 cost time: 0.5412302017211914
Epoch: 35, Steps: 3 | Train Loss: 0.262 Vali Loss: 0.327 Vali Acc: 0.975 Test Loss: 0.327 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 36 cost time: 0.5160152912139893
Epoch: 36, Steps: 3 | Train Loss: 0.227 Vali Loss: 0.320 Vali Acc: 0.975 Test Loss: 0.320 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 37 cost time: 0.45578885078430176
Epoch: 37, Steps: 3 | Train Loss: 0.229 Vali Loss: 0.311 Vali Acc: 0.975 Test Loss: 0.311 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 38 cost time: 0.39980030059814453
Epoch: 38, Steps: 3 | Train Loss: 0.191 Vali Loss: 0.303 Vali Acc: 0.975 Test Loss: 0.303 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 39 cost time: 0.45725250244140625
Epoch: 39, Steps: 3 | Train Loss: 0.174 Vali Loss: 0.287 Vali Acc: 0.975 Test Loss: 0.287 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 40 cost time: 0.3971676826477051
Epoch: 40, Steps: 3 | Train Loss: 0.182 Vali Loss: 0.279 Vali Acc: 0.975 Test Loss: 0.279 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 41 cost time: 0.4298214912414551
Epoch: 41, Steps: 3 | Train Loss: 0.182 Vali Loss: 0.270 Vali Acc: 0.975 Test Loss: 0.270 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 42 cost time: 0.4675874710083008
Epoch: 42, Steps: 3 | Train Loss: 0.165 Vali Loss: 0.259 Vali Acc: 0.975 Test Loss: 0.259 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 43 cost time: 0.4587585926055908
Epoch: 43, Steps: 3 | Train Loss: 0.181 Vali Loss: 0.254 Vali Acc: 0.975 Test Loss: 0.254 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 44 cost time: 0.4448823928833008
Epoch: 44, Steps: 3 | Train Loss: 0.154 Vali Loss: 0.249 Vali Acc: 0.975 Test Loss: 0.249 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 45 cost time: 0.4270009994506836
Epoch: 45, Steps: 3 | Train Loss: 0.168 Vali Loss: 0.252 Vali Acc: 0.975 Test Loss: 0.252 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.44431090354919434
Epoch: 46, Steps: 3 | Train Loss: 0.161 Vali Loss: 0.255 Vali Acc: 0.975 Test Loss: 0.255 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.4596121311187744
Epoch: 47, Steps: 3 | Train Loss: 0.141 Vali Loss: 0.245 Vali Acc: 0.975 Test Loss: 0.245 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 48 cost time: 0.4733543395996094
Epoch: 48, Steps: 3 | Train Loss: 0.109 Vali Loss: 0.231 Vali Acc: 0.975 Test Loss: 0.231 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 49 cost time: 0.4044220447540283
Epoch: 49, Steps: 3 | Train Loss: 0.108 Vali Loss: 0.228 Vali Acc: 0.975 Test Loss: 0.228 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 50 cost time: 0.5366349220275879
Epoch: 50, Steps: 3 | Train Loss: 0.113 Vali Loss: 0.224 Vali Acc: 0.975 Test Loss: 0.224 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 74372
model size : 0.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps20_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.8140971660614014
Epoch: 1, Steps: 3 | Train Loss: 1.438 Vali Loss: 1.466 Vali Acc: 0.050 Test Loss: 1.466 Test Acc: 0.050
Validation loss decreased (inf --> -0.049985).  Saving model ...
Epoch: 2 cost time: 0.3818235397338867
Epoch: 2, Steps: 3 | Train Loss: 1.447 Vali Loss: 1.449 Vali Acc: 0.075 Test Loss: 1.449 Test Acc: 0.075
Validation loss decreased (-0.049985 --> -0.074986).  Saving model ...
Epoch: 3 cost time: 0.437863826751709
Epoch: 3, Steps: 3 | Train Loss: 1.347 Vali Loss: 1.432 Vali Acc: 0.075 Test Loss: 1.432 Test Acc: 0.075
Validation loss decreased (-0.074986 --> -0.074986).  Saving model ...
Epoch: 4 cost time: 0.4092440605163574
Epoch: 4, Steps: 3 | Train Loss: 1.371 Vali Loss: 1.403 Vali Acc: 0.150 Test Loss: 1.403 Test Acc: 0.150
Validation loss decreased (-0.074986 --> -0.149986).  Saving model ...
Epoch: 5 cost time: 0.48831725120544434
Epoch: 5, Steps: 3 | Train Loss: 1.334 Vali Loss: 1.366 Vali Acc: 0.175 Test Loss: 1.366 Test Acc: 0.175
Validation loss decreased (-0.149986 --> -0.174986).  Saving model ...
Epoch: 6 cost time: 0.45476484298706055
Epoch: 6, Steps: 3 | Train Loss: 1.294 Vali Loss: 1.324 Vali Acc: 0.200 Test Loss: 1.324 Test Acc: 0.200
Validation loss decreased (-0.174986 --> -0.199987).  Saving model ...
Epoch: 7 cost time: 0.453594446182251
Epoch: 7, Steps: 3 | Train Loss: 1.199 Vali Loss: 1.275 Vali Acc: 0.275 Test Loss: 1.275 Test Acc: 0.275
Validation loss decreased (-0.199987 --> -0.274987).  Saving model ...
Epoch: 8 cost time: 0.4135007858276367
Epoch: 8, Steps: 3 | Train Loss: 1.132 Vali Loss: 1.224 Vali Acc: 0.325 Test Loss: 1.224 Test Acc: 0.325
Validation loss decreased (-0.274987 --> -0.324988).  Saving model ...
Epoch: 9 cost time: 0.4143965244293213
Epoch: 9, Steps: 3 | Train Loss: 1.090 Vali Loss: 1.173 Vali Acc: 0.375 Test Loss: 1.173 Test Acc: 0.375
Validation loss decreased (-0.324988 --> -0.374988).  Saving model ...
Epoch: 10 cost time: 0.5223994255065918
Epoch: 10, Steps: 3 | Train Loss: 1.059 Vali Loss: 1.117 Vali Acc: 0.450 Test Loss: 1.117 Test Acc: 0.450
Validation loss decreased (-0.374988 --> -0.449989).  Saving model ...
Epoch: 11 cost time: 0.46180272102355957
Epoch: 11, Steps: 3 | Train Loss: 0.998 Vali Loss: 1.071 Vali Acc: 0.500 Test Loss: 1.071 Test Acc: 0.500
Validation loss decreased (-0.449989 --> -0.499989).  Saving model ...
Epoch: 12 cost time: 0.4731471538543701
Epoch: 12, Steps: 3 | Train Loss: 0.972 Vali Loss: 1.020 Vali Acc: 0.575 Test Loss: 1.020 Test Acc: 0.575
Validation loss decreased (-0.499989 --> -0.574990).  Saving model ...
Epoch: 13 cost time: 0.38948488235473633
Epoch: 13, Steps: 3 | Train Loss: 0.902 Vali Loss: 0.969 Vali Acc: 0.625 Test Loss: 0.969 Test Acc: 0.625
Validation loss decreased (-0.574990 --> -0.624990).  Saving model ...
Epoch: 14 cost time: 0.4443488121032715
Epoch: 14, Steps: 3 | Train Loss: 0.837 Vali Loss: 0.928 Vali Acc: 0.725 Test Loss: 0.928 Test Acc: 0.725
Validation loss decreased (-0.624990 --> -0.724991).  Saving model ...
Epoch: 15 cost time: 0.4941284656524658
Epoch: 15, Steps: 3 | Train Loss: 0.801 Vali Loss: 0.892 Vali Acc: 0.750 Test Loss: 0.892 Test Acc: 0.750
Validation loss decreased (-0.724991 --> -0.749991).  Saving model ...
Epoch: 16 cost time: 0.4770803451538086
Epoch: 16, Steps: 3 | Train Loss: 0.711 Vali Loss: 0.854 Vali Acc: 0.800 Test Loss: 0.854 Test Acc: 0.800
Validation loss decreased (-0.749991 --> -0.799991).  Saving model ...
Epoch: 17 cost time: 0.5521230697631836
Epoch: 17, Steps: 3 | Train Loss: 0.694 Vali Loss: 0.819 Vali Acc: 0.850 Test Loss: 0.819 Test Acc: 0.850
Validation loss decreased (-0.799991 --> -0.849992).  Saving model ...
Epoch: 18 cost time: 0.5187902450561523
Epoch: 18, Steps: 3 | Train Loss: 0.702 Vali Loss: 0.782 Vali Acc: 0.875 Test Loss: 0.782 Test Acc: 0.875
Validation loss decreased (-0.849992 --> -0.874992).  Saving model ...
Epoch: 19 cost time: 0.5180964469909668
Epoch: 19, Steps: 3 | Train Loss: 0.662 Vali Loss: 0.745 Vali Acc: 0.875 Test Loss: 0.745 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874993).  Saving model ...
Epoch: 20 cost time: 0.5086276531219482
Epoch: 20, Steps: 3 | Train Loss: 0.623 Vali Loss: 0.705 Vali Acc: 0.900 Test Loss: 0.705 Test Acc: 0.900
Validation loss decreased (-0.874993 --> -0.899993).  Saving model ...
Epoch: 21 cost time: 0.47110772132873535
Epoch: 21, Steps: 3 | Train Loss: 0.577 Vali Loss: 0.671 Vali Acc: 0.925 Test Loss: 0.671 Test Acc: 0.925
Validation loss decreased (-0.899993 --> -0.924993).  Saving model ...
Epoch: 22 cost time: 0.38927745819091797
Epoch: 22, Steps: 3 | Train Loss: 0.540 Vali Loss: 0.643 Vali Acc: 0.925 Test Loss: 0.643 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924994).  Saving model ...
Epoch: 23 cost time: 0.48537421226501465
Epoch: 23, Steps: 3 | Train Loss: 0.524 Vali Loss: 0.612 Vali Acc: 0.925 Test Loss: 0.612 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 24 cost time: 0.46312761306762695
Epoch: 24, Steps: 3 | Train Loss: 0.490 Vali Loss: 0.585 Vali Acc: 0.925 Test Loss: 0.585 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 25 cost time: 0.4757106304168701
Epoch: 25, Steps: 3 | Train Loss: 0.426 Vali Loss: 0.554 Vali Acc: 0.975 Test Loss: 0.554 Test Acc: 0.975
Validation loss decreased (-0.924994 --> -0.974994).  Saving model ...
Epoch: 26 cost time: 0.5287375450134277
Epoch: 26, Steps: 3 | Train Loss: 0.445 Vali Loss: 0.532 Vali Acc: 0.950 Test Loss: 0.532 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.532477855682373
Epoch: 27, Steps: 3 | Train Loss: 0.408 Vali Loss: 0.519 Vali Acc: 0.950 Test Loss: 0.519 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.4707605838775635
Epoch: 28, Steps: 3 | Train Loss: 0.389 Vali Loss: 0.501 Vali Acc: 0.950 Test Loss: 0.501 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.4251871109008789
Epoch: 29, Steps: 3 | Train Loss: 0.381 Vali Loss: 0.485 Vali Acc: 0.950 Test Loss: 0.485 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.533315896987915
Epoch: 30, Steps: 3 | Train Loss: 0.353 Vali Loss: 0.465 Vali Acc: 0.950 Test Loss: 0.465 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.5435605049133301
Epoch: 31, Steps: 3 | Train Loss: 0.336 Vali Loss: 0.445 Vali Acc: 0.950 Test Loss: 0.445 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.6012234687805176
Epoch: 32, Steps: 3 | Train Loss: 0.315 Vali Loss: 0.442 Vali Acc: 0.950 Test Loss: 0.442 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.529700756072998
Epoch: 33, Steps: 3 | Train Loss: 0.313 Vali Loss: 0.430 Vali Acc: 0.950 Test Loss: 0.430 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.5155608654022217
Epoch: 34, Steps: 3 | Train Loss: 0.285 Vali Loss: 0.422 Vali Acc: 0.950 Test Loss: 0.422 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.578585147857666
Epoch: 35, Steps: 3 | Train Loss: 0.312 Vali Loss: 0.411 Vali Acc: 0.950 Test Loss: 0.411 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps20_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 72996
model size : 0.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps25_str13_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.6308605670928955
Epoch: 1, Steps: 3 | Train Loss: 1.284 Vali Loss: 1.374 Vali Acc: 0.375 Test Loss: 1.374 Test Acc: 0.375
Validation loss decreased (inf --> -0.374986).  Saving model ...
Epoch: 2 cost time: 0.43067097663879395
Epoch: 2, Steps: 3 | Train Loss: 1.222 Vali Loss: 1.352 Vali Acc: 0.350 Test Loss: 1.352 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.38367509841918945
Epoch: 3, Steps: 3 | Train Loss: 1.239 Vali Loss: 1.330 Vali Acc: 0.350 Test Loss: 1.330 Test Acc: 0.350
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.35544896125793457
Epoch: 4, Steps: 3 | Train Loss: 1.212 Vali Loss: 1.301 Vali Acc: 0.350 Test Loss: 1.301 Test Acc: 0.350
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.4359142780303955
Epoch: 5, Steps: 3 | Train Loss: 1.216 Vali Loss: 1.269 Vali Acc: 0.375 Test Loss: 1.269 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374987).  Saving model ...
Epoch: 6 cost time: 0.40584659576416016
Epoch: 6, Steps: 3 | Train Loss: 1.171 Vali Loss: 1.233 Vali Acc: 0.425 Test Loss: 1.233 Test Acc: 0.425
Validation loss decreased (-0.374987 --> -0.424988).  Saving model ...
Epoch: 7 cost time: 0.3583545684814453
Epoch: 7, Steps: 3 | Train Loss: 1.111 Vali Loss: 1.195 Vali Acc: 0.475 Test Loss: 1.195 Test Acc: 0.475
Validation loss decreased (-0.424988 --> -0.474988).  Saving model ...
Epoch: 8 cost time: 0.422959566116333
Epoch: 8, Steps: 3 | Train Loss: 1.132 Vali Loss: 1.155 Vali Acc: 0.525 Test Loss: 1.155 Test Acc: 0.525
Validation loss decreased (-0.474988 --> -0.524988).  Saving model ...
Epoch: 9 cost time: 0.3538551330566406
Epoch: 9, Steps: 3 | Train Loss: 1.022 Vali Loss: 1.119 Vali Acc: 0.600 Test Loss: 1.119 Test Acc: 0.600
Validation loss decreased (-0.524988 --> -0.599989).  Saving model ...
Epoch: 10 cost time: 0.33514857292175293
Epoch: 10, Steps: 3 | Train Loss: 1.016 Vali Loss: 1.080 Vali Acc: 0.625 Test Loss: 1.080 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624989).  Saving model ...
Epoch: 11 cost time: 0.38762927055358887
Epoch: 11, Steps: 3 | Train Loss: 0.965 Vali Loss: 1.045 Vali Acc: 0.625 Test Loss: 1.045 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624990).  Saving model ...
Epoch: 12 cost time: 0.48085761070251465
Epoch: 12, Steps: 3 | Train Loss: 0.943 Vali Loss: 1.012 Vali Acc: 0.675 Test Loss: 1.012 Test Acc: 0.675
Validation loss decreased (-0.624990 --> -0.674990).  Saving model ...
Epoch: 13 cost time: 0.3718564510345459
Epoch: 13, Steps: 3 | Train Loss: 0.896 Vali Loss: 0.983 Vali Acc: 0.725 Test Loss: 0.983 Test Acc: 0.725
Validation loss decreased (-0.674990 --> -0.724990).  Saving model ...
Epoch: 14 cost time: 0.40261292457580566
Epoch: 14, Steps: 3 | Train Loss: 0.849 Vali Loss: 0.952 Vali Acc: 0.750 Test Loss: 0.952 Test Acc: 0.750
Validation loss decreased (-0.724990 --> -0.749990).  Saving model ...
Epoch: 15 cost time: 0.3926205635070801
Epoch: 15, Steps: 3 | Train Loss: 0.790 Vali Loss: 0.928 Vali Acc: 0.800 Test Loss: 0.928 Test Acc: 0.800
Validation loss decreased (-0.749990 --> -0.799991).  Saving model ...
Epoch: 16 cost time: 0.39214229583740234
Epoch: 16, Steps: 3 | Train Loss: 0.800 Vali Loss: 0.895 Vali Acc: 0.800 Test Loss: 0.895 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799991).  Saving model ...
Epoch: 17 cost time: 0.3675875663757324
Epoch: 17, Steps: 3 | Train Loss: 0.742 Vali Loss: 0.868 Vali Acc: 0.800 Test Loss: 0.868 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799991).  Saving model ...
Epoch: 18 cost time: 0.3464066982269287
Epoch: 18, Steps: 3 | Train Loss: 0.710 Vali Loss: 0.846 Vali Acc: 0.800 Test Loss: 0.846 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799992).  Saving model ...
Epoch: 19 cost time: 0.4009976387023926
Epoch: 19, Steps: 3 | Train Loss: 0.720 Vali Loss: 0.817 Vali Acc: 0.800 Test Loss: 0.817 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 20 cost time: 0.3963429927825928
Epoch: 20, Steps: 3 | Train Loss: 0.687 Vali Loss: 0.792 Vali Acc: 0.850 Test Loss: 0.792 Test Acc: 0.850
Validation loss decreased (-0.799992 --> -0.849992).  Saving model ...
Epoch: 21 cost time: 0.3762931823730469
Epoch: 21, Steps: 3 | Train Loss: 0.638 Vali Loss: 0.769 Vali Acc: 0.900 Test Loss: 0.769 Test Acc: 0.900
Validation loss decreased (-0.849992 --> -0.899992).  Saving model ...
Epoch: 22 cost time: 0.43134236335754395
Epoch: 22, Steps: 3 | Train Loss: 0.632 Vali Loss: 0.743 Vali Acc: 0.900 Test Loss: 0.743 Test Acc: 0.900
Validation loss decreased (-0.899992 --> -0.899993).  Saving model ...
Epoch: 23 cost time: 0.4239237308502197
Epoch: 23, Steps: 3 | Train Loss: 0.605 Vali Loss: 0.725 Vali Acc: 0.900 Test Loss: 0.725 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 24 cost time: 0.41414713859558105
Epoch: 24, Steps: 3 | Train Loss: 0.550 Vali Loss: 0.700 Vali Acc: 0.900 Test Loss: 0.700 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 25 cost time: 0.3597452640533447
Epoch: 25, Steps: 3 | Train Loss: 0.565 Vali Loss: 0.682 Vali Acc: 0.900 Test Loss: 0.682 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 26 cost time: 0.419391393661499
Epoch: 26, Steps: 3 | Train Loss: 0.562 Vali Loss: 0.661 Vali Acc: 0.900 Test Loss: 0.661 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 27 cost time: 0.3487567901611328
Epoch: 27, Steps: 3 | Train Loss: 0.494 Vali Loss: 0.643 Vali Acc: 0.900 Test Loss: 0.643 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899994).  Saving model ...
Epoch: 28 cost time: 0.377277135848999
Epoch: 28, Steps: 3 | Train Loss: 0.479 Vali Loss: 0.633 Vali Acc: 0.925 Test Loss: 0.633 Test Acc: 0.925
Validation loss decreased (-0.899994 --> -0.924994).  Saving model ...
Epoch: 29 cost time: 0.41678857803344727
Epoch: 29, Steps: 3 | Train Loss: 0.444 Vali Loss: 0.621 Vali Acc: 0.925 Test Loss: 0.621 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 30 cost time: 0.3543558120727539
Epoch: 30, Steps: 3 | Train Loss: 0.455 Vali Loss: 0.600 Vali Acc: 0.925 Test Loss: 0.600 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 31 cost time: 0.33115100860595703
Epoch: 31, Steps: 3 | Train Loss: 0.429 Vali Loss: 0.578 Vali Acc: 0.925 Test Loss: 0.578 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 32 cost time: 0.4162905216217041
Epoch: 32, Steps: 3 | Train Loss: 0.412 Vali Loss: 0.564 Vali Acc: 0.925 Test Loss: 0.564 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 33 cost time: 0.4749612808227539
Epoch: 33, Steps: 3 | Train Loss: 0.419 Vali Loss: 0.548 Vali Acc: 0.925 Test Loss: 0.548 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 34 cost time: 0.39507532119750977
Epoch: 34, Steps: 3 | Train Loss: 0.399 Vali Loss: 0.534 Vali Acc: 0.925 Test Loss: 0.534 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 35 cost time: 0.3940761089324951
Epoch: 35, Steps: 3 | Train Loss: 0.371 Vali Loss: 0.518 Vali Acc: 0.925 Test Loss: 0.518 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 36 cost time: 0.3498804569244385
Epoch: 36, Steps: 3 | Train Loss: 0.341 Vali Loss: 0.509 Vali Acc: 0.950 Test Loss: 0.509 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949995).  Saving model ...
Epoch: 37 cost time: 0.40654778480529785
Epoch: 37, Steps: 3 | Train Loss: 0.339 Vali Loss: 0.500 Vali Acc: 0.950 Test Loss: 0.500 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 38 cost time: 0.4092719554901123
Epoch: 38, Steps: 3 | Train Loss: 0.345 Vali Loss: 0.481 Vali Acc: 0.950 Test Loss: 0.481 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 39 cost time: 0.4032747745513916
Epoch: 39, Steps: 3 | Train Loss: 0.311 Vali Loss: 0.461 Vali Acc: 0.950 Test Loss: 0.461 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 40 cost time: 0.3809230327606201
Epoch: 40, Steps: 3 | Train Loss: 0.303 Vali Loss: 0.450 Vali Acc: 0.950 Test Loss: 0.450 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 41 cost time: 0.4123086929321289
Epoch: 41, Steps: 3 | Train Loss: 0.293 Vali Loss: 0.427 Vali Acc: 0.950 Test Loss: 0.427 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 42 cost time: 0.4318509101867676
Epoch: 42, Steps: 3 | Train Loss: 0.294 Vali Loss: 0.419 Vali Acc: 0.950 Test Loss: 0.419 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 43 cost time: 0.36727428436279297
Epoch: 43, Steps: 3 | Train Loss: 0.270 Vali Loss: 0.409 Vali Acc: 0.950 Test Loss: 0.409 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 44 cost time: 0.38909459114074707
Epoch: 44, Steps: 3 | Train Loss: 0.262 Vali Loss: 0.398 Vali Acc: 0.950 Test Loss: 0.398 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 45 cost time: 0.3630867004394531
Epoch: 45, Steps: 3 | Train Loss: 0.261 Vali Loss: 0.386 Vali Acc: 0.950 Test Loss: 0.386 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 46 cost time: 0.40108227729797363
Epoch: 46, Steps: 3 | Train Loss: 0.265 Vali Loss: 0.372 Vali Acc: 0.950 Test Loss: 0.372 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 47 cost time: 0.43666648864746094
Epoch: 47, Steps: 3 | Train Loss: 0.232 Vali Loss: 0.369 Vali Acc: 0.950 Test Loss: 0.369 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 48 cost time: 0.3958280086517334
Epoch: 48, Steps: 3 | Train Loss: 0.219 Vali Loss: 0.360 Vali Acc: 0.950 Test Loss: 0.360 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 49 cost time: 0.4205307960510254
Epoch: 49, Steps: 3 | Train Loss: 0.230 Vali Loss: 0.355 Vali Acc: 0.950 Test Loss: 0.355 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 50 cost time: 0.45252203941345215
Epoch: 50, Steps: 3 | Train Loss: 0.209 Vali Loss: 0.350 Vali Acc: 0.950 Test Loss: 0.350 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps25_str13_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 70852
model size : 0.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.736586332321167
Epoch: 1, Steps: 3 | Train Loss: 1.470 Vali Loss: 1.412 Vali Acc: 0.150 Test Loss: 1.412 Test Acc: 0.150
Validation loss decreased (inf --> -0.149986).  Saving model ...
Epoch: 2 cost time: 0.49109935760498047
Epoch: 2, Steps: 3 | Train Loss: 1.413 Vali Loss: 1.405 Vali Acc: 0.150 Test Loss: 1.405 Test Acc: 0.150
Validation loss decreased (-0.149986 --> -0.149986).  Saving model ...
Epoch: 3 cost time: 0.48428773880004883
Epoch: 3, Steps: 3 | Train Loss: 1.367 Vali Loss: 1.383 Vali Acc: 0.175 Test Loss: 1.383 Test Acc: 0.175
Validation loss decreased (-0.149986 --> -0.174986).  Saving model ...
Epoch: 4 cost time: 0.43950438499450684
Epoch: 4, Steps: 3 | Train Loss: 1.278 Vali Loss: 1.344 Vali Acc: 0.325 Test Loss: 1.344 Test Acc: 0.325
Validation loss decreased (-0.174986 --> -0.324987).  Saving model ...
Epoch: 5 cost time: 0.47783613204956055
Epoch: 5, Steps: 3 | Train Loss: 1.163 Vali Loss: 1.288 Vali Acc: 0.525 Test Loss: 1.288 Test Acc: 0.525
Validation loss decreased (-0.324987 --> -0.524987).  Saving model ...
Epoch: 6 cost time: 0.5711288452148438
Epoch: 6, Steps: 3 | Train Loss: 1.081 Vali Loss: 1.216 Vali Acc: 0.625 Test Loss: 1.216 Test Acc: 0.625
Validation loss decreased (-0.524987 --> -0.624988).  Saving model ...
Epoch: 7 cost time: 0.6175746917724609
Epoch: 7, Steps: 3 | Train Loss: 0.945 Vali Loss: 1.143 Vali Acc: 0.875 Test Loss: 1.143 Test Acc: 0.875
Validation loss decreased (-0.624988 --> -0.874989).  Saving model ...
Epoch: 8 cost time: 0.5027062892913818
Epoch: 8, Steps: 3 | Train Loss: 0.868 Vali Loss: 1.051 Vali Acc: 0.825 Test Loss: 1.051 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.4920616149902344
Epoch: 9, Steps: 3 | Train Loss: 0.765 Vali Loss: 0.957 Vali Acc: 0.775 Test Loss: 0.957 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.5595371723175049
Epoch: 10, Steps: 3 | Train Loss: 0.688 Vali Loss: 0.872 Vali Acc: 0.825 Test Loss: 0.872 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.44417786598205566
Epoch: 11, Steps: 3 | Train Loss: 0.599 Vali Loss: 0.787 Vali Acc: 0.850 Test Loss: 0.787 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.46489953994750977
Epoch: 12, Steps: 3 | Train Loss: 0.519 Vali Loss: 0.723 Vali Acc: 0.850 Test Loss: 0.723 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.584052324295044
Epoch: 13, Steps: 3 | Train Loss: 0.481 Vali Loss: 0.660 Vali Acc: 0.875 Test Loss: 0.660 Test Acc: 0.875
Validation loss decreased (-0.874989 --> -0.874993).  Saving model ...
Epoch: 14 cost time: 0.511589527130127
Epoch: 14, Steps: 3 | Train Loss: 0.431 Vali Loss: 0.581 Vali Acc: 0.925 Test Loss: 0.581 Test Acc: 0.925
Validation loss decreased (-0.874993 --> -0.924994).  Saving model ...
Epoch: 15 cost time: 0.5436041355133057
Epoch: 15, Steps: 3 | Train Loss: 0.379 Vali Loss: 0.526 Vali Acc: 0.925 Test Loss: 0.526 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 16 cost time: 0.5142168998718262
Epoch: 16, Steps: 3 | Train Loss: 0.337 Vali Loss: 0.481 Vali Acc: 0.950 Test Loss: 0.481 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949995).  Saving model ...
Epoch: 17 cost time: 0.5402963161468506
Epoch: 17, Steps: 3 | Train Loss: 0.285 Vali Loss: 0.438 Vali Acc: 0.950 Test Loss: 0.438 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 18 cost time: 0.5591912269592285
Epoch: 18, Steps: 3 | Train Loss: 0.291 Vali Loss: 0.405 Vali Acc: 0.925 Test Loss: 0.405 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.45249128341674805
Epoch: 19, Steps: 3 | Train Loss: 0.240 Vali Loss: 0.393 Vali Acc: 0.925 Test Loss: 0.393 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.4419138431549072
Epoch: 20, Steps: 3 | Train Loss: 0.222 Vali Loss: 0.355 Vali Acc: 0.925 Test Loss: 0.355 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.4319741725921631
Epoch: 21, Steps: 3 | Train Loss: 0.207 Vali Loss: 0.323 Vali Acc: 0.925 Test Loss: 0.323 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.49767637252807617
Epoch: 22, Steps: 3 | Train Loss: 0.174 Vali Loss: 0.306 Vali Acc: 0.925 Test Loss: 0.306 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.5137743949890137
Epoch: 23, Steps: 3 | Train Loss: 0.185 Vali Loss: 0.274 Vali Acc: 0.950 Test Loss: 0.274 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 24 cost time: 0.48495984077453613
Epoch: 24, Steps: 3 | Train Loss: 0.157 Vali Loss: 0.252 Vali Acc: 0.950 Test Loss: 0.252 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 25 cost time: 0.45452237129211426
Epoch: 25, Steps: 3 | Train Loss: 0.131 Vali Loss: 0.229 Vali Acc: 0.950 Test Loss: 0.229 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 26 cost time: 0.5018775463104248
Epoch: 26, Steps: 3 | Train Loss: 0.127 Vali Loss: 0.218 Vali Acc: 0.950 Test Loss: 0.218 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 27 cost time: 0.48019933700561523
Epoch: 27, Steps: 3 | Train Loss: 0.121 Vali Loss: 0.205 Vali Acc: 0.950 Test Loss: 0.205 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 28 cost time: 0.4299132823944092
Epoch: 28, Steps: 3 | Train Loss: 0.095 Vali Loss: 0.198 Vali Acc: 0.950 Test Loss: 0.198 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 29 cost time: 0.525336503982544
Epoch: 29, Steps: 3 | Train Loss: 0.087 Vali Loss: 0.194 Vali Acc: 0.950 Test Loss: 0.194 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 30 cost time: 0.5025539398193359
Epoch: 30, Steps: 3 | Train Loss: 0.092 Vali Loss: 0.188 Vali Acc: 0.950 Test Loss: 0.188 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 31 cost time: 0.5441927909851074
Epoch: 31, Steps: 3 | Train Loss: 0.073 Vali Loss: 0.181 Vali Acc: 0.950 Test Loss: 0.181 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 32 cost time: 0.5164296627044678
Epoch: 32, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.178 Vali Acc: 0.950 Test Loss: 0.178 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 33 cost time: 0.5352580547332764
Epoch: 33, Steps: 3 | Train Loss: 0.068 Vali Loss: 0.170 Vali Acc: 0.950 Test Loss: 0.170 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 34 cost time: 0.5317955017089844
Epoch: 34, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.166 Vali Acc: 0.950 Test Loss: 0.166 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 35 cost time: 0.522587776184082
Epoch: 35, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.162 Vali Acc: 0.950 Test Loss: 0.162 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 36 cost time: 0.5661981105804443
Epoch: 36, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.161 Vali Acc: 0.950 Test Loss: 0.161 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 37 cost time: 0.5594122409820557
Epoch: 37, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.159 Vali Acc: 0.950 Test Loss: 0.159 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 38 cost time: 0.46448540687561035
Epoch: 38, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.152 Vali Acc: 0.950 Test Loss: 0.152 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 39 cost time: 0.48447632789611816
Epoch: 39, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.151 Vali Acc: 0.950 Test Loss: 0.151 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 40 cost time: 0.49548959732055664
Epoch: 40, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.152 Vali Acc: 0.950 Test Loss: 0.152 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.5400667190551758
Epoch: 41, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.151 Vali Acc: 0.950 Test Loss: 0.151 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 42 cost time: 0.5434303283691406
Epoch: 42, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.155 Vali Acc: 0.950 Test Loss: 0.155 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.4911952018737793
Epoch: 43, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.149 Vali Acc: 0.950 Test Loss: 0.149 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949999).  Saving model ...
Epoch: 44 cost time: 0.47460389137268066
Epoch: 44, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.143 Vali Acc: 0.950 Test Loss: 0.143 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 45 cost time: 0.5215785503387451
Epoch: 45, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.141 Vali Acc: 0.950 Test Loss: 0.141 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 46 cost time: 0.48113107681274414
Epoch: 46, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.138 Vali Acc: 0.950 Test Loss: 0.138 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 47 cost time: 0.525951623916626
Epoch: 47, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.138 Vali Acc: 0.950 Test Loss: 0.138 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 48 cost time: 0.4710111618041992
Epoch: 48, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.141 Vali Acc: 0.950 Test Loss: 0.141 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.4759652614593506
Epoch: 49, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.140 Vali Acc: 0.950 Test Loss: 0.140 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.49345898628234863
Epoch: 50, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.143 Vali Acc: 0.950 Test Loss: 0.143 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 647428
model size : 2.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.7609224319458008
Epoch: 1, Steps: 3 | Train Loss: 1.357 Vali Loss: 1.356 Vali Acc: 0.275 Test Loss: 1.356 Test Acc: 0.275
Validation loss decreased (inf --> -0.274986).  Saving model ...
Epoch: 2 cost time: 0.49489259719848633
Epoch: 2, Steps: 3 | Train Loss: 1.327 Vali Loss: 1.340 Vali Acc: 0.350 Test Loss: 1.340 Test Acc: 0.350
Validation loss decreased (-0.274986 --> -0.349987).  Saving model ...
Epoch: 3 cost time: 0.44780898094177246
Epoch: 3, Steps: 3 | Train Loss: 1.297 Vali Loss: 1.314 Vali Acc: 0.450 Test Loss: 1.314 Test Acc: 0.450
Validation loss decreased (-0.349987 --> -0.449987).  Saving model ...
Epoch: 4 cost time: 0.4533252716064453
Epoch: 4, Steps: 3 | Train Loss: 1.214 Vali Loss: 1.272 Vali Acc: 0.625 Test Loss: 1.272 Test Acc: 0.625
Validation loss decreased (-0.449987 --> -0.624987).  Saving model ...
Epoch: 5 cost time: 0.44487810134887695
Epoch: 5, Steps: 3 | Train Loss: 1.125 Vali Loss: 1.219 Vali Acc: 0.650 Test Loss: 1.219 Test Acc: 0.650
Validation loss decreased (-0.624987 --> -0.649988).  Saving model ...
Epoch: 6 cost time: 0.5643229484558105
Epoch: 6, Steps: 3 | Train Loss: 1.051 Vali Loss: 1.157 Vali Acc: 0.675 Test Loss: 1.157 Test Acc: 0.675
Validation loss decreased (-0.649988 --> -0.674988).  Saving model ...
Epoch: 7 cost time: 0.5510385036468506
Epoch: 7, Steps: 3 | Train Loss: 0.965 Vali Loss: 1.095 Vali Acc: 0.675 Test Loss: 1.095 Test Acc: 0.675
Validation loss decreased (-0.674988 --> -0.674989).  Saving model ...
Epoch: 8 cost time: 0.43593573570251465
Epoch: 8, Steps: 3 | Train Loss: 0.902 Vali Loss: 1.017 Vali Acc: 0.875 Test Loss: 1.017 Test Acc: 0.875
Validation loss decreased (-0.674989 --> -0.874990).  Saving model ...
Epoch: 9 cost time: 0.4765617847442627
Epoch: 9, Steps: 3 | Train Loss: 0.813 Vali Loss: 0.935 Vali Acc: 0.875 Test Loss: 0.935 Test Acc: 0.875
Validation loss decreased (-0.874990 --> -0.874991).  Saving model ...
Epoch: 10 cost time: 0.5047717094421387
Epoch: 10, Steps: 3 | Train Loss: 0.725 Vali Loss: 0.860 Vali Acc: 0.875 Test Loss: 0.860 Test Acc: 0.875
Validation loss decreased (-0.874991 --> -0.874991).  Saving model ...
Epoch: 11 cost time: 0.512965202331543
Epoch: 11, Steps: 3 | Train Loss: 0.657 Vali Loss: 0.779 Vali Acc: 0.900 Test Loss: 0.779 Test Acc: 0.900
Validation loss decreased (-0.874991 --> -0.899992).  Saving model ...
Epoch: 12 cost time: 0.4543619155883789
Epoch: 12, Steps: 3 | Train Loss: 0.594 Vali Loss: 0.698 Vali Acc: 0.875 Test Loss: 0.698 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.4510178565979004
Epoch: 13, Steps: 3 | Train Loss: 0.508 Vali Loss: 0.640 Vali Acc: 0.925 Test Loss: 0.640 Test Acc: 0.925
Validation loss decreased (-0.899992 --> -0.924994).  Saving model ...
Epoch: 14 cost time: 0.4390983581542969
Epoch: 14, Steps: 3 | Train Loss: 0.452 Vali Loss: 0.587 Vali Acc: 0.950 Test Loss: 0.587 Test Acc: 0.950
Validation loss decreased (-0.924994 --> -0.949994).  Saving model ...
Epoch: 15 cost time: 0.47275376319885254
Epoch: 15, Steps: 3 | Train Loss: 0.404 Vali Loss: 0.541 Vali Acc: 0.950 Test Loss: 0.541 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 16 cost time: 0.50034499168396
Epoch: 16, Steps: 3 | Train Loss: 0.369 Vali Loss: 0.502 Vali Acc: 0.950 Test Loss: 0.502 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 17 cost time: 0.5120406150817871
Epoch: 17, Steps: 3 | Train Loss: 0.349 Vali Loss: 0.465 Vali Acc: 0.950 Test Loss: 0.465 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 18 cost time: 0.5844323635101318
Epoch: 18, Steps: 3 | Train Loss: 0.311 Vali Loss: 0.435 Vali Acc: 0.925 Test Loss: 0.435 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.4614841938018799
Epoch: 19, Steps: 3 | Train Loss: 0.279 Vali Loss: 0.410 Vali Acc: 0.950 Test Loss: 0.410 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 20 cost time: 0.44362950325012207
Epoch: 20, Steps: 3 | Train Loss: 0.248 Vali Loss: 0.375 Vali Acc: 0.950 Test Loss: 0.375 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 21 cost time: 0.4603703022003174
Epoch: 21, Steps: 3 | Train Loss: 0.259 Vali Loss: 0.360 Vali Acc: 0.950 Test Loss: 0.360 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 22 cost time: 0.42754316329956055
Epoch: 22, Steps: 3 | Train Loss: 0.219 Vali Loss: 0.339 Vali Acc: 0.975 Test Loss: 0.339 Test Acc: 0.975
Validation loss decreased (-0.949996 --> -0.974997).  Saving model ...
Epoch: 23 cost time: 0.4709162712097168
Epoch: 23, Steps: 3 | Train Loss: 0.202 Vali Loss: 0.317 Vali Acc: 0.975 Test Loss: 0.317 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 24 cost time: 0.427077054977417
Epoch: 24, Steps: 3 | Train Loss: 0.191 Vali Loss: 0.294 Vali Acc: 0.975 Test Loss: 0.294 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 25 cost time: 0.46425771713256836
Epoch: 25, Steps: 3 | Train Loss: 0.172 Vali Loss: 0.277 Vali Acc: 0.975 Test Loss: 0.277 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 26 cost time: 0.41890835762023926
Epoch: 26, Steps: 3 | Train Loss: 0.156 Vali Loss: 0.260 Vali Acc: 0.975 Test Loss: 0.260 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 27 cost time: 0.4788553714752197
Epoch: 27, Steps: 3 | Train Loss: 0.145 Vali Loss: 0.248 Vali Acc: 0.975 Test Loss: 0.248 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 28 cost time: 0.44463634490966797
Epoch: 28, Steps: 3 | Train Loss: 0.157 Vali Loss: 0.241 Vali Acc: 0.975 Test Loss: 0.241 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 29 cost time: 0.4161856174468994
Epoch: 29, Steps: 3 | Train Loss: 0.117 Vali Loss: 0.225 Vali Acc: 0.975 Test Loss: 0.225 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 30 cost time: 0.43599414825439453
Epoch: 30, Steps: 3 | Train Loss: 0.111 Vali Loss: 0.210 Vali Acc: 0.975 Test Loss: 0.210 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 31 cost time: 0.44202208518981934
Epoch: 31, Steps: 3 | Train Loss: 0.101 Vali Loss: 0.203 Vali Acc: 0.975 Test Loss: 0.203 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 32 cost time: 0.4262251853942871
Epoch: 32, Steps: 3 | Train Loss: 0.087 Vali Loss: 0.193 Vali Acc: 0.975 Test Loss: 0.193 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 33 cost time: 0.4919579029083252
Epoch: 33, Steps: 3 | Train Loss: 0.078 Vali Loss: 0.191 Vali Acc: 0.975 Test Loss: 0.191 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 34 cost time: 0.5225145816802979
Epoch: 34, Steps: 3 | Train Loss: 0.074 Vali Loss: 0.187 Vali Acc: 0.975 Test Loss: 0.187 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 35 cost time: 0.5911293029785156
Epoch: 35, Steps: 3 | Train Loss: 0.061 Vali Loss: 0.179 Vali Acc: 0.975 Test Loss: 0.179 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 36 cost time: 0.4582197666168213
Epoch: 36, Steps: 3 | Train Loss: 0.055 Vali Loss: 0.178 Vali Acc: 0.975 Test Loss: 0.178 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 37 cost time: 0.47726011276245117
Epoch: 37, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.173 Vali Acc: 0.975 Test Loss: 0.173 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 38 cost time: 0.45932435989379883
Epoch: 38, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.168 Vali Acc: 0.975 Test Loss: 0.168 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 39 cost time: 0.3962595462799072
Epoch: 39, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.166 Vali Acc: 0.975 Test Loss: 0.166 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 40 cost time: 0.5256013870239258
Epoch: 40, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.159 Vali Acc: 0.975 Test Loss: 0.159 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 41 cost time: 0.4892005920410156
Epoch: 41, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.153 Vali Acc: 0.975 Test Loss: 0.153 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 42 cost time: 0.43437743186950684
Epoch: 42, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.150 Vali Acc: 0.975 Test Loss: 0.150 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974999).  Saving model ...
Epoch: 43 cost time: 0.4793674945831299
Epoch: 43, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.150 Vali Acc: 0.975 Test Loss: 0.150 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.4675617218017578
Epoch: 44, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.151 Vali Acc: 0.975 Test Loss: 0.151 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.4800565242767334
Epoch: 45, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.146 Vali Acc: 0.975 Test Loss: 0.146 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 46 cost time: 0.47199368476867676
Epoch: 46, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.138 Vali Acc: 0.975 Test Loss: 0.138 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 47 cost time: 0.45742321014404297
Epoch: 47, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.134 Vali Acc: 0.975 Test Loss: 0.134 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 48 cost time: 0.4509603977203369
Epoch: 48, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.129 Vali Acc: 0.975 Test Loss: 0.129 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 49 cost time: 0.47839975357055664
Epoch: 49, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.128 Vali Acc: 0.975 Test Loss: 0.128 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 50 cost time: 0.45278191566467285
Epoch: 50, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.129 Vali Acc: 0.975 Test Loss: 0.129 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 635204
model size : 2.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.8143200874328613
Epoch: 1, Steps: 3 | Train Loss: 1.429 Vali Loss: 1.384 Vali Acc: 0.200 Test Loss: 1.384 Test Acc: 0.200
Validation loss decreased (inf --> -0.199986).  Saving model ...
Epoch: 2 cost time: 0.5296483039855957
Epoch: 2, Steps: 3 | Train Loss: 1.357 Vali Loss: 1.375 Vali Acc: 0.225 Test Loss: 1.375 Test Acc: 0.225
Validation loss decreased (-0.199986 --> -0.224986).  Saving model ...
Epoch: 3 cost time: 0.5071976184844971
Epoch: 3, Steps: 3 | Train Loss: 1.311 Vali Loss: 1.360 Vali Acc: 0.275 Test Loss: 1.360 Test Acc: 0.275
Validation loss decreased (-0.224986 --> -0.274986).  Saving model ...
Epoch: 4 cost time: 0.4941115379333496
Epoch: 4, Steps: 3 | Train Loss: 1.250 Vali Loss: 1.332 Vali Acc: 0.325 Test Loss: 1.332 Test Acc: 0.325
Validation loss decreased (-0.274986 --> -0.324987).  Saving model ...
Epoch: 5 cost time: 0.479494571685791
Epoch: 5, Steps: 3 | Train Loss: 1.215 Vali Loss: 1.294 Vali Acc: 0.550 Test Loss: 1.294 Test Acc: 0.550
Validation loss decreased (-0.324987 --> -0.549987).  Saving model ...
Epoch: 6 cost time: 0.4586784839630127
Epoch: 6, Steps: 3 | Train Loss: 1.122 Vali Loss: 1.246 Vali Acc: 0.750 Test Loss: 1.246 Test Acc: 0.750
Validation loss decreased (-0.549987 --> -0.749988).  Saving model ...
Epoch: 7 cost time: 0.6180145740509033
Epoch: 7, Steps: 3 | Train Loss: 1.052 Vali Loss: 1.192 Vali Acc: 0.750 Test Loss: 1.192 Test Acc: 0.750
Validation loss decreased (-0.749988 --> -0.749988).  Saving model ...
Epoch: 8 cost time: 0.49047350883483887
Epoch: 8, Steps: 3 | Train Loss: 0.970 Vali Loss: 1.136 Vali Acc: 0.775 Test Loss: 1.136 Test Acc: 0.775
Validation loss decreased (-0.749988 --> -0.774989).  Saving model ...
Epoch: 9 cost time: 0.5221898555755615
Epoch: 9, Steps: 3 | Train Loss: 0.876 Vali Loss: 1.068 Vali Acc: 0.875 Test Loss: 1.068 Test Acc: 0.875
Validation loss decreased (-0.774989 --> -0.874989).  Saving model ...
Epoch: 10 cost time: 0.47241902351379395
Epoch: 10, Steps: 3 | Train Loss: 0.838 Vali Loss: 1.003 Vali Acc: 0.875 Test Loss: 1.003 Test Acc: 0.875
Validation loss decreased (-0.874989 --> -0.874990).  Saving model ...
Epoch: 11 cost time: 0.46812963485717773
Epoch: 11, Steps: 3 | Train Loss: 0.756 Vali Loss: 0.944 Vali Acc: 0.850 Test Loss: 0.944 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.46999287605285645
Epoch: 12, Steps: 3 | Train Loss: 0.679 Vali Loss: 0.883 Vali Acc: 0.875 Test Loss: 0.883 Test Acc: 0.875
Validation loss decreased (-0.874990 --> -0.874991).  Saving model ...
Epoch: 13 cost time: 0.4821348190307617
Epoch: 13, Steps: 3 | Train Loss: 0.637 Vali Loss: 0.808 Vali Acc: 0.875 Test Loss: 0.808 Test Acc: 0.875
Validation loss decreased (-0.874991 --> -0.874992).  Saving model ...
Epoch: 14 cost time: 0.5362744331359863
Epoch: 14, Steps: 3 | Train Loss: 0.556 Vali Loss: 0.753 Vali Acc: 0.875 Test Loss: 0.753 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874992).  Saving model ...
Epoch: 15 cost time: 0.5490357875823975
Epoch: 15, Steps: 3 | Train Loss: 0.511 Vali Loss: 0.709 Vali Acc: 0.875 Test Loss: 0.709 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874993).  Saving model ...
Epoch: 16 cost time: 0.5690774917602539
Epoch: 16, Steps: 3 | Train Loss: 0.475 Vali Loss: 0.664 Vali Acc: 0.875 Test Loss: 0.664 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 17 cost time: 0.509526252746582
Epoch: 17, Steps: 3 | Train Loss: 0.425 Vali Loss: 0.612 Vali Acc: 0.875 Test Loss: 0.612 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 18 cost time: 0.42265796661376953
Epoch: 18, Steps: 3 | Train Loss: 0.377 Vali Loss: 0.580 Vali Acc: 0.900 Test Loss: 0.580 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899994).  Saving model ...
Epoch: 19 cost time: 0.45827364921569824
Epoch: 19, Steps: 3 | Train Loss: 0.366 Vali Loss: 0.531 Vali Acc: 0.900 Test Loss: 0.531 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 20 cost time: 0.4559783935546875
Epoch: 20, Steps: 3 | Train Loss: 0.313 Vali Loss: 0.502 Vali Acc: 0.900 Test Loss: 0.502 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 21 cost time: 0.4566915035247803
Epoch: 21, Steps: 3 | Train Loss: 0.290 Vali Loss: 0.493 Vali Acc: 0.900 Test Loss: 0.493 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 22 cost time: 0.45560336112976074
Epoch: 22, Steps: 3 | Train Loss: 0.271 Vali Loss: 0.471 Vali Acc: 0.900 Test Loss: 0.471 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 23 cost time: 0.4848456382751465
Epoch: 23, Steps: 3 | Train Loss: 0.258 Vali Loss: 0.449 Vali Acc: 0.900 Test Loss: 0.449 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 24 cost time: 0.5253636837005615
Epoch: 24, Steps: 3 | Train Loss: 0.242 Vali Loss: 0.428 Vali Acc: 0.900 Test Loss: 0.428 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 25 cost time: 0.4670102596282959
Epoch: 25, Steps: 3 | Train Loss: 0.246 Vali Loss: 0.412 Vali Acc: 0.900 Test Loss: 0.412 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 26 cost time: 0.4935426712036133
Epoch: 26, Steps: 3 | Train Loss: 0.209 Vali Loss: 0.382 Vali Acc: 0.900 Test Loss: 0.382 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 27 cost time: 0.5257570743560791
Epoch: 27, Steps: 3 | Train Loss: 0.200 Vali Loss: 0.366 Vali Acc: 0.900 Test Loss: 0.366 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 28 cost time: 0.543179988861084
Epoch: 28, Steps: 3 | Train Loss: 0.187 Vali Loss: 0.359 Vali Acc: 0.900 Test Loss: 0.359 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 29 cost time: 0.48312807083129883
Epoch: 29, Steps: 3 | Train Loss: 0.168 Vali Loss: 0.343 Vali Acc: 0.900 Test Loss: 0.343 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899997).  Saving model ...
Epoch: 30 cost time: 0.5449192523956299
Epoch: 30, Steps: 3 | Train Loss: 0.151 Vali Loss: 0.326 Vali Acc: 0.900 Test Loss: 0.326 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 31 cost time: 0.5452032089233398
Epoch: 31, Steps: 3 | Train Loss: 0.136 Vali Loss: 0.309 Vali Acc: 0.900 Test Loss: 0.309 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 32 cost time: 0.533221960067749
Epoch: 32, Steps: 3 | Train Loss: 0.146 Vali Loss: 0.297 Vali Acc: 0.900 Test Loss: 0.297 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 33 cost time: 0.5034852027893066
Epoch: 33, Steps: 3 | Train Loss: 0.126 Vali Loss: 0.295 Vali Acc: 0.900 Test Loss: 0.295 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 34 cost time: 0.5606207847595215
Epoch: 34, Steps: 3 | Train Loss: 0.104 Vali Loss: 0.293 Vali Acc: 0.900 Test Loss: 0.293 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 35 cost time: 0.5125048160552979
Epoch: 35, Steps: 3 | Train Loss: 0.122 Vali Loss: 0.285 Vali Acc: 0.900 Test Loss: 0.285 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 36 cost time: 0.4919252395629883
Epoch: 36, Steps: 3 | Train Loss: 0.093 Vali Loss: 0.273 Vali Acc: 0.900 Test Loss: 0.273 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 37 cost time: 0.48064446449279785
Epoch: 37, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.262 Vali Acc: 0.900 Test Loss: 0.262 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 38 cost time: 0.5105571746826172
Epoch: 38, Steps: 3 | Train Loss: 0.071 Vali Loss: 0.252 Vali Acc: 0.925 Test Loss: 0.252 Test Acc: 0.925
Validation loss decreased (-0.899997 --> -0.924997).  Saving model ...
Epoch: 39 cost time: 0.49576544761657715
Epoch: 39, Steps: 3 | Train Loss: 0.072 Vali Loss: 0.248 Vali Acc: 0.925 Test Loss: 0.248 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924998).  Saving model ...
Epoch: 40 cost time: 0.47054052352905273
Epoch: 40, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.246 Vali Acc: 0.925 Test Loss: 0.246 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 41 cost time: 0.5395989418029785
Epoch: 41, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.242 Vali Acc: 0.925 Test Loss: 0.242 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 42 cost time: 0.4991772174835205
Epoch: 42, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.242 Vali Acc: 0.925 Test Loss: 0.242 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.46679139137268066
Epoch: 43, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.237 Vali Acc: 0.925 Test Loss: 0.237 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 44 cost time: 0.46441030502319336
Epoch: 44, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.241 Vali Acc: 0.900 Test Loss: 0.241 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.46961140632629395
Epoch: 45, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.231 Vali Acc: 0.925 Test Loss: 0.231 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 46 cost time: 0.49809741973876953
Epoch: 46, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.224 Vali Acc: 0.925 Test Loss: 0.224 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 47 cost time: 0.6460545063018799
Epoch: 47, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.218 Vali Acc: 0.925 Test Loss: 0.218 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 48 cost time: 0.4567070007324219
Epoch: 48, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.211 Vali Acc: 0.925 Test Loss: 0.211 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 49 cost time: 0.6282200813293457
Epoch: 49, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.212 Vali Acc: 0.925 Test Loss: 0.212 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.597724199295044
Epoch: 50, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.211 Vali Acc: 0.925 Test Loss: 0.211 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 629156
model size : 2.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.8228199481964111
Epoch: 1, Steps: 3 | Train Loss: 1.379 Vali Loss: 1.382 Vali Acc: 0.200 Test Loss: 1.382 Test Acc: 0.200
Validation loss decreased (inf --> -0.199986).  Saving model ...
Epoch: 2 cost time: 0.5547332763671875
Epoch: 2, Steps: 3 | Train Loss: 1.356 Vali Loss: 1.371 Vali Acc: 0.200 Test Loss: 1.371 Test Acc: 0.200
Validation loss decreased (-0.199986 --> -0.199986).  Saving model ...
Epoch: 3 cost time: 0.55277419090271
Epoch: 3, Steps: 3 | Train Loss: 1.313 Vali Loss: 1.355 Vali Acc: 0.250 Test Loss: 1.355 Test Acc: 0.250
Validation loss decreased (-0.199986 --> -0.249986).  Saving model ...
Epoch: 4 cost time: 0.46447181701660156
Epoch: 4, Steps: 3 | Train Loss: 1.280 Vali Loss: 1.331 Vali Acc: 0.375 Test Loss: 1.331 Test Acc: 0.375
Validation loss decreased (-0.249986 --> -0.374987).  Saving model ...
Epoch: 5 cost time: 0.4455246925354004
Epoch: 5, Steps: 3 | Train Loss: 1.235 Vali Loss: 1.298 Vali Acc: 0.400 Test Loss: 1.298 Test Acc: 0.400
Validation loss decreased (-0.374987 --> -0.399987).  Saving model ...
Epoch: 6 cost time: 0.44240689277648926
Epoch: 6, Steps: 3 | Train Loss: 1.164 Vali Loss: 1.257 Vali Acc: 0.425 Test Loss: 1.257 Test Acc: 0.425
Validation loss decreased (-0.399987 --> -0.424987).  Saving model ...
Epoch: 7 cost time: 0.47193336486816406
Epoch: 7, Steps: 3 | Train Loss: 1.114 Vali Loss: 1.208 Vali Acc: 0.500 Test Loss: 1.208 Test Acc: 0.500
Validation loss decreased (-0.424987 --> -0.499988).  Saving model ...
Epoch: 8 cost time: 0.5172860622406006
Epoch: 8, Steps: 3 | Train Loss: 1.051 Vali Loss: 1.154 Vali Acc: 0.600 Test Loss: 1.154 Test Acc: 0.600
Validation loss decreased (-0.499988 --> -0.599988).  Saving model ...
Epoch: 9 cost time: 0.4411799907684326
Epoch: 9, Steps: 3 | Train Loss: 0.967 Vali Loss: 1.101 Vali Acc: 0.700 Test Loss: 1.101 Test Acc: 0.700
Validation loss decreased (-0.599988 --> -0.699989).  Saving model ...
Epoch: 10 cost time: 0.43422412872314453
Epoch: 10, Steps: 3 | Train Loss: 0.937 Vali Loss: 1.040 Vali Acc: 0.725 Test Loss: 1.040 Test Acc: 0.725
Validation loss decreased (-0.699989 --> -0.724990).  Saving model ...
Epoch: 11 cost time: 0.43959879875183105
Epoch: 11, Steps: 3 | Train Loss: 0.851 Vali Loss: 0.989 Vali Acc: 0.750 Test Loss: 0.989 Test Acc: 0.750
Validation loss decreased (-0.724990 --> -0.749990).  Saving model ...
Epoch: 12 cost time: 0.40784478187561035
Epoch: 12, Steps: 3 | Train Loss: 0.813 Vali Loss: 0.930 Vali Acc: 0.750 Test Loss: 0.930 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749991).  Saving model ...
Epoch: 13 cost time: 0.5070819854736328
Epoch: 13, Steps: 3 | Train Loss: 0.754 Vali Loss: 0.876 Vali Acc: 0.800 Test Loss: 0.876 Test Acc: 0.800
Validation loss decreased (-0.749991 --> -0.799991).  Saving model ...
Epoch: 14 cost time: 0.462604284286499
Epoch: 14, Steps: 3 | Train Loss: 0.685 Vali Loss: 0.827 Vali Acc: 0.925 Test Loss: 0.827 Test Acc: 0.925
Validation loss decreased (-0.799991 --> -0.924992).  Saving model ...
Epoch: 15 cost time: 0.5050361156463623
Epoch: 15, Steps: 3 | Train Loss: 0.639 Vali Loss: 0.784 Vali Acc: 0.950 Test Loss: 0.784 Test Acc: 0.950
Validation loss decreased (-0.924992 --> -0.949992).  Saving model ...
Epoch: 16 cost time: 0.4407782554626465
Epoch: 16, Steps: 3 | Train Loss: 0.597 Vali Loss: 0.749 Vali Acc: 0.925 Test Loss: 0.749 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5092959403991699
Epoch: 17, Steps: 3 | Train Loss: 0.567 Vali Loss: 0.704 Vali Acc: 0.900 Test Loss: 0.704 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.5083951950073242
Epoch: 18, Steps: 3 | Train Loss: 0.512 Vali Loss: 0.675 Vali Acc: 0.875 Test Loss: 0.675 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.4875633716583252
Epoch: 19, Steps: 3 | Train Loss: 0.468 Vali Loss: 0.643 Vali Acc: 0.875 Test Loss: 0.643 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.4464597702026367
Epoch: 20, Steps: 3 | Train Loss: 0.460 Vali Loss: 0.610 Vali Acc: 0.900 Test Loss: 0.610 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.5084593296051025
Epoch: 21, Steps: 3 | Train Loss: 0.415 Vali Loss: 0.575 Vali Acc: 0.900 Test Loss: 0.575 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.4735691547393799
Epoch: 22, Steps: 3 | Train Loss: 0.389 Vali Loss: 0.546 Vali Acc: 0.900 Test Loss: 0.546 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.4487183094024658
Epoch: 23, Steps: 3 | Train Loss: 0.373 Vali Loss: 0.519 Vali Acc: 0.975 Test Loss: 0.519 Test Acc: 0.975
Validation loss decreased (-0.949992 --> -0.974995).  Saving model ...
Epoch: 24 cost time: 0.5177321434020996
Epoch: 24, Steps: 3 | Train Loss: 0.350 Vali Loss: 0.499 Vali Acc: 0.975 Test Loss: 0.499 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 25 cost time: 0.4263944625854492
Epoch: 25, Steps: 3 | Train Loss: 0.314 Vali Loss: 0.484 Vali Acc: 0.975 Test Loss: 0.484 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 26 cost time: 0.40004587173461914
Epoch: 26, Steps: 3 | Train Loss: 0.314 Vali Loss: 0.464 Vali Acc: 0.975 Test Loss: 0.464 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 27 cost time: 0.5319705009460449
Epoch: 27, Steps: 3 | Train Loss: 0.288 Vali Loss: 0.450 Vali Acc: 0.975 Test Loss: 0.450 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 28 cost time: 0.55558180809021
Epoch: 28, Steps: 3 | Train Loss: 0.274 Vali Loss: 0.427 Vali Acc: 0.975 Test Loss: 0.427 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 29 cost time: 0.44739437103271484
Epoch: 29, Steps: 3 | Train Loss: 0.251 Vali Loss: 0.411 Vali Acc: 0.975 Test Loss: 0.411 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 30 cost time: 0.45180177688598633
Epoch: 30, Steps: 3 | Train Loss: 0.250 Vali Loss: 0.393 Vali Acc: 0.975 Test Loss: 0.393 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 31 cost time: 0.48850131034851074
Epoch: 31, Steps: 3 | Train Loss: 0.227 Vali Loss: 0.384 Vali Acc: 0.975 Test Loss: 0.384 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 32 cost time: 0.4470784664154053
Epoch: 32, Steps: 3 | Train Loss: 0.214 Vali Loss: 0.377 Vali Acc: 0.975 Test Loss: 0.377 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 33 cost time: 0.5169327259063721
Epoch: 33, Steps: 3 | Train Loss: 0.205 Vali Loss: 0.364 Vali Acc: 0.975 Test Loss: 0.364 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 34 cost time: 0.4869570732116699
Epoch: 34, Steps: 3 | Train Loss: 0.210 Vali Loss: 0.345 Vali Acc: 0.975 Test Loss: 0.345 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 35 cost time: 0.5506539344787598
Epoch: 35, Steps: 3 | Train Loss: 0.184 Vali Loss: 0.333 Vali Acc: 0.975 Test Loss: 0.333 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 36 cost time: 0.4716224670410156
Epoch: 36, Steps: 3 | Train Loss: 0.163 Vali Loss: 0.323 Vali Acc: 0.950 Test Loss: 0.323 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.6386351585388184
Epoch: 37, Steps: 3 | Train Loss: 0.154 Vali Loss: 0.321 Vali Acc: 0.950 Test Loss: 0.321 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.48766279220581055
Epoch: 38, Steps: 3 | Train Loss: 0.144 Vali Loss: 0.310 Vali Acc: 0.950 Test Loss: 0.310 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.4404904842376709
Epoch: 39, Steps: 3 | Train Loss: 0.136 Vali Loss: 0.300 Vali Acc: 0.950 Test Loss: 0.300 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.45766186714172363
Epoch: 40, Steps: 3 | Train Loss: 0.131 Vali Loss: 0.294 Vali Acc: 0.925 Test Loss: 0.294 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.4663560390472412
Epoch: 41, Steps: 3 | Train Loss: 0.121 Vali Loss: 0.286 Vali Acc: 0.925 Test Loss: 0.286 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.44945669174194336
Epoch: 42, Steps: 3 | Train Loss: 0.113 Vali Loss: 0.276 Vali Acc: 0.925 Test Loss: 0.276 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.48098254203796387
Epoch: 43, Steps: 3 | Train Loss: 0.103 Vali Loss: 0.258 Vali Acc: 0.925 Test Loss: 0.258 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.5708849430084229
Epoch: 44, Steps: 3 | Train Loss: 0.114 Vali Loss: 0.262 Vali Acc: 0.925 Test Loss: 0.262 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.5003795623779297
Epoch: 45, Steps: 3 | Train Loss: 0.090 Vali Loss: 0.260 Vali Acc: 0.925 Test Loss: 0.260 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 623076
model size : 2.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.7573227882385254
Epoch: 1, Steps: 3 | Train Loss: 1.376 Vali Loss: 1.371 Vali Acc: 0.425 Test Loss: 1.371 Test Acc: 0.425
Validation loss decreased (inf --> -0.424986).  Saving model ...
Epoch: 2 cost time: 0.463348388671875
Epoch: 2, Steps: 3 | Train Loss: 1.326 Vali Loss: 1.358 Vali Acc: 0.450 Test Loss: 1.358 Test Acc: 0.450
Validation loss decreased (-0.424986 --> -0.449986).  Saving model ...
Epoch: 3 cost time: 0.5160419940948486
Epoch: 3, Steps: 3 | Train Loss: 1.273 Vali Loss: 1.343 Vali Acc: 0.450 Test Loss: 1.343 Test Acc: 0.450
Validation loss decreased (-0.449986 --> -0.449987).  Saving model ...
Epoch: 4 cost time: 0.5016067028045654
Epoch: 4, Steps: 3 | Train Loss: 1.263 Vali Loss: 1.323 Vali Acc: 0.425 Test Loss: 1.323 Test Acc: 0.425
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5121464729309082
Epoch: 5, Steps: 3 | Train Loss: 1.195 Vali Loss: 1.297 Vali Acc: 0.475 Test Loss: 1.297 Test Acc: 0.475
Validation loss decreased (-0.449987 --> -0.474987).  Saving model ...
Epoch: 6 cost time: 0.5159907341003418
Epoch: 6, Steps: 3 | Train Loss: 1.221 Vali Loss: 1.264 Vali Acc: 0.450 Test Loss: 1.264 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5091948509216309
Epoch: 7, Steps: 3 | Train Loss: 1.140 Vali Loss: 1.231 Vali Acc: 0.450 Test Loss: 1.231 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.4674496650695801
Epoch: 8, Steps: 3 | Train Loss: 1.101 Vali Loss: 1.193 Vali Acc: 0.500 Test Loss: 1.193 Test Acc: 0.500
Validation loss decreased (-0.474987 --> -0.499988).  Saving model ...
Epoch: 9 cost time: 0.4757101535797119
Epoch: 9, Steps: 3 | Train Loss: 1.059 Vali Loss: 1.159 Vali Acc: 0.575 Test Loss: 1.159 Test Acc: 0.575
Validation loss decreased (-0.499988 --> -0.574988).  Saving model ...
Epoch: 10 cost time: 0.4151144027709961
Epoch: 10, Steps: 3 | Train Loss: 0.998 Vali Loss: 1.119 Vali Acc: 0.600 Test Loss: 1.119 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599989).  Saving model ...
Epoch: 11 cost time: 0.4507906436920166
Epoch: 11, Steps: 3 | Train Loss: 0.934 Vali Loss: 1.075 Vali Acc: 0.625 Test Loss: 1.075 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624989).  Saving model ...
Epoch: 12 cost time: 0.44333386421203613
Epoch: 12, Steps: 3 | Train Loss: 0.945 Vali Loss: 1.024 Vali Acc: 0.625 Test Loss: 1.024 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624990).  Saving model ...
Epoch: 13 cost time: 0.5742223262786865
Epoch: 13, Steps: 3 | Train Loss: 0.829 Vali Loss: 0.993 Vali Acc: 0.725 Test Loss: 0.993 Test Acc: 0.725
Validation loss decreased (-0.624990 --> -0.724990).  Saving model ...
Epoch: 14 cost time: 0.5069472789764404
Epoch: 14, Steps: 3 | Train Loss: 0.793 Vali Loss: 0.952 Vali Acc: 0.825 Test Loss: 0.952 Test Acc: 0.825
Validation loss decreased (-0.724990 --> -0.824990).  Saving model ...
Epoch: 15 cost time: 0.5592813491821289
Epoch: 15, Steps: 3 | Train Loss: 0.740 Vali Loss: 0.920 Vali Acc: 0.850 Test Loss: 0.920 Test Acc: 0.850
Validation loss decreased (-0.824990 --> -0.849991).  Saving model ...
Epoch: 16 cost time: 0.48792529106140137
Epoch: 16, Steps: 3 | Train Loss: 0.727 Vali Loss: 0.871 Vali Acc: 0.900 Test Loss: 0.871 Test Acc: 0.900
Validation loss decreased (-0.849991 --> -0.899991).  Saving model ...
Epoch: 17 cost time: 0.42156434059143066
Epoch: 17, Steps: 3 | Train Loss: 0.686 Vali Loss: 0.825 Vali Acc: 0.900 Test Loss: 0.825 Test Acc: 0.900
Validation loss decreased (-0.899991 --> -0.899992).  Saving model ...
Epoch: 18 cost time: 0.494199275970459
Epoch: 18, Steps: 3 | Train Loss: 0.611 Vali Loss: 0.796 Vali Acc: 0.900 Test Loss: 0.796 Test Acc: 0.900
Validation loss decreased (-0.899992 --> -0.899992).  Saving model ...
Epoch: 19 cost time: 0.5121355056762695
Epoch: 19, Steps: 3 | Train Loss: 0.582 Vali Loss: 0.765 Vali Acc: 0.900 Test Loss: 0.765 Test Acc: 0.900
Validation loss decreased (-0.899992 --> -0.899992).  Saving model ...
Epoch: 20 cost time: 0.42960238456726074
Epoch: 20, Steps: 3 | Train Loss: 0.585 Vali Loss: 0.724 Vali Acc: 0.900 Test Loss: 0.724 Test Acc: 0.900
Validation loss decreased (-0.899992 --> -0.899993).  Saving model ...
Epoch: 21 cost time: 0.49953150749206543
Epoch: 21, Steps: 3 | Train Loss: 0.526 Vali Loss: 0.692 Vali Acc: 0.925 Test Loss: 0.692 Test Acc: 0.925
Validation loss decreased (-0.899993 --> -0.924993).  Saving model ...
Epoch: 22 cost time: 0.4622766971588135
Epoch: 22, Steps: 3 | Train Loss: 0.495 Vali Loss: 0.657 Vali Acc: 0.925 Test Loss: 0.657 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924993).  Saving model ...
Epoch: 23 cost time: 0.49738287925720215
Epoch: 23, Steps: 3 | Train Loss: 0.456 Vali Loss: 0.621 Vali Acc: 0.925 Test Loss: 0.621 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924994).  Saving model ...
Epoch: 24 cost time: 0.5320346355438232
Epoch: 24, Steps: 3 | Train Loss: 0.438 Vali Loss: 0.597 Vali Acc: 0.975 Test Loss: 0.597 Test Acc: 0.975
Validation loss decreased (-0.924994 --> -0.974994).  Saving model ...
Epoch: 25 cost time: 0.47083568572998047
Epoch: 25, Steps: 3 | Train Loss: 0.398 Vali Loss: 0.567 Vali Acc: 0.975 Test Loss: 0.567 Test Acc: 0.975
Validation loss decreased (-0.974994 --> -0.974994).  Saving model ...
Epoch: 26 cost time: 0.48165106773376465
Epoch: 26, Steps: 3 | Train Loss: 0.381 Vali Loss: 0.537 Vali Acc: 0.975 Test Loss: 0.537 Test Acc: 0.975
Validation loss decreased (-0.974994 --> -0.974995).  Saving model ...
Epoch: 27 cost time: 0.44525671005249023
Epoch: 27, Steps: 3 | Train Loss: 0.371 Vali Loss: 0.511 Vali Acc: 0.975 Test Loss: 0.511 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 28 cost time: 0.4353361129760742
Epoch: 28, Steps: 3 | Train Loss: 0.321 Vali Loss: 0.490 Vali Acc: 0.975 Test Loss: 0.490 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 29 cost time: 0.4079442024230957
Epoch: 29, Steps: 3 | Train Loss: 0.332 Vali Loss: 0.472 Vali Acc: 0.975 Test Loss: 0.472 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 30 cost time: 0.4335150718688965
Epoch: 30, Steps: 3 | Train Loss: 0.296 Vali Loss: 0.451 Vali Acc: 0.975 Test Loss: 0.451 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 31 cost time: 0.41381025314331055
Epoch: 31, Steps: 3 | Train Loss: 0.298 Vali Loss: 0.438 Vali Acc: 0.975 Test Loss: 0.438 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 32 cost time: 0.5059816837310791
Epoch: 32, Steps: 3 | Train Loss: 0.262 Vali Loss: 0.417 Vali Acc: 0.975 Test Loss: 0.417 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 33 cost time: 0.4337191581726074
Epoch: 33, Steps: 3 | Train Loss: 0.250 Vali Loss: 0.405 Vali Acc: 0.975 Test Loss: 0.405 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 34 cost time: 0.48166656494140625
Epoch: 34, Steps: 3 | Train Loss: 0.239 Vali Loss: 0.394 Vali Acc: 0.975 Test Loss: 0.394 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 35 cost time: 0.4787578582763672
Epoch: 35, Steps: 3 | Train Loss: 0.237 Vali Loss: 0.382 Vali Acc: 0.975 Test Loss: 0.382 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 36 cost time: 0.49779224395751953
Epoch: 36, Steps: 3 | Train Loss: 0.204 Vali Loss: 0.357 Vali Acc: 0.975 Test Loss: 0.357 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 37 cost time: 0.5014667510986328
Epoch: 37, Steps: 3 | Train Loss: 0.206 Vali Loss: 0.333 Vali Acc: 0.975 Test Loss: 0.333 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 38 cost time: 0.4919466972351074
Epoch: 38, Steps: 3 | Train Loss: 0.212 Vali Loss: 0.315 Vali Acc: 0.975 Test Loss: 0.315 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 39 cost time: 0.550142765045166
Epoch: 39, Steps: 3 | Train Loss: 0.184 Vali Loss: 0.304 Vali Acc: 0.975 Test Loss: 0.304 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 40 cost time: 0.44457101821899414
Epoch: 40, Steps: 3 | Train Loss: 0.156 Vali Loss: 0.288 Vali Acc: 0.975 Test Loss: 0.288 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 41 cost time: 0.4317355155944824
Epoch: 41, Steps: 3 | Train Loss: 0.154 Vali Loss: 0.268 Vali Acc: 0.975 Test Loss: 0.268 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 42 cost time: 0.4516749382019043
Epoch: 42, Steps: 3 | Train Loss: 0.145 Vali Loss: 0.252 Vali Acc: 0.975 Test Loss: 0.252 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 43 cost time: 0.4896354675292969
Epoch: 43, Steps: 3 | Train Loss: 0.148 Vali Loss: 0.247 Vali Acc: 0.975 Test Loss: 0.247 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 44 cost time: 0.4232175350189209
Epoch: 44, Steps: 3 | Train Loss: 0.129 Vali Loss: 0.243 Vali Acc: 0.975 Test Loss: 0.243 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 45 cost time: 0.4784691333770752
Epoch: 45, Steps: 3 | Train Loss: 0.116 Vali Loss: 0.240 Vali Acc: 0.975 Test Loss: 0.240 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 46 cost time: 0.4562983512878418
Epoch: 46, Steps: 3 | Train Loss: 0.122 Vali Loss: 0.223 Vali Acc: 0.975 Test Loss: 0.223 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 47 cost time: 0.5526535511016846
Epoch: 47, Steps: 3 | Train Loss: 0.115 Vali Loss: 0.212 Vali Acc: 0.975 Test Loss: 0.212 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 48 cost time: 0.4823417663574219
Epoch: 48, Steps: 3 | Train Loss: 0.092 Vali Loss: 0.205 Vali Acc: 0.975 Test Loss: 0.205 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 49 cost time: 0.4796147346496582
Epoch: 49, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.195 Vali Acc: 0.975 Test Loss: 0.195 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 50 cost time: 0.47315359115600586
Epoch: 50, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.183 Vali Acc: 0.975 Test Loss: 0.183 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 617092
model size : 2.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps20_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.7749171257019043
Epoch: 1, Steps: 3 | Train Loss: 1.400 Vali Loss: 1.352 Vali Acc: 0.225 Test Loss: 1.352 Test Acc: 0.225
Validation loss decreased (inf --> -0.224986).  Saving model ...
Epoch: 2 cost time: 0.4982025623321533
Epoch: 2, Steps: 3 | Train Loss: 1.420 Vali Loss: 1.343 Vali Acc: 0.250 Test Loss: 1.343 Test Acc: 0.250
Validation loss decreased (-0.224986 --> -0.249987).  Saving model ...
Epoch: 3 cost time: 0.4750332832336426
Epoch: 3, Steps: 3 | Train Loss: 1.373 Vali Loss: 1.331 Vali Acc: 0.300 Test Loss: 1.331 Test Acc: 0.300
Validation loss decreased (-0.249987 --> -0.299987).  Saving model ...
Epoch: 4 cost time: 0.5146448612213135
Epoch: 4, Steps: 3 | Train Loss: 1.368 Vali Loss: 1.314 Vali Acc: 0.325 Test Loss: 1.314 Test Acc: 0.325
Validation loss decreased (-0.299987 --> -0.324987).  Saving model ...
Epoch: 5 cost time: 0.49811577796936035
Epoch: 5, Steps: 3 | Train Loss: 1.331 Vali Loss: 1.290 Vali Acc: 0.325 Test Loss: 1.290 Test Acc: 0.325
Validation loss decreased (-0.324987 --> -0.324987).  Saving model ...
Epoch: 6 cost time: 0.4715912342071533
Epoch: 6, Steps: 3 | Train Loss: 1.276 Vali Loss: 1.262 Vali Acc: 0.350 Test Loss: 1.262 Test Acc: 0.350
Validation loss decreased (-0.324987 --> -0.349987).  Saving model ...
Epoch: 7 cost time: 0.4689185619354248
Epoch: 7, Steps: 3 | Train Loss: 1.228 Vali Loss: 1.228 Vali Acc: 0.400 Test Loss: 1.228 Test Acc: 0.400
Validation loss decreased (-0.349987 --> -0.399988).  Saving model ...
Epoch: 8 cost time: 0.5006616115570068
Epoch: 8, Steps: 3 | Train Loss: 1.187 Vali Loss: 1.194 Vali Acc: 0.625 Test Loss: 1.194 Test Acc: 0.625
Validation loss decreased (-0.399988 --> -0.624988).  Saving model ...
Epoch: 9 cost time: 0.5031957626342773
Epoch: 9, Steps: 3 | Train Loss: 1.094 Vali Loss: 1.159 Vali Acc: 0.775 Test Loss: 1.159 Test Acc: 0.775
Validation loss decreased (-0.624988 --> -0.774988).  Saving model ...
Epoch: 10 cost time: 0.5163559913635254
Epoch: 10, Steps: 3 | Train Loss: 1.040 Vali Loss: 1.119 Vali Acc: 0.800 Test Loss: 1.119 Test Acc: 0.800
Validation loss decreased (-0.774988 --> -0.799989).  Saving model ...
Epoch: 11 cost time: 0.480759859085083
Epoch: 11, Steps: 3 | Train Loss: 0.979 Vali Loss: 1.082 Vali Acc: 0.825 Test Loss: 1.082 Test Acc: 0.825
Validation loss decreased (-0.799989 --> -0.824989).  Saving model ...
Epoch: 12 cost time: 0.5723674297332764
Epoch: 12, Steps: 3 | Train Loss: 0.944 Vali Loss: 1.043 Vali Acc: 0.850 Test Loss: 1.043 Test Acc: 0.850
Validation loss decreased (-0.824989 --> -0.849990).  Saving model ...
Epoch: 13 cost time: 0.5299651622772217
Epoch: 13, Steps: 3 | Train Loss: 0.875 Vali Loss: 1.008 Vali Acc: 0.850 Test Loss: 1.008 Test Acc: 0.850
Validation loss decreased (-0.849990 --> -0.849990).  Saving model ...
Epoch: 14 cost time: 0.48328351974487305
Epoch: 14, Steps: 3 | Train Loss: 0.872 Vali Loss: 0.975 Vali Acc: 0.850 Test Loss: 0.975 Test Acc: 0.850
Validation loss decreased (-0.849990 --> -0.849990).  Saving model ...
Epoch: 15 cost time: 0.5128283500671387
Epoch: 15, Steps: 3 | Train Loss: 0.811 Vali Loss: 0.941 Vali Acc: 0.850 Test Loss: 0.941 Test Acc: 0.850
Validation loss decreased (-0.849990 --> -0.849991).  Saving model ...
Epoch: 16 cost time: 0.4969627857208252
Epoch: 16, Steps: 3 | Train Loss: 0.757 Vali Loss: 0.899 Vali Acc: 0.875 Test Loss: 0.899 Test Acc: 0.875
Validation loss decreased (-0.849991 --> -0.874991).  Saving model ...
Epoch: 17 cost time: 0.4957280158996582
Epoch: 17, Steps: 3 | Train Loss: 0.694 Vali Loss: 0.857 Vali Acc: 0.875 Test Loss: 0.857 Test Acc: 0.875
Validation loss decreased (-0.874991 --> -0.874991).  Saving model ...
Epoch: 18 cost time: 0.45057129859924316
Epoch: 18, Steps: 3 | Train Loss: 0.681 Vali Loss: 0.817 Vali Acc: 0.875 Test Loss: 0.817 Test Acc: 0.875
Validation loss decreased (-0.874991 --> -0.874992).  Saving model ...
Epoch: 19 cost time: 0.5608201026916504
Epoch: 19, Steps: 3 | Train Loss: 0.624 Vali Loss: 0.787 Vali Acc: 0.875 Test Loss: 0.787 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874992).  Saving model ...
Epoch: 20 cost time: 0.4650847911834717
Epoch: 20, Steps: 3 | Train Loss: 0.582 Vali Loss: 0.751 Vali Acc: 0.900 Test Loss: 0.751 Test Acc: 0.900
Validation loss decreased (-0.874992 --> -0.899992).  Saving model ...
Epoch: 21 cost time: 0.5030002593994141
Epoch: 21, Steps: 3 | Train Loss: 0.557 Vali Loss: 0.712 Vali Acc: 0.875 Test Loss: 0.712 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.4620504379272461
Epoch: 22, Steps: 3 | Train Loss: 0.552 Vali Loss: 0.676 Vali Acc: 0.850 Test Loss: 0.676 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.598536491394043
Epoch: 23, Steps: 3 | Train Loss: 0.511 Vali Loss: 0.652 Vali Acc: 0.850 Test Loss: 0.652 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.5490942001342773
Epoch: 24, Steps: 3 | Train Loss: 0.460 Vali Loss: 0.637 Vali Acc: 0.875 Test Loss: 0.637 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.4902770519256592
Epoch: 25, Steps: 3 | Train Loss: 0.452 Vali Loss: 0.624 Vali Acc: 0.900 Test Loss: 0.624 Test Acc: 0.900
Validation loss decreased (-0.899992 --> -0.899994).  Saving model ...
Epoch: 26 cost time: 0.4606208801269531
Epoch: 26, Steps: 3 | Train Loss: 0.440 Vali Loss: 0.596 Vali Acc: 0.900 Test Loss: 0.596 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 27 cost time: 0.5061452388763428
Epoch: 27, Steps: 3 | Train Loss: 0.411 Vali Loss: 0.575 Vali Acc: 0.900 Test Loss: 0.575 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 28 cost time: 0.44176316261291504
Epoch: 28, Steps: 3 | Train Loss: 0.371 Vali Loss: 0.560 Vali Acc: 0.900 Test Loss: 0.560 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 29 cost time: 0.5114364624023438
Epoch: 29, Steps: 3 | Train Loss: 0.373 Vali Loss: 0.538 Vali Acc: 0.900 Test Loss: 0.538 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 30 cost time: 0.481778621673584
Epoch: 30, Steps: 3 | Train Loss: 0.358 Vali Loss: 0.516 Vali Acc: 0.925 Test Loss: 0.516 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924995).  Saving model ...
Epoch: 31 cost time: 0.48217034339904785
Epoch: 31, Steps: 3 | Train Loss: 0.340 Vali Loss: 0.497 Vali Acc: 0.900 Test Loss: 0.497 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.5546875
Epoch: 32, Steps: 3 | Train Loss: 0.303 Vali Loss: 0.488 Vali Acc: 0.900 Test Loss: 0.488 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.4839768409729004
Epoch: 33, Steps: 3 | Train Loss: 0.310 Vali Loss: 0.475 Vali Acc: 0.900 Test Loss: 0.475 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.7046554088592529
Epoch: 34, Steps: 3 | Train Loss: 0.286 Vali Loss: 0.458 Vali Acc: 0.900 Test Loss: 0.458 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.46489906311035156
Epoch: 35, Steps: 3 | Train Loss: 0.275 Vali Loss: 0.448 Vali Acc: 0.900 Test Loss: 0.448 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.4812965393066406
Epoch: 36, Steps: 3 | Train Loss: 0.265 Vali Loss: 0.429 Vali Acc: 0.900 Test Loss: 0.429 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.4728877544403076
Epoch: 37, Steps: 3 | Train Loss: 0.254 Vali Loss: 0.424 Vali Acc: 0.900 Test Loss: 0.424 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.42851805686950684
Epoch: 38, Steps: 3 | Train Loss: 0.225 Vali Loss: 0.412 Vali Acc: 0.900 Test Loss: 0.412 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.4628279209136963
Epoch: 39, Steps: 3 | Train Loss: 0.219 Vali Loss: 0.395 Vali Acc: 0.900 Test Loss: 0.395 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.5539851188659668
Epoch: 40, Steps: 3 | Train Loss: 0.200 Vali Loss: 0.379 Vali Acc: 0.900 Test Loss: 0.379 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps20_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 617252
model size : 2.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps25_str13_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.6998870372772217
Epoch: 1, Steps: 3 | Train Loss: 1.410 Vali Loss: 1.386 Vali Acc: 0.100 Test Loss: 1.386 Test Acc: 0.100
Validation loss decreased (inf --> -0.099986).  Saving model ...
Epoch: 2 cost time: 0.5779712200164795
Epoch: 2, Steps: 3 | Train Loss: 1.356 Vali Loss: 1.383 Vali Acc: 0.150 Test Loss: 1.383 Test Acc: 0.150
Validation loss decreased (-0.099986 --> -0.149986).  Saving model ...
Epoch: 3 cost time: 0.46552276611328125
Epoch: 3, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.377 Vali Acc: 0.175 Test Loss: 1.377 Test Acc: 0.175
Validation loss decreased (-0.149986 --> -0.174986).  Saving model ...
Epoch: 4 cost time: 0.4555943012237549
Epoch: 4, Steps: 3 | Train Loss: 1.351 Vali Loss: 1.366 Vali Acc: 0.275 Test Loss: 1.366 Test Acc: 0.275
Validation loss decreased (-0.174986 --> -0.274986).  Saving model ...
Epoch: 5 cost time: 0.45105528831481934
Epoch: 5, Steps: 3 | Train Loss: 1.346 Vali Loss: 1.352 Vali Acc: 0.350 Test Loss: 1.352 Test Acc: 0.350
Validation loss decreased (-0.274986 --> -0.349986).  Saving model ...
Epoch: 6 cost time: 0.496304988861084
Epoch: 6, Steps: 3 | Train Loss: 1.277 Vali Loss: 1.332 Vali Acc: 0.425 Test Loss: 1.332 Test Acc: 0.425
Validation loss decreased (-0.349986 --> -0.424987).  Saving model ...
Epoch: 7 cost time: 0.4382188320159912
Epoch: 7, Steps: 3 | Train Loss: 1.247 Vali Loss: 1.308 Vali Acc: 0.475 Test Loss: 1.308 Test Acc: 0.475
Validation loss decreased (-0.424987 --> -0.474987).  Saving model ...
Epoch: 8 cost time: 0.4611790180206299
Epoch: 8, Steps: 3 | Train Loss: 1.174 Vali Loss: 1.283 Vali Acc: 0.525 Test Loss: 1.283 Test Acc: 0.525
Validation loss decreased (-0.474987 --> -0.524987).  Saving model ...
Epoch: 9 cost time: 0.4661698341369629
Epoch: 9, Steps: 3 | Train Loss: 1.176 Vali Loss: 1.254 Vali Acc: 0.600 Test Loss: 1.254 Test Acc: 0.600
Validation loss decreased (-0.524987 --> -0.599987).  Saving model ...
Epoch: 10 cost time: 0.48748302459716797
Epoch: 10, Steps: 3 | Train Loss: 1.113 Vali Loss: 1.222 Vali Acc: 0.650 Test Loss: 1.222 Test Acc: 0.650
Validation loss decreased (-0.599987 --> -0.649988).  Saving model ...
Epoch: 11 cost time: 0.49821043014526367
Epoch: 11, Steps: 3 | Train Loss: 1.068 Vali Loss: 1.188 Vali Acc: 0.700 Test Loss: 1.188 Test Acc: 0.700
Validation loss decreased (-0.649988 --> -0.699988).  Saving model ...
Epoch: 12 cost time: 0.5021109580993652
Epoch: 12, Steps: 3 | Train Loss: 1.012 Vali Loss: 1.157 Vali Acc: 0.700 Test Loss: 1.157 Test Acc: 0.700
Validation loss decreased (-0.699988 --> -0.699988).  Saving model ...
Epoch: 13 cost time: 0.5282459259033203
Epoch: 13, Steps: 3 | Train Loss: 0.973 Vali Loss: 1.123 Vali Acc: 0.700 Test Loss: 1.123 Test Acc: 0.700
Validation loss decreased (-0.699988 --> -0.699989).  Saving model ...
Epoch: 14 cost time: 0.5383963584899902
Epoch: 14, Steps: 3 | Train Loss: 0.943 Vali Loss: 1.092 Vali Acc: 0.750 Test Loss: 1.092 Test Acc: 0.750
Validation loss decreased (-0.699989 --> -0.749989).  Saving model ...
Epoch: 15 cost time: 0.4861729145050049
Epoch: 15, Steps: 3 | Train Loss: 0.892 Vali Loss: 1.061 Vali Acc: 0.750 Test Loss: 1.061 Test Acc: 0.750
Validation loss decreased (-0.749989 --> -0.749989).  Saving model ...
Epoch: 16 cost time: 0.519366979598999
Epoch: 16, Steps: 3 | Train Loss: 0.851 Vali Loss: 1.035 Vali Acc: 0.750 Test Loss: 1.035 Test Acc: 0.750
Validation loss decreased (-0.749989 --> -0.749990).  Saving model ...
Epoch: 17 cost time: 0.5035367012023926
Epoch: 17, Steps: 3 | Train Loss: 0.823 Vali Loss: 1.003 Vali Acc: 0.750 Test Loss: 1.003 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749990).  Saving model ...
Epoch: 18 cost time: 0.4810948371887207
Epoch: 18, Steps: 3 | Train Loss: 0.773 Vali Loss: 0.969 Vali Acc: 0.750 Test Loss: 0.969 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749990).  Saving model ...
Epoch: 19 cost time: 0.5010902881622314
Epoch: 19, Steps: 3 | Train Loss: 0.727 Vali Loss: 0.946 Vali Acc: 0.800 Test Loss: 0.946 Test Acc: 0.800
Validation loss decreased (-0.749990 --> -0.799991).  Saving model ...
Epoch: 20 cost time: 0.4635796546936035
Epoch: 20, Steps: 3 | Train Loss: 0.710 Vali Loss: 0.919 Vali Acc: 0.875 Test Loss: 0.919 Test Acc: 0.875
Validation loss decreased (-0.799991 --> -0.874991).  Saving model ...
Epoch: 21 cost time: 0.5075385570526123
Epoch: 21, Steps: 3 | Train Loss: 0.651 Vali Loss: 0.889 Vali Acc: 0.875 Test Loss: 0.889 Test Acc: 0.875
Validation loss decreased (-0.874991 --> -0.874991).  Saving model ...
Epoch: 22 cost time: 0.5362789630889893
Epoch: 22, Steps: 3 | Train Loss: 0.665 Vali Loss: 0.850 Vali Acc: 0.925 Test Loss: 0.850 Test Acc: 0.925
Validation loss decreased (-0.874991 --> -0.924991).  Saving model ...
Epoch: 23 cost time: 0.5072524547576904
Epoch: 23, Steps: 3 | Train Loss: 0.599 Vali Loss: 0.822 Vali Acc: 0.925 Test Loss: 0.822 Test Acc: 0.925
Validation loss decreased (-0.924991 --> -0.924992).  Saving model ...
Epoch: 24 cost time: 0.515526294708252
Epoch: 24, Steps: 3 | Train Loss: 0.581 Vali Loss: 0.806 Vali Acc: 0.925 Test Loss: 0.806 Test Acc: 0.925
Validation loss decreased (-0.924992 --> -0.924992).  Saving model ...
Epoch: 25 cost time: 0.5049123764038086
Epoch: 25, Steps: 3 | Train Loss: 0.535 Vali Loss: 0.779 Vali Acc: 0.925 Test Loss: 0.779 Test Acc: 0.925
Validation loss decreased (-0.924992 --> -0.924992).  Saving model ...
Epoch: 26 cost time: 0.46781373023986816
Epoch: 26, Steps: 3 | Train Loss: 0.500 Vali Loss: 0.764 Vali Acc: 0.925 Test Loss: 0.764 Test Acc: 0.925
Validation loss decreased (-0.924992 --> -0.924992).  Saving model ...
Epoch: 27 cost time: 0.4440724849700928
Epoch: 27, Steps: 3 | Train Loss: 0.489 Vali Loss: 0.742 Vali Acc: 0.925 Test Loss: 0.742 Test Acc: 0.925
Validation loss decreased (-0.924992 --> -0.924993).  Saving model ...
Epoch: 28 cost time: 0.599339485168457
Epoch: 28, Steps: 3 | Train Loss: 0.450 Vali Loss: 0.711 Vali Acc: 0.925 Test Loss: 0.711 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924993).  Saving model ...
Epoch: 29 cost time: 0.5611417293548584
Epoch: 29, Steps: 3 | Train Loss: 0.468 Vali Loss: 0.687 Vali Acc: 0.925 Test Loss: 0.687 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924993).  Saving model ...
Epoch: 30 cost time: 0.47094178199768066
Epoch: 30, Steps: 3 | Train Loss: 0.412 Vali Loss: 0.659 Vali Acc: 0.925 Test Loss: 0.659 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924993).  Saving model ...
Epoch: 31 cost time: 0.5351717472076416
Epoch: 31, Steps: 3 | Train Loss: 0.413 Vali Loss: 0.651 Vali Acc: 0.925 Test Loss: 0.651 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924993).  Saving model ...
Epoch: 32 cost time: 0.49044370651245117
Epoch: 32, Steps: 3 | Train Loss: 0.366 Vali Loss: 0.635 Vali Acc: 0.925 Test Loss: 0.635 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924994).  Saving model ...
Epoch: 33 cost time: 0.5822587013244629
Epoch: 33, Steps: 3 | Train Loss: 0.384 Vali Loss: 0.618 Vali Acc: 0.925 Test Loss: 0.618 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 34 cost time: 0.5861771106719971
Epoch: 34, Steps: 3 | Train Loss: 0.353 Vali Loss: 0.610 Vali Acc: 0.925 Test Loss: 0.610 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 35 cost time: 0.513418436050415
Epoch: 35, Steps: 3 | Train Loss: 0.348 Vali Loss: 0.587 Vali Acc: 0.925 Test Loss: 0.587 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 36 cost time: 0.6063966751098633
Epoch: 36, Steps: 3 | Train Loss: 0.317 Vali Loss: 0.577 Vali Acc: 0.925 Test Loss: 0.577 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 37 cost time: 0.5210826396942139
Epoch: 37, Steps: 3 | Train Loss: 0.316 Vali Loss: 0.558 Vali Acc: 0.925 Test Loss: 0.558 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 38 cost time: 0.4920785427093506
Epoch: 38, Steps: 3 | Train Loss: 0.269 Vali Loss: 0.545 Vali Acc: 0.925 Test Loss: 0.545 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 39 cost time: 0.5069425106048584
Epoch: 39, Steps: 3 | Train Loss: 0.258 Vali Loss: 0.539 Vali Acc: 0.925 Test Loss: 0.539 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 40 cost time: 0.5441718101501465
Epoch: 40, Steps: 3 | Train Loss: 0.258 Vali Loss: 0.522 Vali Acc: 0.900 Test Loss: 0.522 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.56520676612854
Epoch: 41, Steps: 3 | Train Loss: 0.257 Vali Loss: 0.505 Vali Acc: 0.900 Test Loss: 0.505 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.54227614402771
Epoch: 42, Steps: 3 | Train Loss: 0.223 Vali Loss: 0.494 Vali Acc: 0.925 Test Loss: 0.494 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 43 cost time: 0.559572696685791
Epoch: 43, Steps: 3 | Train Loss: 0.237 Vali Loss: 0.478 Vali Acc: 0.925 Test Loss: 0.478 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 44 cost time: 0.49812984466552734
Epoch: 44, Steps: 3 | Train Loss: 0.208 Vali Loss: 0.462 Vali Acc: 0.925 Test Loss: 0.462 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 45 cost time: 0.5023617744445801
Epoch: 45, Steps: 3 | Train Loss: 0.188 Vali Loss: 0.442 Vali Acc: 0.950 Test Loss: 0.442 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949996).  Saving model ...
Epoch: 46 cost time: 0.4957766532897949
Epoch: 46, Steps: 3 | Train Loss: 0.174 Vali Loss: 0.428 Vali Acc: 0.925 Test Loss: 0.428 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.596743106842041
Epoch: 47, Steps: 3 | Train Loss: 0.187 Vali Loss: 0.430 Vali Acc: 0.925 Test Loss: 0.430 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.5734975337982178
Epoch: 48, Steps: 3 | Train Loss: 0.166 Vali Loss: 0.417 Vali Acc: 0.925 Test Loss: 0.417 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.4959564208984375
Epoch: 49, Steps: 3 | Train Loss: 0.147 Vali Loss: 0.400 Vali Acc: 0.950 Test Loss: 0.400 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 50 cost time: 0.4594390392303467
Epoch: 50, Steps: 3 | Train Loss: 0.165 Vali Loss: 0.388 Vali Acc: 0.925 Test Loss: 0.388 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps25_str13_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 614340
model size : 2.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.6828320026397705
Epoch: 1, Steps: 3 | Train Loss: 1.341 Vali Loss: 1.362 Vali Acc: 0.275 Test Loss: 1.362 Test Acc: 0.275
Validation loss decreased (inf --> -0.274986).  Saving model ...
Epoch: 2 cost time: 0.4662790298461914
Epoch: 2, Steps: 3 | Train Loss: 1.267 Vali Loss: 1.347 Vali Acc: 0.350 Test Loss: 1.347 Test Acc: 0.350
Validation loss decreased (-0.274986 --> -0.349987).  Saving model ...
Epoch: 3 cost time: 0.4872579574584961
Epoch: 3, Steps: 3 | Train Loss: 1.233 Vali Loss: 1.320 Vali Acc: 0.450 Test Loss: 1.320 Test Acc: 0.450
Validation loss decreased (-0.349987 --> -0.449987).  Saving model ...
Epoch: 4 cost time: 0.47458982467651367
Epoch: 4, Steps: 3 | Train Loss: 1.162 Vali Loss: 1.276 Vali Acc: 0.775 Test Loss: 1.276 Test Acc: 0.775
Validation loss decreased (-0.449987 --> -0.774987).  Saving model ...
Epoch: 5 cost time: 0.48227787017822266
Epoch: 5, Steps: 3 | Train Loss: 1.074 Vali Loss: 1.220 Vali Acc: 0.750 Test Loss: 1.220 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.4612884521484375
Epoch: 6, Steps: 3 | Train Loss: 0.958 Vali Loss: 1.153 Vali Acc: 0.775 Test Loss: 1.153 Test Acc: 0.775
Validation loss decreased (-0.774987 --> -0.774988).  Saving model ...
Epoch: 7 cost time: 0.4706237316131592
Epoch: 7, Steps: 3 | Train Loss: 0.878 Vali Loss: 1.076 Vali Acc: 0.850 Test Loss: 1.076 Test Acc: 0.850
Validation loss decreased (-0.774988 --> -0.849989).  Saving model ...
Epoch: 8 cost time: 0.5839941501617432
Epoch: 8, Steps: 3 | Train Loss: 0.792 Vali Loss: 0.990 Vali Acc: 0.850 Test Loss: 0.990 Test Acc: 0.850
Validation loss decreased (-0.849989 --> -0.849990).  Saving model ...
Epoch: 9 cost time: 0.4681260585784912
Epoch: 9, Steps: 3 | Train Loss: 0.695 Vali Loss: 0.910 Vali Acc: 0.850 Test Loss: 0.910 Test Acc: 0.850
Validation loss decreased (-0.849990 --> -0.849991).  Saving model ...
Epoch: 10 cost time: 0.44850850105285645
Epoch: 10, Steps: 3 | Train Loss: 0.626 Vali Loss: 0.823 Vali Acc: 0.875 Test Loss: 0.823 Test Acc: 0.875
Validation loss decreased (-0.849991 --> -0.874992).  Saving model ...
Epoch: 11 cost time: 0.4375736713409424
Epoch: 11, Steps: 3 | Train Loss: 0.554 Vali Loss: 0.738 Vali Acc: 0.900 Test Loss: 0.738 Test Acc: 0.900
Validation loss decreased (-0.874992 --> -0.899993).  Saving model ...
Epoch: 12 cost time: 0.46501803398132324
Epoch: 12, Steps: 3 | Train Loss: 0.489 Vali Loss: 0.675 Vali Acc: 0.925 Test Loss: 0.675 Test Acc: 0.925
Validation loss decreased (-0.899993 --> -0.924993).  Saving model ...
Epoch: 13 cost time: 0.4542195796966553
Epoch: 13, Steps: 3 | Train Loss: 0.460 Vali Loss: 0.607 Vali Acc: 0.925 Test Loss: 0.607 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924994).  Saving model ...
Epoch: 14 cost time: 0.5360338687896729
Epoch: 14, Steps: 3 | Train Loss: 0.379 Vali Loss: 0.553 Vali Acc: 0.925 Test Loss: 0.553 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 15 cost time: 0.5923895835876465
Epoch: 15, Steps: 3 | Train Loss: 0.353 Vali Loss: 0.503 Vali Acc: 0.925 Test Loss: 0.503 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 16 cost time: 0.4625411033630371
Epoch: 16, Steps: 3 | Train Loss: 0.321 Vali Loss: 0.459 Vali Acc: 0.925 Test Loss: 0.459 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 17 cost time: 0.5527844429016113
Epoch: 17, Steps: 3 | Train Loss: 0.289 Vali Loss: 0.424 Vali Acc: 0.925 Test Loss: 0.424 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 18 cost time: 0.528125524520874
Epoch: 18, Steps: 3 | Train Loss: 0.256 Vali Loss: 0.398 Vali Acc: 0.925 Test Loss: 0.398 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 19 cost time: 0.452085018157959
Epoch: 19, Steps: 3 | Train Loss: 0.244 Vali Loss: 0.375 Vali Acc: 0.925 Test Loss: 0.375 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 20 cost time: 0.4563431739807129
Epoch: 20, Steps: 3 | Train Loss: 0.221 Vali Loss: 0.351 Vali Acc: 0.925 Test Loss: 0.351 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 21 cost time: 0.4383046627044678
Epoch: 21, Steps: 3 | Train Loss: 0.222 Vali Loss: 0.327 Vali Acc: 0.925 Test Loss: 0.327 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924997).  Saving model ...
Epoch: 22 cost time: 0.4369511604309082
Epoch: 22, Steps: 3 | Train Loss: 0.189 Vali Loss: 0.297 Vali Acc: 0.950 Test Loss: 0.297 Test Acc: 0.950
Validation loss decreased (-0.924997 --> -0.949997).  Saving model ...
Epoch: 23 cost time: 0.5080306529998779
Epoch: 23, Steps: 3 | Train Loss: 0.172 Vali Loss: 0.275 Vali Acc: 0.950 Test Loss: 0.275 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 24 cost time: 0.4594290256500244
Epoch: 24, Steps: 3 | Train Loss: 0.155 Vali Loss: 0.262 Vali Acc: 0.950 Test Loss: 0.262 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 25 cost time: 0.4455127716064453
Epoch: 25, Steps: 3 | Train Loss: 0.160 Vali Loss: 0.253 Vali Acc: 0.950 Test Loss: 0.253 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 26 cost time: 0.44194865226745605
Epoch: 26, Steps: 3 | Train Loss: 0.123 Vali Loss: 0.240 Vali Acc: 0.950 Test Loss: 0.240 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 27 cost time: 0.4808626174926758
Epoch: 27, Steps: 3 | Train Loss: 0.115 Vali Loss: 0.235 Vali Acc: 0.950 Test Loss: 0.235 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 28 cost time: 0.588104248046875
Epoch: 28, Steps: 3 | Train Loss: 0.112 Vali Loss: 0.228 Vali Acc: 0.950 Test Loss: 0.228 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 29 cost time: 0.5192792415618896
Epoch: 29, Steps: 3 | Train Loss: 0.087 Vali Loss: 0.208 Vali Acc: 0.950 Test Loss: 0.208 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 30 cost time: 0.5294008255004883
Epoch: 30, Steps: 3 | Train Loss: 0.090 Vali Loss: 0.197 Vali Acc: 0.950 Test Loss: 0.197 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 31 cost time: 0.42644429206848145
Epoch: 31, Steps: 3 | Train Loss: 0.083 Vali Loss: 0.186 Vali Acc: 0.950 Test Loss: 0.186 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 32 cost time: 0.4731295108795166
Epoch: 32, Steps: 3 | Train Loss: 0.055 Vali Loss: 0.175 Vali Acc: 0.950 Test Loss: 0.175 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 33 cost time: 0.4868907928466797
Epoch: 33, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.173 Vali Acc: 0.950 Test Loss: 0.173 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 34 cost time: 0.47870922088623047
Epoch: 34, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.166 Vali Acc: 0.950 Test Loss: 0.166 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 35 cost time: 0.4837033748626709
Epoch: 35, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.161 Vali Acc: 0.950 Test Loss: 0.161 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 36 cost time: 0.4538695812225342
Epoch: 36, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.157 Vali Acc: 0.950 Test Loss: 0.157 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 37 cost time: 0.51226806640625
Epoch: 37, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.154 Vali Acc: 0.950 Test Loss: 0.154 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 38 cost time: 0.46943163871765137
Epoch: 38, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.159 Vali Acc: 0.950 Test Loss: 0.159 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.4090077877044678
Epoch: 39, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.157 Vali Acc: 0.950 Test Loss: 0.157 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.45015382766723633
Epoch: 40, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.156 Vali Acc: 0.950 Test Loss: 0.156 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.4419727325439453
Epoch: 41, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.152 Vali Acc: 0.950 Test Loss: 0.152 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 42 cost time: 0.4394056797027588
Epoch: 42, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.150 Vali Acc: 0.950 Test Loss: 0.150 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 43 cost time: 0.5158021450042725
Epoch: 43, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.148 Vali Acc: 0.950 Test Loss: 0.148 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949999).  Saving model ...
Epoch: 44 cost time: 0.5137722492218018
Epoch: 44, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.155 Vali Acc: 0.950 Test Loss: 0.155 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.4618813991546631
Epoch: 45, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.153 Vali Acc: 0.950 Test Loss: 0.153 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.5081865787506104
Epoch: 46, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.151 Vali Acc: 0.950 Test Loss: 0.151 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.4788627624511719
Epoch: 47, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.157 Vali Acc: 0.950 Test Loss: 0.157 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.47635746002197266
Epoch: 48, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.161 Vali Acc: 0.950 Test Loss: 0.161 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.4760439395904541
Epoch: 49, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.156 Vali Acc: 0.950 Test Loss: 0.156 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.44626450538635254
Epoch: 50, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.153 Vali Acc: 0.950 Test Loss: 0.153 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 642052
model size : 2.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.6489744186401367
Epoch: 1, Steps: 3 | Train Loss: 1.444 Vali Loss: 1.406 Vali Acc: 0.200 Test Loss: 1.406 Test Acc: 0.200
Validation loss decreased (inf --> -0.199986).  Saving model ...
Epoch: 2 cost time: 0.46712613105773926
Epoch: 2, Steps: 3 | Train Loss: 1.371 Vali Loss: 1.400 Vali Acc: 0.250 Test Loss: 1.400 Test Acc: 0.250
Validation loss decreased (-0.199986 --> -0.249986).  Saving model ...
Epoch: 3 cost time: 0.5181012153625488
Epoch: 3, Steps: 3 | Train Loss: 1.331 Vali Loss: 1.384 Vali Acc: 0.275 Test Loss: 1.384 Test Acc: 0.275
Validation loss decreased (-0.249986 --> -0.274986).  Saving model ...
Epoch: 4 cost time: 0.4689452648162842
Epoch: 4, Steps: 3 | Train Loss: 1.291 Vali Loss: 1.352 Vali Acc: 0.300 Test Loss: 1.352 Test Acc: 0.300
Validation loss decreased (-0.274986 --> -0.299986).  Saving model ...
Epoch: 5 cost time: 0.4783976078033447
Epoch: 5, Steps: 3 | Train Loss: 1.180 Vali Loss: 1.309 Vali Acc: 0.350 Test Loss: 1.309 Test Acc: 0.350
Validation loss decreased (-0.299986 --> -0.349987).  Saving model ...
Epoch: 6 cost time: 0.46033525466918945
Epoch: 6, Steps: 3 | Train Loss: 1.083 Vali Loss: 1.253 Vali Acc: 0.400 Test Loss: 1.253 Test Acc: 0.400
Validation loss decreased (-0.349987 --> -0.399987).  Saving model ...
Epoch: 7 cost time: 0.5317947864532471
Epoch: 7, Steps: 3 | Train Loss: 1.003 Vali Loss: 1.185 Vali Acc: 0.625 Test Loss: 1.185 Test Acc: 0.625
Validation loss decreased (-0.399987 --> -0.624988).  Saving model ...
Epoch: 8 cost time: 0.5535063743591309
Epoch: 8, Steps: 3 | Train Loss: 0.899 Vali Loss: 1.104 Vali Acc: 0.750 Test Loss: 1.104 Test Acc: 0.750
Validation loss decreased (-0.624988 --> -0.749989).  Saving model ...
Epoch: 9 cost time: 0.4383423328399658
Epoch: 9, Steps: 3 | Train Loss: 0.812 Vali Loss: 1.022 Vali Acc: 0.825 Test Loss: 1.022 Test Acc: 0.825
Validation loss decreased (-0.749989 --> -0.824990).  Saving model ...
Epoch: 10 cost time: 0.5338339805603027
Epoch: 10, Steps: 3 | Train Loss: 0.768 Vali Loss: 0.933 Vali Acc: 0.825 Test Loss: 0.933 Test Acc: 0.825
Validation loss decreased (-0.824990 --> -0.824991).  Saving model ...
Epoch: 11 cost time: 0.4542248249053955
Epoch: 11, Steps: 3 | Train Loss: 0.661 Vali Loss: 0.853 Vali Acc: 0.850 Test Loss: 0.853 Test Acc: 0.850
Validation loss decreased (-0.824991 --> -0.849991).  Saving model ...
Epoch: 12 cost time: 0.46911096572875977
Epoch: 12, Steps: 3 | Train Loss: 0.593 Vali Loss: 0.776 Vali Acc: 0.900 Test Loss: 0.776 Test Acc: 0.900
Validation loss decreased (-0.849991 --> -0.899992).  Saving model ...
Epoch: 13 cost time: 0.5030972957611084
Epoch: 13, Steps: 3 | Train Loss: 0.538 Vali Loss: 0.703 Vali Acc: 0.925 Test Loss: 0.703 Test Acc: 0.925
Validation loss decreased (-0.899992 --> -0.924993).  Saving model ...
Epoch: 14 cost time: 0.46674299240112305
Epoch: 14, Steps: 3 | Train Loss: 0.456 Vali Loss: 0.636 Vali Acc: 0.925 Test Loss: 0.636 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924994).  Saving model ...
Epoch: 15 cost time: 0.4981422424316406
Epoch: 15, Steps: 3 | Train Loss: 0.408 Vali Loss: 0.574 Vali Acc: 0.925 Test Loss: 0.574 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 16 cost time: 0.4595334529876709
Epoch: 16, Steps: 3 | Train Loss: 0.367 Vali Loss: 0.543 Vali Acc: 0.900 Test Loss: 0.543 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.4375476837158203
Epoch: 17, Steps: 3 | Train Loss: 0.352 Vali Loss: 0.495 Vali Acc: 0.900 Test Loss: 0.495 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.4588587284088135
Epoch: 18, Steps: 3 | Train Loss: 0.334 Vali Loss: 0.455 Vali Acc: 0.900 Test Loss: 0.455 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.5066051483154297
Epoch: 19, Steps: 3 | Train Loss: 0.302 Vali Loss: 0.412 Vali Acc: 0.950 Test Loss: 0.412 Test Acc: 0.950
Validation loss decreased (-0.924994 --> -0.949996).  Saving model ...
Epoch: 20 cost time: 0.4708526134490967
Epoch: 20, Steps: 3 | Train Loss: 0.260 Vali Loss: 0.379 Vali Acc: 0.950 Test Loss: 0.379 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 21 cost time: 0.46637701988220215
Epoch: 21, Steps: 3 | Train Loss: 0.246 Vali Loss: 0.349 Vali Acc: 0.975 Test Loss: 0.349 Test Acc: 0.975
Validation loss decreased (-0.949996 --> -0.974997).  Saving model ...
Epoch: 22 cost time: 0.5287041664123535
Epoch: 22, Steps: 3 | Train Loss: 0.208 Vali Loss: 0.322 Vali Acc: 0.975 Test Loss: 0.322 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 23 cost time: 0.47744178771972656
Epoch: 23, Steps: 3 | Train Loss: 0.201 Vali Loss: 0.301 Vali Acc: 0.975 Test Loss: 0.301 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 24 cost time: 0.5098862648010254
Epoch: 24, Steps: 3 | Train Loss: 0.198 Vali Loss: 0.281 Vali Acc: 0.975 Test Loss: 0.281 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 25 cost time: 0.47235107421875
Epoch: 25, Steps: 3 | Train Loss: 0.222 Vali Loss: 0.264 Vali Acc: 0.975 Test Loss: 0.264 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 26 cost time: 0.533048152923584
Epoch: 26, Steps: 3 | Train Loss: 0.178 Vali Loss: 0.251 Vali Acc: 0.975 Test Loss: 0.251 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 27 cost time: 0.43865180015563965
Epoch: 27, Steps: 3 | Train Loss: 0.148 Vali Loss: 0.238 Vali Acc: 0.975 Test Loss: 0.238 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 28 cost time: 0.607297420501709
Epoch: 28, Steps: 3 | Train Loss: 0.155 Vali Loss: 0.232 Vali Acc: 0.975 Test Loss: 0.232 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 29 cost time: 0.5509600639343262
Epoch: 29, Steps: 3 | Train Loss: 0.119 Vali Loss: 0.216 Vali Acc: 0.975 Test Loss: 0.216 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 30 cost time: 0.45587611198425293
Epoch: 30, Steps: 3 | Train Loss: 0.118 Vali Loss: 0.203 Vali Acc: 0.975 Test Loss: 0.203 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 31 cost time: 0.45889735221862793
Epoch: 31, Steps: 3 | Train Loss: 0.099 Vali Loss: 0.196 Vali Acc: 0.975 Test Loss: 0.196 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 32 cost time: 0.44983911514282227
Epoch: 32, Steps: 3 | Train Loss: 0.090 Vali Loss: 0.187 Vali Acc: 0.975 Test Loss: 0.187 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 33 cost time: 0.4991745948791504
Epoch: 33, Steps: 3 | Train Loss: 0.091 Vali Loss: 0.181 Vali Acc: 0.950 Test Loss: 0.181 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.4823570251464844
Epoch: 34, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.178 Vali Acc: 0.950 Test Loss: 0.178 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.49442052841186523
Epoch: 35, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.178 Vali Acc: 0.950 Test Loss: 0.178 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.4835937023162842
Epoch: 36, Steps: 3 | Train Loss: 0.055 Vali Loss: 0.168 Vali Acc: 0.950 Test Loss: 0.168 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.4826846122741699
Epoch: 37, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.162 Vali Acc: 0.950 Test Loss: 0.162 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.4811210632324219
Epoch: 38, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.160 Vali Acc: 0.950 Test Loss: 0.160 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.49419569969177246
Epoch: 39, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.154 Vali Acc: 0.950 Test Loss: 0.154 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.5767629146575928
Epoch: 40, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.153 Vali Acc: 0.950 Test Loss: 0.153 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.5198919773101807
Epoch: 41, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.154 Vali Acc: 0.950 Test Loss: 0.154 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.473644495010376
Epoch: 42, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.150 Vali Acc: 0.950 Test Loss: 0.150 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 629828
model size : 2.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.7371809482574463
Epoch: 1, Steps: 3 | Train Loss: 1.403 Vali Loss: 1.368 Vali Acc: 0.300 Test Loss: 1.368 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 0.4919557571411133
Epoch: 2, Steps: 3 | Train Loss: 1.376 Vali Loss: 1.354 Vali Acc: 0.300 Test Loss: 1.354 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299986).  Saving model ...
Epoch: 3 cost time: 0.4628767967224121
Epoch: 3, Steps: 3 | Train Loss: 1.308 Vali Loss: 1.334 Vali Acc: 0.300 Test Loss: 1.334 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299987).  Saving model ...
Epoch: 4 cost time: 0.5433740615844727
Epoch: 4, Steps: 3 | Train Loss: 1.252 Vali Loss: 1.303 Vali Acc: 0.350 Test Loss: 1.303 Test Acc: 0.350
Validation loss decreased (-0.299987 --> -0.349987).  Saving model ...
Epoch: 5 cost time: 0.5242266654968262
Epoch: 5, Steps: 3 | Train Loss: 1.205 Vali Loss: 1.261 Vali Acc: 0.375 Test Loss: 1.261 Test Acc: 0.375
Validation loss decreased (-0.349987 --> -0.374987).  Saving model ...
Epoch: 6 cost time: 0.4502401351928711
Epoch: 6, Steps: 3 | Train Loss: 1.134 Vali Loss: 1.210 Vali Acc: 0.550 Test Loss: 1.210 Test Acc: 0.550
Validation loss decreased (-0.374987 --> -0.549988).  Saving model ...
Epoch: 7 cost time: 0.48197078704833984
Epoch: 7, Steps: 3 | Train Loss: 1.058 Vali Loss: 1.151 Vali Acc: 0.650 Test Loss: 1.151 Test Acc: 0.650
Validation loss decreased (-0.549988 --> -0.649988).  Saving model ...
Epoch: 8 cost time: 0.4928324222564697
Epoch: 8, Steps: 3 | Train Loss: 0.964 Vali Loss: 1.093 Vali Acc: 0.675 Test Loss: 1.093 Test Acc: 0.675
Validation loss decreased (-0.649988 --> -0.674989).  Saving model ...
Epoch: 9 cost time: 0.5231399536132812
Epoch: 9, Steps: 3 | Train Loss: 0.904 Vali Loss: 1.025 Vali Acc: 0.750 Test Loss: 1.025 Test Acc: 0.750
Validation loss decreased (-0.674989 --> -0.749990).  Saving model ...
Epoch: 10 cost time: 0.4760117530822754
Epoch: 10, Steps: 3 | Train Loss: 0.835 Vali Loss: 0.966 Vali Acc: 0.825 Test Loss: 0.966 Test Acc: 0.825
Validation loss decreased (-0.749990 --> -0.824990).  Saving model ...
Epoch: 11 cost time: 0.48714351654052734
Epoch: 11, Steps: 3 | Train Loss: 0.764 Vali Loss: 0.907 Vali Acc: 0.825 Test Loss: 0.907 Test Acc: 0.825
Validation loss decreased (-0.824990 --> -0.824991).  Saving model ...
Epoch: 12 cost time: 0.528780460357666
Epoch: 12, Steps: 3 | Train Loss: 0.722 Vali Loss: 0.841 Vali Acc: 0.850 Test Loss: 0.841 Test Acc: 0.850
Validation loss decreased (-0.824991 --> -0.849992).  Saving model ...
Epoch: 13 cost time: 0.5232234001159668
Epoch: 13, Steps: 3 | Train Loss: 0.617 Vali Loss: 0.775 Vali Acc: 0.850 Test Loss: 0.775 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 14 cost time: 0.5311627388000488
Epoch: 14, Steps: 3 | Train Loss: 0.609 Vali Loss: 0.713 Vali Acc: 0.850 Test Loss: 0.713 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849993).  Saving model ...
Epoch: 15 cost time: 0.4951186180114746
Epoch: 15, Steps: 3 | Train Loss: 0.511 Vali Loss: 0.670 Vali Acc: 0.850 Test Loss: 0.670 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 16 cost time: 0.4051830768585205
Epoch: 16, Steps: 3 | Train Loss: 0.476 Vali Loss: 0.627 Vali Acc: 0.850 Test Loss: 0.627 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849994).  Saving model ...
Epoch: 17 cost time: 0.4905738830566406
Epoch: 17, Steps: 3 | Train Loss: 0.436 Vali Loss: 0.589 Vali Acc: 0.875 Test Loss: 0.589 Test Acc: 0.875
Validation loss decreased (-0.849994 --> -0.874994).  Saving model ...
Epoch: 18 cost time: 0.4901871681213379
Epoch: 18, Steps: 3 | Train Loss: 0.415 Vali Loss: 0.545 Vali Acc: 0.875 Test Loss: 0.545 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 19 cost time: 0.5001277923583984
Epoch: 19, Steps: 3 | Train Loss: 0.392 Vali Loss: 0.519 Vali Acc: 0.900 Test Loss: 0.519 Test Acc: 0.900
Validation loss decreased (-0.874995 --> -0.899995).  Saving model ...
Epoch: 20 cost time: 0.49039697647094727
Epoch: 20, Steps: 3 | Train Loss: 0.348 Vali Loss: 0.487 Vali Acc: 0.900 Test Loss: 0.487 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 21 cost time: 0.44658470153808594
Epoch: 21, Steps: 3 | Train Loss: 0.308 Vali Loss: 0.459 Vali Acc: 0.900 Test Loss: 0.459 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 22 cost time: 0.45276474952697754
Epoch: 22, Steps: 3 | Train Loss: 0.321 Vali Loss: 0.426 Vali Acc: 0.925 Test Loss: 0.426 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924996).  Saving model ...
Epoch: 23 cost time: 0.5019779205322266
Epoch: 23, Steps: 3 | Train Loss: 0.280 Vali Loss: 0.410 Vali Acc: 0.950 Test Loss: 0.410 Test Acc: 0.950
Validation loss decreased (-0.924996 --> -0.949996).  Saving model ...
Epoch: 24 cost time: 0.48213911056518555
Epoch: 24, Steps: 3 | Train Loss: 0.258 Vali Loss: 0.391 Vali Acc: 0.950 Test Loss: 0.391 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 25 cost time: 0.42697906494140625
Epoch: 25, Steps: 3 | Train Loss: 0.236 Vali Loss: 0.382 Vali Acc: 0.950 Test Loss: 0.382 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 26 cost time: 0.5539250373840332
Epoch: 26, Steps: 3 | Train Loss: 0.226 Vali Loss: 0.368 Vali Acc: 0.950 Test Loss: 0.368 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 27 cost time: 0.44690775871276855
Epoch: 27, Steps: 3 | Train Loss: 0.213 Vali Loss: 0.343 Vali Acc: 0.950 Test Loss: 0.343 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 28 cost time: 0.47322821617126465
Epoch: 28, Steps: 3 | Train Loss: 0.199 Vali Loss: 0.325 Vali Acc: 0.950 Test Loss: 0.325 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 29 cost time: 0.4736464023590088
Epoch: 29, Steps: 3 | Train Loss: 0.181 Vali Loss: 0.314 Vali Acc: 0.950 Test Loss: 0.314 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 30 cost time: 0.5062501430511475
Epoch: 30, Steps: 3 | Train Loss: 0.171 Vali Loss: 0.303 Vali Acc: 0.950 Test Loss: 0.303 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 31 cost time: 0.4846811294555664
Epoch: 31, Steps: 3 | Train Loss: 0.153 Vali Loss: 0.291 Vali Acc: 0.950 Test Loss: 0.291 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 32 cost time: 0.45695996284484863
Epoch: 32, Steps: 3 | Train Loss: 0.161 Vali Loss: 0.285 Vali Acc: 0.950 Test Loss: 0.285 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 33 cost time: 0.5085048675537109
Epoch: 33, Steps: 3 | Train Loss: 0.138 Vali Loss: 0.279 Vali Acc: 0.950 Test Loss: 0.279 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 34 cost time: 0.4311952590942383
Epoch: 34, Steps: 3 | Train Loss: 0.113 Vali Loss: 0.264 Vali Acc: 0.950 Test Loss: 0.264 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 35 cost time: 0.46413755416870117
Epoch: 35, Steps: 3 | Train Loss: 0.111 Vali Loss: 0.266 Vali Acc: 0.950 Test Loss: 0.266 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.525120735168457
Epoch: 36, Steps: 3 | Train Loss: 0.117 Vali Loss: 0.261 Vali Acc: 0.950 Test Loss: 0.261 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 37 cost time: 0.5186724662780762
Epoch: 37, Steps: 3 | Train Loss: 0.100 Vali Loss: 0.250 Vali Acc: 0.950 Test Loss: 0.250 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 38 cost time: 0.4813728332519531
Epoch: 38, Steps: 3 | Train Loss: 0.091 Vali Loss: 0.251 Vali Acc: 0.950 Test Loss: 0.251 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.4016604423522949
Epoch: 39, Steps: 3 | Train Loss: 0.076 Vali Loss: 0.239 Vali Acc: 0.950 Test Loss: 0.239 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 40 cost time: 0.47452211380004883
Epoch: 40, Steps: 3 | Train Loss: 0.070 Vali Loss: 0.228 Vali Acc: 0.950 Test Loss: 0.228 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 41 cost time: 0.5362358093261719
Epoch: 41, Steps: 3 | Train Loss: 0.074 Vali Loss: 0.221 Vali Acc: 0.950 Test Loss: 0.221 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 42 cost time: 0.4298670291900635
Epoch: 42, Steps: 3 | Train Loss: 0.062 Vali Loss: 0.215 Vali Acc: 0.950 Test Loss: 0.215 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 43 cost time: 0.4559016227722168
Epoch: 43, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.208 Vali Acc: 0.950 Test Loss: 0.208 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 44 cost time: 0.5865573883056641
Epoch: 44, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.205 Vali Acc: 0.950 Test Loss: 0.205 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 45 cost time: 0.5462441444396973
Epoch: 45, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.205 Vali Acc: 0.950 Test Loss: 0.205 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 46 cost time: 0.5340518951416016
Epoch: 46, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.207 Vali Acc: 0.950 Test Loss: 0.207 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.4847745895385742
Epoch: 47, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.204 Vali Acc: 0.950 Test Loss: 0.204 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 48 cost time: 0.5461032390594482
Epoch: 48, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.198 Vali Acc: 0.950 Test Loss: 0.198 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 49 cost time: 0.4501206874847412
Epoch: 49, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.196 Vali Acc: 0.950 Test Loss: 0.196 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 50 cost time: 0.5308008193969727
Epoch: 50, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.194 Vali Acc: 0.950 Test Loss: 0.194 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 623780
model size : 2.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.7380387783050537
Epoch: 1, Steps: 3 | Train Loss: 1.382 Vali Loss: 1.421 Vali Acc: 0.150 Test Loss: 1.421 Test Acc: 0.150
Validation loss decreased (inf --> -0.149986).  Saving model ...
Epoch: 2 cost time: 0.44133424758911133
Epoch: 2, Steps: 3 | Train Loss: 1.426 Vali Loss: 1.415 Vali Acc: 0.150 Test Loss: 1.415 Test Acc: 0.150
Validation loss decreased (-0.149986 --> -0.149986).  Saving model ...
Epoch: 3 cost time: 0.4823751449584961
Epoch: 3, Steps: 3 | Train Loss: 1.332 Vali Loss: 1.405 Vali Acc: 0.150 Test Loss: 1.405 Test Acc: 0.150
Validation loss decreased (-0.149986 --> -0.149986).  Saving model ...
Epoch: 4 cost time: 0.4791741371154785
Epoch: 4, Steps: 3 | Train Loss: 1.284 Vali Loss: 1.386 Vali Acc: 0.275 Test Loss: 1.386 Test Acc: 0.275
Validation loss decreased (-0.149986 --> -0.274986).  Saving model ...
Epoch: 5 cost time: 0.4914088249206543
Epoch: 5, Steps: 3 | Train Loss: 1.219 Vali Loss: 1.358 Vali Acc: 0.325 Test Loss: 1.358 Test Acc: 0.325
Validation loss decreased (-0.274986 --> -0.324986).  Saving model ...
Epoch: 6 cost time: 0.4468097686767578
Epoch: 6, Steps: 3 | Train Loss: 1.197 Vali Loss: 1.320 Vali Acc: 0.350 Test Loss: 1.320 Test Acc: 0.350
Validation loss decreased (-0.324986 --> -0.349987).  Saving model ...
Epoch: 7 cost time: 0.5269336700439453
Epoch: 7, Steps: 3 | Train Loss: 1.102 Vali Loss: 1.279 Vali Acc: 0.425 Test Loss: 1.279 Test Acc: 0.425
Validation loss decreased (-0.349987 --> -0.424987).  Saving model ...
Epoch: 8 cost time: 0.4711730480194092
Epoch: 8, Steps: 3 | Train Loss: 1.075 Vali Loss: 1.231 Vali Acc: 0.500 Test Loss: 1.231 Test Acc: 0.500
Validation loss decreased (-0.424987 --> -0.499988).  Saving model ...
Epoch: 9 cost time: 0.47940707206726074
Epoch: 9, Steps: 3 | Train Loss: 0.973 Vali Loss: 1.182 Vali Acc: 0.450 Test Loss: 1.182 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.43652915954589844
Epoch: 10, Steps: 3 | Train Loss: 0.933 Vali Loss: 1.129 Vali Acc: 0.500 Test Loss: 1.129 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499989).  Saving model ...
Epoch: 11 cost time: 0.4440596103668213
Epoch: 11, Steps: 3 | Train Loss: 0.875 Vali Loss: 1.070 Vali Acc: 0.650 Test Loss: 1.070 Test Acc: 0.650
Validation loss decreased (-0.499989 --> -0.649989).  Saving model ...
Epoch: 12 cost time: 0.41839051246643066
Epoch: 12, Steps: 3 | Train Loss: 0.788 Vali Loss: 1.020 Vali Acc: 0.775 Test Loss: 1.020 Test Acc: 0.775
Validation loss decreased (-0.649989 --> -0.774990).  Saving model ...
Epoch: 13 cost time: 0.45024847984313965
Epoch: 13, Steps: 3 | Train Loss: 0.750 Vali Loss: 0.957 Vali Acc: 0.875 Test Loss: 0.957 Test Acc: 0.875
Validation loss decreased (-0.774990 --> -0.874990).  Saving model ...
Epoch: 14 cost time: 0.4113152027130127
Epoch: 14, Steps: 3 | Train Loss: 0.682 Vali Loss: 0.906 Vali Acc: 0.875 Test Loss: 0.906 Test Acc: 0.875
Validation loss decreased (-0.874990 --> -0.874991).  Saving model ...
Epoch: 15 cost time: 0.3951399326324463
Epoch: 15, Steps: 3 | Train Loss: 0.619 Vali Loss: 0.860 Vali Acc: 0.875 Test Loss: 0.860 Test Acc: 0.875
Validation loss decreased (-0.874991 --> -0.874991).  Saving model ...
Epoch: 16 cost time: 0.45783233642578125
Epoch: 16, Steps: 3 | Train Loss: 0.594 Vali Loss: 0.808 Vali Acc: 0.875 Test Loss: 0.808 Test Acc: 0.875
Validation loss decreased (-0.874991 --> -0.874992).  Saving model ...
Epoch: 17 cost time: 0.4993915557861328
Epoch: 17, Steps: 3 | Train Loss: 0.563 Vali Loss: 0.770 Vali Acc: 0.875 Test Loss: 0.770 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874992).  Saving model ...
Epoch: 18 cost time: 0.4415245056152344
Epoch: 18, Steps: 3 | Train Loss: 0.571 Vali Loss: 0.719 Vali Acc: 0.850 Test Loss: 0.719 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.530447244644165
Epoch: 19, Steps: 3 | Train Loss: 0.473 Vali Loss: 0.690 Vali Acc: 0.875 Test Loss: 0.690 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874993).  Saving model ...
Epoch: 20 cost time: 0.5039734840393066
Epoch: 20, Steps: 3 | Train Loss: 0.432 Vali Loss: 0.666 Vali Acc: 0.850 Test Loss: 0.666 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.4414076805114746
Epoch: 21, Steps: 3 | Train Loss: 0.448 Vali Loss: 0.627 Vali Acc: 0.875 Test Loss: 0.627 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 22 cost time: 0.5345478057861328
Epoch: 22, Steps: 3 | Train Loss: 0.385 Vali Loss: 0.599 Vali Acc: 0.875 Test Loss: 0.599 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 23 cost time: 0.5725290775299072
Epoch: 23, Steps: 3 | Train Loss: 0.366 Vali Loss: 0.576 Vali Acc: 0.900 Test Loss: 0.576 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899994).  Saving model ...
Epoch: 24 cost time: 0.4684717655181885
Epoch: 24, Steps: 3 | Train Loss: 0.338 Vali Loss: 0.551 Vali Acc: 0.950 Test Loss: 0.551 Test Acc: 0.950
Validation loss decreased (-0.899994 --> -0.949994).  Saving model ...
Epoch: 25 cost time: 0.46851134300231934
Epoch: 25, Steps: 3 | Train Loss: 0.337 Vali Loss: 0.543 Vali Acc: 0.925 Test Loss: 0.543 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.47290515899658203
Epoch: 26, Steps: 3 | Train Loss: 0.304 Vali Loss: 0.520 Vali Acc: 0.925 Test Loss: 0.520 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.4782979488372803
Epoch: 27, Steps: 3 | Train Loss: 0.253 Vali Loss: 0.485 Vali Acc: 0.975 Test Loss: 0.485 Test Acc: 0.975
Validation loss decreased (-0.949994 --> -0.974995).  Saving model ...
Epoch: 28 cost time: 0.49588537216186523
Epoch: 28, Steps: 3 | Train Loss: 0.285 Vali Loss: 0.477 Vali Acc: 0.950 Test Loss: 0.477 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.5242693424224854
Epoch: 29, Steps: 3 | Train Loss: 0.269 Vali Loss: 0.453 Vali Acc: 0.950 Test Loss: 0.453 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.5078823566436768
Epoch: 30, Steps: 3 | Train Loss: 0.247 Vali Loss: 0.428 Vali Acc: 0.950 Test Loss: 0.428 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.49848175048828125
Epoch: 31, Steps: 3 | Train Loss: 0.219 Vali Loss: 0.412 Vali Acc: 0.950 Test Loss: 0.412 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.5407147407531738
Epoch: 32, Steps: 3 | Train Loss: 0.226 Vali Loss: 0.400 Vali Acc: 0.950 Test Loss: 0.400 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.581589937210083
Epoch: 33, Steps: 3 | Train Loss: 0.198 Vali Loss: 0.393 Vali Acc: 0.950 Test Loss: 0.393 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.5287127494812012
Epoch: 34, Steps: 3 | Train Loss: 0.198 Vali Loss: 0.377 Vali Acc: 0.950 Test Loss: 0.377 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.540651798248291
Epoch: 35, Steps: 3 | Train Loss: 0.169 Vali Loss: 0.353 Vali Acc: 0.950 Test Loss: 0.353 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.5020337104797363
Epoch: 36, Steps: 3 | Train Loss: 0.159 Vali Loss: 0.351 Vali Acc: 0.950 Test Loss: 0.351 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.5532963275909424
Epoch: 37, Steps: 3 | Train Loss: 0.168 Vali Loss: 0.337 Vali Acc: 0.950 Test Loss: 0.337 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 617700
model size : 2.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.7396597862243652
Epoch: 1, Steps: 3 | Train Loss: 1.369 Vali Loss: 1.394 Vali Acc: 0.275 Test Loss: 1.394 Test Acc: 0.275
Validation loss decreased (inf --> -0.274986).  Saving model ...
Epoch: 2 cost time: 0.47528934478759766
Epoch: 2, Steps: 3 | Train Loss: 1.368 Vali Loss: 1.384 Vali Acc: 0.250 Test Loss: 1.384 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5091660022735596
Epoch: 3, Steps: 3 | Train Loss: 1.340 Vali Loss: 1.372 Vali Acc: 0.225 Test Loss: 1.372 Test Acc: 0.225
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.4406626224517822
Epoch: 4, Steps: 3 | Train Loss: 1.322 Vali Loss: 1.355 Vali Acc: 0.225 Test Loss: 1.355 Test Acc: 0.225
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.42559337615966797
Epoch: 5, Steps: 3 | Train Loss: 1.267 Vali Loss: 1.330 Vali Acc: 0.275 Test Loss: 1.330 Test Acc: 0.275
Validation loss decreased (-0.274986 --> -0.274987).  Saving model ...
Epoch: 6 cost time: 0.5412859916687012
Epoch: 6, Steps: 3 | Train Loss: 1.222 Vali Loss: 1.299 Vali Acc: 0.375 Test Loss: 1.299 Test Acc: 0.375
Validation loss decreased (-0.274987 --> -0.374987).  Saving model ...
Epoch: 7 cost time: 0.45574045181274414
Epoch: 7, Steps: 3 | Train Loss: 1.196 Vali Loss: 1.263 Vali Acc: 0.400 Test Loss: 1.263 Test Acc: 0.400
Validation loss decreased (-0.374987 --> -0.399987).  Saving model ...
Epoch: 8 cost time: 0.5346250534057617
Epoch: 8, Steps: 3 | Train Loss: 1.110 Vali Loss: 1.225 Vali Acc: 0.450 Test Loss: 1.225 Test Acc: 0.450
Validation loss decreased (-0.399987 --> -0.449988).  Saving model ...
Epoch: 9 cost time: 0.499194860458374
Epoch: 9, Steps: 3 | Train Loss: 1.057 Vali Loss: 1.191 Vali Acc: 0.500 Test Loss: 1.191 Test Acc: 0.500
Validation loss decreased (-0.449988 --> -0.499988).  Saving model ...
Epoch: 10 cost time: 0.5166614055633545
Epoch: 10, Steps: 3 | Train Loss: 1.024 Vali Loss: 1.146 Vali Acc: 0.600 Test Loss: 1.146 Test Acc: 0.600
Validation loss decreased (-0.499988 --> -0.599989).  Saving model ...
Epoch: 11 cost time: 0.5723674297332764
Epoch: 11, Steps: 3 | Train Loss: 0.970 Vali Loss: 1.102 Vali Acc: 0.700 Test Loss: 1.102 Test Acc: 0.700
Validation loss decreased (-0.599989 --> -0.699989).  Saving model ...
Epoch: 12 cost time: 0.5236613750457764
Epoch: 12, Steps: 3 | Train Loss: 0.936 Vali Loss: 1.054 Vali Acc: 0.725 Test Loss: 1.054 Test Acc: 0.725
Validation loss decreased (-0.699989 --> -0.724989).  Saving model ...
Epoch: 13 cost time: 0.4916505813598633
Epoch: 13, Steps: 3 | Train Loss: 0.866 Vali Loss: 1.014 Vali Acc: 0.825 Test Loss: 1.014 Test Acc: 0.825
Validation loss decreased (-0.724989 --> -0.824990).  Saving model ...
Epoch: 14 cost time: 0.4766676425933838
Epoch: 14, Steps: 3 | Train Loss: 0.825 Vali Loss: 0.970 Vali Acc: 0.875 Test Loss: 0.970 Test Acc: 0.875
Validation loss decreased (-0.824990 --> -0.874990).  Saving model ...
Epoch: 15 cost time: 0.4359402656555176
Epoch: 15, Steps: 3 | Train Loss: 0.766 Vali Loss: 0.922 Vali Acc: 0.900 Test Loss: 0.922 Test Acc: 0.900
Validation loss decreased (-0.874990 --> -0.899991).  Saving model ...
Epoch: 16 cost time: 0.4955620765686035
Epoch: 16, Steps: 3 | Train Loss: 0.718 Vali Loss: 0.878 Vali Acc: 0.900 Test Loss: 0.878 Test Acc: 0.900
Validation loss decreased (-0.899991 --> -0.899991).  Saving model ...
Epoch: 17 cost time: 0.5659801959991455
Epoch: 17, Steps: 3 | Train Loss: 0.675 Vali Loss: 0.847 Vali Acc: 0.875 Test Loss: 0.847 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.48914289474487305
Epoch: 18, Steps: 3 | Train Loss: 0.615 Vali Loss: 0.813 Vali Acc: 0.900 Test Loss: 0.813 Test Acc: 0.900
Validation loss decreased (-0.899991 --> -0.899992).  Saving model ...
Epoch: 19 cost time: 0.4732990264892578
Epoch: 19, Steps: 3 | Train Loss: 0.581 Vali Loss: 0.776 Vali Acc: 0.925 Test Loss: 0.776 Test Acc: 0.925
Validation loss decreased (-0.899992 --> -0.924992).  Saving model ...
Epoch: 20 cost time: 0.5284743309020996
Epoch: 20, Steps: 3 | Train Loss: 0.559 Vali Loss: 0.739 Vali Acc: 0.925 Test Loss: 0.739 Test Acc: 0.925
Validation loss decreased (-0.924992 --> -0.924993).  Saving model ...
Epoch: 21 cost time: 0.528620719909668
Epoch: 21, Steps: 3 | Train Loss: 0.510 Vali Loss: 0.727 Vali Acc: 0.925 Test Loss: 0.727 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924993).  Saving model ...
Epoch: 22 cost time: 0.5258550643920898
Epoch: 22, Steps: 3 | Train Loss: 0.497 Vali Loss: 0.699 Vali Acc: 0.925 Test Loss: 0.699 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924993).  Saving model ...
Epoch: 23 cost time: 0.45275092124938965
Epoch: 23, Steps: 3 | Train Loss: 0.445 Vali Loss: 0.670 Vali Acc: 0.925 Test Loss: 0.670 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924993).  Saving model ...
Epoch: 24 cost time: 0.5656704902648926
Epoch: 24, Steps: 3 | Train Loss: 0.442 Vali Loss: 0.641 Vali Acc: 0.925 Test Loss: 0.641 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924994).  Saving model ...
Epoch: 25 cost time: 0.48538923263549805
Epoch: 25, Steps: 3 | Train Loss: 0.391 Vali Loss: 0.613 Vali Acc: 0.925 Test Loss: 0.613 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 26 cost time: 0.4370918273925781
Epoch: 26, Steps: 3 | Train Loss: 0.376 Vali Loss: 0.592 Vali Acc: 0.950 Test Loss: 0.592 Test Acc: 0.950
Validation loss decreased (-0.924994 --> -0.949994).  Saving model ...
Epoch: 27 cost time: 0.5645499229431152
Epoch: 27, Steps: 3 | Train Loss: 0.353 Vali Loss: 0.569 Vali Acc: 0.950 Test Loss: 0.569 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949994).  Saving model ...
Epoch: 28 cost time: 0.49109554290771484
Epoch: 28, Steps: 3 | Train Loss: 0.315 Vali Loss: 0.551 Vali Acc: 0.950 Test Loss: 0.551 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949994).  Saving model ...
Epoch: 29 cost time: 0.5253198146820068
Epoch: 29, Steps: 3 | Train Loss: 0.319 Vali Loss: 0.522 Vali Acc: 0.950 Test Loss: 0.522 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 30 cost time: 0.4911625385284424
Epoch: 30, Steps: 3 | Train Loss: 0.311 Vali Loss: 0.507 Vali Acc: 0.950 Test Loss: 0.507 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 31 cost time: 0.5049338340759277
Epoch: 31, Steps: 3 | Train Loss: 0.289 Vali Loss: 0.484 Vali Acc: 0.950 Test Loss: 0.484 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 32 cost time: 0.48046422004699707
Epoch: 32, Steps: 3 | Train Loss: 0.253 Vali Loss: 0.474 Vali Acc: 0.950 Test Loss: 0.474 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 33 cost time: 0.5752205848693848
Epoch: 33, Steps: 3 | Train Loss: 0.243 Vali Loss: 0.454 Vali Acc: 0.950 Test Loss: 0.454 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 34 cost time: 0.4984292984008789
Epoch: 34, Steps: 3 | Train Loss: 0.239 Vali Loss: 0.432 Vali Acc: 0.950 Test Loss: 0.432 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 35 cost time: 0.5139157772064209
Epoch: 35, Steps: 3 | Train Loss: 0.242 Vali Loss: 0.414 Vali Acc: 0.950 Test Loss: 0.414 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 36 cost time: 0.5376167297363281
Epoch: 36, Steps: 3 | Train Loss: 0.231 Vali Loss: 0.393 Vali Acc: 0.950 Test Loss: 0.393 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 37 cost time: 0.5359983444213867
Epoch: 37, Steps: 3 | Train Loss: 0.200 Vali Loss: 0.384 Vali Acc: 0.950 Test Loss: 0.384 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 38 cost time: 0.5353484153747559
Epoch: 38, Steps: 3 | Train Loss: 0.178 Vali Loss: 0.374 Vali Acc: 0.950 Test Loss: 0.374 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 39 cost time: 0.4798095226287842
Epoch: 39, Steps: 3 | Train Loss: 0.164 Vali Loss: 0.359 Vali Acc: 0.950 Test Loss: 0.359 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 40 cost time: 0.4974238872528076
Epoch: 40, Steps: 3 | Train Loss: 0.157 Vali Loss: 0.352 Vali Acc: 0.950 Test Loss: 0.352 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 41 cost time: 0.44861364364624023
Epoch: 41, Steps: 3 | Train Loss: 0.157 Vali Loss: 0.341 Vali Acc: 0.950 Test Loss: 0.341 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 42 cost time: 0.5195956230163574
Epoch: 42, Steps: 3 | Train Loss: 0.131 Vali Loss: 0.327 Vali Acc: 0.950 Test Loss: 0.327 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 43 cost time: 0.49797606468200684
Epoch: 43, Steps: 3 | Train Loss: 0.127 Vali Loss: 0.322 Vali Acc: 0.950 Test Loss: 0.322 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 44 cost time: 0.46724438667297363
Epoch: 44, Steps: 3 | Train Loss: 0.129 Vali Loss: 0.312 Vali Acc: 0.950 Test Loss: 0.312 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 45 cost time: 0.44692349433898926
Epoch: 45, Steps: 3 | Train Loss: 0.105 Vali Loss: 0.300 Vali Acc: 0.950 Test Loss: 0.300 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 46 cost time: 0.4832918643951416
Epoch: 46, Steps: 3 | Train Loss: 0.094 Vali Loss: 0.288 Vali Acc: 0.950 Test Loss: 0.288 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 47 cost time: 0.41786956787109375
Epoch: 47, Steps: 3 | Train Loss: 0.089 Vali Loss: 0.282 Vali Acc: 0.950 Test Loss: 0.282 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 48 cost time: 0.41788291931152344
Epoch: 48, Steps: 3 | Train Loss: 0.087 Vali Loss: 0.279 Vali Acc: 0.950 Test Loss: 0.279 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 49 cost time: 0.4422187805175781
Epoch: 49, Steps: 3 | Train Loss: 0.080 Vali Loss: 0.270 Vali Acc: 0.950 Test Loss: 0.270 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 50 cost time: 0.4281880855560303
Epoch: 50, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.262 Vali Acc: 0.950 Test Loss: 0.262 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 611716
model size : 2.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps20_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.6960086822509766
Epoch: 1, Steps: 3 | Train Loss: 1.420 Vali Loss: 1.387 Vali Acc: 0.125 Test Loss: 1.387 Test Acc: 0.125
Validation loss decreased (inf --> -0.124986).  Saving model ...
Epoch: 2 cost time: 0.43883609771728516
Epoch: 2, Steps: 3 | Train Loss: 1.422 Vali Loss: 1.380 Vali Acc: 0.150 Test Loss: 1.380 Test Acc: 0.150
Validation loss decreased (-0.124986 --> -0.149986).  Saving model ...
Epoch: 3 cost time: 0.4461514949798584
Epoch: 3, Steps: 3 | Train Loss: 1.379 Vali Loss: 1.371 Vali Acc: 0.125 Test Loss: 1.371 Test Acc: 0.125
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.49474596977233887
Epoch: 4, Steps: 3 | Train Loss: 1.345 Vali Loss: 1.356 Vali Acc: 0.200 Test Loss: 1.356 Test Acc: 0.200
Validation loss decreased (-0.149986 --> -0.199986).  Saving model ...
Epoch: 5 cost time: 0.5509419441223145
Epoch: 5, Steps: 3 | Train Loss: 1.286 Vali Loss: 1.335 Vali Acc: 0.250 Test Loss: 1.335 Test Acc: 0.250
Validation loss decreased (-0.199986 --> -0.249987).  Saving model ...
Epoch: 6 cost time: 0.4976685047149658
Epoch: 6, Steps: 3 | Train Loss: 1.263 Vali Loss: 1.308 Vali Acc: 0.300 Test Loss: 1.308 Test Acc: 0.300
Validation loss decreased (-0.249987 --> -0.299987).  Saving model ...
Epoch: 7 cost time: 0.508650541305542
Epoch: 7, Steps: 3 | Train Loss: 1.194 Vali Loss: 1.278 Vali Acc: 0.475 Test Loss: 1.278 Test Acc: 0.475
Validation loss decreased (-0.299987 --> -0.474987).  Saving model ...
Epoch: 8 cost time: 0.49384117126464844
Epoch: 8, Steps: 3 | Train Loss: 1.157 Vali Loss: 1.244 Vali Acc: 0.600 Test Loss: 1.244 Test Acc: 0.600
Validation loss decreased (-0.474987 --> -0.599988).  Saving model ...
Epoch: 9 cost time: 0.52496337890625
Epoch: 9, Steps: 3 | Train Loss: 1.119 Vali Loss: 1.203 Vali Acc: 0.650 Test Loss: 1.203 Test Acc: 0.650
Validation loss decreased (-0.599988 --> -0.649988).  Saving model ...
Epoch: 10 cost time: 0.4873790740966797
Epoch: 10, Steps: 3 | Train Loss: 1.036 Vali Loss: 1.166 Vali Acc: 0.675 Test Loss: 1.166 Test Acc: 0.675
Validation loss decreased (-0.649988 --> -0.674988).  Saving model ...
Epoch: 11 cost time: 0.5013370513916016
Epoch: 11, Steps: 3 | Train Loss: 1.004 Vali Loss: 1.125 Vali Acc: 0.750 Test Loss: 1.125 Test Acc: 0.750
Validation loss decreased (-0.674988 --> -0.749989).  Saving model ...
Epoch: 12 cost time: 0.42287492752075195
Epoch: 12, Steps: 3 | Train Loss: 0.922 Vali Loss: 1.090 Vali Acc: 0.750 Test Loss: 1.090 Test Acc: 0.750
Validation loss decreased (-0.749989 --> -0.749989).  Saving model ...
Epoch: 13 cost time: 0.4220163822174072
Epoch: 13, Steps: 3 | Train Loss: 0.871 Vali Loss: 1.051 Vali Acc: 0.750 Test Loss: 1.051 Test Acc: 0.750
Validation loss decreased (-0.749989 --> -0.749989).  Saving model ...
Epoch: 14 cost time: 0.4417457580566406
Epoch: 14, Steps: 3 | Train Loss: 0.859 Vali Loss: 1.008 Vali Acc: 0.775 Test Loss: 1.008 Test Acc: 0.775
Validation loss decreased (-0.749989 --> -0.774990).  Saving model ...
Epoch: 15 cost time: 0.5247538089752197
Epoch: 15, Steps: 3 | Train Loss: 0.850 Vali Loss: 0.967 Vali Acc: 0.800 Test Loss: 0.967 Test Acc: 0.800
Validation loss decreased (-0.774990 --> -0.799990).  Saving model ...
Epoch: 16 cost time: 0.5092415809631348
Epoch: 16, Steps: 3 | Train Loss: 0.772 Vali Loss: 0.925 Vali Acc: 0.800 Test Loss: 0.925 Test Acc: 0.800
Validation loss decreased (-0.799990 --> -0.799991).  Saving model ...
Epoch: 17 cost time: 0.5066184997558594
Epoch: 17, Steps: 3 | Train Loss: 0.739 Vali Loss: 0.894 Vali Acc: 0.800 Test Loss: 0.894 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799991).  Saving model ...
Epoch: 18 cost time: 0.44374918937683105
Epoch: 18, Steps: 3 | Train Loss: 0.684 Vali Loss: 0.866 Vali Acc: 0.800 Test Loss: 0.866 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799991).  Saving model ...
Epoch: 19 cost time: 0.5022180080413818
Epoch: 19, Steps: 3 | Train Loss: 0.646 Vali Loss: 0.830 Vali Acc: 0.825 Test Loss: 0.830 Test Acc: 0.825
Validation loss decreased (-0.799991 --> -0.824992).  Saving model ...
Epoch: 20 cost time: 0.4625089168548584
Epoch: 20, Steps: 3 | Train Loss: 0.609 Vali Loss: 0.805 Vali Acc: 0.825 Test Loss: 0.805 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 21 cost time: 0.47130489349365234
Epoch: 21, Steps: 3 | Train Loss: 0.587 Vali Loss: 0.774 Vali Acc: 0.825 Test Loss: 0.774 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 22 cost time: 0.4257066249847412
Epoch: 22, Steps: 3 | Train Loss: 0.530 Vali Loss: 0.746 Vali Acc: 0.825 Test Loss: 0.746 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824993).  Saving model ...
Epoch: 23 cost time: 0.38649606704711914
Epoch: 23, Steps: 3 | Train Loss: 0.516 Vali Loss: 0.725 Vali Acc: 0.825 Test Loss: 0.725 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 24 cost time: 0.43148303031921387
Epoch: 24, Steps: 3 | Train Loss: 0.493 Vali Loss: 0.699 Vali Acc: 0.825 Test Loss: 0.699 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 25 cost time: 0.5263924598693848
Epoch: 25, Steps: 3 | Train Loss: 0.456 Vali Loss: 0.673 Vali Acc: 0.850 Test Loss: 0.673 Test Acc: 0.850
Validation loss decreased (-0.824993 --> -0.849993).  Saving model ...
Epoch: 26 cost time: 0.4766573905944824
Epoch: 26, Steps: 3 | Train Loss: 0.439 Vali Loss: 0.644 Vali Acc: 0.850 Test Loss: 0.644 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849994).  Saving model ...
Epoch: 27 cost time: 0.45083045959472656
Epoch: 27, Steps: 3 | Train Loss: 0.408 Vali Loss: 0.625 Vali Acc: 0.875 Test Loss: 0.625 Test Acc: 0.875
Validation loss decreased (-0.849994 --> -0.874994).  Saving model ...
Epoch: 28 cost time: 0.48146867752075195
Epoch: 28, Steps: 3 | Train Loss: 0.398 Vali Loss: 0.605 Vali Acc: 0.900 Test Loss: 0.605 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899994).  Saving model ...
Epoch: 29 cost time: 0.42890167236328125
Epoch: 29, Steps: 3 | Train Loss: 0.373 Vali Loss: 0.581 Vali Acc: 0.900 Test Loss: 0.581 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 30 cost time: 0.46403980255126953
Epoch: 30, Steps: 3 | Train Loss: 0.353 Vali Loss: 0.561 Vali Acc: 0.900 Test Loss: 0.561 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 31 cost time: 0.46244096755981445
Epoch: 31, Steps: 3 | Train Loss: 0.332 Vali Loss: 0.551 Vali Acc: 0.900 Test Loss: 0.551 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 32 cost time: 0.5112106800079346
Epoch: 32, Steps: 3 | Train Loss: 0.336 Vali Loss: 0.536 Vali Acc: 0.875 Test Loss: 0.536 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.5015196800231934
Epoch: 33, Steps: 3 | Train Loss: 0.322 Vali Loss: 0.509 Vali Acc: 0.875 Test Loss: 0.509 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.5473864078521729
Epoch: 34, Steps: 3 | Train Loss: 0.315 Vali Loss: 0.509 Vali Acc: 0.900 Test Loss: 0.509 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 35 cost time: 0.5175561904907227
Epoch: 35, Steps: 3 | Train Loss: 0.298 Vali Loss: 0.482 Vali Acc: 0.925 Test Loss: 0.482 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924995).  Saving model ...
Epoch: 36 cost time: 0.49894070625305176
Epoch: 36, Steps: 3 | Train Loss: 0.284 Vali Loss: 0.458 Vali Acc: 0.925 Test Loss: 0.458 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 37 cost time: 0.5471305847167969
Epoch: 37, Steps: 3 | Train Loss: 0.282 Vali Loss: 0.442 Vali Acc: 0.925 Test Loss: 0.442 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 38 cost time: 0.447206974029541
Epoch: 38, Steps: 3 | Train Loss: 0.267 Vali Loss: 0.420 Vali Acc: 0.925 Test Loss: 0.420 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 39 cost time: 0.5054275989532471
Epoch: 39, Steps: 3 | Train Loss: 0.250 Vali Loss: 0.409 Vali Acc: 0.925 Test Loss: 0.409 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 40 cost time: 0.43983960151672363
Epoch: 40, Steps: 3 | Train Loss: 0.229 Vali Loss: 0.396 Vali Acc: 0.925 Test Loss: 0.396 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 41 cost time: 0.5540921688079834
Epoch: 41, Steps: 3 | Train Loss: 0.229 Vali Loss: 0.387 Vali Acc: 0.925 Test Loss: 0.387 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 42 cost time: 0.5196866989135742
Epoch: 42, Steps: 3 | Train Loss: 0.202 Vali Loss: 0.375 Vali Acc: 0.925 Test Loss: 0.375 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 43 cost time: 0.5178658962249756
Epoch: 43, Steps: 3 | Train Loss: 0.204 Vali Loss: 0.374 Vali Acc: 0.925 Test Loss: 0.374 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 44 cost time: 0.5692999362945557
Epoch: 44, Steps: 3 | Train Loss: 0.182 Vali Loss: 0.365 Vali Acc: 0.925 Test Loss: 0.365 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 45 cost time: 0.5059547424316406
Epoch: 45, Steps: 3 | Train Loss: 0.188 Vali Loss: 0.351 Vali Acc: 0.900 Test Loss: 0.351 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.5045797824859619
Epoch: 46, Steps: 3 | Train Loss: 0.189 Vali Loss: 0.339 Vali Acc: 0.900 Test Loss: 0.339 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.5044314861297607
Epoch: 47, Steps: 3 | Train Loss: 0.195 Vali Loss: 0.328 Vali Acc: 0.900 Test Loss: 0.328 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.5329535007476807
Epoch: 48, Steps: 3 | Train Loss: 0.147 Vali Loss: 0.320 Vali Acc: 0.900 Test Loss: 0.320 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.4613065719604492
Epoch: 49, Steps: 3 | Train Loss: 0.167 Vali Loss: 0.314 Vali Acc: 0.925 Test Loss: 0.314 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924997).  Saving model ...
Epoch: 50 cost time: 0.5181167125701904
Epoch: 50, Steps: 3 | Train Loss: 0.126 Vali Loss: 0.309 Vali Acc: 0.925 Test Loss: 0.309 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps20_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 611876
model size : 2.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps25_str13_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.7430167198181152
Epoch: 1, Steps: 3 | Train Loss: 1.445 Vali Loss: 1.362 Vali Acc: 0.300 Test Loss: 1.362 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 0.583052396774292
Epoch: 2, Steps: 3 | Train Loss: 1.423 Vali Loss: 1.356 Vali Acc: 0.275 Test Loss: 1.356 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.43045592308044434
Epoch: 3, Steps: 3 | Train Loss: 1.439 Vali Loss: 1.346 Vali Acc: 0.275 Test Loss: 1.346 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5203087329864502
Epoch: 4, Steps: 3 | Train Loss: 1.384 Vali Loss: 1.333 Vali Acc: 0.325 Test Loss: 1.333 Test Acc: 0.325
Validation loss decreased (-0.299986 --> -0.324987).  Saving model ...
Epoch: 5 cost time: 0.5268309116363525
Epoch: 5, Steps: 3 | Train Loss: 1.348 Vali Loss: 1.315 Vali Acc: 0.350 Test Loss: 1.315 Test Acc: 0.350
Validation loss decreased (-0.324987 --> -0.349987).  Saving model ...
Epoch: 6 cost time: 0.4402737617492676
Epoch: 6, Steps: 3 | Train Loss: 1.319 Vali Loss: 1.294 Vali Acc: 0.450 Test Loss: 1.294 Test Acc: 0.450
Validation loss decreased (-0.349987 --> -0.449987).  Saving model ...
Epoch: 7 cost time: 0.3924252986907959
Epoch: 7, Steps: 3 | Train Loss: 1.265 Vali Loss: 1.269 Vali Acc: 0.500 Test Loss: 1.269 Test Acc: 0.500
Validation loss decreased (-0.449987 --> -0.499987).  Saving model ...
Epoch: 8 cost time: 0.5517306327819824
Epoch: 8, Steps: 3 | Train Loss: 1.234 Vali Loss: 1.239 Vali Acc: 0.550 Test Loss: 1.239 Test Acc: 0.550
Validation loss decreased (-0.499987 --> -0.549988).  Saving model ...
Epoch: 9 cost time: 0.459003210067749
Epoch: 9, Steps: 3 | Train Loss: 1.203 Vali Loss: 1.207 Vali Acc: 0.575 Test Loss: 1.207 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574988).  Saving model ...
Epoch: 10 cost time: 0.45922064781188965
Epoch: 10, Steps: 3 | Train Loss: 1.160 Vali Loss: 1.174 Vali Acc: 0.625 Test Loss: 1.174 Test Acc: 0.625
Validation loss decreased (-0.574988 --> -0.624988).  Saving model ...
Epoch: 11 cost time: 0.44599270820617676
Epoch: 11, Steps: 3 | Train Loss: 1.103 Vali Loss: 1.138 Vali Acc: 0.700 Test Loss: 1.138 Test Acc: 0.700
Validation loss decreased (-0.624988 --> -0.699989).  Saving model ...
Epoch: 12 cost time: 0.5116128921508789
Epoch: 12, Steps: 3 | Train Loss: 1.053 Vali Loss: 1.099 Vali Acc: 0.750 Test Loss: 1.099 Test Acc: 0.750
Validation loss decreased (-0.699989 --> -0.749989).  Saving model ...
Epoch: 13 cost time: 0.45451974868774414
Epoch: 13, Steps: 3 | Train Loss: 0.992 Vali Loss: 1.062 Vali Acc: 0.800 Test Loss: 1.062 Test Acc: 0.800
Validation loss decreased (-0.749989 --> -0.799989).  Saving model ...
Epoch: 14 cost time: 0.474834680557251
Epoch: 14, Steps: 3 | Train Loss: 0.951 Vali Loss: 1.022 Vali Acc: 0.850 Test Loss: 1.022 Test Acc: 0.850
Validation loss decreased (-0.799989 --> -0.849990).  Saving model ...
Epoch: 15 cost time: 0.46460485458374023
Epoch: 15, Steps: 3 | Train Loss: 0.924 Vali Loss: 0.987 Vali Acc: 0.875 Test Loss: 0.987 Test Acc: 0.875
Validation loss decreased (-0.849990 --> -0.874990).  Saving model ...
Epoch: 16 cost time: 0.4489469528198242
Epoch: 16, Steps: 3 | Train Loss: 0.864 Vali Loss: 0.951 Vali Acc: 0.925 Test Loss: 0.951 Test Acc: 0.925
Validation loss decreased (-0.874990 --> -0.924990).  Saving model ...
Epoch: 17 cost time: 0.4789001941680908
Epoch: 17, Steps: 3 | Train Loss: 0.824 Vali Loss: 0.926 Vali Acc: 0.925 Test Loss: 0.926 Test Acc: 0.925
Validation loss decreased (-0.924990 --> -0.924991).  Saving model ...
Epoch: 18 cost time: 0.49895787239074707
Epoch: 18, Steps: 3 | Train Loss: 0.769 Vali Loss: 0.894 Vali Acc: 0.900 Test Loss: 0.894 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5800786018371582
Epoch: 19, Steps: 3 | Train Loss: 0.746 Vali Loss: 0.857 Vali Acc: 0.900 Test Loss: 0.857 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.5090374946594238
Epoch: 20, Steps: 3 | Train Loss: 0.716 Vali Loss: 0.828 Vali Acc: 0.900 Test Loss: 0.828 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.5244669914245605
Epoch: 21, Steps: 3 | Train Loss: 0.669 Vali Loss: 0.798 Vali Acc: 0.900 Test Loss: 0.798 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.4887125492095947
Epoch: 22, Steps: 3 | Train Loss: 0.623 Vali Loss: 0.763 Vali Acc: 0.900 Test Loss: 0.763 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.459151029586792
Epoch: 23, Steps: 3 | Train Loss: 0.619 Vali Loss: 0.729 Vali Acc: 0.900 Test Loss: 0.729 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.4761073589324951
Epoch: 24, Steps: 3 | Train Loss: 0.567 Vali Loss: 0.695 Vali Acc: 0.900 Test Loss: 0.695 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.4337637424468994
Epoch: 25, Steps: 3 | Train Loss: 0.545 Vali Loss: 0.671 Vali Acc: 0.900 Test Loss: 0.671 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.5273606777191162
Epoch: 26, Steps: 3 | Train Loss: 0.513 Vali Loss: 0.650 Vali Acc: 0.900 Test Loss: 0.650 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.4151899814605713
Epoch: 27, Steps: 3 | Train Loss: 0.501 Vali Loss: 0.618 Vali Acc: 0.900 Test Loss: 0.618 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps25_str13_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 608964
model size : 2.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.6740837097167969
Epoch: 1, Steps: 3 | Train Loss: 1.416 Vali Loss: 1.346 Vali Acc: 0.275 Test Loss: 1.346 Test Acc: 0.275
Validation loss decreased (inf --> -0.274987).  Saving model ...
Epoch: 2 cost time: 0.586686372756958
Epoch: 2, Steps: 3 | Train Loss: 1.278 Vali Loss: 1.285 Vali Acc: 0.325 Test Loss: 1.285 Test Acc: 0.325
Validation loss decreased (-0.274987 --> -0.324987).  Saving model ...
Epoch: 3 cost time: 0.5349922180175781
Epoch: 3, Steps: 3 | Train Loss: 1.119 Vali Loss: 1.159 Vali Acc: 0.500 Test Loss: 1.159 Test Acc: 0.500
Validation loss decreased (-0.324987 --> -0.499988).  Saving model ...
Epoch: 4 cost time: 0.5357849597930908
Epoch: 4, Steps: 3 | Train Loss: 0.887 Vali Loss: 1.009 Vali Acc: 0.700 Test Loss: 1.009 Test Acc: 0.700
Validation loss decreased (-0.499988 --> -0.699990).  Saving model ...
Epoch: 5 cost time: 0.5640456676483154
Epoch: 5, Steps: 3 | Train Loss: 0.730 Vali Loss: 0.833 Vali Acc: 0.700 Test Loss: 0.833 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699992).  Saving model ...
Epoch: 6 cost time: 0.5559766292572021
Epoch: 6, Steps: 3 | Train Loss: 0.558 Vali Loss: 0.669 Vali Acc: 0.925 Test Loss: 0.669 Test Acc: 0.925
Validation loss decreased (-0.699992 --> -0.924993).  Saving model ...
Epoch: 7 cost time: 0.5745160579681396
Epoch: 7, Steps: 3 | Train Loss: 0.381 Vali Loss: 0.552 Vali Acc: 0.950 Test Loss: 0.552 Test Acc: 0.950
Validation loss decreased (-0.924993 --> -0.949994).  Saving model ...
Epoch: 8 cost time: 0.6171731948852539
Epoch: 8, Steps: 3 | Train Loss: 0.277 Vali Loss: 0.466 Vali Acc: 0.925 Test Loss: 0.466 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5430662631988525
Epoch: 9, Steps: 3 | Train Loss: 0.228 Vali Loss: 0.398 Vali Acc: 0.925 Test Loss: 0.398 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.6037125587463379
Epoch: 10, Steps: 3 | Train Loss: 0.182 Vali Loss: 0.330 Vali Acc: 0.950 Test Loss: 0.330 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949997).  Saving model ...
Epoch: 11 cost time: 0.5719010829925537
Epoch: 11, Steps: 3 | Train Loss: 0.136 Vali Loss: 0.286 Vali Acc: 0.950 Test Loss: 0.286 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 12 cost time: 0.5735840797424316
Epoch: 12, Steps: 3 | Train Loss: 0.115 Vali Loss: 0.257 Vali Acc: 0.950 Test Loss: 0.257 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 13 cost time: 0.5081644058227539
Epoch: 13, Steps: 3 | Train Loss: 0.071 Vali Loss: 0.241 Vali Acc: 0.950 Test Loss: 0.241 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 14 cost time: 0.5240249633789062
Epoch: 14, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.226 Vali Acc: 0.950 Test Loss: 0.226 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 15 cost time: 0.5803048610687256
Epoch: 15, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.234 Vali Acc: 0.950 Test Loss: 0.234 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.564638614654541
Epoch: 16, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.231 Vali Acc: 0.950 Test Loss: 0.231 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.5220239162445068
Epoch: 17, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.232 Vali Acc: 0.950 Test Loss: 0.232 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.5116746425628662
Epoch: 18, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.250 Vali Acc: 0.950 Test Loss: 0.250 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.6158044338226318
Epoch: 19, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.251 Vali Acc: 0.950 Test Loss: 0.251 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.5456650257110596
Epoch: 20, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.256 Vali Acc: 0.950 Test Loss: 0.256 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.4536118507385254
Epoch: 21, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.253 Vali Acc: 0.950 Test Loss: 0.253 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.6936461925506592
Epoch: 22, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.260 Vali Acc: 0.950 Test Loss: 0.260 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.576561450958252
Epoch: 23, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.268 Vali Acc: 0.950 Test Loss: 0.268 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.491225004196167
Epoch: 24, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.274 Vali Acc: 0.950 Test Loss: 0.274 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 2307076
model size : 8.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.9429597854614258
Epoch: 1, Steps: 3 | Train Loss: 1.391 Vali Loss: 1.312 Vali Acc: 0.425 Test Loss: 1.312 Test Acc: 0.425
Validation loss decreased (inf --> -0.424987).  Saving model ...
Epoch: 2 cost time: 0.5006239414215088
Epoch: 2, Steps: 3 | Train Loss: 1.293 Vali Loss: 1.265 Vali Acc: 0.500 Test Loss: 1.265 Test Acc: 0.500
Validation loss decreased (-0.424987 --> -0.499987).  Saving model ...
Epoch: 3 cost time: 0.45818114280700684
Epoch: 3, Steps: 3 | Train Loss: 1.215 Vali Loss: 1.160 Vali Acc: 0.600 Test Loss: 1.160 Test Acc: 0.600
Validation loss decreased (-0.499987 --> -0.599988).  Saving model ...
Epoch: 4 cost time: 0.5003089904785156
Epoch: 4, Steps: 3 | Train Loss: 0.991 Vali Loss: 1.031 Vali Acc: 0.825 Test Loss: 1.031 Test Acc: 0.825
Validation loss decreased (-0.599988 --> -0.824990).  Saving model ...
Epoch: 5 cost time: 0.4978451728820801
Epoch: 5, Steps: 3 | Train Loss: 0.816 Vali Loss: 0.879 Vali Acc: 0.875 Test Loss: 0.879 Test Acc: 0.875
Validation loss decreased (-0.824990 --> -0.874991).  Saving model ...
Epoch: 6 cost time: 0.44858217239379883
Epoch: 6, Steps: 3 | Train Loss: 0.642 Vali Loss: 0.731 Vali Acc: 0.900 Test Loss: 0.731 Test Acc: 0.900
Validation loss decreased (-0.874991 --> -0.899993).  Saving model ...
Epoch: 7 cost time: 0.4845256805419922
Epoch: 7, Steps: 3 | Train Loss: 0.509 Vali Loss: 0.598 Vali Acc: 0.925 Test Loss: 0.598 Test Acc: 0.925
Validation loss decreased (-0.899993 --> -0.924994).  Saving model ...
Epoch: 8 cost time: 0.5164804458618164
Epoch: 8, Steps: 3 | Train Loss: 0.393 Vali Loss: 0.491 Vali Acc: 0.925 Test Loss: 0.491 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 9 cost time: 0.5892715454101562
Epoch: 9, Steps: 3 | Train Loss: 0.315 Vali Loss: 0.416 Vali Acc: 0.925 Test Loss: 0.416 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 10 cost time: 0.48496341705322266
Epoch: 10, Steps: 3 | Train Loss: 0.244 Vali Loss: 0.350 Vali Acc: 0.950 Test Loss: 0.350 Test Acc: 0.950
Validation loss decreased (-0.924996 --> -0.949997).  Saving model ...
Epoch: 11 cost time: 0.4639136791229248
Epoch: 11, Steps: 3 | Train Loss: 0.202 Vali Loss: 0.291 Vali Acc: 0.950 Test Loss: 0.291 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 12 cost time: 0.4502713680267334
Epoch: 12, Steps: 3 | Train Loss: 0.171 Vali Loss: 0.243 Vali Acc: 0.975 Test Loss: 0.243 Test Acc: 0.975
Validation loss decreased (-0.949997 --> -0.974998).  Saving model ...
Epoch: 13 cost time: 0.5388693809509277
Epoch: 13, Steps: 3 | Train Loss: 0.143 Vali Loss: 0.211 Vali Acc: 0.975 Test Loss: 0.211 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 14 cost time: 0.43558311462402344
Epoch: 14, Steps: 3 | Train Loss: 0.127 Vali Loss: 0.187 Vali Acc: 0.975 Test Loss: 0.187 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 15 cost time: 0.4563333988189697
Epoch: 15, Steps: 3 | Train Loss: 0.091 Vali Loss: 0.171 Vali Acc: 0.975 Test Loss: 0.171 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 16 cost time: 0.5220375061035156
Epoch: 16, Steps: 3 | Train Loss: 0.073 Vali Loss: 0.160 Vali Acc: 0.975 Test Loss: 0.160 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 17 cost time: 0.4289991855621338
Epoch: 17, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.147 Vali Acc: 0.950 Test Loss: 0.147 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.4766097068786621
Epoch: 18, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.138 Vali Acc: 0.950 Test Loss: 0.138 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.4484524726867676
Epoch: 19, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.137 Vali Acc: 0.950 Test Loss: 0.137 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.47309422492980957
Epoch: 20, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.135 Vali Acc: 0.950 Test Loss: 0.135 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.5170667171478271
Epoch: 21, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.141 Vali Acc: 0.950 Test Loss: 0.141 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.4649069309234619
Epoch: 22, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.143 Vali Acc: 0.950 Test Loss: 0.143 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.4825122356414795
Epoch: 23, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.145 Vali Acc: 0.950 Test Loss: 0.145 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.48917460441589355
Epoch: 24, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.148 Vali Acc: 0.950 Test Loss: 0.148 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.47395753860473633
Epoch: 25, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.150 Vali Acc: 0.950 Test Loss: 0.150 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.4777071475982666
Epoch: 26, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.155 Vali Acc: 0.950 Test Loss: 0.155 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 2258180
model size : 8.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.7964766025543213
Epoch: 1, Steps: 3 | Train Loss: 1.363 Vali Loss: 1.299 Vali Acc: 0.300 Test Loss: 1.299 Test Acc: 0.300
Validation loss decreased (inf --> -0.299987).  Saving model ...
Epoch: 2 cost time: 0.4990522861480713
Epoch: 2, Steps: 3 | Train Loss: 1.263 Vali Loss: 1.255 Vali Acc: 0.350 Test Loss: 1.255 Test Acc: 0.350
Validation loss decreased (-0.299987 --> -0.349987).  Saving model ...
Epoch: 3 cost time: 0.49172520637512207
Epoch: 3, Steps: 3 | Train Loss: 1.173 Vali Loss: 1.172 Vali Acc: 0.475 Test Loss: 1.172 Test Acc: 0.475
Validation loss decreased (-0.349987 --> -0.474988).  Saving model ...
Epoch: 4 cost time: 0.5485095977783203
Epoch: 4, Steps: 3 | Train Loss: 1.045 Vali Loss: 1.055 Vali Acc: 0.725 Test Loss: 1.055 Test Acc: 0.725
Validation loss decreased (-0.474988 --> -0.724989).  Saving model ...
Epoch: 5 cost time: 0.49439525604248047
Epoch: 5, Steps: 3 | Train Loss: 0.866 Vali Loss: 0.933 Vali Acc: 0.925 Test Loss: 0.933 Test Acc: 0.925
Validation loss decreased (-0.724989 --> -0.924991).  Saving model ...
Epoch: 6 cost time: 0.4897739887237549
Epoch: 6, Steps: 3 | Train Loss: 0.740 Vali Loss: 0.799 Vali Acc: 0.900 Test Loss: 0.799 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.45757317543029785
Epoch: 7, Steps: 3 | Train Loss: 0.594 Vali Loss: 0.683 Vali Acc: 0.925 Test Loss: 0.683 Test Acc: 0.925
Validation loss decreased (-0.924991 --> -0.924993).  Saving model ...
Epoch: 8 cost time: 0.48810768127441406
Epoch: 8, Steps: 3 | Train Loss: 0.498 Vali Loss: 0.571 Vali Acc: 0.900 Test Loss: 0.571 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.47670674324035645
Epoch: 9, Steps: 3 | Train Loss: 0.398 Vali Loss: 0.479 Vali Acc: 0.950 Test Loss: 0.479 Test Acc: 0.950
Validation loss decreased (-0.924993 --> -0.949995).  Saving model ...
Epoch: 10 cost time: 0.4627535343170166
Epoch: 10, Steps: 3 | Train Loss: 0.332 Vali Loss: 0.409 Vali Acc: 0.950 Test Loss: 0.409 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 11 cost time: 0.506537675857544
Epoch: 11, Steps: 3 | Train Loss: 0.276 Vali Loss: 0.349 Vali Acc: 0.950 Test Loss: 0.349 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 12 cost time: 0.5103306770324707
Epoch: 12, Steps: 3 | Train Loss: 0.209 Vali Loss: 0.310 Vali Acc: 0.975 Test Loss: 0.310 Test Acc: 0.975
Validation loss decreased (-0.949997 --> -0.974997).  Saving model ...
Epoch: 13 cost time: 0.49820733070373535
Epoch: 13, Steps: 3 | Train Loss: 0.195 Vali Loss: 0.274 Vali Acc: 0.975 Test Loss: 0.274 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 14 cost time: 0.4547452926635742
Epoch: 14, Steps: 3 | Train Loss: 0.164 Vali Loss: 0.245 Vali Acc: 0.975 Test Loss: 0.245 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 15 cost time: 0.5178179740905762
Epoch: 15, Steps: 3 | Train Loss: 0.155 Vali Loss: 0.223 Vali Acc: 0.975 Test Loss: 0.223 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 16 cost time: 0.5098636150360107
Epoch: 16, Steps: 3 | Train Loss: 0.124 Vali Loss: 0.201 Vali Acc: 0.975 Test Loss: 0.201 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 17 cost time: 0.4510765075683594
Epoch: 17, Steps: 3 | Train Loss: 0.107 Vali Loss: 0.188 Vali Acc: 0.975 Test Loss: 0.188 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 18 cost time: 0.46155810356140137
Epoch: 18, Steps: 3 | Train Loss: 0.102 Vali Loss: 0.176 Vali Acc: 0.975 Test Loss: 0.176 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 19 cost time: 0.43572139739990234
Epoch: 19, Steps: 3 | Train Loss: 0.072 Vali Loss: 0.155 Vali Acc: 0.975 Test Loss: 0.155 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 20 cost time: 0.4663679599761963
Epoch: 20, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.150 Vali Acc: 0.975 Test Loss: 0.150 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 21 cost time: 0.4720602035522461
Epoch: 21, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.143 Vali Acc: 0.975 Test Loss: 0.143 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974999).  Saving model ...
Epoch: 22 cost time: 0.493851900100708
Epoch: 22, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.135 Vali Acc: 0.975 Test Loss: 0.135 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 23 cost time: 0.5749611854553223
Epoch: 23, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.124 Vali Acc: 0.975 Test Loss: 0.124 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 24 cost time: 0.4883918762207031
Epoch: 24, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.119 Vali Acc: 0.975 Test Loss: 0.119 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 25 cost time: 0.45395612716674805
Epoch: 25, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.115 Vali Acc: 0.975 Test Loss: 0.115 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 26 cost time: 0.4561309814453125
Epoch: 26, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.118 Vali Acc: 0.975 Test Loss: 0.118 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.443709135055542
Epoch: 27, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.117 Vali Acc: 0.975 Test Loss: 0.117 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.45922064781188965
Epoch: 28, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.113 Vali Acc: 0.975 Test Loss: 0.113 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 29 cost time: 0.4569871425628662
Epoch: 29, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.118 Vali Acc: 0.975 Test Loss: 0.118 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.48032522201538086
Epoch: 30, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.123 Vali Acc: 0.975 Test Loss: 0.123 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.43715763092041016
Epoch: 31, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.120 Vali Acc: 0.975 Test Loss: 0.120 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.46064066886901855
Epoch: 32, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.124 Vali Acc: 0.975 Test Loss: 0.124 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.472104549407959
Epoch: 33, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.125 Vali Acc: 0.975 Test Loss: 0.125 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.48622918128967285
Epoch: 34, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.128 Vali Acc: 0.950 Test Loss: 0.128 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.5120353698730469
Epoch: 35, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.133 Vali Acc: 0.950 Test Loss: 0.133 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.5016393661499023
Epoch: 36, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.138 Vali Acc: 0.950 Test Loss: 0.138 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.4475829601287842
Epoch: 37, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.139 Vali Acc: 0.950 Test Loss: 0.139 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.4648444652557373
Epoch: 38, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.137 Vali Acc: 0.950 Test Loss: 0.137 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 2233988
model size : 8.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.6051340103149414
Epoch: 1, Steps: 3 | Train Loss: 1.335 Vali Loss: 1.380 Vali Acc: 0.400 Test Loss: 1.380 Test Acc: 0.400
Validation loss decreased (inf --> -0.399986).  Saving model ...
Epoch: 2 cost time: 0.5446231365203857
Epoch: 2, Steps: 3 | Train Loss: 1.264 Vali Loss: 1.346 Vali Acc: 0.475 Test Loss: 1.346 Test Acc: 0.475
Validation loss decreased (-0.399986 --> -0.474987).  Saving model ...
Epoch: 3 cost time: 0.5083916187286377
Epoch: 3, Steps: 3 | Train Loss: 1.180 Vali Loss: 1.280 Vali Acc: 0.475 Test Loss: 1.280 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474987).  Saving model ...
Epoch: 4 cost time: 0.4503359794616699
Epoch: 4, Steps: 3 | Train Loss: 1.051 Vali Loss: 1.185 Vali Acc: 0.600 Test Loss: 1.185 Test Acc: 0.600
Validation loss decreased (-0.474987 --> -0.599988).  Saving model ...
Epoch: 5 cost time: 0.5552937984466553
Epoch: 5, Steps: 3 | Train Loss: 0.945 Vali Loss: 1.072 Vali Acc: 0.675 Test Loss: 1.072 Test Acc: 0.675
Validation loss decreased (-0.599988 --> -0.674989).  Saving model ...
Epoch: 6 cost time: 0.5299184322357178
Epoch: 6, Steps: 3 | Train Loss: 0.799 Vali Loss: 0.949 Vali Acc: 0.800 Test Loss: 0.949 Test Acc: 0.800
Validation loss decreased (-0.674989 --> -0.799991).  Saving model ...
Epoch: 7 cost time: 0.4765787124633789
Epoch: 7, Steps: 3 | Train Loss: 0.658 Vali Loss: 0.840 Vali Acc: 0.825 Test Loss: 0.840 Test Acc: 0.825
Validation loss decreased (-0.799991 --> -0.824992).  Saving model ...
Epoch: 8 cost time: 0.46160030364990234
Epoch: 8, Steps: 3 | Train Loss: 0.562 Vali Loss: 0.731 Vali Acc: 0.825 Test Loss: 0.731 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824993).  Saving model ...
Epoch: 9 cost time: 0.5351073741912842
Epoch: 9, Steps: 3 | Train Loss: 0.476 Vali Loss: 0.625 Vali Acc: 0.850 Test Loss: 0.625 Test Acc: 0.850
Validation loss decreased (-0.824993 --> -0.849994).  Saving model ...
Epoch: 10 cost time: 0.48982834815979004
Epoch: 10, Steps: 3 | Train Loss: 0.390 Vali Loss: 0.545 Vali Acc: 0.875 Test Loss: 0.545 Test Acc: 0.875
Validation loss decreased (-0.849994 --> -0.874995).  Saving model ...
Epoch: 11 cost time: 0.5091872215270996
Epoch: 11, Steps: 3 | Train Loss: 0.352 Vali Loss: 0.474 Vali Acc: 0.900 Test Loss: 0.474 Test Acc: 0.900
Validation loss decreased (-0.874995 --> -0.899995).  Saving model ...
Epoch: 12 cost time: 0.5692229270935059
Epoch: 12, Steps: 3 | Train Loss: 0.295 Vali Loss: 0.432 Vali Acc: 0.900 Test Loss: 0.432 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 13 cost time: 0.4260725975036621
Epoch: 13, Steps: 3 | Train Loss: 0.257 Vali Loss: 0.385 Vali Acc: 0.900 Test Loss: 0.385 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 14 cost time: 0.5500953197479248
Epoch: 14, Steps: 3 | Train Loss: 0.232 Vali Loss: 0.350 Vali Acc: 0.925 Test Loss: 0.350 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924996).  Saving model ...
Epoch: 15 cost time: 0.4824340343475342
Epoch: 15, Steps: 3 | Train Loss: 0.205 Vali Loss: 0.326 Vali Acc: 0.925 Test Loss: 0.326 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924997).  Saving model ...
Epoch: 16 cost time: 0.40746140480041504
Epoch: 16, Steps: 3 | Train Loss: 0.168 Vali Loss: 0.303 Vali Acc: 0.925 Test Loss: 0.303 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 17 cost time: 0.4457242488861084
Epoch: 17, Steps: 3 | Train Loss: 0.149 Vali Loss: 0.290 Vali Acc: 0.950 Test Loss: 0.290 Test Acc: 0.950
Validation loss decreased (-0.924997 --> -0.949997).  Saving model ...
Epoch: 18 cost time: 0.46197056770324707
Epoch: 18, Steps: 3 | Train Loss: 0.129 Vali Loss: 0.284 Vali Acc: 0.950 Test Loss: 0.284 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 19 cost time: 0.52018141746521
Epoch: 19, Steps: 3 | Train Loss: 0.120 Vali Loss: 0.269 Vali Acc: 0.950 Test Loss: 0.269 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 20 cost time: 0.47292351722717285
Epoch: 20, Steps: 3 | Train Loss: 0.086 Vali Loss: 0.260 Vali Acc: 0.925 Test Loss: 0.260 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.43471527099609375
Epoch: 21, Steps: 3 | Train Loss: 0.081 Vali Loss: 0.251 Vali Acc: 0.925 Test Loss: 0.251 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.5754194259643555
Epoch: 22, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.248 Vali Acc: 0.900 Test Loss: 0.248 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.616624116897583
Epoch: 23, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.238 Vali Acc: 0.900 Test Loss: 0.238 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.5374701023101807
Epoch: 24, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.235 Vali Acc: 0.900 Test Loss: 0.235 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.5386652946472168
Epoch: 25, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.227 Vali Acc: 0.900 Test Loss: 0.227 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.5982077121734619
Epoch: 26, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.225 Vali Acc: 0.900 Test Loss: 0.225 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.5302953720092773
Epoch: 27, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.218 Vali Acc: 0.900 Test Loss: 0.218 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.6782288551330566
Epoch: 28, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.215 Vali Acc: 0.900 Test Loss: 0.215 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.603813886642456
Epoch: 29, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.217 Vali Acc: 0.900 Test Loss: 0.217 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 2215812
model size : 8.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.7624166011810303
Epoch: 1, Steps: 3 | Train Loss: 1.456 Vali Loss: 1.383 Vali Acc: 0.275 Test Loss: 1.383 Test Acc: 0.275
Validation loss decreased (inf --> -0.274986).  Saving model ...
Epoch: 2 cost time: 0.5275599956512451
Epoch: 2, Steps: 3 | Train Loss: 1.426 Vali Loss: 1.355 Vali Acc: 0.325 Test Loss: 1.355 Test Acc: 0.325
Validation loss decreased (-0.274986 --> -0.324986).  Saving model ...
Epoch: 3 cost time: 0.5288655757904053
Epoch: 3, Steps: 3 | Train Loss: 1.315 Vali Loss: 1.311 Vali Acc: 0.475 Test Loss: 1.311 Test Acc: 0.475
Validation loss decreased (-0.324986 --> -0.474987).  Saving model ...
Epoch: 4 cost time: 0.4374856948852539
Epoch: 4, Steps: 3 | Train Loss: 1.216 Vali Loss: 1.242 Vali Acc: 0.525 Test Loss: 1.242 Test Acc: 0.525
Validation loss decreased (-0.474987 --> -0.524988).  Saving model ...
Epoch: 5 cost time: 0.45375990867614746
Epoch: 5, Steps: 3 | Train Loss: 1.110 Vali Loss: 1.159 Vali Acc: 0.625 Test Loss: 1.159 Test Acc: 0.625
Validation loss decreased (-0.524988 --> -0.624988).  Saving model ...
Epoch: 6 cost time: 0.4916572570800781
Epoch: 6, Steps: 3 | Train Loss: 0.984 Vali Loss: 1.068 Vali Acc: 0.675 Test Loss: 1.068 Test Acc: 0.675
Validation loss decreased (-0.624988 --> -0.674989).  Saving model ...
Epoch: 7 cost time: 0.45308756828308105
Epoch: 7, Steps: 3 | Train Loss: 0.879 Vali Loss: 0.971 Vali Acc: 0.750 Test Loss: 0.971 Test Acc: 0.750
Validation loss decreased (-0.674989 --> -0.749990).  Saving model ...
Epoch: 8 cost time: 0.4590590000152588
Epoch: 8, Steps: 3 | Train Loss: 0.819 Vali Loss: 0.876 Vali Acc: 0.775 Test Loss: 0.876 Test Acc: 0.775
Validation loss decreased (-0.749990 --> -0.774991).  Saving model ...
Epoch: 9 cost time: 0.5510413646697998
Epoch: 9, Steps: 3 | Train Loss: 0.710 Vali Loss: 0.786 Vali Acc: 0.825 Test Loss: 0.786 Test Acc: 0.825
Validation loss decreased (-0.774991 --> -0.824992).  Saving model ...
Epoch: 10 cost time: 0.42450714111328125
Epoch: 10, Steps: 3 | Train Loss: 0.604 Vali Loss: 0.706 Vali Acc: 0.825 Test Loss: 0.706 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824993).  Saving model ...
Epoch: 11 cost time: 0.4474906921386719
Epoch: 11, Steps: 3 | Train Loss: 0.511 Vali Loss: 0.643 Vali Acc: 0.900 Test Loss: 0.643 Test Acc: 0.900
Validation loss decreased (-0.824993 --> -0.899994).  Saving model ...
Epoch: 12 cost time: 0.5296220779418945
Epoch: 12, Steps: 3 | Train Loss: 0.444 Vali Loss: 0.575 Vali Acc: 0.900 Test Loss: 0.575 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 13 cost time: 0.4325532913208008
Epoch: 13, Steps: 3 | Train Loss: 0.394 Vali Loss: 0.538 Vali Acc: 0.925 Test Loss: 0.538 Test Acc: 0.925
Validation loss decreased (-0.899994 --> -0.924995).  Saving model ...
Epoch: 14 cost time: 0.47091054916381836
Epoch: 14, Steps: 3 | Train Loss: 0.340 Vali Loss: 0.494 Vali Acc: 0.950 Test Loss: 0.494 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949995).  Saving model ...
Epoch: 15 cost time: 0.4820597171783447
Epoch: 15, Steps: 3 | Train Loss: 0.296 Vali Loss: 0.450 Vali Acc: 0.950 Test Loss: 0.450 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 16 cost time: 0.5218789577484131
Epoch: 16, Steps: 3 | Train Loss: 0.282 Vali Loss: 0.416 Vali Acc: 0.950 Test Loss: 0.416 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 17 cost time: 0.5257248878479004
Epoch: 17, Steps: 3 | Train Loss: 0.229 Vali Loss: 0.376 Vali Acc: 0.975 Test Loss: 0.376 Test Acc: 0.975
Validation loss decreased (-0.949996 --> -0.974996).  Saving model ...
Epoch: 18 cost time: 0.5428202152252197
Epoch: 18, Steps: 3 | Train Loss: 0.212 Vali Loss: 0.354 Vali Acc: 0.950 Test Loss: 0.354 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5086431503295898
Epoch: 19, Steps: 3 | Train Loss: 0.212 Vali Loss: 0.327 Vali Acc: 0.950 Test Loss: 0.327 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.5064129829406738
Epoch: 20, Steps: 3 | Train Loss: 0.188 Vali Loss: 0.316 Vali Acc: 0.950 Test Loss: 0.316 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.5079188346862793
Epoch: 21, Steps: 3 | Train Loss: 0.152 Vali Loss: 0.302 Vali Acc: 0.950 Test Loss: 0.302 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.4539055824279785
Epoch: 22, Steps: 3 | Train Loss: 0.129 Vali Loss: 0.277 Vali Acc: 0.950 Test Loss: 0.277 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.4812335968017578
Epoch: 23, Steps: 3 | Train Loss: 0.122 Vali Loss: 0.257 Vali Acc: 0.950 Test Loss: 0.257 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.47432446479797363
Epoch: 24, Steps: 3 | Train Loss: 0.114 Vali Loss: 0.252 Vali Acc: 0.950 Test Loss: 0.252 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.4946870803833008
Epoch: 25, Steps: 3 | Train Loss: 0.109 Vali Loss: 0.238 Vali Acc: 0.950 Test Loss: 0.238 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.5380558967590332
Epoch: 26, Steps: 3 | Train Loss: 0.101 Vali Loss: 0.230 Vali Acc: 0.950 Test Loss: 0.230 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.4484128952026367
Epoch: 27, Steps: 3 | Train Loss: 0.071 Vali Loss: 0.216 Vali Acc: 0.950 Test Loss: 0.216 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 2191876
model size : 8.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps20_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.8336925506591797
Epoch: 1, Steps: 3 | Train Loss: 1.419 Vali Loss: 1.364 Vali Acc: 0.275 Test Loss: 1.364 Test Acc: 0.275
Validation loss decreased (inf --> -0.274986).  Saving model ...
Epoch: 2 cost time: 0.44353175163269043
Epoch: 2, Steps: 3 | Train Loss: 1.381 Vali Loss: 1.333 Vali Acc: 0.350 Test Loss: 1.333 Test Acc: 0.350
Validation loss decreased (-0.274986 --> -0.349987).  Saving model ...
Epoch: 3 cost time: 0.4744997024536133
Epoch: 3, Steps: 3 | Train Loss: 1.298 Vali Loss: 1.287 Vali Acc: 0.350 Test Loss: 1.287 Test Acc: 0.350
Validation loss decreased (-0.349987 --> -0.349987).  Saving model ...
Epoch: 4 cost time: 0.5127365589141846
Epoch: 4, Steps: 3 | Train Loss: 1.201 Vali Loss: 1.221 Vali Acc: 0.375 Test Loss: 1.221 Test Acc: 0.375
Validation loss decreased (-0.349987 --> -0.374988).  Saving model ...
Epoch: 5 cost time: 0.49792909622192383
Epoch: 5, Steps: 3 | Train Loss: 1.140 Vali Loss: 1.139 Vali Acc: 0.725 Test Loss: 1.139 Test Acc: 0.725
Validation loss decreased (-0.374988 --> -0.724989).  Saving model ...
Epoch: 6 cost time: 0.4548466205596924
Epoch: 6, Steps: 3 | Train Loss: 0.984 Vali Loss: 1.059 Vali Acc: 0.825 Test Loss: 1.059 Test Acc: 0.825
Validation loss decreased (-0.724989 --> -0.824989).  Saving model ...
Epoch: 7 cost time: 0.4459874629974365
Epoch: 7, Steps: 3 | Train Loss: 0.893 Vali Loss: 0.971 Vali Acc: 0.875 Test Loss: 0.971 Test Acc: 0.875
Validation loss decreased (-0.824989 --> -0.874990).  Saving model ...
Epoch: 8 cost time: 0.46071529388427734
Epoch: 8, Steps: 3 | Train Loss: 0.815 Vali Loss: 0.880 Vali Acc: 0.875 Test Loss: 0.880 Test Acc: 0.875
Validation loss decreased (-0.874990 --> -0.874991).  Saving model ...
Epoch: 9 cost time: 0.462526798248291
Epoch: 9, Steps: 3 | Train Loss: 0.733 Vali Loss: 0.794 Vali Acc: 0.875 Test Loss: 0.794 Test Acc: 0.875
Validation loss decreased (-0.874991 --> -0.874992).  Saving model ...
Epoch: 10 cost time: 0.4537653923034668
Epoch: 10, Steps: 3 | Train Loss: 0.652 Vali Loss: 0.716 Vali Acc: 0.900 Test Loss: 0.716 Test Acc: 0.900
Validation loss decreased (-0.874992 --> -0.899993).  Saving model ...
Epoch: 11 cost time: 0.4558095932006836
Epoch: 11, Steps: 3 | Train Loss: 0.564 Vali Loss: 0.642 Vali Acc: 0.900 Test Loss: 0.642 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899994).  Saving model ...
Epoch: 12 cost time: 0.4849052429199219
Epoch: 12, Steps: 3 | Train Loss: 0.501 Vali Loss: 0.582 Vali Acc: 0.900 Test Loss: 0.582 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 13 cost time: 0.4671518802642822
Epoch: 13, Steps: 3 | Train Loss: 0.414 Vali Loss: 0.538 Vali Acc: 0.925 Test Loss: 0.538 Test Acc: 0.925
Validation loss decreased (-0.899994 --> -0.924995).  Saving model ...
Epoch: 14 cost time: 0.5454564094543457
Epoch: 14, Steps: 3 | Train Loss: 0.412 Vali Loss: 0.490 Vali Acc: 0.925 Test Loss: 0.490 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 15 cost time: 0.4762852191925049
Epoch: 15, Steps: 3 | Train Loss: 0.335 Vali Loss: 0.445 Vali Acc: 0.925 Test Loss: 0.445 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 16 cost time: 0.4661710262298584
Epoch: 16, Steps: 3 | Train Loss: 0.294 Vali Loss: 0.414 Vali Acc: 0.925 Test Loss: 0.414 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 17 cost time: 0.5282211303710938
Epoch: 17, Steps: 3 | Train Loss: 0.312 Vali Loss: 0.382 Vali Acc: 0.925 Test Loss: 0.382 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 18 cost time: 0.5022056102752686
Epoch: 18, Steps: 3 | Train Loss: 0.276 Vali Loss: 0.353 Vali Acc: 0.925 Test Loss: 0.353 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 19 cost time: 0.5619573593139648
Epoch: 19, Steps: 3 | Train Loss: 0.240 Vali Loss: 0.336 Vali Acc: 0.950 Test Loss: 0.336 Test Acc: 0.950
Validation loss decreased (-0.924996 --> -0.949997).  Saving model ...
Epoch: 20 cost time: 0.47808408737182617
Epoch: 20, Steps: 3 | Train Loss: 0.216 Vali Loss: 0.324 Vali Acc: 0.950 Test Loss: 0.324 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 21 cost time: 0.46514320373535156
Epoch: 21, Steps: 3 | Train Loss: 0.208 Vali Loss: 0.312 Vali Acc: 0.950 Test Loss: 0.312 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 22 cost time: 0.5331523418426514
Epoch: 22, Steps: 3 | Train Loss: 0.196 Vali Loss: 0.300 Vali Acc: 0.950 Test Loss: 0.300 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 23 cost time: 0.48573827743530273
Epoch: 23, Steps: 3 | Train Loss: 0.164 Vali Loss: 0.292 Vali Acc: 0.950 Test Loss: 0.292 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 24 cost time: 0.5203170776367188
Epoch: 24, Steps: 3 | Train Loss: 0.155 Vali Loss: 0.272 Vali Acc: 0.950 Test Loss: 0.272 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 25 cost time: 0.5138585567474365
Epoch: 25, Steps: 3 | Train Loss: 0.135 Vali Loss: 0.256 Vali Acc: 0.975 Test Loss: 0.256 Test Acc: 0.975
Validation loss decreased (-0.949997 --> -0.974997).  Saving model ...
Epoch: 26 cost time: 0.4313673973083496
Epoch: 26, Steps: 3 | Train Loss: 0.121 Vali Loss: 0.243 Vali Acc: 0.975 Test Loss: 0.243 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 27 cost time: 0.4802403450012207
Epoch: 27, Steps: 3 | Train Loss: 0.121 Vali Loss: 0.228 Vali Acc: 0.975 Test Loss: 0.228 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 28 cost time: 0.49340033531188965
Epoch: 28, Steps: 3 | Train Loss: 0.097 Vali Loss: 0.220 Vali Acc: 0.975 Test Loss: 0.220 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 29 cost time: 0.4953174591064453
Epoch: 29, Steps: 3 | Train Loss: 0.099 Vali Loss: 0.207 Vali Acc: 0.975 Test Loss: 0.207 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 30 cost time: 0.48610925674438477
Epoch: 30, Steps: 3 | Train Loss: 0.079 Vali Loss: 0.195 Vali Acc: 0.975 Test Loss: 0.195 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 31 cost time: 0.4561338424682617
Epoch: 31, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.186 Vali Acc: 0.975 Test Loss: 0.186 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 32 cost time: 0.6243431568145752
Epoch: 32, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.178 Vali Acc: 0.975 Test Loss: 0.178 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 33 cost time: 0.49224328994750977
Epoch: 33, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.170 Vali Acc: 0.975 Test Loss: 0.170 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 34 cost time: 0.509282112121582
Epoch: 34, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.169 Vali Acc: 0.975 Test Loss: 0.169 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 35 cost time: 0.4821295738220215
Epoch: 35, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.162 Vali Acc: 0.975 Test Loss: 0.162 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 36 cost time: 0.5651822090148926
Epoch: 36, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.162 Vali Acc: 0.975 Test Loss: 0.162 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 37 cost time: 0.5329568386077881
Epoch: 37, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.167 Vali Acc: 0.950 Test Loss: 0.167 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.5030934810638428
Epoch: 38, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.167 Vali Acc: 0.950 Test Loss: 0.167 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.42700695991516113
Epoch: 39, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.168 Vali Acc: 0.950 Test Loss: 0.168 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.5490717887878418
Epoch: 40, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.170 Vali Acc: 0.950 Test Loss: 0.170 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.4717731475830078
Epoch: 41, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.167 Vali Acc: 0.950 Test Loss: 0.167 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.5181713104248047
Epoch: 42, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.159 Vali Acc: 0.950 Test Loss: 0.159 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.48836350440979004
Epoch: 43, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.159 Vali Acc: 0.950 Test Loss: 0.159 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.5054762363433838
Epoch: 44, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.163 Vali Acc: 0.950 Test Loss: 0.163 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.444746732711792
Epoch: 45, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.157 Vali Acc: 0.950 Test Loss: 0.157 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 0.5111756324768066
Epoch: 46, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.162 Vali Acc: 0.950 Test Loss: 0.162 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps20_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 2186372
model size : 8.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps25_str13_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.7094836235046387
Epoch: 1, Steps: 3 | Train Loss: 1.420 Vali Loss: 1.359 Vali Acc: 0.200 Test Loss: 1.359 Test Acc: 0.200
Validation loss decreased (inf --> -0.199986).  Saving model ...
Epoch: 2 cost time: 0.5446031093597412
Epoch: 2, Steps: 3 | Train Loss: 1.346 Vali Loss: 1.332 Vali Acc: 0.250 Test Loss: 1.332 Test Acc: 0.250
Validation loss decreased (-0.199986 --> -0.249987).  Saving model ...
Epoch: 3 cost time: 0.49642133712768555
Epoch: 3, Steps: 3 | Train Loss: 1.289 Vali Loss: 1.293 Vali Acc: 0.350 Test Loss: 1.293 Test Acc: 0.350
Validation loss decreased (-0.249987 --> -0.349987).  Saving model ...
Epoch: 4 cost time: 0.4830155372619629
Epoch: 4, Steps: 3 | Train Loss: 1.182 Vali Loss: 1.236 Vali Acc: 0.575 Test Loss: 1.236 Test Acc: 0.575
Validation loss decreased (-0.349987 --> -0.574988).  Saving model ...
Epoch: 5 cost time: 0.4532036781311035
Epoch: 5, Steps: 3 | Train Loss: 1.109 Vali Loss: 1.166 Vali Acc: 0.775 Test Loss: 1.166 Test Acc: 0.775
Validation loss decreased (-0.574988 --> -0.774988).  Saving model ...
Epoch: 6 cost time: 0.43896484375
Epoch: 6, Steps: 3 | Train Loss: 0.997 Vali Loss: 1.094 Vali Acc: 0.850 Test Loss: 1.094 Test Acc: 0.850
Validation loss decreased (-0.774988 --> -0.849989).  Saving model ...
Epoch: 7 cost time: 0.5879740715026855
Epoch: 7, Steps: 3 | Train Loss: 0.918 Vali Loss: 1.011 Vali Acc: 0.925 Test Loss: 1.011 Test Acc: 0.925
Validation loss decreased (-0.849989 --> -0.924990).  Saving model ...
Epoch: 8 cost time: 0.5010144710540771
Epoch: 8, Steps: 3 | Train Loss: 0.824 Vali Loss: 0.929 Vali Acc: 0.925 Test Loss: 0.929 Test Acc: 0.925
Validation loss decreased (-0.924990 --> -0.924991).  Saving model ...
Epoch: 9 cost time: 0.583888053894043
Epoch: 9, Steps: 3 | Train Loss: 0.736 Vali Loss: 0.844 Vali Acc: 0.900 Test Loss: 0.844 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5781919956207275
Epoch: 10, Steps: 3 | Train Loss: 0.647 Vali Loss: 0.774 Vali Acc: 0.925 Test Loss: 0.774 Test Acc: 0.925
Validation loss decreased (-0.924991 --> -0.924992).  Saving model ...
Epoch: 11 cost time: 0.48723435401916504
Epoch: 11, Steps: 3 | Train Loss: 0.567 Vali Loss: 0.708 Vali Acc: 0.950 Test Loss: 0.708 Test Acc: 0.950
Validation loss decreased (-0.924992 --> -0.949993).  Saving model ...
Epoch: 12 cost time: 0.579822301864624
Epoch: 12, Steps: 3 | Train Loss: 0.513 Vali Loss: 0.641 Vali Acc: 0.950 Test Loss: 0.641 Test Acc: 0.950
Validation loss decreased (-0.949993 --> -0.949994).  Saving model ...
Epoch: 13 cost time: 0.5291244983673096
Epoch: 13, Steps: 3 | Train Loss: 0.470 Vali Loss: 0.583 Vali Acc: 0.950 Test Loss: 0.583 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949994).  Saving model ...
Epoch: 14 cost time: 0.5515933036804199
Epoch: 14, Steps: 3 | Train Loss: 0.420 Vali Loss: 0.536 Vali Acc: 0.950 Test Loss: 0.536 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 15 cost time: 0.46242809295654297
Epoch: 15, Steps: 3 | Train Loss: 0.363 Vali Loss: 0.493 Vali Acc: 0.975 Test Loss: 0.493 Test Acc: 0.975
Validation loss decreased (-0.949995 --> -0.974995).  Saving model ...
Epoch: 16 cost time: 0.5229048728942871
Epoch: 16, Steps: 3 | Train Loss: 0.333 Vali Loss: 0.471 Vali Acc: 0.975 Test Loss: 0.471 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 17 cost time: 0.5442748069763184
Epoch: 17, Steps: 3 | Train Loss: 0.289 Vali Loss: 0.442 Vali Acc: 0.975 Test Loss: 0.442 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 18 cost time: 0.5080878734588623
Epoch: 18, Steps: 3 | Train Loss: 0.278 Vali Loss: 0.408 Vali Acc: 0.975 Test Loss: 0.408 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 19 cost time: 0.4669511318206787
Epoch: 19, Steps: 3 | Train Loss: 0.237 Vali Loss: 0.372 Vali Acc: 0.975 Test Loss: 0.372 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 20 cost time: 0.4950408935546875
Epoch: 20, Steps: 3 | Train Loss: 0.238 Vali Loss: 0.342 Vali Acc: 0.975 Test Loss: 0.342 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 21 cost time: 0.49505186080932617
Epoch: 21, Steps: 3 | Train Loss: 0.189 Vali Loss: 0.321 Vali Acc: 0.975 Test Loss: 0.321 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 22 cost time: 0.5946941375732422
Epoch: 22, Steps: 3 | Train Loss: 0.186 Vali Loss: 0.302 Vali Acc: 0.975 Test Loss: 0.302 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 23 cost time: 0.47951197624206543
Epoch: 23, Steps: 3 | Train Loss: 0.161 Vali Loss: 0.294 Vali Acc: 0.975 Test Loss: 0.294 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 24 cost time: 0.4876737594604492
Epoch: 24, Steps: 3 | Train Loss: 0.145 Vali Loss: 0.288 Vali Acc: 0.975 Test Loss: 0.288 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 25 cost time: 0.5559983253479004
Epoch: 25, Steps: 3 | Train Loss: 0.145 Vali Loss: 0.268 Vali Acc: 0.975 Test Loss: 0.268 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 26 cost time: 0.562129020690918
Epoch: 26, Steps: 3 | Train Loss: 0.127 Vali Loss: 0.261 Vali Acc: 0.975 Test Loss: 0.261 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 27 cost time: 0.47243833541870117
Epoch: 27, Steps: 3 | Train Loss: 0.107 Vali Loss: 0.258 Vali Acc: 0.975 Test Loss: 0.258 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 28 cost time: 0.5827865600585938
Epoch: 28, Steps: 3 | Train Loss: 0.105 Vali Loss: 0.244 Vali Acc: 0.975 Test Loss: 0.244 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 29 cost time: 0.5728950500488281
Epoch: 29, Steps: 3 | Train Loss: 0.093 Vali Loss: 0.229 Vali Acc: 0.975 Test Loss: 0.229 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 30 cost time: 0.5392570495605469
Epoch: 30, Steps: 3 | Train Loss: 0.075 Vali Loss: 0.215 Vali Acc: 0.975 Test Loss: 0.215 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 31 cost time: 0.6132371425628662
Epoch: 31, Steps: 3 | Train Loss: 0.085 Vali Loss: 0.207 Vali Acc: 0.975 Test Loss: 0.207 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 32 cost time: 0.5619320869445801
Epoch: 32, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.186 Vali Acc: 0.975 Test Loss: 0.186 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 33 cost time: 0.5879991054534912
Epoch: 33, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.189 Vali Acc: 0.975 Test Loss: 0.189 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.618607759475708
Epoch: 34, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.184 Vali Acc: 0.975 Test Loss: 0.184 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 35 cost time: 0.566227912902832
Epoch: 35, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.170 Vali Acc: 0.975 Test Loss: 0.170 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 36 cost time: 0.6142961978912354
Epoch: 36, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.169 Vali Acc: 0.975 Test Loss: 0.169 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 37 cost time: 0.5435988903045654
Epoch: 37, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.154 Vali Acc: 0.975 Test Loss: 0.154 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 38 cost time: 0.6106705665588379
Epoch: 38, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.155 Vali Acc: 0.975 Test Loss: 0.155 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.5441622734069824
Epoch: 39, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.148 Vali Acc: 0.975 Test Loss: 0.148 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974999).  Saving model ...
Epoch: 40 cost time: 0.6353750228881836
Epoch: 40, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.150 Vali Acc: 0.975 Test Loss: 0.150 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.4956934452056885
Epoch: 41, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.148 Vali Acc: 0.975 Test Loss: 0.148 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 42 cost time: 0.46617603302001953
Epoch: 42, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.149 Vali Acc: 0.975 Test Loss: 0.149 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.5429201126098633
Epoch: 43, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.150 Vali Acc: 0.975 Test Loss: 0.150 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.5420863628387451
Epoch: 44, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.149 Vali Acc: 0.975 Test Loss: 0.149 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.5748274326324463
Epoch: 45, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.143 Vali Acc: 0.975 Test Loss: 0.143 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 46 cost time: 0.5810670852661133
Epoch: 46, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.152 Vali Acc: 0.975 Test Loss: 0.152 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.4933359622955322
Epoch: 47, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.156 Vali Acc: 0.975 Test Loss: 0.156 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.5366256237030029
Epoch: 48, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.154 Vali Acc: 0.975 Test Loss: 0.154 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.5451180934906006
Epoch: 49, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.147 Vali Acc: 0.975 Test Loss: 0.147 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.6064941883087158
Epoch: 50, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.148 Vali Acc: 0.975 Test Loss: 0.148 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps25_str13_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 2180868
model size : 8.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.7234039306640625
Epoch: 1, Steps: 3 | Train Loss: 1.377 Vali Loss: 1.344 Vali Acc: 0.225 Test Loss: 1.344 Test Acc: 0.225
Validation loss decreased (inf --> -0.224987).  Saving model ...
Epoch: 2 cost time: 0.4490017890930176
Epoch: 2, Steps: 3 | Train Loss: 1.261 Vali Loss: 1.310 Vali Acc: 0.275 Test Loss: 1.310 Test Acc: 0.275
Validation loss decreased (-0.224987 --> -0.274987).  Saving model ...
Epoch: 3 cost time: 0.4385871887207031
Epoch: 3, Steps: 3 | Train Loss: 1.187 Vali Loss: 1.238 Vali Acc: 0.375 Test Loss: 1.238 Test Acc: 0.375
Validation loss decreased (-0.274987 --> -0.374988).  Saving model ...
Epoch: 4 cost time: 0.4819037914276123
Epoch: 4, Steps: 3 | Train Loss: 1.071 Vali Loss: 1.147 Vali Acc: 0.650 Test Loss: 1.147 Test Acc: 0.650
Validation loss decreased (-0.374988 --> -0.649989).  Saving model ...
Epoch: 5 cost time: 0.40937304496765137
Epoch: 5, Steps: 3 | Train Loss: 0.937 Vali Loss: 1.041 Vali Acc: 0.725 Test Loss: 1.041 Test Acc: 0.725
Validation loss decreased (-0.649989 --> -0.724990).  Saving model ...
Epoch: 6 cost time: 0.43741774559020996
Epoch: 6, Steps: 3 | Train Loss: 0.784 Vali Loss: 0.920 Vali Acc: 0.725 Test Loss: 0.920 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724991).  Saving model ...
Epoch: 7 cost time: 0.4611048698425293
Epoch: 7, Steps: 3 | Train Loss: 0.677 Vali Loss: 0.804 Vali Acc: 0.800 Test Loss: 0.804 Test Acc: 0.800
Validation loss decreased (-0.724991 --> -0.799992).  Saving model ...
Epoch: 8 cost time: 0.45564770698547363
Epoch: 8, Steps: 3 | Train Loss: 0.561 Vali Loss: 0.685 Vali Acc: 0.900 Test Loss: 0.685 Test Acc: 0.900
Validation loss decreased (-0.799992 --> -0.899993).  Saving model ...
Epoch: 9 cost time: 0.36569952964782715
Epoch: 9, Steps: 3 | Train Loss: 0.485 Vali Loss: 0.587 Vali Acc: 0.900 Test Loss: 0.587 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899994).  Saving model ...
Epoch: 10 cost time: 0.4819612503051758
Epoch: 10, Steps: 3 | Train Loss: 0.397 Vali Loss: 0.509 Vali Acc: 0.925 Test Loss: 0.509 Test Acc: 0.925
Validation loss decreased (-0.899994 --> -0.924995).  Saving model ...
Epoch: 11 cost time: 0.34636688232421875
Epoch: 11, Steps: 3 | Train Loss: 0.320 Vali Loss: 0.451 Vali Acc: 0.925 Test Loss: 0.451 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 12 cost time: 0.38433170318603516
Epoch: 12, Steps: 3 | Train Loss: 0.270 Vali Loss: 0.412 Vali Acc: 0.925 Test Loss: 0.412 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 13 cost time: 0.46174073219299316
Epoch: 13, Steps: 3 | Train Loss: 0.232 Vali Loss: 0.368 Vali Acc: 0.925 Test Loss: 0.368 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 14 cost time: 0.4139442443847656
Epoch: 14, Steps: 3 | Train Loss: 0.197 Vali Loss: 0.330 Vali Acc: 0.925 Test Loss: 0.330 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924997).  Saving model ...
Epoch: 15 cost time: 0.4133179187774658
Epoch: 15, Steps: 3 | Train Loss: 0.167 Vali Loss: 0.298 Vali Acc: 0.950 Test Loss: 0.298 Test Acc: 0.950
Validation loss decreased (-0.924997 --> -0.949997).  Saving model ...
Epoch: 16 cost time: 0.4342191219329834
Epoch: 16, Steps: 3 | Train Loss: 0.162 Vali Loss: 0.278 Vali Acc: 0.950 Test Loss: 0.278 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 17 cost time: 0.40349769592285156
Epoch: 17, Steps: 3 | Train Loss: 0.132 Vali Loss: 0.257 Vali Acc: 0.950 Test Loss: 0.257 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 18 cost time: 0.5358762741088867
Epoch: 18, Steps: 3 | Train Loss: 0.103 Vali Loss: 0.249 Vali Acc: 0.950 Test Loss: 0.249 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 19 cost time: 0.42554163932800293
Epoch: 19, Steps: 3 | Train Loss: 0.112 Vali Loss: 0.228 Vali Acc: 0.950 Test Loss: 0.228 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 20 cost time: 0.44599008560180664
Epoch: 20, Steps: 3 | Train Loss: 0.086 Vali Loss: 0.216 Vali Acc: 0.950 Test Loss: 0.216 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 21 cost time: 0.4785788059234619
Epoch: 21, Steps: 3 | Train Loss: 0.063 Vali Loss: 0.208 Vali Acc: 0.950 Test Loss: 0.208 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 22 cost time: 0.459075927734375
Epoch: 22, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.204 Vali Acc: 0.950 Test Loss: 0.204 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 23 cost time: 0.4693796634674072
Epoch: 23, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.194 Vali Acc: 0.950 Test Loss: 0.194 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 24 cost time: 0.46221423149108887
Epoch: 24, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.190 Vali Acc: 0.950 Test Loss: 0.190 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 25 cost time: 0.3971741199493408
Epoch: 25, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.192 Vali Acc: 0.950 Test Loss: 0.192 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.435636043548584
Epoch: 26, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.195 Vali Acc: 0.950 Test Loss: 0.195 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.45023274421691895
Epoch: 27, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.194 Vali Acc: 0.950 Test Loss: 0.194 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.4949936866760254
Epoch: 28, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.192 Vali Acc: 0.950 Test Loss: 0.192 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.44153714179992676
Epoch: 29, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.189 Vali Acc: 0.950 Test Loss: 0.189 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 30 cost time: 0.43791818618774414
Epoch: 30, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.194 Vali Acc: 0.950 Test Loss: 0.194 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.45780158042907715
Epoch: 31, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.197 Vali Acc: 0.950 Test Loss: 0.197 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.4677877426147461
Epoch: 32, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.196 Vali Acc: 0.950 Test Loss: 0.196 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.46250200271606445
Epoch: 33, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.194 Vali Acc: 0.950 Test Loss: 0.194 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.4107997417449951
Epoch: 34, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.200 Vali Acc: 0.950 Test Loss: 0.200 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.4459190368652344
Epoch: 35, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.200 Vali Acc: 0.950 Test Loss: 0.200 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.5042471885681152
Epoch: 36, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.202 Vali Acc: 0.950 Test Loss: 0.202 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.5290594100952148
Epoch: 37, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.206 Vali Acc: 0.950 Test Loss: 0.206 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.5167355537414551
Epoch: 38, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.208 Vali Acc: 0.950 Test Loss: 0.208 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.42146730422973633
Epoch: 39, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.208 Vali Acc: 0.950 Test Loss: 0.208 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 645636
model size : 2.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.8410332202911377
Epoch: 1, Steps: 3 | Train Loss: 1.435 Vali Loss: 1.343 Vali Acc: 0.225 Test Loss: 1.343 Test Acc: 0.225
Validation loss decreased (inf --> -0.224987).  Saving model ...
Epoch: 2 cost time: 0.5211098194122314
Epoch: 2, Steps: 3 | Train Loss: 1.361 Vali Loss: 1.310 Vali Acc: 0.275 Test Loss: 1.310 Test Acc: 0.275
Validation loss decreased (-0.224987 --> -0.274987).  Saving model ...
Epoch: 3 cost time: 0.4546334743499756
Epoch: 3, Steps: 3 | Train Loss: 1.275 Vali Loss: 1.259 Vali Acc: 0.650 Test Loss: 1.259 Test Acc: 0.650
Validation loss decreased (-0.274987 --> -0.649987).  Saving model ...
Epoch: 4 cost time: 0.4927241802215576
Epoch: 4, Steps: 3 | Train Loss: 1.186 Vali Loss: 1.182 Vali Acc: 0.700 Test Loss: 1.182 Test Acc: 0.700
Validation loss decreased (-0.649987 --> -0.699988).  Saving model ...
Epoch: 5 cost time: 0.4266927242279053
Epoch: 5, Steps: 3 | Train Loss: 1.039 Vali Loss: 1.093 Vali Acc: 0.775 Test Loss: 1.093 Test Acc: 0.775
Validation loss decreased (-0.699988 --> -0.774989).  Saving model ...
Epoch: 6 cost time: 0.4230997562408447
Epoch: 6, Steps: 3 | Train Loss: 0.907 Vali Loss: 0.989 Vali Acc: 0.775 Test Loss: 0.989 Test Acc: 0.775
Validation loss decreased (-0.774989 --> -0.774990).  Saving model ...
Epoch: 7 cost time: 0.43148064613342285
Epoch: 7, Steps: 3 | Train Loss: 0.816 Vali Loss: 0.877 Vali Acc: 0.825 Test Loss: 0.877 Test Acc: 0.825
Validation loss decreased (-0.774990 --> -0.824991).  Saving model ...
Epoch: 8 cost time: 0.39579296112060547
Epoch: 8, Steps: 3 | Train Loss: 0.669 Vali Loss: 0.785 Vali Acc: 0.900 Test Loss: 0.785 Test Acc: 0.900
Validation loss decreased (-0.824991 --> -0.899992).  Saving model ...
Epoch: 9 cost time: 0.4320709705352783
Epoch: 9, Steps: 3 | Train Loss: 0.581 Vali Loss: 0.688 Vali Acc: 0.925 Test Loss: 0.688 Test Acc: 0.925
Validation loss decreased (-0.899992 --> -0.924993).  Saving model ...
Epoch: 10 cost time: 0.520988941192627
Epoch: 10, Steps: 3 | Train Loss: 0.494 Vali Loss: 0.602 Vali Acc: 0.950 Test Loss: 0.602 Test Acc: 0.950
Validation loss decreased (-0.924993 --> -0.949994).  Saving model ...
Epoch: 11 cost time: 0.3996858596801758
Epoch: 11, Steps: 3 | Train Loss: 0.398 Vali Loss: 0.528 Vali Acc: 0.950 Test Loss: 0.528 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 12 cost time: 0.4943103790283203
Epoch: 12, Steps: 3 | Train Loss: 0.357 Vali Loss: 0.470 Vali Acc: 0.950 Test Loss: 0.470 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 13 cost time: 0.41942429542541504
Epoch: 13, Steps: 3 | Train Loss: 0.302 Vali Loss: 0.412 Vali Acc: 0.950 Test Loss: 0.412 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 14 cost time: 0.44093775749206543
Epoch: 14, Steps: 3 | Train Loss: 0.262 Vali Loss: 0.364 Vali Acc: 0.950 Test Loss: 0.364 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 15 cost time: 0.4472236633300781
Epoch: 15, Steps: 3 | Train Loss: 0.224 Vali Loss: 0.336 Vali Acc: 0.950 Test Loss: 0.336 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 16 cost time: 0.6017889976501465
Epoch: 16, Steps: 3 | Train Loss: 0.211 Vali Loss: 0.308 Vali Acc: 0.950 Test Loss: 0.308 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 17 cost time: 0.45337820053100586
Epoch: 17, Steps: 3 | Train Loss: 0.174 Vali Loss: 0.285 Vali Acc: 0.975 Test Loss: 0.285 Test Acc: 0.975
Validation loss decreased (-0.949997 --> -0.974997).  Saving model ...
Epoch: 18 cost time: 0.4536898136138916
Epoch: 18, Steps: 3 | Train Loss: 0.161 Vali Loss: 0.274 Vali Acc: 0.950 Test Loss: 0.274 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.42589306831359863
Epoch: 19, Steps: 3 | Train Loss: 0.170 Vali Loss: 0.263 Vali Acc: 0.950 Test Loss: 0.263 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.4433307647705078
Epoch: 20, Steps: 3 | Train Loss: 0.139 Vali Loss: 0.244 Vali Acc: 0.950 Test Loss: 0.244 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.4552001953125
Epoch: 21, Steps: 3 | Train Loss: 0.108 Vali Loss: 0.227 Vali Acc: 0.950 Test Loss: 0.227 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.4138150215148926
Epoch: 22, Steps: 3 | Train Loss: 0.103 Vali Loss: 0.218 Vali Acc: 0.950 Test Loss: 0.218 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.4294281005859375
Epoch: 23, Steps: 3 | Train Loss: 0.087 Vali Loss: 0.209 Vali Acc: 0.950 Test Loss: 0.209 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.4622652530670166
Epoch: 24, Steps: 3 | Train Loss: 0.082 Vali Loss: 0.205 Vali Acc: 0.950 Test Loss: 0.205 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.4379079341888428
Epoch: 25, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.202 Vali Acc: 0.950 Test Loss: 0.202 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.45358991622924805
Epoch: 26, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.195 Vali Acc: 0.950 Test Loss: 0.195 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.4232518672943115
Epoch: 27, Steps: 3 | Train Loss: 0.055 Vali Loss: 0.198 Vali Acc: 0.950 Test Loss: 0.198 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 621188
model size : 2.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.7707273960113525
Epoch: 1, Steps: 3 | Train Loss: 1.426 Vali Loss: 1.417 Vali Acc: 0.200 Test Loss: 1.417 Test Acc: 0.200
Validation loss decreased (inf --> -0.199986).  Saving model ...
Epoch: 2 cost time: 0.45212864875793457
Epoch: 2, Steps: 3 | Train Loss: 1.352 Vali Loss: 1.387 Vali Acc: 0.275 Test Loss: 1.387 Test Acc: 0.275
Validation loss decreased (-0.199986 --> -0.274986).  Saving model ...
Epoch: 3 cost time: 0.4760169982910156
Epoch: 3, Steps: 3 | Train Loss: 1.268 Vali Loss: 1.338 Vali Acc: 0.425 Test Loss: 1.338 Test Acc: 0.425
Validation loss decreased (-0.274986 --> -0.424987).  Saving model ...
Epoch: 4 cost time: 0.435711145401001
Epoch: 4, Steps: 3 | Train Loss: 1.204 Vali Loss: 1.268 Vali Acc: 0.550 Test Loss: 1.268 Test Acc: 0.550
Validation loss decreased (-0.424987 --> -0.549987).  Saving model ...
Epoch: 5 cost time: 0.4535677433013916
Epoch: 5, Steps: 3 | Train Loss: 1.090 Vali Loss: 1.184 Vali Acc: 0.625 Test Loss: 1.184 Test Acc: 0.625
Validation loss decreased (-0.549987 --> -0.624988).  Saving model ...
Epoch: 6 cost time: 0.4422767162322998
Epoch: 6, Steps: 3 | Train Loss: 0.984 Vali Loss: 1.091 Vali Acc: 0.725 Test Loss: 1.091 Test Acc: 0.725
Validation loss decreased (-0.624988 --> -0.724989).  Saving model ...
Epoch: 7 cost time: 0.39972448348999023
Epoch: 7, Steps: 3 | Train Loss: 0.866 Vali Loss: 0.996 Vali Acc: 0.725 Test Loss: 0.996 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724990).  Saving model ...
Epoch: 8 cost time: 0.5052731037139893
Epoch: 8, Steps: 3 | Train Loss: 0.767 Vali Loss: 0.900 Vali Acc: 0.850 Test Loss: 0.900 Test Acc: 0.850
Validation loss decreased (-0.724990 --> -0.849991).  Saving model ...
Epoch: 9 cost time: 0.4185175895690918
Epoch: 9, Steps: 3 | Train Loss: 0.664 Vali Loss: 0.806 Vali Acc: 0.875 Test Loss: 0.806 Test Acc: 0.875
Validation loss decreased (-0.849991 --> -0.874992).  Saving model ...
Epoch: 10 cost time: 0.48865842819213867
Epoch: 10, Steps: 3 | Train Loss: 0.573 Vali Loss: 0.728 Vali Acc: 0.900 Test Loss: 0.728 Test Acc: 0.900
Validation loss decreased (-0.874992 --> -0.899993).  Saving model ...
Epoch: 11 cost time: 0.4918985366821289
Epoch: 11, Steps: 3 | Train Loss: 0.506 Vali Loss: 0.655 Vali Acc: 0.900 Test Loss: 0.655 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 12 cost time: 0.45278143882751465
Epoch: 12, Steps: 3 | Train Loss: 0.440 Vali Loss: 0.585 Vali Acc: 0.900 Test Loss: 0.585 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899994).  Saving model ...
Epoch: 13 cost time: 0.5553359985351562
Epoch: 13, Steps: 3 | Train Loss: 0.419 Vali Loss: 0.527 Vali Acc: 0.900 Test Loss: 0.527 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 14 cost time: 0.5074150562286377
Epoch: 14, Steps: 3 | Train Loss: 0.322 Vali Loss: 0.470 Vali Acc: 0.900 Test Loss: 0.470 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 15 cost time: 0.42810940742492676
Epoch: 15, Steps: 3 | Train Loss: 0.300 Vali Loss: 0.437 Vali Acc: 0.925 Test Loss: 0.437 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924996).  Saving model ...
Epoch: 16 cost time: 0.48108386993408203
Epoch: 16, Steps: 3 | Train Loss: 0.264 Vali Loss: 0.399 Vali Acc: 0.950 Test Loss: 0.399 Test Acc: 0.950
Validation loss decreased (-0.924996 --> -0.949996).  Saving model ...
Epoch: 17 cost time: 0.4966459274291992
Epoch: 17, Steps: 3 | Train Loss: 0.242 Vali Loss: 0.369 Vali Acc: 0.950 Test Loss: 0.369 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 18 cost time: 0.4603574275970459
Epoch: 18, Steps: 3 | Train Loss: 0.217 Vali Loss: 0.339 Vali Acc: 0.950 Test Loss: 0.339 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 19 cost time: 0.5362856388092041
Epoch: 19, Steps: 3 | Train Loss: 0.189 Vali Loss: 0.323 Vali Acc: 0.950 Test Loss: 0.323 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 20 cost time: 0.41473388671875
Epoch: 20, Steps: 3 | Train Loss: 0.174 Vali Loss: 0.295 Vali Acc: 0.950 Test Loss: 0.295 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 21 cost time: 0.4332427978515625
Epoch: 21, Steps: 3 | Train Loss: 0.164 Vali Loss: 0.275 Vali Acc: 0.950 Test Loss: 0.275 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 22 cost time: 0.5454459190368652
Epoch: 22, Steps: 3 | Train Loss: 0.146 Vali Loss: 0.258 Vali Acc: 0.950 Test Loss: 0.258 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 23 cost time: 0.5878767967224121
Epoch: 23, Steps: 3 | Train Loss: 0.155 Vali Loss: 0.248 Vali Acc: 0.950 Test Loss: 0.248 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 24 cost time: 0.4573543071746826
Epoch: 24, Steps: 3 | Train Loss: 0.120 Vali Loss: 0.243 Vali Acc: 0.950 Test Loss: 0.243 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 25 cost time: 0.436786413192749
Epoch: 25, Steps: 3 | Train Loss: 0.112 Vali Loss: 0.231 Vali Acc: 0.950 Test Loss: 0.231 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 26 cost time: 0.443204402923584
Epoch: 26, Steps: 3 | Train Loss: 0.091 Vali Loss: 0.227 Vali Acc: 0.950 Test Loss: 0.227 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 27 cost time: 0.4786648750305176
Epoch: 27, Steps: 3 | Train Loss: 0.090 Vali Loss: 0.215 Vali Acc: 0.950 Test Loss: 0.215 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 28 cost time: 0.4610321521759033
Epoch: 28, Steps: 3 | Train Loss: 0.083 Vali Loss: 0.205 Vali Acc: 0.975 Test Loss: 0.205 Test Acc: 0.975
Validation loss decreased (-0.949998 --> -0.974998).  Saving model ...
Epoch: 29 cost time: 0.5418474674224854
Epoch: 29, Steps: 3 | Train Loss: 0.058 Vali Loss: 0.192 Vali Acc: 0.975 Test Loss: 0.192 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 30 cost time: 0.45229268074035645
Epoch: 30, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.190 Vali Acc: 0.950 Test Loss: 0.190 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.4599609375
Epoch: 31, Steps: 3 | Train Loss: 0.055 Vali Loss: 0.191 Vali Acc: 0.950 Test Loss: 0.191 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.4589560031890869
Epoch: 32, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.189 Vali Acc: 0.950 Test Loss: 0.189 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.5183098316192627
Epoch: 33, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.185 Vali Acc: 0.950 Test Loss: 0.185 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.4494960308074951
Epoch: 34, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.181 Vali Acc: 0.950 Test Loss: 0.181 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.43080639839172363
Epoch: 35, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.184 Vali Acc: 0.950 Test Loss: 0.184 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.45671749114990234
Epoch: 36, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.186 Vali Acc: 0.950 Test Loss: 0.186 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.5107183456420898
Epoch: 37, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.174 Vali Acc: 0.975 Test Loss: 0.174 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 38 cost time: 0.450547456741333
Epoch: 38, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.160 Vali Acc: 0.975 Test Loss: 0.160 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 39 cost time: 0.4578888416290283
Epoch: 39, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.154 Vali Acc: 0.975 Test Loss: 0.154 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 40 cost time: 0.4845116138458252
Epoch: 40, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.147 Vali Acc: 0.975 Test Loss: 0.147 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974999).  Saving model ...
Epoch: 41 cost time: 0.47931337356567383
Epoch: 41, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.140 Vali Acc: 0.975 Test Loss: 0.140 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 42 cost time: 0.45123910903930664
Epoch: 42, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.136 Vali Acc: 0.975 Test Loss: 0.136 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 43 cost time: 0.5208373069763184
Epoch: 43, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.138 Vali Acc: 0.975 Test Loss: 0.138 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.489912748336792
Epoch: 44, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.135 Vali Acc: 0.975 Test Loss: 0.135 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 45 cost time: 0.4476633071899414
Epoch: 45, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.137 Vali Acc: 0.975 Test Loss: 0.137 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.5208642482757568
Epoch: 46, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.133 Vali Acc: 0.975 Test Loss: 0.133 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 47 cost time: 0.46884846687316895
Epoch: 47, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.137 Vali Acc: 0.975 Test Loss: 0.137 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.42922353744506836
Epoch: 48, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.138 Vali Acc: 0.975 Test Loss: 0.138 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.5248804092407227
Epoch: 49, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.139 Vali Acc: 0.975 Test Loss: 0.139 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.5264332294464111
Epoch: 50, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.140 Vali Acc: 0.975 Test Loss: 0.140 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 609092
model size : 2.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.8142459392547607
Epoch: 1, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.380 Vali Acc: 0.225 Test Loss: 1.380 Test Acc: 0.225
Validation loss decreased (inf --> -0.224986).  Saving model ...
Epoch: 2 cost time: 0.46192407608032227
Epoch: 2, Steps: 3 | Train Loss: 1.366 Vali Loss: 1.360 Vali Acc: 0.250 Test Loss: 1.360 Test Acc: 0.250
Validation loss decreased (-0.224986 --> -0.249986).  Saving model ...
Epoch: 3 cost time: 0.48688769340515137
Epoch: 3, Steps: 3 | Train Loss: 1.300 Vali Loss: 1.324 Vali Acc: 0.525 Test Loss: 1.324 Test Acc: 0.525
Validation loss decreased (-0.249986 --> -0.524987).  Saving model ...
Epoch: 4 cost time: 0.4761009216308594
Epoch: 4, Steps: 3 | Train Loss: 1.249 Vali Loss: 1.273 Vali Acc: 0.675 Test Loss: 1.273 Test Acc: 0.675
Validation loss decreased (-0.524987 --> -0.674987).  Saving model ...
Epoch: 5 cost time: 0.4748110771179199
Epoch: 5, Steps: 3 | Train Loss: 1.168 Vali Loss: 1.211 Vali Acc: 0.725 Test Loss: 1.211 Test Acc: 0.725
Validation loss decreased (-0.674987 --> -0.724988).  Saving model ...
Epoch: 6 cost time: 0.554659366607666
Epoch: 6, Steps: 3 | Train Loss: 1.070 Vali Loss: 1.143 Vali Acc: 0.750 Test Loss: 1.143 Test Acc: 0.750
Validation loss decreased (-0.724988 --> -0.749989).  Saving model ...
Epoch: 7 cost time: 0.49248385429382324
Epoch: 7, Steps: 3 | Train Loss: 0.978 Vali Loss: 1.069 Vali Acc: 0.800 Test Loss: 1.069 Test Acc: 0.800
Validation loss decreased (-0.749989 --> -0.799989).  Saving model ...
Epoch: 8 cost time: 0.5052473545074463
Epoch: 8, Steps: 3 | Train Loss: 0.881 Vali Loss: 1.000 Vali Acc: 0.875 Test Loss: 1.000 Test Acc: 0.875
Validation loss decreased (-0.799989 --> -0.874990).  Saving model ...
Epoch: 9 cost time: 0.5260138511657715
Epoch: 9, Steps: 3 | Train Loss: 0.858 Vali Loss: 0.915 Vali Acc: 0.925 Test Loss: 0.915 Test Acc: 0.925
Validation loss decreased (-0.874990 --> -0.924991).  Saving model ...
Epoch: 10 cost time: 0.49669599533081055
Epoch: 10, Steps: 3 | Train Loss: 0.734 Vali Loss: 0.839 Vali Acc: 0.950 Test Loss: 0.839 Test Acc: 0.950
Validation loss decreased (-0.924991 --> -0.949992).  Saving model ...
Epoch: 11 cost time: 0.4768087863922119
Epoch: 11, Steps: 3 | Train Loss: 0.698 Vali Loss: 0.755 Vali Acc: 0.950 Test Loss: 0.755 Test Acc: 0.950
Validation loss decreased (-0.949992 --> -0.949992).  Saving model ...
Epoch: 12 cost time: 0.5076076984405518
Epoch: 12, Steps: 3 | Train Loss: 0.564 Vali Loss: 0.695 Vali Acc: 0.950 Test Loss: 0.695 Test Acc: 0.950
Validation loss decreased (-0.949992 --> -0.949993).  Saving model ...
Epoch: 13 cost time: 0.5290408134460449
Epoch: 13, Steps: 3 | Train Loss: 0.501 Vali Loss: 0.643 Vali Acc: 0.950 Test Loss: 0.643 Test Acc: 0.950
Validation loss decreased (-0.949993 --> -0.949994).  Saving model ...
Epoch: 14 cost time: 0.5213258266448975
Epoch: 14, Steps: 3 | Train Loss: 0.458 Vali Loss: 0.590 Vali Acc: 0.925 Test Loss: 0.590 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.46465301513671875
Epoch: 15, Steps: 3 | Train Loss: 0.408 Vali Loss: 0.543 Vali Acc: 0.925 Test Loss: 0.543 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.4628713130950928
Epoch: 16, Steps: 3 | Train Loss: 0.360 Vali Loss: 0.512 Vali Acc: 0.950 Test Loss: 0.512 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 17 cost time: 0.4716782569885254
Epoch: 17, Steps: 3 | Train Loss: 0.312 Vali Loss: 0.462 Vali Acc: 0.950 Test Loss: 0.462 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 18 cost time: 0.45581698417663574
Epoch: 18, Steps: 3 | Train Loss: 0.284 Vali Loss: 0.430 Vali Acc: 0.950 Test Loss: 0.430 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 19 cost time: 0.5033056735992432
Epoch: 19, Steps: 3 | Train Loss: 0.270 Vali Loss: 0.409 Vali Acc: 0.950 Test Loss: 0.409 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 20 cost time: 0.49809789657592773
Epoch: 20, Steps: 3 | Train Loss: 0.249 Vali Loss: 0.375 Vali Acc: 0.950 Test Loss: 0.375 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 21 cost time: 0.44741201400756836
Epoch: 21, Steps: 3 | Train Loss: 0.224 Vali Loss: 0.352 Vali Acc: 0.950 Test Loss: 0.352 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 22 cost time: 0.44498181343078613
Epoch: 22, Steps: 3 | Train Loss: 0.228 Vali Loss: 0.336 Vali Acc: 0.975 Test Loss: 0.336 Test Acc: 0.975
Validation loss decreased (-0.949996 --> -0.974997).  Saving model ...
Epoch: 23 cost time: 0.44246459007263184
Epoch: 23, Steps: 3 | Train Loss: 0.183 Vali Loss: 0.318 Vali Acc: 0.975 Test Loss: 0.318 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 24 cost time: 0.45337629318237305
Epoch: 24, Steps: 3 | Train Loss: 0.140 Vali Loss: 0.292 Vali Acc: 0.975 Test Loss: 0.292 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 25 cost time: 0.4708988666534424
Epoch: 25, Steps: 3 | Train Loss: 0.162 Vali Loss: 0.290 Vali Acc: 0.950 Test Loss: 0.290 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.4547460079193115
Epoch: 26, Steps: 3 | Train Loss: 0.146 Vali Loss: 0.282 Vali Acc: 0.950 Test Loss: 0.282 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.5105884075164795
Epoch: 27, Steps: 3 | Train Loss: 0.151 Vali Loss: 0.272 Vali Acc: 0.950 Test Loss: 0.272 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.5048892498016357
Epoch: 28, Steps: 3 | Train Loss: 0.140 Vali Loss: 0.260 Vali Acc: 0.950 Test Loss: 0.260 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.49061083793640137
Epoch: 29, Steps: 3 | Train Loss: 0.118 Vali Loss: 0.251 Vali Acc: 0.950 Test Loss: 0.251 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.6142373085021973
Epoch: 30, Steps: 3 | Train Loss: 0.113 Vali Loss: 0.256 Vali Acc: 0.950 Test Loss: 0.256 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.5344123840332031
Epoch: 31, Steps: 3 | Train Loss: 0.092 Vali Loss: 0.243 Vali Acc: 0.950 Test Loss: 0.243 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.4882166385650635
Epoch: 32, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.233 Vali Acc: 0.950 Test Loss: 0.233 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.4196653366088867
Epoch: 33, Steps: 3 | Train Loss: 0.080 Vali Loss: 0.238 Vali Acc: 0.925 Test Loss: 0.238 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.5110509395599365
Epoch: 34, Steps: 3 | Train Loss: 0.072 Vali Loss: 0.235 Vali Acc: 0.925 Test Loss: 0.235 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 600004
model size : 2.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.7221524715423584
Epoch: 1, Steps: 3 | Train Loss: 1.427 Vali Loss: 1.345 Vali Acc: 0.250 Test Loss: 1.345 Test Acc: 0.250
Validation loss decreased (inf --> -0.249987).  Saving model ...
Epoch: 2 cost time: 0.37854814529418945
Epoch: 2, Steps: 3 | Train Loss: 1.378 Vali Loss: 1.331 Vali Acc: 0.275 Test Loss: 1.331 Test Acc: 0.275
Validation loss decreased (-0.249987 --> -0.274987).  Saving model ...
Epoch: 3 cost time: 0.5206973552703857
Epoch: 3, Steps: 3 | Train Loss: 1.345 Vali Loss: 1.309 Vali Acc: 0.325 Test Loss: 1.309 Test Acc: 0.325
Validation loss decreased (-0.274987 --> -0.324987).  Saving model ...
Epoch: 4 cost time: 0.4094216823577881
Epoch: 4, Steps: 3 | Train Loss: 1.279 Vali Loss: 1.277 Vali Acc: 0.325 Test Loss: 1.277 Test Acc: 0.325
Validation loss decreased (-0.324987 --> -0.324987).  Saving model ...
Epoch: 5 cost time: 0.3988935947418213
Epoch: 5, Steps: 3 | Train Loss: 1.231 Vali Loss: 1.238 Vali Acc: 0.350 Test Loss: 1.238 Test Acc: 0.350
Validation loss decreased (-0.324987 --> -0.349988).  Saving model ...
Epoch: 6 cost time: 0.47019004821777344
Epoch: 6, Steps: 3 | Train Loss: 1.181 Vali Loss: 1.187 Vali Acc: 0.400 Test Loss: 1.187 Test Acc: 0.400
Validation loss decreased (-0.349988 --> -0.399988).  Saving model ...
Epoch: 7 cost time: 0.4689936637878418
Epoch: 7, Steps: 3 | Train Loss: 1.098 Vali Loss: 1.133 Vali Acc: 0.500 Test Loss: 1.133 Test Acc: 0.500
Validation loss decreased (-0.399988 --> -0.499989).  Saving model ...
Epoch: 8 cost time: 0.45824718475341797
Epoch: 8, Steps: 3 | Train Loss: 1.067 Vali Loss: 1.075 Vali Acc: 0.625 Test Loss: 1.075 Test Acc: 0.625
Validation loss decreased (-0.499989 --> -0.624989).  Saving model ...
Epoch: 9 cost time: 0.47304344177246094
Epoch: 9, Steps: 3 | Train Loss: 0.986 Vali Loss: 1.015 Vali Acc: 0.850 Test Loss: 1.015 Test Acc: 0.850
Validation loss decreased (-0.624989 --> -0.849990).  Saving model ...
Epoch: 10 cost time: 0.3615541458129883
Epoch: 10, Steps: 3 | Train Loss: 0.912 Vali Loss: 0.957 Vali Acc: 0.925 Test Loss: 0.957 Test Acc: 0.925
Validation loss decreased (-0.849990 --> -0.924990).  Saving model ...
Epoch: 11 cost time: 0.46794748306274414
Epoch: 11, Steps: 3 | Train Loss: 0.851 Vali Loss: 0.901 Vali Acc: 0.950 Test Loss: 0.901 Test Acc: 0.950
Validation loss decreased (-0.924990 --> -0.949991).  Saving model ...
Epoch: 12 cost time: 0.46517515182495117
Epoch: 12, Steps: 3 | Train Loss: 0.748 Vali Loss: 0.852 Vali Acc: 0.975 Test Loss: 0.852 Test Acc: 0.975
Validation loss decreased (-0.949991 --> -0.974991).  Saving model ...
Epoch: 13 cost time: 0.4389030933380127
Epoch: 13, Steps: 3 | Train Loss: 0.721 Vali Loss: 0.798 Vali Acc: 0.950 Test Loss: 0.798 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.43211793899536133
Epoch: 14, Steps: 3 | Train Loss: 0.641 Vali Loss: 0.741 Vali Acc: 0.975 Test Loss: 0.741 Test Acc: 0.975
Validation loss decreased (-0.974991 --> -0.974993).  Saving model ...
Epoch: 15 cost time: 0.370577335357666
Epoch: 15, Steps: 3 | Train Loss: 0.599 Vali Loss: 0.690 Vali Acc: 0.950 Test Loss: 0.690 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.41524767875671387
Epoch: 16, Steps: 3 | Train Loss: 0.555 Vali Loss: 0.650 Vali Acc: 0.950 Test Loss: 0.650 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.3935990333557129
Epoch: 17, Steps: 3 | Train Loss: 0.491 Vali Loss: 0.626 Vali Acc: 0.950 Test Loss: 0.626 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.5222835540771484
Epoch: 18, Steps: 3 | Train Loss: 0.462 Vali Loss: 0.590 Vali Acc: 0.950 Test Loss: 0.590 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.4407360553741455
Epoch: 19, Steps: 3 | Train Loss: 0.429 Vali Loss: 0.552 Vali Acc: 0.975 Test Loss: 0.552 Test Acc: 0.975
Validation loss decreased (-0.974993 --> -0.974994).  Saving model ...
Epoch: 20 cost time: 0.48072052001953125
Epoch: 20, Steps: 3 | Train Loss: 0.403 Vali Loss: 0.516 Vali Acc: 0.975 Test Loss: 0.516 Test Acc: 0.975
Validation loss decreased (-0.974994 --> -0.974995).  Saving model ...
Epoch: 21 cost time: 0.49793028831481934
Epoch: 21, Steps: 3 | Train Loss: 0.369 Vali Loss: 0.492 Vali Acc: 0.975 Test Loss: 0.492 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 22 cost time: 0.5603821277618408
Epoch: 22, Steps: 3 | Train Loss: 0.330 Vali Loss: 0.456 Vali Acc: 0.975 Test Loss: 0.456 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 23 cost time: 0.4048576354980469
Epoch: 23, Steps: 3 | Train Loss: 0.298 Vali Loss: 0.428 Vali Acc: 0.975 Test Loss: 0.428 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 24 cost time: 0.42287683486938477
Epoch: 24, Steps: 3 | Train Loss: 0.287 Vali Loss: 0.408 Vali Acc: 0.975 Test Loss: 0.408 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 25 cost time: 0.4028151035308838
Epoch: 25, Steps: 3 | Train Loss: 0.276 Vali Loss: 0.385 Vali Acc: 0.975 Test Loss: 0.385 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 26 cost time: 0.38089847564697266
Epoch: 26, Steps: 3 | Train Loss: 0.226 Vali Loss: 0.362 Vali Acc: 0.975 Test Loss: 0.362 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 27 cost time: 0.4461371898651123
Epoch: 27, Steps: 3 | Train Loss: 0.229 Vali Loss: 0.363 Vali Acc: 0.975 Test Loss: 0.363 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.4017059803009033
Epoch: 28, Steps: 3 | Train Loss: 0.211 Vali Loss: 0.344 Vali Acc: 0.975 Test Loss: 0.344 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 29 cost time: 0.4126768112182617
Epoch: 29, Steps: 3 | Train Loss: 0.197 Vali Loss: 0.336 Vali Acc: 0.975 Test Loss: 0.336 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 30 cost time: 0.4630873203277588
Epoch: 30, Steps: 3 | Train Loss: 0.232 Vali Loss: 0.319 Vali Acc: 0.975 Test Loss: 0.319 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 31 cost time: 0.37940406799316406
Epoch: 31, Steps: 3 | Train Loss: 0.173 Vali Loss: 0.312 Vali Acc: 0.975 Test Loss: 0.312 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 32 cost time: 0.4181532859802246
Epoch: 32, Steps: 3 | Train Loss: 0.166 Vali Loss: 0.305 Vali Acc: 0.975 Test Loss: 0.305 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 33 cost time: 0.46757054328918457
Epoch: 33, Steps: 3 | Train Loss: 0.153 Vali Loss: 0.293 Vali Acc: 0.975 Test Loss: 0.293 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 34 cost time: 0.37048864364624023
Epoch: 34, Steps: 3 | Train Loss: 0.139 Vali Loss: 0.294 Vali Acc: 0.950 Test Loss: 0.294 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.43728113174438477
Epoch: 35, Steps: 3 | Train Loss: 0.129 Vali Loss: 0.292 Vali Acc: 0.950 Test Loss: 0.292 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.3918476104736328
Epoch: 36, Steps: 3 | Train Loss: 0.138 Vali Loss: 0.282 Vali Acc: 0.950 Test Loss: 0.282 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.43917179107666016
Epoch: 37, Steps: 3 | Train Loss: 0.115 Vali Loss: 0.268 Vali Acc: 0.950 Test Loss: 0.268 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.4648776054382324
Epoch: 38, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.257 Vali Acc: 0.950 Test Loss: 0.257 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.40865182876586914
Epoch: 39, Steps: 3 | Train Loss: 0.100 Vali Loss: 0.256 Vali Acc: 0.950 Test Loss: 0.256 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.47550153732299805
Epoch: 40, Steps: 3 | Train Loss: 0.101 Vali Loss: 0.250 Vali Acc: 0.950 Test Loss: 0.250 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.45148563385009766
Epoch: 41, Steps: 3 | Train Loss: 0.083 Vali Loss: 0.237 Vali Acc: 0.950 Test Loss: 0.237 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.4222538471221924
Epoch: 42, Steps: 3 | Train Loss: 0.074 Vali Loss: 0.225 Vali Acc: 0.950 Test Loss: 0.225 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.44674062728881836
Epoch: 43, Steps: 3 | Train Loss: 0.071 Vali Loss: 0.223 Vali Acc: 0.950 Test Loss: 0.223 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 588036
model size : 2.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps20_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.8462884426116943
Epoch: 1, Steps: 3 | Train Loss: 1.421 Vali Loss: 1.382 Vali Acc: 0.250 Test Loss: 1.382 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 0.4603862762451172
Epoch: 2, Steps: 3 | Train Loss: 1.365 Vali Loss: 1.367 Vali Acc: 0.275 Test Loss: 1.367 Test Acc: 0.275
Validation loss decreased (-0.249986 --> -0.274986).  Saving model ...
Epoch: 3 cost time: 0.4412400722503662
Epoch: 3, Steps: 3 | Train Loss: 1.336 Vali Loss: 1.346 Vali Acc: 0.275 Test Loss: 1.346 Test Acc: 0.275
Validation loss decreased (-0.274986 --> -0.274987).  Saving model ...
Epoch: 4 cost time: 0.401500940322876
Epoch: 4, Steps: 3 | Train Loss: 1.300 Vali Loss: 1.315 Vali Acc: 0.275 Test Loss: 1.315 Test Acc: 0.275
Validation loss decreased (-0.274987 --> -0.274987).  Saving model ...
Epoch: 5 cost time: 0.44441747665405273
Epoch: 5, Steps: 3 | Train Loss: 1.271 Vali Loss: 1.277 Vali Acc: 0.300 Test Loss: 1.277 Test Acc: 0.300
Validation loss decreased (-0.274987 --> -0.299987).  Saving model ...
Epoch: 6 cost time: 0.38834357261657715
Epoch: 6, Steps: 3 | Train Loss: 1.209 Vali Loss: 1.234 Vali Acc: 0.400 Test Loss: 1.234 Test Acc: 0.400
Validation loss decreased (-0.299987 --> -0.399988).  Saving model ...
Epoch: 7 cost time: 0.43454837799072266
Epoch: 7, Steps: 3 | Train Loss: 1.124 Vali Loss: 1.189 Vali Acc: 0.675 Test Loss: 1.189 Test Acc: 0.675
Validation loss decreased (-0.399988 --> -0.674988).  Saving model ...
Epoch: 8 cost time: 0.43648290634155273
Epoch: 8, Steps: 3 | Train Loss: 1.072 Vali Loss: 1.139 Vali Acc: 0.825 Test Loss: 1.139 Test Acc: 0.825
Validation loss decreased (-0.674988 --> -0.824989).  Saving model ...
Epoch: 9 cost time: 0.43440937995910645
Epoch: 9, Steps: 3 | Train Loss: 1.002 Vali Loss: 1.086 Vali Acc: 0.850 Test Loss: 1.086 Test Acc: 0.850
Validation loss decreased (-0.824989 --> -0.849989).  Saving model ...
Epoch: 10 cost time: 0.41471338272094727
Epoch: 10, Steps: 3 | Train Loss: 0.972 Vali Loss: 1.027 Vali Acc: 0.900 Test Loss: 1.027 Test Acc: 0.900
Validation loss decreased (-0.849989 --> -0.899990).  Saving model ...
Epoch: 11 cost time: 0.44499754905700684
Epoch: 11, Steps: 3 | Train Loss: 0.854 Vali Loss: 0.979 Vali Acc: 0.900 Test Loss: 0.979 Test Acc: 0.900
Validation loss decreased (-0.899990 --> -0.899990).  Saving model ...
Epoch: 12 cost time: 0.4892425537109375
Epoch: 12, Steps: 3 | Train Loss: 0.846 Vali Loss: 0.926 Vali Acc: 0.900 Test Loss: 0.926 Test Acc: 0.900
Validation loss decreased (-0.899990 --> -0.899991).  Saving model ...
Epoch: 13 cost time: 0.43625903129577637
Epoch: 13, Steps: 3 | Train Loss: 0.786 Vali Loss: 0.870 Vali Acc: 0.900 Test Loss: 0.870 Test Acc: 0.900
Validation loss decreased (-0.899991 --> -0.899991).  Saving model ...
Epoch: 14 cost time: 0.4143846035003662
Epoch: 14, Steps: 3 | Train Loss: 0.702 Vali Loss: 0.823 Vali Acc: 0.900 Test Loss: 0.823 Test Acc: 0.900
Validation loss decreased (-0.899991 --> -0.899992).  Saving model ...
Epoch: 15 cost time: 0.439241886138916
Epoch: 15, Steps: 3 | Train Loss: 0.647 Vali Loss: 0.777 Vali Acc: 0.900 Test Loss: 0.777 Test Acc: 0.900
Validation loss decreased (-0.899992 --> -0.899992).  Saving model ...
Epoch: 16 cost time: 0.42751359939575195
Epoch: 16, Steps: 3 | Train Loss: 0.588 Vali Loss: 0.734 Vali Acc: 0.900 Test Loss: 0.734 Test Acc: 0.900
Validation loss decreased (-0.899992 --> -0.899993).  Saving model ...
Epoch: 17 cost time: 0.46364831924438477
Epoch: 17, Steps: 3 | Train Loss: 0.564 Vali Loss: 0.700 Vali Acc: 0.900 Test Loss: 0.700 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 18 cost time: 0.46930646896362305
Epoch: 18, Steps: 3 | Train Loss: 0.517 Vali Loss: 0.660 Vali Acc: 0.900 Test Loss: 0.660 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 19 cost time: 0.5159835815429688
Epoch: 19, Steps: 3 | Train Loss: 0.476 Vali Loss: 0.621 Vali Acc: 0.875 Test Loss: 0.621 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.39861512184143066
Epoch: 20, Steps: 3 | Train Loss: 0.446 Vali Loss: 0.597 Vali Acc: 0.875 Test Loss: 0.597 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.5203795433044434
Epoch: 21, Steps: 3 | Train Loss: 0.452 Vali Loss: 0.568 Vali Acc: 0.875 Test Loss: 0.568 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.45815277099609375
Epoch: 22, Steps: 3 | Train Loss: 0.377 Vali Loss: 0.542 Vali Acc: 0.875 Test Loss: 0.542 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.5337791442871094
Epoch: 23, Steps: 3 | Train Loss: 0.336 Vali Loss: 0.522 Vali Acc: 0.875 Test Loss: 0.522 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.38840484619140625
Epoch: 24, Steps: 3 | Train Loss: 0.337 Vali Loss: 0.502 Vali Acc: 0.875 Test Loss: 0.502 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.42780137062072754
Epoch: 25, Steps: 3 | Train Loss: 0.337 Vali Loss: 0.473 Vali Acc: 0.875 Test Loss: 0.473 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.42479538917541504
Epoch: 26, Steps: 3 | Train Loss: 0.301 Vali Loss: 0.455 Vali Acc: 0.900 Test Loss: 0.455 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899995).  Saving model ...
Epoch: 27 cost time: 0.5053274631500244
Epoch: 27, Steps: 3 | Train Loss: 0.291 Vali Loss: 0.434 Vali Acc: 0.900 Test Loss: 0.434 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 28 cost time: 0.4945104122161865
Epoch: 28, Steps: 3 | Train Loss: 0.263 Vali Loss: 0.415 Vali Acc: 0.900 Test Loss: 0.415 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 29 cost time: 0.46930813789367676
Epoch: 29, Steps: 3 | Train Loss: 0.263 Vali Loss: 0.399 Vali Acc: 0.900 Test Loss: 0.399 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 30 cost time: 0.42876172065734863
Epoch: 30, Steps: 3 | Train Loss: 0.233 Vali Loss: 0.379 Vali Acc: 0.900 Test Loss: 0.379 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 31 cost time: 0.4156954288482666
Epoch: 31, Steps: 3 | Train Loss: 0.204 Vali Loss: 0.369 Vali Acc: 0.900 Test Loss: 0.369 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 32 cost time: 0.4490017890930176
Epoch: 32, Steps: 3 | Train Loss: 0.239 Vali Loss: 0.354 Vali Acc: 0.900 Test Loss: 0.354 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 33 cost time: 0.4878523349761963
Epoch: 33, Steps: 3 | Train Loss: 0.188 Vali Loss: 0.339 Vali Acc: 0.900 Test Loss: 0.339 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899997).  Saving model ...
Epoch: 34 cost time: 0.4321150779724121
Epoch: 34, Steps: 3 | Train Loss: 0.192 Vali Loss: 0.334 Vali Acc: 0.925 Test Loss: 0.334 Test Acc: 0.925
Validation loss decreased (-0.899997 --> -0.924997).  Saving model ...
Epoch: 35 cost time: 0.40969204902648926
Epoch: 35, Steps: 3 | Train Loss: 0.173 Vali Loss: 0.322 Vali Acc: 0.925 Test Loss: 0.322 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 36 cost time: 0.40230321884155273
Epoch: 36, Steps: 3 | Train Loss: 0.164 Vali Loss: 0.303 Vali Acc: 0.925 Test Loss: 0.303 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 37 cost time: 0.4163074493408203
Epoch: 37, Steps: 3 | Train Loss: 0.154 Vali Loss: 0.302 Vali Acc: 0.925 Test Loss: 0.302 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 38 cost time: 0.41840600967407227
Epoch: 38, Steps: 3 | Train Loss: 0.147 Vali Loss: 0.287 Vali Acc: 0.925 Test Loss: 0.287 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 39 cost time: 0.44603466987609863
Epoch: 39, Steps: 3 | Train Loss: 0.134 Vali Loss: 0.283 Vali Acc: 0.925 Test Loss: 0.283 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 40 cost time: 0.4462554454803467
Epoch: 40, Steps: 3 | Train Loss: 0.131 Vali Loss: 0.283 Vali Acc: 0.925 Test Loss: 0.283 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.5238583087921143
Epoch: 41, Steps: 3 | Train Loss: 0.126 Vali Loss: 0.274 Vali Acc: 0.925 Test Loss: 0.274 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 42 cost time: 0.5021119117736816
Epoch: 42, Steps: 3 | Train Loss: 0.108 Vali Loss: 0.262 Vali Acc: 0.925 Test Loss: 0.262 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 43 cost time: 0.49980998039245605
Epoch: 43, Steps: 3 | Train Loss: 0.090 Vali Loss: 0.246 Vali Acc: 0.925 Test Loss: 0.246 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924998).  Saving model ...
Epoch: 44 cost time: 0.48020291328430176
Epoch: 44, Steps: 3 | Train Loss: 0.091 Vali Loss: 0.248 Vali Acc: 0.925 Test Loss: 0.248 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.4155585765838623
Epoch: 45, Steps: 3 | Train Loss: 0.091 Vali Loss: 0.236 Vali Acc: 0.925 Test Loss: 0.236 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 46 cost time: 0.48589611053466797
Epoch: 46, Steps: 3 | Train Loss: 0.081 Vali Loss: 0.230 Vali Acc: 0.925 Test Loss: 0.230 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 47 cost time: 0.4210379123687744
Epoch: 47, Steps: 3 | Train Loss: 0.071 Vali Loss: 0.222 Vali Acc: 0.925 Test Loss: 0.222 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 48 cost time: 0.5019936561584473
Epoch: 48, Steps: 3 | Train Loss: 0.062 Vali Loss: 0.212 Vali Acc: 0.925 Test Loss: 0.212 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 49 cost time: 0.42905306816101074
Epoch: 49, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.202 Vali Acc: 0.950 Test Loss: 0.202 Test Acc: 0.950
Validation loss decreased (-0.924998 --> -0.949998).  Saving model ...
Epoch: 50 cost time: 0.47987985610961914
Epoch: 50, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.207 Vali Acc: 0.950 Test Loss: 0.207 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps20_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 585284
model size : 2.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps25_str13_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.625955581665039
Epoch: 1, Steps: 3 | Train Loss: 1.371 Vali Loss: 1.401 Vali Acc: 0.200 Test Loss: 1.401 Test Acc: 0.200
Validation loss decreased (inf --> -0.199986).  Saving model ...
Epoch: 2 cost time: 0.46367311477661133
Epoch: 2, Steps: 3 | Train Loss: 1.346 Vali Loss: 1.388 Vali Acc: 0.200 Test Loss: 1.388 Test Acc: 0.200
Validation loss decreased (-0.199986 --> -0.199986).  Saving model ...
Epoch: 3 cost time: 0.514850378036499
Epoch: 3, Steps: 3 | Train Loss: 1.290 Vali Loss: 1.371 Vali Acc: 0.200 Test Loss: 1.371 Test Acc: 0.200
Validation loss decreased (-0.199986 --> -0.199986).  Saving model ...
Epoch: 4 cost time: 0.4462721347808838
Epoch: 4, Steps: 3 | Train Loss: 1.288 Vali Loss: 1.347 Vali Acc: 0.250 Test Loss: 1.347 Test Acc: 0.250
Validation loss decreased (-0.199986 --> -0.249987).  Saving model ...
Epoch: 5 cost time: 0.49630141258239746
Epoch: 5, Steps: 3 | Train Loss: 1.221 Vali Loss: 1.314 Vali Acc: 0.300 Test Loss: 1.314 Test Acc: 0.300
Validation loss decreased (-0.249987 --> -0.299987).  Saving model ...
Epoch: 6 cost time: 0.48221349716186523
Epoch: 6, Steps: 3 | Train Loss: 1.185 Vali Loss: 1.276 Vali Acc: 0.450 Test Loss: 1.276 Test Acc: 0.450
Validation loss decreased (-0.299987 --> -0.449987).  Saving model ...
Epoch: 7 cost time: 0.45625734329223633
Epoch: 7, Steps: 3 | Train Loss: 1.172 Vali Loss: 1.230 Vali Acc: 0.625 Test Loss: 1.230 Test Acc: 0.625
Validation loss decreased (-0.449987 --> -0.624988).  Saving model ...
Epoch: 8 cost time: 0.43410205841064453
Epoch: 8, Steps: 3 | Train Loss: 1.036 Vali Loss: 1.186 Vali Acc: 0.700 Test Loss: 1.186 Test Acc: 0.700
Validation loss decreased (-0.624988 --> -0.699988).  Saving model ...
Epoch: 9 cost time: 0.46114063262939453
Epoch: 9, Steps: 3 | Train Loss: 0.993 Vali Loss: 1.133 Vali Acc: 0.700 Test Loss: 1.133 Test Acc: 0.700
Validation loss decreased (-0.699988 --> -0.699989).  Saving model ...
Epoch: 10 cost time: 0.48836302757263184
Epoch: 10, Steps: 3 | Train Loss: 0.958 Vali Loss: 1.083 Vali Acc: 0.800 Test Loss: 1.083 Test Acc: 0.800
Validation loss decreased (-0.699989 --> -0.799989).  Saving model ...
Epoch: 11 cost time: 0.4897785186767578
Epoch: 11, Steps: 3 | Train Loss: 0.933 Vali Loss: 1.034 Vali Acc: 0.775 Test Loss: 1.034 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.48517847061157227
Epoch: 12, Steps: 3 | Train Loss: 0.848 Vali Loss: 0.984 Vali Acc: 0.775 Test Loss: 0.984 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.45395517349243164
Epoch: 13, Steps: 3 | Train Loss: 0.791 Vali Loss: 0.940 Vali Acc: 0.775 Test Loss: 0.940 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.411149263381958
Epoch: 14, Steps: 3 | Train Loss: 0.732 Vali Loss: 0.901 Vali Acc: 0.775 Test Loss: 0.901 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.5210063457489014
Epoch: 15, Steps: 3 | Train Loss: 0.736 Vali Loss: 0.846 Vali Acc: 0.800 Test Loss: 0.846 Test Acc: 0.800
Validation loss decreased (-0.799989 --> -0.799992).  Saving model ...
Epoch: 16 cost time: 0.5474750995635986
Epoch: 16, Steps: 3 | Train Loss: 0.646 Vali Loss: 0.803 Vali Acc: 0.800 Test Loss: 0.803 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 17 cost time: 0.46170544624328613
Epoch: 17, Steps: 3 | Train Loss: 0.641 Vali Loss: 0.767 Vali Acc: 0.800 Test Loss: 0.767 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 18 cost time: 0.5343258380889893
Epoch: 18, Steps: 3 | Train Loss: 0.586 Vali Loss: 0.736 Vali Acc: 0.800 Test Loss: 0.736 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799993).  Saving model ...
Epoch: 19 cost time: 0.537916898727417
Epoch: 19, Steps: 3 | Train Loss: 0.530 Vali Loss: 0.706 Vali Acc: 0.825 Test Loss: 0.706 Test Acc: 0.825
Validation loss decreased (-0.799993 --> -0.824993).  Saving model ...
Epoch: 20 cost time: 0.42750120162963867
Epoch: 20, Steps: 3 | Train Loss: 0.496 Vali Loss: 0.690 Vali Acc: 0.875 Test Loss: 0.690 Test Acc: 0.875
Validation loss decreased (-0.824993 --> -0.874993).  Saving model ...
Epoch: 21 cost time: 0.4298520088195801
Epoch: 21, Steps: 3 | Train Loss: 0.459 Vali Loss: 0.659 Vali Acc: 0.875 Test Loss: 0.659 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 22 cost time: 0.42116451263427734
Epoch: 22, Steps: 3 | Train Loss: 0.426 Vali Loss: 0.622 Vali Acc: 0.900 Test Loss: 0.622 Test Acc: 0.900
Validation loss decreased (-0.874993 --> -0.899994).  Saving model ...
Epoch: 23 cost time: 0.40532732009887695
Epoch: 23, Steps: 3 | Train Loss: 0.421 Vali Loss: 0.597 Vali Acc: 0.900 Test Loss: 0.597 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 24 cost time: 0.4302046298980713
Epoch: 24, Steps: 3 | Train Loss: 0.362 Vali Loss: 0.576 Vali Acc: 0.900 Test Loss: 0.576 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 25 cost time: 0.41323375701904297
Epoch: 25, Steps: 3 | Train Loss: 0.388 Vali Loss: 0.556 Vali Acc: 0.900 Test Loss: 0.556 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 26 cost time: 0.45207929611206055
Epoch: 26, Steps: 3 | Train Loss: 0.356 Vali Loss: 0.531 Vali Acc: 0.875 Test Loss: 0.531 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5579619407653809
Epoch: 27, Steps: 3 | Train Loss: 0.319 Vali Loss: 0.526 Vali Acc: 0.875 Test Loss: 0.526 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.4059135913848877
Epoch: 28, Steps: 3 | Train Loss: 0.317 Vali Loss: 0.498 Vali Acc: 0.875 Test Loss: 0.498 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.5155680179595947
Epoch: 29, Steps: 3 | Train Loss: 0.283 Vali Loss: 0.481 Vali Acc: 0.875 Test Loss: 0.481 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.49727344512939453
Epoch: 30, Steps: 3 | Train Loss: 0.263 Vali Loss: 0.464 Vali Acc: 0.875 Test Loss: 0.464 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.5206298828125
Epoch: 31, Steps: 3 | Train Loss: 0.266 Vali Loss: 0.442 Vali Acc: 0.875 Test Loss: 0.442 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.46357059478759766
Epoch: 32, Steps: 3 | Train Loss: 0.240 Vali Loss: 0.439 Vali Acc: 0.875 Test Loss: 0.439 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.4515984058380127
Epoch: 33, Steps: 3 | Train Loss: 0.215 Vali Loss: 0.420 Vali Acc: 0.875 Test Loss: 0.420 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.5428857803344727
Epoch: 34, Steps: 3 | Train Loss: 0.218 Vali Loss: 0.402 Vali Acc: 0.875 Test Loss: 0.402 Test Acc: 0.875
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.5294020175933838
Epoch: 35, Steps: 3 | Train Loss: 0.217 Vali Loss: 0.390 Vali Acc: 0.900 Test Loss: 0.390 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899996).  Saving model ...
Epoch: 36 cost time: 0.4380216598510742
Epoch: 36, Steps: 3 | Train Loss: 0.187 Vali Loss: 0.385 Vali Acc: 0.925 Test Loss: 0.385 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924996).  Saving model ...
Epoch: 37 cost time: 0.4315965175628662
Epoch: 37, Steps: 3 | Train Loss: 0.181 Vali Loss: 0.369 Vali Acc: 0.950 Test Loss: 0.369 Test Acc: 0.950
Validation loss decreased (-0.924996 --> -0.949996).  Saving model ...
Epoch: 38 cost time: 0.48284459114074707
Epoch: 38, Steps: 3 | Train Loss: 0.178 Vali Loss: 0.368 Vali Acc: 0.950 Test Loss: 0.368 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 39 cost time: 0.4962596893310547
Epoch: 39, Steps: 3 | Train Loss: 0.155 Vali Loss: 0.360 Vali Acc: 0.950 Test Loss: 0.360 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 40 cost time: 0.4594554901123047
Epoch: 40, Steps: 3 | Train Loss: 0.140 Vali Loss: 0.349 Vali Acc: 0.950 Test Loss: 0.349 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 41 cost time: 0.5407540798187256
Epoch: 41, Steps: 3 | Train Loss: 0.158 Vali Loss: 0.341 Vali Acc: 0.950 Test Loss: 0.341 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 42 cost time: 0.5233743190765381
Epoch: 42, Steps: 3 | Train Loss: 0.103 Vali Loss: 0.322 Vali Acc: 0.950 Test Loss: 0.322 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 43 cost time: 0.4692189693450928
Epoch: 43, Steps: 3 | Train Loss: 0.102 Vali Loss: 0.305 Vali Acc: 0.950 Test Loss: 0.305 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 44 cost time: 0.4867560863494873
Epoch: 44, Steps: 3 | Train Loss: 0.119 Vali Loss: 0.299 Vali Acc: 0.950 Test Loss: 0.299 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 45 cost time: 0.44980788230895996
Epoch: 45, Steps: 3 | Train Loss: 0.110 Vali Loss: 0.295 Vali Acc: 0.950 Test Loss: 0.295 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 46 cost time: 0.45343804359436035
Epoch: 46, Steps: 3 | Train Loss: 0.087 Vali Loss: 0.302 Vali Acc: 0.925 Test Loss: 0.302 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.5617115497589111
Epoch: 47, Steps: 3 | Train Loss: 0.093 Vali Loss: 0.295 Vali Acc: 0.925 Test Loss: 0.295 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.5459072589874268
Epoch: 48, Steps: 3 | Train Loss: 0.073 Vali Loss: 0.288 Vali Acc: 0.925 Test Loss: 0.288 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.5724947452545166
Epoch: 49, Steps: 3 | Train Loss: 0.083 Vali Loss: 0.288 Vali Acc: 0.925 Test Loss: 0.288 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.565345048904419
Epoch: 50, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.289 Vali Acc: 0.925 Test Loss: 0.289 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps25_str13_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 582532
model size : 2.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.661113977432251
Epoch: 1, Steps: 3 | Train Loss: 1.467 Vali Loss: 1.444 Vali Acc: 0.075 Test Loss: 1.444 Test Acc: 0.075
Validation loss decreased (inf --> -0.074986).  Saving model ...
Epoch: 2 cost time: 0.48386263847351074
Epoch: 2, Steps: 3 | Train Loss: 1.379 Vali Loss: 1.421 Vali Acc: 0.100 Test Loss: 1.421 Test Acc: 0.100
Validation loss decreased (-0.074986 --> -0.099986).  Saving model ...
Epoch: 3 cost time: 0.43460607528686523
Epoch: 3, Steps: 3 | Train Loss: 1.329 Vali Loss: 1.383 Vali Acc: 0.150 Test Loss: 1.383 Test Acc: 0.150
Validation loss decreased (-0.099986 --> -0.149986).  Saving model ...
Epoch: 4 cost time: 0.4303464889526367
Epoch: 4, Steps: 3 | Train Loss: 1.241 Vali Loss: 1.325 Vali Acc: 0.500 Test Loss: 1.325 Test Acc: 0.500
Validation loss decreased (-0.149986 --> -0.499987).  Saving model ...
Epoch: 5 cost time: 0.4319169521331787
Epoch: 5, Steps: 3 | Train Loss: 1.147 Vali Loss: 1.258 Vali Acc: 0.700 Test Loss: 1.258 Test Acc: 0.700
Validation loss decreased (-0.499987 --> -0.699987).  Saving model ...
Epoch: 6 cost time: 0.4802989959716797
Epoch: 6, Steps: 3 | Train Loss: 1.060 Vali Loss: 1.182 Vali Acc: 0.775 Test Loss: 1.182 Test Acc: 0.775
Validation loss decreased (-0.699987 --> -0.774988).  Saving model ...
Epoch: 7 cost time: 0.44673824310302734
Epoch: 7, Steps: 3 | Train Loss: 0.956 Vali Loss: 1.100 Vali Acc: 0.800 Test Loss: 1.100 Test Acc: 0.800
Validation loss decreased (-0.774988 --> -0.799989).  Saving model ...
Epoch: 8 cost time: 0.46076416969299316
Epoch: 8, Steps: 3 | Train Loss: 0.882 Vali Loss: 1.013 Vali Acc: 0.775 Test Loss: 1.013 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.49315667152404785
Epoch: 9, Steps: 3 | Train Loss: 0.782 Vali Loss: 0.934 Vali Acc: 0.825 Test Loss: 0.934 Test Acc: 0.825
Validation loss decreased (-0.799989 --> -0.824991).  Saving model ...
Epoch: 10 cost time: 0.47968506813049316
Epoch: 10, Steps: 3 | Train Loss: 0.678 Vali Loss: 0.856 Vali Acc: 0.850 Test Loss: 0.856 Test Acc: 0.850
Validation loss decreased (-0.824991 --> -0.849991).  Saving model ...
Epoch: 11 cost time: 0.48078370094299316
Epoch: 11, Steps: 3 | Train Loss: 0.673 Vali Loss: 0.774 Vali Acc: 0.875 Test Loss: 0.774 Test Acc: 0.875
Validation loss decreased (-0.849991 --> -0.874992).  Saving model ...
Epoch: 12 cost time: 0.46769261360168457
Epoch: 12, Steps: 3 | Train Loss: 0.555 Vali Loss: 0.718 Vali Acc: 0.875 Test Loss: 0.718 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874993).  Saving model ...
Epoch: 13 cost time: 0.5509762763977051
Epoch: 13, Steps: 3 | Train Loss: 0.487 Vali Loss: 0.673 Vali Acc: 0.875 Test Loss: 0.673 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 14 cost time: 0.54441237449646
Epoch: 14, Steps: 3 | Train Loss: 0.421 Vali Loss: 0.617 Vali Acc: 0.875 Test Loss: 0.617 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 15 cost time: 0.49786376953125
Epoch: 15, Steps: 3 | Train Loss: 0.370 Vali Loss: 0.580 Vali Acc: 0.875 Test Loss: 0.580 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 16 cost time: 0.4917423725128174
Epoch: 16, Steps: 3 | Train Loss: 0.342 Vali Loss: 0.528 Vali Acc: 0.875 Test Loss: 0.528 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 17 cost time: 0.46495485305786133
Epoch: 17, Steps: 3 | Train Loss: 0.300 Vali Loss: 0.489 Vali Acc: 0.875 Test Loss: 0.489 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 18 cost time: 0.5160183906555176
Epoch: 18, Steps: 3 | Train Loss: 0.282 Vali Loss: 0.452 Vali Acc: 0.900 Test Loss: 0.452 Test Acc: 0.900
Validation loss decreased (-0.874995 --> -0.899995).  Saving model ...
Epoch: 19 cost time: 0.5803983211517334
Epoch: 19, Steps: 3 | Train Loss: 0.243 Vali Loss: 0.417 Vali Acc: 0.925 Test Loss: 0.417 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924996).  Saving model ...
Epoch: 20 cost time: 0.5031235218048096
Epoch: 20, Steps: 3 | Train Loss: 0.225 Vali Loss: 0.400 Vali Acc: 0.925 Test Loss: 0.400 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 21 cost time: 0.5034313201904297
Epoch: 21, Steps: 3 | Train Loss: 0.241 Vali Loss: 0.374 Vali Acc: 0.925 Test Loss: 0.374 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 22 cost time: 0.41338467597961426
Epoch: 22, Steps: 3 | Train Loss: 0.204 Vali Loss: 0.356 Vali Acc: 0.925 Test Loss: 0.356 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 23 cost time: 0.5162703990936279
Epoch: 23, Steps: 3 | Train Loss: 0.190 Vali Loss: 0.347 Vali Acc: 0.950 Test Loss: 0.347 Test Acc: 0.950
Validation loss decreased (-0.924996 --> -0.949997).  Saving model ...
Epoch: 24 cost time: 0.5150666236877441
Epoch: 24, Steps: 3 | Train Loss: 0.173 Vali Loss: 0.330 Vali Acc: 0.950 Test Loss: 0.330 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 25 cost time: 0.5840878486633301
Epoch: 25, Steps: 3 | Train Loss: 0.152 Vali Loss: 0.318 Vali Acc: 0.950 Test Loss: 0.318 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 26 cost time: 0.5055058002471924
Epoch: 26, Steps: 3 | Train Loss: 0.136 Vali Loss: 0.303 Vali Acc: 0.950 Test Loss: 0.303 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 27 cost time: 0.44501399993896484
Epoch: 27, Steps: 3 | Train Loss: 0.137 Vali Loss: 0.302 Vali Acc: 0.950 Test Loss: 0.302 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 28 cost time: 0.6024281978607178
Epoch: 28, Steps: 3 | Train Loss: 0.112 Vali Loss: 0.294 Vali Acc: 0.950 Test Loss: 0.294 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 29 cost time: 0.5431480407714844
Epoch: 29, Steps: 3 | Train Loss: 0.110 Vali Loss: 0.285 Vali Acc: 0.950 Test Loss: 0.285 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 30 cost time: 0.44263672828674316
Epoch: 30, Steps: 3 | Train Loss: 0.100 Vali Loss: 0.272 Vali Acc: 0.950 Test Loss: 0.272 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 31 cost time: 0.5089919567108154
Epoch: 31, Steps: 3 | Train Loss: 0.098 Vali Loss: 0.270 Vali Acc: 0.950 Test Loss: 0.270 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 32 cost time: 0.42786455154418945
Epoch: 32, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.273 Vali Acc: 0.950 Test Loss: 0.273 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.480849027633667
Epoch: 33, Steps: 3 | Train Loss: 0.090 Vali Loss: 0.269 Vali Acc: 0.950 Test Loss: 0.269 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 34 cost time: 0.41913557052612305
Epoch: 34, Steps: 3 | Train Loss: 0.078 Vali Loss: 0.264 Vali Acc: 0.950 Test Loss: 0.264 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 35 cost time: 0.4155728816986084
Epoch: 35, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.266 Vali Acc: 0.950 Test Loss: 0.266 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.49210119247436523
Epoch: 36, Steps: 3 | Train Loss: 0.058 Vali Loss: 0.263 Vali Acc: 0.950 Test Loss: 0.263 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 37 cost time: 0.46716785430908203
Epoch: 37, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.268 Vali Acc: 0.950 Test Loss: 0.268 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.4604332447052002
Epoch: 38, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.261 Vali Acc: 0.950 Test Loss: 0.261 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 39 cost time: 0.4432830810546875
Epoch: 39, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.259 Vali Acc: 0.950 Test Loss: 0.259 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 40 cost time: 0.45662426948547363
Epoch: 40, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.259 Vali Acc: 0.950 Test Loss: 0.259 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 41 cost time: 0.5075955390930176
Epoch: 41, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.256 Vali Acc: 0.950 Test Loss: 0.256 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 42 cost time: 0.47026848793029785
Epoch: 42, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.252 Vali Acc: 0.950 Test Loss: 0.252 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 43 cost time: 0.49385571479797363
Epoch: 43, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.259 Vali Acc: 0.950 Test Loss: 0.259 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.4618666172027588
Epoch: 44, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.262 Vali Acc: 0.950 Test Loss: 0.262 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.5629298686981201
Epoch: 45, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.268 Vali Acc: 0.950 Test Loss: 0.268 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.5034382343292236
Epoch: 46, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.269 Vali Acc: 0.950 Test Loss: 0.269 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.500525712966919
Epoch: 47, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.268 Vali Acc: 0.950 Test Loss: 0.268 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.530860424041748
Epoch: 48, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.262 Vali Acc: 0.950 Test Loss: 0.262 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.4568350315093994
Epoch: 49, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.254 Vali Acc: 0.950 Test Loss: 0.254 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.5421881675720215
Epoch: 50, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.248 Vali Acc: 0.950 Test Loss: 0.248 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 195844
model size : 0.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.855910062789917
Epoch: 1, Steps: 3 | Train Loss: 1.521 Vali Loss: 1.481 Vali Acc: 0.300 Test Loss: 1.481 Test Acc: 0.300
Validation loss decreased (inf --> -0.299985).  Saving model ...
Epoch: 2 cost time: 0.4675276279449463
Epoch: 2, Steps: 3 | Train Loss: 1.485 Vali Loss: 1.456 Vali Acc: 0.325 Test Loss: 1.456 Test Acc: 0.325
Validation loss decreased (-0.299985 --> -0.324985).  Saving model ...
Epoch: 3 cost time: 0.4815387725830078
Epoch: 3, Steps: 3 | Train Loss: 1.428 Vali Loss: 1.422 Vali Acc: 0.400 Test Loss: 1.422 Test Acc: 0.400
Validation loss decreased (-0.324985 --> -0.399986).  Saving model ...
Epoch: 4 cost time: 0.4496958255767822
Epoch: 4, Steps: 3 | Train Loss: 1.366 Vali Loss: 1.374 Vali Acc: 0.400 Test Loss: 1.374 Test Acc: 0.400
Validation loss decreased (-0.399986 --> -0.399986).  Saving model ...
Epoch: 5 cost time: 0.4658215045928955
Epoch: 5, Steps: 3 | Train Loss: 1.252 Vali Loss: 1.315 Vali Acc: 0.450 Test Loss: 1.315 Test Acc: 0.450
Validation loss decreased (-0.399986 --> -0.449987).  Saving model ...
Epoch: 6 cost time: 0.49927449226379395
Epoch: 6, Steps: 3 | Train Loss: 1.170 Vali Loss: 1.244 Vali Acc: 0.475 Test Loss: 1.244 Test Acc: 0.475
Validation loss decreased (-0.449987 --> -0.474988).  Saving model ...
Epoch: 7 cost time: 0.46561527252197266
Epoch: 7, Steps: 3 | Train Loss: 1.100 Vali Loss: 1.170 Vali Acc: 0.575 Test Loss: 1.170 Test Acc: 0.575
Validation loss decreased (-0.474988 --> -0.574988).  Saving model ...
Epoch: 8 cost time: 0.44592857360839844
Epoch: 8, Steps: 3 | Train Loss: 1.020 Vali Loss: 1.093 Vali Acc: 0.600 Test Loss: 1.093 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599989).  Saving model ...
Epoch: 9 cost time: 0.46224522590637207
Epoch: 9, Steps: 3 | Train Loss: 0.944 Vali Loss: 1.022 Vali Acc: 0.775 Test Loss: 1.022 Test Acc: 0.775
Validation loss decreased (-0.599989 --> -0.774990).  Saving model ...
Epoch: 10 cost time: 0.4865076541900635
Epoch: 10, Steps: 3 | Train Loss: 0.843 Vali Loss: 0.947 Vali Acc: 0.950 Test Loss: 0.947 Test Acc: 0.950
Validation loss decreased (-0.774990 --> -0.949991).  Saving model ...
Epoch: 11 cost time: 0.530200719833374
Epoch: 11, Steps: 3 | Train Loss: 0.770 Vali Loss: 0.876 Vali Acc: 0.950 Test Loss: 0.876 Test Acc: 0.950
Validation loss decreased (-0.949991 --> -0.949991).  Saving model ...
Epoch: 12 cost time: 0.4198782444000244
Epoch: 12, Steps: 3 | Train Loss: 0.692 Vali Loss: 0.809 Vali Acc: 0.925 Test Loss: 0.809 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.4332568645477295
Epoch: 13, Steps: 3 | Train Loss: 0.640 Vali Loss: 0.753 Vali Acc: 0.950 Test Loss: 0.753 Test Acc: 0.950
Validation loss decreased (-0.949991 --> -0.949992).  Saving model ...
Epoch: 14 cost time: 0.3977823257446289
Epoch: 14, Steps: 3 | Train Loss: 0.588 Vali Loss: 0.686 Vali Acc: 0.950 Test Loss: 0.686 Test Acc: 0.950
Validation loss decreased (-0.949992 --> -0.949993).  Saving model ...
Epoch: 15 cost time: 0.4864363670349121
Epoch: 15, Steps: 3 | Train Loss: 0.524 Vali Loss: 0.636 Vali Acc: 0.950 Test Loss: 0.636 Test Acc: 0.950
Validation loss decreased (-0.949993 --> -0.949994).  Saving model ...
Epoch: 16 cost time: 0.3961052894592285
Epoch: 16, Steps: 3 | Train Loss: 0.454 Vali Loss: 0.592 Vali Acc: 0.950 Test Loss: 0.592 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949994).  Saving model ...
Epoch: 17 cost time: 0.42905306816101074
Epoch: 17, Steps: 3 | Train Loss: 0.422 Vali Loss: 0.545 Vali Acc: 0.950 Test Loss: 0.545 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 18 cost time: 0.3989417552947998
Epoch: 18, Steps: 3 | Train Loss: 0.395 Vali Loss: 0.510 Vali Acc: 0.950 Test Loss: 0.510 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 19 cost time: 0.3401060104370117
Epoch: 19, Steps: 3 | Train Loss: 0.350 Vali Loss: 0.473 Vali Acc: 0.950 Test Loss: 0.473 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 20 cost time: 0.4584660530090332
Epoch: 20, Steps: 3 | Train Loss: 0.330 Vali Loss: 0.432 Vali Acc: 0.950 Test Loss: 0.432 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 21 cost time: 0.41630077362060547
Epoch: 21, Steps: 3 | Train Loss: 0.306 Vali Loss: 0.400 Vali Acc: 0.950 Test Loss: 0.400 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 22 cost time: 0.45177197456359863
Epoch: 22, Steps: 3 | Train Loss: 0.286 Vali Loss: 0.379 Vali Acc: 0.950 Test Loss: 0.379 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 23 cost time: 0.3888208866119385
Epoch: 23, Steps: 3 | Train Loss: 0.239 Vali Loss: 0.350 Vali Acc: 0.950 Test Loss: 0.350 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 24 cost time: 0.45662951469421387
Epoch: 24, Steps: 3 | Train Loss: 0.245 Vali Loss: 0.330 Vali Acc: 0.950 Test Loss: 0.330 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 25 cost time: 0.5134584903717041
Epoch: 25, Steps: 3 | Train Loss: 0.213 Vali Loss: 0.308 Vali Acc: 0.975 Test Loss: 0.308 Test Acc: 0.975
Validation loss decreased (-0.949997 --> -0.974997).  Saving model ...
Epoch: 26 cost time: 0.38175415992736816
Epoch: 26, Steps: 3 | Train Loss: 0.198 Vali Loss: 0.297 Vali Acc: 0.975 Test Loss: 0.297 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 27 cost time: 0.450855016708374
Epoch: 27, Steps: 3 | Train Loss: 0.200 Vali Loss: 0.288 Vali Acc: 0.975 Test Loss: 0.288 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 28 cost time: 0.5512409210205078
Epoch: 28, Steps: 3 | Train Loss: 0.170 Vali Loss: 0.271 Vali Acc: 0.975 Test Loss: 0.271 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 29 cost time: 0.41565966606140137
Epoch: 29, Steps: 3 | Train Loss: 0.165 Vali Loss: 0.251 Vali Acc: 0.975 Test Loss: 0.251 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 30 cost time: 0.5513808727264404
Epoch: 30, Steps: 3 | Train Loss: 0.155 Vali Loss: 0.244 Vali Acc: 0.975 Test Loss: 0.244 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 31 cost time: 0.4307551383972168
Epoch: 31, Steps: 3 | Train Loss: 0.124 Vali Loss: 0.247 Vali Acc: 0.975 Test Loss: 0.247 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.44245171546936035
Epoch: 32, Steps: 3 | Train Loss: 0.120 Vali Loss: 0.236 Vali Acc: 0.950 Test Loss: 0.236 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.4389948844909668
Epoch: 33, Steps: 3 | Train Loss: 0.108 Vali Loss: 0.222 Vali Acc: 0.950 Test Loss: 0.222 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.5390794277191162
Epoch: 34, Steps: 3 | Train Loss: 0.103 Vali Loss: 0.219 Vali Acc: 0.950 Test Loss: 0.219 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.46868348121643066
Epoch: 35, Steps: 3 | Train Loss: 0.098 Vali Loss: 0.214 Vali Acc: 0.950 Test Loss: 0.214 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.4463176727294922
Epoch: 36, Steps: 3 | Train Loss: 0.094 Vali Loss: 0.204 Vali Acc: 0.950 Test Loss: 0.204 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.5265004634857178
Epoch: 37, Steps: 3 | Train Loss: 0.085 Vali Loss: 0.199 Vali Acc: 0.950 Test Loss: 0.199 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.5277206897735596
Epoch: 38, Steps: 3 | Train Loss: 0.071 Vali Loss: 0.193 Vali Acc: 0.950 Test Loss: 0.193 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.4986913204193115
Epoch: 39, Steps: 3 | Train Loss: 0.078 Vali Loss: 0.189 Vali Acc: 0.950 Test Loss: 0.189 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.4465358257293701
Epoch: 40, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.183 Vali Acc: 0.950 Test Loss: 0.183 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 183620
model size : 0.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.657050371170044
Epoch: 1, Steps: 3 | Train Loss: 1.447 Vali Loss: 1.422 Vali Acc: 0.250 Test Loss: 1.422 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 0.4472939968109131
Epoch: 2, Steps: 3 | Train Loss: 1.382 Vali Loss: 1.406 Vali Acc: 0.250 Test Loss: 1.406 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 3 cost time: 0.5546431541442871
Epoch: 3, Steps: 3 | Train Loss: 1.349 Vali Loss: 1.384 Vali Acc: 0.350 Test Loss: 1.384 Test Acc: 0.350
Validation loss decreased (-0.249986 --> -0.349986).  Saving model ...
Epoch: 4 cost time: 0.5060098171234131
Epoch: 4, Steps: 3 | Train Loss: 1.319 Vali Loss: 1.350 Vali Acc: 0.425 Test Loss: 1.350 Test Acc: 0.425
Validation loss decreased (-0.349986 --> -0.424986).  Saving model ...
Epoch: 5 cost time: 0.5218021869659424
Epoch: 5, Steps: 3 | Train Loss: 1.241 Vali Loss: 1.308 Vali Acc: 0.500 Test Loss: 1.308 Test Acc: 0.500
Validation loss decreased (-0.424986 --> -0.499987).  Saving model ...
Epoch: 6 cost time: 0.5357780456542969
Epoch: 6, Steps: 3 | Train Loss: 1.178 Vali Loss: 1.255 Vali Acc: 0.525 Test Loss: 1.255 Test Acc: 0.525
Validation loss decreased (-0.499987 --> -0.524987).  Saving model ...
Epoch: 7 cost time: 0.4250791072845459
Epoch: 7, Steps: 3 | Train Loss: 1.113 Vali Loss: 1.193 Vali Acc: 0.550 Test Loss: 1.193 Test Acc: 0.550
Validation loss decreased (-0.524987 --> -0.549988).  Saving model ...
Epoch: 8 cost time: 0.46247363090515137
Epoch: 8, Steps: 3 | Train Loss: 1.054 Vali Loss: 1.129 Vali Acc: 0.575 Test Loss: 1.129 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574989).  Saving model ...
Epoch: 9 cost time: 0.4355325698852539
Epoch: 9, Steps: 3 | Train Loss: 0.966 Vali Loss: 1.066 Vali Acc: 0.625 Test Loss: 1.066 Test Acc: 0.625
Validation loss decreased (-0.574989 --> -0.624989).  Saving model ...
Epoch: 10 cost time: 0.4179508686065674
Epoch: 10, Steps: 3 | Train Loss: 0.889 Vali Loss: 1.002 Vali Acc: 0.825 Test Loss: 1.002 Test Acc: 0.825
Validation loss decreased (-0.624989 --> -0.824990).  Saving model ...
Epoch: 11 cost time: 0.47205662727355957
Epoch: 11, Steps: 3 | Train Loss: 0.827 Vali Loss: 0.939 Vali Acc: 0.875 Test Loss: 0.939 Test Acc: 0.875
Validation loss decreased (-0.824990 --> -0.874991).  Saving model ...
Epoch: 12 cost time: 0.4730265140533447
Epoch: 12, Steps: 3 | Train Loss: 0.771 Vali Loss: 0.883 Vali Acc: 0.875 Test Loss: 0.883 Test Acc: 0.875
Validation loss decreased (-0.874991 --> -0.874991).  Saving model ...
Epoch: 13 cost time: 0.4820547103881836
Epoch: 13, Steps: 3 | Train Loss: 0.727 Vali Loss: 0.822 Vali Acc: 0.900 Test Loss: 0.822 Test Acc: 0.900
Validation loss decreased (-0.874991 --> -0.899992).  Saving model ...
Epoch: 14 cost time: 0.4833693504333496
Epoch: 14, Steps: 3 | Train Loss: 0.642 Vali Loss: 0.770 Vali Acc: 0.900 Test Loss: 0.770 Test Acc: 0.900
Validation loss decreased (-0.899992 --> -0.899992).  Saving model ...
Epoch: 15 cost time: 0.4243357181549072
Epoch: 15, Steps: 3 | Train Loss: 0.606 Vali Loss: 0.718 Vali Acc: 0.875 Test Loss: 0.718 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.41326165199279785
Epoch: 16, Steps: 3 | Train Loss: 0.538 Vali Loss: 0.675 Vali Acc: 0.875 Test Loss: 0.675 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.471982479095459
Epoch: 17, Steps: 3 | Train Loss: 0.515 Vali Loss: 0.633 Vali Acc: 0.875 Test Loss: 0.633 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.47336769104003906
Epoch: 18, Steps: 3 | Train Loss: 0.453 Vali Loss: 0.597 Vali Acc: 0.925 Test Loss: 0.597 Test Acc: 0.925
Validation loss decreased (-0.899992 --> -0.924994).  Saving model ...
Epoch: 19 cost time: 0.4633638858795166
Epoch: 19, Steps: 3 | Train Loss: 0.406 Vali Loss: 0.562 Vali Acc: 0.975 Test Loss: 0.562 Test Acc: 0.975
Validation loss decreased (-0.924994 --> -0.974994).  Saving model ...
Epoch: 20 cost time: 0.5335092544555664
Epoch: 20, Steps: 3 | Train Loss: 0.387 Vali Loss: 0.523 Vali Acc: 0.975 Test Loss: 0.523 Test Acc: 0.975
Validation loss decreased (-0.974994 --> -0.974995).  Saving model ...
Epoch: 21 cost time: 0.42533421516418457
Epoch: 21, Steps: 3 | Train Loss: 0.368 Vali Loss: 0.503 Vali Acc: 0.975 Test Loss: 0.503 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 22 cost time: 0.47461414337158203
Epoch: 22, Steps: 3 | Train Loss: 0.343 Vali Loss: 0.472 Vali Acc: 0.975 Test Loss: 0.472 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 23 cost time: 0.42611002922058105
Epoch: 23, Steps: 3 | Train Loss: 0.320 Vali Loss: 0.457 Vali Acc: 0.950 Test Loss: 0.457 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.4760310649871826
Epoch: 24, Steps: 3 | Train Loss: 0.290 Vali Loss: 0.422 Vali Acc: 0.950 Test Loss: 0.422 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.3850381374359131
Epoch: 25, Steps: 3 | Train Loss: 0.273 Vali Loss: 0.401 Vali Acc: 0.950 Test Loss: 0.401 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.4182157516479492
Epoch: 26, Steps: 3 | Train Loss: 0.252 Vali Loss: 0.379 Vali Acc: 0.975 Test Loss: 0.379 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 27 cost time: 0.4328596591949463
Epoch: 27, Steps: 3 | Train Loss: 0.228 Vali Loss: 0.357 Vali Acc: 0.975 Test Loss: 0.357 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 28 cost time: 0.4245738983154297
Epoch: 28, Steps: 3 | Train Loss: 0.217 Vali Loss: 0.339 Vali Acc: 0.975 Test Loss: 0.339 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 29 cost time: 0.4904937744140625
Epoch: 29, Steps: 3 | Train Loss: 0.221 Vali Loss: 0.322 Vali Acc: 0.975 Test Loss: 0.322 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 30 cost time: 0.4793424606323242
Epoch: 30, Steps: 3 | Train Loss: 0.209 Vali Loss: 0.309 Vali Acc: 0.975 Test Loss: 0.309 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 31 cost time: 0.42592954635620117
Epoch: 31, Steps: 3 | Train Loss: 0.202 Vali Loss: 0.295 Vali Acc: 0.975 Test Loss: 0.295 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 32 cost time: 0.4184894561767578
Epoch: 32, Steps: 3 | Train Loss: 0.174 Vali Loss: 0.291 Vali Acc: 0.975 Test Loss: 0.291 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 33 cost time: 0.4486675262451172
Epoch: 33, Steps: 3 | Train Loss: 0.189 Vali Loss: 0.277 Vali Acc: 0.975 Test Loss: 0.277 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 34 cost time: 0.5102272033691406
Epoch: 34, Steps: 3 | Train Loss: 0.149 Vali Loss: 0.266 Vali Acc: 0.975 Test Loss: 0.266 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 35 cost time: 0.6964054107666016
Epoch: 35, Steps: 3 | Train Loss: 0.145 Vali Loss: 0.266 Vali Acc: 0.975 Test Loss: 0.266 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 36 cost time: 0.43698668479919434
Epoch: 36, Steps: 3 | Train Loss: 0.128 Vali Loss: 0.255 Vali Acc: 0.975 Test Loss: 0.255 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 37 cost time: 0.45899438858032227
Epoch: 37, Steps: 3 | Train Loss: 0.116 Vali Loss: 0.245 Vali Acc: 0.975 Test Loss: 0.245 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 38 cost time: 0.46033287048339844
Epoch: 38, Steps: 3 | Train Loss: 0.113 Vali Loss: 0.235 Vali Acc: 0.975 Test Loss: 0.235 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 39 cost time: 0.43741679191589355
Epoch: 39, Steps: 3 | Train Loss: 0.125 Vali Loss: 0.234 Vali Acc: 0.975 Test Loss: 0.234 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 40 cost time: 0.4404168128967285
Epoch: 40, Steps: 3 | Train Loss: 0.100 Vali Loss: 0.227 Vali Acc: 0.975 Test Loss: 0.227 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 41 cost time: 0.45859742164611816
Epoch: 41, Steps: 3 | Train Loss: 0.109 Vali Loss: 0.231 Vali Acc: 0.950 Test Loss: 0.231 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.4104123115539551
Epoch: 42, Steps: 3 | Train Loss: 0.098 Vali Loss: 0.224 Vali Acc: 0.950 Test Loss: 0.224 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.5483207702636719
Epoch: 43, Steps: 3 | Train Loss: 0.087 Vali Loss: 0.215 Vali Acc: 0.950 Test Loss: 0.215 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.5277259349822998
Epoch: 44, Steps: 3 | Train Loss: 0.082 Vali Loss: 0.213 Vali Acc: 0.950 Test Loss: 0.213 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.47095823287963867
Epoch: 45, Steps: 3 | Train Loss: 0.070 Vali Loss: 0.206 Vali Acc: 0.950 Test Loss: 0.206 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.4434819221496582
Epoch: 46, Steps: 3 | Train Loss: 0.071 Vali Loss: 0.206 Vali Acc: 0.950 Test Loss: 0.206 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.5048489570617676
Epoch: 47, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.198 Vali Acc: 0.950 Test Loss: 0.198 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 0.4833548069000244
Epoch: 48, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.190 Vali Acc: 0.950 Test Loss: 0.190 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 0.4765446186065674
Epoch: 49, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.194 Vali Acc: 0.950 Test Loss: 0.194 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 0.48470520973205566
Epoch: 50, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.200 Vali Acc: 0.950 Test Loss: 0.200 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 177572
model size : 0.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.5249855518341064
Epoch: 1, Steps: 3 | Train Loss: 1.423 Vali Loss: 1.425 Vali Acc: 0.300 Test Loss: 1.425 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 0.39681458473205566
Epoch: 2, Steps: 3 | Train Loss: 1.415 Vali Loss: 1.406 Vali Acc: 0.325 Test Loss: 1.406 Test Acc: 0.325
Validation loss decreased (-0.299986 --> -0.324986).  Saving model ...
Epoch: 3 cost time: 0.38161396980285645
Epoch: 3, Steps: 3 | Train Loss: 1.391 Vali Loss: 1.385 Vali Acc: 0.350 Test Loss: 1.385 Test Acc: 0.350
Validation loss decreased (-0.324986 --> -0.349986).  Saving model ...
Epoch: 4 cost time: 0.4153714179992676
Epoch: 4, Steps: 3 | Train Loss: 1.332 Vali Loss: 1.354 Vali Acc: 0.400 Test Loss: 1.354 Test Acc: 0.400
Validation loss decreased (-0.349986 --> -0.399986).  Saving model ...
Epoch: 5 cost time: 0.511080265045166
Epoch: 5, Steps: 3 | Train Loss: 1.303 Vali Loss: 1.316 Vali Acc: 0.425 Test Loss: 1.316 Test Acc: 0.425
Validation loss decreased (-0.399986 --> -0.424987).  Saving model ...
Epoch: 6 cost time: 0.4945995807647705
Epoch: 6, Steps: 3 | Train Loss: 1.258 Vali Loss: 1.271 Vali Acc: 0.475 Test Loss: 1.271 Test Acc: 0.475
Validation loss decreased (-0.424987 --> -0.474987).  Saving model ...
Epoch: 7 cost time: 0.43253087997436523
Epoch: 7, Steps: 3 | Train Loss: 1.183 Vali Loss: 1.228 Vali Acc: 0.525 Test Loss: 1.228 Test Acc: 0.525
Validation loss decreased (-0.474987 --> -0.524988).  Saving model ...
Epoch: 8 cost time: 0.4478268623352051
Epoch: 8, Steps: 3 | Train Loss: 1.135 Vali Loss: 1.174 Vali Acc: 0.625 Test Loss: 1.174 Test Acc: 0.625
Validation loss decreased (-0.524988 --> -0.624988).  Saving model ...
Epoch: 9 cost time: 0.4036557674407959
Epoch: 9, Steps: 3 | Train Loss: 1.072 Vali Loss: 1.116 Vali Acc: 0.625 Test Loss: 1.116 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624989).  Saving model ...
Epoch: 10 cost time: 0.5302345752716064
Epoch: 10, Steps: 3 | Train Loss: 1.011 Vali Loss: 1.065 Vali Acc: 0.725 Test Loss: 1.065 Test Acc: 0.725
Validation loss decreased (-0.624989 --> -0.724989).  Saving model ...
Epoch: 11 cost time: 0.39495110511779785
Epoch: 11, Steps: 3 | Train Loss: 0.941 Vali Loss: 1.016 Vali Acc: 0.725 Test Loss: 1.016 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724990).  Saving model ...
Epoch: 12 cost time: 0.43517470359802246
Epoch: 12, Steps: 3 | Train Loss: 0.894 Vali Loss: 0.962 Vali Acc: 0.675 Test Loss: 0.962 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.42885708808898926
Epoch: 13, Steps: 3 | Train Loss: 0.834 Vali Loss: 0.910 Vali Acc: 0.725 Test Loss: 0.910 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724991).  Saving model ...
Epoch: 14 cost time: 0.4486212730407715
Epoch: 14, Steps: 3 | Train Loss: 0.778 Vali Loss: 0.857 Vali Acc: 0.825 Test Loss: 0.857 Test Acc: 0.825
Validation loss decreased (-0.724991 --> -0.824991).  Saving model ...
Epoch: 15 cost time: 0.42239880561828613
Epoch: 15, Steps: 3 | Train Loss: 0.726 Vali Loss: 0.812 Vali Acc: 0.825 Test Loss: 0.812 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824992).  Saving model ...
Epoch: 16 cost time: 0.4435851573944092
Epoch: 16, Steps: 3 | Train Loss: 0.682 Vali Loss: 0.768 Vali Acc: 0.850 Test Loss: 0.768 Test Acc: 0.850
Validation loss decreased (-0.824992 --> -0.849992).  Saving model ...
Epoch: 17 cost time: 0.45600438117980957
Epoch: 17, Steps: 3 | Train Loss: 0.624 Vali Loss: 0.741 Vali Acc: 0.925 Test Loss: 0.741 Test Acc: 0.925
Validation loss decreased (-0.849992 --> -0.924993).  Saving model ...
Epoch: 18 cost time: 0.502368688583374
Epoch: 18, Steps: 3 | Train Loss: 0.600 Vali Loss: 0.713 Vali Acc: 0.925 Test Loss: 0.713 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924993).  Saving model ...
Epoch: 19 cost time: 0.45931434631347656
Epoch: 19, Steps: 3 | Train Loss: 0.560 Vali Loss: 0.670 Vali Acc: 0.925 Test Loss: 0.670 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924993).  Saving model ...
Epoch: 20 cost time: 0.4747498035430908
Epoch: 20, Steps: 3 | Train Loss: 0.516 Vali Loss: 0.640 Vali Acc: 0.950 Test Loss: 0.640 Test Acc: 0.950
Validation loss decreased (-0.924993 --> -0.949994).  Saving model ...
Epoch: 21 cost time: 0.4601128101348877
Epoch: 21, Steps: 3 | Train Loss: 0.477 Vali Loss: 0.608 Vali Acc: 0.950 Test Loss: 0.608 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949994).  Saving model ...
Epoch: 22 cost time: 0.4007890224456787
Epoch: 22, Steps: 3 | Train Loss: 0.448 Vali Loss: 0.581 Vali Acc: 0.950 Test Loss: 0.581 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949994).  Saving model ...
Epoch: 23 cost time: 0.43863463401794434
Epoch: 23, Steps: 3 | Train Loss: 0.453 Vali Loss: 0.545 Vali Acc: 0.950 Test Loss: 0.545 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 24 cost time: 0.43613696098327637
Epoch: 24, Steps: 3 | Train Loss: 0.403 Vali Loss: 0.516 Vali Acc: 0.950 Test Loss: 0.516 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 25 cost time: 0.45435309410095215
Epoch: 25, Steps: 3 | Train Loss: 0.373 Vali Loss: 0.491 Vali Acc: 0.950 Test Loss: 0.491 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 26 cost time: 0.4885556697845459
Epoch: 26, Steps: 3 | Train Loss: 0.371 Vali Loss: 0.478 Vali Acc: 0.950 Test Loss: 0.478 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 27 cost time: 0.5291469097137451
Epoch: 27, Steps: 3 | Train Loss: 0.349 Vali Loss: 0.460 Vali Acc: 0.950 Test Loss: 0.460 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 28 cost time: 0.44875597953796387
Epoch: 28, Steps: 3 | Train Loss: 0.327 Vali Loss: 0.440 Vali Acc: 0.950 Test Loss: 0.440 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 29 cost time: 0.4499084949493408
Epoch: 29, Steps: 3 | Train Loss: 0.298 Vali Loss: 0.419 Vali Acc: 0.950 Test Loss: 0.419 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 30 cost time: 0.48693418502807617
Epoch: 30, Steps: 3 | Train Loss: 0.294 Vali Loss: 0.403 Vali Acc: 0.950 Test Loss: 0.403 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 31 cost time: 0.4794292449951172
Epoch: 31, Steps: 3 | Train Loss: 0.288 Vali Loss: 0.384 Vali Acc: 0.975 Test Loss: 0.384 Test Acc: 0.975
Validation loss decreased (-0.949996 --> -0.974996).  Saving model ...
Epoch: 32 cost time: 0.4380044937133789
Epoch: 32, Steps: 3 | Train Loss: 0.261 Vali Loss: 0.369 Vali Acc: 0.975 Test Loss: 0.369 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 33 cost time: 0.4192392826080322
Epoch: 33, Steps: 3 | Train Loss: 0.280 Vali Loss: 0.347 Vali Acc: 0.975 Test Loss: 0.347 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 34 cost time: 0.3727855682373047
Epoch: 34, Steps: 3 | Train Loss: 0.250 Vali Loss: 0.331 Vali Acc: 0.975 Test Loss: 0.331 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 35 cost time: 0.5221774578094482
Epoch: 35, Steps: 3 | Train Loss: 0.222 Vali Loss: 0.320 Vali Acc: 0.975 Test Loss: 0.320 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 36 cost time: 0.5049397945404053
Epoch: 36, Steps: 3 | Train Loss: 0.214 Vali Loss: 0.308 Vali Acc: 0.975 Test Loss: 0.308 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 37 cost time: 0.3955209255218506
Epoch: 37, Steps: 3 | Train Loss: 0.220 Vali Loss: 0.303 Vali Acc: 0.975 Test Loss: 0.303 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 38 cost time: 0.3817179203033447
Epoch: 38, Steps: 3 | Train Loss: 0.188 Vali Loss: 0.298 Vali Acc: 0.975 Test Loss: 0.298 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 39 cost time: 0.3849184513092041
Epoch: 39, Steps: 3 | Train Loss: 0.192 Vali Loss: 0.294 Vali Acc: 0.975 Test Loss: 0.294 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 40 cost time: 0.3857076168060303
Epoch: 40, Steps: 3 | Train Loss: 0.183 Vali Loss: 0.278 Vali Acc: 0.975 Test Loss: 0.278 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 41 cost time: 0.4899172782897949
Epoch: 41, Steps: 3 | Train Loss: 0.167 Vali Loss: 0.278 Vali Acc: 0.975 Test Loss: 0.278 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.4482405185699463
Epoch: 42, Steps: 3 | Train Loss: 0.161 Vali Loss: 0.275 Vali Acc: 0.975 Test Loss: 0.275 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 43 cost time: 0.41994714736938477
Epoch: 43, Steps: 3 | Train Loss: 0.142 Vali Loss: 0.264 Vali Acc: 0.975 Test Loss: 0.264 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 44 cost time: 0.4737889766693115
Epoch: 44, Steps: 3 | Train Loss: 0.136 Vali Loss: 0.249 Vali Acc: 0.975 Test Loss: 0.249 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 45 cost time: 0.4812784194946289
Epoch: 45, Steps: 3 | Train Loss: 0.152 Vali Loss: 0.243 Vali Acc: 0.975 Test Loss: 0.243 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 46 cost time: 0.465742826461792
Epoch: 46, Steps: 3 | Train Loss: 0.135 Vali Loss: 0.234 Vali Acc: 0.975 Test Loss: 0.234 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 47 cost time: 0.4447035789489746
Epoch: 47, Steps: 3 | Train Loss: 0.131 Vali Loss: 0.227 Vali Acc: 0.975 Test Loss: 0.227 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 48 cost time: 0.43832898139953613
Epoch: 48, Steps: 3 | Train Loss: 0.118 Vali Loss: 0.218 Vali Acc: 0.975 Test Loss: 0.218 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 49 cost time: 0.43944787979125977
Epoch: 49, Steps: 3 | Train Loss: 0.109 Vali Loss: 0.212 Vali Acc: 0.975 Test Loss: 0.212 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 50 cost time: 0.49591517448425293
Epoch: 50, Steps: 3 | Train Loss: 0.105 Vali Loss: 0.207 Vali Acc: 0.975 Test Loss: 0.207 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 173028
model size : 0.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.6028673648834229
Epoch: 1, Steps: 3 | Train Loss: 1.493 Vali Loss: 1.427 Vali Acc: 0.500 Test Loss: 1.427 Test Acc: 0.500
Validation loss decreased (inf --> -0.499986).  Saving model ...
Epoch: 2 cost time: 0.36933302879333496
Epoch: 2, Steps: 3 | Train Loss: 1.428 Vali Loss: 1.421 Vali Acc: 0.475 Test Loss: 1.421 Test Acc: 0.475
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.40018606185913086
Epoch: 3, Steps: 3 | Train Loss: 1.457 Vali Loss: 1.411 Vali Acc: 0.475 Test Loss: 1.411 Test Acc: 0.475
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.4236605167388916
Epoch: 4, Steps: 3 | Train Loss: 1.413 Vali Loss: 1.395 Vali Acc: 0.450 Test Loss: 1.395 Test Acc: 0.450
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.3978443145751953
Epoch: 5, Steps: 3 | Train Loss: 1.371 Vali Loss: 1.372 Vali Acc: 0.450 Test Loss: 1.372 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.38688015937805176
Epoch: 6, Steps: 3 | Train Loss: 1.348 Vali Loss: 1.342 Vali Acc: 0.600 Test Loss: 1.342 Test Acc: 0.600
Validation loss decreased (-0.499986 --> -0.599987).  Saving model ...
Epoch: 7 cost time: 0.3829474449157715
Epoch: 7, Steps: 3 | Train Loss: 1.264 Vali Loss: 1.306 Vali Acc: 0.650 Test Loss: 1.306 Test Acc: 0.650
Validation loss decreased (-0.599987 --> -0.649987).  Saving model ...
Epoch: 8 cost time: 0.5042665004730225
Epoch: 8, Steps: 3 | Train Loss: 1.228 Vali Loss: 1.268 Vali Acc: 0.750 Test Loss: 1.268 Test Acc: 0.750
Validation loss decreased (-0.649987 --> -0.749987).  Saving model ...
Epoch: 9 cost time: 0.4462876319885254
Epoch: 9, Steps: 3 | Train Loss: 1.181 Vali Loss: 1.231 Vali Acc: 0.750 Test Loss: 1.231 Test Acc: 0.750
Validation loss decreased (-0.749987 --> -0.749988).  Saving model ...
Epoch: 10 cost time: 0.3907768726348877
Epoch: 10, Steps: 3 | Train Loss: 1.127 Vali Loss: 1.188 Vali Acc: 0.825 Test Loss: 1.188 Test Acc: 0.825
Validation loss decreased (-0.749988 --> -0.824988).  Saving model ...
Epoch: 11 cost time: 0.408414363861084
Epoch: 11, Steps: 3 | Train Loss: 1.082 Vali Loss: 1.146 Vali Acc: 0.850 Test Loss: 1.146 Test Acc: 0.850
Validation loss decreased (-0.824988 --> -0.849989).  Saving model ...
Epoch: 12 cost time: 0.3867523670196533
Epoch: 12, Steps: 3 | Train Loss: 1.015 Vali Loss: 1.100 Vali Acc: 0.925 Test Loss: 1.100 Test Acc: 0.925
Validation loss decreased (-0.849989 --> -0.924989).  Saving model ...
Epoch: 13 cost time: 0.4629027843475342
Epoch: 13, Steps: 3 | Train Loss: 0.988 Vali Loss: 1.055 Vali Acc: 0.925 Test Loss: 1.055 Test Acc: 0.925
Validation loss decreased (-0.924989 --> -0.924989).  Saving model ...
Epoch: 14 cost time: 0.4264976978302002
Epoch: 14, Steps: 3 | Train Loss: 0.920 Vali Loss: 1.013 Vali Acc: 0.925 Test Loss: 1.013 Test Acc: 0.925
Validation loss decreased (-0.924989 --> -0.924990).  Saving model ...
Epoch: 15 cost time: 0.4251713752746582
Epoch: 15, Steps: 3 | Train Loss: 0.874 Vali Loss: 0.972 Vali Acc: 0.975 Test Loss: 0.972 Test Acc: 0.975
Validation loss decreased (-0.924990 --> -0.974990).  Saving model ...
Epoch: 16 cost time: 0.4099881649017334
Epoch: 16, Steps: 3 | Train Loss: 0.856 Vali Loss: 0.928 Vali Acc: 0.950 Test Loss: 0.928 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.4124326705932617
Epoch: 17, Steps: 3 | Train Loss: 0.795 Vali Loss: 0.890 Vali Acc: 0.950 Test Loss: 0.890 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.47546935081481934
Epoch: 18, Steps: 3 | Train Loss: 0.767 Vali Loss: 0.857 Vali Acc: 0.950 Test Loss: 0.857 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.4971449375152588
Epoch: 19, Steps: 3 | Train Loss: 0.697 Vali Loss: 0.823 Vali Acc: 0.950 Test Loss: 0.823 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.4148702621459961
Epoch: 20, Steps: 3 | Train Loss: 0.679 Vali Loss: 0.780 Vali Acc: 0.950 Test Loss: 0.780 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.35575056076049805
Epoch: 21, Steps: 3 | Train Loss: 0.629 Vali Loss: 0.749 Vali Acc: 0.950 Test Loss: 0.749 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.4658336639404297
Epoch: 22, Steps: 3 | Train Loss: 0.603 Vali Loss: 0.727 Vali Acc: 0.950 Test Loss: 0.727 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.4050784111022949
Epoch: 23, Steps: 3 | Train Loss: 0.581 Vali Loss: 0.705 Vali Acc: 0.950 Test Loss: 0.705 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.4009730815887451
Epoch: 24, Steps: 3 | Train Loss: 0.559 Vali Loss: 0.690 Vali Acc: 0.950 Test Loss: 0.690 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.44016289710998535
Epoch: 25, Steps: 3 | Train Loss: 0.522 Vali Loss: 0.655 Vali Acc: 0.950 Test Loss: 0.655 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 167044
model size : 0.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps20_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.6587650775909424
Epoch: 1, Steps: 3 | Train Loss: 1.407 Vali Loss: 1.412 Vali Acc: 0.200 Test Loss: 1.412 Test Acc: 0.200
Validation loss decreased (inf --> -0.199986).  Saving model ...
Epoch: 2 cost time: 0.3729543685913086
Epoch: 2, Steps: 3 | Train Loss: 1.341 Vali Loss: 1.405 Vali Acc: 0.200 Test Loss: 1.405 Test Acc: 0.200
Validation loss decreased (-0.199986 --> -0.199986).  Saving model ...
Epoch: 3 cost time: 0.43738317489624023
Epoch: 3, Steps: 3 | Train Loss: 1.345 Vali Loss: 1.398 Vali Acc: 0.225 Test Loss: 1.398 Test Acc: 0.225
Validation loss decreased (-0.199986 --> -0.224986).  Saving model ...
Epoch: 4 cost time: 0.3770930767059326
Epoch: 4, Steps: 3 | Train Loss: 1.344 Vali Loss: 1.385 Vali Acc: 0.250 Test Loss: 1.385 Test Acc: 0.250
Validation loss decreased (-0.224986 --> -0.249986).  Saving model ...
Epoch: 5 cost time: 0.415865421295166
Epoch: 5, Steps: 3 | Train Loss: 1.276 Vali Loss: 1.365 Vali Acc: 0.300 Test Loss: 1.365 Test Acc: 0.300
Validation loss decreased (-0.249986 --> -0.299986).  Saving model ...
Epoch: 6 cost time: 0.40671706199645996
Epoch: 6, Steps: 3 | Train Loss: 1.229 Vali Loss: 1.340 Vali Acc: 0.350 Test Loss: 1.340 Test Acc: 0.350
Validation loss decreased (-0.299986 --> -0.349987).  Saving model ...
Epoch: 7 cost time: 0.39516186714172363
Epoch: 7, Steps: 3 | Train Loss: 1.208 Vali Loss: 1.311 Vali Acc: 0.425 Test Loss: 1.311 Test Acc: 0.425
Validation loss decreased (-0.349987 --> -0.424987).  Saving model ...
Epoch: 8 cost time: 0.4567606449127197
Epoch: 8, Steps: 3 | Train Loss: 1.162 Vali Loss: 1.279 Vali Acc: 0.475 Test Loss: 1.279 Test Acc: 0.475
Validation loss decreased (-0.424987 --> -0.474987).  Saving model ...
Epoch: 9 cost time: 0.5034265518188477
Epoch: 9, Steps: 3 | Train Loss: 1.154 Vali Loss: 1.243 Vali Acc: 0.575 Test Loss: 1.243 Test Acc: 0.575
Validation loss decreased (-0.474987 --> -0.574988).  Saving model ...
Epoch: 10 cost time: 0.39974403381347656
Epoch: 10, Steps: 3 | Train Loss: 1.095 Vali Loss: 1.209 Vali Acc: 0.625 Test Loss: 1.209 Test Acc: 0.625
Validation loss decreased (-0.574988 --> -0.624988).  Saving model ...
Epoch: 11 cost time: 0.4165949821472168
Epoch: 11, Steps: 3 | Train Loss: 1.055 Vali Loss: 1.174 Vali Acc: 0.675 Test Loss: 1.174 Test Acc: 0.675
Validation loss decreased (-0.624988 --> -0.674988).  Saving model ...
Epoch: 12 cost time: 0.3843257427215576
Epoch: 12, Steps: 3 | Train Loss: 1.014 Vali Loss: 1.136 Vali Acc: 0.700 Test Loss: 1.136 Test Acc: 0.700
Validation loss decreased (-0.674988 --> -0.699989).  Saving model ...
Epoch: 13 cost time: 0.43925952911376953
Epoch: 13, Steps: 3 | Train Loss: 0.983 Vali Loss: 1.096 Vali Acc: 0.775 Test Loss: 1.096 Test Acc: 0.775
Validation loss decreased (-0.699989 --> -0.774989).  Saving model ...
Epoch: 14 cost time: 0.41864633560180664
Epoch: 14, Steps: 3 | Train Loss: 0.913 Vali Loss: 1.060 Vali Acc: 0.775 Test Loss: 1.060 Test Acc: 0.775
Validation loss decreased (-0.774989 --> -0.774989).  Saving model ...
Epoch: 15 cost time: 0.4540586471557617
Epoch: 15, Steps: 3 | Train Loss: 0.887 Vali Loss: 1.021 Vali Acc: 0.775 Test Loss: 1.021 Test Acc: 0.775
Validation loss decreased (-0.774989 --> -0.774990).  Saving model ...
Epoch: 16 cost time: 0.4186277389526367
Epoch: 16, Steps: 3 | Train Loss: 0.855 Vali Loss: 0.987 Vali Acc: 0.750 Test Loss: 0.987 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.3952627182006836
Epoch: 17, Steps: 3 | Train Loss: 0.816 Vali Loss: 0.956 Vali Acc: 0.800 Test Loss: 0.956 Test Acc: 0.800
Validation loss decreased (-0.774990 --> -0.799990).  Saving model ...
Epoch: 18 cost time: 0.41538381576538086
Epoch: 18, Steps: 3 | Train Loss: 0.788 Vali Loss: 0.926 Vali Acc: 0.825 Test Loss: 0.926 Test Acc: 0.825
Validation loss decreased (-0.799990 --> -0.824991).  Saving model ...
Epoch: 19 cost time: 0.40451622009277344
Epoch: 19, Steps: 3 | Train Loss: 0.733 Vali Loss: 0.898 Vali Acc: 0.850 Test Loss: 0.898 Test Acc: 0.850
Validation loss decreased (-0.824991 --> -0.849991).  Saving model ...
Epoch: 20 cost time: 0.43643712997436523
Epoch: 20, Steps: 3 | Train Loss: 0.695 Vali Loss: 0.873 Vali Acc: 0.850 Test Loss: 0.873 Test Acc: 0.850
Validation loss decreased (-0.849991 --> -0.849991).  Saving model ...
Epoch: 21 cost time: 0.407362699508667
Epoch: 21, Steps: 3 | Train Loss: 0.692 Vali Loss: 0.851 Vali Acc: 0.875 Test Loss: 0.851 Test Acc: 0.875
Validation loss decreased (-0.849991 --> -0.874991).  Saving model ...
Epoch: 22 cost time: 0.4004397392272949
Epoch: 22, Steps: 3 | Train Loss: 0.650 Vali Loss: 0.827 Vali Acc: 0.875 Test Loss: 0.827 Test Acc: 0.875
Validation loss decreased (-0.874991 --> -0.874992).  Saving model ...
Epoch: 23 cost time: 0.3956437110900879
Epoch: 23, Steps: 3 | Train Loss: 0.637 Vali Loss: 0.798 Vali Acc: 0.875 Test Loss: 0.798 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874992).  Saving model ...
Epoch: 24 cost time: 0.40988922119140625
Epoch: 24, Steps: 3 | Train Loss: 0.605 Vali Loss: 0.777 Vali Acc: 0.875 Test Loss: 0.777 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874992).  Saving model ...
Epoch: 25 cost time: 0.41166043281555176
Epoch: 25, Steps: 3 | Train Loss: 0.560 Vali Loss: 0.756 Vali Acc: 0.875 Test Loss: 0.756 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874992).  Saving model ...
Epoch: 26 cost time: 0.3907146453857422
Epoch: 26, Steps: 3 | Train Loss: 0.547 Vali Loss: 0.724 Vali Acc: 0.875 Test Loss: 0.724 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874993).  Saving model ...
Epoch: 27 cost time: 0.38353729248046875
Epoch: 27, Steps: 3 | Train Loss: 0.554 Vali Loss: 0.708 Vali Acc: 0.850 Test Loss: 0.708 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.4419536590576172
Epoch: 28, Steps: 3 | Train Loss: 0.519 Vali Loss: 0.688 Vali Acc: 0.850 Test Loss: 0.688 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.41176271438598633
Epoch: 29, Steps: 3 | Train Loss: 0.469 Vali Loss: 0.662 Vali Acc: 0.850 Test Loss: 0.662 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.44577836990356445
Epoch: 30, Steps: 3 | Train Loss: 0.447 Vali Loss: 0.644 Vali Acc: 0.850 Test Loss: 0.644 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.45174312591552734
Epoch: 31, Steps: 3 | Train Loss: 0.444 Vali Loss: 0.618 Vali Acc: 0.850 Test Loss: 0.618 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.409534215927124
Epoch: 32, Steps: 3 | Train Loss: 0.451 Vali Loss: 0.606 Vali Acc: 0.850 Test Loss: 0.606 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.4109840393066406
Epoch: 33, Steps: 3 | Train Loss: 0.411 Vali Loss: 0.594 Vali Acc: 0.850 Test Loss: 0.594 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.40428733825683594
Epoch: 34, Steps: 3 | Train Loss: 0.397 Vali Loss: 0.575 Vali Acc: 0.850 Test Loss: 0.575 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.39456629753112793
Epoch: 35, Steps: 3 | Train Loss: 0.380 Vali Loss: 0.558 Vali Acc: 0.850 Test Loss: 0.558 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.43259310722351074
Epoch: 36, Steps: 3 | Train Loss: 0.358 Vali Loss: 0.536 Vali Acc: 0.850 Test Loss: 0.536 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps20_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.875
model parameter : 165668
model size : 0.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps25_str13_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.5885753631591797
Epoch: 1, Steps: 3 | Train Loss: 1.454 Vali Loss: 1.444 Vali Acc: 0.250 Test Loss: 1.444 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 0.42850780487060547
Epoch: 2, Steps: 3 | Train Loss: 1.437 Vali Loss: 1.439 Vali Acc: 0.275 Test Loss: 1.439 Test Acc: 0.275
Validation loss decreased (-0.249986 --> -0.274986).  Saving model ...
Epoch: 3 cost time: 0.4502732753753662
Epoch: 3, Steps: 3 | Train Loss: 1.419 Vali Loss: 1.435 Vali Acc: 0.300 Test Loss: 1.435 Test Acc: 0.300
Validation loss decreased (-0.274986 --> -0.299986).  Saving model ...
Epoch: 4 cost time: 0.4572622776031494
Epoch: 4, Steps: 3 | Train Loss: 1.395 Vali Loss: 1.426 Vali Acc: 0.300 Test Loss: 1.426 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299986).  Saving model ...
Epoch: 5 cost time: 0.43430280685424805
Epoch: 5, Steps: 3 | Train Loss: 1.355 Vali Loss: 1.411 Vali Acc: 0.300 Test Loss: 1.411 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299986).  Saving model ...
Epoch: 6 cost time: 0.4417891502380371
Epoch: 6, Steps: 3 | Train Loss: 1.328 Vali Loss: 1.393 Vali Acc: 0.350 Test Loss: 1.393 Test Acc: 0.350
Validation loss decreased (-0.299986 --> -0.349986).  Saving model ...
Epoch: 7 cost time: 0.45682215690612793
Epoch: 7, Steps: 3 | Train Loss: 1.318 Vali Loss: 1.370 Vali Acc: 0.400 Test Loss: 1.370 Test Acc: 0.400
Validation loss decreased (-0.349986 --> -0.399986).  Saving model ...
Epoch: 8 cost time: 0.46686339378356934
Epoch: 8, Steps: 3 | Train Loss: 1.258 Vali Loss: 1.343 Vali Acc: 0.450 Test Loss: 1.343 Test Acc: 0.450
Validation loss decreased (-0.399986 --> -0.449987).  Saving model ...
Epoch: 9 cost time: 0.4283616542816162
Epoch: 9, Steps: 3 | Train Loss: 1.255 Vali Loss: 1.313 Vali Acc: 0.450 Test Loss: 1.313 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449987).  Saving model ...
Epoch: 10 cost time: 0.4041268825531006
Epoch: 10, Steps: 3 | Train Loss: 1.210 Vali Loss: 1.283 Vali Acc: 0.525 Test Loss: 1.283 Test Acc: 0.525
Validation loss decreased (-0.449987 --> -0.524987).  Saving model ...
Epoch: 11 cost time: 0.4790313243865967
Epoch: 11, Steps: 3 | Train Loss: 1.139 Vali Loss: 1.255 Vali Acc: 0.525 Test Loss: 1.255 Test Acc: 0.525
Validation loss decreased (-0.524987 --> -0.524987).  Saving model ...
Epoch: 12 cost time: 0.4697575569152832
Epoch: 12, Steps: 3 | Train Loss: 1.111 Vali Loss: 1.223 Vali Acc: 0.575 Test Loss: 1.223 Test Acc: 0.575
Validation loss decreased (-0.524987 --> -0.574988).  Saving model ...
Epoch: 13 cost time: 0.451092004776001
Epoch: 13, Steps: 3 | Train Loss: 1.093 Vali Loss: 1.189 Vali Acc: 0.575 Test Loss: 1.189 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 14 cost time: 0.4593477249145508
Epoch: 14, Steps: 3 | Train Loss: 1.058 Vali Loss: 1.155 Vali Acc: 0.575 Test Loss: 1.155 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 15 cost time: 0.47467470169067383
Epoch: 15, Steps: 3 | Train Loss: 1.012 Vali Loss: 1.122 Vali Acc: 0.625 Test Loss: 1.122 Test Acc: 0.625
Validation loss decreased (-0.574988 --> -0.624989).  Saving model ...
Epoch: 16 cost time: 0.39851999282836914
Epoch: 16, Steps: 3 | Train Loss: 0.972 Vali Loss: 1.092 Vali Acc: 0.625 Test Loss: 1.092 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 17 cost time: 0.4064927101135254
Epoch: 17, Steps: 3 | Train Loss: 0.937 Vali Loss: 1.060 Vali Acc: 0.625 Test Loss: 1.060 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 18 cost time: 0.4219815731048584
Epoch: 18, Steps: 3 | Train Loss: 0.925 Vali Loss: 1.029 Vali Acc: 0.675 Test Loss: 1.029 Test Acc: 0.675
Validation loss decreased (-0.624989 --> -0.674990).  Saving model ...
Epoch: 19 cost time: 0.44620513916015625
Epoch: 19, Steps: 3 | Train Loss: 0.858 Vali Loss: 1.003 Vali Acc: 0.675 Test Loss: 1.003 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 20 cost time: 0.43021082878112793
Epoch: 20, Steps: 3 | Train Loss: 0.821 Vali Loss: 0.985 Vali Acc: 0.675 Test Loss: 0.985 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 21 cost time: 0.4371480941772461
Epoch: 21, Steps: 3 | Train Loss: 0.795 Vali Loss: 0.958 Vali Acc: 0.675 Test Loss: 0.958 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674990).  Saving model ...
Epoch: 22 cost time: 0.4578084945678711
Epoch: 22, Steps: 3 | Train Loss: 0.752 Vali Loss: 0.941 Vali Acc: 0.675 Test Loss: 0.941 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674991).  Saving model ...
Epoch: 23 cost time: 0.46061110496520996
Epoch: 23, Steps: 3 | Train Loss: 0.732 Vali Loss: 0.919 Vali Acc: 0.675 Test Loss: 0.919 Test Acc: 0.675
Validation loss decreased (-0.674991 --> -0.674991).  Saving model ...
Epoch: 24 cost time: 0.5218691825866699
Epoch: 24, Steps: 3 | Train Loss: 0.721 Vali Loss: 0.887 Vali Acc: 0.725 Test Loss: 0.887 Test Acc: 0.725
Validation loss decreased (-0.674991 --> -0.724991).  Saving model ...
Epoch: 25 cost time: 0.42796754837036133
Epoch: 25, Steps: 3 | Train Loss: 0.686 Vali Loss: 0.867 Vali Acc: 0.800 Test Loss: 0.867 Test Acc: 0.800
Validation loss decreased (-0.724991 --> -0.799991).  Saving model ...
Epoch: 26 cost time: 0.5286989212036133
Epoch: 26, Steps: 3 | Train Loss: 0.673 Vali Loss: 0.844 Vali Acc: 0.825 Test Loss: 0.844 Test Acc: 0.825
Validation loss decreased (-0.799991 --> -0.824992).  Saving model ...
Epoch: 27 cost time: 0.48038363456726074
Epoch: 27, Steps: 3 | Train Loss: 0.651 Vali Loss: 0.820 Vali Acc: 0.850 Test Loss: 0.820 Test Acc: 0.850
Validation loss decreased (-0.824992 --> -0.849992).  Saving model ...
Epoch: 28 cost time: 0.527775764465332
Epoch: 28, Steps: 3 | Train Loss: 0.606 Vali Loss: 0.790 Vali Acc: 0.875 Test Loss: 0.790 Test Acc: 0.875
Validation loss decreased (-0.849992 --> -0.874992).  Saving model ...
Epoch: 29 cost time: 0.47240161895751953
Epoch: 29, Steps: 3 | Train Loss: 0.602 Vali Loss: 0.772 Vali Acc: 0.900 Test Loss: 0.772 Test Acc: 0.900
Validation loss decreased (-0.874992 --> -0.899992).  Saving model ...
Epoch: 30 cost time: 0.5003602504730225
Epoch: 30, Steps: 3 | Train Loss: 0.575 Vali Loss: 0.749 Vali Acc: 0.900 Test Loss: 0.749 Test Acc: 0.900
Validation loss decreased (-0.899992 --> -0.899993).  Saving model ...
Epoch: 31 cost time: 0.4875221252441406
Epoch: 31, Steps: 3 | Train Loss: 0.550 Vali Loss: 0.717 Vali Acc: 0.900 Test Loss: 0.717 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 32 cost time: 0.4630115032196045
Epoch: 32, Steps: 3 | Train Loss: 0.535 Vali Loss: 0.694 Vali Acc: 0.900 Test Loss: 0.694 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 33 cost time: 0.41661977767944336
Epoch: 33, Steps: 3 | Train Loss: 0.502 Vali Loss: 0.668 Vali Acc: 0.900 Test Loss: 0.668 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 34 cost time: 0.4178791046142578
Epoch: 34, Steps: 3 | Train Loss: 0.497 Vali Loss: 0.650 Vali Acc: 0.900 Test Loss: 0.650 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899994).  Saving model ...
Epoch: 35 cost time: 0.4954257011413574
Epoch: 35, Steps: 3 | Train Loss: 0.472 Vali Loss: 0.635 Vali Acc: 0.900 Test Loss: 0.635 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 36 cost time: 0.43473267555236816
Epoch: 36, Steps: 3 | Train Loss: 0.430 Vali Loss: 0.610 Vali Acc: 0.900 Test Loss: 0.610 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 37 cost time: 0.359241247177124
Epoch: 37, Steps: 3 | Train Loss: 0.428 Vali Loss: 0.605 Vali Acc: 0.875 Test Loss: 0.605 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.476794958114624
Epoch: 38, Steps: 3 | Train Loss: 0.415 Vali Loss: 0.587 Vali Acc: 0.900 Test Loss: 0.587 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 39 cost time: 0.4023888111114502
Epoch: 39, Steps: 3 | Train Loss: 0.393 Vali Loss: 0.577 Vali Acc: 0.900 Test Loss: 0.577 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 40 cost time: 0.46689820289611816
Epoch: 40, Steps: 3 | Train Loss: 0.396 Vali Loss: 0.552 Vali Acc: 0.900 Test Loss: 0.552 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 41 cost time: 0.4532594680786133
Epoch: 41, Steps: 3 | Train Loss: 0.366 Vali Loss: 0.532 Vali Acc: 0.900 Test Loss: 0.532 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 42 cost time: 0.4319758415222168
Epoch: 42, Steps: 3 | Train Loss: 0.355 Vali Loss: 0.514 Vali Acc: 0.900 Test Loss: 0.514 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 43 cost time: 0.40709829330444336
Epoch: 43, Steps: 3 | Train Loss: 0.320 Vali Loss: 0.500 Vali Acc: 0.900 Test Loss: 0.500 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 44 cost time: 0.46591854095458984
Epoch: 44, Steps: 3 | Train Loss: 0.334 Vali Loss: 0.488 Vali Acc: 0.900 Test Loss: 0.488 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 45 cost time: 0.49175214767456055
Epoch: 45, Steps: 3 | Train Loss: 0.307 Vali Loss: 0.474 Vali Acc: 0.900 Test Loss: 0.474 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 46 cost time: 0.4664578437805176
Epoch: 46, Steps: 3 | Train Loss: 0.294 Vali Loss: 0.470 Vali Acc: 0.900 Test Loss: 0.470 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 47 cost time: 0.4880330562591553
Epoch: 47, Steps: 3 | Train Loss: 0.275 Vali Loss: 0.452 Vali Acc: 0.900 Test Loss: 0.452 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 48 cost time: 0.4487786293029785
Epoch: 48, Steps: 3 | Train Loss: 0.255 Vali Loss: 0.436 Vali Acc: 0.900 Test Loss: 0.436 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 49 cost time: 0.5053956508636475
Epoch: 49, Steps: 3 | Train Loss: 0.258 Vali Loss: 0.430 Vali Acc: 0.900 Test Loss: 0.430 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 50 cost time: 0.4682941436767578
Epoch: 50, Steps: 3 | Train Loss: 0.235 Vali Loss: 0.415 Vali Acc: 0.900 Test Loss: 0.415 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps25_str13_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 164292
model size : 0.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.7408413887023926
Epoch: 1, Steps: 3 | Train Loss: 1.407 Vali Loss: 1.335 Vali Acc: 0.475 Test Loss: 1.335 Test Acc: 0.475
Validation loss decreased (inf --> -0.474987).  Saving model ...
Epoch: 2 cost time: 0.5635547637939453
Epoch: 2, Steps: 3 | Train Loss: 1.291 Vali Loss: 1.272 Vali Acc: 0.600 Test Loss: 1.272 Test Acc: 0.600
Validation loss decreased (-0.474987 --> -0.599987).  Saving model ...
Epoch: 3 cost time: 0.48143506050109863
Epoch: 3, Steps: 3 | Train Loss: 1.127 Vali Loss: 1.139 Vali Acc: 0.700 Test Loss: 1.139 Test Acc: 0.700
Validation loss decreased (-0.599987 --> -0.699989).  Saving model ...
Epoch: 4 cost time: 0.6516234874725342
Epoch: 4, Steps: 3 | Train Loss: 0.896 Vali Loss: 0.980 Vali Acc: 0.825 Test Loss: 0.980 Test Acc: 0.825
Validation loss decreased (-0.699989 --> -0.824990).  Saving model ...
Epoch: 5 cost time: 0.5817675590515137
Epoch: 5, Steps: 3 | Train Loss: 0.694 Vali Loss: 0.814 Vali Acc: 0.825 Test Loss: 0.814 Test Acc: 0.825
Validation loss decreased (-0.824990 --> -0.824992).  Saving model ...
Epoch: 6 cost time: 0.6501598358154297
Epoch: 6, Steps: 3 | Train Loss: 0.526 Vali Loss: 0.663 Vali Acc: 0.925 Test Loss: 0.663 Test Acc: 0.925
Validation loss decreased (-0.824992 --> -0.924993).  Saving model ...
Epoch: 7 cost time: 0.4998304843902588
Epoch: 7, Steps: 3 | Train Loss: 0.405 Vali Loss: 0.529 Vali Acc: 0.950 Test Loss: 0.529 Test Acc: 0.950
Validation loss decreased (-0.924993 --> -0.949995).  Saving model ...
Epoch: 8 cost time: 0.5710792541503906
Epoch: 8, Steps: 3 | Train Loss: 0.306 Vali Loss: 0.438 Vali Acc: 0.925 Test Loss: 0.438 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5632834434509277
Epoch: 9, Steps: 3 | Train Loss: 0.275 Vali Loss: 0.363 Vali Acc: 0.925 Test Loss: 0.363 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.5887451171875
Epoch: 10, Steps: 3 | Train Loss: 0.205 Vali Loss: 0.314 Vali Acc: 0.950 Test Loss: 0.314 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949997).  Saving model ...
Epoch: 11 cost time: 0.48345232009887695
Epoch: 11, Steps: 3 | Train Loss: 0.174 Vali Loss: 0.276 Vali Acc: 0.950 Test Loss: 0.276 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 12 cost time: 0.5806329250335693
Epoch: 12, Steps: 3 | Train Loss: 0.124 Vali Loss: 0.246 Vali Acc: 0.950 Test Loss: 0.246 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 13 cost time: 0.5356786251068115
Epoch: 13, Steps: 3 | Train Loss: 0.091 Vali Loss: 0.225 Vali Acc: 0.950 Test Loss: 0.225 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 14 cost time: 0.5635805130004883
Epoch: 14, Steps: 3 | Train Loss: 0.075 Vali Loss: 0.208 Vali Acc: 0.950 Test Loss: 0.208 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 15 cost time: 0.5416786670684814
Epoch: 15, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.196 Vali Acc: 0.950 Test Loss: 0.196 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 16 cost time: 0.5972342491149902
Epoch: 16, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.189 Vali Acc: 0.950 Test Loss: 0.189 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 17 cost time: 0.47257161140441895
Epoch: 17, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.191 Vali Acc: 0.950 Test Loss: 0.191 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5402181148529053
Epoch: 18, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.197 Vali Acc: 0.950 Test Loss: 0.197 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.501115083694458
Epoch: 19, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.210 Vali Acc: 0.950 Test Loss: 0.210 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.557896614074707
Epoch: 20, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.232 Vali Acc: 0.950 Test Loss: 0.232 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.5039684772491455
Epoch: 21, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.240 Vali Acc: 0.950 Test Loss: 0.240 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.5744695663452148
Epoch: 22, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.238 Vali Acc: 0.950 Test Loss: 0.238 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.5244789123535156
Epoch: 23, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.244 Vali Acc: 0.950 Test Loss: 0.244 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.5746097564697266
Epoch: 24, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.256 Vali Acc: 0.950 Test Loss: 0.256 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.5588037967681885
Epoch: 25, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.268 Vali Acc: 0.925 Test Loss: 0.268 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.6038339138031006
Epoch: 26, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.271 Vali Acc: 0.925 Test Loss: 0.271 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 2297860
model size : 8.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.846240520477295
Epoch: 1, Steps: 3 | Train Loss: 1.367 Vali Loss: 1.325 Vali Acc: 0.275 Test Loss: 1.325 Test Acc: 0.275
Validation loss decreased (inf --> -0.274987).  Saving model ...
Epoch: 2 cost time: 0.515596866607666
Epoch: 2, Steps: 3 | Train Loss: 1.262 Vali Loss: 1.275 Vali Acc: 0.525 Test Loss: 1.275 Test Acc: 0.525
Validation loss decreased (-0.274987 --> -0.524987).  Saving model ...
Epoch: 3 cost time: 0.5162913799285889
Epoch: 3, Steps: 3 | Train Loss: 1.153 Vali Loss: 1.170 Vali Acc: 0.725 Test Loss: 1.170 Test Acc: 0.725
Validation loss decreased (-0.524987 --> -0.724988).  Saving model ...
Epoch: 4 cost time: 0.4660351276397705
Epoch: 4, Steps: 3 | Train Loss: 0.970 Vali Loss: 1.033 Vali Acc: 0.900 Test Loss: 1.033 Test Acc: 0.900
Validation loss decreased (-0.724988 --> -0.899990).  Saving model ...
Epoch: 5 cost time: 0.6019270420074463
Epoch: 5, Steps: 3 | Train Loss: 0.792 Vali Loss: 0.877 Vali Acc: 0.950 Test Loss: 0.877 Test Acc: 0.950
Validation loss decreased (-0.899990 --> -0.949991).  Saving model ...
Epoch: 6 cost time: 0.6023831367492676
Epoch: 6, Steps: 3 | Train Loss: 0.618 Vali Loss: 0.731 Vali Acc: 0.950 Test Loss: 0.731 Test Acc: 0.950
Validation loss decreased (-0.949991 --> -0.949993).  Saving model ...
Epoch: 7 cost time: 0.4938066005706787
Epoch: 7, Steps: 3 | Train Loss: 0.479 Vali Loss: 0.591 Vali Acc: 0.950 Test Loss: 0.591 Test Acc: 0.950
Validation loss decreased (-0.949993 --> -0.949994).  Saving model ...
Epoch: 8 cost time: 0.5746853351593018
Epoch: 8, Steps: 3 | Train Loss: 0.409 Vali Loss: 0.489 Vali Acc: 0.925 Test Loss: 0.489 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.44963717460632324
Epoch: 9, Steps: 3 | Train Loss: 0.337 Vali Loss: 0.401 Vali Acc: 0.950 Test Loss: 0.401 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949996).  Saving model ...
Epoch: 10 cost time: 0.49933862686157227
Epoch: 10, Steps: 3 | Train Loss: 0.257 Vali Loss: 0.343 Vali Acc: 0.975 Test Loss: 0.343 Test Acc: 0.975
Validation loss decreased (-0.949996 --> -0.974997).  Saving model ...
Epoch: 11 cost time: 0.5441176891326904
Epoch: 11, Steps: 3 | Train Loss: 0.212 Vali Loss: 0.297 Vali Acc: 0.975 Test Loss: 0.297 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 12 cost time: 0.4752187728881836
Epoch: 12, Steps: 3 | Train Loss: 0.180 Vali Loss: 0.258 Vali Acc: 0.975 Test Loss: 0.258 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 13 cost time: 0.4719572067260742
Epoch: 13, Steps: 3 | Train Loss: 0.142 Vali Loss: 0.226 Vali Acc: 0.975 Test Loss: 0.226 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 14 cost time: 0.43268275260925293
Epoch: 14, Steps: 3 | Train Loss: 0.129 Vali Loss: 0.196 Vali Acc: 0.975 Test Loss: 0.196 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 15 cost time: 0.5799100399017334
Epoch: 15, Steps: 3 | Train Loss: 0.107 Vali Loss: 0.171 Vali Acc: 0.975 Test Loss: 0.171 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 16 cost time: 0.49822163581848145
Epoch: 16, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.158 Vali Acc: 0.975 Test Loss: 0.158 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 17 cost time: 0.5275192260742188
Epoch: 17, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.142 Vali Acc: 0.975 Test Loss: 0.142 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974999).  Saving model ...
Epoch: 18 cost time: 0.5469009876251221
Epoch: 18, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.130 Vali Acc: 0.975 Test Loss: 0.130 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 19 cost time: 0.5764844417572021
Epoch: 19, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.120 Vali Acc: 0.975 Test Loss: 0.120 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 20 cost time: 0.523029088973999
Epoch: 20, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.121 Vali Acc: 0.975 Test Loss: 0.121 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.630957841873169
Epoch: 21, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.125 Vali Acc: 0.975 Test Loss: 0.125 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.544546365737915
Epoch: 22, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.119 Vali Acc: 0.975 Test Loss: 0.119 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 23 cost time: 0.5288543701171875
Epoch: 23, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.124 Vali Acc: 0.950 Test Loss: 0.124 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.5299372673034668
Epoch: 24, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.125 Vali Acc: 0.950 Test Loss: 0.125 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.5328166484832764
Epoch: 25, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.124 Vali Acc: 0.950 Test Loss: 0.124 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.5465714931488037
Epoch: 26, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.122 Vali Acc: 0.950 Test Loss: 0.122 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.5038902759552002
Epoch: 27, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.124 Vali Acc: 0.950 Test Loss: 0.124 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.4901096820831299
Epoch: 28, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.130 Vali Acc: 0.950 Test Loss: 0.130 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.5050396919250488
Epoch: 29, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.129 Vali Acc: 0.950 Test Loss: 0.129 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.4844646453857422
Epoch: 30, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.129 Vali Acc: 0.950 Test Loss: 0.129 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.5119047164916992
Epoch: 31, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.127 Vali Acc: 0.950 Test Loss: 0.127 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.4931471347808838
Epoch: 32, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.128 Vali Acc: 0.950 Test Loss: 0.128 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 2248964
model size : 8.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.82840895652771
Epoch: 1, Steps: 3 | Train Loss: 1.338 Vali Loss: 1.338 Vali Acc: 0.450 Test Loss: 1.338 Test Acc: 0.450
Validation loss decreased (inf --> -0.449987).  Saving model ...
Epoch: 2 cost time: 0.46265435218811035
Epoch: 2, Steps: 3 | Train Loss: 1.235 Vali Loss: 1.292 Vali Acc: 0.525 Test Loss: 1.292 Test Acc: 0.525
Validation loss decreased (-0.449987 --> -0.524987).  Saving model ...
Epoch: 3 cost time: 0.544959545135498
Epoch: 3, Steps: 3 | Train Loss: 1.130 Vali Loss: 1.203 Vali Acc: 0.650 Test Loss: 1.203 Test Acc: 0.650
Validation loss decreased (-0.524987 --> -0.649988).  Saving model ...
Epoch: 4 cost time: 0.5501596927642822
Epoch: 4, Steps: 3 | Train Loss: 1.003 Vali Loss: 1.093 Vali Acc: 0.675 Test Loss: 1.093 Test Acc: 0.675
Validation loss decreased (-0.649988 --> -0.674989).  Saving model ...
Epoch: 5 cost time: 0.4572582244873047
Epoch: 5, Steps: 3 | Train Loss: 0.827 Vali Loss: 0.972 Vali Acc: 0.825 Test Loss: 0.972 Test Acc: 0.825
Validation loss decreased (-0.674989 --> -0.824990).  Saving model ...
Epoch: 6 cost time: 0.4781327247619629
Epoch: 6, Steps: 3 | Train Loss: 0.699 Vali Loss: 0.839 Vali Acc: 0.875 Test Loss: 0.839 Test Acc: 0.875
Validation loss decreased (-0.824990 --> -0.874992).  Saving model ...
Epoch: 7 cost time: 0.5581138134002686
Epoch: 7, Steps: 3 | Train Loss: 0.571 Vali Loss: 0.722 Vali Acc: 0.875 Test Loss: 0.722 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874993).  Saving model ...
Epoch: 8 cost time: 0.5604212284088135
Epoch: 8, Steps: 3 | Train Loss: 0.472 Vali Loss: 0.620 Vali Acc: 0.900 Test Loss: 0.620 Test Acc: 0.900
Validation loss decreased (-0.874993 --> -0.899994).  Saving model ...
Epoch: 9 cost time: 0.5805137157440186
Epoch: 9, Steps: 3 | Train Loss: 0.387 Vali Loss: 0.534 Vali Acc: 0.875 Test Loss: 0.534 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5622031688690186
Epoch: 10, Steps: 3 | Train Loss: 0.314 Vali Loss: 0.456 Vali Acc: 0.900 Test Loss: 0.456 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 11 cost time: 0.6026871204376221
Epoch: 11, Steps: 3 | Train Loss: 0.254 Vali Loss: 0.394 Vali Acc: 0.925 Test Loss: 0.394 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924996).  Saving model ...
Epoch: 12 cost time: 0.5687940120697021
Epoch: 12, Steps: 3 | Train Loss: 0.237 Vali Loss: 0.341 Vali Acc: 0.950 Test Loss: 0.341 Test Acc: 0.950
Validation loss decreased (-0.924996 --> -0.949997).  Saving model ...
Epoch: 13 cost time: 0.6161272525787354
Epoch: 13, Steps: 3 | Train Loss: 0.211 Vali Loss: 0.299 Vali Acc: 0.975 Test Loss: 0.299 Test Acc: 0.975
Validation loss decreased (-0.949997 --> -0.974997).  Saving model ...
Epoch: 14 cost time: 0.5459082126617432
Epoch: 14, Steps: 3 | Train Loss: 0.187 Vali Loss: 0.264 Vali Acc: 0.975 Test Loss: 0.264 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 15 cost time: 0.5254449844360352
Epoch: 15, Steps: 3 | Train Loss: 0.138 Vali Loss: 0.241 Vali Acc: 0.975 Test Loss: 0.241 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 16 cost time: 0.4673457145690918
Epoch: 16, Steps: 3 | Train Loss: 0.117 Vali Loss: 0.218 Vali Acc: 0.975 Test Loss: 0.218 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 17 cost time: 0.4927494525909424
Epoch: 17, Steps: 3 | Train Loss: 0.099 Vali Loss: 0.204 Vali Acc: 0.975 Test Loss: 0.204 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 18 cost time: 0.5216302871704102
Epoch: 18, Steps: 3 | Train Loss: 0.088 Vali Loss: 0.198 Vali Acc: 0.975 Test Loss: 0.198 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 19 cost time: 0.5538554191589355
Epoch: 19, Steps: 3 | Train Loss: 0.073 Vali Loss: 0.188 Vali Acc: 0.975 Test Loss: 0.188 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 20 cost time: 0.5723583698272705
Epoch: 20, Steps: 3 | Train Loss: 0.058 Vali Loss: 0.185 Vali Acc: 0.975 Test Loss: 0.185 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 21 cost time: 0.5927062034606934
Epoch: 21, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.171 Vali Acc: 0.975 Test Loss: 0.171 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 22 cost time: 0.5232388973236084
Epoch: 22, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.167 Vali Acc: 0.950 Test Loss: 0.167 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6120953559875488
Epoch: 23, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.163 Vali Acc: 0.950 Test Loss: 0.163 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.5406816005706787
Epoch: 24, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.158 Vali Acc: 0.950 Test Loss: 0.158 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.6242680549621582
Epoch: 25, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.152 Vali Acc: 0.950 Test Loss: 0.152 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.5280733108520508
Epoch: 26, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.150 Vali Acc: 0.950 Test Loss: 0.150 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.5377359390258789
Epoch: 27, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.153 Vali Acc: 0.950 Test Loss: 0.153 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.5762286186218262
Epoch: 28, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.149 Vali Acc: 0.950 Test Loss: 0.149 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.6037740707397461
Epoch: 29, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.149 Vali Acc: 0.950 Test Loss: 0.149 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.5710909366607666
Epoch: 30, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.149 Vali Acc: 0.950 Test Loss: 0.149 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.5399842262268066
Epoch: 31, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.156 Vali Acc: 0.950 Test Loss: 0.156 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 2224772
model size : 8.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.8775537014007568
Epoch: 1, Steps: 3 | Train Loss: 1.486 Vali Loss: 1.409 Vali Acc: 0.300 Test Loss: 1.409 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 0.5101382732391357
Epoch: 2, Steps: 3 | Train Loss: 1.389 Vali Loss: 1.377 Vali Acc: 0.300 Test Loss: 1.377 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299986).  Saving model ...
Epoch: 3 cost time: 0.5357763767242432
Epoch: 3, Steps: 3 | Train Loss: 1.329 Vali Loss: 1.311 Vali Acc: 0.375 Test Loss: 1.311 Test Acc: 0.375
Validation loss decreased (-0.299986 --> -0.374987).  Saving model ...
Epoch: 4 cost time: 0.47504138946533203
Epoch: 4, Steps: 3 | Train Loss: 1.184 Vali Loss: 1.212 Vali Acc: 0.450 Test Loss: 1.212 Test Acc: 0.450
Validation loss decreased (-0.374987 --> -0.449988).  Saving model ...
Epoch: 5 cost time: 0.5949616432189941
Epoch: 5, Steps: 3 | Train Loss: 0.996 Vali Loss: 1.103 Vali Acc: 0.600 Test Loss: 1.103 Test Acc: 0.600
Validation loss decreased (-0.449988 --> -0.599989).  Saving model ...
Epoch: 6 cost time: 0.569549560546875
Epoch: 6, Steps: 3 | Train Loss: 0.860 Vali Loss: 0.991 Vali Acc: 0.725 Test Loss: 0.991 Test Acc: 0.725
Validation loss decreased (-0.599989 --> -0.724990).  Saving model ...
Epoch: 7 cost time: 0.5398945808410645
Epoch: 7, Steps: 3 | Train Loss: 0.719 Vali Loss: 0.880 Vali Acc: 0.825 Test Loss: 0.880 Test Acc: 0.825
Validation loss decreased (-0.724990 --> -0.824991).  Saving model ...
Epoch: 8 cost time: 0.5200405120849609
Epoch: 8, Steps: 3 | Train Loss: 0.596 Vali Loss: 0.782 Vali Acc: 0.900 Test Loss: 0.782 Test Acc: 0.900
Validation loss decreased (-0.824991 --> -0.899992).  Saving model ...
Epoch: 9 cost time: 0.5605733394622803
Epoch: 9, Steps: 3 | Train Loss: 0.512 Vali Loss: 0.670 Vali Acc: 0.875 Test Loss: 0.670 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5420982837677002
Epoch: 10, Steps: 3 | Train Loss: 0.432 Vali Loss: 0.577 Vali Acc: 0.875 Test Loss: 0.577 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5805573463439941
Epoch: 11, Steps: 3 | Train Loss: 0.392 Vali Loss: 0.501 Vali Acc: 0.900 Test Loss: 0.501 Test Acc: 0.900
Validation loss decreased (-0.899992 --> -0.899995).  Saving model ...
Epoch: 12 cost time: 0.5625121593475342
Epoch: 12, Steps: 3 | Train Loss: 0.298 Vali Loss: 0.448 Vali Acc: 0.900 Test Loss: 0.448 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 13 cost time: 0.5981898307800293
Epoch: 13, Steps: 3 | Train Loss: 0.256 Vali Loss: 0.406 Vali Acc: 0.925 Test Loss: 0.406 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924996).  Saving model ...
Epoch: 14 cost time: 0.4842662811279297
Epoch: 14, Steps: 3 | Train Loss: 0.248 Vali Loss: 0.368 Vali Acc: 0.925 Test Loss: 0.368 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 15 cost time: 0.5334377288818359
Epoch: 15, Steps: 3 | Train Loss: 0.207 Vali Loss: 0.342 Vali Acc: 0.925 Test Loss: 0.342 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924997).  Saving model ...
Epoch: 16 cost time: 0.5258941650390625
Epoch: 16, Steps: 3 | Train Loss: 0.169 Vali Loss: 0.329 Vali Acc: 0.950 Test Loss: 0.329 Test Acc: 0.950
Validation loss decreased (-0.924997 --> -0.949997).  Saving model ...
Epoch: 17 cost time: 0.5702869892120361
Epoch: 17, Steps: 3 | Train Loss: 0.150 Vali Loss: 0.315 Vali Acc: 0.925 Test Loss: 0.315 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.4993612766265869
Epoch: 18, Steps: 3 | Train Loss: 0.143 Vali Loss: 0.293 Vali Acc: 0.950 Test Loss: 0.293 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 19 cost time: 0.5266025066375732
Epoch: 19, Steps: 3 | Train Loss: 0.111 Vali Loss: 0.272 Vali Acc: 0.950 Test Loss: 0.272 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 20 cost time: 0.5315818786621094
Epoch: 20, Steps: 3 | Train Loss: 0.103 Vali Loss: 0.262 Vali Acc: 0.950 Test Loss: 0.262 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 21 cost time: 0.5232269763946533
Epoch: 21, Steps: 3 | Train Loss: 0.076 Vali Loss: 0.255 Vali Acc: 0.950 Test Loss: 0.255 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 22 cost time: 0.5340476036071777
Epoch: 22, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.253 Vali Acc: 0.925 Test Loss: 0.253 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5489473342895508
Epoch: 23, Steps: 3 | Train Loss: 0.071 Vali Loss: 0.247 Vali Acc: 0.925 Test Loss: 0.247 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.5756733417510986
Epoch: 24, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.245 Vali Acc: 0.925 Test Loss: 0.245 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.48240017890930176
Epoch: 25, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.241 Vali Acc: 0.925 Test Loss: 0.241 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.5308411121368408
Epoch: 26, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.243 Vali Acc: 0.925 Test Loss: 0.243 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.5911784172058105
Epoch: 27, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.235 Vali Acc: 0.925 Test Loss: 0.235 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.5044748783111572
Epoch: 28, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.240 Vali Acc: 0.925 Test Loss: 0.240 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.5288166999816895
Epoch: 29, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.238 Vali Acc: 0.925 Test Loss: 0.238 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.604036808013916
Epoch: 30, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.238 Vali Acc: 0.925 Test Loss: 0.238 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.5503036975860596
Epoch: 31, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.241 Vali Acc: 0.925 Test Loss: 0.241 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 2206596
model size : 8.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.6509506702423096
Epoch: 1, Steps: 3 | Train Loss: 1.408 Vali Loss: 1.346 Vali Acc: 0.325 Test Loss: 1.346 Test Acc: 0.325
Validation loss decreased (inf --> -0.324987).  Saving model ...
Epoch: 2 cost time: 0.46569347381591797
Epoch: 2, Steps: 3 | Train Loss: 1.334 Vali Loss: 1.315 Vali Acc: 0.375 Test Loss: 1.315 Test Acc: 0.375
Validation loss decreased (-0.324987 --> -0.374987).  Saving model ...
Epoch: 3 cost time: 0.5157589912414551
Epoch: 3, Steps: 3 | Train Loss: 1.276 Vali Loss: 1.265 Vali Acc: 0.450 Test Loss: 1.265 Test Acc: 0.450
Validation loss decreased (-0.374987 --> -0.449987).  Saving model ...
Epoch: 4 cost time: 0.5848257541656494
Epoch: 4, Steps: 3 | Train Loss: 1.159 Vali Loss: 1.196 Vali Acc: 0.575 Test Loss: 1.196 Test Acc: 0.575
Validation loss decreased (-0.449987 --> -0.574988).  Saving model ...
Epoch: 5 cost time: 0.4871962070465088
Epoch: 5, Steps: 3 | Train Loss: 1.052 Vali Loss: 1.112 Vali Acc: 0.575 Test Loss: 1.112 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574989).  Saving model ...
Epoch: 6 cost time: 0.48645806312561035
Epoch: 6, Steps: 3 | Train Loss: 0.929 Vali Loss: 1.021 Vali Acc: 0.650 Test Loss: 1.021 Test Acc: 0.650
Validation loss decreased (-0.574989 --> -0.649990).  Saving model ...
Epoch: 7 cost time: 0.4757652282714844
Epoch: 7, Steps: 3 | Train Loss: 0.817 Vali Loss: 0.932 Vali Acc: 0.700 Test Loss: 0.932 Test Acc: 0.700
Validation loss decreased (-0.649990 --> -0.699991).  Saving model ...
Epoch: 8 cost time: 0.5329914093017578
Epoch: 8, Steps: 3 | Train Loss: 0.744 Vali Loss: 0.832 Vali Acc: 0.850 Test Loss: 0.832 Test Acc: 0.850
Validation loss decreased (-0.699991 --> -0.849992).  Saving model ...
Epoch: 9 cost time: 0.5170152187347412
Epoch: 9, Steps: 3 | Train Loss: 0.660 Vali Loss: 0.745 Vali Acc: 0.950 Test Loss: 0.745 Test Acc: 0.950
Validation loss decreased (-0.849992 --> -0.949993).  Saving model ...
Epoch: 10 cost time: 0.5219020843505859
Epoch: 10, Steps: 3 | Train Loss: 0.554 Vali Loss: 0.670 Vali Acc: 0.950 Test Loss: 0.670 Test Acc: 0.950
Validation loss decreased (-0.949993 --> -0.949993).  Saving model ...
Epoch: 11 cost time: 0.5517458915710449
Epoch: 11, Steps: 3 | Train Loss: 0.487 Vali Loss: 0.600 Vali Acc: 0.950 Test Loss: 0.600 Test Acc: 0.950
Validation loss decreased (-0.949993 --> -0.949994).  Saving model ...
Epoch: 12 cost time: 0.544715166091919
Epoch: 12, Steps: 3 | Train Loss: 0.425 Vali Loss: 0.536 Vali Acc: 0.950 Test Loss: 0.536 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 13 cost time: 0.527662992477417
Epoch: 13, Steps: 3 | Train Loss: 0.359 Vali Loss: 0.492 Vali Acc: 0.950 Test Loss: 0.492 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 14 cost time: 0.5468714237213135
Epoch: 14, Steps: 3 | Train Loss: 0.331 Vali Loss: 0.449 Vali Acc: 0.950 Test Loss: 0.449 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 15 cost time: 0.5303714275360107
Epoch: 15, Steps: 3 | Train Loss: 0.309 Vali Loss: 0.416 Vali Acc: 0.950 Test Loss: 0.416 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 16 cost time: 0.47023916244506836
Epoch: 16, Steps: 3 | Train Loss: 0.272 Vali Loss: 0.382 Vali Acc: 0.950 Test Loss: 0.382 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 17 cost time: 0.49834632873535156
Epoch: 17, Steps: 3 | Train Loss: 0.223 Vali Loss: 0.358 Vali Acc: 0.975 Test Loss: 0.358 Test Acc: 0.975
Validation loss decreased (-0.949996 --> -0.974996).  Saving model ...
Epoch: 18 cost time: 0.5334105491638184
Epoch: 18, Steps: 3 | Train Loss: 0.199 Vali Loss: 0.333 Vali Acc: 0.975 Test Loss: 0.333 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 19 cost time: 0.5164198875427246
Epoch: 19, Steps: 3 | Train Loss: 0.193 Vali Loss: 0.323 Vali Acc: 0.975 Test Loss: 0.323 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 20 cost time: 0.5506846904754639
Epoch: 20, Steps: 3 | Train Loss: 0.168 Vali Loss: 0.301 Vali Acc: 0.975 Test Loss: 0.301 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 21 cost time: 0.44651126861572266
Epoch: 21, Steps: 3 | Train Loss: 0.160 Vali Loss: 0.285 Vali Acc: 0.975 Test Loss: 0.285 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 22 cost time: 0.5007221698760986
Epoch: 22, Steps: 3 | Train Loss: 0.143 Vali Loss: 0.267 Vali Acc: 0.975 Test Loss: 0.267 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 23 cost time: 0.5258991718292236
Epoch: 23, Steps: 3 | Train Loss: 0.108 Vali Loss: 0.257 Vali Acc: 0.975 Test Loss: 0.257 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 24 cost time: 0.4969630241394043
Epoch: 24, Steps: 3 | Train Loss: 0.124 Vali Loss: 0.250 Vali Acc: 0.975 Test Loss: 0.250 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 25 cost time: 0.5509147644042969
Epoch: 25, Steps: 3 | Train Loss: 0.098 Vali Loss: 0.236 Vali Acc: 0.950 Test Loss: 0.236 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.4897141456604004
Epoch: 26, Steps: 3 | Train Loss: 0.094 Vali Loss: 0.230 Vali Acc: 0.950 Test Loss: 0.230 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.5362434387207031
Epoch: 27, Steps: 3 | Train Loss: 0.078 Vali Loss: 0.223 Vali Acc: 0.950 Test Loss: 0.223 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.5639960765838623
Epoch: 28, Steps: 3 | Train Loss: 0.062 Vali Loss: 0.212 Vali Acc: 0.950 Test Loss: 0.212 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.572472333908081
Epoch: 29, Steps: 3 | Train Loss: 0.062 Vali Loss: 0.208 Vali Acc: 0.950 Test Loss: 0.208 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.5594398975372314
Epoch: 30, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.206 Vali Acc: 0.950 Test Loss: 0.206 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.5497293472290039
Epoch: 31, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.205 Vali Acc: 0.950 Test Loss: 0.205 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.5712058544158936
Epoch: 32, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.204 Vali Acc: 0.950 Test Loss: 0.204 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.48969388008117676
Epoch: 33, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.199 Vali Acc: 0.950 Test Loss: 0.199 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.44394516944885254
Epoch: 34, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.199 Vali Acc: 0.950 Test Loss: 0.199 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 2182660
model size : 8.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps20_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.7687177658081055
Epoch: 1, Steps: 3 | Train Loss: 1.378 Vali Loss: 1.350 Vali Acc: 0.225 Test Loss: 1.350 Test Acc: 0.225
Validation loss decreased (inf --> -0.224987).  Saving model ...
Epoch: 2 cost time: 0.4669609069824219
Epoch: 2, Steps: 3 | Train Loss: 1.333 Vali Loss: 1.325 Vali Acc: 0.275 Test Loss: 1.325 Test Acc: 0.275
Validation loss decreased (-0.224987 --> -0.274987).  Saving model ...
Epoch: 3 cost time: 0.452481746673584
Epoch: 3, Steps: 3 | Train Loss: 1.265 Vali Loss: 1.284 Vali Acc: 0.300 Test Loss: 1.284 Test Acc: 0.300
Validation loss decreased (-0.274987 --> -0.299987).  Saving model ...
Epoch: 4 cost time: 0.452852725982666
Epoch: 4, Steps: 3 | Train Loss: 1.169 Vali Loss: 1.224 Vali Acc: 0.400 Test Loss: 1.224 Test Acc: 0.400
Validation loss decreased (-0.299987 --> -0.399988).  Saving model ...
Epoch: 5 cost time: 0.577681303024292
Epoch: 5, Steps: 3 | Train Loss: 1.102 Vali Loss: 1.153 Vali Acc: 0.600 Test Loss: 1.153 Test Acc: 0.600
Validation loss decreased (-0.399988 --> -0.599988).  Saving model ...
Epoch: 6 cost time: 0.48741650581359863
Epoch: 6, Steps: 3 | Train Loss: 0.975 Vali Loss: 1.075 Vali Acc: 0.750 Test Loss: 1.075 Test Acc: 0.750
Validation loss decreased (-0.599988 --> -0.749989).  Saving model ...
Epoch: 7 cost time: 0.497603178024292
Epoch: 7, Steps: 3 | Train Loss: 0.864 Vali Loss: 0.994 Vali Acc: 0.750 Test Loss: 0.994 Test Acc: 0.750
Validation loss decreased (-0.749989 --> -0.749990).  Saving model ...
Epoch: 8 cost time: 0.48558878898620605
Epoch: 8, Steps: 3 | Train Loss: 0.767 Vali Loss: 0.908 Vali Acc: 0.750 Test Loss: 0.908 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749991).  Saving model ...
Epoch: 9 cost time: 0.47641611099243164
Epoch: 9, Steps: 3 | Train Loss: 0.700 Vali Loss: 0.817 Vali Acc: 0.875 Test Loss: 0.817 Test Acc: 0.875
Validation loss decreased (-0.749991 --> -0.874992).  Saving model ...
Epoch: 10 cost time: 0.5019049644470215
Epoch: 10, Steps: 3 | Train Loss: 0.614 Vali Loss: 0.736 Vali Acc: 0.975 Test Loss: 0.736 Test Acc: 0.975
Validation loss decreased (-0.874992 --> -0.974993).  Saving model ...
Epoch: 11 cost time: 0.5231363773345947
Epoch: 11, Steps: 3 | Train Loss: 0.536 Vali Loss: 0.664 Vali Acc: 0.950 Test Loss: 0.664 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6221823692321777
Epoch: 12, Steps: 3 | Train Loss: 0.485 Vali Loss: 0.603 Vali Acc: 0.950 Test Loss: 0.603 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.5477824211120605
Epoch: 13, Steps: 3 | Train Loss: 0.436 Vali Loss: 0.549 Vali Acc: 0.950 Test Loss: 0.549 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.5957646369934082
Epoch: 14, Steps: 3 | Train Loss: 0.366 Vali Loss: 0.514 Vali Acc: 0.900 Test Loss: 0.514 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.5091919898986816
Epoch: 15, Steps: 3 | Train Loss: 0.336 Vali Loss: 0.466 Vali Acc: 0.900 Test Loss: 0.466 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.5524547100067139
Epoch: 16, Steps: 3 | Train Loss: 0.293 Vali Loss: 0.419 Vali Acc: 0.900 Test Loss: 0.419 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.5957398414611816
Epoch: 17, Steps: 3 | Train Loss: 0.257 Vali Loss: 0.395 Vali Acc: 0.900 Test Loss: 0.395 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.5994203090667725
Epoch: 18, Steps: 3 | Train Loss: 0.294 Vali Loss: 0.363 Vali Acc: 0.925 Test Loss: 0.363 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.6587569713592529
Epoch: 19, Steps: 3 | Train Loss: 0.245 Vali Loss: 0.344 Vali Acc: 0.925 Test Loss: 0.344 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.5285797119140625
Epoch: 20, Steps: 3 | Train Loss: 0.232 Vali Loss: 0.319 Vali Acc: 0.950 Test Loss: 0.319 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps20_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 2177156
model size : 8.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps25_str13_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.7547807693481445
Epoch: 1, Steps: 3 | Train Loss: 1.424 Vali Loss: 1.392 Vali Acc: 0.100 Test Loss: 1.392 Test Acc: 0.100
Validation loss decreased (inf --> -0.099986).  Saving model ...
Epoch: 2 cost time: 0.5084705352783203
Epoch: 2, Steps: 3 | Train Loss: 1.375 Vali Loss: 1.367 Vali Acc: 0.150 Test Loss: 1.367 Test Acc: 0.150
Validation loss decreased (-0.099986 --> -0.149986).  Saving model ...
Epoch: 3 cost time: 0.47205400466918945
Epoch: 3, Steps: 3 | Train Loss: 1.301 Vali Loss: 1.327 Vali Acc: 0.275 Test Loss: 1.327 Test Acc: 0.275
Validation loss decreased (-0.149986 --> -0.274987).  Saving model ...
Epoch: 4 cost time: 0.5345852375030518
Epoch: 4, Steps: 3 | Train Loss: 1.232 Vali Loss: 1.272 Vali Acc: 0.475 Test Loss: 1.272 Test Acc: 0.475
Validation loss decreased (-0.274987 --> -0.474987).  Saving model ...
Epoch: 5 cost time: 0.5839779376983643
Epoch: 5, Steps: 3 | Train Loss: 1.122 Vali Loss: 1.199 Vali Acc: 0.525 Test Loss: 1.199 Test Acc: 0.525
Validation loss decreased (-0.474987 --> -0.524988).  Saving model ...
Epoch: 6 cost time: 0.5244719982147217
Epoch: 6, Steps: 3 | Train Loss: 1.050 Vali Loss: 1.117 Vali Acc: 0.650 Test Loss: 1.117 Test Acc: 0.650
Validation loss decreased (-0.524988 --> -0.649989).  Saving model ...
Epoch: 7 cost time: 0.5103881359100342
Epoch: 7, Steps: 3 | Train Loss: 0.922 Vali Loss: 1.034 Vali Acc: 0.825 Test Loss: 1.034 Test Acc: 0.825
Validation loss decreased (-0.649989 --> -0.824990).  Saving model ...
Epoch: 8 cost time: 0.5594091415405273
Epoch: 8, Steps: 3 | Train Loss: 0.837 Vali Loss: 0.954 Vali Acc: 0.850 Test Loss: 0.954 Test Acc: 0.850
Validation loss decreased (-0.824990 --> -0.849990).  Saving model ...
Epoch: 9 cost time: 0.4549984931945801
Epoch: 9, Steps: 3 | Train Loss: 0.735 Vali Loss: 0.871 Vali Acc: 0.900 Test Loss: 0.871 Test Acc: 0.900
Validation loss decreased (-0.849990 --> -0.899991).  Saving model ...
Epoch: 10 cost time: 0.5237154960632324
Epoch: 10, Steps: 3 | Train Loss: 0.644 Vali Loss: 0.797 Vali Acc: 0.950 Test Loss: 0.797 Test Acc: 0.950
Validation loss decreased (-0.899991 --> -0.949992).  Saving model ...
Epoch: 11 cost time: 0.5115242004394531
Epoch: 11, Steps: 3 | Train Loss: 0.578 Vali Loss: 0.730 Vali Acc: 0.950 Test Loss: 0.730 Test Acc: 0.950
Validation loss decreased (-0.949992 --> -0.949993).  Saving model ...
Epoch: 12 cost time: 0.4772987365722656
Epoch: 12, Steps: 3 | Train Loss: 0.546 Vali Loss: 0.656 Vali Acc: 0.975 Test Loss: 0.656 Test Acc: 0.975
Validation loss decreased (-0.949993 --> -0.974993).  Saving model ...
Epoch: 13 cost time: 0.45314621925354004
Epoch: 13, Steps: 3 | Train Loss: 0.474 Vali Loss: 0.603 Vali Acc: 0.975 Test Loss: 0.603 Test Acc: 0.975
Validation loss decreased (-0.974993 --> -0.974994).  Saving model ...
Epoch: 14 cost time: 0.49155139923095703
Epoch: 14, Steps: 3 | Train Loss: 0.417 Vali Loss: 0.544 Vali Acc: 0.975 Test Loss: 0.544 Test Acc: 0.975
Validation loss decreased (-0.974994 --> -0.974995).  Saving model ...
Epoch: 15 cost time: 0.5916433334350586
Epoch: 15, Steps: 3 | Train Loss: 0.369 Vali Loss: 0.495 Vali Acc: 0.975 Test Loss: 0.495 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 16 cost time: 0.5520427227020264
Epoch: 16, Steps: 3 | Train Loss: 0.327 Vali Loss: 0.452 Vali Acc: 0.975 Test Loss: 0.452 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 17 cost time: 0.5149528980255127
Epoch: 17, Steps: 3 | Train Loss: 0.294 Vali Loss: 0.428 Vali Acc: 0.975 Test Loss: 0.428 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 18 cost time: 0.5051403045654297
Epoch: 18, Steps: 3 | Train Loss: 0.281 Vali Loss: 0.399 Vali Acc: 0.975 Test Loss: 0.399 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 19 cost time: 0.46562647819519043
Epoch: 19, Steps: 3 | Train Loss: 0.234 Vali Loss: 0.373 Vali Acc: 0.975 Test Loss: 0.373 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 20 cost time: 0.5524640083312988
Epoch: 20, Steps: 3 | Train Loss: 0.240 Vali Loss: 0.356 Vali Acc: 0.975 Test Loss: 0.356 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 21 cost time: 0.5076932907104492
Epoch: 21, Steps: 3 | Train Loss: 0.218 Vali Loss: 0.336 Vali Acc: 0.975 Test Loss: 0.336 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 22 cost time: 0.5808596611022949
Epoch: 22, Steps: 3 | Train Loss: 0.193 Vali Loss: 0.314 Vali Acc: 0.975 Test Loss: 0.314 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 23 cost time: 0.4968242645263672
Epoch: 23, Steps: 3 | Train Loss: 0.175 Vali Loss: 0.292 Vali Acc: 0.975 Test Loss: 0.292 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 24 cost time: 0.4999978542327881
Epoch: 24, Steps: 3 | Train Loss: 0.151 Vali Loss: 0.278 Vali Acc: 0.975 Test Loss: 0.278 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 25 cost time: 0.5665569305419922
Epoch: 25, Steps: 3 | Train Loss: 0.139 Vali Loss: 0.265 Vali Acc: 0.975 Test Loss: 0.265 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 26 cost time: 0.5787394046783447
Epoch: 26, Steps: 3 | Train Loss: 0.138 Vali Loss: 0.251 Vali Acc: 0.975 Test Loss: 0.251 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 27 cost time: 0.5233104228973389
Epoch: 27, Steps: 3 | Train Loss: 0.099 Vali Loss: 0.227 Vali Acc: 0.975 Test Loss: 0.227 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 28 cost time: 0.5141065120697021
Epoch: 28, Steps: 3 | Train Loss: 0.100 Vali Loss: 0.212 Vali Acc: 0.975 Test Loss: 0.212 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 29 cost time: 0.5357966423034668
Epoch: 29, Steps: 3 | Train Loss: 0.097 Vali Loss: 0.203 Vali Acc: 0.975 Test Loss: 0.203 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 30 cost time: 0.5508155822753906
Epoch: 30, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.197 Vali Acc: 0.975 Test Loss: 0.197 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 31 cost time: 0.537428617477417
Epoch: 31, Steps: 3 | Train Loss: 0.082 Vali Loss: 0.188 Vali Acc: 0.975 Test Loss: 0.188 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 32 cost time: 0.5500495433807373
Epoch: 32, Steps: 3 | Train Loss: 0.081 Vali Loss: 0.187 Vali Acc: 0.975 Test Loss: 0.187 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 33 cost time: 0.540339469909668
Epoch: 33, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.180 Vali Acc: 0.975 Test Loss: 0.180 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 34 cost time: 0.5607945919036865
Epoch: 34, Steps: 3 | Train Loss: 0.058 Vali Loss: 0.177 Vali Acc: 0.975 Test Loss: 0.177 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 35 cost time: 0.4745216369628906
Epoch: 35, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.170 Vali Acc: 0.975 Test Loss: 0.170 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 36 cost time: 0.6281509399414062
Epoch: 36, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.169 Vali Acc: 0.975 Test Loss: 0.169 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 37 cost time: 0.512697696685791
Epoch: 37, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.163 Vali Acc: 0.975 Test Loss: 0.163 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 38 cost time: 0.5107192993164062
Epoch: 38, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.152 Vali Acc: 0.975 Test Loss: 0.152 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 39 cost time: 0.5012354850769043
Epoch: 39, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.144 Vali Acc: 0.975 Test Loss: 0.144 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974999).  Saving model ...
Epoch: 40 cost time: 0.5371980667114258
Epoch: 40, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.144 Vali Acc: 0.975 Test Loss: 0.144 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 41 cost time: 0.5306580066680908
Epoch: 41, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.140 Vali Acc: 0.975 Test Loss: 0.140 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 42 cost time: 0.4841341972351074
Epoch: 42, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.146 Vali Acc: 0.975 Test Loss: 0.146 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.5652282238006592
Epoch: 43, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.141 Vali Acc: 0.975 Test Loss: 0.141 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.49914050102233887
Epoch: 44, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.134 Vali Acc: 0.975 Test Loss: 0.134 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 45 cost time: 0.5355772972106934
Epoch: 45, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.131 Vali Acc: 0.975 Test Loss: 0.131 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 46 cost time: 0.550814151763916
Epoch: 46, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.127 Vali Acc: 0.975 Test Loss: 0.127 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 47 cost time: 0.5580708980560303
Epoch: 47, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.125 Vali Acc: 0.975 Test Loss: 0.125 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 48 cost time: 0.535137414932251
Epoch: 48, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.127 Vali Acc: 0.975 Test Loss: 0.127 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.554368257522583
Epoch: 49, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.125 Vali Acc: 0.975 Test Loss: 0.125 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.5528969764709473
Epoch: 50, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.129 Vali Acc: 0.975 Test Loss: 0.129 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps25_str13_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 2171652
model size : 8.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.7025957107543945
Epoch: 1, Steps: 3 | Train Loss: 1.370 Vali Loss: 1.325 Vali Acc: 0.450 Test Loss: 1.325 Test Acc: 0.450
Validation loss decreased (inf --> -0.449987).  Saving model ...
Epoch: 2 cost time: 0.42159461975097656
Epoch: 2, Steps: 3 | Train Loss: 1.269 Vali Loss: 1.283 Vali Acc: 0.475 Test Loss: 1.283 Test Acc: 0.475
Validation loss decreased (-0.449987 --> -0.474987).  Saving model ...
Epoch: 3 cost time: 0.5112731456756592
Epoch: 3, Steps: 3 | Train Loss: 1.175 Vali Loss: 1.208 Vali Acc: 0.500 Test Loss: 1.208 Test Acc: 0.500
Validation loss decreased (-0.474987 --> -0.499988).  Saving model ...
Epoch: 4 cost time: 0.443835973739624
Epoch: 4, Steps: 3 | Train Loss: 1.085 Vali Loss: 1.110 Vali Acc: 0.575 Test Loss: 1.110 Test Acc: 0.575
Validation loss decreased (-0.499988 --> -0.574989).  Saving model ...
Epoch: 5 cost time: 0.45183777809143066
Epoch: 5, Steps: 3 | Train Loss: 0.945 Vali Loss: 0.996 Vali Acc: 0.675 Test Loss: 0.996 Test Acc: 0.675
Validation loss decreased (-0.574989 --> -0.674990).  Saving model ...
Epoch: 6 cost time: 0.48421263694763184
Epoch: 6, Steps: 3 | Train Loss: 0.772 Vali Loss: 0.885 Vali Acc: 0.800 Test Loss: 0.885 Test Acc: 0.800
Validation loss decreased (-0.674990 --> -0.799991).  Saving model ...
Epoch: 7 cost time: 0.4260408878326416
Epoch: 7, Steps: 3 | Train Loss: 0.657 Vali Loss: 0.779 Vali Acc: 0.950 Test Loss: 0.779 Test Acc: 0.950
Validation loss decreased (-0.799991 --> -0.949992).  Saving model ...
Epoch: 8 cost time: 0.4884316921234131
Epoch: 8, Steps: 3 | Train Loss: 0.532 Vali Loss: 0.673 Vali Acc: 0.975 Test Loss: 0.673 Test Acc: 0.975
Validation loss decreased (-0.949992 --> -0.974993).  Saving model ...
Epoch: 9 cost time: 0.5230023860931396
Epoch: 9, Steps: 3 | Train Loss: 0.444 Vali Loss: 0.579 Vali Acc: 0.950 Test Loss: 0.579 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.49280476570129395
Epoch: 10, Steps: 3 | Train Loss: 0.347 Vali Loss: 0.492 Vali Acc: 0.950 Test Loss: 0.492 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.4340033531188965
Epoch: 11, Steps: 3 | Train Loss: 0.325 Vali Loss: 0.426 Vali Acc: 0.975 Test Loss: 0.426 Test Acc: 0.975
Validation loss decreased (-0.974993 --> -0.974996).  Saving model ...
Epoch: 12 cost time: 0.4883749485015869
Epoch: 12, Steps: 3 | Train Loss: 0.248 Vali Loss: 0.380 Vali Acc: 0.975 Test Loss: 0.380 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 13 cost time: 0.44537973403930664
Epoch: 13, Steps: 3 | Train Loss: 0.188 Vali Loss: 0.330 Vali Acc: 0.975 Test Loss: 0.330 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 14 cost time: 0.4302356243133545
Epoch: 14, Steps: 3 | Train Loss: 0.194 Vali Loss: 0.300 Vali Acc: 0.975 Test Loss: 0.300 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 15 cost time: 0.45583581924438477
Epoch: 15, Steps: 3 | Train Loss: 0.161 Vali Loss: 0.272 Vali Acc: 0.975 Test Loss: 0.272 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 16 cost time: 0.5600602626800537
Epoch: 16, Steps: 3 | Train Loss: 0.142 Vali Loss: 0.252 Vali Acc: 0.975 Test Loss: 0.252 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 17 cost time: 0.4485738277435303
Epoch: 17, Steps: 3 | Train Loss: 0.103 Vali Loss: 0.249 Vali Acc: 0.950 Test Loss: 0.249 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.4680502414703369
Epoch: 18, Steps: 3 | Train Loss: 0.116 Vali Loss: 0.226 Vali Acc: 0.950 Test Loss: 0.226 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.46176934242248535
Epoch: 19, Steps: 3 | Train Loss: 0.072 Vali Loss: 0.216 Vali Acc: 0.950 Test Loss: 0.216 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.4381687641143799
Epoch: 20, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.195 Vali Acc: 0.950 Test Loss: 0.195 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.4857606887817383
Epoch: 21, Steps: 3 | Train Loss: 0.055 Vali Loss: 0.179 Vali Acc: 0.950 Test Loss: 0.179 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.4239189624786377
Epoch: 22, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.174 Vali Acc: 0.950 Test Loss: 0.174 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.4911377429962158
Epoch: 23, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.176 Vali Acc: 0.950 Test Loss: 0.176 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.4760251045227051
Epoch: 24, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.172 Vali Acc: 0.950 Test Loss: 0.172 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.5046381950378418
Epoch: 25, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.172 Vali Acc: 0.950 Test Loss: 0.172 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.4673178195953369
Epoch: 26, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.180 Vali Acc: 0.950 Test Loss: 0.180 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 641028
model size : 2.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.6933233737945557
Epoch: 1, Steps: 3 | Train Loss: 1.358 Vali Loss: 1.347 Vali Acc: 0.450 Test Loss: 1.347 Test Acc: 0.450
Validation loss decreased (inf --> -0.449987).  Saving model ...
Epoch: 2 cost time: 0.4434385299682617
Epoch: 2, Steps: 3 | Train Loss: 1.318 Vali Loss: 1.310 Vali Acc: 0.550 Test Loss: 1.310 Test Acc: 0.550
Validation loss decreased (-0.449987 --> -0.549987).  Saving model ...
Epoch: 3 cost time: 0.4469280242919922
Epoch: 3, Steps: 3 | Train Loss: 1.218 Vali Loss: 1.252 Vali Acc: 0.600 Test Loss: 1.252 Test Acc: 0.600
Validation loss decreased (-0.549987 --> -0.599987).  Saving model ...
Epoch: 4 cost time: 0.44251418113708496
Epoch: 4, Steps: 3 | Train Loss: 1.116 Vali Loss: 1.175 Vali Acc: 0.725 Test Loss: 1.175 Test Acc: 0.725
Validation loss decreased (-0.599987 --> -0.724988).  Saving model ...
Epoch: 5 cost time: 0.45549845695495605
Epoch: 5, Steps: 3 | Train Loss: 0.982 Vali Loss: 1.085 Vali Acc: 0.825 Test Loss: 1.085 Test Acc: 0.825
Validation loss decreased (-0.724988 --> -0.824989).  Saving model ...
Epoch: 6 cost time: 0.4291262626647949
Epoch: 6, Steps: 3 | Train Loss: 0.890 Vali Loss: 0.982 Vali Acc: 0.875 Test Loss: 0.982 Test Acc: 0.875
Validation loss decreased (-0.824989 --> -0.874990).  Saving model ...
Epoch: 7 cost time: 0.4901750087738037
Epoch: 7, Steps: 3 | Train Loss: 0.773 Vali Loss: 0.881 Vali Acc: 0.925 Test Loss: 0.881 Test Acc: 0.925
Validation loss decreased (-0.874990 --> -0.924991).  Saving model ...
Epoch: 8 cost time: 0.4083530902862549
Epoch: 8, Steps: 3 | Train Loss: 0.647 Vali Loss: 0.789 Vali Acc: 0.925 Test Loss: 0.789 Test Acc: 0.925
Validation loss decreased (-0.924991 --> -0.924992).  Saving model ...
Epoch: 9 cost time: 0.44582629203796387
Epoch: 9, Steps: 3 | Train Loss: 0.567 Vali Loss: 0.699 Vali Acc: 0.925 Test Loss: 0.699 Test Acc: 0.925
Validation loss decreased (-0.924992 --> -0.924993).  Saving model ...
Epoch: 10 cost time: 0.46911025047302246
Epoch: 10, Steps: 3 | Train Loss: 0.485 Vali Loss: 0.613 Vali Acc: 0.950 Test Loss: 0.613 Test Acc: 0.950
Validation loss decreased (-0.924993 --> -0.949994).  Saving model ...
Epoch: 11 cost time: 0.44057345390319824
Epoch: 11, Steps: 3 | Train Loss: 0.422 Vali Loss: 0.542 Vali Acc: 0.950 Test Loss: 0.542 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 12 cost time: 0.44059038162231445
Epoch: 12, Steps: 3 | Train Loss: 0.350 Vali Loss: 0.489 Vali Acc: 0.950 Test Loss: 0.489 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 13 cost time: 0.39956235885620117
Epoch: 13, Steps: 3 | Train Loss: 0.317 Vali Loss: 0.442 Vali Acc: 0.975 Test Loss: 0.442 Test Acc: 0.975
Validation loss decreased (-0.949995 --> -0.974996).  Saving model ...
Epoch: 14 cost time: 0.41622328758239746
Epoch: 14, Steps: 3 | Train Loss: 0.266 Vali Loss: 0.396 Vali Acc: 0.950 Test Loss: 0.396 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.3797733783721924
Epoch: 15, Steps: 3 | Train Loss: 0.234 Vali Loss: 0.362 Vali Acc: 0.950 Test Loss: 0.362 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.3644731044769287
Epoch: 16, Steps: 3 | Train Loss: 0.204 Vali Loss: 0.322 Vali Acc: 0.950 Test Loss: 0.322 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.512531042098999
Epoch: 17, Steps: 3 | Train Loss: 0.180 Vali Loss: 0.298 Vali Acc: 0.950 Test Loss: 0.298 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.4271354675292969
Epoch: 18, Steps: 3 | Train Loss: 0.148 Vali Loss: 0.273 Vali Acc: 0.950 Test Loss: 0.273 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.39862942695617676
Epoch: 19, Steps: 3 | Train Loss: 0.136 Vali Loss: 0.248 Vali Acc: 0.950 Test Loss: 0.248 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.46241044998168945
Epoch: 20, Steps: 3 | Train Loss: 0.122 Vali Loss: 0.228 Vali Acc: 0.975 Test Loss: 0.228 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974998).  Saving model ...
Epoch: 21 cost time: 0.3617217540740967
Epoch: 21, Steps: 3 | Train Loss: 0.117 Vali Loss: 0.212 Vali Acc: 0.975 Test Loss: 0.212 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 22 cost time: 0.4753303527832031
Epoch: 22, Steps: 3 | Train Loss: 0.093 Vali Loss: 0.197 Vali Acc: 0.975 Test Loss: 0.197 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 23 cost time: 0.4224872589111328
Epoch: 23, Steps: 3 | Train Loss: 0.082 Vali Loss: 0.190 Vali Acc: 0.950 Test Loss: 0.190 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.4277784824371338
Epoch: 24, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.186 Vali Acc: 0.950 Test Loss: 0.186 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.3916034698486328
Epoch: 25, Steps: 3 | Train Loss: 0.070 Vali Loss: 0.181 Vali Acc: 0.950 Test Loss: 0.181 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.4231266975402832
Epoch: 26, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.181 Vali Acc: 0.950 Test Loss: 0.181 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.4128389358520508
Epoch: 27, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.176 Vali Acc: 0.950 Test Loss: 0.176 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.43923139572143555
Epoch: 28, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.181 Vali Acc: 0.950 Test Loss: 0.181 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.41348767280578613
Epoch: 29, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.182 Vali Acc: 0.950 Test Loss: 0.182 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.4298267364501953
Epoch: 30, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.184 Vali Acc: 0.950 Test Loss: 0.184 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.4839918613433838
Epoch: 31, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.182 Vali Acc: 0.950 Test Loss: 0.182 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.4599766731262207
Epoch: 32, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.183 Vali Acc: 0.950 Test Loss: 0.183 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 616580
model size : 2.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.6023073196411133
Epoch: 1, Steps: 3 | Train Loss: 1.392 Vali Loss: 1.327 Vali Acc: 0.375 Test Loss: 1.327 Test Acc: 0.375
Validation loss decreased (inf --> -0.374987).  Saving model ...
Epoch: 2 cost time: 0.49024271965026855
Epoch: 2, Steps: 3 | Train Loss: 1.374 Vali Loss: 1.293 Vali Acc: 0.425 Test Loss: 1.293 Test Acc: 0.425
Validation loss decreased (-0.374987 --> -0.424987).  Saving model ...
Epoch: 3 cost time: 0.4195277690887451
Epoch: 3, Steps: 3 | Train Loss: 1.252 Vali Loss: 1.244 Vali Acc: 0.675 Test Loss: 1.244 Test Acc: 0.675
Validation loss decreased (-0.424987 --> -0.674988).  Saving model ...
Epoch: 4 cost time: 0.4848752021789551
Epoch: 4, Steps: 3 | Train Loss: 1.176 Vali Loss: 1.176 Vali Acc: 0.750 Test Loss: 1.176 Test Acc: 0.750
Validation loss decreased (-0.674988 --> -0.749988).  Saving model ...
Epoch: 5 cost time: 0.45295000076293945
Epoch: 5, Steps: 3 | Train Loss: 1.087 Vali Loss: 1.096 Vali Acc: 0.800 Test Loss: 1.096 Test Acc: 0.800
Validation loss decreased (-0.749988 --> -0.799989).  Saving model ...
Epoch: 6 cost time: 0.4664647579193115
Epoch: 6, Steps: 3 | Train Loss: 0.953 Vali Loss: 1.015 Vali Acc: 0.825 Test Loss: 1.015 Test Acc: 0.825
Validation loss decreased (-0.799989 --> -0.824990).  Saving model ...
Epoch: 7 cost time: 0.46980762481689453
Epoch: 7, Steps: 3 | Train Loss: 0.880 Vali Loss: 0.927 Vali Acc: 0.900 Test Loss: 0.927 Test Acc: 0.900
Validation loss decreased (-0.824990 --> -0.899991).  Saving model ...
Epoch: 8 cost time: 0.43047308921813965
Epoch: 8, Steps: 3 | Train Loss: 0.769 Vali Loss: 0.846 Vali Acc: 0.875 Test Loss: 0.846 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.4517340660095215
Epoch: 9, Steps: 3 | Train Loss: 0.708 Vali Loss: 0.756 Vali Acc: 0.900 Test Loss: 0.756 Test Acc: 0.900
Validation loss decreased (-0.899991 --> -0.899992).  Saving model ...
Epoch: 10 cost time: 0.41114282608032227
Epoch: 10, Steps: 3 | Train Loss: 0.583 Vali Loss: 0.678 Vali Acc: 0.900 Test Loss: 0.678 Test Acc: 0.900
Validation loss decreased (-0.899992 --> -0.899993).  Saving model ...
Epoch: 11 cost time: 0.5493066310882568
Epoch: 11, Steps: 3 | Train Loss: 0.534 Vali Loss: 0.612 Vali Acc: 0.900 Test Loss: 0.612 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899994).  Saving model ...
Epoch: 12 cost time: 0.3684804439544678
Epoch: 12, Steps: 3 | Train Loss: 0.469 Vali Loss: 0.542 Vali Acc: 0.925 Test Loss: 0.542 Test Acc: 0.925
Validation loss decreased (-0.899994 --> -0.924995).  Saving model ...
Epoch: 13 cost time: 0.4121401309967041
Epoch: 13, Steps: 3 | Train Loss: 0.409 Vali Loss: 0.493 Vali Acc: 0.975 Test Loss: 0.493 Test Acc: 0.975
Validation loss decreased (-0.924995 --> -0.974995).  Saving model ...
Epoch: 14 cost time: 0.49399900436401367
Epoch: 14, Steps: 3 | Train Loss: 0.367 Vali Loss: 0.455 Vali Acc: 0.975 Test Loss: 0.455 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 15 cost time: 0.3964402675628662
Epoch: 15, Steps: 3 | Train Loss: 0.319 Vali Loss: 0.409 Vali Acc: 0.975 Test Loss: 0.409 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 16 cost time: 0.3958292007446289
Epoch: 16, Steps: 3 | Train Loss: 0.292 Vali Loss: 0.370 Vali Acc: 0.975 Test Loss: 0.370 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 17 cost time: 0.40454530715942383
Epoch: 17, Steps: 3 | Train Loss: 0.262 Vali Loss: 0.332 Vali Acc: 0.975 Test Loss: 0.332 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 18 cost time: 0.3806624412536621
Epoch: 18, Steps: 3 | Train Loss: 0.253 Vali Loss: 0.303 Vali Acc: 0.975 Test Loss: 0.303 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 19 cost time: 0.39612364768981934
Epoch: 19, Steps: 3 | Train Loss: 0.216 Vali Loss: 0.280 Vali Acc: 0.975 Test Loss: 0.280 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 20 cost time: 0.4078836441040039
Epoch: 20, Steps: 3 | Train Loss: 0.202 Vali Loss: 0.264 Vali Acc: 0.975 Test Loss: 0.264 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 21 cost time: 0.4289205074310303
Epoch: 21, Steps: 3 | Train Loss: 0.169 Vali Loss: 0.251 Vali Acc: 0.975 Test Loss: 0.251 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 22 cost time: 0.45465946197509766
Epoch: 22, Steps: 3 | Train Loss: 0.155 Vali Loss: 0.238 Vali Acc: 0.975 Test Loss: 0.238 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 23 cost time: 0.47759103775024414
Epoch: 23, Steps: 3 | Train Loss: 0.140 Vali Loss: 0.226 Vali Acc: 0.975 Test Loss: 0.226 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 24 cost time: 0.4568624496459961
Epoch: 24, Steps: 3 | Train Loss: 0.124 Vali Loss: 0.211 Vali Acc: 0.975 Test Loss: 0.211 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 25 cost time: 0.4491708278656006
Epoch: 25, Steps: 3 | Train Loss: 0.115 Vali Loss: 0.208 Vali Acc: 0.975 Test Loss: 0.208 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 26 cost time: 0.44948697090148926
Epoch: 26, Steps: 3 | Train Loss: 0.117 Vali Loss: 0.198 Vali Acc: 0.975 Test Loss: 0.198 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 27 cost time: 0.5105018615722656
Epoch: 27, Steps: 3 | Train Loss: 0.076 Vali Loss: 0.180 Vali Acc: 0.975 Test Loss: 0.180 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 28 cost time: 0.4649655818939209
Epoch: 28, Steps: 3 | Train Loss: 0.081 Vali Loss: 0.173 Vali Acc: 0.975 Test Loss: 0.173 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 29 cost time: 0.43229031562805176
Epoch: 29, Steps: 3 | Train Loss: 0.082 Vali Loss: 0.165 Vali Acc: 0.975 Test Loss: 0.165 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 30 cost time: 0.4166746139526367
Epoch: 30, Steps: 3 | Train Loss: 0.073 Vali Loss: 0.164 Vali Acc: 0.975 Test Loss: 0.164 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 31 cost time: 0.43024539947509766
Epoch: 31, Steps: 3 | Train Loss: 0.055 Vali Loss: 0.151 Vali Acc: 0.975 Test Loss: 0.151 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 32 cost time: 0.4465758800506592
Epoch: 32, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.148 Vali Acc: 0.975 Test Loss: 0.148 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974999).  Saving model ...
Epoch: 33 cost time: 0.4703524112701416
Epoch: 33, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.138 Vali Acc: 0.975 Test Loss: 0.138 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 34 cost time: 0.42548036575317383
Epoch: 34, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.131 Vali Acc: 0.975 Test Loss: 0.131 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 35 cost time: 0.48466920852661133
Epoch: 35, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.130 Vali Acc: 0.975 Test Loss: 0.130 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 36 cost time: 0.4270634651184082
Epoch: 36, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.131 Vali Acc: 0.975 Test Loss: 0.131 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.4736979007720947
Epoch: 37, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.131 Vali Acc: 0.975 Test Loss: 0.131 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.44453954696655273
Epoch: 38, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.131 Vali Acc: 0.975 Test Loss: 0.131 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.4875297546386719
Epoch: 39, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.130 Vali Acc: 0.975 Test Loss: 0.130 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.46185898780822754
Epoch: 40, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.132 Vali Acc: 0.975 Test Loss: 0.132 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.46344995498657227
Epoch: 41, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.126 Vali Acc: 0.975 Test Loss: 0.126 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 42 cost time: 0.4682011604309082
Epoch: 42, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.124 Vali Acc: 0.975 Test Loss: 0.124 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 43 cost time: 0.4723091125488281
Epoch: 43, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.120 Vali Acc: 0.975 Test Loss: 0.120 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 44 cost time: 0.47193336486816406
Epoch: 44, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.118 Vali Acc: 0.975 Test Loss: 0.118 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 45 cost time: 0.4898953437805176
Epoch: 45, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.119 Vali Acc: 0.975 Test Loss: 0.119 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.49253344535827637
Epoch: 46, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.115 Vali Acc: 0.975 Test Loss: 0.115 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 47 cost time: 0.5116584300994873
Epoch: 47, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.117 Vali Acc: 0.975 Test Loss: 0.117 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.42354917526245117
Epoch: 48, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.117 Vali Acc: 0.975 Test Loss: 0.117 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.4200289249420166
Epoch: 49, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.118 Vali Acc: 0.975 Test Loss: 0.118 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.45848846435546875
Epoch: 50, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.120 Vali Acc: 0.975 Test Loss: 0.120 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 604484
model size : 2.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.7263715267181396
Epoch: 1, Steps: 3 | Train Loss: 1.347 Vali Loss: 1.362 Vali Acc: 0.175 Test Loss: 1.362 Test Acc: 0.175
Validation loss decreased (inf --> -0.174986).  Saving model ...
Epoch: 2 cost time: 0.47294068336486816
Epoch: 2, Steps: 3 | Train Loss: 1.321 Vali Loss: 1.342 Vali Acc: 0.175 Test Loss: 1.342 Test Acc: 0.175
Validation loss decreased (-0.174986 --> -0.174987).  Saving model ...
Epoch: 3 cost time: 0.4648885726928711
Epoch: 3, Steps: 3 | Train Loss: 1.281 Vali Loss: 1.306 Vali Acc: 0.225 Test Loss: 1.306 Test Acc: 0.225
Validation loss decreased (-0.174987 --> -0.224987).  Saving model ...
Epoch: 4 cost time: 0.4610567092895508
Epoch: 4, Steps: 3 | Train Loss: 1.209 Vali Loss: 1.259 Vali Acc: 0.325 Test Loss: 1.259 Test Acc: 0.325
Validation loss decreased (-0.224987 --> -0.324987).  Saving model ...
Epoch: 5 cost time: 0.48421168327331543
Epoch: 5, Steps: 3 | Train Loss: 1.132 Vali Loss: 1.197 Vali Acc: 0.450 Test Loss: 1.197 Test Acc: 0.450
Validation loss decreased (-0.324987 --> -0.449988).  Saving model ...
Epoch: 6 cost time: 0.47601795196533203
Epoch: 6, Steps: 3 | Train Loss: 1.054 Vali Loss: 1.124 Vali Acc: 0.550 Test Loss: 1.124 Test Acc: 0.550
Validation loss decreased (-0.449988 --> -0.549989).  Saving model ...
Epoch: 7 cost time: 0.4467127323150635
Epoch: 7, Steps: 3 | Train Loss: 0.928 Vali Loss: 1.051 Vali Acc: 0.675 Test Loss: 1.051 Test Acc: 0.675
Validation loss decreased (-0.549989 --> -0.674989).  Saving model ...
Epoch: 8 cost time: 0.4785768985748291
Epoch: 8, Steps: 3 | Train Loss: 0.849 Vali Loss: 0.979 Vali Acc: 0.825 Test Loss: 0.979 Test Acc: 0.825
Validation loss decreased (-0.674989 --> -0.824990).  Saving model ...
Epoch: 9 cost time: 0.46086645126342773
Epoch: 9, Steps: 3 | Train Loss: 0.778 Vali Loss: 0.900 Vali Acc: 0.850 Test Loss: 0.900 Test Acc: 0.850
Validation loss decreased (-0.824990 --> -0.849991).  Saving model ...
Epoch: 10 cost time: 0.4804263114929199
Epoch: 10, Steps: 3 | Train Loss: 0.689 Vali Loss: 0.831 Vali Acc: 0.875 Test Loss: 0.831 Test Acc: 0.875
Validation loss decreased (-0.849991 --> -0.874992).  Saving model ...
Epoch: 11 cost time: 0.5325384140014648
Epoch: 11, Steps: 3 | Train Loss: 0.624 Vali Loss: 0.748 Vali Acc: 0.875 Test Loss: 0.748 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874993).  Saving model ...
Epoch: 12 cost time: 0.4667198657989502
Epoch: 12, Steps: 3 | Train Loss: 0.596 Vali Loss: 0.672 Vali Acc: 0.900 Test Loss: 0.672 Test Acc: 0.900
Validation loss decreased (-0.874993 --> -0.899993).  Saving model ...
Epoch: 13 cost time: 0.4693324565887451
Epoch: 13, Steps: 3 | Train Loss: 0.477 Vali Loss: 0.605 Vali Acc: 0.900 Test Loss: 0.605 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899994).  Saving model ...
Epoch: 14 cost time: 0.45442986488342285
Epoch: 14, Steps: 3 | Train Loss: 0.429 Vali Loss: 0.558 Vali Acc: 0.925 Test Loss: 0.558 Test Acc: 0.925
Validation loss decreased (-0.899994 --> -0.924994).  Saving model ...
Epoch: 15 cost time: 0.48839521408081055
Epoch: 15, Steps: 3 | Train Loss: 0.378 Vali Loss: 0.527 Vali Acc: 0.850 Test Loss: 0.527 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.45273756980895996
Epoch: 16, Steps: 3 | Train Loss: 0.346 Vali Loss: 0.489 Vali Acc: 0.850 Test Loss: 0.489 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.50730299949646
Epoch: 17, Steps: 3 | Train Loss: 0.330 Vali Loss: 0.447 Vali Acc: 0.850 Test Loss: 0.447 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.4891011714935303
Epoch: 18, Steps: 3 | Train Loss: 0.299 Vali Loss: 0.421 Vali Acc: 0.900 Test Loss: 0.421 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.44072461128234863
Epoch: 19, Steps: 3 | Train Loss: 0.260 Vali Loss: 0.385 Vali Acc: 0.950 Test Loss: 0.385 Test Acc: 0.950
Validation loss decreased (-0.924994 --> -0.949996).  Saving model ...
Epoch: 20 cost time: 0.5032176971435547
Epoch: 20, Steps: 3 | Train Loss: 0.241 Vali Loss: 0.365 Vali Acc: 0.950 Test Loss: 0.365 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 21 cost time: 0.5889801979064941
Epoch: 21, Steps: 3 | Train Loss: 0.213 Vali Loss: 0.338 Vali Acc: 0.975 Test Loss: 0.338 Test Acc: 0.975
Validation loss decreased (-0.949996 --> -0.974997).  Saving model ...
Epoch: 22 cost time: 0.44516897201538086
Epoch: 22, Steps: 3 | Train Loss: 0.199 Vali Loss: 0.317 Vali Acc: 0.975 Test Loss: 0.317 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 23 cost time: 0.4350905418395996
Epoch: 23, Steps: 3 | Train Loss: 0.195 Vali Loss: 0.299 Vali Acc: 0.975 Test Loss: 0.299 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 24 cost time: 0.41645050048828125
Epoch: 24, Steps: 3 | Train Loss: 0.167 Vali Loss: 0.282 Vali Acc: 0.975 Test Loss: 0.282 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 25 cost time: 0.4812014102935791
Epoch: 25, Steps: 3 | Train Loss: 0.156 Vali Loss: 0.266 Vali Acc: 0.950 Test Loss: 0.266 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.4761972427368164
Epoch: 26, Steps: 3 | Train Loss: 0.143 Vali Loss: 0.253 Vali Acc: 0.950 Test Loss: 0.253 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.3876960277557373
Epoch: 27, Steps: 3 | Train Loss: 0.135 Vali Loss: 0.244 Vali Acc: 0.975 Test Loss: 0.244 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 28 cost time: 0.463728666305542
Epoch: 28, Steps: 3 | Train Loss: 0.120 Vali Loss: 0.229 Vali Acc: 0.975 Test Loss: 0.229 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 29 cost time: 0.44452619552612305
Epoch: 29, Steps: 3 | Train Loss: 0.107 Vali Loss: 0.223 Vali Acc: 0.975 Test Loss: 0.223 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 30 cost time: 0.43359375
Epoch: 30, Steps: 3 | Train Loss: 0.113 Vali Loss: 0.215 Vali Acc: 0.975 Test Loss: 0.215 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 31 cost time: 0.4606788158416748
Epoch: 31, Steps: 3 | Train Loss: 0.093 Vali Loss: 0.207 Vali Acc: 0.975 Test Loss: 0.207 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 32 cost time: 0.3776257038116455
Epoch: 32, Steps: 3 | Train Loss: 0.090 Vali Loss: 0.204 Vali Acc: 0.975 Test Loss: 0.204 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 33 cost time: 0.4254932403564453
Epoch: 33, Steps: 3 | Train Loss: 0.080 Vali Loss: 0.203 Vali Acc: 0.975 Test Loss: 0.203 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 34 cost time: 0.4084353446960449
Epoch: 34, Steps: 3 | Train Loss: 0.071 Vali Loss: 0.196 Vali Acc: 0.975 Test Loss: 0.196 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 35 cost time: 0.4327361583709717
Epoch: 35, Steps: 3 | Train Loss: 0.063 Vali Loss: 0.194 Vali Acc: 0.950 Test Loss: 0.194 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.43293309211730957
Epoch: 36, Steps: 3 | Train Loss: 0.062 Vali Loss: 0.193 Vali Acc: 0.950 Test Loss: 0.193 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.501488447189331
Epoch: 37, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.204 Vali Acc: 0.950 Test Loss: 0.204 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.41076159477233887
Epoch: 38, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.206 Vali Acc: 0.925 Test Loss: 0.206 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.4184262752532959
Epoch: 39, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.204 Vali Acc: 0.925 Test Loss: 0.204 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.5027475357055664
Epoch: 40, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.201 Vali Acc: 0.925 Test Loss: 0.201 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.5019001960754395
Epoch: 41, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.202 Vali Acc: 0.925 Test Loss: 0.202 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.4747297763824463
Epoch: 42, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.199 Vali Acc: 0.925 Test Loss: 0.199 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.44831275939941406
Epoch: 43, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.201 Vali Acc: 0.925 Test Loss: 0.201 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.4773294925689697
Epoch: 44, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.197 Vali Acc: 0.925 Test Loss: 0.197 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 595396
model size : 2.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.6904172897338867
Epoch: 1, Steps: 3 | Train Loss: 1.367 Vali Loss: 1.376 Vali Acc: 0.225 Test Loss: 1.376 Test Acc: 0.225
Validation loss decreased (inf --> -0.224986).  Saving model ...
Epoch: 2 cost time: 0.4807157516479492
Epoch: 2, Steps: 3 | Train Loss: 1.366 Vali Loss: 1.357 Vali Acc: 0.250 Test Loss: 1.357 Test Acc: 0.250
Validation loss decreased (-0.224986 --> -0.249986).  Saving model ...
Epoch: 3 cost time: 0.4351203441619873
Epoch: 3, Steps: 3 | Train Loss: 1.316 Vali Loss: 1.330 Vali Acc: 0.275 Test Loss: 1.330 Test Acc: 0.275
Validation loss decreased (-0.249986 --> -0.274987).  Saving model ...
Epoch: 4 cost time: 0.4331531524658203
Epoch: 4, Steps: 3 | Train Loss: 1.259 Vali Loss: 1.292 Vali Acc: 0.375 Test Loss: 1.292 Test Acc: 0.375
Validation loss decreased (-0.274987 --> -0.374987).  Saving model ...
Epoch: 5 cost time: 0.4288508892059326
Epoch: 5, Steps: 3 | Train Loss: 1.222 Vali Loss: 1.245 Vali Acc: 0.650 Test Loss: 1.245 Test Acc: 0.650
Validation loss decreased (-0.374987 --> -0.649988).  Saving model ...
Epoch: 6 cost time: 0.44814586639404297
Epoch: 6, Steps: 3 | Train Loss: 1.191 Vali Loss: 1.187 Vali Acc: 0.700 Test Loss: 1.187 Test Acc: 0.700
Validation loss decreased (-0.649988 --> -0.699988).  Saving model ...
Epoch: 7 cost time: 0.5166387557983398
Epoch: 7, Steps: 3 | Train Loss: 1.084 Vali Loss: 1.128 Vali Acc: 0.750 Test Loss: 1.128 Test Acc: 0.750
Validation loss decreased (-0.699988 --> -0.749989).  Saving model ...
Epoch: 8 cost time: 0.4638392925262451
Epoch: 8, Steps: 3 | Train Loss: 0.999 Vali Loss: 1.067 Vali Acc: 0.775 Test Loss: 1.067 Test Acc: 0.775
Validation loss decreased (-0.749989 --> -0.774989).  Saving model ...
Epoch: 9 cost time: 0.433699369430542
Epoch: 9, Steps: 3 | Train Loss: 0.918 Vali Loss: 1.010 Vali Acc: 0.775 Test Loss: 1.010 Test Acc: 0.775
Validation loss decreased (-0.774989 --> -0.774990).  Saving model ...
Epoch: 10 cost time: 0.44713401794433594
Epoch: 10, Steps: 3 | Train Loss: 0.869 Vali Loss: 0.952 Vali Acc: 0.825 Test Loss: 0.952 Test Acc: 0.825
Validation loss decreased (-0.774990 --> -0.824990).  Saving model ...
Epoch: 11 cost time: 0.4426276683807373
Epoch: 11, Steps: 3 | Train Loss: 0.793 Vali Loss: 0.904 Vali Acc: 0.850 Test Loss: 0.904 Test Acc: 0.850
Validation loss decreased (-0.824990 --> -0.849991).  Saving model ...
Epoch: 12 cost time: 0.5103158950805664
Epoch: 12, Steps: 3 | Train Loss: 0.735 Vali Loss: 0.843 Vali Acc: 0.875 Test Loss: 0.843 Test Acc: 0.875
Validation loss decreased (-0.849991 --> -0.874992).  Saving model ...
Epoch: 13 cost time: 0.4788527488708496
Epoch: 13, Steps: 3 | Train Loss: 0.662 Vali Loss: 0.790 Vali Acc: 0.875 Test Loss: 0.790 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874992).  Saving model ...
Epoch: 14 cost time: 0.4514613151550293
Epoch: 14, Steps: 3 | Train Loss: 0.620 Vali Loss: 0.739 Vali Acc: 0.875 Test Loss: 0.739 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874993).  Saving model ...
Epoch: 15 cost time: 0.4572768211364746
Epoch: 15, Steps: 3 | Train Loss: 0.586 Vali Loss: 0.690 Vali Acc: 0.900 Test Loss: 0.690 Test Acc: 0.900
Validation loss decreased (-0.874993 --> -0.899993).  Saving model ...
Epoch: 16 cost time: 0.4019901752471924
Epoch: 16, Steps: 3 | Train Loss: 0.526 Vali Loss: 0.651 Vali Acc: 0.900 Test Loss: 0.651 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 17 cost time: 0.49208927154541016
Epoch: 17, Steps: 3 | Train Loss: 0.491 Vali Loss: 0.613 Vali Acc: 0.900 Test Loss: 0.613 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899994).  Saving model ...
Epoch: 18 cost time: 0.4480714797973633
Epoch: 18, Steps: 3 | Train Loss: 0.463 Vali Loss: 0.570 Vali Acc: 0.900 Test Loss: 0.570 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 19 cost time: 0.5122940540313721
Epoch: 19, Steps: 3 | Train Loss: 0.435 Vali Loss: 0.532 Vali Acc: 0.900 Test Loss: 0.532 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 20 cost time: 0.4382898807525635
Epoch: 20, Steps: 3 | Train Loss: 0.418 Vali Loss: 0.501 Vali Acc: 0.900 Test Loss: 0.501 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 21 cost time: 0.46982860565185547
Epoch: 21, Steps: 3 | Train Loss: 0.339 Vali Loss: 0.473 Vali Acc: 0.925 Test Loss: 0.473 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924995).  Saving model ...
Epoch: 22 cost time: 0.4545145034790039
Epoch: 22, Steps: 3 | Train Loss: 0.328 Vali Loss: 0.445 Vali Acc: 0.925 Test Loss: 0.445 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 23 cost time: 0.43947744369506836
Epoch: 23, Steps: 3 | Train Loss: 0.333 Vali Loss: 0.423 Vali Acc: 0.925 Test Loss: 0.423 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 24 cost time: 0.45601511001586914
Epoch: 24, Steps: 3 | Train Loss: 0.296 Vali Loss: 0.401 Vali Acc: 0.925 Test Loss: 0.401 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 25 cost time: 0.4628000259399414
Epoch: 25, Steps: 3 | Train Loss: 0.268 Vali Loss: 0.379 Vali Acc: 0.925 Test Loss: 0.379 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 26 cost time: 0.4738025665283203
Epoch: 26, Steps: 3 | Train Loss: 0.249 Vali Loss: 0.361 Vali Acc: 0.950 Test Loss: 0.361 Test Acc: 0.950
Validation loss decreased (-0.924996 --> -0.949996).  Saving model ...
Epoch: 27 cost time: 0.5988051891326904
Epoch: 27, Steps: 3 | Train Loss: 0.219 Vali Loss: 0.353 Vali Acc: 0.950 Test Loss: 0.353 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 28 cost time: 0.4508817195892334
Epoch: 28, Steps: 3 | Train Loss: 0.229 Vali Loss: 0.339 Vali Acc: 0.950 Test Loss: 0.339 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 29 cost time: 0.4905893802642822
Epoch: 29, Steps: 3 | Train Loss: 0.205 Vali Loss: 0.319 Vali Acc: 0.950 Test Loss: 0.319 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 30 cost time: 0.5195846557617188
Epoch: 30, Steps: 3 | Train Loss: 0.177 Vali Loss: 0.300 Vali Acc: 0.950 Test Loss: 0.300 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 31 cost time: 0.44304919242858887
Epoch: 31, Steps: 3 | Train Loss: 0.170 Vali Loss: 0.298 Vali Acc: 0.950 Test Loss: 0.298 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 32 cost time: 0.5185372829437256
Epoch: 32, Steps: 3 | Train Loss: 0.156 Vali Loss: 0.290 Vali Acc: 0.950 Test Loss: 0.290 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 33 cost time: 0.4698948860168457
Epoch: 33, Steps: 3 | Train Loss: 0.136 Vali Loss: 0.272 Vali Acc: 0.950 Test Loss: 0.272 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 34 cost time: 0.4873182773590088
Epoch: 34, Steps: 3 | Train Loss: 0.145 Vali Loss: 0.261 Vali Acc: 0.950 Test Loss: 0.261 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 35 cost time: 0.5109255313873291
Epoch: 35, Steps: 3 | Train Loss: 0.124 Vali Loss: 0.255 Vali Acc: 0.950 Test Loss: 0.255 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 36 cost time: 0.48374462127685547
Epoch: 36, Steps: 3 | Train Loss: 0.122 Vali Loss: 0.248 Vali Acc: 0.950 Test Loss: 0.248 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 37 cost time: 0.41423559188842773
Epoch: 37, Steps: 3 | Train Loss: 0.103 Vali Loss: 0.243 Vali Acc: 0.950 Test Loss: 0.243 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 38 cost time: 0.4442455768585205
Epoch: 38, Steps: 3 | Train Loss: 0.091 Vali Loss: 0.229 Vali Acc: 0.950 Test Loss: 0.229 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 39 cost time: 0.446230411529541
Epoch: 39, Steps: 3 | Train Loss: 0.105 Vali Loss: 0.225 Vali Acc: 0.950 Test Loss: 0.225 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 40 cost time: 0.3938562870025635
Epoch: 40, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.212 Vali Acc: 0.950 Test Loss: 0.212 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 41 cost time: 0.45705723762512207
Epoch: 41, Steps: 3 | Train Loss: 0.079 Vali Loss: 0.206 Vali Acc: 0.950 Test Loss: 0.206 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 42 cost time: 0.4161062240600586
Epoch: 42, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.208 Vali Acc: 0.950 Test Loss: 0.208 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.4686286449432373
Epoch: 43, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.196 Vali Acc: 0.950 Test Loss: 0.196 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 44 cost time: 0.5223724842071533
Epoch: 44, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.187 Vali Acc: 0.950 Test Loss: 0.187 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 45 cost time: 0.45674896240234375
Epoch: 45, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.186 Vali Acc: 0.950 Test Loss: 0.186 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 46 cost time: 0.4994943141937256
Epoch: 46, Steps: 3 | Train Loss: 0.055 Vali Loss: 0.181 Vali Acc: 0.950 Test Loss: 0.181 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 47 cost time: 0.48839330673217773
Epoch: 47, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.171 Vali Acc: 0.950 Test Loss: 0.171 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 48 cost time: 0.4696345329284668
Epoch: 48, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.162 Vali Acc: 0.950 Test Loss: 0.162 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 49 cost time: 0.4623682498931885
Epoch: 49, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.159 Vali Acc: 0.950 Test Loss: 0.159 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 50 cost time: 0.4492073059082031
Epoch: 50, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.154 Vali Acc: 0.950 Test Loss: 0.154 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 583428
model size : 2.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps20_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.6173508167266846
Epoch: 1, Steps: 3 | Train Loss: 1.433 Vali Loss: 1.377 Vali Acc: 0.225 Test Loss: 1.377 Test Acc: 0.225
Validation loss decreased (inf --> -0.224986).  Saving model ...
Epoch: 2 cost time: 0.4771268367767334
Epoch: 2, Steps: 3 | Train Loss: 1.358 Vali Loss: 1.364 Vali Acc: 0.225 Test Loss: 1.364 Test Acc: 0.225
Validation loss decreased (-0.224986 --> -0.224986).  Saving model ...
Epoch: 3 cost time: 0.44637227058410645
Epoch: 3, Steps: 3 | Train Loss: 1.342 Vali Loss: 1.347 Vali Acc: 0.275 Test Loss: 1.347 Test Acc: 0.275
Validation loss decreased (-0.224986 --> -0.274987).  Saving model ...
Epoch: 4 cost time: 0.4677748680114746
Epoch: 4, Steps: 3 | Train Loss: 1.298 Vali Loss: 1.322 Vali Acc: 0.275 Test Loss: 1.322 Test Acc: 0.275
Validation loss decreased (-0.274987 --> -0.274987).  Saving model ...
Epoch: 5 cost time: 0.45806312561035156
Epoch: 5, Steps: 3 | Train Loss: 1.230 Vali Loss: 1.287 Vali Acc: 0.325 Test Loss: 1.287 Test Acc: 0.325
Validation loss decreased (-0.274987 --> -0.324987).  Saving model ...
Epoch: 6 cost time: 0.5095522403717041
Epoch: 6, Steps: 3 | Train Loss: 1.176 Vali Loss: 1.245 Vali Acc: 0.375 Test Loss: 1.245 Test Acc: 0.375
Validation loss decreased (-0.324987 --> -0.374988).  Saving model ...
Epoch: 7 cost time: 0.4532160758972168
Epoch: 7, Steps: 3 | Train Loss: 1.120 Vali Loss: 1.200 Vali Acc: 0.475 Test Loss: 1.200 Test Acc: 0.475
Validation loss decreased (-0.374988 --> -0.474988).  Saving model ...
Epoch: 8 cost time: 0.4385693073272705
Epoch: 8, Steps: 3 | Train Loss: 1.072 Vali Loss: 1.149 Vali Acc: 0.625 Test Loss: 1.149 Test Acc: 0.625
Validation loss decreased (-0.474988 --> -0.624989).  Saving model ...
Epoch: 9 cost time: 0.3956267833709717
Epoch: 9, Steps: 3 | Train Loss: 0.986 Vali Loss: 1.097 Vali Acc: 0.750 Test Loss: 1.097 Test Acc: 0.750
Validation loss decreased (-0.624989 --> -0.749989).  Saving model ...
Epoch: 10 cost time: 0.43114614486694336
Epoch: 10, Steps: 3 | Train Loss: 0.939 Vali Loss: 1.039 Vali Acc: 0.825 Test Loss: 1.039 Test Acc: 0.825
Validation loss decreased (-0.749989 --> -0.824990).  Saving model ...
Epoch: 11 cost time: 0.5481436252593994
Epoch: 11, Steps: 3 | Train Loss: 0.868 Vali Loss: 0.989 Vali Acc: 0.825 Test Loss: 0.989 Test Acc: 0.825
Validation loss decreased (-0.824990 --> -0.824990).  Saving model ...
Epoch: 12 cost time: 0.46620655059814453
Epoch: 12, Steps: 3 | Train Loss: 0.796 Vali Loss: 0.939 Vali Acc: 0.850 Test Loss: 0.939 Test Acc: 0.850
Validation loss decreased (-0.824990 --> -0.849991).  Saving model ...
Epoch: 13 cost time: 0.39503979682922363
Epoch: 13, Steps: 3 | Train Loss: 0.732 Vali Loss: 0.893 Vali Acc: 0.875 Test Loss: 0.893 Test Acc: 0.875
Validation loss decreased (-0.849991 --> -0.874991).  Saving model ...
Epoch: 14 cost time: 0.39487791061401367
Epoch: 14, Steps: 3 | Train Loss: 0.716 Vali Loss: 0.841 Vali Acc: 0.875 Test Loss: 0.841 Test Acc: 0.875
Validation loss decreased (-0.874991 --> -0.874992).  Saving model ...
Epoch: 15 cost time: 0.38823747634887695
Epoch: 15, Steps: 3 | Train Loss: 0.664 Vali Loss: 0.788 Vali Acc: 0.875 Test Loss: 0.788 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874992).  Saving model ...
Epoch: 16 cost time: 0.44225263595581055
Epoch: 16, Steps: 3 | Train Loss: 0.625 Vali Loss: 0.740 Vali Acc: 0.900 Test Loss: 0.740 Test Acc: 0.900
Validation loss decreased (-0.874992 --> -0.899993).  Saving model ...
Epoch: 17 cost time: 0.5215184688568115
Epoch: 17, Steps: 3 | Train Loss: 0.559 Vali Loss: 0.707 Vali Acc: 0.900 Test Loss: 0.707 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 18 cost time: 0.41369009017944336
Epoch: 18, Steps: 3 | Train Loss: 0.551 Vali Loss: 0.672 Vali Acc: 0.900 Test Loss: 0.672 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 19 cost time: 0.4605696201324463
Epoch: 19, Steps: 3 | Train Loss: 0.469 Vali Loss: 0.647 Vali Acc: 0.900 Test Loss: 0.647 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899994).  Saving model ...
Epoch: 20 cost time: 0.4801478385925293
Epoch: 20, Steps: 3 | Train Loss: 0.455 Vali Loss: 0.610 Vali Acc: 0.925 Test Loss: 0.610 Test Acc: 0.925
Validation loss decreased (-0.899994 --> -0.924994).  Saving model ...
Epoch: 21 cost time: 0.526831865310669
Epoch: 21, Steps: 3 | Train Loss: 0.411 Vali Loss: 0.588 Vali Acc: 0.925 Test Loss: 0.588 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 22 cost time: 0.4839437007904053
Epoch: 22, Steps: 3 | Train Loss: 0.382 Vali Loss: 0.550 Vali Acc: 0.925 Test Loss: 0.550 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 23 cost time: 0.4627964496612549
Epoch: 23, Steps: 3 | Train Loss: 0.359 Vali Loss: 0.531 Vali Acc: 0.925 Test Loss: 0.531 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 24 cost time: 0.425753116607666
Epoch: 24, Steps: 3 | Train Loss: 0.350 Vali Loss: 0.500 Vali Acc: 0.925 Test Loss: 0.500 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 25 cost time: 0.4031710624694824
Epoch: 25, Steps: 3 | Train Loss: 0.332 Vali Loss: 0.470 Vali Acc: 0.925 Test Loss: 0.470 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 26 cost time: 0.44331812858581543
Epoch: 26, Steps: 3 | Train Loss: 0.320 Vali Loss: 0.441 Vali Acc: 0.925 Test Loss: 0.441 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 27 cost time: 0.4194509983062744
Epoch: 27, Steps: 3 | Train Loss: 0.288 Vali Loss: 0.423 Vali Acc: 0.925 Test Loss: 0.423 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 28 cost time: 0.42163515090942383
Epoch: 28, Steps: 3 | Train Loss: 0.261 Vali Loss: 0.403 Vali Acc: 0.925 Test Loss: 0.403 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 29 cost time: 0.4239935874938965
Epoch: 29, Steps: 3 | Train Loss: 0.243 Vali Loss: 0.381 Vali Acc: 0.925 Test Loss: 0.381 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 30 cost time: 0.4707944393157959
Epoch: 30, Steps: 3 | Train Loss: 0.227 Vali Loss: 0.370 Vali Acc: 0.925 Test Loss: 0.370 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 31 cost time: 0.45200061798095703
Epoch: 31, Steps: 3 | Train Loss: 0.209 Vali Loss: 0.365 Vali Acc: 0.925 Test Loss: 0.365 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 32 cost time: 0.4687464237213135
Epoch: 32, Steps: 3 | Train Loss: 0.199 Vali Loss: 0.342 Vali Acc: 0.950 Test Loss: 0.342 Test Acc: 0.950
Validation loss decreased (-0.924996 --> -0.949997).  Saving model ...
Epoch: 33 cost time: 0.49720048904418945
Epoch: 33, Steps: 3 | Train Loss: 0.194 Vali Loss: 0.327 Vali Acc: 0.975 Test Loss: 0.327 Test Acc: 0.975
Validation loss decreased (-0.949997 --> -0.974997).  Saving model ...
Epoch: 34 cost time: 0.4604942798614502
Epoch: 34, Steps: 3 | Train Loss: 0.204 Vali Loss: 0.322 Vali Acc: 0.975 Test Loss: 0.322 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 35 cost time: 0.455277681350708
Epoch: 35, Steps: 3 | Train Loss: 0.174 Vali Loss: 0.315 Vali Acc: 0.975 Test Loss: 0.315 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 36 cost time: 0.4444608688354492
Epoch: 36, Steps: 3 | Train Loss: 0.163 Vali Loss: 0.306 Vali Acc: 0.975 Test Loss: 0.306 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 37 cost time: 0.5356478691101074
Epoch: 37, Steps: 3 | Train Loss: 0.150 Vali Loss: 0.293 Vali Acc: 0.975 Test Loss: 0.293 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 38 cost time: 0.4844191074371338
Epoch: 38, Steps: 3 | Train Loss: 0.140 Vali Loss: 0.282 Vali Acc: 0.975 Test Loss: 0.282 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 39 cost time: 0.5530450344085693
Epoch: 39, Steps: 3 | Train Loss: 0.136 Vali Loss: 0.274 Vali Acc: 0.975 Test Loss: 0.274 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 40 cost time: 0.638451099395752
Epoch: 40, Steps: 3 | Train Loss: 0.122 Vali Loss: 0.263 Vali Acc: 0.975 Test Loss: 0.263 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 41 cost time: 0.5163090229034424
Epoch: 41, Steps: 3 | Train Loss: 0.137 Vali Loss: 0.252 Vali Acc: 0.975 Test Loss: 0.252 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 42 cost time: 0.48468899726867676
Epoch: 42, Steps: 3 | Train Loss: 0.118 Vali Loss: 0.244 Vali Acc: 0.975 Test Loss: 0.244 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 43 cost time: 0.49805355072021484
Epoch: 43, Steps: 3 | Train Loss: 0.102 Vali Loss: 0.241 Vali Acc: 0.975 Test Loss: 0.241 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 44 cost time: 0.4009573459625244
Epoch: 44, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.241 Vali Acc: 0.975 Test Loss: 0.241 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 45 cost time: 0.4224131107330322
Epoch: 45, Steps: 3 | Train Loss: 0.087 Vali Loss: 0.233 Vali Acc: 0.975 Test Loss: 0.233 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 46 cost time: 0.5009255409240723
Epoch: 46, Steps: 3 | Train Loss: 0.079 Vali Loss: 0.223 Vali Acc: 0.975 Test Loss: 0.223 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 47 cost time: 0.5238046646118164
Epoch: 47, Steps: 3 | Train Loss: 0.078 Vali Loss: 0.220 Vali Acc: 0.975 Test Loss: 0.220 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 48 cost time: 0.478395938873291
Epoch: 48, Steps: 3 | Train Loss: 0.073 Vali Loss: 0.213 Vali Acc: 0.975 Test Loss: 0.213 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 49 cost time: 0.46213650703430176
Epoch: 49, Steps: 3 | Train Loss: 0.062 Vali Loss: 0.205 Vali Acc: 0.975 Test Loss: 0.205 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 50 cost time: 0.5510475635528564
Epoch: 50, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.196 Vali Acc: 0.975 Test Loss: 0.196 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps20_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 580676
model size : 2.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps25_str13_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.7020282745361328
Epoch: 1, Steps: 3 | Train Loss: 1.466 Vali Loss: 1.433 Vali Acc: 0.225 Test Loss: 1.433 Test Acc: 0.225
Validation loss decreased (inf --> -0.224986).  Saving model ...
Epoch: 2 cost time: 0.44416189193725586
Epoch: 2, Steps: 3 | Train Loss: 1.428 Vali Loss: 1.422 Vali Acc: 0.225 Test Loss: 1.422 Test Acc: 0.225
Validation loss decreased (-0.224986 --> -0.224986).  Saving model ...
Epoch: 3 cost time: 0.4535484313964844
Epoch: 3, Steps: 3 | Train Loss: 1.379 Vali Loss: 1.407 Vali Acc: 0.250 Test Loss: 1.407 Test Acc: 0.250
Validation loss decreased (-0.224986 --> -0.249986).  Saving model ...
Epoch: 4 cost time: 0.45773839950561523
Epoch: 4, Steps: 3 | Train Loss: 1.345 Vali Loss: 1.382 Vali Acc: 0.350 Test Loss: 1.382 Test Acc: 0.350
Validation loss decreased (-0.249986 --> -0.349986).  Saving model ...
Epoch: 5 cost time: 0.4693715572357178
Epoch: 5, Steps: 3 | Train Loss: 1.308 Vali Loss: 1.349 Vali Acc: 0.450 Test Loss: 1.349 Test Acc: 0.450
Validation loss decreased (-0.349986 --> -0.449987).  Saving model ...
Epoch: 6 cost time: 0.4028596878051758
Epoch: 6, Steps: 3 | Train Loss: 1.230 Vali Loss: 1.309 Vali Acc: 0.550 Test Loss: 1.309 Test Acc: 0.550
Validation loss decreased (-0.449987 --> -0.549987).  Saving model ...
Epoch: 7 cost time: 0.43027305603027344
Epoch: 7, Steps: 3 | Train Loss: 1.194 Vali Loss: 1.263 Vali Acc: 0.650 Test Loss: 1.263 Test Acc: 0.650
Validation loss decreased (-0.549987 --> -0.649987).  Saving model ...
Epoch: 8 cost time: 0.437511682510376
Epoch: 8, Steps: 3 | Train Loss: 1.125 Vali Loss: 1.216 Vali Acc: 0.675 Test Loss: 1.216 Test Acc: 0.675
Validation loss decreased (-0.649987 --> -0.674988).  Saving model ...
Epoch: 9 cost time: 0.44701695442199707
Epoch: 9, Steps: 3 | Train Loss: 1.049 Vali Loss: 1.163 Vali Acc: 0.750 Test Loss: 1.163 Test Acc: 0.750
Validation loss decreased (-0.674988 --> -0.749988).  Saving model ...
Epoch: 10 cost time: 0.44306254386901855
Epoch: 10, Steps: 3 | Train Loss: 1.000 Vali Loss: 1.112 Vali Acc: 0.725 Test Loss: 1.112 Test Acc: 0.725
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.44923830032348633
Epoch: 11, Steps: 3 | Train Loss: 0.958 Vali Loss: 1.060 Vali Acc: 0.850 Test Loss: 1.060 Test Acc: 0.850
Validation loss decreased (-0.749988 --> -0.849989).  Saving model ...
Epoch: 12 cost time: 0.42321324348449707
Epoch: 12, Steps: 3 | Train Loss: 0.879 Vali Loss: 1.015 Vali Acc: 0.875 Test Loss: 1.015 Test Acc: 0.875
Validation loss decreased (-0.849989 --> -0.874990).  Saving model ...
Epoch: 13 cost time: 0.3987390995025635
Epoch: 13, Steps: 3 | Train Loss: 0.829 Vali Loss: 0.969 Vali Acc: 0.875 Test Loss: 0.969 Test Acc: 0.875
Validation loss decreased (-0.874990 --> -0.874990).  Saving model ...
Epoch: 14 cost time: 0.40976476669311523
Epoch: 14, Steps: 3 | Train Loss: 0.777 Vali Loss: 0.923 Vali Acc: 0.875 Test Loss: 0.923 Test Acc: 0.875
Validation loss decreased (-0.874990 --> -0.874991).  Saving model ...
Epoch: 15 cost time: 0.46433568000793457
Epoch: 15, Steps: 3 | Train Loss: 0.728 Vali Loss: 0.875 Vali Acc: 0.875 Test Loss: 0.875 Test Acc: 0.875
Validation loss decreased (-0.874991 --> -0.874991).  Saving model ...
Epoch: 16 cost time: 0.461106538772583
Epoch: 16, Steps: 3 | Train Loss: 0.688 Vali Loss: 0.825 Vali Acc: 0.875 Test Loss: 0.825 Test Acc: 0.875
Validation loss decreased (-0.874991 --> -0.874992).  Saving model ...
Epoch: 17 cost time: 0.4916996955871582
Epoch: 17, Steps: 3 | Train Loss: 0.635 Vali Loss: 0.786 Vali Acc: 0.875 Test Loss: 0.786 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874992).  Saving model ...
Epoch: 18 cost time: 0.4719119071960449
Epoch: 18, Steps: 3 | Train Loss: 0.593 Vali Loss: 0.761 Vali Acc: 0.875 Test Loss: 0.761 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874992).  Saving model ...
Epoch: 19 cost time: 0.41941165924072266
Epoch: 19, Steps: 3 | Train Loss: 0.525 Vali Loss: 0.732 Vali Acc: 0.875 Test Loss: 0.732 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874993).  Saving model ...
Epoch: 20 cost time: 0.452817440032959
Epoch: 20, Steps: 3 | Train Loss: 0.523 Vali Loss: 0.698 Vali Acc: 0.900 Test Loss: 0.698 Test Acc: 0.900
Validation loss decreased (-0.874993 --> -0.899993).  Saving model ...
Epoch: 21 cost time: 0.43878626823425293
Epoch: 21, Steps: 3 | Train Loss: 0.483 Vali Loss: 0.664 Vali Acc: 0.925 Test Loss: 0.664 Test Acc: 0.925
Validation loss decreased (-0.899993 --> -0.924993).  Saving model ...
Epoch: 22 cost time: 0.45473361015319824
Epoch: 22, Steps: 3 | Train Loss: 0.451 Vali Loss: 0.632 Vali Acc: 0.925 Test Loss: 0.632 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924994).  Saving model ...
Epoch: 23 cost time: 0.42647242546081543
Epoch: 23, Steps: 3 | Train Loss: 0.441 Vali Loss: 0.605 Vali Acc: 0.925 Test Loss: 0.605 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 24 cost time: 0.48759961128234863
Epoch: 24, Steps: 3 | Train Loss: 0.409 Vali Loss: 0.581 Vali Acc: 0.925 Test Loss: 0.581 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 25 cost time: 0.48447513580322266
Epoch: 25, Steps: 3 | Train Loss: 0.377 Vali Loss: 0.556 Vali Acc: 0.950 Test Loss: 0.556 Test Acc: 0.950
Validation loss decreased (-0.924994 --> -0.949994).  Saving model ...
Epoch: 26 cost time: 0.4287679195404053
Epoch: 26, Steps: 3 | Train Loss: 0.354 Vali Loss: 0.536 Vali Acc: 0.950 Test Loss: 0.536 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 27 cost time: 0.4871482849121094
Epoch: 27, Steps: 3 | Train Loss: 0.341 Vali Loss: 0.515 Vali Acc: 0.950 Test Loss: 0.515 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 28 cost time: 0.5355739593505859
Epoch: 28, Steps: 3 | Train Loss: 0.294 Vali Loss: 0.510 Vali Acc: 0.950 Test Loss: 0.510 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 29 cost time: 0.4640505313873291
Epoch: 29, Steps: 3 | Train Loss: 0.304 Vali Loss: 0.496 Vali Acc: 0.950 Test Loss: 0.496 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 30 cost time: 0.5100603103637695
Epoch: 30, Steps: 3 | Train Loss: 0.268 Vali Loss: 0.486 Vali Acc: 0.950 Test Loss: 0.486 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 31 cost time: 0.47096776962280273
Epoch: 31, Steps: 3 | Train Loss: 0.250 Vali Loss: 0.472 Vali Acc: 0.950 Test Loss: 0.472 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 32 cost time: 0.4419395923614502
Epoch: 32, Steps: 3 | Train Loss: 0.248 Vali Loss: 0.458 Vali Acc: 0.950 Test Loss: 0.458 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 33 cost time: 0.48210573196411133
Epoch: 33, Steps: 3 | Train Loss: 0.205 Vali Loss: 0.434 Vali Acc: 0.950 Test Loss: 0.434 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 34 cost time: 0.5027875900268555
Epoch: 34, Steps: 3 | Train Loss: 0.196 Vali Loss: 0.427 Vali Acc: 0.950 Test Loss: 0.427 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 35 cost time: 0.46628499031066895
Epoch: 35, Steps: 3 | Train Loss: 0.193 Vali Loss: 0.418 Vali Acc: 0.950 Test Loss: 0.418 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 36 cost time: 0.47803235054016113
Epoch: 36, Steps: 3 | Train Loss: 0.189 Vali Loss: 0.395 Vali Acc: 0.950 Test Loss: 0.395 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 37 cost time: 0.4628627300262451
Epoch: 37, Steps: 3 | Train Loss: 0.178 Vali Loss: 0.394 Vali Acc: 0.950 Test Loss: 0.394 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 38 cost time: 0.43939208984375
Epoch: 38, Steps: 3 | Train Loss: 0.180 Vali Loss: 0.375 Vali Acc: 0.950 Test Loss: 0.375 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 39 cost time: 0.5097684860229492
Epoch: 39, Steps: 3 | Train Loss: 0.151 Vali Loss: 0.356 Vali Acc: 0.950 Test Loss: 0.356 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 40 cost time: 0.421248197555542
Epoch: 40, Steps: 3 | Train Loss: 0.142 Vali Loss: 0.349 Vali Acc: 0.950 Test Loss: 0.349 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 41 cost time: 0.4536397457122803
Epoch: 41, Steps: 3 | Train Loss: 0.146 Vali Loss: 0.338 Vali Acc: 0.950 Test Loss: 0.338 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 42 cost time: 0.471660852432251
Epoch: 42, Steps: 3 | Train Loss: 0.117 Vali Loss: 0.328 Vali Acc: 0.950 Test Loss: 0.328 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 43 cost time: 0.4993627071380615
Epoch: 43, Steps: 3 | Train Loss: 0.112 Vali Loss: 0.324 Vali Acc: 0.950 Test Loss: 0.324 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 44 cost time: 0.43626999855041504
Epoch: 44, Steps: 3 | Train Loss: 0.110 Vali Loss: 0.322 Vali Acc: 0.950 Test Loss: 0.322 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 45 cost time: 0.42967915534973145
Epoch: 45, Steps: 3 | Train Loss: 0.119 Vali Loss: 0.318 Vali Acc: 0.950 Test Loss: 0.318 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 46 cost time: 0.4706695079803467
Epoch: 46, Steps: 3 | Train Loss: 0.098 Vali Loss: 0.315 Vali Acc: 0.950 Test Loss: 0.315 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 47 cost time: 0.4583115577697754
Epoch: 47, Steps: 3 | Train Loss: 0.080 Vali Loss: 0.312 Vali Acc: 0.925 Test Loss: 0.312 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.4751765727996826
Epoch: 48, Steps: 3 | Train Loss: 0.082 Vali Loss: 0.301 Vali Acc: 0.925 Test Loss: 0.301 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.4154355525970459
Epoch: 49, Steps: 3 | Train Loss: 0.088 Vali Loss: 0.304 Vali Acc: 0.925 Test Loss: 0.304 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.5376284122467041
Epoch: 50, Steps: 3 | Train Loss: 0.081 Vali Loss: 0.300 Vali Acc: 0.925 Test Loss: 0.300 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps25_str13_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 577924
model size : 2.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.486520528793335
Epoch: 1, Steps: 3 | Train Loss: 1.467 Vali Loss: 1.445 Vali Acc: 0.325 Test Loss: 1.445 Test Acc: 0.325
Validation loss decreased (inf --> -0.324986).  Saving model ...
Epoch: 2 cost time: 0.45544934272766113
Epoch: 2, Steps: 3 | Train Loss: 1.456 Vali Loss: 1.419 Vali Acc: 0.400 Test Loss: 1.419 Test Acc: 0.400
Validation loss decreased (-0.324986 --> -0.399986).  Saving model ...
Epoch: 3 cost time: 0.5602428913116455
Epoch: 3, Steps: 3 | Train Loss: 1.378 Vali Loss: 1.377 Vali Acc: 0.475 Test Loss: 1.377 Test Acc: 0.475
Validation loss decreased (-0.399986 --> -0.474986).  Saving model ...
Epoch: 4 cost time: 0.4828920364379883
Epoch: 4, Steps: 3 | Train Loss: 1.278 Vali Loss: 1.316 Vali Acc: 0.600 Test Loss: 1.316 Test Acc: 0.600
Validation loss decreased (-0.474986 --> -0.599987).  Saving model ...
Epoch: 5 cost time: 0.439115047454834
Epoch: 5, Steps: 3 | Train Loss: 1.189 Vali Loss: 1.241 Vali Acc: 0.675 Test Loss: 1.241 Test Acc: 0.675
Validation loss decreased (-0.599987 --> -0.674988).  Saving model ...
Epoch: 6 cost time: 0.4251532554626465
Epoch: 6, Steps: 3 | Train Loss: 1.086 Vali Loss: 1.161 Vali Acc: 0.725 Test Loss: 1.161 Test Acc: 0.725
Validation loss decreased (-0.674988 --> -0.724988).  Saving model ...
Epoch: 7 cost time: 0.41999125480651855
Epoch: 7, Steps: 3 | Train Loss: 0.982 Vali Loss: 1.079 Vali Acc: 0.850 Test Loss: 1.079 Test Acc: 0.850
Validation loss decreased (-0.724988 --> -0.849989).  Saving model ...
Epoch: 8 cost time: 0.40976619720458984
Epoch: 8, Steps: 3 | Train Loss: 0.876 Vali Loss: 0.992 Vali Acc: 0.925 Test Loss: 0.992 Test Acc: 0.925
Validation loss decreased (-0.849989 --> -0.924990).  Saving model ...
Epoch: 9 cost time: 0.43919873237609863
Epoch: 9, Steps: 3 | Train Loss: 0.806 Vali Loss: 0.908 Vali Acc: 0.925 Test Loss: 0.908 Test Acc: 0.925
Validation loss decreased (-0.924990 --> -0.924991).  Saving model ...
Epoch: 10 cost time: 0.4779233932495117
Epoch: 10, Steps: 3 | Train Loss: 0.721 Vali Loss: 0.824 Vali Acc: 0.900 Test Loss: 0.824 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5100741386413574
Epoch: 11, Steps: 3 | Train Loss: 0.619 Vali Loss: 0.755 Vali Acc: 0.950 Test Loss: 0.755 Test Acc: 0.950
Validation loss decreased (-0.924991 --> -0.949992).  Saving model ...
Epoch: 12 cost time: 0.47249650955200195
Epoch: 12, Steps: 3 | Train Loss: 0.562 Vali Loss: 0.682 Vali Acc: 0.925 Test Loss: 0.682 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5248959064483643
Epoch: 13, Steps: 3 | Train Loss: 0.491 Vali Loss: 0.624 Vali Acc: 0.950 Test Loss: 0.624 Test Acc: 0.950
Validation loss decreased (-0.949992 --> -0.949994).  Saving model ...
Epoch: 14 cost time: 0.4599583148956299
Epoch: 14, Steps: 3 | Train Loss: 0.455 Vali Loss: 0.575 Vali Acc: 0.925 Test Loss: 0.575 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.4287595748901367
Epoch: 15, Steps: 3 | Train Loss: 0.391 Vali Loss: 0.546 Vali Acc: 0.925 Test Loss: 0.546 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.5100908279418945
Epoch: 16, Steps: 3 | Train Loss: 0.363 Vali Loss: 0.494 Vali Acc: 0.925 Test Loss: 0.494 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.46507740020751953
Epoch: 17, Steps: 3 | Train Loss: 0.338 Vali Loss: 0.460 Vali Acc: 0.950 Test Loss: 0.460 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 18 cost time: 0.4542107582092285
Epoch: 18, Steps: 3 | Train Loss: 0.298 Vali Loss: 0.440 Vali Acc: 0.950 Test Loss: 0.440 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 19 cost time: 0.3950052261352539
Epoch: 19, Steps: 3 | Train Loss: 0.283 Vali Loss: 0.405 Vali Acc: 0.950 Test Loss: 0.405 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 20 cost time: 0.458085298538208
Epoch: 20, Steps: 3 | Train Loss: 0.237 Vali Loss: 0.378 Vali Acc: 0.950 Test Loss: 0.378 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 21 cost time: 0.44191551208496094
Epoch: 21, Steps: 3 | Train Loss: 0.209 Vali Loss: 0.350 Vali Acc: 0.950 Test Loss: 0.350 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 22 cost time: 0.44956207275390625
Epoch: 22, Steps: 3 | Train Loss: 0.226 Vali Loss: 0.333 Vali Acc: 0.950 Test Loss: 0.333 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 23 cost time: 0.4316892623901367
Epoch: 23, Steps: 3 | Train Loss: 0.181 Vali Loss: 0.312 Vali Acc: 0.950 Test Loss: 0.312 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 24 cost time: 0.4441518783569336
Epoch: 24, Steps: 3 | Train Loss: 0.176 Vali Loss: 0.296 Vali Acc: 0.950 Test Loss: 0.296 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 25 cost time: 0.4326817989349365
Epoch: 25, Steps: 3 | Train Loss: 0.153 Vali Loss: 0.291 Vali Acc: 0.950 Test Loss: 0.291 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 26 cost time: 0.4794332981109619
Epoch: 26, Steps: 3 | Train Loss: 0.148 Vali Loss: 0.281 Vali Acc: 0.950 Test Loss: 0.281 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 27 cost time: 0.42729759216308594
Epoch: 27, Steps: 3 | Train Loss: 0.136 Vali Loss: 0.265 Vali Acc: 0.950 Test Loss: 0.265 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 28 cost time: 0.38502931594848633
Epoch: 28, Steps: 3 | Train Loss: 0.136 Vali Loss: 0.262 Vali Acc: 0.950 Test Loss: 0.262 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 29 cost time: 0.47005176544189453
Epoch: 29, Steps: 3 | Train Loss: 0.099 Vali Loss: 0.247 Vali Acc: 0.950 Test Loss: 0.247 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 30 cost time: 0.46094226837158203
Epoch: 30, Steps: 3 | Train Loss: 0.100 Vali Loss: 0.246 Vali Acc: 0.950 Test Loss: 0.246 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 31 cost time: 0.46729564666748047
Epoch: 31, Steps: 3 | Train Loss: 0.092 Vali Loss: 0.242 Vali Acc: 0.950 Test Loss: 0.242 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 32 cost time: 0.47509002685546875
Epoch: 32, Steps: 3 | Train Loss: 0.078 Vali Loss: 0.244 Vali Acc: 0.950 Test Loss: 0.244 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.4514732360839844
Epoch: 33, Steps: 3 | Train Loss: 0.073 Vali Loss: 0.240 Vali Acc: 0.950 Test Loss: 0.240 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 34 cost time: 0.44669365882873535
Epoch: 34, Steps: 3 | Train Loss: 0.068 Vali Loss: 0.236 Vali Acc: 0.950 Test Loss: 0.236 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 35 cost time: 0.4258127212524414
Epoch: 35, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.233 Vali Acc: 0.950 Test Loss: 0.233 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 36 cost time: 0.4468224048614502
Epoch: 36, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.226 Vali Acc: 0.950 Test Loss: 0.226 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 37 cost time: 0.4379301071166992
Epoch: 37, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.222 Vali Acc: 0.950 Test Loss: 0.222 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 38 cost time: 0.45978665351867676
Epoch: 38, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.229 Vali Acc: 0.950 Test Loss: 0.229 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.4752004146575928
Epoch: 39, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.235 Vali Acc: 0.950 Test Loss: 0.235 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.4642026424407959
Epoch: 40, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.242 Vali Acc: 0.950 Test Loss: 0.242 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.4546496868133545
Epoch: 41, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.239 Vali Acc: 0.950 Test Loss: 0.239 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.43050217628479004
Epoch: 42, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.235 Vali Acc: 0.950 Test Loss: 0.235 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.4266016483306885
Epoch: 43, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.229 Vali Acc: 0.950 Test Loss: 0.229 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.4493563175201416
Epoch: 44, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.229 Vali Acc: 0.950 Test Loss: 0.229 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.4764740467071533
Epoch: 45, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.224 Vali Acc: 0.950 Test Loss: 0.224 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.4050099849700928
Epoch: 46, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.228 Vali Acc: 0.950 Test Loss: 0.228 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.4109930992126465
Epoch: 47, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.224 Vali Acc: 0.950 Test Loss: 0.224 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 193540
model size : 0.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.632246494293213
Epoch: 1, Steps: 3 | Train Loss: 1.496 Vali Loss: 1.436 Vali Acc: 0.275 Test Loss: 1.436 Test Acc: 0.275
Validation loss decreased (inf --> -0.274986).  Saving model ...
Epoch: 2 cost time: 0.43181872367858887
Epoch: 2, Steps: 3 | Train Loss: 1.399 Vali Loss: 1.420 Vali Acc: 0.275 Test Loss: 1.420 Test Acc: 0.275
Validation loss decreased (-0.274986 --> -0.274986).  Saving model ...
Epoch: 3 cost time: 0.426898717880249
Epoch: 3, Steps: 3 | Train Loss: 1.379 Vali Loss: 1.394 Vali Acc: 0.350 Test Loss: 1.394 Test Acc: 0.350
Validation loss decreased (-0.274986 --> -0.349986).  Saving model ...
Epoch: 4 cost time: 0.3907966613769531
Epoch: 4, Steps: 3 | Train Loss: 1.319 Vali Loss: 1.353 Vali Acc: 0.400 Test Loss: 1.353 Test Acc: 0.400
Validation loss decreased (-0.349986 --> -0.399986).  Saving model ...
Epoch: 5 cost time: 0.496929407119751
Epoch: 5, Steps: 3 | Train Loss: 1.247 Vali Loss: 1.299 Vali Acc: 0.375 Test Loss: 1.299 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.40129756927490234
Epoch: 6, Steps: 3 | Train Loss: 1.148 Vali Loss: 1.235 Vali Acc: 0.350 Test Loss: 1.235 Test Acc: 0.350
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.44950056076049805
Epoch: 7, Steps: 3 | Train Loss: 1.067 Vali Loss: 1.165 Vali Acc: 0.550 Test Loss: 1.165 Test Acc: 0.550
Validation loss decreased (-0.399986 --> -0.549988).  Saving model ...
Epoch: 8 cost time: 0.40006256103515625
Epoch: 8, Steps: 3 | Train Loss: 0.993 Vali Loss: 1.093 Vali Acc: 0.625 Test Loss: 1.093 Test Acc: 0.625
Validation loss decreased (-0.549988 --> -0.624989).  Saving model ...
Epoch: 9 cost time: 0.416912317276001
Epoch: 9, Steps: 3 | Train Loss: 0.905 Vali Loss: 1.024 Vali Acc: 0.675 Test Loss: 1.024 Test Acc: 0.675
Validation loss decreased (-0.624989 --> -0.674990).  Saving model ...
Epoch: 10 cost time: 0.4504995346069336
Epoch: 10, Steps: 3 | Train Loss: 0.846 Vali Loss: 0.953 Vali Acc: 0.750 Test Loss: 0.953 Test Acc: 0.750
Validation loss decreased (-0.674990 --> -0.749990).  Saving model ...
Epoch: 11 cost time: 0.4357779026031494
Epoch: 11, Steps: 3 | Train Loss: 0.761 Vali Loss: 0.888 Vali Acc: 0.850 Test Loss: 0.888 Test Acc: 0.850
Validation loss decreased (-0.749990 --> -0.849991).  Saving model ...
Epoch: 12 cost time: 0.4217860698699951
Epoch: 12, Steps: 3 | Train Loss: 0.682 Vali Loss: 0.819 Vali Acc: 0.875 Test Loss: 0.819 Test Acc: 0.875
Validation loss decreased (-0.849991 --> -0.874992).  Saving model ...
Epoch: 13 cost time: 0.42734527587890625
Epoch: 13, Steps: 3 | Train Loss: 0.618 Vali Loss: 0.748 Vali Acc: 0.900 Test Loss: 0.748 Test Acc: 0.900
Validation loss decreased (-0.874992 --> -0.899993).  Saving model ...
Epoch: 14 cost time: 0.4286336898803711
Epoch: 14, Steps: 3 | Train Loss: 0.552 Vali Loss: 0.698 Vali Acc: 0.900 Test Loss: 0.698 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 15 cost time: 0.41612744331359863
Epoch: 15, Steps: 3 | Train Loss: 0.498 Vali Loss: 0.655 Vali Acc: 0.900 Test Loss: 0.655 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 16 cost time: 0.4720027446746826
Epoch: 16, Steps: 3 | Train Loss: 0.445 Vali Loss: 0.609 Vali Acc: 0.925 Test Loss: 0.609 Test Acc: 0.925
Validation loss decreased (-0.899993 --> -0.924994).  Saving model ...
Epoch: 17 cost time: 0.41300225257873535
Epoch: 17, Steps: 3 | Train Loss: 0.440 Vali Loss: 0.570 Vali Acc: 0.900 Test Loss: 0.570 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.37937355041503906
Epoch: 18, Steps: 3 | Train Loss: 0.378 Vali Loss: 0.535 Vali Acc: 0.925 Test Loss: 0.535 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 19 cost time: 0.39844799041748047
Epoch: 19, Steps: 3 | Train Loss: 0.351 Vali Loss: 0.501 Vali Acc: 0.925 Test Loss: 0.501 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 20 cost time: 0.3528022766113281
Epoch: 20, Steps: 3 | Train Loss: 0.305 Vali Loss: 0.465 Vali Acc: 0.925 Test Loss: 0.465 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 21 cost time: 0.4835679531097412
Epoch: 21, Steps: 3 | Train Loss: 0.282 Vali Loss: 0.434 Vali Acc: 0.925 Test Loss: 0.434 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 22 cost time: 0.370952844619751
Epoch: 22, Steps: 3 | Train Loss: 0.240 Vali Loss: 0.407 Vali Acc: 0.925 Test Loss: 0.407 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 23 cost time: 0.3806450366973877
Epoch: 23, Steps: 3 | Train Loss: 0.248 Vali Loss: 0.384 Vali Acc: 0.925 Test Loss: 0.384 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 24 cost time: 0.3979072570800781
Epoch: 24, Steps: 3 | Train Loss: 0.223 Vali Loss: 0.367 Vali Acc: 0.950 Test Loss: 0.367 Test Acc: 0.950
Validation loss decreased (-0.924996 --> -0.949996).  Saving model ...
Epoch: 25 cost time: 0.3865370750427246
Epoch: 25, Steps: 3 | Train Loss: 0.208 Vali Loss: 0.352 Vali Acc: 0.950 Test Loss: 0.352 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 26 cost time: 0.43558287620544434
Epoch: 26, Steps: 3 | Train Loss: 0.194 Vali Loss: 0.340 Vali Acc: 0.950 Test Loss: 0.340 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 27 cost time: 0.3711276054382324
Epoch: 27, Steps: 3 | Train Loss: 0.192 Vali Loss: 0.330 Vali Acc: 0.950 Test Loss: 0.330 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 28 cost time: 0.42177271842956543
Epoch: 28, Steps: 3 | Train Loss: 0.161 Vali Loss: 0.316 Vali Acc: 0.950 Test Loss: 0.316 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 29 cost time: 0.5038385391235352
Epoch: 29, Steps: 3 | Train Loss: 0.153 Vali Loss: 0.309 Vali Acc: 0.950 Test Loss: 0.309 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 30 cost time: 0.4441804885864258
Epoch: 30, Steps: 3 | Train Loss: 0.135 Vali Loss: 0.296 Vali Acc: 0.950 Test Loss: 0.296 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 31 cost time: 0.38662075996398926
Epoch: 31, Steps: 3 | Train Loss: 0.144 Vali Loss: 0.286 Vali Acc: 0.950 Test Loss: 0.286 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 32 cost time: 0.44362735748291016
Epoch: 32, Steps: 3 | Train Loss: 0.118 Vali Loss: 0.267 Vali Acc: 0.950 Test Loss: 0.267 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 33 cost time: 0.4119682312011719
Epoch: 33, Steps: 3 | Train Loss: 0.112 Vali Loss: 0.256 Vali Acc: 0.950 Test Loss: 0.256 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 34 cost time: 0.39917516708374023
Epoch: 34, Steps: 3 | Train Loss: 0.103 Vali Loss: 0.249 Vali Acc: 0.950 Test Loss: 0.249 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 35 cost time: 0.4412496089935303
Epoch: 35, Steps: 3 | Train Loss: 0.097 Vali Loss: 0.242 Vali Acc: 0.950 Test Loss: 0.242 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 36 cost time: 0.4419093132019043
Epoch: 36, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.234 Vali Acc: 0.950 Test Loss: 0.234 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 37 cost time: 0.4221987724304199
Epoch: 37, Steps: 3 | Train Loss: 0.080 Vali Loss: 0.230 Vali Acc: 0.950 Test Loss: 0.230 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 38 cost time: 0.43796563148498535
Epoch: 38, Steps: 3 | Train Loss: 0.063 Vali Loss: 0.231 Vali Acc: 0.950 Test Loss: 0.231 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.3952193260192871
Epoch: 39, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.220 Vali Acc: 0.950 Test Loss: 0.220 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 40 cost time: 0.41823530197143555
Epoch: 40, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.221 Vali Acc: 0.950 Test Loss: 0.221 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.4116017818450928
Epoch: 41, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.222 Vali Acc: 0.950 Test Loss: 0.222 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.4533064365386963
Epoch: 42, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.219 Vali Acc: 0.950 Test Loss: 0.219 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 43 cost time: 0.45488691329956055
Epoch: 43, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.216 Vali Acc: 0.950 Test Loss: 0.216 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 44 cost time: 0.4378674030303955
Epoch: 44, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.213 Vali Acc: 0.950 Test Loss: 0.213 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 45 cost time: 0.4194662570953369
Epoch: 45, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.210 Vali Acc: 0.950 Test Loss: 0.210 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 46 cost time: 0.4141712188720703
Epoch: 46, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.207 Vali Acc: 0.950 Test Loss: 0.207 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 47 cost time: 0.39528584480285645
Epoch: 47, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.211 Vali Acc: 0.950 Test Loss: 0.211 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.38915300369262695
Epoch: 48, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.205 Vali Acc: 0.950 Test Loss: 0.205 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 49 cost time: 0.4270637035369873
Epoch: 49, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.205 Vali Acc: 0.950 Test Loss: 0.205 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 50 cost time: 0.44465136528015137
Epoch: 50, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.204 Vali Acc: 0.950 Test Loss: 0.204 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 181316
model size : 0.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.5746397972106934
Epoch: 1, Steps: 3 | Train Loss: 1.432 Vali Loss: 1.382 Vali Acc: 0.250 Test Loss: 1.382 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 0.42172956466674805
Epoch: 2, Steps: 3 | Train Loss: 1.390 Vali Loss: 1.363 Vali Acc: 0.275 Test Loss: 1.363 Test Acc: 0.275
Validation loss decreased (-0.249986 --> -0.274986).  Saving model ...
Epoch: 3 cost time: 0.4277610778808594
Epoch: 3, Steps: 3 | Train Loss: 1.394 Vali Loss: 1.337 Vali Acc: 0.325 Test Loss: 1.337 Test Acc: 0.325
Validation loss decreased (-0.274986 --> -0.324987).  Saving model ...
Epoch: 4 cost time: 0.40870141983032227
Epoch: 4, Steps: 3 | Train Loss: 1.314 Vali Loss: 1.300 Vali Acc: 0.350 Test Loss: 1.300 Test Acc: 0.350
Validation loss decreased (-0.324987 --> -0.349987).  Saving model ...
Epoch: 5 cost time: 0.46891260147094727
Epoch: 5, Steps: 3 | Train Loss: 1.249 Vali Loss: 1.253 Vali Acc: 0.425 Test Loss: 1.253 Test Acc: 0.425
Validation loss decreased (-0.349987 --> -0.424987).  Saving model ...
Epoch: 6 cost time: 0.40782713890075684
Epoch: 6, Steps: 3 | Train Loss: 1.194 Vali Loss: 1.200 Vali Acc: 0.450 Test Loss: 1.200 Test Acc: 0.450
Validation loss decreased (-0.424987 --> -0.449988).  Saving model ...
Epoch: 7 cost time: 0.3809795379638672
Epoch: 7, Steps: 3 | Train Loss: 1.118 Vali Loss: 1.144 Vali Acc: 0.525 Test Loss: 1.144 Test Acc: 0.525
Validation loss decreased (-0.449988 --> -0.524989).  Saving model ...
Epoch: 8 cost time: 0.43610334396362305
Epoch: 8, Steps: 3 | Train Loss: 1.065 Vali Loss: 1.089 Vali Acc: 0.550 Test Loss: 1.089 Test Acc: 0.550
Validation loss decreased (-0.524989 --> -0.549989).  Saving model ...
Epoch: 9 cost time: 0.480867862701416
Epoch: 9, Steps: 3 | Train Loss: 1.000 Vali Loss: 1.028 Vali Acc: 0.650 Test Loss: 1.028 Test Acc: 0.650
Validation loss decreased (-0.549989 --> -0.649990).  Saving model ...
Epoch: 10 cost time: 0.3960764408111572
Epoch: 10, Steps: 3 | Train Loss: 0.936 Vali Loss: 0.969 Vali Acc: 0.725 Test Loss: 0.969 Test Acc: 0.725
Validation loss decreased (-0.649990 --> -0.724990).  Saving model ...
Epoch: 11 cost time: 0.4468343257904053
Epoch: 11, Steps: 3 | Train Loss: 0.827 Vali Loss: 0.917 Vali Acc: 0.850 Test Loss: 0.917 Test Acc: 0.850
Validation loss decreased (-0.724990 --> -0.849991).  Saving model ...
Epoch: 12 cost time: 0.47498512268066406
Epoch: 12, Steps: 3 | Train Loss: 0.783 Vali Loss: 0.860 Vali Acc: 0.875 Test Loss: 0.860 Test Acc: 0.875
Validation loss decreased (-0.849991 --> -0.874991).  Saving model ...
Epoch: 13 cost time: 0.5936863422393799
Epoch: 13, Steps: 3 | Train Loss: 0.724 Vali Loss: 0.811 Vali Acc: 0.900 Test Loss: 0.811 Test Acc: 0.900
Validation loss decreased (-0.874991 --> -0.899992).  Saving model ...
Epoch: 14 cost time: 0.4643411636352539
Epoch: 14, Steps: 3 | Train Loss: 0.673 Vali Loss: 0.760 Vali Acc: 0.900 Test Loss: 0.760 Test Acc: 0.900
Validation loss decreased (-0.899992 --> -0.899992).  Saving model ...
Epoch: 15 cost time: 0.41245269775390625
Epoch: 15, Steps: 3 | Train Loss: 0.601 Vali Loss: 0.715 Vali Acc: 0.925 Test Loss: 0.715 Test Acc: 0.925
Validation loss decreased (-0.899992 --> -0.924993).  Saving model ...
Epoch: 16 cost time: 0.37329745292663574
Epoch: 16, Steps: 3 | Train Loss: 0.566 Vali Loss: 0.668 Vali Acc: 0.925 Test Loss: 0.668 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924993).  Saving model ...
Epoch: 17 cost time: 0.45168042182922363
Epoch: 17, Steps: 3 | Train Loss: 0.528 Vali Loss: 0.629 Vali Acc: 0.925 Test Loss: 0.629 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924994).  Saving model ...
Epoch: 18 cost time: 0.36223459243774414
Epoch: 18, Steps: 3 | Train Loss: 0.471 Vali Loss: 0.595 Vali Acc: 0.950 Test Loss: 0.595 Test Acc: 0.950
Validation loss decreased (-0.924994 --> -0.949994).  Saving model ...
Epoch: 19 cost time: 0.37689781188964844
Epoch: 19, Steps: 3 | Train Loss: 0.434 Vali Loss: 0.555 Vali Acc: 0.950 Test Loss: 0.555 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949994).  Saving model ...
Epoch: 20 cost time: 0.4752039909362793
Epoch: 20, Steps: 3 | Train Loss: 0.392 Vali Loss: 0.528 Vali Acc: 0.925 Test Loss: 0.528 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.4657745361328125
Epoch: 21, Steps: 3 | Train Loss: 0.381 Vali Loss: 0.500 Vali Acc: 0.925 Test Loss: 0.500 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.4251863956451416
Epoch: 22, Steps: 3 | Train Loss: 0.337 Vali Loss: 0.461 Vali Acc: 0.925 Test Loss: 0.461 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.4694252014160156
Epoch: 23, Steps: 3 | Train Loss: 0.318 Vali Loss: 0.442 Vali Acc: 0.925 Test Loss: 0.442 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.4152545928955078
Epoch: 24, Steps: 3 | Train Loss: 0.280 Vali Loss: 0.418 Vali Acc: 0.925 Test Loss: 0.418 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.3991892337799072
Epoch: 25, Steps: 3 | Train Loss: 0.245 Vali Loss: 0.386 Vali Acc: 0.925 Test Loss: 0.386 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.42867422103881836
Epoch: 26, Steps: 3 | Train Loss: 0.272 Vali Loss: 0.370 Vali Acc: 0.925 Test Loss: 0.370 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.41367220878601074
Epoch: 27, Steps: 3 | Train Loss: 0.247 Vali Loss: 0.353 Vali Acc: 0.925 Test Loss: 0.353 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.42549633979797363
Epoch: 28, Steps: 3 | Train Loss: 0.257 Vali Loss: 0.339 Vali Acc: 0.950 Test Loss: 0.339 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949997).  Saving model ...
Epoch: 29 cost time: 0.4408144950866699
Epoch: 29, Steps: 3 | Train Loss: 0.209 Vali Loss: 0.324 Vali Acc: 0.950 Test Loss: 0.324 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 30 cost time: 0.4255499839782715
Epoch: 30, Steps: 3 | Train Loss: 0.205 Vali Loss: 0.315 Vali Acc: 0.950 Test Loss: 0.315 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 31 cost time: 0.46927976608276367
Epoch: 31, Steps: 3 | Train Loss: 0.205 Vali Loss: 0.307 Vali Acc: 0.950 Test Loss: 0.307 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 32 cost time: 0.4355318546295166
Epoch: 32, Steps: 3 | Train Loss: 0.173 Vali Loss: 0.290 Vali Acc: 0.950 Test Loss: 0.290 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 33 cost time: 0.47326111793518066
Epoch: 33, Steps: 3 | Train Loss: 0.172 Vali Loss: 0.281 Vali Acc: 0.950 Test Loss: 0.281 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 34 cost time: 0.3921377658843994
Epoch: 34, Steps: 3 | Train Loss: 0.143 Vali Loss: 0.280 Vali Acc: 0.950 Test Loss: 0.280 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 35 cost time: 0.4500088691711426
Epoch: 35, Steps: 3 | Train Loss: 0.159 Vali Loss: 0.264 Vali Acc: 0.950 Test Loss: 0.264 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 36 cost time: 0.42421460151672363
Epoch: 36, Steps: 3 | Train Loss: 0.147 Vali Loss: 0.256 Vali Acc: 0.950 Test Loss: 0.256 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 37 cost time: 0.46177148818969727
Epoch: 37, Steps: 3 | Train Loss: 0.126 Vali Loss: 0.249 Vali Acc: 0.950 Test Loss: 0.249 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 38 cost time: 0.3730630874633789
Epoch: 38, Steps: 3 | Train Loss: 0.113 Vali Loss: 0.236 Vali Acc: 0.950 Test Loss: 0.236 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 39 cost time: 0.4450685977935791
Epoch: 39, Steps: 3 | Train Loss: 0.109 Vali Loss: 0.238 Vali Acc: 0.950 Test Loss: 0.238 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.4403531551361084
Epoch: 40, Steps: 3 | Train Loss: 0.098 Vali Loss: 0.222 Vali Acc: 0.950 Test Loss: 0.222 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 41 cost time: 0.4374849796295166
Epoch: 41, Steps: 3 | Train Loss: 0.090 Vali Loss: 0.208 Vali Acc: 0.950 Test Loss: 0.208 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 42 cost time: 0.43926525115966797
Epoch: 42, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.201 Vali Acc: 0.950 Test Loss: 0.201 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 43 cost time: 0.42446017265319824
Epoch: 43, Steps: 3 | Train Loss: 0.082 Vali Loss: 0.190 Vali Acc: 0.950 Test Loss: 0.190 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 44 cost time: 0.41609668731689453
Epoch: 44, Steps: 3 | Train Loss: 0.080 Vali Loss: 0.190 Vali Acc: 0.975 Test Loss: 0.190 Test Acc: 0.975
Validation loss decreased (-0.949998 --> -0.974998).  Saving model ...
Epoch: 45 cost time: 0.3757622241973877
Epoch: 45, Steps: 3 | Train Loss: 0.068 Vali Loss: 0.184 Vali Acc: 0.975 Test Loss: 0.184 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 46 cost time: 0.4146914482116699
Epoch: 46, Steps: 3 | Train Loss: 0.062 Vali Loss: 0.178 Vali Acc: 0.975 Test Loss: 0.178 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 47 cost time: 0.3859426975250244
Epoch: 47, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.180 Vali Acc: 0.975 Test Loss: 0.180 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.37964367866516113
Epoch: 48, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.173 Vali Acc: 0.975 Test Loss: 0.173 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 49 cost time: 0.43958377838134766
Epoch: 49, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.169 Vali Acc: 0.975 Test Loss: 0.169 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 50 cost time: 0.42942070960998535
Epoch: 50, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.162 Vali Acc: 0.975 Test Loss: 0.162 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 175268
model size : 0.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.6115899085998535
Epoch: 1, Steps: 3 | Train Loss: 1.444 Vali Loss: 1.426 Vali Acc: 0.200 Test Loss: 1.426 Test Acc: 0.200
Validation loss decreased (inf --> -0.199986).  Saving model ...
Epoch: 2 cost time: 0.424285888671875
Epoch: 2, Steps: 3 | Train Loss: 1.420 Vali Loss: 1.415 Vali Acc: 0.175 Test Loss: 1.415 Test Acc: 0.175
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4945962429046631
Epoch: 3, Steps: 3 | Train Loss: 1.398 Vali Loss: 1.401 Vali Acc: 0.225 Test Loss: 1.401 Test Acc: 0.225
Validation loss decreased (-0.199986 --> -0.224986).  Saving model ...
Epoch: 4 cost time: 0.47042346000671387
Epoch: 4, Steps: 3 | Train Loss: 1.343 Vali Loss: 1.377 Vali Acc: 0.250 Test Loss: 1.377 Test Acc: 0.250
Validation loss decreased (-0.224986 --> -0.249986).  Saving model ...
Epoch: 5 cost time: 0.4266853332519531
Epoch: 5, Steps: 3 | Train Loss: 1.299 Vali Loss: 1.346 Vali Acc: 0.275 Test Loss: 1.346 Test Acc: 0.275
Validation loss decreased (-0.249986 --> -0.274987).  Saving model ...
Epoch: 6 cost time: 0.47778820991516113
Epoch: 6, Steps: 3 | Train Loss: 1.233 Vali Loss: 1.308 Vali Acc: 0.350 Test Loss: 1.308 Test Acc: 0.350
Validation loss decreased (-0.274987 --> -0.349987).  Saving model ...
Epoch: 7 cost time: 0.4075639247894287
Epoch: 7, Steps: 3 | Train Loss: 1.174 Vali Loss: 1.265 Vali Acc: 0.450 Test Loss: 1.265 Test Acc: 0.450
Validation loss decreased (-0.349987 --> -0.449987).  Saving model ...
Epoch: 8 cost time: 0.5991499423980713
Epoch: 8, Steps: 3 | Train Loss: 1.154 Vali Loss: 1.218 Vali Acc: 0.475 Test Loss: 1.218 Test Acc: 0.475
Validation loss decreased (-0.449987 --> -0.474988).  Saving model ...
Epoch: 9 cost time: 0.4735252857208252
Epoch: 9, Steps: 3 | Train Loss: 1.080 Vali Loss: 1.168 Vali Acc: 0.550 Test Loss: 1.168 Test Acc: 0.550
Validation loss decreased (-0.474988 --> -0.549988).  Saving model ...
Epoch: 10 cost time: 0.4895963668823242
Epoch: 10, Steps: 3 | Train Loss: 1.021 Vali Loss: 1.118 Vali Acc: 0.600 Test Loss: 1.118 Test Acc: 0.600
Validation loss decreased (-0.549988 --> -0.599989).  Saving model ...
Epoch: 11 cost time: 0.44884443283081055
Epoch: 11, Steps: 3 | Train Loss: 0.939 Vali Loss: 1.070 Vali Acc: 0.675 Test Loss: 1.070 Test Acc: 0.675
Validation loss decreased (-0.599989 --> -0.674989).  Saving model ...
Epoch: 12 cost time: 0.4064154624938965
Epoch: 12, Steps: 3 | Train Loss: 0.901 Vali Loss: 1.023 Vali Acc: 0.750 Test Loss: 1.023 Test Acc: 0.750
Validation loss decreased (-0.674989 --> -0.749990).  Saving model ...
Epoch: 13 cost time: 0.47878384590148926
Epoch: 13, Steps: 3 | Train Loss: 0.864 Vali Loss: 0.970 Vali Acc: 0.825 Test Loss: 0.970 Test Acc: 0.825
Validation loss decreased (-0.749990 --> -0.824990).  Saving model ...
Epoch: 14 cost time: 0.45857954025268555
Epoch: 14, Steps: 3 | Train Loss: 0.790 Vali Loss: 0.926 Vali Acc: 0.850 Test Loss: 0.926 Test Acc: 0.850
Validation loss decreased (-0.824990 --> -0.849991).  Saving model ...
Epoch: 15 cost time: 0.43834853172302246
Epoch: 15, Steps: 3 | Train Loss: 0.758 Vali Loss: 0.890 Vali Acc: 0.850 Test Loss: 0.890 Test Acc: 0.850
Validation loss decreased (-0.849991 --> -0.849991).  Saving model ...
Epoch: 16 cost time: 0.5047004222869873
Epoch: 16, Steps: 3 | Train Loss: 0.722 Vali Loss: 0.848 Vali Acc: 0.850 Test Loss: 0.848 Test Acc: 0.850
Validation loss decreased (-0.849991 --> -0.849992).  Saving model ...
Epoch: 17 cost time: 0.41203975677490234
Epoch: 17, Steps: 3 | Train Loss: 0.656 Vali Loss: 0.824 Vali Acc: 0.850 Test Loss: 0.824 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 18 cost time: 0.4555494785308838
Epoch: 18, Steps: 3 | Train Loss: 0.627 Vali Loss: 0.776 Vali Acc: 0.900 Test Loss: 0.776 Test Acc: 0.900
Validation loss decreased (-0.849992 --> -0.899992).  Saving model ...
Epoch: 19 cost time: 0.41946840286254883
Epoch: 19, Steps: 3 | Train Loss: 0.558 Vali Loss: 0.734 Vali Acc: 0.950 Test Loss: 0.734 Test Acc: 0.950
Validation loss decreased (-0.899992 --> -0.949993).  Saving model ...
Epoch: 20 cost time: 0.41770243644714355
Epoch: 20, Steps: 3 | Train Loss: 0.548 Vali Loss: 0.701 Vali Acc: 0.950 Test Loss: 0.701 Test Acc: 0.950
Validation loss decreased (-0.949993 --> -0.949993).  Saving model ...
Epoch: 21 cost time: 0.4448411464691162
Epoch: 21, Steps: 3 | Train Loss: 0.503 Vali Loss: 0.667 Vali Acc: 0.950 Test Loss: 0.667 Test Acc: 0.950
Validation loss decreased (-0.949993 --> -0.949993).  Saving model ...
Epoch: 22 cost time: 0.5446164608001709
Epoch: 22, Steps: 3 | Train Loss: 0.484 Vali Loss: 0.619 Vali Acc: 0.950 Test Loss: 0.619 Test Acc: 0.950
Validation loss decreased (-0.949993 --> -0.949994).  Saving model ...
Epoch: 23 cost time: 0.5759904384613037
Epoch: 23, Steps: 3 | Train Loss: 0.472 Vali Loss: 0.593 Vali Acc: 0.950 Test Loss: 0.593 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949994).  Saving model ...
Epoch: 24 cost time: 0.5002007484436035
Epoch: 24, Steps: 3 | Train Loss: 0.417 Vali Loss: 0.567 Vali Acc: 0.950 Test Loss: 0.567 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949994).  Saving model ...
Epoch: 25 cost time: 0.5339975357055664
Epoch: 25, Steps: 3 | Train Loss: 0.403 Vali Loss: 0.547 Vali Acc: 0.950 Test Loss: 0.547 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 26 cost time: 0.4711275100708008
Epoch: 26, Steps: 3 | Train Loss: 0.371 Vali Loss: 0.528 Vali Acc: 0.950 Test Loss: 0.528 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 27 cost time: 0.44061994552612305
Epoch: 27, Steps: 3 | Train Loss: 0.377 Vali Loss: 0.504 Vali Acc: 0.950 Test Loss: 0.504 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 28 cost time: 0.4546501636505127
Epoch: 28, Steps: 3 | Train Loss: 0.331 Vali Loss: 0.485 Vali Acc: 0.950 Test Loss: 0.485 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 29 cost time: 0.428680419921875
Epoch: 29, Steps: 3 | Train Loss: 0.325 Vali Loss: 0.479 Vali Acc: 0.950 Test Loss: 0.479 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 30 cost time: 0.4634361267089844
Epoch: 30, Steps: 3 | Train Loss: 0.312 Vali Loss: 0.459 Vali Acc: 0.950 Test Loss: 0.459 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 31 cost time: 0.46200013160705566
Epoch: 31, Steps: 3 | Train Loss: 0.280 Vali Loss: 0.439 Vali Acc: 0.950 Test Loss: 0.439 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 32 cost time: 0.38672614097595215
Epoch: 32, Steps: 3 | Train Loss: 0.299 Vali Loss: 0.427 Vali Acc: 0.950 Test Loss: 0.427 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 33 cost time: 0.404620885848999
Epoch: 33, Steps: 3 | Train Loss: 0.260 Vali Loss: 0.420 Vali Acc: 0.950 Test Loss: 0.420 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 34 cost time: 0.4747006893157959
Epoch: 34, Steps: 3 | Train Loss: 0.241 Vali Loss: 0.402 Vali Acc: 0.975 Test Loss: 0.402 Test Acc: 0.975
Validation loss decreased (-0.949996 --> -0.974996).  Saving model ...
Epoch: 35 cost time: 0.40069150924682617
Epoch: 35, Steps: 3 | Train Loss: 0.248 Vali Loss: 0.391 Vali Acc: 0.975 Test Loss: 0.391 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 36 cost time: 0.4275703430175781
Epoch: 36, Steps: 3 | Train Loss: 0.230 Vali Loss: 0.386 Vali Acc: 0.975 Test Loss: 0.386 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 37 cost time: 0.5507192611694336
Epoch: 37, Steps: 3 | Train Loss: 0.204 Vali Loss: 0.363 Vali Acc: 0.975 Test Loss: 0.363 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 38 cost time: 0.42243504524230957
Epoch: 38, Steps: 3 | Train Loss: 0.206 Vali Loss: 0.364 Vali Acc: 0.975 Test Loss: 0.364 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.46403026580810547
Epoch: 39, Steps: 3 | Train Loss: 0.200 Vali Loss: 0.335 Vali Acc: 0.975 Test Loss: 0.335 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 40 cost time: 0.43440866470336914
Epoch: 40, Steps: 3 | Train Loss: 0.168 Vali Loss: 0.314 Vali Acc: 0.975 Test Loss: 0.314 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 41 cost time: 0.48748326301574707
Epoch: 41, Steps: 3 | Train Loss: 0.176 Vali Loss: 0.310 Vali Acc: 0.975 Test Loss: 0.310 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 42 cost time: 0.4695003032684326
Epoch: 42, Steps: 3 | Train Loss: 0.165 Vali Loss: 0.301 Vali Acc: 0.975 Test Loss: 0.301 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 43 cost time: 0.4421348571777344
Epoch: 43, Steps: 3 | Train Loss: 0.152 Vali Loss: 0.301 Vali Acc: 0.975 Test Loss: 0.301 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 44 cost time: 0.46739983558654785
Epoch: 44, Steps: 3 | Train Loss: 0.155 Vali Loss: 0.284 Vali Acc: 0.975 Test Loss: 0.284 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 45 cost time: 0.4371457099914551
Epoch: 45, Steps: 3 | Train Loss: 0.137 Vali Loss: 0.275 Vali Acc: 0.975 Test Loss: 0.275 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 46 cost time: 0.43126440048217773
Epoch: 46, Steps: 3 | Train Loss: 0.153 Vali Loss: 0.277 Vali Acc: 0.975 Test Loss: 0.277 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.47440314292907715
Epoch: 47, Steps: 3 | Train Loss: 0.124 Vali Loss: 0.272 Vali Acc: 0.975 Test Loss: 0.272 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 48 cost time: 0.5167107582092285
Epoch: 48, Steps: 3 | Train Loss: 0.128 Vali Loss: 0.268 Vali Acc: 0.950 Test Loss: 0.268 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.5465259552001953
Epoch: 49, Steps: 3 | Train Loss: 0.108 Vali Loss: 0.269 Vali Acc: 0.950 Test Loss: 0.269 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.450087308883667
Epoch: 50, Steps: 3 | Train Loss: 0.105 Vali Loss: 0.260 Vali Acc: 0.950 Test Loss: 0.260 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 170724
model size : 0.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.6971893310546875
Epoch: 1, Steps: 3 | Train Loss: 1.425 Vali Loss: 1.383 Vali Acc: 0.250 Test Loss: 1.383 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 0.4495205879211426
Epoch: 2, Steps: 3 | Train Loss: 1.349 Vali Loss: 1.373 Vali Acc: 0.300 Test Loss: 1.373 Test Acc: 0.300
Validation loss decreased (-0.249986 --> -0.299986).  Saving model ...
Epoch: 3 cost time: 0.4088919162750244
Epoch: 3, Steps: 3 | Train Loss: 1.326 Vali Loss: 1.362 Vali Acc: 0.325 Test Loss: 1.362 Test Acc: 0.325
Validation loss decreased (-0.299986 --> -0.324986).  Saving model ...
Epoch: 4 cost time: 0.43572020530700684
Epoch: 4, Steps: 3 | Train Loss: 1.329 Vali Loss: 1.343 Vali Acc: 0.325 Test Loss: 1.343 Test Acc: 0.325
Validation loss decreased (-0.324986 --> -0.324987).  Saving model ...
Epoch: 5 cost time: 0.4194934368133545
Epoch: 5, Steps: 3 | Train Loss: 1.283 Vali Loss: 1.319 Vali Acc: 0.375 Test Loss: 1.319 Test Acc: 0.375
Validation loss decreased (-0.324987 --> -0.374987).  Saving model ...
Epoch: 6 cost time: 0.4383726119995117
Epoch: 6, Steps: 3 | Train Loss: 1.275 Vali Loss: 1.292 Vali Acc: 0.475 Test Loss: 1.292 Test Acc: 0.475
Validation loss decreased (-0.374987 --> -0.474987).  Saving model ...
Epoch: 7 cost time: 0.48236513137817383
Epoch: 7, Steps: 3 | Train Loss: 1.195 Vali Loss: 1.260 Vali Acc: 0.600 Test Loss: 1.260 Test Acc: 0.600
Validation loss decreased (-0.474987 --> -0.599987).  Saving model ...
Epoch: 8 cost time: 0.4437563419342041
Epoch: 8, Steps: 3 | Train Loss: 1.185 Vali Loss: 1.221 Vali Acc: 0.650 Test Loss: 1.221 Test Acc: 0.650
Validation loss decreased (-0.599987 --> -0.649988).  Saving model ...
Epoch: 9 cost time: 0.5140345096588135
Epoch: 9, Steps: 3 | Train Loss: 1.117 Vali Loss: 1.188 Vali Acc: 0.650 Test Loss: 1.188 Test Acc: 0.650
Validation loss decreased (-0.649988 --> -0.649988).  Saving model ...
Epoch: 10 cost time: 0.438889741897583
Epoch: 10, Steps: 3 | Train Loss: 1.055 Vali Loss: 1.151 Vali Acc: 0.675 Test Loss: 1.151 Test Acc: 0.675
Validation loss decreased (-0.649988 --> -0.674988).  Saving model ...
Epoch: 11 cost time: 0.5043256282806396
Epoch: 11, Steps: 3 | Train Loss: 1.025 Vali Loss: 1.114 Vali Acc: 0.725 Test Loss: 1.114 Test Acc: 0.725
Validation loss decreased (-0.674988 --> -0.724989).  Saving model ...
Epoch: 12 cost time: 0.4078855514526367
Epoch: 12, Steps: 3 | Train Loss: 0.985 Vali Loss: 1.075 Vali Acc: 0.725 Test Loss: 1.075 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724989).  Saving model ...
Epoch: 13 cost time: 0.47840023040771484
Epoch: 13, Steps: 3 | Train Loss: 0.966 Vali Loss: 1.028 Vali Acc: 0.750 Test Loss: 1.028 Test Acc: 0.750
Validation loss decreased (-0.724989 --> -0.749990).  Saving model ...
Epoch: 14 cost time: 0.46082162857055664
Epoch: 14, Steps: 3 | Train Loss: 0.921 Vali Loss: 0.991 Vali Acc: 0.775 Test Loss: 0.991 Test Acc: 0.775
Validation loss decreased (-0.749990 --> -0.774990).  Saving model ...
Epoch: 15 cost time: 0.46767401695251465
Epoch: 15, Steps: 3 | Train Loss: 0.867 Vali Loss: 0.952 Vali Acc: 0.850 Test Loss: 0.952 Test Acc: 0.850
Validation loss decreased (-0.774990 --> -0.849990).  Saving model ...
Epoch: 16 cost time: 0.4902176856994629
Epoch: 16, Steps: 3 | Train Loss: 0.846 Vali Loss: 0.920 Vali Acc: 0.850 Test Loss: 0.920 Test Acc: 0.850
Validation loss decreased (-0.849990 --> -0.849991).  Saving model ...
Epoch: 17 cost time: 0.42596960067749023
Epoch: 17, Steps: 3 | Train Loss: 0.779 Vali Loss: 0.898 Vali Acc: 0.850 Test Loss: 0.898 Test Acc: 0.850
Validation loss decreased (-0.849991 --> -0.849991).  Saving model ...
Epoch: 18 cost time: 0.4480102062225342
Epoch: 18, Steps: 3 | Train Loss: 0.757 Vali Loss: 0.855 Vali Acc: 0.850 Test Loss: 0.855 Test Acc: 0.850
Validation loss decreased (-0.849991 --> -0.849991).  Saving model ...
Epoch: 19 cost time: 0.4514744281768799
Epoch: 19, Steps: 3 | Train Loss: 0.729 Vali Loss: 0.822 Vali Acc: 0.850 Test Loss: 0.822 Test Acc: 0.850
Validation loss decreased (-0.849991 --> -0.849992).  Saving model ...
Epoch: 20 cost time: 0.4574272632598877
Epoch: 20, Steps: 3 | Train Loss: 0.677 Vali Loss: 0.809 Vali Acc: 0.850 Test Loss: 0.809 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 21 cost time: 0.4355337619781494
Epoch: 21, Steps: 3 | Train Loss: 0.661 Vali Loss: 0.779 Vali Acc: 0.850 Test Loss: 0.779 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 22 cost time: 0.46723079681396484
Epoch: 22, Steps: 3 | Train Loss: 0.620 Vali Loss: 0.752 Vali Acc: 0.850 Test Loss: 0.752 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 23 cost time: 0.42356252670288086
Epoch: 23, Steps: 3 | Train Loss: 0.579 Vali Loss: 0.721 Vali Acc: 0.875 Test Loss: 0.721 Test Acc: 0.875
Validation loss decreased (-0.849992 --> -0.874993).  Saving model ...
Epoch: 24 cost time: 0.4383738040924072
Epoch: 24, Steps: 3 | Train Loss: 0.558 Vali Loss: 0.698 Vali Acc: 0.875 Test Loss: 0.698 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 25 cost time: 0.4673440456390381
Epoch: 25, Steps: 3 | Train Loss: 0.528 Vali Loss: 0.667 Vali Acc: 0.875 Test Loss: 0.667 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 26 cost time: 0.4755723476409912
Epoch: 26, Steps: 3 | Train Loss: 0.502 Vali Loss: 0.637 Vali Acc: 0.875 Test Loss: 0.637 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 27 cost time: 0.44062280654907227
Epoch: 27, Steps: 3 | Train Loss: 0.502 Vali Loss: 0.611 Vali Acc: 0.900 Test Loss: 0.611 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899994).  Saving model ...
Epoch: 28 cost time: 0.4242570400238037
Epoch: 28, Steps: 3 | Train Loss: 0.456 Vali Loss: 0.592 Vali Acc: 0.950 Test Loss: 0.592 Test Acc: 0.950
Validation loss decreased (-0.899994 --> -0.949994).  Saving model ...
Epoch: 29 cost time: 0.4351212978363037
Epoch: 29, Steps: 3 | Train Loss: 0.439 Vali Loss: 0.570 Vali Acc: 0.950 Test Loss: 0.570 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949994).  Saving model ...
Epoch: 30 cost time: 0.40435361862182617
Epoch: 30, Steps: 3 | Train Loss: 0.401 Vali Loss: 0.553 Vali Acc: 0.950 Test Loss: 0.553 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949994).  Saving model ...
Epoch: 31 cost time: 0.4196956157684326
Epoch: 31, Steps: 3 | Train Loss: 0.419 Vali Loss: 0.528 Vali Acc: 0.950 Test Loss: 0.528 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 32 cost time: 0.3783588409423828
Epoch: 32, Steps: 3 | Train Loss: 0.361 Vali Loss: 0.506 Vali Acc: 0.950 Test Loss: 0.506 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 33 cost time: 0.45264577865600586
Epoch: 33, Steps: 3 | Train Loss: 0.365 Vali Loss: 0.504 Vali Acc: 0.950 Test Loss: 0.504 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 34 cost time: 0.5482299327850342
Epoch: 34, Steps: 3 | Train Loss: 0.347 Vali Loss: 0.494 Vali Acc: 0.950 Test Loss: 0.494 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 35 cost time: 0.5786490440368652
Epoch: 35, Steps: 3 | Train Loss: 0.339 Vali Loss: 0.480 Vali Acc: 0.975 Test Loss: 0.480 Test Acc: 0.975
Validation loss decreased (-0.949995 --> -0.974995).  Saving model ...
Epoch: 36 cost time: 0.447939395904541
Epoch: 36, Steps: 3 | Train Loss: 0.332 Vali Loss: 0.472 Vali Acc: 0.975 Test Loss: 0.472 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 37 cost time: 0.40907907485961914
Epoch: 37, Steps: 3 | Train Loss: 0.298 Vali Loss: 0.445 Vali Acc: 0.975 Test Loss: 0.445 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 38 cost time: 0.3937668800354004
Epoch: 38, Steps: 3 | Train Loss: 0.281 Vali Loss: 0.424 Vali Acc: 0.975 Test Loss: 0.424 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 39 cost time: 0.3868980407714844
Epoch: 39, Steps: 3 | Train Loss: 0.283 Vali Loss: 0.410 Vali Acc: 0.975 Test Loss: 0.410 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 40 cost time: 0.456615686416626
Epoch: 40, Steps: 3 | Train Loss: 0.275 Vali Loss: 0.397 Vali Acc: 0.975 Test Loss: 0.397 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 41 cost time: 0.4034233093261719
Epoch: 41, Steps: 3 | Train Loss: 0.255 Vali Loss: 0.374 Vali Acc: 0.975 Test Loss: 0.374 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 42 cost time: 0.5405259132385254
Epoch: 42, Steps: 3 | Train Loss: 0.233 Vali Loss: 0.362 Vali Acc: 0.975 Test Loss: 0.362 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 43 cost time: 0.4361574649810791
Epoch: 43, Steps: 3 | Train Loss: 0.229 Vali Loss: 0.349 Vali Acc: 0.975 Test Loss: 0.349 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 44 cost time: 0.514054536819458
Epoch: 44, Steps: 3 | Train Loss: 0.244 Vali Loss: 0.337 Vali Acc: 0.975 Test Loss: 0.337 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 45 cost time: 0.44525694847106934
Epoch: 45, Steps: 3 | Train Loss: 0.194 Vali Loss: 0.325 Vali Acc: 0.975 Test Loss: 0.325 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 46 cost time: 0.46999645233154297
Epoch: 46, Steps: 3 | Train Loss: 0.199 Vali Loss: 0.314 Vali Acc: 0.975 Test Loss: 0.314 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 47 cost time: 0.4301276206970215
Epoch: 47, Steps: 3 | Train Loss: 0.188 Vali Loss: 0.308 Vali Acc: 0.975 Test Loss: 0.308 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 48 cost time: 0.4200880527496338
Epoch: 48, Steps: 3 | Train Loss: 0.194 Vali Loss: 0.305 Vali Acc: 0.975 Test Loss: 0.305 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 49 cost time: 0.49562740325927734
Epoch: 49, Steps: 3 | Train Loss: 0.178 Vali Loss: 0.295 Vali Acc: 0.975 Test Loss: 0.295 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 50 cost time: 0.42023396492004395
Epoch: 50, Steps: 3 | Train Loss: 0.175 Vali Loss: 0.293 Vali Acc: 0.975 Test Loss: 0.293 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 164740
model size : 0.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps20_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.7951242923736572
Epoch: 1, Steps: 3 | Train Loss: 1.402 Vali Loss: 1.354 Vali Acc: 0.225 Test Loss: 1.354 Test Acc: 0.225
Validation loss decreased (inf --> -0.224986).  Saving model ...
Epoch: 2 cost time: 0.4680180549621582
Epoch: 2, Steps: 3 | Train Loss: 1.317 Vali Loss: 1.342 Vali Acc: 0.225 Test Loss: 1.342 Test Acc: 0.225
Validation loss decreased (-0.224986 --> -0.224987).  Saving model ...
Epoch: 3 cost time: 0.46387743949890137
Epoch: 3, Steps: 3 | Train Loss: 1.322 Vali Loss: 1.329 Vali Acc: 0.225 Test Loss: 1.329 Test Acc: 0.225
Validation loss decreased (-0.224987 --> -0.224987).  Saving model ...
Epoch: 4 cost time: 0.4941408634185791
Epoch: 4, Steps: 3 | Train Loss: 1.312 Vali Loss: 1.311 Vali Acc: 0.250 Test Loss: 1.311 Test Acc: 0.250
Validation loss decreased (-0.224987 --> -0.249987).  Saving model ...
Epoch: 5 cost time: 0.4762387275695801
Epoch: 5, Steps: 3 | Train Loss: 1.277 Vali Loss: 1.290 Vali Acc: 0.300 Test Loss: 1.290 Test Acc: 0.300
Validation loss decreased (-0.249987 --> -0.299987).  Saving model ...
Epoch: 6 cost time: 0.4980015754699707
Epoch: 6, Steps: 3 | Train Loss: 1.267 Vali Loss: 1.265 Vali Acc: 0.400 Test Loss: 1.265 Test Acc: 0.400
Validation loss decreased (-0.299987 --> -0.399987).  Saving model ...
Epoch: 7 cost time: 0.41287851333618164
Epoch: 7, Steps: 3 | Train Loss: 1.179 Vali Loss: 1.238 Vali Acc: 0.450 Test Loss: 1.238 Test Acc: 0.450
Validation loss decreased (-0.399987 --> -0.449988).  Saving model ...
Epoch: 8 cost time: 0.43678998947143555
Epoch: 8, Steps: 3 | Train Loss: 1.160 Vali Loss: 1.210 Vali Acc: 0.500 Test Loss: 1.210 Test Acc: 0.500
Validation loss decreased (-0.449988 --> -0.499988).  Saving model ...
Epoch: 9 cost time: 0.5282108783721924
Epoch: 9, Steps: 3 | Train Loss: 1.128 Vali Loss: 1.178 Vali Acc: 0.550 Test Loss: 1.178 Test Acc: 0.550
Validation loss decreased (-0.499988 --> -0.549988).  Saving model ...
Epoch: 10 cost time: 0.3843224048614502
Epoch: 10, Steps: 3 | Train Loss: 1.079 Vali Loss: 1.146 Vali Acc: 0.575 Test Loss: 1.146 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574989).  Saving model ...
Epoch: 11 cost time: 0.3779480457305908
Epoch: 11, Steps: 3 | Train Loss: 1.057 Vali Loss: 1.114 Vali Acc: 0.575 Test Loss: 1.114 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574989).  Saving model ...
Epoch: 12 cost time: 0.4208946228027344
Epoch: 12, Steps: 3 | Train Loss: 0.989 Vali Loss: 1.078 Vali Acc: 0.625 Test Loss: 1.078 Test Acc: 0.625
Validation loss decreased (-0.574989 --> -0.624989).  Saving model ...
Epoch: 13 cost time: 0.5673723220825195
Epoch: 13, Steps: 3 | Train Loss: 0.970 Vali Loss: 1.049 Vali Acc: 0.775 Test Loss: 1.049 Test Acc: 0.775
Validation loss decreased (-0.624989 --> -0.774990).  Saving model ...
Epoch: 14 cost time: 0.4385802745819092
Epoch: 14, Steps: 3 | Train Loss: 0.920 Vali Loss: 1.020 Vali Acc: 0.775 Test Loss: 1.020 Test Acc: 0.775
Validation loss decreased (-0.774990 --> -0.774990).  Saving model ...
Epoch: 15 cost time: 0.4503610134124756
Epoch: 15, Steps: 3 | Train Loss: 0.905 Vali Loss: 0.991 Vali Acc: 0.800 Test Loss: 0.991 Test Acc: 0.800
Validation loss decreased (-0.774990 --> -0.799990).  Saving model ...
Epoch: 16 cost time: 0.4033784866333008
Epoch: 16, Steps: 3 | Train Loss: 0.851 Vali Loss: 0.967 Vali Acc: 0.825 Test Loss: 0.967 Test Acc: 0.825
Validation loss decreased (-0.799990 --> -0.824990).  Saving model ...
Epoch: 17 cost time: 0.42235589027404785
Epoch: 17, Steps: 3 | Train Loss: 0.822 Vali Loss: 0.934 Vali Acc: 0.825 Test Loss: 0.934 Test Acc: 0.825
Validation loss decreased (-0.824990 --> -0.824991).  Saving model ...
Epoch: 18 cost time: 0.498187780380249
Epoch: 18, Steps: 3 | Train Loss: 0.798 Vali Loss: 0.900 Vali Acc: 0.825 Test Loss: 0.900 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824991).  Saving model ...
Epoch: 19 cost time: 0.3957192897796631
Epoch: 19, Steps: 3 | Train Loss: 0.757 Vali Loss: 0.871 Vali Acc: 0.825 Test Loss: 0.871 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824991).  Saving model ...
Epoch: 20 cost time: 0.48891258239746094
Epoch: 20, Steps: 3 | Train Loss: 0.727 Vali Loss: 0.846 Vali Acc: 0.825 Test Loss: 0.846 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824992).  Saving model ...
Epoch: 21 cost time: 0.4967029094696045
Epoch: 21, Steps: 3 | Train Loss: 0.682 Vali Loss: 0.819 Vali Acc: 0.825 Test Loss: 0.819 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 22 cost time: 0.3686354160308838
Epoch: 22, Steps: 3 | Train Loss: 0.655 Vali Loss: 0.791 Vali Acc: 0.825 Test Loss: 0.791 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 23 cost time: 0.46190404891967773
Epoch: 23, Steps: 3 | Train Loss: 0.670 Vali Loss: 0.752 Vali Acc: 0.825 Test Loss: 0.752 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 24 cost time: 0.4488565921783447
Epoch: 24, Steps: 3 | Train Loss: 0.604 Vali Loss: 0.720 Vali Acc: 0.825 Test Loss: 0.720 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824993).  Saving model ...
Epoch: 25 cost time: 0.40334010124206543
Epoch: 25, Steps: 3 | Train Loss: 0.599 Vali Loss: 0.694 Vali Acc: 0.875 Test Loss: 0.694 Test Acc: 0.875
Validation loss decreased (-0.824993 --> -0.874993).  Saving model ...
Epoch: 26 cost time: 0.4629020690917969
Epoch: 26, Steps: 3 | Train Loss: 0.556 Vali Loss: 0.666 Vali Acc: 0.900 Test Loss: 0.666 Test Acc: 0.900
Validation loss decreased (-0.874993 --> -0.899993).  Saving model ...
Epoch: 27 cost time: 0.43099069595336914
Epoch: 27, Steps: 3 | Train Loss: 0.536 Vali Loss: 0.647 Vali Acc: 0.900 Test Loss: 0.647 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899994).  Saving model ...
Epoch: 28 cost time: 0.45276665687561035
Epoch: 28, Steps: 3 | Train Loss: 0.519 Vali Loss: 0.628 Vali Acc: 0.900 Test Loss: 0.628 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 29 cost time: 0.4107933044433594
Epoch: 29, Steps: 3 | Train Loss: 0.472 Vali Loss: 0.608 Vali Acc: 0.900 Test Loss: 0.608 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 30 cost time: 0.3945496082305908
Epoch: 30, Steps: 3 | Train Loss: 0.452 Vali Loss: 0.603 Vali Acc: 0.900 Test Loss: 0.603 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 31 cost time: 0.4856541156768799
Epoch: 31, Steps: 3 | Train Loss: 0.437 Vali Loss: 0.580 Vali Acc: 0.900 Test Loss: 0.580 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 32 cost time: 0.48390626907348633
Epoch: 32, Steps: 3 | Train Loss: 0.408 Vali Loss: 0.558 Vali Acc: 0.900 Test Loss: 0.558 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 33 cost time: 0.42598819732666016
Epoch: 33, Steps: 3 | Train Loss: 0.405 Vali Loss: 0.542 Vali Acc: 0.875 Test Loss: 0.542 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.5346355438232422
Epoch: 34, Steps: 3 | Train Loss: 0.392 Vali Loss: 0.525 Vali Acc: 0.875 Test Loss: 0.525 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.3855865001678467
Epoch: 35, Steps: 3 | Train Loss: 0.382 Vali Loss: 0.507 Vali Acc: 0.875 Test Loss: 0.507 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.4050333499908447
Epoch: 36, Steps: 3 | Train Loss: 0.379 Vali Loss: 0.495 Vali Acc: 0.875 Test Loss: 0.495 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.5630514621734619
Epoch: 37, Steps: 3 | Train Loss: 0.328 Vali Loss: 0.478 Vali Acc: 0.875 Test Loss: 0.478 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.5323903560638428
Epoch: 38, Steps: 3 | Train Loss: 0.326 Vali Loss: 0.467 Vali Acc: 0.875 Test Loss: 0.467 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.4359571933746338
Epoch: 39, Steps: 3 | Train Loss: 0.300 Vali Loss: 0.453 Vali Acc: 0.875 Test Loss: 0.453 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.4244809150695801
Epoch: 40, Steps: 3 | Train Loss: 0.319 Vali Loss: 0.448 Vali Acc: 0.875 Test Loss: 0.448 Test Acc: 0.875
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.4186534881591797
Epoch: 41, Steps: 3 | Train Loss: 0.318 Vali Loss: 0.430 Vali Acc: 0.900 Test Loss: 0.430 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899996).  Saving model ...
Epoch: 42 cost time: 0.39788246154785156
Epoch: 42, Steps: 3 | Train Loss: 0.285 Vali Loss: 0.415 Vali Acc: 0.900 Test Loss: 0.415 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 43 cost time: 0.4266023635864258
Epoch: 43, Steps: 3 | Train Loss: 0.275 Vali Loss: 0.403 Vali Acc: 0.950 Test Loss: 0.403 Test Acc: 0.950
Validation loss decreased (-0.899996 --> -0.949996).  Saving model ...
Epoch: 44 cost time: 0.5048141479492188
Epoch: 44, Steps: 3 | Train Loss: 0.277 Vali Loss: 0.396 Vali Acc: 0.950 Test Loss: 0.396 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 45 cost time: 0.44484519958496094
Epoch: 45, Steps: 3 | Train Loss: 0.252 Vali Loss: 0.387 Vali Acc: 0.950 Test Loss: 0.387 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 46 cost time: 0.4676170349121094
Epoch: 46, Steps: 3 | Train Loss: 0.222 Vali Loss: 0.371 Vali Acc: 0.950 Test Loss: 0.371 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 47 cost time: 0.4685494899749756
Epoch: 47, Steps: 3 | Train Loss: 0.225 Vali Loss: 0.355 Vali Acc: 0.950 Test Loss: 0.355 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 48 cost time: 0.46743035316467285
Epoch: 48, Steps: 3 | Train Loss: 0.220 Vali Loss: 0.350 Vali Acc: 0.950 Test Loss: 0.350 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 49 cost time: 0.43692636489868164
Epoch: 49, Steps: 3 | Train Loss: 0.199 Vali Loss: 0.339 Vali Acc: 0.950 Test Loss: 0.339 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 50 cost time: 0.4313979148864746
Epoch: 50, Steps: 3 | Train Loss: 0.229 Vali Loss: 0.328 Vali Acc: 0.950 Test Loss: 0.328 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps20_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 163364
model size : 0.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps25_str13_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.6271417140960693
Epoch: 1, Steps: 3 | Train Loss: 1.406 Vali Loss: 1.357 Vali Acc: 0.300 Test Loss: 1.357 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 0.42336034774780273
Epoch: 2, Steps: 3 | Train Loss: 1.351 Vali Loss: 1.344 Vali Acc: 0.300 Test Loss: 1.344 Test Acc: 0.300
Validation loss decreased (-0.299986 --> -0.299987).  Saving model ...
Epoch: 3 cost time: 0.4355478286743164
Epoch: 3, Steps: 3 | Train Loss: 1.329 Vali Loss: 1.331 Vali Acc: 0.300 Test Loss: 1.331 Test Acc: 0.300
Validation loss decreased (-0.299987 --> -0.299987).  Saving model ...
Epoch: 4 cost time: 0.3632204532623291
Epoch: 4, Steps: 3 | Train Loss: 1.317 Vali Loss: 1.314 Vali Acc: 0.300 Test Loss: 1.314 Test Acc: 0.300
Validation loss decreased (-0.299987 --> -0.299987).  Saving model ...
Epoch: 5 cost time: 0.3750467300415039
Epoch: 5, Steps: 3 | Train Loss: 1.293 Vali Loss: 1.294 Vali Acc: 0.350 Test Loss: 1.294 Test Acc: 0.350
Validation loss decreased (-0.299987 --> -0.349987).  Saving model ...
Epoch: 6 cost time: 0.42327046394348145
Epoch: 6, Steps: 3 | Train Loss: 1.285 Vali Loss: 1.269 Vali Acc: 0.375 Test Loss: 1.269 Test Acc: 0.375
Validation loss decreased (-0.349987 --> -0.374987).  Saving model ...
Epoch: 7 cost time: 0.40006518363952637
Epoch: 7, Steps: 3 | Train Loss: 1.246 Vali Loss: 1.245 Vali Acc: 0.425 Test Loss: 1.245 Test Acc: 0.425
Validation loss decreased (-0.374987 --> -0.424988).  Saving model ...
Epoch: 8 cost time: 0.36823415756225586
Epoch: 8, Steps: 3 | Train Loss: 1.184 Vali Loss: 1.218 Vali Acc: 0.575 Test Loss: 1.218 Test Acc: 0.575
Validation loss decreased (-0.424988 --> -0.574988).  Saving model ...
Epoch: 9 cost time: 0.4532046318054199
Epoch: 9, Steps: 3 | Train Loss: 1.155 Vali Loss: 1.191 Vali Acc: 0.575 Test Loss: 1.191 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 10 cost time: 0.3572707176208496
Epoch: 10, Steps: 3 | Train Loss: 1.123 Vali Loss: 1.164 Vali Acc: 0.600 Test Loss: 1.164 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599988).  Saving model ...
Epoch: 11 cost time: 0.40761303901672363
Epoch: 11, Steps: 3 | Train Loss: 1.090 Vali Loss: 1.137 Vali Acc: 0.625 Test Loss: 1.137 Test Acc: 0.625
Validation loss decreased (-0.599988 --> -0.624989).  Saving model ...
Epoch: 12 cost time: 0.5069808959960938
Epoch: 12, Steps: 3 | Train Loss: 1.078 Vali Loss: 1.111 Vali Acc: 0.625 Test Loss: 1.111 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 13 cost time: 0.47077178955078125
Epoch: 13, Steps: 3 | Train Loss: 1.022 Vali Loss: 1.082 Vali Acc: 0.625 Test Loss: 1.082 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 14 cost time: 0.48768019676208496
Epoch: 14, Steps: 3 | Train Loss: 0.998 Vali Loss: 1.059 Vali Acc: 0.675 Test Loss: 1.059 Test Acc: 0.675
Validation loss decreased (-0.624989 --> -0.674989).  Saving model ...
Epoch: 15 cost time: 0.3906095027923584
Epoch: 15, Steps: 3 | Train Loss: 0.992 Vali Loss: 1.030 Vali Acc: 0.725 Test Loss: 1.030 Test Acc: 0.725
Validation loss decreased (-0.674989 --> -0.724990).  Saving model ...
Epoch: 16 cost time: 0.37274765968322754
Epoch: 16, Steps: 3 | Train Loss: 0.925 Vali Loss: 0.998 Vali Acc: 0.725 Test Loss: 0.998 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724990).  Saving model ...
Epoch: 17 cost time: 0.3811190128326416
Epoch: 17, Steps: 3 | Train Loss: 0.898 Vali Loss: 0.972 Vali Acc: 0.775 Test Loss: 0.972 Test Acc: 0.775
Validation loss decreased (-0.724990 --> -0.774990).  Saving model ...
Epoch: 18 cost time: 0.4813807010650635
Epoch: 18, Steps: 3 | Train Loss: 0.875 Vali Loss: 0.948 Vali Acc: 0.775 Test Loss: 0.948 Test Acc: 0.775
Validation loss decreased (-0.774990 --> -0.774991).  Saving model ...
Epoch: 19 cost time: 0.40351438522338867
Epoch: 19, Steps: 3 | Train Loss: 0.861 Vali Loss: 0.916 Vali Acc: 0.775 Test Loss: 0.916 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 20 cost time: 0.39002227783203125
Epoch: 20, Steps: 3 | Train Loss: 0.820 Vali Loss: 0.897 Vali Acc: 0.775 Test Loss: 0.897 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 21 cost time: 0.4333789348602295
Epoch: 21, Steps: 3 | Train Loss: 0.770 Vali Loss: 0.876 Vali Acc: 0.800 Test Loss: 0.876 Test Acc: 0.800
Validation loss decreased (-0.774991 --> -0.799991).  Saving model ...
Epoch: 22 cost time: 0.41413283348083496
Epoch: 22, Steps: 3 | Train Loss: 0.729 Vali Loss: 0.857 Vali Acc: 0.800 Test Loss: 0.857 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799991).  Saving model ...
Epoch: 23 cost time: 0.39418840408325195
Epoch: 23, Steps: 3 | Train Loss: 0.782 Vali Loss: 0.824 Vali Acc: 0.800 Test Loss: 0.824 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799992).  Saving model ...
Epoch: 24 cost time: 0.4178507328033447
Epoch: 24, Steps: 3 | Train Loss: 0.684 Vali Loss: 0.810 Vali Acc: 0.800 Test Loss: 0.810 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 25 cost time: 0.4155397415161133
Epoch: 25, Steps: 3 | Train Loss: 0.661 Vali Loss: 0.794 Vali Acc: 0.800 Test Loss: 0.794 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 26 cost time: 0.45975732803344727
Epoch: 26, Steps: 3 | Train Loss: 0.631 Vali Loss: 0.775 Vali Acc: 0.825 Test Loss: 0.775 Test Acc: 0.825
Validation loss decreased (-0.799992 --> -0.824992).  Saving model ...
Epoch: 27 cost time: 0.4407541751861572
Epoch: 27, Steps: 3 | Train Loss: 0.641 Vali Loss: 0.755 Vali Acc: 0.825 Test Loss: 0.755 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 28 cost time: 0.38644981384277344
Epoch: 28, Steps: 3 | Train Loss: 0.592 Vali Loss: 0.731 Vali Acc: 0.850 Test Loss: 0.731 Test Acc: 0.850
Validation loss decreased (-0.824992 --> -0.849993).  Saving model ...
Epoch: 29 cost time: 0.3860783576965332
Epoch: 29, Steps: 3 | Train Loss: 0.585 Vali Loss: 0.709 Vali Acc: 0.850 Test Loss: 0.709 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 30 cost time: 0.40369677543640137
Epoch: 30, Steps: 3 | Train Loss: 0.542 Vali Loss: 0.693 Vali Acc: 0.875 Test Loss: 0.693 Test Acc: 0.875
Validation loss decreased (-0.849993 --> -0.874993).  Saving model ...
Epoch: 31 cost time: 0.4224860668182373
Epoch: 31, Steps: 3 | Train Loss: 0.520 Vali Loss: 0.680 Vali Acc: 0.875 Test Loss: 0.680 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 32 cost time: 0.4791123867034912
Epoch: 32, Steps: 3 | Train Loss: 0.509 Vali Loss: 0.652 Vali Acc: 0.875 Test Loss: 0.652 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 33 cost time: 0.4315526485443115
Epoch: 33, Steps: 3 | Train Loss: 0.481 Vali Loss: 0.629 Vali Acc: 0.875 Test Loss: 0.629 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 34 cost time: 0.48243093490600586
Epoch: 34, Steps: 3 | Train Loss: 0.466 Vali Loss: 0.607 Vali Acc: 0.875 Test Loss: 0.607 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 35 cost time: 0.3762936592102051
Epoch: 35, Steps: 3 | Train Loss: 0.451 Vali Loss: 0.582 Vali Acc: 0.875 Test Loss: 0.582 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 36 cost time: 0.374375581741333
Epoch: 36, Steps: 3 | Train Loss: 0.429 Vali Loss: 0.573 Vali Acc: 0.875 Test Loss: 0.573 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 37 cost time: 0.4018824100494385
Epoch: 37, Steps: 3 | Train Loss: 0.402 Vali Loss: 0.564 Vali Acc: 0.875 Test Loss: 0.564 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 38 cost time: 0.4085261821746826
Epoch: 38, Steps: 3 | Train Loss: 0.390 Vali Loss: 0.548 Vali Acc: 0.900 Test Loss: 0.548 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899995).  Saving model ...
Epoch: 39 cost time: 0.4030146598815918
Epoch: 39, Steps: 3 | Train Loss: 0.366 Vali Loss: 0.527 Vali Acc: 0.900 Test Loss: 0.527 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 40 cost time: 0.5250391960144043
Epoch: 40, Steps: 3 | Train Loss: 0.365 Vali Loss: 0.511 Vali Acc: 0.900 Test Loss: 0.511 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 41 cost time: 0.44728803634643555
Epoch: 41, Steps: 3 | Train Loss: 0.365 Vali Loss: 0.492 Vali Acc: 0.900 Test Loss: 0.492 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 42 cost time: 0.3988382816314697
Epoch: 42, Steps: 3 | Train Loss: 0.327 Vali Loss: 0.478 Vali Acc: 0.900 Test Loss: 0.478 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 43 cost time: 0.3848731517791748
Epoch: 43, Steps: 3 | Train Loss: 0.337 Vali Loss: 0.463 Vali Acc: 0.900 Test Loss: 0.463 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 44 cost time: 0.42036914825439453
Epoch: 44, Steps: 3 | Train Loss: 0.309 Vali Loss: 0.457 Vali Acc: 0.900 Test Loss: 0.457 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 45 cost time: 0.3879740238189697
Epoch: 45, Steps: 3 | Train Loss: 0.319 Vali Loss: 0.440 Vali Acc: 0.900 Test Loss: 0.440 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 46 cost time: 0.5108249187469482
Epoch: 46, Steps: 3 | Train Loss: 0.283 Vali Loss: 0.441 Vali Acc: 0.900 Test Loss: 0.441 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.4179086685180664
Epoch: 47, Steps: 3 | Train Loss: 0.262 Vali Loss: 0.422 Vali Acc: 0.925 Test Loss: 0.422 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924996).  Saving model ...
Epoch: 48 cost time: 0.4053764343261719
Epoch: 48, Steps: 3 | Train Loss: 0.267 Vali Loss: 0.407 Vali Acc: 0.925 Test Loss: 0.407 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 49 cost time: 0.4074563980102539
Epoch: 49, Steps: 3 | Train Loss: 0.269 Vali Loss: 0.392 Vali Acc: 0.925 Test Loss: 0.392 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 50 cost time: 0.4294116497039795
Epoch: 50, Steps: 3 | Train Loss: 0.260 Vali Loss: 0.381 Vali Acc: 0.925 Test Loss: 0.381 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps25_str13_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 161988
model size : 0.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.689255714416504
Epoch: 1, Steps: 3 | Train Loss: 1.465 Vali Loss: 1.349 Vali Acc: 0.450 Test Loss: 1.349 Test Acc: 0.450
Validation loss decreased (inf --> -0.449987).  Saving model ...
Epoch: 2 cost time: 0.44336485862731934
Epoch: 2, Steps: 3 | Train Loss: 1.153 Vali Loss: 1.160 Vali Acc: 0.475 Test Loss: 1.160 Test Acc: 0.475
Validation loss decreased (-0.449987 --> -0.474988).  Saving model ...
Epoch: 3 cost time: 0.45319128036499023
Epoch: 3, Steps: 3 | Train Loss: 0.823 Vali Loss: 0.833 Vali Acc: 0.825 Test Loss: 0.833 Test Acc: 0.825
Validation loss decreased (-0.474988 --> -0.824992).  Saving model ...
Epoch: 4 cost time: 0.41758012771606445
Epoch: 4, Steps: 3 | Train Loss: 0.491 Vali Loss: 0.542 Vali Acc: 0.975 Test Loss: 0.542 Test Acc: 0.975
Validation loss decreased (-0.824992 --> -0.974995).  Saving model ...
Epoch: 5 cost time: 0.4331629276275635
Epoch: 5, Steps: 3 | Train Loss: 0.288 Vali Loss: 0.344 Vali Acc: 0.975 Test Loss: 0.344 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974997).  Saving model ...
Epoch: 6 cost time: 0.48663902282714844
Epoch: 6, Steps: 3 | Train Loss: 0.147 Vali Loss: 0.254 Vali Acc: 0.950 Test Loss: 0.254 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.46320247650146484
Epoch: 7, Steps: 3 | Train Loss: 0.102 Vali Loss: 0.233 Vali Acc: 0.925 Test Loss: 0.233 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.4260749816894531
Epoch: 8, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.272 Vali Acc: 0.925 Test Loss: 0.272 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.496807336807251
Epoch: 9, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.348 Vali Acc: 0.925 Test Loss: 0.348 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.5191922187805176
Epoch: 10, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.421 Vali Acc: 0.925 Test Loss: 0.421 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.5603899955749512
Epoch: 11, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.472 Vali Acc: 0.925 Test Loss: 0.472 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.4131605625152588
Epoch: 12, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.506 Vali Acc: 0.925 Test Loss: 0.506 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.4669487476348877
Epoch: 13, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.522 Vali Acc: 0.925 Test Loss: 0.522 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.48375654220581055
Epoch: 14, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.539 Vali Acc: 0.925 Test Loss: 0.539 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.4278078079223633
Epoch: 15, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.536 Vali Acc: 0.925 Test Loss: 0.536 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 1961988
model size : 7.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.651231288909912
Epoch: 1, Steps: 3 | Train Loss: 1.513 Vali Loss: 1.341 Vali Acc: 0.350 Test Loss: 1.341 Test Acc: 0.350
Validation loss decreased (inf --> -0.349987).  Saving model ...
Epoch: 2 cost time: 0.49762511253356934
Epoch: 2, Steps: 3 | Train Loss: 1.207 Vali Loss: 1.174 Vali Acc: 0.500 Test Loss: 1.174 Test Acc: 0.500
Validation loss decreased (-0.349987 --> -0.499988).  Saving model ...
Epoch: 3 cost time: 0.4597141742706299
Epoch: 3, Steps: 3 | Train Loss: 0.940 Vali Loss: 0.878 Vali Acc: 0.725 Test Loss: 0.878 Test Acc: 0.725
Validation loss decreased (-0.499988 --> -0.724991).  Saving model ...
Epoch: 4 cost time: 0.4593503475189209
Epoch: 4, Steps: 3 | Train Loss: 0.622 Vali Loss: 0.625 Vali Acc: 0.850 Test Loss: 0.625 Test Acc: 0.850
Validation loss decreased (-0.724991 --> -0.849994).  Saving model ...
Epoch: 5 cost time: 0.4859638214111328
Epoch: 5, Steps: 3 | Train Loss: 0.414 Vali Loss: 0.441 Vali Acc: 0.950 Test Loss: 0.441 Test Acc: 0.950
Validation loss decreased (-0.849994 --> -0.949996).  Saving model ...
Epoch: 6 cost time: 0.5825226306915283
Epoch: 6, Steps: 3 | Train Loss: 0.263 Vali Loss: 0.323 Vali Acc: 0.950 Test Loss: 0.323 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 7 cost time: 0.43088626861572266
Epoch: 7, Steps: 3 | Train Loss: 0.152 Vali Loss: 0.252 Vali Acc: 0.975 Test Loss: 0.252 Test Acc: 0.975
Validation loss decreased (-0.949997 --> -0.974997).  Saving model ...
Epoch: 8 cost time: 0.4783446788787842
Epoch: 8, Steps: 3 | Train Loss: 0.121 Vali Loss: 0.212 Vali Acc: 0.975 Test Loss: 0.212 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 9 cost time: 0.4119703769683838
Epoch: 9, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.206 Vali Acc: 0.950 Test Loss: 0.206 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.45767855644226074
Epoch: 10, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.215 Vali Acc: 0.950 Test Loss: 0.215 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.4845700263977051
Epoch: 11, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.247 Vali Acc: 0.925 Test Loss: 0.247 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.5221476554870605
Epoch: 12, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.296 Vali Acc: 0.900 Test Loss: 0.296 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.4789245128631592
Epoch: 13, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.341 Vali Acc: 0.900 Test Loss: 0.341 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.4595801830291748
Epoch: 14, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.376 Vali Acc: 0.900 Test Loss: 0.376 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.48397016525268555
Epoch: 15, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.400 Vali Acc: 0.900 Test Loss: 0.400 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.4766106605529785
Epoch: 16, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.399 Vali Acc: 0.900 Test Loss: 0.399 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.5115063190460205
Epoch: 17, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.396 Vali Acc: 0.900 Test Loss: 0.396 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.4761195182800293
Epoch: 18, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.401 Vali Acc: 0.900 Test Loss: 0.401 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 1858052
model size : 7.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.680626630783081
Epoch: 1, Steps: 3 | Train Loss: 1.322 Vali Loss: 1.307 Vali Acc: 0.500 Test Loss: 1.307 Test Acc: 0.500
Validation loss decreased (inf --> -0.499987).  Saving model ...
Epoch: 2 cost time: 0.41701531410217285
Epoch: 2, Steps: 3 | Train Loss: 1.116 Vali Loss: 1.164 Vali Acc: 0.600 Test Loss: 1.164 Test Acc: 0.600
Validation loss decreased (-0.499987 --> -0.599988).  Saving model ...
Epoch: 3 cost time: 0.4199545383453369
Epoch: 3, Steps: 3 | Train Loss: 0.860 Vali Loss: 0.935 Vali Acc: 0.825 Test Loss: 0.935 Test Acc: 0.825
Validation loss decreased (-0.599988 --> -0.824991).  Saving model ...
Epoch: 4 cost time: 0.45456480979919434
Epoch: 4, Steps: 3 | Train Loss: 0.644 Vali Loss: 0.720 Vali Acc: 0.875 Test Loss: 0.720 Test Acc: 0.875
Validation loss decreased (-0.824991 --> -0.874993).  Saving model ...
Epoch: 5 cost time: 0.4433603286743164
Epoch: 5, Steps: 3 | Train Loss: 0.490 Vali Loss: 0.532 Vali Acc: 0.925 Test Loss: 0.532 Test Acc: 0.925
Validation loss decreased (-0.874993 --> -0.924995).  Saving model ...
Epoch: 6 cost time: 0.42197489738464355
Epoch: 6, Steps: 3 | Train Loss: 0.330 Vali Loss: 0.399 Vali Acc: 0.950 Test Loss: 0.399 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949996).  Saving model ...
Epoch: 7 cost time: 0.41440629959106445
Epoch: 7, Steps: 3 | Train Loss: 0.212 Vali Loss: 0.306 Vali Acc: 0.975 Test Loss: 0.306 Test Acc: 0.975
Validation loss decreased (-0.949996 --> -0.974997).  Saving model ...
Epoch: 8 cost time: 0.43196558952331543
Epoch: 8, Steps: 3 | Train Loss: 0.184 Vali Loss: 0.248 Vali Acc: 0.975 Test Loss: 0.248 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 9 cost time: 0.48378729820251465
Epoch: 9, Steps: 3 | Train Loss: 0.100 Vali Loss: 0.238 Vali Acc: 0.950 Test Loss: 0.238 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.44532012939453125
Epoch: 10, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.235 Vali Acc: 0.950 Test Loss: 0.235 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.4032926559448242
Epoch: 11, Steps: 3 | Train Loss: 0.062 Vali Loss: 0.243 Vali Acc: 0.950 Test Loss: 0.243 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.3920886516571045
Epoch: 12, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.260 Vali Acc: 0.950 Test Loss: 0.260 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.41829943656921387
Epoch: 13, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.276 Vali Acc: 0.950 Test Loss: 0.276 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.40306854248046875
Epoch: 14, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.291 Vali Acc: 0.950 Test Loss: 0.291 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.5414459705352783
Epoch: 15, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.301 Vali Acc: 0.950 Test Loss: 0.301 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.4009692668914795
Epoch: 16, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.300 Vali Acc: 0.950 Test Loss: 0.300 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.49244141578674316
Epoch: 17, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.306 Vali Acc: 0.950 Test Loss: 0.306 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.5169486999511719
Epoch: 18, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.305 Vali Acc: 0.950 Test Loss: 0.305 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 1809668
model size : 6.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.6735546588897705
Epoch: 1, Steps: 3 | Train Loss: 1.503 Vali Loss: 1.261 Vali Acc: 0.450 Test Loss: 1.261 Test Acc: 0.450
Validation loss decreased (inf --> -0.449987).  Saving model ...
Epoch: 2 cost time: 0.4228205680847168
Epoch: 2, Steps: 3 | Train Loss: 1.263 Vali Loss: 1.145 Vali Acc: 0.650 Test Loss: 1.145 Test Acc: 0.650
Validation loss decreased (-0.449987 --> -0.649989).  Saving model ...
Epoch: 3 cost time: 0.40338706970214844
Epoch: 3, Steps: 3 | Train Loss: 1.051 Vali Loss: 0.939 Vali Acc: 0.850 Test Loss: 0.939 Test Acc: 0.850
Validation loss decreased (-0.649989 --> -0.849991).  Saving model ...
Epoch: 4 cost time: 0.444843053817749
Epoch: 4, Steps: 3 | Train Loss: 0.830 Vali Loss: 0.765 Vali Acc: 0.875 Test Loss: 0.765 Test Acc: 0.875
Validation loss decreased (-0.849991 --> -0.874992).  Saving model ...
Epoch: 5 cost time: 0.46021056175231934
Epoch: 5, Steps: 3 | Train Loss: 0.590 Vali Loss: 0.603 Vali Acc: 0.925 Test Loss: 0.603 Test Acc: 0.925
Validation loss decreased (-0.874992 --> -0.924994).  Saving model ...
Epoch: 6 cost time: 0.449138879776001
Epoch: 6, Steps: 3 | Train Loss: 0.420 Vali Loss: 0.449 Vali Acc: 0.950 Test Loss: 0.449 Test Acc: 0.950
Validation loss decreased (-0.924994 --> -0.949996).  Saving model ...
Epoch: 7 cost time: 0.42843031883239746
Epoch: 7, Steps: 3 | Train Loss: 0.288 Vali Loss: 0.339 Vali Acc: 0.975 Test Loss: 0.339 Test Acc: 0.975
Validation loss decreased (-0.949996 --> -0.974997).  Saving model ...
Epoch: 8 cost time: 0.44965052604675293
Epoch: 8, Steps: 3 | Train Loss: 0.194 Vali Loss: 0.252 Vali Acc: 0.975 Test Loss: 0.252 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 9 cost time: 0.4544692039489746
Epoch: 9, Steps: 3 | Train Loss: 0.181 Vali Loss: 0.201 Vali Acc: 0.975 Test Loss: 0.201 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 10 cost time: 0.47736382484436035
Epoch: 10, Steps: 3 | Train Loss: 0.113 Vali Loss: 0.174 Vali Acc: 0.975 Test Loss: 0.174 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 11 cost time: 0.41103482246398926
Epoch: 11, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.169 Vali Acc: 0.975 Test Loss: 0.169 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 12 cost time: 0.508465051651001
Epoch: 12, Steps: 3 | Train Loss: 0.061 Vali Loss: 0.164 Vali Acc: 0.950 Test Loss: 0.164 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.394115686416626
Epoch: 13, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.171 Vali Acc: 0.950 Test Loss: 0.171 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.4214601516723633
Epoch: 14, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.177 Vali Acc: 0.925 Test Loss: 0.177 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.3701283931732178
Epoch: 15, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.180 Vali Acc: 0.925 Test Loss: 0.180 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.40129947662353516
Epoch: 16, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.179 Vali Acc: 0.925 Test Loss: 0.179 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.4346001148223877
Epoch: 17, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.186 Vali Acc: 0.925 Test Loss: 0.186 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.4293537139892578
Epoch: 18, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.187 Vali Acc: 0.925 Test Loss: 0.187 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.3766906261444092
Epoch: 19, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.197 Vali Acc: 0.925 Test Loss: 0.197 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.3986666202545166
Epoch: 20, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.184 Vali Acc: 0.925 Test Loss: 0.184 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.4558436870574951
Epoch: 21, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.183 Vali Acc: 0.925 Test Loss: 0.183 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 1779460
model size : 6.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.5769786834716797
Epoch: 1, Steps: 3 | Train Loss: 1.408 Vali Loss: 1.289 Vali Acc: 0.225 Test Loss: 1.289 Test Acc: 0.225
Validation loss decreased (inf --> -0.224987).  Saving model ...
Epoch: 2 cost time: 0.36815690994262695
Epoch: 2, Steps: 3 | Train Loss: 1.201 Vali Loss: 1.210 Vali Acc: 0.325 Test Loss: 1.210 Test Acc: 0.325
Validation loss decreased (-0.224987 --> -0.324988).  Saving model ...
Epoch: 3 cost time: 0.4900960922241211
Epoch: 3, Steps: 3 | Train Loss: 1.039 Vali Loss: 1.064 Vali Acc: 0.750 Test Loss: 1.064 Test Acc: 0.750
Validation loss decreased (-0.324988 --> -0.749989).  Saving model ...
Epoch: 4 cost time: 0.43639421463012695
Epoch: 4, Steps: 3 | Train Loss: 0.862 Vali Loss: 0.910 Vali Acc: 0.825 Test Loss: 0.910 Test Acc: 0.825
Validation loss decreased (-0.749989 --> -0.824991).  Saving model ...
Epoch: 5 cost time: 0.4407968521118164
Epoch: 5, Steps: 3 | Train Loss: 0.732 Vali Loss: 0.748 Vali Acc: 0.875 Test Loss: 0.748 Test Acc: 0.875
Validation loss decreased (-0.824991 --> -0.874993).  Saving model ...
Epoch: 6 cost time: 0.39991164207458496
Epoch: 6, Steps: 3 | Train Loss: 0.539 Vali Loss: 0.614 Vali Acc: 0.900 Test Loss: 0.614 Test Acc: 0.900
Validation loss decreased (-0.874993 --> -0.899994).  Saving model ...
Epoch: 7 cost time: 0.4805576801300049
Epoch: 7, Steps: 3 | Train Loss: 0.438 Vali Loss: 0.495 Vali Acc: 0.900 Test Loss: 0.495 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 8 cost time: 0.39569735527038574
Epoch: 8, Steps: 3 | Train Loss: 0.341 Vali Loss: 0.403 Vali Acc: 0.950 Test Loss: 0.403 Test Acc: 0.950
Validation loss decreased (-0.899995 --> -0.949996).  Saving model ...
Epoch: 9 cost time: 0.4282238483428955
Epoch: 9, Steps: 3 | Train Loss: 0.271 Vali Loss: 0.329 Vali Acc: 0.950 Test Loss: 0.329 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 10 cost time: 0.42315149307250977
Epoch: 10, Steps: 3 | Train Loss: 0.199 Vali Loss: 0.291 Vali Acc: 0.950 Test Loss: 0.291 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 11 cost time: 0.3991053104400635
Epoch: 11, Steps: 3 | Train Loss: 0.155 Vali Loss: 0.266 Vali Acc: 0.925 Test Loss: 0.266 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.40525317192077637
Epoch: 12, Steps: 3 | Train Loss: 0.119 Vali Loss: 0.259 Vali Acc: 0.925 Test Loss: 0.259 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.3975560665130615
Epoch: 13, Steps: 3 | Train Loss: 0.101 Vali Loss: 0.259 Vali Acc: 0.925 Test Loss: 0.259 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.4330732822418213
Epoch: 14, Steps: 3 | Train Loss: 0.089 Vali Loss: 0.263 Vali Acc: 0.950 Test Loss: 0.263 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 15 cost time: 0.4264848232269287
Epoch: 15, Steps: 3 | Train Loss: 0.058 Vali Loss: 0.240 Vali Acc: 0.950 Test Loss: 0.240 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 16 cost time: 0.43436479568481445
Epoch: 16, Steps: 3 | Train Loss: 0.063 Vali Loss: 0.228 Vali Acc: 0.950 Test Loss: 0.228 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 17 cost time: 0.47560787200927734
Epoch: 17, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.216 Vali Acc: 0.950 Test Loss: 0.216 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 18 cost time: 0.4273092746734619
Epoch: 18, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.212 Vali Acc: 0.950 Test Loss: 0.212 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 19 cost time: 0.43964529037475586
Epoch: 19, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.214 Vali Acc: 0.950 Test Loss: 0.214 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.42569637298583984
Epoch: 20, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.213 Vali Acc: 0.950 Test Loss: 0.213 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.40302538871765137
Epoch: 21, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.218 Vali Acc: 0.950 Test Loss: 0.218 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.4004089832305908
Epoch: 22, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.220 Vali Acc: 0.950 Test Loss: 0.220 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.4431431293487549
Epoch: 23, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.221 Vali Acc: 0.950 Test Loss: 0.221 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.4093925952911377
Epoch: 24, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.227 Vali Acc: 0.950 Test Loss: 0.227 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.4343395233154297
Epoch: 25, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.234 Vali Acc: 0.950 Test Loss: 0.234 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.40169692039489746
Epoch: 26, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.236 Vali Acc: 0.950 Test Loss: 0.236 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.41602253913879395
Epoch: 27, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.240 Vali Acc: 0.950 Test Loss: 0.240 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.4564952850341797
Epoch: 28, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.241 Vali Acc: 0.950 Test Loss: 0.241 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 1731588
model size : 6.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps20_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.7226848602294922
Epoch: 1, Steps: 3 | Train Loss: 1.224 Vali Loss: 1.322 Vali Acc: 0.300 Test Loss: 1.322 Test Acc: 0.300
Validation loss decreased (inf --> -0.299987).  Saving model ...
Epoch: 2 cost time: 0.44232726097106934
Epoch: 2, Steps: 3 | Train Loss: 1.102 Vali Loss: 1.238 Vali Acc: 0.500 Test Loss: 1.238 Test Acc: 0.500
Validation loss decreased (-0.299987 --> -0.499988).  Saving model ...
Epoch: 3 cost time: 0.48468542098999023
Epoch: 3, Steps: 3 | Train Loss: 0.969 Vali Loss: 1.103 Vali Acc: 0.675 Test Loss: 1.103 Test Acc: 0.675
Validation loss decreased (-0.499988 --> -0.674989).  Saving model ...
Epoch: 4 cost time: 0.4165661334991455
Epoch: 4, Steps: 3 | Train Loss: 0.822 Vali Loss: 0.952 Vali Acc: 0.750 Test Loss: 0.952 Test Acc: 0.750
Validation loss decreased (-0.674989 --> -0.749990).  Saving model ...
Epoch: 5 cost time: 0.4312913417816162
Epoch: 5, Steps: 3 | Train Loss: 0.682 Vali Loss: 0.806 Vali Acc: 0.875 Test Loss: 0.806 Test Acc: 0.875
Validation loss decreased (-0.749990 --> -0.874992).  Saving model ...
Epoch: 6 cost time: 0.40778422355651855
Epoch: 6, Steps: 3 | Train Loss: 0.573 Vali Loss: 0.668 Vali Acc: 0.950 Test Loss: 0.668 Test Acc: 0.950
Validation loss decreased (-0.874992 --> -0.949993).  Saving model ...
Epoch: 7 cost time: 0.42835068702697754
Epoch: 7, Steps: 3 | Train Loss: 0.481 Vali Loss: 0.558 Vali Acc: 0.950 Test Loss: 0.558 Test Acc: 0.950
Validation loss decreased (-0.949993 --> -0.949994).  Saving model ...
Epoch: 8 cost time: 0.3909618854522705
Epoch: 8, Steps: 3 | Train Loss: 0.384 Vali Loss: 0.453 Vali Acc: 0.950 Test Loss: 0.453 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 9 cost time: 0.4149324893951416
Epoch: 9, Steps: 3 | Train Loss: 0.296 Vali Loss: 0.381 Vali Acc: 0.950 Test Loss: 0.381 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 10 cost time: 0.4144930839538574
Epoch: 10, Steps: 3 | Train Loss: 0.271 Vali Loss: 0.324 Vali Acc: 0.975 Test Loss: 0.324 Test Acc: 0.975
Validation loss decreased (-0.949996 --> -0.974997).  Saving model ...
Epoch: 11 cost time: 0.5397739410400391
Epoch: 11, Steps: 3 | Train Loss: 0.184 Vali Loss: 0.282 Vali Acc: 0.975 Test Loss: 0.282 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 12 cost time: 0.44010424613952637
Epoch: 12, Steps: 3 | Train Loss: 0.147 Vali Loss: 0.246 Vali Acc: 0.975 Test Loss: 0.246 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 13 cost time: 0.4694216251373291
Epoch: 13, Steps: 3 | Train Loss: 0.151 Vali Loss: 0.232 Vali Acc: 0.950 Test Loss: 0.232 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.4626433849334717
Epoch: 14, Steps: 3 | Train Loss: 0.108 Vali Loss: 0.227 Vali Acc: 0.950 Test Loss: 0.227 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.40044426918029785
Epoch: 15, Steps: 3 | Train Loss: 0.100 Vali Loss: 0.221 Vali Acc: 0.950 Test Loss: 0.221 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.5227048397064209
Epoch: 16, Steps: 3 | Train Loss: 0.083 Vali Loss: 0.215 Vali Acc: 0.950 Test Loss: 0.215 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.4555683135986328
Epoch: 17, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.221 Vali Acc: 0.950 Test Loss: 0.221 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.44982099533081055
Epoch: 18, Steps: 3 | Train Loss: 0.075 Vali Loss: 0.218 Vali Acc: 0.950 Test Loss: 0.218 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.44955897331237793
Epoch: 19, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.213 Vali Acc: 0.950 Test Loss: 0.213 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.4395332336425781
Epoch: 20, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.208 Vali Acc: 0.950 Test Loss: 0.208 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.45539236068725586
Epoch: 21, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.202 Vali Acc: 0.950 Test Loss: 0.202 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.44445300102233887
Epoch: 22, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.194 Vali Acc: 0.950 Test Loss: 0.194 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps20_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 1720580
model size : 6.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps25_str13_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.656071662902832
Epoch: 1, Steps: 3 | Train Loss: 1.238 Vali Loss: 1.274 Vali Acc: 0.225 Test Loss: 1.274 Test Acc: 0.225
Validation loss decreased (inf --> -0.224987).  Saving model ...
Epoch: 2 cost time: 0.4192500114440918
Epoch: 2, Steps: 3 | Train Loss: 1.132 Vali Loss: 1.217 Vali Acc: 0.275 Test Loss: 1.217 Test Acc: 0.275
Validation loss decreased (-0.224987 --> -0.274988).  Saving model ...
Epoch: 3 cost time: 0.4067087173461914
Epoch: 3, Steps: 3 | Train Loss: 1.056 Vali Loss: 1.123 Vali Acc: 0.300 Test Loss: 1.123 Test Acc: 0.300
Validation loss decreased (-0.274988 --> -0.299989).  Saving model ...
Epoch: 4 cost time: 0.48883795738220215
Epoch: 4, Steps: 3 | Train Loss: 0.977 Vali Loss: 1.006 Vali Acc: 0.400 Test Loss: 1.006 Test Acc: 0.400
Validation loss decreased (-0.299989 --> -0.399990).  Saving model ...
Epoch: 5 cost time: 0.41510534286499023
Epoch: 5, Steps: 3 | Train Loss: 0.854 Vali Loss: 0.884 Vali Acc: 0.625 Test Loss: 0.884 Test Acc: 0.625
Validation loss decreased (-0.399990 --> -0.624991).  Saving model ...
Epoch: 6 cost time: 0.4387776851654053
Epoch: 6, Steps: 3 | Train Loss: 0.717 Vali Loss: 0.772 Vali Acc: 0.725 Test Loss: 0.772 Test Acc: 0.725
Validation loss decreased (-0.624991 --> -0.724992).  Saving model ...
Epoch: 7 cost time: 0.44940900802612305
Epoch: 7, Steps: 3 | Train Loss: 0.617 Vali Loss: 0.657 Vali Acc: 0.925 Test Loss: 0.657 Test Acc: 0.925
Validation loss decreased (-0.724992 --> -0.924993).  Saving model ...
Epoch: 8 cost time: 0.3989288806915283
Epoch: 8, Steps: 3 | Train Loss: 0.501 Vali Loss: 0.557 Vali Acc: 0.975 Test Loss: 0.557 Test Acc: 0.975
Validation loss decreased (-0.924993 --> -0.974994).  Saving model ...
Epoch: 9 cost time: 0.38210034370422363
Epoch: 9, Steps: 3 | Train Loss: 0.428 Vali Loss: 0.469 Vali Acc: 0.975 Test Loss: 0.469 Test Acc: 0.975
Validation loss decreased (-0.974994 --> -0.974995).  Saving model ...
Epoch: 10 cost time: 0.43814587593078613
Epoch: 10, Steps: 3 | Train Loss: 0.328 Vali Loss: 0.403 Vali Acc: 0.975 Test Loss: 0.403 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 11 cost time: 0.40883588790893555
Epoch: 11, Steps: 3 | Train Loss: 0.283 Vali Loss: 0.353 Vali Acc: 0.975 Test Loss: 0.353 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 12 cost time: 0.42856359481811523
Epoch: 12, Steps: 3 | Train Loss: 0.240 Vali Loss: 0.316 Vali Acc: 0.975 Test Loss: 0.316 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 13 cost time: 0.43392157554626465
Epoch: 13, Steps: 3 | Train Loss: 0.185 Vali Loss: 0.279 Vali Acc: 0.975 Test Loss: 0.279 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 14 cost time: 0.4100151062011719
Epoch: 14, Steps: 3 | Train Loss: 0.168 Vali Loss: 0.250 Vali Acc: 0.975 Test Loss: 0.250 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 15 cost time: 0.44603776931762695
Epoch: 15, Steps: 3 | Train Loss: 0.148 Vali Loss: 0.227 Vali Acc: 0.975 Test Loss: 0.227 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 16 cost time: 0.4174158573150635
Epoch: 16, Steps: 3 | Train Loss: 0.130 Vali Loss: 0.209 Vali Acc: 0.975 Test Loss: 0.209 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 17 cost time: 0.45403313636779785
Epoch: 17, Steps: 3 | Train Loss: 0.112 Vali Loss: 0.194 Vali Acc: 0.975 Test Loss: 0.194 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 18 cost time: 0.4858102798461914
Epoch: 18, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.177 Vali Acc: 0.975 Test Loss: 0.177 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 19 cost time: 0.49576616287231445
Epoch: 19, Steps: 3 | Train Loss: 0.079 Vali Loss: 0.173 Vali Acc: 0.975 Test Loss: 0.173 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 20 cost time: 0.4912240505218506
Epoch: 20, Steps: 3 | Train Loss: 0.078 Vali Loss: 0.167 Vali Acc: 0.975 Test Loss: 0.167 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 21 cost time: 0.5273253917694092
Epoch: 21, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.165 Vali Acc: 0.975 Test Loss: 0.165 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 22 cost time: 0.42289090156555176
Epoch: 22, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.164 Vali Acc: 0.975 Test Loss: 0.164 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 23 cost time: 0.4665043354034424
Epoch: 23, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.158 Vali Acc: 0.975 Test Loss: 0.158 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 24 cost time: 0.4444618225097656
Epoch: 24, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.150 Vali Acc: 0.975 Test Loss: 0.150 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974999).  Saving model ...
Epoch: 25 cost time: 0.44890832901000977
Epoch: 25, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.151 Vali Acc: 0.975 Test Loss: 0.151 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.43446946144104004
Epoch: 26, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.138 Vali Acc: 0.975 Test Loss: 0.138 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 27 cost time: 0.40218496322631836
Epoch: 27, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.134 Vali Acc: 0.975 Test Loss: 0.134 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 28 cost time: 0.4233226776123047
Epoch: 28, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.126 Vali Acc: 0.975 Test Loss: 0.126 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 29 cost time: 0.4433462619781494
Epoch: 29, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.125 Vali Acc: 0.975 Test Loss: 0.125 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 30 cost time: 0.4554252624511719
Epoch: 30, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.123 Vali Acc: 0.975 Test Loss: 0.123 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 31 cost time: 0.43312621116638184
Epoch: 31, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.126 Vali Acc: 0.975 Test Loss: 0.126 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.4320816993713379
Epoch: 32, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.124 Vali Acc: 0.975 Test Loss: 0.124 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.5128304958343506
Epoch: 33, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.118 Vali Acc: 0.975 Test Loss: 0.118 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 34 cost time: 0.41631197929382324
Epoch: 34, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.118 Vali Acc: 0.975 Test Loss: 0.118 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.42763519287109375
Epoch: 35, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.120 Vali Acc: 0.975 Test Loss: 0.120 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.4443490505218506
Epoch: 36, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.123 Vali Acc: 0.950 Test Loss: 0.123 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.46448779106140137
Epoch: 37, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.124 Vali Acc: 0.950 Test Loss: 0.124 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.4280660152435303
Epoch: 38, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.125 Vali Acc: 0.950 Test Loss: 0.125 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.4649789333343506
Epoch: 39, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.125 Vali Acc: 0.950 Test Loss: 0.125 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.4842851161956787
Epoch: 40, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.128 Vali Acc: 0.950 Test Loss: 0.128 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.4110262393951416
Epoch: 41, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.125 Vali Acc: 0.950 Test Loss: 0.125 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.4250314235687256
Epoch: 42, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.124 Vali Acc: 0.950 Test Loss: 0.124 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.4146580696105957
Epoch: 43, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.126 Vali Acc: 0.950 Test Loss: 0.126 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps25_str13_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 1703428
model size : 6.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.6762361526489258
Epoch: 1, Steps: 3 | Train Loss: 1.405 Vali Loss: 1.352 Vali Acc: 0.275 Test Loss: 1.352 Test Acc: 0.275
Validation loss decreased (inf --> -0.274986).  Saving model ...
Epoch: 2 cost time: 0.4781789779663086
Epoch: 2, Steps: 3 | Train Loss: 1.173 Vali Loss: 1.232 Vali Acc: 0.375 Test Loss: 1.232 Test Acc: 0.375
Validation loss decreased (-0.274986 --> -0.374988).  Saving model ...
Epoch: 3 cost time: 0.43048572540283203
Epoch: 3, Steps: 3 | Train Loss: 0.997 Vali Loss: 1.024 Vali Acc: 0.675 Test Loss: 1.024 Test Acc: 0.675
Validation loss decreased (-0.374988 --> -0.674990).  Saving model ...
Epoch: 4 cost time: 0.43225669860839844
Epoch: 4, Steps: 3 | Train Loss: 0.762 Vali Loss: 0.795 Vali Acc: 0.825 Test Loss: 0.795 Test Acc: 0.825
Validation loss decreased (-0.674990 --> -0.824992).  Saving model ...
Epoch: 5 cost time: 0.4114348888397217
Epoch: 5, Steps: 3 | Train Loss: 0.532 Vali Loss: 0.593 Vali Acc: 0.900 Test Loss: 0.593 Test Acc: 0.900
Validation loss decreased (-0.824992 --> -0.899994).  Saving model ...
Epoch: 6 cost time: 0.49292850494384766
Epoch: 6, Steps: 3 | Train Loss: 0.357 Vali Loss: 0.427 Vali Acc: 0.925 Test Loss: 0.427 Test Acc: 0.925
Validation loss decreased (-0.899994 --> -0.924996).  Saving model ...
Epoch: 7 cost time: 0.4427220821380615
Epoch: 7, Steps: 3 | Train Loss: 0.240 Vali Loss: 0.331 Vali Acc: 0.925 Test Loss: 0.331 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924997).  Saving model ...
Epoch: 8 cost time: 0.5248050689697266
Epoch: 8, Steps: 3 | Train Loss: 0.205 Vali Loss: 0.285 Vali Acc: 0.925 Test Loss: 0.285 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 9 cost time: 0.406754732131958
Epoch: 9, Steps: 3 | Train Loss: 0.131 Vali Loss: 0.281 Vali Acc: 0.950 Test Loss: 0.281 Test Acc: 0.950
Validation loss decreased (-0.924997 --> -0.949997).  Saving model ...
Epoch: 10 cost time: 0.4274725914001465
Epoch: 10, Steps: 3 | Train Loss: 0.091 Vali Loss: 0.307 Vali Acc: 0.925 Test Loss: 0.307 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.4206366539001465
Epoch: 11, Steps: 3 | Train Loss: 0.058 Vali Loss: 0.343 Vali Acc: 0.925 Test Loss: 0.343 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.4430241584777832
Epoch: 12, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.387 Vali Acc: 0.900 Test Loss: 0.387 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.46170926094055176
Epoch: 13, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.421 Vali Acc: 0.900 Test Loss: 0.421 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.40857434272766113
Epoch: 14, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.452 Vali Acc: 0.900 Test Loss: 0.452 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.44457244873046875
Epoch: 15, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.473 Vali Acc: 0.900 Test Loss: 0.473 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.4751613140106201
Epoch: 16, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.487 Vali Acc: 0.900 Test Loss: 0.487 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.4431593418121338
Epoch: 17, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.467 Vali Acc: 0.900 Test Loss: 0.467 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.4821951389312744
Epoch: 18, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.446 Vali Acc: 0.900 Test Loss: 0.446 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.42531299591064453
Epoch: 19, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.436 Vali Acc: 0.900 Test Loss: 0.436 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 587780
model size : 2.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.6056723594665527
Epoch: 1, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.368 Vali Acc: 0.200 Test Loss: 1.368 Test Acc: 0.200
Validation loss decreased (inf --> -0.199986).  Saving model ...
Epoch: 2 cost time: 0.5244724750518799
Epoch: 2, Steps: 3 | Train Loss: 1.316 Vali Loss: 1.255 Vali Acc: 0.325 Test Loss: 1.255 Test Acc: 0.325
Validation loss decreased (-0.199986 --> -0.324987).  Saving model ...
Epoch: 3 cost time: 0.4146864414215088
Epoch: 3, Steps: 3 | Train Loss: 1.068 Vali Loss: 1.056 Vali Acc: 0.700 Test Loss: 1.056 Test Acc: 0.700
Validation loss decreased (-0.324987 --> -0.699989).  Saving model ...
Epoch: 4 cost time: 0.38710594177246094
Epoch: 4, Steps: 3 | Train Loss: 0.857 Vali Loss: 0.847 Vali Acc: 0.925 Test Loss: 0.847 Test Acc: 0.925
Validation loss decreased (-0.699989 --> -0.924992).  Saving model ...
Epoch: 5 cost time: 0.5036866664886475
Epoch: 5, Steps: 3 | Train Loss: 0.631 Vali Loss: 0.664 Vali Acc: 0.950 Test Loss: 0.664 Test Acc: 0.950
Validation loss decreased (-0.924992 --> -0.949993).  Saving model ...
Epoch: 6 cost time: 0.4073605537414551
Epoch: 6, Steps: 3 | Train Loss: 0.454 Vali Loss: 0.515 Vali Acc: 0.975 Test Loss: 0.515 Test Acc: 0.975
Validation loss decreased (-0.949993 --> -0.974995).  Saving model ...
Epoch: 7 cost time: 0.5475184917449951
Epoch: 7, Steps: 3 | Train Loss: 0.336 Vali Loss: 0.400 Vali Acc: 0.975 Test Loss: 0.400 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 8 cost time: 0.4130737781524658
Epoch: 8, Steps: 3 | Train Loss: 0.273 Vali Loss: 0.322 Vali Acc: 0.975 Test Loss: 0.322 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 9 cost time: 0.401843786239624
Epoch: 9, Steps: 3 | Train Loss: 0.226 Vali Loss: 0.272 Vali Acc: 0.975 Test Loss: 0.272 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 10 cost time: 0.42584919929504395
Epoch: 10, Steps: 3 | Train Loss: 0.155 Vali Loss: 0.250 Vali Acc: 0.975 Test Loss: 0.250 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 11 cost time: 0.423450231552124
Epoch: 11, Steps: 3 | Train Loss: 0.136 Vali Loss: 0.247 Vali Acc: 0.950 Test Loss: 0.247 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.43500304222106934
Epoch: 12, Steps: 3 | Train Loss: 0.103 Vali Loss: 0.259 Vali Acc: 0.950 Test Loss: 0.259 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.4074554443359375
Epoch: 13, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.275 Vali Acc: 0.925 Test Loss: 0.275 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.44846129417419434
Epoch: 14, Steps: 3 | Train Loss: 0.063 Vali Loss: 0.298 Vali Acc: 0.925 Test Loss: 0.298 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.42840003967285156
Epoch: 15, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.312 Vali Acc: 0.925 Test Loss: 0.312 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.42403697967529297
Epoch: 16, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.305 Vali Acc: 0.925 Test Loss: 0.305 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.4025604724884033
Epoch: 17, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.306 Vali Acc: 0.925 Test Loss: 0.306 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.4138016700744629
Epoch: 18, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.300 Vali Acc: 0.925 Test Loss: 0.300 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.47023701667785645
Epoch: 19, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.293 Vali Acc: 0.925 Test Loss: 0.293 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.396869421005249
Epoch: 20, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.287 Vali Acc: 0.925 Test Loss: 0.287 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 535812
model size : 2.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.6215298175811768
Epoch: 1, Steps: 3 | Train Loss: 1.559 Vali Loss: 1.378 Vali Acc: 0.425 Test Loss: 1.378 Test Acc: 0.425
Validation loss decreased (inf --> -0.424986).  Saving model ...
Epoch: 2 cost time: 0.4490211009979248
Epoch: 2, Steps: 3 | Train Loss: 1.339 Vali Loss: 1.280 Vali Acc: 0.500 Test Loss: 1.280 Test Acc: 0.500
Validation loss decreased (-0.424986 --> -0.499987).  Saving model ...
Epoch: 3 cost time: 0.3801891803741455
Epoch: 3, Steps: 3 | Train Loss: 1.157 Vali Loss: 1.114 Vali Acc: 0.575 Test Loss: 1.114 Test Acc: 0.575
Validation loss decreased (-0.499987 --> -0.574989).  Saving model ...
Epoch: 4 cost time: 0.5334224700927734
Epoch: 4, Steps: 3 | Train Loss: 0.975 Vali Loss: 0.938 Vali Acc: 0.750 Test Loss: 0.938 Test Acc: 0.750
Validation loss decreased (-0.574989 --> -0.749991).  Saving model ...
Epoch: 5 cost time: 0.43180274963378906
Epoch: 5, Steps: 3 | Train Loss: 0.770 Vali Loss: 0.777 Vali Acc: 0.900 Test Loss: 0.777 Test Acc: 0.900
Validation loss decreased (-0.749991 --> -0.899992).  Saving model ...
Epoch: 6 cost time: 0.49153995513916016
Epoch: 6, Steps: 3 | Train Loss: 0.596 Vali Loss: 0.639 Vali Acc: 0.925 Test Loss: 0.639 Test Acc: 0.925
Validation loss decreased (-0.899992 --> -0.924994).  Saving model ...
Epoch: 7 cost time: 0.419158935546875
Epoch: 7, Steps: 3 | Train Loss: 0.480 Vali Loss: 0.524 Vali Acc: 0.950 Test Loss: 0.524 Test Acc: 0.950
Validation loss decreased (-0.924994 --> -0.949995).  Saving model ...
Epoch: 8 cost time: 0.41544675827026367
Epoch: 8, Steps: 3 | Train Loss: 0.399 Vali Loss: 0.408 Vali Acc: 0.975 Test Loss: 0.408 Test Acc: 0.975
Validation loss decreased (-0.949995 --> -0.974996).  Saving model ...
Epoch: 9 cost time: 0.41082096099853516
Epoch: 9, Steps: 3 | Train Loss: 0.296 Vali Loss: 0.327 Vali Acc: 0.975 Test Loss: 0.327 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 10 cost time: 0.48123693466186523
Epoch: 10, Steps: 3 | Train Loss: 0.195 Vali Loss: 0.278 Vali Acc: 0.975 Test Loss: 0.278 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 11 cost time: 0.4734795093536377
Epoch: 11, Steps: 3 | Train Loss: 0.175 Vali Loss: 0.242 Vali Acc: 0.975 Test Loss: 0.242 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 12 cost time: 0.4758872985839844
Epoch: 12, Steps: 3 | Train Loss: 0.144 Vali Loss: 0.221 Vali Acc: 0.975 Test Loss: 0.221 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 13 cost time: 0.43239450454711914
Epoch: 13, Steps: 3 | Train Loss: 0.117 Vali Loss: 0.220 Vali Acc: 0.950 Test Loss: 0.220 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5060396194458008
Epoch: 14, Steps: 3 | Train Loss: 0.097 Vali Loss: 0.217 Vali Acc: 0.950 Test Loss: 0.217 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.4872860908508301
Epoch: 15, Steps: 3 | Train Loss: 0.081 Vali Loss: 0.218 Vali Acc: 0.950 Test Loss: 0.218 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.4617297649383545
Epoch: 16, Steps: 3 | Train Loss: 0.078 Vali Loss: 0.220 Vali Acc: 0.950 Test Loss: 0.220 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.4553079605102539
Epoch: 17, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.217 Vali Acc: 0.950 Test Loss: 0.217 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.458118200302124
Epoch: 18, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.211 Vali Acc: 0.950 Test Loss: 0.211 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.45228075981140137
Epoch: 19, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.199 Vali Acc: 0.950 Test Loss: 0.199 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.42979955673217773
Epoch: 20, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.195 Vali Acc: 0.950 Test Loss: 0.195 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.4176969528198242
Epoch: 21, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.197 Vali Acc: 0.950 Test Loss: 0.197 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.41507720947265625
Epoch: 22, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.195 Vali Acc: 0.950 Test Loss: 0.195 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 511620
model size : 1.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.644014596939087
Epoch: 1, Steps: 3 | Train Loss: 1.433 Vali Loss: 1.388 Vali Acc: 0.175 Test Loss: 1.388 Test Acc: 0.175
Validation loss decreased (inf --> -0.174986).  Saving model ...
Epoch: 2 cost time: 0.43854522705078125
Epoch: 2, Steps: 3 | Train Loss: 1.277 Vali Loss: 1.311 Vali Acc: 0.275 Test Loss: 1.311 Test Acc: 0.275
Validation loss decreased (-0.174986 --> -0.274987).  Saving model ...
Epoch: 3 cost time: 0.464644193649292
Epoch: 3, Steps: 3 | Train Loss: 1.123 Vali Loss: 1.175 Vali Acc: 0.350 Test Loss: 1.175 Test Acc: 0.350
Validation loss decreased (-0.274987 --> -0.349988).  Saving model ...
Epoch: 4 cost time: 0.47986841201782227
Epoch: 4, Steps: 3 | Train Loss: 0.954 Vali Loss: 1.019 Vali Acc: 0.575 Test Loss: 1.019 Test Acc: 0.575
Validation loss decreased (-0.349988 --> -0.574990).  Saving model ...
Epoch: 5 cost time: 0.4016592502593994
Epoch: 5, Steps: 3 | Train Loss: 0.831 Vali Loss: 0.866 Vali Acc: 0.825 Test Loss: 0.866 Test Acc: 0.825
Validation loss decreased (-0.574990 --> -0.824991).  Saving model ...
Epoch: 6 cost time: 0.4191932678222656
Epoch: 6, Steps: 3 | Train Loss: 0.662 Vali Loss: 0.732 Vali Acc: 0.925 Test Loss: 0.732 Test Acc: 0.925
Validation loss decreased (-0.824991 --> -0.924993).  Saving model ...
Epoch: 7 cost time: 0.37728404998779297
Epoch: 7, Steps: 3 | Train Loss: 0.519 Vali Loss: 0.608 Vali Acc: 0.950 Test Loss: 0.608 Test Acc: 0.950
Validation loss decreased (-0.924993 --> -0.949994).  Saving model ...
Epoch: 8 cost time: 0.4210221767425537
Epoch: 8, Steps: 3 | Train Loss: 0.451 Vali Loss: 0.503 Vali Acc: 0.975 Test Loss: 0.503 Test Acc: 0.975
Validation loss decreased (-0.949994 --> -0.974995).  Saving model ...
Epoch: 9 cost time: 0.4092550277709961
Epoch: 9, Steps: 3 | Train Loss: 0.353 Vali Loss: 0.417 Vali Acc: 0.975 Test Loss: 0.417 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 10 cost time: 0.42644476890563965
Epoch: 10, Steps: 3 | Train Loss: 0.294 Vali Loss: 0.349 Vali Acc: 0.975 Test Loss: 0.349 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 11 cost time: 0.4189333915710449
Epoch: 11, Steps: 3 | Train Loss: 0.230 Vali Loss: 0.303 Vali Acc: 0.975 Test Loss: 0.303 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 12 cost time: 0.4808988571166992
Epoch: 12, Steps: 3 | Train Loss: 0.198 Vali Loss: 0.266 Vali Acc: 0.975 Test Loss: 0.266 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 13 cost time: 0.4262709617614746
Epoch: 13, Steps: 3 | Train Loss: 0.160 Vali Loss: 0.248 Vali Acc: 0.975 Test Loss: 0.248 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 14 cost time: 0.5052261352539062
Epoch: 14, Steps: 3 | Train Loss: 0.128 Vali Loss: 0.242 Vali Acc: 0.950 Test Loss: 0.242 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.4299278259277344
Epoch: 15, Steps: 3 | Train Loss: 0.116 Vali Loss: 0.241 Vali Acc: 0.950 Test Loss: 0.241 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.4539625644683838
Epoch: 16, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.234 Vali Acc: 0.950 Test Loss: 0.234 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.44327354431152344
Epoch: 17, Steps: 3 | Train Loss: 0.076 Vali Loss: 0.232 Vali Acc: 0.950 Test Loss: 0.232 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.5297446250915527
Epoch: 18, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.229 Vali Acc: 0.950 Test Loss: 0.229 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.4464254379272461
Epoch: 19, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.225 Vali Acc: 0.950 Test Loss: 0.225 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.48913073539733887
Epoch: 20, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.225 Vali Acc: 0.950 Test Loss: 0.225 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.4689671993255615
Epoch: 21, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.221 Vali Acc: 0.950 Test Loss: 0.221 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.4187166690826416
Epoch: 22, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.227 Vali Acc: 0.950 Test Loss: 0.227 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.4427332878112793
Epoch: 23, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.222 Vali Acc: 0.950 Test Loss: 0.222 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 496516
model size : 1.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.632939338684082
Epoch: 1, Steps: 3 | Train Loss: 1.480 Vali Loss: 1.350 Vali Acc: 0.450 Test Loss: 1.350 Test Acc: 0.450
Validation loss decreased (inf --> -0.449987).  Saving model ...
Epoch: 2 cost time: 0.43419623374938965
Epoch: 2, Steps: 3 | Train Loss: 1.377 Vali Loss: 1.282 Vali Acc: 0.600 Test Loss: 1.282 Test Acc: 0.600
Validation loss decreased (-0.449987 --> -0.599987).  Saving model ...
Epoch: 3 cost time: 0.38353776931762695
Epoch: 3, Steps: 3 | Train Loss: 1.246 Vali Loss: 1.176 Vali Acc: 0.625 Test Loss: 1.176 Test Acc: 0.625
Validation loss decreased (-0.599987 --> -0.624988).  Saving model ...
Epoch: 4 cost time: 0.3910369873046875
Epoch: 4, Steps: 3 | Train Loss: 1.112 Vali Loss: 1.048 Vali Acc: 0.650 Test Loss: 1.048 Test Acc: 0.650
Validation loss decreased (-0.624988 --> -0.649990).  Saving model ...
Epoch: 5 cost time: 0.43171167373657227
Epoch: 5, Steps: 3 | Train Loss: 0.957 Vali Loss: 0.920 Vali Acc: 0.675 Test Loss: 0.920 Test Acc: 0.675
Validation loss decreased (-0.649990 --> -0.674991).  Saving model ...
Epoch: 6 cost time: 0.539952278137207
Epoch: 6, Steps: 3 | Train Loss: 0.837 Vali Loss: 0.802 Vali Acc: 0.675 Test Loss: 0.802 Test Acc: 0.675
Validation loss decreased (-0.674991 --> -0.674992).  Saving model ...
Epoch: 7 cost time: 0.4005444049835205
Epoch: 7, Steps: 3 | Train Loss: 0.721 Vali Loss: 0.705 Vali Acc: 0.700 Test Loss: 0.705 Test Acc: 0.700
Validation loss decreased (-0.674992 --> -0.699993).  Saving model ...
Epoch: 8 cost time: 0.4027674198150635
Epoch: 8, Steps: 3 | Train Loss: 0.630 Vali Loss: 0.610 Vali Acc: 0.950 Test Loss: 0.610 Test Acc: 0.950
Validation loss decreased (-0.699993 --> -0.949994).  Saving model ...
Epoch: 9 cost time: 0.397493839263916
Epoch: 9, Steps: 3 | Train Loss: 0.539 Vali Loss: 0.528 Vali Acc: 0.950 Test Loss: 0.528 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 10 cost time: 0.3824276924133301
Epoch: 10, Steps: 3 | Train Loss: 0.453 Vali Loss: 0.459 Vali Acc: 0.950 Test Loss: 0.459 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 11 cost time: 0.4566948413848877
Epoch: 11, Steps: 3 | Train Loss: 0.370 Vali Loss: 0.398 Vali Acc: 0.950 Test Loss: 0.398 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 12 cost time: 0.38787031173706055
Epoch: 12, Steps: 3 | Train Loss: 0.288 Vali Loss: 0.358 Vali Acc: 0.950 Test Loss: 0.358 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 13 cost time: 0.4212067127227783
Epoch: 13, Steps: 3 | Train Loss: 0.274 Vali Loss: 0.317 Vali Acc: 0.950 Test Loss: 0.317 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 14 cost time: 0.46020078659057617
Epoch: 14, Steps: 3 | Train Loss: 0.239 Vali Loss: 0.284 Vali Acc: 0.950 Test Loss: 0.284 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 15 cost time: 0.42765140533447266
Epoch: 15, Steps: 3 | Train Loss: 0.208 Vali Loss: 0.262 Vali Acc: 0.975 Test Loss: 0.262 Test Acc: 0.975
Validation loss decreased (-0.949997 --> -0.974997).  Saving model ...
Epoch: 16 cost time: 0.4423251152038574
Epoch: 16, Steps: 3 | Train Loss: 0.173 Vali Loss: 0.245 Vali Acc: 0.975 Test Loss: 0.245 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 17 cost time: 0.38151097297668457
Epoch: 17, Steps: 3 | Train Loss: 0.150 Vali Loss: 0.238 Vali Acc: 0.950 Test Loss: 0.238 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.42527174949645996
Epoch: 18, Steps: 3 | Train Loss: 0.139 Vali Loss: 0.233 Vali Acc: 0.950 Test Loss: 0.233 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.4162123203277588
Epoch: 19, Steps: 3 | Train Loss: 0.145 Vali Loss: 0.229 Vali Acc: 0.950 Test Loss: 0.229 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.4686870574951172
Epoch: 20, Steps: 3 | Train Loss: 0.109 Vali Loss: 0.226 Vali Acc: 0.950 Test Loss: 0.226 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.4399130344390869
Epoch: 21, Steps: 3 | Train Loss: 0.102 Vali Loss: 0.228 Vali Acc: 0.950 Test Loss: 0.228 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.42229700088500977
Epoch: 22, Steps: 3 | Train Loss: 0.079 Vali Loss: 0.224 Vali Acc: 0.950 Test Loss: 0.224 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.4008798599243164
Epoch: 23, Steps: 3 | Train Loss: 0.082 Vali Loss: 0.227 Vali Acc: 0.950 Test Loss: 0.227 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.4114990234375
Epoch: 24, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.233 Vali Acc: 0.925 Test Loss: 0.233 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.4634101390838623
Epoch: 25, Steps: 3 | Train Loss: 0.055 Vali Loss: 0.218 Vali Acc: 0.950 Test Loss: 0.218 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.39768195152282715
Epoch: 26, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.213 Vali Acc: 0.950 Test Loss: 0.213 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 472580
model size : 1.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps20_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.4828500747680664
Epoch: 1, Steps: 3 | Train Loss: 1.453 Vali Loss: 1.357 Vali Acc: 0.175 Test Loss: 1.357 Test Acc: 0.175
Validation loss decreased (inf --> -0.174986).  Saving model ...
Epoch: 2 cost time: 0.5238661766052246
Epoch: 2, Steps: 3 | Train Loss: 1.334 Vali Loss: 1.299 Vali Acc: 0.275 Test Loss: 1.299 Test Acc: 0.275
Validation loss decreased (-0.174986 --> -0.274987).  Saving model ...
Epoch: 3 cost time: 0.36635303497314453
Epoch: 3, Steps: 3 | Train Loss: 1.237 Vali Loss: 1.214 Vali Acc: 0.375 Test Loss: 1.214 Test Acc: 0.375
Validation loss decreased (-0.274987 --> -0.374988).  Saving model ...
Epoch: 4 cost time: 0.4042246341705322
Epoch: 4, Steps: 3 | Train Loss: 1.065 Vali Loss: 1.108 Vali Acc: 0.475 Test Loss: 1.108 Test Acc: 0.475
Validation loss decreased (-0.374988 --> -0.474989).  Saving model ...
Epoch: 5 cost time: 0.4320340156555176
Epoch: 5, Steps: 3 | Train Loss: 1.063 Vali Loss: 0.996 Vali Acc: 0.475 Test Loss: 0.996 Test Acc: 0.475
Validation loss decreased (-0.474989 --> -0.474990).  Saving model ...
Epoch: 6 cost time: 0.3797633647918701
Epoch: 6, Steps: 3 | Train Loss: 0.851 Vali Loss: 0.897 Vali Acc: 0.575 Test Loss: 0.897 Test Acc: 0.575
Validation loss decreased (-0.474990 --> -0.574991).  Saving model ...
Epoch: 7 cost time: 0.4544944763183594
Epoch: 7, Steps: 3 | Train Loss: 0.789 Vali Loss: 0.805 Vali Acc: 0.675 Test Loss: 0.805 Test Acc: 0.675
Validation loss decreased (-0.574991 --> -0.674992).  Saving model ...
Epoch: 8 cost time: 0.42450594902038574
Epoch: 8, Steps: 3 | Train Loss: 0.660 Vali Loss: 0.719 Vali Acc: 0.850 Test Loss: 0.719 Test Acc: 0.850
Validation loss decreased (-0.674992 --> -0.849993).  Saving model ...
Epoch: 9 cost time: 0.4911794662475586
Epoch: 9, Steps: 3 | Train Loss: 0.597 Vali Loss: 0.638 Vali Acc: 0.950 Test Loss: 0.638 Test Acc: 0.950
Validation loss decreased (-0.849993 --> -0.949994).  Saving model ...
Epoch: 10 cost time: 0.3921797275543213
Epoch: 10, Steps: 3 | Train Loss: 0.535 Vali Loss: 0.565 Vali Acc: 0.925 Test Loss: 0.565 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.4632236957550049
Epoch: 11, Steps: 3 | Train Loss: 0.465 Vali Loss: 0.500 Vali Acc: 0.925 Test Loss: 0.500 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.46189260482788086
Epoch: 12, Steps: 3 | Train Loss: 0.396 Vali Loss: 0.446 Vali Acc: 0.950 Test Loss: 0.446 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949996).  Saving model ...
Epoch: 13 cost time: 0.4949328899383545
Epoch: 13, Steps: 3 | Train Loss: 0.336 Vali Loss: 0.398 Vali Acc: 0.975 Test Loss: 0.398 Test Acc: 0.975
Validation loss decreased (-0.949996 --> -0.974996).  Saving model ...
Epoch: 14 cost time: 0.4897346496582031
Epoch: 14, Steps: 3 | Train Loss: 0.284 Vali Loss: 0.363 Vali Acc: 0.975 Test Loss: 0.363 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 15 cost time: 0.446850061416626
Epoch: 15, Steps: 3 | Train Loss: 0.263 Vali Loss: 0.331 Vali Acc: 0.975 Test Loss: 0.331 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 16 cost time: 0.4417402744293213
Epoch: 16, Steps: 3 | Train Loss: 0.219 Vali Loss: 0.312 Vali Acc: 0.975 Test Loss: 0.312 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 17 cost time: 0.4230020046234131
Epoch: 17, Steps: 3 | Train Loss: 0.223 Vali Loss: 0.294 Vali Acc: 0.975 Test Loss: 0.294 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 18 cost time: 0.4364151954650879
Epoch: 18, Steps: 3 | Train Loss: 0.176 Vali Loss: 0.270 Vali Acc: 0.975 Test Loss: 0.270 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 19 cost time: 0.3845088481903076
Epoch: 19, Steps: 3 | Train Loss: 0.178 Vali Loss: 0.256 Vali Acc: 0.975 Test Loss: 0.256 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 20 cost time: 0.4204730987548828
Epoch: 20, Steps: 3 | Train Loss: 0.150 Vali Loss: 0.242 Vali Acc: 0.975 Test Loss: 0.242 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 21 cost time: 0.4973490238189697
Epoch: 21, Steps: 3 | Train Loss: 0.126 Vali Loss: 0.240 Vali Acc: 0.975 Test Loss: 0.240 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 22 cost time: 0.475430965423584
Epoch: 22, Steps: 3 | Train Loss: 0.114 Vali Loss: 0.236 Vali Acc: 0.975 Test Loss: 0.236 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 23 cost time: 0.40811872482299805
Epoch: 23, Steps: 3 | Train Loss: 0.110 Vali Loss: 0.220 Vali Acc: 0.975 Test Loss: 0.220 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 24 cost time: 0.45813798904418945
Epoch: 24, Steps: 3 | Train Loss: 0.089 Vali Loss: 0.206 Vali Acc: 0.975 Test Loss: 0.206 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 25 cost time: 0.4875600337982178
Epoch: 25, Steps: 3 | Train Loss: 0.092 Vali Loss: 0.198 Vali Acc: 0.975 Test Loss: 0.198 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 26 cost time: 0.442807674407959
Epoch: 26, Steps: 3 | Train Loss: 0.088 Vali Loss: 0.193 Vali Acc: 0.975 Test Loss: 0.193 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 27 cost time: 0.3930075168609619
Epoch: 27, Steps: 3 | Train Loss: 0.080 Vali Loss: 0.190 Vali Acc: 0.975 Test Loss: 0.190 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 28 cost time: 0.4535677433013916
Epoch: 28, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.181 Vali Acc: 0.975 Test Loss: 0.181 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 29 cost time: 0.40500617027282715
Epoch: 29, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.181 Vali Acc: 0.975 Test Loss: 0.181 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 30 cost time: 0.4592580795288086
Epoch: 30, Steps: 3 | Train Loss: 0.075 Vali Loss: 0.186 Vali Acc: 0.975 Test Loss: 0.186 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.43034934997558594
Epoch: 31, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.179 Vali Acc: 0.975 Test Loss: 0.179 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 32 cost time: 0.3878490924835205
Epoch: 32, Steps: 3 | Train Loss: 0.061 Vali Loss: 0.174 Vali Acc: 0.975 Test Loss: 0.174 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 33 cost time: 0.4051187038421631
Epoch: 33, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.161 Vali Acc: 0.975 Test Loss: 0.161 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 34 cost time: 0.40583372116088867
Epoch: 34, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.159 Vali Acc: 0.975 Test Loss: 0.159 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 35 cost time: 0.4038522243499756
Epoch: 35, Steps: 3 | Train Loss: 0.058 Vali Loss: 0.161 Vali Acc: 0.975 Test Loss: 0.161 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.42773938179016113
Epoch: 36, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.159 Vali Acc: 0.975 Test Loss: 0.159 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 37 cost time: 0.4108457565307617
Epoch: 37, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.148 Vali Acc: 0.975 Test Loss: 0.148 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974999).  Saving model ...
Epoch: 38 cost time: 0.5096666812896729
Epoch: 38, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.146 Vali Acc: 0.975 Test Loss: 0.146 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 39 cost time: 0.4784832000732422
Epoch: 39, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.144 Vali Acc: 0.975 Test Loss: 0.144 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 40 cost time: 0.5038783550262451
Epoch: 40, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.144 Vali Acc: 0.975 Test Loss: 0.144 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 41 cost time: 0.46457862854003906
Epoch: 41, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.146 Vali Acc: 0.975 Test Loss: 0.146 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.44373011589050293
Epoch: 42, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.148 Vali Acc: 0.975 Test Loss: 0.148 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.39042019844055176
Epoch: 43, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.152 Vali Acc: 0.975 Test Loss: 0.152 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.4400956630706787
Epoch: 44, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.150 Vali Acc: 0.975 Test Loss: 0.150 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.5907948017120361
Epoch: 45, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.153 Vali Acc: 0.975 Test Loss: 0.153 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.511742115020752
Epoch: 46, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.153 Vali Acc: 0.975 Test Loss: 0.153 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.42615795135498047
Epoch: 47, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.155 Vali Acc: 0.975 Test Loss: 0.155 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 0.40830254554748535
Epoch: 48, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.156 Vali Acc: 0.975 Test Loss: 0.156 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 0.43978404998779297
Epoch: 49, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.150 Vali Acc: 0.975 Test Loss: 0.150 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 0.4007558822631836
Epoch: 50, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.149 Vali Acc: 0.975 Test Loss: 0.149 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps20_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 467076
model size : 1.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps25_str13_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.511518955230713
Epoch: 1, Steps: 3 | Train Loss: 1.357 Vali Loss: 1.271 Vali Acc: 0.500 Test Loss: 1.271 Test Acc: 0.500
Validation loss decreased (inf --> -0.499987).  Saving model ...
Epoch: 2 cost time: 0.48758745193481445
Epoch: 2, Steps: 3 | Train Loss: 1.253 Vali Loss: 1.221 Vali Acc: 0.575 Test Loss: 1.221 Test Acc: 0.575
Validation loss decreased (-0.499987 --> -0.574988).  Saving model ...
Epoch: 3 cost time: 0.3889036178588867
Epoch: 3, Steps: 3 | Train Loss: 1.182 Vali Loss: 1.159 Vali Acc: 0.575 Test Loss: 1.159 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 4 cost time: 0.3817024230957031
Epoch: 4, Steps: 3 | Train Loss: 1.086 Vali Loss: 1.081 Vali Acc: 0.650 Test Loss: 1.081 Test Acc: 0.650
Validation loss decreased (-0.574988 --> -0.649989).  Saving model ...
Epoch: 5 cost time: 0.5005528926849365
Epoch: 5, Steps: 3 | Train Loss: 1.031 Vali Loss: 0.991 Vali Acc: 0.675 Test Loss: 0.991 Test Acc: 0.675
Validation loss decreased (-0.649989 --> -0.674990).  Saving model ...
Epoch: 6 cost time: 0.4838368892669678
Epoch: 6, Steps: 3 | Train Loss: 0.895 Vali Loss: 0.910 Vali Acc: 0.725 Test Loss: 0.910 Test Acc: 0.725
Validation loss decreased (-0.674990 --> -0.724991).  Saving model ...
Epoch: 7 cost time: 0.45563173294067383
Epoch: 7, Steps: 3 | Train Loss: 0.798 Vali Loss: 0.834 Vali Acc: 0.875 Test Loss: 0.834 Test Acc: 0.875
Validation loss decreased (-0.724991 --> -0.874992).  Saving model ...
Epoch: 8 cost time: 0.4615769386291504
Epoch: 8, Steps: 3 | Train Loss: 0.706 Vali Loss: 0.762 Vali Acc: 0.925 Test Loss: 0.762 Test Acc: 0.925
Validation loss decreased (-0.874992 --> -0.924992).  Saving model ...
Epoch: 9 cost time: 0.43729090690612793
Epoch: 9, Steps: 3 | Train Loss: 0.700 Vali Loss: 0.688 Vali Acc: 0.925 Test Loss: 0.688 Test Acc: 0.925
Validation loss decreased (-0.924992 --> -0.924993).  Saving model ...
Epoch: 10 cost time: 0.4107966423034668
Epoch: 10, Steps: 3 | Train Loss: 0.609 Vali Loss: 0.616 Vali Acc: 0.950 Test Loss: 0.616 Test Acc: 0.950
Validation loss decreased (-0.924993 --> -0.949994).  Saving model ...
Epoch: 11 cost time: 0.4363391399383545
Epoch: 11, Steps: 3 | Train Loss: 0.554 Vali Loss: 0.558 Vali Acc: 0.950 Test Loss: 0.558 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949994).  Saving model ...
Epoch: 12 cost time: 0.4842653274536133
Epoch: 12, Steps: 3 | Train Loss: 0.467 Vali Loss: 0.506 Vali Acc: 0.950 Test Loss: 0.506 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 13 cost time: 0.4683420658111572
Epoch: 13, Steps: 3 | Train Loss: 0.421 Vali Loss: 0.452 Vali Acc: 0.950 Test Loss: 0.452 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 14 cost time: 0.40103960037231445
Epoch: 14, Steps: 3 | Train Loss: 0.374 Vali Loss: 0.409 Vali Acc: 0.950 Test Loss: 0.409 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 15 cost time: 0.40720224380493164
Epoch: 15, Steps: 3 | Train Loss: 0.346 Vali Loss: 0.368 Vali Acc: 0.950 Test Loss: 0.368 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 16 cost time: 0.42315030097961426
Epoch: 16, Steps: 3 | Train Loss: 0.297 Vali Loss: 0.333 Vali Acc: 0.950 Test Loss: 0.333 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 17 cost time: 0.49266529083251953
Epoch: 17, Steps: 3 | Train Loss: 0.266 Vali Loss: 0.312 Vali Acc: 0.950 Test Loss: 0.312 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 18 cost time: 0.4555652141571045
Epoch: 18, Steps: 3 | Train Loss: 0.244 Vali Loss: 0.295 Vali Acc: 0.950 Test Loss: 0.295 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 19 cost time: 0.43863344192504883
Epoch: 19, Steps: 3 | Train Loss: 0.224 Vali Loss: 0.272 Vali Acc: 0.975 Test Loss: 0.272 Test Acc: 0.975
Validation loss decreased (-0.949997 --> -0.974997).  Saving model ...
Epoch: 20 cost time: 0.4241013526916504
Epoch: 20, Steps: 3 | Train Loss: 0.204 Vali Loss: 0.256 Vali Acc: 0.975 Test Loss: 0.256 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 21 cost time: 0.4318079948425293
Epoch: 21, Steps: 3 | Train Loss: 0.175 Vali Loss: 0.245 Vali Acc: 0.975 Test Loss: 0.245 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 22 cost time: 0.41324329376220703
Epoch: 22, Steps: 3 | Train Loss: 0.197 Vali Loss: 0.235 Vali Acc: 0.975 Test Loss: 0.235 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 23 cost time: 0.4640645980834961
Epoch: 23, Steps: 3 | Train Loss: 0.166 Vali Loss: 0.225 Vali Acc: 0.975 Test Loss: 0.225 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 24 cost time: 0.45527124404907227
Epoch: 24, Steps: 3 | Train Loss: 0.113 Vali Loss: 0.208 Vali Acc: 0.975 Test Loss: 0.208 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 25 cost time: 0.41289710998535156
Epoch: 25, Steps: 3 | Train Loss: 0.145 Vali Loss: 0.202 Vali Acc: 0.975 Test Loss: 0.202 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 26 cost time: 0.38039183616638184
Epoch: 26, Steps: 3 | Train Loss: 0.113 Vali Loss: 0.191 Vali Acc: 0.975 Test Loss: 0.191 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 27 cost time: 0.4038259983062744
Epoch: 27, Steps: 3 | Train Loss: 0.102 Vali Loss: 0.183 Vali Acc: 0.975 Test Loss: 0.183 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 28 cost time: 0.4019002914428711
Epoch: 28, Steps: 3 | Train Loss: 0.106 Vali Loss: 0.179 Vali Acc: 0.975 Test Loss: 0.179 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 29 cost time: 0.3935365676879883
Epoch: 29, Steps: 3 | Train Loss: 0.102 Vali Loss: 0.175 Vali Acc: 0.975 Test Loss: 0.175 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 30 cost time: 0.4327263832092285
Epoch: 30, Steps: 3 | Train Loss: 0.101 Vali Loss: 0.169 Vali Acc: 0.975 Test Loss: 0.169 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 31 cost time: 0.4094996452331543
Epoch: 31, Steps: 3 | Train Loss: 0.087 Vali Loss: 0.165 Vali Acc: 0.975 Test Loss: 0.165 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 32 cost time: 0.38023805618286133
Epoch: 32, Steps: 3 | Train Loss: 0.089 Vali Loss: 0.162 Vali Acc: 0.975 Test Loss: 0.162 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 33 cost time: 0.39548659324645996
Epoch: 33, Steps: 3 | Train Loss: 0.073 Vali Loss: 0.156 Vali Acc: 0.975 Test Loss: 0.156 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 34 cost time: 0.39659547805786133
Epoch: 34, Steps: 3 | Train Loss: 0.075 Vali Loss: 0.156 Vali Acc: 0.975 Test Loss: 0.156 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 35 cost time: 0.37496471405029297
Epoch: 35, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.154 Vali Acc: 0.975 Test Loss: 0.154 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 36 cost time: 0.37591981887817383
Epoch: 36, Steps: 3 | Train Loss: 0.068 Vali Loss: 0.145 Vali Acc: 0.975 Test Loss: 0.145 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974999).  Saving model ...
Epoch: 37 cost time: 0.33469557762145996
Epoch: 37, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.141 Vali Acc: 0.975 Test Loss: 0.141 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 38 cost time: 0.4483306407928467
Epoch: 38, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.136 Vali Acc: 0.975 Test Loss: 0.136 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 39 cost time: 0.38773441314697266
Epoch: 39, Steps: 3 | Train Loss: 0.055 Vali Loss: 0.131 Vali Acc: 0.975 Test Loss: 0.131 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 40 cost time: 0.3992471694946289
Epoch: 40, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.125 Vali Acc: 0.975 Test Loss: 0.125 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 41 cost time: 0.41616010665893555
Epoch: 41, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.116 Vali Acc: 0.975 Test Loss: 0.116 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 42 cost time: 0.37841343879699707
Epoch: 42, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.118 Vali Acc: 0.975 Test Loss: 0.118 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.4006359577178955
Epoch: 43, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.114 Vali Acc: 0.975 Test Loss: 0.114 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 44 cost time: 0.430866003036499
Epoch: 44, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.113 Vali Acc: 0.975 Test Loss: 0.113 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 45 cost time: 0.4413926601409912
Epoch: 45, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.109 Vali Acc: 0.975 Test Loss: 0.109 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 46 cost time: 0.450059175491333
Epoch: 46, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.112 Vali Acc: 0.975 Test Loss: 0.112 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.4122617244720459
Epoch: 47, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.109 Vali Acc: 0.975 Test Loss: 0.109 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 48 cost time: 0.40593767166137695
Epoch: 48, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.103 Vali Acc: 0.975 Test Loss: 0.103 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 49 cost time: 0.42958974838256836
Epoch: 49, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.099 Vali Acc: 0.975 Test Loss: 0.099 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 50 cost time: 0.4357926845550537
Epoch: 50, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.100 Vali Acc: 0.975 Test Loss: 0.100 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps25_str13_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 458500
model size : 1.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.537621259689331
Epoch: 1, Steps: 3 | Train Loss: 1.479 Vali Loss: 1.451 Vali Acc: 0.325 Test Loss: 1.451 Test Acc: 0.325
Validation loss decreased (inf --> -0.324985).  Saving model ...
Epoch: 2 cost time: 0.38422250747680664
Epoch: 2, Steps: 3 | Train Loss: 1.340 Vali Loss: 1.373 Vali Acc: 0.475 Test Loss: 1.373 Test Acc: 0.475
Validation loss decreased (-0.324985 --> -0.474986).  Saving model ...
Epoch: 3 cost time: 0.48977184295654297
Epoch: 3, Steps: 3 | Train Loss: 1.177 Vali Loss: 1.242 Vali Acc: 0.550 Test Loss: 1.242 Test Acc: 0.550
Validation loss decreased (-0.474986 --> -0.549988).  Saving model ...
Epoch: 4 cost time: 0.4387650489807129
Epoch: 4, Steps: 3 | Train Loss: 0.983 Vali Loss: 1.084 Vali Acc: 0.575 Test Loss: 1.084 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574989).  Saving model ...
Epoch: 5 cost time: 0.4170224666595459
Epoch: 5, Steps: 3 | Train Loss: 0.789 Vali Loss: 0.914 Vali Acc: 0.750 Test Loss: 0.914 Test Acc: 0.750
Validation loss decreased (-0.574989 --> -0.749991).  Saving model ...
Epoch: 6 cost time: 0.3964247703552246
Epoch: 6, Steps: 3 | Train Loss: 0.620 Vali Loss: 0.748 Vali Acc: 0.825 Test Loss: 0.748 Test Acc: 0.825
Validation loss decreased (-0.749991 --> -0.824993).  Saving model ...
Epoch: 7 cost time: 0.4337186813354492
Epoch: 7, Steps: 3 | Train Loss: 0.484 Vali Loss: 0.607 Vali Acc: 0.875 Test Loss: 0.607 Test Acc: 0.875
Validation loss decreased (-0.824993 --> -0.874994).  Saving model ...
Epoch: 8 cost time: 0.40503621101379395
Epoch: 8, Steps: 3 | Train Loss: 0.399 Vali Loss: 0.497 Vali Acc: 0.950 Test Loss: 0.497 Test Acc: 0.950
Validation loss decreased (-0.874994 --> -0.949995).  Saving model ...
Epoch: 9 cost time: 0.4314248561859131
Epoch: 9, Steps: 3 | Train Loss: 0.318 Vali Loss: 0.417 Vali Acc: 0.950 Test Loss: 0.417 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 10 cost time: 0.49860525131225586
Epoch: 10, Steps: 3 | Train Loss: 0.227 Vali Loss: 0.362 Vali Acc: 0.950 Test Loss: 0.362 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 11 cost time: 0.37700390815734863
Epoch: 11, Steps: 3 | Train Loss: 0.199 Vali Loss: 0.330 Vali Acc: 0.975 Test Loss: 0.330 Test Acc: 0.975
Validation loss decreased (-0.949996 --> -0.974997).  Saving model ...
Epoch: 12 cost time: 0.419158935546875
Epoch: 12, Steps: 3 | Train Loss: 0.155 Vali Loss: 0.316 Vali Acc: 0.950 Test Loss: 0.316 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.3944532871246338
Epoch: 13, Steps: 3 | Train Loss: 0.143 Vali Loss: 0.308 Vali Acc: 0.950 Test Loss: 0.308 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.3824496269226074
Epoch: 14, Steps: 3 | Train Loss: 0.112 Vali Loss: 0.309 Vali Acc: 0.950 Test Loss: 0.309 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.3800480365753174
Epoch: 15, Steps: 3 | Train Loss: 0.091 Vali Loss: 0.305 Vali Acc: 0.950 Test Loss: 0.305 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.5672216415405273
Epoch: 16, Steps: 3 | Train Loss: 0.068 Vali Loss: 0.297 Vali Acc: 0.950 Test Loss: 0.297 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.34162187576293945
Epoch: 17, Steps: 3 | Train Loss: 0.063 Vali Loss: 0.295 Vali Acc: 0.950 Test Loss: 0.295 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.42554712295532227
Epoch: 18, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.301 Vali Acc: 0.950 Test Loss: 0.301 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.4008791446685791
Epoch: 19, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.294 Vali Acc: 0.950 Test Loss: 0.294 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.3784513473510742
Epoch: 20, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.292 Vali Acc: 0.950 Test Loss: 0.292 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.3963124752044678
Epoch: 21, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.291 Vali Acc: 0.950 Test Loss: 0.291 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 195588
model size : 0.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.5355796813964844
Epoch: 1, Steps: 3 | Train Loss: 1.371 Vali Loss: 1.332 Vali Acc: 0.400 Test Loss: 1.332 Test Acc: 0.400
Validation loss decreased (inf --> -0.399987).  Saving model ...
Epoch: 2 cost time: 0.3958590030670166
Epoch: 2, Steps: 3 | Train Loss: 1.269 Vali Loss: 1.257 Vali Acc: 0.475 Test Loss: 1.257 Test Acc: 0.475
Validation loss decreased (-0.399987 --> -0.474987).  Saving model ...
Epoch: 3 cost time: 0.41396522521972656
Epoch: 3, Steps: 3 | Train Loss: 1.101 Vali Loss: 1.134 Vali Acc: 0.625 Test Loss: 1.134 Test Acc: 0.625
Validation loss decreased (-0.474987 --> -0.624989).  Saving model ...
Epoch: 4 cost time: 0.39314913749694824
Epoch: 4, Steps: 3 | Train Loss: 0.918 Vali Loss: 0.997 Vali Acc: 0.700 Test Loss: 0.997 Test Acc: 0.700
Validation loss decreased (-0.624989 --> -0.699990).  Saving model ...
Epoch: 5 cost time: 0.4089999198913574
Epoch: 5, Steps: 3 | Train Loss: 0.791 Vali Loss: 0.868 Vali Acc: 0.825 Test Loss: 0.868 Test Acc: 0.825
Validation loss decreased (-0.699990 --> -0.824991).  Saving model ...
Epoch: 6 cost time: 0.4342989921569824
Epoch: 6, Steps: 3 | Train Loss: 0.668 Vali Loss: 0.747 Vali Acc: 0.850 Test Loss: 0.747 Test Acc: 0.850
Validation loss decreased (-0.824991 --> -0.849993).  Saving model ...
Epoch: 7 cost time: 0.3785409927368164
Epoch: 7, Steps: 3 | Train Loss: 0.590 Vali Loss: 0.636 Vali Acc: 0.900 Test Loss: 0.636 Test Acc: 0.900
Validation loss decreased (-0.849993 --> -0.899994).  Saving model ...
Epoch: 8 cost time: 0.3797125816345215
Epoch: 8, Steps: 3 | Train Loss: 0.488 Vali Loss: 0.546 Vali Acc: 0.975 Test Loss: 0.546 Test Acc: 0.975
Validation loss decreased (-0.899994 --> -0.974995).  Saving model ...
Epoch: 9 cost time: 0.4801955223083496
Epoch: 9, Steps: 3 | Train Loss: 0.412 Vali Loss: 0.466 Vali Acc: 0.975 Test Loss: 0.466 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 10 cost time: 0.4333195686340332
Epoch: 10, Steps: 3 | Train Loss: 0.326 Vali Loss: 0.392 Vali Acc: 0.975 Test Loss: 0.392 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 11 cost time: 0.43057942390441895
Epoch: 11, Steps: 3 | Train Loss: 0.255 Vali Loss: 0.344 Vali Acc: 0.975 Test Loss: 0.344 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 12 cost time: 0.37412142753601074
Epoch: 12, Steps: 3 | Train Loss: 0.209 Vali Loss: 0.306 Vali Acc: 0.975 Test Loss: 0.306 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 13 cost time: 0.4202444553375244
Epoch: 13, Steps: 3 | Train Loss: 0.160 Vali Loss: 0.282 Vali Acc: 0.975 Test Loss: 0.282 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 14 cost time: 0.39502549171447754
Epoch: 14, Steps: 3 | Train Loss: 0.151 Vali Loss: 0.246 Vali Acc: 0.975 Test Loss: 0.246 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 15 cost time: 0.3869493007659912
Epoch: 15, Steps: 3 | Train Loss: 0.134 Vali Loss: 0.231 Vali Acc: 0.975 Test Loss: 0.231 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 16 cost time: 0.4510161876678467
Epoch: 16, Steps: 3 | Train Loss: 0.128 Vali Loss: 0.216 Vali Acc: 0.975 Test Loss: 0.216 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 17 cost time: 0.3717927932739258
Epoch: 17, Steps: 3 | Train Loss: 0.112 Vali Loss: 0.207 Vali Acc: 0.975 Test Loss: 0.207 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 18 cost time: 0.4255983829498291
Epoch: 18, Steps: 3 | Train Loss: 0.097 Vali Loss: 0.201 Vali Acc: 0.975 Test Loss: 0.201 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 19 cost time: 0.43015527725219727
Epoch: 19, Steps: 3 | Train Loss: 0.075 Vali Loss: 0.201 Vali Acc: 0.975 Test Loss: 0.201 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 20 cost time: 0.4117856025695801
Epoch: 20, Steps: 3 | Train Loss: 0.082 Vali Loss: 0.202 Vali Acc: 0.950 Test Loss: 0.202 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.4059417247772217
Epoch: 21, Steps: 3 | Train Loss: 0.061 Vali Loss: 0.208 Vali Acc: 0.950 Test Loss: 0.208 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.4364438056945801
Epoch: 22, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.198 Vali Acc: 0.950 Test Loss: 0.198 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.4019899368286133
Epoch: 23, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.195 Vali Acc: 0.950 Test Loss: 0.195 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.4365668296813965
Epoch: 24, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.191 Vali Acc: 0.950 Test Loss: 0.191 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.3959615230560303
Epoch: 25, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.189 Vali Acc: 0.950 Test Loss: 0.189 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.40976524353027344
Epoch: 26, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.187 Vali Acc: 0.950 Test Loss: 0.187 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.3970646858215332
Epoch: 27, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.185 Vali Acc: 0.950 Test Loss: 0.185 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.36989688873291016
Epoch: 28, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.186 Vali Acc: 0.950 Test Loss: 0.186 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.4668557643890381
Epoch: 29, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.187 Vali Acc: 0.950 Test Loss: 0.187 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 169604
model size : 0.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.5968706607818604
Epoch: 1, Steps: 3 | Train Loss: 1.453 Vali Loss: 1.309 Vali Acc: 0.375 Test Loss: 1.309 Test Acc: 0.375
Validation loss decreased (inf --> -0.374987).  Saving model ...
Epoch: 2 cost time: 0.3677210807800293
Epoch: 2, Steps: 3 | Train Loss: 1.311 Vali Loss: 1.255 Vali Acc: 0.375 Test Loss: 1.255 Test Acc: 0.375
Validation loss decreased (-0.374987 --> -0.374987).  Saving model ...
Epoch: 3 cost time: 0.39655447006225586
Epoch: 3, Steps: 3 | Train Loss: 1.179 Vali Loss: 1.173 Vali Acc: 0.425 Test Loss: 1.173 Test Acc: 0.425
Validation loss decreased (-0.374987 --> -0.424988).  Saving model ...
Epoch: 4 cost time: 0.37548208236694336
Epoch: 4, Steps: 3 | Train Loss: 1.086 Vali Loss: 1.070 Vali Acc: 0.450 Test Loss: 1.070 Test Acc: 0.450
Validation loss decreased (-0.424988 --> -0.449989).  Saving model ...
Epoch: 5 cost time: 0.4073760509490967
Epoch: 5, Steps: 3 | Train Loss: 0.962 Vali Loss: 0.966 Vali Acc: 0.550 Test Loss: 0.966 Test Acc: 0.550
Validation loss decreased (-0.449989 --> -0.549990).  Saving model ...
Epoch: 6 cost time: 0.42005348205566406
Epoch: 6, Steps: 3 | Train Loss: 0.850 Vali Loss: 0.863 Vali Acc: 0.625 Test Loss: 0.863 Test Acc: 0.625
Validation loss decreased (-0.549990 --> -0.624991).  Saving model ...
Epoch: 7 cost time: 0.3508422374725342
Epoch: 7, Steps: 3 | Train Loss: 0.772 Vali Loss: 0.764 Vali Acc: 0.825 Test Loss: 0.764 Test Acc: 0.825
Validation loss decreased (-0.624991 --> -0.824992).  Saving model ...
Epoch: 8 cost time: 0.40547990798950195
Epoch: 8, Steps: 3 | Train Loss: 0.624 Vali Loss: 0.673 Vali Acc: 0.975 Test Loss: 0.673 Test Acc: 0.975
Validation loss decreased (-0.824992 --> -0.974993).  Saving model ...
Epoch: 9 cost time: 0.43518877029418945
Epoch: 9, Steps: 3 | Train Loss: 0.536 Vali Loss: 0.583 Vali Acc: 1.000 Test Loss: 0.583 Test Acc: 1.000
Validation loss decreased (-0.974993 --> -0.999994).  Saving model ...
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:1.0
model parameter : 157508
model size : 0.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.6742463111877441
Epoch: 1, Steps: 3 | Train Loss: 1.486 Vali Loss: 1.384 Vali Acc: 0.175 Test Loss: 1.384 Test Acc: 0.175
Validation loss decreased (inf --> -0.174986).  Saving model ...
Epoch: 2 cost time: 0.4218127727508545
Epoch: 2, Steps: 3 | Train Loss: 1.309 Vali Loss: 1.328 Vali Acc: 0.225 Test Loss: 1.328 Test Acc: 0.225
Validation loss decreased (-0.174986 --> -0.224987).  Saving model ...
Epoch: 3 cost time: 0.42519617080688477
Epoch: 3, Steps: 3 | Train Loss: 1.217 Vali Loss: 1.246 Vali Acc: 0.375 Test Loss: 1.246 Test Acc: 0.375
Validation loss decreased (-0.224987 --> -0.374988).  Saving model ...
Epoch: 4 cost time: 0.3944547176361084
Epoch: 4, Steps: 3 | Train Loss: 1.134 Vali Loss: 1.144 Vali Acc: 0.625 Test Loss: 1.144 Test Acc: 0.625
Validation loss decreased (-0.374988 --> -0.624989).  Saving model ...
Epoch: 5 cost time: 0.37110424041748047
Epoch: 5, Steps: 3 | Train Loss: 0.988 Vali Loss: 1.030 Vali Acc: 0.725 Test Loss: 1.030 Test Acc: 0.725
Validation loss decreased (-0.624989 --> -0.724990).  Saving model ...
Epoch: 6 cost time: 0.3695869445800781
Epoch: 6, Steps: 3 | Train Loss: 0.949 Vali Loss: 0.922 Vali Acc: 0.825 Test Loss: 0.922 Test Acc: 0.825
Validation loss decreased (-0.724990 --> -0.824991).  Saving model ...
Epoch: 7 cost time: 0.42113161087036133
Epoch: 7, Steps: 3 | Train Loss: 0.820 Vali Loss: 0.827 Vali Acc: 0.875 Test Loss: 0.827 Test Acc: 0.875
Validation loss decreased (-0.824991 --> -0.874992).  Saving model ...
Epoch: 8 cost time: 0.3484306335449219
Epoch: 8, Steps: 3 | Train Loss: 0.668 Vali Loss: 0.737 Vali Acc: 0.925 Test Loss: 0.737 Test Acc: 0.925
Validation loss decreased (-0.874992 --> -0.924993).  Saving model ...
Epoch: 9 cost time: 0.3779637813568115
Epoch: 9, Steps: 3 | Train Loss: 0.585 Vali Loss: 0.654 Vali Acc: 0.925 Test Loss: 0.654 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924993).  Saving model ...
Epoch: 10 cost time: 0.3713979721069336
Epoch: 10, Steps: 3 | Train Loss: 0.496 Vali Loss: 0.576 Vali Acc: 0.950 Test Loss: 0.576 Test Acc: 0.950
Validation loss decreased (-0.924993 --> -0.949994).  Saving model ...
Epoch: 11 cost time: 0.38289475440979004
Epoch: 11, Steps: 3 | Train Loss: 0.430 Vali Loss: 0.504 Vali Acc: 0.950 Test Loss: 0.504 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 12 cost time: 0.41869378089904785
Epoch: 12, Steps: 3 | Train Loss: 0.385 Vali Loss: 0.451 Vali Acc: 0.950 Test Loss: 0.451 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 13 cost time: 0.3891594409942627
Epoch: 13, Steps: 3 | Train Loss: 0.335 Vali Loss: 0.401 Vali Acc: 0.950 Test Loss: 0.401 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 14 cost time: 0.4012324810028076
Epoch: 14, Steps: 3 | Train Loss: 0.301 Vali Loss: 0.362 Vali Acc: 0.950 Test Loss: 0.362 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 15 cost time: 0.3762686252593994
Epoch: 15, Steps: 3 | Train Loss: 0.252 Vali Loss: 0.328 Vali Acc: 0.950 Test Loss: 0.328 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 16 cost time: 0.3560066223144531
Epoch: 16, Steps: 3 | Train Loss: 0.230 Vali Loss: 0.313 Vali Acc: 0.950 Test Loss: 0.313 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 17 cost time: 0.37795376777648926
Epoch: 17, Steps: 3 | Train Loss: 0.222 Vali Loss: 0.293 Vali Acc: 0.950 Test Loss: 0.293 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 18 cost time: 0.4082987308502197
Epoch: 18, Steps: 3 | Train Loss: 0.183 Vali Loss: 0.290 Vali Acc: 0.950 Test Loss: 0.290 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 19 cost time: 0.40052151679992676
Epoch: 19, Steps: 3 | Train Loss: 0.160 Vali Loss: 0.288 Vali Acc: 0.950 Test Loss: 0.288 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 20 cost time: 0.4277503490447998
Epoch: 20, Steps: 3 | Train Loss: 0.134 Vali Loss: 0.260 Vali Acc: 0.950 Test Loss: 0.260 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 21 cost time: 0.38227200508117676
Epoch: 21, Steps: 3 | Train Loss: 0.131 Vali Loss: 0.241 Vali Acc: 0.950 Test Loss: 0.241 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 22 cost time: 0.40767574310302734
Epoch: 22, Steps: 3 | Train Loss: 0.130 Vali Loss: 0.236 Vali Acc: 0.950 Test Loss: 0.236 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 23 cost time: 0.3787846565246582
Epoch: 23, Steps: 3 | Train Loss: 0.125 Vali Loss: 0.227 Vali Acc: 0.950 Test Loss: 0.227 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 24 cost time: 0.4162414073944092
Epoch: 24, Steps: 3 | Train Loss: 0.107 Vali Loss: 0.216 Vali Acc: 0.950 Test Loss: 0.216 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 25 cost time: 0.40225958824157715
Epoch: 25, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.212 Vali Acc: 0.950 Test Loss: 0.212 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 26 cost time: 0.44432711601257324
Epoch: 26, Steps: 3 | Train Loss: 0.095 Vali Loss: 0.210 Vali Acc: 0.950 Test Loss: 0.210 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 27 cost time: 0.37235283851623535
Epoch: 27, Steps: 3 | Train Loss: 0.085 Vali Loss: 0.212 Vali Acc: 0.950 Test Loss: 0.212 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.35965800285339355
Epoch: 28, Steps: 3 | Train Loss: 0.080 Vali Loss: 0.216 Vali Acc: 0.950 Test Loss: 0.216 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.4486064910888672
Epoch: 29, Steps: 3 | Train Loss: 0.068 Vali Loss: 0.220 Vali Acc: 0.950 Test Loss: 0.220 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.33948564529418945
Epoch: 30, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.228 Vali Acc: 0.950 Test Loss: 0.228 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.4245154857635498
Epoch: 31, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.231 Vali Acc: 0.950 Test Loss: 0.231 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.37554430961608887
Epoch: 32, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.226 Vali Acc: 0.950 Test Loss: 0.226 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.39121031761169434
Epoch: 33, Steps: 3 | Train Loss: 0.055 Vali Loss: 0.229 Vali Acc: 0.950 Test Loss: 0.229 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.3934361934661865
Epoch: 34, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.233 Vali Acc: 0.950 Test Loss: 0.233 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.42112183570861816
Epoch: 35, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.239 Vali Acc: 0.950 Test Loss: 0.239 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.42867612838745117
Epoch: 36, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.241 Vali Acc: 0.950 Test Loss: 0.241 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 149956
model size : 0.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.6941370964050293
Epoch: 1, Steps: 3 | Train Loss: 1.520 Vali Loss: 1.412 Vali Acc: 0.100 Test Loss: 1.412 Test Acc: 0.100
Validation loss decreased (inf --> -0.099986).  Saving model ...
Epoch: 2 cost time: 0.3612246513366699
Epoch: 2, Steps: 3 | Train Loss: 1.459 Vali Loss: 1.371 Vali Acc: 0.100 Test Loss: 1.371 Test Acc: 0.100
Validation loss decreased (-0.099986 --> -0.099986).  Saving model ...
Epoch: 3 cost time: 0.436053991317749
Epoch: 3, Steps: 3 | Train Loss: 1.383 Vali Loss: 1.317 Vali Acc: 0.225 Test Loss: 1.317 Test Acc: 0.225
Validation loss decreased (-0.099986 --> -0.224987).  Saving model ...
Epoch: 4 cost time: 0.4256594181060791
Epoch: 4, Steps: 3 | Train Loss: 1.306 Vali Loss: 1.244 Vali Acc: 0.350 Test Loss: 1.244 Test Acc: 0.350
Validation loss decreased (-0.224987 --> -0.349988).  Saving model ...
Epoch: 5 cost time: 0.41150355339050293
Epoch: 5, Steps: 3 | Train Loss: 1.179 Vali Loss: 1.162 Vali Acc: 0.375 Test Loss: 1.162 Test Acc: 0.375
Validation loss decreased (-0.349988 --> -0.374988).  Saving model ...
Epoch: 6 cost time: 0.3916633129119873
Epoch: 6, Steps: 3 | Train Loss: 1.143 Vali Loss: 1.075 Vali Acc: 0.450 Test Loss: 1.075 Test Acc: 0.450
Validation loss decreased (-0.374988 --> -0.449989).  Saving model ...
Epoch: 7 cost time: 0.4126930236816406
Epoch: 7, Steps: 3 | Train Loss: 1.039 Vali Loss: 0.999 Vali Acc: 0.525 Test Loss: 0.999 Test Acc: 0.525
Validation loss decreased (-0.449989 --> -0.524990).  Saving model ...
Epoch: 8 cost time: 0.514915943145752
Epoch: 8, Steps: 3 | Train Loss: 0.965 Vali Loss: 0.930 Vali Acc: 0.675 Test Loss: 0.930 Test Acc: 0.675
Validation loss decreased (-0.524990 --> -0.674991).  Saving model ...
Epoch: 9 cost time: 0.4665391445159912
Epoch: 9, Steps: 3 | Train Loss: 0.900 Vali Loss: 0.867 Vali Acc: 0.825 Test Loss: 0.867 Test Acc: 0.825
Validation loss decreased (-0.674991 --> -0.824991).  Saving model ...
Epoch: 10 cost time: 0.5157091617584229
Epoch: 10, Steps: 3 | Train Loss: 0.752 Vali Loss: 0.818 Vali Acc: 0.850 Test Loss: 0.818 Test Acc: 0.850
Validation loss decreased (-0.824991 --> -0.849992).  Saving model ...
Epoch: 11 cost time: 0.45891618728637695
Epoch: 11, Steps: 3 | Train Loss: 0.686 Vali Loss: 0.759 Vali Acc: 0.875 Test Loss: 0.759 Test Acc: 0.875
Validation loss decreased (-0.849992 --> -0.874992).  Saving model ...
Epoch: 12 cost time: 0.4188833236694336
Epoch: 12, Steps: 3 | Train Loss: 0.658 Vali Loss: 0.699 Vali Acc: 0.925 Test Loss: 0.699 Test Acc: 0.925
Validation loss decreased (-0.874992 --> -0.924993).  Saving model ...
Epoch: 13 cost time: 0.5150752067565918
Epoch: 13, Steps: 3 | Train Loss: 0.592 Vali Loss: 0.644 Vali Acc: 0.925 Test Loss: 0.644 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924994).  Saving model ...
Epoch: 14 cost time: 0.44545984268188477
Epoch: 14, Steps: 3 | Train Loss: 0.532 Vali Loss: 0.595 Vali Acc: 0.950 Test Loss: 0.595 Test Acc: 0.950
Validation loss decreased (-0.924994 --> -0.949994).  Saving model ...
Epoch: 15 cost time: 0.43062281608581543
Epoch: 15, Steps: 3 | Train Loss: 0.484 Vali Loss: 0.558 Vali Acc: 0.950 Test Loss: 0.558 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949994).  Saving model ...
Epoch: 16 cost time: 0.45149731636047363
Epoch: 16, Steps: 3 | Train Loss: 0.425 Vali Loss: 0.521 Vali Acc: 0.950 Test Loss: 0.521 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 17 cost time: 0.4005861282348633
Epoch: 17, Steps: 3 | Train Loss: 0.394 Vali Loss: 0.489 Vali Acc: 0.950 Test Loss: 0.489 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 18 cost time: 0.394808292388916
Epoch: 18, Steps: 3 | Train Loss: 0.353 Vali Loss: 0.456 Vali Acc: 0.950 Test Loss: 0.456 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 19 cost time: 0.429872989654541
Epoch: 19, Steps: 3 | Train Loss: 0.317 Vali Loss: 0.433 Vali Acc: 0.975 Test Loss: 0.433 Test Acc: 0.975
Validation loss decreased (-0.949995 --> -0.974996).  Saving model ...
Epoch: 20 cost time: 0.4775257110595703
Epoch: 20, Steps: 3 | Train Loss: 0.278 Vali Loss: 0.407 Vali Acc: 0.975 Test Loss: 0.407 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 21 cost time: 0.41191911697387695
Epoch: 21, Steps: 3 | Train Loss: 0.283 Vali Loss: 0.387 Vali Acc: 0.975 Test Loss: 0.387 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 22 cost time: 0.39434313774108887
Epoch: 22, Steps: 3 | Train Loss: 0.248 Vali Loss: 0.371 Vali Acc: 0.975 Test Loss: 0.371 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 23 cost time: 0.47278761863708496
Epoch: 23, Steps: 3 | Train Loss: 0.228 Vali Loss: 0.359 Vali Acc: 0.950 Test Loss: 0.359 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.3749375343322754
Epoch: 24, Steps: 3 | Train Loss: 0.209 Vali Loss: 0.339 Vali Acc: 0.950 Test Loss: 0.339 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.40095090866088867
Epoch: 25, Steps: 3 | Train Loss: 0.183 Vali Loss: 0.329 Vali Acc: 0.975 Test Loss: 0.329 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 26 cost time: 0.44981861114501953
Epoch: 26, Steps: 3 | Train Loss: 0.177 Vali Loss: 0.318 Vali Acc: 0.975 Test Loss: 0.318 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 27 cost time: 0.39340949058532715
Epoch: 27, Steps: 3 | Train Loss: 0.165 Vali Loss: 0.304 Vali Acc: 0.975 Test Loss: 0.304 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 28 cost time: 0.46050214767456055
Epoch: 28, Steps: 3 | Train Loss: 0.174 Vali Loss: 0.298 Vali Acc: 0.950 Test Loss: 0.298 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.4554018974304199
Epoch: 29, Steps: 3 | Train Loss: 0.153 Vali Loss: 0.300 Vali Acc: 0.950 Test Loss: 0.300 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.34857869148254395
Epoch: 30, Steps: 3 | Train Loss: 0.140 Vali Loss: 0.294 Vali Acc: 0.950 Test Loss: 0.294 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.4169192314147949
Epoch: 31, Steps: 3 | Train Loss: 0.124 Vali Loss: 0.290 Vali Acc: 0.950 Test Loss: 0.290 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.47557950019836426
Epoch: 32, Steps: 3 | Train Loss: 0.122 Vali Loss: 0.296 Vali Acc: 0.950 Test Loss: 0.296 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.41365981101989746
Epoch: 33, Steps: 3 | Train Loss: 0.111 Vali Loss: 0.297 Vali Acc: 0.950 Test Loss: 0.297 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.4031696319580078
Epoch: 34, Steps: 3 | Train Loss: 0.098 Vali Loss: 0.284 Vali Acc: 0.950 Test Loss: 0.284 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.42626476287841797
Epoch: 35, Steps: 3 | Train Loss: 0.085 Vali Loss: 0.271 Vali Acc: 0.950 Test Loss: 0.271 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.4226093292236328
Epoch: 36, Steps: 3 | Train Loss: 0.092 Vali Loss: 0.275 Vali Acc: 0.950 Test Loss: 0.275 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.46122074127197266
Epoch: 37, Steps: 3 | Train Loss: 0.086 Vali Loss: 0.269 Vali Acc: 0.950 Test Loss: 0.269 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 137988
model size : 0.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps20_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.7421188354492188
Epoch: 1, Steps: 3 | Train Loss: 1.395 Vali Loss: 1.316 Vali Acc: 0.300 Test Loss: 1.316 Test Acc: 0.300
Validation loss decreased (inf --> -0.299987).  Saving model ...
Epoch: 2 cost time: 0.4449195861816406
Epoch: 2, Steps: 3 | Train Loss: 1.295 Vali Loss: 1.278 Vali Acc: 0.300 Test Loss: 1.278 Test Acc: 0.300
Validation loss decreased (-0.299987 --> -0.299987).  Saving model ...
Epoch: 3 cost time: 0.5048809051513672
Epoch: 3, Steps: 3 | Train Loss: 1.219 Vali Loss: 1.234 Vali Acc: 0.375 Test Loss: 1.234 Test Acc: 0.375
Validation loss decreased (-0.299987 --> -0.374988).  Saving model ...
Epoch: 4 cost time: 0.3469538688659668
Epoch: 4, Steps: 3 | Train Loss: 1.232 Vali Loss: 1.172 Vali Acc: 0.375 Test Loss: 1.172 Test Acc: 0.375
Validation loss decreased (-0.374988 --> -0.374988).  Saving model ...
Epoch: 5 cost time: 0.4030916690826416
Epoch: 5, Steps: 3 | Train Loss: 1.146 Vali Loss: 1.104 Vali Acc: 0.450 Test Loss: 1.104 Test Acc: 0.450
Validation loss decreased (-0.374988 --> -0.449989).  Saving model ...
Epoch: 6 cost time: 0.41349029541015625
Epoch: 6, Steps: 3 | Train Loss: 1.023 Vali Loss: 1.040 Vali Acc: 0.525 Test Loss: 1.040 Test Acc: 0.525
Validation loss decreased (-0.449989 --> -0.524990).  Saving model ...
Epoch: 7 cost time: 0.47626447677612305
Epoch: 7, Steps: 3 | Train Loss: 0.976 Vali Loss: 0.972 Vali Acc: 0.675 Test Loss: 0.972 Test Acc: 0.675
Validation loss decreased (-0.524990 --> -0.674990).  Saving model ...
Epoch: 8 cost time: 0.4391193389892578
Epoch: 8, Steps: 3 | Train Loss: 0.911 Vali Loss: 0.906 Vali Acc: 0.800 Test Loss: 0.906 Test Acc: 0.800
Validation loss decreased (-0.674990 --> -0.799991).  Saving model ...
Epoch: 9 cost time: 0.4616847038269043
Epoch: 9, Steps: 3 | Train Loss: 0.792 Vali Loss: 0.851 Vali Acc: 0.900 Test Loss: 0.851 Test Acc: 0.900
Validation loss decreased (-0.799991 --> -0.899991).  Saving model ...
Epoch: 10 cost time: 0.3666548728942871
Epoch: 10, Steps: 3 | Train Loss: 0.774 Vali Loss: 0.794 Vali Acc: 0.900 Test Loss: 0.794 Test Acc: 0.900
Validation loss decreased (-0.899991 --> -0.899992).  Saving model ...
Epoch: 11 cost time: 0.4042229652404785
Epoch: 11, Steps: 3 | Train Loss: 0.731 Vali Loss: 0.739 Vali Acc: 0.925 Test Loss: 0.739 Test Acc: 0.925
Validation loss decreased (-0.899992 --> -0.924993).  Saving model ...
Epoch: 12 cost time: 0.49630022048950195
Epoch: 12, Steps: 3 | Train Loss: 0.638 Vali Loss: 0.690 Vali Acc: 0.925 Test Loss: 0.690 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924993).  Saving model ...
Epoch: 13 cost time: 0.42627453804016113
Epoch: 13, Steps: 3 | Train Loss: 0.563 Vali Loss: 0.644 Vali Acc: 0.925 Test Loss: 0.644 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924994).  Saving model ...
Epoch: 14 cost time: 0.46063923835754395
Epoch: 14, Steps: 3 | Train Loss: 0.568 Vali Loss: 0.598 Vali Acc: 0.925 Test Loss: 0.598 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 15 cost time: 0.3993804454803467
Epoch: 15, Steps: 3 | Train Loss: 0.519 Vali Loss: 0.546 Vali Acc: 0.925 Test Loss: 0.546 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 16 cost time: 0.44237351417541504
Epoch: 16, Steps: 3 | Train Loss: 0.462 Vali Loss: 0.512 Vali Acc: 0.975 Test Loss: 0.512 Test Acc: 0.975
Validation loss decreased (-0.924995 --> -0.974995).  Saving model ...
Epoch: 17 cost time: 0.4657621383666992
Epoch: 17, Steps: 3 | Train Loss: 0.405 Vali Loss: 0.478 Vali Acc: 0.975 Test Loss: 0.478 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 18 cost time: 0.519758939743042
Epoch: 18, Steps: 3 | Train Loss: 0.399 Vali Loss: 0.454 Vali Acc: 0.975 Test Loss: 0.454 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 19 cost time: 0.45383286476135254
Epoch: 19, Steps: 3 | Train Loss: 0.340 Vali Loss: 0.424 Vali Acc: 0.975 Test Loss: 0.424 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 20 cost time: 0.3706669807434082
Epoch: 20, Steps: 3 | Train Loss: 0.336 Vali Loss: 0.407 Vali Acc: 0.975 Test Loss: 0.407 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 21 cost time: 0.4231133460998535
Epoch: 21, Steps: 3 | Train Loss: 0.257 Vali Loss: 0.380 Vali Acc: 0.975 Test Loss: 0.380 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 22 cost time: 0.37310338020324707
Epoch: 22, Steps: 3 | Train Loss: 0.275 Vali Loss: 0.362 Vali Acc: 0.975 Test Loss: 0.362 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 23 cost time: 0.48143553733825684
Epoch: 23, Steps: 3 | Train Loss: 0.252 Vali Loss: 0.347 Vali Acc: 0.975 Test Loss: 0.347 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 24 cost time: 0.44753026962280273
Epoch: 24, Steps: 3 | Train Loss: 0.231 Vali Loss: 0.328 Vali Acc: 0.975 Test Loss: 0.328 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 25 cost time: 0.4507465362548828
Epoch: 25, Steps: 3 | Train Loss: 0.242 Vali Loss: 0.313 Vali Acc: 0.975 Test Loss: 0.313 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 26 cost time: 0.387470006942749
Epoch: 26, Steps: 3 | Train Loss: 0.205 Vali Loss: 0.301 Vali Acc: 0.975 Test Loss: 0.301 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 27 cost time: 0.42032742500305176
Epoch: 27, Steps: 3 | Train Loss: 0.179 Vali Loss: 0.301 Vali Acc: 0.975 Test Loss: 0.301 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 28 cost time: 0.44292664527893066
Epoch: 28, Steps: 3 | Train Loss: 0.185 Vali Loss: 0.288 Vali Acc: 0.975 Test Loss: 0.288 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 29 cost time: 0.4975130558013916
Epoch: 29, Steps: 3 | Train Loss: 0.172 Vali Loss: 0.281 Vali Acc: 0.975 Test Loss: 0.281 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 30 cost time: 0.4295816421508789
Epoch: 30, Steps: 3 | Train Loss: 0.180 Vali Loss: 0.276 Vali Acc: 0.975 Test Loss: 0.276 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 31 cost time: 0.4246077537536621
Epoch: 31, Steps: 3 | Train Loss: 0.167 Vali Loss: 0.265 Vali Acc: 0.975 Test Loss: 0.265 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 32 cost time: 0.4880516529083252
Epoch: 32, Steps: 3 | Train Loss: 0.168 Vali Loss: 0.266 Vali Acc: 0.975 Test Loss: 0.266 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.44927287101745605
Epoch: 33, Steps: 3 | Train Loss: 0.133 Vali Loss: 0.259 Vali Acc: 0.975 Test Loss: 0.259 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 34 cost time: 0.4893043041229248
Epoch: 34, Steps: 3 | Train Loss: 0.145 Vali Loss: 0.252 Vali Acc: 0.975 Test Loss: 0.252 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 35 cost time: 0.41274547576904297
Epoch: 35, Steps: 3 | Train Loss: 0.132 Vali Loss: 0.243 Vali Acc: 0.975 Test Loss: 0.243 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 36 cost time: 0.4194936752319336
Epoch: 36, Steps: 3 | Train Loss: 0.146 Vali Loss: 0.244 Vali Acc: 0.975 Test Loss: 0.244 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.4101247787475586
Epoch: 37, Steps: 3 | Train Loss: 0.115 Vali Loss: 0.239 Vali Acc: 0.975 Test Loss: 0.239 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 38 cost time: 0.44129395484924316
Epoch: 38, Steps: 3 | Train Loss: 0.110 Vali Loss: 0.234 Vali Acc: 0.975 Test Loss: 0.234 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 39 cost time: 0.3927600383758545
Epoch: 39, Steps: 3 | Train Loss: 0.099 Vali Loss: 0.225 Vali Acc: 0.975 Test Loss: 0.225 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 40 cost time: 0.43210315704345703
Epoch: 40, Steps: 3 | Train Loss: 0.118 Vali Loss: 0.223 Vali Acc: 0.975 Test Loss: 0.223 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 41 cost time: 0.4477345943450928
Epoch: 41, Steps: 3 | Train Loss: 0.092 Vali Loss: 0.219 Vali Acc: 0.975 Test Loss: 0.219 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 42 cost time: 0.47731900215148926
Epoch: 42, Steps: 3 | Train Loss: 0.088 Vali Loss: 0.214 Vali Acc: 0.975 Test Loss: 0.214 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 43 cost time: 0.4130063056945801
Epoch: 43, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.213 Vali Acc: 0.975 Test Loss: 0.213 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 44 cost time: 0.4716224670410156
Epoch: 44, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.205 Vali Acc: 0.975 Test Loss: 0.205 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 45 cost time: 0.4079766273498535
Epoch: 45, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.206 Vali Acc: 0.975 Test Loss: 0.206 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.4591524600982666
Epoch: 46, Steps: 3 | Train Loss: 0.070 Vali Loss: 0.201 Vali Acc: 0.975 Test Loss: 0.201 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 47 cost time: 0.3920724391937256
Epoch: 47, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.195 Vali Acc: 0.975 Test Loss: 0.195 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 48 cost time: 0.415895938873291
Epoch: 48, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.196 Vali Acc: 0.975 Test Loss: 0.196 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.451357364654541
Epoch: 49, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.201 Vali Acc: 0.950 Test Loss: 0.201 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.40504026412963867
Epoch: 50, Steps: 3 | Train Loss: 0.061 Vali Loss: 0.203 Vali Acc: 0.950 Test Loss: 0.203 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps20_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 135236
model size : 0.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps25_str13_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.5196795463562012
Epoch: 1, Steps: 3 | Train Loss: 1.318 Vali Loss: 1.403 Vali Acc: 0.325 Test Loss: 1.403 Test Acc: 0.325
Validation loss decreased (inf --> -0.324986).  Saving model ...
Epoch: 2 cost time: 0.47968268394470215
Epoch: 2, Steps: 3 | Train Loss: 1.267 Vali Loss: 1.375 Vali Acc: 0.325 Test Loss: 1.375 Test Acc: 0.325
Validation loss decreased (-0.324986 --> -0.324986).  Saving model ...
Epoch: 3 cost time: 0.44840121269226074
Epoch: 3, Steps: 3 | Train Loss: 1.207 Vali Loss: 1.344 Vali Acc: 0.350 Test Loss: 1.344 Test Acc: 0.350
Validation loss decreased (-0.324986 --> -0.349987).  Saving model ...
Epoch: 4 cost time: 0.5214903354644775
Epoch: 4, Steps: 3 | Train Loss: 1.188 Vali Loss: 1.299 Vali Acc: 0.375 Test Loss: 1.299 Test Acc: 0.375
Validation loss decreased (-0.349987 --> -0.374987).  Saving model ...
Epoch: 5 cost time: 0.4108607769012451
Epoch: 5, Steps: 3 | Train Loss: 1.129 Vali Loss: 1.242 Vali Acc: 0.475 Test Loss: 1.242 Test Acc: 0.475
Validation loss decreased (-0.374987 --> -0.474988).  Saving model ...
Epoch: 6 cost time: 0.446155309677124
Epoch: 6, Steps: 3 | Train Loss: 1.062 Vali Loss: 1.181 Vali Acc: 0.500 Test Loss: 1.181 Test Acc: 0.500
Validation loss decreased (-0.474988 --> -0.499988).  Saving model ...
Epoch: 7 cost time: 0.49594759941101074
Epoch: 7, Steps: 3 | Train Loss: 0.987 Vali Loss: 1.119 Vali Acc: 0.525 Test Loss: 1.119 Test Acc: 0.525
Validation loss decreased (-0.499988 --> -0.524989).  Saving model ...
Epoch: 8 cost time: 0.5075869560241699
Epoch: 8, Steps: 3 | Train Loss: 0.958 Vali Loss: 1.057 Vali Acc: 0.575 Test Loss: 1.057 Test Acc: 0.575
Validation loss decreased (-0.524989 --> -0.574989).  Saving model ...
Epoch: 9 cost time: 0.5241327285766602
Epoch: 9, Steps: 3 | Train Loss: 0.893 Vali Loss: 1.003 Vali Acc: 0.625 Test Loss: 1.003 Test Acc: 0.625
Validation loss decreased (-0.574989 --> -0.624990).  Saving model ...
Epoch: 10 cost time: 0.5384416580200195
Epoch: 10, Steps: 3 | Train Loss: 0.818 Vali Loss: 0.957 Vali Acc: 0.625 Test Loss: 0.957 Test Acc: 0.625
Validation loss decreased (-0.624990 --> -0.624990).  Saving model ...
Epoch: 11 cost time: 0.4464449882507324
Epoch: 11, Steps: 3 | Train Loss: 0.789 Vali Loss: 0.905 Vali Acc: 0.625 Test Loss: 0.905 Test Acc: 0.625
Validation loss decreased (-0.624990 --> -0.624991).  Saving model ...
Epoch: 12 cost time: 0.4524960517883301
Epoch: 12, Steps: 3 | Train Loss: 0.735 Vali Loss: 0.855 Vali Acc: 0.700 Test Loss: 0.855 Test Acc: 0.700
Validation loss decreased (-0.624991 --> -0.699991).  Saving model ...
Epoch: 13 cost time: 0.4735538959503174
Epoch: 13, Steps: 3 | Train Loss: 0.719 Vali Loss: 0.801 Vali Acc: 0.775 Test Loss: 0.801 Test Acc: 0.775
Validation loss decreased (-0.699991 --> -0.774992).  Saving model ...
Epoch: 14 cost time: 0.5459203720092773
Epoch: 14, Steps: 3 | Train Loss: 0.645 Vali Loss: 0.755 Vali Acc: 0.875 Test Loss: 0.755 Test Acc: 0.875
Validation loss decreased (-0.774992 --> -0.874992).  Saving model ...
Epoch: 15 cost time: 0.43909478187561035
Epoch: 15, Steps: 3 | Train Loss: 0.608 Vali Loss: 0.710 Vali Acc: 0.925 Test Loss: 0.710 Test Acc: 0.925
Validation loss decreased (-0.874992 --> -0.924993).  Saving model ...
Epoch: 16 cost time: 0.4877011775970459
Epoch: 16, Steps: 3 | Train Loss: 0.566 Vali Loss: 0.673 Vali Acc: 0.925 Test Loss: 0.673 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924993).  Saving model ...
Epoch: 17 cost time: 0.373089075088501
Epoch: 17, Steps: 3 | Train Loss: 0.513 Vali Loss: 0.641 Vali Acc: 0.925 Test Loss: 0.641 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924994).  Saving model ...
Epoch: 18 cost time: 0.5265548229217529
Epoch: 18, Steps: 3 | Train Loss: 0.488 Vali Loss: 0.615 Vali Acc: 0.950 Test Loss: 0.615 Test Acc: 0.950
Validation loss decreased (-0.924994 --> -0.949994).  Saving model ...
Epoch: 19 cost time: 0.37685179710388184
Epoch: 19, Steps: 3 | Train Loss: 0.460 Vali Loss: 0.590 Vali Acc: 0.950 Test Loss: 0.590 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949994).  Saving model ...
Epoch: 20 cost time: 0.4881117343902588
Epoch: 20, Steps: 3 | Train Loss: 0.408 Vali Loss: 0.563 Vali Acc: 0.950 Test Loss: 0.563 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949994).  Saving model ...
Epoch: 21 cost time: 0.4296691417694092
Epoch: 21, Steps: 3 | Train Loss: 0.396 Vali Loss: 0.535 Vali Acc: 0.950 Test Loss: 0.535 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 22 cost time: 0.3941633701324463
Epoch: 22, Steps: 3 | Train Loss: 0.360 Vali Loss: 0.511 Vali Acc: 0.950 Test Loss: 0.511 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 23 cost time: 0.4817230701446533
Epoch: 23, Steps: 3 | Train Loss: 0.349 Vali Loss: 0.498 Vali Acc: 0.950 Test Loss: 0.498 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 24 cost time: 0.42650508880615234
Epoch: 24, Steps: 3 | Train Loss: 0.326 Vali Loss: 0.481 Vali Acc: 0.950 Test Loss: 0.481 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 25 cost time: 0.43822574615478516
Epoch: 25, Steps: 3 | Train Loss: 0.321 Vali Loss: 0.467 Vali Acc: 0.950 Test Loss: 0.467 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 26 cost time: 0.46506786346435547
Epoch: 26, Steps: 3 | Train Loss: 0.281 Vali Loss: 0.449 Vali Acc: 0.925 Test Loss: 0.449 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5164375305175781
Epoch: 27, Steps: 3 | Train Loss: 0.275 Vali Loss: 0.434 Vali Acc: 0.950 Test Loss: 0.434 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 28 cost time: 0.5121619701385498
Epoch: 28, Steps: 3 | Train Loss: 0.276 Vali Loss: 0.418 Vali Acc: 0.950 Test Loss: 0.418 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 29 cost time: 0.4577908515930176
Epoch: 29, Steps: 3 | Train Loss: 0.239 Vali Loss: 0.412 Vali Acc: 0.950 Test Loss: 0.412 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 30 cost time: 0.4053804874420166
Epoch: 30, Steps: 3 | Train Loss: 0.235 Vali Loss: 0.393 Vali Acc: 0.950 Test Loss: 0.393 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 31 cost time: 0.40224289894104004
Epoch: 31, Steps: 3 | Train Loss: 0.219 Vali Loss: 0.385 Vali Acc: 0.925 Test Loss: 0.385 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.5267112255096436
Epoch: 32, Steps: 3 | Train Loss: 0.207 Vali Loss: 0.375 Vali Acc: 0.925 Test Loss: 0.375 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.4361424446105957
Epoch: 33, Steps: 3 | Train Loss: 0.201 Vali Loss: 0.367 Vali Acc: 0.950 Test Loss: 0.367 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 34 cost time: 0.4079873561859131
Epoch: 34, Steps: 3 | Train Loss: 0.185 Vali Loss: 0.361 Vali Acc: 0.950 Test Loss: 0.361 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 35 cost time: 0.3638763427734375
Epoch: 35, Steps: 3 | Train Loss: 0.183 Vali Loss: 0.352 Vali Acc: 0.950 Test Loss: 0.352 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 36 cost time: 0.39572930335998535
Epoch: 36, Steps: 3 | Train Loss: 0.162 Vali Loss: 0.349 Vali Acc: 0.950 Test Loss: 0.349 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 37 cost time: 0.42130160331726074
Epoch: 37, Steps: 3 | Train Loss: 0.184 Vali Loss: 0.329 Vali Acc: 0.950 Test Loss: 0.329 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 38 cost time: 0.48314547538757324
Epoch: 38, Steps: 3 | Train Loss: 0.140 Vali Loss: 0.310 Vali Acc: 0.950 Test Loss: 0.310 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 39 cost time: 0.4616739749908447
Epoch: 39, Steps: 3 | Train Loss: 0.146 Vali Loss: 0.301 Vali Acc: 0.950 Test Loss: 0.301 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 40 cost time: 0.3550150394439697
Epoch: 40, Steps: 3 | Train Loss: 0.144 Vali Loss: 0.296 Vali Acc: 0.950 Test Loss: 0.296 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 41 cost time: 0.4359560012817383
Epoch: 41, Steps: 3 | Train Loss: 0.144 Vali Loss: 0.287 Vali Acc: 0.950 Test Loss: 0.287 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 42 cost time: 0.4204733371734619
Epoch: 42, Steps: 3 | Train Loss: 0.117 Vali Loss: 0.284 Vali Acc: 0.950 Test Loss: 0.284 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 43 cost time: 0.46854400634765625
Epoch: 43, Steps: 3 | Train Loss: 0.127 Vali Loss: 0.283 Vali Acc: 0.950 Test Loss: 0.283 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 44 cost time: 0.4319729804992676
Epoch: 44, Steps: 3 | Train Loss: 0.117 Vali Loss: 0.270 Vali Acc: 0.950 Test Loss: 0.270 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 45 cost time: 0.3902254104614258
Epoch: 45, Steps: 3 | Train Loss: 0.110 Vali Loss: 0.258 Vali Acc: 0.950 Test Loss: 0.258 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 46 cost time: 0.4181818962097168
Epoch: 46, Steps: 3 | Train Loss: 0.107 Vali Loss: 0.257 Vali Acc: 0.950 Test Loss: 0.257 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 47 cost time: 0.4141271114349365
Epoch: 47, Steps: 3 | Train Loss: 0.101 Vali Loss: 0.248 Vali Acc: 0.950 Test Loss: 0.248 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 48 cost time: 0.45288610458374023
Epoch: 48, Steps: 3 | Train Loss: 0.097 Vali Loss: 0.246 Vali Acc: 0.950 Test Loss: 0.246 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 49 cost time: 0.40634846687316895
Epoch: 49, Steps: 3 | Train Loss: 0.086 Vali Loss: 0.238 Vali Acc: 0.950 Test Loss: 0.238 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 50 cost time: 0.4328420162200928
Epoch: 50, Steps: 3 | Train Loss: 0.088 Vali Loss: 0.232 Vali Acc: 0.950 Test Loss: 0.232 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps25_str13_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 130948
model size : 0.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.5311167240142822
Epoch: 1, Steps: 3 | Train Loss: 1.673 Vali Loss: 1.520 Vali Acc: 0.175 Test Loss: 1.520 Test Acc: 0.175
Validation loss decreased (inf --> -0.174985).  Saving model ...
Epoch: 2 cost time: 0.3790395259857178
Epoch: 2, Steps: 3 | Train Loss: 1.455 Vali Loss: 1.479 Vali Acc: 0.250 Test Loss: 1.479 Test Acc: 0.250
Validation loss decreased (-0.174985 --> -0.249985).  Saving model ...
Epoch: 3 cost time: 0.39397120475769043
Epoch: 3, Steps: 3 | Train Loss: 1.408 Vali Loss: 1.402 Vali Acc: 0.375 Test Loss: 1.402 Test Acc: 0.375
Validation loss decreased (-0.249985 --> -0.374986).  Saving model ...
Epoch: 4 cost time: 0.4407961368560791
Epoch: 4, Steps: 3 | Train Loss: 1.215 Vali Loss: 1.295 Vali Acc: 0.450 Test Loss: 1.295 Test Acc: 0.450
Validation loss decreased (-0.374986 --> -0.449987).  Saving model ...
Epoch: 5 cost time: 0.46502161026000977
Epoch: 5, Steps: 3 | Train Loss: 1.086 Vali Loss: 1.175 Vali Acc: 0.550 Test Loss: 1.175 Test Acc: 0.550
Validation loss decreased (-0.449987 --> -0.549988).  Saving model ...
Epoch: 6 cost time: 0.4608464241027832
Epoch: 6, Steps: 3 | Train Loss: 0.895 Vali Loss: 1.055 Vali Acc: 0.625 Test Loss: 1.055 Test Acc: 0.625
Validation loss decreased (-0.549988 --> -0.624989).  Saving model ...
Epoch: 7 cost time: 0.42050981521606445
Epoch: 7, Steps: 3 | Train Loss: 0.804 Vali Loss: 0.944 Vali Acc: 0.750 Test Loss: 0.944 Test Acc: 0.750
Validation loss decreased (-0.624989 --> -0.749991).  Saving model ...
Epoch: 8 cost time: 0.39086413383483887
Epoch: 8, Steps: 3 | Train Loss: 0.680 Vali Loss: 0.850 Vali Acc: 0.800 Test Loss: 0.850 Test Acc: 0.800
Validation loss decreased (-0.749991 --> -0.799992).  Saving model ...
Epoch: 9 cost time: 0.3907804489135742
Epoch: 9, Steps: 3 | Train Loss: 0.609 Vali Loss: 0.757 Vali Acc: 0.800 Test Loss: 0.757 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 10 cost time: 0.41614484786987305
Epoch: 10, Steps: 3 | Train Loss: 0.531 Vali Loss: 0.661 Vali Acc: 0.900 Test Loss: 0.661 Test Acc: 0.900
Validation loss decreased (-0.799992 --> -0.899993).  Saving model ...
Epoch: 11 cost time: 0.36696696281433105
Epoch: 11, Steps: 3 | Train Loss: 0.437 Vali Loss: 0.580 Vali Acc: 0.950 Test Loss: 0.580 Test Acc: 0.950
Validation loss decreased (-0.899993 --> -0.949994).  Saving model ...
Epoch: 12 cost time: 0.42287611961364746
Epoch: 12, Steps: 3 | Train Loss: 0.367 Vali Loss: 0.511 Vali Acc: 0.950 Test Loss: 0.511 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 13 cost time: 0.41329169273376465
Epoch: 13, Steps: 3 | Train Loss: 0.316 Vali Loss: 0.460 Vali Acc: 0.950 Test Loss: 0.460 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 14 cost time: 0.4166288375854492
Epoch: 14, Steps: 3 | Train Loss: 0.288 Vali Loss: 0.416 Vali Acc: 0.925 Test Loss: 0.416 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.42352962493896484
Epoch: 15, Steps: 3 | Train Loss: 0.235 Vali Loss: 0.393 Vali Acc: 0.950 Test Loss: 0.393 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 16 cost time: 0.3926217555999756
Epoch: 16, Steps: 3 | Train Loss: 0.203 Vali Loss: 0.377 Vali Acc: 0.925 Test Loss: 0.377 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.36643362045288086
Epoch: 17, Steps: 3 | Train Loss: 0.173 Vali Loss: 0.369 Vali Acc: 0.925 Test Loss: 0.369 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.41330552101135254
Epoch: 18, Steps: 3 | Train Loss: 0.178 Vali Loss: 0.374 Vali Acc: 0.925 Test Loss: 0.374 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.5513966083526611
Epoch: 19, Steps: 3 | Train Loss: 0.147 Vali Loss: 0.379 Vali Acc: 0.925 Test Loss: 0.379 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.43187618255615234
Epoch: 20, Steps: 3 | Train Loss: 0.140 Vali Loss: 0.381 Vali Acc: 0.925 Test Loss: 0.381 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.40732741355895996
Epoch: 21, Steps: 3 | Train Loss: 0.110 Vali Loss: 0.379 Vali Acc: 0.900 Test Loss: 0.379 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.3737215995788574
Epoch: 22, Steps: 3 | Train Loss: 0.099 Vali Loss: 0.374 Vali Acc: 0.900 Test Loss: 0.374 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.4359018802642822
Epoch: 23, Steps: 3 | Train Loss: 0.098 Vali Loss: 0.370 Vali Acc: 0.900 Test Loss: 0.370 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.4534773826599121
Epoch: 24, Steps: 3 | Train Loss: 0.092 Vali Loss: 0.379 Vali Acc: 0.900 Test Loss: 0.379 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.48749852180480957
Epoch: 25, Steps: 3 | Train Loss: 0.092 Vali Loss: 0.373 Vali Acc: 0.900 Test Loss: 0.373 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 73220
model size : 0.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.6662588119506836
Epoch: 1, Steps: 3 | Train Loss: 1.461 Vali Loss: 1.407 Vali Acc: 0.200 Test Loss: 1.407 Test Acc: 0.200
Validation loss decreased (inf --> -0.199986).  Saving model ...
Epoch: 2 cost time: 0.4049191474914551
Epoch: 2, Steps: 3 | Train Loss: 1.468 Vali Loss: 1.370 Vali Acc: 0.275 Test Loss: 1.370 Test Acc: 0.275
Validation loss decreased (-0.199986 --> -0.274986).  Saving model ...
Epoch: 3 cost time: 0.41131043434143066
Epoch: 3, Steps: 3 | Train Loss: 1.311 Vali Loss: 1.311 Vali Acc: 0.325 Test Loss: 1.311 Test Acc: 0.325
Validation loss decreased (-0.274986 --> -0.324987).  Saving model ...
Epoch: 4 cost time: 0.36136817932128906
Epoch: 4, Steps: 3 | Train Loss: 1.168 Vali Loss: 1.233 Vali Acc: 0.400 Test Loss: 1.233 Test Acc: 0.400
Validation loss decreased (-0.324987 --> -0.399988).  Saving model ...
Epoch: 5 cost time: 0.40227627754211426
Epoch: 5, Steps: 3 | Train Loss: 1.058 Vali Loss: 1.146 Vali Acc: 0.500 Test Loss: 1.146 Test Acc: 0.500
Validation loss decreased (-0.399988 --> -0.499989).  Saving model ...
Epoch: 6 cost time: 0.4468255043029785
Epoch: 6, Steps: 3 | Train Loss: 0.944 Vali Loss: 1.058 Vali Acc: 0.575 Test Loss: 1.058 Test Acc: 0.575
Validation loss decreased (-0.499989 --> -0.574989).  Saving model ...
Epoch: 7 cost time: 0.40984678268432617
Epoch: 7, Steps: 3 | Train Loss: 0.836 Vali Loss: 0.971 Vali Acc: 0.650 Test Loss: 0.971 Test Acc: 0.650
Validation loss decreased (-0.574989 --> -0.649990).  Saving model ...
Epoch: 8 cost time: 0.4206862449645996
Epoch: 8, Steps: 3 | Train Loss: 0.742 Vali Loss: 0.882 Vali Acc: 0.800 Test Loss: 0.882 Test Acc: 0.800
Validation loss decreased (-0.649990 --> -0.799991).  Saving model ...
Epoch: 9 cost time: 0.4065675735473633
Epoch: 9, Steps: 3 | Train Loss: 0.681 Vali Loss: 0.799 Vali Acc: 0.850 Test Loss: 0.799 Test Acc: 0.850
Validation loss decreased (-0.799991 --> -0.849992).  Saving model ...
Epoch: 10 cost time: 0.37087249755859375
Epoch: 10, Steps: 3 | Train Loss: 0.570 Vali Loss: 0.717 Vali Acc: 0.900 Test Loss: 0.717 Test Acc: 0.900
Validation loss decreased (-0.849992 --> -0.899993).  Saving model ...
Epoch: 11 cost time: 0.3711721897125244
Epoch: 11, Steps: 3 | Train Loss: 0.501 Vali Loss: 0.644 Vali Acc: 0.900 Test Loss: 0.644 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899994).  Saving model ...
Epoch: 12 cost time: 0.3861501216888428
Epoch: 12, Steps: 3 | Train Loss: 0.446 Vali Loss: 0.576 Vali Acc: 0.925 Test Loss: 0.576 Test Acc: 0.925
Validation loss decreased (-0.899994 --> -0.924994).  Saving model ...
Epoch: 13 cost time: 0.537308931350708
Epoch: 13, Steps: 3 | Train Loss: 0.396 Vali Loss: 0.522 Vali Acc: 0.900 Test Loss: 0.522 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.44568610191345215
Epoch: 14, Steps: 3 | Train Loss: 0.359 Vali Loss: 0.473 Vali Acc: 0.925 Test Loss: 0.473 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 15 cost time: 0.3652157783508301
Epoch: 15, Steps: 3 | Train Loss: 0.290 Vali Loss: 0.427 Vali Acc: 0.950 Test Loss: 0.427 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949996).  Saving model ...
Epoch: 16 cost time: 0.5143635272979736
Epoch: 16, Steps: 3 | Train Loss: 0.307 Vali Loss: 0.397 Vali Acc: 0.950 Test Loss: 0.397 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 17 cost time: 0.4192531108856201
Epoch: 17, Steps: 3 | Train Loss: 0.250 Vali Loss: 0.368 Vali Acc: 0.950 Test Loss: 0.368 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 18 cost time: 0.3491652011871338
Epoch: 18, Steps: 3 | Train Loss: 0.236 Vali Loss: 0.341 Vali Acc: 0.950 Test Loss: 0.341 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 19 cost time: 0.44655585289001465
Epoch: 19, Steps: 3 | Train Loss: 0.203 Vali Loss: 0.326 Vali Acc: 0.950 Test Loss: 0.326 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 20 cost time: 0.49471068382263184
Epoch: 20, Steps: 3 | Train Loss: 0.192 Vali Loss: 0.311 Vali Acc: 0.950 Test Loss: 0.311 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 21 cost time: 0.3607637882232666
Epoch: 21, Steps: 3 | Train Loss: 0.179 Vali Loss: 0.300 Vali Acc: 0.950 Test Loss: 0.300 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 22 cost time: 0.4041581153869629
Epoch: 22, Steps: 3 | Train Loss: 0.175 Vali Loss: 0.289 Vali Acc: 0.950 Test Loss: 0.289 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 23 cost time: 0.47862768173217773
Epoch: 23, Steps: 3 | Train Loss: 0.157 Vali Loss: 0.281 Vali Acc: 0.950 Test Loss: 0.281 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 24 cost time: 0.4432528018951416
Epoch: 24, Steps: 3 | Train Loss: 0.137 Vali Loss: 0.274 Vali Acc: 0.950 Test Loss: 0.274 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 25 cost time: 0.4394106864929199
Epoch: 25, Steps: 3 | Train Loss: 0.122 Vali Loss: 0.274 Vali Acc: 0.950 Test Loss: 0.274 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 26 cost time: 0.4211428165435791
Epoch: 26, Steps: 3 | Train Loss: 0.124 Vali Loss: 0.271 Vali Acc: 0.950 Test Loss: 0.271 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 27 cost time: 0.44281744956970215
Epoch: 27, Steps: 3 | Train Loss: 0.109 Vali Loss: 0.257 Vali Acc: 0.950 Test Loss: 0.257 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 28 cost time: 0.5015561580657959
Epoch: 28, Steps: 3 | Train Loss: 0.108 Vali Loss: 0.249 Vali Acc: 0.950 Test Loss: 0.249 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 29 cost time: 0.43843936920166016
Epoch: 29, Steps: 3 | Train Loss: 0.092 Vali Loss: 0.238 Vali Acc: 0.950 Test Loss: 0.238 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 30 cost time: 0.4989454746246338
Epoch: 30, Steps: 3 | Train Loss: 0.094 Vali Loss: 0.236 Vali Acc: 0.950 Test Loss: 0.236 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 31 cost time: 0.44542479515075684
Epoch: 31, Steps: 3 | Train Loss: 0.082 Vali Loss: 0.227 Vali Acc: 0.950 Test Loss: 0.227 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 32 cost time: 0.45395445823669434
Epoch: 32, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.227 Vali Acc: 0.950 Test Loss: 0.227 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 33 cost time: 0.4062373638153076
Epoch: 33, Steps: 3 | Train Loss: 0.081 Vali Loss: 0.229 Vali Acc: 0.950 Test Loss: 0.229 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.4426443576812744
Epoch: 34, Steps: 3 | Train Loss: 0.075 Vali Loss: 0.228 Vali Acc: 0.950 Test Loss: 0.228 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.437225341796875
Epoch: 35, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.223 Vali Acc: 0.950 Test Loss: 0.223 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 36 cost time: 0.4887425899505615
Epoch: 36, Steps: 3 | Train Loss: 0.074 Vali Loss: 0.227 Vali Acc: 0.950 Test Loss: 0.227 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.42803382873535156
Epoch: 37, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.225 Vali Acc: 0.950 Test Loss: 0.225 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.38326144218444824
Epoch: 38, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.218 Vali Acc: 0.950 Test Loss: 0.218 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 39 cost time: 0.42066383361816406
Epoch: 39, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.222 Vali Acc: 0.950 Test Loss: 0.222 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.3817474842071533
Epoch: 40, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.219 Vali Acc: 0.950 Test Loss: 0.219 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.4527461528778076
Epoch: 41, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.211 Vali Acc: 0.950 Test Loss: 0.211 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 42 cost time: 0.3706333637237549
Epoch: 42, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.208 Vali Acc: 0.950 Test Loss: 0.208 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 43 cost time: 0.42816996574401855
Epoch: 43, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.210 Vali Acc: 0.950 Test Loss: 0.210 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.4033620357513428
Epoch: 44, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.205 Vali Acc: 0.950 Test Loss: 0.205 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 45 cost time: 0.3754305839538574
Epoch: 45, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.204 Vali Acc: 0.950 Test Loss: 0.204 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 46 cost time: 0.40897059440612793
Epoch: 46, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.204 Vali Acc: 0.950 Test Loss: 0.204 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 47 cost time: 0.38069844245910645
Epoch: 47, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.207 Vali Acc: 0.950 Test Loss: 0.207 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.4053993225097656
Epoch: 48, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.208 Vali Acc: 0.950 Test Loss: 0.208 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.459183931350708
Epoch: 49, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.216 Vali Acc: 0.950 Test Loss: 0.216 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.4203526973724365
Epoch: 50, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.208 Vali Acc: 0.950 Test Loss: 0.208 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 60228
model size : 0.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.705275535583496
Epoch: 1, Steps: 3 | Train Loss: 1.425 Vali Loss: 1.383 Vali Acc: 0.175 Test Loss: 1.383 Test Acc: 0.175
Validation loss decreased (inf --> -0.174986).  Saving model ...
Epoch: 2 cost time: 0.41419291496276855
Epoch: 2, Steps: 3 | Train Loss: 1.281 Vali Loss: 1.352 Vali Acc: 0.275 Test Loss: 1.352 Test Acc: 0.275
Validation loss decreased (-0.174986 --> -0.274986).  Saving model ...
Epoch: 3 cost time: 0.38378405570983887
Epoch: 3, Steps: 3 | Train Loss: 1.234 Vali Loss: 1.307 Vali Acc: 0.350 Test Loss: 1.307 Test Acc: 0.350
Validation loss decreased (-0.274986 --> -0.349987).  Saving model ...
Epoch: 4 cost time: 0.38699936866760254
Epoch: 4, Steps: 3 | Train Loss: 1.175 Vali Loss: 1.241 Vali Acc: 0.325 Test Loss: 1.241 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.3802816867828369
Epoch: 5, Steps: 3 | Train Loss: 1.086 Vali Loss: 1.164 Vali Acc: 0.425 Test Loss: 1.164 Test Acc: 0.425
Validation loss decreased (-0.349987 --> -0.424988).  Saving model ...
Epoch: 6 cost time: 0.367628812789917
Epoch: 6, Steps: 3 | Train Loss: 1.027 Vali Loss: 1.081 Vali Acc: 0.475 Test Loss: 1.081 Test Acc: 0.475
Validation loss decreased (-0.424988 --> -0.474989).  Saving model ...
Epoch: 7 cost time: 0.4106130599975586
Epoch: 7, Steps: 3 | Train Loss: 0.905 Vali Loss: 1.002 Vali Acc: 0.600 Test Loss: 1.002 Test Acc: 0.600
Validation loss decreased (-0.474989 --> -0.599990).  Saving model ...
Epoch: 8 cost time: 0.43398308753967285
Epoch: 8, Steps: 3 | Train Loss: 0.850 Vali Loss: 0.923 Vali Acc: 0.675 Test Loss: 0.923 Test Acc: 0.675
Validation loss decreased (-0.599990 --> -0.674991).  Saving model ...
Epoch: 9 cost time: 0.3708503246307373
Epoch: 9, Steps: 3 | Train Loss: 0.730 Vali Loss: 0.853 Vali Acc: 0.750 Test Loss: 0.853 Test Acc: 0.750
Validation loss decreased (-0.674991 --> -0.749991).  Saving model ...
Epoch: 10 cost time: 0.32981061935424805
Epoch: 10, Steps: 3 | Train Loss: 0.699 Vali Loss: 0.781 Vali Acc: 0.850 Test Loss: 0.781 Test Acc: 0.850
Validation loss decreased (-0.749991 --> -0.849992).  Saving model ...
Epoch: 11 cost time: 0.4209609031677246
Epoch: 11, Steps: 3 | Train Loss: 0.619 Vali Loss: 0.716 Vali Acc: 0.875 Test Loss: 0.716 Test Acc: 0.875
Validation loss decreased (-0.849992 --> -0.874993).  Saving model ...
Epoch: 12 cost time: 0.4259979724884033
Epoch: 12, Steps: 3 | Train Loss: 0.553 Vali Loss: 0.652 Vali Acc: 0.950 Test Loss: 0.652 Test Acc: 0.950
Validation loss decreased (-0.874993 --> -0.949993).  Saving model ...
Epoch: 13 cost time: 0.3742070198059082
Epoch: 13, Steps: 3 | Train Loss: 0.495 Vali Loss: 0.599 Vali Acc: 0.975 Test Loss: 0.599 Test Acc: 0.975
Validation loss decreased (-0.949993 --> -0.974994).  Saving model ...
Epoch: 14 cost time: 0.37896227836608887
Epoch: 14, Steps: 3 | Train Loss: 0.470 Vali Loss: 0.547 Vali Acc: 0.975 Test Loss: 0.547 Test Acc: 0.975
Validation loss decreased (-0.974994 --> -0.974995).  Saving model ...
Epoch: 15 cost time: 0.38465237617492676
Epoch: 15, Steps: 3 | Train Loss: 0.422 Vali Loss: 0.503 Vali Acc: 0.975 Test Loss: 0.503 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 16 cost time: 0.42029500007629395
Epoch: 16, Steps: 3 | Train Loss: 0.382 Vali Loss: 0.473 Vali Acc: 0.975 Test Loss: 0.473 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 17 cost time: 0.5180830955505371
Epoch: 17, Steps: 3 | Train Loss: 0.335 Vali Loss: 0.450 Vali Acc: 0.975 Test Loss: 0.450 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 18 cost time: 0.38904452323913574
Epoch: 18, Steps: 3 | Train Loss: 0.322 Vali Loss: 0.420 Vali Acc: 0.975 Test Loss: 0.420 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 19 cost time: 0.41054248809814453
Epoch: 19, Steps: 3 | Train Loss: 0.293 Vali Loss: 0.396 Vali Acc: 0.975 Test Loss: 0.396 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 20 cost time: 0.40527892112731934
Epoch: 20, Steps: 3 | Train Loss: 0.264 Vali Loss: 0.383 Vali Acc: 0.975 Test Loss: 0.383 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 21 cost time: 0.34531450271606445
Epoch: 21, Steps: 3 | Train Loss: 0.255 Vali Loss: 0.364 Vali Acc: 0.975 Test Loss: 0.364 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 22 cost time: 0.3870542049407959
Epoch: 22, Steps: 3 | Train Loss: 0.254 Vali Loss: 0.348 Vali Acc: 0.975 Test Loss: 0.348 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 23 cost time: 0.3533754348754883
Epoch: 23, Steps: 3 | Train Loss: 0.210 Vali Loss: 0.333 Vali Acc: 0.975 Test Loss: 0.333 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 24 cost time: 0.35249996185302734
Epoch: 24, Steps: 3 | Train Loss: 0.215 Vali Loss: 0.317 Vali Acc: 0.975 Test Loss: 0.317 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 25 cost time: 0.36790919303894043
Epoch: 25, Steps: 3 | Train Loss: 0.195 Vali Loss: 0.307 Vali Acc: 0.975 Test Loss: 0.307 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 26 cost time: 0.3745079040527344
Epoch: 26, Steps: 3 | Train Loss: 0.163 Vali Loss: 0.291 Vali Acc: 0.975 Test Loss: 0.291 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 27 cost time: 0.43866562843322754
Epoch: 27, Steps: 3 | Train Loss: 0.163 Vali Loss: 0.287 Vali Acc: 0.975 Test Loss: 0.287 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 28 cost time: 0.4192471504211426
Epoch: 28, Steps: 3 | Train Loss: 0.154 Vali Loss: 0.280 Vali Acc: 0.950 Test Loss: 0.280 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.3343386650085449
Epoch: 29, Steps: 3 | Train Loss: 0.156 Vali Loss: 0.273 Vali Acc: 0.950 Test Loss: 0.273 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.3952443599700928
Epoch: 30, Steps: 3 | Train Loss: 0.134 Vali Loss: 0.268 Vali Acc: 0.950 Test Loss: 0.268 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.3777899742126465
Epoch: 31, Steps: 3 | Train Loss: 0.135 Vali Loss: 0.268 Vali Acc: 0.950 Test Loss: 0.268 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.3753495216369629
Epoch: 32, Steps: 3 | Train Loss: 0.125 Vali Loss: 0.265 Vali Acc: 0.950 Test Loss: 0.265 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.4197564125061035
Epoch: 33, Steps: 3 | Train Loss: 0.132 Vali Loss: 0.262 Vali Acc: 0.950 Test Loss: 0.262 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.36302614212036133
Epoch: 34, Steps: 3 | Train Loss: 0.106 Vali Loss: 0.258 Vali Acc: 0.950 Test Loss: 0.258 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.386462926864624
Epoch: 35, Steps: 3 | Train Loss: 0.100 Vali Loss: 0.254 Vali Acc: 0.950 Test Loss: 0.254 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.36782217025756836
Epoch: 36, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.246 Vali Acc: 0.950 Test Loss: 0.246 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.3657844066619873
Epoch: 37, Steps: 3 | Train Loss: 0.093 Vali Loss: 0.245 Vali Acc: 0.950 Test Loss: 0.245 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 54180
model size : 0.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.7317464351654053
Epoch: 1, Steps: 3 | Train Loss: 1.396 Vali Loss: 1.456 Vali Acc: 0.400 Test Loss: 1.456 Test Acc: 0.400
Validation loss decreased (inf --> -0.399985).  Saving model ...
Epoch: 2 cost time: 0.41143178939819336
Epoch: 2, Steps: 3 | Train Loss: 1.279 Vali Loss: 1.422 Vali Acc: 0.400 Test Loss: 1.422 Test Acc: 0.400
Validation loss decreased (-0.399985 --> -0.399986).  Saving model ...
Epoch: 3 cost time: 0.39405298233032227
Epoch: 3, Steps: 3 | Train Loss: 1.263 Vali Loss: 1.378 Vali Acc: 0.400 Test Loss: 1.378 Test Acc: 0.400
Validation loss decreased (-0.399986 --> -0.399986).  Saving model ...
Epoch: 4 cost time: 0.4112536907196045
Epoch: 4, Steps: 3 | Train Loss: 1.193 Vali Loss: 1.317 Vali Acc: 0.375 Test Loss: 1.317 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.4719541072845459
Epoch: 5, Steps: 3 | Train Loss: 1.113 Vali Loss: 1.246 Vali Acc: 0.475 Test Loss: 1.246 Test Acc: 0.475
Validation loss decreased (-0.399986 --> -0.474988).  Saving model ...
Epoch: 6 cost time: 0.41844892501831055
Epoch: 6, Steps: 3 | Train Loss: 1.054 Vali Loss: 1.169 Vali Acc: 0.550 Test Loss: 1.169 Test Acc: 0.550
Validation loss decreased (-0.474988 --> -0.549988).  Saving model ...
Epoch: 7 cost time: 0.3990011215209961
Epoch: 7, Steps: 3 | Train Loss: 0.948 Vali Loss: 1.091 Vali Acc: 0.600 Test Loss: 1.091 Test Acc: 0.600
Validation loss decreased (-0.549988 --> -0.599989).  Saving model ...
Epoch: 8 cost time: 0.4141066074371338
Epoch: 8, Steps: 3 | Train Loss: 0.871 Vali Loss: 1.016 Vali Acc: 0.725 Test Loss: 1.016 Test Acc: 0.725
Validation loss decreased (-0.599989 --> -0.724990).  Saving model ...
Epoch: 9 cost time: 0.41980862617492676
Epoch: 9, Steps: 3 | Train Loss: 0.793 Vali Loss: 0.951 Vali Acc: 0.775 Test Loss: 0.951 Test Acc: 0.775
Validation loss decreased (-0.724990 --> -0.774990).  Saving model ...
Epoch: 10 cost time: 0.4204230308532715
Epoch: 10, Steps: 3 | Train Loss: 0.735 Vali Loss: 0.888 Vali Acc: 0.825 Test Loss: 0.888 Test Acc: 0.825
Validation loss decreased (-0.774990 --> -0.824991).  Saving model ...
Epoch: 11 cost time: 0.4608616828918457
Epoch: 11, Steps: 3 | Train Loss: 0.698 Vali Loss: 0.822 Vali Acc: 0.875 Test Loss: 0.822 Test Acc: 0.875
Validation loss decreased (-0.824991 --> -0.874992).  Saving model ...
Epoch: 12 cost time: 0.39674997329711914
Epoch: 12, Steps: 3 | Train Loss: 0.630 Vali Loss: 0.769 Vali Acc: 0.875 Test Loss: 0.769 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874992).  Saving model ...
Epoch: 13 cost time: 0.4043726921081543
Epoch: 13, Steps: 3 | Train Loss: 0.594 Vali Loss: 0.717 Vali Acc: 0.950 Test Loss: 0.717 Test Acc: 0.950
Validation loss decreased (-0.874992 --> -0.949993).  Saving model ...
Epoch: 14 cost time: 0.4119539260864258
Epoch: 14, Steps: 3 | Train Loss: 0.527 Vali Loss: 0.671 Vali Acc: 0.950 Test Loss: 0.671 Test Acc: 0.950
Validation loss decreased (-0.949993 --> -0.949993).  Saving model ...
Epoch: 15 cost time: 0.36284637451171875
Epoch: 15, Steps: 3 | Train Loss: 0.472 Vali Loss: 0.627 Vali Acc: 0.950 Test Loss: 0.627 Test Acc: 0.950
Validation loss decreased (-0.949993 --> -0.949994).  Saving model ...
Epoch: 16 cost time: 0.4052605628967285
Epoch: 16, Steps: 3 | Train Loss: 0.454 Vali Loss: 0.591 Vali Acc: 0.950 Test Loss: 0.591 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949994).  Saving model ...
Epoch: 17 cost time: 0.42209553718566895
Epoch: 17, Steps: 3 | Train Loss: 0.416 Vali Loss: 0.555 Vali Acc: 0.950 Test Loss: 0.555 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949994).  Saving model ...
Epoch: 18 cost time: 0.39598989486694336
Epoch: 18, Steps: 3 | Train Loss: 0.378 Vali Loss: 0.512 Vali Acc: 0.950 Test Loss: 0.512 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 19 cost time: 0.39825892448425293
Epoch: 19, Steps: 3 | Train Loss: 0.367 Vali Loss: 0.484 Vali Acc: 0.950 Test Loss: 0.484 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 20 cost time: 0.35041022300720215
Epoch: 20, Steps: 3 | Train Loss: 0.309 Vali Loss: 0.461 Vali Acc: 0.950 Test Loss: 0.461 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 21 cost time: 0.4571361541748047
Epoch: 21, Steps: 3 | Train Loss: 0.306 Vali Loss: 0.439 Vali Acc: 0.950 Test Loss: 0.439 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 22 cost time: 0.3593177795410156
Epoch: 22, Steps: 3 | Train Loss: 0.267 Vali Loss: 0.425 Vali Acc: 0.950 Test Loss: 0.425 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 23 cost time: 0.45631885528564453
Epoch: 23, Steps: 3 | Train Loss: 0.263 Vali Loss: 0.406 Vali Acc: 0.950 Test Loss: 0.406 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 24 cost time: 0.42357540130615234
Epoch: 24, Steps: 3 | Train Loss: 0.227 Vali Loss: 0.400 Vali Acc: 0.925 Test Loss: 0.400 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.4191927909851074
Epoch: 25, Steps: 3 | Train Loss: 0.222 Vali Loss: 0.391 Vali Acc: 0.925 Test Loss: 0.391 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.4384596347808838
Epoch: 26, Steps: 3 | Train Loss: 0.191 Vali Loss: 0.379 Vali Acc: 0.925 Test Loss: 0.379 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.3827831745147705
Epoch: 27, Steps: 3 | Train Loss: 0.194 Vali Loss: 0.375 Vali Acc: 0.925 Test Loss: 0.375 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.48370933532714844
Epoch: 28, Steps: 3 | Train Loss: 0.199 Vali Loss: 0.368 Vali Acc: 0.925 Test Loss: 0.368 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.37049293518066406
Epoch: 29, Steps: 3 | Train Loss: 0.178 Vali Loss: 0.352 Vali Acc: 0.950 Test Loss: 0.352 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 30 cost time: 0.4080331325531006
Epoch: 30, Steps: 3 | Train Loss: 0.180 Vali Loss: 0.341 Vali Acc: 0.950 Test Loss: 0.341 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 31 cost time: 0.39699506759643555
Epoch: 31, Steps: 3 | Train Loss: 0.173 Vali Loss: 0.339 Vali Acc: 0.950 Test Loss: 0.339 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 32 cost time: 0.3735971450805664
Epoch: 32, Steps: 3 | Train Loss: 0.151 Vali Loss: 0.331 Vali Acc: 0.950 Test Loss: 0.331 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 33 cost time: 0.4634547233581543
Epoch: 33, Steps: 3 | Train Loss: 0.151 Vali Loss: 0.328 Vali Acc: 0.950 Test Loss: 0.328 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 34 cost time: 0.4781837463378906
Epoch: 34, Steps: 3 | Train Loss: 0.143 Vali Loss: 0.328 Vali Acc: 0.925 Test Loss: 0.328 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.4054117202758789
Epoch: 35, Steps: 3 | Train Loss: 0.118 Vali Loss: 0.319 Vali Acc: 0.925 Test Loss: 0.319 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.41199612617492676
Epoch: 36, Steps: 3 | Train Loss: 0.109 Vali Loss: 0.305 Vali Acc: 0.950 Test Loss: 0.305 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 37 cost time: 0.3858485221862793
Epoch: 37, Steps: 3 | Train Loss: 0.133 Vali Loss: 0.302 Vali Acc: 0.950 Test Loss: 0.302 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 38 cost time: 0.4217691421508789
Epoch: 38, Steps: 3 | Train Loss: 0.109 Vali Loss: 0.294 Vali Acc: 0.950 Test Loss: 0.294 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 39 cost time: 0.3812596797943115
Epoch: 39, Steps: 3 | Train Loss: 0.099 Vali Loss: 0.290 Vali Acc: 0.950 Test Loss: 0.290 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 40 cost time: 0.48270344734191895
Epoch: 40, Steps: 3 | Train Loss: 0.104 Vali Loss: 0.288 Vali Acc: 0.925 Test Loss: 0.288 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.381303071975708
Epoch: 41, Steps: 3 | Train Loss: 0.093 Vali Loss: 0.283 Vali Acc: 0.925 Test Loss: 0.283 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.4837977886199951
Epoch: 42, Steps: 3 | Train Loss: 0.099 Vali Loss: 0.286 Vali Acc: 0.925 Test Loss: 0.286 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.3798062801361084
Epoch: 43, Steps: 3 | Train Loss: 0.091 Vali Loss: 0.285 Vali Acc: 0.925 Test Loss: 0.285 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.3538839817047119
Epoch: 44, Steps: 3 | Train Loss: 0.092 Vali Loss: 0.286 Vali Acc: 0.925 Test Loss: 0.286 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.37987327575683594
Epoch: 45, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.296 Vali Acc: 0.925 Test Loss: 0.296 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.431398868560791
Epoch: 46, Steps: 3 | Train Loss: 0.076 Vali Loss: 0.296 Vali Acc: 0.925 Test Loss: 0.296 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.42433762550354004
Epoch: 47, Steps: 3 | Train Loss: 0.076 Vali Loss: 0.292 Vali Acc: 0.925 Test Loss: 0.292 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 0.3934495449066162
Epoch: 48, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.279 Vali Acc: 0.925 Test Loss: 0.279 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 0.3736109733581543
Epoch: 49, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.266 Vali Acc: 0.925 Test Loss: 0.266 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 50404
model size : 0.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.653731346130371
Epoch: 1, Steps: 3 | Train Loss: 1.451 Vali Loss: 1.376 Vali Acc: 0.150 Test Loss: 1.376 Test Acc: 0.150
Validation loss decreased (inf --> -0.149986).  Saving model ...
Epoch: 2 cost time: 0.39397382736206055
Epoch: 2, Steps: 3 | Train Loss: 1.385 Vali Loss: 1.351 Vali Acc: 0.175 Test Loss: 1.351 Test Acc: 0.175
Validation loss decreased (-0.149986 --> -0.174986).  Saving model ...
Epoch: 3 cost time: 0.4081723690032959
Epoch: 3, Steps: 3 | Train Loss: 1.361 Vali Loss: 1.324 Vali Acc: 0.200 Test Loss: 1.324 Test Acc: 0.200
Validation loss decreased (-0.174986 --> -0.199987).  Saving model ...
Epoch: 4 cost time: 0.3709688186645508
Epoch: 4, Steps: 3 | Train Loss: 1.299 Vali Loss: 1.286 Vali Acc: 0.200 Test Loss: 1.286 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199987).  Saving model ...
Epoch: 5 cost time: 0.37194204330444336
Epoch: 5, Steps: 3 | Train Loss: 1.306 Vali Loss: 1.240 Vali Acc: 0.250 Test Loss: 1.240 Test Acc: 0.250
Validation loss decreased (-0.199987 --> -0.249988).  Saving model ...
Epoch: 6 cost time: 0.3798956871032715
Epoch: 6, Steps: 3 | Train Loss: 1.209 Vali Loss: 1.188 Vali Acc: 0.275 Test Loss: 1.188 Test Acc: 0.275
Validation loss decreased (-0.249988 --> -0.274988).  Saving model ...
Epoch: 7 cost time: 0.3722803592681885
Epoch: 7, Steps: 3 | Train Loss: 1.160 Vali Loss: 1.135 Vali Acc: 0.325 Test Loss: 1.135 Test Acc: 0.325
Validation loss decreased (-0.274988 --> -0.324989).  Saving model ...
Epoch: 8 cost time: 0.4502131938934326
Epoch: 8, Steps: 3 | Train Loss: 1.120 Vali Loss: 1.087 Vali Acc: 0.325 Test Loss: 1.087 Test Acc: 0.325
Validation loss decreased (-0.324989 --> -0.324989).  Saving model ...
Epoch: 9 cost time: 0.39745521545410156
Epoch: 9, Steps: 3 | Train Loss: 1.058 Vali Loss: 1.043 Vali Acc: 0.375 Test Loss: 1.043 Test Acc: 0.375
Validation loss decreased (-0.324989 --> -0.374990).  Saving model ...
Epoch: 10 cost time: 0.4203047752380371
Epoch: 10, Steps: 3 | Train Loss: 1.015 Vali Loss: 0.996 Vali Acc: 0.400 Test Loss: 0.996 Test Acc: 0.400
Validation loss decreased (-0.374990 --> -0.399990).  Saving model ...
Epoch: 11 cost time: 0.35646963119506836
Epoch: 11, Steps: 3 | Train Loss: 0.947 Vali Loss: 0.950 Vali Acc: 0.400 Test Loss: 0.950 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 12 cost time: 0.3794560432434082
Epoch: 12, Steps: 3 | Train Loss: 0.906 Vali Loss: 0.904 Vali Acc: 0.600 Test Loss: 0.904 Test Acc: 0.600
Validation loss decreased (-0.399990 --> -0.599991).  Saving model ...
Epoch: 13 cost time: 0.38851499557495117
Epoch: 13, Steps: 3 | Train Loss: 0.869 Vali Loss: 0.862 Vali Acc: 0.700 Test Loss: 0.862 Test Acc: 0.700
Validation loss decreased (-0.599991 --> -0.699991).  Saving model ...
Epoch: 14 cost time: 0.4139289855957031
Epoch: 14, Steps: 3 | Train Loss: 0.829 Vali Loss: 0.820 Vali Acc: 0.775 Test Loss: 0.820 Test Acc: 0.775
Validation loss decreased (-0.699991 --> -0.774992).  Saving model ...
Epoch: 15 cost time: 0.3725464344024658
Epoch: 15, Steps: 3 | Train Loss: 0.735 Vali Loss: 0.794 Vali Acc: 0.825 Test Loss: 0.794 Test Acc: 0.825
Validation loss decreased (-0.774992 --> -0.824992).  Saving model ...
Epoch: 16 cost time: 0.3844747543334961
Epoch: 16, Steps: 3 | Train Loss: 0.720 Vali Loss: 0.760 Vali Acc: 0.900 Test Loss: 0.760 Test Acc: 0.900
Validation loss decreased (-0.824992 --> -0.899992).  Saving model ...
Epoch: 17 cost time: 0.3845970630645752
Epoch: 17, Steps: 3 | Train Loss: 0.661 Vali Loss: 0.733 Vali Acc: 0.950 Test Loss: 0.733 Test Acc: 0.950
Validation loss decreased (-0.899992 --> -0.949993).  Saving model ...
Epoch: 18 cost time: 0.4147007465362549
Epoch: 18, Steps: 3 | Train Loss: 0.632 Vali Loss: 0.702 Vali Acc: 0.975 Test Loss: 0.702 Test Acc: 0.975
Validation loss decreased (-0.949993 --> -0.974993).  Saving model ...
Epoch: 19 cost time: 0.4162943363189697
Epoch: 19, Steps: 3 | Train Loss: 0.599 Vali Loss: 0.677 Vali Acc: 0.975 Test Loss: 0.677 Test Acc: 0.975
Validation loss decreased (-0.974993 --> -0.974993).  Saving model ...
Epoch: 20 cost time: 0.41993236541748047
Epoch: 20, Steps: 3 | Train Loss: 0.566 Vali Loss: 0.648 Vali Acc: 0.975 Test Loss: 0.648 Test Acc: 0.975
Validation loss decreased (-0.974993 --> -0.974994).  Saving model ...
Epoch: 21 cost time: 0.3683912754058838
Epoch: 21, Steps: 3 | Train Loss: 0.545 Vali Loss: 0.618 Vali Acc: 0.975 Test Loss: 0.618 Test Acc: 0.975
Validation loss decreased (-0.974994 --> -0.974994).  Saving model ...
Epoch: 22 cost time: 0.38042163848876953
Epoch: 22, Steps: 3 | Train Loss: 0.507 Vali Loss: 0.591 Vali Acc: 0.975 Test Loss: 0.591 Test Acc: 0.975
Validation loss decreased (-0.974994 --> -0.974994).  Saving model ...
Epoch: 23 cost time: 0.42065882682800293
Epoch: 23, Steps: 3 | Train Loss: 0.477 Vali Loss: 0.568 Vali Acc: 0.975 Test Loss: 0.568 Test Acc: 0.975
Validation loss decreased (-0.974994 --> -0.974994).  Saving model ...
Epoch: 24 cost time: 0.4676856994628906
Epoch: 24, Steps: 3 | Train Loss: 0.463 Vali Loss: 0.542 Vali Acc: 0.975 Test Loss: 0.542 Test Acc: 0.975
Validation loss decreased (-0.974994 --> -0.974995).  Saving model ...
Epoch: 25 cost time: 0.4086267948150635
Epoch: 25, Steps: 3 | Train Loss: 0.436 Vali Loss: 0.524 Vali Acc: 0.975 Test Loss: 0.524 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 26 cost time: 0.400571346282959
Epoch: 26, Steps: 3 | Train Loss: 0.419 Vali Loss: 0.502 Vali Acc: 0.975 Test Loss: 0.502 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 27 cost time: 0.3101813793182373
Epoch: 27, Steps: 3 | Train Loss: 0.376 Vali Loss: 0.483 Vali Acc: 0.975 Test Loss: 0.483 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 28 cost time: 0.363309383392334
Epoch: 28, Steps: 3 | Train Loss: 0.356 Vali Loss: 0.467 Vali Acc: 0.975 Test Loss: 0.467 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 29 cost time: 0.39023423194885254
Epoch: 29, Steps: 3 | Train Loss: 0.336 Vali Loss: 0.456 Vali Acc: 0.975 Test Loss: 0.456 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 30 cost time: 0.33298158645629883
Epoch: 30, Steps: 3 | Train Loss: 0.316 Vali Loss: 0.449 Vali Acc: 0.975 Test Loss: 0.449 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 31 cost time: 0.37960028648376465
Epoch: 31, Steps: 3 | Train Loss: 0.326 Vali Loss: 0.436 Vali Acc: 0.975 Test Loss: 0.436 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 32 cost time: 0.38445544242858887
Epoch: 32, Steps: 3 | Train Loss: 0.294 Vali Loss: 0.415 Vali Acc: 0.975 Test Loss: 0.415 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 33 cost time: 0.32714319229125977
Epoch: 33, Steps: 3 | Train Loss: 0.293 Vali Loss: 0.400 Vali Acc: 0.975 Test Loss: 0.400 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 34 cost time: 0.3382229804992676
Epoch: 34, Steps: 3 | Train Loss: 0.261 Vali Loss: 0.383 Vali Acc: 0.975 Test Loss: 0.383 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 35 cost time: 0.3594491481781006
Epoch: 35, Steps: 3 | Train Loss: 0.244 Vali Loss: 0.381 Vali Acc: 0.975 Test Loss: 0.381 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 36 cost time: 0.40252137184143066
Epoch: 36, Steps: 3 | Train Loss: 0.257 Vali Loss: 0.377 Vali Acc: 0.975 Test Loss: 0.377 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 37 cost time: 0.41372036933898926
Epoch: 37, Steps: 3 | Train Loss: 0.238 Vali Loss: 0.377 Vali Acc: 0.975 Test Loss: 0.377 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 38 cost time: 0.41606926918029785
Epoch: 38, Steps: 3 | Train Loss: 0.229 Vali Loss: 0.360 Vali Acc: 0.975 Test Loss: 0.360 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 39 cost time: 0.38358020782470703
Epoch: 39, Steps: 3 | Train Loss: 0.203 Vali Loss: 0.353 Vali Acc: 0.975 Test Loss: 0.353 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 40 cost time: 0.37572240829467773
Epoch: 40, Steps: 3 | Train Loss: 0.195 Vali Loss: 0.343 Vali Acc: 0.975 Test Loss: 0.343 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 41 cost time: 0.4010133743286133
Epoch: 41, Steps: 3 | Train Loss: 0.205 Vali Loss: 0.340 Vali Acc: 0.975 Test Loss: 0.340 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 42 cost time: 0.40818071365356445
Epoch: 42, Steps: 3 | Train Loss: 0.188 Vali Loss: 0.330 Vali Acc: 0.975 Test Loss: 0.330 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 43 cost time: 0.37427520751953125
Epoch: 43, Steps: 3 | Train Loss: 0.170 Vali Loss: 0.317 Vali Acc: 0.975 Test Loss: 0.317 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 44 cost time: 0.3666088581085205
Epoch: 44, Steps: 3 | Train Loss: 0.171 Vali Loss: 0.315 Vali Acc: 0.975 Test Loss: 0.315 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 45 cost time: 0.38690876960754395
Epoch: 45, Steps: 3 | Train Loss: 0.164 Vali Loss: 0.313 Vali Acc: 0.975 Test Loss: 0.313 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 46 cost time: 0.37059545516967773
Epoch: 46, Steps: 3 | Train Loss: 0.173 Vali Loss: 0.321 Vali Acc: 0.950 Test Loss: 0.321 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.4019041061401367
Epoch: 47, Steps: 3 | Train Loss: 0.139 Vali Loss: 0.304 Vali Acc: 0.950 Test Loss: 0.304 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.3967783451080322
Epoch: 48, Steps: 3 | Train Loss: 0.137 Vali Loss: 0.295 Vali Acc: 0.950 Test Loss: 0.295 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.4075636863708496
Epoch: 49, Steps: 3 | Train Loss: 0.115 Vali Loss: 0.282 Vali Acc: 0.950 Test Loss: 0.282 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.4161570072174072
Epoch: 50, Steps: 3 | Train Loss: 0.125 Vali Loss: 0.278 Vali Acc: 0.950 Test Loss: 0.278 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 44420
model size : 0.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps20_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.8477833271026611
Epoch: 1, Steps: 3 | Train Loss: 1.356 Vali Loss: 1.374 Vali Acc: 0.275 Test Loss: 1.374 Test Acc: 0.275
Validation loss decreased (inf --> -0.274986).  Saving model ...
Epoch: 2 cost time: 0.37940430641174316
Epoch: 2, Steps: 3 | Train Loss: 1.346 Vali Loss: 1.351 Vali Acc: 0.275 Test Loss: 1.351 Test Acc: 0.275
Validation loss decreased (-0.274986 --> -0.274986).  Saving model ...
Epoch: 3 cost time: 0.449965238571167
Epoch: 3, Steps: 3 | Train Loss: 1.272 Vali Loss: 1.328 Vali Acc: 0.300 Test Loss: 1.328 Test Acc: 0.300
Validation loss decreased (-0.274986 --> -0.299987).  Saving model ...
Epoch: 4 cost time: 0.40517616271972656
Epoch: 4, Steps: 3 | Train Loss: 1.215 Vali Loss: 1.296 Vali Acc: 0.375 Test Loss: 1.296 Test Acc: 0.375
Validation loss decreased (-0.299987 --> -0.374987).  Saving model ...
Epoch: 5 cost time: 0.342043399810791
Epoch: 5, Steps: 3 | Train Loss: 1.203 Vali Loss: 1.258 Vali Acc: 0.425 Test Loss: 1.258 Test Acc: 0.425
Validation loss decreased (-0.374987 --> -0.424987).  Saving model ...
Epoch: 6 cost time: 0.3712594509124756
Epoch: 6, Steps: 3 | Train Loss: 1.165 Vali Loss: 1.212 Vali Acc: 0.475 Test Loss: 1.212 Test Acc: 0.475
Validation loss decreased (-0.424987 --> -0.474988).  Saving model ...
Epoch: 7 cost time: 0.34769368171691895
Epoch: 7, Steps: 3 | Train Loss: 1.123 Vali Loss: 1.161 Vali Acc: 0.475 Test Loss: 1.161 Test Acc: 0.475
Validation loss decreased (-0.474988 --> -0.474988).  Saving model ...
Epoch: 8 cost time: 0.3946261405944824
Epoch: 8, Steps: 3 | Train Loss: 1.052 Vali Loss: 1.114 Vali Acc: 0.550 Test Loss: 1.114 Test Acc: 0.550
Validation loss decreased (-0.474988 --> -0.549989).  Saving model ...
Epoch: 9 cost time: 0.37026309967041016
Epoch: 9, Steps: 3 | Train Loss: 0.975 Vali Loss: 1.069 Vali Acc: 0.600 Test Loss: 1.069 Test Acc: 0.600
Validation loss decreased (-0.549989 --> -0.599989).  Saving model ...
Epoch: 10 cost time: 0.4794003963470459
Epoch: 10, Steps: 3 | Train Loss: 0.977 Vali Loss: 1.020 Vali Acc: 0.625 Test Loss: 1.020 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624990).  Saving model ...
Epoch: 11 cost time: 0.4146556854248047
Epoch: 11, Steps: 3 | Train Loss: 0.892 Vali Loss: 0.979 Vali Acc: 0.700 Test Loss: 0.979 Test Acc: 0.700
Validation loss decreased (-0.624990 --> -0.699990).  Saving model ...
Epoch: 12 cost time: 0.42559123039245605
Epoch: 12, Steps: 3 | Train Loss: 0.890 Vali Loss: 0.932 Vali Acc: 0.775 Test Loss: 0.932 Test Acc: 0.775
Validation loss decreased (-0.699990 --> -0.774991).  Saving model ...
Epoch: 13 cost time: 0.402451753616333
Epoch: 13, Steps: 3 | Train Loss: 0.820 Vali Loss: 0.892 Vali Acc: 0.875 Test Loss: 0.892 Test Acc: 0.875
Validation loss decreased (-0.774991 --> -0.874991).  Saving model ...
Epoch: 14 cost time: 0.36527252197265625
Epoch: 14, Steps: 3 | Train Loss: 0.749 Vali Loss: 0.855 Vali Acc: 0.875 Test Loss: 0.855 Test Acc: 0.875
Validation loss decreased (-0.874991 --> -0.874991).  Saving model ...
Epoch: 15 cost time: 0.3922872543334961
Epoch: 15, Steps: 3 | Train Loss: 0.711 Vali Loss: 0.820 Vali Acc: 0.900 Test Loss: 0.820 Test Acc: 0.900
Validation loss decreased (-0.874991 --> -0.899992).  Saving model ...
Epoch: 16 cost time: 0.4004840850830078
Epoch: 16, Steps: 3 | Train Loss: 0.672 Vali Loss: 0.788 Vali Acc: 0.925 Test Loss: 0.788 Test Acc: 0.925
Validation loss decreased (-0.899992 --> -0.924992).  Saving model ...
Epoch: 17 cost time: 0.4825761318206787
Epoch: 17, Steps: 3 | Train Loss: 0.626 Vali Loss: 0.762 Vali Acc: 0.925 Test Loss: 0.762 Test Acc: 0.925
Validation loss decreased (-0.924992 --> -0.924992).  Saving model ...
Epoch: 18 cost time: 0.42589449882507324
Epoch: 18, Steps: 3 | Train Loss: 0.619 Vali Loss: 0.732 Vali Acc: 0.900 Test Loss: 0.732 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.4439198970794678
Epoch: 19, Steps: 3 | Train Loss: 0.572 Vali Loss: 0.707 Vali Acc: 0.925 Test Loss: 0.707 Test Acc: 0.925
Validation loss decreased (-0.924992 --> -0.924993).  Saving model ...
Epoch: 20 cost time: 0.44790148735046387
Epoch: 20, Steps: 3 | Train Loss: 0.541 Vali Loss: 0.686 Vali Acc: 0.950 Test Loss: 0.686 Test Acc: 0.950
Validation loss decreased (-0.924993 --> -0.949993).  Saving model ...
Epoch: 21 cost time: 0.4124321937561035
Epoch: 21, Steps: 3 | Train Loss: 0.515 Vali Loss: 0.655 Vali Acc: 0.950 Test Loss: 0.655 Test Acc: 0.950
Validation loss decreased (-0.949993 --> -0.949993).  Saving model ...
Epoch: 22 cost time: 0.3957817554473877
Epoch: 22, Steps: 3 | Train Loss: 0.499 Vali Loss: 0.628 Vali Acc: 0.950 Test Loss: 0.628 Test Acc: 0.950
Validation loss decreased (-0.949993 --> -0.949994).  Saving model ...
Epoch: 23 cost time: 0.3798942565917969
Epoch: 23, Steps: 3 | Train Loss: 0.475 Vali Loss: 0.599 Vali Acc: 0.950 Test Loss: 0.599 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949994).  Saving model ...
Epoch: 24 cost time: 0.4150102138519287
Epoch: 24, Steps: 3 | Train Loss: 0.448 Vali Loss: 0.579 Vali Acc: 0.950 Test Loss: 0.579 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949994).  Saving model ...
Epoch: 25 cost time: 0.464810848236084
Epoch: 25, Steps: 3 | Train Loss: 0.440 Vali Loss: 0.561 Vali Acc: 0.950 Test Loss: 0.561 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949994).  Saving model ...
Epoch: 26 cost time: 0.3938732147216797
Epoch: 26, Steps: 3 | Train Loss: 0.389 Vali Loss: 0.551 Vali Acc: 0.950 Test Loss: 0.551 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949994).  Saving model ...
Epoch: 27 cost time: 0.44426703453063965
Epoch: 27, Steps: 3 | Train Loss: 0.401 Vali Loss: 0.527 Vali Acc: 0.950 Test Loss: 0.527 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 28 cost time: 0.3457963466644287
Epoch: 28, Steps: 3 | Train Loss: 0.368 Vali Loss: 0.512 Vali Acc: 0.950 Test Loss: 0.512 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 29 cost time: 0.34517931938171387
Epoch: 29, Steps: 3 | Train Loss: 0.373 Vali Loss: 0.494 Vali Acc: 0.950 Test Loss: 0.494 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 30 cost time: 0.327117919921875
Epoch: 30, Steps: 3 | Train Loss: 0.339 Vali Loss: 0.481 Vali Acc: 0.950 Test Loss: 0.481 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 31 cost time: 0.3555307388305664
Epoch: 31, Steps: 3 | Train Loss: 0.313 Vali Loss: 0.474 Vali Acc: 0.950 Test Loss: 0.474 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 32 cost time: 0.4214212894439697
Epoch: 32, Steps: 3 | Train Loss: 0.307 Vali Loss: 0.459 Vali Acc: 0.950 Test Loss: 0.459 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 33 cost time: 0.4343550205230713
Epoch: 33, Steps: 3 | Train Loss: 0.310 Vali Loss: 0.443 Vali Acc: 0.950 Test Loss: 0.443 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 34 cost time: 0.4075143337249756
Epoch: 34, Steps: 3 | Train Loss: 0.292 Vali Loss: 0.433 Vali Acc: 0.950 Test Loss: 0.433 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 35 cost time: 0.3681044578552246
Epoch: 35, Steps: 3 | Train Loss: 0.284 Vali Loss: 0.423 Vali Acc: 0.950 Test Loss: 0.423 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 36 cost time: 0.443375825881958
Epoch: 36, Steps: 3 | Train Loss: 0.248 Vali Loss: 0.410 Vali Acc: 0.950 Test Loss: 0.410 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 37 cost time: 0.38931703567504883
Epoch: 37, Steps: 3 | Train Loss: 0.256 Vali Loss: 0.403 Vali Acc: 0.950 Test Loss: 0.403 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 38 cost time: 0.4553680419921875
Epoch: 38, Steps: 3 | Train Loss: 0.243 Vali Loss: 0.390 Vali Acc: 0.950 Test Loss: 0.390 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 39 cost time: 0.42705297470092773
Epoch: 39, Steps: 3 | Train Loss: 0.241 Vali Loss: 0.374 Vali Acc: 0.950 Test Loss: 0.374 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 40 cost time: 0.4337797164916992
Epoch: 40, Steps: 3 | Train Loss: 0.237 Vali Loss: 0.370 Vali Acc: 0.950 Test Loss: 0.370 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 41 cost time: 0.4351046085357666
Epoch: 41, Steps: 3 | Train Loss: 0.234 Vali Loss: 0.359 Vali Acc: 0.950 Test Loss: 0.359 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 42 cost time: 0.3696253299713135
Epoch: 42, Steps: 3 | Train Loss: 0.206 Vali Loss: 0.345 Vali Acc: 0.950 Test Loss: 0.345 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 43 cost time: 0.3900933265686035
Epoch: 43, Steps: 3 | Train Loss: 0.246 Vali Loss: 0.337 Vali Acc: 0.950 Test Loss: 0.337 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 44 cost time: 0.4425039291381836
Epoch: 44, Steps: 3 | Train Loss: 0.199 Vali Loss: 0.338 Vali Acc: 0.950 Test Loss: 0.338 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.4488370418548584
Epoch: 45, Steps: 3 | Train Loss: 0.203 Vali Loss: 0.325 Vali Acc: 0.975 Test Loss: 0.325 Test Acc: 0.975
Validation loss decreased (-0.949997 --> -0.974997).  Saving model ...
Epoch: 46 cost time: 0.42843127250671387
Epoch: 46, Steps: 3 | Train Loss: 0.199 Vali Loss: 0.319 Vali Acc: 0.975 Test Loss: 0.319 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 47 cost time: 0.40610313415527344
Epoch: 47, Steps: 3 | Train Loss: 0.193 Vali Loss: 0.318 Vali Acc: 0.975 Test Loss: 0.318 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 48 cost time: 0.42423558235168457
Epoch: 48, Steps: 3 | Train Loss: 0.197 Vali Loss: 0.312 Vali Acc: 0.975 Test Loss: 0.312 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 49 cost time: 0.4077012538909912
Epoch: 49, Steps: 3 | Train Loss: 0.183 Vali Loss: 0.305 Vali Acc: 0.975 Test Loss: 0.305 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 50 cost time: 0.4190404415130615
Epoch: 50, Steps: 3 | Train Loss: 0.174 Vali Loss: 0.301 Vali Acc: 0.975 Test Loss: 0.301 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps20_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 43044
model size : 0.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps25_str13_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.5487959384918213
Epoch: 1, Steps: 3 | Train Loss: 1.535 Vali Loss: 1.455 Vali Acc: 0.150 Test Loss: 1.455 Test Acc: 0.150
Validation loss decreased (inf --> -0.149985).  Saving model ...
Epoch: 2 cost time: 0.4880483150482178
Epoch: 2, Steps: 3 | Train Loss: 1.439 Vali Loss: 1.440 Vali Acc: 0.150 Test Loss: 1.440 Test Acc: 0.150
Validation loss decreased (-0.149985 --> -0.149986).  Saving model ...
Epoch: 3 cost time: 0.4840717315673828
Epoch: 3, Steps: 3 | Train Loss: 1.444 Vali Loss: 1.427 Vali Acc: 0.150 Test Loss: 1.427 Test Acc: 0.150
Validation loss decreased (-0.149986 --> -0.149986).  Saving model ...
Epoch: 4 cost time: 0.45182085037231445
Epoch: 4, Steps: 3 | Train Loss: 1.382 Vali Loss: 1.403 Vali Acc: 0.175 Test Loss: 1.403 Test Acc: 0.175
Validation loss decreased (-0.149986 --> -0.174986).  Saving model ...
Epoch: 5 cost time: 0.43273186683654785
Epoch: 5, Steps: 3 | Train Loss: 1.383 Vali Loss: 1.374 Vali Acc: 0.225 Test Loss: 1.374 Test Acc: 0.225
Validation loss decreased (-0.174986 --> -0.224986).  Saving model ...
Epoch: 6 cost time: 0.47818565368652344
Epoch: 6, Steps: 3 | Train Loss: 1.329 Vali Loss: 1.339 Vali Acc: 0.250 Test Loss: 1.339 Test Acc: 0.250
Validation loss decreased (-0.224986 --> -0.249987).  Saving model ...
Epoch: 7 cost time: 0.44387245178222656
Epoch: 7, Steps: 3 | Train Loss: 1.255 Vali Loss: 1.298 Vali Acc: 0.250 Test Loss: 1.298 Test Acc: 0.250
Validation loss decreased (-0.249987 --> -0.249987).  Saving model ...
Epoch: 8 cost time: 0.4586029052734375
Epoch: 8, Steps: 3 | Train Loss: 1.244 Vali Loss: 1.255 Vali Acc: 0.300 Test Loss: 1.255 Test Acc: 0.300
Validation loss decreased (-0.249987 --> -0.299987).  Saving model ...
Epoch: 9 cost time: 0.46883606910705566
Epoch: 9, Steps: 3 | Train Loss: 1.175 Vali Loss: 1.211 Vali Acc: 0.325 Test Loss: 1.211 Test Acc: 0.325
Validation loss decreased (-0.299987 --> -0.324988).  Saving model ...
Epoch: 10 cost time: 0.4405074119567871
Epoch: 10, Steps: 3 | Train Loss: 1.173 Vali Loss: 1.168 Vali Acc: 0.425 Test Loss: 1.168 Test Acc: 0.425
Validation loss decreased (-0.324988 --> -0.424988).  Saving model ...
Epoch: 11 cost time: 0.45276880264282227
Epoch: 11, Steps: 3 | Train Loss: 1.070 Vali Loss: 1.125 Vali Acc: 0.500 Test Loss: 1.125 Test Acc: 0.500
Validation loss decreased (-0.424988 --> -0.499989).  Saving model ...
Epoch: 12 cost time: 0.41867542266845703
Epoch: 12, Steps: 3 | Train Loss: 1.034 Vali Loss: 1.083 Vali Acc: 0.575 Test Loss: 1.083 Test Acc: 0.575
Validation loss decreased (-0.499989 --> -0.574989).  Saving model ...
Epoch: 13 cost time: 0.46499156951904297
Epoch: 13, Steps: 3 | Train Loss: 0.981 Vali Loss: 1.045 Vali Acc: 0.675 Test Loss: 1.045 Test Acc: 0.675
Validation loss decreased (-0.574989 --> -0.674990).  Saving model ...
Epoch: 14 cost time: 0.4351332187652588
Epoch: 14, Steps: 3 | Train Loss: 0.936 Vali Loss: 1.011 Vali Acc: 0.750 Test Loss: 1.011 Test Acc: 0.750
Validation loss decreased (-0.674990 --> -0.749990).  Saving model ...
Epoch: 15 cost time: 0.47571659088134766
Epoch: 15, Steps: 3 | Train Loss: 0.911 Vali Loss: 0.971 Vali Acc: 0.750 Test Loss: 0.971 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749990).  Saving model ...
Epoch: 16 cost time: 0.4591951370239258
Epoch: 16, Steps: 3 | Train Loss: 0.874 Vali Loss: 0.940 Vali Acc: 0.775 Test Loss: 0.940 Test Acc: 0.775
Validation loss decreased (-0.749990 --> -0.774991).  Saving model ...
Epoch: 17 cost time: 0.426633358001709
Epoch: 17, Steps: 3 | Train Loss: 0.812 Vali Loss: 0.908 Vali Acc: 0.775 Test Loss: 0.908 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 18 cost time: 0.4462888240814209
Epoch: 18, Steps: 3 | Train Loss: 0.855 Vali Loss: 0.871 Vali Acc: 0.800 Test Loss: 0.871 Test Acc: 0.800
Validation loss decreased (-0.774991 --> -0.799991).  Saving model ...
Epoch: 19 cost time: 0.4724996089935303
Epoch: 19, Steps: 3 | Train Loss: 0.728 Vali Loss: 0.846 Vali Acc: 0.850 Test Loss: 0.846 Test Acc: 0.850
Validation loss decreased (-0.799991 --> -0.849992).  Saving model ...
Epoch: 20 cost time: 0.4451282024383545
Epoch: 20, Steps: 3 | Train Loss: 0.727 Vali Loss: 0.819 Vali Acc: 0.900 Test Loss: 0.819 Test Acc: 0.900
Validation loss decreased (-0.849992 --> -0.899992).  Saving model ...
Epoch: 21 cost time: 0.4336099624633789
Epoch: 21, Steps: 3 | Train Loss: 0.687 Vali Loss: 0.789 Vali Acc: 0.900 Test Loss: 0.789 Test Acc: 0.900
Validation loss decreased (-0.899992 --> -0.899992).  Saving model ...
Epoch: 22 cost time: 0.456592321395874
Epoch: 22, Steps: 3 | Train Loss: 0.664 Vali Loss: 0.763 Vali Acc: 0.925 Test Loss: 0.763 Test Acc: 0.925
Validation loss decreased (-0.899992 --> -0.924992).  Saving model ...
Epoch: 23 cost time: 0.4057736396789551
Epoch: 23, Steps: 3 | Train Loss: 0.629 Vali Loss: 0.740 Vali Acc: 0.925 Test Loss: 0.740 Test Acc: 0.925
Validation loss decreased (-0.924992 --> -0.924993).  Saving model ...
Epoch: 24 cost time: 0.4013347625732422
Epoch: 24, Steps: 3 | Train Loss: 0.614 Vali Loss: 0.712 Vali Acc: 0.925 Test Loss: 0.712 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924993).  Saving model ...
Epoch: 25 cost time: 0.49823522567749023
Epoch: 25, Steps: 3 | Train Loss: 0.618 Vali Loss: 0.686 Vali Acc: 0.925 Test Loss: 0.686 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924993).  Saving model ...
Epoch: 26 cost time: 0.4605998992919922
Epoch: 26, Steps: 3 | Train Loss: 0.559 Vali Loss: 0.666 Vali Acc: 0.925 Test Loss: 0.666 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924993).  Saving model ...
Epoch: 27 cost time: 0.42960357666015625
Epoch: 27, Steps: 3 | Train Loss: 0.546 Vali Loss: 0.641 Vali Acc: 0.900 Test Loss: 0.641 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.45745229721069336
Epoch: 28, Steps: 3 | Train Loss: 0.512 Vali Loss: 0.620 Vali Acc: 0.925 Test Loss: 0.620 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924994).  Saving model ...
Epoch: 29 cost time: 0.48824286460876465
Epoch: 29, Steps: 3 | Train Loss: 0.497 Vali Loss: 0.608 Vali Acc: 0.925 Test Loss: 0.608 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 30 cost time: 0.3945472240447998
Epoch: 30, Steps: 3 | Train Loss: 0.472 Vali Loss: 0.595 Vali Acc: 0.900 Test Loss: 0.595 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.4018235206604004
Epoch: 31, Steps: 3 | Train Loss: 0.489 Vali Loss: 0.569 Vali Acc: 0.925 Test Loss: 0.569 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 32 cost time: 0.4236600399017334
Epoch: 32, Steps: 3 | Train Loss: 0.469 Vali Loss: 0.550 Vali Acc: 0.925 Test Loss: 0.550 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 33 cost time: 0.4853935241699219
Epoch: 33, Steps: 3 | Train Loss: 0.414 Vali Loss: 0.531 Vali Acc: 0.925 Test Loss: 0.531 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 34 cost time: 0.5057728290557861
Epoch: 34, Steps: 3 | Train Loss: 0.396 Vali Loss: 0.521 Vali Acc: 0.925 Test Loss: 0.521 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 35 cost time: 0.44765496253967285
Epoch: 35, Steps: 3 | Train Loss: 0.389 Vali Loss: 0.511 Vali Acc: 0.925 Test Loss: 0.511 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 36 cost time: 0.3938765525817871
Epoch: 36, Steps: 3 | Train Loss: 0.381 Vali Loss: 0.495 Vali Acc: 0.925 Test Loss: 0.495 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 37 cost time: 0.37442827224731445
Epoch: 37, Steps: 3 | Train Loss: 0.358 Vali Loss: 0.490 Vali Acc: 0.900 Test Loss: 0.490 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.43169116973876953
Epoch: 38, Steps: 3 | Train Loss: 0.360 Vali Loss: 0.475 Vali Acc: 0.900 Test Loss: 0.475 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.4139420986175537
Epoch: 39, Steps: 3 | Train Loss: 0.327 Vali Loss: 0.469 Vali Acc: 0.900 Test Loss: 0.469 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.4020259380340576
Epoch: 40, Steps: 3 | Train Loss: 0.299 Vali Loss: 0.447 Vali Acc: 0.900 Test Loss: 0.447 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.3673214912414551
Epoch: 41, Steps: 3 | Train Loss: 0.313 Vali Loss: 0.429 Vali Acc: 0.900 Test Loss: 0.429 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.41567277908325195
Epoch: 42, Steps: 3 | Train Loss: 0.292 Vali Loss: 0.425 Vali Acc: 0.900 Test Loss: 0.425 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.39255404472351074
Epoch: 43, Steps: 3 | Train Loss: 0.310 Vali Loss: 0.414 Vali Acc: 0.900 Test Loss: 0.414 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.4706242084503174
Epoch: 44, Steps: 3 | Train Loss: 0.268 Vali Loss: 0.397 Vali Acc: 0.900 Test Loss: 0.397 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.4559195041656494
Epoch: 45, Steps: 3 | Train Loss: 0.263 Vali Loss: 0.386 Vali Acc: 0.900 Test Loss: 0.386 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 0.4544644355773926
Epoch: 46, Steps: 3 | Train Loss: 0.277 Vali Loss: 0.374 Vali Acc: 0.925 Test Loss: 0.374 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 47 cost time: 0.3543229103088379
Epoch: 47, Steps: 3 | Train Loss: 0.250 Vali Loss: 0.371 Vali Acc: 0.925 Test Loss: 0.371 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 48 cost time: 0.4547574520111084
Epoch: 48, Steps: 3 | Train Loss: 0.224 Vali Loss: 0.366 Vali Acc: 0.925 Test Loss: 0.366 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 49 cost time: 0.426069974899292
Epoch: 49, Steps: 3 | Train Loss: 0.235 Vali Loss: 0.365 Vali Acc: 0.925 Test Loss: 0.365 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 50 cost time: 0.44196462631225586
Epoch: 50, Steps: 3 | Train Loss: 0.246 Vali Loss: 0.358 Vali Acc: 0.925 Test Loss: 0.358 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps25_str13_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 40900
model size : 0.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.6291027069091797
Epoch: 1, Steps: 3 | Train Loss: 1.373 Vali Loss: 1.386 Vali Acc: 0.200 Test Loss: 1.386 Test Acc: 0.200
Validation loss decreased (inf --> -0.199986).  Saving model ...
Epoch: 2 cost time: 0.42965126037597656
Epoch: 2, Steps: 3 | Train Loss: 1.358 Vali Loss: 1.378 Vali Acc: 0.225 Test Loss: 1.378 Test Acc: 0.225
Validation loss decreased (-0.199986 --> -0.224986).  Saving model ...
Epoch: 3 cost time: 0.4882042407989502
Epoch: 3, Steps: 3 | Train Loss: 1.306 Vali Loss: 1.364 Vali Acc: 0.200 Test Loss: 1.364 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.4393606185913086
Epoch: 4, Steps: 3 | Train Loss: 1.242 Vali Loss: 1.335 Vali Acc: 0.550 Test Loss: 1.335 Test Acc: 0.550
Validation loss decreased (-0.224986 --> -0.549987).  Saving model ...
Epoch: 5 cost time: 0.49501538276672363
Epoch: 5, Steps: 3 | Train Loss: 1.153 Vali Loss: 1.297 Vali Acc: 0.550 Test Loss: 1.297 Test Acc: 0.550
Validation loss decreased (-0.549987 --> -0.549987).  Saving model ...
Epoch: 6 cost time: 0.43066906929016113
Epoch: 6, Steps: 3 | Train Loss: 1.074 Vali Loss: 1.238 Vali Acc: 0.650 Test Loss: 1.238 Test Acc: 0.650
Validation loss decreased (-0.549987 --> -0.649988).  Saving model ...
Epoch: 7 cost time: 0.44885921478271484
Epoch: 7, Steps: 3 | Train Loss: 0.984 Vali Loss: 1.178 Vali Acc: 0.675 Test Loss: 1.178 Test Acc: 0.675
Validation loss decreased (-0.649988 --> -0.674988).  Saving model ...
Epoch: 8 cost time: 0.426135778427124
Epoch: 8, Steps: 3 | Train Loss: 0.889 Vali Loss: 1.103 Vali Acc: 0.675 Test Loss: 1.103 Test Acc: 0.675
Validation loss decreased (-0.674988 --> -0.674989).  Saving model ...
Epoch: 9 cost time: 0.5329701900482178
Epoch: 9, Steps: 3 | Train Loss: 0.800 Vali Loss: 1.021 Vali Acc: 0.700 Test Loss: 1.021 Test Acc: 0.700
Validation loss decreased (-0.674989 --> -0.699990).  Saving model ...
Epoch: 10 cost time: 0.5214452743530273
Epoch: 10, Steps: 3 | Train Loss: 0.713 Vali Loss: 0.928 Vali Acc: 0.900 Test Loss: 0.928 Test Acc: 0.900
Validation loss decreased (-0.699990 --> -0.899991).  Saving model ...
Epoch: 11 cost time: 0.432342529296875
Epoch: 11, Steps: 3 | Train Loss: 0.645 Vali Loss: 0.841 Vali Acc: 0.900 Test Loss: 0.841 Test Acc: 0.900
Validation loss decreased (-0.899991 --> -0.899992).  Saving model ...
Epoch: 12 cost time: 0.42855358123779297
Epoch: 12, Steps: 3 | Train Loss: 0.571 Vali Loss: 0.775 Vali Acc: 0.850 Test Loss: 0.775 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5082919597625732
Epoch: 13, Steps: 3 | Train Loss: 0.504 Vali Loss: 0.711 Vali Acc: 0.850 Test Loss: 0.711 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.4273800849914551
Epoch: 14, Steps: 3 | Train Loss: 0.461 Vali Loss: 0.649 Vali Acc: 0.825 Test Loss: 0.649 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.42693114280700684
Epoch: 15, Steps: 3 | Train Loss: 0.404 Vali Loss: 0.606 Vali Acc: 0.900 Test Loss: 0.606 Test Acc: 0.900
Validation loss decreased (-0.899992 --> -0.899994).  Saving model ...
Epoch: 16 cost time: 0.541053056716919
Epoch: 16, Steps: 3 | Train Loss: 0.365 Vali Loss: 0.551 Vali Acc: 0.900 Test Loss: 0.551 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 17 cost time: 0.5160622596740723
Epoch: 17, Steps: 3 | Train Loss: 0.334 Vali Loss: 0.491 Vali Acc: 0.900 Test Loss: 0.491 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 18 cost time: 0.465557336807251
Epoch: 18, Steps: 3 | Train Loss: 0.332 Vali Loss: 0.444 Vali Acc: 0.925 Test Loss: 0.444 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924996).  Saving model ...
Epoch: 19 cost time: 0.45003366470336914
Epoch: 19, Steps: 3 | Train Loss: 0.299 Vali Loss: 0.399 Vali Acc: 0.950 Test Loss: 0.399 Test Acc: 0.950
Validation loss decreased (-0.924996 --> -0.949996).  Saving model ...
Epoch: 20 cost time: 0.4869565963745117
Epoch: 20, Steps: 3 | Train Loss: 0.258 Vali Loss: 0.373 Vali Acc: 0.950 Test Loss: 0.373 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 21 cost time: 0.4742720127105713
Epoch: 21, Steps: 3 | Train Loss: 0.224 Vali Loss: 0.344 Vali Acc: 0.950 Test Loss: 0.344 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 22 cost time: 0.5776870250701904
Epoch: 22, Steps: 3 | Train Loss: 0.223 Vali Loss: 0.321 Vali Acc: 0.950 Test Loss: 0.321 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 23 cost time: 0.44823122024536133
Epoch: 23, Steps: 3 | Train Loss: 0.210 Vali Loss: 0.302 Vali Acc: 0.950 Test Loss: 0.302 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 24 cost time: 0.445955753326416
Epoch: 24, Steps: 3 | Train Loss: 0.185 Vali Loss: 0.284 Vali Acc: 0.975 Test Loss: 0.284 Test Acc: 0.975
Validation loss decreased (-0.949997 --> -0.974997).  Saving model ...
Epoch: 25 cost time: 0.5156214237213135
Epoch: 25, Steps: 3 | Train Loss: 0.181 Vali Loss: 0.269 Vali Acc: 0.975 Test Loss: 0.269 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 26 cost time: 0.4748084545135498
Epoch: 26, Steps: 3 | Train Loss: 0.167 Vali Loss: 0.250 Vali Acc: 0.975 Test Loss: 0.250 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 27 cost time: 0.5322360992431641
Epoch: 27, Steps: 3 | Train Loss: 0.146 Vali Loss: 0.231 Vali Acc: 0.975 Test Loss: 0.231 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 28 cost time: 0.4529719352722168
Epoch: 28, Steps: 3 | Train Loss: 0.125 Vali Loss: 0.220 Vali Acc: 0.975 Test Loss: 0.220 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 29 cost time: 0.49247121810913086
Epoch: 29, Steps: 3 | Train Loss: 0.112 Vali Loss: 0.217 Vali Acc: 0.975 Test Loss: 0.217 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 30 cost time: 0.45934605598449707
Epoch: 30, Steps: 3 | Train Loss: 0.104 Vali Loss: 0.213 Vali Acc: 0.975 Test Loss: 0.213 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 31 cost time: 0.45734715461730957
Epoch: 31, Steps: 3 | Train Loss: 0.092 Vali Loss: 0.206 Vali Acc: 0.975 Test Loss: 0.206 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 32 cost time: 0.43514513969421387
Epoch: 32, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.194 Vali Acc: 0.975 Test Loss: 0.194 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 33 cost time: 0.4726741313934326
Epoch: 33, Steps: 3 | Train Loss: 0.083 Vali Loss: 0.185 Vali Acc: 0.950 Test Loss: 0.185 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.531153678894043
Epoch: 34, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.184 Vali Acc: 0.950 Test Loss: 0.184 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.4461193084716797
Epoch: 35, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.181 Vali Acc: 0.950 Test Loss: 0.181 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.4281454086303711
Epoch: 36, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.181 Vali Acc: 0.950 Test Loss: 0.181 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.4253354072570801
Epoch: 37, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.180 Vali Acc: 0.950 Test Loss: 0.180 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.5111520290374756
Epoch: 38, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.169 Vali Acc: 0.950 Test Loss: 0.169 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.5568850040435791
Epoch: 39, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.173 Vali Acc: 0.950 Test Loss: 0.173 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.4725611209869385
Epoch: 40, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.173 Vali Acc: 0.950 Test Loss: 0.173 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.4750819206237793
Epoch: 41, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.174 Vali Acc: 0.950 Test Loss: 0.174 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.4873785972595215
Epoch: 42, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.182 Vali Acc: 0.950 Test Loss: 0.182 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 370564
model size : 1.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.7052974700927734
Epoch: 1, Steps: 3 | Train Loss: 1.329 Vali Loss: 1.347 Vali Acc: 0.300 Test Loss: 1.347 Test Acc: 0.300
Validation loss decreased (inf --> -0.299987).  Saving model ...
Epoch: 2 cost time: 0.45317983627319336
Epoch: 2, Steps: 3 | Train Loss: 1.306 Vali Loss: 1.331 Vali Acc: 0.300 Test Loss: 1.331 Test Acc: 0.300
Validation loss decreased (-0.299987 --> -0.299987).  Saving model ...
Epoch: 3 cost time: 0.4302184581756592
Epoch: 3, Steps: 3 | Train Loss: 1.256 Vali Loss: 1.307 Vali Acc: 0.425 Test Loss: 1.307 Test Acc: 0.425
Validation loss decreased (-0.299987 --> -0.424987).  Saving model ...
Epoch: 4 cost time: 0.4400203227996826
Epoch: 4, Steps: 3 | Train Loss: 1.221 Vali Loss: 1.272 Vali Acc: 0.750 Test Loss: 1.272 Test Acc: 0.750
Validation loss decreased (-0.424987 --> -0.749987).  Saving model ...
Epoch: 5 cost time: 0.4553029537200928
Epoch: 5, Steps: 3 | Train Loss: 1.110 Vali Loss: 1.229 Vali Acc: 0.650 Test Loss: 1.229 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.44301414489746094
Epoch: 6, Steps: 3 | Train Loss: 1.059 Vali Loss: 1.172 Vali Acc: 0.625 Test Loss: 1.172 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.49420857429504395
Epoch: 7, Steps: 3 | Train Loss: 1.002 Vali Loss: 1.113 Vali Acc: 0.675 Test Loss: 1.113 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.41980910301208496
Epoch: 8, Steps: 3 | Train Loss: 0.897 Vali Loss: 1.050 Vali Acc: 0.750 Test Loss: 1.050 Test Acc: 0.750
Validation loss decreased (-0.749987 --> -0.749989).  Saving model ...
Epoch: 9 cost time: 0.42523694038391113
Epoch: 9, Steps: 3 | Train Loss: 0.847 Vali Loss: 0.980 Vali Acc: 0.775 Test Loss: 0.980 Test Acc: 0.775
Validation loss decreased (-0.749989 --> -0.774990).  Saving model ...
Epoch: 10 cost time: 0.38931918144226074
Epoch: 10, Steps: 3 | Train Loss: 0.739 Vali Loss: 0.907 Vali Acc: 0.775 Test Loss: 0.907 Test Acc: 0.775
Validation loss decreased (-0.774990 --> -0.774991).  Saving model ...
Epoch: 11 cost time: 0.4611668586730957
Epoch: 11, Steps: 3 | Train Loss: 0.681 Vali Loss: 0.830 Vali Acc: 0.800 Test Loss: 0.830 Test Acc: 0.800
Validation loss decreased (-0.774991 --> -0.799992).  Saving model ...
Epoch: 12 cost time: 0.3870563507080078
Epoch: 12, Steps: 3 | Train Loss: 0.591 Vali Loss: 0.761 Vali Acc: 0.825 Test Loss: 0.761 Test Acc: 0.825
Validation loss decreased (-0.799992 --> -0.824992).  Saving model ...
Epoch: 13 cost time: 0.41253209114074707
Epoch: 13, Steps: 3 | Train Loss: 0.566 Vali Loss: 0.705 Vali Acc: 0.825 Test Loss: 0.705 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824993).  Saving model ...
Epoch: 14 cost time: 0.4067094326019287
Epoch: 14, Steps: 3 | Train Loss: 0.496 Vali Loss: 0.638 Vali Acc: 0.850 Test Loss: 0.638 Test Acc: 0.850
Validation loss decreased (-0.824993 --> -0.849994).  Saving model ...
Epoch: 15 cost time: 0.3861117362976074
Epoch: 15, Steps: 3 | Train Loss: 0.440 Vali Loss: 0.586 Vali Acc: 0.925 Test Loss: 0.586 Test Acc: 0.925
Validation loss decreased (-0.849994 --> -0.924994).  Saving model ...
Epoch: 16 cost time: 0.47011590003967285
Epoch: 16, Steps: 3 | Train Loss: 0.418 Vali Loss: 0.528 Vali Acc: 0.925 Test Loss: 0.528 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 17 cost time: 0.44743895530700684
Epoch: 17, Steps: 3 | Train Loss: 0.360 Vali Loss: 0.492 Vali Acc: 0.925 Test Loss: 0.492 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 18 cost time: 0.3887813091278076
Epoch: 18, Steps: 3 | Train Loss: 0.332 Vali Loss: 0.460 Vali Acc: 0.900 Test Loss: 0.460 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.4364964962005615
Epoch: 19, Steps: 3 | Train Loss: 0.306 Vali Loss: 0.431 Vali Acc: 0.875 Test Loss: 0.431 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.3894515037536621
Epoch: 20, Steps: 3 | Train Loss: 0.315 Vali Loss: 0.402 Vali Acc: 0.875 Test Loss: 0.402 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.4265275001525879
Epoch: 21, Steps: 3 | Train Loss: 0.262 Vali Loss: 0.378 Vali Acc: 0.925 Test Loss: 0.378 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 22 cost time: 0.5150651931762695
Epoch: 22, Steps: 3 | Train Loss: 0.240 Vali Loss: 0.350 Vali Acc: 0.950 Test Loss: 0.350 Test Acc: 0.950
Validation loss decreased (-0.924996 --> -0.949997).  Saving model ...
Epoch: 23 cost time: 0.44112515449523926
Epoch: 23, Steps: 3 | Train Loss: 0.235 Vali Loss: 0.332 Vali Acc: 0.950 Test Loss: 0.332 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 24 cost time: 0.423403263092041
Epoch: 24, Steps: 3 | Train Loss: 0.217 Vali Loss: 0.308 Vali Acc: 0.950 Test Loss: 0.308 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 25 cost time: 0.43241238594055176
Epoch: 25, Steps: 3 | Train Loss: 0.208 Vali Loss: 0.289 Vali Acc: 0.950 Test Loss: 0.289 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 26 cost time: 0.43975138664245605
Epoch: 26, Steps: 3 | Train Loss: 0.192 Vali Loss: 0.272 Vali Acc: 0.950 Test Loss: 0.272 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 27 cost time: 0.4226973056793213
Epoch: 27, Steps: 3 | Train Loss: 0.175 Vali Loss: 0.256 Vali Acc: 0.950 Test Loss: 0.256 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 28 cost time: 0.42505645751953125
Epoch: 28, Steps: 3 | Train Loss: 0.167 Vali Loss: 0.245 Vali Acc: 0.950 Test Loss: 0.245 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 29 cost time: 0.42798471450805664
Epoch: 29, Steps: 3 | Train Loss: 0.147 Vali Loss: 0.228 Vali Acc: 0.950 Test Loss: 0.228 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 30 cost time: 0.39724087715148926
Epoch: 30, Steps: 3 | Train Loss: 0.139 Vali Loss: 0.218 Vali Acc: 0.950 Test Loss: 0.218 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 31 cost time: 0.4799160957336426
Epoch: 31, Steps: 3 | Train Loss: 0.126 Vali Loss: 0.210 Vali Acc: 0.950 Test Loss: 0.210 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 32 cost time: 0.482619047164917
Epoch: 32, Steps: 3 | Train Loss: 0.115 Vali Loss: 0.204 Vali Acc: 0.950 Test Loss: 0.204 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 33 cost time: 0.39519429206848145
Epoch: 33, Steps: 3 | Train Loss: 0.104 Vali Loss: 0.198 Vali Acc: 0.950 Test Loss: 0.198 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 34 cost time: 0.40140581130981445
Epoch: 34, Steps: 3 | Train Loss: 0.097 Vali Loss: 0.186 Vali Acc: 0.950 Test Loss: 0.186 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 35 cost time: 0.4902305603027344
Epoch: 35, Steps: 3 | Train Loss: 0.081 Vali Loss: 0.181 Vali Acc: 0.950 Test Loss: 0.181 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 36 cost time: 0.432650089263916
Epoch: 36, Steps: 3 | Train Loss: 0.068 Vali Loss: 0.172 Vali Acc: 0.950 Test Loss: 0.172 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 37 cost time: 0.488741397857666
Epoch: 37, Steps: 3 | Train Loss: 0.063 Vali Loss: 0.166 Vali Acc: 0.950 Test Loss: 0.166 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 38 cost time: 0.44144535064697266
Epoch: 38, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.154 Vali Acc: 0.950 Test Loss: 0.154 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 39 cost time: 0.390366792678833
Epoch: 39, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.146 Vali Acc: 0.950 Test Loss: 0.146 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949999).  Saving model ...
Epoch: 40 cost time: 0.42243289947509766
Epoch: 40, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.139 Vali Acc: 0.950 Test Loss: 0.139 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 41 cost time: 0.4199388027191162
Epoch: 41, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.138 Vali Acc: 0.950 Test Loss: 0.138 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 42 cost time: 0.42766833305358887
Epoch: 42, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.134 Vali Acc: 0.950 Test Loss: 0.134 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 43 cost time: 0.4148542881011963
Epoch: 43, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.134 Vali Acc: 0.950 Test Loss: 0.134 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 44 cost time: 0.3955504894256592
Epoch: 44, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.131 Vali Acc: 0.950 Test Loss: 0.131 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 45 cost time: 0.43921947479248047
Epoch: 45, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.130 Vali Acc: 0.950 Test Loss: 0.130 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 46 cost time: 0.4162170886993408
Epoch: 46, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.130 Vali Acc: 0.950 Test Loss: 0.130 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 47 cost time: 0.4120800495147705
Epoch: 47, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.127 Vali Acc: 0.950 Test Loss: 0.127 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 48 cost time: 0.43839144706726074
Epoch: 48, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.124 Vali Acc: 0.950 Test Loss: 0.124 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 49 cost time: 0.41916489601135254
Epoch: 49, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.123 Vali Acc: 0.950 Test Loss: 0.123 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
Epoch: 50 cost time: 0.4065065383911133
Epoch: 50, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.118 Vali Acc: 0.950 Test Loss: 0.118 Test Acc: 0.950
Validation loss decreased (-0.949999 --> -0.949999).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 358340
model size : 1.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.7418322563171387
Epoch: 1, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.389 Vali Acc: 0.375 Test Loss: 1.389 Test Acc: 0.375
Validation loss decreased (inf --> -0.374986).  Saving model ...
Epoch: 2 cost time: 0.42289304733276367
Epoch: 2, Steps: 3 | Train Loss: 1.377 Vali Loss: 1.379 Vali Acc: 0.325 Test Loss: 1.379 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.42143940925598145
Epoch: 3, Steps: 3 | Train Loss: 1.322 Vali Loss: 1.366 Vali Acc: 0.450 Test Loss: 1.366 Test Acc: 0.450
Validation loss decreased (-0.374986 --> -0.449986).  Saving model ...
Epoch: 4 cost time: 0.602313756942749
Epoch: 4, Steps: 3 | Train Loss: 1.298 Vali Loss: 1.343 Vali Acc: 0.500 Test Loss: 1.343 Test Acc: 0.500
Validation loss decreased (-0.449986 --> -0.499987).  Saving model ...
Epoch: 5 cost time: 0.42186927795410156
Epoch: 5, Steps: 3 | Train Loss: 1.235 Vali Loss: 1.310 Vali Acc: 0.625 Test Loss: 1.310 Test Acc: 0.625
Validation loss decreased (-0.499987 --> -0.624987).  Saving model ...
Epoch: 6 cost time: 0.42972564697265625
Epoch: 6, Steps: 3 | Train Loss: 1.172 Vali Loss: 1.269 Vali Acc: 0.550 Test Loss: 1.269 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.4788517951965332
Epoch: 7, Steps: 3 | Train Loss: 1.089 Vali Loss: 1.216 Vali Acc: 0.575 Test Loss: 1.216 Test Acc: 0.575
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.4254157543182373
Epoch: 8, Steps: 3 | Train Loss: 1.031 Vali Loss: 1.164 Vali Acc: 0.600 Test Loss: 1.164 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.45148134231567383
Epoch: 9, Steps: 3 | Train Loss: 0.926 Vali Loss: 1.116 Vali Acc: 0.600 Test Loss: 1.116 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.44174957275390625
Epoch: 10, Steps: 3 | Train Loss: 0.880 Vali Loss: 1.053 Vali Acc: 0.600 Test Loss: 1.053 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.45729732513427734
Epoch: 11, Steps: 3 | Train Loss: 0.784 Vali Loss: 0.992 Vali Acc: 0.575 Test Loss: 0.992 Test Acc: 0.575
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.43526482582092285
Epoch: 12, Steps: 3 | Train Loss: 0.733 Vali Loss: 0.933 Vali Acc: 0.700 Test Loss: 0.933 Test Acc: 0.700
Validation loss decreased (-0.624987 --> -0.699991).  Saving model ...
Epoch: 13 cost time: 0.4856698513031006
Epoch: 13, Steps: 3 | Train Loss: 0.658 Vali Loss: 0.879 Vali Acc: 0.725 Test Loss: 0.879 Test Acc: 0.725
Validation loss decreased (-0.699991 --> -0.724991).  Saving model ...
Epoch: 14 cost time: 0.41472840309143066
Epoch: 14, Steps: 3 | Train Loss: 0.632 Vali Loss: 0.824 Vali Acc: 0.825 Test Loss: 0.824 Test Acc: 0.825
Validation loss decreased (-0.724991 --> -0.824992).  Saving model ...
Epoch: 15 cost time: 0.41967105865478516
Epoch: 15, Steps: 3 | Train Loss: 0.570 Vali Loss: 0.775 Vali Acc: 0.825 Test Loss: 0.775 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 16 cost time: 0.41109395027160645
Epoch: 16, Steps: 3 | Train Loss: 0.508 Vali Loss: 0.729 Vali Acc: 0.800 Test Loss: 0.729 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.41909313201904297
Epoch: 17, Steps: 3 | Train Loss: 0.480 Vali Loss: 0.692 Vali Acc: 0.775 Test Loss: 0.692 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.42624402046203613
Epoch: 18, Steps: 3 | Train Loss: 0.459 Vali Loss: 0.638 Vali Acc: 0.775 Test Loss: 0.638 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.4461970329284668
Epoch: 19, Steps: 3 | Train Loss: 0.413 Vali Loss: 0.596 Vali Acc: 0.775 Test Loss: 0.596 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.4622368812561035
Epoch: 20, Steps: 3 | Train Loss: 0.406 Vali Loss: 0.558 Vali Acc: 0.825 Test Loss: 0.558 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824994).  Saving model ...
Epoch: 21 cost time: 0.45230793952941895
Epoch: 21, Steps: 3 | Train Loss: 0.356 Vali Loss: 0.530 Vali Acc: 0.825 Test Loss: 0.530 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824995).  Saving model ...
Epoch: 22 cost time: 0.42276501655578613
Epoch: 22, Steps: 3 | Train Loss: 0.331 Vali Loss: 0.497 Vali Acc: 0.850 Test Loss: 0.497 Test Acc: 0.850
Validation loss decreased (-0.824995 --> -0.849995).  Saving model ...
Epoch: 23 cost time: 0.43380308151245117
Epoch: 23, Steps: 3 | Train Loss: 0.321 Vali Loss: 0.465 Vali Acc: 0.850 Test Loss: 0.465 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 24 cost time: 0.4424271583557129
Epoch: 24, Steps: 3 | Train Loss: 0.309 Vali Loss: 0.452 Vali Acc: 0.850 Test Loss: 0.452 Test Acc: 0.850
Validation loss decreased (-0.849995 --> -0.849995).  Saving model ...
Epoch: 25 cost time: 0.4174976348876953
Epoch: 25, Steps: 3 | Train Loss: 0.285 Vali Loss: 0.432 Vali Acc: 0.900 Test Loss: 0.432 Test Acc: 0.900
Validation loss decreased (-0.849995 --> -0.899996).  Saving model ...
Epoch: 26 cost time: 0.4191403388977051
Epoch: 26, Steps: 3 | Train Loss: 0.253 Vali Loss: 0.411 Vali Acc: 0.900 Test Loss: 0.411 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 27 cost time: 0.4804246425628662
Epoch: 27, Steps: 3 | Train Loss: 0.251 Vali Loss: 0.386 Vali Acc: 0.925 Test Loss: 0.386 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924996).  Saving model ...
Epoch: 28 cost time: 0.4253997802734375
Epoch: 28, Steps: 3 | Train Loss: 0.218 Vali Loss: 0.366 Vali Acc: 0.925 Test Loss: 0.366 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 29 cost time: 0.4385819435119629
Epoch: 29, Steps: 3 | Train Loss: 0.208 Vali Loss: 0.362 Vali Acc: 0.925 Test Loss: 0.362 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 30 cost time: 0.4461338520050049
Epoch: 30, Steps: 3 | Train Loss: 0.208 Vali Loss: 0.350 Vali Acc: 0.925 Test Loss: 0.350 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924997).  Saving model ...
Epoch: 31 cost time: 0.40871691703796387
Epoch: 31, Steps: 3 | Train Loss: 0.175 Vali Loss: 0.326 Vali Acc: 0.925 Test Loss: 0.326 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 32 cost time: 0.4815659523010254
Epoch: 32, Steps: 3 | Train Loss: 0.177 Vali Loss: 0.304 Vali Acc: 0.925 Test Loss: 0.304 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 33 cost time: 0.44513392448425293
Epoch: 33, Steps: 3 | Train Loss: 0.171 Vali Loss: 0.294 Vali Acc: 0.925 Test Loss: 0.294 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 34 cost time: 0.43680262565612793
Epoch: 34, Steps: 3 | Train Loss: 0.156 Vali Loss: 0.284 Vali Acc: 0.925 Test Loss: 0.284 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 35 cost time: 0.440732479095459
Epoch: 35, Steps: 3 | Train Loss: 0.146 Vali Loss: 0.278 Vali Acc: 0.925 Test Loss: 0.278 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 36 cost time: 0.43963098526000977
Epoch: 36, Steps: 3 | Train Loss: 0.136 Vali Loss: 0.278 Vali Acc: 0.925 Test Loss: 0.278 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.42252326011657715
Epoch: 37, Steps: 3 | Train Loss: 0.117 Vali Loss: 0.265 Vali Acc: 0.925 Test Loss: 0.265 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 38 cost time: 0.45035409927368164
Epoch: 38, Steps: 3 | Train Loss: 0.106 Vali Loss: 0.254 Vali Acc: 0.925 Test Loss: 0.254 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 39 cost time: 0.43162107467651367
Epoch: 39, Steps: 3 | Train Loss: 0.115 Vali Loss: 0.246 Vali Acc: 0.925 Test Loss: 0.246 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924998).  Saving model ...
Epoch: 40 cost time: 0.43028855323791504
Epoch: 40, Steps: 3 | Train Loss: 0.094 Vali Loss: 0.238 Vali Acc: 0.925 Test Loss: 0.238 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 41 cost time: 0.42962074279785156
Epoch: 41, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.233 Vali Acc: 0.925 Test Loss: 0.233 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 42 cost time: 0.42980265617370605
Epoch: 42, Steps: 3 | Train Loss: 0.088 Vali Loss: 0.235 Vali Acc: 0.925 Test Loss: 0.235 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.4556393623352051
Epoch: 43, Steps: 3 | Train Loss: 0.078 Vali Loss: 0.229 Vali Acc: 0.925 Test Loss: 0.229 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 44 cost time: 0.4314839839935303
Epoch: 44, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.219 Vali Acc: 0.925 Test Loss: 0.219 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 45 cost time: 0.3695354461669922
Epoch: 45, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.212 Vali Acc: 0.925 Test Loss: 0.212 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 46 cost time: 0.42975807189941406
Epoch: 46, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.210 Vali Acc: 0.925 Test Loss: 0.210 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 47 cost time: 0.4751901626586914
Epoch: 47, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.211 Vali Acc: 0.925 Test Loss: 0.211 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.38973069190979004
Epoch: 48, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.204 Vali Acc: 0.925 Test Loss: 0.204 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 49 cost time: 0.38666868209838867
Epoch: 49, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.200 Vali Acc: 0.925 Test Loss: 0.200 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 50 cost time: 0.4355587959289551
Epoch: 50, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.204 Vali Acc: 0.925 Test Loss: 0.204 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 352292
model size : 1.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.5813727378845215
Epoch: 1, Steps: 3 | Train Loss: 1.412 Vali Loss: 1.377 Vali Acc: 0.200 Test Loss: 1.377 Test Acc: 0.200
Validation loss decreased (inf --> -0.199986).  Saving model ...
Epoch: 2 cost time: 0.4127342700958252
Epoch: 2, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.374 Vali Acc: 0.200 Test Loss: 1.374 Test Acc: 0.200
Validation loss decreased (-0.199986 --> -0.199986).  Saving model ...
Epoch: 3 cost time: 0.40686750411987305
Epoch: 3, Steps: 3 | Train Loss: 1.338 Vali Loss: 1.366 Vali Acc: 0.200 Test Loss: 1.366 Test Acc: 0.200
Validation loss decreased (-0.199986 --> -0.199986).  Saving model ...
Epoch: 4 cost time: 0.40197229385375977
Epoch: 4, Steps: 3 | Train Loss: 1.328 Vali Loss: 1.352 Vali Acc: 0.200 Test Loss: 1.352 Test Acc: 0.200
Validation loss decreased (-0.199986 --> -0.199986).  Saving model ...
Epoch: 5 cost time: 0.4205455780029297
Epoch: 5, Steps: 3 | Train Loss: 1.308 Vali Loss: 1.332 Vali Acc: 0.300 Test Loss: 1.332 Test Acc: 0.300
Validation loss decreased (-0.199986 --> -0.299987).  Saving model ...
Epoch: 6 cost time: 0.38471269607543945
Epoch: 6, Steps: 3 | Train Loss: 1.253 Vali Loss: 1.305 Vali Acc: 0.525 Test Loss: 1.305 Test Acc: 0.525
Validation loss decreased (-0.299987 --> -0.524987).  Saving model ...
Epoch: 7 cost time: 0.4120819568634033
Epoch: 7, Steps: 3 | Train Loss: 1.162 Vali Loss: 1.272 Vali Acc: 0.600 Test Loss: 1.272 Test Acc: 0.600
Validation loss decreased (-0.524987 --> -0.599987).  Saving model ...
Epoch: 8 cost time: 0.4308478832244873
Epoch: 8, Steps: 3 | Train Loss: 1.087 Vali Loss: 1.230 Vali Acc: 0.600 Test Loss: 1.230 Test Acc: 0.600
Validation loss decreased (-0.599987 --> -0.599988).  Saving model ...
Epoch: 9 cost time: 0.4278240203857422
Epoch: 9, Steps: 3 | Train Loss: 1.040 Vali Loss: 1.183 Vali Acc: 0.600 Test Loss: 1.183 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599988).  Saving model ...
Epoch: 10 cost time: 0.38360142707824707
Epoch: 10, Steps: 3 | Train Loss: 0.982 Vali Loss: 1.135 Vali Acc: 0.625 Test Loss: 1.135 Test Acc: 0.625
Validation loss decreased (-0.599988 --> -0.624989).  Saving model ...
Epoch: 11 cost time: 0.38155078887939453
Epoch: 11, Steps: 3 | Train Loss: 0.936 Vali Loss: 1.083 Vali Acc: 0.625 Test Loss: 1.083 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 12 cost time: 0.3834834098815918
Epoch: 12, Steps: 3 | Train Loss: 0.855 Vali Loss: 1.039 Vali Acc: 0.750 Test Loss: 1.039 Test Acc: 0.750
Validation loss decreased (-0.624989 --> -0.749990).  Saving model ...
Epoch: 13 cost time: 0.502194881439209
Epoch: 13, Steps: 3 | Train Loss: 0.781 Vali Loss: 0.995 Vali Acc: 0.800 Test Loss: 0.995 Test Acc: 0.800
Validation loss decreased (-0.749990 --> -0.799990).  Saving model ...
Epoch: 14 cost time: 0.40235424041748047
Epoch: 14, Steps: 3 | Train Loss: 0.753 Vali Loss: 0.944 Vali Acc: 0.850 Test Loss: 0.944 Test Acc: 0.850
Validation loss decreased (-0.799990 --> -0.849991).  Saving model ...
Epoch: 15 cost time: 0.4164159297943115
Epoch: 15, Steps: 3 | Train Loss: 0.696 Vali Loss: 0.896 Vali Acc: 0.875 Test Loss: 0.896 Test Acc: 0.875
Validation loss decreased (-0.849991 --> -0.874991).  Saving model ...
Epoch: 16 cost time: 0.4104933738708496
Epoch: 16, Steps: 3 | Train Loss: 0.654 Vali Loss: 0.859 Vali Acc: 0.875 Test Loss: 0.859 Test Acc: 0.875
Validation loss decreased (-0.874991 --> -0.874991).  Saving model ...
Epoch: 17 cost time: 0.37380075454711914
Epoch: 17, Steps: 3 | Train Loss: 0.599 Vali Loss: 0.811 Vali Acc: 0.900 Test Loss: 0.811 Test Acc: 0.900
Validation loss decreased (-0.874991 --> -0.899992).  Saving model ...
Epoch: 18 cost time: 0.39659833908081055
Epoch: 18, Steps: 3 | Train Loss: 0.535 Vali Loss: 0.770 Vali Acc: 0.925 Test Loss: 0.770 Test Acc: 0.925
Validation loss decreased (-0.899992 --> -0.924992).  Saving model ...
Epoch: 19 cost time: 0.41030073165893555
Epoch: 19, Steps: 3 | Train Loss: 0.500 Vali Loss: 0.737 Vali Acc: 0.925 Test Loss: 0.737 Test Acc: 0.925
Validation loss decreased (-0.924992 --> -0.924993).  Saving model ...
Epoch: 20 cost time: 0.4134249687194824
Epoch: 20, Steps: 3 | Train Loss: 0.467 Vali Loss: 0.696 Vali Acc: 0.900 Test Loss: 0.696 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.4144299030303955
Epoch: 21, Steps: 3 | Train Loss: 0.449 Vali Loss: 0.656 Vali Acc: 0.900 Test Loss: 0.656 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.41429781913757324
Epoch: 22, Steps: 3 | Train Loss: 0.413 Vali Loss: 0.615 Vali Acc: 0.925 Test Loss: 0.615 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924994).  Saving model ...
Epoch: 23 cost time: 0.40293288230895996
Epoch: 23, Steps: 3 | Train Loss: 0.372 Vali Loss: 0.598 Vali Acc: 0.925 Test Loss: 0.598 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 24 cost time: 0.405592679977417
Epoch: 24, Steps: 3 | Train Loss: 0.351 Vali Loss: 0.580 Vali Acc: 0.925 Test Loss: 0.580 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 25 cost time: 0.4050877094268799
Epoch: 25, Steps: 3 | Train Loss: 0.358 Vali Loss: 0.557 Vali Acc: 0.925 Test Loss: 0.557 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 26 cost time: 0.37726402282714844
Epoch: 26, Steps: 3 | Train Loss: 0.317 Vali Loss: 0.536 Vali Acc: 0.950 Test Loss: 0.536 Test Acc: 0.950
Validation loss decreased (-0.924994 --> -0.949995).  Saving model ...
Epoch: 27 cost time: 0.41634202003479004
Epoch: 27, Steps: 3 | Train Loss: 0.296 Vali Loss: 0.518 Vali Acc: 0.950 Test Loss: 0.518 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 28 cost time: 0.4568135738372803
Epoch: 28, Steps: 3 | Train Loss: 0.273 Vali Loss: 0.501 Vali Acc: 0.925 Test Loss: 0.501 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.3916342258453369
Epoch: 29, Steps: 3 | Train Loss: 0.284 Vali Loss: 0.475 Vali Acc: 0.925 Test Loss: 0.475 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.3975026607513428
Epoch: 30, Steps: 3 | Train Loss: 0.249 Vali Loss: 0.450 Vali Acc: 0.950 Test Loss: 0.450 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 31 cost time: 0.42344069480895996
Epoch: 31, Steps: 3 | Train Loss: 0.225 Vali Loss: 0.431 Vali Acc: 0.950 Test Loss: 0.431 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 32 cost time: 0.38791489601135254
Epoch: 32, Steps: 3 | Train Loss: 0.227 Vali Loss: 0.411 Vali Acc: 0.975 Test Loss: 0.411 Test Acc: 0.975
Validation loss decreased (-0.949996 --> -0.974996).  Saving model ...
Epoch: 33 cost time: 0.3876016139984131
Epoch: 33, Steps: 3 | Train Loss: 0.213 Vali Loss: 0.398 Vali Acc: 0.975 Test Loss: 0.398 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 34 cost time: 0.42322492599487305
Epoch: 34, Steps: 3 | Train Loss: 0.214 Vali Loss: 0.389 Vali Acc: 0.975 Test Loss: 0.389 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 35 cost time: 0.45659732818603516
Epoch: 35, Steps: 3 | Train Loss: 0.193 Vali Loss: 0.375 Vali Acc: 0.975 Test Loss: 0.375 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 36 cost time: 0.3885509967803955
Epoch: 36, Steps: 3 | Train Loss: 0.206 Vali Loss: 0.363 Vali Acc: 0.975 Test Loss: 0.363 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 37 cost time: 0.41098618507385254
Epoch: 37, Steps: 3 | Train Loss: 0.174 Vali Loss: 0.346 Vali Acc: 0.975 Test Loss: 0.346 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 38 cost time: 0.4549062252044678
Epoch: 38, Steps: 3 | Train Loss: 0.174 Vali Loss: 0.329 Vali Acc: 0.975 Test Loss: 0.329 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 39 cost time: 0.38234806060791016
Epoch: 39, Steps: 3 | Train Loss: 0.153 Vali Loss: 0.317 Vali Acc: 0.975 Test Loss: 0.317 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 40 cost time: 0.47629523277282715
Epoch: 40, Steps: 3 | Train Loss: 0.156 Vali Loss: 0.301 Vali Acc: 0.975 Test Loss: 0.301 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 41 cost time: 0.5332653522491455
Epoch: 41, Steps: 3 | Train Loss: 0.142 Vali Loss: 0.295 Vali Acc: 0.975 Test Loss: 0.295 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 42 cost time: 0.4718809127807617
Epoch: 42, Steps: 3 | Train Loss: 0.136 Vali Loss: 0.287 Vali Acc: 0.975 Test Loss: 0.287 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 43 cost time: 0.42067623138427734
Epoch: 43, Steps: 3 | Train Loss: 0.115 Vali Loss: 0.287 Vali Acc: 0.975 Test Loss: 0.287 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 44 cost time: 0.41921472549438477
Epoch: 44, Steps: 3 | Train Loss: 0.111 Vali Loss: 0.278 Vali Acc: 0.975 Test Loss: 0.278 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 45 cost time: 0.42342686653137207
Epoch: 45, Steps: 3 | Train Loss: 0.107 Vali Loss: 0.266 Vali Acc: 0.975 Test Loss: 0.266 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 46 cost time: 0.5173566341400146
Epoch: 46, Steps: 3 | Train Loss: 0.108 Vali Loss: 0.258 Vali Acc: 0.975 Test Loss: 0.258 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 47 cost time: 0.4511706829071045
Epoch: 47, Steps: 3 | Train Loss: 0.082 Vali Loss: 0.251 Vali Acc: 0.950 Test Loss: 0.251 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.45616602897644043
Epoch: 48, Steps: 3 | Train Loss: 0.082 Vali Loss: 0.234 Vali Acc: 0.975 Test Loss: 0.234 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 49 cost time: 0.44528913497924805
Epoch: 49, Steps: 3 | Train Loss: 0.072 Vali Loss: 0.233 Vali Acc: 0.950 Test Loss: 0.233 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.5005738735198975
Epoch: 50, Steps: 3 | Train Loss: 0.068 Vali Loss: 0.222 Vali Acc: 0.950 Test Loss: 0.222 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 346212
model size : 1.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.53000807762146
Epoch: 1, Steps: 3 | Train Loss: 1.390 Vali Loss: 1.404 Vali Acc: 0.275 Test Loss: 1.404 Test Acc: 0.275
Validation loss decreased (inf --> -0.274986).  Saving model ...
Epoch: 2 cost time: 0.42710065841674805
Epoch: 2, Steps: 3 | Train Loss: 1.331 Vali Loss: 1.397 Vali Acc: 0.325 Test Loss: 1.397 Test Acc: 0.325
Validation loss decreased (-0.274986 --> -0.324986).  Saving model ...
Epoch: 3 cost time: 0.3941457271575928
Epoch: 3, Steps: 3 | Train Loss: 1.322 Vali Loss: 1.387 Vali Acc: 0.425 Test Loss: 1.387 Test Acc: 0.425
Validation loss decreased (-0.324986 --> -0.424986).  Saving model ...
Epoch: 4 cost time: 0.39960408210754395
Epoch: 4, Steps: 3 | Train Loss: 1.297 Vali Loss: 1.372 Vali Acc: 0.450 Test Loss: 1.372 Test Acc: 0.450
Validation loss decreased (-0.424986 --> -0.449986).  Saving model ...
Epoch: 5 cost time: 0.43465137481689453
Epoch: 5, Steps: 3 | Train Loss: 1.261 Vali Loss: 1.352 Vali Acc: 0.475 Test Loss: 1.352 Test Acc: 0.475
Validation loss decreased (-0.449986 --> -0.474986).  Saving model ...
Epoch: 6 cost time: 0.3851296901702881
Epoch: 6, Steps: 3 | Train Loss: 1.271 Vali Loss: 1.326 Vali Acc: 0.500 Test Loss: 1.326 Test Acc: 0.500
Validation loss decreased (-0.474986 --> -0.499987).  Saving model ...
Epoch: 7 cost time: 0.46698760986328125
Epoch: 7, Steps: 3 | Train Loss: 1.191 Vali Loss: 1.294 Vali Acc: 0.525 Test Loss: 1.294 Test Acc: 0.525
Validation loss decreased (-0.499987 --> -0.524987).  Saving model ...
Epoch: 8 cost time: 0.41326236724853516
Epoch: 8, Steps: 3 | Train Loss: 1.125 Vali Loss: 1.262 Vali Acc: 0.550 Test Loss: 1.262 Test Acc: 0.550
Validation loss decreased (-0.524987 --> -0.549987).  Saving model ...
Epoch: 9 cost time: 0.4396631717681885
Epoch: 9, Steps: 3 | Train Loss: 1.061 Vali Loss: 1.224 Vali Acc: 0.600 Test Loss: 1.224 Test Acc: 0.600
Validation loss decreased (-0.549987 --> -0.599988).  Saving model ...
Epoch: 10 cost time: 0.41373109817504883
Epoch: 10, Steps: 3 | Train Loss: 1.048 Vali Loss: 1.186 Vali Acc: 0.625 Test Loss: 1.186 Test Acc: 0.625
Validation loss decreased (-0.599988 --> -0.624988).  Saving model ...
Epoch: 11 cost time: 0.4317147731781006
Epoch: 11, Steps: 3 | Train Loss: 1.024 Vali Loss: 1.145 Vali Acc: 0.625 Test Loss: 1.145 Test Acc: 0.625
Validation loss decreased (-0.624988 --> -0.624989).  Saving model ...
Epoch: 12 cost time: 0.4878854751586914
Epoch: 12, Steps: 3 | Train Loss: 0.948 Vali Loss: 1.114 Vali Acc: 0.650 Test Loss: 1.114 Test Acc: 0.650
Validation loss decreased (-0.624989 --> -0.649989).  Saving model ...
Epoch: 13 cost time: 0.4503622055053711
Epoch: 13, Steps: 3 | Train Loss: 0.933 Vali Loss: 1.072 Vali Acc: 0.675 Test Loss: 1.072 Test Acc: 0.675
Validation loss decreased (-0.649989 --> -0.674989).  Saving model ...
Epoch: 14 cost time: 0.4710357189178467
Epoch: 14, Steps: 3 | Train Loss: 0.834 Vali Loss: 1.036 Vali Acc: 0.700 Test Loss: 1.036 Test Acc: 0.700
Validation loss decreased (-0.674989 --> -0.699990).  Saving model ...
Epoch: 15 cost time: 0.39572882652282715
Epoch: 15, Steps: 3 | Train Loss: 0.803 Vali Loss: 0.991 Vali Acc: 0.725 Test Loss: 0.991 Test Acc: 0.725
Validation loss decreased (-0.699990 --> -0.724990).  Saving model ...
Epoch: 16 cost time: 0.4737069606781006
Epoch: 16, Steps: 3 | Train Loss: 0.778 Vali Loss: 0.945 Vali Acc: 0.775 Test Loss: 0.945 Test Acc: 0.775
Validation loss decreased (-0.724990 --> -0.774991).  Saving model ...
Epoch: 17 cost time: 0.4594273567199707
Epoch: 17, Steps: 3 | Train Loss: 0.743 Vali Loss: 0.908 Vali Acc: 0.775 Test Loss: 0.908 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 18 cost time: 0.4131910800933838
Epoch: 18, Steps: 3 | Train Loss: 0.695 Vali Loss: 0.882 Vali Acc: 0.800 Test Loss: 0.882 Test Acc: 0.800
Validation loss decreased (-0.774991 --> -0.799991).  Saving model ...
Epoch: 19 cost time: 0.41884613037109375
Epoch: 19, Steps: 3 | Train Loss: 0.638 Vali Loss: 0.846 Vali Acc: 0.800 Test Loss: 0.846 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799992).  Saving model ...
Epoch: 20 cost time: 0.3879997730255127
Epoch: 20, Steps: 3 | Train Loss: 0.610 Vali Loss: 0.804 Vali Acc: 0.825 Test Loss: 0.804 Test Acc: 0.825
Validation loss decreased (-0.799992 --> -0.824992).  Saving model ...
Epoch: 21 cost time: 0.543454647064209
Epoch: 21, Steps: 3 | Train Loss: 0.570 Vali Loss: 0.766 Vali Acc: 0.875 Test Loss: 0.766 Test Acc: 0.875
Validation loss decreased (-0.824992 --> -0.874992).  Saving model ...
Epoch: 22 cost time: 0.4485898017883301
Epoch: 22, Steps: 3 | Train Loss: 0.549 Vali Loss: 0.752 Vali Acc: 0.875 Test Loss: 0.752 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874992).  Saving model ...
Epoch: 23 cost time: 0.4570486545562744
Epoch: 23, Steps: 3 | Train Loss: 0.502 Vali Loss: 0.719 Vali Acc: 0.900 Test Loss: 0.719 Test Acc: 0.900
Validation loss decreased (-0.874992 --> -0.899993).  Saving model ...
Epoch: 24 cost time: 0.431657075881958
Epoch: 24, Steps: 3 | Train Loss: 0.459 Vali Loss: 0.684 Vali Acc: 0.900 Test Loss: 0.684 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 25 cost time: 0.4601900577545166
Epoch: 25, Steps: 3 | Train Loss: 0.452 Vali Loss: 0.664 Vali Acc: 0.900 Test Loss: 0.664 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 26 cost time: 0.44698643684387207
Epoch: 26, Steps: 3 | Train Loss: 0.446 Vali Loss: 0.631 Vali Acc: 0.875 Test Loss: 0.631 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.43680667877197266
Epoch: 27, Steps: 3 | Train Loss: 0.397 Vali Loss: 0.598 Vali Acc: 0.875 Test Loss: 0.598 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.4173243045806885
Epoch: 28, Steps: 3 | Train Loss: 0.372 Vali Loss: 0.573 Vali Acc: 0.875 Test Loss: 0.573 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.44798874855041504
Epoch: 29, Steps: 3 | Train Loss: 0.348 Vali Loss: 0.556 Vali Acc: 0.900 Test Loss: 0.556 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899994).  Saving model ...
Epoch: 30 cost time: 0.39112114906311035
Epoch: 30, Steps: 3 | Train Loss: 0.331 Vali Loss: 0.537 Vali Acc: 0.900 Test Loss: 0.537 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 31 cost time: 0.4149956703186035
Epoch: 31, Steps: 3 | Train Loss: 0.353 Vali Loss: 0.512 Vali Acc: 0.900 Test Loss: 0.512 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 32 cost time: 0.43375182151794434
Epoch: 32, Steps: 3 | Train Loss: 0.319 Vali Loss: 0.495 Vali Acc: 0.900 Test Loss: 0.495 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 33 cost time: 0.4349484443664551
Epoch: 33, Steps: 3 | Train Loss: 0.298 Vali Loss: 0.487 Vali Acc: 0.925 Test Loss: 0.487 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924995).  Saving model ...
Epoch: 34 cost time: 0.42363882064819336
Epoch: 34, Steps: 3 | Train Loss: 0.264 Vali Loss: 0.474 Vali Acc: 0.925 Test Loss: 0.474 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 35 cost time: 0.4191756248474121
Epoch: 35, Steps: 3 | Train Loss: 0.271 Vali Loss: 0.459 Vali Acc: 0.925 Test Loss: 0.459 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 36 cost time: 0.4862964153289795
Epoch: 36, Steps: 3 | Train Loss: 0.259 Vali Loss: 0.446 Vali Acc: 0.925 Test Loss: 0.446 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 37 cost time: 0.392930269241333
Epoch: 37, Steps: 3 | Train Loss: 0.217 Vali Loss: 0.430 Vali Acc: 0.900 Test Loss: 0.430 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.45572471618652344
Epoch: 38, Steps: 3 | Train Loss: 0.224 Vali Loss: 0.419 Vali Acc: 0.900 Test Loss: 0.419 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.4398517608642578
Epoch: 39, Steps: 3 | Train Loss: 0.243 Vali Loss: 0.398 Vali Acc: 0.925 Test Loss: 0.398 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 40 cost time: 0.42313647270202637
Epoch: 40, Steps: 3 | Train Loss: 0.186 Vali Loss: 0.376 Vali Acc: 0.950 Test Loss: 0.376 Test Acc: 0.950
Validation loss decreased (-0.924996 --> -0.949996).  Saving model ...
Epoch: 41 cost time: 0.4051525592803955
Epoch: 41, Steps: 3 | Train Loss: 0.175 Vali Loss: 0.370 Vali Acc: 0.950 Test Loss: 0.370 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 42 cost time: 0.3850247859954834
Epoch: 42, Steps: 3 | Train Loss: 0.184 Vali Loss: 0.352 Vali Acc: 0.950 Test Loss: 0.352 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 43 cost time: 0.5298624038696289
Epoch: 43, Steps: 3 | Train Loss: 0.162 Vali Loss: 0.336 Vali Acc: 0.950 Test Loss: 0.336 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 44 cost time: 0.48001575469970703
Epoch: 44, Steps: 3 | Train Loss: 0.178 Vali Loss: 0.329 Vali Acc: 0.950 Test Loss: 0.329 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 45 cost time: 0.5049517154693604
Epoch: 45, Steps: 3 | Train Loss: 0.154 Vali Loss: 0.318 Vali Acc: 0.950 Test Loss: 0.318 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 46 cost time: 0.42429566383361816
Epoch: 46, Steps: 3 | Train Loss: 0.125 Vali Loss: 0.302 Vali Acc: 0.950 Test Loss: 0.302 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 47 cost time: 0.4608159065246582
Epoch: 47, Steps: 3 | Train Loss: 0.131 Vali Loss: 0.298 Vali Acc: 0.950 Test Loss: 0.298 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 48 cost time: 0.48490118980407715
Epoch: 48, Steps: 3 | Train Loss: 0.129 Vali Loss: 0.302 Vali Acc: 0.950 Test Loss: 0.302 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.482177734375
Epoch: 49, Steps: 3 | Train Loss: 0.115 Vali Loss: 0.283 Vali Acc: 0.950 Test Loss: 0.283 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 50 cost time: 0.4885537624359131
Epoch: 50, Steps: 3 | Train Loss: 0.108 Vali Loss: 0.271 Vali Acc: 0.950 Test Loss: 0.271 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 340228
model size : 1.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps20_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.6751172542572021
Epoch: 1, Steps: 3 | Train Loss: 1.383 Vali Loss: 1.368 Vali Acc: 0.400 Test Loss: 1.368 Test Acc: 0.400
Validation loss decreased (inf --> -0.399986).  Saving model ...
Epoch: 2 cost time: 0.43382930755615234
Epoch: 2, Steps: 3 | Train Loss: 1.363 Vali Loss: 1.362 Vali Acc: 0.450 Test Loss: 1.362 Test Acc: 0.450
Validation loss decreased (-0.399986 --> -0.449986).  Saving model ...
Epoch: 3 cost time: 0.4346334934234619
Epoch: 3, Steps: 3 | Train Loss: 1.388 Vali Loss: 1.352 Vali Acc: 0.475 Test Loss: 1.352 Test Acc: 0.475
Validation loss decreased (-0.449986 --> -0.474986).  Saving model ...
Epoch: 4 cost time: 0.41789841651916504
Epoch: 4, Steps: 3 | Train Loss: 1.287 Vali Loss: 1.337 Vali Acc: 0.425 Test Loss: 1.337 Test Acc: 0.425
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.4646604061126709
Epoch: 5, Steps: 3 | Train Loss: 1.279 Vali Loss: 1.318 Vali Acc: 0.475 Test Loss: 1.318 Test Acc: 0.475
Validation loss decreased (-0.474986 --> -0.474987).  Saving model ...
Epoch: 6 cost time: 0.3748030662536621
Epoch: 6, Steps: 3 | Train Loss: 1.264 Vali Loss: 1.293 Vali Acc: 0.500 Test Loss: 1.293 Test Acc: 0.500
Validation loss decreased (-0.474987 --> -0.499987).  Saving model ...
Epoch: 7 cost time: 0.42490506172180176
Epoch: 7, Steps: 3 | Train Loss: 1.213 Vali Loss: 1.261 Vali Acc: 0.550 Test Loss: 1.261 Test Acc: 0.550
Validation loss decreased (-0.499987 --> -0.549987).  Saving model ...
Epoch: 8 cost time: 0.4650275707244873
Epoch: 8, Steps: 3 | Train Loss: 1.148 Vali Loss: 1.228 Vali Acc: 0.575 Test Loss: 1.228 Test Acc: 0.575
Validation loss decreased (-0.549987 --> -0.574988).  Saving model ...
Epoch: 9 cost time: 0.4077029228210449
Epoch: 9, Steps: 3 | Train Loss: 1.118 Vali Loss: 1.194 Vali Acc: 0.575 Test Loss: 1.194 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 10 cost time: 0.4005732536315918
Epoch: 10, Steps: 3 | Train Loss: 1.085 Vali Loss: 1.158 Vali Acc: 0.550 Test Loss: 1.158 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.4105222225189209
Epoch: 11, Steps: 3 | Train Loss: 1.048 Vali Loss: 1.116 Vali Acc: 0.625 Test Loss: 1.116 Test Acc: 0.625
Validation loss decreased (-0.574988 --> -0.624989).  Saving model ...
Epoch: 12 cost time: 0.4185984134674072
Epoch: 12, Steps: 3 | Train Loss: 0.965 Vali Loss: 1.081 Vali Acc: 0.700 Test Loss: 1.081 Test Acc: 0.700
Validation loss decreased (-0.624989 --> -0.699989).  Saving model ...
Epoch: 13 cost time: 0.4011366367340088
Epoch: 13, Steps: 3 | Train Loss: 0.903 Vali Loss: 1.050 Vali Acc: 0.775 Test Loss: 1.050 Test Acc: 0.775
Validation loss decreased (-0.699989 --> -0.774990).  Saving model ...
Epoch: 14 cost time: 0.4139378070831299
Epoch: 14, Steps: 3 | Train Loss: 0.902 Vali Loss: 1.014 Vali Acc: 0.850 Test Loss: 1.014 Test Acc: 0.850
Validation loss decreased (-0.774990 --> -0.849990).  Saving model ...
Epoch: 15 cost time: 0.422257661819458
Epoch: 15, Steps: 3 | Train Loss: 0.838 Vali Loss: 0.979 Vali Acc: 0.850 Test Loss: 0.979 Test Acc: 0.850
Validation loss decreased (-0.849990 --> -0.849990).  Saving model ...
Epoch: 16 cost time: 0.4138147830963135
Epoch: 16, Steps: 3 | Train Loss: 0.776 Vali Loss: 0.947 Vali Acc: 0.825 Test Loss: 0.947 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.4275972843170166
Epoch: 17, Steps: 3 | Train Loss: 0.748 Vali Loss: 0.915 Vali Acc: 0.775 Test Loss: 0.915 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.4076874256134033
Epoch: 18, Steps: 3 | Train Loss: 0.703 Vali Loss: 0.886 Vali Acc: 0.800 Test Loss: 0.886 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.4575076103210449
Epoch: 19, Steps: 3 | Train Loss: 0.682 Vali Loss: 0.849 Vali Acc: 0.800 Test Loss: 0.849 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.4515116214752197
Epoch: 20, Steps: 3 | Train Loss: 0.634 Vali Loss: 0.816 Vali Acc: 0.825 Test Loss: 0.816 Test Acc: 0.825
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.4427189826965332
Epoch: 21, Steps: 3 | Train Loss: 0.582 Vali Loss: 0.797 Vali Acc: 0.875 Test Loss: 0.797 Test Acc: 0.875
Validation loss decreased (-0.849990 --> -0.874992).  Saving model ...
Epoch: 22 cost time: 0.40812087059020996
Epoch: 22, Steps: 3 | Train Loss: 0.595 Vali Loss: 0.762 Vali Acc: 0.900 Test Loss: 0.762 Test Acc: 0.900
Validation loss decreased (-0.874992 --> -0.899992).  Saving model ...
Epoch: 23 cost time: 0.4071187973022461
Epoch: 23, Steps: 3 | Train Loss: 0.561 Vali Loss: 0.732 Vali Acc: 0.900 Test Loss: 0.732 Test Acc: 0.900
Validation loss decreased (-0.899992 --> -0.899993).  Saving model ...
Epoch: 24 cost time: 0.46324849128723145
Epoch: 24, Steps: 3 | Train Loss: 0.536 Vali Loss: 0.712 Vali Acc: 0.900 Test Loss: 0.712 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 25 cost time: 0.40216970443725586
Epoch: 25, Steps: 3 | Train Loss: 0.494 Vali Loss: 0.692 Vali Acc: 0.900 Test Loss: 0.692 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 26 cost time: 0.42792558670043945
Epoch: 26, Steps: 3 | Train Loss: 0.481 Vali Loss: 0.663 Vali Acc: 0.925 Test Loss: 0.663 Test Acc: 0.925
Validation loss decreased (-0.899993 --> -0.924993).  Saving model ...
Epoch: 27 cost time: 0.41181373596191406
Epoch: 27, Steps: 3 | Train Loss: 0.426 Vali Loss: 0.652 Vali Acc: 0.925 Test Loss: 0.652 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924993).  Saving model ...
Epoch: 28 cost time: 0.42196202278137207
Epoch: 28, Steps: 3 | Train Loss: 0.464 Vali Loss: 0.652 Vali Acc: 0.925 Test Loss: 0.652 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924993).  Saving model ...
Epoch: 29 cost time: 0.486253023147583
Epoch: 29, Steps: 3 | Train Loss: 0.407 Vali Loss: 0.618 Vali Acc: 0.925 Test Loss: 0.618 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924994).  Saving model ...
Epoch: 30 cost time: 0.41847729682922363
Epoch: 30, Steps: 3 | Train Loss: 0.395 Vali Loss: 0.595 Vali Acc: 0.900 Test Loss: 0.595 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.39243149757385254
Epoch: 31, Steps: 3 | Train Loss: 0.372 Vali Loss: 0.571 Vali Acc: 0.900 Test Loss: 0.571 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.431088924407959
Epoch: 32, Steps: 3 | Train Loss: 0.363 Vali Loss: 0.544 Vali Acc: 0.950 Test Loss: 0.544 Test Acc: 0.950
Validation loss decreased (-0.924994 --> -0.949995).  Saving model ...
Epoch: 33 cost time: 0.42730140686035156
Epoch: 33, Steps: 3 | Train Loss: 0.338 Vali Loss: 0.531 Vali Acc: 0.925 Test Loss: 0.531 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.4585909843444824
Epoch: 34, Steps: 3 | Train Loss: 0.336 Vali Loss: 0.513 Vali Acc: 0.925 Test Loss: 0.513 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.376065731048584
Epoch: 35, Steps: 3 | Train Loss: 0.311 Vali Loss: 0.511 Vali Acc: 0.925 Test Loss: 0.511 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.4326629638671875
Epoch: 36, Steps: 3 | Train Loss: 0.291 Vali Loss: 0.481 Vali Acc: 0.925 Test Loss: 0.481 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.39576196670532227
Epoch: 37, Steps: 3 | Train Loss: 0.287 Vali Loss: 0.473 Vali Acc: 0.925 Test Loss: 0.473 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.4140279293060303
Epoch: 38, Steps: 3 | Train Loss: 0.317 Vali Loss: 0.457 Vali Acc: 0.925 Test Loss: 0.457 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.44648098945617676
Epoch: 39, Steps: 3 | Train Loss: 0.267 Vali Loss: 0.445 Vali Acc: 0.925 Test Loss: 0.445 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.40920567512512207
Epoch: 40, Steps: 3 | Train Loss: 0.257 Vali Loss: 0.430 Vali Acc: 0.925 Test Loss: 0.430 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.39437198638916016
Epoch: 41, Steps: 3 | Train Loss: 0.257 Vali Loss: 0.426 Vali Acc: 0.950 Test Loss: 0.426 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 42 cost time: 0.40321922302246094
Epoch: 42, Steps: 3 | Train Loss: 0.228 Vali Loss: 0.413 Vali Acc: 0.950 Test Loss: 0.413 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 43 cost time: 0.4775872230529785
Epoch: 43, Steps: 3 | Train Loss: 0.232 Vali Loss: 0.406 Vali Acc: 0.950 Test Loss: 0.406 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 44 cost time: 0.4485194683074951
Epoch: 44, Steps: 3 | Train Loss: 0.225 Vali Loss: 0.392 Vali Acc: 0.950 Test Loss: 0.392 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 45 cost time: 0.413848876953125
Epoch: 45, Steps: 3 | Train Loss: 0.205 Vali Loss: 0.389 Vali Acc: 0.925 Test Loss: 0.389 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.3935878276824951
Epoch: 46, Steps: 3 | Train Loss: 0.197 Vali Loss: 0.377 Vali Acc: 0.925 Test Loss: 0.377 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.40763115882873535
Epoch: 47, Steps: 3 | Train Loss: 0.197 Vali Loss: 0.369 Vali Acc: 0.925 Test Loss: 0.369 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.40638065338134766
Epoch: 48, Steps: 3 | Train Loss: 0.172 Vali Loss: 0.353 Vali Acc: 0.925 Test Loss: 0.353 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.3867943286895752
Epoch: 49, Steps: 3 | Train Loss: 0.189 Vali Loss: 0.342 Vali Acc: 0.925 Test Loss: 0.342 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.40613770484924316
Epoch: 50, Steps: 3 | Train Loss: 0.144 Vali Loss: 0.337 Vali Acc: 0.925 Test Loss: 0.337 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps20_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 340388
model size : 1.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps25_str13_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.613252878189087
Epoch: 1, Steps: 3 | Train Loss: 1.364 Vali Loss: 1.372 Vali Acc: 0.150 Test Loss: 1.372 Test Acc: 0.150
Validation loss decreased (inf --> -0.149986).  Saving model ...
Epoch: 2 cost time: 0.4547603130340576
Epoch: 2, Steps: 3 | Train Loss: 1.374 Vali Loss: 1.364 Vali Acc: 0.150 Test Loss: 1.364 Test Acc: 0.150
Validation loss decreased (-0.149986 --> -0.149986).  Saving model ...
Epoch: 3 cost time: 0.49219775199890137
Epoch: 3, Steps: 3 | Train Loss: 1.342 Vali Loss: 1.354 Vali Acc: 0.125 Test Loss: 1.354 Test Acc: 0.125
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.44849228858947754
Epoch: 4, Steps: 3 | Train Loss: 1.317 Vali Loss: 1.342 Vali Acc: 0.125 Test Loss: 1.342 Test Acc: 0.125
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.39520764350891113
Epoch: 5, Steps: 3 | Train Loss: 1.301 Vali Loss: 1.326 Vali Acc: 0.225 Test Loss: 1.326 Test Acc: 0.225
Validation loss decreased (-0.149986 --> -0.224987).  Saving model ...
Epoch: 6 cost time: 0.46839237213134766
Epoch: 6, Steps: 3 | Train Loss: 1.288 Vali Loss: 1.307 Vali Acc: 0.225 Test Loss: 1.307 Test Acc: 0.225
Validation loss decreased (-0.224987 --> -0.224987).  Saving model ...
Epoch: 7 cost time: 0.4355018138885498
Epoch: 7, Steps: 3 | Train Loss: 1.244 Vali Loss: 1.283 Vali Acc: 0.400 Test Loss: 1.283 Test Acc: 0.400
Validation loss decreased (-0.224987 --> -0.399987).  Saving model ...
Epoch: 8 cost time: 0.4478785991668701
Epoch: 8, Steps: 3 | Train Loss: 1.179 Vali Loss: 1.258 Vali Acc: 0.625 Test Loss: 1.258 Test Acc: 0.625
Validation loss decreased (-0.399987 --> -0.624987).  Saving model ...
Epoch: 9 cost time: 0.5260505676269531
Epoch: 9, Steps: 3 | Train Loss: 1.194 Vali Loss: 1.231 Vali Acc: 0.675 Test Loss: 1.231 Test Acc: 0.675
Validation loss decreased (-0.624987 --> -0.674988).  Saving model ...
Epoch: 10 cost time: 0.4332551956176758
Epoch: 10, Steps: 3 | Train Loss: 1.091 Vali Loss: 1.203 Vali Acc: 0.750 Test Loss: 1.203 Test Acc: 0.750
Validation loss decreased (-0.674988 --> -0.749988).  Saving model ...
Epoch: 11 cost time: 0.514249324798584
Epoch: 11, Steps: 3 | Train Loss: 1.072 Vali Loss: 1.173 Vali Acc: 0.800 Test Loss: 1.173 Test Acc: 0.800
Validation loss decreased (-0.749988 --> -0.799988).  Saving model ...
Epoch: 12 cost time: 0.4468348026275635
Epoch: 12, Steps: 3 | Train Loss: 1.044 Vali Loss: 1.147 Vali Acc: 0.850 Test Loss: 1.147 Test Acc: 0.850
Validation loss decreased (-0.799988 --> -0.849989).  Saving model ...
Epoch: 13 cost time: 0.46355366706848145
Epoch: 13, Steps: 3 | Train Loss: 0.982 Vali Loss: 1.115 Vali Acc: 0.875 Test Loss: 1.115 Test Acc: 0.875
Validation loss decreased (-0.849989 --> -0.874989).  Saving model ...
Epoch: 14 cost time: 0.45792365074157715
Epoch: 14, Steps: 3 | Train Loss: 0.973 Vali Loss: 1.082 Vali Acc: 0.850 Test Loss: 1.082 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.518101692199707
Epoch: 15, Steps: 3 | Train Loss: 0.936 Vali Loss: 1.052 Vali Acc: 0.850 Test Loss: 1.052 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.4669053554534912
Epoch: 16, Steps: 3 | Train Loss: 0.885 Vali Loss: 1.027 Vali Acc: 0.850 Test Loss: 1.027 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.43337178230285645
Epoch: 17, Steps: 3 | Train Loss: 0.860 Vali Loss: 0.993 Vali Acc: 0.850 Test Loss: 0.993 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.4521148204803467
Epoch: 18, Steps: 3 | Train Loss: 0.785 Vali Loss: 0.959 Vali Acc: 0.875 Test Loss: 0.959 Test Acc: 0.875
Validation loss decreased (-0.874989 --> -0.874990).  Saving model ...
Epoch: 19 cost time: 0.4744751453399658
Epoch: 19, Steps: 3 | Train Loss: 0.773 Vali Loss: 0.929 Vali Acc: 0.875 Test Loss: 0.929 Test Acc: 0.875
Validation loss decreased (-0.874990 --> -0.874991).  Saving model ...
Epoch: 20 cost time: 0.47681617736816406
Epoch: 20, Steps: 3 | Train Loss: 0.725 Vali Loss: 0.892 Vali Acc: 0.850 Test Loss: 0.892 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.44290876388549805
Epoch: 21, Steps: 3 | Train Loss: 0.681 Vali Loss: 0.870 Vali Acc: 0.850 Test Loss: 0.870 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.4343545436859131
Epoch: 22, Steps: 3 | Train Loss: 0.657 Vali Loss: 0.843 Vali Acc: 0.850 Test Loss: 0.843 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.4278600215911865
Epoch: 23, Steps: 3 | Train Loss: 0.637 Vali Loss: 0.808 Vali Acc: 0.850 Test Loss: 0.808 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.47633862495422363
Epoch: 24, Steps: 3 | Train Loss: 0.603 Vali Loss: 0.788 Vali Acc: 0.850 Test Loss: 0.788 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.4601764678955078
Epoch: 25, Steps: 3 | Train Loss: 0.574 Vali Loss: 0.775 Vali Acc: 0.850 Test Loss: 0.775 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.4985682964324951
Epoch: 26, Steps: 3 | Train Loss: 0.539 Vali Loss: 0.742 Vali Acc: 0.850 Test Loss: 0.742 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.47635793685913086
Epoch: 27, Steps: 3 | Train Loss: 0.529 Vali Loss: 0.718 Vali Acc: 0.875 Test Loss: 0.718 Test Acc: 0.875
Validation loss decreased (-0.874991 --> -0.874993).  Saving model ...
Epoch: 28 cost time: 0.4732029438018799
Epoch: 28, Steps: 3 | Train Loss: 0.504 Vali Loss: 0.695 Vali Acc: 0.900 Test Loss: 0.695 Test Acc: 0.900
Validation loss decreased (-0.874993 --> -0.899993).  Saving model ...
Epoch: 29 cost time: 0.4690108299255371
Epoch: 29, Steps: 3 | Train Loss: 0.468 Vali Loss: 0.679 Vali Acc: 0.875 Test Loss: 0.679 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.47824525833129883
Epoch: 30, Steps: 3 | Train Loss: 0.439 Vali Loss: 0.662 Vali Acc: 0.875 Test Loss: 0.662 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.4339420795440674
Epoch: 31, Steps: 3 | Train Loss: 0.427 Vali Loss: 0.641 Vali Acc: 0.875 Test Loss: 0.641 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.4223904609680176
Epoch: 32, Steps: 3 | Train Loss: 0.427 Vali Loss: 0.617 Vali Acc: 0.875 Test Loss: 0.617 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.4088246822357178
Epoch: 33, Steps: 3 | Train Loss: 0.373 Vali Loss: 0.588 Vali Acc: 0.875 Test Loss: 0.588 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.45031213760375977
Epoch: 34, Steps: 3 | Train Loss: 0.361 Vali Loss: 0.566 Vali Acc: 0.900 Test Loss: 0.566 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899994).  Saving model ...
Epoch: 35 cost time: 0.42261695861816406
Epoch: 35, Steps: 3 | Train Loss: 0.343 Vali Loss: 0.549 Vali Acc: 0.850 Test Loss: 0.549 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.45265746116638184
Epoch: 36, Steps: 3 | Train Loss: 0.336 Vali Loss: 0.539 Vali Acc: 0.850 Test Loss: 0.539 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.45197248458862305
Epoch: 37, Steps: 3 | Train Loss: 0.322 Vali Loss: 0.532 Vali Acc: 0.850 Test Loss: 0.532 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.426088809967041
Epoch: 38, Steps: 3 | Train Loss: 0.302 Vali Loss: 0.520 Vali Acc: 0.850 Test Loss: 0.520 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.4116499423980713
Epoch: 39, Steps: 3 | Train Loss: 0.276 Vali Loss: 0.496 Vali Acc: 0.875 Test Loss: 0.496 Test Acc: 0.875
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.47135114669799805
Epoch: 40, Steps: 3 | Train Loss: 0.271 Vali Loss: 0.483 Vali Acc: 0.875 Test Loss: 0.483 Test Acc: 0.875
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.41533946990966797
Epoch: 41, Steps: 3 | Train Loss: 0.245 Vali Loss: 0.462 Vali Acc: 0.875 Test Loss: 0.462 Test Acc: 0.875
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.4595060348510742
Epoch: 42, Steps: 3 | Train Loss: 0.247 Vali Loss: 0.457 Vali Acc: 0.850 Test Loss: 0.457 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.43576765060424805
Epoch: 43, Steps: 3 | Train Loss: 0.225 Vali Loss: 0.448 Vali Acc: 0.850 Test Loss: 0.448 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.42505788803100586
Epoch: 44, Steps: 3 | Train Loss: 0.218 Vali Loss: 0.449 Vali Acc: 0.875 Test Loss: 0.449 Test Acc: 0.875
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps25_str13_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.9
model parameter : 337476
model size : 1.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.508955717086792
Epoch: 1, Steps: 3 | Train Loss: 1.455 Vali Loss: 1.385 Vali Acc: 0.325 Test Loss: 1.385 Test Acc: 0.325
Validation loss decreased (inf --> -0.324986).  Saving model ...
Epoch: 2 cost time: 0.43035030364990234
Epoch: 2, Steps: 3 | Train Loss: 1.411 Vali Loss: 1.375 Vali Acc: 0.350 Test Loss: 1.375 Test Acc: 0.350
Validation loss decreased (-0.324986 --> -0.349986).  Saving model ...
Epoch: 3 cost time: 0.41768813133239746
Epoch: 3, Steps: 3 | Train Loss: 1.361 Vali Loss: 1.352 Vali Acc: 0.350 Test Loss: 1.352 Test Acc: 0.350
Validation loss decreased (-0.349986 --> -0.349986).  Saving model ...
Epoch: 4 cost time: 0.45261049270629883
Epoch: 4, Steps: 3 | Train Loss: 1.306 Vali Loss: 1.319 Vali Acc: 0.425 Test Loss: 1.319 Test Acc: 0.425
Validation loss decreased (-0.349986 --> -0.424987).  Saving model ...
Epoch: 5 cost time: 0.41367053985595703
Epoch: 5, Steps: 3 | Train Loss: 1.191 Vali Loss: 1.271 Vali Acc: 0.500 Test Loss: 1.271 Test Acc: 0.500
Validation loss decreased (-0.424987 --> -0.499987).  Saving model ...
Epoch: 6 cost time: 0.4360051155090332
Epoch: 6, Steps: 3 | Train Loss: 1.107 Vali Loss: 1.214 Vali Acc: 0.575 Test Loss: 1.214 Test Acc: 0.575
Validation loss decreased (-0.499987 --> -0.574988).  Saving model ...
Epoch: 7 cost time: 0.4274592399597168
Epoch: 7, Steps: 3 | Train Loss: 1.018 Vali Loss: 1.151 Vali Acc: 0.575 Test Loss: 1.151 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 8 cost time: 0.4030189514160156
Epoch: 8, Steps: 3 | Train Loss: 0.907 Vali Loss: 1.071 Vali Acc: 0.650 Test Loss: 1.071 Test Acc: 0.650
Validation loss decreased (-0.574988 --> -0.649989).  Saving model ...
Epoch: 9 cost time: 0.43189501762390137
Epoch: 9, Steps: 3 | Train Loss: 0.804 Vali Loss: 1.005 Vali Acc: 0.700 Test Loss: 1.005 Test Acc: 0.700
Validation loss decreased (-0.649989 --> -0.699990).  Saving model ...
Epoch: 10 cost time: 0.4494924545288086
Epoch: 10, Steps: 3 | Train Loss: 0.757 Vali Loss: 0.927 Vali Acc: 0.700 Test Loss: 0.927 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699991).  Saving model ...
Epoch: 11 cost time: 0.4463796615600586
Epoch: 11, Steps: 3 | Train Loss: 0.642 Vali Loss: 0.851 Vali Acc: 0.700 Test Loss: 0.851 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 12 cost time: 0.44206786155700684
Epoch: 12, Steps: 3 | Train Loss: 0.600 Vali Loss: 0.788 Vali Acc: 0.850 Test Loss: 0.788 Test Acc: 0.850
Validation loss decreased (-0.699991 --> -0.849992).  Saving model ...
Epoch: 13 cost time: 0.4329543113708496
Epoch: 13, Steps: 3 | Train Loss: 0.549 Vali Loss: 0.733 Vali Acc: 0.850 Test Loss: 0.733 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849993).  Saving model ...
Epoch: 14 cost time: 0.4020085334777832
Epoch: 14, Steps: 3 | Train Loss: 0.469 Vali Loss: 0.691 Vali Acc: 0.875 Test Loss: 0.691 Test Acc: 0.875
Validation loss decreased (-0.849993 --> -0.874993).  Saving model ...
Epoch: 15 cost time: 0.42055559158325195
Epoch: 15, Steps: 3 | Train Loss: 0.420 Vali Loss: 0.616 Vali Acc: 0.900 Test Loss: 0.616 Test Acc: 0.900
Validation loss decreased (-0.874993 --> -0.899994).  Saving model ...
Epoch: 16 cost time: 0.4803159236907959
Epoch: 16, Steps: 3 | Train Loss: 0.391 Vali Loss: 0.552 Vali Acc: 0.925 Test Loss: 0.552 Test Acc: 0.925
Validation loss decreased (-0.899994 --> -0.924994).  Saving model ...
Epoch: 17 cost time: 0.4673480987548828
Epoch: 17, Steps: 3 | Train Loss: 0.353 Vali Loss: 0.489 Vali Acc: 0.950 Test Loss: 0.489 Test Acc: 0.950
Validation loss decreased (-0.924994 --> -0.949995).  Saving model ...
Epoch: 18 cost time: 0.43364572525024414
Epoch: 18, Steps: 3 | Train Loss: 0.310 Vali Loss: 0.435 Vali Acc: 0.925 Test Loss: 0.435 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.4145548343658447
Epoch: 19, Steps: 3 | Train Loss: 0.277 Vali Loss: 0.405 Vali Acc: 0.925 Test Loss: 0.405 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.4087049961090088
Epoch: 20, Steps: 3 | Train Loss: 0.244 Vali Loss: 0.378 Vali Acc: 0.925 Test Loss: 0.378 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.394153356552124
Epoch: 21, Steps: 3 | Train Loss: 0.232 Vali Loss: 0.358 Vali Acc: 0.925 Test Loss: 0.358 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.4810521602630615
Epoch: 22, Steps: 3 | Train Loss: 0.241 Vali Loss: 0.333 Vali Acc: 0.925 Test Loss: 0.333 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.43261027336120605
Epoch: 23, Steps: 3 | Train Loss: 0.195 Vali Loss: 0.315 Vali Acc: 0.950 Test Loss: 0.315 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949997).  Saving model ...
Epoch: 24 cost time: 0.4572153091430664
Epoch: 24, Steps: 3 | Train Loss: 0.170 Vali Loss: 0.305 Vali Acc: 0.950 Test Loss: 0.305 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 25 cost time: 0.44712233543395996
Epoch: 25, Steps: 3 | Train Loss: 0.176 Vali Loss: 0.289 Vali Acc: 0.950 Test Loss: 0.289 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 26 cost time: 0.3867628574371338
Epoch: 26, Steps: 3 | Train Loss: 0.149 Vali Loss: 0.277 Vali Acc: 0.950 Test Loss: 0.277 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 27 cost time: 0.38315892219543457
Epoch: 27, Steps: 3 | Train Loss: 0.140 Vali Loss: 0.263 Vali Acc: 0.950 Test Loss: 0.263 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 28 cost time: 0.46588826179504395
Epoch: 28, Steps: 3 | Train Loss: 0.116 Vali Loss: 0.246 Vali Acc: 0.950 Test Loss: 0.246 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 29 cost time: 0.4864373207092285
Epoch: 29, Steps: 3 | Train Loss: 0.146 Vali Loss: 0.239 Vali Acc: 0.950 Test Loss: 0.239 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 30 cost time: 0.40376996994018555
Epoch: 30, Steps: 3 | Train Loss: 0.112 Vali Loss: 0.229 Vali Acc: 0.950 Test Loss: 0.229 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 31 cost time: 0.40091371536254883
Epoch: 31, Steps: 3 | Train Loss: 0.094 Vali Loss: 0.217 Vali Acc: 0.950 Test Loss: 0.217 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 32 cost time: 0.40491294860839844
Epoch: 32, Steps: 3 | Train Loss: 0.071 Vali Loss: 0.218 Vali Acc: 0.950 Test Loss: 0.218 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.4111166000366211
Epoch: 33, Steps: 3 | Train Loss: 0.071 Vali Loss: 0.204 Vali Acc: 0.950 Test Loss: 0.204 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 34 cost time: 0.5223541259765625
Epoch: 34, Steps: 3 | Train Loss: 0.058 Vali Loss: 0.194 Vali Acc: 0.950 Test Loss: 0.194 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 35 cost time: 0.5064589977264404
Epoch: 35, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.190 Vali Acc: 0.950 Test Loss: 0.190 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 36 cost time: 0.4221808910369873
Epoch: 36, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.188 Vali Acc: 0.950 Test Loss: 0.188 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 37 cost time: 0.446514368057251
Epoch: 37, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.180 Vali Acc: 0.950 Test Loss: 0.180 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 38 cost time: 0.40086960792541504
Epoch: 38, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.173 Vali Acc: 0.950 Test Loss: 0.173 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 39 cost time: 0.42032575607299805
Epoch: 39, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.171 Vali Acc: 0.950 Test Loss: 0.171 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 40 cost time: 0.41826486587524414
Epoch: 40, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.178 Vali Acc: 0.950 Test Loss: 0.178 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.40911149978637695
Epoch: 41, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.183 Vali Acc: 0.950 Test Loss: 0.183 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.4326810836791992
Epoch: 42, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.177 Vali Acc: 0.950 Test Loss: 0.177 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.4073779582977295
Epoch: 43, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.176 Vali Acc: 0.950 Test Loss: 0.176 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.42154955863952637
Epoch: 44, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.171 Vali Acc: 0.950 Test Loss: 0.171 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.4266502857208252
Epoch: 45, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.172 Vali Acc: 0.950 Test Loss: 0.172 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.4338057041168213
Epoch: 46, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.170 Vali Acc: 0.950 Test Loss: 0.170 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 47 cost time: 0.44541501998901367
Epoch: 47, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.175 Vali Acc: 0.950 Test Loss: 0.175 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.44428420066833496
Epoch: 48, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.177 Vali Acc: 0.950 Test Loss: 0.177 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.427109956741333
Epoch: 49, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.168 Vali Acc: 0.950 Test Loss: 0.168 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 50 cost time: 0.4397604465484619
Epoch: 50, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.162 Vali Acc: 0.950 Test Loss: 0.162 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 365188
model size : 1.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.636538028717041
Epoch: 1, Steps: 3 | Train Loss: 1.398 Vali Loss: 1.376 Vali Acc: 0.325 Test Loss: 1.376 Test Acc: 0.325
Validation loss decreased (inf --> -0.324986).  Saving model ...
Epoch: 2 cost time: 0.39885807037353516
Epoch: 2, Steps: 3 | Train Loss: 1.356 Vali Loss: 1.361 Vali Acc: 0.325 Test Loss: 1.361 Test Acc: 0.325
Validation loss decreased (-0.324986 --> -0.324986).  Saving model ...
Epoch: 3 cost time: 0.4402201175689697
Epoch: 3, Steps: 3 | Train Loss: 1.324 Vali Loss: 1.337 Vali Acc: 0.400 Test Loss: 1.337 Test Acc: 0.400
Validation loss decreased (-0.324986 --> -0.399987).  Saving model ...
Epoch: 4 cost time: 0.4086270332336426
Epoch: 4, Steps: 3 | Train Loss: 1.266 Vali Loss: 1.297 Vali Acc: 0.450 Test Loss: 1.297 Test Acc: 0.450
Validation loss decreased (-0.399987 --> -0.449987).  Saving model ...
Epoch: 5 cost time: 0.47821855545043945
Epoch: 5, Steps: 3 | Train Loss: 1.181 Vali Loss: 1.250 Vali Acc: 0.650 Test Loss: 1.250 Test Acc: 0.650
Validation loss decreased (-0.449987 --> -0.649987).  Saving model ...
Epoch: 6 cost time: 0.43739843368530273
Epoch: 6, Steps: 3 | Train Loss: 1.131 Vali Loss: 1.193 Vali Acc: 0.700 Test Loss: 1.193 Test Acc: 0.700
Validation loss decreased (-0.649987 --> -0.699988).  Saving model ...
Epoch: 7 cost time: 0.40552449226379395
Epoch: 7, Steps: 3 | Train Loss: 1.047 Vali Loss: 1.125 Vali Acc: 0.775 Test Loss: 1.125 Test Acc: 0.775
Validation loss decreased (-0.699988 --> -0.774989).  Saving model ...
Epoch: 8 cost time: 0.4253699779510498
Epoch: 8, Steps: 3 | Train Loss: 0.958 Vali Loss: 1.062 Vali Acc: 0.800 Test Loss: 1.062 Test Acc: 0.800
Validation loss decreased (-0.774989 --> -0.799989).  Saving model ...
Epoch: 9 cost time: 0.39412593841552734
Epoch: 9, Steps: 3 | Train Loss: 0.865 Vali Loss: 0.988 Vali Acc: 0.825 Test Loss: 0.988 Test Acc: 0.825
Validation loss decreased (-0.799989 --> -0.824990).  Saving model ...
Epoch: 10 cost time: 0.4151787757873535
Epoch: 10, Steps: 3 | Train Loss: 0.794 Vali Loss: 0.917 Vali Acc: 0.775 Test Loss: 0.917 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.44657158851623535
Epoch: 11, Steps: 3 | Train Loss: 0.702 Vali Loss: 0.854 Vali Acc: 0.850 Test Loss: 0.854 Test Acc: 0.850
Validation loss decreased (-0.824990 --> -0.849991).  Saving model ...
Epoch: 12 cost time: 0.48943638801574707
Epoch: 12, Steps: 3 | Train Loss: 0.677 Vali Loss: 0.788 Vali Acc: 0.900 Test Loss: 0.788 Test Acc: 0.900
Validation loss decreased (-0.849991 --> -0.899992).  Saving model ...
Epoch: 13 cost time: 0.41733860969543457
Epoch: 13, Steps: 3 | Train Loss: 0.594 Vali Loss: 0.712 Vali Acc: 0.925 Test Loss: 0.712 Test Acc: 0.925
Validation loss decreased (-0.899992 --> -0.924993).  Saving model ...
Epoch: 14 cost time: 0.4246094226837158
Epoch: 14, Steps: 3 | Train Loss: 0.540 Vali Loss: 0.655 Vali Acc: 0.925 Test Loss: 0.655 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924993).  Saving model ...
Epoch: 15 cost time: 0.4067041873931885
Epoch: 15, Steps: 3 | Train Loss: 0.468 Vali Loss: 0.602 Vali Acc: 0.900 Test Loss: 0.602 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.387253999710083
Epoch: 16, Steps: 3 | Train Loss: 0.440 Vali Loss: 0.559 Vali Acc: 0.850 Test Loss: 0.559 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.4028630256652832
Epoch: 17, Steps: 3 | Train Loss: 0.415 Vali Loss: 0.510 Vali Acc: 0.875 Test Loss: 0.510 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.4787557125091553
Epoch: 18, Steps: 3 | Train Loss: 0.362 Vali Loss: 0.472 Vali Acc: 0.925 Test Loss: 0.472 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924995).  Saving model ...
Epoch: 19 cost time: 0.3924849033355713
Epoch: 19, Steps: 3 | Train Loss: 0.342 Vali Loss: 0.438 Vali Acc: 0.950 Test Loss: 0.438 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949996).  Saving model ...
Epoch: 20 cost time: 0.390002965927124
Epoch: 20, Steps: 3 | Train Loss: 0.314 Vali Loss: 0.407 Vali Acc: 0.975 Test Loss: 0.407 Test Acc: 0.975
Validation loss decreased (-0.949996 --> -0.974996).  Saving model ...
Epoch: 21 cost time: 0.4069645404815674
Epoch: 21, Steps: 3 | Train Loss: 0.294 Vali Loss: 0.378 Vali Acc: 0.950 Test Loss: 0.378 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.40404272079467773
Epoch: 22, Steps: 3 | Train Loss: 0.257 Vali Loss: 0.367 Vali Acc: 0.925 Test Loss: 0.367 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.42110157012939453
Epoch: 23, Steps: 3 | Train Loss: 0.258 Vali Loss: 0.342 Vali Acc: 0.925 Test Loss: 0.342 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.44676661491394043
Epoch: 24, Steps: 3 | Train Loss: 0.231 Vali Loss: 0.331 Vali Acc: 0.925 Test Loss: 0.331 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.41376376152038574
Epoch: 25, Steps: 3 | Train Loss: 0.203 Vali Loss: 0.314 Vali Acc: 0.925 Test Loss: 0.314 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.42713165283203125
Epoch: 26, Steps: 3 | Train Loss: 0.214 Vali Loss: 0.291 Vali Acc: 0.950 Test Loss: 0.291 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.4450654983520508
Epoch: 27, Steps: 3 | Train Loss: 0.175 Vali Loss: 0.266 Vali Acc: 0.975 Test Loss: 0.266 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 28 cost time: 0.44814300537109375
Epoch: 28, Steps: 3 | Train Loss: 0.170 Vali Loss: 0.251 Vali Acc: 0.975 Test Loss: 0.251 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 29 cost time: 0.4301323890686035
Epoch: 29, Steps: 3 | Train Loss: 0.166 Vali Loss: 0.235 Vali Acc: 0.975 Test Loss: 0.235 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 30 cost time: 0.41225409507751465
Epoch: 30, Steps: 3 | Train Loss: 0.132 Vali Loss: 0.222 Vali Acc: 0.975 Test Loss: 0.222 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 31 cost time: 0.41635632514953613
Epoch: 31, Steps: 3 | Train Loss: 0.132 Vali Loss: 0.209 Vali Acc: 0.975 Test Loss: 0.209 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 32 cost time: 0.43547797203063965
Epoch: 32, Steps: 3 | Train Loss: 0.109 Vali Loss: 0.193 Vali Acc: 0.975 Test Loss: 0.193 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 33 cost time: 0.3976266384124756
Epoch: 33, Steps: 3 | Train Loss: 0.091 Vali Loss: 0.186 Vali Acc: 0.975 Test Loss: 0.186 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 34 cost time: 0.4205446243286133
Epoch: 34, Steps: 3 | Train Loss: 0.086 Vali Loss: 0.176 Vali Acc: 0.975 Test Loss: 0.176 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 35 cost time: 0.45281386375427246
Epoch: 35, Steps: 3 | Train Loss: 0.092 Vali Loss: 0.175 Vali Acc: 0.975 Test Loss: 0.175 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 36 cost time: 0.4389655590057373
Epoch: 36, Steps: 3 | Train Loss: 0.071 Vali Loss: 0.171 Vali Acc: 0.975 Test Loss: 0.171 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 37 cost time: 0.44988274574279785
Epoch: 37, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.169 Vali Acc: 0.975 Test Loss: 0.169 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 38 cost time: 0.4382474422454834
Epoch: 38, Steps: 3 | Train Loss: 0.061 Vali Loss: 0.159 Vali Acc: 0.975 Test Loss: 0.159 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 39 cost time: 0.4144785404205322
Epoch: 39, Steps: 3 | Train Loss: 0.058 Vali Loss: 0.155 Vali Acc: 0.975 Test Loss: 0.155 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 40 cost time: 0.44045400619506836
Epoch: 40, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.157 Vali Acc: 0.950 Test Loss: 0.157 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.41858768463134766
Epoch: 41, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.144 Vali Acc: 0.950 Test Loss: 0.144 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.4016115665435791
Epoch: 42, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.137 Vali Acc: 0.950 Test Loss: 0.137 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.4211277961730957
Epoch: 43, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.129 Vali Acc: 0.975 Test Loss: 0.129 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974999).  Saving model ...
Epoch: 44 cost time: 0.4476914405822754
Epoch: 44, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.128 Vali Acc: 0.975 Test Loss: 0.128 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 45 cost time: 0.44937896728515625
Epoch: 45, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.127 Vali Acc: 0.975 Test Loss: 0.127 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 46 cost time: 0.4689664840698242
Epoch: 46, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.128 Vali Acc: 0.950 Test Loss: 0.128 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.438626766204834
Epoch: 47, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.119 Vali Acc: 0.950 Test Loss: 0.119 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.43039369583129883
Epoch: 48, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.120 Vali Acc: 0.950 Test Loss: 0.120 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.45258593559265137
Epoch: 49, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.122 Vali Acc: 0.950 Test Loss: 0.122 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.4534416198730469
Epoch: 50, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.116 Vali Acc: 0.950 Test Loss: 0.116 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 352964
model size : 1.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.5650944709777832
Epoch: 1, Steps: 3 | Train Loss: 1.429 Vali Loss: 1.374 Vali Acc: 0.400 Test Loss: 1.374 Test Acc: 0.400
Validation loss decreased (inf --> -0.399986).  Saving model ...
Epoch: 2 cost time: 0.41944408416748047
Epoch: 2, Steps: 3 | Train Loss: 1.398 Vali Loss: 1.366 Vali Acc: 0.425 Test Loss: 1.366 Test Acc: 0.425
Validation loss decreased (-0.399986 --> -0.424986).  Saving model ...
Epoch: 3 cost time: 0.4475090503692627
Epoch: 3, Steps: 3 | Train Loss: 1.380 Vali Loss: 1.351 Vali Acc: 0.400 Test Loss: 1.351 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.41884326934814453
Epoch: 4, Steps: 3 | Train Loss: 1.319 Vali Loss: 1.326 Vali Acc: 0.450 Test Loss: 1.326 Test Acc: 0.450
Validation loss decreased (-0.424986 --> -0.449987).  Saving model ...
Epoch: 5 cost time: 0.4520456790924072
Epoch: 5, Steps: 3 | Train Loss: 1.259 Vali Loss: 1.291 Vali Acc: 0.450 Test Loss: 1.291 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449987).  Saving model ...
Epoch: 6 cost time: 0.42546582221984863
Epoch: 6, Steps: 3 | Train Loss: 1.174 Vali Loss: 1.252 Vali Acc: 0.475 Test Loss: 1.252 Test Acc: 0.475
Validation loss decreased (-0.449987 --> -0.474987).  Saving model ...
Epoch: 7 cost time: 0.43944430351257324
Epoch: 7, Steps: 3 | Train Loss: 1.126 Vali Loss: 1.201 Vali Acc: 0.575 Test Loss: 1.201 Test Acc: 0.575
Validation loss decreased (-0.474987 --> -0.574988).  Saving model ...
Epoch: 8 cost time: 0.4132730960845947
Epoch: 8, Steps: 3 | Train Loss: 1.029 Vali Loss: 1.147 Vali Acc: 0.650 Test Loss: 1.147 Test Acc: 0.650
Validation loss decreased (-0.574988 --> -0.649989).  Saving model ...
Epoch: 9 cost time: 0.4492919445037842
Epoch: 9, Steps: 3 | Train Loss: 0.968 Vali Loss: 1.087 Vali Acc: 0.800 Test Loss: 1.087 Test Acc: 0.800
Validation loss decreased (-0.649989 --> -0.799989).  Saving model ...
Epoch: 10 cost time: 0.3906588554382324
Epoch: 10, Steps: 3 | Train Loss: 0.900 Vali Loss: 1.022 Vali Acc: 0.850 Test Loss: 1.022 Test Acc: 0.850
Validation loss decreased (-0.799989 --> -0.849990).  Saving model ...
Epoch: 11 cost time: 0.45917701721191406
Epoch: 11, Steps: 3 | Train Loss: 0.795 Vali Loss: 0.961 Vali Acc: 0.850 Test Loss: 0.961 Test Acc: 0.850
Validation loss decreased (-0.849990 --> -0.849990).  Saving model ...
Epoch: 12 cost time: 0.4753103256225586
Epoch: 12, Steps: 3 | Train Loss: 0.746 Vali Loss: 0.904 Vali Acc: 0.875 Test Loss: 0.904 Test Acc: 0.875
Validation loss decreased (-0.849990 --> -0.874991).  Saving model ...
Epoch: 13 cost time: 0.4527928829193115
Epoch: 13, Steps: 3 | Train Loss: 0.680 Vali Loss: 0.847 Vali Acc: 0.900 Test Loss: 0.847 Test Acc: 0.900
Validation loss decreased (-0.874991 --> -0.899992).  Saving model ...
Epoch: 14 cost time: 0.4457814693450928
Epoch: 14, Steps: 3 | Train Loss: 0.638 Vali Loss: 0.788 Vali Acc: 0.900 Test Loss: 0.788 Test Acc: 0.900
Validation loss decreased (-0.899992 --> -0.899992).  Saving model ...
Epoch: 15 cost time: 0.4086620807647705
Epoch: 15, Steps: 3 | Train Loss: 0.551 Vali Loss: 0.743 Vali Acc: 0.900 Test Loss: 0.743 Test Acc: 0.900
Validation loss decreased (-0.899992 --> -0.899993).  Saving model ...
Epoch: 16 cost time: 0.4034547805786133
Epoch: 16, Steps: 3 | Train Loss: 0.505 Vali Loss: 0.703 Vali Acc: 0.900 Test Loss: 0.703 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 17 cost time: 0.43042659759521484
Epoch: 17, Steps: 3 | Train Loss: 0.468 Vali Loss: 0.670 Vali Acc: 0.875 Test Loss: 0.670 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.47100353240966797
Epoch: 18, Steps: 3 | Train Loss: 0.446 Vali Loss: 0.613 Vali Acc: 0.875 Test Loss: 0.613 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.46034789085388184
Epoch: 19, Steps: 3 | Train Loss: 0.397 Vali Loss: 0.572 Vali Acc: 0.875 Test Loss: 0.572 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.44072580337524414
Epoch: 20, Steps: 3 | Train Loss: 0.378 Vali Loss: 0.533 Vali Acc: 0.900 Test Loss: 0.533 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899995).  Saving model ...
Epoch: 21 cost time: 0.43398523330688477
Epoch: 21, Steps: 3 | Train Loss: 0.343 Vali Loss: 0.496 Vali Acc: 0.925 Test Loss: 0.496 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924995).  Saving model ...
Epoch: 22 cost time: 0.3923642635345459
Epoch: 22, Steps: 3 | Train Loss: 0.323 Vali Loss: 0.472 Vali Acc: 0.925 Test Loss: 0.472 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 23 cost time: 0.4346463680267334
Epoch: 23, Steps: 3 | Train Loss: 0.273 Vali Loss: 0.435 Vali Acc: 0.925 Test Loss: 0.435 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 24 cost time: 0.4160037040710449
Epoch: 24, Steps: 3 | Train Loss: 0.279 Vali Loss: 0.421 Vali Acc: 0.925 Test Loss: 0.421 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 25 cost time: 0.4128692150115967
Epoch: 25, Steps: 3 | Train Loss: 0.268 Vali Loss: 0.402 Vali Acc: 0.925 Test Loss: 0.402 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 26 cost time: 0.4348485469818115
Epoch: 26, Steps: 3 | Train Loss: 0.246 Vali Loss: 0.382 Vali Acc: 0.925 Test Loss: 0.382 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 27 cost time: 0.40193819999694824
Epoch: 27, Steps: 3 | Train Loss: 0.228 Vali Loss: 0.363 Vali Acc: 0.925 Test Loss: 0.363 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 28 cost time: 0.44808459281921387
Epoch: 28, Steps: 3 | Train Loss: 0.215 Vali Loss: 0.344 Vali Acc: 0.925 Test Loss: 0.344 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924997).  Saving model ...
Epoch: 29 cost time: 0.44467926025390625
Epoch: 29, Steps: 3 | Train Loss: 0.203 Vali Loss: 0.341 Vali Acc: 0.925 Test Loss: 0.341 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 30 cost time: 0.3759429454803467
Epoch: 30, Steps: 3 | Train Loss: 0.170 Vali Loss: 0.324 Vali Acc: 0.925 Test Loss: 0.324 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 31 cost time: 0.4043881893157959
Epoch: 31, Steps: 3 | Train Loss: 0.164 Vali Loss: 0.312 Vali Acc: 0.925 Test Loss: 0.312 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 32 cost time: 0.39876699447631836
Epoch: 32, Steps: 3 | Train Loss: 0.166 Vali Loss: 0.303 Vali Acc: 0.925 Test Loss: 0.303 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 33 cost time: 0.42522358894348145
Epoch: 33, Steps: 3 | Train Loss: 0.166 Vali Loss: 0.287 Vali Acc: 0.925 Test Loss: 0.287 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 34 cost time: 0.42259669303894043
Epoch: 34, Steps: 3 | Train Loss: 0.136 Vali Loss: 0.279 Vali Acc: 0.925 Test Loss: 0.279 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 35 cost time: 0.4181041717529297
Epoch: 35, Steps: 3 | Train Loss: 0.122 Vali Loss: 0.270 Vali Acc: 0.925 Test Loss: 0.270 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 36 cost time: 0.4073817729949951
Epoch: 36, Steps: 3 | Train Loss: 0.114 Vali Loss: 0.264 Vali Acc: 0.925 Test Loss: 0.264 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 37 cost time: 0.39560437202453613
Epoch: 37, Steps: 3 | Train Loss: 0.101 Vali Loss: 0.259 Vali Acc: 0.925 Test Loss: 0.259 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 38 cost time: 0.44554853439331055
Epoch: 38, Steps: 3 | Train Loss: 0.108 Vali Loss: 0.255 Vali Acc: 0.925 Test Loss: 0.255 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 39 cost time: 0.42321205139160156
Epoch: 39, Steps: 3 | Train Loss: 0.095 Vali Loss: 0.248 Vali Acc: 0.925 Test Loss: 0.248 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924998).  Saving model ...
Epoch: 40 cost time: 0.4436683654785156
Epoch: 40, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.248 Vali Acc: 0.925 Test Loss: 0.248 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.39791131019592285
Epoch: 41, Steps: 3 | Train Loss: 0.081 Vali Loss: 0.243 Vali Acc: 0.925 Test Loss: 0.243 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 42 cost time: 0.41423749923706055
Epoch: 42, Steps: 3 | Train Loss: 0.073 Vali Loss: 0.237 Vali Acc: 0.925 Test Loss: 0.237 Test Acc: 0.925
Validation loss decreased (-0.924998 --> -0.924998).  Saving model ...
Epoch: 43 cost time: 0.4631969928741455
Epoch: 43, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.234 Vali Acc: 0.950 Test Loss: 0.234 Test Acc: 0.950
Validation loss decreased (-0.924998 --> -0.949998).  Saving model ...
Epoch: 44 cost time: 0.4238862991333008
Epoch: 44, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.226 Vali Acc: 0.950 Test Loss: 0.226 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 45 cost time: 0.41420412063598633
Epoch: 45, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.220 Vali Acc: 0.950 Test Loss: 0.220 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 46 cost time: 0.43092989921569824
Epoch: 46, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.218 Vali Acc: 0.950 Test Loss: 0.218 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 47 cost time: 0.47488999366760254
Epoch: 47, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.212 Vali Acc: 0.950 Test Loss: 0.212 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 48 cost time: 0.39801836013793945
Epoch: 48, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.214 Vali Acc: 0.950 Test Loss: 0.214 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.3908722400665283
Epoch: 49, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.211 Vali Acc: 0.950 Test Loss: 0.211 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 50 cost time: 0.4638068675994873
Epoch: 50, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.213 Vali Acc: 0.950 Test Loss: 0.213 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 346916
model size : 1.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.5809075832366943
Epoch: 1, Steps: 3 | Train Loss: 1.427 Vali Loss: 1.348 Vali Acc: 0.200 Test Loss: 1.348 Test Acc: 0.200
Validation loss decreased (inf --> -0.199987).  Saving model ...
Epoch: 2 cost time: 0.46161651611328125
Epoch: 2, Steps: 3 | Train Loss: 1.378 Vali Loss: 1.337 Vali Acc: 0.200 Test Loss: 1.337 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199987).  Saving model ...
Epoch: 3 cost time: 0.40175962448120117
Epoch: 3, Steps: 3 | Train Loss: 1.362 Vali Loss: 1.321 Vali Acc: 0.200 Test Loss: 1.321 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199987).  Saving model ...
Epoch: 4 cost time: 0.3866617679595947
Epoch: 4, Steps: 3 | Train Loss: 1.325 Vali Loss: 1.298 Vali Acc: 0.275 Test Loss: 1.298 Test Acc: 0.275
Validation loss decreased (-0.199987 --> -0.274987).  Saving model ...
Epoch: 5 cost time: 0.41226816177368164
Epoch: 5, Steps: 3 | Train Loss: 1.271 Vali Loss: 1.270 Vali Acc: 0.375 Test Loss: 1.270 Test Acc: 0.375
Validation loss decreased (-0.274987 --> -0.374987).  Saving model ...
Epoch: 6 cost time: 0.4082064628601074
Epoch: 6, Steps: 3 | Train Loss: 1.225 Vali Loss: 1.237 Vali Acc: 0.625 Test Loss: 1.237 Test Acc: 0.625
Validation loss decreased (-0.374987 --> -0.624988).  Saving model ...
Epoch: 7 cost time: 0.4230682849884033
Epoch: 7, Steps: 3 | Train Loss: 1.185 Vali Loss: 1.198 Vali Acc: 0.725 Test Loss: 1.198 Test Acc: 0.725
Validation loss decreased (-0.624988 --> -0.724988).  Saving model ...
Epoch: 8 cost time: 0.45368456840515137
Epoch: 8, Steps: 3 | Train Loss: 1.107 Vali Loss: 1.159 Vali Acc: 0.775 Test Loss: 1.159 Test Acc: 0.775
Validation loss decreased (-0.724988 --> -0.774988).  Saving model ...
Epoch: 9 cost time: 0.4424121379852295
Epoch: 9, Steps: 3 | Train Loss: 1.051 Vali Loss: 1.122 Vali Acc: 0.750 Test Loss: 1.122 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.4812891483306885
Epoch: 10, Steps: 3 | Train Loss: 0.970 Vali Loss: 1.082 Vali Acc: 0.775 Test Loss: 1.082 Test Acc: 0.775
Validation loss decreased (-0.774988 --> -0.774989).  Saving model ...
Epoch: 11 cost time: 0.40998387336730957
Epoch: 11, Steps: 3 | Train Loss: 0.917 Vali Loss: 1.032 Vali Acc: 0.775 Test Loss: 1.032 Test Acc: 0.775
Validation loss decreased (-0.774989 --> -0.774990).  Saving model ...
Epoch: 12 cost time: 0.3755369186401367
Epoch: 12, Steps: 3 | Train Loss: 0.872 Vali Loss: 0.993 Vali Acc: 0.775 Test Loss: 0.993 Test Acc: 0.775
Validation loss decreased (-0.774990 --> -0.774990).  Saving model ...
Epoch: 13 cost time: 0.38437914848327637
Epoch: 13, Steps: 3 | Train Loss: 0.802 Vali Loss: 0.945 Vali Acc: 0.775 Test Loss: 0.945 Test Acc: 0.775
Validation loss decreased (-0.774990 --> -0.774991).  Saving model ...
Epoch: 14 cost time: 0.43021726608276367
Epoch: 14, Steps: 3 | Train Loss: 0.730 Vali Loss: 0.905 Vali Acc: 0.775 Test Loss: 0.905 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 15 cost time: 0.3701610565185547
Epoch: 15, Steps: 3 | Train Loss: 0.700 Vali Loss: 0.867 Vali Acc: 0.800 Test Loss: 0.867 Test Acc: 0.800
Validation loss decreased (-0.774991 --> -0.799991).  Saving model ...
Epoch: 16 cost time: 0.4448857307434082
Epoch: 16, Steps: 3 | Train Loss: 0.624 Vali Loss: 0.812 Vali Acc: 0.825 Test Loss: 0.812 Test Acc: 0.825
Validation loss decreased (-0.799991 --> -0.824992).  Saving model ...
Epoch: 17 cost time: 0.4010469913482666
Epoch: 17, Steps: 3 | Train Loss: 0.609 Vali Loss: 0.765 Vali Acc: 0.825 Test Loss: 0.765 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 18 cost time: 0.4369690418243408
Epoch: 18, Steps: 3 | Train Loss: 0.571 Vali Loss: 0.733 Vali Acc: 0.825 Test Loss: 0.733 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824993).  Saving model ...
Epoch: 19 cost time: 0.4249444007873535
Epoch: 19, Steps: 3 | Train Loss: 0.516 Vali Loss: 0.689 Vali Acc: 0.850 Test Loss: 0.689 Test Acc: 0.850
Validation loss decreased (-0.824993 --> -0.849993).  Saving model ...
Epoch: 20 cost time: 0.4210090637207031
Epoch: 20, Steps: 3 | Train Loss: 0.492 Vali Loss: 0.651 Vali Acc: 0.825 Test Loss: 0.651 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.4221019744873047
Epoch: 21, Steps: 3 | Train Loss: 0.443 Vali Loss: 0.620 Vali Acc: 0.825 Test Loss: 0.620 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.40675926208496094
Epoch: 22, Steps: 3 | Train Loss: 0.412 Vali Loss: 0.587 Vali Acc: 0.850 Test Loss: 0.587 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849994).  Saving model ...
Epoch: 23 cost time: 0.4083523750305176
Epoch: 23, Steps: 3 | Train Loss: 0.406 Vali Loss: 0.559 Vali Acc: 0.850 Test Loss: 0.559 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849994).  Saving model ...
Epoch: 24 cost time: 0.420285701751709
Epoch: 24, Steps: 3 | Train Loss: 0.376 Vali Loss: 0.524 Vali Acc: 0.900 Test Loss: 0.524 Test Acc: 0.900
Validation loss decreased (-0.849994 --> -0.899995).  Saving model ...
Epoch: 25 cost time: 0.3901560306549072
Epoch: 25, Steps: 3 | Train Loss: 0.342 Vali Loss: 0.505 Vali Acc: 0.950 Test Loss: 0.505 Test Acc: 0.950
Validation loss decreased (-0.899995 --> -0.949995).  Saving model ...
Epoch: 26 cost time: 0.3873417377471924
Epoch: 26, Steps: 3 | Train Loss: 0.333 Vali Loss: 0.485 Vali Acc: 0.950 Test Loss: 0.485 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 27 cost time: 0.43411803245544434
Epoch: 27, Steps: 3 | Train Loss: 0.296 Vali Loss: 0.467 Vali Acc: 0.975 Test Loss: 0.467 Test Acc: 0.975
Validation loss decreased (-0.949995 --> -0.974995).  Saving model ...
Epoch: 28 cost time: 0.38330936431884766
Epoch: 28, Steps: 3 | Train Loss: 0.291 Vali Loss: 0.453 Vali Acc: 0.975 Test Loss: 0.453 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 29 cost time: 0.4121124744415283
Epoch: 29, Steps: 3 | Train Loss: 0.282 Vali Loss: 0.439 Vali Acc: 0.975 Test Loss: 0.439 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 30 cost time: 0.43363165855407715
Epoch: 30, Steps: 3 | Train Loss: 0.249 Vali Loss: 0.420 Vali Acc: 0.975 Test Loss: 0.420 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 31 cost time: 0.38864684104919434
Epoch: 31, Steps: 3 | Train Loss: 0.241 Vali Loss: 0.396 Vali Acc: 0.975 Test Loss: 0.396 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 32 cost time: 0.5058877468109131
Epoch: 32, Steps: 3 | Train Loss: 0.230 Vali Loss: 0.377 Vali Acc: 0.975 Test Loss: 0.377 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 33 cost time: 0.48948168754577637
Epoch: 33, Steps: 3 | Train Loss: 0.217 Vali Loss: 0.360 Vali Acc: 0.950 Test Loss: 0.360 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.461275577545166
Epoch: 34, Steps: 3 | Train Loss: 0.206 Vali Loss: 0.345 Vali Acc: 0.950 Test Loss: 0.345 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.41701221466064453
Epoch: 35, Steps: 3 | Train Loss: 0.210 Vali Loss: 0.333 Vali Acc: 0.950 Test Loss: 0.333 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.45110034942626953
Epoch: 36, Steps: 3 | Train Loss: 0.207 Vali Loss: 0.314 Vali Acc: 0.975 Test Loss: 0.314 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 37 cost time: 0.40195727348327637
Epoch: 37, Steps: 3 | Train Loss: 0.172 Vali Loss: 0.305 Vali Acc: 0.975 Test Loss: 0.305 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 38 cost time: 0.41014695167541504
Epoch: 38, Steps: 3 | Train Loss: 0.160 Vali Loss: 0.295 Vali Acc: 0.975 Test Loss: 0.295 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 39 cost time: 0.4317138195037842
Epoch: 39, Steps: 3 | Train Loss: 0.177 Vali Loss: 0.283 Vali Acc: 0.975 Test Loss: 0.283 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 40 cost time: 0.447160005569458
Epoch: 40, Steps: 3 | Train Loss: 0.138 Vali Loss: 0.287 Vali Acc: 0.975 Test Loss: 0.287 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.39333415031433105
Epoch: 41, Steps: 3 | Train Loss: 0.143 Vali Loss: 0.278 Vali Acc: 0.975 Test Loss: 0.278 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 42 cost time: 0.3832385540008545
Epoch: 42, Steps: 3 | Train Loss: 0.125 Vali Loss: 0.265 Vali Acc: 0.975 Test Loss: 0.265 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 43 cost time: 0.44756340980529785
Epoch: 43, Steps: 3 | Train Loss: 0.113 Vali Loss: 0.261 Vali Acc: 0.975 Test Loss: 0.261 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 44 cost time: 0.44057226181030273
Epoch: 44, Steps: 3 | Train Loss: 0.118 Vali Loss: 0.255 Vali Acc: 0.950 Test Loss: 0.255 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.41371750831604004
Epoch: 45, Steps: 3 | Train Loss: 0.103 Vali Loss: 0.244 Vali Acc: 0.975 Test Loss: 0.244 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 46 cost time: 0.44107556343078613
Epoch: 46, Steps: 3 | Train Loss: 0.106 Vali Loss: 0.238 Vali Acc: 0.950 Test Loss: 0.238 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.4096512794494629
Epoch: 47, Steps: 3 | Train Loss: 0.083 Vali Loss: 0.234 Vali Acc: 0.950 Test Loss: 0.234 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.481229305267334
Epoch: 48, Steps: 3 | Train Loss: 0.083 Vali Loss: 0.229 Vali Acc: 0.950 Test Loss: 0.229 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.4212367534637451
Epoch: 49, Steps: 3 | Train Loss: 0.071 Vali Loss: 0.225 Vali Acc: 0.950 Test Loss: 0.225 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.4169886112213135
Epoch: 50, Steps: 3 | Train Loss: 0.074 Vali Loss: 0.223 Vali Acc: 0.950 Test Loss: 0.223 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 340836
model size : 1.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.6072566509246826
Epoch: 1, Steps: 3 | Train Loss: 1.443 Vali Loss: 1.383 Vali Acc: 0.200 Test Loss: 1.383 Test Acc: 0.200
Validation loss decreased (inf --> -0.199986).  Saving model ...
Epoch: 2 cost time: 0.3936314582824707
Epoch: 2, Steps: 3 | Train Loss: 1.441 Vali Loss: 1.377 Vali Acc: 0.225 Test Loss: 1.377 Test Acc: 0.225
Validation loss decreased (-0.199986 --> -0.224986).  Saving model ...
Epoch: 3 cost time: 0.44967150688171387
Epoch: 3, Steps: 3 | Train Loss: 1.416 Vali Loss: 1.370 Vali Acc: 0.225 Test Loss: 1.370 Test Acc: 0.225
Validation loss decreased (-0.224986 --> -0.224986).  Saving model ...
Epoch: 4 cost time: 0.44491052627563477
Epoch: 4, Steps: 3 | Train Loss: 1.372 Vali Loss: 1.357 Vali Acc: 0.225 Test Loss: 1.357 Test Acc: 0.225
Validation loss decreased (-0.224986 --> -0.224986).  Saving model ...
Epoch: 5 cost time: 0.46675539016723633
Epoch: 5, Steps: 3 | Train Loss: 1.327 Vali Loss: 1.338 Vali Acc: 0.200 Test Loss: 1.338 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.4145076274871826
Epoch: 6, Steps: 3 | Train Loss: 1.289 Vali Loss: 1.315 Vali Acc: 0.325 Test Loss: 1.315 Test Acc: 0.325
Validation loss decreased (-0.224986 --> -0.324987).  Saving model ...
Epoch: 7 cost time: 0.43450093269348145
Epoch: 7, Steps: 3 | Train Loss: 1.250 Vali Loss: 1.287 Vali Acc: 0.550 Test Loss: 1.287 Test Acc: 0.550
Validation loss decreased (-0.324987 --> -0.549987).  Saving model ...
Epoch: 8 cost time: 0.42047739028930664
Epoch: 8, Steps: 3 | Train Loss: 1.181 Vali Loss: 1.257 Vali Acc: 0.625 Test Loss: 1.257 Test Acc: 0.625
Validation loss decreased (-0.549987 --> -0.624987).  Saving model ...
Epoch: 9 cost time: 0.43497562408447266
Epoch: 9, Steps: 3 | Train Loss: 1.142 Vali Loss: 1.223 Vali Acc: 0.675 Test Loss: 1.223 Test Acc: 0.675
Validation loss decreased (-0.624987 --> -0.674988).  Saving model ...
Epoch: 10 cost time: 0.3920886516571045
Epoch: 10, Steps: 3 | Train Loss: 1.117 Vali Loss: 1.181 Vali Acc: 0.725 Test Loss: 1.181 Test Acc: 0.725
Validation loss decreased (-0.674988 --> -0.724988).  Saving model ...
Epoch: 11 cost time: 0.3859715461730957
Epoch: 11, Steps: 3 | Train Loss: 1.028 Vali Loss: 1.147 Vali Acc: 0.775 Test Loss: 1.147 Test Acc: 0.775
Validation loss decreased (-0.724988 --> -0.774989).  Saving model ...
Epoch: 12 cost time: 0.4145314693450928
Epoch: 12, Steps: 3 | Train Loss: 0.985 Vali Loss: 1.110 Vali Acc: 0.825 Test Loss: 1.110 Test Acc: 0.825
Validation loss decreased (-0.774989 --> -0.824989).  Saving model ...
Epoch: 13 cost time: 0.4044804573059082
Epoch: 13, Steps: 3 | Train Loss: 0.940 Vali Loss: 1.073 Vali Acc: 0.850 Test Loss: 1.073 Test Acc: 0.850
Validation loss decreased (-0.824989 --> -0.849989).  Saving model ...
Epoch: 14 cost time: 0.4150047302246094
Epoch: 14, Steps: 3 | Train Loss: 0.887 Vali Loss: 1.037 Vali Acc: 0.825 Test Loss: 1.037 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.4764671325683594
Epoch: 15, Steps: 3 | Train Loss: 0.851 Vali Loss: 0.996 Vali Acc: 0.850 Test Loss: 0.996 Test Acc: 0.850
Validation loss decreased (-0.849989 --> -0.849990).  Saving model ...
Epoch: 16 cost time: 0.39972662925720215
Epoch: 16, Steps: 3 | Train Loss: 0.805 Vali Loss: 0.965 Vali Acc: 0.825 Test Loss: 0.965 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.4316742420196533
Epoch: 17, Steps: 3 | Train Loss: 0.734 Vali Loss: 0.940 Vali Acc: 0.825 Test Loss: 0.940 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.4404773712158203
Epoch: 18, Steps: 3 | Train Loss: 0.680 Vali Loss: 0.907 Vali Acc: 0.850 Test Loss: 0.907 Test Acc: 0.850
Validation loss decreased (-0.849990 --> -0.849991).  Saving model ...
Epoch: 19 cost time: 0.42691993713378906
Epoch: 19, Steps: 3 | Train Loss: 0.660 Vali Loss: 0.869 Vali Acc: 0.850 Test Loss: 0.869 Test Acc: 0.850
Validation loss decreased (-0.849991 --> -0.849991).  Saving model ...
Epoch: 20 cost time: 0.4245457649230957
Epoch: 20, Steps: 3 | Train Loss: 0.635 Vali Loss: 0.834 Vali Acc: 0.850 Test Loss: 0.834 Test Acc: 0.850
Validation loss decreased (-0.849991 --> -0.849992).  Saving model ...
Epoch: 21 cost time: 0.40712904930114746
Epoch: 21, Steps: 3 | Train Loss: 0.593 Vali Loss: 0.791 Vali Acc: 0.850 Test Loss: 0.791 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 22 cost time: 0.39181971549987793
Epoch: 22, Steps: 3 | Train Loss: 0.546 Vali Loss: 0.764 Vali Acc: 0.875 Test Loss: 0.764 Test Acc: 0.875
Validation loss decreased (-0.849992 --> -0.874992).  Saving model ...
Epoch: 23 cost time: 0.41723060607910156
Epoch: 23, Steps: 3 | Train Loss: 0.508 Vali Loss: 0.735 Vali Acc: 0.850 Test Loss: 0.735 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.4480149745941162
Epoch: 24, Steps: 3 | Train Loss: 0.481 Vali Loss: 0.703 Vali Acc: 0.875 Test Loss: 0.703 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874993).  Saving model ...
Epoch: 25 cost time: 0.4710233211517334
Epoch: 25, Steps: 3 | Train Loss: 0.474 Vali Loss: 0.671 Vali Acc: 0.875 Test Loss: 0.671 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 26 cost time: 0.415802001953125
Epoch: 26, Steps: 3 | Train Loss: 0.440 Vali Loss: 0.646 Vali Acc: 0.875 Test Loss: 0.646 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 27 cost time: 0.40927934646606445
Epoch: 27, Steps: 3 | Train Loss: 0.408 Vali Loss: 0.636 Vali Acc: 0.875 Test Loss: 0.636 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 28 cost time: 0.3904292583465576
Epoch: 28, Steps: 3 | Train Loss: 0.384 Vali Loss: 0.614 Vali Acc: 0.875 Test Loss: 0.614 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 29 cost time: 0.4349374771118164
Epoch: 29, Steps: 3 | Train Loss: 0.400 Vali Loss: 0.584 Vali Acc: 0.875 Test Loss: 0.584 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 30 cost time: 0.3686177730560303
Epoch: 30, Steps: 3 | Train Loss: 0.343 Vali Loss: 0.553 Vali Acc: 0.900 Test Loss: 0.553 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899994).  Saving model ...
Epoch: 31 cost time: 0.47728943824768066
Epoch: 31, Steps: 3 | Train Loss: 0.341 Vali Loss: 0.532 Vali Acc: 0.925 Test Loss: 0.532 Test Acc: 0.925
Validation loss decreased (-0.899994 --> -0.924995).  Saving model ...
Epoch: 32 cost time: 0.4493448734283447
Epoch: 32, Steps: 3 | Train Loss: 0.298 Vali Loss: 0.518 Vali Acc: 0.925 Test Loss: 0.518 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 33 cost time: 0.40569376945495605
Epoch: 33, Steps: 3 | Train Loss: 0.305 Vali Loss: 0.498 Vali Acc: 0.950 Test Loss: 0.498 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949995).  Saving model ...
Epoch: 34 cost time: 0.40471696853637695
Epoch: 34, Steps: 3 | Train Loss: 0.297 Vali Loss: 0.477 Vali Acc: 0.950 Test Loss: 0.477 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 35 cost time: 0.41408610343933105
Epoch: 35, Steps: 3 | Train Loss: 0.271 Vali Loss: 0.460 Vali Acc: 0.950 Test Loss: 0.460 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 36 cost time: 0.4194681644439697
Epoch: 36, Steps: 3 | Train Loss: 0.246 Vali Loss: 0.441 Vali Acc: 0.950 Test Loss: 0.441 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 37 cost time: 0.4699592590332031
Epoch: 37, Steps: 3 | Train Loss: 0.218 Vali Loss: 0.420 Vali Acc: 0.950 Test Loss: 0.420 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 38 cost time: 0.41958189010620117
Epoch: 38, Steps: 3 | Train Loss: 0.240 Vali Loss: 0.402 Vali Acc: 0.950 Test Loss: 0.402 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 39 cost time: 0.4430878162384033
Epoch: 39, Steps: 3 | Train Loss: 0.219 Vali Loss: 0.397 Vali Acc: 0.950 Test Loss: 0.397 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 40 cost time: 0.41037774085998535
Epoch: 40, Steps: 3 | Train Loss: 0.212 Vali Loss: 0.386 Vali Acc: 0.950 Test Loss: 0.386 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 41 cost time: 0.3945748805999756
Epoch: 41, Steps: 3 | Train Loss: 0.184 Vali Loss: 0.369 Vali Acc: 0.950 Test Loss: 0.369 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 42 cost time: 0.4080190658569336
Epoch: 42, Steps: 3 | Train Loss: 0.195 Vali Loss: 0.365 Vali Acc: 0.950 Test Loss: 0.365 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 43 cost time: 0.4074716567993164
Epoch: 43, Steps: 3 | Train Loss: 0.167 Vali Loss: 0.361 Vali Acc: 0.925 Test Loss: 0.361 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.39512205123901367
Epoch: 44, Steps: 3 | Train Loss: 0.157 Vali Loss: 0.350 Vali Acc: 0.925 Test Loss: 0.350 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.4474029541015625
Epoch: 45, Steps: 3 | Train Loss: 0.169 Vali Loss: 0.348 Vali Acc: 0.925 Test Loss: 0.348 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.4648764133453369
Epoch: 46, Steps: 3 | Train Loss: 0.145 Vali Loss: 0.335 Vali Acc: 0.925 Test Loss: 0.335 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.39368438720703125
Epoch: 47, Steps: 3 | Train Loss: 0.114 Vali Loss: 0.314 Vali Acc: 0.925 Test Loss: 0.314 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.38543105125427246
Epoch: 48, Steps: 3 | Train Loss: 0.126 Vali Loss: 0.307 Vali Acc: 0.925 Test Loss: 0.307 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.42192697525024414
Epoch: 49, Steps: 3 | Train Loss: 0.115 Vali Loss: 0.300 Vali Acc: 0.925 Test Loss: 0.300 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.4550740718841553
Epoch: 50, Steps: 3 | Train Loss: 0.108 Vali Loss: 0.290 Vali Acc: 0.925 Test Loss: 0.290 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 334852
model size : 1.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps20_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.65610671043396
Epoch: 1, Steps: 3 | Train Loss: 1.358 Vali Loss: 1.388 Vali Acc: 0.150 Test Loss: 1.388 Test Acc: 0.150
Validation loss decreased (inf --> -0.149986).  Saving model ...
Epoch: 2 cost time: 0.4143178462982178
Epoch: 2, Steps: 3 | Train Loss: 1.302 Vali Loss: 1.385 Vali Acc: 0.150 Test Loss: 1.385 Test Acc: 0.150
Validation loss decreased (-0.149986 --> -0.149986).  Saving model ...
Epoch: 3 cost time: 0.4416806697845459
Epoch: 3, Steps: 3 | Train Loss: 1.305 Vali Loss: 1.379 Vali Acc: 0.175 Test Loss: 1.379 Test Acc: 0.175
Validation loss decreased (-0.149986 --> -0.174986).  Saving model ...
Epoch: 4 cost time: 0.4180774688720703
Epoch: 4, Steps: 3 | Train Loss: 1.265 Vali Loss: 1.366 Vali Acc: 0.250 Test Loss: 1.366 Test Acc: 0.250
Validation loss decreased (-0.174986 --> -0.249986).  Saving model ...
Epoch: 5 cost time: 0.41835498809814453
Epoch: 5, Steps: 3 | Train Loss: 1.233 Vali Loss: 1.348 Vali Acc: 0.450 Test Loss: 1.348 Test Acc: 0.450
Validation loss decreased (-0.249986 --> -0.449987).  Saving model ...
Epoch: 6 cost time: 0.3970682621002197
Epoch: 6, Steps: 3 | Train Loss: 1.202 Vali Loss: 1.325 Vali Acc: 0.475 Test Loss: 1.325 Test Acc: 0.475
Validation loss decreased (-0.449987 --> -0.474987).  Saving model ...
Epoch: 7 cost time: 0.40324926376342773
Epoch: 7, Steps: 3 | Train Loss: 1.154 Vali Loss: 1.298 Vali Acc: 0.525 Test Loss: 1.298 Test Acc: 0.525
Validation loss decreased (-0.474987 --> -0.524987).  Saving model ...
Epoch: 8 cost time: 0.5350937843322754
Epoch: 8, Steps: 3 | Train Loss: 1.126 Vali Loss: 1.267 Vali Acc: 0.575 Test Loss: 1.267 Test Acc: 0.575
Validation loss decreased (-0.524987 --> -0.574987).  Saving model ...
Epoch: 9 cost time: 0.4313008785247803
Epoch: 9, Steps: 3 | Train Loss: 1.071 Vali Loss: 1.231 Vali Acc: 0.600 Test Loss: 1.231 Test Acc: 0.600
Validation loss decreased (-0.574987 --> -0.599988).  Saving model ...
Epoch: 10 cost time: 0.3950321674346924
Epoch: 10, Steps: 3 | Train Loss: 1.023 Vali Loss: 1.192 Vali Acc: 0.700 Test Loss: 1.192 Test Acc: 0.700
Validation loss decreased (-0.599988 --> -0.699988).  Saving model ...
Epoch: 11 cost time: 0.41046833992004395
Epoch: 11, Steps: 3 | Train Loss: 0.970 Vali Loss: 1.155 Vali Acc: 0.700 Test Loss: 1.155 Test Acc: 0.700
Validation loss decreased (-0.699988 --> -0.699988).  Saving model ...
Epoch: 12 cost time: 0.3765733242034912
Epoch: 12, Steps: 3 | Train Loss: 0.910 Vali Loss: 1.122 Vali Acc: 0.725 Test Loss: 1.122 Test Acc: 0.725
Validation loss decreased (-0.699988 --> -0.724989).  Saving model ...
Epoch: 13 cost time: 0.5052499771118164
Epoch: 13, Steps: 3 | Train Loss: 0.867 Vali Loss: 1.084 Vali Acc: 0.775 Test Loss: 1.084 Test Acc: 0.775
Validation loss decreased (-0.724989 --> -0.774989).  Saving model ...
Epoch: 14 cost time: 0.5043702125549316
Epoch: 14, Steps: 3 | Train Loss: 0.818 Vali Loss: 1.045 Vali Acc: 0.800 Test Loss: 1.045 Test Acc: 0.800
Validation loss decreased (-0.774989 --> -0.799990).  Saving model ...
Epoch: 15 cost time: 0.41506171226501465
Epoch: 15, Steps: 3 | Train Loss: 0.768 Vali Loss: 1.010 Vali Acc: 0.825 Test Loss: 1.010 Test Acc: 0.825
Validation loss decreased (-0.799990 --> -0.824990).  Saving model ...
Epoch: 16 cost time: 0.43845653533935547
Epoch: 16, Steps: 3 | Train Loss: 0.755 Vali Loss: 0.971 Vali Acc: 0.850 Test Loss: 0.971 Test Acc: 0.850
Validation loss decreased (-0.824990 --> -0.849990).  Saving model ...
Epoch: 17 cost time: 0.39861392974853516
Epoch: 17, Steps: 3 | Train Loss: 0.699 Vali Loss: 0.935 Vali Acc: 0.875 Test Loss: 0.935 Test Acc: 0.875
Validation loss decreased (-0.849990 --> -0.874991).  Saving model ...
Epoch: 18 cost time: 0.39377784729003906
Epoch: 18, Steps: 3 | Train Loss: 0.693 Vali Loss: 0.899 Vali Acc: 0.875 Test Loss: 0.899 Test Acc: 0.875
Validation loss decreased (-0.874991 --> -0.874991).  Saving model ...
Epoch: 19 cost time: 0.41924309730529785
Epoch: 19, Steps: 3 | Train Loss: 0.640 Vali Loss: 0.876 Vali Acc: 0.800 Test Loss: 0.876 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.41979503631591797
Epoch: 20, Steps: 3 | Train Loss: 0.601 Vali Loss: 0.848 Vali Acc: 0.800 Test Loss: 0.848 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.43903541564941406
Epoch: 21, Steps: 3 | Train Loss: 0.593 Vali Loss: 0.813 Vali Acc: 0.750 Test Loss: 0.813 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.4302053451538086
Epoch: 22, Steps: 3 | Train Loss: 0.580 Vali Loss: 0.795 Vali Acc: 0.750 Test Loss: 0.795 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.49251818656921387
Epoch: 23, Steps: 3 | Train Loss: 0.518 Vali Loss: 0.779 Vali Acc: 0.725 Test Loss: 0.779 Test Acc: 0.725
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.417417049407959
Epoch: 24, Steps: 3 | Train Loss: 0.484 Vali Loss: 0.756 Vali Acc: 0.725 Test Loss: 0.756 Test Acc: 0.725
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.5080933570861816
Epoch: 25, Steps: 3 | Train Loss: 0.473 Vali Loss: 0.743 Vali Acc: 0.725 Test Loss: 0.743 Test Acc: 0.725
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.4313688278198242
Epoch: 26, Steps: 3 | Train Loss: 0.465 Vali Loss: 0.718 Vali Acc: 0.750 Test Loss: 0.718 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.4925820827484131
Epoch: 27, Steps: 3 | Train Loss: 0.431 Vali Loss: 0.684 Vali Acc: 0.850 Test Loss: 0.684 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.4510047435760498
Epoch: 28, Steps: 3 | Train Loss: 0.404 Vali Loss: 0.667 Vali Acc: 0.850 Test Loss: 0.667 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps20_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.875
model parameter : 335012
model size : 1.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps25_str13_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.603015422821045
Epoch: 1, Steps: 3 | Train Loss: 1.364 Vali Loss: 1.335 Vali Acc: 0.225 Test Loss: 1.335 Test Acc: 0.225
Validation loss decreased (inf --> -0.224987).  Saving model ...
Epoch: 2 cost time: 0.43756937980651855
Epoch: 2, Steps: 3 | Train Loss: 1.353 Vali Loss: 1.324 Vali Acc: 0.225 Test Loss: 1.324 Test Acc: 0.225
Validation loss decreased (-0.224987 --> -0.224987).  Saving model ...
Epoch: 3 cost time: 0.46355724334716797
Epoch: 3, Steps: 3 | Train Loss: 1.347 Vali Loss: 1.311 Vali Acc: 0.250 Test Loss: 1.311 Test Acc: 0.250
Validation loss decreased (-0.224987 --> -0.249987).  Saving model ...
Epoch: 4 cost time: 0.5062112808227539
Epoch: 4, Steps: 3 | Train Loss: 1.311 Vali Loss: 1.296 Vali Acc: 0.250 Test Loss: 1.296 Test Acc: 0.250
Validation loss decreased (-0.249987 --> -0.249987).  Saving model ...
Epoch: 5 cost time: 0.42684459686279297
Epoch: 5, Steps: 3 | Train Loss: 1.283 Vali Loss: 1.279 Vali Acc: 0.250 Test Loss: 1.279 Test Acc: 0.250
Validation loss decreased (-0.249987 --> -0.249987).  Saving model ...
Epoch: 6 cost time: 0.44878268241882324
Epoch: 6, Steps: 3 | Train Loss: 1.246 Vali Loss: 1.259 Vali Acc: 0.275 Test Loss: 1.259 Test Acc: 0.275
Validation loss decreased (-0.249987 --> -0.274987).  Saving model ...
Epoch: 7 cost time: 0.41861391067504883
Epoch: 7, Steps: 3 | Train Loss: 1.199 Vali Loss: 1.241 Vali Acc: 0.375 Test Loss: 1.241 Test Acc: 0.375
Validation loss decreased (-0.274987 --> -0.374988).  Saving model ...
Epoch: 8 cost time: 0.4091928005218506
Epoch: 8, Steps: 3 | Train Loss: 1.175 Vali Loss: 1.216 Vali Acc: 0.525 Test Loss: 1.216 Test Acc: 0.525
Validation loss decreased (-0.374988 --> -0.524988).  Saving model ...
Epoch: 9 cost time: 0.47265028953552246
Epoch: 9, Steps: 3 | Train Loss: 1.141 Vali Loss: 1.192 Vali Acc: 0.650 Test Loss: 1.192 Test Acc: 0.650
Validation loss decreased (-0.524988 --> -0.649988).  Saving model ...
Epoch: 10 cost time: 0.4858510494232178
Epoch: 10, Steps: 3 | Train Loss: 1.069 Vali Loss: 1.167 Vali Acc: 0.675 Test Loss: 1.167 Test Acc: 0.675
Validation loss decreased (-0.649988 --> -0.674988).  Saving model ...
Epoch: 11 cost time: 0.43817853927612305
Epoch: 11, Steps: 3 | Train Loss: 1.048 Vali Loss: 1.134 Vali Acc: 0.700 Test Loss: 1.134 Test Acc: 0.700
Validation loss decreased (-0.674988 --> -0.699989).  Saving model ...
Epoch: 12 cost time: 0.4145476818084717
Epoch: 12, Steps: 3 | Train Loss: 1.016 Vali Loss: 1.108 Vali Acc: 0.750 Test Loss: 1.108 Test Acc: 0.750
Validation loss decreased (-0.699989 --> -0.749989).  Saving model ...
Epoch: 13 cost time: 0.4261739253997803
Epoch: 13, Steps: 3 | Train Loss: 0.979 Vali Loss: 1.080 Vali Acc: 0.750 Test Loss: 1.080 Test Acc: 0.750
Validation loss decreased (-0.749989 --> -0.749989).  Saving model ...
Epoch: 14 cost time: 0.4209907054901123
Epoch: 14, Steps: 3 | Train Loss: 0.947 Vali Loss: 1.045 Vali Acc: 0.750 Test Loss: 1.045 Test Acc: 0.750
Validation loss decreased (-0.749989 --> -0.749990).  Saving model ...
Epoch: 15 cost time: 0.42059326171875
Epoch: 15, Steps: 3 | Train Loss: 0.892 Vali Loss: 1.021 Vali Acc: 0.750 Test Loss: 1.021 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749990).  Saving model ...
Epoch: 16 cost time: 0.4521298408508301
Epoch: 16, Steps: 3 | Train Loss: 0.849 Vali Loss: 0.992 Vali Acc: 0.750 Test Loss: 0.992 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749990).  Saving model ...
Epoch: 17 cost time: 0.42398762702941895
Epoch: 17, Steps: 3 | Train Loss: 0.797 Vali Loss: 0.966 Vali Acc: 0.750 Test Loss: 0.966 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749990).  Saving model ...
Epoch: 18 cost time: 0.4680929183959961
Epoch: 18, Steps: 3 | Train Loss: 0.799 Vali Loss: 0.936 Vali Acc: 0.750 Test Loss: 0.936 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749991).  Saving model ...
Epoch: 19 cost time: 0.4181075096130371
Epoch: 19, Steps: 3 | Train Loss: 0.744 Vali Loss: 0.914 Vali Acc: 0.750 Test Loss: 0.914 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 20 cost time: 0.5402865409851074
Epoch: 20, Steps: 3 | Train Loss: 0.704 Vali Loss: 0.878 Vali Acc: 0.750 Test Loss: 0.878 Test Acc: 0.750
Validation loss decreased (-0.749991 --> -0.749991).  Saving model ...
Epoch: 21 cost time: 0.43054795265197754
Epoch: 21, Steps: 3 | Train Loss: 0.656 Vali Loss: 0.848 Vali Acc: 0.800 Test Loss: 0.848 Test Acc: 0.800
Validation loss decreased (-0.749991 --> -0.799992).  Saving model ...
Epoch: 22 cost time: 0.40822887420654297
Epoch: 22, Steps: 3 | Train Loss: 0.616 Vali Loss: 0.820 Vali Acc: 0.800 Test Loss: 0.820 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 23 cost time: 0.49015378952026367
Epoch: 23, Steps: 3 | Train Loss: 0.593 Vali Loss: 0.790 Vali Acc: 0.825 Test Loss: 0.790 Test Acc: 0.825
Validation loss decreased (-0.799992 --> -0.824992).  Saving model ...
Epoch: 24 cost time: 0.426743745803833
Epoch: 24, Steps: 3 | Train Loss: 0.546 Vali Loss: 0.765 Vali Acc: 0.875 Test Loss: 0.765 Test Acc: 0.875
Validation loss decreased (-0.824992 --> -0.874992).  Saving model ...
Epoch: 25 cost time: 0.4128704071044922
Epoch: 25, Steps: 3 | Train Loss: 0.545 Vali Loss: 0.746 Vali Acc: 0.875 Test Loss: 0.746 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874993).  Saving model ...
Epoch: 26 cost time: 0.43146848678588867
Epoch: 26, Steps: 3 | Train Loss: 0.491 Vali Loss: 0.727 Vali Acc: 0.875 Test Loss: 0.727 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 27 cost time: 0.44410252571105957
Epoch: 27, Steps: 3 | Train Loss: 0.478 Vali Loss: 0.700 Vali Acc: 0.875 Test Loss: 0.700 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 28 cost time: 0.47060561180114746
Epoch: 28, Steps: 3 | Train Loss: 0.462 Vali Loss: 0.681 Vali Acc: 0.875 Test Loss: 0.681 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 29 cost time: 0.4153287410736084
Epoch: 29, Steps: 3 | Train Loss: 0.419 Vali Loss: 0.658 Vali Acc: 0.875 Test Loss: 0.658 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 30 cost time: 0.4593851566314697
Epoch: 30, Steps: 3 | Train Loss: 0.431 Vali Loss: 0.649 Vali Acc: 0.875 Test Loss: 0.649 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 31 cost time: 0.4499397277832031
Epoch: 31, Steps: 3 | Train Loss: 0.402 Vali Loss: 0.628 Vali Acc: 0.875 Test Loss: 0.628 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 32 cost time: 0.4139528274536133
Epoch: 32, Steps: 3 | Train Loss: 0.399 Vali Loss: 0.613 Vali Acc: 0.875 Test Loss: 0.613 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 33 cost time: 0.43404245376586914
Epoch: 33, Steps: 3 | Train Loss: 0.366 Vali Loss: 0.583 Vali Acc: 0.875 Test Loss: 0.583 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 34 cost time: 0.43827009201049805
Epoch: 34, Steps: 3 | Train Loss: 0.345 Vali Loss: 0.558 Vali Acc: 0.875 Test Loss: 0.558 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 35 cost time: 0.45374274253845215
Epoch: 35, Steps: 3 | Train Loss: 0.349 Vali Loss: 0.541 Vali Acc: 0.875 Test Loss: 0.541 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874995).  Saving model ...
Epoch: 36 cost time: 0.5163900852203369
Epoch: 36, Steps: 3 | Train Loss: 0.324 Vali Loss: 0.524 Vali Acc: 0.875 Test Loss: 0.524 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 37 cost time: 0.4302074909210205
Epoch: 37, Steps: 3 | Train Loss: 0.292 Vali Loss: 0.518 Vali Acc: 0.875 Test Loss: 0.518 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 38 cost time: 0.429518461227417
Epoch: 38, Steps: 3 | Train Loss: 0.270 Vali Loss: 0.503 Vali Acc: 0.875 Test Loss: 0.503 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 39 cost time: 0.42395734786987305
Epoch: 39, Steps: 3 | Train Loss: 0.255 Vali Loss: 0.486 Vali Acc: 0.875 Test Loss: 0.486 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 40 cost time: 0.44591474533081055
Epoch: 40, Steps: 3 | Train Loss: 0.269 Vali Loss: 0.465 Vali Acc: 0.875 Test Loss: 0.465 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874995).  Saving model ...
Epoch: 41 cost time: 0.5089318752288818
Epoch: 41, Steps: 3 | Train Loss: 0.281 Vali Loss: 0.443 Vali Acc: 0.875 Test Loss: 0.443 Test Acc: 0.875
Validation loss decreased (-0.874995 --> -0.874996).  Saving model ...
Epoch: 42 cost time: 0.3919961452484131
Epoch: 42, Steps: 3 | Train Loss: 0.219 Vali Loss: 0.432 Vali Acc: 0.875 Test Loss: 0.432 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 43 cost time: 0.4489891529083252
Epoch: 43, Steps: 3 | Train Loss: 0.228 Vali Loss: 0.418 Vali Acc: 0.875 Test Loss: 0.418 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 44 cost time: 0.4651024341583252
Epoch: 44, Steps: 3 | Train Loss: 0.238 Vali Loss: 0.403 Vali Acc: 0.875 Test Loss: 0.403 Test Acc: 0.875
Validation loss decreased (-0.874996 --> -0.874996).  Saving model ...
Epoch: 45 cost time: 0.38331007957458496
Epoch: 45, Steps: 3 | Train Loss: 0.201 Vali Loss: 0.391 Vali Acc: 0.900 Test Loss: 0.391 Test Acc: 0.900
Validation loss decreased (-0.874996 --> -0.899996).  Saving model ...
Epoch: 46 cost time: 0.4154500961303711
Epoch: 46, Steps: 3 | Train Loss: 0.205 Vali Loss: 0.383 Vali Acc: 0.925 Test Loss: 0.383 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924996).  Saving model ...
Epoch: 47 cost time: 0.472226619720459
Epoch: 47, Steps: 3 | Train Loss: 0.175 Vali Loss: 0.374 Vali Acc: 0.950 Test Loss: 0.374 Test Acc: 0.950
Validation loss decreased (-0.924996 --> -0.949996).  Saving model ...
Epoch: 48 cost time: 0.4210209846496582
Epoch: 48, Steps: 3 | Train Loss: 0.174 Vali Loss: 0.359 Vali Acc: 0.950 Test Loss: 0.359 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 49 cost time: 0.45786333084106445
Epoch: 49, Steps: 3 | Train Loss: 0.166 Vali Loss: 0.359 Vali Acc: 0.950 Test Loss: 0.359 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.40048742294311523
Epoch: 50, Steps: 3 | Train Loss: 0.144 Vali Loss: 0.351 Vali Acc: 0.975 Test Loss: 0.351 Test Acc: 0.975
Validation loss decreased (-0.949996 --> -0.974996).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps25_str13_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 332100
model size : 1.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.5484681129455566
Epoch: 1, Steps: 3 | Train Loss: 1.365 Vali Loss: 1.306 Vali Acc: 0.200 Test Loss: 1.306 Test Acc: 0.200
Validation loss decreased (inf --> -0.199987).  Saving model ...
Epoch: 2 cost time: 0.4577615261077881
Epoch: 2, Steps: 3 | Train Loss: 1.240 Vali Loss: 1.252 Vali Acc: 0.325 Test Loss: 1.252 Test Acc: 0.325
Validation loss decreased (-0.199987 --> -0.324987).  Saving model ...
Epoch: 3 cost time: 0.4684464931488037
Epoch: 3, Steps: 3 | Train Loss: 1.101 Vali Loss: 1.128 Vali Acc: 0.725 Test Loss: 1.128 Test Acc: 0.725
Validation loss decreased (-0.324987 --> -0.724989).  Saving model ...
Epoch: 4 cost time: 0.4793815612792969
Epoch: 4, Steps: 3 | Train Loss: 0.888 Vali Loss: 0.969 Vali Acc: 0.725 Test Loss: 0.969 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724990).  Saving model ...
Epoch: 5 cost time: 0.43619251251220703
Epoch: 5, Steps: 3 | Train Loss: 0.668 Vali Loss: 0.814 Vali Acc: 0.825 Test Loss: 0.814 Test Acc: 0.825
Validation loss decreased (-0.724990 --> -0.824992).  Saving model ...
Epoch: 6 cost time: 0.43944382667541504
Epoch: 6, Steps: 3 | Train Loss: 0.538 Vali Loss: 0.640 Vali Acc: 0.950 Test Loss: 0.640 Test Acc: 0.950
Validation loss decreased (-0.824992 --> -0.949994).  Saving model ...
Epoch: 7 cost time: 0.4672665596008301
Epoch: 7, Steps: 3 | Train Loss: 0.396 Vali Loss: 0.526 Vali Acc: 0.950 Test Loss: 0.526 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 8 cost time: 0.49705004692077637
Epoch: 8, Steps: 3 | Train Loss: 0.327 Vali Loss: 0.418 Vali Acc: 0.975 Test Loss: 0.418 Test Acc: 0.975
Validation loss decreased (-0.949995 --> -0.974996).  Saving model ...
Epoch: 9 cost time: 0.4447512626647949
Epoch: 9, Steps: 3 | Train Loss: 0.237 Vali Loss: 0.356 Vali Acc: 0.975 Test Loss: 0.356 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 10 cost time: 0.4208652973175049
Epoch: 10, Steps: 3 | Train Loss: 0.184 Vali Loss: 0.312 Vali Acc: 0.975 Test Loss: 0.312 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 11 cost time: 0.3938584327697754
Epoch: 11, Steps: 3 | Train Loss: 0.153 Vali Loss: 0.254 Vali Acc: 0.975 Test Loss: 0.254 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 12 cost time: 0.5011470317840576
Epoch: 12, Steps: 3 | Train Loss: 0.107 Vali Loss: 0.218 Vali Acc: 0.975 Test Loss: 0.218 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 13 cost time: 0.45270729064941406
Epoch: 13, Steps: 3 | Train Loss: 0.108 Vali Loss: 0.189 Vali Acc: 0.975 Test Loss: 0.189 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 14 cost time: 0.48844218254089355
Epoch: 14, Steps: 3 | Train Loss: 0.063 Vali Loss: 0.175 Vali Acc: 0.950 Test Loss: 0.175 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.43880486488342285
Epoch: 15, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.171 Vali Acc: 0.950 Test Loss: 0.171 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.47217512130737305
Epoch: 16, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.157 Vali Acc: 0.950 Test Loss: 0.157 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.4492807388305664
Epoch: 17, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.164 Vali Acc: 0.950 Test Loss: 0.164 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.472853422164917
Epoch: 18, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.173 Vali Acc: 0.950 Test Loss: 0.173 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.4553365707397461
Epoch: 19, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.179 Vali Acc: 0.950 Test Loss: 0.179 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.6204116344451904
Epoch: 20, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.179 Vali Acc: 0.950 Test Loss: 0.179 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.45106005668640137
Epoch: 21, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.186 Vali Acc: 0.950 Test Loss: 0.186 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.44591784477233887
Epoch: 22, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.195 Vali Acc: 0.950 Test Loss: 0.195 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.5553321838378906
Epoch: 23, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.207 Vali Acc: 0.950 Test Loss: 0.207 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 1291780
model size : 4.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.5975396633148193
Epoch: 1, Steps: 3 | Train Loss: 1.415 Vali Loss: 1.365 Vali Acc: 0.200 Test Loss: 1.365 Test Acc: 0.200
Validation loss decreased (inf --> -0.199986).  Saving model ...
Epoch: 2 cost time: 0.4371206760406494
Epoch: 2, Steps: 3 | Train Loss: 1.347 Vali Loss: 1.316 Vali Acc: 0.400 Test Loss: 1.316 Test Acc: 0.400
Validation loss decreased (-0.199986 --> -0.399987).  Saving model ...
Epoch: 3 cost time: 0.48740077018737793
Epoch: 3, Steps: 3 | Train Loss: 1.209 Vali Loss: 1.226 Vali Acc: 0.475 Test Loss: 1.226 Test Acc: 0.475
Validation loss decreased (-0.399987 --> -0.474988).  Saving model ...
Epoch: 4 cost time: 0.5031528472900391
Epoch: 4, Steps: 3 | Train Loss: 1.021 Vali Loss: 1.103 Vali Acc: 0.625 Test Loss: 1.103 Test Acc: 0.625
Validation loss decreased (-0.474988 --> -0.624989).  Saving model ...
Epoch: 5 cost time: 0.49643778800964355
Epoch: 5, Steps: 3 | Train Loss: 0.826 Vali Loss: 0.968 Vali Acc: 0.625 Test Loss: 0.968 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624990).  Saving model ...
Epoch: 6 cost time: 0.44885754585266113
Epoch: 6, Steps: 3 | Train Loss: 0.642 Vali Loss: 0.830 Vali Acc: 0.900 Test Loss: 0.830 Test Acc: 0.900
Validation loss decreased (-0.624990 --> -0.899992).  Saving model ...
Epoch: 7 cost time: 0.4348630905151367
Epoch: 7, Steps: 3 | Train Loss: 0.520 Vali Loss: 0.695 Vali Acc: 0.950 Test Loss: 0.695 Test Acc: 0.950
Validation loss decreased (-0.899992 --> -0.949993).  Saving model ...
Epoch: 8 cost time: 0.4755568504333496
Epoch: 8, Steps: 3 | Train Loss: 0.416 Vali Loss: 0.582 Vali Acc: 0.975 Test Loss: 0.582 Test Acc: 0.975
Validation loss decreased (-0.949993 --> -0.974994).  Saving model ...
Epoch: 9 cost time: 0.43910646438598633
Epoch: 9, Steps: 3 | Train Loss: 0.365 Vali Loss: 0.484 Vali Acc: 0.950 Test Loss: 0.484 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.4174778461456299
Epoch: 10, Steps: 3 | Train Loss: 0.313 Vali Loss: 0.419 Vali Acc: 0.925 Test Loss: 0.419 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.43804240226745605
Epoch: 11, Steps: 3 | Train Loss: 0.210 Vali Loss: 0.359 Vali Acc: 0.975 Test Loss: 0.359 Test Acc: 0.975
Validation loss decreased (-0.974994 --> -0.974996).  Saving model ...
Epoch: 12 cost time: 0.41729140281677246
Epoch: 12, Steps: 3 | Train Loss: 0.189 Vali Loss: 0.312 Vali Acc: 0.975 Test Loss: 0.312 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 13 cost time: 0.4712049961090088
Epoch: 13, Steps: 3 | Train Loss: 0.197 Vali Loss: 0.268 Vali Acc: 0.975 Test Loss: 0.268 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 14 cost time: 0.5344386100769043
Epoch: 14, Steps: 3 | Train Loss: 0.141 Vali Loss: 0.231 Vali Acc: 0.975 Test Loss: 0.231 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 15 cost time: 0.42789626121520996
Epoch: 15, Steps: 3 | Train Loss: 0.131 Vali Loss: 0.202 Vali Acc: 0.975 Test Loss: 0.202 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 16 cost time: 0.47974228858947754
Epoch: 16, Steps: 3 | Train Loss: 0.089 Vali Loss: 0.182 Vali Acc: 0.975 Test Loss: 0.182 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 17 cost time: 0.4438011646270752
Epoch: 17, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.171 Vali Acc: 0.975 Test Loss: 0.171 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 18 cost time: 0.46613454818725586
Epoch: 18, Steps: 3 | Train Loss: 0.063 Vali Loss: 0.161 Vali Acc: 0.950 Test Loss: 0.161 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.41702795028686523
Epoch: 19, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.161 Vali Acc: 0.950 Test Loss: 0.161 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.44003891944885254
Epoch: 20, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.157 Vali Acc: 0.950 Test Loss: 0.157 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.4647185802459717
Epoch: 21, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.156 Vali Acc: 0.950 Test Loss: 0.156 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.4616267681121826
Epoch: 22, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.167 Vali Acc: 0.950 Test Loss: 0.167 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.4131584167480469
Epoch: 23, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.167 Vali Acc: 0.950 Test Loss: 0.167 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.4543740749359131
Epoch: 24, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.172 Vali Acc: 0.950 Test Loss: 0.172 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.4470255374908447
Epoch: 25, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.176 Vali Acc: 0.950 Test Loss: 0.176 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.43056702613830566
Epoch: 26, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.180 Vali Acc: 0.950 Test Loss: 0.180 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.4356043338775635
Epoch: 27, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.187 Vali Acc: 0.950 Test Loss: 0.187 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 1242884
model size : 4.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.4585912227630615
Epoch: 1, Steps: 3 | Train Loss: 1.437 Vali Loss: 1.322 Vali Acc: 0.250 Test Loss: 1.322 Test Acc: 0.250
Validation loss decreased (inf --> -0.249987).  Saving model ...
Epoch: 2 cost time: 0.4271430969238281
Epoch: 2, Steps: 3 | Train Loss: 1.315 Vali Loss: 1.281 Vali Acc: 0.275 Test Loss: 1.281 Test Acc: 0.275
Validation loss decreased (-0.249987 --> -0.274987).  Saving model ...
Epoch: 3 cost time: 0.4355199337005615
Epoch: 3, Steps: 3 | Train Loss: 1.207 Vali Loss: 1.204 Vali Acc: 0.600 Test Loss: 1.204 Test Acc: 0.600
Validation loss decreased (-0.274987 --> -0.599988).  Saving model ...
Epoch: 4 cost time: 0.43028950691223145
Epoch: 4, Steps: 3 | Train Loss: 1.046 Vali Loss: 1.101 Vali Acc: 0.675 Test Loss: 1.101 Test Acc: 0.675
Validation loss decreased (-0.599988 --> -0.674989).  Saving model ...
Epoch: 5 cost time: 0.43367552757263184
Epoch: 5, Steps: 3 | Train Loss: 0.898 Vali Loss: 0.986 Vali Acc: 0.800 Test Loss: 0.986 Test Acc: 0.800
Validation loss decreased (-0.674989 --> -0.799990).  Saving model ...
Epoch: 6 cost time: 0.4289674758911133
Epoch: 6, Steps: 3 | Train Loss: 0.761 Vali Loss: 0.859 Vali Acc: 0.875 Test Loss: 0.859 Test Acc: 0.875
Validation loss decreased (-0.799990 --> -0.874991).  Saving model ...
Epoch: 7 cost time: 0.4203765392303467
Epoch: 7, Steps: 3 | Train Loss: 0.602 Vali Loss: 0.740 Vali Acc: 0.950 Test Loss: 0.740 Test Acc: 0.950
Validation loss decreased (-0.874991 --> -0.949993).  Saving model ...
Epoch: 8 cost time: 0.5092124938964844
Epoch: 8, Steps: 3 | Train Loss: 0.486 Vali Loss: 0.638 Vali Acc: 0.975 Test Loss: 0.638 Test Acc: 0.975
Validation loss decreased (-0.949993 --> -0.974994).  Saving model ...
Epoch: 9 cost time: 0.4723086357116699
Epoch: 9, Steps: 3 | Train Loss: 0.396 Vali Loss: 0.544 Vali Acc: 0.975 Test Loss: 0.544 Test Acc: 0.975
Validation loss decreased (-0.974994 --> -0.974995).  Saving model ...
Epoch: 10 cost time: 0.4498937129974365
Epoch: 10, Steps: 3 | Train Loss: 0.346 Vali Loss: 0.463 Vali Acc: 0.975 Test Loss: 0.463 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 11 cost time: 0.44786977767944336
Epoch: 11, Steps: 3 | Train Loss: 0.271 Vali Loss: 0.419 Vali Acc: 0.975 Test Loss: 0.419 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 12 cost time: 0.4370121955871582
Epoch: 12, Steps: 3 | Train Loss: 0.266 Vali Loss: 0.360 Vali Acc: 0.975 Test Loss: 0.360 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 13 cost time: 0.46219682693481445
Epoch: 13, Steps: 3 | Train Loss: 0.199 Vali Loss: 0.313 Vali Acc: 0.975 Test Loss: 0.313 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 14 cost time: 0.4427914619445801
Epoch: 14, Steps: 3 | Train Loss: 0.177 Vali Loss: 0.276 Vali Acc: 0.975 Test Loss: 0.276 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 15 cost time: 0.43659472465515137
Epoch: 15, Steps: 3 | Train Loss: 0.156 Vali Loss: 0.243 Vali Acc: 0.975 Test Loss: 0.243 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 16 cost time: 0.39847517013549805
Epoch: 16, Steps: 3 | Train Loss: 0.127 Vali Loss: 0.223 Vali Acc: 0.975 Test Loss: 0.223 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 17 cost time: 0.4215226173400879
Epoch: 17, Steps: 3 | Train Loss: 0.116 Vali Loss: 0.207 Vali Acc: 0.975 Test Loss: 0.207 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 18 cost time: 0.3926725387573242
Epoch: 18, Steps: 3 | Train Loss: 0.138 Vali Loss: 0.197 Vali Acc: 0.975 Test Loss: 0.197 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 19 cost time: 0.4345731735229492
Epoch: 19, Steps: 3 | Train Loss: 0.104 Vali Loss: 0.186 Vali Acc: 0.975 Test Loss: 0.186 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 20 cost time: 0.39157748222351074
Epoch: 20, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.180 Vali Acc: 0.950 Test Loss: 0.180 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.40497303009033203
Epoch: 21, Steps: 3 | Train Loss: 0.062 Vali Loss: 0.170 Vali Acc: 0.950 Test Loss: 0.170 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.42769479751586914
Epoch: 22, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.162 Vali Acc: 0.950 Test Loss: 0.162 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.4463827610015869
Epoch: 23, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.162 Vali Acc: 0.950 Test Loss: 0.162 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.40229249000549316
Epoch: 24, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.160 Vali Acc: 0.950 Test Loss: 0.160 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.3974578380584717
Epoch: 25, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.154 Vali Acc: 0.950 Test Loss: 0.154 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.44813990592956543
Epoch: 26, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.151 Vali Acc: 0.950 Test Loss: 0.151 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.6068465709686279
Epoch: 27, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.147 Vali Acc: 0.950 Test Loss: 0.147 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.4277019500732422
Epoch: 28, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.152 Vali Acc: 0.950 Test Loss: 0.152 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.5153868198394775
Epoch: 29, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.151 Vali Acc: 0.950 Test Loss: 0.151 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 1218692
model size : 4.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.6990108489990234
Epoch: 1, Steps: 3 | Train Loss: 1.380 Vali Loss: 1.387 Vali Acc: 0.400 Test Loss: 1.387 Test Acc: 0.400
Validation loss decreased (inf --> -0.399986).  Saving model ...
Epoch: 2 cost time: 0.4508376121520996
Epoch: 2, Steps: 3 | Train Loss: 1.331 Vali Loss: 1.353 Vali Acc: 0.425 Test Loss: 1.353 Test Acc: 0.425
Validation loss decreased (-0.399986 --> -0.424986).  Saving model ...
Epoch: 3 cost time: 0.49509096145629883
Epoch: 3, Steps: 3 | Train Loss: 1.200 Vali Loss: 1.291 Vali Acc: 0.475 Test Loss: 1.291 Test Acc: 0.475
Validation loss decreased (-0.424986 --> -0.474987).  Saving model ...
Epoch: 4 cost time: 0.44835543632507324
Epoch: 4, Steps: 3 | Train Loss: 1.086 Vali Loss: 1.201 Vali Acc: 0.575 Test Loss: 1.201 Test Acc: 0.575
Validation loss decreased (-0.474987 --> -0.574988).  Saving model ...
Epoch: 5 cost time: 0.4913370609283447
Epoch: 5, Steps: 3 | Train Loss: 0.979 Vali Loss: 1.095 Vali Acc: 0.800 Test Loss: 1.095 Test Acc: 0.800
Validation loss decreased (-0.574988 --> -0.799989).  Saving model ...
Epoch: 6 cost time: 0.46060824394226074
Epoch: 6, Steps: 3 | Train Loss: 0.819 Vali Loss: 0.992 Vali Acc: 0.850 Test Loss: 0.992 Test Acc: 0.850
Validation loss decreased (-0.799989 --> -0.849990).  Saving model ...
Epoch: 7 cost time: 0.46956610679626465
Epoch: 7, Steps: 3 | Train Loss: 0.679 Vali Loss: 0.876 Vali Acc: 0.900 Test Loss: 0.876 Test Acc: 0.900
Validation loss decreased (-0.849990 --> -0.899991).  Saving model ...
Epoch: 8 cost time: 0.42907214164733887
Epoch: 8, Steps: 3 | Train Loss: 0.589 Vali Loss: 0.783 Vali Acc: 0.925 Test Loss: 0.783 Test Acc: 0.925
Validation loss decreased (-0.899991 --> -0.924992).  Saving model ...
Epoch: 9 cost time: 0.4783167839050293
Epoch: 9, Steps: 3 | Train Loss: 0.514 Vali Loss: 0.665 Vali Acc: 0.925 Test Loss: 0.665 Test Acc: 0.925
Validation loss decreased (-0.924992 --> -0.924993).  Saving model ...
Epoch: 10 cost time: 0.4600503444671631
Epoch: 10, Steps: 3 | Train Loss: 0.408 Vali Loss: 0.578 Vali Acc: 0.925 Test Loss: 0.578 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924994).  Saving model ...
Epoch: 11 cost time: 0.4870319366455078
Epoch: 11, Steps: 3 | Train Loss: 0.347 Vali Loss: 0.489 Vali Acc: 0.975 Test Loss: 0.489 Test Acc: 0.975
Validation loss decreased (-0.924994 --> -0.974995).  Saving model ...
Epoch: 12 cost time: 0.5131180286407471
Epoch: 12, Steps: 3 | Train Loss: 0.283 Vali Loss: 0.432 Vali Acc: 0.975 Test Loss: 0.432 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 13 cost time: 0.4570744037628174
Epoch: 13, Steps: 3 | Train Loss: 0.257 Vali Loss: 0.378 Vali Acc: 0.975 Test Loss: 0.378 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 14 cost time: 0.4347379207611084
Epoch: 14, Steps: 3 | Train Loss: 0.232 Vali Loss: 0.330 Vali Acc: 0.975 Test Loss: 0.330 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 15 cost time: 0.46016955375671387
Epoch: 15, Steps: 3 | Train Loss: 0.190 Vali Loss: 0.296 Vali Acc: 0.975 Test Loss: 0.296 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 16 cost time: 0.48688745498657227
Epoch: 16, Steps: 3 | Train Loss: 0.161 Vali Loss: 0.279 Vali Acc: 0.975 Test Loss: 0.279 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 17 cost time: 0.46874451637268066
Epoch: 17, Steps: 3 | Train Loss: 0.163 Vali Loss: 0.259 Vali Acc: 0.975 Test Loss: 0.259 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 18 cost time: 0.4808809757232666
Epoch: 18, Steps: 3 | Train Loss: 0.130 Vali Loss: 0.232 Vali Acc: 0.975 Test Loss: 0.232 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 19 cost time: 0.49752068519592285
Epoch: 19, Steps: 3 | Train Loss: 0.117 Vali Loss: 0.225 Vali Acc: 0.975 Test Loss: 0.225 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 20 cost time: 0.4997556209564209
Epoch: 20, Steps: 3 | Train Loss: 0.116 Vali Loss: 0.216 Vali Acc: 0.975 Test Loss: 0.216 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 21 cost time: 0.47803568840026855
Epoch: 21, Steps: 3 | Train Loss: 0.095 Vali Loss: 0.206 Vali Acc: 0.975 Test Loss: 0.206 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 22 cost time: 0.4181029796600342
Epoch: 22, Steps: 3 | Train Loss: 0.072 Vali Loss: 0.201 Vali Acc: 0.975 Test Loss: 0.201 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 23 cost time: 0.5142724514007568
Epoch: 23, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.191 Vali Acc: 0.950 Test Loss: 0.191 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.40894126892089844
Epoch: 24, Steps: 3 | Train Loss: 0.062 Vali Loss: 0.192 Vali Acc: 0.950 Test Loss: 0.192 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.4534118175506592
Epoch: 25, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.178 Vali Acc: 0.950 Test Loss: 0.178 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.4219398498535156
Epoch: 26, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.181 Vali Acc: 0.950 Test Loss: 0.181 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.4610903263092041
Epoch: 27, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.177 Vali Acc: 0.950 Test Loss: 0.177 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.4714686870574951
Epoch: 28, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.183 Vali Acc: 0.950 Test Loss: 0.183 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.4327073097229004
Epoch: 29, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.178 Vali Acc: 0.950 Test Loss: 0.178 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.44545626640319824
Epoch: 30, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.171 Vali Acc: 0.950 Test Loss: 0.171 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.46718859672546387
Epoch: 31, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.177 Vali Acc: 0.950 Test Loss: 0.177 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.4655945301055908
Epoch: 32, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.177 Vali Acc: 0.950 Test Loss: 0.177 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 1200516
model size : 4.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.4502098560333252
Epoch: 1, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.330 Vali Acc: 0.475 Test Loss: 1.330 Test Acc: 0.475
Validation loss decreased (inf --> -0.474987).  Saving model ...
Epoch: 2 cost time: 0.41039466857910156
Epoch: 2, Steps: 3 | Train Loss: 1.317 Vali Loss: 1.301 Vali Acc: 0.500 Test Loss: 1.301 Test Acc: 0.500
Validation loss decreased (-0.474987 --> -0.499987).  Saving model ...
Epoch: 3 cost time: 0.4171450138092041
Epoch: 3, Steps: 3 | Train Loss: 1.238 Vali Loss: 1.254 Vali Acc: 0.600 Test Loss: 1.254 Test Acc: 0.600
Validation loss decreased (-0.499987 --> -0.599987).  Saving model ...
Epoch: 4 cost time: 0.4249589443206787
Epoch: 4, Steps: 3 | Train Loss: 1.149 Vali Loss: 1.189 Vali Acc: 0.675 Test Loss: 1.189 Test Acc: 0.675
Validation loss decreased (-0.599987 --> -0.674988).  Saving model ...
Epoch: 5 cost time: 0.4111607074737549
Epoch: 5, Steps: 3 | Train Loss: 1.044 Vali Loss: 1.110 Vali Acc: 0.750 Test Loss: 1.110 Test Acc: 0.750
Validation loss decreased (-0.674988 --> -0.749989).  Saving model ...
Epoch: 6 cost time: 0.41359734535217285
Epoch: 6, Steps: 3 | Train Loss: 0.932 Vali Loss: 1.023 Vali Acc: 0.850 Test Loss: 1.023 Test Acc: 0.850
Validation loss decreased (-0.749989 --> -0.849990).  Saving model ...
Epoch: 7 cost time: 0.4623880386352539
Epoch: 7, Steps: 3 | Train Loss: 0.822 Vali Loss: 0.930 Vali Acc: 0.900 Test Loss: 0.930 Test Acc: 0.900
Validation loss decreased (-0.849990 --> -0.899991).  Saving model ...
Epoch: 8 cost time: 0.4216349124908447
Epoch: 8, Steps: 3 | Train Loss: 0.743 Vali Loss: 0.844 Vali Acc: 0.925 Test Loss: 0.844 Test Acc: 0.925
Validation loss decreased (-0.899991 --> -0.924992).  Saving model ...
Epoch: 9 cost time: 0.4442934989929199
Epoch: 9, Steps: 3 | Train Loss: 0.652 Vali Loss: 0.746 Vali Acc: 0.950 Test Loss: 0.746 Test Acc: 0.950
Validation loss decreased (-0.924992 --> -0.949993).  Saving model ...
Epoch: 10 cost time: 0.4515340328216553
Epoch: 10, Steps: 3 | Train Loss: 0.586 Vali Loss: 0.658 Vali Acc: 0.950 Test Loss: 0.658 Test Acc: 0.950
Validation loss decreased (-0.949993 --> -0.949993).  Saving model ...
Epoch: 11 cost time: 0.4489595890045166
Epoch: 11, Steps: 3 | Train Loss: 0.479 Vali Loss: 0.591 Vali Acc: 0.950 Test Loss: 0.591 Test Acc: 0.950
Validation loss decreased (-0.949993 --> -0.949994).  Saving model ...
Epoch: 12 cost time: 0.3858058452606201
Epoch: 12, Steps: 3 | Train Loss: 0.429 Vali Loss: 0.529 Vali Acc: 0.950 Test Loss: 0.529 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 13 cost time: 0.4418826103210449
Epoch: 13, Steps: 3 | Train Loss: 0.366 Vali Loss: 0.488 Vali Acc: 0.950 Test Loss: 0.488 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 14 cost time: 0.4483833312988281
Epoch: 14, Steps: 3 | Train Loss: 0.355 Vali Loss: 0.436 Vali Acc: 0.950 Test Loss: 0.436 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 15 cost time: 0.4662513732910156
Epoch: 15, Steps: 3 | Train Loss: 0.298 Vali Loss: 0.389 Vali Acc: 0.950 Test Loss: 0.389 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 16 cost time: 0.4264411926269531
Epoch: 16, Steps: 3 | Train Loss: 0.278 Vali Loss: 0.358 Vali Acc: 0.950 Test Loss: 0.358 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 17 cost time: 0.41486263275146484
Epoch: 17, Steps: 3 | Train Loss: 0.223 Vali Loss: 0.334 Vali Acc: 0.975 Test Loss: 0.334 Test Acc: 0.975
Validation loss decreased (-0.949996 --> -0.974997).  Saving model ...
Epoch: 18 cost time: 0.44388818740844727
Epoch: 18, Steps: 3 | Train Loss: 0.200 Vali Loss: 0.306 Vali Acc: 0.975 Test Loss: 0.306 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 19 cost time: 0.40851640701293945
Epoch: 19, Steps: 3 | Train Loss: 0.208 Vali Loss: 0.291 Vali Acc: 0.975 Test Loss: 0.291 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 20 cost time: 0.4464731216430664
Epoch: 20, Steps: 3 | Train Loss: 0.162 Vali Loss: 0.269 Vali Acc: 0.975 Test Loss: 0.269 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 21 cost time: 0.44551682472229004
Epoch: 21, Steps: 3 | Train Loss: 0.163 Vali Loss: 0.255 Vali Acc: 0.975 Test Loss: 0.255 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 22 cost time: 0.46857357025146484
Epoch: 22, Steps: 3 | Train Loss: 0.147 Vali Loss: 0.241 Vali Acc: 0.975 Test Loss: 0.241 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 23 cost time: 0.45142030715942383
Epoch: 23, Steps: 3 | Train Loss: 0.123 Vali Loss: 0.242 Vali Acc: 0.975 Test Loss: 0.242 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.42374396324157715
Epoch: 24, Steps: 3 | Train Loss: 0.120 Vali Loss: 0.227 Vali Acc: 0.975 Test Loss: 0.227 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 25 cost time: 0.43613672256469727
Epoch: 25, Steps: 3 | Train Loss: 0.111 Vali Loss: 0.214 Vali Acc: 0.975 Test Loss: 0.214 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 26 cost time: 0.48494434356689453
Epoch: 26, Steps: 3 | Train Loss: 0.089 Vali Loss: 0.203 Vali Acc: 0.975 Test Loss: 0.203 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 27 cost time: 0.4714081287384033
Epoch: 27, Steps: 3 | Train Loss: 0.078 Vali Loss: 0.202 Vali Acc: 0.975 Test Loss: 0.202 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 28 cost time: 0.46837735176086426
Epoch: 28, Steps: 3 | Train Loss: 0.080 Vali Loss: 0.203 Vali Acc: 0.975 Test Loss: 0.203 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.3891634941101074
Epoch: 29, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.195 Vali Acc: 0.975 Test Loss: 0.195 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 30 cost time: 0.45900750160217285
Epoch: 30, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.184 Vali Acc: 0.975 Test Loss: 0.184 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 31 cost time: 0.407421350479126
Epoch: 31, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.179 Vali Acc: 0.975 Test Loss: 0.179 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 32 cost time: 0.4326004981994629
Epoch: 32, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.170 Vali Acc: 0.975 Test Loss: 0.170 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 33 cost time: 0.4390239715576172
Epoch: 33, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.170 Vali Acc: 0.975 Test Loss: 0.170 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.4435713291168213
Epoch: 34, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.168 Vali Acc: 0.950 Test Loss: 0.168 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.5386974811553955
Epoch: 35, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.158 Vali Acc: 0.950 Test Loss: 0.158 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.4952714443206787
Epoch: 36, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.154 Vali Acc: 0.950 Test Loss: 0.154 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.44745349884033203
Epoch: 37, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.152 Vali Acc: 0.950 Test Loss: 0.152 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.3859572410583496
Epoch: 38, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.158 Vali Acc: 0.950 Test Loss: 0.158 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.41393208503723145
Epoch: 39, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.156 Vali Acc: 0.950 Test Loss: 0.156 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.4309227466583252
Epoch: 40, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.161 Vali Acc: 0.950 Test Loss: 0.161 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.38556933403015137
Epoch: 41, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.159 Vali Acc: 0.950 Test Loss: 0.159 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.3542468547821045
Epoch: 42, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.160 Vali Acc: 0.950 Test Loss: 0.160 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 1176580
model size : 4.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps20_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.541306495666504
Epoch: 1, Steps: 3 | Train Loss: 1.402 Vali Loss: 1.331 Vali Acc: 0.325 Test Loss: 1.331 Test Acc: 0.325
Validation loss decreased (inf --> -0.324987).  Saving model ...
Epoch: 2 cost time: 0.39255619049072266
Epoch: 2, Steps: 3 | Train Loss: 1.333 Vali Loss: 1.308 Vali Acc: 0.375 Test Loss: 1.308 Test Acc: 0.375
Validation loss decreased (-0.324987 --> -0.374987).  Saving model ...
Epoch: 3 cost time: 0.36275315284729004
Epoch: 3, Steps: 3 | Train Loss: 1.253 Vali Loss: 1.269 Vali Acc: 0.425 Test Loss: 1.269 Test Acc: 0.425
Validation loss decreased (-0.374987 --> -0.424987).  Saving model ...
Epoch: 4 cost time: 0.40847229957580566
Epoch: 4, Steps: 3 | Train Loss: 1.201 Vali Loss: 1.214 Vali Acc: 0.700 Test Loss: 1.214 Test Acc: 0.700
Validation loss decreased (-0.424987 --> -0.699988).  Saving model ...
Epoch: 5 cost time: 0.3927333354949951
Epoch: 5, Steps: 3 | Train Loss: 1.091 Vali Loss: 1.147 Vali Acc: 0.825 Test Loss: 1.147 Test Acc: 0.825
Validation loss decreased (-0.699988 --> -0.824989).  Saving model ...
Epoch: 6 cost time: 0.4107809066772461
Epoch: 6, Steps: 3 | Train Loss: 1.005 Vali Loss: 1.069 Vali Acc: 0.775 Test Loss: 1.069 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.4541895389556885
Epoch: 7, Steps: 3 | Train Loss: 0.895 Vali Loss: 0.983 Vali Acc: 0.825 Test Loss: 0.983 Test Acc: 0.825
Validation loss decreased (-0.824989 --> -0.824990).  Saving model ...
Epoch: 8 cost time: 0.4071178436279297
Epoch: 8, Steps: 3 | Train Loss: 0.802 Vali Loss: 0.906 Vali Acc: 0.900 Test Loss: 0.906 Test Acc: 0.900
Validation loss decreased (-0.824990 --> -0.899991).  Saving model ...
Epoch: 9 cost time: 0.4431324005126953
Epoch: 9, Steps: 3 | Train Loss: 0.718 Vali Loss: 0.828 Vali Acc: 0.850 Test Loss: 0.828 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.43712425231933594
Epoch: 10, Steps: 3 | Train Loss: 0.628 Vali Loss: 0.758 Vali Acc: 0.875 Test Loss: 0.758 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.4165365695953369
Epoch: 11, Steps: 3 | Train Loss: 0.555 Vali Loss: 0.683 Vali Acc: 0.900 Test Loss: 0.683 Test Acc: 0.900
Validation loss decreased (-0.899991 --> -0.899993).  Saving model ...
Epoch: 12 cost time: 0.4406282901763916
Epoch: 12, Steps: 3 | Train Loss: 0.480 Vali Loss: 0.627 Vali Acc: 0.900 Test Loss: 0.627 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899994).  Saving model ...
Epoch: 13 cost time: 0.4390883445739746
Epoch: 13, Steps: 3 | Train Loss: 0.425 Vali Loss: 0.573 Vali Acc: 0.950 Test Loss: 0.573 Test Acc: 0.950
Validation loss decreased (-0.899994 --> -0.949994).  Saving model ...
Epoch: 14 cost time: 0.5283889770507812
Epoch: 14, Steps: 3 | Train Loss: 0.385 Vali Loss: 0.521 Vali Acc: 0.950 Test Loss: 0.521 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 15 cost time: 0.41490793228149414
Epoch: 15, Steps: 3 | Train Loss: 0.339 Vali Loss: 0.476 Vali Acc: 0.950 Test Loss: 0.476 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 16 cost time: 0.4743475914001465
Epoch: 16, Steps: 3 | Train Loss: 0.314 Vali Loss: 0.445 Vali Acc: 0.950 Test Loss: 0.445 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 17 cost time: 0.45984745025634766
Epoch: 17, Steps: 3 | Train Loss: 0.299 Vali Loss: 0.410 Vali Acc: 0.950 Test Loss: 0.410 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 18 cost time: 0.41306614875793457
Epoch: 18, Steps: 3 | Train Loss: 0.275 Vali Loss: 0.392 Vali Acc: 0.950 Test Loss: 0.392 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 19 cost time: 0.4381535053253174
Epoch: 19, Steps: 3 | Train Loss: 0.231 Vali Loss: 0.367 Vali Acc: 0.950 Test Loss: 0.367 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 20 cost time: 0.4262521266937256
Epoch: 20, Steps: 3 | Train Loss: 0.263 Vali Loss: 0.346 Vali Acc: 0.950 Test Loss: 0.346 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 21 cost time: 0.45665907859802246
Epoch: 21, Steps: 3 | Train Loss: 0.206 Vali Loss: 0.325 Vali Acc: 0.975 Test Loss: 0.325 Test Acc: 0.975
Validation loss decreased (-0.949997 --> -0.974997).  Saving model ...
Epoch: 22 cost time: 0.4535837173461914
Epoch: 22, Steps: 3 | Train Loss: 0.195 Vali Loss: 0.312 Vali Acc: 0.975 Test Loss: 0.312 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 23 cost time: 0.442626953125
Epoch: 23, Steps: 3 | Train Loss: 0.172 Vali Loss: 0.295 Vali Acc: 0.975 Test Loss: 0.295 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 24 cost time: 0.4355771541595459
Epoch: 24, Steps: 3 | Train Loss: 0.179 Vali Loss: 0.281 Vali Acc: 0.975 Test Loss: 0.281 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 25 cost time: 0.3861958980560303
Epoch: 25, Steps: 3 | Train Loss: 0.153 Vali Loss: 0.268 Vali Acc: 0.975 Test Loss: 0.268 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 26 cost time: 0.4522690773010254
Epoch: 26, Steps: 3 | Train Loss: 0.135 Vali Loss: 0.259 Vali Acc: 0.975 Test Loss: 0.259 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 27 cost time: 0.43451690673828125
Epoch: 27, Steps: 3 | Train Loss: 0.135 Vali Loss: 0.254 Vali Acc: 0.975 Test Loss: 0.254 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 28 cost time: 0.4812202453613281
Epoch: 28, Steps: 3 | Train Loss: 0.129 Vali Loss: 0.246 Vali Acc: 0.975 Test Loss: 0.246 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 29 cost time: 0.43102455139160156
Epoch: 29, Steps: 3 | Train Loss: 0.117 Vali Loss: 0.238 Vali Acc: 0.975 Test Loss: 0.238 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 30 cost time: 0.5637381076812744
Epoch: 30, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.227 Vali Acc: 0.975 Test Loss: 0.227 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 31 cost time: 0.39960813522338867
Epoch: 31, Steps: 3 | Train Loss: 0.095 Vali Loss: 0.222 Vali Acc: 0.975 Test Loss: 0.222 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 32 cost time: 0.4353973865509033
Epoch: 32, Steps: 3 | Train Loss: 0.080 Vali Loss: 0.225 Vali Acc: 0.950 Test Loss: 0.225 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.45329737663269043
Epoch: 33, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.213 Vali Acc: 0.950 Test Loss: 0.213 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.41173291206359863
Epoch: 34, Steps: 3 | Train Loss: 0.063 Vali Loss: 0.205 Vali Acc: 0.950 Test Loss: 0.205 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.4492356777191162
Epoch: 35, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.198 Vali Acc: 0.950 Test Loss: 0.198 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.42667722702026367
Epoch: 36, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.196 Vali Acc: 0.950 Test Loss: 0.196 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.42699241638183594
Epoch: 37, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.192 Vali Acc: 0.950 Test Loss: 0.192 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.4735991954803467
Epoch: 38, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.193 Vali Acc: 0.950 Test Loss: 0.193 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.41849732398986816
Epoch: 39, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.184 Vali Acc: 0.950 Test Loss: 0.184 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.4048647880554199
Epoch: 40, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.175 Vali Acc: 0.950 Test Loss: 0.175 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.49486398696899414
Epoch: 41, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.175 Vali Acc: 0.950 Test Loss: 0.175 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps20_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 1171076
model size : 4.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps25_str13_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.606292963027954
Epoch: 1, Steps: 3 | Train Loss: 1.429 Vali Loss: 1.372 Vali Acc: 0.250 Test Loss: 1.372 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 0.40261363983154297
Epoch: 2, Steps: 3 | Train Loss: 1.349 Vali Loss: 1.352 Vali Acc: 0.225 Test Loss: 1.352 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.40447497367858887
Epoch: 3, Steps: 3 | Train Loss: 1.324 Vali Loss: 1.319 Vali Acc: 0.250 Test Loss: 1.319 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249987).  Saving model ...
Epoch: 4 cost time: 0.4395763874053955
Epoch: 4, Steps: 3 | Train Loss: 1.243 Vali Loss: 1.272 Vali Acc: 0.350 Test Loss: 1.272 Test Acc: 0.350
Validation loss decreased (-0.249987 --> -0.349987).  Saving model ...
Epoch: 5 cost time: 0.4257359504699707
Epoch: 5, Steps: 3 | Train Loss: 1.171 Vali Loss: 1.217 Vali Acc: 0.600 Test Loss: 1.217 Test Acc: 0.600
Validation loss decreased (-0.349987 --> -0.599988).  Saving model ...
Epoch: 6 cost time: 0.41629505157470703
Epoch: 6, Steps: 3 | Train Loss: 1.046 Vali Loss: 1.150 Vali Acc: 0.600 Test Loss: 1.150 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599989).  Saving model ...
Epoch: 7 cost time: 0.4189119338989258
Epoch: 7, Steps: 3 | Train Loss: 0.953 Vali Loss: 1.072 Vali Acc: 0.675 Test Loss: 1.072 Test Acc: 0.675
Validation loss decreased (-0.599989 --> -0.674989).  Saving model ...
Epoch: 8 cost time: 0.3954644203186035
Epoch: 8, Steps: 3 | Train Loss: 0.865 Vali Loss: 0.992 Vali Acc: 0.800 Test Loss: 0.992 Test Acc: 0.800
Validation loss decreased (-0.674989 --> -0.799990).  Saving model ...
Epoch: 9 cost time: 0.42713093757629395
Epoch: 9, Steps: 3 | Train Loss: 0.764 Vali Loss: 0.912 Vali Acc: 0.850 Test Loss: 0.912 Test Acc: 0.850
Validation loss decreased (-0.799990 --> -0.849991).  Saving model ...
Epoch: 10 cost time: 0.38444042205810547
Epoch: 10, Steps: 3 | Train Loss: 0.660 Vali Loss: 0.845 Vali Acc: 0.850 Test Loss: 0.845 Test Acc: 0.850
Validation loss decreased (-0.849991 --> -0.849992).  Saving model ...
Epoch: 11 cost time: 0.4206666946411133
Epoch: 11, Steps: 3 | Train Loss: 0.600 Vali Loss: 0.786 Vali Acc: 0.900 Test Loss: 0.786 Test Acc: 0.900
Validation loss decreased (-0.849992 --> -0.899992).  Saving model ...
Epoch: 12 cost time: 0.38932132720947266
Epoch: 12, Steps: 3 | Train Loss: 0.531 Vali Loss: 0.721 Vali Acc: 0.925 Test Loss: 0.721 Test Acc: 0.925
Validation loss decreased (-0.899992 --> -0.924993).  Saving model ...
Epoch: 13 cost time: 0.47776150703430176
Epoch: 13, Steps: 3 | Train Loss: 0.478 Vali Loss: 0.656 Vali Acc: 0.950 Test Loss: 0.656 Test Acc: 0.950
Validation loss decreased (-0.924993 --> -0.949993).  Saving model ...
Epoch: 14 cost time: 0.42866039276123047
Epoch: 14, Steps: 3 | Train Loss: 0.425 Vali Loss: 0.608 Vali Acc: 0.950 Test Loss: 0.608 Test Acc: 0.950
Validation loss decreased (-0.949993 --> -0.949994).  Saving model ...
Epoch: 15 cost time: 0.5001633167266846
Epoch: 15, Steps: 3 | Train Loss: 0.396 Vali Loss: 0.556 Vali Acc: 0.950 Test Loss: 0.556 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949994).  Saving model ...
Epoch: 16 cost time: 0.4113304615020752
Epoch: 16, Steps: 3 | Train Loss: 0.349 Vali Loss: 0.518 Vali Acc: 0.925 Test Loss: 0.518 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.42821621894836426
Epoch: 17, Steps: 3 | Train Loss: 0.342 Vali Loss: 0.482 Vali Acc: 0.900 Test Loss: 0.482 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.4147520065307617
Epoch: 18, Steps: 3 | Train Loss: 0.311 Vali Loss: 0.446 Vali Acc: 0.925 Test Loss: 0.446 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.4199550151824951
Epoch: 19, Steps: 3 | Train Loss: 0.275 Vali Loss: 0.420 Vali Acc: 0.950 Test Loss: 0.420 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949996).  Saving model ...
Epoch: 20 cost time: 0.43732309341430664
Epoch: 20, Steps: 3 | Train Loss: 0.229 Vali Loss: 0.413 Vali Acc: 0.950 Test Loss: 0.413 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 21 cost time: 0.4398031234741211
Epoch: 21, Steps: 3 | Train Loss: 0.215 Vali Loss: 0.388 Vali Acc: 0.950 Test Loss: 0.388 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 22 cost time: 0.408982515335083
Epoch: 22, Steps: 3 | Train Loss: 0.215 Vali Loss: 0.382 Vali Acc: 0.950 Test Loss: 0.382 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 23 cost time: 0.46476316452026367
Epoch: 23, Steps: 3 | Train Loss: 0.164 Vali Loss: 0.365 Vali Acc: 0.950 Test Loss: 0.365 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 24 cost time: 0.38790416717529297
Epoch: 24, Steps: 3 | Train Loss: 0.159 Vali Loss: 0.352 Vali Acc: 0.950 Test Loss: 0.352 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 25 cost time: 0.49622058868408203
Epoch: 25, Steps: 3 | Train Loss: 0.186 Vali Loss: 0.344 Vali Acc: 0.950 Test Loss: 0.344 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 26 cost time: 0.39528799057006836
Epoch: 26, Steps: 3 | Train Loss: 0.144 Vali Loss: 0.323 Vali Acc: 0.950 Test Loss: 0.323 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 27 cost time: 0.4069559574127197
Epoch: 27, Steps: 3 | Train Loss: 0.154 Vali Loss: 0.317 Vali Acc: 0.950 Test Loss: 0.317 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 28 cost time: 0.43563055992126465
Epoch: 28, Steps: 3 | Train Loss: 0.129 Vali Loss: 0.299 Vali Acc: 0.950 Test Loss: 0.299 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 29 cost time: 0.5160079002380371
Epoch: 29, Steps: 3 | Train Loss: 0.111 Vali Loss: 0.295 Vali Acc: 0.950 Test Loss: 0.295 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 30 cost time: 0.45349836349487305
Epoch: 30, Steps: 3 | Train Loss: 0.097 Vali Loss: 0.280 Vali Acc: 0.950 Test Loss: 0.280 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 31 cost time: 0.4176628589630127
Epoch: 31, Steps: 3 | Train Loss: 0.089 Vali Loss: 0.263 Vali Acc: 0.950 Test Loss: 0.263 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 32 cost time: 0.4980123043060303
Epoch: 32, Steps: 3 | Train Loss: 0.083 Vali Loss: 0.249 Vali Acc: 0.950 Test Loss: 0.249 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 33 cost time: 0.5045042037963867
Epoch: 33, Steps: 3 | Train Loss: 0.068 Vali Loss: 0.240 Vali Acc: 0.950 Test Loss: 0.240 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 34 cost time: 0.4591803550720215
Epoch: 34, Steps: 3 | Train Loss: 0.055 Vali Loss: 0.220 Vali Acc: 0.950 Test Loss: 0.220 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 35 cost time: 0.4129605293273926
Epoch: 35, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.216 Vali Acc: 0.950 Test Loss: 0.216 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 36 cost time: 0.49085378646850586
Epoch: 36, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.207 Vali Acc: 0.950 Test Loss: 0.207 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 37 cost time: 0.42780327796936035
Epoch: 37, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.211 Vali Acc: 0.950 Test Loss: 0.211 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.47881460189819336
Epoch: 38, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.207 Vali Acc: 0.950 Test Loss: 0.207 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.4567241668701172
Epoch: 39, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.196 Vali Acc: 0.950 Test Loss: 0.196 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 40 cost time: 0.4667682647705078
Epoch: 40, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.196 Vali Acc: 0.950 Test Loss: 0.196 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.43364572525024414
Epoch: 41, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.194 Vali Acc: 0.950 Test Loss: 0.194 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 42 cost time: 0.42453479766845703
Epoch: 42, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.193 Vali Acc: 0.950 Test Loss: 0.193 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 43 cost time: 0.43962764739990234
Epoch: 43, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.194 Vali Acc: 0.950 Test Loss: 0.194 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.4536247253417969
Epoch: 44, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.187 Vali Acc: 0.950 Test Loss: 0.187 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 45 cost time: 0.4300649166107178
Epoch: 45, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.178 Vali Acc: 0.950 Test Loss: 0.178 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 46 cost time: 0.439739465713501
Epoch: 46, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.174 Vali Acc: 0.950 Test Loss: 0.174 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 47 cost time: 0.4596281051635742
Epoch: 47, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.172 Vali Acc: 0.950 Test Loss: 0.172 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 48 cost time: 0.4566488265991211
Epoch: 48, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.171 Vali Acc: 0.950 Test Loss: 0.171 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 49 cost time: 0.39899611473083496
Epoch: 49, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.169 Vali Acc: 0.950 Test Loss: 0.169 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 50 cost time: 0.4046010971069336
Epoch: 50, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.170 Vali Acc: 0.950 Test Loss: 0.170 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps25_str13_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 1165572
model size : 4.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.3723297119140625
Epoch: 1, Steps: 3 | Train Loss: 1.404 Vali Loss: 1.356 Vali Acc: 0.450 Test Loss: 1.356 Test Acc: 0.450
Validation loss decreased (inf --> -0.449986).  Saving model ...
Epoch: 2 cost time: 0.42340874671936035
Epoch: 2, Steps: 3 | Train Loss: 1.291 Vali Loss: 1.319 Vali Acc: 0.475 Test Loss: 1.319 Test Acc: 0.475
Validation loss decreased (-0.449986 --> -0.474987).  Saving model ...
Epoch: 3 cost time: 0.41794633865356445
Epoch: 3, Steps: 3 | Train Loss: 1.219 Vali Loss: 1.246 Vali Acc: 0.525 Test Loss: 1.246 Test Acc: 0.525
Validation loss decreased (-0.474987 --> -0.524988).  Saving model ...
Epoch: 4 cost time: 0.4032621383666992
Epoch: 4, Steps: 3 | Train Loss: 1.069 Vali Loss: 1.153 Vali Acc: 0.550 Test Loss: 1.153 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549988).  Saving model ...
Epoch: 5 cost time: 0.4288609027862549
Epoch: 5, Steps: 3 | Train Loss: 0.947 Vali Loss: 1.035 Vali Acc: 0.825 Test Loss: 1.035 Test Acc: 0.825
Validation loss decreased (-0.549988 --> -0.824990).  Saving model ...
Epoch: 6 cost time: 0.40264391899108887
Epoch: 6, Steps: 3 | Train Loss: 0.793 Vali Loss: 0.926 Vali Acc: 0.875 Test Loss: 0.926 Test Acc: 0.875
Validation loss decreased (-0.824990 --> -0.874991).  Saving model ...
Epoch: 7 cost time: 0.5103662014007568
Epoch: 7, Steps: 3 | Train Loss: 0.698 Vali Loss: 0.817 Vali Acc: 0.900 Test Loss: 0.817 Test Acc: 0.900
Validation loss decreased (-0.874991 --> -0.899992).  Saving model ...
Epoch: 8 cost time: 0.40583157539367676
Epoch: 8, Steps: 3 | Train Loss: 0.567 Vali Loss: 0.716 Vali Acc: 0.875 Test Loss: 0.716 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.4027736186981201
Epoch: 9, Steps: 3 | Train Loss: 0.479 Vali Loss: 0.620 Vali Acc: 0.875 Test Loss: 0.620 Test Acc: 0.875
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.41518354415893555
Epoch: 10, Steps: 3 | Train Loss: 0.394 Vali Loss: 0.531 Vali Acc: 0.950 Test Loss: 0.531 Test Acc: 0.950
Validation loss decreased (-0.899992 --> -0.949995).  Saving model ...
Epoch: 11 cost time: 0.36711931228637695
Epoch: 11, Steps: 3 | Train Loss: 0.321 Vali Loss: 0.472 Vali Acc: 0.950 Test Loss: 0.472 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 12 cost time: 0.3874809741973877
Epoch: 12, Steps: 3 | Train Loss: 0.276 Vali Loss: 0.411 Vali Acc: 0.975 Test Loss: 0.411 Test Acc: 0.975
Validation loss decreased (-0.949995 --> -0.974996).  Saving model ...
Epoch: 13 cost time: 0.37103962898254395
Epoch: 13, Steps: 3 | Train Loss: 0.270 Vali Loss: 0.349 Vali Acc: 0.975 Test Loss: 0.349 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 14 cost time: 0.4147655963897705
Epoch: 14, Steps: 3 | Train Loss: 0.222 Vali Loss: 0.310 Vali Acc: 0.975 Test Loss: 0.310 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 15 cost time: 0.4396851062774658
Epoch: 15, Steps: 3 | Train Loss: 0.210 Vali Loss: 0.277 Vali Acc: 0.950 Test Loss: 0.277 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.4426593780517578
Epoch: 16, Steps: 3 | Train Loss: 0.169 Vali Loss: 0.257 Vali Acc: 0.975 Test Loss: 0.257 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 17 cost time: 0.4224894046783447
Epoch: 17, Steps: 3 | Train Loss: 0.122 Vali Loss: 0.243 Vali Acc: 0.950 Test Loss: 0.243 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.4158821105957031
Epoch: 18, Steps: 3 | Train Loss: 0.129 Vali Loss: 0.233 Vali Acc: 0.950 Test Loss: 0.233 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.42860865592956543
Epoch: 19, Steps: 3 | Train Loss: 0.094 Vali Loss: 0.219 Vali Acc: 0.950 Test Loss: 0.219 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.4134087562561035
Epoch: 20, Steps: 3 | Train Loss: 0.078 Vali Loss: 0.219 Vali Acc: 0.950 Test Loss: 0.219 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.39889025688171387
Epoch: 21, Steps: 3 | Train Loss: 0.078 Vali Loss: 0.224 Vali Acc: 0.950 Test Loss: 0.224 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.41471147537231445
Epoch: 22, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.221 Vali Acc: 0.950 Test Loss: 0.221 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.3950061798095703
Epoch: 23, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.214 Vali Acc: 0.950 Test Loss: 0.214 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.41143274307250977
Epoch: 24, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.217 Vali Acc: 0.950 Test Loss: 0.217 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.3948953151702881
Epoch: 25, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.216 Vali Acc: 0.950 Test Loss: 0.216 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.41760683059692383
Epoch: 26, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.209 Vali Acc: 0.950 Test Loss: 0.209 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 383748
model size : 1.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.4248366355895996
Epoch: 1, Steps: 3 | Train Loss: 1.398 Vali Loss: 1.400 Vali Acc: 0.275 Test Loss: 1.400 Test Acc: 0.275
Validation loss decreased (inf --> -0.274986).  Saving model ...
Epoch: 2 cost time: 0.43073582649230957
Epoch: 2, Steps: 3 | Train Loss: 1.349 Vali Loss: 1.368 Vali Acc: 0.275 Test Loss: 1.368 Test Acc: 0.275
Validation loss decreased (-0.274986 --> -0.274986).  Saving model ...
Epoch: 3 cost time: 0.41425514221191406
Epoch: 3, Steps: 3 | Train Loss: 1.305 Vali Loss: 1.308 Vali Acc: 0.500 Test Loss: 1.308 Test Acc: 0.500
Validation loss decreased (-0.274986 --> -0.499987).  Saving model ...
Epoch: 4 cost time: 0.40688204765319824
Epoch: 4, Steps: 3 | Train Loss: 1.170 Vali Loss: 1.234 Vali Acc: 0.575 Test Loss: 1.234 Test Acc: 0.575
Validation loss decreased (-0.499987 --> -0.574988).  Saving model ...
Epoch: 5 cost time: 0.40648603439331055
Epoch: 5, Steps: 3 | Train Loss: 1.043 Vali Loss: 1.141 Vali Acc: 0.600 Test Loss: 1.141 Test Acc: 0.600
Validation loss decreased (-0.574988 --> -0.599989).  Saving model ...
Epoch: 6 cost time: 0.44335055351257324
Epoch: 6, Steps: 3 | Train Loss: 0.914 Vali Loss: 1.051 Vali Acc: 0.650 Test Loss: 1.051 Test Acc: 0.650
Validation loss decreased (-0.599989 --> -0.649989).  Saving model ...
Epoch: 7 cost time: 0.4603688716888428
Epoch: 7, Steps: 3 | Train Loss: 0.786 Vali Loss: 0.957 Vali Acc: 0.725 Test Loss: 0.957 Test Acc: 0.725
Validation loss decreased (-0.649989 --> -0.724990).  Saving model ...
Epoch: 8 cost time: 0.4199824333190918
Epoch: 8, Steps: 3 | Train Loss: 0.721 Vali Loss: 0.852 Vali Acc: 0.750 Test Loss: 0.852 Test Acc: 0.750
Validation loss decreased (-0.724990 --> -0.749991).  Saving model ...
Epoch: 9 cost time: 0.45891523361206055
Epoch: 9, Steps: 3 | Train Loss: 0.603 Vali Loss: 0.755 Vali Acc: 0.925 Test Loss: 0.755 Test Acc: 0.925
Validation loss decreased (-0.749991 --> -0.924992).  Saving model ...
Epoch: 10 cost time: 0.43352675437927246
Epoch: 10, Steps: 3 | Train Loss: 0.516 Vali Loss: 0.683 Vali Acc: 0.925 Test Loss: 0.683 Test Acc: 0.925
Validation loss decreased (-0.924992 --> -0.924993).  Saving model ...
Epoch: 11 cost time: 0.4228987693786621
Epoch: 11, Steps: 3 | Train Loss: 0.430 Vali Loss: 0.614 Vali Acc: 0.900 Test Loss: 0.614 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.43700361251831055
Epoch: 12, Steps: 3 | Train Loss: 0.375 Vali Loss: 0.527 Vali Acc: 0.925 Test Loss: 0.527 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924995).  Saving model ...
Epoch: 13 cost time: 0.4358077049255371
Epoch: 13, Steps: 3 | Train Loss: 0.332 Vali Loss: 0.481 Vali Acc: 0.925 Test Loss: 0.481 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 14 cost time: 0.4538581371307373
Epoch: 14, Steps: 3 | Train Loss: 0.324 Vali Loss: 0.424 Vali Acc: 0.950 Test Loss: 0.424 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949996).  Saving model ...
Epoch: 15 cost time: 0.46646904945373535
Epoch: 15, Steps: 3 | Train Loss: 0.264 Vali Loss: 0.379 Vali Acc: 0.950 Test Loss: 0.379 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 16 cost time: 0.45194149017333984
Epoch: 16, Steps: 3 | Train Loss: 0.230 Vali Loss: 0.345 Vali Acc: 0.975 Test Loss: 0.345 Test Acc: 0.975
Validation loss decreased (-0.949996 --> -0.974997).  Saving model ...
Epoch: 17 cost time: 0.41976022720336914
Epoch: 17, Steps: 3 | Train Loss: 0.187 Vali Loss: 0.318 Vali Acc: 0.975 Test Loss: 0.318 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 18 cost time: 0.5302174091339111
Epoch: 18, Steps: 3 | Train Loss: 0.171 Vali Loss: 0.294 Vali Acc: 0.975 Test Loss: 0.294 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 19 cost time: 0.44887566566467285
Epoch: 19, Steps: 3 | Train Loss: 0.152 Vali Loss: 0.273 Vali Acc: 0.950 Test Loss: 0.273 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.4519979953765869
Epoch: 20, Steps: 3 | Train Loss: 0.133 Vali Loss: 0.248 Vali Acc: 0.950 Test Loss: 0.248 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.41701745986938477
Epoch: 21, Steps: 3 | Train Loss: 0.120 Vali Loss: 0.236 Vali Acc: 0.950 Test Loss: 0.236 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.38178491592407227
Epoch: 22, Steps: 3 | Train Loss: 0.105 Vali Loss: 0.227 Vali Acc: 0.950 Test Loss: 0.227 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.44882726669311523
Epoch: 23, Steps: 3 | Train Loss: 0.087 Vali Loss: 0.216 Vali Acc: 0.950 Test Loss: 0.216 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.4558112621307373
Epoch: 24, Steps: 3 | Train Loss: 0.086 Vali Loss: 0.211 Vali Acc: 0.950 Test Loss: 0.211 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.43080759048461914
Epoch: 25, Steps: 3 | Train Loss: 0.068 Vali Loss: 0.217 Vali Acc: 0.950 Test Loss: 0.217 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.430192232131958
Epoch: 26, Steps: 3 | Train Loss: 0.055 Vali Loss: 0.221 Vali Acc: 0.950 Test Loss: 0.221 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.4714534282684326
Epoch: 27, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.220 Vali Acc: 0.950 Test Loss: 0.220 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.4771146774291992
Epoch: 28, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.222 Vali Acc: 0.950 Test Loss: 0.222 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 359300
model size : 1.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.6001718044281006
Epoch: 1, Steps: 3 | Train Loss: 1.407 Vali Loss: 1.356 Vali Acc: 0.375 Test Loss: 1.356 Test Acc: 0.375
Validation loss decreased (inf --> -0.374986).  Saving model ...
Epoch: 2 cost time: 0.4508941173553467
Epoch: 2, Steps: 3 | Train Loss: 1.323 Vali Loss: 1.324 Vali Acc: 0.400 Test Loss: 1.324 Test Acc: 0.400
Validation loss decreased (-0.374986 --> -0.399987).  Saving model ...
Epoch: 3 cost time: 0.38484644889831543
Epoch: 3, Steps: 3 | Train Loss: 1.250 Vali Loss: 1.281 Vali Acc: 0.475 Test Loss: 1.281 Test Acc: 0.475
Validation loss decreased (-0.399987 --> -0.474987).  Saving model ...
Epoch: 4 cost time: 0.450878381729126
Epoch: 4, Steps: 3 | Train Loss: 1.203 Vali Loss: 1.222 Vali Acc: 0.525 Test Loss: 1.222 Test Acc: 0.525
Validation loss decreased (-0.474987 --> -0.524988).  Saving model ...
Epoch: 5 cost time: 0.4149155616760254
Epoch: 5, Steps: 3 | Train Loss: 1.095 Vali Loss: 1.147 Vali Acc: 0.575 Test Loss: 1.147 Test Acc: 0.575
Validation loss decreased (-0.524988 --> -0.574989).  Saving model ...
Epoch: 6 cost time: 0.40530896186828613
Epoch: 6, Steps: 3 | Train Loss: 0.992 Vali Loss: 1.063 Vali Acc: 0.600 Test Loss: 1.063 Test Acc: 0.600
Validation loss decreased (-0.574989 --> -0.599989).  Saving model ...
Epoch: 7 cost time: 0.4153015613555908
Epoch: 7, Steps: 3 | Train Loss: 0.929 Vali Loss: 0.970 Vali Acc: 0.675 Test Loss: 0.970 Test Acc: 0.675
Validation loss decreased (-0.599989 --> -0.674990).  Saving model ...
Epoch: 8 cost time: 0.43962907791137695
Epoch: 8, Steps: 3 | Train Loss: 0.780 Vali Loss: 0.886 Vali Acc: 0.900 Test Loss: 0.886 Test Acc: 0.900
Validation loss decreased (-0.674990 --> -0.899991).  Saving model ...
Epoch: 9 cost time: 0.3983597755432129
Epoch: 9, Steps: 3 | Train Loss: 0.691 Vali Loss: 0.799 Vali Acc: 0.900 Test Loss: 0.799 Test Acc: 0.900
Validation loss decreased (-0.899991 --> -0.899992).  Saving model ...
Epoch: 10 cost time: 0.40599632263183594
Epoch: 10, Steps: 3 | Train Loss: 0.607 Vali Loss: 0.713 Vali Acc: 0.900 Test Loss: 0.713 Test Acc: 0.900
Validation loss decreased (-0.899992 --> -0.899993).  Saving model ...
Epoch: 11 cost time: 0.42472028732299805
Epoch: 11, Steps: 3 | Train Loss: 0.510 Vali Loss: 0.634 Vali Acc: 0.925 Test Loss: 0.634 Test Acc: 0.925
Validation loss decreased (-0.899993 --> -0.924994).  Saving model ...
Epoch: 12 cost time: 0.4215867519378662
Epoch: 12, Steps: 3 | Train Loss: 0.467 Vali Loss: 0.568 Vali Acc: 0.925 Test Loss: 0.568 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 13 cost time: 0.4500143527984619
Epoch: 13, Steps: 3 | Train Loss: 0.404 Vali Loss: 0.518 Vali Acc: 0.925 Test Loss: 0.518 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 14 cost time: 0.41351985931396484
Epoch: 14, Steps: 3 | Train Loss: 0.347 Vali Loss: 0.475 Vali Acc: 0.900 Test Loss: 0.475 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.4097404479980469
Epoch: 15, Steps: 3 | Train Loss: 0.329 Vali Loss: 0.439 Vali Acc: 0.925 Test Loss: 0.439 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 16 cost time: 0.39865732192993164
Epoch: 16, Steps: 3 | Train Loss: 0.296 Vali Loss: 0.404 Vali Acc: 0.925 Test Loss: 0.404 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 17 cost time: 0.37604427337646484
Epoch: 17, Steps: 3 | Train Loss: 0.262 Vali Loss: 0.378 Vali Acc: 0.925 Test Loss: 0.378 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 18 cost time: 0.38294053077697754
Epoch: 18, Steps: 3 | Train Loss: 0.232 Vali Loss: 0.356 Vali Acc: 0.925 Test Loss: 0.356 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 19 cost time: 0.4424726963043213
Epoch: 19, Steps: 3 | Train Loss: 0.197 Vali Loss: 0.329 Vali Acc: 0.950 Test Loss: 0.329 Test Acc: 0.950
Validation loss decreased (-0.924996 --> -0.949997).  Saving model ...
Epoch: 20 cost time: 0.42684173583984375
Epoch: 20, Steps: 3 | Train Loss: 0.200 Vali Loss: 0.295 Vali Acc: 0.950 Test Loss: 0.295 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 21 cost time: 0.4695107936859131
Epoch: 21, Steps: 3 | Train Loss: 0.189 Vali Loss: 0.277 Vali Acc: 0.950 Test Loss: 0.277 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 22 cost time: 0.42513394355773926
Epoch: 22, Steps: 3 | Train Loss: 0.157 Vali Loss: 0.267 Vali Acc: 0.950 Test Loss: 0.267 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 23 cost time: 0.3908538818359375
Epoch: 23, Steps: 3 | Train Loss: 0.144 Vali Loss: 0.252 Vali Acc: 0.950 Test Loss: 0.252 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 24 cost time: 0.3772318363189697
Epoch: 24, Steps: 3 | Train Loss: 0.141 Vali Loss: 0.237 Vali Acc: 0.950 Test Loss: 0.237 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 25 cost time: 0.39694833755493164
Epoch: 25, Steps: 3 | Train Loss: 0.125 Vali Loss: 0.226 Vali Acc: 0.975 Test Loss: 0.226 Test Acc: 0.975
Validation loss decreased (-0.949998 --> -0.974998).  Saving model ...
Epoch: 26 cost time: 0.4827420711517334
Epoch: 26, Steps: 3 | Train Loss: 0.113 Vali Loss: 0.219 Vali Acc: 0.975 Test Loss: 0.219 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 27 cost time: 0.49878454208374023
Epoch: 27, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.202 Vali Acc: 0.975 Test Loss: 0.202 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 28 cost time: 0.4754188060760498
Epoch: 28, Steps: 3 | Train Loss: 0.089 Vali Loss: 0.194 Vali Acc: 0.975 Test Loss: 0.194 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 29 cost time: 0.4843168258666992
Epoch: 29, Steps: 3 | Train Loss: 0.074 Vali Loss: 0.186 Vali Acc: 0.975 Test Loss: 0.186 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 30 cost time: 0.5173676013946533
Epoch: 30, Steps: 3 | Train Loss: 0.079 Vali Loss: 0.184 Vali Acc: 0.975 Test Loss: 0.184 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 31 cost time: 0.43188953399658203
Epoch: 31, Steps: 3 | Train Loss: 0.073 Vali Loss: 0.178 Vali Acc: 0.975 Test Loss: 0.178 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 32 cost time: 0.5120992660522461
Epoch: 32, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.168 Vali Acc: 0.975 Test Loss: 0.168 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 33 cost time: 0.548651933670044
Epoch: 33, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.155 Vali Acc: 0.975 Test Loss: 0.155 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 34 cost time: 0.48145127296447754
Epoch: 34, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.149 Vali Acc: 0.975 Test Loss: 0.149 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974999).  Saving model ...
Epoch: 35 cost time: 0.5653648376464844
Epoch: 35, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.146 Vali Acc: 0.975 Test Loss: 0.146 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 36 cost time: 0.496307373046875
Epoch: 36, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.145 Vali Acc: 0.975 Test Loss: 0.145 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 37 cost time: 0.5321207046508789
Epoch: 37, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.145 Vali Acc: 0.975 Test Loss: 0.145 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 38 cost time: 0.4871997833251953
Epoch: 38, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.145 Vali Acc: 0.975 Test Loss: 0.145 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.49821043014526367
Epoch: 39, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.143 Vali Acc: 0.975 Test Loss: 0.143 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 40 cost time: 0.4676322937011719
Epoch: 40, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.142 Vali Acc: 0.975 Test Loss: 0.142 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 41 cost time: 0.47079920768737793
Epoch: 41, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.143 Vali Acc: 0.975 Test Loss: 0.143 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.4751584529876709
Epoch: 42, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.138 Vali Acc: 0.975 Test Loss: 0.138 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 43 cost time: 0.5115756988525391
Epoch: 43, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.140 Vali Acc: 0.975 Test Loss: 0.140 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.5015077590942383
Epoch: 44, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.144 Vali Acc: 0.975 Test Loss: 0.144 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.48260998725891113
Epoch: 45, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.138 Vali Acc: 0.975 Test Loss: 0.138 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 46 cost time: 0.4835219383239746
Epoch: 46, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.138 Vali Acc: 0.975 Test Loss: 0.138 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.47938013076782227
Epoch: 47, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.138 Vali Acc: 0.975 Test Loss: 0.138 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 48 cost time: 0.4557223320007324
Epoch: 48, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.138 Vali Acc: 0.975 Test Loss: 0.138 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.4825763702392578
Epoch: 49, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.138 Vali Acc: 0.975 Test Loss: 0.138 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.49368977546691895
Epoch: 50, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.140 Vali Acc: 0.975 Test Loss: 0.140 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 347204
model size : 1.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.5832757949829102
Epoch: 1, Steps: 3 | Train Loss: 1.420 Vali Loss: 1.405 Vali Acc: 0.250 Test Loss: 1.405 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 0.3747684955596924
Epoch: 2, Steps: 3 | Train Loss: 1.351 Vali Loss: 1.382 Vali Acc: 0.250 Test Loss: 1.382 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 3 cost time: 0.3472006320953369
Epoch: 3, Steps: 3 | Train Loss: 1.327 Vali Loss: 1.347 Vali Acc: 0.225 Test Loss: 1.347 Test Acc: 0.225
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.3805828094482422
Epoch: 4, Steps: 3 | Train Loss: 1.255 Vali Loss: 1.295 Vali Acc: 0.350 Test Loss: 1.295 Test Acc: 0.350
Validation loss decreased (-0.249986 --> -0.349987).  Saving model ...
Epoch: 5 cost time: 0.36666345596313477
Epoch: 5, Steps: 3 | Train Loss: 1.182 Vali Loss: 1.234 Vali Acc: 0.475 Test Loss: 1.234 Test Acc: 0.475
Validation loss decreased (-0.349987 --> -0.474988).  Saving model ...
Epoch: 6 cost time: 0.3793666362762451
Epoch: 6, Steps: 3 | Train Loss: 1.099 Vali Loss: 1.166 Vali Acc: 0.575 Test Loss: 1.166 Test Acc: 0.575
Validation loss decreased (-0.474988 --> -0.574988).  Saving model ...
Epoch: 7 cost time: 0.4438285827636719
Epoch: 7, Steps: 3 | Train Loss: 0.978 Vali Loss: 1.096 Vali Acc: 0.575 Test Loss: 1.096 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574989).  Saving model ...
Epoch: 8 cost time: 0.4063999652862549
Epoch: 8, Steps: 3 | Train Loss: 0.933 Vali Loss: 1.020 Vali Acc: 0.700 Test Loss: 1.020 Test Acc: 0.700
Validation loss decreased (-0.574989 --> -0.699990).  Saving model ...
Epoch: 9 cost time: 0.3901174068450928
Epoch: 9, Steps: 3 | Train Loss: 0.815 Vali Loss: 0.948 Vali Acc: 0.725 Test Loss: 0.948 Test Acc: 0.725
Validation loss decreased (-0.699990 --> -0.724991).  Saving model ...
Epoch: 10 cost time: 0.36511898040771484
Epoch: 10, Steps: 3 | Train Loss: 0.717 Vali Loss: 0.879 Vali Acc: 0.875 Test Loss: 0.879 Test Acc: 0.875
Validation loss decreased (-0.724991 --> -0.874991).  Saving model ...
Epoch: 11 cost time: 0.3561539649963379
Epoch: 11, Steps: 3 | Train Loss: 0.664 Vali Loss: 0.819 Vali Acc: 0.850 Test Loss: 0.819 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.47632694244384766
Epoch: 12, Steps: 3 | Train Loss: 0.583 Vali Loss: 0.757 Vali Acc: 0.825 Test Loss: 0.757 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.41329526901245117
Epoch: 13, Steps: 3 | Train Loss: 0.543 Vali Loss: 0.702 Vali Acc: 0.825 Test Loss: 0.702 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.40450215339660645
Epoch: 14, Steps: 3 | Train Loss: 0.470 Vali Loss: 0.655 Vali Acc: 0.850 Test Loss: 0.655 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.3554387092590332
Epoch: 15, Steps: 3 | Train Loss: 0.422 Vali Loss: 0.598 Vali Acc: 0.850 Test Loss: 0.598 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.37047505378723145
Epoch: 16, Steps: 3 | Train Loss: 0.385 Vali Loss: 0.550 Vali Acc: 0.925 Test Loss: 0.550 Test Acc: 0.925
Validation loss decreased (-0.874991 --> -0.924994).  Saving model ...
Epoch: 17 cost time: 0.40499091148376465
Epoch: 17, Steps: 3 | Train Loss: 0.351 Vali Loss: 0.500 Vali Acc: 0.925 Test Loss: 0.500 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 18 cost time: 0.3674612045288086
Epoch: 18, Steps: 3 | Train Loss: 0.315 Vali Loss: 0.456 Vali Acc: 0.950 Test Loss: 0.456 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949995).  Saving model ...
Epoch: 19 cost time: 0.3384387493133545
Epoch: 19, Steps: 3 | Train Loss: 0.272 Vali Loss: 0.422 Vali Acc: 0.950 Test Loss: 0.422 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 20 cost time: 0.3800809383392334
Epoch: 20, Steps: 3 | Train Loss: 0.266 Vali Loss: 0.395 Vali Acc: 0.950 Test Loss: 0.395 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 21 cost time: 0.3991885185241699
Epoch: 21, Steps: 3 | Train Loss: 0.261 Vali Loss: 0.378 Vali Acc: 0.950 Test Loss: 0.378 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 22 cost time: 0.41970181465148926
Epoch: 22, Steps: 3 | Train Loss: 0.227 Vali Loss: 0.352 Vali Acc: 0.950 Test Loss: 0.352 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 23 cost time: 0.39707064628601074
Epoch: 23, Steps: 3 | Train Loss: 0.224 Vali Loss: 0.335 Vali Acc: 0.950 Test Loss: 0.335 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 24 cost time: 0.36501336097717285
Epoch: 24, Steps: 3 | Train Loss: 0.185 Vali Loss: 0.327 Vali Acc: 0.950 Test Loss: 0.327 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 25 cost time: 0.38145875930786133
Epoch: 25, Steps: 3 | Train Loss: 0.187 Vali Loss: 0.319 Vali Acc: 0.950 Test Loss: 0.319 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 26 cost time: 0.36510300636291504
Epoch: 26, Steps: 3 | Train Loss: 0.163 Vali Loss: 0.295 Vali Acc: 0.950 Test Loss: 0.295 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 27 cost time: 0.38833045959472656
Epoch: 27, Steps: 3 | Train Loss: 0.139 Vali Loss: 0.289 Vali Acc: 0.950 Test Loss: 0.289 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 28 cost time: 0.4202258586883545
Epoch: 28, Steps: 3 | Train Loss: 0.140 Vali Loss: 0.288 Vali Acc: 0.950 Test Loss: 0.288 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 29 cost time: 0.3679015636444092
Epoch: 29, Steps: 3 | Train Loss: 0.142 Vali Loss: 0.272 Vali Acc: 0.950 Test Loss: 0.272 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 30 cost time: 0.4013326168060303
Epoch: 30, Steps: 3 | Train Loss: 0.127 Vali Loss: 0.265 Vali Acc: 0.950 Test Loss: 0.265 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 31 cost time: 0.39286112785339355
Epoch: 31, Steps: 3 | Train Loss: 0.099 Vali Loss: 0.257 Vali Acc: 0.950 Test Loss: 0.257 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 32 cost time: 0.41231775283813477
Epoch: 32, Steps: 3 | Train Loss: 0.094 Vali Loss: 0.245 Vali Acc: 0.950 Test Loss: 0.245 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 33 cost time: 0.3839576244354248
Epoch: 33, Steps: 3 | Train Loss: 0.105 Vali Loss: 0.237 Vali Acc: 0.950 Test Loss: 0.237 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 34 cost time: 0.383242130279541
Epoch: 34, Steps: 3 | Train Loss: 0.070 Vali Loss: 0.226 Vali Acc: 0.950 Test Loss: 0.226 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 35 cost time: 0.3840489387512207
Epoch: 35, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.214 Vali Acc: 0.950 Test Loss: 0.214 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 36 cost time: 0.43735837936401367
Epoch: 36, Steps: 3 | Train Loss: 0.072 Vali Loss: 0.210 Vali Acc: 0.950 Test Loss: 0.210 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 37 cost time: 0.41521453857421875
Epoch: 37, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.208 Vali Acc: 0.950 Test Loss: 0.208 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 38 cost time: 0.4553048610687256
Epoch: 38, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.201 Vali Acc: 0.950 Test Loss: 0.201 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 39 cost time: 0.39616870880126953
Epoch: 39, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.201 Vali Acc: 0.950 Test Loss: 0.201 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.4051523208618164
Epoch: 40, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.196 Vali Acc: 0.950 Test Loss: 0.196 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 41 cost time: 0.4000437259674072
Epoch: 41, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.196 Vali Acc: 0.950 Test Loss: 0.196 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 42 cost time: 0.4510536193847656
Epoch: 42, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.202 Vali Acc: 0.950 Test Loss: 0.202 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.418438196182251
Epoch: 43, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.198 Vali Acc: 0.950 Test Loss: 0.198 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.38486456871032715
Epoch: 44, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.212 Vali Acc: 0.950 Test Loss: 0.212 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.3880119323730469
Epoch: 45, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.206 Vali Acc: 0.950 Test Loss: 0.206 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.34389424324035645
Epoch: 46, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.202 Vali Acc: 0.950 Test Loss: 0.202 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.4080789089202881
Epoch: 47, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.195 Vali Acc: 0.950 Test Loss: 0.195 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 48 cost time: 0.3786458969116211
Epoch: 48, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.201 Vali Acc: 0.950 Test Loss: 0.201 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.4045836925506592
Epoch: 49, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.198 Vali Acc: 0.950 Test Loss: 0.198 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.3755953311920166
Epoch: 50, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.199 Vali Acc: 0.950 Test Loss: 0.199 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 338116
model size : 1.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.5422630310058594
Epoch: 1, Steps: 3 | Train Loss: 1.411 Vali Loss: 1.453 Vali Acc: 0.300 Test Loss: 1.453 Test Acc: 0.300
Validation loss decreased (inf --> -0.299985).  Saving model ...
Epoch: 2 cost time: 0.37633585929870605
Epoch: 2, Steps: 3 | Train Loss: 1.346 Vali Loss: 1.437 Vali Acc: 0.375 Test Loss: 1.437 Test Acc: 0.375
Validation loss decreased (-0.299985 --> -0.374986).  Saving model ...
Epoch: 3 cost time: 0.40499281883239746
Epoch: 3, Steps: 3 | Train Loss: 1.302 Vali Loss: 1.412 Vali Acc: 0.375 Test Loss: 1.412 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374986).  Saving model ...
Epoch: 4 cost time: 0.3517186641693115
Epoch: 4, Steps: 3 | Train Loss: 1.249 Vali Loss: 1.376 Vali Acc: 0.400 Test Loss: 1.376 Test Acc: 0.400
Validation loss decreased (-0.374986 --> -0.399986).  Saving model ...
Epoch: 5 cost time: 0.39980316162109375
Epoch: 5, Steps: 3 | Train Loss: 1.178 Vali Loss: 1.330 Vali Acc: 0.475 Test Loss: 1.330 Test Acc: 0.475
Validation loss decreased (-0.399986 --> -0.474987).  Saving model ...
Epoch: 6 cost time: 0.4283294677734375
Epoch: 6, Steps: 3 | Train Loss: 1.144 Vali Loss: 1.276 Vali Acc: 0.550 Test Loss: 1.276 Test Acc: 0.550
Validation loss decreased (-0.474987 --> -0.549987).  Saving model ...
Epoch: 7 cost time: 0.3832437992095947
Epoch: 7, Steps: 3 | Train Loss: 1.072 Vali Loss: 1.215 Vali Acc: 0.650 Test Loss: 1.215 Test Acc: 0.650
Validation loss decreased (-0.549987 --> -0.649988).  Saving model ...
Epoch: 8 cost time: 0.42281174659729004
Epoch: 8, Steps: 3 | Train Loss: 0.992 Vali Loss: 1.161 Vali Acc: 0.675 Test Loss: 1.161 Test Acc: 0.675
Validation loss decreased (-0.649988 --> -0.674988).  Saving model ...
Epoch: 9 cost time: 0.39018917083740234
Epoch: 9, Steps: 3 | Train Loss: 0.906 Vali Loss: 1.101 Vali Acc: 0.775 Test Loss: 1.101 Test Acc: 0.775
Validation loss decreased (-0.674988 --> -0.774989).  Saving model ...
Epoch: 10 cost time: 0.3800969123840332
Epoch: 10, Steps: 3 | Train Loss: 0.850 Vali Loss: 1.040 Vali Acc: 0.875 Test Loss: 1.040 Test Acc: 0.875
Validation loss decreased (-0.774989 --> -0.874990).  Saving model ...
Epoch: 11 cost time: 0.39020824432373047
Epoch: 11, Steps: 3 | Train Loss: 0.790 Vali Loss: 0.980 Vali Acc: 0.875 Test Loss: 0.980 Test Acc: 0.875
Validation loss decreased (-0.874990 --> -0.874990).  Saving model ...
Epoch: 12 cost time: 0.41541504859924316
Epoch: 12, Steps: 3 | Train Loss: 0.755 Vali Loss: 0.912 Vali Acc: 0.875 Test Loss: 0.912 Test Acc: 0.875
Validation loss decreased (-0.874990 --> -0.874991).  Saving model ...
Epoch: 13 cost time: 0.3942849636077881
Epoch: 13, Steps: 3 | Train Loss: 0.660 Vali Loss: 0.860 Vali Acc: 0.875 Test Loss: 0.860 Test Acc: 0.875
Validation loss decreased (-0.874991 --> -0.874991).  Saving model ...
Epoch: 14 cost time: 0.3586423397064209
Epoch: 14, Steps: 3 | Train Loss: 0.600 Vali Loss: 0.817 Vali Acc: 0.900 Test Loss: 0.817 Test Acc: 0.900
Validation loss decreased (-0.874991 --> -0.899992).  Saving model ...
Epoch: 15 cost time: 0.38935041427612305
Epoch: 15, Steps: 3 | Train Loss: 0.554 Vali Loss: 0.777 Vali Acc: 0.900 Test Loss: 0.777 Test Acc: 0.900
Validation loss decreased (-0.899992 --> -0.899992).  Saving model ...
Epoch: 16 cost time: 0.4186873435974121
Epoch: 16, Steps: 3 | Train Loss: 0.506 Vali Loss: 0.727 Vali Acc: 0.875 Test Loss: 0.727 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.3721299171447754
Epoch: 17, Steps: 3 | Train Loss: 0.448 Vali Loss: 0.679 Vali Acc: 0.950 Test Loss: 0.679 Test Acc: 0.950
Validation loss decreased (-0.899992 --> -0.949993).  Saving model ...
Epoch: 18 cost time: 0.3922581672668457
Epoch: 18, Steps: 3 | Train Loss: 0.441 Vali Loss: 0.634 Vali Acc: 0.925 Test Loss: 0.634 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.45575642585754395
Epoch: 19, Steps: 3 | Train Loss: 0.376 Vali Loss: 0.577 Vali Acc: 0.925 Test Loss: 0.577 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.38688158988952637
Epoch: 20, Steps: 3 | Train Loss: 0.379 Vali Loss: 0.538 Vali Acc: 0.925 Test Loss: 0.538 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.39232540130615234
Epoch: 21, Steps: 3 | Train Loss: 0.347 Vali Loss: 0.501 Vali Acc: 0.925 Test Loss: 0.501 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.37762928009033203
Epoch: 22, Steps: 3 | Train Loss: 0.311 Vali Loss: 0.482 Vali Acc: 0.925 Test Loss: 0.482 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.38367199897766113
Epoch: 23, Steps: 3 | Train Loss: 0.276 Vali Loss: 0.452 Vali Acc: 0.925 Test Loss: 0.452 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.4201486110687256
Epoch: 24, Steps: 3 | Train Loss: 0.262 Vali Loss: 0.444 Vali Acc: 0.925 Test Loss: 0.444 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.4083268642425537
Epoch: 25, Steps: 3 | Train Loss: 0.245 Vali Loss: 0.423 Vali Acc: 0.925 Test Loss: 0.423 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.3862004280090332
Epoch: 26, Steps: 3 | Train Loss: 0.238 Vali Loss: 0.413 Vali Acc: 0.925 Test Loss: 0.413 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.41916394233703613
Epoch: 27, Steps: 3 | Train Loss: 0.211 Vali Loss: 0.399 Vali Acc: 0.925 Test Loss: 0.399 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 326148
model size : 1.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps20_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.4971461296081543
Epoch: 1, Steps: 3 | Train Loss: 1.377 Vali Loss: 1.361 Vali Acc: 0.275 Test Loss: 1.361 Test Acc: 0.275
Validation loss decreased (inf --> -0.274986).  Saving model ...
Epoch: 2 cost time: 0.3605501651763916
Epoch: 2, Steps: 3 | Train Loss: 1.365 Vali Loss: 1.342 Vali Acc: 0.300 Test Loss: 1.342 Test Acc: 0.300
Validation loss decreased (-0.274986 --> -0.299987).  Saving model ...
Epoch: 3 cost time: 0.39906835556030273
Epoch: 3, Steps: 3 | Train Loss: 1.332 Vali Loss: 1.320 Vali Acc: 0.350 Test Loss: 1.320 Test Acc: 0.350
Validation loss decreased (-0.299987 --> -0.349987).  Saving model ...
Epoch: 4 cost time: 0.38112711906433105
Epoch: 4, Steps: 3 | Train Loss: 1.297 Vali Loss: 1.292 Vali Acc: 0.375 Test Loss: 1.292 Test Acc: 0.375
Validation loss decreased (-0.349987 --> -0.374987).  Saving model ...
Epoch: 5 cost time: 0.3846261501312256
Epoch: 5, Steps: 3 | Train Loss: 1.218 Vali Loss: 1.257 Vali Acc: 0.400 Test Loss: 1.257 Test Acc: 0.400
Validation loss decreased (-0.374987 --> -0.399987).  Saving model ...
Epoch: 6 cost time: 0.3971898555755615
Epoch: 6, Steps: 3 | Train Loss: 1.163 Vali Loss: 1.214 Vali Acc: 0.475 Test Loss: 1.214 Test Acc: 0.475
Validation loss decreased (-0.399987 --> -0.474988).  Saving model ...
Epoch: 7 cost time: 0.4094381332397461
Epoch: 7, Steps: 3 | Train Loss: 1.128 Vali Loss: 1.164 Vali Acc: 0.525 Test Loss: 1.164 Test Acc: 0.525
Validation loss decreased (-0.474988 --> -0.524988).  Saving model ...
Epoch: 8 cost time: 0.44205451011657715
Epoch: 8, Steps: 3 | Train Loss: 1.056 Vali Loss: 1.119 Vali Acc: 0.575 Test Loss: 1.119 Test Acc: 0.575
Validation loss decreased (-0.524988 --> -0.574989).  Saving model ...
Epoch: 9 cost time: 0.41399478912353516
Epoch: 9, Steps: 3 | Train Loss: 0.983 Vali Loss: 1.065 Vali Acc: 0.575 Test Loss: 1.065 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574989).  Saving model ...
Epoch: 10 cost time: 0.3842453956604004
Epoch: 10, Steps: 3 | Train Loss: 0.917 Vali Loss: 1.015 Vali Acc: 0.625 Test Loss: 1.015 Test Acc: 0.625
Validation loss decreased (-0.574989 --> -0.624990).  Saving model ...
Epoch: 11 cost time: 0.400956392288208
Epoch: 11, Steps: 3 | Train Loss: 0.852 Vali Loss: 0.971 Vali Acc: 0.625 Test Loss: 0.971 Test Acc: 0.625
Validation loss decreased (-0.624990 --> -0.624990).  Saving model ...
Epoch: 12 cost time: 0.3933553695678711
Epoch: 12, Steps: 3 | Train Loss: 0.801 Vali Loss: 0.912 Vali Acc: 0.725 Test Loss: 0.912 Test Acc: 0.725
Validation loss decreased (-0.624990 --> -0.724991).  Saving model ...
Epoch: 13 cost time: 0.3998382091522217
Epoch: 13, Steps: 3 | Train Loss: 0.767 Vali Loss: 0.852 Vali Acc: 0.775 Test Loss: 0.852 Test Acc: 0.775
Validation loss decreased (-0.724991 --> -0.774991).  Saving model ...
Epoch: 14 cost time: 0.40924644470214844
Epoch: 14, Steps: 3 | Train Loss: 0.700 Vali Loss: 0.817 Vali Acc: 0.900 Test Loss: 0.817 Test Acc: 0.900
Validation loss decreased (-0.774991 --> -0.899992).  Saving model ...
Epoch: 15 cost time: 0.38632798194885254
Epoch: 15, Steps: 3 | Train Loss: 0.654 Vali Loss: 0.759 Vali Acc: 0.900 Test Loss: 0.759 Test Acc: 0.900
Validation loss decreased (-0.899992 --> -0.899992).  Saving model ...
Epoch: 16 cost time: 0.44443798065185547
Epoch: 16, Steps: 3 | Train Loss: 0.588 Vali Loss: 0.718 Vali Acc: 0.900 Test Loss: 0.718 Test Acc: 0.900
Validation loss decreased (-0.899992 --> -0.899993).  Saving model ...
Epoch: 17 cost time: 0.41040658950805664
Epoch: 17, Steps: 3 | Train Loss: 0.576 Vali Loss: 0.687 Vali Acc: 0.900 Test Loss: 0.687 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 18 cost time: 0.4050314426422119
Epoch: 18, Steps: 3 | Train Loss: 0.530 Vali Loss: 0.642 Vali Acc: 0.925 Test Loss: 0.642 Test Acc: 0.925
Validation loss decreased (-0.899993 --> -0.924994).  Saving model ...
Epoch: 19 cost time: 0.4133014678955078
Epoch: 19, Steps: 3 | Train Loss: 0.484 Vali Loss: 0.606 Vali Acc: 0.925 Test Loss: 0.606 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 20 cost time: 0.4346635341644287
Epoch: 20, Steps: 3 | Train Loss: 0.453 Vali Loss: 0.582 Vali Acc: 0.925 Test Loss: 0.582 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 21 cost time: 0.4053359031677246
Epoch: 21, Steps: 3 | Train Loss: 0.434 Vali Loss: 0.546 Vali Acc: 0.925 Test Loss: 0.546 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 22 cost time: 0.38134074211120605
Epoch: 22, Steps: 3 | Train Loss: 0.401 Vali Loss: 0.518 Vali Acc: 0.925 Test Loss: 0.518 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 23 cost time: 0.41534852981567383
Epoch: 23, Steps: 3 | Train Loss: 0.377 Vali Loss: 0.497 Vali Acc: 0.925 Test Loss: 0.497 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 24 cost time: 0.3851320743560791
Epoch: 24, Steps: 3 | Train Loss: 0.333 Vali Loss: 0.480 Vali Acc: 0.925 Test Loss: 0.480 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 25 cost time: 0.40592026710510254
Epoch: 25, Steps: 3 | Train Loss: 0.330 Vali Loss: 0.460 Vali Acc: 0.925 Test Loss: 0.460 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 26 cost time: 0.40651488304138184
Epoch: 26, Steps: 3 | Train Loss: 0.323 Vali Loss: 0.439 Vali Acc: 0.950 Test Loss: 0.439 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949996).  Saving model ...
Epoch: 27 cost time: 0.4393496513366699
Epoch: 27, Steps: 3 | Train Loss: 0.286 Vali Loss: 0.414 Vali Acc: 0.950 Test Loss: 0.414 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 28 cost time: 0.42003917694091797
Epoch: 28, Steps: 3 | Train Loss: 0.282 Vali Loss: 0.402 Vali Acc: 0.950 Test Loss: 0.402 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 29 cost time: 0.4002804756164551
Epoch: 29, Steps: 3 | Train Loss: 0.263 Vali Loss: 0.385 Vali Acc: 0.950 Test Loss: 0.385 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 30 cost time: 0.3840343952178955
Epoch: 30, Steps: 3 | Train Loss: 0.274 Vali Loss: 0.367 Vali Acc: 0.950 Test Loss: 0.367 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 31 cost time: 0.4079933166503906
Epoch: 31, Steps: 3 | Train Loss: 0.225 Vali Loss: 0.345 Vali Acc: 0.975 Test Loss: 0.345 Test Acc: 0.975
Validation loss decreased (-0.949996 --> -0.974997).  Saving model ...
Epoch: 32 cost time: 0.4014246463775635
Epoch: 32, Steps: 3 | Train Loss: 0.219 Vali Loss: 0.335 Vali Acc: 0.975 Test Loss: 0.335 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 33 cost time: 0.41602015495300293
Epoch: 33, Steps: 3 | Train Loss: 0.232 Vali Loss: 0.320 Vali Acc: 0.975 Test Loss: 0.320 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 34 cost time: 0.39014697074890137
Epoch: 34, Steps: 3 | Train Loss: 0.201 Vali Loss: 0.308 Vali Acc: 0.975 Test Loss: 0.308 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 35 cost time: 0.41249513626098633
Epoch: 35, Steps: 3 | Train Loss: 0.194 Vali Loss: 0.304 Vali Acc: 0.975 Test Loss: 0.304 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 36 cost time: 0.41267871856689453
Epoch: 36, Steps: 3 | Train Loss: 0.176 Vali Loss: 0.286 Vali Acc: 0.975 Test Loss: 0.286 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 37 cost time: 0.38794541358947754
Epoch: 37, Steps: 3 | Train Loss: 0.179 Vali Loss: 0.288 Vali Acc: 0.975 Test Loss: 0.288 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.40230512619018555
Epoch: 38, Steps: 3 | Train Loss: 0.157 Vali Loss: 0.265 Vali Acc: 0.975 Test Loss: 0.265 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 39 cost time: 0.38716578483581543
Epoch: 39, Steps: 3 | Train Loss: 0.162 Vali Loss: 0.249 Vali Acc: 0.975 Test Loss: 0.249 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 40 cost time: 0.45267462730407715
Epoch: 40, Steps: 3 | Train Loss: 0.151 Vali Loss: 0.239 Vali Acc: 0.975 Test Loss: 0.239 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 41 cost time: 0.39667820930480957
Epoch: 41, Steps: 3 | Train Loss: 0.134 Vali Loss: 0.237 Vali Acc: 0.975 Test Loss: 0.237 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 42 cost time: 0.4903292655944824
Epoch: 42, Steps: 3 | Train Loss: 0.137 Vali Loss: 0.236 Vali Acc: 0.975 Test Loss: 0.236 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 43 cost time: 0.43193531036376953
Epoch: 43, Steps: 3 | Train Loss: 0.114 Vali Loss: 0.230 Vali Acc: 0.975 Test Loss: 0.230 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 44 cost time: 0.4096648693084717
Epoch: 44, Steps: 3 | Train Loss: 0.119 Vali Loss: 0.221 Vali Acc: 0.975 Test Loss: 0.221 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 45 cost time: 0.4286520481109619
Epoch: 45, Steps: 3 | Train Loss: 0.107 Vali Loss: 0.215 Vali Acc: 0.975 Test Loss: 0.215 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 46 cost time: 0.4752507209777832
Epoch: 46, Steps: 3 | Train Loss: 0.092 Vali Loss: 0.201 Vali Acc: 0.975 Test Loss: 0.201 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 47 cost time: 0.41812992095947266
Epoch: 47, Steps: 3 | Train Loss: 0.101 Vali Loss: 0.201 Vali Acc: 0.975 Test Loss: 0.201 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.41185808181762695
Epoch: 48, Steps: 3 | Train Loss: 0.098 Vali Loss: 0.201 Vali Acc: 0.975 Test Loss: 0.201 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 49 cost time: 0.43659257888793945
Epoch: 49, Steps: 3 | Train Loss: 0.080 Vali Loss: 0.201 Vali Acc: 0.975 Test Loss: 0.201 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.43983006477355957
Epoch: 50, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.187 Vali Acc: 0.975 Test Loss: 0.187 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps20_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 323396
model size : 1.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps25_str13_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.6564440727233887
Epoch: 1, Steps: 3 | Train Loss: 1.390 Vali Loss: 1.334 Vali Acc: 0.225 Test Loss: 1.334 Test Acc: 0.225
Validation loss decreased (inf --> -0.224987).  Saving model ...
Epoch: 2 cost time: 0.4305250644683838
Epoch: 2, Steps: 3 | Train Loss: 1.341 Vali Loss: 1.320 Vali Acc: 0.225 Test Loss: 1.320 Test Acc: 0.225
Validation loss decreased (-0.224987 --> -0.224987).  Saving model ...
Epoch: 3 cost time: 0.4392735958099365
Epoch: 3, Steps: 3 | Train Loss: 1.320 Vali Loss: 1.303 Vali Acc: 0.275 Test Loss: 1.303 Test Acc: 0.275
Validation loss decreased (-0.224987 --> -0.274987).  Saving model ...
Epoch: 4 cost time: 0.416332483291626
Epoch: 4, Steps: 3 | Train Loss: 1.291 Vali Loss: 1.280 Vali Acc: 0.300 Test Loss: 1.280 Test Acc: 0.300
Validation loss decreased (-0.274987 --> -0.299987).  Saving model ...
Epoch: 5 cost time: 0.4265453815460205
Epoch: 5, Steps: 3 | Train Loss: 1.266 Vali Loss: 1.251 Vali Acc: 0.350 Test Loss: 1.251 Test Acc: 0.350
Validation loss decreased (-0.299987 --> -0.349987).  Saving model ...
Epoch: 6 cost time: 0.4442474842071533
Epoch: 6, Steps: 3 | Train Loss: 1.191 Vali Loss: 1.218 Vali Acc: 0.375 Test Loss: 1.218 Test Acc: 0.375
Validation loss decreased (-0.349987 --> -0.374988).  Saving model ...
Epoch: 7 cost time: 0.4171290397644043
Epoch: 7, Steps: 3 | Train Loss: 1.150 Vali Loss: 1.180 Vali Acc: 0.425 Test Loss: 1.180 Test Acc: 0.425
Validation loss decreased (-0.374988 --> -0.424988).  Saving model ...
Epoch: 8 cost time: 0.37064456939697266
Epoch: 8, Steps: 3 | Train Loss: 1.085 Vali Loss: 1.142 Vali Acc: 0.600 Test Loss: 1.142 Test Acc: 0.600
Validation loss decreased (-0.424988 --> -0.599989).  Saving model ...
Epoch: 9 cost time: 0.4243190288543701
Epoch: 9, Steps: 3 | Train Loss: 1.033 Vali Loss: 1.099 Vali Acc: 0.675 Test Loss: 1.099 Test Acc: 0.675
Validation loss decreased (-0.599989 --> -0.674989).  Saving model ...
Epoch: 10 cost time: 0.4450538158416748
Epoch: 10, Steps: 3 | Train Loss: 0.950 Vali Loss: 1.060 Vali Acc: 0.725 Test Loss: 1.060 Test Acc: 0.725
Validation loss decreased (-0.674989 --> -0.724989).  Saving model ...
Epoch: 11 cost time: 0.43250608444213867
Epoch: 11, Steps: 3 | Train Loss: 0.929 Vali Loss: 1.018 Vali Acc: 0.725 Test Loss: 1.018 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724990).  Saving model ...
Epoch: 12 cost time: 0.44215846061706543
Epoch: 12, Steps: 3 | Train Loss: 0.843 Vali Loss: 0.972 Vali Acc: 0.750 Test Loss: 0.972 Test Acc: 0.750
Validation loss decreased (-0.724990 --> -0.749990).  Saving model ...
Epoch: 13 cost time: 0.4245948791503906
Epoch: 13, Steps: 3 | Train Loss: 0.823 Vali Loss: 0.924 Vali Acc: 0.800 Test Loss: 0.924 Test Acc: 0.800
Validation loss decreased (-0.749990 --> -0.799991).  Saving model ...
Epoch: 14 cost time: 0.42080163955688477
Epoch: 14, Steps: 3 | Train Loss: 0.737 Vali Loss: 0.885 Vali Acc: 0.825 Test Loss: 0.885 Test Acc: 0.825
Validation loss decreased (-0.799991 --> -0.824991).  Saving model ...
Epoch: 15 cost time: 0.45518040657043457
Epoch: 15, Steps: 3 | Train Loss: 0.727 Vali Loss: 0.852 Vali Acc: 0.825 Test Loss: 0.852 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824991).  Saving model ...
Epoch: 16 cost time: 0.4118375778198242
Epoch: 16, Steps: 3 | Train Loss: 0.645 Vali Loss: 0.815 Vali Acc: 0.825 Test Loss: 0.815 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824992).  Saving model ...
Epoch: 17 cost time: 0.4239978790283203
Epoch: 17, Steps: 3 | Train Loss: 0.606 Vali Loss: 0.787 Vali Acc: 0.850 Test Loss: 0.787 Test Acc: 0.850
Validation loss decreased (-0.824992 --> -0.849992).  Saving model ...
Epoch: 18 cost time: 0.3998250961303711
Epoch: 18, Steps: 3 | Train Loss: 0.581 Vali Loss: 0.744 Vali Acc: 0.850 Test Loss: 0.744 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849993).  Saving model ...
Epoch: 19 cost time: 0.48185086250305176
Epoch: 19, Steps: 3 | Train Loss: 0.537 Vali Loss: 0.711 Vali Acc: 0.875 Test Loss: 0.711 Test Acc: 0.875
Validation loss decreased (-0.849993 --> -0.874993).  Saving model ...
Epoch: 20 cost time: 0.4150104522705078
Epoch: 20, Steps: 3 | Train Loss: 0.511 Vali Loss: 0.678 Vali Acc: 0.875 Test Loss: 0.678 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 21 cost time: 0.42678332328796387
Epoch: 21, Steps: 3 | Train Loss: 0.455 Vali Loss: 0.656 Vali Acc: 0.875 Test Loss: 0.656 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 22 cost time: 0.44694972038269043
Epoch: 22, Steps: 3 | Train Loss: 0.443 Vali Loss: 0.622 Vali Acc: 0.875 Test Loss: 0.622 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 23 cost time: 0.3985311985015869
Epoch: 23, Steps: 3 | Train Loss: 0.424 Vali Loss: 0.617 Vali Acc: 0.900 Test Loss: 0.617 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899994).  Saving model ...
Epoch: 24 cost time: 0.45826029777526855
Epoch: 24, Steps: 3 | Train Loss: 0.399 Vali Loss: 0.587 Vali Acc: 0.900 Test Loss: 0.587 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 25 cost time: 0.410503625869751
Epoch: 25, Steps: 3 | Train Loss: 0.362 Vali Loss: 0.561 Vali Acc: 0.900 Test Loss: 0.561 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 26 cost time: 0.41960644721984863
Epoch: 26, Steps: 3 | Train Loss: 0.353 Vali Loss: 0.557 Vali Acc: 0.900 Test Loss: 0.557 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 27 cost time: 0.4182279109954834
Epoch: 27, Steps: 3 | Train Loss: 0.347 Vali Loss: 0.532 Vali Acc: 0.900 Test Loss: 0.532 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 28 cost time: 0.4357736110687256
Epoch: 28, Steps: 3 | Train Loss: 0.304 Vali Loss: 0.508 Vali Acc: 0.925 Test Loss: 0.508 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924995).  Saving model ...
Epoch: 29 cost time: 0.42200589179992676
Epoch: 29, Steps: 3 | Train Loss: 0.291 Vali Loss: 0.490 Vali Acc: 0.950 Test Loss: 0.490 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949995).  Saving model ...
Epoch: 30 cost time: 0.47855186462402344
Epoch: 30, Steps: 3 | Train Loss: 0.291 Vali Loss: 0.466 Vali Acc: 0.950 Test Loss: 0.466 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 31 cost time: 0.45878100395202637
Epoch: 31, Steps: 3 | Train Loss: 0.266 Vali Loss: 0.442 Vali Acc: 0.950 Test Loss: 0.442 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 32 cost time: 0.46825432777404785
Epoch: 32, Steps: 3 | Train Loss: 0.239 Vali Loss: 0.450 Vali Acc: 0.950 Test Loss: 0.450 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.46526026725769043
Epoch: 33, Steps: 3 | Train Loss: 0.226 Vali Loss: 0.426 Vali Acc: 0.950 Test Loss: 0.426 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 34 cost time: 0.4132652282714844
Epoch: 34, Steps: 3 | Train Loss: 0.236 Vali Loss: 0.415 Vali Acc: 0.950 Test Loss: 0.415 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 35 cost time: 0.5126276016235352
Epoch: 35, Steps: 3 | Train Loss: 0.211 Vali Loss: 0.413 Vali Acc: 0.925 Test Loss: 0.413 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.4702117443084717
Epoch: 36, Steps: 3 | Train Loss: 0.204 Vali Loss: 0.399 Vali Acc: 0.925 Test Loss: 0.399 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.43412089347839355
Epoch: 37, Steps: 3 | Train Loss: 0.190 Vali Loss: 0.380 Vali Acc: 0.950 Test Loss: 0.380 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 38 cost time: 0.467602014541626
Epoch: 38, Steps: 3 | Train Loss: 0.227 Vali Loss: 0.366 Vali Acc: 0.950 Test Loss: 0.366 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 39 cost time: 0.48690199851989746
Epoch: 39, Steps: 3 | Train Loss: 0.186 Vali Loss: 0.357 Vali Acc: 0.950 Test Loss: 0.357 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 40 cost time: 0.47077250480651855
Epoch: 40, Steps: 3 | Train Loss: 0.160 Vali Loss: 0.347 Vali Acc: 0.950 Test Loss: 0.347 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 41 cost time: 0.4345262050628662
Epoch: 41, Steps: 3 | Train Loss: 0.157 Vali Loss: 0.345 Vali Acc: 0.950 Test Loss: 0.345 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 42 cost time: 0.43123745918273926
Epoch: 42, Steps: 3 | Train Loss: 0.160 Vali Loss: 0.331 Vali Acc: 0.950 Test Loss: 0.331 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 43 cost time: 0.4769909381866455
Epoch: 43, Steps: 3 | Train Loss: 0.139 Vali Loss: 0.314 Vali Acc: 0.950 Test Loss: 0.314 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 44 cost time: 0.45899248123168945
Epoch: 44, Steps: 3 | Train Loss: 0.126 Vali Loss: 0.313 Vali Acc: 0.950 Test Loss: 0.313 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 45 cost time: 0.48091983795166016
Epoch: 45, Steps: 3 | Train Loss: 0.117 Vali Loss: 0.310 Vali Acc: 0.950 Test Loss: 0.310 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 46 cost time: 0.41911745071411133
Epoch: 46, Steps: 3 | Train Loss: 0.106 Vali Loss: 0.300 Vali Acc: 0.950 Test Loss: 0.300 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 47 cost time: 0.4012947082519531
Epoch: 47, Steps: 3 | Train Loss: 0.091 Vali Loss: 0.293 Vali Acc: 0.950 Test Loss: 0.293 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 48 cost time: 0.43625426292419434
Epoch: 48, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.304 Vali Acc: 0.950 Test Loss: 0.304 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.4360072612762451
Epoch: 49, Steps: 3 | Train Loss: 0.098 Vali Loss: 0.297 Vali Acc: 0.925 Test Loss: 0.297 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.4359006881713867
Epoch: 50, Steps: 3 | Train Loss: 0.071 Vali Loss: 0.294 Vali Acc: 0.925 Test Loss: 0.294 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps25_str13_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 320644
model size : 1.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.5822222232818604
Epoch: 1, Steps: 3 | Train Loss: 1.397 Vali Loss: 1.428 Vali Acc: 0.350 Test Loss: 1.428 Test Acc: 0.350
Validation loss decreased (inf --> -0.349986).  Saving model ...
Epoch: 2 cost time: 0.36412692070007324
Epoch: 2, Steps: 3 | Train Loss: 1.340 Vali Loss: 1.406 Vali Acc: 0.375 Test Loss: 1.406 Test Acc: 0.375
Validation loss decreased (-0.349986 --> -0.374986).  Saving model ...
Epoch: 3 cost time: 0.39871716499328613
Epoch: 3, Steps: 3 | Train Loss: 1.340 Vali Loss: 1.367 Vali Acc: 0.400 Test Loss: 1.367 Test Acc: 0.400
Validation loss decreased (-0.374986 --> -0.399986).  Saving model ...
Epoch: 4 cost time: 0.38738512992858887
Epoch: 4, Steps: 3 | Train Loss: 1.226 Vali Loss: 1.317 Vali Acc: 0.500 Test Loss: 1.317 Test Acc: 0.500
Validation loss decreased (-0.399986 --> -0.499987).  Saving model ...
Epoch: 5 cost time: 0.39511728286743164
Epoch: 5, Steps: 3 | Train Loss: 1.156 Vali Loss: 1.251 Vali Acc: 0.575 Test Loss: 1.251 Test Acc: 0.575
Validation loss decreased (-0.499987 --> -0.574987).  Saving model ...
Epoch: 6 cost time: 0.353238582611084
Epoch: 6, Steps: 3 | Train Loss: 1.079 Vali Loss: 1.185 Vali Acc: 0.625 Test Loss: 1.185 Test Acc: 0.625
Validation loss decreased (-0.574987 --> -0.624988).  Saving model ...
Epoch: 7 cost time: 0.382946252822876
Epoch: 7, Steps: 3 | Train Loss: 0.976 Vali Loss: 1.114 Vali Acc: 0.675 Test Loss: 1.114 Test Acc: 0.675
Validation loss decreased (-0.624988 --> -0.674989).  Saving model ...
Epoch: 8 cost time: 0.37651753425598145
Epoch: 8, Steps: 3 | Train Loss: 0.871 Vali Loss: 1.036 Vali Acc: 0.625 Test Loss: 1.036 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.4866960048675537
Epoch: 9, Steps: 3 | Train Loss: 0.813 Vali Loss: 0.949 Vali Acc: 0.850 Test Loss: 0.949 Test Acc: 0.850
Validation loss decreased (-0.674989 --> -0.849991).  Saving model ...
Epoch: 10 cost time: 0.40058016777038574
Epoch: 10, Steps: 3 | Train Loss: 0.733 Vali Loss: 0.864 Vali Acc: 0.850 Test Loss: 0.864 Test Acc: 0.850
Validation loss decreased (-0.849991 --> -0.849991).  Saving model ...
Epoch: 11 cost time: 0.3737459182739258
Epoch: 11, Steps: 3 | Train Loss: 0.634 Vali Loss: 0.805 Vali Acc: 0.900 Test Loss: 0.805 Test Acc: 0.900
Validation loss decreased (-0.849991 --> -0.899992).  Saving model ...
Epoch: 12 cost time: 0.41190004348754883
Epoch: 12, Steps: 3 | Train Loss: 0.554 Vali Loss: 0.734 Vali Acc: 0.900 Test Loss: 0.734 Test Acc: 0.900
Validation loss decreased (-0.899992 --> -0.899993).  Saving model ...
Epoch: 13 cost time: 0.41799020767211914
Epoch: 13, Steps: 3 | Train Loss: 0.504 Vali Loss: 0.681 Vali Acc: 0.900 Test Loss: 0.681 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 14 cost time: 0.3698110580444336
Epoch: 14, Steps: 3 | Train Loss: 0.451 Vali Loss: 0.634 Vali Acc: 0.925 Test Loss: 0.634 Test Acc: 0.925
Validation loss decreased (-0.899993 --> -0.924994).  Saving model ...
Epoch: 15 cost time: 0.3898298740386963
Epoch: 15, Steps: 3 | Train Loss: 0.421 Vali Loss: 0.576 Vali Acc: 0.925 Test Loss: 0.576 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 16 cost time: 0.37278318405151367
Epoch: 16, Steps: 3 | Train Loss: 0.361 Vali Loss: 0.530 Vali Acc: 0.925 Test Loss: 0.530 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 17 cost time: 0.3881497383117676
Epoch: 17, Steps: 3 | Train Loss: 0.333 Vali Loss: 0.498 Vali Acc: 0.900 Test Loss: 0.498 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.38251352310180664
Epoch: 18, Steps: 3 | Train Loss: 0.296 Vali Loss: 0.454 Vali Acc: 0.925 Test Loss: 0.454 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 19 cost time: 0.39729785919189453
Epoch: 19, Steps: 3 | Train Loss: 0.277 Vali Loss: 0.424 Vali Acc: 0.925 Test Loss: 0.424 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 20 cost time: 0.36228275299072266
Epoch: 20, Steps: 3 | Train Loss: 0.238 Vali Loss: 0.399 Vali Acc: 0.925 Test Loss: 0.399 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 21 cost time: 0.4047715663909912
Epoch: 21, Steps: 3 | Train Loss: 0.241 Vali Loss: 0.374 Vali Acc: 0.925 Test Loss: 0.374 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 22 cost time: 0.4011518955230713
Epoch: 22, Steps: 3 | Train Loss: 0.243 Vali Loss: 0.357 Vali Acc: 0.925 Test Loss: 0.357 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 23 cost time: 0.37362098693847656
Epoch: 23, Steps: 3 | Train Loss: 0.207 Vali Loss: 0.337 Vali Acc: 0.950 Test Loss: 0.337 Test Acc: 0.950
Validation loss decreased (-0.924996 --> -0.949997).  Saving model ...
Epoch: 24 cost time: 0.3652341365814209
Epoch: 24, Steps: 3 | Train Loss: 0.189 Vali Loss: 0.331 Vali Acc: 0.950 Test Loss: 0.331 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 25 cost time: 0.3800826072692871
Epoch: 25, Steps: 3 | Train Loss: 0.171 Vali Loss: 0.322 Vali Acc: 0.950 Test Loss: 0.322 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 26 cost time: 0.3561697006225586
Epoch: 26, Steps: 3 | Train Loss: 0.165 Vali Loss: 0.308 Vali Acc: 0.950 Test Loss: 0.308 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 27 cost time: 0.3392646312713623
Epoch: 27, Steps: 3 | Train Loss: 0.152 Vali Loss: 0.301 Vali Acc: 0.950 Test Loss: 0.301 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 28 cost time: 0.4347560405731201
Epoch: 28, Steps: 3 | Train Loss: 0.153 Vali Loss: 0.286 Vali Acc: 0.950 Test Loss: 0.286 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 29 cost time: 0.34092116355895996
Epoch: 29, Steps: 3 | Train Loss: 0.146 Vali Loss: 0.271 Vali Acc: 0.950 Test Loss: 0.271 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 30 cost time: 0.39507627487182617
Epoch: 30, Steps: 3 | Train Loss: 0.126 Vali Loss: 0.261 Vali Acc: 0.950 Test Loss: 0.261 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 31 cost time: 0.3406393527984619
Epoch: 31, Steps: 3 | Train Loss: 0.117 Vali Loss: 0.254 Vali Acc: 0.950 Test Loss: 0.254 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 32 cost time: 0.34078383445739746
Epoch: 32, Steps: 3 | Train Loss: 0.095 Vali Loss: 0.238 Vali Acc: 0.950 Test Loss: 0.238 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 33 cost time: 0.41288042068481445
Epoch: 33, Steps: 3 | Train Loss: 0.095 Vali Loss: 0.237 Vali Acc: 0.950 Test Loss: 0.237 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 34 cost time: 0.37970423698425293
Epoch: 34, Steps: 3 | Train Loss: 0.082 Vali Loss: 0.228 Vali Acc: 0.950 Test Loss: 0.228 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 35 cost time: 0.40903615951538086
Epoch: 35, Steps: 3 | Train Loss: 0.080 Vali Loss: 0.226 Vali Acc: 0.950 Test Loss: 0.226 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 36 cost time: 0.48728156089782715
Epoch: 36, Steps: 3 | Train Loss: 0.081 Vali Loss: 0.224 Vali Acc: 0.950 Test Loss: 0.224 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 37 cost time: 0.4078223705291748
Epoch: 37, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.222 Vali Acc: 0.950 Test Loss: 0.222 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 38 cost time: 0.40131616592407227
Epoch: 38, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.223 Vali Acc: 0.950 Test Loss: 0.223 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.4369339942932129
Epoch: 39, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.227 Vali Acc: 0.950 Test Loss: 0.227 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.36700916290283203
Epoch: 40, Steps: 3 | Train Loss: 0.055 Vali Loss: 0.230 Vali Acc: 0.950 Test Loss: 0.230 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.37798309326171875
Epoch: 41, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.225 Vali Acc: 0.950 Test Loss: 0.225 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.3886599540710449
Epoch: 42, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.227 Vali Acc: 0.950 Test Loss: 0.227 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.4289095401763916
Epoch: 43, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.224 Vali Acc: 0.950 Test Loss: 0.224 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.381695032119751
Epoch: 44, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.221 Vali Acc: 0.950 Test Loss: 0.221 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 45 cost time: 0.49378442764282227
Epoch: 45, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.231 Vali Acc: 0.950 Test Loss: 0.231 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.5171849727630615
Epoch: 46, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.227 Vali Acc: 0.950 Test Loss: 0.227 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.5038599967956543
Epoch: 47, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.222 Vali Acc: 0.950 Test Loss: 0.222 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.5025920867919922
Epoch: 48, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.228 Vali Acc: 0.950 Test Loss: 0.228 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.443920373916626
Epoch: 49, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.223 Vali Acc: 0.950 Test Loss: 0.223 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.5349740982055664
Epoch: 50, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.214 Vali Acc: 0.950 Test Loss: 0.214 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 126340
model size : 0.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.5284302234649658
Epoch: 1, Steps: 3 | Train Loss: 1.352 Vali Loss: 1.413 Vali Acc: 0.350 Test Loss: 1.413 Test Acc: 0.350
Validation loss decreased (inf --> -0.349986).  Saving model ...
Epoch: 2 cost time: 0.41745519638061523
Epoch: 2, Steps: 3 | Train Loss: 1.344 Vali Loss: 1.394 Vali Acc: 0.400 Test Loss: 1.394 Test Acc: 0.400
Validation loss decreased (-0.349986 --> -0.399986).  Saving model ...
Epoch: 3 cost time: 0.3694641590118408
Epoch: 3, Steps: 3 | Train Loss: 1.261 Vali Loss: 1.370 Vali Acc: 0.425 Test Loss: 1.370 Test Acc: 0.425
Validation loss decreased (-0.399986 --> -0.424986).  Saving model ...
Epoch: 4 cost time: 0.3966813087463379
Epoch: 4, Steps: 3 | Train Loss: 1.223 Vali Loss: 1.329 Vali Acc: 0.475 Test Loss: 1.329 Test Acc: 0.475
Validation loss decreased (-0.424986 --> -0.474987).  Saving model ...
Epoch: 5 cost time: 0.42336392402648926
Epoch: 5, Steps: 3 | Train Loss: 1.163 Vali Loss: 1.276 Vali Acc: 0.475 Test Loss: 1.276 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474987).  Saving model ...
Epoch: 6 cost time: 0.36577630043029785
Epoch: 6, Steps: 3 | Train Loss: 1.080 Vali Loss: 1.215 Vali Acc: 0.675 Test Loss: 1.215 Test Acc: 0.675
Validation loss decreased (-0.474987 --> -0.674988).  Saving model ...
Epoch: 7 cost time: 0.3722529411315918
Epoch: 7, Steps: 3 | Train Loss: 0.996 Vali Loss: 1.148 Vali Acc: 0.700 Test Loss: 1.148 Test Acc: 0.700
Validation loss decreased (-0.674988 --> -0.699989).  Saving model ...
Epoch: 8 cost time: 0.358931303024292
Epoch: 8, Steps: 3 | Train Loss: 0.898 Vali Loss: 1.081 Vali Acc: 0.725 Test Loss: 1.081 Test Acc: 0.725
Validation loss decreased (-0.699989 --> -0.724989).  Saving model ...
Epoch: 9 cost time: 0.369492769241333
Epoch: 9, Steps: 3 | Train Loss: 0.850 Vali Loss: 1.018 Vali Acc: 0.725 Test Loss: 1.018 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724990).  Saving model ...
Epoch: 10 cost time: 0.3755612373352051
Epoch: 10, Steps: 3 | Train Loss: 0.769 Vali Loss: 0.948 Vali Acc: 0.725 Test Loss: 0.948 Test Acc: 0.725
Validation loss decreased (-0.724990 --> -0.724991).  Saving model ...
Epoch: 11 cost time: 0.38997554779052734
Epoch: 11, Steps: 3 | Train Loss: 0.697 Vali Loss: 0.877 Vali Acc: 0.775 Test Loss: 0.877 Test Acc: 0.775
Validation loss decreased (-0.724991 --> -0.774991).  Saving model ...
Epoch: 12 cost time: 0.36106443405151367
Epoch: 12, Steps: 3 | Train Loss: 0.624 Vali Loss: 0.815 Vali Acc: 0.800 Test Loss: 0.815 Test Acc: 0.800
Validation loss decreased (-0.774991 --> -0.799992).  Saving model ...
Epoch: 13 cost time: 0.3828573226928711
Epoch: 13, Steps: 3 | Train Loss: 0.564 Vali Loss: 0.754 Vali Acc: 0.800 Test Loss: 0.754 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799992).  Saving model ...
Epoch: 14 cost time: 0.3996398448944092
Epoch: 14, Steps: 3 | Train Loss: 0.514 Vali Loss: 0.699 Vali Acc: 0.800 Test Loss: 0.699 Test Acc: 0.800
Validation loss decreased (-0.799992 --> -0.799993).  Saving model ...
Epoch: 15 cost time: 0.3589167594909668
Epoch: 15, Steps: 3 | Train Loss: 0.473 Vali Loss: 0.653 Vali Acc: 0.825 Test Loss: 0.653 Test Acc: 0.825
Validation loss decreased (-0.799993 --> -0.824993).  Saving model ...
Epoch: 16 cost time: 0.40328001976013184
Epoch: 16, Steps: 3 | Train Loss: 0.441 Vali Loss: 0.619 Vali Acc: 0.875 Test Loss: 0.619 Test Acc: 0.875
Validation loss decreased (-0.824993 --> -0.874994).  Saving model ...
Epoch: 17 cost time: 0.3722412586212158
Epoch: 17, Steps: 3 | Train Loss: 0.391 Vali Loss: 0.583 Vali Acc: 0.900 Test Loss: 0.583 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899994).  Saving model ...
Epoch: 18 cost time: 0.3708038330078125
Epoch: 18, Steps: 3 | Train Loss: 0.395 Vali Loss: 0.533 Vali Acc: 0.900 Test Loss: 0.533 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 19 cost time: 0.4122202396392822
Epoch: 19, Steps: 3 | Train Loss: 0.334 Vali Loss: 0.503 Vali Acc: 0.900 Test Loss: 0.503 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 20 cost time: 0.3947446346282959
Epoch: 20, Steps: 3 | Train Loss: 0.298 Vali Loss: 0.483 Vali Acc: 0.925 Test Loss: 0.483 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924995).  Saving model ...
Epoch: 21 cost time: 0.369187593460083
Epoch: 21, Steps: 3 | Train Loss: 0.296 Vali Loss: 0.452 Vali Acc: 0.900 Test Loss: 0.452 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.3528451919555664
Epoch: 22, Steps: 3 | Train Loss: 0.250 Vali Loss: 0.431 Vali Acc: 0.900 Test Loss: 0.431 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.3728935718536377
Epoch: 23, Steps: 3 | Train Loss: 0.253 Vali Loss: 0.413 Vali Acc: 0.900 Test Loss: 0.413 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.43285202980041504
Epoch: 24, Steps: 3 | Train Loss: 0.214 Vali Loss: 0.401 Vali Acc: 0.900 Test Loss: 0.401 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.41626882553100586
Epoch: 25, Steps: 3 | Train Loss: 0.207 Vali Loss: 0.376 Vali Acc: 0.925 Test Loss: 0.376 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 26 cost time: 0.3673439025878906
Epoch: 26, Steps: 3 | Train Loss: 0.197 Vali Loss: 0.360 Vali Acc: 0.900 Test Loss: 0.360 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.36350131034851074
Epoch: 27, Steps: 3 | Train Loss: 0.182 Vali Loss: 0.342 Vali Acc: 0.900 Test Loss: 0.342 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.35840630531311035
Epoch: 28, Steps: 3 | Train Loss: 0.167 Vali Loss: 0.332 Vali Acc: 0.900 Test Loss: 0.332 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.3884866237640381
Epoch: 29, Steps: 3 | Train Loss: 0.157 Vali Loss: 0.324 Vali Acc: 0.900 Test Loss: 0.324 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.3666386604309082
Epoch: 30, Steps: 3 | Train Loss: 0.145 Vali Loss: 0.311 Vali Acc: 0.900 Test Loss: 0.311 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.3655402660369873
Epoch: 31, Steps: 3 | Train Loss: 0.140 Vali Loss: 0.309 Vali Acc: 0.900 Test Loss: 0.309 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.36846303939819336
Epoch: 32, Steps: 3 | Train Loss: 0.139 Vali Loss: 0.304 Vali Acc: 0.925 Test Loss: 0.304 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924997).  Saving model ...
Epoch: 33 cost time: 0.3779563903808594
Epoch: 33, Steps: 3 | Train Loss: 0.125 Vali Loss: 0.302 Vali Acc: 0.925 Test Loss: 0.302 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 34 cost time: 0.3746023178100586
Epoch: 34, Steps: 3 | Train Loss: 0.103 Vali Loss: 0.292 Vali Acc: 0.925 Test Loss: 0.292 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 35 cost time: 0.3209259510040283
Epoch: 35, Steps: 3 | Train Loss: 0.098 Vali Loss: 0.291 Vali Acc: 0.925 Test Loss: 0.291 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 36 cost time: 0.39415907859802246
Epoch: 36, Steps: 3 | Train Loss: 0.090 Vali Loss: 0.287 Vali Acc: 0.925 Test Loss: 0.287 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 37 cost time: 0.3635525703430176
Epoch: 37, Steps: 3 | Train Loss: 0.091 Vali Loss: 0.285 Vali Acc: 0.925 Test Loss: 0.285 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 38 cost time: 0.3913545608520508
Epoch: 38, Steps: 3 | Train Loss: 0.086 Vali Loss: 0.283 Vali Acc: 0.925 Test Loss: 0.283 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 39 cost time: 0.36185264587402344
Epoch: 39, Steps: 3 | Train Loss: 0.076 Vali Loss: 0.263 Vali Acc: 0.950 Test Loss: 0.263 Test Acc: 0.950
Validation loss decreased (-0.924997 --> -0.949997).  Saving model ...
Epoch: 40 cost time: 0.383969783782959
Epoch: 40, Steps: 3 | Train Loss: 0.068 Vali Loss: 0.245 Vali Acc: 0.950 Test Loss: 0.245 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 41 cost time: 0.3657872676849365
Epoch: 41, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.234 Vali Acc: 0.950 Test Loss: 0.234 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 42 cost time: 0.3678004741668701
Epoch: 42, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.223 Vali Acc: 0.950 Test Loss: 0.223 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 43 cost time: 0.39365601539611816
Epoch: 43, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.223 Vali Acc: 0.950 Test Loss: 0.223 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.39489006996154785
Epoch: 44, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.215 Vali Acc: 0.950 Test Loss: 0.215 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 45 cost time: 0.4010488986968994
Epoch: 45, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.211 Vali Acc: 0.950 Test Loss: 0.211 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 46 cost time: 0.36736178398132324
Epoch: 46, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.213 Vali Acc: 0.950 Test Loss: 0.213 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.3747291564941406
Epoch: 47, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.216 Vali Acc: 0.950 Test Loss: 0.216 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.4331507682800293
Epoch: 48, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.215 Vali Acc: 0.950 Test Loss: 0.215 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.3645594120025635
Epoch: 49, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.212 Vali Acc: 0.950 Test Loss: 0.212 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.4170506000518799
Epoch: 50, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.214 Vali Acc: 0.950 Test Loss: 0.214 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 114116
model size : 0.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.6415674686431885
Epoch: 1, Steps: 3 | Train Loss: 1.423 Vali Loss: 1.406 Vali Acc: 0.450 Test Loss: 1.406 Test Acc: 0.450
Validation loss decreased (inf --> -0.449986).  Saving model ...
Epoch: 2 cost time: 0.38821959495544434
Epoch: 2, Steps: 3 | Train Loss: 1.413 Vali Loss: 1.386 Vali Acc: 0.425 Test Loss: 1.386 Test Acc: 0.425
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4150979518890381
Epoch: 3, Steps: 3 | Train Loss: 1.381 Vali Loss: 1.362 Vali Acc: 0.450 Test Loss: 1.362 Test Acc: 0.450
Validation loss decreased (-0.449986 --> -0.449986).  Saving model ...
Epoch: 4 cost time: 0.4400062561035156
Epoch: 4, Steps: 3 | Train Loss: 1.317 Vali Loss: 1.326 Vali Acc: 0.550 Test Loss: 1.326 Test Acc: 0.550
Validation loss decreased (-0.449986 --> -0.549987).  Saving model ...
Epoch: 5 cost time: 0.3810436725616455
Epoch: 5, Steps: 3 | Train Loss: 1.250 Vali Loss: 1.278 Vali Acc: 0.625 Test Loss: 1.278 Test Acc: 0.625
Validation loss decreased (-0.549987 --> -0.624987).  Saving model ...
Epoch: 6 cost time: 0.37468791007995605
Epoch: 6, Steps: 3 | Train Loss: 1.171 Vali Loss: 1.225 Vali Acc: 0.700 Test Loss: 1.225 Test Acc: 0.700
Validation loss decreased (-0.624987 --> -0.699988).  Saving model ...
Epoch: 7 cost time: 0.376986026763916
Epoch: 7, Steps: 3 | Train Loss: 1.101 Vali Loss: 1.166 Vali Acc: 0.775 Test Loss: 1.166 Test Acc: 0.775
Validation loss decreased (-0.699988 --> -0.774988).  Saving model ...
Epoch: 8 cost time: 0.3799605369567871
Epoch: 8, Steps: 3 | Train Loss: 1.036 Vali Loss: 1.106 Vali Acc: 0.800 Test Loss: 1.106 Test Acc: 0.800
Validation loss decreased (-0.774988 --> -0.799989).  Saving model ...
Epoch: 9 cost time: 0.4033081531524658
Epoch: 9, Steps: 3 | Train Loss: 0.959 Vali Loss: 1.046 Vali Acc: 0.800 Test Loss: 1.046 Test Acc: 0.800
Validation loss decreased (-0.799989 --> -0.799990).  Saving model ...
Epoch: 10 cost time: 0.3878591060638428
Epoch: 10, Steps: 3 | Train Loss: 0.901 Vali Loss: 0.987 Vali Acc: 0.800 Test Loss: 0.987 Test Acc: 0.800
Validation loss decreased (-0.799990 --> -0.799990).  Saving model ...
Epoch: 11 cost time: 0.350111722946167
Epoch: 11, Steps: 3 | Train Loss: 0.817 Vali Loss: 0.930 Vali Acc: 0.825 Test Loss: 0.930 Test Acc: 0.825
Validation loss decreased (-0.799990 --> -0.824991).  Saving model ...
Epoch: 12 cost time: 0.38181281089782715
Epoch: 12, Steps: 3 | Train Loss: 0.785 Vali Loss: 0.870 Vali Acc: 0.850 Test Loss: 0.870 Test Acc: 0.850
Validation loss decreased (-0.824991 --> -0.849991).  Saving model ...
Epoch: 13 cost time: 0.38973474502563477
Epoch: 13, Steps: 3 | Train Loss: 0.701 Vali Loss: 0.815 Vali Acc: 0.850 Test Loss: 0.815 Test Acc: 0.850
Validation loss decreased (-0.849991 --> -0.849992).  Saving model ...
Epoch: 14 cost time: 0.39214372634887695
Epoch: 14, Steps: 3 | Train Loss: 0.644 Vali Loss: 0.764 Vali Acc: 0.900 Test Loss: 0.764 Test Acc: 0.900
Validation loss decreased (-0.849992 --> -0.899992).  Saving model ...
Epoch: 15 cost time: 0.3928334712982178
Epoch: 15, Steps: 3 | Train Loss: 0.605 Vali Loss: 0.714 Vali Acc: 0.900 Test Loss: 0.714 Test Acc: 0.900
Validation loss decreased (-0.899992 --> -0.899993).  Saving model ...
Epoch: 16 cost time: 0.39279627799987793
Epoch: 16, Steps: 3 | Train Loss: 0.557 Vali Loss: 0.659 Vali Acc: 0.925 Test Loss: 0.659 Test Acc: 0.925
Validation loss decreased (-0.899993 --> -0.924993).  Saving model ...
Epoch: 17 cost time: 0.38616275787353516
Epoch: 17, Steps: 3 | Train Loss: 0.508 Vali Loss: 0.626 Vali Acc: 0.925 Test Loss: 0.626 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924994).  Saving model ...
Epoch: 18 cost time: 0.4479084014892578
Epoch: 18, Steps: 3 | Train Loss: 0.449 Vali Loss: 0.583 Vali Acc: 0.925 Test Loss: 0.583 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 19 cost time: 0.4285740852355957
Epoch: 19, Steps: 3 | Train Loss: 0.435 Vali Loss: 0.560 Vali Acc: 0.925 Test Loss: 0.560 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 20 cost time: 0.36246275901794434
Epoch: 20, Steps: 3 | Train Loss: 0.381 Vali Loss: 0.539 Vali Acc: 0.925 Test Loss: 0.539 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 21 cost time: 0.38138699531555176
Epoch: 21, Steps: 3 | Train Loss: 0.357 Vali Loss: 0.517 Vali Acc: 0.925 Test Loss: 0.517 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 22 cost time: 0.3758971691131592
Epoch: 22, Steps: 3 | Train Loss: 0.332 Vali Loss: 0.491 Vali Acc: 0.925 Test Loss: 0.491 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 23 cost time: 0.36113500595092773
Epoch: 23, Steps: 3 | Train Loss: 0.300 Vali Loss: 0.465 Vali Acc: 0.925 Test Loss: 0.465 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 24 cost time: 0.3839414119720459
Epoch: 24, Steps: 3 | Train Loss: 0.301 Vali Loss: 0.445 Vali Acc: 0.925 Test Loss: 0.445 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 25 cost time: 0.4955167770385742
Epoch: 25, Steps: 3 | Train Loss: 0.294 Vali Loss: 0.436 Vali Acc: 0.925 Test Loss: 0.436 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 26 cost time: 0.37032222747802734
Epoch: 26, Steps: 3 | Train Loss: 0.252 Vali Loss: 0.407 Vali Acc: 0.925 Test Loss: 0.407 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 27 cost time: 0.4626328945159912
Epoch: 27, Steps: 3 | Train Loss: 0.232 Vali Loss: 0.385 Vali Acc: 0.950 Test Loss: 0.385 Test Acc: 0.950
Validation loss decreased (-0.924996 --> -0.949996).  Saving model ...
Epoch: 28 cost time: 0.3678324222564697
Epoch: 28, Steps: 3 | Train Loss: 0.234 Vali Loss: 0.358 Vali Acc: 0.975 Test Loss: 0.358 Test Acc: 0.975
Validation loss decreased (-0.949996 --> -0.974996).  Saving model ...
Epoch: 29 cost time: 0.3677089214324951
Epoch: 29, Steps: 3 | Train Loss: 0.219 Vali Loss: 0.342 Vali Acc: 0.975 Test Loss: 0.342 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 30 cost time: 0.3763999938964844
Epoch: 30, Steps: 3 | Train Loss: 0.201 Vali Loss: 0.332 Vali Acc: 0.975 Test Loss: 0.332 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 31 cost time: 0.4117157459259033
Epoch: 31, Steps: 3 | Train Loss: 0.185 Vali Loss: 0.317 Vali Acc: 0.975 Test Loss: 0.317 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 32 cost time: 0.38287830352783203
Epoch: 32, Steps: 3 | Train Loss: 0.175 Vali Loss: 0.313 Vali Acc: 0.975 Test Loss: 0.313 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 33 cost time: 0.38808631896972656
Epoch: 33, Steps: 3 | Train Loss: 0.178 Vali Loss: 0.300 Vali Acc: 0.975 Test Loss: 0.300 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 34 cost time: 0.3763868808746338
Epoch: 34, Steps: 3 | Train Loss: 0.152 Vali Loss: 0.299 Vali Acc: 0.975 Test Loss: 0.299 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 35 cost time: 0.3534739017486572
Epoch: 35, Steps: 3 | Train Loss: 0.172 Vali Loss: 0.295 Vali Acc: 0.975 Test Loss: 0.295 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 36 cost time: 0.39591336250305176
Epoch: 36, Steps: 3 | Train Loss: 0.151 Vali Loss: 0.286 Vali Acc: 0.975 Test Loss: 0.286 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 37 cost time: 0.40937256813049316
Epoch: 37, Steps: 3 | Train Loss: 0.133 Vali Loss: 0.273 Vali Acc: 0.975 Test Loss: 0.273 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 38 cost time: 0.3732028007507324
Epoch: 38, Steps: 3 | Train Loss: 0.118 Vali Loss: 0.258 Vali Acc: 0.975 Test Loss: 0.258 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 39 cost time: 0.4129600524902344
Epoch: 39, Steps: 3 | Train Loss: 0.121 Vali Loss: 0.255 Vali Acc: 0.975 Test Loss: 0.255 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 40 cost time: 0.41053223609924316
Epoch: 40, Steps: 3 | Train Loss: 0.110 Vali Loss: 0.250 Vali Acc: 0.975 Test Loss: 0.250 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 41 cost time: 0.39165210723876953
Epoch: 41, Steps: 3 | Train Loss: 0.124 Vali Loss: 0.249 Vali Acc: 0.975 Test Loss: 0.249 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 42 cost time: 0.43273425102233887
Epoch: 42, Steps: 3 | Train Loss: 0.102 Vali Loss: 0.243 Vali Acc: 0.950 Test Loss: 0.243 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.4094867706298828
Epoch: 43, Steps: 3 | Train Loss: 0.095 Vali Loss: 0.240 Vali Acc: 0.950 Test Loss: 0.240 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.39096736907958984
Epoch: 44, Steps: 3 | Train Loss: 0.075 Vali Loss: 0.231 Vali Acc: 0.950 Test Loss: 0.231 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.36228084564208984
Epoch: 45, Steps: 3 | Train Loss: 0.078 Vali Loss: 0.223 Vali Acc: 0.950 Test Loss: 0.223 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.3980705738067627
Epoch: 46, Steps: 3 | Train Loss: 0.083 Vali Loss: 0.223 Vali Acc: 0.950 Test Loss: 0.223 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.3929910659790039
Epoch: 47, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.224 Vali Acc: 0.950 Test Loss: 0.224 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.40879011154174805
Epoch: 48, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.219 Vali Acc: 0.950 Test Loss: 0.219 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.3709859848022461
Epoch: 49, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.223 Vali Acc: 0.950 Test Loss: 0.223 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 0.3870089054107666
Epoch: 50, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.219 Vali Acc: 0.950 Test Loss: 0.219 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 108068
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.6222970485687256
Epoch: 1, Steps: 3 | Train Loss: 1.437 Vali Loss: 1.407 Vali Acc: 0.300 Test Loss: 1.407 Test Acc: 0.300
Validation loss decreased (inf --> -0.299986).  Saving model ...
Epoch: 2 cost time: 0.395963191986084
Epoch: 2, Steps: 3 | Train Loss: 1.369 Vali Loss: 1.394 Vali Acc: 0.325 Test Loss: 1.394 Test Acc: 0.325
Validation loss decreased (-0.299986 --> -0.324986).  Saving model ...
Epoch: 3 cost time: 0.3980729579925537
Epoch: 3, Steps: 3 | Train Loss: 1.358 Vali Loss: 1.377 Vali Acc: 0.375 Test Loss: 1.377 Test Acc: 0.375
Validation loss decreased (-0.324986 --> -0.374986).  Saving model ...
Epoch: 4 cost time: 0.40775632858276367
Epoch: 4, Steps: 3 | Train Loss: 1.336 Vali Loss: 1.353 Vali Acc: 0.425 Test Loss: 1.353 Test Acc: 0.425
Validation loss decreased (-0.374986 --> -0.424986).  Saving model ...
Epoch: 5 cost time: 0.45317792892456055
Epoch: 5, Steps: 3 | Train Loss: 1.288 Vali Loss: 1.322 Vali Acc: 0.475 Test Loss: 1.322 Test Acc: 0.475
Validation loss decreased (-0.424986 --> -0.474987).  Saving model ...
Epoch: 6 cost time: 0.39822912216186523
Epoch: 6, Steps: 3 | Train Loss: 1.235 Vali Loss: 1.287 Vali Acc: 0.550 Test Loss: 1.287 Test Acc: 0.550
Validation loss decreased (-0.474987 --> -0.549987).  Saving model ...
Epoch: 7 cost time: 0.49582362174987793
Epoch: 7, Steps: 3 | Train Loss: 1.226 Vali Loss: 1.249 Vali Acc: 0.550 Test Loss: 1.249 Test Acc: 0.550
Validation loss decreased (-0.549987 --> -0.549988).  Saving model ...
Epoch: 8 cost time: 0.38945746421813965
Epoch: 8, Steps: 3 | Train Loss: 1.144 Vali Loss: 1.206 Vali Acc: 0.575 Test Loss: 1.206 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574988).  Saving model ...
Epoch: 9 cost time: 0.42484593391418457
Epoch: 9, Steps: 3 | Train Loss: 1.082 Vali Loss: 1.160 Vali Acc: 0.575 Test Loss: 1.160 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574988).  Saving model ...
Epoch: 10 cost time: 0.4820380210876465
Epoch: 10, Steps: 3 | Train Loss: 1.009 Vali Loss: 1.114 Vali Acc: 0.575 Test Loss: 1.114 Test Acc: 0.575
Validation loss decreased (-0.574988 --> -0.574989).  Saving model ...
Epoch: 11 cost time: 0.4579792022705078
Epoch: 11, Steps: 3 | Train Loss: 0.981 Vali Loss: 1.067 Vali Acc: 0.650 Test Loss: 1.067 Test Acc: 0.650
Validation loss decreased (-0.574989 --> -0.649989).  Saving model ...
Epoch: 12 cost time: 0.3768000602722168
Epoch: 12, Steps: 3 | Train Loss: 0.902 Vali Loss: 1.022 Vali Acc: 0.625 Test Loss: 1.022 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.3776822090148926
Epoch: 13, Steps: 3 | Train Loss: 0.850 Vali Loss: 0.981 Vali Acc: 0.650 Test Loss: 0.981 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649990).  Saving model ...
Epoch: 14 cost time: 0.39574122428894043
Epoch: 14, Steps: 3 | Train Loss: 0.845 Vali Loss: 0.929 Vali Acc: 0.650 Test Loss: 0.929 Test Acc: 0.650
Validation loss decreased (-0.649990 --> -0.649991).  Saving model ...
Epoch: 15 cost time: 0.3617517948150635
Epoch: 15, Steps: 3 | Train Loss: 0.749 Vali Loss: 0.893 Vali Acc: 0.675 Test Loss: 0.893 Test Acc: 0.675
Validation loss decreased (-0.649991 --> -0.674991).  Saving model ...
Epoch: 16 cost time: 0.379901647567749
Epoch: 16, Steps: 3 | Train Loss: 0.694 Vali Loss: 0.852 Vali Acc: 0.725 Test Loss: 0.852 Test Acc: 0.725
Validation loss decreased (-0.674991 --> -0.724991).  Saving model ...
Epoch: 17 cost time: 0.45435190200805664
Epoch: 17, Steps: 3 | Train Loss: 0.667 Vali Loss: 0.811 Vali Acc: 0.900 Test Loss: 0.811 Test Acc: 0.900
Validation loss decreased (-0.724991 --> -0.899992).  Saving model ...
Epoch: 18 cost time: 0.41492438316345215
Epoch: 18, Steps: 3 | Train Loss: 0.599 Vali Loss: 0.776 Vali Acc: 0.950 Test Loss: 0.776 Test Acc: 0.950
Validation loss decreased (-0.899992 --> -0.949992).  Saving model ...
Epoch: 19 cost time: 0.44261622428894043
Epoch: 19, Steps: 3 | Train Loss: 0.579 Vali Loss: 0.736 Vali Acc: 0.950 Test Loss: 0.736 Test Acc: 0.950
Validation loss decreased (-0.949992 --> -0.949993).  Saving model ...
Epoch: 20 cost time: 0.47219324111938477
Epoch: 20, Steps: 3 | Train Loss: 0.560 Vali Loss: 0.701 Vali Acc: 0.950 Test Loss: 0.701 Test Acc: 0.950
Validation loss decreased (-0.949993 --> -0.949993).  Saving model ...
Epoch: 21 cost time: 0.4139406681060791
Epoch: 21, Steps: 3 | Train Loss: 0.510 Vali Loss: 0.664 Vali Acc: 0.950 Test Loss: 0.664 Test Acc: 0.950
Validation loss decreased (-0.949993 --> -0.949993).  Saving model ...
Epoch: 22 cost time: 0.4101266860961914
Epoch: 22, Steps: 3 | Train Loss: 0.480 Vali Loss: 0.622 Vali Acc: 0.950 Test Loss: 0.622 Test Acc: 0.950
Validation loss decreased (-0.949993 --> -0.949994).  Saving model ...
Epoch: 23 cost time: 0.39137911796569824
Epoch: 23, Steps: 3 | Train Loss: 0.462 Vali Loss: 0.589 Vali Acc: 0.950 Test Loss: 0.589 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949994).  Saving model ...
Epoch: 24 cost time: 0.44782209396362305
Epoch: 24, Steps: 3 | Train Loss: 0.420 Vali Loss: 0.562 Vali Acc: 0.950 Test Loss: 0.562 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949994).  Saving model ...
Epoch: 25 cost time: 0.3844306468963623
Epoch: 25, Steps: 3 | Train Loss: 0.419 Vali Loss: 0.543 Vali Acc: 0.925 Test Loss: 0.543 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.402249813079834
Epoch: 26, Steps: 3 | Train Loss: 0.380 Vali Loss: 0.525 Vali Acc: 0.925 Test Loss: 0.525 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.4235877990722656
Epoch: 27, Steps: 3 | Train Loss: 0.374 Vali Loss: 0.506 Vali Acc: 0.925 Test Loss: 0.506 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.4025905132293701
Epoch: 28, Steps: 3 | Train Loss: 0.334 Vali Loss: 0.483 Vali Acc: 0.925 Test Loss: 0.483 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.3991985321044922
Epoch: 29, Steps: 3 | Train Loss: 0.321 Vali Loss: 0.460 Vali Acc: 0.925 Test Loss: 0.460 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.4160792827606201
Epoch: 30, Steps: 3 | Train Loss: 0.325 Vali Loss: 0.454 Vali Acc: 0.950 Test Loss: 0.454 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 31 cost time: 0.47110724449157715
Epoch: 31, Steps: 3 | Train Loss: 0.289 Vali Loss: 0.432 Vali Acc: 0.925 Test Loss: 0.432 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.3893132209777832
Epoch: 32, Steps: 3 | Train Loss: 0.275 Vali Loss: 0.419 Vali Acc: 0.950 Test Loss: 0.419 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 33 cost time: 0.42409348487854004
Epoch: 33, Steps: 3 | Train Loss: 0.258 Vali Loss: 0.398 Vali Acc: 0.975 Test Loss: 0.398 Test Acc: 0.975
Validation loss decreased (-0.949996 --> -0.974996).  Saving model ...
Epoch: 34 cost time: 0.41719985008239746
Epoch: 34, Steps: 3 | Train Loss: 0.256 Vali Loss: 0.382 Vali Acc: 0.975 Test Loss: 0.382 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 35 cost time: 0.47494959831237793
Epoch: 35, Steps: 3 | Train Loss: 0.288 Vali Loss: 0.369 Vali Acc: 0.975 Test Loss: 0.369 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 36 cost time: 0.4193696975708008
Epoch: 36, Steps: 3 | Train Loss: 0.237 Vali Loss: 0.363 Vali Acc: 0.975 Test Loss: 0.363 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 37 cost time: 0.4536426067352295
Epoch: 37, Steps: 3 | Train Loss: 0.213 Vali Loss: 0.345 Vali Acc: 0.975 Test Loss: 0.345 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 38 cost time: 0.39587974548339844
Epoch: 38, Steps: 3 | Train Loss: 0.214 Vali Loss: 0.337 Vali Acc: 0.975 Test Loss: 0.337 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 39 cost time: 0.38871097564697266
Epoch: 39, Steps: 3 | Train Loss: 0.202 Vali Loss: 0.322 Vali Acc: 0.975 Test Loss: 0.322 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 40 cost time: 0.4253242015838623
Epoch: 40, Steps: 3 | Train Loss: 0.215 Vali Loss: 0.315 Vali Acc: 0.975 Test Loss: 0.315 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 41 cost time: 0.4092526435852051
Epoch: 41, Steps: 3 | Train Loss: 0.187 Vali Loss: 0.303 Vali Acc: 0.975 Test Loss: 0.303 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 42 cost time: 0.3783261775970459
Epoch: 42, Steps: 3 | Train Loss: 0.166 Vali Loss: 0.289 Vali Acc: 0.975 Test Loss: 0.289 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 43 cost time: 0.4014418125152588
Epoch: 43, Steps: 3 | Train Loss: 0.167 Vali Loss: 0.281 Vali Acc: 0.975 Test Loss: 0.281 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 44 cost time: 0.385556697845459
Epoch: 44, Steps: 3 | Train Loss: 0.166 Vali Loss: 0.268 Vali Acc: 0.975 Test Loss: 0.268 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 45 cost time: 0.4044206142425537
Epoch: 45, Steps: 3 | Train Loss: 0.151 Vali Loss: 0.268 Vali Acc: 0.975 Test Loss: 0.268 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.35414624214172363
Epoch: 46, Steps: 3 | Train Loss: 0.147 Vali Loss: 0.260 Vali Acc: 0.975 Test Loss: 0.260 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 47 cost time: 0.38087940216064453
Epoch: 47, Steps: 3 | Train Loss: 0.148 Vali Loss: 0.256 Vali Acc: 0.975 Test Loss: 0.256 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 48 cost time: 0.34137725830078125
Epoch: 48, Steps: 3 | Train Loss: 0.116 Vali Loss: 0.243 Vali Acc: 0.975 Test Loss: 0.243 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 49 cost time: 0.34093260765075684
Epoch: 49, Steps: 3 | Train Loss: 0.121 Vali Loss: 0.236 Vali Acc: 0.975 Test Loss: 0.236 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 50 cost time: 0.34675097465515137
Epoch: 50, Steps: 3 | Train Loss: 0.119 Vali Loss: 0.233 Vali Acc: 0.975 Test Loss: 0.233 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 103524
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.5505189895629883
Epoch: 1, Steps: 3 | Train Loss: 1.399 Vali Loss: 1.405 Vali Acc: 0.425 Test Loss: 1.405 Test Acc: 0.425
Validation loss decreased (inf --> -0.424986).  Saving model ...
Epoch: 2 cost time: 0.3688359260559082
Epoch: 2, Steps: 3 | Train Loss: 1.384 Vali Loss: 1.392 Vali Acc: 0.450 Test Loss: 1.392 Test Acc: 0.450
Validation loss decreased (-0.424986 --> -0.449986).  Saving model ...
Epoch: 3 cost time: 0.47231197357177734
Epoch: 3, Steps: 3 | Train Loss: 1.410 Vali Loss: 1.379 Vali Acc: 0.550 Test Loss: 1.379 Test Acc: 0.550
Validation loss decreased (-0.449986 --> -0.549986).  Saving model ...
Epoch: 4 cost time: 0.41466522216796875
Epoch: 4, Steps: 3 | Train Loss: 1.344 Vali Loss: 1.359 Vali Acc: 0.525 Test Loss: 1.359 Test Acc: 0.525
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.39597344398498535
Epoch: 5, Steps: 3 | Train Loss: 1.290 Vali Loss: 1.335 Vali Acc: 0.600 Test Loss: 1.335 Test Acc: 0.600
Validation loss decreased (-0.549986 --> -0.599987).  Saving model ...
Epoch: 6 cost time: 0.37837839126586914
Epoch: 6, Steps: 3 | Train Loss: 1.244 Vali Loss: 1.306 Vali Acc: 0.575 Test Loss: 1.306 Test Acc: 0.575
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.39961886405944824
Epoch: 7, Steps: 3 | Train Loss: 1.229 Vali Loss: 1.274 Vali Acc: 0.625 Test Loss: 1.274 Test Acc: 0.625
Validation loss decreased (-0.599987 --> -0.624987).  Saving model ...
Epoch: 8 cost time: 0.3557145595550537
Epoch: 8, Steps: 3 | Train Loss: 1.173 Vali Loss: 1.237 Vali Acc: 0.725 Test Loss: 1.237 Test Acc: 0.725
Validation loss decreased (-0.624987 --> -0.724988).  Saving model ...
Epoch: 9 cost time: 0.3476700782775879
Epoch: 9, Steps: 3 | Train Loss: 1.145 Vali Loss: 1.201 Vali Acc: 0.775 Test Loss: 1.201 Test Acc: 0.775
Validation loss decreased (-0.724988 --> -0.774988).  Saving model ...
Epoch: 10 cost time: 0.3574845790863037
Epoch: 10, Steps: 3 | Train Loss: 1.094 Vali Loss: 1.161 Vali Acc: 0.800 Test Loss: 1.161 Test Acc: 0.800
Validation loss decreased (-0.774988 --> -0.799988).  Saving model ...
Epoch: 11 cost time: 0.40387988090515137
Epoch: 11, Steps: 3 | Train Loss: 1.035 Vali Loss: 1.122 Vali Acc: 0.800 Test Loss: 1.122 Test Acc: 0.800
Validation loss decreased (-0.799988 --> -0.799989).  Saving model ...
Epoch: 12 cost time: 0.3902709484100342
Epoch: 12, Steps: 3 | Train Loss: 1.011 Vali Loss: 1.095 Vali Acc: 0.850 Test Loss: 1.095 Test Acc: 0.850
Validation loss decreased (-0.799989 --> -0.849989).  Saving model ...
Epoch: 13 cost time: 0.4288759231567383
Epoch: 13, Steps: 3 | Train Loss: 0.974 Vali Loss: 1.053 Vali Acc: 0.875 Test Loss: 1.053 Test Acc: 0.875
Validation loss decreased (-0.849989 --> -0.874989).  Saving model ...
Epoch: 14 cost time: 0.4084169864654541
Epoch: 14, Steps: 3 | Train Loss: 0.914 Vali Loss: 1.022 Vali Acc: 0.875 Test Loss: 1.022 Test Acc: 0.875
Validation loss decreased (-0.874989 --> -0.874990).  Saving model ...
Epoch: 15 cost time: 0.3700993061065674
Epoch: 15, Steps: 3 | Train Loss: 0.849 Vali Loss: 0.992 Vali Acc: 0.900 Test Loss: 0.992 Test Acc: 0.900
Validation loss decreased (-0.874990 --> -0.899990).  Saving model ...
Epoch: 16 cost time: 0.4666407108306885
Epoch: 16, Steps: 3 | Train Loss: 0.797 Vali Loss: 0.954 Vali Acc: 0.900 Test Loss: 0.954 Test Acc: 0.900
Validation loss decreased (-0.899990 --> -0.899990).  Saving model ...
Epoch: 17 cost time: 0.3828606605529785
Epoch: 17, Steps: 3 | Train Loss: 0.779 Vali Loss: 0.918 Vali Acc: 0.900 Test Loss: 0.918 Test Acc: 0.900
Validation loss decreased (-0.899990 --> -0.899991).  Saving model ...
Epoch: 18 cost time: 0.3937849998474121
Epoch: 18, Steps: 3 | Train Loss: 0.747 Vali Loss: 0.883 Vali Acc: 0.900 Test Loss: 0.883 Test Acc: 0.900
Validation loss decreased (-0.899991 --> -0.899991).  Saving model ...
Epoch: 19 cost time: 0.32814621925354004
Epoch: 19, Steps: 3 | Train Loss: 0.705 Vali Loss: 0.857 Vali Acc: 0.925 Test Loss: 0.857 Test Acc: 0.925
Validation loss decreased (-0.899991 --> -0.924991).  Saving model ...
Epoch: 20 cost time: 0.37673139572143555
Epoch: 20, Steps: 3 | Train Loss: 0.674 Vali Loss: 0.833 Vali Acc: 0.900 Test Loss: 0.833 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.3805208206176758
Epoch: 21, Steps: 3 | Train Loss: 0.667 Vali Loss: 0.787 Vali Acc: 0.900 Test Loss: 0.787 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.3837275505065918
Epoch: 22, Steps: 3 | Train Loss: 0.607 Vali Loss: 0.751 Vali Acc: 0.900 Test Loss: 0.751 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.41419434547424316
Epoch: 23, Steps: 3 | Train Loss: 0.586 Vali Loss: 0.725 Vali Acc: 0.925 Test Loss: 0.725 Test Acc: 0.925
Validation loss decreased (-0.924991 --> -0.924993).  Saving model ...
Epoch: 24 cost time: 0.4217653274536133
Epoch: 24, Steps: 3 | Train Loss: 0.544 Vali Loss: 0.702 Vali Acc: 0.925 Test Loss: 0.702 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924993).  Saving model ...
Epoch: 25 cost time: 0.384401798248291
Epoch: 25, Steps: 3 | Train Loss: 0.522 Vali Loss: 0.682 Vali Acc: 0.925 Test Loss: 0.682 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924993).  Saving model ...
Epoch: 26 cost time: 0.3832120895385742
Epoch: 26, Steps: 3 | Train Loss: 0.487 Vali Loss: 0.653 Vali Acc: 0.925 Test Loss: 0.653 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924993).  Saving model ...
Epoch: 27 cost time: 0.38016819953918457
Epoch: 27, Steps: 3 | Train Loss: 0.478 Vali Loss: 0.636 Vali Acc: 0.925 Test Loss: 0.636 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924994).  Saving model ...
Epoch: 28 cost time: 0.46571969985961914
Epoch: 28, Steps: 3 | Train Loss: 0.476 Vali Loss: 0.608 Vali Acc: 0.950 Test Loss: 0.608 Test Acc: 0.950
Validation loss decreased (-0.924994 --> -0.949994).  Saving model ...
Epoch: 29 cost time: 0.37947583198547363
Epoch: 29, Steps: 3 | Train Loss: 0.430 Vali Loss: 0.591 Vali Acc: 0.950 Test Loss: 0.591 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949994).  Saving model ...
Epoch: 30 cost time: 0.4085862636566162
Epoch: 30, Steps: 3 | Train Loss: 0.407 Vali Loss: 0.560 Vali Acc: 0.950 Test Loss: 0.560 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949994).  Saving model ...
Epoch: 31 cost time: 0.41689634323120117
Epoch: 31, Steps: 3 | Train Loss: 0.397 Vali Loss: 0.530 Vali Acc: 0.950 Test Loss: 0.530 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 32 cost time: 0.44694089889526367
Epoch: 32, Steps: 3 | Train Loss: 0.391 Vali Loss: 0.515 Vali Acc: 0.950 Test Loss: 0.515 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 33 cost time: 0.4727785587310791
Epoch: 33, Steps: 3 | Train Loss: 0.360 Vali Loss: 0.496 Vali Acc: 0.950 Test Loss: 0.496 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 34 cost time: 0.4092564582824707
Epoch: 34, Steps: 3 | Train Loss: 0.353 Vali Loss: 0.478 Vali Acc: 0.950 Test Loss: 0.478 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 35 cost time: 0.43177294731140137
Epoch: 35, Steps: 3 | Train Loss: 0.341 Vali Loss: 0.470 Vali Acc: 0.950 Test Loss: 0.470 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 36 cost time: 0.3862643241882324
Epoch: 36, Steps: 3 | Train Loss: 0.254 Vali Loss: 0.437 Vali Acc: 0.950 Test Loss: 0.437 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 37 cost time: 0.3999767303466797
Epoch: 37, Steps: 3 | Train Loss: 0.300 Vali Loss: 0.413 Vali Acc: 0.950 Test Loss: 0.413 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 38 cost time: 0.40822291374206543
Epoch: 38, Steps: 3 | Train Loss: 0.299 Vali Loss: 0.398 Vali Acc: 0.950 Test Loss: 0.398 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 39 cost time: 0.42826151847839355
Epoch: 39, Steps: 3 | Train Loss: 0.275 Vali Loss: 0.401 Vali Acc: 0.950 Test Loss: 0.401 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.39599037170410156
Epoch: 40, Steps: 3 | Train Loss: 0.273 Vali Loss: 0.395 Vali Acc: 0.950 Test Loss: 0.395 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 41 cost time: 0.435471773147583
Epoch: 41, Steps: 3 | Train Loss: 0.251 Vali Loss: 0.381 Vali Acc: 0.975 Test Loss: 0.381 Test Acc: 0.975
Validation loss decreased (-0.949996 --> -0.974996).  Saving model ...
Epoch: 42 cost time: 0.39302635192871094
Epoch: 42, Steps: 3 | Train Loss: 0.245 Vali Loss: 0.378 Vali Acc: 0.975 Test Loss: 0.378 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 43 cost time: 0.4417989253997803
Epoch: 43, Steps: 3 | Train Loss: 0.239 Vali Loss: 0.358 Vali Acc: 0.975 Test Loss: 0.358 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 44 cost time: 0.44770312309265137
Epoch: 44, Steps: 3 | Train Loss: 0.233 Vali Loss: 0.346 Vali Acc: 0.975 Test Loss: 0.346 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 45 cost time: 0.38416266441345215
Epoch: 45, Steps: 3 | Train Loss: 0.219 Vali Loss: 0.346 Vali Acc: 0.975 Test Loss: 0.346 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 46 cost time: 0.3979470729827881
Epoch: 46, Steps: 3 | Train Loss: 0.202 Vali Loss: 0.330 Vali Acc: 0.975 Test Loss: 0.330 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 47 cost time: 0.3852119445800781
Epoch: 47, Steps: 3 | Train Loss: 0.203 Vali Loss: 0.320 Vali Acc: 0.975 Test Loss: 0.320 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 48 cost time: 0.4327077865600586
Epoch: 48, Steps: 3 | Train Loss: 0.182 Vali Loss: 0.314 Vali Acc: 0.975 Test Loss: 0.314 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 49 cost time: 0.42009615898132324
Epoch: 49, Steps: 3 | Train Loss: 0.177 Vali Loss: 0.307 Vali Acc: 0.975 Test Loss: 0.307 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 50 cost time: 0.37708377838134766
Epoch: 50, Steps: 3 | Train Loss: 0.186 Vali Loss: 0.306 Vali Acc: 0.975 Test Loss: 0.306 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 97540
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps20_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.6178038120269775
Epoch: 1, Steps: 3 | Train Loss: 1.441 Vali Loss: 1.402 Vali Acc: 0.225 Test Loss: 1.402 Test Acc: 0.225
Validation loss decreased (inf --> -0.224986).  Saving model ...
Epoch: 2 cost time: 0.420285701751709
Epoch: 2, Steps: 3 | Train Loss: 1.424 Vali Loss: 1.394 Vali Acc: 0.250 Test Loss: 1.394 Test Acc: 0.250
Validation loss decreased (-0.224986 --> -0.249986).  Saving model ...
Epoch: 3 cost time: 0.38169336318969727
Epoch: 3, Steps: 3 | Train Loss: 1.386 Vali Loss: 1.385 Vali Acc: 0.250 Test Loss: 1.385 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 4 cost time: 0.38970088958740234
Epoch: 4, Steps: 3 | Train Loss: 1.353 Vali Loss: 1.371 Vali Acc: 0.275 Test Loss: 1.371 Test Acc: 0.275
Validation loss decreased (-0.249986 --> -0.274986).  Saving model ...
Epoch: 5 cost time: 0.39745235443115234
Epoch: 5, Steps: 3 | Train Loss: 1.293 Vali Loss: 1.352 Vali Acc: 0.300 Test Loss: 1.352 Test Acc: 0.300
Validation loss decreased (-0.274986 --> -0.299986).  Saving model ...
Epoch: 6 cost time: 0.40594983100891113
Epoch: 6, Steps: 3 | Train Loss: 1.295 Vali Loss: 1.329 Vali Acc: 0.325 Test Loss: 1.329 Test Acc: 0.325
Validation loss decreased (-0.299986 --> -0.324987).  Saving model ...
Epoch: 7 cost time: 0.36304450035095215
Epoch: 7, Steps: 3 | Train Loss: 1.244 Vali Loss: 1.303 Vali Acc: 0.350 Test Loss: 1.303 Test Acc: 0.350
Validation loss decreased (-0.324987 --> -0.349987).  Saving model ...
Epoch: 8 cost time: 0.35387420654296875
Epoch: 8, Steps: 3 | Train Loss: 1.241 Vali Loss: 1.275 Vali Acc: 0.400 Test Loss: 1.275 Test Acc: 0.400
Validation loss decreased (-0.349987 --> -0.399987).  Saving model ...
Epoch: 9 cost time: 0.46035099029541016
Epoch: 9, Steps: 3 | Train Loss: 1.158 Vali Loss: 1.244 Vali Acc: 0.450 Test Loss: 1.244 Test Acc: 0.450
Validation loss decreased (-0.399987 --> -0.449988).  Saving model ...
Epoch: 10 cost time: 0.3988966941833496
Epoch: 10, Steps: 3 | Train Loss: 1.128 Vali Loss: 1.215 Vali Acc: 0.450 Test Loss: 1.215 Test Acc: 0.450
Validation loss decreased (-0.449988 --> -0.449988).  Saving model ...
Epoch: 11 cost time: 0.35860323905944824
Epoch: 11, Steps: 3 | Train Loss: 1.091 Vali Loss: 1.184 Vali Acc: 0.475 Test Loss: 1.184 Test Acc: 0.475
Validation loss decreased (-0.449988 --> -0.474988).  Saving model ...
Epoch: 12 cost time: 0.4614999294281006
Epoch: 12, Steps: 3 | Train Loss: 1.041 Vali Loss: 1.155 Vali Acc: 0.525 Test Loss: 1.155 Test Acc: 0.525
Validation loss decreased (-0.474988 --> -0.524988).  Saving model ...
Epoch: 13 cost time: 0.3968794345855713
Epoch: 13, Steps: 3 | Train Loss: 0.994 Vali Loss: 1.125 Vali Acc: 0.600 Test Loss: 1.125 Test Acc: 0.600
Validation loss decreased (-0.524988 --> -0.599989).  Saving model ...
Epoch: 14 cost time: 0.363619327545166
Epoch: 14, Steps: 3 | Train Loss: 0.958 Vali Loss: 1.093 Vali Acc: 0.775 Test Loss: 1.093 Test Acc: 0.775
Validation loss decreased (-0.599989 --> -0.774989).  Saving model ...
Epoch: 15 cost time: 0.45601367950439453
Epoch: 15, Steps: 3 | Train Loss: 0.913 Vali Loss: 1.061 Vali Acc: 0.775 Test Loss: 1.061 Test Acc: 0.775
Validation loss decreased (-0.774989 --> -0.774989).  Saving model ...
Epoch: 16 cost time: 0.3741483688354492
Epoch: 16, Steps: 3 | Train Loss: 0.868 Vali Loss: 1.024 Vali Acc: 0.875 Test Loss: 1.024 Test Acc: 0.875
Validation loss decreased (-0.774989 --> -0.874990).  Saving model ...
Epoch: 17 cost time: 0.496673583984375
Epoch: 17, Steps: 3 | Train Loss: 0.867 Vali Loss: 0.990 Vali Acc: 0.850 Test Loss: 0.990 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.3863062858581543
Epoch: 18, Steps: 3 | Train Loss: 0.792 Vali Loss: 0.960 Vali Acc: 0.875 Test Loss: 0.960 Test Acc: 0.875
Validation loss decreased (-0.874990 --> -0.874990).  Saving model ...
Epoch: 19 cost time: 0.41193604469299316
Epoch: 19, Steps: 3 | Train Loss: 0.780 Vali Loss: 0.929 Vali Acc: 0.850 Test Loss: 0.929 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.4022846221923828
Epoch: 20, Steps: 3 | Train Loss: 0.756 Vali Loss: 0.894 Vali Acc: 0.825 Test Loss: 0.894 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.41359829902648926
Epoch: 21, Steps: 3 | Train Loss: 0.742 Vali Loss: 0.861 Vali Acc: 0.875 Test Loss: 0.861 Test Acc: 0.875
Validation loss decreased (-0.874990 --> -0.874991).  Saving model ...
Epoch: 22 cost time: 0.5214729309082031
Epoch: 22, Steps: 3 | Train Loss: 0.684 Vali Loss: 0.846 Vali Acc: 0.850 Test Loss: 0.846 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.4574158191680908
Epoch: 23, Steps: 3 | Train Loss: 0.651 Vali Loss: 0.818 Vali Acc: 0.850 Test Loss: 0.818 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.40391087532043457
Epoch: 24, Steps: 3 | Train Loss: 0.623 Vali Loss: 0.794 Vali Acc: 0.925 Test Loss: 0.794 Test Acc: 0.925
Validation loss decreased (-0.874991 --> -0.924992).  Saving model ...
Epoch: 25 cost time: 0.37638044357299805
Epoch: 25, Steps: 3 | Train Loss: 0.611 Vali Loss: 0.771 Vali Acc: 0.925 Test Loss: 0.771 Test Acc: 0.925
Validation loss decreased (-0.924992 --> -0.924992).  Saving model ...
Epoch: 26 cost time: 0.42074155807495117
Epoch: 26, Steps: 3 | Train Loss: 0.553 Vali Loss: 0.736 Vali Acc: 0.925 Test Loss: 0.736 Test Acc: 0.925
Validation loss decreased (-0.924992 --> -0.924993).  Saving model ...
Epoch: 27 cost time: 0.4068915843963623
Epoch: 27, Steps: 3 | Train Loss: 0.564 Vali Loss: 0.718 Vali Acc: 0.925 Test Loss: 0.718 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924993).  Saving model ...
Epoch: 28 cost time: 0.44611430168151855
Epoch: 28, Steps: 3 | Train Loss: 0.514 Vali Loss: 0.711 Vali Acc: 0.950 Test Loss: 0.711 Test Acc: 0.950
Validation loss decreased (-0.924993 --> -0.949993).  Saving model ...
Epoch: 29 cost time: 0.38629817962646484
Epoch: 29, Steps: 3 | Train Loss: 0.501 Vali Loss: 0.687 Vali Acc: 0.950 Test Loss: 0.687 Test Acc: 0.950
Validation loss decreased (-0.949993 --> -0.949993).  Saving model ...
Epoch: 30 cost time: 0.41469264030456543
Epoch: 30, Steps: 3 | Train Loss: 0.474 Vali Loss: 0.665 Vali Acc: 0.975 Test Loss: 0.665 Test Acc: 0.975
Validation loss decreased (-0.949993 --> -0.974993).  Saving model ...
Epoch: 31 cost time: 0.38842344284057617
Epoch: 31, Steps: 3 | Train Loss: 0.465 Vali Loss: 0.647 Vali Acc: 0.975 Test Loss: 0.647 Test Acc: 0.975
Validation loss decreased (-0.974993 --> -0.974994).  Saving model ...
Epoch: 32 cost time: 0.38042497634887695
Epoch: 32, Steps: 3 | Train Loss: 0.436 Vali Loss: 0.628 Vali Acc: 0.950 Test Loss: 0.628 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.4312400817871094
Epoch: 33, Steps: 3 | Train Loss: 0.430 Vali Loss: 0.604 Vali Acc: 0.975 Test Loss: 0.604 Test Acc: 0.975
Validation loss decreased (-0.974994 --> -0.974994).  Saving model ...
Epoch: 34 cost time: 0.42012500762939453
Epoch: 34, Steps: 3 | Train Loss: 0.399 Vali Loss: 0.596 Vali Acc: 0.950 Test Loss: 0.596 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.41697001457214355
Epoch: 35, Steps: 3 | Train Loss: 0.390 Vali Loss: 0.570 Vali Acc: 0.925 Test Loss: 0.570 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.4494462013244629
Epoch: 36, Steps: 3 | Train Loss: 0.369 Vali Loss: 0.547 Vali Acc: 0.950 Test Loss: 0.547 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.4869513511657715
Epoch: 37, Steps: 3 | Train Loss: 0.351 Vali Loss: 0.527 Vali Acc: 0.950 Test Loss: 0.527 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.39619922637939453
Epoch: 38, Steps: 3 | Train Loss: 0.356 Vali Loss: 0.517 Vali Acc: 0.950 Test Loss: 0.517 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.41439247131347656
Epoch: 39, Steps: 3 | Train Loss: 0.336 Vali Loss: 0.507 Vali Acc: 0.950 Test Loss: 0.507 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.4449803829193115
Epoch: 40, Steps: 3 | Train Loss: 0.335 Vali Loss: 0.496 Vali Acc: 0.950 Test Loss: 0.496 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.4231741428375244
Epoch: 41, Steps: 3 | Train Loss: 0.324 Vali Loss: 0.483 Vali Acc: 0.950 Test Loss: 0.483 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.4492521286010742
Epoch: 42, Steps: 3 | Train Loss: 0.330 Vali Loss: 0.463 Vali Acc: 0.975 Test Loss: 0.463 Test Acc: 0.975
Validation loss decreased (-0.974994 --> -0.974995).  Saving model ...
Epoch: 43 cost time: 0.40278029441833496
Epoch: 43, Steps: 3 | Train Loss: 0.295 Vali Loss: 0.446 Vali Acc: 0.975 Test Loss: 0.446 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 44 cost time: 0.3913002014160156
Epoch: 44, Steps: 3 | Train Loss: 0.296 Vali Loss: 0.440 Vali Acc: 0.975 Test Loss: 0.440 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 45 cost time: 0.40719008445739746
Epoch: 45, Steps: 3 | Train Loss: 0.275 Vali Loss: 0.425 Vali Acc: 0.975 Test Loss: 0.425 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 46 cost time: 0.3992166519165039
Epoch: 46, Steps: 3 | Train Loss: 0.266 Vali Loss: 0.417 Vali Acc: 0.975 Test Loss: 0.417 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 47 cost time: 0.49417591094970703
Epoch: 47, Steps: 3 | Train Loss: 0.282 Vali Loss: 0.411 Vali Acc: 0.975 Test Loss: 0.411 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 48 cost time: 0.4008195400238037
Epoch: 48, Steps: 3 | Train Loss: 0.238 Vali Loss: 0.398 Vali Acc: 0.975 Test Loss: 0.398 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 49 cost time: 0.3836507797241211
Epoch: 49, Steps: 3 | Train Loss: 0.235 Vali Loss: 0.384 Vali Acc: 0.975 Test Loss: 0.384 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 50 cost time: 0.38042378425598145
Epoch: 50, Steps: 3 | Train Loss: 0.245 Vali Loss: 0.372 Vali Acc: 0.975 Test Loss: 0.372 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps20_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 96164
model size : 0.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps25_str13_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.5969061851501465
Epoch: 1, Steps: 3 | Train Loss: 1.481 Vali Loss: 1.434 Vali Acc: 0.125 Test Loss: 1.434 Test Acc: 0.125
Validation loss decreased (inf --> -0.124986).  Saving model ...
Epoch: 2 cost time: 0.38828301429748535
Epoch: 2, Steps: 3 | Train Loss: 1.448 Vali Loss: 1.431 Vali Acc: 0.150 Test Loss: 1.431 Test Acc: 0.150
Validation loss decreased (-0.124986 --> -0.149986).  Saving model ...
Epoch: 3 cost time: 0.4219818115234375
Epoch: 3, Steps: 3 | Train Loss: 1.420 Vali Loss: 1.428 Vali Acc: 0.175 Test Loss: 1.428 Test Acc: 0.175
Validation loss decreased (-0.149986 --> -0.174986).  Saving model ...
Epoch: 4 cost time: 0.4160583019256592
Epoch: 4, Steps: 3 | Train Loss: 1.412 Vali Loss: 1.420 Vali Acc: 0.175 Test Loss: 1.420 Test Acc: 0.175
Validation loss decreased (-0.174986 --> -0.174986).  Saving model ...
Epoch: 5 cost time: 0.38336753845214844
Epoch: 5, Steps: 3 | Train Loss: 1.382 Vali Loss: 1.407 Vali Acc: 0.200 Test Loss: 1.407 Test Acc: 0.200
Validation loss decreased (-0.174986 --> -0.199986).  Saving model ...
Epoch: 6 cost time: 0.38460683822631836
Epoch: 6, Steps: 3 | Train Loss: 1.362 Vali Loss: 1.391 Vali Acc: 0.200 Test Loss: 1.391 Test Acc: 0.200
Validation loss decreased (-0.199986 --> -0.199986).  Saving model ...
Epoch: 7 cost time: 0.3776085376739502
Epoch: 7, Steps: 3 | Train Loss: 1.385 Vali Loss: 1.370 Vali Acc: 0.200 Test Loss: 1.370 Test Acc: 0.200
Validation loss decreased (-0.199986 --> -0.199986).  Saving model ...
Epoch: 8 cost time: 0.3827953338623047
Epoch: 8, Steps: 3 | Train Loss: 1.342 Vali Loss: 1.347 Vali Acc: 0.225 Test Loss: 1.347 Test Acc: 0.225
Validation loss decreased (-0.199986 --> -0.224987).  Saving model ...
Epoch: 9 cost time: 0.37744903564453125
Epoch: 9, Steps: 3 | Train Loss: 1.271 Vali Loss: 1.324 Vali Acc: 0.225 Test Loss: 1.324 Test Acc: 0.225
Validation loss decreased (-0.224987 --> -0.224987).  Saving model ...
Epoch: 10 cost time: 0.4162323474884033
Epoch: 10, Steps: 3 | Train Loss: 1.241 Vali Loss: 1.298 Vali Acc: 0.275 Test Loss: 1.298 Test Acc: 0.275
Validation loss decreased (-0.224987 --> -0.274987).  Saving model ...
Epoch: 11 cost time: 0.4017305374145508
Epoch: 11, Steps: 3 | Train Loss: 1.207 Vali Loss: 1.269 Vali Acc: 0.400 Test Loss: 1.269 Test Acc: 0.400
Validation loss decreased (-0.274987 --> -0.399987).  Saving model ...
Epoch: 12 cost time: 0.41246938705444336
Epoch: 12, Steps: 3 | Train Loss: 1.177 Vali Loss: 1.244 Vali Acc: 0.425 Test Loss: 1.244 Test Acc: 0.425
Validation loss decreased (-0.399987 --> -0.424988).  Saving model ...
Epoch: 13 cost time: 0.4014914035797119
Epoch: 13, Steps: 3 | Train Loss: 1.167 Vali Loss: 1.213 Vali Acc: 0.550 Test Loss: 1.213 Test Acc: 0.550
Validation loss decreased (-0.424988 --> -0.549988).  Saving model ...
Epoch: 14 cost time: 0.35768699645996094
Epoch: 14, Steps: 3 | Train Loss: 1.075 Vali Loss: 1.185 Vali Acc: 0.700 Test Loss: 1.185 Test Acc: 0.700
Validation loss decreased (-0.549988 --> -0.699988).  Saving model ...
Epoch: 15 cost time: 0.38293957710266113
Epoch: 15, Steps: 3 | Train Loss: 1.035 Vali Loss: 1.157 Vali Acc: 0.700 Test Loss: 1.157 Test Acc: 0.700
Validation loss decreased (-0.699988 --> -0.699988).  Saving model ...
Epoch: 16 cost time: 0.44008874893188477
Epoch: 16, Steps: 3 | Train Loss: 1.001 Vali Loss: 1.126 Vali Acc: 0.750 Test Loss: 1.126 Test Acc: 0.750
Validation loss decreased (-0.699988 --> -0.749989).  Saving model ...
Epoch: 17 cost time: 0.43349599838256836
Epoch: 17, Steps: 3 | Train Loss: 0.982 Vali Loss: 1.106 Vali Acc: 0.750 Test Loss: 1.106 Test Acc: 0.750
Validation loss decreased (-0.749989 --> -0.749989).  Saving model ...
Epoch: 18 cost time: 0.4178450107574463
Epoch: 18, Steps: 3 | Train Loss: 0.923 Vali Loss: 1.080 Vali Acc: 0.800 Test Loss: 1.080 Test Acc: 0.800
Validation loss decreased (-0.749989 --> -0.799989).  Saving model ...
Epoch: 19 cost time: 0.3674900531768799
Epoch: 19, Steps: 3 | Train Loss: 0.902 Vali Loss: 1.049 Vali Acc: 0.800 Test Loss: 1.049 Test Acc: 0.800
Validation loss decreased (-0.799989 --> -0.799990).  Saving model ...
Epoch: 20 cost time: 0.41086840629577637
Epoch: 20, Steps: 3 | Train Loss: 0.874 Vali Loss: 1.022 Vali Acc: 0.800 Test Loss: 1.022 Test Acc: 0.800
Validation loss decreased (-0.799990 --> -0.799990).  Saving model ...
Epoch: 21 cost time: 0.3811345100402832
Epoch: 21, Steps: 3 | Train Loss: 0.863 Vali Loss: 0.993 Vali Acc: 0.825 Test Loss: 0.993 Test Acc: 0.825
Validation loss decreased (-0.799990 --> -0.824990).  Saving model ...
Epoch: 22 cost time: 0.3836052417755127
Epoch: 22, Steps: 3 | Train Loss: 0.820 Vali Loss: 0.959 Vali Acc: 0.825 Test Loss: 0.959 Test Acc: 0.825
Validation loss decreased (-0.824990 --> -0.824990).  Saving model ...
Epoch: 23 cost time: 0.3880739212036133
Epoch: 23, Steps: 3 | Train Loss: 0.790 Vali Loss: 0.936 Vali Acc: 0.825 Test Loss: 0.936 Test Acc: 0.825
Validation loss decreased (-0.824990 --> -0.824991).  Saving model ...
Epoch: 24 cost time: 0.3782801628112793
Epoch: 24, Steps: 3 | Train Loss: 0.732 Vali Loss: 0.917 Vali Acc: 0.825 Test Loss: 0.917 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824991).  Saving model ...
Epoch: 25 cost time: 0.4466712474822998
Epoch: 25, Steps: 3 | Train Loss: 0.724 Vali Loss: 0.894 Vali Acc: 0.825 Test Loss: 0.894 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824991).  Saving model ...
Epoch: 26 cost time: 0.35901832580566406
Epoch: 26, Steps: 3 | Train Loss: 0.681 Vali Loss: 0.884 Vali Acc: 0.825 Test Loss: 0.884 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824991).  Saving model ...
Epoch: 27 cost time: 0.3817098140716553
Epoch: 27, Steps: 3 | Train Loss: 0.680 Vali Loss: 0.850 Vali Acc: 0.825 Test Loss: 0.850 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824991).  Saving model ...
Epoch: 28 cost time: 0.38750767707824707
Epoch: 28, Steps: 3 | Train Loss: 0.625 Vali Loss: 0.820 Vali Acc: 0.825 Test Loss: 0.820 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824992).  Saving model ...
Epoch: 29 cost time: 0.3860204219818115
Epoch: 29, Steps: 3 | Train Loss: 0.608 Vali Loss: 0.803 Vali Acc: 0.825 Test Loss: 0.803 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 30 cost time: 0.3685331344604492
Epoch: 30, Steps: 3 | Train Loss: 0.571 Vali Loss: 0.780 Vali Acc: 0.825 Test Loss: 0.780 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 31 cost time: 0.3865072727203369
Epoch: 31, Steps: 3 | Train Loss: 0.550 Vali Loss: 0.747 Vali Acc: 0.825 Test Loss: 0.747 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824993).  Saving model ...
Epoch: 32 cost time: 0.399564266204834
Epoch: 32, Steps: 3 | Train Loss: 0.534 Vali Loss: 0.728 Vali Acc: 0.825 Test Loss: 0.728 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 33 cost time: 0.4082968235015869
Epoch: 33, Steps: 3 | Train Loss: 0.517 Vali Loss: 0.710 Vali Acc: 0.825 Test Loss: 0.710 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 34 cost time: 0.4170229434967041
Epoch: 34, Steps: 3 | Train Loss: 0.496 Vali Loss: 0.688 Vali Acc: 0.825 Test Loss: 0.688 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 35 cost time: 0.4214496612548828
Epoch: 35, Steps: 3 | Train Loss: 0.469 Vali Loss: 0.665 Vali Acc: 0.825 Test Loss: 0.665 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 36 cost time: 0.39168739318847656
Epoch: 36, Steps: 3 | Train Loss: 0.453 Vali Loss: 0.640 Vali Acc: 0.850 Test Loss: 0.640 Test Acc: 0.850
Validation loss decreased (-0.824993 --> -0.849994).  Saving model ...
Epoch: 37 cost time: 0.35849785804748535
Epoch: 37, Steps: 3 | Train Loss: 0.428 Vali Loss: 0.617 Vali Acc: 0.875 Test Loss: 0.617 Test Acc: 0.875
Validation loss decreased (-0.849994 --> -0.874994).  Saving model ...
Epoch: 38 cost time: 0.453810453414917
Epoch: 38, Steps: 3 | Train Loss: 0.407 Vali Loss: 0.603 Vali Acc: 0.875 Test Loss: 0.603 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 39 cost time: 0.37743401527404785
Epoch: 39, Steps: 3 | Train Loss: 0.400 Vali Loss: 0.586 Vali Acc: 0.900 Test Loss: 0.586 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899994).  Saving model ...
Epoch: 40 cost time: 0.3952353000640869
Epoch: 40, Steps: 3 | Train Loss: 0.378 Vali Loss: 0.563 Vali Acc: 0.900 Test Loss: 0.563 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 41 cost time: 0.3782179355621338
Epoch: 41, Steps: 3 | Train Loss: 0.361 Vali Loss: 0.547 Vali Acc: 0.900 Test Loss: 0.547 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 42 cost time: 0.39589858055114746
Epoch: 42, Steps: 3 | Train Loss: 0.338 Vali Loss: 0.528 Vali Acc: 0.900 Test Loss: 0.528 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 43 cost time: 0.3710451126098633
Epoch: 43, Steps: 3 | Train Loss: 0.334 Vali Loss: 0.522 Vali Acc: 0.900 Test Loss: 0.522 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 44 cost time: 0.3782162666320801
Epoch: 44, Steps: 3 | Train Loss: 0.325 Vali Loss: 0.507 Vali Acc: 0.900 Test Loss: 0.507 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 45 cost time: 0.3593902587890625
Epoch: 45, Steps: 3 | Train Loss: 0.306 Vali Loss: 0.489 Vali Acc: 0.900 Test Loss: 0.489 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 46 cost time: 0.37261366844177246
Epoch: 46, Steps: 3 | Train Loss: 0.309 Vali Loss: 0.483 Vali Acc: 0.900 Test Loss: 0.483 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 47 cost time: 0.37113165855407715
Epoch: 47, Steps: 3 | Train Loss: 0.277 Vali Loss: 0.466 Vali Acc: 0.900 Test Loss: 0.466 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 48 cost time: 0.38567280769348145
Epoch: 48, Steps: 3 | Train Loss: 0.266 Vali Loss: 0.451 Vali Acc: 0.925 Test Loss: 0.451 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924995).  Saving model ...
Epoch: 49 cost time: 0.36994385719299316
Epoch: 49, Steps: 3 | Train Loss: 0.241 Vali Loss: 0.452 Vali Acc: 0.925 Test Loss: 0.452 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.3645637035369873
Epoch: 50, Steps: 3 | Train Loss: 0.251 Vali Loss: 0.432 Vali Acc: 0.925 Test Loss: 0.432 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps25_str13_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 94788
model size : 0.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.5807344913482666
Epoch: 1, Steps: 3 | Train Loss: 1.312 Vali Loss: 1.363 Vali Acc: 0.500 Test Loss: 1.363 Test Acc: 0.500
Validation loss decreased (inf --> -0.499986).  Saving model ...
Epoch: 2 cost time: 0.44359803199768066
Epoch: 2, Steps: 3 | Train Loss: 1.206 Vali Loss: 1.306 Vali Acc: 0.525 Test Loss: 1.306 Test Acc: 0.525
Validation loss decreased (-0.499986 --> -0.524987).  Saving model ...
Epoch: 3 cost time: 0.42363595962524414
Epoch: 3, Steps: 3 | Train Loss: 1.069 Vali Loss: 1.195 Vali Acc: 0.575 Test Loss: 1.195 Test Acc: 0.575
Validation loss decreased (-0.524987 --> -0.574988).  Saving model ...
Epoch: 4 cost time: 0.41083240509033203
Epoch: 4, Steps: 3 | Train Loss: 0.861 Vali Loss: 1.046 Vali Acc: 0.675 Test Loss: 1.046 Test Acc: 0.675
Validation loss decreased (-0.574988 --> -0.674990).  Saving model ...
Epoch: 5 cost time: 0.4144117832183838
Epoch: 5, Steps: 3 | Train Loss: 0.661 Vali Loss: 0.900 Vali Acc: 0.850 Test Loss: 0.900 Test Acc: 0.850
Validation loss decreased (-0.674990 --> -0.849991).  Saving model ...
Epoch: 6 cost time: 0.439227819442749
Epoch: 6, Steps: 3 | Train Loss: 0.504 Vali Loss: 0.747 Vali Acc: 0.850 Test Loss: 0.747 Test Acc: 0.850
Validation loss decreased (-0.849991 --> -0.849993).  Saving model ...
Epoch: 7 cost time: 0.4261319637298584
Epoch: 7, Steps: 3 | Train Loss: 0.433 Vali Loss: 0.606 Vali Acc: 0.750 Test Loss: 0.606 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.48038458824157715
Epoch: 8, Steps: 3 | Train Loss: 0.317 Vali Loss: 0.494 Vali Acc: 0.875 Test Loss: 0.494 Test Acc: 0.875
Validation loss decreased (-0.849993 --> -0.874995).  Saving model ...
Epoch: 9 cost time: 0.41988110542297363
Epoch: 9, Steps: 3 | Train Loss: 0.256 Vali Loss: 0.421 Vali Acc: 0.900 Test Loss: 0.421 Test Acc: 0.900
Validation loss decreased (-0.874995 --> -0.899996).  Saving model ...
Epoch: 10 cost time: 0.43980979919433594
Epoch: 10, Steps: 3 | Train Loss: 0.231 Vali Loss: 0.365 Vali Acc: 0.925 Test Loss: 0.365 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924996).  Saving model ...
Epoch: 11 cost time: 0.3967008590698242
Epoch: 11, Steps: 3 | Train Loss: 0.158 Vali Loss: 0.334 Vali Acc: 0.925 Test Loss: 0.334 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924997).  Saving model ...
Epoch: 12 cost time: 0.3539257049560547
Epoch: 12, Steps: 3 | Train Loss: 0.135 Vali Loss: 0.310 Vali Acc: 0.925 Test Loss: 0.310 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 13 cost time: 0.45295262336730957
Epoch: 13, Steps: 3 | Train Loss: 0.118 Vali Loss: 0.295 Vali Acc: 0.925 Test Loss: 0.295 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 14 cost time: 0.3664240837097168
Epoch: 14, Steps: 3 | Train Loss: 0.089 Vali Loss: 0.279 Vali Acc: 0.925 Test Loss: 0.279 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 15 cost time: 0.397747278213501
Epoch: 15, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.284 Vali Acc: 0.925 Test Loss: 0.284 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.3832888603210449
Epoch: 16, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.286 Vali Acc: 0.925 Test Loss: 0.286 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.39620161056518555
Epoch: 17, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.285 Vali Acc: 0.925 Test Loss: 0.285 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.35013532638549805
Epoch: 18, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.289 Vali Acc: 0.925 Test Loss: 0.289 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.3524754047393799
Epoch: 19, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.296 Vali Acc: 0.925 Test Loss: 0.296 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.3726229667663574
Epoch: 20, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.304 Vali Acc: 0.925 Test Loss: 0.304 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.48587918281555176
Epoch: 21, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.322 Vali Acc: 0.925 Test Loss: 0.322 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.4896690845489502
Epoch: 22, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.343 Vali Acc: 0.925 Test Loss: 0.343 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.458019495010376
Epoch: 23, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.358 Vali Acc: 0.925 Test Loss: 0.358 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.44290685653686523
Epoch: 24, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.371 Vali Acc: 0.925 Test Loss: 0.371 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 1282564
model size : 4.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.5628182888031006
Epoch: 1, Steps: 3 | Train Loss: 1.334 Vali Loss: 1.320 Vali Acc: 0.250 Test Loss: 1.320 Test Acc: 0.250
Validation loss decreased (inf --> -0.249987).  Saving model ...
Epoch: 2 cost time: 0.4175589084625244
Epoch: 2, Steps: 3 | Train Loss: 1.218 Vali Loss: 1.273 Vali Acc: 0.500 Test Loss: 1.273 Test Acc: 0.500
Validation loss decreased (-0.249987 --> -0.499987).  Saving model ...
Epoch: 3 cost time: 0.43662118911743164
Epoch: 3, Steps: 3 | Train Loss: 1.150 Vali Loss: 1.178 Vali Acc: 0.775 Test Loss: 1.178 Test Acc: 0.775
Validation loss decreased (-0.499987 --> -0.774988).  Saving model ...
Epoch: 4 cost time: 0.4460330009460449
Epoch: 4, Steps: 3 | Train Loss: 0.966 Vali Loss: 1.049 Vali Acc: 0.800 Test Loss: 1.049 Test Acc: 0.800
Validation loss decreased (-0.774988 --> -0.799990).  Saving model ...
Epoch: 5 cost time: 0.44402050971984863
Epoch: 5, Steps: 3 | Train Loss: 0.811 Vali Loss: 0.906 Vali Acc: 0.825 Test Loss: 0.906 Test Acc: 0.825
Validation loss decreased (-0.799990 --> -0.824991).  Saving model ...
Epoch: 6 cost time: 0.43379688262939453
Epoch: 6, Steps: 3 | Train Loss: 0.622 Vali Loss: 0.783 Vali Acc: 0.900 Test Loss: 0.783 Test Acc: 0.900
Validation loss decreased (-0.824991 --> -0.899992).  Saving model ...
Epoch: 7 cost time: 0.4313690662384033
Epoch: 7, Steps: 3 | Train Loss: 0.505 Vali Loss: 0.656 Vali Acc: 0.925 Test Loss: 0.656 Test Acc: 0.925
Validation loss decreased (-0.899992 --> -0.924993).  Saving model ...
Epoch: 8 cost time: 0.4557969570159912
Epoch: 8, Steps: 3 | Train Loss: 0.401 Vali Loss: 0.531 Vali Acc: 0.975 Test Loss: 0.531 Test Acc: 0.975
Validation loss decreased (-0.924993 --> -0.974995).  Saving model ...
Epoch: 9 cost time: 0.42966675758361816
Epoch: 9, Steps: 3 | Train Loss: 0.312 Vali Loss: 0.437 Vali Acc: 0.975 Test Loss: 0.437 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 10 cost time: 0.4326467514038086
Epoch: 10, Steps: 3 | Train Loss: 0.239 Vali Loss: 0.368 Vali Acc: 0.975 Test Loss: 0.368 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 11 cost time: 0.476346492767334
Epoch: 11, Steps: 3 | Train Loss: 0.203 Vali Loss: 0.306 Vali Acc: 0.950 Test Loss: 0.306 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.41365957260131836
Epoch: 12, Steps: 3 | Train Loss: 0.180 Vali Loss: 0.252 Vali Acc: 0.975 Test Loss: 0.252 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 13 cost time: 0.4583561420440674
Epoch: 13, Steps: 3 | Train Loss: 0.145 Vali Loss: 0.213 Vali Acc: 0.975 Test Loss: 0.213 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 14 cost time: 0.4448263645172119
Epoch: 14, Steps: 3 | Train Loss: 0.134 Vali Loss: 0.183 Vali Acc: 0.975 Test Loss: 0.183 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 15 cost time: 0.4464108943939209
Epoch: 15, Steps: 3 | Train Loss: 0.097 Vali Loss: 0.162 Vali Acc: 0.975 Test Loss: 0.162 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 16 cost time: 0.4450352191925049
Epoch: 16, Steps: 3 | Train Loss: 0.083 Vali Loss: 0.148 Vali Acc: 0.975 Test Loss: 0.148 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974999).  Saving model ...
Epoch: 17 cost time: 0.45377612113952637
Epoch: 17, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.143 Vali Acc: 0.975 Test Loss: 0.143 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 18 cost time: 0.47231245040893555
Epoch: 18, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.133 Vali Acc: 0.975 Test Loss: 0.133 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 19 cost time: 0.45959019660949707
Epoch: 19, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.127 Vali Acc: 0.975 Test Loss: 0.127 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 20 cost time: 0.45452427864074707
Epoch: 20, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.124 Vali Acc: 0.975 Test Loss: 0.124 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 21 cost time: 0.4303250312805176
Epoch: 21, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.125 Vali Acc: 0.950 Test Loss: 0.125 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.42025089263916016
Epoch: 22, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.124 Vali Acc: 0.950 Test Loss: 0.124 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.44730329513549805
Epoch: 23, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.121 Vali Acc: 0.950 Test Loss: 0.121 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.494340181350708
Epoch: 24, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.126 Vali Acc: 0.950 Test Loss: 0.126 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.46230125427246094
Epoch: 25, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.137 Vali Acc: 0.950 Test Loss: 0.137 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.4609060287475586
Epoch: 26, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.136 Vali Acc: 0.950 Test Loss: 0.136 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.4489562511444092
Epoch: 27, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.137 Vali Acc: 0.950 Test Loss: 0.137 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.43586087226867676
Epoch: 28, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.138 Vali Acc: 0.950 Test Loss: 0.138 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.5072753429412842
Epoch: 29, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.130 Vali Acc: 0.950 Test Loss: 0.130 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.4459998607635498
Epoch: 30, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.123 Vali Acc: 0.950 Test Loss: 0.123 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 1233668
model size : 4.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.5736217498779297
Epoch: 1, Steps: 3 | Train Loss: 1.433 Vali Loss: 1.350 Vali Acc: 0.225 Test Loss: 1.350 Test Acc: 0.225
Validation loss decreased (inf --> -0.224987).  Saving model ...
Epoch: 2 cost time: 0.376537561416626
Epoch: 2, Steps: 3 | Train Loss: 1.342 Vali Loss: 1.310 Vali Acc: 0.300 Test Loss: 1.310 Test Acc: 0.300
Validation loss decreased (-0.224987 --> -0.299987).  Saving model ...
Epoch: 3 cost time: 0.40254783630371094
Epoch: 3, Steps: 3 | Train Loss: 1.252 Vali Loss: 1.229 Vali Acc: 0.450 Test Loss: 1.229 Test Acc: 0.450
Validation loss decreased (-0.299987 --> -0.449988).  Saving model ...
Epoch: 4 cost time: 0.42643308639526367
Epoch: 4, Steps: 3 | Train Loss: 1.090 Vali Loss: 1.129 Vali Acc: 0.625 Test Loss: 1.129 Test Acc: 0.625
Validation loss decreased (-0.449988 --> -0.624989).  Saving model ...
Epoch: 5 cost time: 0.41039514541625977
Epoch: 5, Steps: 3 | Train Loss: 0.942 Vali Loss: 1.012 Vali Acc: 0.750 Test Loss: 1.012 Test Acc: 0.750
Validation loss decreased (-0.624989 --> -0.749990).  Saving model ...
Epoch: 6 cost time: 0.43698692321777344
Epoch: 6, Steps: 3 | Train Loss: 0.792 Vali Loss: 0.882 Vali Acc: 0.775 Test Loss: 0.882 Test Acc: 0.775
Validation loss decreased (-0.749990 --> -0.774991).  Saving model ...
Epoch: 7 cost time: 0.39656877517700195
Epoch: 7, Steps: 3 | Train Loss: 0.634 Vali Loss: 0.767 Vali Acc: 0.800 Test Loss: 0.767 Test Acc: 0.800
Validation loss decreased (-0.774991 --> -0.799992).  Saving model ...
Epoch: 8 cost time: 0.4145359992980957
Epoch: 8, Steps: 3 | Train Loss: 0.527 Vali Loss: 0.651 Vali Acc: 0.850 Test Loss: 0.651 Test Acc: 0.850
Validation loss decreased (-0.799992 --> -0.849993).  Saving model ...
Epoch: 9 cost time: 0.3953390121459961
Epoch: 9, Steps: 3 | Train Loss: 0.445 Vali Loss: 0.547 Vali Acc: 0.925 Test Loss: 0.547 Test Acc: 0.925
Validation loss decreased (-0.849993 --> -0.924995).  Saving model ...
Epoch: 10 cost time: 0.4165968894958496
Epoch: 10, Steps: 3 | Train Loss: 0.358 Vali Loss: 0.477 Vali Acc: 0.950 Test Loss: 0.477 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949995).  Saving model ...
Epoch: 11 cost time: 0.41055941581726074
Epoch: 11, Steps: 3 | Train Loss: 0.301 Vali Loss: 0.409 Vali Acc: 0.950 Test Loss: 0.409 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 12 cost time: 0.47220373153686523
Epoch: 12, Steps: 3 | Train Loss: 0.250 Vali Loss: 0.363 Vali Acc: 0.950 Test Loss: 0.363 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 13 cost time: 0.40030360221862793
Epoch: 13, Steps: 3 | Train Loss: 0.209 Vali Loss: 0.321 Vali Acc: 0.975 Test Loss: 0.321 Test Acc: 0.975
Validation loss decreased (-0.949996 --> -0.974997).  Saving model ...
Epoch: 14 cost time: 0.41574621200561523
Epoch: 14, Steps: 3 | Train Loss: 0.189 Vali Loss: 0.291 Vali Acc: 0.975 Test Loss: 0.291 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 15 cost time: 0.44245076179504395
Epoch: 15, Steps: 3 | Train Loss: 0.152 Vali Loss: 0.274 Vali Acc: 0.975 Test Loss: 0.274 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 16 cost time: 0.43956708908081055
Epoch: 16, Steps: 3 | Train Loss: 0.133 Vali Loss: 0.252 Vali Acc: 0.975 Test Loss: 0.252 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 17 cost time: 0.44344592094421387
Epoch: 17, Steps: 3 | Train Loss: 0.123 Vali Loss: 0.230 Vali Acc: 0.975 Test Loss: 0.230 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 18 cost time: 0.38681817054748535
Epoch: 18, Steps: 3 | Train Loss: 0.091 Vali Loss: 0.221 Vali Acc: 0.975 Test Loss: 0.221 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 19 cost time: 0.4074530601501465
Epoch: 19, Steps: 3 | Train Loss: 0.086 Vali Loss: 0.205 Vali Acc: 0.975 Test Loss: 0.205 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 20 cost time: 0.4113001823425293
Epoch: 20, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.191 Vali Acc: 0.975 Test Loss: 0.191 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 21 cost time: 0.4097785949707031
Epoch: 21, Steps: 3 | Train Loss: 0.062 Vali Loss: 0.179 Vali Acc: 0.975 Test Loss: 0.179 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 22 cost time: 0.4048190116882324
Epoch: 22, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.178 Vali Acc: 0.975 Test Loss: 0.178 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 23 cost time: 0.4244263172149658
Epoch: 23, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.171 Vali Acc: 0.975 Test Loss: 0.171 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 24 cost time: 0.40314507484436035
Epoch: 24, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.164 Vali Acc: 0.975 Test Loss: 0.164 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 25 cost time: 0.4162440299987793
Epoch: 25, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.165 Vali Acc: 0.975 Test Loss: 0.165 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.40228724479675293
Epoch: 26, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.160 Vali Acc: 0.975 Test Loss: 0.160 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 27 cost time: 0.4584324359893799
Epoch: 27, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.161 Vali Acc: 0.975 Test Loss: 0.161 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.4132957458496094
Epoch: 28, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.163 Vali Acc: 0.975 Test Loss: 0.163 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.43900346755981445
Epoch: 29, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.158 Vali Acc: 0.975 Test Loss: 0.158 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 30 cost time: 0.4574429988861084
Epoch: 30, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.159 Vali Acc: 0.975 Test Loss: 0.159 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.4442768096923828
Epoch: 31, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.158 Vali Acc: 0.975 Test Loss: 0.158 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 32 cost time: 0.41741275787353516
Epoch: 32, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.162 Vali Acc: 0.950 Test Loss: 0.162 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.451632022857666
Epoch: 33, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.165 Vali Acc: 0.950 Test Loss: 0.165 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.47994303703308105
Epoch: 34, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.172 Vali Acc: 0.950 Test Loss: 0.172 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.3976755142211914
Epoch: 35, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.167 Vali Acc: 0.950 Test Loss: 0.167 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.480571985244751
Epoch: 36, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.162 Vali Acc: 0.950 Test Loss: 0.162 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.4045097827911377
Epoch: 37, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.158 Vali Acc: 0.950 Test Loss: 0.158 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.40612077713012695
Epoch: 38, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.153 Vali Acc: 0.975 Test Loss: 0.153 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 39 cost time: 0.43792128562927246
Epoch: 39, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.153 Vali Acc: 0.975 Test Loss: 0.153 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.3895556926727295
Epoch: 40, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.156 Vali Acc: 0.950 Test Loss: 0.156 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.46863508224487305
Epoch: 41, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.157 Vali Acc: 0.950 Test Loss: 0.157 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.42298173904418945
Epoch: 42, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.149 Vali Acc: 0.975 Test Loss: 0.149 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974999).  Saving model ...
Epoch: 43 cost time: 0.4059946537017822
Epoch: 43, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.154 Vali Acc: 0.950 Test Loss: 0.154 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.40140390396118164
Epoch: 44, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.153 Vali Acc: 0.975 Test Loss: 0.153 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.40294313430786133
Epoch: 45, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.160 Vali Acc: 0.950 Test Loss: 0.160 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.41555261611938477
Epoch: 46, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.160 Vali Acc: 0.950 Test Loss: 0.160 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.47150516510009766
Epoch: 47, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.169 Vali Acc: 0.950 Test Loss: 0.169 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.4203832149505615
Epoch: 48, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.172 Vali Acc: 0.950 Test Loss: 0.172 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.3969106674194336
Epoch: 49, Steps: 3 | Train Loss: 0.002 Vali Loss: 0.163 Vali Acc: 0.950 Test Loss: 0.163 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.45229244232177734
Epoch: 50, Steps: 3 | Train Loss: 0.003 Vali Loss: 0.163 Vali Acc: 0.950 Test Loss: 0.163 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 1209476
model size : 4.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.7800817489624023
Epoch: 1, Steps: 3 | Train Loss: 1.408 Vali Loss: 1.321 Vali Acc: 0.450 Test Loss: 1.321 Test Acc: 0.450
Validation loss decreased (inf --> -0.449987).  Saving model ...
Epoch: 2 cost time: 0.40221667289733887
Epoch: 2, Steps: 3 | Train Loss: 1.341 Vali Loss: 1.284 Vali Acc: 0.450 Test Loss: 1.284 Test Acc: 0.450
Validation loss decreased (-0.449987 --> -0.449987).  Saving model ...
Epoch: 3 cost time: 0.3899192810058594
Epoch: 3, Steps: 3 | Train Loss: 1.273 Vali Loss: 1.214 Vali Acc: 0.525 Test Loss: 1.214 Test Acc: 0.525
Validation loss decreased (-0.449987 --> -0.524988).  Saving model ...
Epoch: 4 cost time: 0.43129563331604004
Epoch: 4, Steps: 3 | Train Loss: 1.140 Vali Loss: 1.121 Vali Acc: 0.725 Test Loss: 1.121 Test Acc: 0.725
Validation loss decreased (-0.524988 --> -0.724989).  Saving model ...
Epoch: 5 cost time: 0.43248701095581055
Epoch: 5, Steps: 3 | Train Loss: 0.975 Vali Loss: 1.016 Vali Acc: 0.825 Test Loss: 1.016 Test Acc: 0.825
Validation loss decreased (-0.724989 --> -0.824990).  Saving model ...
Epoch: 6 cost time: 0.40541577339172363
Epoch: 6, Steps: 3 | Train Loss: 0.869 Vali Loss: 0.906 Vali Acc: 0.850 Test Loss: 0.906 Test Acc: 0.850
Validation loss decreased (-0.824990 --> -0.849991).  Saving model ...
Epoch: 7 cost time: 0.41713809967041016
Epoch: 7, Steps: 3 | Train Loss: 0.720 Vali Loss: 0.793 Vali Acc: 0.875 Test Loss: 0.793 Test Acc: 0.875
Validation loss decreased (-0.849991 --> -0.874992).  Saving model ...
Epoch: 8 cost time: 0.40570592880249023
Epoch: 8, Steps: 3 | Train Loss: 0.615 Vali Loss: 0.697 Vali Acc: 0.900 Test Loss: 0.697 Test Acc: 0.900
Validation loss decreased (-0.874992 --> -0.899993).  Saving model ...
Epoch: 9 cost time: 0.4162461757659912
Epoch: 9, Steps: 3 | Train Loss: 0.500 Vali Loss: 0.608 Vali Acc: 0.925 Test Loss: 0.608 Test Acc: 0.925
Validation loss decreased (-0.899993 --> -0.924994).  Saving model ...
Epoch: 10 cost time: 0.4621579647064209
Epoch: 10, Steps: 3 | Train Loss: 0.407 Vali Loss: 0.550 Vali Acc: 0.925 Test Loss: 0.550 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 11 cost time: 0.4327843189239502
Epoch: 11, Steps: 3 | Train Loss: 0.348 Vali Loss: 0.492 Vali Acc: 0.950 Test Loss: 0.492 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949995).  Saving model ...
Epoch: 12 cost time: 0.4367096424102783
Epoch: 12, Steps: 3 | Train Loss: 0.310 Vali Loss: 0.427 Vali Acc: 0.950 Test Loss: 0.427 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 13 cost time: 0.45378565788269043
Epoch: 13, Steps: 3 | Train Loss: 0.256 Vali Loss: 0.366 Vali Acc: 0.950 Test Loss: 0.366 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 14 cost time: 0.4356245994567871
Epoch: 14, Steps: 3 | Train Loss: 0.214 Vali Loss: 0.301 Vali Acc: 0.950 Test Loss: 0.301 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 15 cost time: 0.41973161697387695
Epoch: 15, Steps: 3 | Train Loss: 0.209 Vali Loss: 0.267 Vali Acc: 0.975 Test Loss: 0.267 Test Acc: 0.975
Validation loss decreased (-0.949997 --> -0.974997).  Saving model ...
Epoch: 16 cost time: 0.4581570625305176
Epoch: 16, Steps: 3 | Train Loss: 0.177 Vali Loss: 0.250 Vali Acc: 0.975 Test Loss: 0.250 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 17 cost time: 0.4460780620574951
Epoch: 17, Steps: 3 | Train Loss: 0.156 Vali Loss: 0.219 Vali Acc: 0.975 Test Loss: 0.219 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 18 cost time: 0.40758800506591797
Epoch: 18, Steps: 3 | Train Loss: 0.149 Vali Loss: 0.192 Vali Acc: 0.975 Test Loss: 0.192 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 19 cost time: 0.40426087379455566
Epoch: 19, Steps: 3 | Train Loss: 0.130 Vali Loss: 0.175 Vali Acc: 0.975 Test Loss: 0.175 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 20 cost time: 0.45263123512268066
Epoch: 20, Steps: 3 | Train Loss: 0.103 Vali Loss: 0.162 Vali Acc: 0.975 Test Loss: 0.162 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 21 cost time: 0.4857792854309082
Epoch: 21, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.152 Vali Acc: 0.975 Test Loss: 0.152 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 22 cost time: 0.41771912574768066
Epoch: 22, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.142 Vali Acc: 0.975 Test Loss: 0.142 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974999).  Saving model ...
Epoch: 23 cost time: 0.36979007720947266
Epoch: 23, Steps: 3 | Train Loss: 0.062 Vali Loss: 0.131 Vali Acc: 0.975 Test Loss: 0.131 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 24 cost time: 0.43077874183654785
Epoch: 24, Steps: 3 | Train Loss: 0.070 Vali Loss: 0.129 Vali Acc: 0.975 Test Loss: 0.129 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 25 cost time: 0.37880635261535645
Epoch: 25, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.122 Vali Acc: 0.975 Test Loss: 0.122 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 26 cost time: 0.5061972141265869
Epoch: 26, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.121 Vali Acc: 0.975 Test Loss: 0.121 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 27 cost time: 0.38820457458496094
Epoch: 27, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.122 Vali Acc: 0.975 Test Loss: 0.122 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.4118642807006836
Epoch: 28, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.126 Vali Acc: 0.975 Test Loss: 0.126 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.4147939682006836
Epoch: 29, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.130 Vali Acc: 0.950 Test Loss: 0.130 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.3692617416381836
Epoch: 30, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.134 Vali Acc: 0.950 Test Loss: 0.134 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.40720677375793457
Epoch: 31, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.133 Vali Acc: 0.950 Test Loss: 0.133 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.4507591724395752
Epoch: 32, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.141 Vali Acc: 0.950 Test Loss: 0.141 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.414898157119751
Epoch: 33, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.136 Vali Acc: 0.950 Test Loss: 0.136 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.4212512969970703
Epoch: 34, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.138 Vali Acc: 0.950 Test Loss: 0.138 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.4047660827636719
Epoch: 35, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.138 Vali Acc: 0.950 Test Loss: 0.138 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.42180299758911133
Epoch: 36, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.144 Vali Acc: 0.950 Test Loss: 0.144 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 1191300
model size : 4.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.551894187927246
Epoch: 1, Steps: 3 | Train Loss: 1.424 Vali Loss: 1.357 Vali Acc: 0.175 Test Loss: 1.357 Test Acc: 0.175
Validation loss decreased (inf --> -0.174986).  Saving model ...
Epoch: 2 cost time: 0.4240243434906006
Epoch: 2, Steps: 3 | Train Loss: 1.338 Vali Loss: 1.331 Vali Acc: 0.250 Test Loss: 1.331 Test Acc: 0.250
Validation loss decreased (-0.174986 --> -0.249987).  Saving model ...
Epoch: 3 cost time: 0.45558977127075195
Epoch: 3, Steps: 3 | Train Loss: 1.252 Vali Loss: 1.288 Vali Acc: 0.450 Test Loss: 1.288 Test Acc: 0.450
Validation loss decreased (-0.249987 --> -0.449987).  Saving model ...
Epoch: 4 cost time: 0.44011521339416504
Epoch: 4, Steps: 3 | Train Loss: 1.188 Vali Loss: 1.228 Vali Acc: 0.675 Test Loss: 1.228 Test Acc: 0.675
Validation loss decreased (-0.449987 --> -0.674988).  Saving model ...
Epoch: 5 cost time: 0.42569422721862793
Epoch: 5, Steps: 3 | Train Loss: 1.077 Vali Loss: 1.157 Vali Acc: 0.750 Test Loss: 1.157 Test Acc: 0.750
Validation loss decreased (-0.674988 --> -0.749988).  Saving model ...
Epoch: 6 cost time: 0.4738426208496094
Epoch: 6, Steps: 3 | Train Loss: 0.974 Vali Loss: 1.075 Vali Acc: 0.775 Test Loss: 1.075 Test Acc: 0.775
Validation loss decreased (-0.749988 --> -0.774989).  Saving model ...
Epoch: 7 cost time: 0.3686385154724121
Epoch: 7, Steps: 3 | Train Loss: 0.900 Vali Loss: 0.991 Vali Acc: 0.850 Test Loss: 0.991 Test Acc: 0.850
Validation loss decreased (-0.774989 --> -0.849990).  Saving model ...
Epoch: 8 cost time: 0.4326009750366211
Epoch: 8, Steps: 3 | Train Loss: 0.777 Vali Loss: 0.897 Vali Acc: 0.850 Test Loss: 0.897 Test Acc: 0.850
Validation loss decreased (-0.849990 --> -0.849991).  Saving model ...
Epoch: 9 cost time: 0.4229409694671631
Epoch: 9, Steps: 3 | Train Loss: 0.698 Vali Loss: 0.799 Vali Acc: 0.850 Test Loss: 0.799 Test Acc: 0.850
Validation loss decreased (-0.849991 --> -0.849992).  Saving model ...
Epoch: 10 cost time: 0.5351791381835938
Epoch: 10, Steps: 3 | Train Loss: 0.597 Vali Loss: 0.705 Vali Acc: 0.900 Test Loss: 0.705 Test Acc: 0.900
Validation loss decreased (-0.849992 --> -0.899993).  Saving model ...
Epoch: 11 cost time: 0.4268174171447754
Epoch: 11, Steps: 3 | Train Loss: 0.535 Vali Loss: 0.637 Vali Acc: 0.875 Test Loss: 0.637 Test Acc: 0.875
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.4936952590942383
Epoch: 12, Steps: 3 | Train Loss: 0.438 Vali Loss: 0.573 Vali Acc: 0.900 Test Loss: 0.573 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899994).  Saving model ...
Epoch: 13 cost time: 0.4656078815460205
Epoch: 13, Steps: 3 | Train Loss: 0.368 Vali Loss: 0.531 Vali Acc: 0.900 Test Loss: 0.531 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 14 cost time: 0.4114511013031006
Epoch: 14, Steps: 3 | Train Loss: 0.331 Vali Loss: 0.490 Vali Acc: 0.900 Test Loss: 0.490 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 15 cost time: 0.44727158546447754
Epoch: 15, Steps: 3 | Train Loss: 0.292 Vali Loss: 0.460 Vali Acc: 0.900 Test Loss: 0.460 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 16 cost time: 0.42277026176452637
Epoch: 16, Steps: 3 | Train Loss: 0.266 Vali Loss: 0.436 Vali Acc: 0.900 Test Loss: 0.436 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 17 cost time: 0.44025158882141113
Epoch: 17, Steps: 3 | Train Loss: 0.238 Vali Loss: 0.409 Vali Acc: 0.900 Test Loss: 0.409 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 18 cost time: 0.4467124938964844
Epoch: 18, Steps: 3 | Train Loss: 0.224 Vali Loss: 0.371 Vali Acc: 0.925 Test Loss: 0.371 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924996).  Saving model ...
Epoch: 19 cost time: 0.4386558532714844
Epoch: 19, Steps: 3 | Train Loss: 0.203 Vali Loss: 0.344 Vali Acc: 0.925 Test Loss: 0.344 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924997).  Saving model ...
Epoch: 20 cost time: 0.4800276756286621
Epoch: 20, Steps: 3 | Train Loss: 0.184 Vali Loss: 0.320 Vali Acc: 0.925 Test Loss: 0.320 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 21 cost time: 0.4426717758178711
Epoch: 21, Steps: 3 | Train Loss: 0.164 Vali Loss: 0.303 Vali Acc: 0.950 Test Loss: 0.303 Test Acc: 0.950
Validation loss decreased (-0.924997 --> -0.949997).  Saving model ...
Epoch: 22 cost time: 0.4251441955566406
Epoch: 22, Steps: 3 | Train Loss: 0.152 Vali Loss: 0.292 Vali Acc: 0.950 Test Loss: 0.292 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 23 cost time: 0.4331479072570801
Epoch: 23, Steps: 3 | Train Loss: 0.142 Vali Loss: 0.285 Vali Acc: 0.950 Test Loss: 0.285 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 24 cost time: 0.4307441711425781
Epoch: 24, Steps: 3 | Train Loss: 0.111 Vali Loss: 0.279 Vali Acc: 0.950 Test Loss: 0.279 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 25 cost time: 0.4280974864959717
Epoch: 25, Steps: 3 | Train Loss: 0.086 Vali Loss: 0.258 Vali Acc: 0.950 Test Loss: 0.258 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 26 cost time: 0.4062836170196533
Epoch: 26, Steps: 3 | Train Loss: 0.112 Vali Loss: 0.250 Vali Acc: 0.950 Test Loss: 0.250 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 27 cost time: 0.4089820384979248
Epoch: 27, Steps: 3 | Train Loss: 0.086 Vali Loss: 0.248 Vali Acc: 0.950 Test Loss: 0.248 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 28 cost time: 0.41637110710144043
Epoch: 28, Steps: 3 | Train Loss: 0.079 Vali Loss: 0.251 Vali Acc: 0.950 Test Loss: 0.251 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.49292802810668945
Epoch: 29, Steps: 3 | Train Loss: 0.062 Vali Loss: 0.244 Vali Acc: 0.950 Test Loss: 0.244 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 30 cost time: 0.41917943954467773
Epoch: 30, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.232 Vali Acc: 0.950 Test Loss: 0.232 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 31 cost time: 0.4394497871398926
Epoch: 31, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.230 Vali Acc: 0.950 Test Loss: 0.230 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 32 cost time: 0.42057180404663086
Epoch: 32, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.235 Vali Acc: 0.950 Test Loss: 0.235 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.5512993335723877
Epoch: 33, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.232 Vali Acc: 0.950 Test Loss: 0.232 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.37763190269470215
Epoch: 34, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.236 Vali Acc: 0.950 Test Loss: 0.236 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.4395878314971924
Epoch: 35, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.230 Vali Acc: 0.950 Test Loss: 0.230 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.4106907844543457
Epoch: 36, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.232 Vali Acc: 0.950 Test Loss: 0.232 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.45565342903137207
Epoch: 37, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.236 Vali Acc: 0.950 Test Loss: 0.236 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.49419164657592773
Epoch: 38, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.241 Vali Acc: 0.950 Test Loss: 0.241 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.4447765350341797
Epoch: 39, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.248 Vali Acc: 0.925 Test Loss: 0.248 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.4263453483581543
Epoch: 40, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.256 Vali Acc: 0.925 Test Loss: 0.256 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.4326958656311035
Epoch: 41, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.258 Vali Acc: 0.925 Test Loss: 0.258 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 1167364
model size : 4.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps20_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.521803379058838
Epoch: 1, Steps: 3 | Train Loss: 1.433 Vali Loss: 1.384 Vali Acc: 0.150 Test Loss: 1.384 Test Acc: 0.150
Validation loss decreased (inf --> -0.149986).  Saving model ...
Epoch: 2 cost time: 0.40596961975097656
Epoch: 2, Steps: 3 | Train Loss: 1.383 Vali Loss: 1.360 Vali Acc: 0.175 Test Loss: 1.360 Test Acc: 0.175
Validation loss decreased (-0.149986 --> -0.174986).  Saving model ...
Epoch: 3 cost time: 0.40430784225463867
Epoch: 3, Steps: 3 | Train Loss: 1.325 Vali Loss: 1.323 Vali Acc: 0.250 Test Loss: 1.323 Test Acc: 0.250
Validation loss decreased (-0.174986 --> -0.249987).  Saving model ...
Epoch: 4 cost time: 0.4105091094970703
Epoch: 4, Steps: 3 | Train Loss: 1.245 Vali Loss: 1.267 Vali Acc: 0.325 Test Loss: 1.267 Test Acc: 0.325
Validation loss decreased (-0.249987 --> -0.324987).  Saving model ...
Epoch: 5 cost time: 0.400165319442749
Epoch: 5, Steps: 3 | Train Loss: 1.135 Vali Loss: 1.197 Vali Acc: 0.625 Test Loss: 1.197 Test Acc: 0.625
Validation loss decreased (-0.324987 --> -0.624988).  Saving model ...
Epoch: 6 cost time: 0.3885006904602051
Epoch: 6, Steps: 3 | Train Loss: 1.036 Vali Loss: 1.120 Vali Acc: 0.725 Test Loss: 1.120 Test Acc: 0.725
Validation loss decreased (-0.624988 --> -0.724989).  Saving model ...
Epoch: 7 cost time: 0.3935565948486328
Epoch: 7, Steps: 3 | Train Loss: 0.919 Vali Loss: 1.039 Vali Acc: 0.850 Test Loss: 1.039 Test Acc: 0.850
Validation loss decreased (-0.724989 --> -0.849990).  Saving model ...
Epoch: 8 cost time: 0.404247522354126
Epoch: 8, Steps: 3 | Train Loss: 0.839 Vali Loss: 0.958 Vali Acc: 0.875 Test Loss: 0.958 Test Acc: 0.875
Validation loss decreased (-0.849990 --> -0.874990).  Saving model ...
Epoch: 9 cost time: 0.38506627082824707
Epoch: 9, Steps: 3 | Train Loss: 0.726 Vali Loss: 0.878 Vali Acc: 0.900 Test Loss: 0.878 Test Acc: 0.900
Validation loss decreased (-0.874990 --> -0.899991).  Saving model ...
Epoch: 10 cost time: 0.40968847274780273
Epoch: 10, Steps: 3 | Train Loss: 0.623 Vali Loss: 0.816 Vali Acc: 0.925 Test Loss: 0.816 Test Acc: 0.925
Validation loss decreased (-0.899991 --> -0.924992).  Saving model ...
Epoch: 11 cost time: 0.41416406631469727
Epoch: 11, Steps: 3 | Train Loss: 0.573 Vali Loss: 0.736 Vali Acc: 0.925 Test Loss: 0.736 Test Acc: 0.925
Validation loss decreased (-0.924992 --> -0.924993).  Saving model ...
Epoch: 12 cost time: 0.35750484466552734
Epoch: 12, Steps: 3 | Train Loss: 0.505 Vali Loss: 0.676 Vali Acc: 0.925 Test Loss: 0.676 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924993).  Saving model ...
Epoch: 13 cost time: 0.45068836212158203
Epoch: 13, Steps: 3 | Train Loss: 0.464 Vali Loss: 0.616 Vali Acc: 0.925 Test Loss: 0.616 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924994).  Saving model ...
Epoch: 14 cost time: 0.37714457511901855
Epoch: 14, Steps: 3 | Train Loss: 0.415 Vali Loss: 0.561 Vali Acc: 0.900 Test Loss: 0.561 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.385784387588501
Epoch: 15, Steps: 3 | Train Loss: 0.349 Vali Loss: 0.515 Vali Acc: 0.900 Test Loss: 0.515 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.4410243034362793
Epoch: 16, Steps: 3 | Train Loss: 0.328 Vali Loss: 0.483 Vali Acc: 0.900 Test Loss: 0.483 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.4035377502441406
Epoch: 17, Steps: 3 | Train Loss: 0.317 Vali Loss: 0.451 Vali Acc: 0.900 Test Loss: 0.451 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.38271546363830566
Epoch: 18, Steps: 3 | Train Loss: 0.296 Vali Loss: 0.428 Vali Acc: 0.900 Test Loss: 0.428 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.432633638381958
Epoch: 19, Steps: 3 | Train Loss: 0.242 Vali Loss: 0.395 Vali Acc: 0.925 Test Loss: 0.395 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924996).  Saving model ...
Epoch: 20 cost time: 0.40705418586730957
Epoch: 20, Steps: 3 | Train Loss: 0.225 Vali Loss: 0.386 Vali Acc: 0.925 Test Loss: 0.386 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 21 cost time: 0.3775458335876465
Epoch: 21, Steps: 3 | Train Loss: 0.191 Vali Loss: 0.382 Vali Acc: 0.925 Test Loss: 0.382 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 22 cost time: 0.4020240306854248
Epoch: 22, Steps: 3 | Train Loss: 0.180 Vali Loss: 0.368 Vali Acc: 0.925 Test Loss: 0.368 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 23 cost time: 0.40647435188293457
Epoch: 23, Steps: 3 | Train Loss: 0.179 Vali Loss: 0.357 Vali Acc: 0.925 Test Loss: 0.357 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 24 cost time: 0.43564629554748535
Epoch: 24, Steps: 3 | Train Loss: 0.172 Vali Loss: 0.335 Vali Acc: 0.925 Test Loss: 0.335 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924997).  Saving model ...
Epoch: 25 cost time: 0.4297037124633789
Epoch: 25, Steps: 3 | Train Loss: 0.160 Vali Loss: 0.313 Vali Acc: 0.950 Test Loss: 0.313 Test Acc: 0.950
Validation loss decreased (-0.924997 --> -0.949997).  Saving model ...
Epoch: 26 cost time: 0.40077781677246094
Epoch: 26, Steps: 3 | Train Loss: 0.147 Vali Loss: 0.302 Vali Acc: 0.950 Test Loss: 0.302 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 27 cost time: 0.39405179023742676
Epoch: 27, Steps: 3 | Train Loss: 0.124 Vali Loss: 0.295 Vali Acc: 0.950 Test Loss: 0.295 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 28 cost time: 0.39279770851135254
Epoch: 28, Steps: 3 | Train Loss: 0.130 Vali Loss: 0.287 Vali Acc: 0.950 Test Loss: 0.287 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 29 cost time: 0.4280822277069092
Epoch: 29, Steps: 3 | Train Loss: 0.106 Vali Loss: 0.277 Vali Acc: 0.950 Test Loss: 0.277 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 30 cost time: 0.3997652530670166
Epoch: 30, Steps: 3 | Train Loss: 0.098 Vali Loss: 0.276 Vali Acc: 0.950 Test Loss: 0.276 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 31 cost time: 0.430387020111084
Epoch: 31, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.273 Vali Acc: 0.950 Test Loss: 0.273 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 32 cost time: 0.4082028865814209
Epoch: 32, Steps: 3 | Train Loss: 0.073 Vali Loss: 0.273 Vali Acc: 0.950 Test Loss: 0.273 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 33 cost time: 0.3954150676727295
Epoch: 33, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.261 Vali Acc: 0.950 Test Loss: 0.261 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 34 cost time: 0.3809323310852051
Epoch: 34, Steps: 3 | Train Loss: 0.063 Vali Loss: 0.258 Vali Acc: 0.950 Test Loss: 0.258 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 35 cost time: 0.4080681800842285
Epoch: 35, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.250 Vali Acc: 0.950 Test Loss: 0.250 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 36 cost time: 0.4508793354034424
Epoch: 36, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.244 Vali Acc: 0.950 Test Loss: 0.244 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 37 cost time: 0.3454172611236572
Epoch: 37, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.249 Vali Acc: 0.950 Test Loss: 0.249 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.4350721836090088
Epoch: 38, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.250 Vali Acc: 0.950 Test Loss: 0.250 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.40367650985717773
Epoch: 39, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.241 Vali Acc: 0.950 Test Loss: 0.241 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 40 cost time: 0.42116689682006836
Epoch: 40, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.243 Vali Acc: 0.950 Test Loss: 0.243 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.4577031135559082
Epoch: 41, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.242 Vali Acc: 0.950 Test Loss: 0.242 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.4192373752593994
Epoch: 42, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.235 Vali Acc: 0.950 Test Loss: 0.235 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 43 cost time: 0.3606445789337158
Epoch: 43, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.238 Vali Acc: 0.950 Test Loss: 0.238 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.3558025360107422
Epoch: 44, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.235 Vali Acc: 0.950 Test Loss: 0.235 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 45 cost time: 0.5203137397766113
Epoch: 45, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.238 Vali Acc: 0.950 Test Loss: 0.238 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.39963245391845703
Epoch: 46, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.239 Vali Acc: 0.950 Test Loss: 0.239 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.3910176753997803
Epoch: 47, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.241 Vali Acc: 0.950 Test Loss: 0.241 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.3299732208251953
Epoch: 48, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.241 Vali Acc: 0.950 Test Loss: 0.241 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.384049654006958
Epoch: 49, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.245 Vali Acc: 0.950 Test Loss: 0.245 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.3942561149597168
Epoch: 50, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.248 Vali Acc: 0.950 Test Loss: 0.248 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps20_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 1161860
model size : 4.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps25_str13_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.595876693725586
Epoch: 1, Steps: 3 | Train Loss: 1.341 Vali Loss: 1.319 Vali Acc: 0.325 Test Loss: 1.319 Test Acc: 0.325
Validation loss decreased (inf --> -0.324987).  Saving model ...
Epoch: 2 cost time: 0.42480969429016113
Epoch: 2, Steps: 3 | Train Loss: 1.312 Vali Loss: 1.291 Vali Acc: 0.350 Test Loss: 1.291 Test Acc: 0.350
Validation loss decreased (-0.324987 --> -0.349987).  Saving model ...
Epoch: 3 cost time: 0.43465733528137207
Epoch: 3, Steps: 3 | Train Loss: 1.269 Vali Loss: 1.253 Vali Acc: 0.350 Test Loss: 1.253 Test Acc: 0.350
Validation loss decreased (-0.349987 --> -0.349987).  Saving model ...
Epoch: 4 cost time: 0.41689038276672363
Epoch: 4, Steps: 3 | Train Loss: 1.168 Vali Loss: 1.201 Vali Acc: 0.475 Test Loss: 1.201 Test Acc: 0.475
Validation loss decreased (-0.349987 --> -0.474988).  Saving model ...
Epoch: 5 cost time: 0.43684816360473633
Epoch: 5, Steps: 3 | Train Loss: 1.076 Vali Loss: 1.141 Vali Acc: 0.550 Test Loss: 1.141 Test Acc: 0.550
Validation loss decreased (-0.474988 --> -0.549989).  Saving model ...
Epoch: 6 cost time: 0.4614226818084717
Epoch: 6, Steps: 3 | Train Loss: 1.007 Vali Loss: 1.071 Vali Acc: 0.725 Test Loss: 1.071 Test Acc: 0.725
Validation loss decreased (-0.549989 --> -0.724989).  Saving model ...
Epoch: 7 cost time: 0.3856377601623535
Epoch: 7, Steps: 3 | Train Loss: 0.884 Vali Loss: 1.000 Vali Acc: 0.850 Test Loss: 1.000 Test Acc: 0.850
Validation loss decreased (-0.724989 --> -0.849990).  Saving model ...
Epoch: 8 cost time: 0.44943761825561523
Epoch: 8, Steps: 3 | Train Loss: 0.794 Vali Loss: 0.928 Vali Acc: 0.850 Test Loss: 0.928 Test Acc: 0.850
Validation loss decreased (-0.849990 --> -0.849991).  Saving model ...
Epoch: 9 cost time: 0.4387507438659668
Epoch: 9, Steps: 3 | Train Loss: 0.741 Vali Loss: 0.856 Vali Acc: 0.850 Test Loss: 0.856 Test Acc: 0.850
Validation loss decreased (-0.849991 --> -0.849991).  Saving model ...
Epoch: 10 cost time: 0.40903377532958984
Epoch: 10, Steps: 3 | Train Loss: 0.635 Vali Loss: 0.788 Vali Acc: 0.825 Test Loss: 0.788 Test Acc: 0.825
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.41568446159362793
Epoch: 11, Steps: 3 | Train Loss: 0.599 Vali Loss: 0.719 Vali Acc: 0.825 Test Loss: 0.719 Test Acc: 0.825
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.4098989963531494
Epoch: 12, Steps: 3 | Train Loss: 0.524 Vali Loss: 0.651 Vali Acc: 0.825 Test Loss: 0.651 Test Acc: 0.825
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.38225865364074707
Epoch: 13, Steps: 3 | Train Loss: 0.484 Vali Loss: 0.590 Vali Acc: 0.850 Test Loss: 0.590 Test Acc: 0.850
Validation loss decreased (-0.849991 --> -0.849994).  Saving model ...
Epoch: 14 cost time: 0.3846280574798584
Epoch: 14, Steps: 3 | Train Loss: 0.420 Vali Loss: 0.539 Vali Acc: 0.850 Test Loss: 0.539 Test Acc: 0.850
Validation loss decreased (-0.849994 --> -0.849995).  Saving model ...
Epoch: 15 cost time: 0.4325904846191406
Epoch: 15, Steps: 3 | Train Loss: 0.387 Vali Loss: 0.501 Vali Acc: 0.900 Test Loss: 0.501 Test Acc: 0.900
Validation loss decreased (-0.849995 --> -0.899995).  Saving model ...
Epoch: 16 cost time: 0.38213634490966797
Epoch: 16, Steps: 3 | Train Loss: 0.344 Vali Loss: 0.474 Vali Acc: 0.925 Test Loss: 0.474 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924995).  Saving model ...
Epoch: 17 cost time: 0.4281473159790039
Epoch: 17, Steps: 3 | Train Loss: 0.294 Vali Loss: 0.447 Vali Acc: 0.925 Test Loss: 0.447 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 18 cost time: 0.4444749355316162
Epoch: 18, Steps: 3 | Train Loss: 0.293 Vali Loss: 0.416 Vali Acc: 0.925 Test Loss: 0.416 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 19 cost time: 0.40789198875427246
Epoch: 19, Steps: 3 | Train Loss: 0.253 Vali Loss: 0.384 Vali Acc: 0.925 Test Loss: 0.384 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 20 cost time: 0.39385271072387695
Epoch: 20, Steps: 3 | Train Loss: 0.225 Vali Loss: 0.356 Vali Acc: 0.925 Test Loss: 0.356 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 21 cost time: 0.422471284866333
Epoch: 21, Steps: 3 | Train Loss: 0.230 Vali Loss: 0.340 Vali Acc: 0.925 Test Loss: 0.340 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924997).  Saving model ...
Epoch: 22 cost time: 0.41211390495300293
Epoch: 22, Steps: 3 | Train Loss: 0.203 Vali Loss: 0.318 Vali Acc: 0.950 Test Loss: 0.318 Test Acc: 0.950
Validation loss decreased (-0.924997 --> -0.949997).  Saving model ...
Epoch: 23 cost time: 0.47130393981933594
Epoch: 23, Steps: 3 | Train Loss: 0.206 Vali Loss: 0.296 Vali Acc: 0.950 Test Loss: 0.296 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 24 cost time: 0.4159107208251953
Epoch: 24, Steps: 3 | Train Loss: 0.174 Vali Loss: 0.282 Vali Acc: 0.950 Test Loss: 0.282 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 25 cost time: 0.43244314193725586
Epoch: 25, Steps: 3 | Train Loss: 0.177 Vali Loss: 0.271 Vali Acc: 0.950 Test Loss: 0.271 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 26 cost time: 0.39836955070495605
Epoch: 26, Steps: 3 | Train Loss: 0.145 Vali Loss: 0.262 Vali Acc: 0.950 Test Loss: 0.262 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 27 cost time: 0.4494137763977051
Epoch: 27, Steps: 3 | Train Loss: 0.121 Vali Loss: 0.245 Vali Acc: 0.950 Test Loss: 0.245 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 28 cost time: 0.4148595333099365
Epoch: 28, Steps: 3 | Train Loss: 0.131 Vali Loss: 0.239 Vali Acc: 0.950 Test Loss: 0.239 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 29 cost time: 0.41245198249816895
Epoch: 29, Steps: 3 | Train Loss: 0.106 Vali Loss: 0.226 Vali Acc: 0.950 Test Loss: 0.226 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 30 cost time: 0.4014263153076172
Epoch: 30, Steps: 3 | Train Loss: 0.095 Vali Loss: 0.219 Vali Acc: 0.950 Test Loss: 0.219 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 31 cost time: 0.45411205291748047
Epoch: 31, Steps: 3 | Train Loss: 0.080 Vali Loss: 0.215 Vali Acc: 0.950 Test Loss: 0.215 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 32 cost time: 0.4556851387023926
Epoch: 32, Steps: 3 | Train Loss: 0.081 Vali Loss: 0.208 Vali Acc: 0.950 Test Loss: 0.208 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 33 cost time: 0.40601634979248047
Epoch: 33, Steps: 3 | Train Loss: 0.081 Vali Loss: 0.203 Vali Acc: 0.950 Test Loss: 0.203 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 34 cost time: 0.4483957290649414
Epoch: 34, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.201 Vali Acc: 0.950 Test Loss: 0.201 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 35 cost time: 0.4447824954986572
Epoch: 35, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.195 Vali Acc: 0.975 Test Loss: 0.195 Test Acc: 0.975
Validation loss decreased (-0.949998 --> -0.974998).  Saving model ...
Epoch: 36 cost time: 0.43106865882873535
Epoch: 36, Steps: 3 | Train Loss: 0.061 Vali Loss: 0.189 Vali Acc: 0.975 Test Loss: 0.189 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 37 cost time: 0.4300696849822998
Epoch: 37, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.187 Vali Acc: 0.950 Test Loss: 0.187 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.4568042755126953
Epoch: 38, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.186 Vali Acc: 0.950 Test Loss: 0.186 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.45884037017822266
Epoch: 39, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.180 Vali Acc: 0.950 Test Loss: 0.180 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.47723817825317383
Epoch: 40, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.183 Vali Acc: 0.950 Test Loss: 0.183 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.4205806255340576
Epoch: 41, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.174 Vali Acc: 0.950 Test Loss: 0.174 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.42788171768188477
Epoch: 42, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.169 Vali Acc: 0.975 Test Loss: 0.169 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 43 cost time: 0.41864848136901855
Epoch: 43, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.162 Vali Acc: 0.975 Test Loss: 0.162 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 44 cost time: 0.42172765731811523
Epoch: 44, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.159 Vali Acc: 0.975 Test Loss: 0.159 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 45 cost time: 0.4402737617492676
Epoch: 45, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.155 Vali Acc: 0.975 Test Loss: 0.155 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 46 cost time: 0.43129634857177734
Epoch: 46, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.154 Vali Acc: 0.975 Test Loss: 0.154 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 47 cost time: 0.4168519973754883
Epoch: 47, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.156 Vali Acc: 0.975 Test Loss: 0.156 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.40375375747680664
Epoch: 48, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.156 Vali Acc: 0.975 Test Loss: 0.156 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.4466092586517334
Epoch: 49, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.157 Vali Acc: 0.975 Test Loss: 0.157 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.40564584732055664
Epoch: 50, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.147 Vali Acc: 0.975 Test Loss: 0.147 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974999).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps25_str13_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 1156356
model size : 4.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.682612657546997
Epoch: 1, Steps: 3 | Train Loss: 1.394 Vali Loss: 1.362 Vali Acc: 0.125 Test Loss: 1.362 Test Acc: 0.125
Validation loss decreased (inf --> -0.124986).  Saving model ...
Epoch: 2 cost time: 0.4354572296142578
Epoch: 2, Steps: 3 | Train Loss: 1.303 Vali Loss: 1.333 Vali Acc: 0.150 Test Loss: 1.333 Test Acc: 0.150
Validation loss decreased (-0.124986 --> -0.149987).  Saving model ...
Epoch: 3 cost time: 0.4195594787597656
Epoch: 3, Steps: 3 | Train Loss: 1.230 Vali Loss: 1.272 Vali Acc: 0.275 Test Loss: 1.272 Test Acc: 0.275
Validation loss decreased (-0.149987 --> -0.274987).  Saving model ...
Epoch: 4 cost time: 0.4186530113220215
Epoch: 4, Steps: 3 | Train Loss: 1.058 Vali Loss: 1.177 Vali Acc: 0.550 Test Loss: 1.177 Test Acc: 0.550
Validation loss decreased (-0.274987 --> -0.549988).  Saving model ...
Epoch: 5 cost time: 0.4302380084991455
Epoch: 5, Steps: 3 | Train Loss: 0.946 Vali Loss: 1.068 Vali Acc: 0.700 Test Loss: 1.068 Test Acc: 0.700
Validation loss decreased (-0.549988 --> -0.699989).  Saving model ...
Epoch: 6 cost time: 0.4018213748931885
Epoch: 6, Steps: 3 | Train Loss: 0.797 Vali Loss: 0.968 Vali Acc: 0.800 Test Loss: 0.968 Test Acc: 0.800
Validation loss decreased (-0.699989 --> -0.799990).  Saving model ...
Epoch: 7 cost time: 0.3870553970336914
Epoch: 7, Steps: 3 | Train Loss: 0.651 Vali Loss: 0.846 Vali Acc: 0.850 Test Loss: 0.846 Test Acc: 0.850
Validation loss decreased (-0.799990 --> -0.849992).  Saving model ...
Epoch: 8 cost time: 0.40573692321777344
Epoch: 8, Steps: 3 | Train Loss: 0.523 Vali Loss: 0.729 Vali Acc: 0.875 Test Loss: 0.729 Test Acc: 0.875
Validation loss decreased (-0.849992 --> -0.874993).  Saving model ...
Epoch: 9 cost time: 0.4363415241241455
Epoch: 9, Steps: 3 | Train Loss: 0.448 Vali Loss: 0.629 Vali Acc: 0.900 Test Loss: 0.629 Test Acc: 0.900
Validation loss decreased (-0.874993 --> -0.899994).  Saving model ...
Epoch: 10 cost time: 0.40537405014038086
Epoch: 10, Steps: 3 | Train Loss: 0.365 Vali Loss: 0.531 Vali Acc: 0.925 Test Loss: 0.531 Test Acc: 0.925
Validation loss decreased (-0.899994 --> -0.924995).  Saving model ...
Epoch: 11 cost time: 0.39963197708129883
Epoch: 11, Steps: 3 | Train Loss: 0.304 Vali Loss: 0.457 Vali Acc: 0.925 Test Loss: 0.457 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 12 cost time: 0.46079301834106445
Epoch: 12, Steps: 3 | Train Loss: 0.268 Vali Loss: 0.395 Vali Acc: 0.925 Test Loss: 0.395 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 13 cost time: 0.43100786209106445
Epoch: 13, Steps: 3 | Train Loss: 0.232 Vali Loss: 0.353 Vali Acc: 0.950 Test Loss: 0.353 Test Acc: 0.950
Validation loss decreased (-0.924996 --> -0.949996).  Saving model ...
Epoch: 14 cost time: 0.41614341735839844
Epoch: 14, Steps: 3 | Train Loss: 0.209 Vali Loss: 0.319 Vali Acc: 0.950 Test Loss: 0.319 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 15 cost time: 0.4142191410064697
Epoch: 15, Steps: 3 | Train Loss: 0.202 Vali Loss: 0.292 Vali Acc: 0.950 Test Loss: 0.292 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 16 cost time: 0.4072840213775635
Epoch: 16, Steps: 3 | Train Loss: 0.136 Vali Loss: 0.255 Vali Acc: 0.950 Test Loss: 0.255 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 17 cost time: 0.397266149520874
Epoch: 17, Steps: 3 | Train Loss: 0.113 Vali Loss: 0.232 Vali Acc: 0.950 Test Loss: 0.232 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 18 cost time: 0.44268226623535156
Epoch: 18, Steps: 3 | Train Loss: 0.136 Vali Loss: 0.219 Vali Acc: 0.950 Test Loss: 0.219 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 19 cost time: 0.4555857181549072
Epoch: 19, Steps: 3 | Train Loss: 0.100 Vali Loss: 0.213 Vali Acc: 0.950 Test Loss: 0.213 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 20 cost time: 0.41490793228149414
Epoch: 20, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.209 Vali Acc: 0.950 Test Loss: 0.209 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 21 cost time: 0.44751763343811035
Epoch: 21, Steps: 3 | Train Loss: 0.074 Vali Loss: 0.210 Vali Acc: 0.950 Test Loss: 0.210 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.4230234622955322
Epoch: 22, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.216 Vali Acc: 0.950 Test Loss: 0.216 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.45410919189453125
Epoch: 23, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.212 Vali Acc: 0.950 Test Loss: 0.212 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.4135415554046631
Epoch: 24, Steps: 3 | Train Loss: 0.042 Vali Loss: 0.216 Vali Acc: 0.950 Test Loss: 0.216 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.4400205612182617
Epoch: 25, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.224 Vali Acc: 0.950 Test Loss: 0.224 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.4507327079772949
Epoch: 26, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.220 Vali Acc: 0.950 Test Loss: 0.220 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.4664950370788574
Epoch: 27, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.223 Vali Acc: 0.950 Test Loss: 0.223 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.4241816997528076
Epoch: 28, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.228 Vali Acc: 0.950 Test Loss: 0.228 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.46559810638427734
Epoch: 29, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.232 Vali Acc: 0.950 Test Loss: 0.232 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.4516170024871826
Epoch: 30, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.231 Vali Acc: 0.950 Test Loss: 0.231 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 379140
model size : 1.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.5892035961151123
Epoch: 1, Steps: 3 | Train Loss: 1.396 Vali Loss: 1.350 Vali Acc: 0.375 Test Loss: 1.350 Test Acc: 0.375
Validation loss decreased (inf --> -0.374987).  Saving model ...
Epoch: 2 cost time: 0.40256786346435547
Epoch: 2, Steps: 3 | Train Loss: 1.274 Vali Loss: 1.308 Vali Acc: 0.475 Test Loss: 1.308 Test Acc: 0.475
Validation loss decreased (-0.374987 --> -0.474987).  Saving model ...
Epoch: 3 cost time: 0.39566516876220703
Epoch: 3, Steps: 3 | Train Loss: 1.220 Vali Loss: 1.248 Vali Acc: 0.475 Test Loss: 1.248 Test Acc: 0.475
Validation loss decreased (-0.474987 --> -0.474988).  Saving model ...
Epoch: 4 cost time: 0.3707737922668457
Epoch: 4, Steps: 3 | Train Loss: 1.132 Vali Loss: 1.170 Vali Acc: 0.550 Test Loss: 1.170 Test Acc: 0.550
Validation loss decreased (-0.474988 --> -0.549988).  Saving model ...
Epoch: 5 cost time: 0.3902151584625244
Epoch: 5, Steps: 3 | Train Loss: 1.005 Vali Loss: 1.079 Vali Acc: 0.600 Test Loss: 1.079 Test Acc: 0.600
Validation loss decreased (-0.549988 --> -0.599989).  Saving model ...
Epoch: 6 cost time: 0.411060094833374
Epoch: 6, Steps: 3 | Train Loss: 0.912 Vali Loss: 0.982 Vali Acc: 0.650 Test Loss: 0.982 Test Acc: 0.650
Validation loss decreased (-0.599989 --> -0.649990).  Saving model ...
Epoch: 7 cost time: 0.3942575454711914
Epoch: 7, Steps: 3 | Train Loss: 0.789 Vali Loss: 0.886 Vali Acc: 0.875 Test Loss: 0.886 Test Acc: 0.875
Validation loss decreased (-0.649990 --> -0.874991).  Saving model ...
Epoch: 8 cost time: 0.4468104839324951
Epoch: 8, Steps: 3 | Train Loss: 0.689 Vali Loss: 0.788 Vali Acc: 0.875 Test Loss: 0.788 Test Acc: 0.875
Validation loss decreased (-0.874991 --> -0.874992).  Saving model ...
Epoch: 9 cost time: 0.39307141304016113
Epoch: 9, Steps: 3 | Train Loss: 0.571 Vali Loss: 0.713 Vali Acc: 0.900 Test Loss: 0.713 Test Acc: 0.900
Validation loss decreased (-0.874992 --> -0.899993).  Saving model ...
Epoch: 10 cost time: 0.4524545669555664
Epoch: 10, Steps: 3 | Train Loss: 0.493 Vali Loss: 0.622 Vali Acc: 0.925 Test Loss: 0.622 Test Acc: 0.925
Validation loss decreased (-0.899993 --> -0.924994).  Saving model ...
Epoch: 11 cost time: 0.4097139835357666
Epoch: 11, Steps: 3 | Train Loss: 0.452 Vali Loss: 0.544 Vali Acc: 0.925 Test Loss: 0.544 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 12 cost time: 0.39478063583374023
Epoch: 12, Steps: 3 | Train Loss: 0.364 Vali Loss: 0.488 Vali Acc: 0.950 Test Loss: 0.488 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949995).  Saving model ...
Epoch: 13 cost time: 0.42545294761657715
Epoch: 13, Steps: 3 | Train Loss: 0.318 Vali Loss: 0.425 Vali Acc: 0.975 Test Loss: 0.425 Test Acc: 0.975
Validation loss decreased (-0.949995 --> -0.974996).  Saving model ...
Epoch: 14 cost time: 0.4405522346496582
Epoch: 14, Steps: 3 | Train Loss: 0.271 Vali Loss: 0.372 Vali Acc: 0.975 Test Loss: 0.372 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 15 cost time: 0.42476558685302734
Epoch: 15, Steps: 3 | Train Loss: 0.244 Vali Loss: 0.339 Vali Acc: 0.975 Test Loss: 0.339 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 16 cost time: 0.44788074493408203
Epoch: 16, Steps: 3 | Train Loss: 0.198 Vali Loss: 0.304 Vali Acc: 0.975 Test Loss: 0.304 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 17 cost time: 0.43862032890319824
Epoch: 17, Steps: 3 | Train Loss: 0.180 Vali Loss: 0.275 Vali Acc: 0.975 Test Loss: 0.275 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 18 cost time: 0.43973469734191895
Epoch: 18, Steps: 3 | Train Loss: 0.150 Vali Loss: 0.250 Vali Acc: 0.975 Test Loss: 0.250 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 19 cost time: 0.4322023391723633
Epoch: 19, Steps: 3 | Train Loss: 0.144 Vali Loss: 0.236 Vali Acc: 0.975 Test Loss: 0.236 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 20 cost time: 0.5086236000061035
Epoch: 20, Steps: 3 | Train Loss: 0.147 Vali Loss: 0.230 Vali Acc: 0.975 Test Loss: 0.230 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 21 cost time: 0.42975330352783203
Epoch: 21, Steps: 3 | Train Loss: 0.106 Vali Loss: 0.223 Vali Acc: 0.950 Test Loss: 0.223 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.40843725204467773
Epoch: 22, Steps: 3 | Train Loss: 0.115 Vali Loss: 0.222 Vali Acc: 0.950 Test Loss: 0.222 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.4344954490661621
Epoch: 23, Steps: 3 | Train Loss: 0.101 Vali Loss: 0.221 Vali Acc: 0.950 Test Loss: 0.221 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.42177581787109375
Epoch: 24, Steps: 3 | Train Loss: 0.089 Vali Loss: 0.223 Vali Acc: 0.950 Test Loss: 0.223 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.4114704132080078
Epoch: 25, Steps: 3 | Train Loss: 0.074 Vali Loss: 0.225 Vali Acc: 0.950 Test Loss: 0.225 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.453991174697876
Epoch: 26, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.215 Vali Acc: 0.950 Test Loss: 0.215 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.3904428482055664
Epoch: 27, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.211 Vali Acc: 0.950 Test Loss: 0.211 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.42665648460388184
Epoch: 28, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.210 Vali Acc: 0.950 Test Loss: 0.210 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.406252384185791
Epoch: 29, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.211 Vali Acc: 0.950 Test Loss: 0.211 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.3847322463989258
Epoch: 30, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.213 Vali Acc: 0.950 Test Loss: 0.213 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 354692
model size : 1.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.668090581893921
Epoch: 1, Steps: 3 | Train Loss: 1.429 Vali Loss: 1.360 Vali Acc: 0.200 Test Loss: 1.360 Test Acc: 0.200
Validation loss decreased (inf --> -0.199986).  Saving model ...
Epoch: 2 cost time: 0.4173145294189453
Epoch: 2, Steps: 3 | Train Loss: 1.385 Vali Loss: 1.335 Vali Acc: 0.200 Test Loss: 1.335 Test Acc: 0.200
Validation loss decreased (-0.199986 --> -0.199987).  Saving model ...
Epoch: 3 cost time: 0.42778992652893066
Epoch: 3, Steps: 3 | Train Loss: 1.301 Vali Loss: 1.293 Vali Acc: 0.225 Test Loss: 1.293 Test Acc: 0.225
Validation loss decreased (-0.199987 --> -0.224987).  Saving model ...
Epoch: 4 cost time: 0.38666629791259766
Epoch: 4, Steps: 3 | Train Loss: 1.188 Vali Loss: 1.236 Vali Acc: 0.425 Test Loss: 1.236 Test Acc: 0.425
Validation loss decreased (-0.224987 --> -0.424988).  Saving model ...
Epoch: 5 cost time: 0.3937690258026123
Epoch: 5, Steps: 3 | Train Loss: 1.104 Vali Loss: 1.165 Vali Acc: 0.750 Test Loss: 1.165 Test Acc: 0.750
Validation loss decreased (-0.424988 --> -0.749988).  Saving model ...
Epoch: 6 cost time: 0.4438488483428955
Epoch: 6, Steps: 3 | Train Loss: 0.981 Vali Loss: 1.080 Vali Acc: 0.800 Test Loss: 1.080 Test Acc: 0.800
Validation loss decreased (-0.749988 --> -0.799989).  Saving model ...
Epoch: 7 cost time: 0.43676018714904785
Epoch: 7, Steps: 3 | Train Loss: 0.872 Vali Loss: 0.996 Vali Acc: 0.825 Test Loss: 0.996 Test Acc: 0.825
Validation loss decreased (-0.799989 --> -0.824990).  Saving model ...
Epoch: 8 cost time: 0.3738241195678711
Epoch: 8, Steps: 3 | Train Loss: 0.788 Vali Loss: 0.899 Vali Acc: 0.900 Test Loss: 0.899 Test Acc: 0.900
Validation loss decreased (-0.824990 --> -0.899991).  Saving model ...
Epoch: 9 cost time: 0.4410440921783447
Epoch: 9, Steps: 3 | Train Loss: 0.683 Vali Loss: 0.818 Vali Acc: 0.925 Test Loss: 0.818 Test Acc: 0.925
Validation loss decreased (-0.899991 --> -0.924992).  Saving model ...
Epoch: 10 cost time: 0.377901554107666
Epoch: 10, Steps: 3 | Train Loss: 0.594 Vali Loss: 0.729 Vali Acc: 0.925 Test Loss: 0.729 Test Acc: 0.925
Validation loss decreased (-0.924992 --> -0.924993).  Saving model ...
Epoch: 11 cost time: 0.38765621185302734
Epoch: 11, Steps: 3 | Train Loss: 0.528 Vali Loss: 0.649 Vali Acc: 0.950 Test Loss: 0.649 Test Acc: 0.950
Validation loss decreased (-0.924993 --> -0.949994).  Saving model ...
Epoch: 12 cost time: 0.47120118141174316
Epoch: 12, Steps: 3 | Train Loss: 0.466 Vali Loss: 0.589 Vali Acc: 0.950 Test Loss: 0.589 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949994).  Saving model ...
Epoch: 13 cost time: 0.40824151039123535
Epoch: 13, Steps: 3 | Train Loss: 0.404 Vali Loss: 0.526 Vali Acc: 0.950 Test Loss: 0.526 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 14 cost time: 0.408811092376709
Epoch: 14, Steps: 3 | Train Loss: 0.371 Vali Loss: 0.478 Vali Acc: 0.950 Test Loss: 0.478 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 15 cost time: 0.38698744773864746
Epoch: 15, Steps: 3 | Train Loss: 0.319 Vali Loss: 0.424 Vali Acc: 0.950 Test Loss: 0.424 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 16 cost time: 0.4052293300628662
Epoch: 16, Steps: 3 | Train Loss: 0.283 Vali Loss: 0.387 Vali Acc: 0.950 Test Loss: 0.387 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 17 cost time: 0.38994646072387695
Epoch: 17, Steps: 3 | Train Loss: 0.273 Vali Loss: 0.356 Vali Acc: 0.925 Test Loss: 0.356 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.38603734970092773
Epoch: 18, Steps: 3 | Train Loss: 0.236 Vali Loss: 0.339 Vali Acc: 0.950 Test Loss: 0.339 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 19 cost time: 0.41938328742980957
Epoch: 19, Steps: 3 | Train Loss: 0.199 Vali Loss: 0.313 Vali Acc: 0.950 Test Loss: 0.313 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 20 cost time: 0.4355742931365967
Epoch: 20, Steps: 3 | Train Loss: 0.186 Vali Loss: 0.302 Vali Acc: 0.950 Test Loss: 0.302 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 21 cost time: 0.369617223739624
Epoch: 21, Steps: 3 | Train Loss: 0.169 Vali Loss: 0.299 Vali Acc: 0.950 Test Loss: 0.299 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 22 cost time: 0.49428820610046387
Epoch: 22, Steps: 3 | Train Loss: 0.168 Vali Loss: 0.276 Vali Acc: 0.975 Test Loss: 0.276 Test Acc: 0.975
Validation loss decreased (-0.949997 --> -0.974997).  Saving model ...
Epoch: 23 cost time: 0.42710185050964355
Epoch: 23, Steps: 3 | Train Loss: 0.142 Vali Loss: 0.252 Vali Acc: 0.975 Test Loss: 0.252 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 24 cost time: 0.3468663692474365
Epoch: 24, Steps: 3 | Train Loss: 0.128 Vali Loss: 0.243 Vali Acc: 0.975 Test Loss: 0.243 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 25 cost time: 0.4578845500946045
Epoch: 25, Steps: 3 | Train Loss: 0.116 Vali Loss: 0.230 Vali Acc: 0.975 Test Loss: 0.230 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 26 cost time: 0.38027048110961914
Epoch: 26, Steps: 3 | Train Loss: 0.123 Vali Loss: 0.221 Vali Acc: 0.975 Test Loss: 0.221 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 27 cost time: 0.42060112953186035
Epoch: 27, Steps: 3 | Train Loss: 0.098 Vali Loss: 0.210 Vali Acc: 0.975 Test Loss: 0.210 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 28 cost time: 0.45871829986572266
Epoch: 28, Steps: 3 | Train Loss: 0.094 Vali Loss: 0.205 Vali Acc: 0.975 Test Loss: 0.205 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 29 cost time: 0.3985283374786377
Epoch: 29, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.188 Vali Acc: 0.975 Test Loss: 0.188 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 30 cost time: 0.4258906841278076
Epoch: 30, Steps: 3 | Train Loss: 0.075 Vali Loss: 0.180 Vali Acc: 0.975 Test Loss: 0.180 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 31 cost time: 0.4199061393737793
Epoch: 31, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.179 Vali Acc: 0.975 Test Loss: 0.179 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 32 cost time: 0.37699103355407715
Epoch: 32, Steps: 3 | Train Loss: 0.058 Vali Loss: 0.171 Vali Acc: 0.975 Test Loss: 0.171 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 33 cost time: 0.3903043270111084
Epoch: 33, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.160 Vali Acc: 0.975 Test Loss: 0.160 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 34 cost time: 0.3840305805206299
Epoch: 34, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.158 Vali Acc: 0.975 Test Loss: 0.158 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 35 cost time: 0.35242199897766113
Epoch: 35, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.161 Vali Acc: 0.975 Test Loss: 0.161 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.4429209232330322
Epoch: 36, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.150 Vali Acc: 0.950 Test Loss: 0.150 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.3897702693939209
Epoch: 37, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.145 Vali Acc: 0.950 Test Loss: 0.145 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.395465612411499
Epoch: 38, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.138 Vali Acc: 0.950 Test Loss: 0.138 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.3673548698425293
Epoch: 39, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.129 Vali Acc: 0.950 Test Loss: 0.129 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.41537904739379883
Epoch: 40, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.122 Vali Acc: 0.950 Test Loss: 0.122 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.39435648918151855
Epoch: 41, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.115 Vali Acc: 0.950 Test Loss: 0.115 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.3894193172454834
Epoch: 42, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.114 Vali Acc: 0.950 Test Loss: 0.114 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.40106916427612305
Epoch: 43, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.114 Vali Acc: 0.950 Test Loss: 0.114 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.40545201301574707
Epoch: 44, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.115 Vali Acc: 0.950 Test Loss: 0.115 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 342596
model size : 1.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.5491275787353516
Epoch: 1, Steps: 3 | Train Loss: 1.392 Vali Loss: 1.330 Vali Acc: 0.175 Test Loss: 1.330 Test Acc: 0.175
Validation loss decreased (inf --> -0.174987).  Saving model ...
Epoch: 2 cost time: 0.405895471572876
Epoch: 2, Steps: 3 | Train Loss: 1.309 Vali Loss: 1.309 Vali Acc: 0.200 Test Loss: 1.309 Test Acc: 0.200
Validation loss decreased (-0.174987 --> -0.199987).  Saving model ...
Epoch: 3 cost time: 0.4277613162994385
Epoch: 3, Steps: 3 | Train Loss: 1.273 Vali Loss: 1.274 Vali Acc: 0.200 Test Loss: 1.274 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199987).  Saving model ...
Epoch: 4 cost time: 0.3923523426055908
Epoch: 4, Steps: 3 | Train Loss: 1.187 Vali Loss: 1.228 Vali Acc: 0.300 Test Loss: 1.228 Test Acc: 0.300
Validation loss decreased (-0.199987 --> -0.299988).  Saving model ...
Epoch: 5 cost time: 0.43660926818847656
Epoch: 5, Steps: 3 | Train Loss: 1.122 Vali Loss: 1.172 Vali Acc: 0.450 Test Loss: 1.172 Test Acc: 0.450
Validation loss decreased (-0.299988 --> -0.449988).  Saving model ...
Epoch: 6 cost time: 0.4340667724609375
Epoch: 6, Steps: 3 | Train Loss: 1.038 Vali Loss: 1.111 Vali Acc: 0.500 Test Loss: 1.111 Test Acc: 0.500
Validation loss decreased (-0.449988 --> -0.499989).  Saving model ...
Epoch: 7 cost time: 0.4530758857727051
Epoch: 7, Steps: 3 | Train Loss: 0.951 Vali Loss: 1.042 Vali Acc: 0.550 Test Loss: 1.042 Test Acc: 0.550
Validation loss decreased (-0.499989 --> -0.549990).  Saving model ...
Epoch: 8 cost time: 0.39837074279785156
Epoch: 8, Steps: 3 | Train Loss: 0.874 Vali Loss: 0.967 Vali Acc: 0.675 Test Loss: 0.967 Test Acc: 0.675
Validation loss decreased (-0.549990 --> -0.674990).  Saving model ...
Epoch: 9 cost time: 0.41021251678466797
Epoch: 9, Steps: 3 | Train Loss: 0.774 Vali Loss: 0.893 Vali Acc: 0.775 Test Loss: 0.893 Test Acc: 0.775
Validation loss decreased (-0.674990 --> -0.774991).  Saving model ...
Epoch: 10 cost time: 0.407179594039917
Epoch: 10, Steps: 3 | Train Loss: 0.693 Vali Loss: 0.815 Vali Acc: 0.875 Test Loss: 0.815 Test Acc: 0.875
Validation loss decreased (-0.774991 --> -0.874992).  Saving model ...
Epoch: 11 cost time: 0.404827356338501
Epoch: 11, Steps: 3 | Train Loss: 0.627 Vali Loss: 0.746 Vali Acc: 0.925 Test Loss: 0.746 Test Acc: 0.925
Validation loss decreased (-0.874992 --> -0.924993).  Saving model ...
Epoch: 12 cost time: 0.38751959800720215
Epoch: 12, Steps: 3 | Train Loss: 0.559 Vali Loss: 0.689 Vali Acc: 0.950 Test Loss: 0.689 Test Acc: 0.950
Validation loss decreased (-0.924993 --> -0.949993).  Saving model ...
Epoch: 13 cost time: 0.5131754875183105
Epoch: 13, Steps: 3 | Train Loss: 0.497 Vali Loss: 0.624 Vali Acc: 0.975 Test Loss: 0.624 Test Acc: 0.975
Validation loss decreased (-0.949993 --> -0.974994).  Saving model ...
Epoch: 14 cost time: 0.40616679191589355
Epoch: 14, Steps: 3 | Train Loss: 0.432 Vali Loss: 0.582 Vali Acc: 0.975 Test Loss: 0.582 Test Acc: 0.975
Validation loss decreased (-0.974994 --> -0.974994).  Saving model ...
Epoch: 15 cost time: 0.3718075752258301
Epoch: 15, Steps: 3 | Train Loss: 0.384 Vali Loss: 0.521 Vali Acc: 0.975 Test Loss: 0.521 Test Acc: 0.975
Validation loss decreased (-0.974994 --> -0.974995).  Saving model ...
Epoch: 16 cost time: 0.44951868057250977
Epoch: 16, Steps: 3 | Train Loss: 0.369 Vali Loss: 0.470 Vali Acc: 0.975 Test Loss: 0.470 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 17 cost time: 0.37558650970458984
Epoch: 17, Steps: 3 | Train Loss: 0.313 Vali Loss: 0.429 Vali Acc: 0.975 Test Loss: 0.429 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 18 cost time: 0.39750242233276367
Epoch: 18, Steps: 3 | Train Loss: 0.293 Vali Loss: 0.402 Vali Acc: 0.975 Test Loss: 0.402 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 19 cost time: 0.37554121017456055
Epoch: 19, Steps: 3 | Train Loss: 0.265 Vali Loss: 0.375 Vali Acc: 0.975 Test Loss: 0.375 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 20 cost time: 0.37448930740356445
Epoch: 20, Steps: 3 | Train Loss: 0.240 Vali Loss: 0.351 Vali Acc: 0.950 Test Loss: 0.351 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.38677144050598145
Epoch: 21, Steps: 3 | Train Loss: 0.222 Vali Loss: 0.324 Vali Acc: 0.950 Test Loss: 0.324 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.45070719718933105
Epoch: 22, Steps: 3 | Train Loss: 0.236 Vali Loss: 0.308 Vali Acc: 0.950 Test Loss: 0.308 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.3869130611419678
Epoch: 23, Steps: 3 | Train Loss: 0.197 Vali Loss: 0.291 Vali Acc: 0.975 Test Loss: 0.291 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 24 cost time: 0.4181196689605713
Epoch: 24, Steps: 3 | Train Loss: 0.182 Vali Loss: 0.283 Vali Acc: 0.975 Test Loss: 0.283 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 25 cost time: 0.44312119483947754
Epoch: 25, Steps: 3 | Train Loss: 0.168 Vali Loss: 0.269 Vali Acc: 0.975 Test Loss: 0.269 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 26 cost time: 0.41965460777282715
Epoch: 26, Steps: 3 | Train Loss: 0.141 Vali Loss: 0.262 Vali Acc: 0.975 Test Loss: 0.262 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 27 cost time: 0.39662814140319824
Epoch: 27, Steps: 3 | Train Loss: 0.156 Vali Loss: 0.253 Vali Acc: 0.975 Test Loss: 0.253 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 28 cost time: 0.42721080780029297
Epoch: 28, Steps: 3 | Train Loss: 0.137 Vali Loss: 0.241 Vali Acc: 0.975 Test Loss: 0.241 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 29 cost time: 0.4010653495788574
Epoch: 29, Steps: 3 | Train Loss: 0.115 Vali Loss: 0.222 Vali Acc: 0.975 Test Loss: 0.222 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 30 cost time: 0.39447021484375
Epoch: 30, Steps: 3 | Train Loss: 0.115 Vali Loss: 0.214 Vali Acc: 0.975 Test Loss: 0.214 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 31 cost time: 0.44864988327026367
Epoch: 31, Steps: 3 | Train Loss: 0.104 Vali Loss: 0.213 Vali Acc: 0.975 Test Loss: 0.213 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 32 cost time: 0.3916940689086914
Epoch: 32, Steps: 3 | Train Loss: 0.093 Vali Loss: 0.207 Vali Acc: 0.975 Test Loss: 0.207 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 33 cost time: 0.4019942283630371
Epoch: 33, Steps: 3 | Train Loss: 0.087 Vali Loss: 0.202 Vali Acc: 0.975 Test Loss: 0.202 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 34 cost time: 0.40507078170776367
Epoch: 34, Steps: 3 | Train Loss: 0.079 Vali Loss: 0.196 Vali Acc: 0.975 Test Loss: 0.196 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 35 cost time: 0.4498417377471924
Epoch: 35, Steps: 3 | Train Loss: 0.068 Vali Loss: 0.189 Vali Acc: 0.975 Test Loss: 0.189 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 36 cost time: 0.40274524688720703
Epoch: 36, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.177 Vali Acc: 0.975 Test Loss: 0.177 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 37 cost time: 0.4382483959197998
Epoch: 37, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.172 Vali Acc: 0.975 Test Loss: 0.172 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 38 cost time: 0.38605785369873047
Epoch: 38, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.167 Vali Acc: 0.950 Test Loss: 0.167 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.3995382785797119
Epoch: 39, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.167 Vali Acc: 0.950 Test Loss: 0.167 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.41443371772766113
Epoch: 40, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.164 Vali Acc: 0.950 Test Loss: 0.164 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.37590742111206055
Epoch: 41, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.157 Vali Acc: 0.950 Test Loss: 0.157 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.47437357902526855
Epoch: 42, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.152 Vali Acc: 0.950 Test Loss: 0.152 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.42401742935180664
Epoch: 43, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.155 Vali Acc: 0.950 Test Loss: 0.155 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.40757298469543457
Epoch: 44, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.154 Vali Acc: 0.950 Test Loss: 0.154 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.4706454277038574
Epoch: 45, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.160 Vali Acc: 0.950 Test Loss: 0.160 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.4182157516479492
Epoch: 46, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.158 Vali Acc: 0.950 Test Loss: 0.158 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.39879798889160156
Epoch: 47, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.154 Vali Acc: 0.950 Test Loss: 0.154 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 333508
model size : 1.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.6691408157348633
Epoch: 1, Steps: 3 | Train Loss: 1.356 Vali Loss: 1.332 Vali Acc: 0.300 Test Loss: 1.332 Test Acc: 0.300
Validation loss decreased (inf --> -0.299987).  Saving model ...
Epoch: 2 cost time: 0.37574195861816406
Epoch: 2, Steps: 3 | Train Loss: 1.332 Vali Loss: 1.314 Vali Acc: 0.300 Test Loss: 1.314 Test Acc: 0.300
Validation loss decreased (-0.299987 --> -0.299987).  Saving model ...
Epoch: 3 cost time: 0.3832736015319824
Epoch: 3, Steps: 3 | Train Loss: 1.298 Vali Loss: 1.289 Vali Acc: 0.375 Test Loss: 1.289 Test Acc: 0.375
Validation loss decreased (-0.299987 --> -0.374987).  Saving model ...
Epoch: 4 cost time: 0.3749115467071533
Epoch: 4, Steps: 3 | Train Loss: 1.233 Vali Loss: 1.256 Vali Acc: 0.425 Test Loss: 1.256 Test Acc: 0.425
Validation loss decreased (-0.374987 --> -0.424987).  Saving model ...
Epoch: 5 cost time: 0.43816542625427246
Epoch: 5, Steps: 3 | Train Loss: 1.192 Vali Loss: 1.214 Vali Acc: 0.525 Test Loss: 1.214 Test Acc: 0.525
Validation loss decreased (-0.424987 --> -0.524988).  Saving model ...
Epoch: 6 cost time: 0.4122769832611084
Epoch: 6, Steps: 3 | Train Loss: 1.092 Vali Loss: 1.166 Vali Acc: 0.675 Test Loss: 1.166 Test Acc: 0.675
Validation loss decreased (-0.524988 --> -0.674988).  Saving model ...
Epoch: 7 cost time: 0.43535757064819336
Epoch: 7, Steps: 3 | Train Loss: 1.050 Vali Loss: 1.116 Vali Acc: 0.775 Test Loss: 1.116 Test Acc: 0.775
Validation loss decreased (-0.674988 --> -0.774989).  Saving model ...
Epoch: 8 cost time: 0.3873579502105713
Epoch: 8, Steps: 3 | Train Loss: 0.998 Vali Loss: 1.063 Vali Acc: 0.775 Test Loss: 1.063 Test Acc: 0.775
Validation loss decreased (-0.774989 --> -0.774989).  Saving model ...
Epoch: 9 cost time: 0.4062199592590332
Epoch: 9, Steps: 3 | Train Loss: 0.929 Vali Loss: 1.003 Vali Acc: 0.850 Test Loss: 1.003 Test Acc: 0.850
Validation loss decreased (-0.774989 --> -0.849990).  Saving model ...
Epoch: 10 cost time: 0.44782423973083496
Epoch: 10, Steps: 3 | Train Loss: 0.859 Vali Loss: 0.947 Vali Acc: 0.850 Test Loss: 0.947 Test Acc: 0.850
Validation loss decreased (-0.849990 --> -0.849991).  Saving model ...
Epoch: 11 cost time: 0.41947436332702637
Epoch: 11, Steps: 3 | Train Loss: 0.787 Vali Loss: 0.895 Vali Acc: 0.850 Test Loss: 0.895 Test Acc: 0.850
Validation loss decreased (-0.849991 --> -0.849991).  Saving model ...
Epoch: 12 cost time: 0.4568827152252197
Epoch: 12, Steps: 3 | Train Loss: 0.701 Vali Loss: 0.833 Vali Acc: 0.875 Test Loss: 0.833 Test Acc: 0.875
Validation loss decreased (-0.849991 --> -0.874992).  Saving model ...
Epoch: 13 cost time: 0.4198331832885742
Epoch: 13, Steps: 3 | Train Loss: 0.659 Vali Loss: 0.783 Vali Acc: 0.900 Test Loss: 0.783 Test Acc: 0.900
Validation loss decreased (-0.874992 --> -0.899992).  Saving model ...
Epoch: 14 cost time: 0.4047689437866211
Epoch: 14, Steps: 3 | Train Loss: 0.629 Vali Loss: 0.730 Vali Acc: 0.900 Test Loss: 0.730 Test Acc: 0.900
Validation loss decreased (-0.899992 --> -0.899993).  Saving model ...
Epoch: 15 cost time: 0.50972580909729
Epoch: 15, Steps: 3 | Train Loss: 0.567 Vali Loss: 0.690 Vali Acc: 0.900 Test Loss: 0.690 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 16 cost time: 0.4434788227081299
Epoch: 16, Steps: 3 | Train Loss: 0.511 Vali Loss: 0.648 Vali Acc: 0.900 Test Loss: 0.648 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899994).  Saving model ...
Epoch: 17 cost time: 0.44957780838012695
Epoch: 17, Steps: 3 | Train Loss: 0.481 Vali Loss: 0.600 Vali Acc: 0.900 Test Loss: 0.600 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 18 cost time: 0.4322545528411865
Epoch: 18, Steps: 3 | Train Loss: 0.425 Vali Loss: 0.564 Vali Acc: 0.900 Test Loss: 0.564 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 19 cost time: 0.44219350814819336
Epoch: 19, Steps: 3 | Train Loss: 0.388 Vali Loss: 0.534 Vali Acc: 0.900 Test Loss: 0.534 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 20 cost time: 0.44484949111938477
Epoch: 20, Steps: 3 | Train Loss: 0.362 Vali Loss: 0.518 Vali Acc: 0.925 Test Loss: 0.518 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924995).  Saving model ...
Epoch: 21 cost time: 0.4598267078399658
Epoch: 21, Steps: 3 | Train Loss: 0.388 Vali Loss: 0.488 Vali Acc: 0.925 Test Loss: 0.488 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 22 cost time: 0.4290196895599365
Epoch: 22, Steps: 3 | Train Loss: 0.309 Vali Loss: 0.475 Vali Acc: 0.925 Test Loss: 0.475 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 23 cost time: 0.4802091121673584
Epoch: 23, Steps: 3 | Train Loss: 0.284 Vali Loss: 0.435 Vali Acc: 0.950 Test Loss: 0.435 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949996).  Saving model ...
Epoch: 24 cost time: 0.46114158630371094
Epoch: 24, Steps: 3 | Train Loss: 0.302 Vali Loss: 0.396 Vali Acc: 0.950 Test Loss: 0.396 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 25 cost time: 0.4486246109008789
Epoch: 25, Steps: 3 | Train Loss: 0.248 Vali Loss: 0.374 Vali Acc: 0.950 Test Loss: 0.374 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 26 cost time: 0.42990541458129883
Epoch: 26, Steps: 3 | Train Loss: 0.249 Vali Loss: 0.356 Vali Acc: 0.950 Test Loss: 0.356 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 27 cost time: 0.43668127059936523
Epoch: 27, Steps: 3 | Train Loss: 0.245 Vali Loss: 0.337 Vali Acc: 0.975 Test Loss: 0.337 Test Acc: 0.975
Validation loss decreased (-0.949996 --> -0.974997).  Saving model ...
Epoch: 28 cost time: 0.37764406204223633
Epoch: 28, Steps: 3 | Train Loss: 0.221 Vali Loss: 0.333 Vali Acc: 0.975 Test Loss: 0.333 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 29 cost time: 0.44865918159484863
Epoch: 29, Steps: 3 | Train Loss: 0.214 Vali Loss: 0.315 Vali Acc: 0.975 Test Loss: 0.315 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 30 cost time: 0.4129948616027832
Epoch: 30, Steps: 3 | Train Loss: 0.190 Vali Loss: 0.304 Vali Acc: 0.975 Test Loss: 0.304 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 31 cost time: 0.39099860191345215
Epoch: 31, Steps: 3 | Train Loss: 0.154 Vali Loss: 0.295 Vali Acc: 0.975 Test Loss: 0.295 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 32 cost time: 0.42275333404541016
Epoch: 32, Steps: 3 | Train Loss: 0.165 Vali Loss: 0.288 Vali Acc: 0.975 Test Loss: 0.288 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 33 cost time: 0.387805700302124
Epoch: 33, Steps: 3 | Train Loss: 0.175 Vali Loss: 0.280 Vali Acc: 0.975 Test Loss: 0.280 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 34 cost time: 0.4278128147125244
Epoch: 34, Steps: 3 | Train Loss: 0.149 Vali Loss: 0.279 Vali Acc: 0.975 Test Loss: 0.279 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 35 cost time: 0.38561344146728516
Epoch: 35, Steps: 3 | Train Loss: 0.132 Vali Loss: 0.272 Vali Acc: 0.975 Test Loss: 0.272 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 36 cost time: 0.44651174545288086
Epoch: 36, Steps: 3 | Train Loss: 0.130 Vali Loss: 0.259 Vali Acc: 0.975 Test Loss: 0.259 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 37 cost time: 0.40414857864379883
Epoch: 37, Steps: 3 | Train Loss: 0.116 Vali Loss: 0.253 Vali Acc: 0.975 Test Loss: 0.253 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 38 cost time: 0.42647695541381836
Epoch: 38, Steps: 3 | Train Loss: 0.127 Vali Loss: 0.249 Vali Acc: 0.975 Test Loss: 0.249 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 39 cost time: 0.39655590057373047
Epoch: 39, Steps: 3 | Train Loss: 0.094 Vali Loss: 0.234 Vali Acc: 0.975 Test Loss: 0.234 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 40 cost time: 0.38205885887145996
Epoch: 40, Steps: 3 | Train Loss: 0.102 Vali Loss: 0.228 Vali Acc: 0.975 Test Loss: 0.228 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 41 cost time: 0.41614222526550293
Epoch: 41, Steps: 3 | Train Loss: 0.091 Vali Loss: 0.232 Vali Acc: 0.950 Test Loss: 0.232 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.395843505859375
Epoch: 42, Steps: 3 | Train Loss: 0.080 Vali Loss: 0.228 Vali Acc: 0.950 Test Loss: 0.228 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.43261289596557617
Epoch: 43, Steps: 3 | Train Loss: 0.085 Vali Loss: 0.229 Vali Acc: 0.950 Test Loss: 0.229 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.5176002979278564
Epoch: 44, Steps: 3 | Train Loss: 0.078 Vali Loss: 0.222 Vali Acc: 0.950 Test Loss: 0.222 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.44626688957214355
Epoch: 45, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.211 Vali Acc: 0.950 Test Loss: 0.211 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.3560912609100342
Epoch: 46, Steps: 3 | Train Loss: 0.062 Vali Loss: 0.208 Vali Acc: 0.950 Test Loss: 0.208 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.3944683074951172
Epoch: 47, Steps: 3 | Train Loss: 0.062 Vali Loss: 0.202 Vali Acc: 0.950 Test Loss: 0.202 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 0.40171098709106445
Epoch: 48, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.204 Vali Acc: 0.950 Test Loss: 0.204 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 0.3954181671142578
Epoch: 49, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.202 Vali Acc: 0.950 Test Loss: 0.202 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 0.42587780952453613
Epoch: 50, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.198 Vali Acc: 0.950 Test Loss: 0.198 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 321540
model size : 1.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps20_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.5737640857696533
Epoch: 1, Steps: 3 | Train Loss: 1.342 Vali Loss: 1.348 Vali Acc: 0.200 Test Loss: 1.348 Test Acc: 0.200
Validation loss decreased (inf --> -0.199987).  Saving model ...
Epoch: 2 cost time: 0.42527294158935547
Epoch: 2, Steps: 3 | Train Loss: 1.336 Vali Loss: 1.329 Vali Acc: 0.250 Test Loss: 1.329 Test Acc: 0.250
Validation loss decreased (-0.199987 --> -0.249987).  Saving model ...
Epoch: 3 cost time: 0.48236775398254395
Epoch: 3, Steps: 3 | Train Loss: 1.275 Vali Loss: 1.306 Vali Acc: 0.325 Test Loss: 1.306 Test Acc: 0.325
Validation loss decreased (-0.249987 --> -0.324987).  Saving model ...
Epoch: 4 cost time: 0.4091036319732666
Epoch: 4, Steps: 3 | Train Loss: 1.238 Vali Loss: 1.274 Vali Acc: 0.475 Test Loss: 1.274 Test Acc: 0.475
Validation loss decreased (-0.324987 --> -0.474987).  Saving model ...
Epoch: 5 cost time: 0.39531469345092773
Epoch: 5, Steps: 3 | Train Loss: 1.186 Vali Loss: 1.238 Vali Acc: 0.650 Test Loss: 1.238 Test Acc: 0.650
Validation loss decreased (-0.474987 --> -0.649988).  Saving model ...
Epoch: 6 cost time: 0.42419958114624023
Epoch: 6, Steps: 3 | Train Loss: 1.143 Vali Loss: 1.194 Vali Acc: 0.650 Test Loss: 1.194 Test Acc: 0.650
Validation loss decreased (-0.649988 --> -0.649988).  Saving model ...
Epoch: 7 cost time: 0.40092897415161133
Epoch: 7, Steps: 3 | Train Loss: 1.088 Vali Loss: 1.142 Vali Acc: 0.775 Test Loss: 1.142 Test Acc: 0.775
Validation loss decreased (-0.649988 --> -0.774989).  Saving model ...
Epoch: 8 cost time: 0.41400146484375
Epoch: 8, Steps: 3 | Train Loss: 1.009 Vali Loss: 1.090 Vali Acc: 0.700 Test Loss: 1.090 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.393543004989624
Epoch: 9, Steps: 3 | Train Loss: 0.966 Vali Loss: 1.033 Vali Acc: 0.650 Test Loss: 1.033 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.43021178245544434
Epoch: 10, Steps: 3 | Train Loss: 0.877 Vali Loss: 0.980 Vali Acc: 0.675 Test Loss: 0.980 Test Acc: 0.675
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.3740239143371582
Epoch: 11, Steps: 3 | Train Loss: 0.827 Vali Loss: 0.930 Vali Acc: 0.725 Test Loss: 0.930 Test Acc: 0.725
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.5037882328033447
Epoch: 12, Steps: 3 | Train Loss: 0.781 Vali Loss: 0.881 Vali Acc: 0.750 Test Loss: 0.881 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.4511425495147705
Epoch: 13, Steps: 3 | Train Loss: 0.732 Vali Loss: 0.831 Vali Acc: 0.825 Test Loss: 0.831 Test Acc: 0.825
Validation loss decreased (-0.774989 --> -0.824992).  Saving model ...
Epoch: 14 cost time: 0.42825794219970703
Epoch: 14, Steps: 3 | Train Loss: 0.674 Vali Loss: 0.790 Vali Acc: 0.925 Test Loss: 0.790 Test Acc: 0.925
Validation loss decreased (-0.824992 --> -0.924992).  Saving model ...
Epoch: 15 cost time: 0.4006783962249756
Epoch: 15, Steps: 3 | Train Loss: 0.643 Vali Loss: 0.754 Vali Acc: 0.900 Test Loss: 0.754 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.3917086124420166
Epoch: 16, Steps: 3 | Train Loss: 0.598 Vali Loss: 0.703 Vali Acc: 0.900 Test Loss: 0.703 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.4074819087982178
Epoch: 17, Steps: 3 | Train Loss: 0.564 Vali Loss: 0.665 Vali Acc: 0.875 Test Loss: 0.665 Test Acc: 0.875
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.42670440673828125
Epoch: 18, Steps: 3 | Train Loss: 0.525 Vali Loss: 0.636 Vali Acc: 0.875 Test Loss: 0.636 Test Acc: 0.875
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.3941357135772705
Epoch: 19, Steps: 3 | Train Loss: 0.461 Vali Loss: 0.610 Vali Acc: 0.900 Test Loss: 0.610 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.3932316303253174
Epoch: 20, Steps: 3 | Train Loss: 0.446 Vali Loss: 0.580 Vali Acc: 0.900 Test Loss: 0.580 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.3924679756164551
Epoch: 21, Steps: 3 | Train Loss: 0.408 Vali Loss: 0.558 Vali Acc: 0.925 Test Loss: 0.558 Test Acc: 0.925
Validation loss decreased (-0.924992 --> -0.924994).  Saving model ...
Epoch: 22 cost time: 0.3901479244232178
Epoch: 22, Steps: 3 | Train Loss: 0.387 Vali Loss: 0.544 Vali Acc: 0.900 Test Loss: 0.544 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.40098142623901367
Epoch: 23, Steps: 3 | Train Loss: 0.365 Vali Loss: 0.514 Vali Acc: 0.925 Test Loss: 0.514 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 24 cost time: 0.40163421630859375
Epoch: 24, Steps: 3 | Train Loss: 0.362 Vali Loss: 0.487 Vali Acc: 0.900 Test Loss: 0.487 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.40062642097473145
Epoch: 25, Steps: 3 | Train Loss: 0.327 Vali Loss: 0.477 Vali Acc: 0.925 Test Loss: 0.477 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 26 cost time: 0.3726799488067627
Epoch: 26, Steps: 3 | Train Loss: 0.316 Vali Loss: 0.464 Vali Acc: 0.925 Test Loss: 0.464 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 27 cost time: 0.383007287979126
Epoch: 27, Steps: 3 | Train Loss: 0.317 Vali Loss: 0.441 Vali Acc: 0.925 Test Loss: 0.441 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 28 cost time: 0.42511796951293945
Epoch: 28, Steps: 3 | Train Loss: 0.299 Vali Loss: 0.413 Vali Acc: 0.950 Test Loss: 0.413 Test Acc: 0.950
Validation loss decreased (-0.924996 --> -0.949996).  Saving model ...
Epoch: 29 cost time: 0.4398810863494873
Epoch: 29, Steps: 3 | Train Loss: 0.284 Vali Loss: 0.396 Vali Acc: 0.950 Test Loss: 0.396 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 30 cost time: 0.3886423110961914
Epoch: 30, Steps: 3 | Train Loss: 0.270 Vali Loss: 0.387 Vali Acc: 0.950 Test Loss: 0.387 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 31 cost time: 0.36417174339294434
Epoch: 31, Steps: 3 | Train Loss: 0.262 Vali Loss: 0.372 Vali Acc: 0.950 Test Loss: 0.372 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 32 cost time: 0.4441087245941162
Epoch: 32, Steps: 3 | Train Loss: 0.230 Vali Loss: 0.359 Vali Acc: 0.950 Test Loss: 0.359 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 33 cost time: 0.39501953125
Epoch: 33, Steps: 3 | Train Loss: 0.214 Vali Loss: 0.349 Vali Acc: 0.950 Test Loss: 0.349 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 34 cost time: 0.41999387741088867
Epoch: 34, Steps: 3 | Train Loss: 0.216 Vali Loss: 0.328 Vali Acc: 0.950 Test Loss: 0.328 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 35 cost time: 0.45237135887145996
Epoch: 35, Steps: 3 | Train Loss: 0.193 Vali Loss: 0.321 Vali Acc: 0.950 Test Loss: 0.321 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 36 cost time: 0.3951115608215332
Epoch: 36, Steps: 3 | Train Loss: 0.190 Vali Loss: 0.312 Vali Acc: 0.950 Test Loss: 0.312 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 37 cost time: 0.41054606437683105
Epoch: 37, Steps: 3 | Train Loss: 0.201 Vali Loss: 0.299 Vali Acc: 0.950 Test Loss: 0.299 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 38 cost time: 0.4349501132965088
Epoch: 38, Steps: 3 | Train Loss: 0.175 Vali Loss: 0.284 Vali Acc: 0.950 Test Loss: 0.284 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 39 cost time: 0.464336633682251
Epoch: 39, Steps: 3 | Train Loss: 0.152 Vali Loss: 0.271 Vali Acc: 0.950 Test Loss: 0.271 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 40 cost time: 0.3778972625732422
Epoch: 40, Steps: 3 | Train Loss: 0.149 Vali Loss: 0.268 Vali Acc: 0.950 Test Loss: 0.268 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 41 cost time: 0.4121842384338379
Epoch: 41, Steps: 3 | Train Loss: 0.135 Vali Loss: 0.258 Vali Acc: 0.950 Test Loss: 0.258 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 42 cost time: 0.39765453338623047
Epoch: 42, Steps: 3 | Train Loss: 0.131 Vali Loss: 0.255 Vali Acc: 0.950 Test Loss: 0.255 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 43 cost time: 0.5041379928588867
Epoch: 43, Steps: 3 | Train Loss: 0.157 Vali Loss: 0.247 Vali Acc: 0.950 Test Loss: 0.247 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 44 cost time: 0.3788142204284668
Epoch: 44, Steps: 3 | Train Loss: 0.110 Vali Loss: 0.235 Vali Acc: 0.950 Test Loss: 0.235 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 45 cost time: 0.47971510887145996
Epoch: 45, Steps: 3 | Train Loss: 0.114 Vali Loss: 0.235 Vali Acc: 0.950 Test Loss: 0.235 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 46 cost time: 0.3828427791595459
Epoch: 46, Steps: 3 | Train Loss: 0.106 Vali Loss: 0.230 Vali Acc: 0.950 Test Loss: 0.230 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 47 cost time: 0.4061262607574463
Epoch: 47, Steps: 3 | Train Loss: 0.098 Vali Loss: 0.220 Vali Acc: 0.950 Test Loss: 0.220 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 48 cost time: 0.3913860321044922
Epoch: 48, Steps: 3 | Train Loss: 0.089 Vali Loss: 0.206 Vali Acc: 0.950 Test Loss: 0.206 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 49 cost time: 0.4294126033782959
Epoch: 49, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.195 Vali Acc: 0.975 Test Loss: 0.195 Test Acc: 0.975
Validation loss decreased (-0.949998 --> -0.974998).  Saving model ...
Epoch: 50 cost time: 0.4939908981323242
Epoch: 50, Steps: 3 | Train Loss: 0.072 Vali Loss: 0.187 Vali Acc: 0.975 Test Loss: 0.187 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps20_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 318788
model size : 1.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps25_str13_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.504143238067627
Epoch: 1, Steps: 3 | Train Loss: 1.401 Vali Loss: 1.347 Vali Acc: 0.225 Test Loss: 1.347 Test Acc: 0.225
Validation loss decreased (inf --> -0.224987).  Saving model ...
Epoch: 2 cost time: 0.37605810165405273
Epoch: 2, Steps: 3 | Train Loss: 1.365 Vali Loss: 1.332 Vali Acc: 0.275 Test Loss: 1.332 Test Acc: 0.275
Validation loss decreased (-0.224987 --> -0.274987).  Saving model ...
Epoch: 3 cost time: 0.36690711975097656
Epoch: 3, Steps: 3 | Train Loss: 1.326 Vali Loss: 1.315 Vali Acc: 0.350 Test Loss: 1.315 Test Acc: 0.350
Validation loss decreased (-0.274987 --> -0.349987).  Saving model ...
Epoch: 4 cost time: 0.41291213035583496
Epoch: 4, Steps: 3 | Train Loss: 1.294 Vali Loss: 1.289 Vali Acc: 0.375 Test Loss: 1.289 Test Acc: 0.375
Validation loss decreased (-0.349987 --> -0.374987).  Saving model ...
Epoch: 5 cost time: 0.43329715728759766
Epoch: 5, Steps: 3 | Train Loss: 1.239 Vali Loss: 1.260 Vali Acc: 0.475 Test Loss: 1.260 Test Acc: 0.475
Validation loss decreased (-0.374987 --> -0.474987).  Saving model ...
Epoch: 6 cost time: 0.3626060485839844
Epoch: 6, Steps: 3 | Train Loss: 1.185 Vali Loss: 1.223 Vali Acc: 0.550 Test Loss: 1.223 Test Acc: 0.550
Validation loss decreased (-0.474987 --> -0.549988).  Saving model ...
Epoch: 7 cost time: 0.36920690536499023
Epoch: 7, Steps: 3 | Train Loss: 1.120 Vali Loss: 1.181 Vali Acc: 0.650 Test Loss: 1.181 Test Acc: 0.650
Validation loss decreased (-0.549988 --> -0.649988).  Saving model ...
Epoch: 8 cost time: 0.37335753440856934
Epoch: 8, Steps: 3 | Train Loss: 1.085 Vali Loss: 1.139 Vali Acc: 0.700 Test Loss: 1.139 Test Acc: 0.700
Validation loss decreased (-0.649988 --> -0.699989).  Saving model ...
Epoch: 9 cost time: 0.373699426651001
Epoch: 9, Steps: 3 | Train Loss: 1.015 Vali Loss: 1.097 Vali Acc: 0.750 Test Loss: 1.097 Test Acc: 0.750
Validation loss decreased (-0.699989 --> -0.749989).  Saving model ...
Epoch: 10 cost time: 0.36167120933532715
Epoch: 10, Steps: 3 | Train Loss: 0.965 Vali Loss: 1.046 Vali Acc: 0.775 Test Loss: 1.046 Test Acc: 0.775
Validation loss decreased (-0.749989 --> -0.774990).  Saving model ...
Epoch: 11 cost time: 0.3443887233734131
Epoch: 11, Steps: 3 | Train Loss: 0.908 Vali Loss: 1.004 Vali Acc: 0.800 Test Loss: 1.004 Test Acc: 0.800
Validation loss decreased (-0.774990 --> -0.799990).  Saving model ...
Epoch: 12 cost time: 0.3632657527923584
Epoch: 12, Steps: 3 | Train Loss: 0.838 Vali Loss: 0.957 Vali Acc: 0.825 Test Loss: 0.957 Test Acc: 0.825
Validation loss decreased (-0.799990 --> -0.824990).  Saving model ...
Epoch: 13 cost time: 0.382793664932251
Epoch: 13, Steps: 3 | Train Loss: 0.787 Vali Loss: 0.925 Vali Acc: 0.800 Test Loss: 0.925 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.3592987060546875
Epoch: 14, Steps: 3 | Train Loss: 0.727 Vali Loss: 0.878 Vali Acc: 0.800 Test Loss: 0.878 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.40904998779296875
Epoch: 15, Steps: 3 | Train Loss: 0.706 Vali Loss: 0.836 Vali Acc: 0.800 Test Loss: 0.836 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.38109421730041504
Epoch: 16, Steps: 3 | Train Loss: 0.654 Vali Loss: 0.791 Vali Acc: 0.825 Test Loss: 0.791 Test Acc: 0.825
Validation loss decreased (-0.824990 --> -0.824992).  Saving model ...
Epoch: 17 cost time: 0.3578639030456543
Epoch: 17, Steps: 3 | Train Loss: 0.610 Vali Loss: 0.757 Vali Acc: 0.825 Test Loss: 0.757 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 18 cost time: 0.4183816909790039
Epoch: 18, Steps: 3 | Train Loss: 0.552 Vali Loss: 0.734 Vali Acc: 0.850 Test Loss: 0.734 Test Acc: 0.850
Validation loss decreased (-0.824992 --> -0.849993).  Saving model ...
Epoch: 19 cost time: 0.35340380668640137
Epoch: 19, Steps: 3 | Train Loss: 0.524 Vali Loss: 0.704 Vali Acc: 0.875 Test Loss: 0.704 Test Acc: 0.875
Validation loss decreased (-0.849993 --> -0.874993).  Saving model ...
Epoch: 20 cost time: 0.39728784561157227
Epoch: 20, Steps: 3 | Train Loss: 0.481 Vali Loss: 0.678 Vali Acc: 0.875 Test Loss: 0.678 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 21 cost time: 0.3872380256652832
Epoch: 21, Steps: 3 | Train Loss: 0.456 Vali Loss: 0.652 Vali Acc: 0.875 Test Loss: 0.652 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874993).  Saving model ...
Epoch: 22 cost time: 0.4104421138763428
Epoch: 22, Steps: 3 | Train Loss: 0.419 Vali Loss: 0.610 Vali Acc: 0.875 Test Loss: 0.610 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 23 cost time: 0.38071370124816895
Epoch: 23, Steps: 3 | Train Loss: 0.417 Vali Loss: 0.584 Vali Acc: 0.875 Test Loss: 0.584 Test Acc: 0.875
Validation loss decreased (-0.874994 --> -0.874994).  Saving model ...
Epoch: 24 cost time: 0.3871786594390869
Epoch: 24, Steps: 3 | Train Loss: 0.384 Vali Loss: 0.564 Vali Acc: 0.900 Test Loss: 0.564 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899994).  Saving model ...
Epoch: 25 cost time: 0.4436647891998291
Epoch: 25, Steps: 3 | Train Loss: 0.364 Vali Loss: 0.548 Vali Acc: 0.900 Test Loss: 0.548 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 26 cost time: 0.38156580924987793
Epoch: 26, Steps: 3 | Train Loss: 0.360 Vali Loss: 0.532 Vali Acc: 0.900 Test Loss: 0.532 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 27 cost time: 0.3735496997833252
Epoch: 27, Steps: 3 | Train Loss: 0.322 Vali Loss: 0.513 Vali Acc: 0.900 Test Loss: 0.513 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 28 cost time: 0.39530181884765625
Epoch: 28, Steps: 3 | Train Loss: 0.306 Vali Loss: 0.494 Vali Acc: 0.900 Test Loss: 0.494 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 29 cost time: 0.3939666748046875
Epoch: 29, Steps: 3 | Train Loss: 0.301 Vali Loss: 0.485 Vali Acc: 0.925 Test Loss: 0.485 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924995).  Saving model ...
Epoch: 30 cost time: 0.3654191493988037
Epoch: 30, Steps: 3 | Train Loss: 0.295 Vali Loss: 0.474 Vali Acc: 0.925 Test Loss: 0.474 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 31 cost time: 0.3760192394256592
Epoch: 31, Steps: 3 | Train Loss: 0.260 Vali Loss: 0.454 Vali Acc: 0.925 Test Loss: 0.454 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 32 cost time: 0.36439037322998047
Epoch: 32, Steps: 3 | Train Loss: 0.242 Vali Loss: 0.444 Vali Acc: 0.925 Test Loss: 0.444 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 33 cost time: 0.389359712600708
Epoch: 33, Steps: 3 | Train Loss: 0.245 Vali Loss: 0.425 Vali Acc: 0.925 Test Loss: 0.425 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 34 cost time: 0.37985682487487793
Epoch: 34, Steps: 3 | Train Loss: 0.235 Vali Loss: 0.417 Vali Acc: 0.925 Test Loss: 0.417 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 35 cost time: 0.4049675464630127
Epoch: 35, Steps: 3 | Train Loss: 0.235 Vali Loss: 0.397 Vali Acc: 0.925 Test Loss: 0.397 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 36 cost time: 0.37275171279907227
Epoch: 36, Steps: 3 | Train Loss: 0.197 Vali Loss: 0.383 Vali Acc: 0.925 Test Loss: 0.383 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 37 cost time: 0.391721248626709
Epoch: 37, Steps: 3 | Train Loss: 0.176 Vali Loss: 0.370 Vali Acc: 0.925 Test Loss: 0.370 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 38 cost time: 0.38404393196105957
Epoch: 38, Steps: 3 | Train Loss: 0.165 Vali Loss: 0.360 Vali Acc: 0.925 Test Loss: 0.360 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 39 cost time: 0.3829982280731201
Epoch: 39, Steps: 3 | Train Loss: 0.152 Vali Loss: 0.362 Vali Acc: 0.925 Test Loss: 0.362 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.40973973274230957
Epoch: 40, Steps: 3 | Train Loss: 0.171 Vali Loss: 0.363 Vali Acc: 0.925 Test Loss: 0.363 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.39495134353637695
Epoch: 41, Steps: 3 | Train Loss: 0.133 Vali Loss: 0.351 Vali Acc: 0.925 Test Loss: 0.351 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 42 cost time: 0.3870062828063965
Epoch: 42, Steps: 3 | Train Loss: 0.157 Vali Loss: 0.345 Vali Acc: 0.925 Test Loss: 0.345 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924997).  Saving model ...
Epoch: 43 cost time: 0.36833834648132324
Epoch: 43, Steps: 3 | Train Loss: 0.148 Vali Loss: 0.341 Vali Acc: 0.925 Test Loss: 0.341 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 44 cost time: 0.3647756576538086
Epoch: 44, Steps: 3 | Train Loss: 0.119 Vali Loss: 0.339 Vali Acc: 0.925 Test Loss: 0.339 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 45 cost time: 0.39729976654052734
Epoch: 45, Steps: 3 | Train Loss: 0.118 Vali Loss: 0.326 Vali Acc: 0.925 Test Loss: 0.326 Test Acc: 0.925
Validation loss decreased (-0.924997 --> -0.924997).  Saving model ...
Epoch: 46 cost time: 0.4247417449951172
Epoch: 46, Steps: 3 | Train Loss: 0.102 Vali Loss: 0.322 Vali Acc: 0.950 Test Loss: 0.322 Test Acc: 0.950
Validation loss decreased (-0.924997 --> -0.949997).  Saving model ...
Epoch: 47 cost time: 0.40629029273986816
Epoch: 47, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.324 Vali Acc: 0.950 Test Loss: 0.324 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.38796496391296387
Epoch: 48, Steps: 3 | Train Loss: 0.095 Vali Loss: 0.311 Vali Acc: 0.950 Test Loss: 0.311 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 49 cost time: 0.45630812644958496
Epoch: 49, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.301 Vali Acc: 0.950 Test Loss: 0.301 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 50 cost time: 0.41060781478881836
Epoch: 50, Steps: 3 | Train Loss: 0.088 Vali Loss: 0.298 Vali Acc: 0.950 Test Loss: 0.298 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps25_str13_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 316036
model size : 1.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.5896291732788086
Epoch: 1, Steps: 3 | Train Loss: 1.383 Vali Loss: 1.361 Vali Acc: 0.200 Test Loss: 1.361 Test Acc: 0.200
Validation loss decreased (inf --> -0.199986).  Saving model ...
Epoch: 2 cost time: 0.42193055152893066
Epoch: 2, Steps: 3 | Train Loss: 1.340 Vali Loss: 1.342 Vali Acc: 0.275 Test Loss: 1.342 Test Acc: 0.275
Validation loss decreased (-0.199986 --> -0.274987).  Saving model ...
Epoch: 3 cost time: 0.41292476654052734
Epoch: 3, Steps: 3 | Train Loss: 1.278 Vali Loss: 1.309 Vali Acc: 0.325 Test Loss: 1.309 Test Acc: 0.325
Validation loss decreased (-0.274987 --> -0.324987).  Saving model ...
Epoch: 4 cost time: 0.3630709648132324
Epoch: 4, Steps: 3 | Train Loss: 1.234 Vali Loss: 1.261 Vali Acc: 0.475 Test Loss: 1.261 Test Acc: 0.475
Validation loss decreased (-0.324987 --> -0.474987).  Saving model ...
Epoch: 5 cost time: 0.3949134349822998
Epoch: 5, Steps: 3 | Train Loss: 1.139 Vali Loss: 1.201 Vali Acc: 0.800 Test Loss: 1.201 Test Acc: 0.800
Validation loss decreased (-0.474987 --> -0.799988).  Saving model ...
Epoch: 6 cost time: 0.4612293243408203
Epoch: 6, Steps: 3 | Train Loss: 1.045 Vali Loss: 1.135 Vali Acc: 0.900 Test Loss: 1.135 Test Acc: 0.900
Validation loss decreased (-0.799988 --> -0.899989).  Saving model ...
Epoch: 7 cost time: 0.4493904113769531
Epoch: 7, Steps: 3 | Train Loss: 0.997 Vali Loss: 1.060 Vali Acc: 0.800 Test Loss: 1.060 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.429577112197876
Epoch: 8, Steps: 3 | Train Loss: 0.852 Vali Loss: 0.983 Vali Acc: 0.800 Test Loss: 0.983 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.40430474281311035
Epoch: 9, Steps: 3 | Train Loss: 0.767 Vali Loss: 0.908 Vali Acc: 0.800 Test Loss: 0.908 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.4107174873352051
Epoch: 10, Steps: 3 | Train Loss: 0.666 Vali Loss: 0.834 Vali Acc: 0.900 Test Loss: 0.834 Test Acc: 0.900
Validation loss decreased (-0.899989 --> -0.899992).  Saving model ...
Epoch: 11 cost time: 0.391970157623291
Epoch: 11, Steps: 3 | Train Loss: 0.620 Vali Loss: 0.770 Vali Acc: 0.925 Test Loss: 0.770 Test Acc: 0.925
Validation loss decreased (-0.899992 --> -0.924992).  Saving model ...
Epoch: 12 cost time: 0.3609035015106201
Epoch: 12, Steps: 3 | Train Loss: 0.533 Vali Loss: 0.705 Vali Acc: 0.950 Test Loss: 0.705 Test Acc: 0.950
Validation loss decreased (-0.924992 --> -0.949993).  Saving model ...
Epoch: 13 cost time: 0.4471862316131592
Epoch: 13, Steps: 3 | Train Loss: 0.448 Vali Loss: 0.647 Vali Acc: 0.950 Test Loss: 0.647 Test Acc: 0.950
Validation loss decreased (-0.949993 --> -0.949994).  Saving model ...
Epoch: 14 cost time: 0.3718380928039551
Epoch: 14, Steps: 3 | Train Loss: 0.437 Vali Loss: 0.593 Vali Acc: 0.950 Test Loss: 0.593 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949994).  Saving model ...
Epoch: 15 cost time: 0.4133894443511963
Epoch: 15, Steps: 3 | Train Loss: 0.383 Vali Loss: 0.556 Vali Acc: 0.925 Test Loss: 0.556 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.3565678596496582
Epoch: 16, Steps: 3 | Train Loss: 0.347 Vali Loss: 0.512 Vali Acc: 0.900 Test Loss: 0.512 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.4156064987182617
Epoch: 17, Steps: 3 | Train Loss: 0.303 Vali Loss: 0.459 Vali Acc: 0.925 Test Loss: 0.459 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.3743758201599121
Epoch: 18, Steps: 3 | Train Loss: 0.267 Vali Loss: 0.433 Vali Acc: 0.925 Test Loss: 0.433 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.4161217212677002
Epoch: 19, Steps: 3 | Train Loss: 0.251 Vali Loss: 0.396 Vali Acc: 0.950 Test Loss: 0.396 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949996).  Saving model ...
Epoch: 20 cost time: 0.3715035915374756
Epoch: 20, Steps: 3 | Train Loss: 0.263 Vali Loss: 0.371 Vali Acc: 0.925 Test Loss: 0.371 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.4776439666748047
Epoch: 21, Steps: 3 | Train Loss: 0.215 Vali Loss: 0.346 Vali Acc: 0.925 Test Loss: 0.346 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.4100165367126465
Epoch: 22, Steps: 3 | Train Loss: 0.212 Vali Loss: 0.334 Vali Acc: 0.950 Test Loss: 0.334 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 23 cost time: 0.39152002334594727
Epoch: 23, Steps: 3 | Train Loss: 0.189 Vali Loss: 0.329 Vali Acc: 0.950 Test Loss: 0.329 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 24 cost time: 0.37631821632385254
Epoch: 24, Steps: 3 | Train Loss: 0.181 Vali Loss: 0.314 Vali Acc: 0.950 Test Loss: 0.314 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 25 cost time: 0.3971846103668213
Epoch: 25, Steps: 3 | Train Loss: 0.162 Vali Loss: 0.305 Vali Acc: 0.950 Test Loss: 0.305 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 26 cost time: 0.3947746753692627
Epoch: 26, Steps: 3 | Train Loss: 0.161 Vali Loss: 0.295 Vali Acc: 0.950 Test Loss: 0.295 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 27 cost time: 0.38426804542541504
Epoch: 27, Steps: 3 | Train Loss: 0.140 Vali Loss: 0.289 Vali Acc: 0.950 Test Loss: 0.289 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 28 cost time: 0.38892149925231934
Epoch: 28, Steps: 3 | Train Loss: 0.143 Vali Loss: 0.276 Vali Acc: 0.950 Test Loss: 0.276 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 29 cost time: 0.45819664001464844
Epoch: 29, Steps: 3 | Train Loss: 0.129 Vali Loss: 0.268 Vali Acc: 0.950 Test Loss: 0.268 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 30 cost time: 0.3884713649749756
Epoch: 30, Steps: 3 | Train Loss: 0.110 Vali Loss: 0.262 Vali Acc: 0.950 Test Loss: 0.262 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 31 cost time: 0.41841673851013184
Epoch: 31, Steps: 3 | Train Loss: 0.100 Vali Loss: 0.259 Vali Acc: 0.950 Test Loss: 0.259 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 32 cost time: 0.49666523933410645
Epoch: 32, Steps: 3 | Train Loss: 0.085 Vali Loss: 0.244 Vali Acc: 0.950 Test Loss: 0.244 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 33 cost time: 0.42358899116516113
Epoch: 33, Steps: 3 | Train Loss: 0.088 Vali Loss: 0.239 Vali Acc: 0.950 Test Loss: 0.239 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 34 cost time: 0.42594385147094727
Epoch: 34, Steps: 3 | Train Loss: 0.075 Vali Loss: 0.231 Vali Acc: 0.950 Test Loss: 0.231 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 35 cost time: 0.4447307586669922
Epoch: 35, Steps: 3 | Train Loss: 0.068 Vali Loss: 0.224 Vali Acc: 0.950 Test Loss: 0.224 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 36 cost time: 0.39403247833251953
Epoch: 36, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.223 Vali Acc: 0.950 Test Loss: 0.223 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 37 cost time: 0.42725253105163574
Epoch: 37, Steps: 3 | Train Loss: 0.061 Vali Loss: 0.224 Vali Acc: 0.950 Test Loss: 0.224 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.3815274238586426
Epoch: 38, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.231 Vali Acc: 0.950 Test Loss: 0.231 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.4182248115539551
Epoch: 39, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.234 Vali Acc: 0.950 Test Loss: 0.234 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.37589383125305176
Epoch: 40, Steps: 3 | Train Loss: 0.049 Vali Loss: 0.238 Vali Acc: 0.950 Test Loss: 0.238 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.441220760345459
Epoch: 41, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.228 Vali Acc: 0.950 Test Loss: 0.228 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.4082303047180176
Epoch: 42, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.235 Vali Acc: 0.950 Test Loss: 0.235 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.4620022773742676
Epoch: 43, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.226 Vali Acc: 0.950 Test Loss: 0.226 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.3851439952850342
Epoch: 44, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.231 Vali Acc: 0.950 Test Loss: 0.231 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.42683982849121094
Epoch: 45, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.231 Vali Acc: 0.950 Test Loss: 0.231 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 0.4402015209197998
Epoch: 46, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.226 Vali Acc: 0.950 Test Loss: 0.226 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 124036
model size : 0.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.5380887985229492
Epoch: 1, Steps: 3 | Train Loss: 1.378 Vali Loss: 1.383 Vali Acc: 0.350 Test Loss: 1.383 Test Acc: 0.350
Validation loss decreased (inf --> -0.349986).  Saving model ...
Epoch: 2 cost time: 0.40540027618408203
Epoch: 2, Steps: 3 | Train Loss: 1.368 Vali Loss: 1.362 Vali Acc: 0.400 Test Loss: 1.362 Test Acc: 0.400
Validation loss decreased (-0.349986 --> -0.399986).  Saving model ...
Epoch: 3 cost time: 0.43224334716796875
Epoch: 3, Steps: 3 | Train Loss: 1.343 Vali Loss: 1.331 Vali Acc: 0.375 Test Loss: 1.331 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.4125030040740967
Epoch: 4, Steps: 3 | Train Loss: 1.259 Vali Loss: 1.288 Vali Acc: 0.425 Test Loss: 1.288 Test Acc: 0.425
Validation loss decreased (-0.399986 --> -0.424987).  Saving model ...
Epoch: 5 cost time: 0.38005542755126953
Epoch: 5, Steps: 3 | Train Loss: 1.185 Vali Loss: 1.234 Vali Acc: 0.475 Test Loss: 1.234 Test Acc: 0.475
Validation loss decreased (-0.424987 --> -0.474988).  Saving model ...
Epoch: 6 cost time: 0.489912748336792
Epoch: 6, Steps: 3 | Train Loss: 1.112 Vali Loss: 1.173 Vali Acc: 0.500 Test Loss: 1.173 Test Acc: 0.500
Validation loss decreased (-0.474988 --> -0.499988).  Saving model ...
Epoch: 7 cost time: 0.49070072174072266
Epoch: 7, Steps: 3 | Train Loss: 1.033 Vali Loss: 1.105 Vali Acc: 0.550 Test Loss: 1.105 Test Acc: 0.550
Validation loss decreased (-0.499988 --> -0.549989).  Saving model ...
Epoch: 8 cost time: 0.4699232578277588
Epoch: 8, Steps: 3 | Train Loss: 0.944 Vali Loss: 1.041 Vali Acc: 0.625 Test Loss: 1.041 Test Acc: 0.625
Validation loss decreased (-0.549989 --> -0.624990).  Saving model ...
Epoch: 9 cost time: 0.39626216888427734
Epoch: 9, Steps: 3 | Train Loss: 0.865 Vali Loss: 0.975 Vali Acc: 0.600 Test Loss: 0.975 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.43410301208496094
Epoch: 10, Steps: 3 | Train Loss: 0.799 Vali Loss: 0.907 Vali Acc: 0.725 Test Loss: 0.907 Test Acc: 0.725
Validation loss decreased (-0.624990 --> -0.724991).  Saving model ...
Epoch: 11 cost time: 0.38913393020629883
Epoch: 11, Steps: 3 | Train Loss: 0.707 Vali Loss: 0.847 Vali Acc: 0.775 Test Loss: 0.847 Test Acc: 0.775
Validation loss decreased (-0.724991 --> -0.774992).  Saving model ...
Epoch: 12 cost time: 0.40844225883483887
Epoch: 12, Steps: 3 | Train Loss: 0.634 Vali Loss: 0.777 Vali Acc: 0.925 Test Loss: 0.777 Test Acc: 0.925
Validation loss decreased (-0.774992 --> -0.924992).  Saving model ...
Epoch: 13 cost time: 0.3969767093658447
Epoch: 13, Steps: 3 | Train Loss: 0.576 Vali Loss: 0.716 Vali Acc: 0.975 Test Loss: 0.716 Test Acc: 0.975
Validation loss decreased (-0.924992 --> -0.974993).  Saving model ...
Epoch: 14 cost time: 0.3933682441711426
Epoch: 14, Steps: 3 | Train Loss: 0.537 Vali Loss: 0.663 Vali Acc: 0.975 Test Loss: 0.663 Test Acc: 0.975
Validation loss decreased (-0.974993 --> -0.974993).  Saving model ...
Epoch: 15 cost time: 0.40397071838378906
Epoch: 15, Steps: 3 | Train Loss: 0.447 Vali Loss: 0.611 Vali Acc: 0.975 Test Loss: 0.611 Test Acc: 0.975
Validation loss decreased (-0.974993 --> -0.974994).  Saving model ...
Epoch: 16 cost time: 0.3923211097717285
Epoch: 16, Steps: 3 | Train Loss: 0.433 Vali Loss: 0.562 Vali Acc: 0.975 Test Loss: 0.562 Test Acc: 0.975
Validation loss decreased (-0.974994 --> -0.974994).  Saving model ...
Epoch: 17 cost time: 0.4548337459564209
Epoch: 17, Steps: 3 | Train Loss: 0.384 Vali Loss: 0.519 Vali Acc: 0.975 Test Loss: 0.519 Test Acc: 0.975
Validation loss decreased (-0.974994 --> -0.974995).  Saving model ...
Epoch: 18 cost time: 0.4289522171020508
Epoch: 18, Steps: 3 | Train Loss: 0.366 Vali Loss: 0.490 Vali Acc: 0.975 Test Loss: 0.490 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 19 cost time: 0.3939826488494873
Epoch: 19, Steps: 3 | Train Loss: 0.329 Vali Loss: 0.457 Vali Acc: 0.975 Test Loss: 0.457 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 20 cost time: 0.38835597038269043
Epoch: 20, Steps: 3 | Train Loss: 0.301 Vali Loss: 0.434 Vali Acc: 0.975 Test Loss: 0.434 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 21 cost time: 0.43076610565185547
Epoch: 21, Steps: 3 | Train Loss: 0.270 Vali Loss: 0.416 Vali Acc: 0.975 Test Loss: 0.416 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 22 cost time: 0.421954870223999
Epoch: 22, Steps: 3 | Train Loss: 0.247 Vali Loss: 0.393 Vali Acc: 0.975 Test Loss: 0.393 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 23 cost time: 0.42749476432800293
Epoch: 23, Steps: 3 | Train Loss: 0.263 Vali Loss: 0.366 Vali Acc: 0.975 Test Loss: 0.366 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 24 cost time: 0.4322693347930908
Epoch: 24, Steps: 3 | Train Loss: 0.210 Vali Loss: 0.357 Vali Acc: 0.975 Test Loss: 0.357 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 25 cost time: 0.39270830154418945
Epoch: 25, Steps: 3 | Train Loss: 0.205 Vali Loss: 0.334 Vali Acc: 0.975 Test Loss: 0.334 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 26 cost time: 0.39111924171447754
Epoch: 26, Steps: 3 | Train Loss: 0.202 Vali Loss: 0.324 Vali Acc: 0.975 Test Loss: 0.324 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 27 cost time: 0.42124247550964355
Epoch: 27, Steps: 3 | Train Loss: 0.180 Vali Loss: 0.316 Vali Acc: 0.975 Test Loss: 0.316 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 28 cost time: 0.4273829460144043
Epoch: 28, Steps: 3 | Train Loss: 0.144 Vali Loss: 0.289 Vali Acc: 0.975 Test Loss: 0.289 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 29 cost time: 0.4320690631866455
Epoch: 29, Steps: 3 | Train Loss: 0.159 Vali Loss: 0.283 Vali Acc: 0.975 Test Loss: 0.283 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 30 cost time: 0.3873162269592285
Epoch: 30, Steps: 3 | Train Loss: 0.141 Vali Loss: 0.270 Vali Acc: 0.975 Test Loss: 0.270 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 31 cost time: 0.4184703826904297
Epoch: 31, Steps: 3 | Train Loss: 0.140 Vali Loss: 0.253 Vali Acc: 0.975 Test Loss: 0.253 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 32 cost time: 0.42026686668395996
Epoch: 32, Steps: 3 | Train Loss: 0.130 Vali Loss: 0.241 Vali Acc: 0.975 Test Loss: 0.241 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 33 cost time: 0.37982177734375
Epoch: 33, Steps: 3 | Train Loss: 0.111 Vali Loss: 0.235 Vali Acc: 0.975 Test Loss: 0.235 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 34 cost time: 0.40453243255615234
Epoch: 34, Steps: 3 | Train Loss: 0.095 Vali Loss: 0.239 Vali Acc: 0.950 Test Loss: 0.239 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.3706240653991699
Epoch: 35, Steps: 3 | Train Loss: 0.100 Vali Loss: 0.238 Vali Acc: 0.950 Test Loss: 0.238 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.3799595832824707
Epoch: 36, Steps: 3 | Train Loss: 0.085 Vali Loss: 0.227 Vali Acc: 0.950 Test Loss: 0.227 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.4040493965148926
Epoch: 37, Steps: 3 | Train Loss: 0.079 Vali Loss: 0.221 Vali Acc: 0.950 Test Loss: 0.221 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.4303405284881592
Epoch: 38, Steps: 3 | Train Loss: 0.073 Vali Loss: 0.217 Vali Acc: 0.950 Test Loss: 0.217 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.3939476013183594
Epoch: 39, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.225 Vali Acc: 0.950 Test Loss: 0.225 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.44637417793273926
Epoch: 40, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.218 Vali Acc: 0.950 Test Loss: 0.218 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.38043761253356934
Epoch: 41, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.206 Vali Acc: 0.950 Test Loss: 0.206 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.44677042961120605
Epoch: 42, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.203 Vali Acc: 0.950 Test Loss: 0.203 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.40143513679504395
Epoch: 43, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.201 Vali Acc: 0.950 Test Loss: 0.201 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 111812
model size : 0.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.5809433460235596
Epoch: 1, Steps: 3 | Train Loss: 1.347 Vali Loss: 1.400 Vali Acc: 0.325 Test Loss: 1.400 Test Acc: 0.325
Validation loss decreased (inf --> -0.324986).  Saving model ...
Epoch: 2 cost time: 0.37293124198913574
Epoch: 2, Steps: 3 | Train Loss: 1.297 Vali Loss: 1.377 Vali Acc: 0.375 Test Loss: 1.377 Test Acc: 0.375
Validation loss decreased (-0.324986 --> -0.374986).  Saving model ...
Epoch: 3 cost time: 0.38812255859375
Epoch: 3, Steps: 3 | Train Loss: 1.259 Vali Loss: 1.350 Vali Acc: 0.400 Test Loss: 1.350 Test Acc: 0.400
Validation loss decreased (-0.374986 --> -0.399986).  Saving model ...
Epoch: 4 cost time: 0.39730334281921387
Epoch: 4, Steps: 3 | Train Loss: 1.219 Vali Loss: 1.315 Vali Acc: 0.525 Test Loss: 1.315 Test Acc: 0.525
Validation loss decreased (-0.399986 --> -0.524987).  Saving model ...
Epoch: 5 cost time: 0.38976287841796875
Epoch: 5, Steps: 3 | Train Loss: 1.177 Vali Loss: 1.267 Vali Acc: 0.575 Test Loss: 1.267 Test Acc: 0.575
Validation loss decreased (-0.524987 --> -0.574987).  Saving model ...
Epoch: 6 cost time: 0.4295644760131836
Epoch: 6, Steps: 3 | Train Loss: 1.113 Vali Loss: 1.214 Vali Acc: 0.625 Test Loss: 1.214 Test Acc: 0.625
Validation loss decreased (-0.574987 --> -0.624988).  Saving model ...
Epoch: 7 cost time: 0.36389756202697754
Epoch: 7, Steps: 3 | Train Loss: 1.058 Vali Loss: 1.158 Vali Acc: 0.700 Test Loss: 1.158 Test Acc: 0.700
Validation loss decreased (-0.624988 --> -0.699988).  Saving model ...
Epoch: 8 cost time: 0.4608132839202881
Epoch: 8, Steps: 3 | Train Loss: 0.980 Vali Loss: 1.095 Vali Acc: 0.700 Test Loss: 1.095 Test Acc: 0.700
Validation loss decreased (-0.699988 --> -0.699989).  Saving model ...
Epoch: 9 cost time: 0.4333159923553467
Epoch: 9, Steps: 3 | Train Loss: 0.922 Vali Loss: 1.034 Vali Acc: 0.750 Test Loss: 1.034 Test Acc: 0.750
Validation loss decreased (-0.699989 --> -0.749990).  Saving model ...
Epoch: 10 cost time: 0.37552738189697266
Epoch: 10, Steps: 3 | Train Loss: 0.870 Vali Loss: 0.973 Vali Acc: 0.775 Test Loss: 0.973 Test Acc: 0.775
Validation loss decreased (-0.749990 --> -0.774990).  Saving model ...
Epoch: 11 cost time: 0.3688690662384033
Epoch: 11, Steps: 3 | Train Loss: 0.774 Vali Loss: 0.915 Vali Acc: 0.825 Test Loss: 0.915 Test Acc: 0.825
Validation loss decreased (-0.774990 --> -0.824991).  Saving model ...
Epoch: 12 cost time: 0.36972475051879883
Epoch: 12, Steps: 3 | Train Loss: 0.727 Vali Loss: 0.866 Vali Acc: 0.825 Test Loss: 0.866 Test Acc: 0.825
Validation loss decreased (-0.824991 --> -0.824991).  Saving model ...
Epoch: 13 cost time: 0.41790127754211426
Epoch: 13, Steps: 3 | Train Loss: 0.656 Vali Loss: 0.811 Vali Acc: 0.850 Test Loss: 0.811 Test Acc: 0.850
Validation loss decreased (-0.824991 --> -0.849992).  Saving model ...
Epoch: 14 cost time: 0.35314178466796875
Epoch: 14, Steps: 3 | Train Loss: 0.623 Vali Loss: 0.769 Vali Acc: 0.900 Test Loss: 0.769 Test Acc: 0.900
Validation loss decreased (-0.849992 --> -0.899992).  Saving model ...
Epoch: 15 cost time: 0.4626920223236084
Epoch: 15, Steps: 3 | Train Loss: 0.557 Vali Loss: 0.718 Vali Acc: 0.900 Test Loss: 0.718 Test Acc: 0.900
Validation loss decreased (-0.899992 --> -0.899993).  Saving model ...
Epoch: 16 cost time: 0.355846643447876
Epoch: 16, Steps: 3 | Train Loss: 0.505 Vali Loss: 0.682 Vali Acc: 0.900 Test Loss: 0.682 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 17 cost time: 0.3577766418457031
Epoch: 17, Steps: 3 | Train Loss: 0.473 Vali Loss: 0.644 Vali Acc: 0.900 Test Loss: 0.644 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899994).  Saving model ...
Epoch: 18 cost time: 0.44856953620910645
Epoch: 18, Steps: 3 | Train Loss: 0.428 Vali Loss: 0.611 Vali Acc: 0.900 Test Loss: 0.611 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 19 cost time: 0.3758735656738281
Epoch: 19, Steps: 3 | Train Loss: 0.414 Vali Loss: 0.566 Vali Acc: 0.900 Test Loss: 0.566 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 20 cost time: 0.3819279670715332
Epoch: 20, Steps: 3 | Train Loss: 0.394 Vali Loss: 0.534 Vali Acc: 0.900 Test Loss: 0.534 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 21 cost time: 0.3810861110687256
Epoch: 21, Steps: 3 | Train Loss: 0.357 Vali Loss: 0.504 Vali Acc: 0.950 Test Loss: 0.504 Test Acc: 0.950
Validation loss decreased (-0.899995 --> -0.949995).  Saving model ...
Epoch: 22 cost time: 0.4471924304962158
Epoch: 22, Steps: 3 | Train Loss: 0.325 Vali Loss: 0.480 Vali Acc: 0.950 Test Loss: 0.480 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 23 cost time: 0.40424084663391113
Epoch: 23, Steps: 3 | Train Loss: 0.327 Vali Loss: 0.454 Vali Acc: 0.950 Test Loss: 0.454 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 24 cost time: 0.3889787197113037
Epoch: 24, Steps: 3 | Train Loss: 0.291 Vali Loss: 0.431 Vali Acc: 0.950 Test Loss: 0.431 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 25 cost time: 0.3724968433380127
Epoch: 25, Steps: 3 | Train Loss: 0.267 Vali Loss: 0.418 Vali Acc: 0.950 Test Loss: 0.418 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 26 cost time: 0.3799757957458496
Epoch: 26, Steps: 3 | Train Loss: 0.255 Vali Loss: 0.394 Vali Acc: 0.950 Test Loss: 0.394 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 27 cost time: 0.3643984794616699
Epoch: 27, Steps: 3 | Train Loss: 0.247 Vali Loss: 0.369 Vali Acc: 0.950 Test Loss: 0.369 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 28 cost time: 0.37566280364990234
Epoch: 28, Steps: 3 | Train Loss: 0.231 Vali Loss: 0.357 Vali Acc: 0.950 Test Loss: 0.357 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 29 cost time: 0.36308956146240234
Epoch: 29, Steps: 3 | Train Loss: 0.219 Vali Loss: 0.348 Vali Acc: 0.950 Test Loss: 0.348 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 30 cost time: 0.403914213180542
Epoch: 30, Steps: 3 | Train Loss: 0.220 Vali Loss: 0.331 Vali Acc: 0.975 Test Loss: 0.331 Test Acc: 0.975
Validation loss decreased (-0.949997 --> -0.974997).  Saving model ...
Epoch: 31 cost time: 0.3810412883758545
Epoch: 31, Steps: 3 | Train Loss: 0.206 Vali Loss: 0.314 Vali Acc: 0.975 Test Loss: 0.314 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 32 cost time: 0.3837740421295166
Epoch: 32, Steps: 3 | Train Loss: 0.184 Vali Loss: 0.302 Vali Acc: 0.975 Test Loss: 0.302 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 33 cost time: 0.4226858615875244
Epoch: 33, Steps: 3 | Train Loss: 0.195 Vali Loss: 0.286 Vali Acc: 0.975 Test Loss: 0.286 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 34 cost time: 0.3581361770629883
Epoch: 34, Steps: 3 | Train Loss: 0.162 Vali Loss: 0.266 Vali Acc: 0.975 Test Loss: 0.266 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 35 cost time: 0.3897731304168701
Epoch: 35, Steps: 3 | Train Loss: 0.167 Vali Loss: 0.258 Vali Acc: 0.975 Test Loss: 0.258 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 36 cost time: 0.4059772491455078
Epoch: 36, Steps: 3 | Train Loss: 0.150 Vali Loss: 0.258 Vali Acc: 0.975 Test Loss: 0.258 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.38758087158203125
Epoch: 37, Steps: 3 | Train Loss: 0.144 Vali Loss: 0.251 Vali Acc: 0.975 Test Loss: 0.251 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 38 cost time: 0.38174009323120117
Epoch: 38, Steps: 3 | Train Loss: 0.128 Vali Loss: 0.247 Vali Acc: 0.975 Test Loss: 0.247 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 39 cost time: 0.38854312896728516
Epoch: 39, Steps: 3 | Train Loss: 0.128 Vali Loss: 0.239 Vali Acc: 0.975 Test Loss: 0.239 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 40 cost time: 0.3817100524902344
Epoch: 40, Steps: 3 | Train Loss: 0.129 Vali Loss: 0.239 Vali Acc: 0.975 Test Loss: 0.239 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 41 cost time: 0.36699390411376953
Epoch: 41, Steps: 3 | Train Loss: 0.107 Vali Loss: 0.229 Vali Acc: 0.975 Test Loss: 0.229 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 42 cost time: 0.365795373916626
Epoch: 42, Steps: 3 | Train Loss: 0.106 Vali Loss: 0.226 Vali Acc: 0.975 Test Loss: 0.226 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 43 cost time: 0.4724609851837158
Epoch: 43, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.211 Vali Acc: 0.975 Test Loss: 0.211 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 44 cost time: 0.4104483127593994
Epoch: 44, Steps: 3 | Train Loss: 0.087 Vali Loss: 0.202 Vali Acc: 0.975 Test Loss: 0.202 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 45 cost time: 0.4514169692993164
Epoch: 45, Steps: 3 | Train Loss: 0.080 Vali Loss: 0.200 Vali Acc: 0.975 Test Loss: 0.200 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 46 cost time: 0.45918965339660645
Epoch: 46, Steps: 3 | Train Loss: 0.068 Vali Loss: 0.200 Vali Acc: 0.975 Test Loss: 0.200 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.4442572593688965
Epoch: 47, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.191 Vali Acc: 0.975 Test Loss: 0.191 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 48 cost time: 0.4646923542022705
Epoch: 48, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.185 Vali Acc: 0.975 Test Loss: 0.185 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 49 cost time: 0.39755845069885254
Epoch: 49, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.169 Vali Acc: 0.975 Test Loss: 0.169 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 50 cost time: 0.44835710525512695
Epoch: 50, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.163 Vali Acc: 0.975 Test Loss: 0.163 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 105764
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.5467801094055176
Epoch: 1, Steps: 3 | Train Loss: 1.430 Vali Loss: 1.414 Vali Acc: 0.150 Test Loss: 1.414 Test Acc: 0.150
Validation loss decreased (inf --> -0.149986).  Saving model ...
Epoch: 2 cost time: 0.41983890533447266
Epoch: 2, Steps: 3 | Train Loss: 1.389 Vali Loss: 1.399 Vali Acc: 0.150 Test Loss: 1.399 Test Acc: 0.150
Validation loss decreased (-0.149986 --> -0.149986).  Saving model ...
Epoch: 3 cost time: 0.4068794250488281
Epoch: 3, Steps: 3 | Train Loss: 1.367 Vali Loss: 1.380 Vali Acc: 0.175 Test Loss: 1.380 Test Acc: 0.175
Validation loss decreased (-0.149986 --> -0.174986).  Saving model ...
Epoch: 4 cost time: 0.3767061233520508
Epoch: 4, Steps: 3 | Train Loss: 1.337 Vali Loss: 1.353 Vali Acc: 0.175 Test Loss: 1.353 Test Acc: 0.175
Validation loss decreased (-0.174986 --> -0.174986).  Saving model ...
Epoch: 5 cost time: 0.3914463520050049
Epoch: 5, Steps: 3 | Train Loss: 1.298 Vali Loss: 1.319 Vali Acc: 0.250 Test Loss: 1.319 Test Acc: 0.250
Validation loss decreased (-0.174986 --> -0.249987).  Saving model ...
Epoch: 6 cost time: 0.36710023880004883
Epoch: 6, Steps: 3 | Train Loss: 1.248 Vali Loss: 1.281 Vali Acc: 0.300 Test Loss: 1.281 Test Acc: 0.300
Validation loss decreased (-0.249987 --> -0.299987).  Saving model ...
Epoch: 7 cost time: 0.4096052646636963
Epoch: 7, Steps: 3 | Train Loss: 1.224 Vali Loss: 1.234 Vali Acc: 0.525 Test Loss: 1.234 Test Acc: 0.525
Validation loss decreased (-0.299987 --> -0.524988).  Saving model ...
Epoch: 8 cost time: 0.3592555522918701
Epoch: 8, Steps: 3 | Train Loss: 1.138 Vali Loss: 1.189 Vali Acc: 0.600 Test Loss: 1.189 Test Acc: 0.600
Validation loss decreased (-0.524988 --> -0.599988).  Saving model ...
Epoch: 9 cost time: 0.35863327980041504
Epoch: 9, Steps: 3 | Train Loss: 1.100 Vali Loss: 1.147 Vali Acc: 0.675 Test Loss: 1.147 Test Acc: 0.675
Validation loss decreased (-0.599988 --> -0.674989).  Saving model ...
Epoch: 10 cost time: 0.3634016513824463
Epoch: 10, Steps: 3 | Train Loss: 1.031 Vali Loss: 1.096 Vali Acc: 0.725 Test Loss: 1.096 Test Acc: 0.725
Validation loss decreased (-0.674989 --> -0.724989).  Saving model ...
Epoch: 11 cost time: 0.38520121574401855
Epoch: 11, Steps: 3 | Train Loss: 0.938 Vali Loss: 1.047 Vali Acc: 0.775 Test Loss: 1.047 Test Acc: 0.775
Validation loss decreased (-0.724989 --> -0.774990).  Saving model ...
Epoch: 12 cost time: 0.3377981185913086
Epoch: 12, Steps: 3 | Train Loss: 0.920 Vali Loss: 1.000 Vali Acc: 0.850 Test Loss: 1.000 Test Acc: 0.850
Validation loss decreased (-0.774990 --> -0.849990).  Saving model ...
Epoch: 13 cost time: 0.47794151306152344
Epoch: 13, Steps: 3 | Train Loss: 0.847 Vali Loss: 0.950 Vali Acc: 0.950 Test Loss: 0.950 Test Acc: 0.950
Validation loss decreased (-0.849990 --> -0.949991).  Saving model ...
Epoch: 14 cost time: 0.38567614555358887
Epoch: 14, Steps: 3 | Train Loss: 0.792 Vali Loss: 0.899 Vali Acc: 0.950 Test Loss: 0.899 Test Acc: 0.950
Validation loss decreased (-0.949991 --> -0.949991).  Saving model ...
Epoch: 15 cost time: 0.3818533420562744
Epoch: 15, Steps: 3 | Train Loss: 0.741 Vali Loss: 0.862 Vali Acc: 0.950 Test Loss: 0.862 Test Acc: 0.950
Validation loss decreased (-0.949991 --> -0.949991).  Saving model ...
Epoch: 16 cost time: 0.37014174461364746
Epoch: 16, Steps: 3 | Train Loss: 0.707 Vali Loss: 0.820 Vali Acc: 0.950 Test Loss: 0.820 Test Acc: 0.950
Validation loss decreased (-0.949991 --> -0.949992).  Saving model ...
Epoch: 17 cost time: 0.3563728332519531
Epoch: 17, Steps: 3 | Train Loss: 0.659 Vali Loss: 0.772 Vali Acc: 0.950 Test Loss: 0.772 Test Acc: 0.950
Validation loss decreased (-0.949992 --> -0.949992).  Saving model ...
Epoch: 18 cost time: 0.36305952072143555
Epoch: 18, Steps: 3 | Train Loss: 0.623 Vali Loss: 0.730 Vali Acc: 0.950 Test Loss: 0.730 Test Acc: 0.950
Validation loss decreased (-0.949992 --> -0.949993).  Saving model ...
Epoch: 19 cost time: 0.46390271186828613
Epoch: 19, Steps: 3 | Train Loss: 0.559 Vali Loss: 0.692 Vali Acc: 0.975 Test Loss: 0.692 Test Acc: 0.975
Validation loss decreased (-0.949993 --> -0.974993).  Saving model ...
Epoch: 20 cost time: 0.37369251251220703
Epoch: 20, Steps: 3 | Train Loss: 0.534 Vali Loss: 0.658 Vali Acc: 0.975 Test Loss: 0.658 Test Acc: 0.975
Validation loss decreased (-0.974993 --> -0.974993).  Saving model ...
Epoch: 21 cost time: 0.42618894577026367
Epoch: 21, Steps: 3 | Train Loss: 0.513 Vali Loss: 0.634 Vali Acc: 0.975 Test Loss: 0.634 Test Acc: 0.975
Validation loss decreased (-0.974993 --> -0.974994).  Saving model ...
Epoch: 22 cost time: 0.36038732528686523
Epoch: 22, Steps: 3 | Train Loss: 0.460 Vali Loss: 0.603 Vali Acc: 0.975 Test Loss: 0.603 Test Acc: 0.975
Validation loss decreased (-0.974994 --> -0.974994).  Saving model ...
Epoch: 23 cost time: 0.3581817150115967
Epoch: 23, Steps: 3 | Train Loss: 0.450 Vali Loss: 0.583 Vali Acc: 0.975 Test Loss: 0.583 Test Acc: 0.975
Validation loss decreased (-0.974994 --> -0.974994).  Saving model ...
Epoch: 24 cost time: 0.37043166160583496
Epoch: 24, Steps: 3 | Train Loss: 0.426 Vali Loss: 0.541 Vali Acc: 0.975 Test Loss: 0.541 Test Acc: 0.975
Validation loss decreased (-0.974994 --> -0.974995).  Saving model ...
Epoch: 25 cost time: 0.3809235095977783
Epoch: 25, Steps: 3 | Train Loss: 0.376 Vali Loss: 0.513 Vali Acc: 0.950 Test Loss: 0.513 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.37932896614074707
Epoch: 26, Steps: 3 | Train Loss: 0.379 Vali Loss: 0.489 Vali Acc: 0.950 Test Loss: 0.489 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.35572218894958496
Epoch: 27, Steps: 3 | Train Loss: 0.360 Vali Loss: 0.466 Vali Acc: 0.925 Test Loss: 0.466 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.3897843360900879
Epoch: 28, Steps: 3 | Train Loss: 0.337 Vali Loss: 0.456 Vali Acc: 0.950 Test Loss: 0.456 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.395280122756958
Epoch: 29, Steps: 3 | Train Loss: 0.302 Vali Loss: 0.436 Vali Acc: 0.975 Test Loss: 0.436 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 30 cost time: 0.4062204360961914
Epoch: 30, Steps: 3 | Train Loss: 0.249 Vali Loss: 0.404 Vali Acc: 0.975 Test Loss: 0.404 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 31 cost time: 0.3486649990081787
Epoch: 31, Steps: 3 | Train Loss: 0.306 Vali Loss: 0.389 Vali Acc: 0.975 Test Loss: 0.389 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 32 cost time: 0.4911329746246338
Epoch: 32, Steps: 3 | Train Loss: 0.279 Vali Loss: 0.378 Vali Acc: 0.975 Test Loss: 0.378 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 33 cost time: 0.37474870681762695
Epoch: 33, Steps: 3 | Train Loss: 0.273 Vali Loss: 0.365 Vali Acc: 0.975 Test Loss: 0.365 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 34 cost time: 0.4631929397583008
Epoch: 34, Steps: 3 | Train Loss: 0.261 Vali Loss: 0.350 Vali Acc: 0.975 Test Loss: 0.350 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 35 cost time: 0.45238399505615234
Epoch: 35, Steps: 3 | Train Loss: 0.232 Vali Loss: 0.341 Vali Acc: 0.975 Test Loss: 0.341 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 36 cost time: 0.32407522201538086
Epoch: 36, Steps: 3 | Train Loss: 0.225 Vali Loss: 0.343 Vali Acc: 0.975 Test Loss: 0.343 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.37243008613586426
Epoch: 37, Steps: 3 | Train Loss: 0.209 Vali Loss: 0.334 Vali Acc: 0.975 Test Loss: 0.334 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 38 cost time: 0.37651658058166504
Epoch: 38, Steps: 3 | Train Loss: 0.199 Vali Loss: 0.318 Vali Acc: 0.975 Test Loss: 0.318 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 39 cost time: 0.38237571716308594
Epoch: 39, Steps: 3 | Train Loss: 0.185 Vali Loss: 0.309 Vali Acc: 0.975 Test Loss: 0.309 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 40 cost time: 0.4383270740509033
Epoch: 40, Steps: 3 | Train Loss: 0.189 Vali Loss: 0.294 Vali Acc: 0.975 Test Loss: 0.294 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 41 cost time: 0.40077924728393555
Epoch: 41, Steps: 3 | Train Loss: 0.178 Vali Loss: 0.283 Vali Acc: 0.975 Test Loss: 0.283 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 42 cost time: 0.3529045581817627
Epoch: 42, Steps: 3 | Train Loss: 0.177 Vali Loss: 0.277 Vali Acc: 0.975 Test Loss: 0.277 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 43 cost time: 0.35889577865600586
Epoch: 43, Steps: 3 | Train Loss: 0.159 Vali Loss: 0.266 Vali Acc: 0.975 Test Loss: 0.266 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 44 cost time: 0.4249453544616699
Epoch: 44, Steps: 3 | Train Loss: 0.162 Vali Loss: 0.258 Vali Acc: 0.975 Test Loss: 0.258 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 45 cost time: 0.387664794921875
Epoch: 45, Steps: 3 | Train Loss: 0.140 Vali Loss: 0.261 Vali Acc: 0.975 Test Loss: 0.261 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.3786494731903076
Epoch: 46, Steps: 3 | Train Loss: 0.149 Vali Loss: 0.257 Vali Acc: 0.975 Test Loss: 0.257 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 47 cost time: 0.3472001552581787
Epoch: 47, Steps: 3 | Train Loss: 0.138 Vali Loss: 0.247 Vali Acc: 0.975 Test Loss: 0.247 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 48 cost time: 0.4064648151397705
Epoch: 48, Steps: 3 | Train Loss: 0.131 Vali Loss: 0.252 Vali Acc: 0.975 Test Loss: 0.252 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.40866684913635254
Epoch: 49, Steps: 3 | Train Loss: 0.100 Vali Loss: 0.238 Vali Acc: 0.975 Test Loss: 0.238 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 50 cost time: 0.3644435405731201
Epoch: 50, Steps: 3 | Train Loss: 0.100 Vali Loss: 0.238 Vali Acc: 0.975 Test Loss: 0.238 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 101220
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.4948740005493164
Epoch: 1, Steps: 3 | Train Loss: 1.435 Vali Loss: 1.449 Vali Acc: 0.175 Test Loss: 1.449 Test Acc: 0.175
Validation loss decreased (inf --> -0.174986).  Saving model ...
Epoch: 2 cost time: 0.4078235626220703
Epoch: 2, Steps: 3 | Train Loss: 1.399 Vali Loss: 1.442 Vali Acc: 0.200 Test Loss: 1.442 Test Acc: 0.200
Validation loss decreased (-0.174986 --> -0.199986).  Saving model ...
Epoch: 3 cost time: 0.35573673248291016
Epoch: 3, Steps: 3 | Train Loss: 1.387 Vali Loss: 1.432 Vali Acc: 0.250 Test Loss: 1.432 Test Acc: 0.250
Validation loss decreased (-0.199986 --> -0.249986).  Saving model ...
Epoch: 4 cost time: 0.3920586109161377
Epoch: 4, Steps: 3 | Train Loss: 1.340 Vali Loss: 1.417 Vali Acc: 0.250 Test Loss: 1.417 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 5 cost time: 0.38213300704956055
Epoch: 5, Steps: 3 | Train Loss: 1.324 Vali Loss: 1.395 Vali Acc: 0.250 Test Loss: 1.395 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 6 cost time: 0.3828251361846924
Epoch: 6, Steps: 3 | Train Loss: 1.272 Vali Loss: 1.370 Vali Acc: 0.250 Test Loss: 1.370 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249986).  Saving model ...
Epoch: 7 cost time: 0.3749735355377197
Epoch: 7, Steps: 3 | Train Loss: 1.222 Vali Loss: 1.341 Vali Acc: 0.325 Test Loss: 1.341 Test Acc: 0.325
Validation loss decreased (-0.249986 --> -0.324987).  Saving model ...
Epoch: 8 cost time: 0.36241745948791504
Epoch: 8, Steps: 3 | Train Loss: 1.216 Vali Loss: 1.309 Vali Acc: 0.350 Test Loss: 1.309 Test Acc: 0.350
Validation loss decreased (-0.324987 --> -0.349987).  Saving model ...
Epoch: 9 cost time: 0.42566633224487305
Epoch: 9, Steps: 3 | Train Loss: 1.157 Vali Loss: 1.273 Vali Acc: 0.425 Test Loss: 1.273 Test Acc: 0.425
Validation loss decreased (-0.349987 --> -0.424987).  Saving model ...
Epoch: 10 cost time: 0.39633798599243164
Epoch: 10, Steps: 3 | Train Loss: 1.134 Vali Loss: 1.238 Vali Acc: 0.475 Test Loss: 1.238 Test Acc: 0.475
Validation loss decreased (-0.424987 --> -0.474988).  Saving model ...
Epoch: 11 cost time: 0.39047670364379883
Epoch: 11, Steps: 3 | Train Loss: 1.063 Vali Loss: 1.200 Vali Acc: 0.550 Test Loss: 1.200 Test Acc: 0.550
Validation loss decreased (-0.474988 --> -0.549988).  Saving model ...
Epoch: 12 cost time: 0.41823387145996094
Epoch: 12, Steps: 3 | Train Loss: 1.023 Vali Loss: 1.163 Vali Acc: 0.600 Test Loss: 1.163 Test Acc: 0.600
Validation loss decreased (-0.549988 --> -0.599988).  Saving model ...
Epoch: 13 cost time: 0.3942220211029053
Epoch: 13, Steps: 3 | Train Loss: 0.985 Vali Loss: 1.135 Vali Acc: 0.600 Test Loss: 1.135 Test Acc: 0.600
Validation loss decreased (-0.599988 --> -0.599989).  Saving model ...
Epoch: 14 cost time: 0.37835073471069336
Epoch: 14, Steps: 3 | Train Loss: 0.936 Vali Loss: 1.098 Vali Acc: 0.650 Test Loss: 1.098 Test Acc: 0.650
Validation loss decreased (-0.599989 --> -0.649989).  Saving model ...
Epoch: 15 cost time: 0.37357068061828613
Epoch: 15, Steps: 3 | Train Loss: 0.891 Vali Loss: 1.057 Vali Acc: 0.825 Test Loss: 1.057 Test Acc: 0.825
Validation loss decreased (-0.649989 --> -0.824989).  Saving model ...
Epoch: 16 cost time: 0.39105653762817383
Epoch: 16, Steps: 3 | Train Loss: 0.846 Vali Loss: 1.022 Vali Acc: 0.875 Test Loss: 1.022 Test Acc: 0.875
Validation loss decreased (-0.824989 --> -0.874990).  Saving model ...
Epoch: 17 cost time: 0.3592355251312256
Epoch: 17, Steps: 3 | Train Loss: 0.835 Vali Loss: 1.000 Vali Acc: 0.875 Test Loss: 1.000 Test Acc: 0.875
Validation loss decreased (-0.874990 --> -0.874990).  Saving model ...
Epoch: 18 cost time: 0.41405558586120605
Epoch: 18, Steps: 3 | Train Loss: 0.763 Vali Loss: 0.962 Vali Acc: 0.875 Test Loss: 0.962 Test Acc: 0.875
Validation loss decreased (-0.874990 --> -0.874990).  Saving model ...
Epoch: 19 cost time: 0.357680082321167
Epoch: 19, Steps: 3 | Train Loss: 0.733 Vali Loss: 0.924 Vali Acc: 0.875 Test Loss: 0.924 Test Acc: 0.875
Validation loss decreased (-0.874990 --> -0.874991).  Saving model ...
Epoch: 20 cost time: 0.4447321891784668
Epoch: 20, Steps: 3 | Train Loss: 0.704 Vali Loss: 0.889 Vali Acc: 0.875 Test Loss: 0.889 Test Acc: 0.875
Validation loss decreased (-0.874991 --> -0.874991).  Saving model ...
Epoch: 21 cost time: 0.3670618534088135
Epoch: 21, Steps: 3 | Train Loss: 0.645 Vali Loss: 0.863 Vali Acc: 0.875 Test Loss: 0.863 Test Acc: 0.875
Validation loss decreased (-0.874991 --> -0.874991).  Saving model ...
Epoch: 22 cost time: 0.39806532859802246
Epoch: 22, Steps: 3 | Train Loss: 0.614 Vali Loss: 0.842 Vali Acc: 0.875 Test Loss: 0.842 Test Acc: 0.875
Validation loss decreased (-0.874991 --> -0.874992).  Saving model ...
Epoch: 23 cost time: 0.39604711532592773
Epoch: 23, Steps: 3 | Train Loss: 0.611 Vali Loss: 0.800 Vali Acc: 0.875 Test Loss: 0.800 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874992).  Saving model ...
Epoch: 24 cost time: 0.3812062740325928
Epoch: 24, Steps: 3 | Train Loss: 0.608 Vali Loss: 0.762 Vali Acc: 0.875 Test Loss: 0.762 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874992).  Saving model ...
Epoch: 25 cost time: 0.3982052803039551
Epoch: 25, Steps: 3 | Train Loss: 0.520 Vali Loss: 0.740 Vali Acc: 0.850 Test Loss: 0.740 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.3991377353668213
Epoch: 26, Steps: 3 | Train Loss: 0.512 Vali Loss: 0.707 Vali Acc: 0.850 Test Loss: 0.707 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.38732314109802246
Epoch: 27, Steps: 3 | Train Loss: 0.490 Vali Loss: 0.685 Vali Acc: 0.850 Test Loss: 0.685 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.41423583030700684
Epoch: 28, Steps: 3 | Train Loss: 0.451 Vali Loss: 0.660 Vali Acc: 0.875 Test Loss: 0.660 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874993).  Saving model ...
Epoch: 29 cost time: 0.36276888847351074
Epoch: 29, Steps: 3 | Train Loss: 0.454 Vali Loss: 0.639 Vali Acc: 0.875 Test Loss: 0.639 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 30 cost time: 0.35973477363586426
Epoch: 30, Steps: 3 | Train Loss: 0.418 Vali Loss: 0.632 Vali Acc: 0.900 Test Loss: 0.632 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899994).  Saving model ...
Epoch: 31 cost time: 0.39427781105041504
Epoch: 31, Steps: 3 | Train Loss: 0.383 Vali Loss: 0.622 Vali Acc: 0.900 Test Loss: 0.622 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 32 cost time: 0.35021471977233887
Epoch: 32, Steps: 3 | Train Loss: 0.393 Vali Loss: 0.602 Vali Acc: 0.925 Test Loss: 0.602 Test Acc: 0.925
Validation loss decreased (-0.899994 --> -0.924994).  Saving model ...
Epoch: 33 cost time: 0.4195072650909424
Epoch: 33, Steps: 3 | Train Loss: 0.348 Vali Loss: 0.568 Vali Acc: 0.925 Test Loss: 0.568 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 34 cost time: 0.3655588626861572
Epoch: 34, Steps: 3 | Train Loss: 0.363 Vali Loss: 0.560 Vali Acc: 0.925 Test Loss: 0.560 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 35 cost time: 0.4055497646331787
Epoch: 35, Steps: 3 | Train Loss: 0.323 Vali Loss: 0.537 Vali Acc: 0.925 Test Loss: 0.537 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 36 cost time: 0.38512635231018066
Epoch: 36, Steps: 3 | Train Loss: 0.311 Vali Loss: 0.513 Vali Acc: 0.925 Test Loss: 0.513 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 37 cost time: 0.36920166015625
Epoch: 37, Steps: 3 | Train Loss: 0.303 Vali Loss: 0.507 Vali Acc: 0.925 Test Loss: 0.507 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 38 cost time: 0.38361024856567383
Epoch: 38, Steps: 3 | Train Loss: 0.288 Vali Loss: 0.485 Vali Acc: 0.925 Test Loss: 0.485 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 39 cost time: 0.3273489475250244
Epoch: 39, Steps: 3 | Train Loss: 0.265 Vali Loss: 0.467 Vali Acc: 0.925 Test Loss: 0.467 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 40 cost time: 0.3600790500640869
Epoch: 40, Steps: 3 | Train Loss: 0.275 Vali Loss: 0.452 Vali Acc: 0.925 Test Loss: 0.452 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 41 cost time: 0.35733485221862793
Epoch: 41, Steps: 3 | Train Loss: 0.273 Vali Loss: 0.445 Vali Acc: 0.925 Test Loss: 0.445 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 42 cost time: 0.3967018127441406
Epoch: 42, Steps: 3 | Train Loss: 0.251 Vali Loss: 0.432 Vali Acc: 0.925 Test Loss: 0.432 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 43 cost time: 0.40212106704711914
Epoch: 43, Steps: 3 | Train Loss: 0.230 Vali Loss: 0.423 Vali Acc: 0.950 Test Loss: 0.423 Test Acc: 0.950
Validation loss decreased (-0.924996 --> -0.949996).  Saving model ...
Epoch: 44 cost time: 0.4050934314727783
Epoch: 44, Steps: 3 | Train Loss: 0.238 Vali Loss: 0.427 Vali Acc: 0.950 Test Loss: 0.427 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.406414270401001
Epoch: 45, Steps: 3 | Train Loss: 0.198 Vali Loss: 0.402 Vali Acc: 0.950 Test Loss: 0.402 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 46 cost time: 0.3813321590423584
Epoch: 46, Steps: 3 | Train Loss: 0.220 Vali Loss: 0.397 Vali Acc: 0.950 Test Loss: 0.397 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 47 cost time: 0.395458459854126
Epoch: 47, Steps: 3 | Train Loss: 0.190 Vali Loss: 0.387 Vali Acc: 0.950 Test Loss: 0.387 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 48 cost time: 0.37704014778137207
Epoch: 48, Steps: 3 | Train Loss: 0.192 Vali Loss: 0.368 Vali Acc: 0.950 Test Loss: 0.368 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 49 cost time: 0.3901188373565674
Epoch: 49, Steps: 3 | Train Loss: 0.189 Vali Loss: 0.362 Vali Acc: 0.950 Test Loss: 0.362 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 50 cost time: 0.3548119068145752
Epoch: 50, Steps: 3 | Train Loss: 0.167 Vali Loss: 0.351 Vali Acc: 0.950 Test Loss: 0.351 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 95236
model size : 0.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps20_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.4934837818145752
Epoch: 1, Steps: 3 | Train Loss: 1.422 Vali Loss: 1.336 Vali Acc: 0.200 Test Loss: 1.336 Test Acc: 0.200
Validation loss decreased (inf --> -0.199987).  Saving model ...
Epoch: 2 cost time: 0.3518505096435547
Epoch: 2, Steps: 3 | Train Loss: 1.348 Vali Loss: 1.325 Vali Acc: 0.200 Test Loss: 1.325 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199987).  Saving model ...
Epoch: 3 cost time: 0.3572714328765869
Epoch: 3, Steps: 3 | Train Loss: 1.347 Vali Loss: 1.313 Vali Acc: 0.200 Test Loss: 1.313 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199987).  Saving model ...
Epoch: 4 cost time: 0.3897969722747803
Epoch: 4, Steps: 3 | Train Loss: 1.349 Vali Loss: 1.296 Vali Acc: 0.225 Test Loss: 1.296 Test Acc: 0.225
Validation loss decreased (-0.199987 --> -0.224987).  Saving model ...
Epoch: 5 cost time: 0.364595890045166
Epoch: 5, Steps: 3 | Train Loss: 1.313 Vali Loss: 1.276 Vali Acc: 0.300 Test Loss: 1.276 Test Acc: 0.300
Validation loss decreased (-0.224987 --> -0.299987).  Saving model ...
Epoch: 6 cost time: 0.3970644474029541
Epoch: 6, Steps: 3 | Train Loss: 1.272 Vali Loss: 1.253 Vali Acc: 0.325 Test Loss: 1.253 Test Acc: 0.325
Validation loss decreased (-0.299987 --> -0.324987).  Saving model ...
Epoch: 7 cost time: 0.4149281978607178
Epoch: 7, Steps: 3 | Train Loss: 1.253 Vali Loss: 1.226 Vali Acc: 0.375 Test Loss: 1.226 Test Acc: 0.375
Validation loss decreased (-0.324987 --> -0.374988).  Saving model ...
Epoch: 8 cost time: 0.4378032684326172
Epoch: 8, Steps: 3 | Train Loss: 1.198 Vali Loss: 1.198 Vali Acc: 0.425 Test Loss: 1.198 Test Acc: 0.425
Validation loss decreased (-0.374988 --> -0.424988).  Saving model ...
Epoch: 9 cost time: 0.37859606742858887
Epoch: 9, Steps: 3 | Train Loss: 1.164 Vali Loss: 1.167 Vali Acc: 0.500 Test Loss: 1.167 Test Acc: 0.500
Validation loss decreased (-0.424988 --> -0.499988).  Saving model ...
Epoch: 10 cost time: 0.3890669345855713
Epoch: 10, Steps: 3 | Train Loss: 1.108 Vali Loss: 1.139 Vali Acc: 0.550 Test Loss: 1.139 Test Acc: 0.550
Validation loss decreased (-0.499988 --> -0.549989).  Saving model ...
Epoch: 11 cost time: 0.4293642044067383
Epoch: 11, Steps: 3 | Train Loss: 1.100 Vali Loss: 1.107 Vali Acc: 0.625 Test Loss: 1.107 Test Acc: 0.625
Validation loss decreased (-0.549989 --> -0.624989).  Saving model ...
Epoch: 12 cost time: 0.35786890983581543
Epoch: 12, Steps: 3 | Train Loss: 1.056 Vali Loss: 1.072 Vali Acc: 0.625 Test Loss: 1.072 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624989).  Saving model ...
Epoch: 13 cost time: 0.3863062858581543
Epoch: 13, Steps: 3 | Train Loss: 0.983 Vali Loss: 1.040 Vali Acc: 0.625 Test Loss: 1.040 Test Acc: 0.625
Validation loss decreased (-0.624989 --> -0.624990).  Saving model ...
Epoch: 14 cost time: 0.4201979637145996
Epoch: 14, Steps: 3 | Train Loss: 0.962 Vali Loss: 1.005 Vali Acc: 0.700 Test Loss: 1.005 Test Acc: 0.700
Validation loss decreased (-0.624990 --> -0.699990).  Saving model ...
Epoch: 15 cost time: 0.3834102153778076
Epoch: 15, Steps: 3 | Train Loss: 0.920 Vali Loss: 0.967 Vali Acc: 0.675 Test Loss: 0.967 Test Acc: 0.675
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.3861546516418457
Epoch: 16, Steps: 3 | Train Loss: 0.894 Vali Loss: 0.936 Vali Acc: 0.675 Test Loss: 0.936 Test Acc: 0.675
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.3670003414154053
Epoch: 17, Steps: 3 | Train Loss: 0.849 Vali Loss: 0.909 Vali Acc: 0.775 Test Loss: 0.909 Test Acc: 0.775
Validation loss decreased (-0.699990 --> -0.774991).  Saving model ...
Epoch: 18 cost time: 0.4262728691101074
Epoch: 18, Steps: 3 | Train Loss: 0.804 Vali Loss: 0.881 Vali Acc: 0.775 Test Loss: 0.881 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 19 cost time: 0.38596415519714355
Epoch: 19, Steps: 3 | Train Loss: 0.770 Vali Loss: 0.853 Vali Acc: 0.775 Test Loss: 0.853 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774991).  Saving model ...
Epoch: 20 cost time: 0.3804049491882324
Epoch: 20, Steps: 3 | Train Loss: 0.725 Vali Loss: 0.820 Vali Acc: 0.775 Test Loss: 0.820 Test Acc: 0.775
Validation loss decreased (-0.774991 --> -0.774992).  Saving model ...
Epoch: 21 cost time: 0.38585329055786133
Epoch: 21, Steps: 3 | Train Loss: 0.733 Vali Loss: 0.784 Vali Acc: 0.825 Test Loss: 0.784 Test Acc: 0.825
Validation loss decreased (-0.774992 --> -0.824992).  Saving model ...
Epoch: 22 cost time: 0.38880276679992676
Epoch: 22, Steps: 3 | Train Loss: 0.675 Vali Loss: 0.755 Vali Acc: 0.825 Test Loss: 0.755 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824992).  Saving model ...
Epoch: 23 cost time: 0.3851795196533203
Epoch: 23, Steps: 3 | Train Loss: 0.635 Vali Loss: 0.731 Vali Acc: 0.850 Test Loss: 0.731 Test Acc: 0.850
Validation loss decreased (-0.824992 --> -0.849993).  Saving model ...
Epoch: 24 cost time: 0.3540472984313965
Epoch: 24, Steps: 3 | Train Loss: 0.590 Vali Loss: 0.721 Vali Acc: 0.850 Test Loss: 0.721 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 25 cost time: 0.3888978958129883
Epoch: 25, Steps: 3 | Train Loss: 0.590 Vali Loss: 0.695 Vali Acc: 0.850 Test Loss: 0.695 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 26 cost time: 0.3788011074066162
Epoch: 26, Steps: 3 | Train Loss: 0.556 Vali Loss: 0.672 Vali Acc: 0.850 Test Loss: 0.672 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 27 cost time: 0.40001440048217773
Epoch: 27, Steps: 3 | Train Loss: 0.543 Vali Loss: 0.656 Vali Acc: 0.850 Test Loss: 0.656 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849993).  Saving model ...
Epoch: 28 cost time: 0.3482189178466797
Epoch: 28, Steps: 3 | Train Loss: 0.529 Vali Loss: 0.631 Vali Acc: 0.850 Test Loss: 0.631 Test Acc: 0.850
Validation loss decreased (-0.849993 --> -0.849994).  Saving model ...
Epoch: 29 cost time: 0.38137292861938477
Epoch: 29, Steps: 3 | Train Loss: 0.505 Vali Loss: 0.610 Vali Acc: 0.875 Test Loss: 0.610 Test Acc: 0.875
Validation loss decreased (-0.849994 --> -0.874994).  Saving model ...
Epoch: 30 cost time: 0.35872483253479004
Epoch: 30, Steps: 3 | Train Loss: 0.482 Vali Loss: 0.586 Vali Acc: 0.925 Test Loss: 0.586 Test Acc: 0.925
Validation loss decreased (-0.874994 --> -0.924994).  Saving model ...
Epoch: 31 cost time: 0.3984522819519043
Epoch: 31, Steps: 3 | Train Loss: 0.461 Vali Loss: 0.557 Vali Acc: 0.950 Test Loss: 0.557 Test Acc: 0.950
Validation loss decreased (-0.924994 --> -0.949994).  Saving model ...
Epoch: 32 cost time: 0.3664579391479492
Epoch: 32, Steps: 3 | Train Loss: 0.441 Vali Loss: 0.550 Vali Acc: 0.925 Test Loss: 0.550 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.4314093589782715
Epoch: 33, Steps: 3 | Train Loss: 0.447 Vali Loss: 0.529 Vali Acc: 0.925 Test Loss: 0.529 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.374737024307251
Epoch: 34, Steps: 3 | Train Loss: 0.410 Vali Loss: 0.518 Vali Acc: 0.925 Test Loss: 0.518 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.3792288303375244
Epoch: 35, Steps: 3 | Train Loss: 0.408 Vali Loss: 0.502 Vali Acc: 0.925 Test Loss: 0.502 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.36409711837768555
Epoch: 36, Steps: 3 | Train Loss: 0.395 Vali Loss: 0.494 Vali Acc: 0.925 Test Loss: 0.494 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.3618772029876709
Epoch: 37, Steps: 3 | Train Loss: 0.374 Vali Loss: 0.476 Vali Acc: 0.925 Test Loss: 0.476 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.385326623916626
Epoch: 38, Steps: 3 | Train Loss: 0.349 Vali Loss: 0.458 Vali Acc: 0.925 Test Loss: 0.458 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.4041712284088135
Epoch: 39, Steps: 3 | Train Loss: 0.353 Vali Loss: 0.441 Vali Acc: 0.925 Test Loss: 0.441 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.3772308826446533
Epoch: 40, Steps: 3 | Train Loss: 0.327 Vali Loss: 0.436 Vali Acc: 0.925 Test Loss: 0.436 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.44268059730529785
Epoch: 41, Steps: 3 | Train Loss: 0.325 Vali Loss: 0.425 Vali Acc: 0.925 Test Loss: 0.425 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps20_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 93860
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps25_str13_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.509289026260376
Epoch: 1, Steps: 3 | Train Loss: 1.415 Vali Loss: 1.368 Vali Acc: 0.375 Test Loss: 1.368 Test Acc: 0.375
Validation loss decreased (inf --> -0.374986).  Saving model ...
Epoch: 2 cost time: 0.37958455085754395
Epoch: 2, Steps: 3 | Train Loss: 1.384 Vali Loss: 1.356 Vali Acc: 0.375 Test Loss: 1.356 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374986).  Saving model ...
Epoch: 3 cost time: 0.3694157600402832
Epoch: 3, Steps: 3 | Train Loss: 1.392 Vali Loss: 1.346 Vali Acc: 0.375 Test Loss: 1.346 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374987).  Saving model ...
Epoch: 4 cost time: 0.42316436767578125
Epoch: 4, Steps: 3 | Train Loss: 1.370 Vali Loss: 1.331 Vali Acc: 0.400 Test Loss: 1.331 Test Acc: 0.400
Validation loss decreased (-0.374987 --> -0.399987).  Saving model ...
Epoch: 5 cost time: 0.3978865146636963
Epoch: 5, Steps: 3 | Train Loss: 1.341 Vali Loss: 1.313 Vali Acc: 0.425 Test Loss: 1.313 Test Acc: 0.425
Validation loss decreased (-0.399987 --> -0.424987).  Saving model ...
Epoch: 6 cost time: 0.38636183738708496
Epoch: 6, Steps: 3 | Train Loss: 1.292 Vali Loss: 1.289 Vali Acc: 0.475 Test Loss: 1.289 Test Acc: 0.475
Validation loss decreased (-0.424987 --> -0.474987).  Saving model ...
Epoch: 7 cost time: 0.36256909370422363
Epoch: 7, Steps: 3 | Train Loss: 1.266 Vali Loss: 1.265 Vali Acc: 0.500 Test Loss: 1.265 Test Acc: 0.500
Validation loss decreased (-0.474987 --> -0.499987).  Saving model ...
Epoch: 8 cost time: 0.4050478935241699
Epoch: 8, Steps: 3 | Train Loss: 1.254 Vali Loss: 1.237 Vali Acc: 0.525 Test Loss: 1.237 Test Acc: 0.525
Validation loss decreased (-0.499987 --> -0.524988).  Saving model ...
Epoch: 9 cost time: 0.39080190658569336
Epoch: 9, Steps: 3 | Train Loss: 1.221 Vali Loss: 1.210 Vali Acc: 0.550 Test Loss: 1.210 Test Acc: 0.550
Validation loss decreased (-0.524988 --> -0.549988).  Saving model ...
Epoch: 10 cost time: 0.34488940238952637
Epoch: 10, Steps: 3 | Train Loss: 1.169 Vali Loss: 1.180 Vali Acc: 0.600 Test Loss: 1.180 Test Acc: 0.600
Validation loss decreased (-0.549988 --> -0.599988).  Saving model ...
Epoch: 11 cost time: 0.44580578804016113
Epoch: 11, Steps: 3 | Train Loss: 1.153 Vali Loss: 1.152 Vali Acc: 0.650 Test Loss: 1.152 Test Acc: 0.650
Validation loss decreased (-0.599988 --> -0.649988).  Saving model ...
Epoch: 12 cost time: 0.3684720993041992
Epoch: 12, Steps: 3 | Train Loss: 1.091 Vali Loss: 1.124 Vali Acc: 0.675 Test Loss: 1.124 Test Acc: 0.675
Validation loss decreased (-0.649988 --> -0.674989).  Saving model ...
Epoch: 13 cost time: 0.43007469177246094
Epoch: 13, Steps: 3 | Train Loss: 1.073 Vali Loss: 1.090 Vali Acc: 0.725 Test Loss: 1.090 Test Acc: 0.725
Validation loss decreased (-0.674989 --> -0.724989).  Saving model ...
Epoch: 14 cost time: 0.43347859382629395
Epoch: 14, Steps: 3 | Train Loss: 1.039 Vali Loss: 1.056 Vali Acc: 0.725 Test Loss: 1.056 Test Acc: 0.725
Validation loss decreased (-0.724989 --> -0.724989).  Saving model ...
Epoch: 15 cost time: 0.35109901428222656
Epoch: 15, Steps: 3 | Train Loss: 0.976 Vali Loss: 1.029 Vali Acc: 0.750 Test Loss: 1.029 Test Acc: 0.750
Validation loss decreased (-0.724989 --> -0.749990).  Saving model ...
Epoch: 16 cost time: 0.37585020065307617
Epoch: 16, Steps: 3 | Train Loss: 0.954 Vali Loss: 1.008 Vali Acc: 0.750 Test Loss: 1.008 Test Acc: 0.750
Validation loss decreased (-0.749990 --> -0.749990).  Saving model ...
Epoch: 17 cost time: 0.37563061714172363
Epoch: 17, Steps: 3 | Train Loss: 0.928 Vali Loss: 0.979 Vali Acc: 0.775 Test Loss: 0.979 Test Acc: 0.775
Validation loss decreased (-0.749990 --> -0.774990).  Saving model ...
Epoch: 18 cost time: 0.36605286598205566
Epoch: 18, Steps: 3 | Train Loss: 0.892 Vali Loss: 0.950 Vali Acc: 0.775 Test Loss: 0.950 Test Acc: 0.775
Validation loss decreased (-0.774990 --> -0.774990).  Saving model ...
Epoch: 19 cost time: 0.3699181079864502
Epoch: 19, Steps: 3 | Train Loss: 0.853 Vali Loss: 0.925 Vali Acc: 0.775 Test Loss: 0.925 Test Acc: 0.775
Validation loss decreased (-0.774990 --> -0.774991).  Saving model ...
Epoch: 20 cost time: 0.3903985023498535
Epoch: 20, Steps: 3 | Train Loss: 0.818 Vali Loss: 0.904 Vali Acc: 0.800 Test Loss: 0.904 Test Acc: 0.800
Validation loss decreased (-0.774991 --> -0.799991).  Saving model ...
Epoch: 21 cost time: 0.4374055862426758
Epoch: 21, Steps: 3 | Train Loss: 0.795 Vali Loss: 0.884 Vali Acc: 0.875 Test Loss: 0.884 Test Acc: 0.875
Validation loss decreased (-0.799991 --> -0.874991).  Saving model ...
Epoch: 22 cost time: 0.4210777282714844
Epoch: 22, Steps: 3 | Train Loss: 0.745 Vali Loss: 0.857 Vali Acc: 0.875 Test Loss: 0.857 Test Acc: 0.875
Validation loss decreased (-0.874991 --> -0.874991).  Saving model ...
Epoch: 23 cost time: 0.3831322193145752
Epoch: 23, Steps: 3 | Train Loss: 0.763 Vali Loss: 0.822 Vali Acc: 0.875 Test Loss: 0.822 Test Acc: 0.875
Validation loss decreased (-0.874991 --> -0.874992).  Saving model ...
Epoch: 24 cost time: 0.3533761501312256
Epoch: 24, Steps: 3 | Train Loss: 0.703 Vali Loss: 0.802 Vali Acc: 0.875 Test Loss: 0.802 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874992).  Saving model ...
Epoch: 25 cost time: 0.4373018741607666
Epoch: 25, Steps: 3 | Train Loss: 0.681 Vali Loss: 0.778 Vali Acc: 0.875 Test Loss: 0.778 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874992).  Saving model ...
Epoch: 26 cost time: 0.3923943042755127
Epoch: 26, Steps: 3 | Train Loss: 0.663 Vali Loss: 0.752 Vali Acc: 0.900 Test Loss: 0.752 Test Acc: 0.900
Validation loss decreased (-0.874992 --> -0.899992).  Saving model ...
Epoch: 27 cost time: 0.4095742702484131
Epoch: 27, Steps: 3 | Train Loss: 0.612 Vali Loss: 0.736 Vali Acc: 0.925 Test Loss: 0.736 Test Acc: 0.925
Validation loss decreased (-0.899992 --> -0.924993).  Saving model ...
Epoch: 28 cost time: 0.39360618591308594
Epoch: 28, Steps: 3 | Train Loss: 0.600 Vali Loss: 0.718 Vali Acc: 0.925 Test Loss: 0.718 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924993).  Saving model ...
Epoch: 29 cost time: 0.38468456268310547
Epoch: 29, Steps: 3 | Train Loss: 0.585 Vali Loss: 0.694 Vali Acc: 0.925 Test Loss: 0.694 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924993).  Saving model ...
Epoch: 30 cost time: 0.3854377269744873
Epoch: 30, Steps: 3 | Train Loss: 0.552 Vali Loss: 0.676 Vali Acc: 0.925 Test Loss: 0.676 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924993).  Saving model ...
Epoch: 31 cost time: 0.34543681144714355
Epoch: 31, Steps: 3 | Train Loss: 0.545 Vali Loss: 0.656 Vali Acc: 0.925 Test Loss: 0.656 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924993).  Saving model ...
Epoch: 32 cost time: 0.41631174087524414
Epoch: 32, Steps: 3 | Train Loss: 0.520 Vali Loss: 0.632 Vali Acc: 0.925 Test Loss: 0.632 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924994).  Saving model ...
Epoch: 33 cost time: 0.3771958351135254
Epoch: 33, Steps: 3 | Train Loss: 0.490 Vali Loss: 0.610 Vali Acc: 0.925 Test Loss: 0.610 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 34 cost time: 0.3934786319732666
Epoch: 34, Steps: 3 | Train Loss: 0.436 Vali Loss: 0.593 Vali Acc: 0.925 Test Loss: 0.593 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 35 cost time: 0.3934957981109619
Epoch: 35, Steps: 3 | Train Loss: 0.426 Vali Loss: 0.575 Vali Acc: 0.925 Test Loss: 0.575 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 36 cost time: 0.3972141742706299
Epoch: 36, Steps: 3 | Train Loss: 0.425 Vali Loss: 0.566 Vali Acc: 0.925 Test Loss: 0.566 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 37 cost time: 0.43660926818847656
Epoch: 37, Steps: 3 | Train Loss: 0.399 Vali Loss: 0.543 Vali Acc: 0.925 Test Loss: 0.543 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 38 cost time: 0.3932971954345703
Epoch: 38, Steps: 3 | Train Loss: 0.390 Vali Loss: 0.528 Vali Acc: 0.950 Test Loss: 0.528 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949995).  Saving model ...
Epoch: 39 cost time: 0.3982977867126465
Epoch: 39, Steps: 3 | Train Loss: 0.362 Vali Loss: 0.500 Vali Acc: 0.950 Test Loss: 0.500 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 40 cost time: 0.35507845878601074
Epoch: 40, Steps: 3 | Train Loss: 0.364 Vali Loss: 0.482 Vali Acc: 0.950 Test Loss: 0.482 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 41 cost time: 0.3769717216491699
Epoch: 41, Steps: 3 | Train Loss: 0.342 Vali Loss: 0.459 Vali Acc: 0.950 Test Loss: 0.459 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 42 cost time: 0.36615443229675293
Epoch: 42, Steps: 3 | Train Loss: 0.354 Vali Loss: 0.448 Vali Acc: 0.950 Test Loss: 0.448 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 43 cost time: 0.3933537006378174
Epoch: 43, Steps: 3 | Train Loss: 0.324 Vali Loss: 0.438 Vali Acc: 0.950 Test Loss: 0.438 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 44 cost time: 0.47691845893859863
Epoch: 44, Steps: 3 | Train Loss: 0.284 Vali Loss: 0.430 Vali Acc: 0.950 Test Loss: 0.430 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 45 cost time: 0.37518930435180664
Epoch: 45, Steps: 3 | Train Loss: 0.273 Vali Loss: 0.427 Vali Acc: 0.950 Test Loss: 0.427 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 46 cost time: 0.38407373428344727
Epoch: 46, Steps: 3 | Train Loss: 0.279 Vali Loss: 0.413 Vali Acc: 0.950 Test Loss: 0.413 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 47 cost time: 0.4062991142272949
Epoch: 47, Steps: 3 | Train Loss: 0.256 Vali Loss: 0.400 Vali Acc: 0.950 Test Loss: 0.400 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 48 cost time: 0.39098668098449707
Epoch: 48, Steps: 3 | Train Loss: 0.249 Vali Loss: 0.395 Vali Acc: 0.950 Test Loss: 0.395 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 49 cost time: 0.3619804382324219
Epoch: 49, Steps: 3 | Train Loss: 0.249 Vali Loss: 0.382 Vali Acc: 0.950 Test Loss: 0.382 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 50 cost time: 0.35760021209716797
Epoch: 50, Steps: 3 | Train Loss: 0.225 Vali Loss: 0.370 Vali Acc: 0.950 Test Loss: 0.370 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps25_str13_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 92484
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.5302202701568604
Epoch: 1, Steps: 3 | Train Loss: 1.395 Vali Loss: 1.231 Vali Acc: 0.350 Test Loss: 1.231 Test Acc: 0.350
Validation loss decreased (inf --> -0.349988).  Saving model ...
Epoch: 2 cost time: 0.35860657691955566
Epoch: 2, Steps: 3 | Train Loss: 1.063 Vali Loss: 1.058 Vali Acc: 0.650 Test Loss: 1.058 Test Acc: 0.650
Validation loss decreased (-0.349988 --> -0.649989).  Saving model ...
Epoch: 3 cost time: 0.4410536289215088
Epoch: 3, Steps: 3 | Train Loss: 0.724 Vali Loss: 0.731 Vali Acc: 0.900 Test Loss: 0.731 Test Acc: 0.900
Validation loss decreased (-0.649989 --> -0.899993).  Saving model ...
Epoch: 4 cost time: 0.43834757804870605
Epoch: 4, Steps: 3 | Train Loss: 0.449 Vali Loss: 0.469 Vali Acc: 0.950 Test Loss: 0.469 Test Acc: 0.950
Validation loss decreased (-0.899993 --> -0.949995).  Saving model ...
Epoch: 5 cost time: 0.43545961380004883
Epoch: 5, Steps: 3 | Train Loss: 0.266 Vali Loss: 0.310 Vali Acc: 0.950 Test Loss: 0.310 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949997).  Saving model ...
Epoch: 6 cost time: 0.3784027099609375
Epoch: 6, Steps: 3 | Train Loss: 0.161 Vali Loss: 0.240 Vali Acc: 0.975 Test Loss: 0.240 Test Acc: 0.975
Validation loss decreased (-0.949997 --> -0.974998).  Saving model ...
Epoch: 7 cost time: 0.4101531505584717
Epoch: 7, Steps: 3 | Train Loss: 0.141 Vali Loss: 0.223 Vali Acc: 0.925 Test Loss: 0.223 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.4277153015136719
Epoch: 8, Steps: 3 | Train Loss: 0.068 Vali Loss: 0.228 Vali Acc: 0.950 Test Loss: 0.228 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.4037449359893799
Epoch: 9, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.266 Vali Acc: 0.925 Test Loss: 0.266 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.4337596893310547
Epoch: 10, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.251 Vali Acc: 0.925 Test Loss: 0.251 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.4279501438140869
Epoch: 11, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.238 Vali Acc: 0.950 Test Loss: 0.238 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.4235713481903076
Epoch: 12, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.255 Vali Acc: 0.950 Test Loss: 0.255 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.3826727867126465
Epoch: 13, Steps: 3 | Train Loss: 0.006 Vali Loss: 0.262 Vali Acc: 0.950 Test Loss: 0.262 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.4301869869232178
Epoch: 14, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.277 Vali Acc: 0.950 Test Loss: 0.277 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.43426036834716797
Epoch: 15, Steps: 3 | Train Loss: 0.005 Vali Loss: 0.283 Vali Acc: 0.950 Test Loss: 0.283 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.42121315002441406
Epoch: 16, Steps: 3 | Train Loss: 0.004 Vali Loss: 0.293 Vali Acc: 0.950 Test Loss: 0.293 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 1154052
model size : 4.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.413759708404541
Epoch: 1, Steps: 3 | Train Loss: 1.305 Vali Loss: 1.198 Vali Acc: 0.475 Test Loss: 1.198 Test Acc: 0.475
Validation loss decreased (inf --> -0.474988).  Saving model ...
Epoch: 2 cost time: 0.4233541488647461
Epoch: 2, Steps: 3 | Train Loss: 1.129 Vali Loss: 1.057 Vali Acc: 0.625 Test Loss: 1.057 Test Acc: 0.625
Validation loss decreased (-0.474988 --> -0.624989).  Saving model ...
Epoch: 3 cost time: 0.3996732234954834
Epoch: 3, Steps: 3 | Train Loss: 0.884 Vali Loss: 0.807 Vali Acc: 0.825 Test Loss: 0.807 Test Acc: 0.825
Validation loss decreased (-0.624989 --> -0.824992).  Saving model ...
Epoch: 4 cost time: 0.49454736709594727
Epoch: 4, Steps: 3 | Train Loss: 0.573 Vali Loss: 0.556 Vali Acc: 0.975 Test Loss: 0.556 Test Acc: 0.975
Validation loss decreased (-0.824992 --> -0.974994).  Saving model ...
Epoch: 5 cost time: 0.43797850608825684
Epoch: 5, Steps: 3 | Train Loss: 0.374 Vali Loss: 0.373 Vali Acc: 0.975 Test Loss: 0.373 Test Acc: 0.975
Validation loss decreased (-0.974994 --> -0.974996).  Saving model ...
Epoch: 6 cost time: 0.4050467014312744
Epoch: 6, Steps: 3 | Train Loss: 0.257 Vali Loss: 0.276 Vali Acc: 0.950 Test Loss: 0.276 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.4385533332824707
Epoch: 7, Steps: 3 | Train Loss: 0.186 Vali Loss: 0.216 Vali Acc: 0.975 Test Loss: 0.216 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974998).  Saving model ...
Epoch: 8 cost time: 0.4208097457885742
Epoch: 8, Steps: 3 | Train Loss: 0.103 Vali Loss: 0.181 Vali Acc: 0.975 Test Loss: 0.181 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 9 cost time: 0.4634711742401123
Epoch: 9, Steps: 3 | Train Loss: 0.089 Vali Loss: 0.180 Vali Acc: 0.950 Test Loss: 0.180 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.4139986038208008
Epoch: 10, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.181 Vali Acc: 0.950 Test Loss: 0.181 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.4610731601715088
Epoch: 11, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.208 Vali Acc: 0.950 Test Loss: 0.208 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.4534273147583008
Epoch: 12, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.237 Vali Acc: 0.950 Test Loss: 0.237 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.4272298812866211
Epoch: 13, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.242 Vali Acc: 0.950 Test Loss: 0.242 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.40451860427856445
Epoch: 14, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.240 Vali Acc: 0.950 Test Loss: 0.240 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.4613642692565918
Epoch: 15, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.231 Vali Acc: 0.950 Test Loss: 0.231 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.4170410633087158
Epoch: 16, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.221 Vali Acc: 0.950 Test Loss: 0.221 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.37673497200012207
Epoch: 17, Steps: 3 | Train Loss: 0.007 Vali Loss: 0.216 Vali Acc: 0.950 Test Loss: 0.216 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.4287865161895752
Epoch: 18, Steps: 3 | Train Loss: 0.008 Vali Loss: 0.213 Vali Acc: 0.950 Test Loss: 0.213 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 1050116
model size : 4.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.5293686389923096
Epoch: 1, Steps: 3 | Train Loss: 1.426 Vali Loss: 1.450 Vali Acc: 0.175 Test Loss: 1.450 Test Acc: 0.175
Validation loss decreased (inf --> -0.174985).  Saving model ...
Epoch: 2 cost time: 0.4359307289123535
Epoch: 2, Steps: 3 | Train Loss: 1.205 Vali Loss: 1.313 Vali Acc: 0.175 Test Loss: 1.313 Test Acc: 0.175
Validation loss decreased (-0.174985 --> -0.174987).  Saving model ...
Epoch: 3 cost time: 0.4185159206390381
Epoch: 3, Steps: 3 | Train Loss: 1.062 Vali Loss: 1.059 Vali Acc: 0.525 Test Loss: 1.059 Test Acc: 0.525
Validation loss decreased (-0.174987 --> -0.524989).  Saving model ...
Epoch: 4 cost time: 0.3862767219543457
Epoch: 4, Steps: 3 | Train Loss: 0.722 Vali Loss: 0.812 Vali Acc: 0.875 Test Loss: 0.812 Test Acc: 0.875
Validation loss decreased (-0.524989 --> -0.874992).  Saving model ...
Epoch: 5 cost time: 0.43112874031066895
Epoch: 5, Steps: 3 | Train Loss: 0.499 Vali Loss: 0.587 Vali Acc: 0.950 Test Loss: 0.587 Test Acc: 0.950
Validation loss decreased (-0.874992 --> -0.949994).  Saving model ...
Epoch: 6 cost time: 0.41243410110473633
Epoch: 6, Steps: 3 | Train Loss: 0.320 Vali Loss: 0.410 Vali Acc: 0.950 Test Loss: 0.410 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949996).  Saving model ...
Epoch: 7 cost time: 0.435744047164917
Epoch: 7, Steps: 3 | Train Loss: 0.217 Vali Loss: 0.309 Vali Acc: 0.975 Test Loss: 0.309 Test Acc: 0.975
Validation loss decreased (-0.949996 --> -0.974997).  Saving model ...
Epoch: 8 cost time: 0.39839959144592285
Epoch: 8, Steps: 3 | Train Loss: 0.154 Vali Loss: 0.275 Vali Acc: 0.950 Test Loss: 0.275 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.4151780605316162
Epoch: 9, Steps: 3 | Train Loss: 0.145 Vali Loss: 0.273 Vali Acc: 0.925 Test Loss: 0.273 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.3881356716156006
Epoch: 10, Steps: 3 | Train Loss: 0.091 Vali Loss: 0.287 Vali Acc: 0.925 Test Loss: 0.287 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.43030810356140137
Epoch: 11, Steps: 3 | Train Loss: 0.075 Vali Loss: 0.302 Vali Acc: 0.925 Test Loss: 0.302 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.3782918453216553
Epoch: 12, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.313 Vali Acc: 0.900 Test Loss: 0.313 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.4320836067199707
Epoch: 13, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.284 Vali Acc: 0.925 Test Loss: 0.284 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.4490220546722412
Epoch: 14, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.257 Vali Acc: 0.925 Test Loss: 0.257 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.42767834663391113
Epoch: 15, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.240 Vali Acc: 0.925 Test Loss: 0.240 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.5392346382141113
Epoch: 16, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.227 Vali Acc: 0.925 Test Loss: 0.227 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.40848803520202637
Epoch: 17, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.224 Vali Acc: 0.925 Test Loss: 0.224 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 1001732
model size : 3.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.528144121170044
Epoch: 1, Steps: 3 | Train Loss: 1.464 Vali Loss: 1.342 Vali Acc: 0.200 Test Loss: 1.342 Test Acc: 0.200
Validation loss decreased (inf --> -0.199987).  Saving model ...
Epoch: 2 cost time: 0.39620256423950195
Epoch: 2, Steps: 3 | Train Loss: 1.306 Vali Loss: 1.218 Vali Acc: 0.375 Test Loss: 1.218 Test Acc: 0.375
Validation loss decreased (-0.199987 --> -0.374988).  Saving model ...
Epoch: 3 cost time: 0.40441131591796875
Epoch: 3, Steps: 3 | Train Loss: 1.099 Vali Loss: 0.989 Vali Acc: 0.750 Test Loss: 0.989 Test Acc: 0.750
Validation loss decreased (-0.374988 --> -0.749990).  Saving model ...
Epoch: 4 cost time: 0.4013702869415283
Epoch: 4, Steps: 3 | Train Loss: 0.749 Vali Loss: 0.770 Vali Acc: 0.900 Test Loss: 0.770 Test Acc: 0.900
Validation loss decreased (-0.749990 --> -0.899992).  Saving model ...
Epoch: 5 cost time: 0.43393564224243164
Epoch: 5, Steps: 3 | Train Loss: 0.582 Vali Loss: 0.588 Vali Acc: 0.950 Test Loss: 0.588 Test Acc: 0.950
Validation loss decreased (-0.899992 --> -0.949994).  Saving model ...
Epoch: 6 cost time: 0.43045735359191895
Epoch: 6, Steps: 3 | Train Loss: 0.400 Vali Loss: 0.434 Vali Acc: 0.950 Test Loss: 0.434 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949996).  Saving model ...
Epoch: 7 cost time: 0.4507589340209961
Epoch: 7, Steps: 3 | Train Loss: 0.309 Vali Loss: 0.332 Vali Acc: 0.950 Test Loss: 0.332 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 8 cost time: 0.3780226707458496
Epoch: 8, Steps: 3 | Train Loss: 0.238 Vali Loss: 0.269 Vali Acc: 0.950 Test Loss: 0.269 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 9 cost time: 0.3564581871032715
Epoch: 9, Steps: 3 | Train Loss: 0.161 Vali Loss: 0.226 Vali Acc: 0.950 Test Loss: 0.226 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 10 cost time: 0.3872654438018799
Epoch: 10, Steps: 3 | Train Loss: 0.147 Vali Loss: 0.194 Vali Acc: 0.975 Test Loss: 0.194 Test Acc: 0.975
Validation loss decreased (-0.949998 --> -0.974998).  Saving model ...
Epoch: 11 cost time: 0.39372849464416504
Epoch: 11, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.170 Vali Acc: 0.975 Test Loss: 0.170 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 12 cost time: 0.36385464668273926
Epoch: 12, Steps: 3 | Train Loss: 0.072 Vali Loss: 0.160 Vali Acc: 0.975 Test Loss: 0.160 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 13 cost time: 0.38363122940063477
Epoch: 13, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.163 Vali Acc: 0.950 Test Loss: 0.163 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.3811347484588623
Epoch: 14, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.176 Vali Acc: 0.950 Test Loss: 0.176 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.3775806427001953
Epoch: 15, Steps: 3 | Train Loss: 0.030 Vali Loss: 0.185 Vali Acc: 0.950 Test Loss: 0.185 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.3870201110839844
Epoch: 16, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.153 Vali Acc: 0.950 Test Loss: 0.153 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.38921022415161133
Epoch: 17, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.145 Vali Acc: 0.950 Test Loss: 0.145 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.406980037689209
Epoch: 18, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.138 Vali Acc: 0.950 Test Loss: 0.138 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.4091520309448242
Epoch: 19, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.140 Vali Acc: 0.950 Test Loss: 0.140 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.3863043785095215
Epoch: 20, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.138 Vali Acc: 0.950 Test Loss: 0.138 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.40209293365478516
Epoch: 21, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.140 Vali Acc: 0.950 Test Loss: 0.140 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.5317339897155762
Epoch: 22, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.139 Vali Acc: 0.950 Test Loss: 0.139 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 971524
model size : 3.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.409782886505127
Epoch: 1, Steps: 3 | Train Loss: 1.468 Vali Loss: 1.254 Vali Acc: 0.375 Test Loss: 1.254 Test Acc: 0.375
Validation loss decreased (inf --> -0.374987).  Saving model ...
Epoch: 2 cost time: 0.36097145080566406
Epoch: 2, Steps: 3 | Train Loss: 1.317 Vali Loss: 1.164 Vali Acc: 0.400 Test Loss: 1.164 Test Acc: 0.400
Validation loss decreased (-0.374987 --> -0.399988).  Saving model ...
Epoch: 3 cost time: 0.3991429805755615
Epoch: 3, Steps: 3 | Train Loss: 1.075 Vali Loss: 1.018 Vali Acc: 0.525 Test Loss: 1.018 Test Acc: 0.525
Validation loss decreased (-0.399988 --> -0.524990).  Saving model ...
Epoch: 4 cost time: 0.3463747501373291
Epoch: 4, Steps: 3 | Train Loss: 0.908 Vali Loss: 0.860 Vali Acc: 0.725 Test Loss: 0.860 Test Acc: 0.725
Validation loss decreased (-0.524990 --> -0.724991).  Saving model ...
Epoch: 5 cost time: 0.3966405391693115
Epoch: 5, Steps: 3 | Train Loss: 0.704 Vali Loss: 0.717 Vali Acc: 0.900 Test Loss: 0.717 Test Acc: 0.900
Validation loss decreased (-0.724991 --> -0.899993).  Saving model ...
Epoch: 6 cost time: 0.34449291229248047
Epoch: 6, Steps: 3 | Train Loss: 0.586 Vali Loss: 0.575 Vali Acc: 0.925 Test Loss: 0.575 Test Acc: 0.925
Validation loss decreased (-0.899993 --> -0.924994).  Saving model ...
Epoch: 7 cost time: 0.3157627582550049
Epoch: 7, Steps: 3 | Train Loss: 0.450 Vali Loss: 0.468 Vali Acc: 0.950 Test Loss: 0.468 Test Acc: 0.950
Validation loss decreased (-0.924994 --> -0.949995).  Saving model ...
Epoch: 8 cost time: 0.3248155117034912
Epoch: 8, Steps: 3 | Train Loss: 0.344 Vali Loss: 0.378 Vali Acc: 0.950 Test Loss: 0.378 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 9 cost time: 0.37699317932128906
Epoch: 9, Steps: 3 | Train Loss: 0.267 Vali Loss: 0.308 Vali Acc: 0.950 Test Loss: 0.308 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 10 cost time: 0.34612202644348145
Epoch: 10, Steps: 3 | Train Loss: 0.215 Vali Loss: 0.265 Vali Acc: 0.975 Test Loss: 0.265 Test Acc: 0.975
Validation loss decreased (-0.949997 --> -0.974997).  Saving model ...
Epoch: 11 cost time: 0.37504076957702637
Epoch: 11, Steps: 3 | Train Loss: 0.168 Vali Loss: 0.236 Vali Acc: 0.975 Test Loss: 0.236 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 12 cost time: 0.39093828201293945
Epoch: 12, Steps: 3 | Train Loss: 0.153 Vali Loss: 0.215 Vali Acc: 0.975 Test Loss: 0.215 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 13 cost time: 0.3675072193145752
Epoch: 13, Steps: 3 | Train Loss: 0.111 Vali Loss: 0.207 Vali Acc: 0.975 Test Loss: 0.207 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 14 cost time: 0.32831835746765137
Epoch: 14, Steps: 3 | Train Loss: 0.087 Vali Loss: 0.198 Vali Acc: 0.950 Test Loss: 0.198 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.3789670467376709
Epoch: 15, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.197 Vali Acc: 0.950 Test Loss: 0.197 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.3953835964202881
Epoch: 16, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.198 Vali Acc: 0.950 Test Loss: 0.198 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.3439211845397949
Epoch: 17, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.190 Vali Acc: 0.950 Test Loss: 0.190 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.42607641220092773
Epoch: 18, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.187 Vali Acc: 0.950 Test Loss: 0.187 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.3164799213409424
Epoch: 19, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.182 Vali Acc: 0.950 Test Loss: 0.182 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.3562886714935303
Epoch: 20, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.174 Vali Acc: 0.950 Test Loss: 0.174 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.3827822208404541
Epoch: 21, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.173 Vali Acc: 0.950 Test Loss: 0.173 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.3608815670013428
Epoch: 22, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.172 Vali Acc: 0.950 Test Loss: 0.172 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.33750152587890625
Epoch: 23, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.179 Vali Acc: 0.950 Test Loss: 0.179 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 923652
model size : 3.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps20_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.530592679977417
Epoch: 1, Steps: 3 | Train Loss: 1.391 Vali Loss: 1.287 Vali Acc: 0.425 Test Loss: 1.287 Test Acc: 0.425
Validation loss decreased (inf --> -0.424987).  Saving model ...
Epoch: 2 cost time: 0.41208839416503906
Epoch: 2, Steps: 3 | Train Loss: 1.246 Vali Loss: 1.196 Vali Acc: 0.500 Test Loss: 1.196 Test Acc: 0.500
Validation loss decreased (-0.424987 --> -0.499988).  Saving model ...
Epoch: 3 cost time: 0.4306657314300537
Epoch: 3, Steps: 3 | Train Loss: 1.071 Vali Loss: 1.058 Vali Acc: 0.600 Test Loss: 1.058 Test Acc: 0.600
Validation loss decreased (-0.499988 --> -0.599989).  Saving model ...
Epoch: 4 cost time: 0.39720726013183594
Epoch: 4, Steps: 3 | Train Loss: 0.897 Vali Loss: 0.899 Vali Acc: 0.700 Test Loss: 0.899 Test Acc: 0.700
Validation loss decreased (-0.599989 --> -0.699991).  Saving model ...
Epoch: 5 cost time: 0.47063565254211426
Epoch: 5, Steps: 3 | Train Loss: 0.751 Vali Loss: 0.752 Vali Acc: 0.975 Test Loss: 0.752 Test Acc: 0.975
Validation loss decreased (-0.699991 --> -0.974992).  Saving model ...
Epoch: 6 cost time: 0.3601353168487549
Epoch: 6, Steps: 3 | Train Loss: 0.578 Vali Loss: 0.624 Vali Acc: 0.975 Test Loss: 0.624 Test Acc: 0.975
Validation loss decreased (-0.974992 --> -0.974994).  Saving model ...
Epoch: 7 cost time: 0.4391520023345947
Epoch: 7, Steps: 3 | Train Loss: 0.484 Vali Loss: 0.507 Vali Acc: 0.975 Test Loss: 0.507 Test Acc: 0.975
Validation loss decreased (-0.974994 --> -0.974995).  Saving model ...
Epoch: 8 cost time: 0.45992112159729004
Epoch: 8, Steps: 3 | Train Loss: 0.373 Vali Loss: 0.419 Vali Acc: 0.975 Test Loss: 0.419 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 9 cost time: 0.38225269317626953
Epoch: 9, Steps: 3 | Train Loss: 0.326 Vali Loss: 0.348 Vali Acc: 0.975 Test Loss: 0.348 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 10 cost time: 0.4617602825164795
Epoch: 10, Steps: 3 | Train Loss: 0.241 Vali Loss: 0.288 Vali Acc: 0.975 Test Loss: 0.288 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 11 cost time: 0.453655481338501
Epoch: 11, Steps: 3 | Train Loss: 0.233 Vali Loss: 0.246 Vali Acc: 0.975 Test Loss: 0.246 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 12 cost time: 0.39205455780029297
Epoch: 12, Steps: 3 | Train Loss: 0.173 Vali Loss: 0.217 Vali Acc: 0.975 Test Loss: 0.217 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 13 cost time: 0.3885793685913086
Epoch: 13, Steps: 3 | Train Loss: 0.137 Vali Loss: 0.194 Vali Acc: 0.975 Test Loss: 0.194 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 14 cost time: 0.3962831497192383
Epoch: 14, Steps: 3 | Train Loss: 0.121 Vali Loss: 0.181 Vali Acc: 0.975 Test Loss: 0.181 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 15 cost time: 0.39933323860168457
Epoch: 15, Steps: 3 | Train Loss: 0.105 Vali Loss: 0.173 Vali Acc: 0.975 Test Loss: 0.173 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 16 cost time: 0.369518518447876
Epoch: 16, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.163 Vali Acc: 0.975 Test Loss: 0.163 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 17 cost time: 0.44062280654907227
Epoch: 17, Steps: 3 | Train Loss: 0.070 Vali Loss: 0.153 Vali Acc: 0.975 Test Loss: 0.153 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 18 cost time: 0.3821096420288086
Epoch: 18, Steps: 3 | Train Loss: 0.074 Vali Loss: 0.154 Vali Acc: 0.975 Test Loss: 0.154 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.42910027503967285
Epoch: 19, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.143 Vali Acc: 0.975 Test Loss: 0.143 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974999).  Saving model ...
Epoch: 20 cost time: 0.5022461414337158
Epoch: 20, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.143 Vali Acc: 0.975 Test Loss: 0.143 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 21 cost time: 0.4549429416656494
Epoch: 21, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.136 Vali Acc: 0.975 Test Loss: 0.136 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 22 cost time: 0.49027276039123535
Epoch: 22, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.126 Vali Acc: 0.975 Test Loss: 0.126 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 23 cost time: 0.44016480445861816
Epoch: 23, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.119 Vali Acc: 0.975 Test Loss: 0.119 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 24 cost time: 0.475771427154541
Epoch: 24, Steps: 3 | Train Loss: 0.031 Vali Loss: 0.120 Vali Acc: 0.975 Test Loss: 0.120 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.4654695987701416
Epoch: 25, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.114 Vali Acc: 0.975 Test Loss: 0.114 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 26 cost time: 0.44058990478515625
Epoch: 26, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.117 Vali Acc: 0.975 Test Loss: 0.117 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.4767329692840576
Epoch: 27, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.109 Vali Acc: 0.975 Test Loss: 0.109 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 28 cost time: 0.4516472816467285
Epoch: 28, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.111 Vali Acc: 0.975 Test Loss: 0.111 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.45644640922546387
Epoch: 29, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.111 Vali Acc: 0.975 Test Loss: 0.111 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.45250797271728516
Epoch: 30, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.114 Vali Acc: 0.975 Test Loss: 0.114 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.47301673889160156
Epoch: 31, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.113 Vali Acc: 0.975 Test Loss: 0.113 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.45250797271728516
Epoch: 32, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.115 Vali Acc: 0.975 Test Loss: 0.115 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.47779369354248047
Epoch: 33, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.122 Vali Acc: 0.975 Test Loss: 0.122 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.4753267765045166
Epoch: 34, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.120 Vali Acc: 0.975 Test Loss: 0.120 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.4259207248687744
Epoch: 35, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.128 Vali Acc: 0.975 Test Loss: 0.128 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.45923757553100586
Epoch: 36, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.123 Vali Acc: 0.975 Test Loss: 0.123 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.4614243507385254
Epoch: 37, Steps: 3 | Train Loss: 0.012 Vali Loss: 0.126 Vali Acc: 0.975 Test Loss: 0.126 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps20_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 912644
model size : 3.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps25_str13_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.4062232971191406
Epoch: 1, Steps: 3 | Train Loss: 1.356 Vali Loss: 1.321 Vali Acc: 0.225 Test Loss: 1.321 Test Acc: 0.225
Validation loss decreased (inf --> -0.224987).  Saving model ...
Epoch: 2 cost time: 0.4445958137512207
Epoch: 2, Steps: 3 | Train Loss: 1.251 Vali Loss: 1.264 Vali Acc: 0.250 Test Loss: 1.264 Test Acc: 0.250
Validation loss decreased (-0.224987 --> -0.249987).  Saving model ...
Epoch: 3 cost time: 0.41177964210510254
Epoch: 3, Steps: 3 | Train Loss: 1.138 Vali Loss: 1.162 Vali Acc: 0.325 Test Loss: 1.162 Test Acc: 0.325
Validation loss decreased (-0.249987 --> -0.324988).  Saving model ...
Epoch: 4 cost time: 0.3664267063140869
Epoch: 4, Steps: 3 | Train Loss: 1.000 Vali Loss: 1.040 Vali Acc: 0.550 Test Loss: 1.040 Test Acc: 0.550
Validation loss decreased (-0.324988 --> -0.549990).  Saving model ...
Epoch: 5 cost time: 0.47063446044921875
Epoch: 5, Steps: 3 | Train Loss: 0.874 Vali Loss: 0.912 Vali Acc: 0.800 Test Loss: 0.912 Test Acc: 0.800
Validation loss decreased (-0.549990 --> -0.799991).  Saving model ...
Epoch: 6 cost time: 0.39244818687438965
Epoch: 6, Steps: 3 | Train Loss: 0.735 Vali Loss: 0.786 Vali Acc: 0.850 Test Loss: 0.786 Test Acc: 0.850
Validation loss decreased (-0.799991 --> -0.849992).  Saving model ...
Epoch: 7 cost time: 0.48708248138427734
Epoch: 7, Steps: 3 | Train Loss: 0.629 Vali Loss: 0.674 Vali Acc: 0.925 Test Loss: 0.674 Test Acc: 0.925
Validation loss decreased (-0.849992 --> -0.924993).  Saving model ...
Epoch: 8 cost time: 0.38094067573547363
Epoch: 8, Steps: 3 | Train Loss: 0.545 Vali Loss: 0.568 Vali Acc: 0.925 Test Loss: 0.568 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924994).  Saving model ...
Epoch: 9 cost time: 0.3828916549682617
Epoch: 9, Steps: 3 | Train Loss: 0.450 Vali Loss: 0.478 Vali Acc: 0.950 Test Loss: 0.478 Test Acc: 0.950
Validation loss decreased (-0.924994 --> -0.949995).  Saving model ...
Epoch: 10 cost time: 0.39955639839172363
Epoch: 10, Steps: 3 | Train Loss: 0.363 Vali Loss: 0.407 Vali Acc: 0.975 Test Loss: 0.407 Test Acc: 0.975
Validation loss decreased (-0.949995 --> -0.974996).  Saving model ...
Epoch: 11 cost time: 0.41213035583496094
Epoch: 11, Steps: 3 | Train Loss: 0.294 Vali Loss: 0.346 Vali Acc: 0.975 Test Loss: 0.346 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 12 cost time: 0.4354407787322998
Epoch: 12, Steps: 3 | Train Loss: 0.253 Vali Loss: 0.302 Vali Acc: 0.975 Test Loss: 0.302 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 13 cost time: 0.37543153762817383
Epoch: 13, Steps: 3 | Train Loss: 0.204 Vali Loss: 0.261 Vali Acc: 0.975 Test Loss: 0.261 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 14 cost time: 0.4063408374786377
Epoch: 14, Steps: 3 | Train Loss: 0.198 Vali Loss: 0.231 Vali Acc: 0.975 Test Loss: 0.231 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 15 cost time: 0.4078514575958252
Epoch: 15, Steps: 3 | Train Loss: 0.146 Vali Loss: 0.206 Vali Acc: 0.975 Test Loss: 0.206 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 16 cost time: 0.4076247215270996
Epoch: 16, Steps: 3 | Train Loss: 0.129 Vali Loss: 0.186 Vali Acc: 0.975 Test Loss: 0.186 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 17 cost time: 0.40225648880004883
Epoch: 17, Steps: 3 | Train Loss: 0.126 Vali Loss: 0.173 Vali Acc: 0.975 Test Loss: 0.173 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 18 cost time: 0.3910183906555176
Epoch: 18, Steps: 3 | Train Loss: 0.104 Vali Loss: 0.158 Vali Acc: 0.975 Test Loss: 0.158 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 19 cost time: 0.43726420402526855
Epoch: 19, Steps: 3 | Train Loss: 0.098 Vali Loss: 0.147 Vali Acc: 0.975 Test Loss: 0.147 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974999).  Saving model ...
Epoch: 20 cost time: 0.39932942390441895
Epoch: 20, Steps: 3 | Train Loss: 0.080 Vali Loss: 0.146 Vali Acc: 0.975 Test Loss: 0.146 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 21 cost time: 0.4073798656463623
Epoch: 21, Steps: 3 | Train Loss: 0.070 Vali Loss: 0.137 Vali Acc: 0.975 Test Loss: 0.137 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 22 cost time: 0.37973546981811523
Epoch: 22, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.130 Vali Acc: 0.975 Test Loss: 0.130 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 23 cost time: 0.39980220794677734
Epoch: 23, Steps: 3 | Train Loss: 0.061 Vali Loss: 0.124 Vali Acc: 0.975 Test Loss: 0.124 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 24 cost time: 0.4053833484649658
Epoch: 24, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.115 Vali Acc: 0.975 Test Loss: 0.115 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 25 cost time: 0.4296281337738037
Epoch: 25, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.111 Vali Acc: 0.975 Test Loss: 0.111 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 26 cost time: 0.43289661407470703
Epoch: 26, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.107 Vali Acc: 0.975 Test Loss: 0.107 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 27 cost time: 0.3907327651977539
Epoch: 27, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.105 Vali Acc: 0.975 Test Loss: 0.105 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 28 cost time: 0.41034507751464844
Epoch: 28, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.104 Vali Acc: 0.975 Test Loss: 0.104 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 29 cost time: 0.39642882347106934
Epoch: 29, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.100 Vali Acc: 0.975 Test Loss: 0.100 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 30 cost time: 0.3935096263885498
Epoch: 30, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.099 Vali Acc: 0.975 Test Loss: 0.099 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 31 cost time: 0.4144432544708252
Epoch: 31, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.100 Vali Acc: 0.975 Test Loss: 0.100 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.4342200756072998
Epoch: 32, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.097 Vali Acc: 0.975 Test Loss: 0.097 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 33 cost time: 0.3794834613800049
Epoch: 33, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.095 Vali Acc: 0.975 Test Loss: 0.095 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 34 cost time: 0.3824176788330078
Epoch: 34, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.096 Vali Acc: 0.975 Test Loss: 0.096 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.4363441467285156
Epoch: 35, Steps: 3 | Train Loss: 0.025 Vali Loss: 0.098 Vali Acc: 0.975 Test Loss: 0.098 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.3993065357208252
Epoch: 36, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.096 Vali Acc: 0.975 Test Loss: 0.096 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.4004232883453369
Epoch: 37, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.094 Vali Acc: 0.975 Test Loss: 0.094 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 38 cost time: 0.3891408443450928
Epoch: 38, Steps: 3 | Train Loss: 0.019 Vali Loss: 0.097 Vali Acc: 0.975 Test Loss: 0.097 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.41754627227783203
Epoch: 39, Steps: 3 | Train Loss: 0.018 Vali Loss: 0.099 Vali Acc: 0.975 Test Loss: 0.099 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.40490078926086426
Epoch: 40, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.096 Vali Acc: 0.975 Test Loss: 0.096 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.4163496494293213
Epoch: 41, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.096 Vali Acc: 0.975 Test Loss: 0.096 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.39595746994018555
Epoch: 42, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.097 Vali Acc: 0.975 Test Loss: 0.097 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.44768595695495605
Epoch: 43, Steps: 3 | Train Loss: 0.014 Vali Loss: 0.097 Vali Acc: 0.975 Test Loss: 0.097 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.4051666259765625
Epoch: 44, Steps: 3 | Train Loss: 0.015 Vali Loss: 0.095 Vali Acc: 0.975 Test Loss: 0.095 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.4343533515930176
Epoch: 45, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.096 Vali Acc: 0.975 Test Loss: 0.096 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.4124433994293213
Epoch: 46, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.092 Vali Acc: 0.975 Test Loss: 0.092 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 47 cost time: 0.42168164253234863
Epoch: 47, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.090 Vali Acc: 0.975 Test Loss: 0.090 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 48 cost time: 0.41962575912475586
Epoch: 48, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.090 Vali Acc: 0.975 Test Loss: 0.090 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 49 cost time: 0.43773651123046875
Epoch: 49, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.090 Vali Acc: 0.975 Test Loss: 0.090 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.4230659008026123
Epoch: 50, Steps: 3 | Train Loss: 0.009 Vali Loss: 0.087 Vali Acc: 0.975 Test Loss: 0.087 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps25_str13_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 895492
model size : 3.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.5514194965362549
Epoch: 1, Steps: 3 | Train Loss: 1.383 Vali Loss: 1.338 Vali Acc: 0.250 Test Loss: 1.338 Test Acc: 0.250
Validation loss decreased (inf --> -0.249987).  Saving model ...
Epoch: 2 cost time: 0.38712549209594727
Epoch: 2, Steps: 3 | Train Loss: 1.235 Vali Loss: 1.225 Vali Acc: 0.350 Test Loss: 1.225 Test Acc: 0.350
Validation loss decreased (-0.249987 --> -0.349988).  Saving model ...
Epoch: 3 cost time: 0.3550562858581543
Epoch: 3, Steps: 3 | Train Loss: 0.988 Vali Loss: 0.997 Vali Acc: 0.725 Test Loss: 0.997 Test Acc: 0.725
Validation loss decreased (-0.349988 --> -0.724990).  Saving model ...
Epoch: 4 cost time: 0.37533044815063477
Epoch: 4, Steps: 3 | Train Loss: 0.698 Vali Loss: 0.754 Vali Acc: 0.925 Test Loss: 0.754 Test Acc: 0.925
Validation loss decreased (-0.724990 --> -0.924992).  Saving model ...
Epoch: 5 cost time: 0.3541393280029297
Epoch: 5, Steps: 3 | Train Loss: 0.472 Vali Loss: 0.574 Vali Acc: 0.950 Test Loss: 0.574 Test Acc: 0.950
Validation loss decreased (-0.924992 --> -0.949994).  Saving model ...
Epoch: 6 cost time: 0.3687095642089844
Epoch: 6, Steps: 3 | Train Loss: 0.311 Vali Loss: 0.429 Vali Acc: 0.925 Test Loss: 0.429 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.4181482791900635
Epoch: 7, Steps: 3 | Train Loss: 0.256 Vali Loss: 0.342 Vali Acc: 0.925 Test Loss: 0.342 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.4309239387512207
Epoch: 8, Steps: 3 | Train Loss: 0.210 Vali Loss: 0.294 Vali Acc: 0.925 Test Loss: 0.294 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.3838648796081543
Epoch: 9, Steps: 3 | Train Loss: 0.134 Vali Loss: 0.278 Vali Acc: 0.950 Test Loss: 0.278 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949997).  Saving model ...
Epoch: 10 cost time: 0.4181480407714844
Epoch: 10, Steps: 3 | Train Loss: 0.091 Vali Loss: 0.292 Vali Acc: 0.950 Test Loss: 0.292 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.36498141288757324
Epoch: 11, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.295 Vali Acc: 0.950 Test Loss: 0.295 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.3646714687347412
Epoch: 12, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.296 Vali Acc: 0.950 Test Loss: 0.296 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.39675474166870117
Epoch: 13, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.309 Vali Acc: 0.950 Test Loss: 0.309 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.4101271629333496
Epoch: 14, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.323 Vali Acc: 0.950 Test Loss: 0.323 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.441425085067749
Epoch: 15, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.344 Vali Acc: 0.925 Test Loss: 0.344 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.3608129024505615
Epoch: 16, Steps: 3 | Train Loss: 0.016 Vali Loss: 0.365 Vali Acc: 0.925 Test Loss: 0.365 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.36841440200805664
Epoch: 17, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.358 Vali Acc: 0.925 Test Loss: 0.358 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.41016435623168945
Epoch: 18, Steps: 3 | Train Loss: 0.011 Vali Loss: 0.352 Vali Acc: 0.925 Test Loss: 0.352 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.3973348140716553
Epoch: 19, Steps: 3 | Train Loss: 0.010 Vali Loss: 0.351 Vali Acc: 0.925 Test Loss: 0.351 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.95
model parameter : 380420
model size : 1.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.4308042526245117
Epoch: 1, Steps: 3 | Train Loss: 1.364 Vali Loss: 1.314 Vali Acc: 0.375 Test Loss: 1.314 Test Acc: 0.375
Validation loss decreased (inf --> -0.374987).  Saving model ...
Epoch: 2 cost time: 0.37528181076049805
Epoch: 2, Steps: 3 | Train Loss: 1.225 Vali Loss: 1.220 Vali Acc: 0.550 Test Loss: 1.220 Test Acc: 0.550
Validation loss decreased (-0.374987 --> -0.549988).  Saving model ...
Epoch: 3 cost time: 0.36505603790283203
Epoch: 3, Steps: 3 | Train Loss: 1.039 Vali Loss: 1.050 Vali Acc: 0.675 Test Loss: 1.050 Test Acc: 0.675
Validation loss decreased (-0.549988 --> -0.674990).  Saving model ...
Epoch: 4 cost time: 0.391650915145874
Epoch: 4, Steps: 3 | Train Loss: 0.825 Vali Loss: 0.859 Vali Acc: 0.750 Test Loss: 0.859 Test Acc: 0.750
Validation loss decreased (-0.674990 --> -0.749991).  Saving model ...
Epoch: 5 cost time: 0.4229576587677002
Epoch: 5, Steps: 3 | Train Loss: 0.616 Vali Loss: 0.690 Vali Acc: 0.900 Test Loss: 0.690 Test Acc: 0.900
Validation loss decreased (-0.749991 --> -0.899993).  Saving model ...
Epoch: 6 cost time: 0.41443729400634766
Epoch: 6, Steps: 3 | Train Loss: 0.434 Vali Loss: 0.550 Vali Acc: 0.950 Test Loss: 0.550 Test Acc: 0.950
Validation loss decreased (-0.899993 --> -0.949994).  Saving model ...
Epoch: 7 cost time: 0.39957618713378906
Epoch: 7, Steps: 3 | Train Loss: 0.323 Vali Loss: 0.420 Vali Acc: 0.950 Test Loss: 0.420 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949996).  Saving model ...
Epoch: 8 cost time: 0.36972618103027344
Epoch: 8, Steps: 3 | Train Loss: 0.267 Vali Loss: 0.333 Vali Acc: 0.950 Test Loss: 0.333 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 9 cost time: 0.363964319229126
Epoch: 9, Steps: 3 | Train Loss: 0.184 Vali Loss: 0.278 Vali Acc: 0.950 Test Loss: 0.278 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 10 cost time: 0.4430723190307617
Epoch: 10, Steps: 3 | Train Loss: 0.143 Vali Loss: 0.236 Vali Acc: 0.975 Test Loss: 0.236 Test Acc: 0.975
Validation loss decreased (-0.949997 --> -0.974998).  Saving model ...
Epoch: 11 cost time: 0.42481422424316406
Epoch: 11, Steps: 3 | Train Loss: 0.117 Vali Loss: 0.221 Vali Acc: 0.975 Test Loss: 0.221 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 12 cost time: 0.4062025547027588
Epoch: 12, Steps: 3 | Train Loss: 0.093 Vali Loss: 0.215 Vali Acc: 0.975 Test Loss: 0.215 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 13 cost time: 0.43788719177246094
Epoch: 13, Steps: 3 | Train Loss: 0.068 Vali Loss: 0.218 Vali Acc: 0.950 Test Loss: 0.218 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.38103628158569336
Epoch: 14, Steps: 3 | Train Loss: 0.062 Vali Loss: 0.211 Vali Acc: 0.950 Test Loss: 0.211 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.4013404846191406
Epoch: 15, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.203 Vali Acc: 0.950 Test Loss: 0.203 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.4069209098815918
Epoch: 16, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.208 Vali Acc: 0.950 Test Loss: 0.208 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.3655409812927246
Epoch: 17, Steps: 3 | Train Loss: 0.032 Vali Loss: 0.195 Vali Acc: 0.950 Test Loss: 0.195 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.3810098171234131
Epoch: 18, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.188 Vali Acc: 0.950 Test Loss: 0.188 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.3916945457458496
Epoch: 19, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.188 Vali Acc: 0.950 Test Loss: 0.188 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.42698192596435547
Epoch: 20, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.189 Vali Acc: 0.950 Test Loss: 0.189 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.3929450511932373
Epoch: 21, Steps: 3 | Train Loss: 0.017 Vali Loss: 0.188 Vali Acc: 0.950 Test Loss: 0.188 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.3986799716949463
Epoch: 22, Steps: 3 | Train Loss: 0.013 Vali Loss: 0.185 Vali Acc: 0.950 Test Loss: 0.185 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 328452
model size : 1.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.4890990257263184
Epoch: 1, Steps: 3 | Train Loss: 1.487 Vali Loss: 1.352 Vali Acc: 0.275 Test Loss: 1.352 Test Acc: 0.275
Validation loss decreased (inf --> -0.274986).  Saving model ...
Epoch: 2 cost time: 0.3435649871826172
Epoch: 2, Steps: 3 | Train Loss: 1.257 Vali Loss: 1.264 Vali Acc: 0.325 Test Loss: 1.264 Test Acc: 0.325
Validation loss decreased (-0.274986 --> -0.324987).  Saving model ...
Epoch: 3 cost time: 0.3746371269226074
Epoch: 3, Steps: 3 | Train Loss: 1.093 Vali Loss: 1.116 Vali Acc: 0.525 Test Loss: 1.116 Test Acc: 0.525
Validation loss decreased (-0.324987 --> -0.524989).  Saving model ...
Epoch: 4 cost time: 0.36858701705932617
Epoch: 4, Steps: 3 | Train Loss: 0.895 Vali Loss: 0.952 Vali Acc: 0.700 Test Loss: 0.952 Test Acc: 0.700
Validation loss decreased (-0.524989 --> -0.699990).  Saving model ...
Epoch: 5 cost time: 0.37665653228759766
Epoch: 5, Steps: 3 | Train Loss: 0.734 Vali Loss: 0.796 Vali Acc: 0.875 Test Loss: 0.796 Test Acc: 0.875
Validation loss decreased (-0.699990 --> -0.874992).  Saving model ...
Epoch: 6 cost time: 0.4173247814178467
Epoch: 6, Steps: 3 | Train Loss: 0.596 Vali Loss: 0.659 Vali Acc: 0.950 Test Loss: 0.659 Test Acc: 0.950
Validation loss decreased (-0.874992 --> -0.949993).  Saving model ...
Epoch: 7 cost time: 0.43690061569213867
Epoch: 7, Steps: 3 | Train Loss: 0.475 Vali Loss: 0.528 Vali Acc: 0.950 Test Loss: 0.528 Test Acc: 0.950
Validation loss decreased (-0.949993 --> -0.949995).  Saving model ...
Epoch: 8 cost time: 0.3734407424926758
Epoch: 8, Steps: 3 | Train Loss: 0.336 Vali Loss: 0.426 Vali Acc: 0.975 Test Loss: 0.426 Test Acc: 0.975
Validation loss decreased (-0.949995 --> -0.974996).  Saving model ...
Epoch: 9 cost time: 0.38992834091186523
Epoch: 9, Steps: 3 | Train Loss: 0.280 Vali Loss: 0.357 Vali Acc: 0.950 Test Loss: 0.357 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.3352932929992676
Epoch: 10, Steps: 3 | Train Loss: 0.207 Vali Loss: 0.306 Vali Acc: 0.950 Test Loss: 0.306 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.4018862247467041
Epoch: 11, Steps: 3 | Train Loss: 0.168 Vali Loss: 0.261 Vali Acc: 0.975 Test Loss: 0.261 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 12 cost time: 0.3401172161102295
Epoch: 12, Steps: 3 | Train Loss: 0.106 Vali Loss: 0.226 Vali Acc: 0.975 Test Loss: 0.226 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 13 cost time: 0.3701941967010498
Epoch: 13, Steps: 3 | Train Loss: 0.117 Vali Loss: 0.212 Vali Acc: 0.975 Test Loss: 0.212 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 14 cost time: 0.3502309322357178
Epoch: 14, Steps: 3 | Train Loss: 0.088 Vali Loss: 0.193 Vali Acc: 0.975 Test Loss: 0.193 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 15 cost time: 0.37021708488464355
Epoch: 15, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.182 Vali Acc: 0.975 Test Loss: 0.182 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 16 cost time: 0.37662363052368164
Epoch: 16, Steps: 3 | Train Loss: 0.072 Vali Loss: 0.179 Vali Acc: 0.950 Test Loss: 0.179 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.4754965305328369
Epoch: 17, Steps: 3 | Train Loss: 0.067 Vali Loss: 0.185 Vali Acc: 0.950 Test Loss: 0.185 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.346935510635376
Epoch: 18, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.186 Vali Acc: 0.950 Test Loss: 0.186 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.3875701427459717
Epoch: 19, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.184 Vali Acc: 0.950 Test Loss: 0.184 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.42136311531066895
Epoch: 20, Steps: 3 | Train Loss: 0.038 Vali Loss: 0.192 Vali Acc: 0.950 Test Loss: 0.192 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.371628999710083
Epoch: 21, Steps: 3 | Train Loss: 0.026 Vali Loss: 0.174 Vali Acc: 0.950 Test Loss: 0.174 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.4029219150543213
Epoch: 22, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.171 Vali Acc: 0.950 Test Loss: 0.171 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.37285447120666504
Epoch: 23, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.170 Vali Acc: 0.950 Test Loss: 0.170 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.3951535224914551
Epoch: 24, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.169 Vali Acc: 0.950 Test Loss: 0.169 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.3700268268585205
Epoch: 25, Steps: 3 | Train Loss: 0.020 Vali Loss: 0.165 Vali Acc: 0.950 Test Loss: 0.165 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 304260
model size : 1.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.2744338512420654
Epoch: 1, Steps: 3 | Train Loss: 1.469 Vali Loss: 1.355 Vali Acc: 0.200 Test Loss: 1.355 Test Acc: 0.200
Validation loss decreased (inf --> -0.199986).  Saving model ...
Epoch: 2 cost time: 0.3568730354309082
Epoch: 2, Steps: 3 | Train Loss: 1.369 Vali Loss: 1.288 Vali Acc: 0.300 Test Loss: 1.288 Test Acc: 0.300
Validation loss decreased (-0.199986 --> -0.299987).  Saving model ...
Epoch: 3 cost time: 0.33398914337158203
Epoch: 3, Steps: 3 | Train Loss: 1.207 Vali Loss: 1.172 Vali Acc: 0.375 Test Loss: 1.172 Test Acc: 0.375
Validation loss decreased (-0.299987 --> -0.374988).  Saving model ...
Epoch: 4 cost time: 0.36066102981567383
Epoch: 4, Steps: 3 | Train Loss: 1.081 Vali Loss: 1.036 Vali Acc: 0.700 Test Loss: 1.036 Test Acc: 0.700
Validation loss decreased (-0.374988 --> -0.699990).  Saving model ...
Epoch: 5 cost time: 0.3751845359802246
Epoch: 5, Steps: 3 | Train Loss: 0.869 Vali Loss: 0.890 Vali Acc: 0.775 Test Loss: 0.890 Test Acc: 0.775
Validation loss decreased (-0.699990 --> -0.774991).  Saving model ...
Epoch: 6 cost time: 0.42415738105773926
Epoch: 6, Steps: 3 | Train Loss: 0.703 Vali Loss: 0.747 Vali Acc: 0.800 Test Loss: 0.747 Test Acc: 0.800
Validation loss decreased (-0.774991 --> -0.799993).  Saving model ...
Epoch: 7 cost time: 0.402665376663208
Epoch: 7, Steps: 3 | Train Loss: 0.590 Vali Loss: 0.622 Vali Acc: 0.825 Test Loss: 0.622 Test Acc: 0.825
Validation loss decreased (-0.799993 --> -0.824994).  Saving model ...
Epoch: 8 cost time: 0.379561185836792
Epoch: 8, Steps: 3 | Train Loss: 0.443 Vali Loss: 0.518 Vali Acc: 0.825 Test Loss: 0.518 Test Acc: 0.825
Validation loss decreased (-0.824994 --> -0.824995).  Saving model ...
Epoch: 9 cost time: 0.44431042671203613
Epoch: 9, Steps: 3 | Train Loss: 0.378 Vali Loss: 0.438 Vali Acc: 0.925 Test Loss: 0.438 Test Acc: 0.925
Validation loss decreased (-0.824995 --> -0.924996).  Saving model ...
Epoch: 10 cost time: 0.39342546463012695
Epoch: 10, Steps: 3 | Train Loss: 0.279 Vali Loss: 0.380 Vali Acc: 0.950 Test Loss: 0.380 Test Acc: 0.950
Validation loss decreased (-0.924996 --> -0.949996).  Saving model ...
Epoch: 11 cost time: 0.3637878894805908
Epoch: 11, Steps: 3 | Train Loss: 0.220 Vali Loss: 0.337 Vali Acc: 0.950 Test Loss: 0.337 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 12 cost time: 0.36196422576904297
Epoch: 12, Steps: 3 | Train Loss: 0.199 Vali Loss: 0.311 Vali Acc: 0.950 Test Loss: 0.311 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 13 cost time: 0.3952155113220215
Epoch: 13, Steps: 3 | Train Loss: 0.159 Vali Loss: 0.279 Vali Acc: 0.950 Test Loss: 0.279 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 14 cost time: 0.40958452224731445
Epoch: 14, Steps: 3 | Train Loss: 0.128 Vali Loss: 0.248 Vali Acc: 0.975 Test Loss: 0.248 Test Acc: 0.975
Validation loss decreased (-0.949997 --> -0.974998).  Saving model ...
Epoch: 15 cost time: 0.38744306564331055
Epoch: 15, Steps: 3 | Train Loss: 0.140 Vali Loss: 0.238 Vali Acc: 0.975 Test Loss: 0.238 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 16 cost time: 0.45951032638549805
Epoch: 16, Steps: 3 | Train Loss: 0.091 Vali Loss: 0.227 Vali Acc: 0.975 Test Loss: 0.227 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 17 cost time: 0.34624338150024414
Epoch: 17, Steps: 3 | Train Loss: 0.088 Vali Loss: 0.222 Vali Acc: 0.950 Test Loss: 0.222 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.37840914726257324
Epoch: 18, Steps: 3 | Train Loss: 0.072 Vali Loss: 0.221 Vali Acc: 0.950 Test Loss: 0.221 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.44814443588256836
Epoch: 19, Steps: 3 | Train Loss: 0.072 Vali Loss: 0.220 Vali Acc: 0.925 Test Loss: 0.220 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.38616132736206055
Epoch: 20, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.224 Vali Acc: 0.925 Test Loss: 0.224 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.36365175247192383
Epoch: 21, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.221 Vali Acc: 0.925 Test Loss: 0.221 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.35135722160339355
Epoch: 22, Steps: 3 | Train Loss: 0.044 Vali Loss: 0.220 Vali Acc: 0.925 Test Loss: 0.220 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.3937509059906006
Epoch: 23, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.222 Vali Acc: 0.925 Test Loss: 0.222 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.38002657890319824
Epoch: 24, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.227 Vali Acc: 0.925 Test Loss: 0.227 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.3520009517669678
Epoch: 25, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.216 Vali Acc: 0.925 Test Loss: 0.216 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.38408780097961426
Epoch: 26, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.211 Vali Acc: 0.925 Test Loss: 0.211 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 289156
model size : 1.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.3773517608642578
Epoch: 1, Steps: 3 | Train Loss: 1.373 Vali Loss: 1.361 Vali Acc: 0.350 Test Loss: 1.361 Test Acc: 0.350
Validation loss decreased (inf --> -0.349986).  Saving model ...
Epoch: 2 cost time: 0.3524758815765381
Epoch: 2, Steps: 3 | Train Loss: 1.281 Vali Loss: 1.300 Vali Acc: 0.450 Test Loss: 1.300 Test Acc: 0.450
Validation loss decreased (-0.349986 --> -0.449987).  Saving model ...
Epoch: 3 cost time: 0.4245259761810303
Epoch: 3, Steps: 3 | Train Loss: 1.140 Vali Loss: 1.210 Vali Acc: 0.475 Test Loss: 1.210 Test Acc: 0.475
Validation loss decreased (-0.449987 --> -0.474988).  Saving model ...
Epoch: 4 cost time: 0.31969642639160156
Epoch: 4, Steps: 3 | Train Loss: 1.082 Vali Loss: 1.091 Vali Acc: 0.650 Test Loss: 1.091 Test Acc: 0.650
Validation loss decreased (-0.474988 --> -0.649989).  Saving model ...
Epoch: 5 cost time: 0.3986785411834717
Epoch: 5, Steps: 3 | Train Loss: 0.925 Vali Loss: 0.972 Vali Acc: 0.675 Test Loss: 0.972 Test Acc: 0.675
Validation loss decreased (-0.649989 --> -0.674990).  Saving model ...
Epoch: 6 cost time: 0.3546452522277832
Epoch: 6, Steps: 3 | Train Loss: 0.783 Vali Loss: 0.858 Vali Acc: 0.750 Test Loss: 0.858 Test Acc: 0.750
Validation loss decreased (-0.674990 --> -0.749991).  Saving model ...
Epoch: 7 cost time: 0.34526729583740234
Epoch: 7, Steps: 3 | Train Loss: 0.676 Vali Loss: 0.755 Vali Acc: 0.850 Test Loss: 0.755 Test Acc: 0.850
Validation loss decreased (-0.749991 --> -0.849992).  Saving model ...
Epoch: 8 cost time: 0.394207239151001
Epoch: 8, Steps: 3 | Train Loss: 0.611 Vali Loss: 0.660 Vali Acc: 0.875 Test Loss: 0.660 Test Acc: 0.875
Validation loss decreased (-0.849992 --> -0.874993).  Saving model ...
Epoch: 9 cost time: 0.331179141998291
Epoch: 9, Steps: 3 | Train Loss: 0.510 Vali Loss: 0.574 Vali Acc: 0.950 Test Loss: 0.574 Test Acc: 0.950
Validation loss decreased (-0.874993 --> -0.949994).  Saving model ...
Epoch: 10 cost time: 0.31909871101379395
Epoch: 10, Steps: 3 | Train Loss: 0.465 Vali Loss: 0.501 Vali Acc: 0.950 Test Loss: 0.501 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 11 cost time: 0.3489689826965332
Epoch: 11, Steps: 3 | Train Loss: 0.362 Vali Loss: 0.445 Vali Acc: 0.975 Test Loss: 0.445 Test Acc: 0.975
Validation loss decreased (-0.949995 --> -0.974996).  Saving model ...
Epoch: 12 cost time: 0.35990095138549805
Epoch: 12, Steps: 3 | Train Loss: 0.330 Vali Loss: 0.399 Vali Acc: 0.975 Test Loss: 0.399 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 13 cost time: 0.35983967781066895
Epoch: 13, Steps: 3 | Train Loss: 0.299 Vali Loss: 0.357 Vali Acc: 0.975 Test Loss: 0.357 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 14 cost time: 0.4081847667694092
Epoch: 14, Steps: 3 | Train Loss: 0.223 Vali Loss: 0.320 Vali Acc: 0.975 Test Loss: 0.320 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 15 cost time: 0.3869483470916748
Epoch: 15, Steps: 3 | Train Loss: 0.227 Vali Loss: 0.290 Vali Acc: 0.975 Test Loss: 0.290 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 16 cost time: 0.3885231018066406
Epoch: 16, Steps: 3 | Train Loss: 0.178 Vali Loss: 0.272 Vali Acc: 0.975 Test Loss: 0.272 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 17 cost time: 0.33228492736816406
Epoch: 17, Steps: 3 | Train Loss: 0.172 Vali Loss: 0.262 Vali Acc: 0.950 Test Loss: 0.262 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.34471607208251953
Epoch: 18, Steps: 3 | Train Loss: 0.144 Vali Loss: 0.259 Vali Acc: 0.950 Test Loss: 0.259 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.34273481369018555
Epoch: 19, Steps: 3 | Train Loss: 0.117 Vali Loss: 0.252 Vali Acc: 0.925 Test Loss: 0.252 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.42542386054992676
Epoch: 20, Steps: 3 | Train Loss: 0.107 Vali Loss: 0.264 Vali Acc: 0.925 Test Loss: 0.264 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.3403947353363037
Epoch: 21, Steps: 3 | Train Loss: 0.099 Vali Loss: 0.267 Vali Acc: 0.925 Test Loss: 0.267 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.32885265350341797
Epoch: 22, Steps: 3 | Train Loss: 0.083 Vali Loss: 0.257 Vali Acc: 0.925 Test Loss: 0.257 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.36023712158203125
Epoch: 23, Steps: 3 | Train Loss: 0.085 Vali Loss: 0.259 Vali Acc: 0.925 Test Loss: 0.259 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.36984801292419434
Epoch: 24, Steps: 3 | Train Loss: 0.075 Vali Loss: 0.257 Vali Acc: 0.925 Test Loss: 0.257 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.3190782070159912
Epoch: 25, Steps: 3 | Train Loss: 0.081 Vali Loss: 0.259 Vali Acc: 0.925 Test Loss: 0.259 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.3420722484588623
Epoch: 26, Steps: 3 | Train Loss: 0.058 Vali Loss: 0.261 Vali Acc: 0.925 Test Loss: 0.261 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 265220
model size : 1.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps20_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.4344885349273682
Epoch: 1, Steps: 3 | Train Loss: 1.472 Vali Loss: 1.470 Vali Acc: 0.250 Test Loss: 1.470 Test Acc: 0.250
Validation loss decreased (inf --> -0.249985).  Saving model ...
Epoch: 2 cost time: 0.3192462921142578
Epoch: 2, Steps: 3 | Train Loss: 1.382 Vali Loss: 1.421 Vali Acc: 0.300 Test Loss: 1.421 Test Acc: 0.300
Validation loss decreased (-0.249985 --> -0.299986).  Saving model ...
Epoch: 3 cost time: 0.36641645431518555
Epoch: 3, Steps: 3 | Train Loss: 1.257 Vali Loss: 1.339 Vali Acc: 0.425 Test Loss: 1.339 Test Acc: 0.425
Validation loss decreased (-0.299986 --> -0.424987).  Saving model ...
Epoch: 4 cost time: 0.30420827865600586
Epoch: 4, Steps: 3 | Train Loss: 1.140 Vali Loss: 1.228 Vali Acc: 0.400 Test Loss: 1.228 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.38655924797058105
Epoch: 5, Steps: 3 | Train Loss: 0.968 Vali Loss: 1.110 Vali Acc: 0.475 Test Loss: 1.110 Test Acc: 0.475
Validation loss decreased (-0.424987 --> -0.474989).  Saving model ...
Epoch: 6 cost time: 0.33364057540893555
Epoch: 6, Steps: 3 | Train Loss: 0.869 Vali Loss: 0.998 Vali Acc: 0.550 Test Loss: 0.998 Test Acc: 0.550
Validation loss decreased (-0.474989 --> -0.549990).  Saving model ...
Epoch: 7 cost time: 0.37314701080322266
Epoch: 7, Steps: 3 | Train Loss: 0.815 Vali Loss: 0.889 Vali Acc: 0.725 Test Loss: 0.889 Test Acc: 0.725
Validation loss decreased (-0.549990 --> -0.724991).  Saving model ...
Epoch: 8 cost time: 0.3955714702606201
Epoch: 8, Steps: 3 | Train Loss: 0.686 Vali Loss: 0.794 Vali Acc: 0.825 Test Loss: 0.794 Test Acc: 0.825
Validation loss decreased (-0.724991 --> -0.824992).  Saving model ...
Epoch: 9 cost time: 0.3206346035003662
Epoch: 9, Steps: 3 | Train Loss: 0.590 Vali Loss: 0.701 Vali Acc: 0.875 Test Loss: 0.701 Test Acc: 0.875
Validation loss decreased (-0.824992 --> -0.874993).  Saving model ...
Epoch: 10 cost time: 0.35494494438171387
Epoch: 10, Steps: 3 | Train Loss: 0.502 Vali Loss: 0.620 Vali Acc: 0.875 Test Loss: 0.620 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 11 cost time: 0.3511078357696533
Epoch: 11, Steps: 3 | Train Loss: 0.435 Vali Loss: 0.535 Vali Acc: 0.900 Test Loss: 0.535 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899995).  Saving model ...
Epoch: 12 cost time: 0.40692877769470215
Epoch: 12, Steps: 3 | Train Loss: 0.377 Vali Loss: 0.475 Vali Acc: 0.900 Test Loss: 0.475 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 13 cost time: 0.34372591972351074
Epoch: 13, Steps: 3 | Train Loss: 0.330 Vali Loss: 0.416 Vali Acc: 0.925 Test Loss: 0.416 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924996).  Saving model ...
Epoch: 14 cost time: 0.37397265434265137
Epoch: 14, Steps: 3 | Train Loss: 0.306 Vali Loss: 0.376 Vali Acc: 0.975 Test Loss: 0.376 Test Acc: 0.975
Validation loss decreased (-0.924996 --> -0.974996).  Saving model ...
Epoch: 15 cost time: 0.3826720714569092
Epoch: 15, Steps: 3 | Train Loss: 0.248 Vali Loss: 0.349 Vali Acc: 0.975 Test Loss: 0.349 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 16 cost time: 0.3542745113372803
Epoch: 16, Steps: 3 | Train Loss: 0.233 Vali Loss: 0.331 Vali Acc: 0.975 Test Loss: 0.331 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 17 cost time: 0.36115121841430664
Epoch: 17, Steps: 3 | Train Loss: 0.199 Vali Loss: 0.305 Vali Acc: 0.975 Test Loss: 0.305 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 18 cost time: 0.3774409294128418
Epoch: 18, Steps: 3 | Train Loss: 0.178 Vali Loss: 0.285 Vali Acc: 0.975 Test Loss: 0.285 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 19 cost time: 0.3547217845916748
Epoch: 19, Steps: 3 | Train Loss: 0.173 Vali Loss: 0.272 Vali Acc: 0.975 Test Loss: 0.272 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 20 cost time: 0.3879528045654297
Epoch: 20, Steps: 3 | Train Loss: 0.161 Vali Loss: 0.258 Vali Acc: 0.975 Test Loss: 0.258 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 21 cost time: 0.36617207527160645
Epoch: 21, Steps: 3 | Train Loss: 0.131 Vali Loss: 0.244 Vali Acc: 0.975 Test Loss: 0.244 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 22 cost time: 0.3769495487213135
Epoch: 22, Steps: 3 | Train Loss: 0.118 Vali Loss: 0.231 Vali Acc: 0.975 Test Loss: 0.231 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 23 cost time: 0.3700547218322754
Epoch: 23, Steps: 3 | Train Loss: 0.119 Vali Loss: 0.228 Vali Acc: 0.975 Test Loss: 0.228 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 24 cost time: 0.3794422149658203
Epoch: 24, Steps: 3 | Train Loss: 0.124 Vali Loss: 0.224 Vali Acc: 0.975 Test Loss: 0.224 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 25 cost time: 0.36944103240966797
Epoch: 25, Steps: 3 | Train Loss: 0.079 Vali Loss: 0.208 Vali Acc: 0.975 Test Loss: 0.208 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 26 cost time: 0.384965181350708
Epoch: 26, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.200 Vali Acc: 0.975 Test Loss: 0.200 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 27 cost time: 0.36928534507751465
Epoch: 27, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.190 Vali Acc: 0.975 Test Loss: 0.190 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 28 cost time: 0.3443572521209717
Epoch: 28, Steps: 3 | Train Loss: 0.076 Vali Loss: 0.192 Vali Acc: 0.975 Test Loss: 0.192 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.4346752166748047
Epoch: 29, Steps: 3 | Train Loss: 0.074 Vali Loss: 0.194 Vali Acc: 0.975 Test Loss: 0.194 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.35095858573913574
Epoch: 30, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.188 Vali Acc: 0.975 Test Loss: 0.188 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 31 cost time: 0.3709836006164551
Epoch: 31, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.186 Vali Acc: 0.975 Test Loss: 0.186 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 32 cost time: 0.3767054080963135
Epoch: 32, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.181 Vali Acc: 0.975 Test Loss: 0.181 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 33 cost time: 0.3954036235809326
Epoch: 33, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.180 Vali Acc: 0.975 Test Loss: 0.180 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 34 cost time: 0.361832857131958
Epoch: 34, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.171 Vali Acc: 0.975 Test Loss: 0.171 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 35 cost time: 0.3885173797607422
Epoch: 35, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.172 Vali Acc: 0.975 Test Loss: 0.172 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.3748760223388672
Epoch: 36, Steps: 3 | Train Loss: 0.041 Vali Loss: 0.170 Vali Acc: 0.975 Test Loss: 0.170 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 37 cost time: 0.3580591678619385
Epoch: 37, Steps: 3 | Train Loss: 0.046 Vali Loss: 0.167 Vali Acc: 0.975 Test Loss: 0.167 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 38 cost time: 0.35669970512390137
Epoch: 38, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.167 Vali Acc: 0.975 Test Loss: 0.167 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.42923593521118164
Epoch: 39, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.164 Vali Acc: 0.975 Test Loss: 0.164 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 40 cost time: 0.365933895111084
Epoch: 40, Steps: 3 | Train Loss: 0.036 Vali Loss: 0.163 Vali Acc: 0.975 Test Loss: 0.163 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 41 cost time: 0.37389206886291504
Epoch: 41, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.166 Vali Acc: 0.975 Test Loss: 0.166 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.372708797454834
Epoch: 42, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.166 Vali Acc: 0.975 Test Loss: 0.166 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.3969712257385254
Epoch: 43, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.166 Vali Acc: 0.975 Test Loss: 0.166 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.34417223930358887
Epoch: 44, Steps: 3 | Train Loss: 0.033 Vali Loss: 0.166 Vali Acc: 0.975 Test Loss: 0.166 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.35265326499938965
Epoch: 45, Steps: 3 | Train Loss: 0.034 Vali Loss: 0.165 Vali Acc: 0.975 Test Loss: 0.165 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.34276628494262695
Epoch: 46, Steps: 3 | Train Loss: 0.027 Vali Loss: 0.166 Vali Acc: 0.975 Test Loss: 0.166 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.36055707931518555
Epoch: 47, Steps: 3 | Train Loss: 0.024 Vali Loss: 0.157 Vali Acc: 0.975 Test Loss: 0.157 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 48 cost time: 0.36179161071777344
Epoch: 48, Steps: 3 | Train Loss: 0.022 Vali Loss: 0.154 Vali Acc: 0.975 Test Loss: 0.154 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 49 cost time: 0.43970179557800293
Epoch: 49, Steps: 3 | Train Loss: 0.023 Vali Loss: 0.155 Vali Acc: 0.975 Test Loss: 0.155 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.35182905197143555
Epoch: 50, Steps: 3 | Train Loss: 0.021 Vali Loss: 0.151 Vali Acc: 0.975 Test Loss: 0.151 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps20_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 259716
model size : 1.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps25_str13_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.6210076808929443
Epoch: 1, Steps: 3 | Train Loss: 1.399 Vali Loss: 1.328 Vali Acc: 0.475 Test Loss: 1.328 Test Acc: 0.475
Validation loss decreased (inf --> -0.474987).  Saving model ...
Epoch: 2 cost time: 0.38515186309814453
Epoch: 2, Steps: 3 | Train Loss: 1.320 Vali Loss: 1.288 Vali Acc: 0.525 Test Loss: 1.288 Test Acc: 0.525
Validation loss decreased (-0.474987 --> -0.524987).  Saving model ...
Epoch: 3 cost time: 0.34687256813049316
Epoch: 3, Steps: 3 | Train Loss: 1.254 Vali Loss: 1.229 Vali Acc: 0.575 Test Loss: 1.229 Test Acc: 0.575
Validation loss decreased (-0.524987 --> -0.574988).  Saving model ...
Epoch: 4 cost time: 0.3656761646270752
Epoch: 4, Steps: 3 | Train Loss: 1.133 Vali Loss: 1.151 Vali Acc: 0.650 Test Loss: 1.151 Test Acc: 0.650
Validation loss decreased (-0.574988 --> -0.649988).  Saving model ...
Epoch: 5 cost time: 0.39173293113708496
Epoch: 5, Steps: 3 | Train Loss: 1.027 Vali Loss: 1.055 Vali Acc: 0.775 Test Loss: 1.055 Test Acc: 0.775
Validation loss decreased (-0.649988 --> -0.774989).  Saving model ...
Epoch: 6 cost time: 0.36132049560546875
Epoch: 6, Steps: 3 | Train Loss: 0.925 Vali Loss: 0.954 Vali Acc: 0.775 Test Loss: 0.954 Test Acc: 0.775
Validation loss decreased (-0.774989 --> -0.774990).  Saving model ...
Epoch: 7 cost time: 0.3755919933319092
Epoch: 7, Steps: 3 | Train Loss: 0.819 Vali Loss: 0.864 Vali Acc: 0.800 Test Loss: 0.864 Test Acc: 0.800
Validation loss decreased (-0.774990 --> -0.799991).  Saving model ...
Epoch: 8 cost time: 0.35997605323791504
Epoch: 8, Steps: 3 | Train Loss: 0.734 Vali Loss: 0.783 Vali Acc: 0.850 Test Loss: 0.783 Test Acc: 0.850
Validation loss decreased (-0.799991 --> -0.849992).  Saving model ...
Epoch: 9 cost time: 0.39855527877807617
Epoch: 9, Steps: 3 | Train Loss: 0.680 Vali Loss: 0.703 Vali Acc: 0.925 Test Loss: 0.703 Test Acc: 0.925
Validation loss decreased (-0.849992 --> -0.924993).  Saving model ...
Epoch: 10 cost time: 0.3795788288116455
Epoch: 10, Steps: 3 | Train Loss: 0.599 Vali Loss: 0.636 Vali Acc: 0.950 Test Loss: 0.636 Test Acc: 0.950
Validation loss decreased (-0.924993 --> -0.949994).  Saving model ...
Epoch: 11 cost time: 0.3656599521636963
Epoch: 11, Steps: 3 | Train Loss: 0.531 Vali Loss: 0.567 Vali Acc: 0.950 Test Loss: 0.567 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949994).  Saving model ...
Epoch: 12 cost time: 0.38356661796569824
Epoch: 12, Steps: 3 | Train Loss: 0.458 Vali Loss: 0.510 Vali Acc: 0.975 Test Loss: 0.510 Test Acc: 0.975
Validation loss decreased (-0.949994 --> -0.974995).  Saving model ...
Epoch: 13 cost time: 0.3872089385986328
Epoch: 13, Steps: 3 | Train Loss: 0.404 Vali Loss: 0.463 Vali Acc: 0.975 Test Loss: 0.463 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 14 cost time: 0.36435532569885254
Epoch: 14, Steps: 3 | Train Loss: 0.341 Vali Loss: 0.427 Vali Acc: 0.975 Test Loss: 0.427 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 15 cost time: 0.4265322685241699
Epoch: 15, Steps: 3 | Train Loss: 0.310 Vali Loss: 0.391 Vali Acc: 0.975 Test Loss: 0.391 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 16 cost time: 0.40112829208374023
Epoch: 16, Steps: 3 | Train Loss: 0.309 Vali Loss: 0.358 Vali Acc: 0.975 Test Loss: 0.358 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 17 cost time: 0.38584208488464355
Epoch: 17, Steps: 3 | Train Loss: 0.233 Vali Loss: 0.331 Vali Acc: 0.975 Test Loss: 0.331 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 18 cost time: 0.4017455577850342
Epoch: 18, Steps: 3 | Train Loss: 0.234 Vali Loss: 0.314 Vali Acc: 0.975 Test Loss: 0.314 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 19 cost time: 0.3577594757080078
Epoch: 19, Steps: 3 | Train Loss: 0.202 Vali Loss: 0.293 Vali Acc: 0.975 Test Loss: 0.293 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 20 cost time: 0.34465670585632324
Epoch: 20, Steps: 3 | Train Loss: 0.190 Vali Loss: 0.277 Vali Acc: 0.975 Test Loss: 0.277 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 21 cost time: 0.37450289726257324
Epoch: 21, Steps: 3 | Train Loss: 0.173 Vali Loss: 0.260 Vali Acc: 0.975 Test Loss: 0.260 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 22 cost time: 0.3542137145996094
Epoch: 22, Steps: 3 | Train Loss: 0.175 Vali Loss: 0.243 Vali Acc: 0.975 Test Loss: 0.243 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 23 cost time: 0.3537483215332031
Epoch: 23, Steps: 3 | Train Loss: 0.161 Vali Loss: 0.238 Vali Acc: 0.975 Test Loss: 0.238 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 24 cost time: 0.3636469841003418
Epoch: 24, Steps: 3 | Train Loss: 0.142 Vali Loss: 0.233 Vali Acc: 0.975 Test Loss: 0.233 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 25 cost time: 0.4011704921722412
Epoch: 25, Steps: 3 | Train Loss: 0.151 Vali Loss: 0.227 Vali Acc: 0.975 Test Loss: 0.227 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 26 cost time: 0.3959834575653076
Epoch: 26, Steps: 3 | Train Loss: 0.126 Vali Loss: 0.225 Vali Acc: 0.975 Test Loss: 0.225 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 27 cost time: 0.3629491329193115
Epoch: 27, Steps: 3 | Train Loss: 0.091 Vali Loss: 0.221 Vali Acc: 0.975 Test Loss: 0.221 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 28 cost time: 0.37731456756591797
Epoch: 28, Steps: 3 | Train Loss: 0.103 Vali Loss: 0.216 Vali Acc: 0.975 Test Loss: 0.216 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 29 cost time: 0.39708495140075684
Epoch: 29, Steps: 3 | Train Loss: 0.116 Vali Loss: 0.206 Vali Acc: 0.975 Test Loss: 0.206 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 30 cost time: 0.42911791801452637
Epoch: 30, Steps: 3 | Train Loss: 0.104 Vali Loss: 0.198 Vali Acc: 0.975 Test Loss: 0.198 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 31 cost time: 0.3727583885192871
Epoch: 31, Steps: 3 | Train Loss: 0.080 Vali Loss: 0.186 Vali Acc: 0.975 Test Loss: 0.186 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 32 cost time: 0.38602137565612793
Epoch: 32, Steps: 3 | Train Loss: 0.095 Vali Loss: 0.184 Vali Acc: 0.975 Test Loss: 0.184 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 33 cost time: 0.4124023914337158
Epoch: 33, Steps: 3 | Train Loss: 0.072 Vali Loss: 0.177 Vali Acc: 0.975 Test Loss: 0.177 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 34 cost time: 0.3747079372406006
Epoch: 34, Steps: 3 | Train Loss: 0.078 Vali Loss: 0.174 Vali Acc: 0.975 Test Loss: 0.174 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 35 cost time: 0.4005897045135498
Epoch: 35, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.167 Vali Acc: 0.975 Test Loss: 0.167 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 36 cost time: 0.376936674118042
Epoch: 36, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.165 Vali Acc: 0.975 Test Loss: 0.165 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 37 cost time: 0.3578946590423584
Epoch: 37, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.169 Vali Acc: 0.975 Test Loss: 0.169 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.3726625442504883
Epoch: 38, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.162 Vali Acc: 0.975 Test Loss: 0.162 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 39 cost time: 0.37169909477233887
Epoch: 39, Steps: 3 | Train Loss: 0.061 Vali Loss: 0.164 Vali Acc: 0.975 Test Loss: 0.164 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.3701953887939453
Epoch: 40, Steps: 3 | Train Loss: 0.048 Vali Loss: 0.158 Vali Acc: 0.975 Test Loss: 0.158 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 41 cost time: 0.3963661193847656
Epoch: 41, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.151 Vali Acc: 0.975 Test Loss: 0.151 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 42 cost time: 0.36555910110473633
Epoch: 42, Steps: 3 | Train Loss: 0.040 Vali Loss: 0.146 Vali Acc: 0.975 Test Loss: 0.146 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974999).  Saving model ...
Epoch: 43 cost time: 0.3603515625
Epoch: 43, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.149 Vali Acc: 0.975 Test Loss: 0.149 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.38924551010131836
Epoch: 44, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.156 Vali Acc: 0.975 Test Loss: 0.156 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.419863224029541
Epoch: 45, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.156 Vali Acc: 0.975 Test Loss: 0.156 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.3897113800048828
Epoch: 46, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.146 Vali Acc: 0.975 Test Loss: 0.146 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.4053189754486084
Epoch: 47, Steps: 3 | Train Loss: 0.029 Vali Loss: 0.142 Vali Acc: 0.975 Test Loss: 0.142 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
Epoch: 48 cost time: 0.3804631233215332
Epoch: 48, Steps: 3 | Train Loss: 0.037 Vali Loss: 0.147 Vali Acc: 0.975 Test Loss: 0.147 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.4251091480255127
Epoch: 49, Steps: 3 | Train Loss: 0.035 Vali Loss: 0.143 Vali Acc: 0.975 Test Loss: 0.143 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.35024118423461914
Epoch: 50, Steps: 3 | Train Loss: 0.028 Vali Loss: 0.137 Vali Acc: 0.975 Test Loss: 0.137 Test Acc: 0.975
Validation loss decreased (-0.974999 --> -0.974999).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps25_str13_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 251140
model size : 0.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.4721910953521729
Epoch: 1, Steps: 3 | Train Loss: 1.407 Vali Loss: 1.326 Vali Acc: 0.400 Test Loss: 1.326 Test Acc: 0.400
Validation loss decreased (inf --> -0.399987).  Saving model ...
Epoch: 2 cost time: 0.38476133346557617
Epoch: 2, Steps: 3 | Train Loss: 1.269 Vali Loss: 1.241 Vali Acc: 0.425 Test Loss: 1.241 Test Acc: 0.425
Validation loss decreased (-0.399987 --> -0.424988).  Saving model ...
Epoch: 3 cost time: 0.35673975944519043
Epoch: 3, Steps: 3 | Train Loss: 1.049 Vali Loss: 1.112 Vali Acc: 0.525 Test Loss: 1.112 Test Acc: 0.525
Validation loss decreased (-0.424988 --> -0.524989).  Saving model ...
Epoch: 4 cost time: 0.3984556198120117
Epoch: 4, Steps: 3 | Train Loss: 0.889 Vali Loss: 0.971 Vali Acc: 0.575 Test Loss: 0.971 Test Acc: 0.575
Validation loss decreased (-0.524989 --> -0.574990).  Saving model ...
Epoch: 5 cost time: 0.3908696174621582
Epoch: 5, Steps: 3 | Train Loss: 0.714 Vali Loss: 0.824 Vali Acc: 0.675 Test Loss: 0.824 Test Acc: 0.675
Validation loss decreased (-0.574990 --> -0.674992).  Saving model ...
Epoch: 6 cost time: 0.35547494888305664
Epoch: 6, Steps: 3 | Train Loss: 0.597 Vali Loss: 0.686 Vali Acc: 0.800 Test Loss: 0.686 Test Acc: 0.800
Validation loss decreased (-0.674992 --> -0.799993).  Saving model ...
Epoch: 7 cost time: 0.368865966796875
Epoch: 7, Steps: 3 | Train Loss: 0.479 Vali Loss: 0.551 Vali Acc: 0.950 Test Loss: 0.551 Test Acc: 0.950
Validation loss decreased (-0.799993 --> -0.949994).  Saving model ...
Epoch: 8 cost time: 0.395571231842041
Epoch: 8, Steps: 3 | Train Loss: 0.355 Vali Loss: 0.439 Vali Acc: 0.975 Test Loss: 0.439 Test Acc: 0.975
Validation loss decreased (-0.949994 --> -0.974996).  Saving model ...
Epoch: 9 cost time: 0.41815710067749023
Epoch: 9, Steps: 3 | Train Loss: 0.280 Vali Loss: 0.364 Vali Acc: 0.975 Test Loss: 0.364 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 10 cost time: 0.3767693042755127
Epoch: 10, Steps: 3 | Train Loss: 0.250 Vali Loss: 0.322 Vali Acc: 0.950 Test Loss: 0.322 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.37030482292175293
Epoch: 11, Steps: 3 | Train Loss: 0.193 Vali Loss: 0.304 Vali Acc: 0.975 Test Loss: 0.304 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 12 cost time: 0.3327445983886719
Epoch: 12, Steps: 3 | Train Loss: 0.152 Vali Loss: 0.289 Vali Acc: 0.950 Test Loss: 0.289 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.4047393798828125
Epoch: 13, Steps: 3 | Train Loss: 0.134 Vali Loss: 0.284 Vali Acc: 0.950 Test Loss: 0.284 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.44576120376586914
Epoch: 14, Steps: 3 | Train Loss: 0.121 Vali Loss: 0.283 Vali Acc: 0.950 Test Loss: 0.283 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.4239652156829834
Epoch: 15, Steps: 3 | Train Loss: 0.095 Vali Loss: 0.282 Vali Acc: 0.950 Test Loss: 0.282 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.3834540843963623
Epoch: 16, Steps: 3 | Train Loss: 0.082 Vali Loss: 0.256 Vali Acc: 0.950 Test Loss: 0.256 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.4037356376647949
Epoch: 17, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.235 Vali Acc: 0.950 Test Loss: 0.235 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.40482211112976074
Epoch: 18, Steps: 3 | Train Loss: 0.061 Vali Loss: 0.229 Vali Acc: 0.950 Test Loss: 0.229 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.4763052463531494
Epoch: 19, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.227 Vali Acc: 0.950 Test Loss: 0.227 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.37520432472229004
Epoch: 20, Steps: 3 | Train Loss: 0.045 Vali Loss: 0.232 Vali Acc: 0.950 Test Loss: 0.232 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.39861226081848145
Epoch: 21, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.237 Vali Acc: 0.950 Test Loss: 0.237 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 141060
model size : 0.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.4342784881591797
Epoch: 1, Steps: 3 | Train Loss: 1.532 Vali Loss: 1.418 Vali Acc: 0.125 Test Loss: 1.418 Test Acc: 0.125
Validation loss decreased (inf --> -0.124986).  Saving model ...
Epoch: 2 cost time: 0.3871743679046631
Epoch: 2, Steps: 3 | Train Loss: 1.389 Vali Loss: 1.358 Vali Acc: 0.200 Test Loss: 1.358 Test Acc: 0.200
Validation loss decreased (-0.124986 --> -0.199986).  Saving model ...
Epoch: 3 cost time: 0.3413422107696533
Epoch: 3, Steps: 3 | Train Loss: 1.279 Vali Loss: 1.252 Vali Acc: 0.425 Test Loss: 1.252 Test Acc: 0.425
Validation loss decreased (-0.199986 --> -0.424987).  Saving model ...
Epoch: 4 cost time: 0.36630773544311523
Epoch: 4, Steps: 3 | Train Loss: 1.091 Vali Loss: 1.126 Vali Acc: 0.650 Test Loss: 1.126 Test Acc: 0.650
Validation loss decreased (-0.424987 --> -0.649989).  Saving model ...
Epoch: 5 cost time: 0.3904421329498291
Epoch: 5, Steps: 3 | Train Loss: 0.964 Vali Loss: 0.987 Vali Acc: 0.750 Test Loss: 0.987 Test Acc: 0.750
Validation loss decreased (-0.649989 --> -0.749990).  Saving model ...
Epoch: 6 cost time: 0.3613312244415283
Epoch: 6, Steps: 3 | Train Loss: 0.817 Vali Loss: 0.856 Vali Acc: 0.800 Test Loss: 0.856 Test Acc: 0.800
Validation loss decreased (-0.749990 --> -0.799991).  Saving model ...
Epoch: 7 cost time: 0.4128565788269043
Epoch: 7, Steps: 3 | Train Loss: 0.679 Vali Loss: 0.735 Vali Acc: 0.875 Test Loss: 0.735 Test Acc: 0.875
Validation loss decreased (-0.799991 --> -0.874993).  Saving model ...
Epoch: 8 cost time: 0.34625983238220215
Epoch: 8, Steps: 3 | Train Loss: 0.536 Vali Loss: 0.625 Vali Acc: 0.875 Test Loss: 0.625 Test Acc: 0.875
Validation loss decreased (-0.874993 --> -0.874994).  Saving model ...
Epoch: 9 cost time: 0.3918571472167969
Epoch: 9, Steps: 3 | Train Loss: 0.432 Vali Loss: 0.523 Vali Acc: 0.900 Test Loss: 0.523 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899995).  Saving model ...
Epoch: 10 cost time: 0.3473825454711914
Epoch: 10, Steps: 3 | Train Loss: 0.352 Vali Loss: 0.451 Vali Acc: 0.950 Test Loss: 0.451 Test Acc: 0.950
Validation loss decreased (-0.899995 --> -0.949995).  Saving model ...
Epoch: 11 cost time: 0.37901926040649414
Epoch: 11, Steps: 3 | Train Loss: 0.282 Vali Loss: 0.393 Vali Acc: 0.950 Test Loss: 0.393 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 12 cost time: 0.3783750534057617
Epoch: 12, Steps: 3 | Train Loss: 0.234 Vali Loss: 0.344 Vali Acc: 0.950 Test Loss: 0.344 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 13 cost time: 0.42438602447509766
Epoch: 13, Steps: 3 | Train Loss: 0.197 Vali Loss: 0.315 Vali Acc: 0.950 Test Loss: 0.315 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 14 cost time: 0.39635324478149414
Epoch: 14, Steps: 3 | Train Loss: 0.159 Vali Loss: 0.272 Vali Acc: 0.950 Test Loss: 0.272 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 15 cost time: 0.35354042053222656
Epoch: 15, Steps: 3 | Train Loss: 0.140 Vali Loss: 0.246 Vali Acc: 0.975 Test Loss: 0.246 Test Acc: 0.975
Validation loss decreased (-0.949997 --> -0.974998).  Saving model ...
Epoch: 16 cost time: 0.3706238269805908
Epoch: 16, Steps: 3 | Train Loss: 0.122 Vali Loss: 0.235 Vali Acc: 0.975 Test Loss: 0.235 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 17 cost time: 0.38767123222351074
Epoch: 17, Steps: 3 | Train Loss: 0.110 Vali Loss: 0.227 Vali Acc: 0.975 Test Loss: 0.227 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 18 cost time: 0.3671753406524658
Epoch: 18, Steps: 3 | Train Loss: 0.099 Vali Loss: 0.216 Vali Acc: 0.975 Test Loss: 0.216 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 19 cost time: 0.4286010265350342
Epoch: 19, Steps: 3 | Train Loss: 0.085 Vali Loss: 0.219 Vali Acc: 0.925 Test Loss: 0.219 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.36011600494384766
Epoch: 20, Steps: 3 | Train Loss: 0.079 Vali Loss: 0.215 Vali Acc: 0.925 Test Loss: 0.215 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.3778090476989746
Epoch: 21, Steps: 3 | Train Loss: 0.075 Vali Loss: 0.218 Vali Acc: 0.925 Test Loss: 0.218 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.4241678714752197
Epoch: 22, Steps: 3 | Train Loss: 0.071 Vali Loss: 0.219 Vali Acc: 0.925 Test Loss: 0.219 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.457660436630249
Epoch: 23, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.225 Vali Acc: 0.925 Test Loss: 0.225 Test Acc: 0.925
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.37517714500427246
Epoch: 24, Steps: 3 | Train Loss: 0.050 Vali Loss: 0.223 Vali Acc: 0.925 Test Loss: 0.223 Test Acc: 0.925
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.41735291481018066
Epoch: 25, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.226 Vali Acc: 0.925 Test Loss: 0.226 Test Acc: 0.925
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.382570743560791
Epoch: 26, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.229 Vali Acc: 0.925 Test Loss: 0.229 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.41434764862060547
Epoch: 27, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.230 Vali Acc: 0.925 Test Loss: 0.230 Test Acc: 0.925
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.440122127532959
Epoch: 28, Steps: 3 | Train Loss: 0.039 Vali Loss: 0.237 Vali Acc: 0.925 Test Loss: 0.237 Test Acc: 0.925
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 115076
model size : 0.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.368166208267212
Epoch: 1, Steps: 3 | Train Loss: 1.309 Vali Loss: 1.330 Vali Acc: 0.325 Test Loss: 1.330 Test Acc: 0.325
Validation loss decreased (inf --> -0.324987).  Saving model ...
Epoch: 2 cost time: 0.3508131504058838
Epoch: 2, Steps: 3 | Train Loss: 1.239 Vali Loss: 1.276 Vali Acc: 0.325 Test Loss: 1.276 Test Acc: 0.325
Validation loss decreased (-0.324987 --> -0.324987).  Saving model ...
Epoch: 3 cost time: 0.3881371021270752
Epoch: 3, Steps: 3 | Train Loss: 1.121 Vali Loss: 1.186 Vali Acc: 0.375 Test Loss: 1.186 Test Acc: 0.375
Validation loss decreased (-0.324987 --> -0.374988).  Saving model ...
Epoch: 4 cost time: 0.3204331398010254
Epoch: 4, Steps: 3 | Train Loss: 1.031 Vali Loss: 1.077 Vali Acc: 0.575 Test Loss: 1.077 Test Acc: 0.575
Validation loss decreased (-0.374988 --> -0.574989).  Saving model ...
Epoch: 5 cost time: 0.3230147361755371
Epoch: 5, Steps: 3 | Train Loss: 0.912 Vali Loss: 0.956 Vali Acc: 0.675 Test Loss: 0.956 Test Acc: 0.675
Validation loss decreased (-0.574989 --> -0.674990).  Saving model ...
Epoch: 6 cost time: 0.356001615524292
Epoch: 6, Steps: 3 | Train Loss: 0.789 Vali Loss: 0.837 Vali Acc: 0.850 Test Loss: 0.837 Test Acc: 0.850
Validation loss decreased (-0.674990 --> -0.849992).  Saving model ...
Epoch: 7 cost time: 0.33867859840393066
Epoch: 7, Steps: 3 | Train Loss: 0.661 Vali Loss: 0.726 Vali Acc: 0.900 Test Loss: 0.726 Test Acc: 0.900
Validation loss decreased (-0.849992 --> -0.899993).  Saving model ...
Epoch: 8 cost time: 0.3534417152404785
Epoch: 8, Steps: 3 | Train Loss: 0.608 Vali Loss: 0.631 Vali Acc: 0.950 Test Loss: 0.631 Test Acc: 0.950
Validation loss decreased (-0.899993 --> -0.949994).  Saving model ...
Epoch: 9 cost time: 0.34743690490722656
Epoch: 9, Steps: 3 | Train Loss: 0.473 Vali Loss: 0.558 Vali Acc: 0.975 Test Loss: 0.558 Test Acc: 0.975
Validation loss decreased (-0.949994 --> -0.974994).  Saving model ...
Epoch: 10 cost time: 0.411663293838501
Epoch: 10, Steps: 3 | Train Loss: 0.437 Vali Loss: 0.492 Vali Acc: 0.975 Test Loss: 0.492 Test Acc: 0.975
Validation loss decreased (-0.974994 --> -0.974995).  Saving model ...
Epoch: 11 cost time: 0.37077832221984863
Epoch: 11, Steps: 3 | Train Loss: 0.351 Vali Loss: 0.443 Vali Acc: 0.975 Test Loss: 0.443 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 12 cost time: 0.36706066131591797
Epoch: 12, Steps: 3 | Train Loss: 0.290 Vali Loss: 0.390 Vali Acc: 0.975 Test Loss: 0.390 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 13 cost time: 0.36240077018737793
Epoch: 13, Steps: 3 | Train Loss: 0.266 Vali Loss: 0.350 Vali Acc: 0.950 Test Loss: 0.350 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.36136722564697266
Epoch: 14, Steps: 3 | Train Loss: 0.217 Vali Loss: 0.325 Vali Acc: 0.950 Test Loss: 0.325 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.3932948112487793
Epoch: 15, Steps: 3 | Train Loss: 0.193 Vali Loss: 0.306 Vali Acc: 0.950 Test Loss: 0.306 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.3614664077758789
Epoch: 16, Steps: 3 | Train Loss: 0.190 Vali Loss: 0.297 Vali Acc: 0.950 Test Loss: 0.297 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.34444260597229004
Epoch: 17, Steps: 3 | Train Loss: 0.158 Vali Loss: 0.278 Vali Acc: 0.950 Test Loss: 0.278 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.38321661949157715
Epoch: 18, Steps: 3 | Train Loss: 0.143 Vali Loss: 0.266 Vali Acc: 0.950 Test Loss: 0.266 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.3496410846710205
Epoch: 19, Steps: 3 | Train Loss: 0.123 Vali Loss: 0.264 Vali Acc: 0.950 Test Loss: 0.264 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.37796878814697266
Epoch: 20, Steps: 3 | Train Loss: 0.115 Vali Loss: 0.257 Vali Acc: 0.950 Test Loss: 0.257 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.39430975914001465
Epoch: 21, Steps: 3 | Train Loss: 0.106 Vali Loss: 0.255 Vali Acc: 0.950 Test Loss: 0.255 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.44266414642333984
Epoch: 22, Steps: 3 | Train Loss: 0.099 Vali Loss: 0.243 Vali Acc: 0.950 Test Loss: 0.243 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 102980
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.394502878189087
Epoch: 1, Steps: 3 | Train Loss: 1.277 Vali Loss: 1.370 Vali Acc: 0.200 Test Loss: 1.370 Test Acc: 0.200
Validation loss decreased (inf --> -0.199986).  Saving model ...
Epoch: 2 cost time: 0.3694589138031006
Epoch: 2, Steps: 3 | Train Loss: 1.193 Vali Loss: 1.314 Vali Acc: 0.275 Test Loss: 1.314 Test Acc: 0.275
Validation loss decreased (-0.199986 --> -0.274987).  Saving model ...
Epoch: 3 cost time: 0.37966299057006836
Epoch: 3, Steps: 3 | Train Loss: 1.130 Vali Loss: 1.238 Vali Acc: 0.350 Test Loss: 1.238 Test Acc: 0.350
Validation loss decreased (-0.274987 --> -0.349988).  Saving model ...
Epoch: 4 cost time: 0.37033605575561523
Epoch: 4, Steps: 3 | Train Loss: 1.026 Vali Loss: 1.143 Vali Acc: 0.425 Test Loss: 1.143 Test Acc: 0.425
Validation loss decreased (-0.349988 --> -0.424989).  Saving model ...
Epoch: 5 cost time: 0.38471245765686035
Epoch: 5, Steps: 3 | Train Loss: 0.981 Vali Loss: 1.048 Vali Acc: 0.550 Test Loss: 1.048 Test Acc: 0.550
Validation loss decreased (-0.424989 --> -0.549990).  Saving model ...
Epoch: 6 cost time: 0.4237833023071289
Epoch: 6, Steps: 3 | Train Loss: 0.823 Vali Loss: 0.953 Vali Acc: 0.625 Test Loss: 0.953 Test Acc: 0.625
Validation loss decreased (-0.549990 --> -0.624990).  Saving model ...
Epoch: 7 cost time: 0.38678622245788574
Epoch: 7, Steps: 3 | Train Loss: 0.744 Vali Loss: 0.856 Vali Acc: 0.775 Test Loss: 0.856 Test Acc: 0.775
Validation loss decreased (-0.624990 --> -0.774991).  Saving model ...
Epoch: 8 cost time: 0.37241697311401367
Epoch: 8, Steps: 3 | Train Loss: 0.644 Vali Loss: 0.756 Vali Acc: 0.950 Test Loss: 0.756 Test Acc: 0.950
Validation loss decreased (-0.774991 --> -0.949992).  Saving model ...
Epoch: 9 cost time: 0.3477492332458496
Epoch: 9, Steps: 3 | Train Loss: 0.612 Vali Loss: 0.662 Vali Acc: 0.950 Test Loss: 0.662 Test Acc: 0.950
Validation loss decreased (-0.949992 --> -0.949993).  Saving model ...
Epoch: 10 cost time: 0.36890363693237305
Epoch: 10, Steps: 3 | Train Loss: 0.501 Vali Loss: 0.588 Vali Acc: 0.950 Test Loss: 0.588 Test Acc: 0.950
Validation loss decreased (-0.949993 --> -0.949994).  Saving model ...
Epoch: 11 cost time: 0.34718918800354004
Epoch: 11, Steps: 3 | Train Loss: 0.437 Vali Loss: 0.520 Vali Acc: 0.950 Test Loss: 0.520 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 12 cost time: 0.3964109420776367
Epoch: 12, Steps: 3 | Train Loss: 0.373 Vali Loss: 0.466 Vali Acc: 0.950 Test Loss: 0.466 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 13 cost time: 0.413602352142334
Epoch: 13, Steps: 3 | Train Loss: 0.322 Vali Loss: 0.422 Vali Acc: 0.950 Test Loss: 0.422 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 14 cost time: 0.39983224868774414
Epoch: 14, Steps: 3 | Train Loss: 0.244 Vali Loss: 0.378 Vali Acc: 0.950 Test Loss: 0.378 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 15 cost time: 0.36257100105285645
Epoch: 15, Steps: 3 | Train Loss: 0.282 Vali Loss: 0.352 Vali Acc: 0.950 Test Loss: 0.352 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 16 cost time: 0.36206865310668945
Epoch: 16, Steps: 3 | Train Loss: 0.213 Vali Loss: 0.343 Vali Acc: 0.950 Test Loss: 0.343 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 17 cost time: 0.4049699306488037
Epoch: 17, Steps: 3 | Train Loss: 0.211 Vali Loss: 0.321 Vali Acc: 0.950 Test Loss: 0.321 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 18 cost time: 0.3831796646118164
Epoch: 18, Steps: 3 | Train Loss: 0.185 Vali Loss: 0.301 Vali Acc: 0.950 Test Loss: 0.301 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 19 cost time: 0.4262263774871826
Epoch: 19, Steps: 3 | Train Loss: 0.169 Vali Loss: 0.285 Vali Acc: 0.975 Test Loss: 0.285 Test Acc: 0.975
Validation loss decreased (-0.949997 --> -0.974997).  Saving model ...
Epoch: 20 cost time: 0.3489508628845215
Epoch: 20, Steps: 3 | Train Loss: 0.157 Vali Loss: 0.269 Vali Acc: 0.975 Test Loss: 0.269 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 21 cost time: 0.3595545291900635
Epoch: 21, Steps: 3 | Train Loss: 0.138 Vali Loss: 0.255 Vali Acc: 0.975 Test Loss: 0.255 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 22 cost time: 0.5285251140594482
Epoch: 22, Steps: 3 | Train Loss: 0.115 Vali Loss: 0.253 Vali Acc: 0.975 Test Loss: 0.253 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 23 cost time: 0.35095810890197754
Epoch: 23, Steps: 3 | Train Loss: 0.117 Vali Loss: 0.238 Vali Acc: 0.975 Test Loss: 0.238 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 24 cost time: 0.346386194229126
Epoch: 24, Steps: 3 | Train Loss: 0.102 Vali Loss: 0.225 Vali Acc: 0.975 Test Loss: 0.225 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 25 cost time: 0.36630725860595703
Epoch: 25, Steps: 3 | Train Loss: 0.098 Vali Loss: 0.215 Vali Acc: 0.975 Test Loss: 0.215 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 26 cost time: 0.36958837509155273
Epoch: 26, Steps: 3 | Train Loss: 0.098 Vali Loss: 0.214 Vali Acc: 0.975 Test Loss: 0.214 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 27 cost time: 0.3809022903442383
Epoch: 27, Steps: 3 | Train Loss: 0.082 Vali Loss: 0.213 Vali Acc: 0.950 Test Loss: 0.213 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.38871240615844727
Epoch: 28, Steps: 3 | Train Loss: 0.088 Vali Loss: 0.213 Vali Acc: 0.950 Test Loss: 0.213 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.3763282299041748
Epoch: 29, Steps: 3 | Train Loss: 0.081 Vali Loss: 0.214 Vali Acc: 0.950 Test Loss: 0.214 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.38323259353637695
Epoch: 30, Steps: 3 | Train Loss: 0.061 Vali Loss: 0.209 Vali Acc: 0.950 Test Loss: 0.209 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.4149620532989502
Epoch: 31, Steps: 3 | Train Loss: 0.055 Vali Loss: 0.204 Vali Acc: 0.950 Test Loss: 0.204 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.39048242568969727
Epoch: 32, Steps: 3 | Train Loss: 0.066 Vali Loss: 0.209 Vali Acc: 0.950 Test Loss: 0.209 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.3787710666656494
Epoch: 33, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.205 Vali Acc: 0.950 Test Loss: 0.205 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.3660135269165039
Epoch: 34, Steps: 3 | Train Loss: 0.053 Vali Loss: 0.208 Vali Acc: 0.950 Test Loss: 0.208 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.4486687183380127
Epoch: 35, Steps: 3 | Train Loss: 0.062 Vali Loss: 0.212 Vali Acc: 0.950 Test Loss: 0.212 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.46206164360046387
Epoch: 36, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.212 Vali Acc: 0.950 Test Loss: 0.212 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 95428
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.4693737030029297
Epoch: 1, Steps: 3 | Train Loss: 1.313 Vali Loss: 1.316 Vali Acc: 0.225 Test Loss: 1.316 Test Acc: 0.225
Validation loss decreased (inf --> -0.224987).  Saving model ...
Epoch: 2 cost time: 0.3692152500152588
Epoch: 2, Steps: 3 | Train Loss: 1.253 Vali Loss: 1.283 Vali Acc: 0.275 Test Loss: 1.283 Test Acc: 0.275
Validation loss decreased (-0.224987 --> -0.274987).  Saving model ...
Epoch: 3 cost time: 0.3857541084289551
Epoch: 3, Steps: 3 | Train Loss: 1.171 Vali Loss: 1.239 Vali Acc: 0.300 Test Loss: 1.239 Test Acc: 0.300
Validation loss decreased (-0.274987 --> -0.299988).  Saving model ...
Epoch: 4 cost time: 0.3459339141845703
Epoch: 4, Steps: 3 | Train Loss: 1.172 Vali Loss: 1.177 Vali Acc: 0.350 Test Loss: 1.177 Test Acc: 0.350
Validation loss decreased (-0.299988 --> -0.349988).  Saving model ...
Epoch: 5 cost time: 0.3632950782775879
Epoch: 5, Steps: 3 | Train Loss: 1.059 Vali Loss: 1.108 Vali Acc: 0.475 Test Loss: 1.108 Test Acc: 0.475
Validation loss decreased (-0.349988 --> -0.474989).  Saving model ...
Epoch: 6 cost time: 0.40419721603393555
Epoch: 6, Steps: 3 | Train Loss: 1.015 Vali Loss: 1.034 Vali Acc: 0.600 Test Loss: 1.034 Test Acc: 0.600
Validation loss decreased (-0.474989 --> -0.599990).  Saving model ...
Epoch: 7 cost time: 0.4626920223236084
Epoch: 7, Steps: 3 | Train Loss: 0.972 Vali Loss: 0.959 Vali Acc: 0.625 Test Loss: 0.959 Test Acc: 0.625
Validation loss decreased (-0.599990 --> -0.624990).  Saving model ...
Epoch: 8 cost time: 0.3550715446472168
Epoch: 8, Steps: 3 | Train Loss: 0.874 Vali Loss: 0.883 Vali Acc: 0.650 Test Loss: 0.883 Test Acc: 0.650
Validation loss decreased (-0.624990 --> -0.649991).  Saving model ...
Epoch: 9 cost time: 0.37180328369140625
Epoch: 9, Steps: 3 | Train Loss: 0.793 Vali Loss: 0.812 Vali Acc: 0.800 Test Loss: 0.812 Test Acc: 0.800
Validation loss decreased (-0.649991 --> -0.799992).  Saving model ...
Epoch: 10 cost time: 0.4047725200653076
Epoch: 10, Steps: 3 | Train Loss: 0.688 Vali Loss: 0.753 Vali Acc: 0.925 Test Loss: 0.753 Test Acc: 0.925
Validation loss decreased (-0.799992 --> -0.924992).  Saving model ...
Epoch: 11 cost time: 0.35354113578796387
Epoch: 11, Steps: 3 | Train Loss: 0.608 Vali Loss: 0.692 Vali Acc: 0.925 Test Loss: 0.692 Test Acc: 0.925
Validation loss decreased (-0.924992 --> -0.924993).  Saving model ...
Epoch: 12 cost time: 0.3587219715118408
Epoch: 12, Steps: 3 | Train Loss: 0.582 Vali Loss: 0.626 Vali Acc: 0.950 Test Loss: 0.626 Test Acc: 0.950
Validation loss decreased (-0.924993 --> -0.949994).  Saving model ...
Epoch: 13 cost time: 0.46536779403686523
Epoch: 13, Steps: 3 | Train Loss: 0.493 Vali Loss: 0.570 Vali Acc: 0.975 Test Loss: 0.570 Test Acc: 0.975
Validation loss decreased (-0.949994 --> -0.974994).  Saving model ...
Epoch: 14 cost time: 0.40146827697753906
Epoch: 14, Steps: 3 | Train Loss: 0.477 Vali Loss: 0.520 Vali Acc: 0.975 Test Loss: 0.520 Test Acc: 0.975
Validation loss decreased (-0.974994 --> -0.974995).  Saving model ...
Epoch: 15 cost time: 0.414750337600708
Epoch: 15, Steps: 3 | Train Loss: 0.434 Vali Loss: 0.485 Vali Acc: 0.975 Test Loss: 0.485 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 16 cost time: 0.38048267364501953
Epoch: 16, Steps: 3 | Train Loss: 0.358 Vali Loss: 0.454 Vali Acc: 0.975 Test Loss: 0.454 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 17 cost time: 0.4091649055480957
Epoch: 17, Steps: 3 | Train Loss: 0.346 Vali Loss: 0.422 Vali Acc: 0.975 Test Loss: 0.422 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 18 cost time: 0.3972799777984619
Epoch: 18, Steps: 3 | Train Loss: 0.302 Vali Loss: 0.393 Vali Acc: 0.975 Test Loss: 0.393 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 19 cost time: 0.40291643142700195
Epoch: 19, Steps: 3 | Train Loss: 0.271 Vali Loss: 0.373 Vali Acc: 0.975 Test Loss: 0.373 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 20 cost time: 0.37837910652160645
Epoch: 20, Steps: 3 | Train Loss: 0.256 Vali Loss: 0.351 Vali Acc: 0.975 Test Loss: 0.351 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 21 cost time: 0.4638814926147461
Epoch: 21, Steps: 3 | Train Loss: 0.259 Vali Loss: 0.337 Vali Acc: 0.975 Test Loss: 0.337 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 22 cost time: 0.4812164306640625
Epoch: 22, Steps: 3 | Train Loss: 0.205 Vali Loss: 0.314 Vali Acc: 0.975 Test Loss: 0.314 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 23 cost time: 0.4465501308441162
Epoch: 23, Steps: 3 | Train Loss: 0.201 Vali Loss: 0.299 Vali Acc: 0.975 Test Loss: 0.299 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 24 cost time: 0.38009214401245117
Epoch: 24, Steps: 3 | Train Loss: 0.192 Vali Loss: 0.283 Vali Acc: 0.975 Test Loss: 0.283 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 25 cost time: 0.3543870449066162
Epoch: 25, Steps: 3 | Train Loss: 0.178 Vali Loss: 0.279 Vali Acc: 0.975 Test Loss: 0.279 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 26 cost time: 0.38774752616882324
Epoch: 26, Steps: 3 | Train Loss: 0.155 Vali Loss: 0.265 Vali Acc: 0.975 Test Loss: 0.265 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 27 cost time: 0.3709263801574707
Epoch: 27, Steps: 3 | Train Loss: 0.147 Vali Loss: 0.257 Vali Acc: 0.975 Test Loss: 0.257 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 28 cost time: 0.3744833469390869
Epoch: 28, Steps: 3 | Train Loss: 0.158 Vali Loss: 0.249 Vali Acc: 0.975 Test Loss: 0.249 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 29 cost time: 0.3868136405944824
Epoch: 29, Steps: 3 | Train Loss: 0.143 Vali Loss: 0.241 Vali Acc: 0.975 Test Loss: 0.241 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 30 cost time: 0.39165568351745605
Epoch: 30, Steps: 3 | Train Loss: 0.125 Vali Loss: 0.227 Vali Acc: 0.975 Test Loss: 0.227 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 31 cost time: 0.42003345489501953
Epoch: 31, Steps: 3 | Train Loss: 0.116 Vali Loss: 0.221 Vali Acc: 0.975 Test Loss: 0.221 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 32 cost time: 0.4390602111816406
Epoch: 32, Steps: 3 | Train Loss: 0.115 Vali Loss: 0.212 Vali Acc: 0.975 Test Loss: 0.212 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 33 cost time: 0.3648853302001953
Epoch: 33, Steps: 3 | Train Loss: 0.101 Vali Loss: 0.203 Vali Acc: 0.975 Test Loss: 0.203 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 34 cost time: 0.369992733001709
Epoch: 34, Steps: 3 | Train Loss: 0.102 Vali Loss: 0.200 Vali Acc: 0.975 Test Loss: 0.200 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 35 cost time: 0.3866753578186035
Epoch: 35, Steps: 3 | Train Loss: 0.099 Vali Loss: 0.205 Vali Acc: 0.975 Test Loss: 0.205 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.4055826663970947
Epoch: 36, Steps: 3 | Train Loss: 0.092 Vali Loss: 0.200 Vali Acc: 0.975 Test Loss: 0.200 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 37 cost time: 0.5115346908569336
Epoch: 37, Steps: 3 | Train Loss: 0.085 Vali Loss: 0.203 Vali Acc: 0.975 Test Loss: 0.203 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.39993977546691895
Epoch: 38, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.202 Vali Acc: 0.975 Test Loss: 0.202 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.36041808128356934
Epoch: 39, Steps: 3 | Train Loss: 0.082 Vali Loss: 0.196 Vali Acc: 0.975 Test Loss: 0.196 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 40 cost time: 0.41472768783569336
Epoch: 40, Steps: 3 | Train Loss: 0.064 Vali Loss: 0.186 Vali Acc: 0.975 Test Loss: 0.186 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 41 cost time: 0.3784635066986084
Epoch: 41, Steps: 3 | Train Loss: 0.071 Vali Loss: 0.182 Vali Acc: 0.975 Test Loss: 0.182 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 42 cost time: 0.34697580337524414
Epoch: 42, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.188 Vali Acc: 0.975 Test Loss: 0.188 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.3843655586242676
Epoch: 43, Steps: 3 | Train Loss: 0.063 Vali Loss: 0.190 Vali Acc: 0.975 Test Loss: 0.190 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.36188650131225586
Epoch: 44, Steps: 3 | Train Loss: 0.052 Vali Loss: 0.181 Vali Acc: 0.975 Test Loss: 0.181 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 45 cost time: 0.3538048267364502
Epoch: 45, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.180 Vali Acc: 0.975 Test Loss: 0.180 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 46 cost time: 0.3728806972503662
Epoch: 46, Steps: 3 | Train Loss: 0.051 Vali Loss: 0.174 Vali Acc: 0.975 Test Loss: 0.174 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 47 cost time: 0.4028911590576172
Epoch: 47, Steps: 3 | Train Loss: 0.056 Vali Loss: 0.176 Vali Acc: 0.975 Test Loss: 0.176 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.43062376976013184
Epoch: 48, Steps: 3 | Train Loss: 0.047 Vali Loss: 0.180 Vali Acc: 0.975 Test Loss: 0.180 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.43492770195007324
Epoch: 49, Steps: 3 | Train Loss: 0.054 Vali Loss: 0.180 Vali Acc: 0.975 Test Loss: 0.180 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.3895576000213623
Epoch: 50, Steps: 3 | Train Loss: 0.043 Vali Loss: 0.174 Vali Acc: 0.975 Test Loss: 0.174 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 83460
model size : 0.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps20_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.478170394897461
Epoch: 1, Steps: 3 | Train Loss: 1.225 Vali Loss: 1.293 Vali Acc: 0.500 Test Loss: 1.293 Test Acc: 0.500
Validation loss decreased (inf --> -0.499987).  Saving model ...
Epoch: 2 cost time: 0.3897514343261719
Epoch: 2, Steps: 3 | Train Loss: 1.180 Vali Loss: 1.256 Vali Acc: 0.525 Test Loss: 1.256 Test Acc: 0.525
Validation loss decreased (-0.499987 --> -0.524987).  Saving model ...
Epoch: 3 cost time: 0.4437980651855469
Epoch: 3, Steps: 3 | Train Loss: 1.165 Vali Loss: 1.215 Vali Acc: 0.550 Test Loss: 1.215 Test Acc: 0.550
Validation loss decreased (-0.524987 --> -0.549988).  Saving model ...
Epoch: 4 cost time: 0.3594532012939453
Epoch: 4, Steps: 3 | Train Loss: 1.059 Vali Loss: 1.163 Vali Acc: 0.550 Test Loss: 1.163 Test Acc: 0.550
Validation loss decreased (-0.549988 --> -0.549988).  Saving model ...
Epoch: 5 cost time: 0.3809328079223633
Epoch: 5, Steps: 3 | Train Loss: 1.058 Vali Loss: 1.104 Vali Acc: 0.575 Test Loss: 1.104 Test Acc: 0.575
Validation loss decreased (-0.549988 --> -0.574989).  Saving model ...
Epoch: 6 cost time: 0.360706090927124
Epoch: 6, Steps: 3 | Train Loss: 0.967 Vali Loss: 1.042 Vali Acc: 0.575 Test Loss: 1.042 Test Acc: 0.575
Validation loss decreased (-0.574989 --> -0.574990).  Saving model ...
Epoch: 7 cost time: 0.34993696212768555
Epoch: 7, Steps: 3 | Train Loss: 0.876 Vali Loss: 0.988 Vali Acc: 0.625 Test Loss: 0.988 Test Acc: 0.625
Validation loss decreased (-0.574990 --> -0.624990).  Saving model ...
Epoch: 8 cost time: 0.3496885299682617
Epoch: 8, Steps: 3 | Train Loss: 0.803 Vali Loss: 0.934 Vali Acc: 0.650 Test Loss: 0.934 Test Acc: 0.650
Validation loss decreased (-0.624990 --> -0.649991).  Saving model ...
Epoch: 9 cost time: 0.3538846969604492
Epoch: 9, Steps: 3 | Train Loss: 0.759 Vali Loss: 0.876 Vali Acc: 0.725 Test Loss: 0.876 Test Acc: 0.725
Validation loss decreased (-0.649991 --> -0.724991).  Saving model ...
Epoch: 10 cost time: 0.37043023109436035
Epoch: 10, Steps: 3 | Train Loss: 0.733 Vali Loss: 0.815 Vali Acc: 0.775 Test Loss: 0.815 Test Acc: 0.775
Validation loss decreased (-0.724991 --> -0.774992).  Saving model ...
Epoch: 11 cost time: 0.3785562515258789
Epoch: 11, Steps: 3 | Train Loss: 0.668 Vali Loss: 0.756 Vali Acc: 0.825 Test Loss: 0.756 Test Acc: 0.825
Validation loss decreased (-0.774992 --> -0.824992).  Saving model ...
Epoch: 12 cost time: 0.4237349033355713
Epoch: 12, Steps: 3 | Train Loss: 0.602 Vali Loss: 0.705 Vali Acc: 0.825 Test Loss: 0.705 Test Acc: 0.825
Validation loss decreased (-0.824992 --> -0.824993).  Saving model ...
Epoch: 13 cost time: 0.34739184379577637
Epoch: 13, Steps: 3 | Train Loss: 0.561 Vali Loss: 0.652 Vali Acc: 0.825 Test Loss: 0.652 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824993).  Saving model ...
Epoch: 14 cost time: 0.3243858814239502
Epoch: 14, Steps: 3 | Train Loss: 0.502 Vali Loss: 0.612 Vali Acc: 0.850 Test Loss: 0.612 Test Acc: 0.850
Validation loss decreased (-0.824993 --> -0.849994).  Saving model ...
Epoch: 15 cost time: 0.36693859100341797
Epoch: 15, Steps: 3 | Train Loss: 0.467 Vali Loss: 0.575 Vali Acc: 0.875 Test Loss: 0.575 Test Acc: 0.875
Validation loss decreased (-0.849994 --> -0.874994).  Saving model ...
Epoch: 16 cost time: 0.3073592185974121
Epoch: 16, Steps: 3 | Train Loss: 0.437 Vali Loss: 0.538 Vali Acc: 0.900 Test Loss: 0.538 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899995).  Saving model ...
Epoch: 17 cost time: 0.43619441986083984
Epoch: 17, Steps: 3 | Train Loss: 0.363 Vali Loss: 0.505 Vali Acc: 0.900 Test Loss: 0.505 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 18 cost time: 0.3758814334869385
Epoch: 18, Steps: 3 | Train Loss: 0.373 Vali Loss: 0.481 Vali Acc: 0.900 Test Loss: 0.481 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 19 cost time: 0.3195514678955078
Epoch: 19, Steps: 3 | Train Loss: 0.336 Vali Loss: 0.455 Vali Acc: 0.900 Test Loss: 0.455 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 20 cost time: 0.39133262634277344
Epoch: 20, Steps: 3 | Train Loss: 0.327 Vali Loss: 0.440 Vali Acc: 0.900 Test Loss: 0.440 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 21 cost time: 0.35673093795776367
Epoch: 21, Steps: 3 | Train Loss: 0.300 Vali Loss: 0.417 Vali Acc: 0.900 Test Loss: 0.417 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 22 cost time: 0.3824489116668701
Epoch: 22, Steps: 3 | Train Loss: 0.279 Vali Loss: 0.401 Vali Acc: 0.900 Test Loss: 0.401 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 23 cost time: 0.365797758102417
Epoch: 23, Steps: 3 | Train Loss: 0.245 Vali Loss: 0.379 Vali Acc: 0.925 Test Loss: 0.379 Test Acc: 0.925
Validation loss decreased (-0.899996 --> -0.924996).  Saving model ...
Epoch: 24 cost time: 0.35094618797302246
Epoch: 24, Steps: 3 | Train Loss: 0.227 Vali Loss: 0.366 Vali Acc: 0.950 Test Loss: 0.366 Test Acc: 0.950
Validation loss decreased (-0.924996 --> -0.949996).  Saving model ...
Epoch: 25 cost time: 0.3757445812225342
Epoch: 25, Steps: 3 | Train Loss: 0.235 Vali Loss: 0.349 Vali Acc: 0.950 Test Loss: 0.349 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 26 cost time: 0.41150999069213867
Epoch: 26, Steps: 3 | Train Loss: 0.211 Vali Loss: 0.341 Vali Acc: 0.950 Test Loss: 0.341 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 27 cost time: 0.45595788955688477
Epoch: 27, Steps: 3 | Train Loss: 0.211 Vali Loss: 0.327 Vali Acc: 0.950 Test Loss: 0.327 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 28 cost time: 0.4789121150970459
Epoch: 28, Steps: 3 | Train Loss: 0.180 Vali Loss: 0.317 Vali Acc: 0.950 Test Loss: 0.317 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 29 cost time: 0.46051025390625
Epoch: 29, Steps: 3 | Train Loss: 0.149 Vali Loss: 0.309 Vali Acc: 0.950 Test Loss: 0.309 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 30 cost time: 0.3546464443206787
Epoch: 30, Steps: 3 | Train Loss: 0.168 Vali Loss: 0.307 Vali Acc: 0.950 Test Loss: 0.307 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 31 cost time: 0.4404003620147705
Epoch: 31, Steps: 3 | Train Loss: 0.171 Vali Loss: 0.298 Vali Acc: 0.950 Test Loss: 0.298 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 32 cost time: 0.43196582794189453
Epoch: 32, Steps: 3 | Train Loss: 0.145 Vali Loss: 0.290 Vali Acc: 0.950 Test Loss: 0.290 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 33 cost time: 0.4035782814025879
Epoch: 33, Steps: 3 | Train Loss: 0.142 Vali Loss: 0.284 Vali Acc: 0.950 Test Loss: 0.284 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 34 cost time: 0.44153285026550293
Epoch: 34, Steps: 3 | Train Loss: 0.134 Vali Loss: 0.275 Vali Acc: 0.950 Test Loss: 0.275 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 35 cost time: 0.427748441696167
Epoch: 35, Steps: 3 | Train Loss: 0.136 Vali Loss: 0.264 Vali Acc: 0.950 Test Loss: 0.264 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 36 cost time: 0.4950418472290039
Epoch: 36, Steps: 3 | Train Loss: 0.103 Vali Loss: 0.261 Vali Acc: 0.950 Test Loss: 0.261 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 37 cost time: 0.47594404220581055
Epoch: 37, Steps: 3 | Train Loss: 0.105 Vali Loss: 0.260 Vali Acc: 0.950 Test Loss: 0.260 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 38 cost time: 0.36101794242858887
Epoch: 38, Steps: 3 | Train Loss: 0.123 Vali Loss: 0.259 Vali Acc: 0.950 Test Loss: 0.259 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 39 cost time: 0.3850841522216797
Epoch: 39, Steps: 3 | Train Loss: 0.099 Vali Loss: 0.255 Vali Acc: 0.950 Test Loss: 0.255 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 40 cost time: 0.37549853324890137
Epoch: 40, Steps: 3 | Train Loss: 0.095 Vali Loss: 0.253 Vali Acc: 0.950 Test Loss: 0.253 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 41 cost time: 0.39475560188293457
Epoch: 41, Steps: 3 | Train Loss: 0.092 Vali Loss: 0.248 Vali Acc: 0.950 Test Loss: 0.248 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 42 cost time: 0.3646669387817383
Epoch: 42, Steps: 3 | Train Loss: 0.071 Vali Loss: 0.238 Vali Acc: 0.950 Test Loss: 0.238 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 43 cost time: 0.4486551284790039
Epoch: 43, Steps: 3 | Train Loss: 0.088 Vali Loss: 0.239 Vali Acc: 0.950 Test Loss: 0.239 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.3453950881958008
Epoch: 44, Steps: 3 | Train Loss: 0.075 Vali Loss: 0.241 Vali Acc: 0.950 Test Loss: 0.241 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.4800407886505127
Epoch: 45, Steps: 3 | Train Loss: 0.076 Vali Loss: 0.235 Vali Acc: 0.950 Test Loss: 0.235 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 46 cost time: 0.3384528160095215
Epoch: 46, Steps: 3 | Train Loss: 0.074 Vali Loss: 0.238 Vali Acc: 0.975 Test Loss: 0.238 Test Acc: 0.975
Validation loss decreased (-0.949998 --> -0.974998).  Saving model ...
Epoch: 47 cost time: 0.44814157485961914
Epoch: 47, Steps: 3 | Train Loss: 0.068 Vali Loss: 0.239 Vali Acc: 0.950 Test Loss: 0.239 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.4632389545440674
Epoch: 48, Steps: 3 | Train Loss: 0.057 Vali Loss: 0.223 Vali Acc: 0.950 Test Loss: 0.223 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.34583449363708496
Epoch: 49, Steps: 3 | Train Loss: 0.062 Vali Loss: 0.215 Vali Acc: 0.950 Test Loss: 0.215 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.34772515296936035
Epoch: 50, Steps: 3 | Train Loss: 0.059 Vali Loss: 0.208 Vali Acc: 0.950 Test Loss: 0.208 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps20_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 80708
model size : 0.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps25_str13_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.4258952140808105
Epoch: 1, Steps: 3 | Train Loss: 1.463 Vali Loss: 1.339 Vali Acc: 0.350 Test Loss: 1.339 Test Acc: 0.350
Validation loss decreased (inf --> -0.349987).  Saving model ...
Epoch: 2 cost time: 0.39427638053894043
Epoch: 2, Steps: 3 | Train Loss: 1.388 Vali Loss: 1.306 Vali Acc: 0.400 Test Loss: 1.306 Test Acc: 0.400
Validation loss decreased (-0.349987 --> -0.399987).  Saving model ...
Epoch: 3 cost time: 0.3612706661224365
Epoch: 3, Steps: 3 | Train Loss: 1.309 Vali Loss: 1.272 Vali Acc: 0.475 Test Loss: 1.272 Test Acc: 0.475
Validation loss decreased (-0.399987 --> -0.474987).  Saving model ...
Epoch: 4 cost time: 0.34435272216796875
Epoch: 4, Steps: 3 | Train Loss: 1.271 Vali Loss: 1.224 Vali Acc: 0.500 Test Loss: 1.224 Test Acc: 0.500
Validation loss decreased (-0.474987 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 0.3795487880706787
Epoch: 5, Steps: 3 | Train Loss: 1.184 Vali Loss: 1.169 Vali Acc: 0.525 Test Loss: 1.169 Test Acc: 0.525
Validation loss decreased (-0.499988 --> -0.524988).  Saving model ...
Epoch: 6 cost time: 0.3387916088104248
Epoch: 6, Steps: 3 | Train Loss: 1.169 Vali Loss: 1.111 Vali Acc: 0.650 Test Loss: 1.111 Test Acc: 0.650
Validation loss decreased (-0.524988 --> -0.649989).  Saving model ...
Epoch: 7 cost time: 0.3491988182067871
Epoch: 7, Steps: 3 | Train Loss: 1.056 Vali Loss: 1.051 Vali Acc: 0.625 Test Loss: 1.051 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.32744312286376953
Epoch: 8, Steps: 3 | Train Loss: 0.982 Vali Loss: 0.998 Vali Acc: 0.675 Test Loss: 0.998 Test Acc: 0.675
Validation loss decreased (-0.649989 --> -0.674990).  Saving model ...
Epoch: 9 cost time: 0.347898006439209
Epoch: 9, Steps: 3 | Train Loss: 0.921 Vali Loss: 0.941 Vali Acc: 0.675 Test Loss: 0.941 Test Acc: 0.675
Validation loss decreased (-0.674990 --> -0.674991).  Saving model ...
Epoch: 10 cost time: 0.3903541564941406
Epoch: 10, Steps: 3 | Train Loss: 0.880 Vali Loss: 0.885 Vali Acc: 0.725 Test Loss: 0.885 Test Acc: 0.725
Validation loss decreased (-0.674991 --> -0.724991).  Saving model ...
Epoch: 11 cost time: 0.37389302253723145
Epoch: 11, Steps: 3 | Train Loss: 0.819 Vali Loss: 0.830 Vali Acc: 0.750 Test Loss: 0.830 Test Acc: 0.750
Validation loss decreased (-0.724991 --> -0.749992).  Saving model ...
Epoch: 12 cost time: 0.3194615840911865
Epoch: 12, Steps: 3 | Train Loss: 0.772 Vali Loss: 0.781 Vali Acc: 0.750 Test Loss: 0.781 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 13 cost time: 0.34735560417175293
Epoch: 13, Steps: 3 | Train Loss: 0.741 Vali Loss: 0.730 Vali Acc: 0.775 Test Loss: 0.730 Test Acc: 0.775
Validation loss decreased (-0.749992 --> -0.774993).  Saving model ...
Epoch: 14 cost time: 0.38892555236816406
Epoch: 14, Steps: 3 | Train Loss: 0.656 Vali Loss: 0.688 Vali Acc: 0.800 Test Loss: 0.688 Test Acc: 0.800
Validation loss decreased (-0.774993 --> -0.799993).  Saving model ...
Epoch: 15 cost time: 0.3782382011413574
Epoch: 15, Steps: 3 | Train Loss: 0.588 Vali Loss: 0.650 Vali Acc: 0.825 Test Loss: 0.650 Test Acc: 0.825
Validation loss decreased (-0.799993 --> -0.824993).  Saving model ...
Epoch: 16 cost time: 0.3732600212097168
Epoch: 16, Steps: 3 | Train Loss: 0.555 Vali Loss: 0.617 Vali Acc: 0.825 Test Loss: 0.617 Test Acc: 0.825
Validation loss decreased (-0.824993 --> -0.824994).  Saving model ...
Epoch: 17 cost time: 0.3780639171600342
Epoch: 17, Steps: 3 | Train Loss: 0.560 Vali Loss: 0.581 Vali Acc: 0.850 Test Loss: 0.581 Test Acc: 0.850
Validation loss decreased (-0.824994 --> -0.849994).  Saving model ...
Epoch: 18 cost time: 0.36052417755126953
Epoch: 18, Steps: 3 | Train Loss: 0.466 Vali Loss: 0.548 Vali Acc: 0.875 Test Loss: 0.548 Test Acc: 0.875
Validation loss decreased (-0.849994 --> -0.874995).  Saving model ...
Epoch: 19 cost time: 0.3670680522918701
Epoch: 19, Steps: 3 | Train Loss: 0.446 Vali Loss: 0.515 Vali Acc: 0.900 Test Loss: 0.515 Test Acc: 0.900
Validation loss decreased (-0.874995 --> -0.899995).  Saving model ...
Epoch: 20 cost time: 0.36433911323547363
Epoch: 20, Steps: 3 | Train Loss: 0.424 Vali Loss: 0.486 Vali Acc: 0.900 Test Loss: 0.486 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 21 cost time: 0.34630250930786133
Epoch: 21, Steps: 3 | Train Loss: 0.394 Vali Loss: 0.458 Vali Acc: 0.925 Test Loss: 0.458 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924995).  Saving model ...
Epoch: 22 cost time: 0.34940648078918457
Epoch: 22, Steps: 3 | Train Loss: 0.389 Vali Loss: 0.437 Vali Acc: 0.950 Test Loss: 0.437 Test Acc: 0.950
Validation loss decreased (-0.924995 --> -0.949996).  Saving model ...
Epoch: 23 cost time: 0.3213839530944824
Epoch: 23, Steps: 3 | Train Loss: 0.363 Vali Loss: 0.417 Vali Acc: 0.950 Test Loss: 0.417 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 24 cost time: 0.46450257301330566
Epoch: 24, Steps: 3 | Train Loss: 0.351 Vali Loss: 0.405 Vali Acc: 0.950 Test Loss: 0.405 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 25 cost time: 0.3374786376953125
Epoch: 25, Steps: 3 | Train Loss: 0.301 Vali Loss: 0.386 Vali Acc: 0.950 Test Loss: 0.386 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 26 cost time: 0.36834120750427246
Epoch: 26, Steps: 3 | Train Loss: 0.282 Vali Loss: 0.378 Vali Acc: 0.950 Test Loss: 0.378 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 27 cost time: 0.3435206413269043
Epoch: 27, Steps: 3 | Train Loss: 0.267 Vali Loss: 0.364 Vali Acc: 0.925 Test Loss: 0.364 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.37061285972595215
Epoch: 28, Steps: 3 | Train Loss: 0.254 Vali Loss: 0.352 Vali Acc: 0.925 Test Loss: 0.352 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.33114075660705566
Epoch: 29, Steps: 3 | Train Loss: 0.261 Vali Loss: 0.347 Vali Acc: 0.925 Test Loss: 0.347 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.4227471351623535
Epoch: 30, Steps: 3 | Train Loss: 0.211 Vali Loss: 0.326 Vali Acc: 0.925 Test Loss: 0.326 Test Acc: 0.925
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.3623802661895752
Epoch: 31, Steps: 3 | Train Loss: 0.228 Vali Loss: 0.319 Vali Acc: 0.950 Test Loss: 0.319 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 32 cost time: 0.36242079734802246
Epoch: 32, Steps: 3 | Train Loss: 0.215 Vali Loss: 0.311 Vali Acc: 0.950 Test Loss: 0.311 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 33 cost time: 0.3533031940460205
Epoch: 33, Steps: 3 | Train Loss: 0.199 Vali Loss: 0.301 Vali Acc: 0.950 Test Loss: 0.301 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 34 cost time: 0.42463183403015137
Epoch: 34, Steps: 3 | Train Loss: 0.182 Vali Loss: 0.300 Vali Acc: 0.950 Test Loss: 0.300 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 35 cost time: 0.3452110290527344
Epoch: 35, Steps: 3 | Train Loss: 0.191 Vali Loss: 0.288 Vali Acc: 0.950 Test Loss: 0.288 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 36 cost time: 0.40255212783813477
Epoch: 36, Steps: 3 | Train Loss: 0.179 Vali Loss: 0.276 Vali Acc: 0.950 Test Loss: 0.276 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 37 cost time: 0.3803980350494385
Epoch: 37, Steps: 3 | Train Loss: 0.167 Vali Loss: 0.276 Vali Acc: 0.950 Test Loss: 0.276 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 38 cost time: 0.3900785446166992
Epoch: 38, Steps: 3 | Train Loss: 0.180 Vali Loss: 0.266 Vali Acc: 0.950 Test Loss: 0.266 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 39 cost time: 0.3634018898010254
Epoch: 39, Steps: 3 | Train Loss: 0.165 Vali Loss: 0.256 Vali Acc: 0.950 Test Loss: 0.256 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949997).  Saving model ...
Epoch: 40 cost time: 0.35994744300842285
Epoch: 40, Steps: 3 | Train Loss: 0.154 Vali Loss: 0.248 Vali Acc: 0.975 Test Loss: 0.248 Test Acc: 0.975
Validation loss decreased (-0.949997 --> -0.974998).  Saving model ...
Epoch: 41 cost time: 0.36632847785949707
Epoch: 41, Steps: 3 | Train Loss: 0.161 Vali Loss: 0.248 Vali Acc: 0.975 Test Loss: 0.248 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.3699150085449219
Epoch: 42, Steps: 3 | Train Loss: 0.133 Vali Loss: 0.239 Vali Acc: 0.975 Test Loss: 0.239 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 43 cost time: 0.34592270851135254
Epoch: 43, Steps: 3 | Train Loss: 0.130 Vali Loss: 0.237 Vali Acc: 0.975 Test Loss: 0.237 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 44 cost time: 0.354295015335083
Epoch: 44, Steps: 3 | Train Loss: 0.135 Vali Loss: 0.236 Vali Acc: 0.975 Test Loss: 0.236 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 45 cost time: 0.4767022132873535
Epoch: 45, Steps: 3 | Train Loss: 0.119 Vali Loss: 0.240 Vali Acc: 0.975 Test Loss: 0.240 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.37985682487487793
Epoch: 46, Steps: 3 | Train Loss: 0.106 Vali Loss: 0.228 Vali Acc: 0.975 Test Loss: 0.228 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 47 cost time: 0.4250047206878662
Epoch: 47, Steps: 3 | Train Loss: 0.130 Vali Loss: 0.231 Vali Acc: 0.975 Test Loss: 0.231 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.4349942207336426
Epoch: 48, Steps: 3 | Train Loss: 0.112 Vali Loss: 0.224 Vali Acc: 0.975 Test Loss: 0.224 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 49 cost time: 0.3669719696044922
Epoch: 49, Steps: 3 | Train Loss: 0.099 Vali Loss: 0.220 Vali Acc: 0.975 Test Loss: 0.220 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 50 cost time: 0.4198155403137207
Epoch: 50, Steps: 3 | Train Loss: 0.119 Vali Loss: 0.218 Vali Acc: 0.975 Test Loss: 0.218 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps25_str13_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 76420
model size : 0.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.5306870937347412
Epoch: 1, Steps: 3 | Train Loss: 1.483 Vali Loss: 1.413 Vali Acc: 0.400 Test Loss: 1.413 Test Acc: 0.400
Validation loss decreased (inf --> -0.399986).  Saving model ...
Epoch: 2 cost time: 0.3779010772705078
Epoch: 2, Steps: 3 | Train Loss: 1.317 Vali Loss: 1.348 Vali Acc: 0.500 Test Loss: 1.348 Test Acc: 0.500
Validation loss decreased (-0.399986 --> -0.499987).  Saving model ...
Epoch: 3 cost time: 0.32889699935913086
Epoch: 3, Steps: 3 | Train Loss: 1.186 Vali Loss: 1.254 Vali Acc: 0.625 Test Loss: 1.254 Test Acc: 0.625
Validation loss decreased (-0.499987 --> -0.624987).  Saving model ...
Epoch: 4 cost time: 0.3089463710784912
Epoch: 4, Steps: 3 | Train Loss: 1.069 Vali Loss: 1.139 Vali Acc: 0.675 Test Loss: 1.139 Test Acc: 0.675
Validation loss decreased (-0.624987 --> -0.674989).  Saving model ...
Epoch: 5 cost time: 0.35896754264831543
Epoch: 5, Steps: 3 | Train Loss: 0.986 Vali Loss: 1.022 Vali Acc: 0.725 Test Loss: 1.022 Test Acc: 0.725
Validation loss decreased (-0.674989 --> -0.724990).  Saving model ...
Epoch: 6 cost time: 0.345167875289917
Epoch: 6, Steps: 3 | Train Loss: 0.852 Vali Loss: 0.906 Vali Acc: 0.750 Test Loss: 0.906 Test Acc: 0.750
Validation loss decreased (-0.724990 --> -0.749991).  Saving model ...
Epoch: 7 cost time: 0.3353269100189209
Epoch: 7, Steps: 3 | Train Loss: 0.759 Vali Loss: 0.802 Vali Acc: 0.800 Test Loss: 0.802 Test Acc: 0.800
Validation loss decreased (-0.749991 --> -0.799992).  Saving model ...
Epoch: 8 cost time: 0.3204171657562256
Epoch: 8, Steps: 3 | Train Loss: 0.639 Vali Loss: 0.709 Vali Acc: 0.825 Test Loss: 0.709 Test Acc: 0.825
Validation loss decreased (-0.799992 --> -0.824993).  Saving model ...
Epoch: 9 cost time: 0.3607769012451172
Epoch: 9, Steps: 3 | Train Loss: 0.563 Vali Loss: 0.625 Vali Acc: 0.875 Test Loss: 0.625 Test Acc: 0.875
Validation loss decreased (-0.824993 --> -0.874994).  Saving model ...
Epoch: 10 cost time: 0.34314870834350586
Epoch: 10, Steps: 3 | Train Loss: 0.481 Vali Loss: 0.547 Vali Acc: 0.900 Test Loss: 0.547 Test Acc: 0.900
Validation loss decreased (-0.874994 --> -0.899995).  Saving model ...
Epoch: 11 cost time: 0.32363462448120117
Epoch: 11, Steps: 3 | Train Loss: 0.385 Vali Loss: 0.486 Vali Acc: 0.925 Test Loss: 0.486 Test Acc: 0.925
Validation loss decreased (-0.899995 --> -0.924995).  Saving model ...
Epoch: 12 cost time: 0.34157514572143555
Epoch: 12, Steps: 3 | Train Loss: 0.331 Vali Loss: 0.435 Vali Acc: 0.925 Test Loss: 0.435 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924996).  Saving model ...
Epoch: 13 cost time: 0.3164787292480469
Epoch: 13, Steps: 3 | Train Loss: 0.306 Vali Loss: 0.401 Vali Acc: 0.925 Test Loss: 0.401 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 14 cost time: 0.39372730255126953
Epoch: 14, Steps: 3 | Train Loss: 0.244 Vali Loss: 0.369 Vali Acc: 0.925 Test Loss: 0.369 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924996).  Saving model ...
Epoch: 15 cost time: 0.3295729160308838
Epoch: 15, Steps: 3 | Train Loss: 0.224 Vali Loss: 0.353 Vali Acc: 0.900 Test Loss: 0.353 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.3820807933807373
Epoch: 16, Steps: 3 | Train Loss: 0.205 Vali Loss: 0.330 Vali Acc: 0.900 Test Loss: 0.330 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.3255600929260254
Epoch: 17, Steps: 3 | Train Loss: 0.192 Vali Loss: 0.309 Vali Acc: 0.925 Test Loss: 0.309 Test Acc: 0.925
Validation loss decreased (-0.924996 --> -0.924997).  Saving model ...
Epoch: 18 cost time: 0.33142733573913574
Epoch: 18, Steps: 3 | Train Loss: 0.173 Vali Loss: 0.294 Vali Acc: 0.975 Test Loss: 0.294 Test Acc: 0.975
Validation loss decreased (-0.924997 --> -0.974997).  Saving model ...
Epoch: 19 cost time: 0.3274836540222168
Epoch: 19, Steps: 3 | Train Loss: 0.145 Vali Loss: 0.286 Vali Acc: 0.950 Test Loss: 0.286 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.40418052673339844
Epoch: 20, Steps: 3 | Train Loss: 0.133 Vali Loss: 0.275 Vali Acc: 0.950 Test Loss: 0.275 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.33273887634277344
Epoch: 21, Steps: 3 | Train Loss: 0.117 Vali Loss: 0.272 Vali Acc: 0.950 Test Loss: 0.272 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.42317843437194824
Epoch: 22, Steps: 3 | Train Loss: 0.125 Vali Loss: 0.274 Vali Acc: 0.950 Test Loss: 0.274 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.42798423767089844
Epoch: 23, Steps: 3 | Train Loss: 0.101 Vali Loss: 0.273 Vali Acc: 0.950 Test Loss: 0.273 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.3243241310119629
Epoch: 24, Steps: 3 | Train Loss: 0.091 Vali Loss: 0.261 Vali Acc: 0.950 Test Loss: 0.261 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.3403959274291992
Epoch: 25, Steps: 3 | Train Loss: 0.097 Vali Loss: 0.259 Vali Acc: 0.950 Test Loss: 0.259 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.32223010063171387
Epoch: 26, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.256 Vali Acc: 0.950 Test Loss: 0.256 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.37500929832458496
Epoch: 27, Steps: 3 | Train Loss: 0.076 Vali Loss: 0.254 Vali Acc: 0.950 Test Loss: 0.254 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.34400057792663574
Epoch: 28, Steps: 3 | Train Loss: 0.069 Vali Loss: 0.250 Vali Acc: 0.950 Test Loss: 0.250 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps3_str2_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 58244
model size : 0.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.5133936405181885
Epoch: 1, Steps: 3 | Train Loss: 1.344 Vali Loss: 1.305 Vali Acc: 0.650 Test Loss: 1.305 Test Acc: 0.650
Validation loss decreased (inf --> -0.649987).  Saving model ...
Epoch: 2 cost time: 0.357344388961792
Epoch: 2, Steps: 3 | Train Loss: 1.214 Vali Loss: 1.259 Vali Acc: 0.725 Test Loss: 1.259 Test Acc: 0.725
Validation loss decreased (-0.649987 --> -0.724987).  Saving model ...
Epoch: 3 cost time: 0.4674201011657715
Epoch: 3, Steps: 3 | Train Loss: 1.168 Vali Loss: 1.195 Vali Acc: 0.750 Test Loss: 1.195 Test Acc: 0.750
Validation loss decreased (-0.724987 --> -0.749988).  Saving model ...
Epoch: 4 cost time: 0.4141252040863037
Epoch: 4, Steps: 3 | Train Loss: 1.059 Vali Loss: 1.115 Vali Acc: 0.775 Test Loss: 1.115 Test Acc: 0.775
Validation loss decreased (-0.749988 --> -0.774989).  Saving model ...
Epoch: 5 cost time: 0.35344505310058594
Epoch: 5, Steps: 3 | Train Loss: 0.990 Vali Loss: 1.022 Vali Acc: 0.850 Test Loss: 1.022 Test Acc: 0.850
Validation loss decreased (-0.774989 --> -0.849990).  Saving model ...
Epoch: 6 cost time: 0.3693835735321045
Epoch: 6, Steps: 3 | Train Loss: 0.870 Vali Loss: 0.929 Vali Acc: 0.850 Test Loss: 0.929 Test Acc: 0.850
Validation loss decreased (-0.849990 --> -0.849991).  Saving model ...
Epoch: 7 cost time: 0.4426698684692383
Epoch: 7, Steps: 3 | Train Loss: 0.770 Vali Loss: 0.847 Vali Acc: 0.875 Test Loss: 0.847 Test Acc: 0.875
Validation loss decreased (-0.849991 --> -0.874992).  Saving model ...
Epoch: 8 cost time: 0.423459529876709
Epoch: 8, Steps: 3 | Train Loss: 0.686 Vali Loss: 0.773 Vali Acc: 0.875 Test Loss: 0.773 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874992).  Saving model ...
Epoch: 9 cost time: 0.42828869819641113
Epoch: 9, Steps: 3 | Train Loss: 0.629 Vali Loss: 0.694 Vali Acc: 0.925 Test Loss: 0.694 Test Acc: 0.925
Validation loss decreased (-0.874992 --> -0.924993).  Saving model ...
Epoch: 10 cost time: 0.3725407123565674
Epoch: 10, Steps: 3 | Train Loss: 0.552 Vali Loss: 0.616 Vali Acc: 0.950 Test Loss: 0.616 Test Acc: 0.950
Validation loss decreased (-0.924993 --> -0.949994).  Saving model ...
Epoch: 11 cost time: 0.369037389755249
Epoch: 11, Steps: 3 | Train Loss: 0.487 Vali Loss: 0.557 Vali Acc: 0.950 Test Loss: 0.557 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949994).  Saving model ...
Epoch: 12 cost time: 0.3571794033050537
Epoch: 12, Steps: 3 | Train Loss: 0.400 Vali Loss: 0.498 Vali Acc: 0.950 Test Loss: 0.498 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 13 cost time: 0.4021627902984619
Epoch: 13, Steps: 3 | Train Loss: 0.383 Vali Loss: 0.452 Vali Acc: 0.950 Test Loss: 0.452 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 14 cost time: 0.418410062789917
Epoch: 14, Steps: 3 | Train Loss: 0.330 Vali Loss: 0.412 Vali Acc: 0.950 Test Loss: 0.412 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949996).  Saving model ...
Epoch: 15 cost time: 0.41770505905151367
Epoch: 15, Steps: 3 | Train Loss: 0.285 Vali Loss: 0.379 Vali Acc: 0.950 Test Loss: 0.379 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949996).  Saving model ...
Epoch: 16 cost time: 0.3789355754852295
Epoch: 16, Steps: 3 | Train Loss: 0.259 Vali Loss: 0.350 Vali Acc: 0.950 Test Loss: 0.350 Test Acc: 0.950
Validation loss decreased (-0.949996 --> -0.949997).  Saving model ...
Epoch: 17 cost time: 0.3926551342010498
Epoch: 17, Steps: 3 | Train Loss: 0.231 Vali Loss: 0.324 Vali Acc: 0.975 Test Loss: 0.324 Test Acc: 0.975
Validation loss decreased (-0.949997 --> -0.974997).  Saving model ...
Epoch: 18 cost time: 0.35848498344421387
Epoch: 18, Steps: 3 | Train Loss: 0.244 Vali Loss: 0.310 Vali Acc: 0.975 Test Loss: 0.310 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 19 cost time: 0.3617379665374756
Epoch: 19, Steps: 3 | Train Loss: 0.182 Vali Loss: 0.298 Vali Acc: 0.975 Test Loss: 0.298 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 20 cost time: 0.3434450626373291
Epoch: 20, Steps: 3 | Train Loss: 0.190 Vali Loss: 0.289 Vali Acc: 0.975 Test Loss: 0.289 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 21 cost time: 0.4171581268310547
Epoch: 21, Steps: 3 | Train Loss: 0.174 Vali Loss: 0.275 Vali Acc: 0.975 Test Loss: 0.275 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 22 cost time: 0.3532423973083496
Epoch: 22, Steps: 3 | Train Loss: 0.163 Vali Loss: 0.268 Vali Acc: 0.975 Test Loss: 0.268 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 23 cost time: 0.38214921951293945
Epoch: 23, Steps: 3 | Train Loss: 0.145 Vali Loss: 0.256 Vali Acc: 0.975 Test Loss: 0.256 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 24 cost time: 0.35921311378479004
Epoch: 24, Steps: 3 | Train Loss: 0.147 Vali Loss: 0.243 Vali Acc: 0.975 Test Loss: 0.243 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 25 cost time: 0.3324134349822998
Epoch: 25, Steps: 3 | Train Loss: 0.130 Vali Loss: 0.234 Vali Acc: 0.975 Test Loss: 0.234 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 26 cost time: 0.34673094749450684
Epoch: 26, Steps: 3 | Train Loss: 0.109 Vali Loss: 0.233 Vali Acc: 0.975 Test Loss: 0.233 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 27 cost time: 0.359710693359375
Epoch: 27, Steps: 3 | Train Loss: 0.103 Vali Loss: 0.230 Vali Acc: 0.950 Test Loss: 0.230 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.3914659023284912
Epoch: 28, Steps: 3 | Train Loss: 0.104 Vali Loss: 0.224 Vali Acc: 0.950 Test Loss: 0.224 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.36169958114624023
Epoch: 29, Steps: 3 | Train Loss: 0.091 Vali Loss: 0.223 Vali Acc: 0.950 Test Loss: 0.223 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.4387505054473877
Epoch: 30, Steps: 3 | Train Loss: 0.092 Vali Loss: 0.227 Vali Acc: 0.950 Test Loss: 0.227 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.40824151039123535
Epoch: 31, Steps: 3 | Train Loss: 0.082 Vali Loss: 0.229 Vali Acc: 0.950 Test Loss: 0.229 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.3746178150177002
Epoch: 32, Steps: 3 | Train Loss: 0.077 Vali Loss: 0.222 Vali Acc: 0.950 Test Loss: 0.222 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.3516268730163574
Epoch: 33, Steps: 3 | Train Loss: 0.080 Vali Loss: 0.226 Vali Acc: 0.950 Test Loss: 0.226 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.49463748931884766
Epoch: 34, Steps: 3 | Train Loss: 0.076 Vali Loss: 0.222 Vali Acc: 0.950 Test Loss: 0.222 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.36453938484191895
Epoch: 35, Steps: 3 | Train Loss: 0.072 Vali Loss: 0.222 Vali Acc: 0.950 Test Loss: 0.222 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.37015366554260254
Epoch: 36, Steps: 3 | Train Loss: 0.060 Vali Loss: 0.217 Vali Acc: 0.950 Test Loss: 0.217 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 45252
model size : 0.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.5410957336425781
Epoch: 1, Steps: 3 | Train Loss: 1.477 Vali Loss: 1.368 Vali Acc: 0.250 Test Loss: 1.368 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 0.36467719078063965
Epoch: 2, Steps: 3 | Train Loss: 1.406 Vali Loss: 1.321 Vali Acc: 0.250 Test Loss: 1.321 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249987).  Saving model ...
Epoch: 3 cost time: 0.3732147216796875
Epoch: 3, Steps: 3 | Train Loss: 1.338 Vali Loss: 1.262 Vali Acc: 0.275 Test Loss: 1.262 Test Acc: 0.275
Validation loss decreased (-0.249987 --> -0.274987).  Saving model ...
Epoch: 4 cost time: 0.36794567108154297
Epoch: 4, Steps: 3 | Train Loss: 1.219 Vali Loss: 1.188 Vali Acc: 0.300 Test Loss: 1.188 Test Acc: 0.300
Validation loss decreased (-0.274987 --> -0.299988).  Saving model ...
Epoch: 5 cost time: 0.3683793544769287
Epoch: 5, Steps: 3 | Train Loss: 1.187 Vali Loss: 1.105 Vali Acc: 0.525 Test Loss: 1.105 Test Acc: 0.525
Validation loss decreased (-0.299988 --> -0.524989).  Saving model ...
Epoch: 6 cost time: 0.3892679214477539
Epoch: 6, Steps: 3 | Train Loss: 1.038 Vali Loss: 1.023 Vali Acc: 0.700 Test Loss: 1.023 Test Acc: 0.700
Validation loss decreased (-0.524989 --> -0.699990).  Saving model ...
Epoch: 7 cost time: 0.35379624366760254
Epoch: 7, Steps: 3 | Train Loss: 0.957 Vali Loss: 0.954 Vali Acc: 0.775 Test Loss: 0.954 Test Acc: 0.775
Validation loss decreased (-0.699990 --> -0.774990).  Saving model ...
Epoch: 8 cost time: 0.3848702907562256
Epoch: 8, Steps: 3 | Train Loss: 0.869 Vali Loss: 0.875 Vali Acc: 0.800 Test Loss: 0.875 Test Acc: 0.800
Validation loss decreased (-0.774990 --> -0.799991).  Saving model ...
Epoch: 9 cost time: 0.37409448623657227
Epoch: 9, Steps: 3 | Train Loss: 0.788 Vali Loss: 0.805 Vali Acc: 0.875 Test Loss: 0.805 Test Acc: 0.875
Validation loss decreased (-0.799991 --> -0.874992).  Saving model ...
Epoch: 10 cost time: 0.34272050857543945
Epoch: 10, Steps: 3 | Train Loss: 0.716 Vali Loss: 0.736 Vali Acc: 0.875 Test Loss: 0.736 Test Acc: 0.875
Validation loss decreased (-0.874992 --> -0.874993).  Saving model ...
Epoch: 11 cost time: 0.343425989151001
Epoch: 11, Steps: 3 | Train Loss: 0.624 Vali Loss: 0.673 Vali Acc: 0.950 Test Loss: 0.673 Test Acc: 0.950
Validation loss decreased (-0.874993 --> -0.949993).  Saving model ...
Epoch: 12 cost time: 0.3603811264038086
Epoch: 12, Steps: 3 | Train Loss: 0.591 Vali Loss: 0.610 Vali Acc: 0.975 Test Loss: 0.610 Test Acc: 0.975
Validation loss decreased (-0.949993 --> -0.974994).  Saving model ...
Epoch: 13 cost time: 0.3751709461212158
Epoch: 13, Steps: 3 | Train Loss: 0.523 Vali Loss: 0.554 Vali Acc: 0.975 Test Loss: 0.554 Test Acc: 0.975
Validation loss decreased (-0.974994 --> -0.974994).  Saving model ...
Epoch: 14 cost time: 0.3549773693084717
Epoch: 14, Steps: 3 | Train Loss: 0.476 Vali Loss: 0.501 Vali Acc: 0.975 Test Loss: 0.501 Test Acc: 0.975
Validation loss decreased (-0.974994 --> -0.974995).  Saving model ...
Epoch: 15 cost time: 0.3833630084991455
Epoch: 15, Steps: 3 | Train Loss: 0.416 Vali Loss: 0.468 Vali Acc: 0.975 Test Loss: 0.468 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 16 cost time: 0.3531334400177002
Epoch: 16, Steps: 3 | Train Loss: 0.351 Vali Loss: 0.425 Vali Acc: 0.975 Test Loss: 0.425 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 17 cost time: 0.4209280014038086
Epoch: 17, Steps: 3 | Train Loss: 0.323 Vali Loss: 0.394 Vali Acc: 0.975 Test Loss: 0.394 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 18 cost time: 0.3510444164276123
Epoch: 18, Steps: 3 | Train Loss: 0.304 Vali Loss: 0.373 Vali Acc: 0.975 Test Loss: 0.373 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 19 cost time: 0.3464329242706299
Epoch: 19, Steps: 3 | Train Loss: 0.305 Vali Loss: 0.349 Vali Acc: 0.975 Test Loss: 0.349 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 20 cost time: 0.3948197364807129
Epoch: 20, Steps: 3 | Train Loss: 0.240 Vali Loss: 0.323 Vali Acc: 0.975 Test Loss: 0.323 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 21 cost time: 0.3939528465270996
Epoch: 21, Steps: 3 | Train Loss: 0.235 Vali Loss: 0.298 Vali Acc: 0.975 Test Loss: 0.298 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 22 cost time: 0.33257269859313965
Epoch: 22, Steps: 3 | Train Loss: 0.217 Vali Loss: 0.288 Vali Acc: 0.975 Test Loss: 0.288 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 23 cost time: 0.32993221282958984
Epoch: 23, Steps: 3 | Train Loss: 0.214 Vali Loss: 0.283 Vali Acc: 0.975 Test Loss: 0.283 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 24 cost time: 0.31247806549072266
Epoch: 24, Steps: 3 | Train Loss: 0.185 Vali Loss: 0.264 Vali Acc: 0.975 Test Loss: 0.264 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 25 cost time: 0.38854122161865234
Epoch: 25, Steps: 3 | Train Loss: 0.170 Vali Loss: 0.255 Vali Acc: 0.975 Test Loss: 0.255 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 26 cost time: 0.3383312225341797
Epoch: 26, Steps: 3 | Train Loss: 0.161 Vali Loss: 0.246 Vali Acc: 0.975 Test Loss: 0.246 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974998).  Saving model ...
Epoch: 27 cost time: 0.46201229095458984
Epoch: 27, Steps: 3 | Train Loss: 0.155 Vali Loss: 0.234 Vali Acc: 0.975 Test Loss: 0.234 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 28 cost time: 0.35059666633605957
Epoch: 28, Steps: 3 | Train Loss: 0.166 Vali Loss: 0.225 Vali Acc: 0.975 Test Loss: 0.225 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 29 cost time: 0.3273646831512451
Epoch: 29, Steps: 3 | Train Loss: 0.157 Vali Loss: 0.223 Vali Acc: 0.975 Test Loss: 0.223 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 30 cost time: 0.38289380073547363
Epoch: 30, Steps: 3 | Train Loss: 0.136 Vali Loss: 0.219 Vali Acc: 0.975 Test Loss: 0.219 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 31 cost time: 0.3564753532409668
Epoch: 31, Steps: 3 | Train Loss: 0.131 Vali Loss: 0.215 Vali Acc: 0.975 Test Loss: 0.215 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 32 cost time: 0.3395559787750244
Epoch: 32, Steps: 3 | Train Loss: 0.130 Vali Loss: 0.214 Vali Acc: 0.975 Test Loss: 0.214 Test Acc: 0.975
Validation loss decreased (-0.974998 --> -0.974998).  Saving model ...
Epoch: 33 cost time: 0.38106489181518555
Epoch: 33, Steps: 3 | Train Loss: 0.118 Vali Loss: 0.207 Vali Acc: 0.950 Test Loss: 0.207 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.3419783115386963
Epoch: 34, Steps: 3 | Train Loss: 0.104 Vali Loss: 0.205 Vali Acc: 0.950 Test Loss: 0.205 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.33289384841918945
Epoch: 35, Steps: 3 | Train Loss: 0.100 Vali Loss: 0.204 Vali Acc: 0.950 Test Loss: 0.204 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.35370302200317383
Epoch: 36, Steps: 3 | Train Loss: 0.096 Vali Loss: 0.196 Vali Acc: 0.950 Test Loss: 0.196 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.3769543170928955
Epoch: 37, Steps: 3 | Train Loss: 0.101 Vali Loss: 0.194 Vali Acc: 0.950 Test Loss: 0.194 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.3314967155456543
Epoch: 38, Steps: 3 | Train Loss: 0.094 Vali Loss: 0.192 Vali Acc: 0.950 Test Loss: 0.192 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.3427560329437256
Epoch: 39, Steps: 3 | Train Loss: 0.084 Vali Loss: 0.187 Vali Acc: 0.950 Test Loss: 0.187 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.3544285297393799
Epoch: 40, Steps: 3 | Train Loss: 0.088 Vali Loss: 0.188 Vali Acc: 0.950 Test Loss: 0.188 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.36099910736083984
Epoch: 41, Steps: 3 | Train Loss: 0.065 Vali Loss: 0.178 Vali Acc: 0.950 Test Loss: 0.178 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.3619425296783447
Epoch: 42, Steps: 3 | Train Loss: 0.075 Vali Loss: 0.180 Vali Acc: 0.950 Test Loss: 0.180 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps8_str4_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 39204
model size : 0.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.2881653308868408
Epoch: 1, Steps: 3 | Train Loss: 1.461 Vali Loss: 1.493 Vali Acc: 0.275 Test Loss: 1.493 Test Acc: 0.275
Validation loss decreased (inf --> -0.274985).  Saving model ...
Epoch: 2 cost time: 0.37592148780822754
Epoch: 2, Steps: 3 | Train Loss: 1.385 Vali Loss: 1.459 Vali Acc: 0.300 Test Loss: 1.459 Test Acc: 0.300
Validation loss decreased (-0.274985 --> -0.299985).  Saving model ...
Epoch: 3 cost time: 0.32113170623779297
Epoch: 3, Steps: 3 | Train Loss: 1.333 Vali Loss: 1.416 Vali Acc: 0.425 Test Loss: 1.416 Test Acc: 0.425
Validation loss decreased (-0.299985 --> -0.424986).  Saving model ...
Epoch: 4 cost time: 0.35080862045288086
Epoch: 4, Steps: 3 | Train Loss: 1.294 Vali Loss: 1.353 Vali Acc: 0.400 Test Loss: 1.353 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.3929777145385742
Epoch: 5, Steps: 3 | Train Loss: 1.190 Vali Loss: 1.278 Vali Acc: 0.450 Test Loss: 1.278 Test Acc: 0.450
Validation loss decreased (-0.424986 --> -0.449987).  Saving model ...
Epoch: 6 cost time: 0.3135364055633545
Epoch: 6, Steps: 3 | Train Loss: 1.092 Vali Loss: 1.198 Vali Acc: 0.500 Test Loss: 1.198 Test Acc: 0.500
Validation loss decreased (-0.449987 --> -0.499988).  Saving model ...
Epoch: 7 cost time: 0.27692365646362305
Epoch: 7, Steps: 3 | Train Loss: 1.000 Vali Loss: 1.115 Vali Acc: 0.600 Test Loss: 1.115 Test Acc: 0.600
Validation loss decreased (-0.499988 --> -0.599989).  Saving model ...
Epoch: 8 cost time: 0.2686762809753418
Epoch: 8, Steps: 3 | Train Loss: 0.926 Vali Loss: 1.039 Vali Acc: 0.625 Test Loss: 1.039 Test Acc: 0.625
Validation loss decreased (-0.599989 --> -0.624990).  Saving model ...
Epoch: 9 cost time: 0.30232739448547363
Epoch: 9, Steps: 3 | Train Loss: 0.841 Vali Loss: 0.964 Vali Acc: 0.700 Test Loss: 0.964 Test Acc: 0.700
Validation loss decreased (-0.624990 --> -0.699990).  Saving model ...
Epoch: 10 cost time: 0.2795143127441406
Epoch: 10, Steps: 3 | Train Loss: 0.762 Vali Loss: 0.896 Vali Acc: 0.725 Test Loss: 0.896 Test Acc: 0.725
Validation loss decreased (-0.699990 --> -0.724991).  Saving model ...
Epoch: 11 cost time: 0.3326883316040039
Epoch: 11, Steps: 3 | Train Loss: 0.721 Vali Loss: 0.827 Vali Acc: 0.800 Test Loss: 0.827 Test Acc: 0.800
Validation loss decreased (-0.724991 --> -0.799992).  Saving model ...
Epoch: 12 cost time: 0.3374760150909424
Epoch: 12, Steps: 3 | Train Loss: 0.645 Vali Loss: 0.769 Vali Acc: 0.825 Test Loss: 0.769 Test Acc: 0.825
Validation loss decreased (-0.799992 --> -0.824992).  Saving model ...
Epoch: 13 cost time: 0.3581686019897461
Epoch: 13, Steps: 3 | Train Loss: 0.591 Vali Loss: 0.711 Vali Acc: 0.850 Test Loss: 0.711 Test Acc: 0.850
Validation loss decreased (-0.824992 --> -0.849993).  Saving model ...
Epoch: 14 cost time: 0.3361396789550781
Epoch: 14, Steps: 3 | Train Loss: 0.523 Vali Loss: 0.661 Vali Acc: 0.875 Test Loss: 0.661 Test Acc: 0.875
Validation loss decreased (-0.849993 --> -0.874993).  Saving model ...
Epoch: 15 cost time: 0.3910667896270752
Epoch: 15, Steps: 3 | Train Loss: 0.500 Vali Loss: 0.613 Vali Acc: 0.900 Test Loss: 0.613 Test Acc: 0.900
Validation loss decreased (-0.874993 --> -0.899994).  Saving model ...
Epoch: 16 cost time: 0.3305230140686035
Epoch: 16, Steps: 3 | Train Loss: 0.440 Vali Loss: 0.568 Vali Acc: 0.950 Test Loss: 0.568 Test Acc: 0.950
Validation loss decreased (-0.899994 --> -0.949994).  Saving model ...
Epoch: 17 cost time: 0.30486321449279785
Epoch: 17, Steps: 3 | Train Loss: 0.410 Vali Loss: 0.536 Vali Acc: 0.975 Test Loss: 0.536 Test Acc: 0.975
Validation loss decreased (-0.949994 --> -0.974995).  Saving model ...
Epoch: 18 cost time: 0.359128475189209
Epoch: 18, Steps: 3 | Train Loss: 0.354 Vali Loss: 0.513 Vali Acc: 0.975 Test Loss: 0.513 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 19 cost time: 0.2957637310028076
Epoch: 19, Steps: 3 | Train Loss: 0.357 Vali Loss: 0.479 Vali Acc: 0.975 Test Loss: 0.479 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 20 cost time: 0.3635718822479248
Epoch: 20, Steps: 3 | Train Loss: 0.335 Vali Loss: 0.454 Vali Acc: 0.975 Test Loss: 0.454 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 21 cost time: 0.37081384658813477
Epoch: 21, Steps: 3 | Train Loss: 0.291 Vali Loss: 0.428 Vali Acc: 0.975 Test Loss: 0.428 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 22 cost time: 0.3473658561706543
Epoch: 22, Steps: 3 | Train Loss: 0.268 Vali Loss: 0.415 Vali Acc: 0.975 Test Loss: 0.415 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 23 cost time: 0.3881227970123291
Epoch: 23, Steps: 3 | Train Loss: 0.273 Vali Loss: 0.397 Vali Acc: 0.975 Test Loss: 0.397 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 24 cost time: 0.34124159812927246
Epoch: 24, Steps: 3 | Train Loss: 0.248 Vali Loss: 0.383 Vali Acc: 0.975 Test Loss: 0.383 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 25 cost time: 0.3374156951904297
Epoch: 25, Steps: 3 | Train Loss: 0.248 Vali Loss: 0.372 Vali Acc: 0.950 Test Loss: 0.372 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.32936620712280273
Epoch: 26, Steps: 3 | Train Loss: 0.210 Vali Loss: 0.362 Vali Acc: 0.950 Test Loss: 0.362 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.30017590522766113
Epoch: 27, Steps: 3 | Train Loss: 0.168 Vali Loss: 0.347 Vali Acc: 0.950 Test Loss: 0.347 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.34741902351379395
Epoch: 28, Steps: 3 | Train Loss: 0.208 Vali Loss: 0.340 Vali Acc: 0.950 Test Loss: 0.340 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.417233943939209
Epoch: 29, Steps: 3 | Train Loss: 0.200 Vali Loss: 0.335 Vali Acc: 0.950 Test Loss: 0.335 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.31817007064819336
Epoch: 30, Steps: 3 | Train Loss: 0.168 Vali Loss: 0.328 Vali Acc: 0.950 Test Loss: 0.328 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.3686847686767578
Epoch: 31, Steps: 3 | Train Loss: 0.184 Vali Loss: 0.322 Vali Acc: 0.950 Test Loss: 0.322 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.36933207511901855
Epoch: 32, Steps: 3 | Train Loss: 0.163 Vali Loss: 0.323 Vali Acc: 0.950 Test Loss: 0.323 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.38138341903686523
Epoch: 33, Steps: 3 | Train Loss: 0.147 Vali Loss: 0.317 Vali Acc: 0.950 Test Loss: 0.317 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.32512593269348145
Epoch: 34, Steps: 3 | Train Loss: 0.142 Vali Loss: 0.308 Vali Acc: 0.950 Test Loss: 0.308 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 35428
model size : 0.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps15_str8_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.389033555984497
Epoch: 1, Steps: 3 | Train Loss: 1.442 Vali Loss: 1.375 Vali Acc: 0.225 Test Loss: 1.375 Test Acc: 0.225
Validation loss decreased (inf --> -0.224986).  Saving model ...
Epoch: 2 cost time: 0.34777188301086426
Epoch: 2, Steps: 3 | Train Loss: 1.374 Vali Loss: 1.354 Vali Acc: 0.250 Test Loss: 1.354 Test Acc: 0.250
Validation loss decreased (-0.224986 --> -0.249986).  Saving model ...
Epoch: 3 cost time: 0.3543412685394287
Epoch: 3, Steps: 3 | Train Loss: 1.332 Vali Loss: 1.331 Vali Acc: 0.250 Test Loss: 1.331 Test Acc: 0.250
Validation loss decreased (-0.249986 --> -0.249987).  Saving model ...
Epoch: 4 cost time: 0.36241602897644043
Epoch: 4, Steps: 3 | Train Loss: 1.266 Vali Loss: 1.297 Vali Acc: 0.250 Test Loss: 1.297 Test Acc: 0.250
Validation loss decreased (-0.249987 --> -0.249987).  Saving model ...
Epoch: 5 cost time: 0.3806183338165283
Epoch: 5, Steps: 3 | Train Loss: 1.238 Vali Loss: 1.255 Vali Acc: 0.250 Test Loss: 1.255 Test Acc: 0.250
Validation loss decreased (-0.249987 --> -0.249987).  Saving model ...
Epoch: 6 cost time: 0.34014344215393066
Epoch: 6, Steps: 3 | Train Loss: 1.156 Vali Loss: 1.208 Vali Acc: 0.350 Test Loss: 1.208 Test Acc: 0.350
Validation loss decreased (-0.249987 --> -0.349988).  Saving model ...
Epoch: 7 cost time: 0.3723011016845703
Epoch: 7, Steps: 3 | Train Loss: 1.128 Vali Loss: 1.156 Vali Acc: 0.450 Test Loss: 1.156 Test Acc: 0.450
Validation loss decreased (-0.349988 --> -0.449988).  Saving model ...
Epoch: 8 cost time: 0.357083797454834
Epoch: 8, Steps: 3 | Train Loss: 1.053 Vali Loss: 1.109 Vali Acc: 0.500 Test Loss: 1.109 Test Acc: 0.500
Validation loss decreased (-0.449988 --> -0.499989).  Saving model ...
Epoch: 9 cost time: 0.4092228412628174
Epoch: 9, Steps: 3 | Train Loss: 1.028 Vali Loss: 1.055 Vali Acc: 0.550 Test Loss: 1.055 Test Acc: 0.550
Validation loss decreased (-0.499989 --> -0.549989).  Saving model ...
Epoch: 10 cost time: 0.3970654010772705
Epoch: 10, Steps: 3 | Train Loss: 0.976 Vali Loss: 1.004 Vali Acc: 0.600 Test Loss: 1.004 Test Acc: 0.600
Validation loss decreased (-0.549989 --> -0.599990).  Saving model ...
Epoch: 11 cost time: 0.38141870498657227
Epoch: 11, Steps: 3 | Train Loss: 0.895 Vali Loss: 0.959 Vali Acc: 0.725 Test Loss: 0.959 Test Acc: 0.725
Validation loss decreased (-0.599990 --> -0.724990).  Saving model ...
Epoch: 12 cost time: 0.4478938579559326
Epoch: 12, Steps: 3 | Train Loss: 0.863 Vali Loss: 0.909 Vali Acc: 0.800 Test Loss: 0.909 Test Acc: 0.800
Validation loss decreased (-0.724990 --> -0.799991).  Saving model ...
Epoch: 13 cost time: 0.36763668060302734
Epoch: 13, Steps: 3 | Train Loss: 0.821 Vali Loss: 0.866 Vali Acc: 0.825 Test Loss: 0.866 Test Acc: 0.825
Validation loss decreased (-0.799991 --> -0.824991).  Saving model ...
Epoch: 14 cost time: 0.3338789939880371
Epoch: 14, Steps: 3 | Train Loss: 0.763 Vali Loss: 0.826 Vali Acc: 0.850 Test Loss: 0.826 Test Acc: 0.850
Validation loss decreased (-0.824991 --> -0.849992).  Saving model ...
Epoch: 15 cost time: 0.39432358741760254
Epoch: 15, Steps: 3 | Train Loss: 0.702 Vali Loss: 0.788 Vali Acc: 0.875 Test Loss: 0.788 Test Acc: 0.875
Validation loss decreased (-0.849992 --> -0.874992).  Saving model ...
Epoch: 16 cost time: 0.3845052719116211
Epoch: 16, Steps: 3 | Train Loss: 0.666 Vali Loss: 0.752 Vali Acc: 0.900 Test Loss: 0.752 Test Acc: 0.900
Validation loss decreased (-0.874992 --> -0.899992).  Saving model ...
Epoch: 17 cost time: 0.3581230640411377
Epoch: 17, Steps: 3 | Train Loss: 0.650 Vali Loss: 0.717 Vali Acc: 0.900 Test Loss: 0.717 Test Acc: 0.900
Validation loss decreased (-0.899992 --> -0.899993).  Saving model ...
Epoch: 18 cost time: 0.37250566482543945
Epoch: 18, Steps: 3 | Train Loss: 0.595 Vali Loss: 0.683 Vali Acc: 0.950 Test Loss: 0.683 Test Acc: 0.950
Validation loss decreased (-0.899993 --> -0.949993).  Saving model ...
Epoch: 19 cost time: 0.37869787216186523
Epoch: 19, Steps: 3 | Train Loss: 0.547 Vali Loss: 0.656 Vali Acc: 0.950 Test Loss: 0.656 Test Acc: 0.950
Validation loss decreased (-0.949993 --> -0.949993).  Saving model ...
Epoch: 20 cost time: 0.38150501251220703
Epoch: 20, Steps: 3 | Train Loss: 0.510 Vali Loss: 0.630 Vali Acc: 0.950 Test Loss: 0.630 Test Acc: 0.950
Validation loss decreased (-0.949993 --> -0.949994).  Saving model ...
Epoch: 21 cost time: 0.40221095085144043
Epoch: 21, Steps: 3 | Train Loss: 0.496 Vali Loss: 0.596 Vali Acc: 0.950 Test Loss: 0.596 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949994).  Saving model ...
Epoch: 22 cost time: 0.3829665184020996
Epoch: 22, Steps: 3 | Train Loss: 0.460 Vali Loss: 0.566 Vali Acc: 0.950 Test Loss: 0.566 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949994).  Saving model ...
Epoch: 23 cost time: 0.3507564067840576
Epoch: 23, Steps: 3 | Train Loss: 0.436 Vali Loss: 0.538 Vali Acc: 0.950 Test Loss: 0.538 Test Acc: 0.950
Validation loss decreased (-0.949994 --> -0.949995).  Saving model ...
Epoch: 24 cost time: 0.3746359348297119
Epoch: 24, Steps: 3 | Train Loss: 0.400 Vali Loss: 0.518 Vali Acc: 0.950 Test Loss: 0.518 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 25 cost time: 0.429227352142334
Epoch: 25, Steps: 3 | Train Loss: 0.388 Vali Loss: 0.505 Vali Acc: 0.950 Test Loss: 0.505 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 26 cost time: 0.4131195545196533
Epoch: 26, Steps: 3 | Train Loss: 0.365 Vali Loss: 0.483 Vali Acc: 0.950 Test Loss: 0.483 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 27 cost time: 0.34241628646850586
Epoch: 27, Steps: 3 | Train Loss: 0.359 Vali Loss: 0.469 Vali Acc: 0.925 Test Loss: 0.469 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.37230634689331055
Epoch: 28, Steps: 3 | Train Loss: 0.318 Vali Loss: 0.441 Vali Acc: 0.975 Test Loss: 0.441 Test Acc: 0.975
Validation loss decreased (-0.949995 --> -0.974996).  Saving model ...
Epoch: 29 cost time: 0.40276551246643066
Epoch: 29, Steps: 3 | Train Loss: 0.312 Vali Loss: 0.426 Vali Acc: 0.950 Test Loss: 0.426 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.3285219669342041
Epoch: 30, Steps: 3 | Train Loss: 0.307 Vali Loss: 0.414 Vali Acc: 0.950 Test Loss: 0.414 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.3908669948577881
Epoch: 31, Steps: 3 | Train Loss: 0.273 Vali Loss: 0.398 Vali Acc: 0.950 Test Loss: 0.398 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.39842891693115234
Epoch: 32, Steps: 3 | Train Loss: 0.278 Vali Loss: 0.386 Vali Acc: 0.950 Test Loss: 0.386 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.3581211566925049
Epoch: 33, Steps: 3 | Train Loss: 0.259 Vali Loss: 0.372 Vali Acc: 0.950 Test Loss: 0.372 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.3511478900909424
Epoch: 34, Steps: 3 | Train Loss: 0.258 Vali Loss: 0.358 Vali Acc: 0.975 Test Loss: 0.358 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 35 cost time: 0.3963801860809326
Epoch: 35, Steps: 3 | Train Loss: 0.236 Vali Loss: 0.344 Vali Acc: 0.975 Test Loss: 0.344 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 36 cost time: 0.42388272285461426
Epoch: 36, Steps: 3 | Train Loss: 0.227 Vali Loss: 0.333 Vali Acc: 0.975 Test Loss: 0.333 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 37 cost time: 0.3472900390625
Epoch: 37, Steps: 3 | Train Loss: 0.207 Vali Loss: 0.326 Vali Acc: 0.975 Test Loss: 0.326 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 38 cost time: 0.4120957851409912
Epoch: 38, Steps: 3 | Train Loss: 0.228 Vali Loss: 0.324 Vali Acc: 0.975 Test Loss: 0.324 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 39 cost time: 0.33782458305358887
Epoch: 39, Steps: 3 | Train Loss: 0.199 Vali Loss: 0.317 Vali Acc: 0.975 Test Loss: 0.317 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 40 cost time: 0.34407854080200195
Epoch: 40, Steps: 3 | Train Loss: 0.183 Vali Loss: 0.311 Vali Acc: 0.975 Test Loss: 0.311 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 41 cost time: 0.33941221237182617
Epoch: 41, Steps: 3 | Train Loss: 0.175 Vali Loss: 0.311 Vali Acc: 0.975 Test Loss: 0.311 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.3289816379547119
Epoch: 42, Steps: 3 | Train Loss: 0.183 Vali Loss: 0.308 Vali Acc: 0.975 Test Loss: 0.308 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 43 cost time: 0.36383700370788574
Epoch: 43, Steps: 3 | Train Loss: 0.152 Vali Loss: 0.291 Vali Acc: 0.975 Test Loss: 0.291 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 44 cost time: 0.35335731506347656
Epoch: 44, Steps: 3 | Train Loss: 0.173 Vali Loss: 0.294 Vali Acc: 0.975 Test Loss: 0.294 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.3465125560760498
Epoch: 45, Steps: 3 | Train Loss: 0.156 Vali Loss: 0.283 Vali Acc: 0.975 Test Loss: 0.283 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 46 cost time: 0.33506202697753906
Epoch: 46, Steps: 3 | Train Loss: 0.186 Vali Loss: 0.281 Vali Acc: 0.975 Test Loss: 0.281 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 47 cost time: 0.33631062507629395
Epoch: 47, Steps: 3 | Train Loss: 0.148 Vali Loss: 0.276 Vali Acc: 0.975 Test Loss: 0.276 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 48 cost time: 0.3944244384765625
Epoch: 48, Steps: 3 | Train Loss: 0.149 Vali Loss: 0.267 Vali Acc: 0.975 Test Loss: 0.267 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 49 cost time: 0.40688657760620117
Epoch: 49, Steps: 3 | Train Loss: 0.134 Vali Loss: 0.264 Vali Acc: 0.975 Test Loss: 0.264 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 50 cost time: 0.32767319679260254
Epoch: 50, Steps: 3 | Train Loss: 0.136 Vali Loss: 0.262 Vali Acc: 0.975 Test Loss: 0.262 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps15_str8_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 29444
model size : 0.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps20_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.3848271369934082
Epoch: 1, Steps: 3 | Train Loss: 1.438 Vali Loss: 1.470 Vali Acc: 0.150 Test Loss: 1.470 Test Acc: 0.150
Validation loss decreased (inf --> -0.149985).  Saving model ...
Epoch: 2 cost time: 0.367767333984375
Epoch: 2, Steps: 3 | Train Loss: 1.409 Vali Loss: 1.456 Vali Acc: 0.175 Test Loss: 1.456 Test Acc: 0.175
Validation loss decreased (-0.149985 --> -0.174985).  Saving model ...
Epoch: 3 cost time: 0.38353610038757324
Epoch: 3, Steps: 3 | Train Loss: 1.360 Vali Loss: 1.441 Vali Acc: 0.150 Test Loss: 1.441 Test Acc: 0.150
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.34470677375793457
Epoch: 4, Steps: 3 | Train Loss: 1.308 Vali Loss: 1.414 Vali Acc: 0.150 Test Loss: 1.414 Test Acc: 0.150
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.3526339530944824
Epoch: 5, Steps: 3 | Train Loss: 1.273 Vali Loss: 1.377 Vali Acc: 0.175 Test Loss: 1.377 Test Acc: 0.175
Validation loss decreased (-0.174985 --> -0.174986).  Saving model ...
Epoch: 6 cost time: 0.4129912853240967
Epoch: 6, Steps: 3 | Train Loss: 1.224 Vali Loss: 1.332 Vali Acc: 0.250 Test Loss: 1.332 Test Acc: 0.250
Validation loss decreased (-0.174986 --> -0.249987).  Saving model ...
Epoch: 7 cost time: 0.3746678829193115
Epoch: 7, Steps: 3 | Train Loss: 1.120 Vali Loss: 1.285 Vali Acc: 0.275 Test Loss: 1.285 Test Acc: 0.275
Validation loss decreased (-0.249987 --> -0.274987).  Saving model ...
Epoch: 8 cost time: 0.4226841926574707
Epoch: 8, Steps: 3 | Train Loss: 1.092 Vali Loss: 1.236 Vali Acc: 0.350 Test Loss: 1.236 Test Acc: 0.350
Validation loss decreased (-0.274987 --> -0.349988).  Saving model ...
Epoch: 9 cost time: 0.3934645652770996
Epoch: 9, Steps: 3 | Train Loss: 1.044 Vali Loss: 1.184 Vali Acc: 0.425 Test Loss: 1.184 Test Acc: 0.425
Validation loss decreased (-0.349988 --> -0.424988).  Saving model ...
Epoch: 10 cost time: 0.3675363063812256
Epoch: 10, Steps: 3 | Train Loss: 0.998 Vali Loss: 1.137 Vali Acc: 0.450 Test Loss: 1.137 Test Acc: 0.450
Validation loss decreased (-0.424988 --> -0.449989).  Saving model ...
Epoch: 11 cost time: 0.3784165382385254
Epoch: 11, Steps: 3 | Train Loss: 0.956 Vali Loss: 1.091 Vali Acc: 0.475 Test Loss: 1.091 Test Acc: 0.475
Validation loss decreased (-0.449989 --> -0.474989).  Saving model ...
Epoch: 12 cost time: 0.3625633716583252
Epoch: 12, Steps: 3 | Train Loss: 0.889 Vali Loss: 1.045 Vali Acc: 0.525 Test Loss: 1.045 Test Acc: 0.525
Validation loss decreased (-0.474989 --> -0.524990).  Saving model ...
Epoch: 13 cost time: 0.40561914443969727
Epoch: 13, Steps: 3 | Train Loss: 0.842 Vali Loss: 1.002 Vali Acc: 0.575 Test Loss: 1.002 Test Acc: 0.575
Validation loss decreased (-0.524990 --> -0.574990).  Saving model ...
Epoch: 14 cost time: 0.43082284927368164
Epoch: 14, Steps: 3 | Train Loss: 0.782 Vali Loss: 0.963 Vali Acc: 0.600 Test Loss: 0.963 Test Acc: 0.600
Validation loss decreased (-0.574990 --> -0.599990).  Saving model ...
Epoch: 15 cost time: 0.39634275436401367
Epoch: 15, Steps: 3 | Train Loss: 0.762 Vali Loss: 0.923 Vali Acc: 0.650 Test Loss: 0.923 Test Acc: 0.650
Validation loss decreased (-0.599990 --> -0.649991).  Saving model ...
Epoch: 16 cost time: 0.3975064754486084
Epoch: 16, Steps: 3 | Train Loss: 0.720 Vali Loss: 0.885 Vali Acc: 0.650 Test Loss: 0.885 Test Acc: 0.650
Validation loss decreased (-0.649991 --> -0.649991).  Saving model ...
Epoch: 17 cost time: 0.3861050605773926
Epoch: 17, Steps: 3 | Train Loss: 0.674 Vali Loss: 0.849 Vali Acc: 0.650 Test Loss: 0.849 Test Acc: 0.650
Validation loss decreased (-0.649991 --> -0.649992).  Saving model ...
Epoch: 18 cost time: 0.38730835914611816
Epoch: 18, Steps: 3 | Train Loss: 0.650 Vali Loss: 0.811 Vali Acc: 0.700 Test Loss: 0.811 Test Acc: 0.700
Validation loss decreased (-0.649992 --> -0.699992).  Saving model ...
Epoch: 19 cost time: 0.40288305282592773
Epoch: 19, Steps: 3 | Train Loss: 0.620 Vali Loss: 0.776 Vali Acc: 0.775 Test Loss: 0.776 Test Acc: 0.775
Validation loss decreased (-0.699992 --> -0.774992).  Saving model ...
Epoch: 20 cost time: 0.37827038764953613
Epoch: 20, Steps: 3 | Train Loss: 0.587 Vali Loss: 0.751 Vali Acc: 0.850 Test Loss: 0.751 Test Acc: 0.850
Validation loss decreased (-0.774992 --> -0.849992).  Saving model ...
Epoch: 21 cost time: 0.40442657470703125
Epoch: 21, Steps: 3 | Train Loss: 0.529 Vali Loss: 0.723 Vali Acc: 0.925 Test Loss: 0.723 Test Acc: 0.925
Validation loss decreased (-0.849992 --> -0.924993).  Saving model ...
Epoch: 22 cost time: 0.40682339668273926
Epoch: 22, Steps: 3 | Train Loss: 0.524 Vali Loss: 0.693 Vali Acc: 0.925 Test Loss: 0.693 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924993).  Saving model ...
Epoch: 23 cost time: 0.40991806983947754
Epoch: 23, Steps: 3 | Train Loss: 0.505 Vali Loss: 0.665 Vali Acc: 0.925 Test Loss: 0.665 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924993).  Saving model ...
Epoch: 24 cost time: 0.38387155532836914
Epoch: 24, Steps: 3 | Train Loss: 0.467 Vali Loss: 0.645 Vali Acc: 0.925 Test Loss: 0.645 Test Acc: 0.925
Validation loss decreased (-0.924993 --> -0.924994).  Saving model ...
Epoch: 25 cost time: 0.3724641799926758
Epoch: 25, Steps: 3 | Train Loss: 0.447 Vali Loss: 0.622 Vali Acc: 0.925 Test Loss: 0.622 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 26 cost time: 0.3896353244781494
Epoch: 26, Steps: 3 | Train Loss: 0.423 Vali Loss: 0.600 Vali Acc: 0.925 Test Loss: 0.600 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 27 cost time: 0.39246511459350586
Epoch: 27, Steps: 3 | Train Loss: 0.396 Vali Loss: 0.584 Vali Acc: 0.925 Test Loss: 0.584 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 28 cost time: 0.3799021244049072
Epoch: 28, Steps: 3 | Train Loss: 0.396 Vali Loss: 0.571 Vali Acc: 0.925 Test Loss: 0.571 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 29 cost time: 0.46944594383239746
Epoch: 29, Steps: 3 | Train Loss: 0.368 Vali Loss: 0.553 Vali Acc: 0.925 Test Loss: 0.553 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 30 cost time: 0.4018585681915283
Epoch: 30, Steps: 3 | Train Loss: 0.343 Vali Loss: 0.540 Vali Acc: 0.925 Test Loss: 0.540 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924995).  Saving model ...
Epoch: 31 cost time: 0.3907899856567383
Epoch: 31, Steps: 3 | Train Loss: 0.358 Vali Loss: 0.523 Vali Acc: 0.925 Test Loss: 0.523 Test Acc: 0.925
Validation loss decreased (-0.924995 --> -0.924995).  Saving model ...
Epoch: 32 cost time: 0.46471691131591797
Epoch: 32, Steps: 3 | Train Loss: 0.349 Vali Loss: 0.511 Vali Acc: 0.900 Test Loss: 0.511 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.39066028594970703
Epoch: 33, Steps: 3 | Train Loss: 0.309 Vali Loss: 0.505 Vali Acc: 0.900 Test Loss: 0.505 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.39783525466918945
Epoch: 34, Steps: 3 | Train Loss: 0.288 Vali Loss: 0.501 Vali Acc: 0.900 Test Loss: 0.501 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.46582984924316406
Epoch: 35, Steps: 3 | Train Loss: 0.262 Vali Loss: 0.486 Vali Acc: 0.900 Test Loss: 0.486 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.41175341606140137
Epoch: 36, Steps: 3 | Train Loss: 0.273 Vali Loss: 0.489 Vali Acc: 0.900 Test Loss: 0.489 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.465548038482666
Epoch: 37, Steps: 3 | Train Loss: 0.275 Vali Loss: 0.481 Vali Acc: 0.900 Test Loss: 0.481 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.4955315589904785
Epoch: 38, Steps: 3 | Train Loss: 0.273 Vali Loss: 0.477 Vali Acc: 0.900 Test Loss: 0.477 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.4553673267364502
Epoch: 39, Steps: 3 | Train Loss: 0.239 Vali Loss: 0.475 Vali Acc: 0.900 Test Loss: 0.475 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.4713916778564453
Epoch: 40, Steps: 3 | Train Loss: 0.241 Vali Loss: 0.464 Vali Acc: 0.900 Test Loss: 0.464 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.5182507038116455
Epoch: 41, Steps: 3 | Train Loss: 0.235 Vali Loss: 0.453 Vali Acc: 0.900 Test Loss: 0.453 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps20_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.925
model parameter : 28068
model size : 0.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_BasicMotions    Model:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/BasicMotions
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

40
40
>>>>>>>start training : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps25_str13_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
40
40
40
Epoch: 1 cost time: 1.3182439804077148
Epoch: 1, Steps: 3 | Train Loss: 1.388 Vali Loss: 1.423 Vali Acc: 0.350 Test Loss: 1.423 Test Acc: 0.350
Validation loss decreased (inf --> -0.349986).  Saving model ...
Epoch: 2 cost time: 0.347062349319458
Epoch: 2, Steps: 3 | Train Loss: 1.378 Vali Loss: 1.411 Vali Acc: 0.375 Test Loss: 1.411 Test Acc: 0.375
Validation loss decreased (-0.349986 --> -0.374986).  Saving model ...
Epoch: 3 cost time: 0.34363412857055664
Epoch: 3, Steps: 3 | Train Loss: 1.341 Vali Loss: 1.400 Vali Acc: 0.400 Test Loss: 1.400 Test Acc: 0.400
Validation loss decreased (-0.374986 --> -0.399986).  Saving model ...
Epoch: 4 cost time: 0.34998226165771484
Epoch: 4, Steps: 3 | Train Loss: 1.279 Vali Loss: 1.380 Vali Acc: 0.425 Test Loss: 1.380 Test Acc: 0.425
Validation loss decreased (-0.399986 --> -0.424986).  Saving model ...
Epoch: 5 cost time: 0.32631611824035645
Epoch: 5, Steps: 3 | Train Loss: 1.293 Vali Loss: 1.350 Vali Acc: 0.475 Test Loss: 1.350 Test Acc: 0.475
Validation loss decreased (-0.424986 --> -0.474986).  Saving model ...
Epoch: 6 cost time: 0.30295276641845703
Epoch: 6, Steps: 3 | Train Loss: 1.225 Vali Loss: 1.312 Vali Acc: 0.550 Test Loss: 1.312 Test Acc: 0.550
Validation loss decreased (-0.474986 --> -0.549987).  Saving model ...
Epoch: 7 cost time: 0.30250120162963867
Epoch: 7, Steps: 3 | Train Loss: 1.172 Vali Loss: 1.269 Vali Acc: 0.550 Test Loss: 1.269 Test Acc: 0.550
Validation loss decreased (-0.549987 --> -0.549987).  Saving model ...
Epoch: 8 cost time: 0.45273447036743164
Epoch: 8, Steps: 3 | Train Loss: 1.133 Vali Loss: 1.224 Vali Acc: 0.625 Test Loss: 1.224 Test Acc: 0.625
Validation loss decreased (-0.549987 --> -0.624988).  Saving model ...
Epoch: 9 cost time: 0.3222782611846924
Epoch: 9, Steps: 3 | Train Loss: 1.091 Vali Loss: 1.179 Vali Acc: 0.650 Test Loss: 1.179 Test Acc: 0.650
Validation loss decreased (-0.624988 --> -0.649988).  Saving model ...
Epoch: 10 cost time: 0.3214600086212158
Epoch: 10, Steps: 3 | Train Loss: 1.088 Vali Loss: 1.131 Vali Acc: 0.675 Test Loss: 1.131 Test Acc: 0.675
Validation loss decreased (-0.649988 --> -0.674989).  Saving model ...
Epoch: 11 cost time: 0.33690953254699707
Epoch: 11, Steps: 3 | Train Loss: 0.986 Vali Loss: 1.087 Vali Acc: 0.725 Test Loss: 1.087 Test Acc: 0.725
Validation loss decreased (-0.674989 --> -0.724989).  Saving model ...
Epoch: 12 cost time: 0.3346426486968994
Epoch: 12, Steps: 3 | Train Loss: 0.980 Vali Loss: 1.042 Vali Acc: 0.750 Test Loss: 1.042 Test Acc: 0.750
Validation loss decreased (-0.724989 --> -0.749990).  Saving model ...
Epoch: 13 cost time: 0.34659767150878906
Epoch: 13, Steps: 3 | Train Loss: 0.945 Vali Loss: 0.997 Vali Acc: 0.800 Test Loss: 0.997 Test Acc: 0.800
Validation loss decreased (-0.749990 --> -0.799990).  Saving model ...
Epoch: 14 cost time: 0.3622889518737793
Epoch: 14, Steps: 3 | Train Loss: 0.889 Vali Loss: 0.955 Vali Acc: 0.800 Test Loss: 0.955 Test Acc: 0.800
Validation loss decreased (-0.799990 --> -0.799990).  Saving model ...
Epoch: 15 cost time: 0.35457777976989746
Epoch: 15, Steps: 3 | Train Loss: 0.840 Vali Loss: 0.917 Vali Acc: 0.800 Test Loss: 0.917 Test Acc: 0.800
Validation loss decreased (-0.799990 --> -0.799991).  Saving model ...
Epoch: 16 cost time: 0.35253095626831055
Epoch: 16, Steps: 3 | Train Loss: 0.815 Vali Loss: 0.877 Vali Acc: 0.800 Test Loss: 0.877 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799991).  Saving model ...
Epoch: 17 cost time: 0.33663177490234375
Epoch: 17, Steps: 3 | Train Loss: 0.822 Vali Loss: 0.837 Vali Acc: 0.800 Test Loss: 0.837 Test Acc: 0.800
Validation loss decreased (-0.799991 --> -0.799992).  Saving model ...
Epoch: 18 cost time: 0.38892126083374023
Epoch: 18, Steps: 3 | Train Loss: 0.729 Vali Loss: 0.812 Vali Acc: 0.825 Test Loss: 0.812 Test Acc: 0.825
Validation loss decreased (-0.799992 --> -0.824992).  Saving model ...
Epoch: 19 cost time: 0.4455437660217285
Epoch: 19, Steps: 3 | Train Loss: 0.746 Vali Loss: 0.784 Vali Acc: 0.850 Test Loss: 0.784 Test Acc: 0.850
Validation loss decreased (-0.824992 --> -0.849992).  Saving model ...
Epoch: 20 cost time: 0.43836092948913574
Epoch: 20, Steps: 3 | Train Loss: 0.689 Vali Loss: 0.759 Vali Acc: 0.850 Test Loss: 0.759 Test Acc: 0.850
Validation loss decreased (-0.849992 --> -0.849992).  Saving model ...
Epoch: 21 cost time: 0.35642027854919434
Epoch: 21, Steps: 3 | Train Loss: 0.654 Vali Loss: 0.731 Vali Acc: 0.900 Test Loss: 0.731 Test Acc: 0.900
Validation loss decreased (-0.849992 --> -0.899993).  Saving model ...
Epoch: 22 cost time: 0.3531613349914551
Epoch: 22, Steps: 3 | Train Loss: 0.625 Vali Loss: 0.703 Vali Acc: 0.900 Test Loss: 0.703 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 23 cost time: 0.36087584495544434
Epoch: 23, Steps: 3 | Train Loss: 0.604 Vali Loss: 0.676 Vali Acc: 0.900 Test Loss: 0.676 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 24 cost time: 0.37520527839660645
Epoch: 24, Steps: 3 | Train Loss: 0.565 Vali Loss: 0.657 Vali Acc: 0.900 Test Loss: 0.657 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 25 cost time: 0.33713746070861816
Epoch: 25, Steps: 3 | Train Loss: 0.542 Vali Loss: 0.636 Vali Acc: 0.900 Test Loss: 0.636 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899994).  Saving model ...
Epoch: 26 cost time: 0.3261904716491699
Epoch: 26, Steps: 3 | Train Loss: 0.511 Vali Loss: 0.628 Vali Acc: 0.900 Test Loss: 0.628 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 27 cost time: 0.38659024238586426
Epoch: 27, Steps: 3 | Train Loss: 0.501 Vali Loss: 0.610 Vali Acc: 0.925 Test Loss: 0.610 Test Acc: 0.925
Validation loss decreased (-0.899994 --> -0.924994).  Saving model ...
Epoch: 28 cost time: 0.4178762435913086
Epoch: 28, Steps: 3 | Train Loss: 0.491 Vali Loss: 0.593 Vali Acc: 0.925 Test Loss: 0.593 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 29 cost time: 0.33980512619018555
Epoch: 29, Steps: 3 | Train Loss: 0.476 Vali Loss: 0.578 Vali Acc: 0.925 Test Loss: 0.578 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 30 cost time: 0.3573124408721924
Epoch: 30, Steps: 3 | Train Loss: 0.445 Vali Loss: 0.566 Vali Acc: 0.925 Test Loss: 0.566 Test Acc: 0.925
Validation loss decreased (-0.924994 --> -0.924994).  Saving model ...
Epoch: 31 cost time: 0.4211454391479492
Epoch: 31, Steps: 3 | Train Loss: 0.436 Vali Loss: 0.546 Vali Acc: 0.950 Test Loss: 0.546 Test Acc: 0.950
Validation loss decreased (-0.924994 --> -0.949995).  Saving model ...
Epoch: 32 cost time: 0.3535928726196289
Epoch: 32, Steps: 3 | Train Loss: 0.386 Vali Loss: 0.521 Vali Acc: 0.950 Test Loss: 0.521 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 33 cost time: 0.3876783847808838
Epoch: 33, Steps: 3 | Train Loss: 0.422 Vali Loss: 0.505 Vali Acc: 0.950 Test Loss: 0.505 Test Acc: 0.950
Validation loss decreased (-0.949995 --> -0.949995).  Saving model ...
Epoch: 34 cost time: 0.37658238410949707
Epoch: 34, Steps: 3 | Train Loss: 0.407 Vali Loss: 0.490 Vali Acc: 0.975 Test Loss: 0.490 Test Acc: 0.975
Validation loss decreased (-0.949995 --> -0.974995).  Saving model ...
Epoch: 35 cost time: 0.3312203884124756
Epoch: 35, Steps: 3 | Train Loss: 0.373 Vali Loss: 0.484 Vali Acc: 0.975 Test Loss: 0.484 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 36 cost time: 0.3870127201080322
Epoch: 36, Steps: 3 | Train Loss: 0.342 Vali Loss: 0.468 Vali Acc: 0.975 Test Loss: 0.468 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974995).  Saving model ...
Epoch: 37 cost time: 0.377765417098999
Epoch: 37, Steps: 3 | Train Loss: 0.344 Vali Loss: 0.450 Vali Acc: 0.975 Test Loss: 0.450 Test Acc: 0.975
Validation loss decreased (-0.974995 --> -0.974996).  Saving model ...
Epoch: 38 cost time: 0.3398244380950928
Epoch: 38, Steps: 3 | Train Loss: 0.340 Vali Loss: 0.440 Vali Acc: 0.975 Test Loss: 0.440 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 39 cost time: 0.36498069763183594
Epoch: 39, Steps: 3 | Train Loss: 0.308 Vali Loss: 0.430 Vali Acc: 0.975 Test Loss: 0.430 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 40 cost time: 0.39977431297302246
Epoch: 40, Steps: 3 | Train Loss: 0.286 Vali Loss: 0.413 Vali Acc: 0.975 Test Loss: 0.413 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 41 cost time: 0.4089846611022949
Epoch: 41, Steps: 3 | Train Loss: 0.313 Vali Loss: 0.406 Vali Acc: 0.975 Test Loss: 0.406 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 42 cost time: 0.4312918186187744
Epoch: 42, Steps: 3 | Train Loss: 0.286 Vali Loss: 0.409 Vali Acc: 0.975 Test Loss: 0.409 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.4399445056915283
Epoch: 43, Steps: 3 | Train Loss: 0.307 Vali Loss: 0.394 Vali Acc: 0.975 Test Loss: 0.394 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 44 cost time: 0.44060826301574707
Epoch: 44, Steps: 3 | Train Loss: 0.266 Vali Loss: 0.388 Vali Acc: 0.975 Test Loss: 0.388 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 45 cost time: 0.42829132080078125
Epoch: 45, Steps: 3 | Train Loss: 0.257 Vali Loss: 0.376 Vali Acc: 0.975 Test Loss: 0.376 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 46 cost time: 0.4216172695159912
Epoch: 46, Steps: 3 | Train Loss: 0.241 Vali Loss: 0.363 Vali Acc: 0.975 Test Loss: 0.363 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 47 cost time: 0.3958296775817871
Epoch: 47, Steps: 3 | Train Loss: 0.250 Vali Loss: 0.361 Vali Acc: 0.975 Test Loss: 0.361 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974996).  Saving model ...
Epoch: 48 cost time: 0.4284403324127197
Epoch: 48, Steps: 3 | Train Loss: 0.249 Vali Loss: 0.349 Vali Acc: 0.975 Test Loss: 0.349 Test Acc: 0.975
Validation loss decreased (-0.974996 --> -0.974997).  Saving model ...
Epoch: 49 cost time: 0.4519619941711426
Epoch: 49, Steps: 3 | Train Loss: 0.221 Vali Loss: 0.343 Vali Acc: 0.975 Test Loss: 0.343 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
Epoch: 50 cost time: 0.45862603187561035
Epoch: 50, Steps: 3 | Train Loss: 0.254 Vali Loss: 0.340 Vali Acc: 0.975 Test Loss: 0.340 Test Acc: 0.975
Validation loss decreased (-0.974997 --> -0.974997).  Saving model ...
>>>>>>>testing : classification_CLS_BasicMotions_ModernTCN_UEA_ftM_sl100_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps25_str13_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
40
test shape: torch.Size([40, 4]) torch.Size([40, 1])
accuracy:0.975
model parameter : 25924
model size : 0.12MB
