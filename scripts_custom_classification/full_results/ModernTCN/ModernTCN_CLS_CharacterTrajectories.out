Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.7522969245910645
Epoch: 1, Steps: 89 | Train Loss: 1.874 Vali Loss: 0.557 Vali Acc: 0.857 Test Loss: 0.557 Test Acc: 0.857
Validation loss decreased (inf --> -0.856540).  Saving model ...
Epoch: 2 cost time: 2.7014167308807373
Epoch: 2, Steps: 89 | Train Loss: 0.302 Vali Loss: 0.253 Vali Acc: 0.932 Test Loss: 0.253 Test Acc: 0.932
Validation loss decreased (-0.856540 --> -0.931752).  Saving model ...
Epoch: 3 cost time: 2.5646684169769287
Epoch: 3, Steps: 89 | Train Loss: 0.125 Vali Loss: 0.124 Vali Acc: 0.964 Test Loss: 0.124 Test Acc: 0.964
Validation loss decreased (-0.931752 --> -0.964483).  Saving model ...
Epoch: 4 cost time: 2.6019515991210938
Epoch: 4, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.127 Vali Acc: 0.968 Test Loss: 0.127 Test Acc: 0.968
Validation loss decreased (-0.964483 --> -0.967965).  Saving model ...
Epoch: 5 cost time: 2.469151735305786
Epoch: 5, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.108 Vali Acc: 0.976 Test Loss: 0.108 Test Acc: 0.976
Validation loss decreased (-0.967965 --> -0.975626).  Saving model ...
Epoch: 6 cost time: 2.514193534851074
Epoch: 6, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.081 Vali Acc: 0.978 Test Loss: 0.081 Test Acc: 0.978
Validation loss decreased (-0.975626 --> -0.978411).  Saving model ...
Epoch: 7 cost time: 2.269702196121216
Epoch: 7, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.101 Vali Acc: 0.979 Test Loss: 0.101 Test Acc: 0.979
Validation loss decreased (-0.978411 --> -0.979108).  Saving model ...
Epoch: 8 cost time: 2.5832724571228027
Epoch: 8, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.076 Vali Acc: 0.981 Test Loss: 0.076 Test Acc: 0.981
Validation loss decreased (-0.979108 --> -0.980501).  Saving model ...
Epoch: 9 cost time: 2.4548957347869873
Epoch: 9, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.165 Vali Acc: 0.966 Test Loss: 0.165 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.5164453983306885
Epoch: 10, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.094 Vali Acc: 0.979 Test Loss: 0.094 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.643425703048706
Epoch: 11, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.206 Vali Acc: 0.960 Test Loss: 0.206 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.5081989765167236
Epoch: 12, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.199 Vali Acc: 0.961 Test Loss: 0.199 Test Acc: 0.961
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.621234655380249
Epoch: 13, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.122 Vali Acc: 0.981 Test Loss: 0.122 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.5654308795928955
Epoch: 14, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.127 Vali Acc: 0.979 Test Loss: 0.127 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.3033454418182373
Epoch: 15, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.155 Vali Acc: 0.973 Test Loss: 0.155 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.3709921836853027
Epoch: 16, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.133 Vali Acc: 0.975 Test Loss: 0.133 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.516465902328491
Epoch: 17, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.087 Vali Acc: 0.985 Test Loss: 0.087 Test Acc: 0.985
Validation loss decreased (-0.980501 --> -0.984679).  Saving model ...
Epoch: 18 cost time: 2.5726993083953857
Epoch: 18, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.986 Test Loss: 0.092 Test Acc: 0.986
Validation loss decreased (-0.984679 --> -0.986072).  Saving model ...
Epoch: 19 cost time: 2.595371961593628
Epoch: 19, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.987 Test Loss: 0.088 Test Acc: 0.987
Validation loss decreased (-0.986072 --> -0.986768).  Saving model ...
Epoch: 20 cost time: 2.475123167037964
Epoch: 20, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.100 Vali Acc: 0.985 Test Loss: 0.100 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.5969045162200928
Epoch: 21, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.183 Vali Acc: 0.970 Test Loss: 0.183 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.44626784324646
Epoch: 22, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.215 Vali Acc: 0.969 Test Loss: 0.215 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.5590360164642334
Epoch: 23, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.198 Vali Acc: 0.982 Test Loss: 0.198 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.571432113647461
Epoch: 24, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.162 Vali Acc: 0.976 Test Loss: 0.162 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.587501049041748
Epoch: 25, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.304 Vali Acc: 0.960 Test Loss: 0.304 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.6882591247558594
Epoch: 26, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.182 Vali Acc: 0.980 Test Loss: 0.182 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.651120901107788
Epoch: 27, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.198 Vali Acc: 0.978 Test Loss: 0.198 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.873699426651001
Epoch: 28, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.208 Vali Acc: 0.970 Test Loss: 0.208 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.964918851852417
Epoch: 29, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.149 Vali Acc: 0.982 Test Loss: 0.149 Test Acc: 0.982
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9867688022284122
model parameter : 690516
model size : 2.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.161072015762329
Epoch: 1, Steps: 89 | Train Loss: 2.198 Vali Loss: 0.920 Vali Acc: 0.786 Test Loss: 0.920 Test Acc: 0.786
Validation loss decreased (inf --> -0.785506).  Saving model ...
Epoch: 2 cost time: 3.844588041305542
Epoch: 2, Steps: 89 | Train Loss: 0.500 Vali Loss: 0.278 Vali Acc: 0.928 Test Loss: 0.278 Test Acc: 0.928
Validation loss decreased (-0.785506 --> -0.927574).  Saving model ...
Epoch: 3 cost time: 4.503230810165405
Epoch: 3, Steps: 89 | Train Loss: 0.168 Vali Loss: 0.147 Vali Acc: 0.964 Test Loss: 0.147 Test Acc: 0.964
Validation loss decreased (-0.927574 --> -0.964483).  Saving model ...
Epoch: 4 cost time: 3.706143617630005
Epoch: 4, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.104 Vali Acc: 0.972 Test Loss: 0.104 Test Acc: 0.972
Validation loss decreased (-0.964483 --> -0.972144).  Saving model ...
Epoch: 5 cost time: 4.3169755935668945
Epoch: 5, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.972144 --> -0.982590).  Saving model ...
Epoch: 6 cost time: 4.600093841552734
Epoch: 6, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.101 Vali Acc: 0.971 Test Loss: 0.101 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.280610084533691
Epoch: 7, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.798121213912964
Epoch: 8, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
Validation loss decreased (-0.982590 --> -0.983286).  Saving model ...
Epoch: 9 cost time: 4.184960126876831
Epoch: 9, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.085 Vali Acc: 0.978 Test Loss: 0.085 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.446351766586304
Epoch: 10, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.086 Vali Acc: 0.981 Test Loss: 0.086 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.5302155017852783
Epoch: 11, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.979614734649658
Epoch: 12, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.981 Test Loss: 0.077 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.042326927185059
Epoch: 13, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.081 Vali Acc: 0.984 Test Loss: 0.081 Test Acc: 0.984
Validation loss decreased (-0.983286 --> -0.983982).  Saving model ...
Epoch: 14 cost time: 4.613311290740967
Epoch: 14, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.180887699127197
Epoch: 15, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.080 Vali Acc: 0.986 Test Loss: 0.080 Test Acc: 0.986
Validation loss decreased (-0.983982 --> -0.986072).  Saving model ...
Epoch: 16 cost time: 3.693790912628174
Epoch: 16, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.269 Vali Acc: 0.962 Test Loss: 0.269 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.962390422821045
Epoch: 17, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.109 Vali Acc: 0.980 Test Loss: 0.109 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.8588874340057373
Epoch: 18, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.122 Vali Acc: 0.981 Test Loss: 0.122 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.762718439102173
Epoch: 19, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.141 Vali Acc: 0.978 Test Loss: 0.141 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 4.515233516693115
Epoch: 20, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.132 Vali Acc: 0.978 Test Loss: 0.132 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 4.3276286125183105
Epoch: 21, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.222 Vali Acc: 0.960 Test Loss: 0.222 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.9457643032073975
Epoch: 22, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.158 Vali Acc: 0.980 Test Loss: 0.158 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.924766778945923
Epoch: 23, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.132 Vali Acc: 0.979 Test Loss: 0.132 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 4.643430948257446
Epoch: 24, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.097 Vali Acc: 0.981 Test Loss: 0.097 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 3.953343629837036
Epoch: 25, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.120 Vali Acc: 0.984 Test Loss: 0.120 Test Acc: 0.984
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9860724233983287
model parameter : 644596
model size : 2.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps14_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.517493963241577
Epoch: 1, Steps: 89 | Train Loss: 2.200 Vali Loss: 0.967 Vali Acc: 0.815 Test Loss: 0.967 Test Acc: 0.815
Validation loss decreased (inf --> -0.814754).  Saving model ...
Epoch: 2 cost time: 4.256117105484009
Epoch: 2, Steps: 89 | Train Loss: 0.538 Vali Loss: 0.328 Vali Acc: 0.914 Test Loss: 0.328 Test Acc: 0.914
Validation loss decreased (-0.814754 --> -0.913646).  Saving model ...
Epoch: 3 cost time: 3.6152358055114746
Epoch: 3, Steps: 89 | Train Loss: 0.193 Vali Loss: 0.150 Vali Acc: 0.968 Test Loss: 0.150 Test Acc: 0.968
Validation loss decreased (-0.913646 --> -0.967965).  Saving model ...
Epoch: 4 cost time: 3.4839088916778564
Epoch: 4, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.093 Vali Acc: 0.978 Test Loss: 0.093 Test Acc: 0.978
Validation loss decreased (-0.967965 --> -0.978411).  Saving model ...
Epoch: 5 cost time: 3.282595634460449
Epoch: 5, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.095 Vali Acc: 0.976 Test Loss: 0.095 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.126766920089722
Epoch: 6, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.065 Vali Acc: 0.985 Test Loss: 0.065 Test Acc: 0.985
Validation loss decreased (-0.978411 --> -0.984679).  Saving model ...
Epoch: 7 cost time: 3.917147397994995
Epoch: 7, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.060 Vali Acc: 0.985 Test Loss: 0.060 Test Acc: 0.985
Validation loss decreased (-0.984679 --> -0.984679).  Saving model ...
Epoch: 8 cost time: 4.391748666763306
Epoch: 8, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.28001856803894
Epoch: 9, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.7335550785064697
Epoch: 10, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.093 Vali Acc: 0.969 Test Loss: 0.093 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.9985783100128174
Epoch: 11, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.065 Vali Acc: 0.987 Test Loss: 0.065 Test Acc: 0.987
Validation loss decreased (-0.984679 --> -0.986768).  Saving model ...
Epoch: 12 cost time: 4.250986099243164
Epoch: 12, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.067 Vali Acc: 0.986 Test Loss: 0.067 Test Acc: 0.986
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.094677686691284
Epoch: 13, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.088 Vali Acc: 0.982 Test Loss: 0.088 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.01446270942688
Epoch: 14, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.066 Vali Acc: 0.987 Test Loss: 0.066 Test Acc: 0.987
Validation loss decreased (-0.986768 --> -0.987465).  Saving model ...
Epoch: 15 cost time: 4.4455883502960205
Epoch: 15, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.056 Vali Acc: 0.987 Test Loss: 0.056 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.9162864685058594
Epoch: 16, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.058 Vali Acc: 0.989 Test Loss: 0.058 Test Acc: 0.989
Validation loss decreased (-0.987465 --> -0.988857).  Saving model ...
Epoch: 17 cost time: 3.7994062900543213
Epoch: 17, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.049 Vali Acc: 0.989 Test Loss: 0.049 Test Acc: 0.989
Validation loss decreased (-0.988857 --> -0.988857).  Saving model ...
Epoch: 18 cost time: 4.27323055267334
Epoch: 18, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.062 Vali Acc: 0.987 Test Loss: 0.062 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.9153573513031006
Epoch: 19, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.093 Vali Acc: 0.981 Test Loss: 0.093 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.191317796707153
Epoch: 20, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.069 Vali Acc: 0.987 Test Loss: 0.069 Test Acc: 0.987
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.5376596450805664
Epoch: 21, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.145 Vali Acc: 0.969 Test Loss: 0.145 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.9431498050689697
Epoch: 22, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.165 Vali Acc: 0.970 Test Loss: 0.165 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 4.127358436584473
Epoch: 23, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.147 Vali Acc: 0.974 Test Loss: 0.147 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.3262979984283447
Epoch: 24, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.069 Vali Acc: 0.987 Test Loss: 0.069 Test Acc: 0.987
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 3.7548861503601074
Epoch: 25, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.089 Vali Acc: 0.986 Test Loss: 0.089 Test Acc: 0.986
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 3.982497453689575
Epoch: 26, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.107 Vali Acc: 0.985 Test Loss: 0.107 Test Acc: 0.985
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 4.375856161117554
Epoch: 27, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.151 Vali Acc: 0.973 Test Loss: 0.151 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps14_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9888579387186629
model parameter : 629364
model size : 2.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps19_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.591996431350708
Epoch: 1, Steps: 89 | Train Loss: 2.366 Vali Loss: 1.288 Vali Acc: 0.742 Test Loss: 1.288 Test Acc: 0.742
Validation loss decreased (inf --> -0.741631).  Saving model ...
Epoch: 2 cost time: 3.942120313644409
Epoch: 2, Steps: 89 | Train Loss: 0.692 Vali Loss: 0.343 Vali Acc: 0.919 Test Loss: 0.343 Test Acc: 0.919
Validation loss decreased (-0.741631 --> -0.918520).  Saving model ...
Epoch: 3 cost time: 3.1448705196380615
Epoch: 3, Steps: 89 | Train Loss: 0.244 Vali Loss: 0.174 Vali Acc: 0.963 Test Loss: 0.174 Test Acc: 0.963
Validation loss decreased (-0.918520 --> -0.963090).  Saving model ...
Epoch: 4 cost time: 3.814101457595825
Epoch: 4, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.117 Vali Acc: 0.966 Test Loss: 0.117 Test Acc: 0.966
Validation loss decreased (-0.963090 --> -0.965876).  Saving model ...
Epoch: 5 cost time: 3.6711361408233643
Epoch: 5, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.965876 --> -0.979804).  Saving model ...
Epoch: 6 cost time: 3.779669761657715
Epoch: 6, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.086 Vali Acc: 0.974 Test Loss: 0.086 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.129364490509033
Epoch: 7, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.109 Vali Acc: 0.971 Test Loss: 0.109 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.7449169158935547
Epoch: 8, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.064 Vali Acc: 0.981 Test Loss: 0.064 Test Acc: 0.981
Validation loss decreased (-0.979804 --> -0.981197).  Saving model ...
Epoch: 9 cost time: 4.557981967926025
Epoch: 9, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.075 Vali Acc: 0.981 Test Loss: 0.075 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.156303405761719
Epoch: 10, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.073 Vali Acc: 0.985 Test Loss: 0.073 Test Acc: 0.985
Validation loss decreased (-0.981197 --> -0.985375).  Saving model ...
Epoch: 11 cost time: 3.6725218296051025
Epoch: 11, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.7418053150177
Epoch: 12, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.076 Vali Acc: 0.981 Test Loss: 0.076 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.7338132858276367
Epoch: 13, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.063 Vali Acc: 0.985 Test Loss: 0.063 Test Acc: 0.985
Validation loss decreased (-0.985375 --> -0.985375).  Saving model ...
Epoch: 14 cost time: 4.001689672470093
Epoch: 14, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.738800287246704
Epoch: 15, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.101 Vali Acc: 0.976 Test Loss: 0.101 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.530660629272461
Epoch: 16, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.087 Vali Acc: 0.979 Test Loss: 0.087 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.293473720550537
Epoch: 17, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.102 Vali Acc: 0.978 Test Loss: 0.102 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 4.65339469909668
Epoch: 18, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.086 Vali Acc: 0.984 Test Loss: 0.086 Test Acc: 0.984
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.7442891597747803
Epoch: 19, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.081 Vali Acc: 0.988 Test Loss: 0.081 Test Acc: 0.988
Validation loss decreased (-0.985375 --> -0.988161).  Saving model ...
Epoch: 20 cost time: 3.785676956176758
Epoch: 20, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.122 Vali Acc: 0.973 Test Loss: 0.122 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.4730770587921143
Epoch: 21, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.059 Vali Acc: 0.986 Test Loss: 0.059 Test Acc: 0.986
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.6133639812469482
Epoch: 22, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.073 Vali Acc: 0.985 Test Loss: 0.073 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 4.463846921920776
Epoch: 23, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.078 Vali Acc: 0.985 Test Loss: 0.078 Test Acc: 0.985
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.7541825771331787
Epoch: 24, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.099 Vali Acc: 0.982 Test Loss: 0.099 Test Acc: 0.982
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.629894733428955
Epoch: 25, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 4.235475301742554
Epoch: 26, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.079 Vali Acc: 0.988 Test Loss: 0.079 Test Acc: 0.988
Validation loss decreased (-0.988161 --> -0.988161).  Saving model ...
Epoch: 27 cost time: 4.337908744812012
Epoch: 27, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.177 Vali Acc: 0.971 Test Loss: 0.177 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.927013397216797
Epoch: 28, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.131 Vali Acc: 0.981 Test Loss: 0.131 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.504742383956909
Epoch: 29, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.092 Vali Acc: 0.986 Test Loss: 0.092 Test Acc: 0.986
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.794990062713623
Epoch: 30, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 4.634021520614624
Epoch: 31, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.145 Vali Acc: 0.975 Test Loss: 0.145 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 4.653842926025391
Epoch: 32, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.055 Vali Acc: 0.987 Test Loss: 0.055 Test Acc: 0.987
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 4.658350467681885
Epoch: 33, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 5.541842937469482
Epoch: 34, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.076 Vali Acc: 0.984 Test Loss: 0.076 Test Acc: 0.984
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 4.935098886489868
Epoch: 35, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.134 Vali Acc: 0.978 Test Loss: 0.134 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 3.800637722015381
Epoch: 36, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.113 Vali Acc: 0.974 Test Loss: 0.113 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps19_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9881615598885793
model parameter : 614164
model size : 2.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps28_str14_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.333871126174927
Epoch: 1, Steps: 89 | Train Loss: 2.512 Vali Loss: 1.587 Vali Acc: 0.695 Test Loss: 1.587 Test Acc: 0.695
Validation loss decreased (inf --> -0.694970).  Saving model ...
Epoch: 2 cost time: 4.3710901737213135
Epoch: 2, Steps: 89 | Train Loss: 0.856 Vali Loss: 0.455 Vali Acc: 0.885 Test Loss: 0.455 Test Acc: 0.885
Validation loss decreased (-0.694970 --> -0.885093).  Saving model ...
Epoch: 3 cost time: 3.954106092453003
Epoch: 3, Steps: 89 | Train Loss: 0.296 Vali Loss: 0.191 Vali Acc: 0.958 Test Loss: 0.191 Test Acc: 0.958
Validation loss decreased (-0.885093 --> -0.957519).  Saving model ...
Epoch: 4 cost time: 3.977426528930664
Epoch: 4, Steps: 89 | Train Loss: 0.148 Vali Loss: 0.134 Vali Acc: 0.974 Test Loss: 0.134 Test Acc: 0.974
Validation loss decreased (-0.957519 --> -0.973536).  Saving model ...
Epoch: 5 cost time: 4.873789072036743
Epoch: 5, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.087 Vali Acc: 0.982 Test Loss: 0.087 Test Acc: 0.982
Validation loss decreased (-0.973536 --> -0.981893).  Saving model ...
Epoch: 6 cost time: 4.611931800842285
Epoch: 6, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.075 Vali Acc: 0.981 Test Loss: 0.075 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.302222013473511
Epoch: 7, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
Validation loss decreased (-0.981893 --> -0.982590).  Saving model ...
Epoch: 8 cost time: 4.750166177749634
Epoch: 8, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.1033780574798584
Epoch: 9, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.078 Vali Acc: 0.978 Test Loss: 0.078 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.120100736618042
Epoch: 10, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.061 Vali Acc: 0.983 Test Loss: 0.061 Test Acc: 0.983
Validation loss decreased (-0.982590 --> -0.983286).  Saving model ...
Epoch: 11 cost time: 5.100409984588623
Epoch: 11, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.064 Vali Acc: 0.986 Test Loss: 0.064 Test Acc: 0.986
Validation loss decreased (-0.983286 --> -0.986072).  Saving model ...
Epoch: 12 cost time: 5.071877717971802
Epoch: 12, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.129808187484741
Epoch: 13, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.101 Vali Acc: 0.979 Test Loss: 0.101 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.737140655517578
Epoch: 14, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.059 Vali Acc: 0.985 Test Loss: 0.059 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.334961652755737
Epoch: 15, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.053 Vali Acc: 0.990 Test Loss: 0.053 Test Acc: 0.990
Validation loss decreased (-0.986072 --> -0.989554).  Saving model ...
Epoch: 16 cost time: 3.6232080459594727
Epoch: 16, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.272998094558716
Epoch: 17, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.066 Vali Acc: 0.981 Test Loss: 0.066 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.451148986816406
Epoch: 18, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.082 Vali Acc: 0.981 Test Loss: 0.082 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.707991123199463
Epoch: 19, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.059 Vali Acc: 0.985 Test Loss: 0.059 Test Acc: 0.985
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 4.165059566497803
Epoch: 20, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.049 Vali Acc: 0.989 Test Loss: 0.049 Test Acc: 0.989
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 4.374277353286743
Epoch: 21, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.061 Vali Acc: 0.988 Test Loss: 0.061 Test Acc: 0.988
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 4.19563627243042
Epoch: 22, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.069 Vali Acc: 0.986 Test Loss: 0.069 Test Acc: 0.986
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 4.274060964584351
Epoch: 23, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 3.4553682804107666
Epoch: 24, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.106 Vali Acc: 0.974 Test Loss: 0.106 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 4.327972888946533
Epoch: 25, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.121 Vali Acc: 0.977 Test Loss: 0.121 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps28_str14_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9895543175487466
model parameter : 606772
model size : 2.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps37_str19_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.851781845092773
Epoch: 1, Steps: 89 | Train Loss: 2.552 Vali Loss: 1.736 Vali Acc: 0.609 Test Loss: 1.736 Test Acc: 0.609
Validation loss decreased (inf --> -0.608618).  Saving model ...
Epoch: 2 cost time: 4.599289655685425
Epoch: 2, Steps: 89 | Train Loss: 1.012 Vali Loss: 0.544 Vali Acc: 0.858 Test Loss: 0.544 Test Acc: 0.858
Validation loss decreased (-0.608618 --> -0.857933).  Saving model ...
Epoch: 3 cost time: 4.608200788497925
Epoch: 3, Steps: 89 | Train Loss: 0.354 Vali Loss: 0.231 Vali Acc: 0.948 Test Loss: 0.231 Test Acc: 0.948
Validation loss decreased (-0.857933 --> -0.948466).  Saving model ...
Epoch: 4 cost time: 3.4241130352020264
Epoch: 4, Steps: 89 | Train Loss: 0.158 Vali Loss: 0.145 Vali Acc: 0.969 Test Loss: 0.145 Test Acc: 0.969
Validation loss decreased (-0.948466 --> -0.968662).  Saving model ...
Epoch: 5 cost time: 4.111574649810791
Epoch: 5, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.111 Vali Acc: 0.971 Test Loss: 0.111 Test Acc: 0.971
Validation loss decreased (-0.968662 --> -0.971447).  Saving model ...
Epoch: 6 cost time: 4.316977500915527
Epoch: 6, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.104 Vali Acc: 0.974 Test Loss: 0.104 Test Acc: 0.974
Validation loss decreased (-0.971447 --> -0.974233).  Saving model ...
Epoch: 7 cost time: 4.233281373977661
Epoch: 7, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.103 Vali Acc: 0.971 Test Loss: 0.103 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.204086780548096
Epoch: 8, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.080 Vali Acc: 0.975 Test Loss: 0.080 Test Acc: 0.975
Validation loss decreased (-0.974233 --> -0.974930).  Saving model ...
Epoch: 9 cost time: 4.606050491333008
Epoch: 9, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.069 Vali Acc: 0.985 Test Loss: 0.069 Test Acc: 0.985
Validation loss decreased (-0.974930 --> -0.984679).  Saving model ...
Epoch: 10 cost time: 4.707498550415039
Epoch: 10, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.062 Vali Acc: 0.985 Test Loss: 0.062 Test Acc: 0.985
Validation loss decreased (-0.984679 --> -0.984679).  Saving model ...
Epoch: 11 cost time: 4.084274053573608
Epoch: 11, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.059 Vali Acc: 0.985 Test Loss: 0.059 Test Acc: 0.985
Validation loss decreased (-0.984679 --> -0.985375).  Saving model ...
Epoch: 12 cost time: 4.384273290634155
Epoch: 12, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.072 Vali Acc: 0.981 Test Loss: 0.072 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.339817762374878
Epoch: 13, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.723006010055542
Epoch: 14, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.060 Vali Acc: 0.988 Test Loss: 0.060 Test Acc: 0.988
Validation loss decreased (-0.985375 --> -0.988161).  Saving model ...
Epoch: 15 cost time: 4.189676284790039
Epoch: 15, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.673966884613037
Epoch: 16, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.112 Vali Acc: 0.971 Test Loss: 0.112 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.817495346069336
Epoch: 17, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.078 Vali Acc: 0.981 Test Loss: 0.078 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.0116403102874756
Epoch: 18, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.092 Vali Acc: 0.976 Test Loss: 0.092 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 4.505466461181641
Epoch: 19, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.067 Vali Acc: 0.987 Test Loss: 0.067 Test Acc: 0.987
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 4.353470087051392
Epoch: 20, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.110 Vali Acc: 0.978 Test Loss: 0.110 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.8653364181518555
Epoch: 21, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.100 Vali Acc: 0.974 Test Loss: 0.100 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 4.545069217681885
Epoch: 22, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.104 Vali Acc: 0.976 Test Loss: 0.104 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 4.523174524307251
Epoch: 23, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 4.069098472595215
Epoch: 24, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.073 Vali Acc: 0.985 Test Loss: 0.073 Test Acc: 0.985
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps37_str19_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9881615598885793
model parameter : 599380
model size : 2.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps46_str23_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.692912817001343
Epoch: 1, Steps: 89 | Train Loss: 2.543 Vali Loss: 1.784 Vali Acc: 0.612 Test Loss: 1.784 Test Acc: 0.612
Validation loss decreased (inf --> -0.612099).  Saving model ...
Epoch: 2 cost time: 4.463096857070923
Epoch: 2, Steps: 89 | Train Loss: 1.092 Vali Loss: 0.606 Vali Acc: 0.868 Test Loss: 0.606 Test Acc: 0.868
Validation loss decreased (-0.612099 --> -0.867682).  Saving model ...
Epoch: 3 cost time: 3.663585901260376
Epoch: 3, Steps: 89 | Train Loss: 0.407 Vali Loss: 0.273 Vali Acc: 0.932 Test Loss: 0.273 Test Acc: 0.932
Validation loss decreased (-0.867682 --> -0.931752).  Saving model ...
Epoch: 4 cost time: 3.9868948459625244
Epoch: 4, Steps: 89 | Train Loss: 0.196 Vali Loss: 0.146 Vali Acc: 0.964 Test Loss: 0.146 Test Acc: 0.964
Validation loss decreased (-0.931752 --> -0.964483).  Saving model ...
Epoch: 5 cost time: 4.400091648101807
Epoch: 5, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.115 Vali Acc: 0.970 Test Loss: 0.115 Test Acc: 0.970
Validation loss decreased (-0.964483 --> -0.970055).  Saving model ...
Epoch: 6 cost time: 3.2323739528656006
Epoch: 6, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.083 Vali Acc: 0.981 Test Loss: 0.083 Test Acc: 0.981
Validation loss decreased (-0.970055 --> -0.980501).  Saving model ...
Epoch: 7 cost time: 3.37532114982605
Epoch: 7, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.980501 --> -0.982590).  Saving model ...
Epoch: 8 cost time: 4.083497762680054
Epoch: 8, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.090 Vali Acc: 0.975 Test Loss: 0.090 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.167710781097412
Epoch: 9, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.099 Vali Acc: 0.974 Test Loss: 0.099 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.6868786811828613
Epoch: 10, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.056 Vali Acc: 0.986 Test Loss: 0.056 Test Acc: 0.986
Validation loss decreased (-0.982590 --> -0.986072).  Saving model ...
Epoch: 11 cost time: 4.33418607711792
Epoch: 11, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.082 Vali Acc: 0.974 Test Loss: 0.082 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.170721769332886
Epoch: 12, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.930330753326416
Epoch: 13, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.078 Vali Acc: 0.981 Test Loss: 0.078 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.574721097946167
Epoch: 14, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.059 Vali Acc: 0.984 Test Loss: 0.059 Test Acc: 0.984
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.4879257678985596
Epoch: 15, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.063 Vali Acc: 0.984 Test Loss: 0.063 Test Acc: 0.984
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.006575584411621
Epoch: 16, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.071 Vali Acc: 0.981 Test Loss: 0.071 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.769575834274292
Epoch: 17, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.065 Vali Acc: 0.981 Test Loss: 0.065 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 4.088595151901245
Epoch: 18, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.128 Vali Acc: 0.971 Test Loss: 0.128 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.8868649005889893
Epoch: 19, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.110 Vali Acc: 0.971 Test Loss: 0.110 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.6648879051208496
Epoch: 20, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.061 Vali Acc: 0.983 Test Loss: 0.061 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr4_ps46_str23_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9860724233983287
model parameter : 591988
model size : 2.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.538944244384766
Epoch: 1, Steps: 89 | Train Loss: 1.839 Vali Loss: 0.542 Vali Acc: 0.865 Test Loss: 0.542 Test Acc: 0.865
Validation loss decreased (inf --> -0.864897).  Saving model ...
Epoch: 2 cost time: 3.8968358039855957
Epoch: 2, Steps: 89 | Train Loss: 0.315 Vali Loss: 0.226 Vali Acc: 0.932 Test Loss: 0.226 Test Acc: 0.932
Validation loss decreased (-0.864897 --> -0.931753).  Saving model ...
Epoch: 3 cost time: 3.2671329975128174
Epoch: 3, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.152 Vali Acc: 0.959 Test Loss: 0.152 Test Acc: 0.959
Validation loss decreased (-0.931753 --> -0.958912).  Saving model ...
Epoch: 4 cost time: 3.2054691314697266
Epoch: 4, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
Validation loss decreased (-0.958912 --> -0.976322).  Saving model ...
Epoch: 5 cost time: 4.224266052246094
Epoch: 5, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.105 Vali Acc: 0.974 Test Loss: 0.105 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.272557258605957
Epoch: 6, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.115 Vali Acc: 0.970 Test Loss: 0.115 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.959913969039917
Epoch: 7, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.067 Vali Acc: 0.985 Test Loss: 0.067 Test Acc: 0.985
Validation loss decreased (-0.976322 --> -0.984679).  Saving model ...
Epoch: 8 cost time: 4.798626899719238
Epoch: 8, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.6937625408172607
Epoch: 9, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.077 Vali Acc: 0.985 Test Loss: 0.077 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.780689001083374
Epoch: 10, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.143 Vali Acc: 0.964 Test Loss: 0.143 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.175612211227417
Epoch: 11, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.101 Vali Acc: 0.981 Test Loss: 0.101 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.389691352844238
Epoch: 12, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.187 Vali Acc: 0.967 Test Loss: 0.187 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.614654541015625
Epoch: 13, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.125 Vali Acc: 0.975 Test Loss: 0.125 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.6374306678771973
Epoch: 14, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.164 Vali Acc: 0.973 Test Loss: 0.164 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.5357820987701416
Epoch: 15, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.139 Vali Acc: 0.983 Test Loss: 0.139 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.949263095855713
Epoch: 16, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.158 Vali Acc: 0.971 Test Loss: 0.158 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 4.03442645072937
Epoch: 17, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9846796657381616
model parameter : 687828
model size : 2.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.489560127258301
Epoch: 1, Steps: 89 | Train Loss: 2.150 Vali Loss: 0.835 Vali Acc: 0.792 Test Loss: 0.835 Test Acc: 0.792
Validation loss decreased (inf --> -0.792471).  Saving model ...
Epoch: 2 cost time: 4.5676422119140625
Epoch: 2, Steps: 89 | Train Loss: 0.469 Vali Loss: 0.267 Vali Acc: 0.932 Test Loss: 0.267 Test Acc: 0.932
Validation loss decreased (-0.792471 --> -0.931752).  Saving model ...
Epoch: 3 cost time: 4.211319923400879
Epoch: 3, Steps: 89 | Train Loss: 0.158 Vali Loss: 0.130 Vali Acc: 0.970 Test Loss: 0.130 Test Acc: 0.970
Validation loss decreased (-0.931752 --> -0.970054).  Saving model ...
Epoch: 4 cost time: 4.128858327865601
Epoch: 4, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.111 Vali Acc: 0.971 Test Loss: 0.111 Test Acc: 0.971
Validation loss decreased (-0.970054 --> -0.970751).  Saving model ...
Epoch: 5 cost time: 3.3757882118225098
Epoch: 5, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.077 Vali Acc: 0.981 Test Loss: 0.077 Test Acc: 0.981
Validation loss decreased (-0.970751 --> -0.981197).  Saving model ...
Epoch: 6 cost time: 3.35927414894104
Epoch: 6, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.513339042663574
Epoch: 7, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.082 Vali Acc: 0.978 Test Loss: 0.082 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.592260837554932
Epoch: 8, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.059 Vali Acc: 0.985 Test Loss: 0.059 Test Acc: 0.985
Validation loss decreased (-0.981197 --> -0.984679).  Saving model ...
Epoch: 9 cost time: 3.7594728469848633
Epoch: 9, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.134 Vali Acc: 0.965 Test Loss: 0.134 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.733968496322632
Epoch: 10, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.060 Vali Acc: 0.985 Test Loss: 0.060 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.7718021869659424
Epoch: 11, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.135916471481323
Epoch: 12, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.118 Vali Acc: 0.976 Test Loss: 0.118 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.1030027866363525
Epoch: 13, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.101 Vali Acc: 0.982 Test Loss: 0.101 Test Acc: 0.982
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.1105735301971436
Epoch: 14, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.130 Vali Acc: 0.974 Test Loss: 0.130 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.93913197517395
Epoch: 15, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.223 Vali Acc: 0.960 Test Loss: 0.223 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.218454360961914
Epoch: 16, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.125555515289307
Epoch: 17, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 4.0136189460754395
Epoch: 18, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.116 Vali Acc: 0.976 Test Loss: 0.116 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9846796657381616
model parameter : 641908
model size : 2.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps14_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.916253566741943
Epoch: 1, Steps: 89 | Train Loss: 2.189 Vali Loss: 0.978 Vali Acc: 0.791 Test Loss: 0.978 Test Acc: 0.791
Validation loss decreased (inf --> -0.791077).  Saving model ...
Epoch: 2 cost time: 3.7750561237335205
Epoch: 2, Steps: 89 | Train Loss: 0.508 Vali Loss: 0.293 Vali Acc: 0.923 Test Loss: 0.293 Test Acc: 0.923
Validation loss decreased (-0.791077 --> -0.923395).  Saving model ...
Epoch: 3 cost time: 4.385199785232544
Epoch: 3, Steps: 89 | Train Loss: 0.204 Vali Loss: 0.149 Vali Acc: 0.963 Test Loss: 0.149 Test Acc: 0.963
Validation loss decreased (-0.923395 --> -0.963090).  Saving model ...
Epoch: 4 cost time: 3.976830244064331
Epoch: 4, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.130 Vali Acc: 0.964 Test Loss: 0.130 Test Acc: 0.964
Validation loss decreased (-0.963090 --> -0.964483).  Saving model ...
Epoch: 5 cost time: 4.530102014541626
Epoch: 5, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.102 Vali Acc: 0.974 Test Loss: 0.102 Test Acc: 0.974
Validation loss decreased (-0.964483 --> -0.973537).  Saving model ...
Epoch: 6 cost time: 4.148730516433716
Epoch: 6, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.066 Vali Acc: 0.984 Test Loss: 0.066 Test Acc: 0.984
Validation loss decreased (-0.973537 --> -0.983983).  Saving model ...
Epoch: 7 cost time: 4.5344860553741455
Epoch: 7, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.061 Vali Acc: 0.986 Test Loss: 0.061 Test Acc: 0.986
Validation loss decreased (-0.983983 --> -0.986072).  Saving model ...
Epoch: 8 cost time: 4.552890777587891
Epoch: 8, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.063 Vali Acc: 0.987 Test Loss: 0.063 Test Acc: 0.987
Validation loss decreased (-0.986072 --> -0.986768).  Saving model ...
Epoch: 9 cost time: 3.777944564819336
Epoch: 9, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.056 Vali Acc: 0.985 Test Loss: 0.056 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.9370245933532715
Epoch: 10, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.063 Vali Acc: 0.981 Test Loss: 0.063 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.34552788734436
Epoch: 11, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.051 Vali Acc: 0.986 Test Loss: 0.051 Test Acc: 0.986
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.223819255828857
Epoch: 12, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.061 Vali Acc: 0.985 Test Loss: 0.061 Test Acc: 0.985
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.211567401885986
Epoch: 13, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.172 Vali Acc: 0.965 Test Loss: 0.172 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.67591118812561
Epoch: 14, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.094 Vali Acc: 0.982 Test Loss: 0.094 Test Acc: 0.982
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.181488037109375
Epoch: 15, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.093 Vali Acc: 0.981 Test Loss: 0.093 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.366141319274902
Epoch: 16, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.134 Vali Acc: 0.975 Test Loss: 0.134 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.531811475753784
Epoch: 17, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.112 Vali Acc: 0.975 Test Loss: 0.112 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 4.729050874710083
Epoch: 18, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps14_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9867688022284122
model parameter : 626676
model size : 2.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps19_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.587065935134888
Epoch: 1, Steps: 89 | Train Loss: 2.396 Vali Loss: 1.307 Vali Acc: 0.780 Test Loss: 1.307 Test Acc: 0.780
Validation loss decreased (inf --> -0.779931).  Saving model ...
Epoch: 2 cost time: 4.301510334014893
Epoch: 2, Steps: 89 | Train Loss: 0.700 Vali Loss: 0.401 Vali Acc: 0.896 Test Loss: 0.401 Test Acc: 0.896
Validation loss decreased (-0.779931 --> -0.896236).  Saving model ...
Epoch: 3 cost time: 3.663119077682495
Epoch: 3, Steps: 89 | Train Loss: 0.250 Vali Loss: 0.193 Vali Acc: 0.951 Test Loss: 0.193 Test Acc: 0.951
Validation loss decreased (-0.896236 --> -0.951252).  Saving model ...
Epoch: 4 cost time: 3.707073211669922
Epoch: 4, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.122 Vali Acc: 0.972 Test Loss: 0.122 Test Acc: 0.972
Validation loss decreased (-0.951252 --> -0.972144).  Saving model ...
Epoch: 5 cost time: 3.561664342880249
Epoch: 5, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.081 Vali Acc: 0.979 Test Loss: 0.081 Test Acc: 0.979
Validation loss decreased (-0.972144 --> -0.979108).  Saving model ...
Epoch: 6 cost time: 3.3159732818603516
Epoch: 6, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.081 Vali Acc: 0.981 Test Loss: 0.081 Test Acc: 0.981
Validation loss decreased (-0.979108 --> -0.980501).  Saving model ...
Epoch: 7 cost time: 3.5642647743225098
Epoch: 7, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.980501 --> -0.982590).  Saving model ...
Epoch: 8 cost time: 4.110767602920532
Epoch: 8, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.054 Vali Acc: 0.987 Test Loss: 0.054 Test Acc: 0.987
Validation loss decreased (-0.982590 --> -0.987465).  Saving model ...
Epoch: 9 cost time: 4.449692964553833
Epoch: 9, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.052 Vali Acc: 0.987 Test Loss: 0.052 Test Acc: 0.987
Validation loss decreased (-0.987465 --> -0.987465).  Saving model ...
Epoch: 10 cost time: 4.313804626464844
Epoch: 10, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.106 Vali Acc: 0.974 Test Loss: 0.106 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.491525173187256
Epoch: 11, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.095 Vali Acc: 0.975 Test Loss: 0.095 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.1714184284210205
Epoch: 12, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.069 Vali Acc: 0.985 Test Loss: 0.069 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.5389182567596436
Epoch: 13, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.088 Vali Acc: 0.981 Test Loss: 0.088 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.6532914638519287
Epoch: 14, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.073 Vali Acc: 0.985 Test Loss: 0.073 Test Acc: 0.985
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.565669536590576
Epoch: 15, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.134 Vali Acc: 0.971 Test Loss: 0.134 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.17080545425415
Epoch: 16, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.071 Vali Acc: 0.984 Test Loss: 0.071 Test Acc: 0.984
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.7033371925354
Epoch: 17, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.076 Vali Acc: 0.984 Test Loss: 0.076 Test Acc: 0.984
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.6927223205566406
Epoch: 18, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.429290533065796
Epoch: 19, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.134 Vali Acc: 0.976 Test Loss: 0.134 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps19_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9874651810584958
model parameter : 611476
model size : 2.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps28_str14_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.8051347732543945
Epoch: 1, Steps: 89 | Train Loss: 2.463 Vali Loss: 1.495 Vali Acc: 0.723 Test Loss: 1.495 Test Acc: 0.723
Validation loss decreased (inf --> -0.722826).  Saving model ...
Epoch: 2 cost time: 4.690528869628906
Epoch: 2, Steps: 89 | Train Loss: 0.846 Vali Loss: 0.454 Vali Acc: 0.884 Test Loss: 0.454 Test Acc: 0.884
Validation loss decreased (-0.722826 --> -0.884397).  Saving model ...
Epoch: 3 cost time: 3.9485952854156494
Epoch: 3, Steps: 89 | Train Loss: 0.298 Vali Loss: 0.200 Vali Acc: 0.953 Test Loss: 0.200 Test Acc: 0.953
Validation loss decreased (-0.884397 --> -0.952644).  Saving model ...
Epoch: 4 cost time: 4.093769550323486
Epoch: 4, Steps: 89 | Train Loss: 0.137 Vali Loss: 0.132 Vali Acc: 0.969 Test Loss: 0.132 Test Acc: 0.969
Validation loss decreased (-0.952644 --> -0.969358).  Saving model ...
Epoch: 5 cost time: 4.305675506591797
Epoch: 5, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.130 Vali Acc: 0.960 Test Loss: 0.130 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.76567530632019
Epoch: 6, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.081 Vali Acc: 0.981 Test Loss: 0.081 Test Acc: 0.981
Validation loss decreased (-0.969358 --> -0.980501).  Saving model ...
Epoch: 7 cost time: 3.856027841567993
Epoch: 7, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.073 Vali Acc: 0.981 Test Loss: 0.073 Test Acc: 0.981
Validation loss decreased (-0.980501 --> -0.980501).  Saving model ...
Epoch: 8 cost time: 4.24983024597168
Epoch: 8, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.4850566387176514
Epoch: 9, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.128 Vali Acc: 0.964 Test Loss: 0.128 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.9401605129241943
Epoch: 10, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.069 Vali Acc: 0.981 Test Loss: 0.069 Test Acc: 0.981
Validation loss decreased (-0.980501 --> -0.981197).  Saving model ...
Epoch: 11 cost time: 4.468281507492065
Epoch: 11, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.054 Vali Acc: 0.985 Test Loss: 0.054 Test Acc: 0.985
Validation loss decreased (-0.981197 --> -0.985376).  Saving model ...
Epoch: 12 cost time: 4.024446964263916
Epoch: 12, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.061 Vali Acc: 0.986 Test Loss: 0.061 Test Acc: 0.986
Validation loss decreased (-0.985376 --> -0.986072).  Saving model ...
Epoch: 13 cost time: 4.337138414382935
Epoch: 13, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.075 Vali Acc: 0.979 Test Loss: 0.075 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.968362331390381
Epoch: 14, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.069 Vali Acc: 0.984 Test Loss: 0.069 Test Acc: 0.984
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.646071195602417
Epoch: 15, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.064 Vali Acc: 0.986 Test Loss: 0.064 Test Acc: 0.986
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.8416690826416016
Epoch: 16, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.090 Vali Acc: 0.978 Test Loss: 0.090 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.263898849487305
Epoch: 17, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.324420213699341
Epoch: 18, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.100 Vali Acc: 0.979 Test Loss: 0.100 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.059582710266113
Epoch: 19, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.091 Vali Acc: 0.978 Test Loss: 0.091 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 4.039263010025024
Epoch: 20, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.075 Vali Acc: 0.986 Test Loss: 0.075 Test Acc: 0.986
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 4.526338577270508
Epoch: 21, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.075 Vali Acc: 0.984 Test Loss: 0.075 Test Acc: 0.984
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.748673677444458
Epoch: 22, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.071 Vali Acc: 0.985 Test Loss: 0.071 Test Acc: 0.985
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps28_str14_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9860724233983287
model parameter : 604084
model size : 2.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps37_str19_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.76242470741272
Epoch: 1, Steps: 89 | Train Loss: 2.556 Vali Loss: 1.765 Vali Acc: 0.657 Test Loss: 1.765 Test Acc: 0.657
Validation loss decreased (inf --> -0.657364).  Saving model ...
Epoch: 2 cost time: 4.009525775909424
Epoch: 2, Steps: 89 | Train Loss: 1.037 Vali Loss: 0.518 Vali Acc: 0.879 Test Loss: 0.518 Test Acc: 0.879
Validation loss decreased (-0.657364 --> -0.878825).  Saving model ...
Epoch: 3 cost time: 3.531040906906128
Epoch: 3, Steps: 89 | Train Loss: 0.345 Vali Loss: 0.226 Vali Acc: 0.943 Test Loss: 0.226 Test Acc: 0.943
Validation loss decreased (-0.878825 --> -0.942895).  Saving model ...
Epoch: 4 cost time: 4.532980918884277
Epoch: 4, Steps: 89 | Train Loss: 0.171 Vali Loss: 0.139 Vali Acc: 0.966 Test Loss: 0.139 Test Acc: 0.966
Validation loss decreased (-0.942895 --> -0.965876).  Saving model ...
Epoch: 5 cost time: 4.824485540390015
Epoch: 5, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.121 Vali Acc: 0.960 Test Loss: 0.121 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.2497239112854
Epoch: 6, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.101 Vali Acc: 0.971 Test Loss: 0.101 Test Acc: 0.971
Validation loss decreased (-0.965876 --> -0.970751).  Saving model ...
Epoch: 7 cost time: 5.042385101318359
Epoch: 7, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.071 Vali Acc: 0.981 Test Loss: 0.071 Test Acc: 0.981
Validation loss decreased (-0.970751 --> -0.980501).  Saving model ...
Epoch: 8 cost time: 3.8339133262634277
Epoch: 8, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.8540005683898926
Epoch: 9, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.550223112106323
Epoch: 10, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.077 Vali Acc: 0.981 Test Loss: 0.077 Test Acc: 0.981
Validation loss decreased (-0.980501 --> -0.981197).  Saving model ...
Epoch: 11 cost time: 4.396685361862183
Epoch: 11, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.080 Vali Acc: 0.978 Test Loss: 0.080 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.8156654834747314
Epoch: 12, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.076 Vali Acc: 0.979 Test Loss: 0.076 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.971611261367798
Epoch: 13, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.630800247192383
Epoch: 14, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.094 Vali Acc: 0.978 Test Loss: 0.094 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.8907718658447266
Epoch: 15, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.078 Vali Acc: 0.981 Test Loss: 0.078 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.392422199249268
Epoch: 16, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.086 Vali Acc: 0.979 Test Loss: 0.086 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.368453502655029
Epoch: 17, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
Validation loss decreased (-0.981197 --> -0.983286).  Saving model ...
Epoch: 18 cost time: 3.5700178146362305
Epoch: 18, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.6226277351379395
Epoch: 19, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.079 Vali Acc: 0.978 Test Loss: 0.079 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.6707139015197754
Epoch: 20, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 4.0763840675354
Epoch: 21, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.088 Vali Acc: 0.979 Test Loss: 0.088 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 4.047632217407227
Epoch: 22, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 4.0253119468688965
Epoch: 23, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 4.531092405319214
Epoch: 24, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.066 Vali Acc: 0.987 Test Loss: 0.066 Test Acc: 0.987
Validation loss decreased (-0.983286 --> -0.986768).  Saving model ...
Epoch: 25 cost time: 5.21233344078064
Epoch: 25, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.110 Vali Acc: 0.978 Test Loss: 0.110 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 4.848791599273682
Epoch: 26, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.104 Vali Acc: 0.972 Test Loss: 0.104 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 4.542665481567383
Epoch: 27, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.169 Vali Acc: 0.953 Test Loss: 0.169 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 4.739489316940308
Epoch: 28, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.094 Vali Acc: 0.981 Test Loss: 0.094 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 5.284032344818115
Epoch: 29, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.109 Vali Acc: 0.978 Test Loss: 0.109 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 4.123805522918701
Epoch: 30, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.109 Vali Acc: 0.976 Test Loss: 0.109 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 4.974661588668823
Epoch: 31, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.078 Vali Acc: 0.984 Test Loss: 0.078 Test Acc: 0.984
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 5.47754979133606
Epoch: 32, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.079 Vali Acc: 0.985 Test Loss: 0.079 Test Acc: 0.985
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 4.2635252475738525
Epoch: 33, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.139 Vali Acc: 0.977 Test Loss: 0.139 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 4.739917278289795
Epoch: 34, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.074 Vali Acc: 0.986 Test Loss: 0.074 Test Acc: 0.986
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps37_str19_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9867688022284122
model parameter : 596692
model size : 2.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps46_str23_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.565661191940308
Epoch: 1, Steps: 89 | Train Loss: 2.564 Vali Loss: 1.758 Vali Acc: 0.680 Test Loss: 1.758 Test Acc: 0.680
Validation loss decreased (inf --> -0.680345).  Saving model ...
Epoch: 2 cost time: 4.2420570850372314
Epoch: 2, Steps: 89 | Train Loss: 1.058 Vali Loss: 0.563 Vali Acc: 0.875 Test Loss: 0.563 Test Acc: 0.875
Validation loss decreased (-0.680345 --> -0.875343).  Saving model ...
Epoch: 3 cost time: 4.428351163864136
Epoch: 3, Steps: 89 | Train Loss: 0.393 Vali Loss: 0.252 Vali Acc: 0.941 Test Loss: 0.252 Test Acc: 0.941
Validation loss decreased (-0.875343 --> -0.940805).  Saving model ...
Epoch: 4 cost time: 3.3651123046875
Epoch: 4, Steps: 89 | Train Loss: 0.198 Vali Loss: 0.159 Vali Acc: 0.966 Test Loss: 0.159 Test Acc: 0.966
Validation loss decreased (-0.940805 --> -0.965876).  Saving model ...
Epoch: 5 cost time: 3.624211072921753
Epoch: 5, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.125 Vali Acc: 0.971 Test Loss: 0.125 Test Acc: 0.971
Validation loss decreased (-0.965876 --> -0.971447).  Saving model ...
Epoch: 6 cost time: 4.5603673458099365
Epoch: 6, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.087 Vali Acc: 0.979 Test Loss: 0.087 Test Acc: 0.979
Validation loss decreased (-0.971447 --> -0.979108).  Saving model ...
Epoch: 7 cost time: 4.650633335113525
Epoch: 7, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.116 Vali Acc: 0.971 Test Loss: 0.116 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.6097254753112793
Epoch: 8, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.094 Vali Acc: 0.974 Test Loss: 0.094 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.214592695236206
Epoch: 9, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
Validation loss decreased (-0.979108 --> -0.982590).  Saving model ...
Epoch: 10 cost time: 4.427856922149658
Epoch: 10, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.094 Vali Acc: 0.978 Test Loss: 0.094 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.8906848430633545
Epoch: 11, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.067 Vali Acc: 0.981 Test Loss: 0.067 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.2839128971099854
Epoch: 12, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.078 Vali Acc: 0.976 Test Loss: 0.078 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.681619644165039
Epoch: 13, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.070 Vali Acc: 0.979 Test Loss: 0.070 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.174588441848755
Epoch: 14, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.063 Vali Acc: 0.985 Test Loss: 0.063 Test Acc: 0.985
Validation loss decreased (-0.982590 --> -0.984679).  Saving model ...
Epoch: 15 cost time: 3.395549774169922
Epoch: 15, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.057 Vali Acc: 0.985 Test Loss: 0.057 Test Acc: 0.985
Validation loss decreased (-0.984679 --> -0.984679).  Saving model ...
Epoch: 16 cost time: 3.7550387382507324
Epoch: 16, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.068 Vali Acc: 0.981 Test Loss: 0.068 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.005709171295166
Epoch: 17, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.082 Vali Acc: 0.981 Test Loss: 0.082 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.141127109527588
Epoch: 18, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.110 Vali Acc: 0.974 Test Loss: 0.110 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.976583957672119
Epoch: 19, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.086 Vali Acc: 0.981 Test Loss: 0.086 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.9796197414398193
Epoch: 20, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.143 Vali Acc: 0.971 Test Loss: 0.143 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.5465338230133057
Epoch: 21, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.114 Vali Acc: 0.969 Test Loss: 0.114 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.764713764190674
Epoch: 22, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.089 Vali Acc: 0.982 Test Loss: 0.089 Test Acc: 0.982
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.8165032863616943
Epoch: 23, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.095 Vali Acc: 0.978 Test Loss: 0.095 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 3.8646984100341797
Epoch: 24, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.103 Vali Acc: 0.978 Test Loss: 0.103 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 3.7604317665100098
Epoch: 25, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr4_ps46_str23_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9846796657381616
model parameter : 589300
model size : 2.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.40598726272583
Epoch: 1, Steps: 89 | Train Loss: 1.156 Vali Loss: 0.306 Vali Acc: 0.916 Test Loss: 0.306 Test Acc: 0.916
Validation loss decreased (inf --> -0.915735).  Saving model ...
Epoch: 2 cost time: 6.76036524772644
Epoch: 2, Steps: 89 | Train Loss: 0.250 Vali Loss: 0.228 Vali Acc: 0.944 Test Loss: 0.228 Test Acc: 0.944
Validation loss decreased (-0.915735 --> -0.944287).  Saving model ...
Epoch: 3 cost time: 5.467426776885986
Epoch: 3, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.192 Vali Acc: 0.948 Test Loss: 0.192 Test Acc: 0.948
Validation loss decreased (-0.944287 --> -0.948466).  Saving model ...
Epoch: 4 cost time: 4.292300462722778
Epoch: 4, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.230 Vali Acc: 0.951 Test Loss: 0.230 Test Acc: 0.951
Validation loss decreased (-0.948466 --> -0.951251).  Saving model ...
Epoch: 5 cost time: 6.434781074523926
Epoch: 5, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.164 Vali Acc: 0.962 Test Loss: 0.164 Test Acc: 0.962
Validation loss decreased (-0.951251 --> -0.961698).  Saving model ...
Epoch: 6 cost time: 5.991550922393799
Epoch: 6, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.219 Vali Acc: 0.962 Test Loss: 0.219 Test Acc: 0.962
Validation loss decreased (-0.961698 --> -0.962393).  Saving model ...
Epoch: 7 cost time: 6.859225273132324
Epoch: 7, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.123 Vali Acc: 0.978 Test Loss: 0.123 Test Acc: 0.978
Validation loss decreased (-0.962393 --> -0.977715).  Saving model ...
Epoch: 8 cost time: 5.54746150970459
Epoch: 8, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.398 Vali Acc: 0.939 Test Loss: 0.398 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.448476314544678
Epoch: 9, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.488 Vali Acc: 0.937 Test Loss: 0.488 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.092411279678345
Epoch: 10, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.213 Vali Acc: 0.971 Test Loss: 0.213 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.9497761726379395
Epoch: 11, Steps: 89 | Train Loss: 0.149 Vali Loss: 0.274 Vali Acc: 0.967 Test Loss: 0.274 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.947660684585571
Epoch: 12, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.339 Vali Acc: 0.971 Test Loss: 0.339 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 6.120697736740112
Epoch: 13, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.241 Vali Acc: 0.976 Test Loss: 0.241 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 5.631674766540527
Epoch: 14, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.331 Vali Acc: 0.964 Test Loss: 0.331 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 5.5017125606536865
Epoch: 15, Steps: 89 | Train Loss: 0.128 Vali Loss: 0.435 Vali Acc: 0.967 Test Loss: 0.435 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 6.039096117019653
Epoch: 16, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.455 Vali Acc: 0.964 Test Loss: 0.455 Test Acc: 0.964
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 5.867234706878662
Epoch: 17, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.261 Vali Acc: 0.984 Test Loss: 0.261 Test Acc: 0.984
Validation loss decreased (-0.977715 --> -0.983981).  Saving model ...
Epoch: 18 cost time: 4.68487811088562
Epoch: 18, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.471 Vali Acc: 0.962 Test Loss: 0.471 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.1825127601623535
Epoch: 19, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.426 Vali Acc: 0.965 Test Loss: 0.426 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.319449186325073
Epoch: 20, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.454 Vali Acc: 0.961 Test Loss: 0.454 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 5.362698793411255
Epoch: 21, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.266 Vali Acc: 0.978 Test Loss: 0.266 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 5.3795082569122314
Epoch: 22, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.459 Vali Acc: 0.973 Test Loss: 0.459 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 5.758516073226929
Epoch: 23, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.643 Vali Acc: 0.958 Test Loss: 0.643 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 7.019499778747559
Epoch: 24, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.413 Vali Acc: 0.971 Test Loss: 0.413 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 5.322202205657959
Epoch: 25, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.483 Vali Acc: 0.973 Test Loss: 0.483 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 4.8555052280426025
Epoch: 26, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.394 Vali Acc: 0.983 Test Loss: 0.394 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 3.5650601387023926
Epoch: 27, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.390 Vali Acc: 0.983 Test Loss: 0.390 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.983983286908078
model parameter : 2559252
model size : 9.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.68879771232605
Epoch: 1, Steps: 89 | Train Loss: 1.324 Vali Loss: 0.339 Vali Acc: 0.915 Test Loss: 0.339 Test Acc: 0.915
Validation loss decreased (inf --> -0.915038).  Saving model ...
Epoch: 2 cost time: 4.786499977111816
Epoch: 2, Steps: 89 | Train Loss: 0.204 Vali Loss: 0.136 Vali Acc: 0.962 Test Loss: 0.136 Test Acc: 0.962
Validation loss decreased (-0.915038 --> -0.962394).  Saving model ...
Epoch: 3 cost time: 4.348130941390991
Epoch: 3, Steps: 89 | Train Loss: 0.127 Vali Loss: 0.148 Vali Acc: 0.959 Test Loss: 0.148 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.6371541023254395
Epoch: 4, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.183 Vali Acc: 0.963 Test Loss: 0.183 Test Acc: 0.963
Validation loss decreased (-0.962394 --> -0.963090).  Saving model ...
Epoch: 5 cost time: 5.0128114223480225
Epoch: 5, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.171 Vali Acc: 0.968 Test Loss: 0.171 Test Acc: 0.968
Validation loss decreased (-0.963090 --> -0.967965).  Saving model ...
Epoch: 6 cost time: 5.380648851394653
Epoch: 6, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.151 Vali Acc: 0.973 Test Loss: 0.151 Test Acc: 0.973
Validation loss decreased (-0.967965 --> -0.972840).  Saving model ...
Epoch: 7 cost time: 3.6491541862487793
Epoch: 7, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.220 Vali Acc: 0.960 Test Loss: 0.220 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.4864466190338135
Epoch: 8, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.153 Vali Acc: 0.971 Test Loss: 0.153 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.261775493621826
Epoch: 9, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.163 Vali Acc: 0.974 Test Loss: 0.163 Test Acc: 0.974
Validation loss decreased (-0.972840 --> -0.973536).  Saving model ...
Epoch: 10 cost time: 4.3812103271484375
Epoch: 10, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.128 Vali Acc: 0.983 Test Loss: 0.128 Test Acc: 0.983
Validation loss decreased (-0.973536 --> -0.982589).  Saving model ...
Epoch: 11 cost time: 4.853442668914795
Epoch: 11, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.177 Vali Acc: 0.975 Test Loss: 0.177 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.526640176773071
Epoch: 12, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.396 Vali Acc: 0.953 Test Loss: 0.396 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.7621896266937256
Epoch: 13, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.205 Vali Acc: 0.978 Test Loss: 0.205 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.353287696838379
Epoch: 14, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.198 Vali Acc: 0.969 Test Loss: 0.198 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 5.362117767333984
Epoch: 15, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.272 Vali Acc: 0.969 Test Loss: 0.272 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.64433741569519
Epoch: 16, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.190 Vali Acc: 0.979 Test Loss: 0.190 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.137598276138306
Epoch: 17, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.231 Vali Acc: 0.976 Test Loss: 0.231 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.837813377380371
Epoch: 18, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.382 Vali Acc: 0.960 Test Loss: 0.382 Test Acc: 0.960
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 5.028586149215698
Epoch: 19, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.533 Vali Acc: 0.939 Test Loss: 0.533 Test Acc: 0.939
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 4.9486024379730225
Epoch: 20, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.436 Vali Acc: 0.958 Test Loss: 0.436 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9825905292479109
model parameter : 2375572
model size : 9.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps14_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.717891216278076
Epoch: 1, Steps: 89 | Train Loss: 1.395 Vali Loss: 0.374 Vali Acc: 0.897 Test Loss: 0.374 Test Acc: 0.897
Validation loss decreased (inf --> -0.896932).  Saving model ...
Epoch: 2 cost time: 3.2818539142608643
Epoch: 2, Steps: 89 | Train Loss: 0.221 Vali Loss: 0.163 Vali Acc: 0.957 Test Loss: 0.163 Test Acc: 0.957
Validation loss decreased (-0.896932 --> -0.956823).  Saving model ...
Epoch: 3 cost time: 4.547552824020386
Epoch: 3, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.130 Vali Acc: 0.969 Test Loss: 0.130 Test Acc: 0.969
Validation loss decreased (-0.956823 --> -0.969358).  Saving model ...
Epoch: 4 cost time: 4.058321952819824
Epoch: 4, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.139 Vali Acc: 0.971 Test Loss: 0.139 Test Acc: 0.971
Validation loss decreased (-0.969358 --> -0.970751).  Saving model ...
Epoch: 5 cost time: 4.107419490814209
Epoch: 5, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.089 Vali Acc: 0.979 Test Loss: 0.089 Test Acc: 0.979
Validation loss decreased (-0.970751 --> -0.979108).  Saving model ...
Epoch: 6 cost time: 4.248243093490601
Epoch: 6, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.083 Vali Acc: 0.981 Test Loss: 0.083 Test Acc: 0.981
Validation loss decreased (-0.979108 --> -0.980501).  Saving model ...
Epoch: 7 cost time: 4.417324066162109
Epoch: 7, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.181 Vali Acc: 0.960 Test Loss: 0.181 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.244127035140991
Epoch: 8, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.240 Vali Acc: 0.960 Test Loss: 0.240 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.286486625671387
Epoch: 9, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.143 Vali Acc: 0.973 Test Loss: 0.143 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.492250680923462
Epoch: 10, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.174 Vali Acc: 0.981 Test Loss: 0.174 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.8172199726104736
Epoch: 11, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.237 Vali Acc: 0.960 Test Loss: 0.237 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.077844619750977
Epoch: 12, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.174 Vali Acc: 0.975 Test Loss: 0.174 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.49970269203186
Epoch: 13, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.149 Vali Acc: 0.985 Test Loss: 0.149 Test Acc: 0.985
Validation loss decreased (-0.980501 --> -0.984678).  Saving model ...
Epoch: 14 cost time: 4.106495141983032
Epoch: 14, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.141 Vali Acc: 0.978 Test Loss: 0.141 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.509857416152954
Epoch: 15, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.167 Vali Acc: 0.979 Test Loss: 0.167 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.9212868213653564
Epoch: 16, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.245 Vali Acc: 0.974 Test Loss: 0.245 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.593502998352051
Epoch: 17, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.281 Vali Acc: 0.972 Test Loss: 0.281 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.632338523864746
Epoch: 18, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.207 Vali Acc: 0.981 Test Loss: 0.207 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.2667338848114014
Epoch: 19, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.349 Vali Acc: 0.962 Test Loss: 0.349 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 4.658129453659058
Epoch: 20, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.292 Vali Acc: 0.967 Test Loss: 0.292 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 4.0967583656311035
Epoch: 21, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.194 Vali Acc: 0.983 Test Loss: 0.194 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.7039594650268555
Epoch: 22, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.397 Vali Acc: 0.962 Test Loss: 0.397 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 4.0916619300842285
Epoch: 23, Steps: 89 | Train Loss: 0.126 Vali Loss: 0.369 Vali Acc: 0.964 Test Loss: 0.369 Test Acc: 0.964
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps14_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9846796657381616
model parameter : 2299284
model size : 8.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps19_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.6200642585754395
Epoch: 1, Steps: 89 | Train Loss: 1.544 Vali Loss: 0.407 Vali Acc: 0.884 Test Loss: 0.407 Test Acc: 0.884
Validation loss decreased (inf --> -0.883701).  Saving model ...
Epoch: 2 cost time: 4.733660936355591
Epoch: 2, Steps: 89 | Train Loss: 0.217 Vali Loss: 0.147 Vali Acc: 0.961 Test Loss: 0.147 Test Acc: 0.961
Validation loss decreased (-0.883701 --> -0.961001).  Saving model ...
Epoch: 3 cost time: 4.327121019363403
Epoch: 3, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
Validation loss decreased (-0.961001 --> -0.970055).  Saving model ...
Epoch: 4 cost time: 5.133079767227173
Epoch: 4, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.116 Vali Acc: 0.964 Test Loss: 0.116 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.104896068572998
Epoch: 5, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.078 Vali Acc: 0.978 Test Loss: 0.078 Test Acc: 0.978
Validation loss decreased (-0.970055 --> -0.978411).  Saving model ...
Epoch: 6 cost time: 4.3351874351501465
Epoch: 6, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.102 Vali Acc: 0.972 Test Loss: 0.102 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.264219522476196
Epoch: 7, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.207 Vali Acc: 0.945 Test Loss: 0.207 Test Acc: 0.945
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.563349008560181
Epoch: 8, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.135 Vali Acc: 0.968 Test Loss: 0.135 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.168385982513428
Epoch: 9, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.126 Vali Acc: 0.979 Test Loss: 0.126 Test Acc: 0.979
Validation loss decreased (-0.978411 --> -0.979107).  Saving model ...
Epoch: 10 cost time: 3.9883766174316406
Epoch: 10, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.124 Vali Acc: 0.976 Test Loss: 0.124 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.7196900844573975
Epoch: 11, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.093 Vali Acc: 0.979 Test Loss: 0.093 Test Acc: 0.979
Validation loss decreased (-0.979107 --> -0.979108).  Saving model ...
Epoch: 12 cost time: 4.579814195632935
Epoch: 12, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.118 Vali Acc: 0.983 Test Loss: 0.118 Test Acc: 0.983
Validation loss decreased (-0.979108 --> -0.983286).  Saving model ...
Epoch: 13 cost time: 4.429102659225464
Epoch: 13, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.175 Vali Acc: 0.972 Test Loss: 0.175 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.399795770645142
Epoch: 14, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.234 Vali Acc: 0.962 Test Loss: 0.234 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.85841965675354
Epoch: 15, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.161 Vali Acc: 0.974 Test Loss: 0.161 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.1076061725616455
Epoch: 16, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.161 Vali Acc: 0.979 Test Loss: 0.161 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.289693355560303
Epoch: 17, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.108 Vali Acc: 0.983 Test Loss: 0.108 Test Acc: 0.983
Validation loss decreased (-0.983286 --> -0.983286).  Saving model ...
Epoch: 18 cost time: 4.3437275886535645
Epoch: 18, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.125 Vali Acc: 0.983 Test Loss: 0.125 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.131406784057617
Epoch: 19, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.207 Vali Acc: 0.977 Test Loss: 0.207 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.438679456710815
Epoch: 20, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.172 Vali Acc: 0.972 Test Loss: 0.172 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 4.121044874191284
Epoch: 21, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.280 Vali Acc: 0.958 Test Loss: 0.280 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.551063060760498
Epoch: 22, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.231 Vali Acc: 0.976 Test Loss: 0.231 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 4.250610113143921
Epoch: 23, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.210 Vali Acc: 0.978 Test Loss: 0.210 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 4.34851336479187
Epoch: 24, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.184 Vali Acc: 0.981 Test Loss: 0.184 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 3.65753173828125
Epoch: 25, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.981 Test Loss: 0.194 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 3.7386810779571533
Epoch: 26, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.483 Vali Acc: 0.959 Test Loss: 0.483 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 3.8594534397125244
Epoch: 27, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.231 Vali Acc: 0.972 Test Loss: 0.231 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps19_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9832869080779945
model parameter : 2238484
model size : 8.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps28_str14_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.30581521987915
Epoch: 1, Steps: 89 | Train Loss: 1.680 Vali Loss: 0.480 Vali Acc: 0.878 Test Loss: 0.480 Test Acc: 0.878
Validation loss decreased (inf --> -0.878129).  Saving model ...
Epoch: 2 cost time: 3.370840072631836
Epoch: 2, Steps: 89 | Train Loss: 0.277 Vali Loss: 0.177 Vali Acc: 0.953 Test Loss: 0.177 Test Acc: 0.953
Validation loss decreased (-0.878129 --> -0.953341).  Saving model ...
Epoch: 3 cost time: 3.6912567615509033
Epoch: 3, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.088 Vali Acc: 0.979 Test Loss: 0.088 Test Acc: 0.979
Validation loss decreased (-0.953341 --> -0.979108).  Saving model ...
Epoch: 4 cost time: 3.877622365951538
Epoch: 4, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.065 Vali Acc: 0.982 Test Loss: 0.065 Test Acc: 0.982
Validation loss decreased (-0.979108 --> -0.981894).  Saving model ...
Epoch: 5 cost time: 3.913886785507202
Epoch: 5, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.7807841300964355
Epoch: 6, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.062 Vali Acc: 0.985 Test Loss: 0.062 Test Acc: 0.985
Validation loss decreased (-0.981894 --> -0.984679).  Saving model ...
Epoch: 7 cost time: 3.6700284481048584
Epoch: 7, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.064 Vali Acc: 0.985 Test Loss: 0.064 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.7948005199432373
Epoch: 8, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.104 Vali Acc: 0.974 Test Loss: 0.104 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.217104434967041
Epoch: 9, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.123 Vali Acc: 0.972 Test Loss: 0.123 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.668215751647949
Epoch: 10, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.063 Vali Acc: 0.985 Test Loss: 0.063 Test Acc: 0.985
Validation loss decreased (-0.984679 --> -0.985375).  Saving model ...
Epoch: 11 cost time: 4.282448053359985
Epoch: 11, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.155 Vali Acc: 0.968 Test Loss: 0.155 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.037535190582275
Epoch: 12, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.071 Vali Acc: 0.984 Test Loss: 0.071 Test Acc: 0.984
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.0100626945495605
Epoch: 13, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.144 Vali Acc: 0.971 Test Loss: 0.144 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.5654194355010986
Epoch: 14, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.110 Vali Acc: 0.978 Test Loss: 0.110 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.8215219974517822
Epoch: 15, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.132 Vali Acc: 0.976 Test Loss: 0.132 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.810757637023926
Epoch: 16, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.101 Vali Acc: 0.982 Test Loss: 0.101 Test Acc: 0.982
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.248669862747192
Epoch: 17, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.140 Vali Acc: 0.978 Test Loss: 0.140 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 4.220118999481201
Epoch: 18, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.122 Vali Acc: 0.985 Test Loss: 0.122 Test Acc: 0.985
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 4.07149338722229
Epoch: 19, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.159 Vali Acc: 0.978 Test Loss: 0.159 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.716261148452759
Epoch: 20, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.137 Vali Acc: 0.980 Test Loss: 0.137 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps28_str14_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9853760445682451
model parameter : 2208916
model size : 8.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps37_str19_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.039844751358032
Epoch: 1, Steps: 89 | Train Loss: 1.832 Vali Loss: 0.626 Vali Acc: 0.871 Test Loss: 0.626 Test Acc: 0.871
Validation loss decreased (inf --> -0.871164).  Saving model ...
Epoch: 2 cost time: 4.685538053512573
Epoch: 2, Steps: 89 | Train Loss: 0.340 Vali Loss: 0.227 Vali Acc: 0.935 Test Loss: 0.227 Test Acc: 0.935
Validation loss decreased (-0.871164 --> -0.935234).  Saving model ...
Epoch: 3 cost time: 4.515621900558472
Epoch: 3, Steps: 89 | Train Loss: 0.133 Vali Loss: 0.113 Vali Acc: 0.976 Test Loss: 0.113 Test Acc: 0.976
Validation loss decreased (-0.935234 --> -0.975626).  Saving model ...
Epoch: 4 cost time: 4.046811819076538
Epoch: 4, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.101 Vali Acc: 0.971 Test Loss: 0.101 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.247753381729126
Epoch: 5, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
Validation loss decreased (-0.975626 --> -0.977715).  Saving model ...
Epoch: 6 cost time: 5.319456577301025
Epoch: 6, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.89914870262146
Epoch: 7, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.090 Vali Acc: 0.979 Test Loss: 0.090 Test Acc: 0.979
Validation loss decreased (-0.977715 --> -0.979108).  Saving model ...
Epoch: 8 cost time: 3.6814632415771484
Epoch: 8, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979108 --> -0.979804).  Saving model ...
Epoch: 9 cost time: 3.9334990978240967
Epoch: 9, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.108 Vali Acc: 0.974 Test Loss: 0.108 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.7899656295776367
Epoch: 10, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.242631435394287
Epoch: 11, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.151 Vali Acc: 0.961 Test Loss: 0.151 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.565453052520752
Epoch: 12, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.105 Vali Acc: 0.982 Test Loss: 0.105 Test Acc: 0.982
Validation loss decreased (-0.979804 --> -0.981893).  Saving model ...
Epoch: 13 cost time: 4.100007772445679
Epoch: 13, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.119 Vali Acc: 0.972 Test Loss: 0.119 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.2867653369903564
Epoch: 14, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.204 Vali Acc: 0.959 Test Loss: 0.204 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.374293327331543
Epoch: 15, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.137 Vali Acc: 0.978 Test Loss: 0.137 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.81026291847229
Epoch: 16, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.210 Vali Acc: 0.967 Test Loss: 0.210 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.12007212638855
Epoch: 17, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.215 Vali Acc: 0.967 Test Loss: 0.215 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.212303876876831
Epoch: 18, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.146 Vali Acc: 0.982 Test Loss: 0.146 Test Acc: 0.982
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.4590201377868652
Epoch: 19, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.198 Vali Acc: 0.969 Test Loss: 0.198 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 4.066344976425171
Epoch: 20, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.185 Vali Acc: 0.972 Test Loss: 0.185 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 4.603200912475586
Epoch: 21, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.200 Vali Acc: 0.967 Test Loss: 0.200 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 4.126789569854736
Epoch: 22, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.153 Vali Acc: 0.981 Test Loss: 0.153 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps37_str19_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9818941504178273
model parameter : 2179348
model size : 8.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps46_str23_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.966901540756226
Epoch: 1, Steps: 89 | Train Loss: 1.905 Vali Loss: 0.730 Vali Acc: 0.830 Test Loss: 0.730 Test Acc: 0.830
Validation loss decreased (inf --> -0.830076).  Saving model ...
Epoch: 2 cost time: 3.675219774246216
Epoch: 2, Steps: 89 | Train Loss: 0.395 Vali Loss: 0.207 Vali Acc: 0.948 Test Loss: 0.207 Test Acc: 0.948
Validation loss decreased (-0.830076 --> -0.948466).  Saving model ...
Epoch: 3 cost time: 3.7217137813568115
Epoch: 3, Steps: 89 | Train Loss: 0.134 Vali Loss: 0.125 Vali Acc: 0.967 Test Loss: 0.125 Test Acc: 0.967
Validation loss decreased (-0.948466 --> -0.966573).  Saving model ...
Epoch: 4 cost time: 3.970336437225342
Epoch: 4, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.115 Vali Acc: 0.969 Test Loss: 0.115 Test Acc: 0.969
Validation loss decreased (-0.966573 --> -0.969358).  Saving model ...
Epoch: 5 cost time: 4.222505569458008
Epoch: 5, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.081 Vali Acc: 0.981 Test Loss: 0.081 Test Acc: 0.981
Validation loss decreased (-0.969358 --> -0.980501).  Saving model ...
Epoch: 6 cost time: 4.221368074417114
Epoch: 6, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.087 Vali Acc: 0.973 Test Loss: 0.087 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.280428886413574
Epoch: 7, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.238582372665405
Epoch: 8, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.563288688659668
Epoch: 9, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.070 Vali Acc: 0.981 Test Loss: 0.070 Test Acc: 0.981
Validation loss decreased (-0.980501 --> -0.981197).  Saving model ...
Epoch: 10 cost time: 3.3097684383392334
Epoch: 10, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
Validation loss decreased (-0.981197 --> -0.982590).  Saving model ...
Epoch: 11 cost time: 4.222064018249512
Epoch: 11, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.982590 --> -0.983286).  Saving model ...
Epoch: 12 cost time: 3.9630329608917236
Epoch: 12, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.122 Vali Acc: 0.972 Test Loss: 0.122 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.6539387702941895
Epoch: 13, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.100 Vali Acc: 0.976 Test Loss: 0.100 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.7602579593658447
Epoch: 14, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.277 Vali Acc: 0.937 Test Loss: 0.277 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.7516534328460693
Epoch: 15, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.095 Vali Acc: 0.979 Test Loss: 0.095 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.787257194519043
Epoch: 16, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.156 Vali Acc: 0.969 Test Loss: 0.156 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.221701383590698
Epoch: 17, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.145 Vali Acc: 0.971 Test Loss: 0.145 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 4.168999433517456
Epoch: 18, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.175 Vali Acc: 0.967 Test Loss: 0.175 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.6792333126068115
Epoch: 19, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.161 Vali Acc: 0.970 Test Loss: 0.161 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 4.119142293930054
Epoch: 20, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.144 Vali Acc: 0.979 Test Loss: 0.144 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 4.6344475746154785
Epoch: 21, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.109 Vali Acc: 0.983 Test Loss: 0.109 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr4_ps46_str23_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9832869080779945
model parameter : 2165140
model size : 8.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.7373456954956055
Epoch: 1, Steps: 89 | Train Loss: 1.423 Vali Loss: 0.431 Vali Acc: 0.880 Test Loss: 0.431 Test Acc: 0.880
Validation loss decreased (inf --> -0.879522).  Saving model ...
Epoch: 2 cost time: 2.7754690647125244
Epoch: 2, Steps: 89 | Train Loss: 0.248 Vali Loss: 0.183 Vali Acc: 0.955 Test Loss: 0.183 Test Acc: 0.955
Validation loss decreased (-0.879522 --> -0.954734).  Saving model ...
Epoch: 3 cost time: 4.724543809890747
Epoch: 3, Steps: 89 | Train Loss: 0.121 Vali Loss: 0.115 Vali Acc: 0.974 Test Loss: 0.115 Test Acc: 0.974
Validation loss decreased (-0.954734 --> -0.973536).  Saving model ...
Epoch: 4 cost time: 4.4306042194366455
Epoch: 4, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.145 Vali Acc: 0.968 Test Loss: 0.145 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.154957294464111
Epoch: 5, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.131 Vali Acc: 0.968 Test Loss: 0.131 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.7398204803466797
Epoch: 6, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.132 Vali Acc: 0.974 Test Loss: 0.132 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.196471691131592
Epoch: 7, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.139 Vali Acc: 0.973 Test Loss: 0.139 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.858757257461548
Epoch: 8, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.203 Vali Acc: 0.959 Test Loss: 0.203 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.637380838394165
Epoch: 9, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.152 Vali Acc: 0.978 Test Loss: 0.152 Test Acc: 0.978
Validation loss decreased (-0.973536 --> -0.978411).  Saving model ...
Epoch: 10 cost time: 3.674318552017212
Epoch: 10, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.121 Vali Acc: 0.978 Test Loss: 0.121 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.167059898376465
Epoch: 11, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.159 Vali Acc: 0.970 Test Loss: 0.159 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.7296462059020996
Epoch: 12, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.131 Vali Acc: 0.983 Test Loss: 0.131 Test Acc: 0.983
Validation loss decreased (-0.978411 --> -0.982589).  Saving model ...
Epoch: 13 cost time: 4.579082012176514
Epoch: 13, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.199 Vali Acc: 0.977 Test Loss: 0.199 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.40134596824646
Epoch: 14, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.134 Vali Acc: 0.976 Test Loss: 0.134 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.529344320297241
Epoch: 15, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.201 Vali Acc: 0.966 Test Loss: 0.201 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.3151326179504395
Epoch: 16, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.220 Vali Acc: 0.958 Test Loss: 0.220 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.496405363082886
Epoch: 17, Steps: 89 | Train Loss: 0.122 Vali Loss: 0.255 Vali Acc: 0.968 Test Loss: 0.255 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.32932448387146
Epoch: 18, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.388 Vali Acc: 0.932 Test Loss: 0.388 Test Acc: 0.932
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.490793228149414
Epoch: 19, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.228 Vali Acc: 0.980 Test Loss: 0.228 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.880514621734619
Epoch: 20, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.350 Vali Acc: 0.962 Test Loss: 0.350 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.935340166091919
Epoch: 21, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.296 Vali Acc: 0.969 Test Loss: 0.296 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 4.19134259223938
Epoch: 22, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.373 Vali Acc: 0.967 Test Loss: 0.373 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9825905292479109
model parameter : 771732
model size : 2.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.14060115814209
Epoch: 1, Steps: 89 | Train Loss: 1.731 Vali Loss: 0.458 Vali Acc: 0.894 Test Loss: 0.458 Test Acc: 0.894
Validation loss decreased (inf --> -0.894146).  Saving model ...
Epoch: 2 cost time: 3.7028098106384277
Epoch: 2, Steps: 89 | Train Loss: 0.283 Vali Loss: 0.194 Vali Acc: 0.946 Test Loss: 0.194 Test Acc: 0.946
Validation loss decreased (-0.894146 --> -0.946377).  Saving model ...
Epoch: 3 cost time: 4.112021207809448
Epoch: 3, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.235 Vali Acc: 0.928 Test Loss: 0.235 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.0896897315979
Epoch: 4, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.202 Vali Acc: 0.951 Test Loss: 0.202 Test Acc: 0.951
Validation loss decreased (-0.946377 --> -0.951251).  Saving model ...
Epoch: 5 cost time: 2.8377063274383545
Epoch: 5, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.103 Vali Acc: 0.978 Test Loss: 0.103 Test Acc: 0.978
Validation loss decreased (-0.951251 --> -0.977715).  Saving model ...
Epoch: 6 cost time: 2.6367056369781494
Epoch: 6, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.977715 --> -0.979804).  Saving model ...
Epoch: 7 cost time: 3.235604763031006
Epoch: 7, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.084 Vali Acc: 0.982 Test Loss: 0.084 Test Acc: 0.982
Validation loss decreased (-0.979804 --> -0.981893).  Saving model ...
Epoch: 8 cost time: 3.7951650619506836
Epoch: 8, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
Validation loss decreased (-0.981893 --> -0.983286).  Saving model ...
Epoch: 9 cost time: 3.404883861541748
Epoch: 9, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.100 Vali Acc: 0.976 Test Loss: 0.100 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.312408924102783
Epoch: 10, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.107 Vali Acc: 0.983 Test Loss: 0.107 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.1707332134246826
Epoch: 11, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.177 Vali Acc: 0.967 Test Loss: 0.177 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.3934168815612793
Epoch: 12, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.210 Vali Acc: 0.963 Test Loss: 0.210 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.2720162868499756
Epoch: 13, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.169 Vali Acc: 0.964 Test Loss: 0.169 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.9027931690216064
Epoch: 14, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.157 Vali Acc: 0.976 Test Loss: 0.157 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.525679349899292
Epoch: 15, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.135 Vali Acc: 0.983 Test Loss: 0.135 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.245073080062866
Epoch: 16, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.146 Vali Acc: 0.976 Test Loss: 0.146 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.1171958446502686
Epoch: 17, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.139 Vali Acc: 0.981 Test Loss: 0.139 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.484586000442505
Epoch: 18, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.158 Vali Acc: 0.978 Test Loss: 0.158 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9832869080779945
model parameter : 679892
model size : 2.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps14_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.252993106842041
Epoch: 1, Steps: 89 | Train Loss: 1.758 Vali Loss: 0.580 Vali Acc: 0.852 Test Loss: 0.580 Test Acc: 0.852
Validation loss decreased (inf --> -0.851666).  Saving model ...
Epoch: 2 cost time: 2.948862314224243
Epoch: 2, Steps: 89 | Train Loss: 0.335 Vali Loss: 0.204 Vali Acc: 0.952 Test Loss: 0.204 Test Acc: 0.952
Validation loss decreased (-0.851666 --> -0.951948).  Saving model ...
Epoch: 3 cost time: 3.258035659790039
Epoch: 3, Steps: 89 | Train Loss: 0.131 Vali Loss: 0.133 Vali Acc: 0.962 Test Loss: 0.133 Test Acc: 0.962
Validation loss decreased (-0.951948 --> -0.961698).  Saving model ...
Epoch: 4 cost time: 2.8900272846221924
Epoch: 4, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.126 Vali Acc: 0.960 Test Loss: 0.126 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.3203651905059814
Epoch: 5, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.092 Vali Acc: 0.972 Test Loss: 0.092 Test Acc: 0.972
Validation loss decreased (-0.961698 --> -0.972144).  Saving model ...
Epoch: 6 cost time: 4.068023204803467
Epoch: 6, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.972144 --> -0.979804).  Saving model ...
Epoch: 7 cost time: 3.099518299102783
Epoch: 7, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.090 Vali Acc: 0.978 Test Loss: 0.090 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.6705143451690674
Epoch: 8, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.979804 --> -0.983286).  Saving model ...
Epoch: 9 cost time: 3.959486246109009
Epoch: 9, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.110 Vali Acc: 0.969 Test Loss: 0.110 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.994229555130005
Epoch: 10, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.244 Vali Acc: 0.935 Test Loss: 0.244 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.2442703247070312
Epoch: 11, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.168 Vali Acc: 0.969 Test Loss: 0.168 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.738295793533325
Epoch: 12, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.127 Vali Acc: 0.978 Test Loss: 0.127 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.3567304611206055
Epoch: 13, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.100 Vali Acc: 0.982 Test Loss: 0.100 Test Acc: 0.982
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.9224283695220947
Epoch: 14, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.222 Vali Acc: 0.949 Test Loss: 0.222 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.588911771774292
Epoch: 15, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.190 Vali Acc: 0.963 Test Loss: 0.190 Test Acc: 0.963
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.50404691696167
Epoch: 16, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.119 Vali Acc: 0.984 Test Loss: 0.119 Test Acc: 0.984
Validation loss decreased (-0.983286 --> -0.983982).  Saving model ...
Epoch: 17 cost time: 4.254863262176514
Epoch: 17, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.123 Vali Acc: 0.983 Test Loss: 0.123 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.1259469985961914
Epoch: 18, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.150 Vali Acc: 0.980 Test Loss: 0.150 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.191075563430786
Epoch: 19, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.136 Vali Acc: 0.985 Test Loss: 0.136 Test Acc: 0.985
Validation loss decreased (-0.983982 --> -0.984678).  Saving model ...
Epoch: 20 cost time: 2.7809576988220215
Epoch: 20, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.134 Vali Acc: 0.985 Test Loss: 0.134 Test Acc: 0.985
Validation loss decreased (-0.984678 --> -0.985375).  Saving model ...
Epoch: 21 cost time: 3.096726655960083
Epoch: 21, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.223 Vali Acc: 0.976 Test Loss: 0.223 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.462925910949707
Epoch: 22, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.178 Vali Acc: 0.979 Test Loss: 0.178 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.2462098598480225
Epoch: 23, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.192 Vali Acc: 0.974 Test Loss: 0.192 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.306861400604248
Epoch: 24, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.300 Vali Acc: 0.951 Test Loss: 0.300 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.1667869091033936
Epoch: 25, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.163 Vali Acc: 0.975 Test Loss: 0.163 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.342867136001587
Epoch: 26, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.202 Vali Acc: 0.967 Test Loss: 0.202 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.1146950721740723
Epoch: 27, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.204 Vali Acc: 0.968 Test Loss: 0.204 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 3.5911943912506104
Epoch: 28, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.265 Vali Acc: 0.967 Test Loss: 0.265 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 3.572462797164917
Epoch: 29, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.225 Vali Acc: 0.974 Test Loss: 0.225 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 3.183159112930298
Epoch: 30, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.167 Vali Acc: 0.983 Test Loss: 0.167 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps14_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9853760445682451
model parameter : 641748
model size : 2.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps19_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.354709148406982
Epoch: 1, Steps: 89 | Train Loss: 2.045 Vali Loss: 0.777 Vali Acc: 0.811 Test Loss: 0.777 Test Acc: 0.811
Validation loss decreased (inf --> -0.811274).  Saving model ...
Epoch: 2 cost time: 2.747701406478882
Epoch: 2, Steps: 89 | Train Loss: 0.424 Vali Loss: 0.234 Vali Acc: 0.950 Test Loss: 0.234 Test Acc: 0.950
Validation loss decreased (-0.811274 --> -0.949858).  Saving model ...
Epoch: 3 cost time: 3.028379440307617
Epoch: 3, Steps: 89 | Train Loss: 0.152 Vali Loss: 0.159 Vali Acc: 0.951 Test Loss: 0.159 Test Acc: 0.951
Validation loss decreased (-0.949858 --> -0.951252).  Saving model ...
Epoch: 4 cost time: 3.3577678203582764
Epoch: 4, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.092 Vali Acc: 0.976 Test Loss: 0.092 Test Acc: 0.976
Validation loss decreased (-0.951252 --> -0.976322).  Saving model ...
Epoch: 5 cost time: 3.2781033515930176
Epoch: 5, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.106 Vali Acc: 0.969 Test Loss: 0.106 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.80596661567688
Epoch: 6, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.064 Vali Acc: 0.986 Test Loss: 0.064 Test Acc: 0.986
Validation loss decreased (-0.976322 --> -0.986072).  Saving model ...
Epoch: 7 cost time: 3.663309335708618
Epoch: 7, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.067 Vali Acc: 0.984 Test Loss: 0.067 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.835386037826538
Epoch: 8, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.073 Vali Acc: 0.981 Test Loss: 0.073 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.9549434185028076
Epoch: 9, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.066 Vali Acc: 0.984 Test Loss: 0.066 Test Acc: 0.984
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.0243754386901855
Epoch: 10, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.068 Vali Acc: 0.984 Test Loss: 0.068 Test Acc: 0.984
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.81451678276062
Epoch: 11, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.069 Vali Acc: 0.985 Test Loss: 0.069 Test Acc: 0.985
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.282569408416748
Epoch: 12, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.079 Vali Acc: 0.987 Test Loss: 0.079 Test Acc: 0.987
Validation loss decreased (-0.986072 --> -0.987464).  Saving model ...
Epoch: 13 cost time: 3.586927652359009
Epoch: 13, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.070 Vali Acc: 0.985 Test Loss: 0.070 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.6030430793762207
Epoch: 14, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.080 Vali Acc: 0.984 Test Loss: 0.080 Test Acc: 0.984
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.020911455154419
Epoch: 15, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.076 Vali Acc: 0.982 Test Loss: 0.076 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.357614755630493
Epoch: 16, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.070 Vali Acc: 0.987 Test Loss: 0.070 Test Acc: 0.987
Validation loss decreased (-0.987464 --> -0.987464).  Saving model ...
Epoch: 17 cost time: 3.3031578063964844
Epoch: 17, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.065 Vali Acc: 0.987 Test Loss: 0.065 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.8579132556915283
Epoch: 18, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.986 Test Loss: 0.073 Test Acc: 0.986
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.860849618911743
Epoch: 19, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.095 Vali Acc: 0.983 Test Loss: 0.095 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.7424867153167725
Epoch: 20, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.246 Vali Acc: 0.953 Test Loss: 0.246 Test Acc: 0.953
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.1520016193389893
Epoch: 21, Steps: 89 | Train Loss: 0.160 Vali Loss: 0.143 Vali Acc: 0.970 Test Loss: 0.143 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 3.024254560470581
Epoch: 22, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.132 Vali Acc: 0.977 Test Loss: 0.132 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 3.6026225090026855
Epoch: 23, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.095 Vali Acc: 0.985 Test Loss: 0.095 Test Acc: 0.985
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 3.5551795959472656
Epoch: 24, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.108 Vali Acc: 0.987 Test Loss: 0.108 Test Acc: 0.987
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 3.214470386505127
Epoch: 25, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.067 Vali Acc: 0.990 Test Loss: 0.067 Test Acc: 0.990
Validation loss decreased (-0.987464 --> -0.990250).  Saving model ...
Epoch: 26 cost time: 2.7297935485839844
Epoch: 26, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.986 Test Loss: 0.084 Test Acc: 0.986
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.659268617630005
Epoch: 27, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.084 Vali Acc: 0.987 Test Loss: 0.084 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.9830994606018066
Epoch: 28, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.987 Test Loss: 0.089 Test Acc: 0.987
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.547966480255127
Epoch: 29, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.110 Vali Acc: 0.982 Test Loss: 0.110 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.577346086502075
Epoch: 30, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.160 Vali Acc: 0.978 Test Loss: 0.160 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 2.647191286087036
Epoch: 31, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.123 Vali Acc: 0.984 Test Loss: 0.123 Test Acc: 0.984
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 2.5270471572875977
Epoch: 32, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.174 Vali Acc: 0.978 Test Loss: 0.174 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 2.740476369857788
Epoch: 33, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.131 Vali Acc: 0.976 Test Loss: 0.131 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 3.004060983657837
Epoch: 34, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.145 Vali Acc: 0.976 Test Loss: 0.145 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 3.6203649044036865
Epoch: 35, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps19_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9902506963788301
model parameter : 611348
model size : 2.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps28_str14_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.849775314331055
Epoch: 1, Steps: 89 | Train Loss: 2.119 Vali Loss: 0.934 Vali Acc: 0.811 Test Loss: 0.934 Test Acc: 0.811
Validation loss decreased (inf --> -0.811272).  Saving model ...
Epoch: 2 cost time: 2.739365816116333
Epoch: 2, Steps: 89 | Train Loss: 0.507 Vali Loss: 0.273 Vali Acc: 0.935 Test Loss: 0.273 Test Acc: 0.935
Validation loss decreased (-0.811272 --> -0.934538).  Saving model ...
Epoch: 3 cost time: 2.8790059089660645
Epoch: 3, Steps: 89 | Train Loss: 0.183 Vali Loss: 0.150 Vali Acc: 0.966 Test Loss: 0.150 Test Acc: 0.966
Validation loss decreased (-0.934538 --> -0.965876).  Saving model ...
Epoch: 4 cost time: 3.061399221420288
Epoch: 4, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.102 Vali Acc: 0.974 Test Loss: 0.102 Test Acc: 0.974
Validation loss decreased (-0.965876 --> -0.974233).  Saving model ...
Epoch: 5 cost time: 3.5263593196868896
Epoch: 5, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.107 Vali Acc: 0.975 Test Loss: 0.107 Test Acc: 0.975
Validation loss decreased (-0.974233 --> -0.974929).  Saving model ...
Epoch: 6 cost time: 3.0348987579345703
Epoch: 6, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.082 Vali Acc: 0.976 Test Loss: 0.082 Test Acc: 0.976
Validation loss decreased (-0.974929 --> -0.975626).  Saving model ...
Epoch: 7 cost time: 3.4740560054779053
Epoch: 7, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.073 Vali Acc: 0.979 Test Loss: 0.073 Test Acc: 0.979
Validation loss decreased (-0.975626 --> -0.979108).  Saving model ...
Epoch: 8 cost time: 3.3887953758239746
Epoch: 8, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.082 Vali Acc: 0.978 Test Loss: 0.082 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.6509292125701904
Epoch: 9, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.059 Vali Acc: 0.985 Test Loss: 0.059 Test Acc: 0.985
Validation loss decreased (-0.979108 --> -0.985375).  Saving model ...
Epoch: 10 cost time: 2.807990550994873
Epoch: 10, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.063 Vali Acc: 0.985 Test Loss: 0.063 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.3841469287872314
Epoch: 11, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.3884224891662598
Epoch: 12, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.062 Vali Acc: 0.985 Test Loss: 0.062 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.101271152496338
Epoch: 13, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.086 Vali Acc: 0.981 Test Loss: 0.086 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.1810617446899414
Epoch: 14, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.149 Vali Acc: 0.964 Test Loss: 0.149 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.2976205348968506
Epoch: 15, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.095 Vali Acc: 0.978 Test Loss: 0.095 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.3749232292175293
Epoch: 16, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.138 Vali Acc: 0.963 Test Loss: 0.138 Test Acc: 0.963
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.092905044555664
Epoch: 17, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.103 Vali Acc: 0.978 Test Loss: 0.103 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.617344856262207
Epoch: 18, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.076 Vali Acc: 0.986 Test Loss: 0.076 Test Acc: 0.986
Validation loss decreased (-0.985375 --> -0.986072).  Saving model ...
Epoch: 19 cost time: 2.62953519821167
Epoch: 19, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.170 Vali Acc: 0.961 Test Loss: 0.170 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.0625293254852295
Epoch: 20, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.159 Vali Acc: 0.965 Test Loss: 0.159 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.931852102279663
Epoch: 21, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.108 Vali Acc: 0.974 Test Loss: 0.108 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.3657431602478027
Epoch: 22, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.111 Vali Acc: 0.978 Test Loss: 0.111 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.3927671909332275
Epoch: 23, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.128 Vali Acc: 0.974 Test Loss: 0.128 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.2690329551696777
Epoch: 24, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.0591070652008057
Epoch: 25, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.097 Vali Acc: 0.986 Test Loss: 0.097 Test Acc: 0.986
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 3.076165199279785
Epoch: 26, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.101 Vali Acc: 0.983 Test Loss: 0.101 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 3.0663609504699707
Epoch: 27, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.090 Vali Acc: 0.985 Test Loss: 0.090 Test Acc: 0.985
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 3.0618503093719482
Epoch: 28, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.095 Vali Acc: 0.983 Test Loss: 0.095 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps28_str14_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9860724233983287
model parameter : 596564
model size : 2.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps37_str19_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.718047857284546
Epoch: 1, Steps: 89 | Train Loss: 2.273 Vali Loss: 1.201 Vali Acc: 0.748 Test Loss: 1.201 Test Acc: 0.748
Validation loss decreased (inf --> -0.747899).  Saving model ...
Epoch: 2 cost time: 3.4869940280914307
Epoch: 2, Steps: 89 | Train Loss: 0.644 Vali Loss: 0.350 Vali Acc: 0.916 Test Loss: 0.350 Test Acc: 0.916
Validation loss decreased (-0.747899 --> -0.916431).  Saving model ...
Epoch: 3 cost time: 3.534730911254883
Epoch: 3, Steps: 89 | Train Loss: 0.232 Vali Loss: 0.262 Vali Acc: 0.932 Test Loss: 0.262 Test Acc: 0.932
Validation loss decreased (-0.916431 --> -0.931752).  Saving model ...
Epoch: 4 cost time: 2.776235342025757
Epoch: 4, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.118 Vali Acc: 0.975 Test Loss: 0.118 Test Acc: 0.975
Validation loss decreased (-0.931752 --> -0.974929).  Saving model ...
Epoch: 5 cost time: 2.8414430618286133
Epoch: 5, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.098 Vali Acc: 0.974 Test Loss: 0.098 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.818591356277466
Epoch: 6, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.090 Vali Acc: 0.977 Test Loss: 0.090 Test Acc: 0.977
Validation loss decreased (-0.974929 --> -0.977019).  Saving model ...
Epoch: 7 cost time: 2.6487414836883545
Epoch: 7, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.977019 --> -0.979804).  Saving model ...
Epoch: 8 cost time: 2.8902459144592285
Epoch: 8, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.138 Vali Acc: 0.964 Test Loss: 0.138 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.286912202835083
Epoch: 9, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.979804 --> -0.983286).  Saving model ...
Epoch: 10 cost time: 3.3865015506744385
Epoch: 10, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.067 Vali Acc: 0.980 Test Loss: 0.067 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.8929290771484375
Epoch: 11, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.064 Vali Acc: 0.985 Test Loss: 0.064 Test Acc: 0.985
Validation loss decreased (-0.983286 --> -0.985375).  Saving model ...
Epoch: 12 cost time: 3.174769401550293
Epoch: 12, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.077 Vali Acc: 0.981 Test Loss: 0.077 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.1552093029022217
Epoch: 13, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.111 Vali Acc: 0.967 Test Loss: 0.111 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.9601829051971436
Epoch: 14, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.060 Vali Acc: 0.985 Test Loss: 0.060 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.269839286804199
Epoch: 15, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.098 Vali Acc: 0.974 Test Loss: 0.098 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.1925277709960938
Epoch: 16, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.101 Vali Acc: 0.975 Test Loss: 0.101 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.8650734424591064
Epoch: 17, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.099 Vali Acc: 0.976 Test Loss: 0.099 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.183367967605591
Epoch: 18, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.792924404144287
Epoch: 19, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.083 Vali Acc: 0.981 Test Loss: 0.083 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.9218966960906982
Epoch: 20, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.074 Vali Acc: 0.987 Test Loss: 0.074 Test Acc: 0.987
Validation loss decreased (-0.985375 --> -0.987464).  Saving model ...
Epoch: 21 cost time: 3.044630765914917
Epoch: 21, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.238335609436035
Epoch: 22, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.233109951019287
Epoch: 23, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.057 Vali Acc: 0.986 Test Loss: 0.057 Test Acc: 0.986
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.7070236206054688
Epoch: 24, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.062 Vali Acc: 0.987 Test Loss: 0.062 Test Acc: 0.987
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.5434987545013428
Epoch: 25, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.059 Vali Acc: 0.987 Test Loss: 0.059 Test Acc: 0.987
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.5463364124298096
Epoch: 26, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.058 Vali Acc: 0.986 Test Loss: 0.058 Test Acc: 0.986
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.5701727867126465
Epoch: 27, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.059 Vali Acc: 0.985 Test Loss: 0.059 Test Acc: 0.985
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 3.249420166015625
Epoch: 28, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.058 Vali Acc: 0.988 Test Loss: 0.058 Test Acc: 0.988
Validation loss decreased (-0.987464 --> -0.988161).  Saving model ...
Epoch: 29 cost time: 3.6036245822906494
Epoch: 29, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.056 Vali Acc: 0.986 Test Loss: 0.056 Test Acc: 0.986
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.268829822540283
Epoch: 30, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.059 Vali Acc: 0.985 Test Loss: 0.059 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.248201370239258
Epoch: 31, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.987 Test Loss: 0.064 Test Acc: 0.987
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 3.3785011768341064
Epoch: 32, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.063 Vali Acc: 0.986 Test Loss: 0.063 Test Acc: 0.986
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 3.3348424434661865
Epoch: 33, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.985 Test Loss: 0.066 Test Acc: 0.985
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 2.977396249771118
Epoch: 34, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.057 Vali Acc: 0.986 Test Loss: 0.057 Test Acc: 0.986
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 3.6145846843719482
Epoch: 35, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.059 Vali Acc: 0.987 Test Loss: 0.059 Test Acc: 0.987
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 3.61157488822937
Epoch: 36, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.059 Vali Acc: 0.986 Test Loss: 0.059 Test Acc: 0.986
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 3.897427797317505
Epoch: 37, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.986 Test Loss: 0.064 Test Acc: 0.986
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 3.570570707321167
Epoch: 38, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.063 Vali Acc: 0.987 Test Loss: 0.063 Test Acc: 0.987
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps37_str19_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9881615598885793
model parameter : 581780
model size : 2.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps46_str23_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.174203872680664
Epoch: 1, Steps: 89 | Train Loss: 2.388 Vali Loss: 1.366 Vali Acc: 0.736 Test Loss: 1.366 Test Acc: 0.736
Validation loss decreased (inf --> -0.736059).  Saving model ...
Epoch: 2 cost time: 2.885894775390625
Epoch: 2, Steps: 89 | Train Loss: 0.720 Vali Loss: 0.410 Vali Acc: 0.901 Test Loss: 0.410 Test Acc: 0.901
Validation loss decreased (-0.736059 --> -0.901110).  Saving model ...
Epoch: 3 cost time: 3.1227426528930664
Epoch: 3, Steps: 89 | Train Loss: 0.258 Vali Loss: 0.182 Vali Acc: 0.954 Test Loss: 0.182 Test Acc: 0.954
Validation loss decreased (-0.901110 --> -0.954037).  Saving model ...
Epoch: 4 cost time: 3.4598515033721924
Epoch: 4, Steps: 89 | Train Loss: 0.126 Vali Loss: 0.123 Vali Acc: 0.966 Test Loss: 0.123 Test Acc: 0.966
Validation loss decreased (-0.954037 --> -0.965876).  Saving model ...
Epoch: 5 cost time: 3.397456169128418
Epoch: 5, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
Validation loss decreased (-0.965876 --> -0.970055).  Saving model ...
Epoch: 6 cost time: 2.8169806003570557
Epoch: 6, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
Validation loss decreased (-0.970055 --> -0.972840).  Saving model ...
Epoch: 7 cost time: 2.6464953422546387
Epoch: 7, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.071 Vali Acc: 0.981 Test Loss: 0.071 Test Acc: 0.981
Validation loss decreased (-0.972840 --> -0.981197).  Saving model ...
Epoch: 8 cost time: 3.014789342880249
Epoch: 8, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.091 Vali Acc: 0.972 Test Loss: 0.091 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.3204898834228516
Epoch: 9, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.049 Vali Acc: 0.987 Test Loss: 0.049 Test Acc: 0.987
Validation loss decreased (-0.981197 --> -0.987465).  Saving model ...
Epoch: 10 cost time: 3.0082168579101562
Epoch: 10, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.061 Vali Acc: 0.983 Test Loss: 0.061 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.4312682151794434
Epoch: 11, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.066 Vali Acc: 0.982 Test Loss: 0.066 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.156527042388916
Epoch: 12, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.8885245323181152
Epoch: 13, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.063 Vali Acc: 0.981 Test Loss: 0.063 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.1344687938690186
Epoch: 14, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.076 Vali Acc: 0.984 Test Loss: 0.076 Test Acc: 0.984
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.162652015686035
Epoch: 15, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.046 Vali Acc: 0.990 Test Loss: 0.046 Test Acc: 0.990
Validation loss decreased (-0.987465 --> -0.989554).  Saving model ...
Epoch: 16 cost time: 3.1522092819213867
Epoch: 16, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.044 Vali Acc: 0.990 Test Loss: 0.044 Test Acc: 0.990
Validation loss decreased (-0.989554 --> -0.990250).  Saving model ...
Epoch: 17 cost time: 2.7610743045806885
Epoch: 17, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.053 Vali Acc: 0.987 Test Loss: 0.053 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.1249215602874756
Epoch: 18, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.700474739074707
Epoch: 19, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.079 Vali Acc: 0.975 Test Loss: 0.079 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.8392372131347656
Epoch: 20, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.092 Vali Acc: 0.979 Test Loss: 0.092 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.985602855682373
Epoch: 21, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.150 Vali Acc: 0.972 Test Loss: 0.150 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 3.5142874717712402
Epoch: 22, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.072 Vali Acc: 0.984 Test Loss: 0.072 Test Acc: 0.984
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 3.6888458728790283
Epoch: 23, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.093 Vali Acc: 0.981 Test Loss: 0.093 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 3.6705727577209473
Epoch: 24, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 3.0577032566070557
Epoch: 25, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.118 Vali Acc: 0.975 Test Loss: 0.118 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 3.040518045425415
Epoch: 26, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.066 Vali Acc: 0.987 Test Loss: 0.066 Test Acc: 0.987
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr4_ps46_str23_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9902506963788301
model parameter : 574676
model size : 2.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.8724825382232666
Epoch: 1, Steps: 89 | Train Loss: 1.779 Vali Loss: 0.596 Vali Acc: 0.838 Test Loss: 0.596 Test Acc: 0.838
Validation loss decreased (inf --> -0.837738).  Saving model ...
Epoch: 2 cost time: 2.7215261459350586
Epoch: 2, Steps: 89 | Train Loss: 0.323 Vali Loss: 0.200 Vali Acc: 0.956 Test Loss: 0.200 Test Acc: 0.956
Validation loss decreased (-0.837738 --> -0.956126).  Saving model ...
Epoch: 3 cost time: 2.5300509929656982
Epoch: 3, Steps: 89 | Train Loss: 0.134 Vali Loss: 0.168 Vali Acc: 0.958 Test Loss: 0.168 Test Acc: 0.958
Validation loss decreased (-0.956126 --> -0.957519).  Saving model ...
Epoch: 4 cost time: 2.9969799518585205
Epoch: 4, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.111 Vali Acc: 0.967 Test Loss: 0.111 Test Acc: 0.967
Validation loss decreased (-0.957519 --> -0.967269).  Saving model ...
Epoch: 5 cost time: 2.576462984085083
Epoch: 5, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.106 Vali Acc: 0.976 Test Loss: 0.106 Test Acc: 0.976
Validation loss decreased (-0.967269 --> -0.976322).  Saving model ...
Epoch: 6 cost time: 2.7656030654907227
Epoch: 6, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.138 Vali Acc: 0.963 Test Loss: 0.138 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.9890072345733643
Epoch: 7, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.124 Vali Acc: 0.967 Test Loss: 0.124 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.998547315597534
Epoch: 8, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.090 Vali Acc: 0.985 Test Loss: 0.090 Test Acc: 0.985
Validation loss decreased (-0.976322 --> -0.984679).  Saving model ...
Epoch: 9 cost time: 2.4595844745635986
Epoch: 9, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.092 Vali Acc: 0.984 Test Loss: 0.092 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.772963047027588
Epoch: 10, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.092 Vali Acc: 0.983 Test Loss: 0.092 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.858177900314331
Epoch: 11, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.983 Test Loss: 0.093 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.9435856342315674
Epoch: 12, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.108 Vali Acc: 0.981 Test Loss: 0.108 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.670725107192993
Epoch: 13, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.5793633460998535
Epoch: 14, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.594 Vali Acc: 0.885 Test Loss: 0.594 Test Acc: 0.885
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.5344815254211426
Epoch: 15, Steps: 89 | Train Loss: 0.158 Vali Loss: 0.307 Vali Acc: 0.953 Test Loss: 0.307 Test Acc: 0.953
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.8093953132629395
Epoch: 16, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.222 Vali Acc: 0.967 Test Loss: 0.222 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.6075046062469482
Epoch: 17, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.178 Vali Acc: 0.976 Test Loss: 0.178 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.9082891941070557
Epoch: 18, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.132 Vali Acc: 0.981 Test Loss: 0.132 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9846796657381616
model parameter : 258900
model size : 1.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.2075657844543457
Epoch: 1, Steps: 89 | Train Loss: 2.199 Vali Loss: 0.953 Vali Acc: 0.813 Test Loss: 0.953 Test Acc: 0.813
Validation loss decreased (inf --> -0.813361).  Saving model ...
Epoch: 2 cost time: 2.268480062484741
Epoch: 2, Steps: 89 | Train Loss: 0.506 Vali Loss: 0.303 Vali Acc: 0.928 Test Loss: 0.303 Test Acc: 0.928
Validation loss decreased (-0.813361 --> -0.927574).  Saving model ...
Epoch: 3 cost time: 2.316908597946167
Epoch: 3, Steps: 89 | Train Loss: 0.181 Vali Loss: 0.157 Vali Acc: 0.964 Test Loss: 0.157 Test Acc: 0.964
Validation loss decreased (-0.927574 --> -0.963787).  Saving model ...
Epoch: 4 cost time: 2.5138213634490967
Epoch: 4, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.106 Vali Acc: 0.971 Test Loss: 0.106 Test Acc: 0.971
Validation loss decreased (-0.963787 --> -0.970751).  Saving model ...
Epoch: 5 cost time: 2.3672118186950684
Epoch: 5, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.104 Vali Acc: 0.969 Test Loss: 0.104 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.7129900455474854
Epoch: 6, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.082 Vali Acc: 0.981 Test Loss: 0.082 Test Acc: 0.981
Validation loss decreased (-0.970751 --> -0.981197).  Saving model ...
Epoch: 7 cost time: 2.535264253616333
Epoch: 7, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.747437000274658
Epoch: 8, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.5647456645965576
Epoch: 9, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
Validation loss decreased (-0.981197 --> -0.982590).  Saving model ...
Epoch: 10 cost time: 2.652944564819336
Epoch: 10, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.092 Vali Acc: 0.978 Test Loss: 0.092 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.611477851867676
Epoch: 11, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.080 Vali Acc: 0.982 Test Loss: 0.080 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.4921748638153076
Epoch: 12, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.082 Vali Acc: 0.981 Test Loss: 0.082 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.4649150371551514
Epoch: 13, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.099 Vali Acc: 0.982 Test Loss: 0.099 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.7901713848114014
Epoch: 14, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.100 Vali Acc: 0.976 Test Loss: 0.100 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.861138343811035
Epoch: 15, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.069 Vali Acc: 0.987 Test Loss: 0.069 Test Acc: 0.987
Validation loss decreased (-0.982590 --> -0.987464).  Saving model ...
Epoch: 16 cost time: 2.69342041015625
Epoch: 16, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.109 Vali Acc: 0.978 Test Loss: 0.109 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.4611856937408447
Epoch: 17, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.110 Vali Acc: 0.979 Test Loss: 0.110 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.839934825897217
Epoch: 18, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.154 Vali Acc: 0.976 Test Loss: 0.154 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.611637592315674
Epoch: 19, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.127 Vali Acc: 0.974 Test Loss: 0.127 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.593630313873291
Epoch: 20, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.125 Vali Acc: 0.980 Test Loss: 0.125 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.515861988067627
Epoch: 21, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.142 Vali Acc: 0.977 Test Loss: 0.142 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.6579787731170654
Epoch: 22, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.126 Vali Acc: 0.982 Test Loss: 0.126 Test Acc: 0.982
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.6615798473358154
Epoch: 23, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.138 Vali Acc: 0.979 Test Loss: 0.138 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.911463499069214
Epoch: 24, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.119 Vali Acc: 0.982 Test Loss: 0.119 Test Acc: 0.982
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.4559104442596436
Epoch: 25, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.148 Vali Acc: 0.978 Test Loss: 0.148 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9874651810584958
model parameter : 212980
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps14_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.993821620941162
Epoch: 1, Steps: 89 | Train Loss: 2.285 Vali Loss: 1.117 Vali Acc: 0.764 Test Loss: 1.117 Test Acc: 0.764
Validation loss decreased (inf --> -0.763916).  Saving model ...
Epoch: 2 cost time: 2.522186517715454
Epoch: 2, Steps: 89 | Train Loss: 0.596 Vali Loss: 0.324 Vali Acc: 0.916 Test Loss: 0.324 Test Acc: 0.916
Validation loss decreased (-0.763916 --> -0.915735).  Saving model ...
Epoch: 3 cost time: 2.3928093910217285
Epoch: 3, Steps: 89 | Train Loss: 0.223 Vali Loss: 0.174 Vali Acc: 0.962 Test Loss: 0.174 Test Acc: 0.962
Validation loss decreased (-0.915735 --> -0.962394).  Saving model ...
Epoch: 4 cost time: 2.420382499694824
Epoch: 4, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.140 Vali Acc: 0.966 Test Loss: 0.140 Test Acc: 0.966
Validation loss decreased (-0.962394 --> -0.965876).  Saving model ...
Epoch: 5 cost time: 2.5346014499664307
Epoch: 5, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
Validation loss decreased (-0.965876 --> -0.976322).  Saving model ...
Epoch: 6 cost time: 2.764186143875122
Epoch: 6, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.976322 --> -0.977019).  Saving model ...
Epoch: 7 cost time: 2.500703811645508
Epoch: 7, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.977019 --> -0.979804).  Saving model ...
Epoch: 8 cost time: 2.4538323879241943
Epoch: 8, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.079 Vali Acc: 0.981 Test Loss: 0.079 Test Acc: 0.981
Validation loss decreased (-0.979804 --> -0.981197).  Saving model ...
Epoch: 9 cost time: 2.512988805770874
Epoch: 9, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.079 Vali Acc: 0.981 Test Loss: 0.079 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.264671564102173
Epoch: 10, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.3807034492492676
Epoch: 11, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.3973207473754883
Epoch: 12, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.106 Vali Acc: 0.976 Test Loss: 0.106 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.491380453109741
Epoch: 13, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.102 Vali Acc: 0.976 Test Loss: 0.102 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.5799949169158936
Epoch: 14, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.088 Vali Acc: 0.985 Test Loss: 0.088 Test Acc: 0.985
Validation loss decreased (-0.981197 --> -0.984679).  Saving model ...
Epoch: 15 cost time: 2.299495220184326
Epoch: 15, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.083 Vali Acc: 0.985 Test Loss: 0.083 Test Acc: 0.985
Validation loss decreased (-0.984679 --> -0.984679).  Saving model ...
Epoch: 16 cost time: 2.290489673614502
Epoch: 16, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.071 Vali Acc: 0.985 Test Loss: 0.071 Test Acc: 0.985
Validation loss decreased (-0.984679 --> -0.985375).  Saving model ...
Epoch: 17 cost time: 2.416194438934326
Epoch: 17, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.082 Vali Acc: 0.984 Test Loss: 0.082 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.774475336074829
Epoch: 18, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.070 Vali Acc: 0.982 Test Loss: 0.070 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.506134510040283
Epoch: 19, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.090 Vali Acc: 0.983 Test Loss: 0.090 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.8233001232147217
Epoch: 20, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.096 Vali Acc: 0.983 Test Loss: 0.096 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.9558358192443848
Epoch: 21, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.081 Vali Acc: 0.985 Test Loss: 0.081 Test Acc: 0.985
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.8383426666259766
Epoch: 22, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.099 Vali Acc: 0.981 Test Loss: 0.099 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.295593500137329
Epoch: 23, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.101 Vali Acc: 0.981 Test Loss: 0.101 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.5981411933898926
Epoch: 24, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.084 Vali Acc: 0.985 Test Loss: 0.084 Test Acc: 0.985
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.3016772270202637
Epoch: 25, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.096 Vali Acc: 0.985 Test Loss: 0.096 Test Acc: 0.985
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.4661834239959717
Epoch: 26, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.134 Vali Acc: 0.979 Test Loss: 0.134 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps14_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9853760445682451
model parameter : 193908
model size : 0.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps19_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.8876218795776367
Epoch: 1, Steps: 89 | Train Loss: 2.554 Vali Loss: 1.672 Vali Acc: 0.722 Test Loss: 1.672 Test Acc: 0.722
Validation loss decreased (inf --> -0.722128).  Saving model ...
Epoch: 2 cost time: 2.7740209102630615
Epoch: 2, Steps: 89 | Train Loss: 0.903 Vali Loss: 0.501 Vali Acc: 0.880 Test Loss: 0.501 Test Acc: 0.880
Validation loss decreased (-0.722128 --> -0.880218).  Saving model ...
Epoch: 3 cost time: 2.3346145153045654
Epoch: 3, Steps: 89 | Train Loss: 0.337 Vali Loss: 0.248 Vali Acc: 0.945 Test Loss: 0.248 Test Acc: 0.945
Validation loss decreased (-0.880218 --> -0.944984).  Saving model ...
Epoch: 4 cost time: 2.385488748550415
Epoch: 4, Steps: 89 | Train Loss: 0.157 Vali Loss: 0.144 Vali Acc: 0.965 Test Loss: 0.144 Test Acc: 0.965
Validation loss decreased (-0.944984 --> -0.965180).  Saving model ...
Epoch: 5 cost time: 2.326780319213867
Epoch: 5, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.104 Vali Acc: 0.978 Test Loss: 0.104 Test Acc: 0.978
Validation loss decreased (-0.965180 --> -0.977715).  Saving model ...
Epoch: 6 cost time: 2.7595162391662598
Epoch: 6, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.098 Vali Acc: 0.974 Test Loss: 0.098 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.401209592819214
Epoch: 7, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.077 Vali Acc: 0.982 Test Loss: 0.077 Test Acc: 0.982
Validation loss decreased (-0.977715 --> -0.981893).  Saving model ...
Epoch: 8 cost time: 2.7752726078033447
Epoch: 8, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.8092784881591797
Epoch: 9, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.077 Vali Acc: 0.976 Test Loss: 0.077 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.81600284576416
Epoch: 10, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.071 Vali Acc: 0.985 Test Loss: 0.071 Test Acc: 0.985
Validation loss decreased (-0.981893 --> -0.985375).  Saving model ...
Epoch: 11 cost time: 2.3310465812683105
Epoch: 11, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.064 Vali Acc: 0.980 Test Loss: 0.064 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.450939893722534
Epoch: 12, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.3330559730529785
Epoch: 13, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.058 Vali Acc: 0.987 Test Loss: 0.058 Test Acc: 0.987
Validation loss decreased (-0.985375 --> -0.987465).  Saving model ...
Epoch: 14 cost time: 2.7251293659210205
Epoch: 14, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.056 Vali Acc: 0.985 Test Loss: 0.056 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.3935489654541016
Epoch: 15, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.049 Vali Acc: 0.988 Test Loss: 0.049 Test Acc: 0.988
Validation loss decreased (-0.987465 --> -0.988161).  Saving model ...
Epoch: 16 cost time: 2.5541813373565674
Epoch: 16, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.9823806285858154
Epoch: 17, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.063 Vali Acc: 0.985 Test Loss: 0.063 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.885160446166992
Epoch: 18, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.063 Vali Acc: 0.984 Test Loss: 0.063 Test Acc: 0.984
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.669006586074829
Epoch: 19, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.064 Vali Acc: 0.984 Test Loss: 0.064 Test Acc: 0.984
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.708646059036255
Epoch: 20, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.056 Vali Acc: 0.984 Test Loss: 0.056 Test Acc: 0.984
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.4879159927368164
Epoch: 21, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.078 Vali Acc: 0.978 Test Loss: 0.078 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.4663259983062744
Epoch: 22, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.121 Vali Acc: 0.979 Test Loss: 0.121 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.4929771423339844
Epoch: 23, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.077 Vali Acc: 0.981 Test Loss: 0.077 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.6582539081573486
Epoch: 24, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.071 Vali Acc: 0.986 Test Loss: 0.071 Test Acc: 0.986
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.593601703643799
Epoch: 25, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.114 Vali Acc: 0.981 Test Loss: 0.114 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps19_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9881615598885793
model parameter : 178708
model size : 0.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps28_str14_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.9008102416992188
Epoch: 1, Steps: 89 | Train Loss: 2.598 Vali Loss: 1.859 Vali Acc: 0.666 Test Loss: 1.859 Test Acc: 0.666
Validation loss decreased (inf --> -0.665720).  Saving model ...
Epoch: 2 cost time: 2.6579833030700684
Epoch: 2, Steps: 89 | Train Loss: 1.088 Vali Loss: 0.584 Vali Acc: 0.864 Test Loss: 0.584 Test Acc: 0.864
Validation loss decreased (-0.665720 --> -0.863504).  Saving model ...
Epoch: 3 cost time: 2.6975626945495605
Epoch: 3, Steps: 89 | Train Loss: 0.396 Vali Loss: 0.278 Vali Acc: 0.935 Test Loss: 0.278 Test Acc: 0.935
Validation loss decreased (-0.863504 --> -0.934538).  Saving model ...
Epoch: 4 cost time: 2.3443427085876465
Epoch: 4, Steps: 89 | Train Loss: 0.196 Vali Loss: 0.170 Vali Acc: 0.958 Test Loss: 0.170 Test Acc: 0.958
Validation loss decreased (-0.934538 --> -0.957519).  Saving model ...
Epoch: 5 cost time: 2.2299301624298096
Epoch: 5, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.135 Vali Acc: 0.962 Test Loss: 0.135 Test Acc: 0.962
Validation loss decreased (-0.957519 --> -0.962394).  Saving model ...
Epoch: 6 cost time: 2.436915159225464
Epoch: 6, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.103 Vali Acc: 0.972 Test Loss: 0.103 Test Acc: 0.972
Validation loss decreased (-0.962394 --> -0.972144).  Saving model ...
Epoch: 7 cost time: 2.8133890628814697
Epoch: 7, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.082 Vali Acc: 0.979 Test Loss: 0.082 Test Acc: 0.979
Validation loss decreased (-0.972144 --> -0.979108).  Saving model ...
Epoch: 8 cost time: 2.557490348815918
Epoch: 8, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.076 Vali Acc: 0.978 Test Loss: 0.076 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.762136936187744
Epoch: 9, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
Validation loss decreased (-0.979108 --> -0.983286).  Saving model ...
Epoch: 10 cost time: 2.4914917945861816
Epoch: 10, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.067 Vali Acc: 0.985 Test Loss: 0.067 Test Acc: 0.985
Validation loss decreased (-0.983286 --> -0.985375).  Saving model ...
Epoch: 11 cost time: 2.4749670028686523
Epoch: 11, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.060 Vali Acc: 0.983 Test Loss: 0.060 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.567142963409424
Epoch: 12, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.055 Vali Acc: 0.987 Test Loss: 0.055 Test Acc: 0.987
Validation loss decreased (-0.985375 --> -0.986768).  Saving model ...
Epoch: 13 cost time: 2.5394582748413086
Epoch: 13, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.055 Vali Acc: 0.985 Test Loss: 0.055 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.6641719341278076
Epoch: 14, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.070 Vali Acc: 0.982 Test Loss: 0.070 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.693842887878418
Epoch: 15, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.062 Vali Acc: 0.988 Test Loss: 0.062 Test Acc: 0.988
Validation loss decreased (-0.986768 --> -0.988161).  Saving model ...
Epoch: 16 cost time: 2.8049802780151367
Epoch: 16, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.069 Vali Acc: 0.985 Test Loss: 0.069 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.865865707397461
Epoch: 17, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.062 Vali Acc: 0.987 Test Loss: 0.062 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.38999080657959
Epoch: 18, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.078 Vali Acc: 0.987 Test Loss: 0.078 Test Acc: 0.987
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.876182794570923
Epoch: 19, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.538435459136963
Epoch: 20, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.386361837387085
Epoch: 21, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.264209032058716
Epoch: 22, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.773418426513672
Epoch: 23, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.064 Vali Acc: 0.987 Test Loss: 0.064 Test Acc: 0.987
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.9402854442596436
Epoch: 24, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.086 Vali Acc: 0.981 Test Loss: 0.086 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.7325291633605957
Epoch: 25, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.120 Vali Acc: 0.975 Test Loss: 0.120 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps28_str14_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9881615598885793
model parameter : 171316
model size : 0.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps37_str19_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.9875741004943848
Epoch: 1, Steps: 89 | Train Loss: 2.739 Vali Loss: 2.111 Vali Acc: 0.595 Test Loss: 2.111 Test Acc: 0.595
Validation loss decreased (inf --> -0.594686).  Saving model ...
Epoch: 2 cost time: 2.492760181427002
Epoch: 2, Steps: 89 | Train Loss: 1.339 Vali Loss: 0.754 Vali Acc: 0.833 Test Loss: 0.754 Test Acc: 0.833
Validation loss decreased (-0.594686 --> -0.832862).  Saving model ...
Epoch: 3 cost time: 2.448291063308716
Epoch: 3, Steps: 89 | Train Loss: 0.525 Vali Loss: 0.360 Vali Acc: 0.911 Test Loss: 0.360 Test Acc: 0.911
Validation loss decreased (-0.832862 --> -0.910860).  Saving model ...
Epoch: 4 cost time: 2.5068907737731934
Epoch: 4, Steps: 89 | Train Loss: 0.257 Vali Loss: 0.194 Vali Acc: 0.960 Test Loss: 0.194 Test Acc: 0.960
Validation loss decreased (-0.910860 --> -0.960304).  Saving model ...
Epoch: 5 cost time: 2.8624653816223145
Epoch: 5, Steps: 89 | Train Loss: 0.148 Vali Loss: 0.135 Vali Acc: 0.972 Test Loss: 0.135 Test Acc: 0.972
Validation loss decreased (-0.960304 --> -0.972143).  Saving model ...
Epoch: 6 cost time: 2.5571160316467285
Epoch: 6, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.123 Vali Acc: 0.965 Test Loss: 0.123 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.6245501041412354
Epoch: 7, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.106 Vali Acc: 0.971 Test Loss: 0.106 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.3491225242614746
Epoch: 8, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.972143 --> -0.979804).  Saving model ...
Epoch: 9 cost time: 2.4386160373687744
Epoch: 9, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.979804 --> -0.979804).  Saving model ...
Epoch: 10 cost time: 2.4520533084869385
Epoch: 10, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.979804 --> -0.982590).  Saving model ...
Epoch: 11 cost time: 2.8207669258117676
Epoch: 11, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.087 Vali Acc: 0.979 Test Loss: 0.087 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.8880765438079834
Epoch: 12, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.081 Vali Acc: 0.978 Test Loss: 0.081 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.781245231628418
Epoch: 13, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.086 Vali Acc: 0.981 Test Loss: 0.086 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.5161855220794678
Epoch: 14, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.070 Vali Acc: 0.985 Test Loss: 0.070 Test Acc: 0.985
Validation loss decreased (-0.982590 --> -0.984679).  Saving model ...
Epoch: 15 cost time: 2.6672160625457764
Epoch: 15, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.066 Vali Acc: 0.985 Test Loss: 0.066 Test Acc: 0.985
Validation loss decreased (-0.984679 --> -0.984679).  Saving model ...
Epoch: 16 cost time: 2.420924663543701
Epoch: 16, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.075 Vali Acc: 0.979 Test Loss: 0.075 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.46938419342041
Epoch: 17, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.654745578765869
Epoch: 18, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.927976131439209
Epoch: 19, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.852161169052124
Epoch: 20, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.134 Vali Acc: 0.971 Test Loss: 0.134 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.8396213054656982
Epoch: 21, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.063 Vali Acc: 0.985 Test Loss: 0.063 Test Acc: 0.985
Validation loss decreased (-0.984679 --> -0.985375).  Saving model ...
Epoch: 22 cost time: 2.7211873531341553
Epoch: 22, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.061 Vali Acc: 0.987 Test Loss: 0.061 Test Acc: 0.987
Validation loss decreased (-0.985375 --> -0.987465).  Saving model ...
Epoch: 23 cost time: 2.8327012062072754
Epoch: 23, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.072 Vali Acc: 0.987 Test Loss: 0.072 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.4602413177490234
Epoch: 24, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.062 Vali Acc: 0.988 Test Loss: 0.062 Test Acc: 0.988
Validation loss decreased (-0.987465 --> -0.988161).  Saving model ...
Epoch: 25 cost time: 2.3810043334960938
Epoch: 25, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.083 Vali Acc: 0.985 Test Loss: 0.083 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.365241527557373
Epoch: 26, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.125 Vali Acc: 0.974 Test Loss: 0.125 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.270864963531494
Epoch: 27, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.098 Vali Acc: 0.984 Test Loss: 0.098 Test Acc: 0.984
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.06982159614563
Epoch: 28, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.077 Vali Acc: 0.987 Test Loss: 0.077 Test Acc: 0.987
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 3.320467948913574
Epoch: 29, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.068 Vali Acc: 0.984 Test Loss: 0.068 Test Acc: 0.984
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.958263874053955
Epoch: 30, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 2.7322585582733154
Epoch: 31, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.095 Vali Acc: 0.983 Test Loss: 0.095 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 3.1910650730133057
Epoch: 32, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.087 Vali Acc: 0.981 Test Loss: 0.087 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 3.225653648376465
Epoch: 33, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.097 Vali Acc: 0.981 Test Loss: 0.097 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 2.648733139038086
Epoch: 34, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.091 Vali Acc: 0.985 Test Loss: 0.091 Test Acc: 0.985
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps37_str19_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9881615598885793
model parameter : 163924
model size : 0.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps46_str23_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.845100164413452
Epoch: 1, Steps: 89 | Train Loss: 2.725 Vali Loss: 2.141 Vali Acc: 0.648 Test Loss: 2.141 Test Acc: 0.648
Validation loss decreased (inf --> -0.647611).  Saving model ...
Epoch: 2 cost time: 2.643519878387451
Epoch: 2, Steps: 89 | Train Loss: 1.363 Vali Loss: 0.733 Vali Acc: 0.864 Test Loss: 0.733 Test Acc: 0.864
Validation loss decreased (-0.647611 --> -0.863502).  Saving model ...
Epoch: 3 cost time: 2.9792397022247314
Epoch: 3, Steps: 89 | Train Loss: 0.485 Vali Loss: 0.338 Vali Acc: 0.910 Test Loss: 0.338 Test Acc: 0.910
Validation loss decreased (-0.863502 --> -0.910164).  Saving model ...
Epoch: 4 cost time: 2.9970672130584717
Epoch: 4, Steps: 89 | Train Loss: 0.240 Vali Loss: 0.192 Vali Acc: 0.956 Test Loss: 0.192 Test Acc: 0.956
Validation loss decreased (-0.910164 --> -0.956126).  Saving model ...
Epoch: 5 cost time: 2.764194965362549
Epoch: 5, Steps: 89 | Train Loss: 0.152 Vali Loss: 0.127 Vali Acc: 0.971 Test Loss: 0.127 Test Acc: 0.971
Validation loss decreased (-0.956126 --> -0.970751).  Saving model ...
Epoch: 6 cost time: 2.3857429027557373
Epoch: 6, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
Validation loss decreased (-0.970751 --> -0.977018).  Saving model ...
Epoch: 7 cost time: 2.4030041694641113
Epoch: 7, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
Validation loss decreased (-0.977018 --> -0.978411).  Saving model ...
Epoch: 8 cost time: 2.1534595489501953
Epoch: 8, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.095 Vali Acc: 0.974 Test Loss: 0.095 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.279012680053711
Epoch: 9, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.072 Vali Acc: 0.982 Test Loss: 0.072 Test Acc: 0.982
Validation loss decreased (-0.978411 --> -0.981893).  Saving model ...
Epoch: 10 cost time: 2.975647211074829
Epoch: 10, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.073 Vali Acc: 0.982 Test Loss: 0.073 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.0794246196746826
Epoch: 11, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.066 Vali Acc: 0.985 Test Loss: 0.066 Test Acc: 0.985
Validation loss decreased (-0.981893 --> -0.985375).  Saving model ...
Epoch: 12 cost time: 2.8936593532562256
Epoch: 12, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.069 Vali Acc: 0.986 Test Loss: 0.069 Test Acc: 0.986
Validation loss decreased (-0.985375 --> -0.986072).  Saving model ...
Epoch: 13 cost time: 2.523207187652588
Epoch: 13, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.063 Vali Acc: 0.985 Test Loss: 0.063 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.5863149166107178
Epoch: 14, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.071 Vali Acc: 0.981 Test Loss: 0.071 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.597352981567383
Epoch: 15, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.083 Vali Acc: 0.982 Test Loss: 0.083 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.759629249572754
Epoch: 16, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.073 Vali Acc: 0.982 Test Loss: 0.073 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.618166923522949
Epoch: 17, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.057 Vali Acc: 0.987 Test Loss: 0.057 Test Acc: 0.987
Validation loss decreased (-0.986072 --> -0.986768).  Saving model ...
Epoch: 18 cost time: 2.341292142868042
Epoch: 18, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.060 Vali Acc: 0.985 Test Loss: 0.060 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.56937575340271
Epoch: 19, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.119 Vali Acc: 0.969 Test Loss: 0.119 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.5398261547088623
Epoch: 20, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.063 Vali Acc: 0.985 Test Loss: 0.063 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.38299822807312
Epoch: 21, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.056 Vali Acc: 0.986 Test Loss: 0.056 Test Acc: 0.986
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.606394052505493
Epoch: 22, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.052 Vali Acc: 0.989 Test Loss: 0.052 Test Acc: 0.989
Validation loss decreased (-0.986768 --> -0.988857).  Saving model ...
Epoch: 23 cost time: 2.8252153396606445
Epoch: 23, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.052 Vali Acc: 0.990 Test Loss: 0.052 Test Acc: 0.990
Validation loss decreased (-0.988857 --> -0.989554).  Saving model ...
Epoch: 24 cost time: 2.6928577423095703
Epoch: 24, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.050 Vali Acc: 0.990 Test Loss: 0.050 Test Acc: 0.990
Validation loss decreased (-0.989554 --> -0.990250).  Saving model ...
Epoch: 25 cost time: 2.517563581466675
Epoch: 25, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.060 Vali Acc: 0.985 Test Loss: 0.060 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.8714420795440674
Epoch: 26, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.059 Vali Acc: 0.986 Test Loss: 0.059 Test Acc: 0.986
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.55552339553833
Epoch: 27, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.061 Vali Acc: 0.986 Test Loss: 0.061 Test Acc: 0.986
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.3656115531921387
Epoch: 28, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.66998553276062
Epoch: 29, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.078 Vali Acc: 0.985 Test Loss: 0.078 Test Acc: 0.985
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.8380935192108154
Epoch: 30, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.070 Vali Acc: 0.984 Test Loss: 0.070 Test Acc: 0.984
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 2.7015628814697266
Epoch: 31, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.065 Vali Acc: 0.984 Test Loss: 0.065 Test Acc: 0.984
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 2.673577070236206
Epoch: 32, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.067 Vali Acc: 0.985 Test Loss: 0.067 Test Acc: 0.985
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 2.5461273193359375
Epoch: 33, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.068 Vali Acc: 0.985 Test Loss: 0.068 Test Acc: 0.985
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 2.8538479804992676
Epoch: 34, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.051 Vali Acc: 0.987 Test Loss: 0.051 Test Acc: 0.987
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr4_ps46_str23_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9902506963788301
model parameter : 160372
model size : 0.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.582757472991943
Epoch: 1, Steps: 89 | Train Loss: 1.128 Vali Loss: 0.357 Vali Acc: 0.900 Test Loss: 0.357 Test Acc: 0.900
Validation loss decreased (inf --> -0.900414).  Saving model ...
Epoch: 2 cost time: 6.053251266479492
Epoch: 2, Steps: 89 | Train Loss: 0.201 Vali Loss: 0.193 Vali Acc: 0.955 Test Loss: 0.193 Test Acc: 0.955
Validation loss decreased (-0.900414 --> -0.955430).  Saving model ...
Epoch: 3 cost time: 5.264888525009155
Epoch: 3, Steps: 89 | Train Loss: 0.113 Vali Loss: 0.235 Vali Acc: 0.941 Test Loss: 0.235 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.8833167552948
Epoch: 4, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.195 Vali Acc: 0.956 Test Loss: 0.195 Test Acc: 0.956
Validation loss decreased (-0.955430 --> -0.956126).  Saving model ...
Epoch: 5 cost time: 4.0833306312561035
Epoch: 5, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.170 Vali Acc: 0.966 Test Loss: 0.170 Test Acc: 0.966
Validation loss decreased (-0.956126 --> -0.965876).  Saving model ...
Epoch: 6 cost time: 5.070666313171387
Epoch: 6, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.247 Vali Acc: 0.946 Test Loss: 0.247 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.8096418380737305
Epoch: 7, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.342 Vali Acc: 0.955 Test Loss: 0.342 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.315611124038696
Epoch: 8, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.284 Vali Acc: 0.958 Test Loss: 0.284 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.487325191497803
Epoch: 9, Steps: 89 | Train Loss: 0.127 Vali Loss: 0.196 Vali Acc: 0.977 Test Loss: 0.196 Test Acc: 0.977
Validation loss decreased (-0.965876 --> -0.977018).  Saving model ...
Epoch: 10 cost time: 4.951847314834595
Epoch: 10, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.217 Vali Acc: 0.962 Test Loss: 0.217 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.030667781829834
Epoch: 11, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.211 Vali Acc: 0.978 Test Loss: 0.211 Test Acc: 0.978
Validation loss decreased (-0.977018 --> -0.978410).  Saving model ...
Epoch: 12 cost time: 5.467003583908081
Epoch: 12, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.451 Vali Acc: 0.951 Test Loss: 0.451 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.081668138504028
Epoch: 13, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.393 Vali Acc: 0.955 Test Loss: 0.393 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.67901611328125
Epoch: 14, Steps: 89 | Train Loss: 0.131 Vali Loss: 0.191 Vali Acc: 0.974 Test Loss: 0.191 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 6.042867183685303
Epoch: 15, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.337 Vali Acc: 0.961 Test Loss: 0.337 Test Acc: 0.961
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 6.206200838088989
Epoch: 16, Steps: 89 | Train Loss: 0.083 Vali Loss: 1.891 Vali Acc: 0.868 Test Loss: 1.891 Test Acc: 0.868
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.788009166717529
Epoch: 17, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.350 Vali Acc: 0.975 Test Loss: 0.350 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 5.803523302078247
Epoch: 18, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.273 Vali Acc: 0.969 Test Loss: 0.273 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 5.387231349945068
Epoch: 19, Steps: 89 | Train Loss: 0.164 Vali Loss: 0.621 Vali Acc: 0.952 Test Loss: 0.621 Test Acc: 0.952
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 5.407058477401733
Epoch: 20, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.293 Vali Acc: 0.971 Test Loss: 0.293 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 6.552206039428711
Epoch: 21, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.227 Vali Acc: 0.983 Test Loss: 0.227 Test Acc: 0.983
Validation loss decreased (-0.978410 --> -0.983285).  Saving model ...
Epoch: 22 cost time: 5.426141262054443
Epoch: 22, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.241 Vali Acc: 0.983 Test Loss: 0.241 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 6.602217197418213
Epoch: 23, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.445 Vali Acc: 0.969 Test Loss: 0.445 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 7.047764778137207
Epoch: 24, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.271 Vali Acc: 0.978 Test Loss: 0.271 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 7.020062208175659
Epoch: 25, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.378 Vali Acc: 0.974 Test Loss: 0.378 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 6.9704320430755615
Epoch: 26, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.794 Vali Acc: 0.933 Test Loss: 0.794 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 5.756460905075073
Epoch: 27, Steps: 89 | Train Loss: 0.203 Vali Loss: 0.732 Vali Acc: 0.958 Test Loss: 0.732 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 7.350865125656128
Epoch: 28, Steps: 89 | Train Loss: 0.152 Vali Loss: 0.412 Vali Acc: 0.964 Test Loss: 0.412 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 5.989703893661499
Epoch: 29, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.390 Vali Acc: 0.976 Test Loss: 0.390 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 7.880756378173828
Epoch: 30, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.809 Vali Acc: 0.958 Test Loss: 0.809 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 4.972216844558716
Epoch: 31, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.508 Vali Acc: 0.970 Test Loss: 0.508 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9832869080779945
model parameter : 2554644
model size : 9.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.645288705825806
Epoch: 1, Steps: 89 | Train Loss: 1.296 Vali Loss: 0.361 Vali Acc: 0.904 Test Loss: 0.361 Test Acc: 0.904
Validation loss decreased (inf --> -0.903896).  Saving model ...
Epoch: 2 cost time: 4.915665626525879
Epoch: 2, Steps: 89 | Train Loss: 0.197 Vali Loss: 0.148 Vali Acc: 0.962 Test Loss: 0.148 Test Acc: 0.962
Validation loss decreased (-0.903896 --> -0.961698).  Saving model ...
Epoch: 3 cost time: 5.1803717613220215
Epoch: 3, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.143 Vali Acc: 0.962 Test Loss: 0.143 Test Acc: 0.962
Validation loss decreased (-0.961698 --> -0.961698).  Saving model ...
Epoch: 4 cost time: 4.87832236289978
Epoch: 4, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.123 Vali Acc: 0.970 Test Loss: 0.123 Test Acc: 0.970
Validation loss decreased (-0.961698 --> -0.970054).  Saving model ...
Epoch: 5 cost time: 4.590756177902222
Epoch: 5, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.100 Vali Acc: 0.976 Test Loss: 0.100 Test Acc: 0.976
Validation loss decreased (-0.970054 --> -0.976322).  Saving model ...
Epoch: 6 cost time: 5.751944303512573
Epoch: 6, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.142 Vali Acc: 0.968 Test Loss: 0.142 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.748597145080566
Epoch: 7, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.127 Vali Acc: 0.971 Test Loss: 0.127 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.7927069664001465
Epoch: 8, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.145 Vali Acc: 0.974 Test Loss: 0.145 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 6.1227126121521
Epoch: 9, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.294 Vali Acc: 0.944 Test Loss: 0.294 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.079240322113037
Epoch: 10, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.224 Vali Acc: 0.968 Test Loss: 0.224 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 5.7672278881073
Epoch: 11, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.218 Vali Acc: 0.969 Test Loss: 0.218 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 5.337021827697754
Epoch: 12, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.319 Vali Acc: 0.949 Test Loss: 0.319 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 5.311304569244385
Epoch: 13, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.297 Vali Acc: 0.969 Test Loss: 0.297 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 5.39301323890686
Epoch: 14, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.300 Vali Acc: 0.965 Test Loss: 0.300 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 5.495917081832886
Epoch: 15, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.461 Vali Acc: 0.955 Test Loss: 0.461 Test Acc: 0.955
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9763231197771588
model parameter : 2370964
model size : 9.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps14_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.745966911315918
Epoch: 1, Steps: 89 | Train Loss: 1.413 Vali Loss: 0.375 Vali Acc: 0.898 Test Loss: 0.375 Test Acc: 0.898
Validation loss decreased (inf --> -0.897629).  Saving model ...
Epoch: 2 cost time: 4.413753986358643
Epoch: 2, Steps: 89 | Train Loss: 0.222 Vali Loss: 0.142 Vali Acc: 0.964 Test Loss: 0.142 Test Acc: 0.964
Validation loss decreased (-0.897629 --> -0.963787).  Saving model ...
Epoch: 3 cost time: 5.088961839675903
Epoch: 3, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.123 Vali Acc: 0.966 Test Loss: 0.123 Test Acc: 0.966
Validation loss decreased (-0.963787 --> -0.965876).  Saving model ...
Epoch: 4 cost time: 4.556156873703003
Epoch: 4, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.136 Vali Acc: 0.969 Test Loss: 0.136 Test Acc: 0.969
Validation loss decreased (-0.965876 --> -0.968662).  Saving model ...
Epoch: 5 cost time: 3.22084903717041
Epoch: 5, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.968662 --> -0.977019).  Saving model ...
Epoch: 6 cost time: 4.3351147174835205
Epoch: 6, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.749222278594971
Epoch: 7, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.156 Vali Acc: 0.973 Test Loss: 0.156 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.6300692558288574
Epoch: 8, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.408 Vali Acc: 0.931 Test Loss: 0.408 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.153849840164185
Epoch: 9, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.111 Vali Acc: 0.978 Test Loss: 0.111 Test Acc: 0.978
Validation loss decreased (-0.977019 --> -0.977715).  Saving model ...
Epoch: 10 cost time: 3.776949167251587
Epoch: 10, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.156 Vali Acc: 0.973 Test Loss: 0.156 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.830841064453125
Epoch: 11, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.137 Vali Acc: 0.976 Test Loss: 0.137 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.579176187515259
Epoch: 12, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.151 Vali Acc: 0.976 Test Loss: 0.151 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.7075042724609375
Epoch: 13, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.293 Vali Acc: 0.953 Test Loss: 0.293 Test Acc: 0.953
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.6117606163024902
Epoch: 14, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.183 Vali Acc: 0.973 Test Loss: 0.183 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.3173470497131348
Epoch: 15, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.198 Vali Acc: 0.979 Test Loss: 0.198 Test Acc: 0.979
Validation loss decreased (-0.977715 --> -0.979107).  Saving model ...
Epoch: 16 cost time: 3.7772135734558105
Epoch: 16, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.322 Vali Acc: 0.949 Test Loss: 0.322 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.6498939990997314
Epoch: 17, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.130 Vali Acc: 0.981 Test Loss: 0.130 Test Acc: 0.981
Validation loss decreased (-0.979107 --> -0.981196).  Saving model ...
Epoch: 18 cost time: 4.832326650619507
Epoch: 18, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.190 Vali Acc: 0.977 Test Loss: 0.190 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.4376184940338135
Epoch: 19, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.139 Vali Acc: 0.983 Test Loss: 0.139 Test Acc: 0.983
Validation loss decreased (-0.981196 --> -0.982589).  Saving model ...
Epoch: 20 cost time: 3.5064198970794678
Epoch: 20, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.151 Vali Acc: 0.984 Test Loss: 0.151 Test Acc: 0.984
Validation loss decreased (-0.982589 --> -0.983982).  Saving model ...
Epoch: 21 cost time: 4.406991958618164
Epoch: 21, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.247 Vali Acc: 0.962 Test Loss: 0.247 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.1942665576934814
Epoch: 22, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.328 Vali Acc: 0.964 Test Loss: 0.328 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 4.0260632038116455
Epoch: 23, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.387 Vali Acc: 0.965 Test Loss: 0.387 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.1069798469543457
Epoch: 24, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.242 Vali Acc: 0.980 Test Loss: 0.242 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.3852105140686035
Epoch: 25, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.345 Vali Acc: 0.971 Test Loss: 0.345 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 4.4027040004730225
Epoch: 26, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.360 Vali Acc: 0.969 Test Loss: 0.360 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.9794487953186035
Epoch: 27, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.210 Vali Acc: 0.980 Test Loss: 0.210 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 3.772385358810425
Epoch: 28, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.214 Vali Acc: 0.977 Test Loss: 0.214 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 4.473468780517578
Epoch: 29, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.316 Vali Acc: 0.972 Test Loss: 0.316 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 3.381575584411621
Epoch: 30, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.258 Vali Acc: 0.972 Test Loss: 0.258 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps14_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.983983286908078
model parameter : 2294676
model size : 8.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps19_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.813230037689209
Epoch: 1, Steps: 89 | Train Loss: 1.541 Vali Loss: 0.396 Vali Acc: 0.900 Test Loss: 0.396 Test Acc: 0.900
Validation loss decreased (inf --> -0.900414).  Saving model ...
Epoch: 2 cost time: 3.518076181411743
Epoch: 2, Steps: 89 | Train Loss: 0.268 Vali Loss: 0.170 Vali Acc: 0.953 Test Loss: 0.170 Test Acc: 0.953
Validation loss decreased (-0.900414 --> -0.952645).  Saving model ...
Epoch: 3 cost time: 3.516754627227783
Epoch: 3, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.119 Vali Acc: 0.971 Test Loss: 0.119 Test Acc: 0.971
Validation loss decreased (-0.952645 --> -0.970751).  Saving model ...
Epoch: 4 cost time: 4.163275241851807
Epoch: 4, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.092 Vali Acc: 0.976 Test Loss: 0.092 Test Acc: 0.976
Validation loss decreased (-0.970751 --> -0.975626).  Saving model ...
Epoch: 5 cost time: 3.5610644817352295
Epoch: 5, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.088 Vali Acc: 0.978 Test Loss: 0.088 Test Acc: 0.978
Validation loss decreased (-0.975626 --> -0.978411).  Saving model ...
Epoch: 6 cost time: 4.216189622879028
Epoch: 6, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.084 Vali Acc: 0.979 Test Loss: 0.084 Test Acc: 0.979
Validation loss decreased (-0.978411 --> -0.979108).  Saving model ...
Epoch: 7 cost time: 4.112867593765259
Epoch: 7, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.087 Vali Acc: 0.981 Test Loss: 0.087 Test Acc: 0.981
Validation loss decreased (-0.979108 --> -0.980501).  Saving model ...
Epoch: 8 cost time: 3.268477439880371
Epoch: 8, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.785712242126465
Epoch: 9, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.176 Vali Acc: 0.962 Test Loss: 0.176 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.104817628860474
Epoch: 10, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.226 Vali Acc: 0.958 Test Loss: 0.226 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.9265098571777344
Epoch: 11, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.310 Vali Acc: 0.947 Test Loss: 0.310 Test Acc: 0.947
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.356133460998535
Epoch: 12, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.106 Vali Acc: 0.978 Test Loss: 0.106 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.6730899810791016
Epoch: 13, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.097 Vali Acc: 0.978 Test Loss: 0.097 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.0848634243011475
Epoch: 14, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.163 Vali Acc: 0.971 Test Loss: 0.163 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.368011236190796
Epoch: 15, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.099 Vali Acc: 0.986 Test Loss: 0.099 Test Acc: 0.986
Validation loss decreased (-0.980501 --> -0.986071).  Saving model ...
Epoch: 16 cost time: 3.79422664642334
Epoch: 16, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.223 Vali Acc: 0.967 Test Loss: 0.223 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.8930511474609375
Epoch: 17, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.167 Vali Acc: 0.977 Test Loss: 0.167 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.1304566860198975
Epoch: 18, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.153 Vali Acc: 0.982 Test Loss: 0.153 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.963434934616089
Epoch: 19, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.132 Vali Acc: 0.981 Test Loss: 0.132 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 4.0366528034210205
Epoch: 20, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.203 Vali Acc: 0.976 Test Loss: 0.203 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 4.2963786125183105
Epoch: 21, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.109 Vali Acc: 0.988 Test Loss: 0.109 Test Acc: 0.988
Validation loss decreased (-0.986071 --> -0.988160).  Saving model ...
Epoch: 22 cost time: 3.3445446491241455
Epoch: 22, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.155 Vali Acc: 0.983 Test Loss: 0.155 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.8867599964141846
Epoch: 23, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.186 Vali Acc: 0.973 Test Loss: 0.186 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 4.032381534576416
Epoch: 24, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.130 Vali Acc: 0.983 Test Loss: 0.130 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.552072763442993
Epoch: 25, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.186 Vali Acc: 0.978 Test Loss: 0.186 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.706907033920288
Epoch: 26, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.130 Vali Acc: 0.980 Test Loss: 0.130 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.9444420337677
Epoch: 27, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.196 Vali Acc: 0.978 Test Loss: 0.196 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 3.8716256618499756
Epoch: 28, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.171 Vali Acc: 0.980 Test Loss: 0.171 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 4.1810667514801025
Epoch: 29, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.212 Vali Acc: 0.981 Test Loss: 0.212 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 4.228804349899292
Epoch: 30, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.186 Vali Acc: 0.985 Test Loss: 0.186 Test Acc: 0.985
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 4.275373935699463
Epoch: 31, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.137 Vali Acc: 0.985 Test Loss: 0.137 Test Acc: 0.985
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps19_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9881615598885793
model parameter : 2233876
model size : 8.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps28_str14_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.800938129425049
Epoch: 1, Steps: 89 | Train Loss: 1.689 Vali Loss: 0.484 Vali Acc: 0.873 Test Loss: 0.484 Test Acc: 0.873
Validation loss decreased (inf --> -0.873254).  Saving model ...
Epoch: 2 cost time: 4.319952011108398
Epoch: 2, Steps: 89 | Train Loss: 0.285 Vali Loss: 0.160 Vali Acc: 0.962 Test Loss: 0.160 Test Acc: 0.962
Validation loss decreased (-0.873254 --> -0.962394).  Saving model ...
Epoch: 3 cost time: 4.116842985153198
Epoch: 3, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.084 Vali Acc: 0.981 Test Loss: 0.084 Test Acc: 0.981
Validation loss decreased (-0.962394 --> -0.981197).  Saving model ...
Epoch: 4 cost time: 4.489548444747925
Epoch: 4, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.096 Vali Acc: 0.978 Test Loss: 0.096 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.985441207885742
Epoch: 5, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.067 Vali Acc: 0.984 Test Loss: 0.067 Test Acc: 0.984
Validation loss decreased (-0.981197 --> -0.983983).  Saving model ...
Epoch: 6 cost time: 4.0938475131988525
Epoch: 6, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.073 Vali Acc: 0.981 Test Loss: 0.073 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.15030837059021
Epoch: 7, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.136 Vali Acc: 0.975 Test Loss: 0.136 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.455729246139526
Epoch: 8, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.097 Vali Acc: 0.981 Test Loss: 0.097 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.553434371948242
Epoch: 9, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.062 Vali Acc: 0.981 Test Loss: 0.062 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.6361351013183594
Epoch: 10, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.279310464859009
Epoch: 11, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.140 Vali Acc: 0.969 Test Loss: 0.140 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.5482800006866455
Epoch: 12, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.104 Vali Acc: 0.978 Test Loss: 0.104 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 4.5048158168792725
Epoch: 13, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.189 Vali Acc: 0.960 Test Loss: 0.189 Test Acc: 0.960
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 4.097070217132568
Epoch: 14, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.115 Vali Acc: 0.978 Test Loss: 0.115 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 4.111492156982422
Epoch: 15, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.132 Vali Acc: 0.976 Test Loss: 0.132 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps28_str14_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.983983286908078
model parameter : 2204308
model size : 8.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps37_str19_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.278491258621216
Epoch: 1, Steps: 89 | Train Loss: 1.802 Vali Loss: 0.615 Vali Acc: 0.852 Test Loss: 0.615 Test Acc: 0.852
Validation loss decreased (inf --> -0.852362).  Saving model ...
Epoch: 2 cost time: 3.992591142654419
Epoch: 2, Steps: 89 | Train Loss: 0.344 Vali Loss: 0.207 Vali Acc: 0.951 Test Loss: 0.207 Test Acc: 0.951
Validation loss decreased (-0.852362 --> -0.951251).  Saving model ...
Epoch: 3 cost time: 3.4435956478118896
Epoch: 3, Steps: 89 | Train Loss: 0.125 Vali Loss: 0.115 Vali Acc: 0.970 Test Loss: 0.115 Test Acc: 0.970
Validation loss decreased (-0.951251 --> -0.970055).  Saving model ...
Epoch: 4 cost time: 3.7948904037475586
Epoch: 4, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.970055 --> -0.979804).  Saving model ...
Epoch: 5 cost time: 3.653762102127075
Epoch: 5, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.093 Vali Acc: 0.974 Test Loss: 0.093 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.001202344894409
Epoch: 6, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.084 Vali Acc: 0.981 Test Loss: 0.084 Test Acc: 0.981
Validation loss decreased (-0.979804 --> -0.980501).  Saving model ...
Epoch: 7 cost time: 4.116685152053833
Epoch: 7, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.7465569972991943
Epoch: 8, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.060 Vali Acc: 0.983 Test Loss: 0.060 Test Acc: 0.983
Validation loss decreased (-0.980501 --> -0.982590).  Saving model ...
Epoch: 9 cost time: 3.985231876373291
Epoch: 9, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.081 Vali Acc: 0.975 Test Loss: 0.081 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.6401164531707764
Epoch: 10, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.096 Vali Acc: 0.978 Test Loss: 0.096 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.4958977699279785
Epoch: 11, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.093 Vali Acc: 0.978 Test Loss: 0.093 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.063673734664917
Epoch: 12, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.7859251499176025
Epoch: 13, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.079 Vali Acc: 0.984 Test Loss: 0.079 Test Acc: 0.984
Validation loss decreased (-0.982590 --> -0.983982).  Saving model ...
Epoch: 14 cost time: 3.5075888633728027
Epoch: 14, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.128 Vali Acc: 0.973 Test Loss: 0.128 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.648927688598633
Epoch: 15, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.139 Vali Acc: 0.976 Test Loss: 0.139 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.895507574081421
Epoch: 16, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.097 Vali Acc: 0.982 Test Loss: 0.097 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.5529348850250244
Epoch: 17, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.122 Vali Acc: 0.983 Test Loss: 0.122 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.9170563220977783
Epoch: 18, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.125 Vali Acc: 0.977 Test Loss: 0.125 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.616516590118408
Epoch: 19, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.253 Vali Acc: 0.961 Test Loss: 0.253 Test Acc: 0.961
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.665381669998169
Epoch: 20, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.186 Vali Acc: 0.966 Test Loss: 0.186 Test Acc: 0.966
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.766916036605835
Epoch: 21, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.130 Vali Acc: 0.978 Test Loss: 0.130 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.455352544784546
Epoch: 22, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.080 Vali Acc: 0.987 Test Loss: 0.080 Test Acc: 0.987
Validation loss decreased (-0.983982 --> -0.987464).  Saving model ...
Epoch: 23 cost time: 3.038330316543579
Epoch: 23, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.117 Vali Acc: 0.982 Test Loss: 0.117 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.144608974456787
Epoch: 24, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.091 Vali Acc: 0.986 Test Loss: 0.091 Test Acc: 0.986
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.515066623687744
Epoch: 25, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.103 Vali Acc: 0.987 Test Loss: 0.103 Test Acc: 0.987
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.737107038497925
Epoch: 26, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.180 Vali Acc: 0.974 Test Loss: 0.180 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.626769781112671
Epoch: 27, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.135 Vali Acc: 0.987 Test Loss: 0.135 Test Acc: 0.987
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 3.8832106590270996
Epoch: 28, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.137 Vali Acc: 0.983 Test Loss: 0.137 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 3.6893086433410645
Epoch: 29, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.354 Vali Acc: 0.942 Test Loss: 0.354 Test Acc: 0.942
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 3.6125173568725586
Epoch: 30, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.111 Vali Acc: 0.979 Test Loss: 0.111 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 3.772216320037842
Epoch: 31, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.113 Vali Acc: 0.985 Test Loss: 0.113 Test Acc: 0.985
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 3.4617459774017334
Epoch: 32, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.235 Vali Acc: 0.971 Test Loss: 0.235 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps37_str19_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9874651810584958
model parameter : 2174740
model size : 8.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps46_str23_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.5686938762664795
Epoch: 1, Steps: 89 | Train Loss: 1.912 Vali Loss: 0.704 Vali Acc: 0.843 Test Loss: 0.704 Test Acc: 0.843
Validation loss decreased (inf --> -0.843308).  Saving model ...
Epoch: 2 cost time: 3.507431745529175
Epoch: 2, Steps: 89 | Train Loss: 0.394 Vali Loss: 0.251 Vali Acc: 0.928 Test Loss: 0.251 Test Acc: 0.928
Validation loss decreased (-0.843308 --> -0.928270).  Saving model ...
Epoch: 3 cost time: 3.322347640991211
Epoch: 3, Steps: 89 | Train Loss: 0.158 Vali Loss: 0.131 Vali Acc: 0.969 Test Loss: 0.131 Test Acc: 0.969
Validation loss decreased (-0.928270 --> -0.968662).  Saving model ...
Epoch: 4 cost time: 3.1614232063293457
Epoch: 4, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.103 Vali Acc: 0.974 Test Loss: 0.103 Test Acc: 0.974
Validation loss decreased (-0.968662 --> -0.973537).  Saving model ...
Epoch: 5 cost time: 3.3842403888702393
Epoch: 5, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.110 Vali Acc: 0.964 Test Loss: 0.110 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.6526708602905273
Epoch: 6, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.087 Vali Acc: 0.979 Test Loss: 0.087 Test Acc: 0.979
Validation loss decreased (-0.973537 --> -0.979108).  Saving model ...
Epoch: 7 cost time: 3.591195583343506
Epoch: 7, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.073 Vali Acc: 0.981 Test Loss: 0.073 Test Acc: 0.981
Validation loss decreased (-0.979108 --> -0.980501).  Saving model ...
Epoch: 8 cost time: 3.5661110877990723
Epoch: 8, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.099 Vali Acc: 0.976 Test Loss: 0.099 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.3668363094329834
Epoch: 9, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.081 Vali Acc: 0.978 Test Loss: 0.081 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.5854172706604004
Epoch: 10, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.101 Vali Acc: 0.976 Test Loss: 0.101 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.508957624435425
Epoch: 11, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.861043930053711
Epoch: 12, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.67641544342041
Epoch: 13, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.092 Vali Acc: 0.978 Test Loss: 0.092 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.8043882846832275
Epoch: 14, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.104 Vali Acc: 0.978 Test Loss: 0.104 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.686241626739502
Epoch: 15, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.168 Vali Acc: 0.967 Test Loss: 0.168 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.22751784324646
Epoch: 16, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.121 Vali Acc: 0.978 Test Loss: 0.121 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.631147861480713
Epoch: 17, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.074 Vali Acc: 0.985 Test Loss: 0.074 Test Acc: 0.985
Validation loss decreased (-0.980501 --> -0.984679).  Saving model ...
Epoch: 18 cost time: 3.574075698852539
Epoch: 18, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.093 Vali Acc: 0.981 Test Loss: 0.093 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.5083131790161133
Epoch: 19, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.097 Vali Acc: 0.983 Test Loss: 0.097 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.880478858947754
Epoch: 20, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.108 Vali Acc: 0.976 Test Loss: 0.108 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.4177517890930176
Epoch: 21, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.096 Vali Acc: 0.982 Test Loss: 0.096 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.6209475994110107
Epoch: 22, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.103 Vali Acc: 0.978 Test Loss: 0.103 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.80224347114563
Epoch: 23, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.208 Vali Acc: 0.971 Test Loss: 0.208 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.575413227081299
Epoch: 24, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.231 Vali Acc: 0.968 Test Loss: 0.231 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 4.093289136886597
Epoch: 25, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.231 Vali Acc: 0.965 Test Loss: 0.231 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 4.044987440109253
Epoch: 26, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.240 Vali Acc: 0.967 Test Loss: 0.240 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 3.689586877822876
Epoch: 27, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.169 Vali Acc: 0.978 Test Loss: 0.169 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr4_ps46_str23_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9846796657381616
model parameter : 2160532
model size : 8.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.26730489730835
Epoch: 1, Steps: 89 | Train Loss: 1.406 Vali Loss: 0.430 Vali Acc: 0.875 Test Loss: 0.430 Test Acc: 0.875
Validation loss decreased (inf --> -0.874648).  Saving model ...
Epoch: 2 cost time: 3.2000157833099365
Epoch: 2, Steps: 89 | Train Loss: 0.237 Vali Loss: 0.173 Vali Acc: 0.951 Test Loss: 0.173 Test Acc: 0.951
Validation loss decreased (-0.874648 --> -0.951252).  Saving model ...
Epoch: 3 cost time: 3.4855191707611084
Epoch: 3, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.197 Vali Acc: 0.953 Test Loss: 0.197 Test Acc: 0.953
Validation loss decreased (-0.951252 --> -0.953341).  Saving model ...
Epoch: 4 cost time: 2.9178292751312256
Epoch: 4, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.126 Vali Acc: 0.969 Test Loss: 0.126 Test Acc: 0.969
Validation loss decreased (-0.953341 --> -0.969358).  Saving model ...
Epoch: 5 cost time: 3.2310051918029785
Epoch: 5, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.146 Vali Acc: 0.965 Test Loss: 0.146 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.5629539489746094
Epoch: 6, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
Validation loss decreased (-0.969358 --> -0.977018).  Saving model ...
Epoch: 7 cost time: 2.857980728149414
Epoch: 7, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.121 Vali Acc: 0.979 Test Loss: 0.121 Test Acc: 0.979
Validation loss decreased (-0.977018 --> -0.979107).  Saving model ...
Epoch: 8 cost time: 3.214432954788208
Epoch: 8, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.135 Vali Acc: 0.981 Test Loss: 0.135 Test Acc: 0.981
Validation loss decreased (-0.979107 --> -0.981196).  Saving model ...
Epoch: 9 cost time: 3.669823408126831
Epoch: 9, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.182 Vali Acc: 0.966 Test Loss: 0.182 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.0904204845428467
Epoch: 10, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.118 Vali Acc: 0.981 Test Loss: 0.118 Test Acc: 0.981
Validation loss decreased (-0.981196 --> -0.981197).  Saving model ...
Epoch: 11 cost time: 2.857121229171753
Epoch: 11, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.159 Vali Acc: 0.981 Test Loss: 0.159 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.1579606533050537
Epoch: 12, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.249 Vali Acc: 0.960 Test Loss: 0.249 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.652921438217163
Epoch: 13, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.290 Vali Acc: 0.960 Test Loss: 0.290 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.17244553565979
Epoch: 14, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.179 Vali Acc: 0.967 Test Loss: 0.179 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.458714246749878
Epoch: 15, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.184 Vali Acc: 0.963 Test Loss: 0.184 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.334719181060791
Epoch: 16, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.210 Vali Acc: 0.975 Test Loss: 0.210 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.772918462753296
Epoch: 17, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.367 Vali Acc: 0.955 Test Loss: 0.367 Test Acc: 0.955
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.2365736961364746
Epoch: 18, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.151 Vali Acc: 0.982 Test Loss: 0.151 Test Acc: 0.982
Validation loss decreased (-0.981197 --> -0.981893).  Saving model ...
Epoch: 19 cost time: 3.274897813796997
Epoch: 19, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.163 Vali Acc: 0.982 Test Loss: 0.163 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.6818370819091797
Epoch: 20, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.256 Vali Acc: 0.969 Test Loss: 0.256 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.94522762298584
Epoch: 21, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.307 Vali Acc: 0.971 Test Loss: 0.307 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.9272983074188232
Epoch: 22, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.232 Vali Acc: 0.974 Test Loss: 0.232 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.511758327484131
Epoch: 23, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.168 Vali Acc: 0.980 Test Loss: 0.168 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.4284253120422363
Epoch: 24, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.158 Vali Acc: 0.979 Test Loss: 0.158 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.665947198867798
Epoch: 25, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.978 Test Loss: 0.202 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 3.8249406814575195
Epoch: 26, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.981 Test Loss: 0.208 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.8845980167388916
Epoch: 27, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.655 Vali Acc: 0.942 Test Loss: 0.655 Test Acc: 0.942
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 3.1732211112976074
Epoch: 28, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.273 Vali Acc: 0.972 Test Loss: 0.273 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9818941504178273
model parameter : 769428
model size : 2.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.829918146133423
Epoch: 1, Steps: 89 | Train Loss: 1.729 Vali Loss: 0.554 Vali Acc: 0.847 Test Loss: 0.554 Test Acc: 0.847
Validation loss decreased (inf --> -0.846791).  Saving model ...
Epoch: 2 cost time: 3.828714609146118
Epoch: 2, Steps: 89 | Train Loss: 0.292 Vali Loss: 0.188 Vali Acc: 0.948 Test Loss: 0.188 Test Acc: 0.948
Validation loss decreased (-0.846791 --> -0.947770).  Saving model ...
Epoch: 3 cost time: 3.204958200454712
Epoch: 3, Steps: 89 | Train Loss: 0.129 Vali Loss: 0.124 Vali Acc: 0.964 Test Loss: 0.124 Test Acc: 0.964
Validation loss decreased (-0.947770 --> -0.964483).  Saving model ...
Epoch: 4 cost time: 3.2637126445770264
Epoch: 4, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.088 Vali Acc: 0.974 Test Loss: 0.088 Test Acc: 0.974
Validation loss decreased (-0.964483 --> -0.973537).  Saving model ...
Epoch: 5 cost time: 2.9317691326141357
Epoch: 5, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.118 Vali Acc: 0.973 Test Loss: 0.118 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.926227569580078
Epoch: 6, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.082 Vali Acc: 0.981 Test Loss: 0.082 Test Acc: 0.981
Validation loss decreased (-0.973537 --> -0.981197).  Saving model ...
Epoch: 7 cost time: 2.884550094604492
Epoch: 7, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
Validation loss decreased (-0.981197 --> -0.983286).  Saving model ...
Epoch: 8 cost time: 2.6064682006835938
Epoch: 8, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.101 Vali Acc: 0.981 Test Loss: 0.101 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.850550413131714
Epoch: 9, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.106 Vali Acc: 0.981 Test Loss: 0.106 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.1136953830718994
Epoch: 10, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.081 Vali Acc: 0.985 Test Loss: 0.081 Test Acc: 0.985
Validation loss decreased (-0.983286 --> -0.984679).  Saving model ...
Epoch: 11 cost time: 2.9164533615112305
Epoch: 11, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.169 Vali Acc: 0.964 Test Loss: 0.169 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.949493885040283
Epoch: 12, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.518 Vali Acc: 0.886 Test Loss: 0.518 Test Acc: 0.886
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.155735969543457
Epoch: 13, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.157 Vali Acc: 0.974 Test Loss: 0.157 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.573007822036743
Epoch: 14, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.190 Vali Acc: 0.974 Test Loss: 0.190 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.2155826091766357
Epoch: 15, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.173 Vali Acc: 0.976 Test Loss: 0.173 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.558209180831909
Epoch: 16, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.230 Vali Acc: 0.964 Test Loss: 0.230 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.0962469577789307
Epoch: 17, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.158 Vali Acc: 0.977 Test Loss: 0.158 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.8981831073760986
Epoch: 18, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.173 Vali Acc: 0.967 Test Loss: 0.173 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.725897789001465
Epoch: 19, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.123 Vali Acc: 0.983 Test Loss: 0.123 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.503098726272583
Epoch: 20, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.191 Vali Acc: 0.976 Test Loss: 0.191 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9846796657381616
model parameter : 677588
model size : 2.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps14_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.000314474105835
Epoch: 1, Steps: 89 | Train Loss: 1.812 Vali Loss: 0.591 Vali Acc: 0.846 Test Loss: 0.591 Test Acc: 0.846
Validation loss decreased (inf --> -0.846094).  Saving model ...
Epoch: 2 cost time: 2.722813129425049
Epoch: 2, Steps: 89 | Train Loss: 0.332 Vali Loss: 0.267 Vali Acc: 0.926 Test Loss: 0.267 Test Acc: 0.926
Validation loss decreased (-0.846094 --> -0.926181).  Saving model ...
Epoch: 3 cost time: 3.0313761234283447
Epoch: 3, Steps: 89 | Train Loss: 0.130 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
Validation loss decreased (-0.926181 --> -0.977018).  Saving model ...
Epoch: 4 cost time: 2.6030893325805664
Epoch: 4, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.115 Vali Acc: 0.967 Test Loss: 0.115 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.902218818664551
Epoch: 5, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.094 Vali Acc: 0.981 Test Loss: 0.094 Test Acc: 0.981
Validation loss decreased (-0.977018 --> -0.980500).  Saving model ...
Epoch: 6 cost time: 2.8113536834716797
Epoch: 6, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.096 Vali Acc: 0.971 Test Loss: 0.096 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.0558249950408936
Epoch: 7, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.076 Vali Acc: 0.981 Test Loss: 0.076 Test Acc: 0.981
Validation loss decreased (-0.980500 --> -0.980501).  Saving model ...
Epoch: 8 cost time: 2.739861488342285
Epoch: 8, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.080 Vali Acc: 0.982 Test Loss: 0.080 Test Acc: 0.982
Validation loss decreased (-0.980501 --> -0.981893).  Saving model ...
Epoch: 9 cost time: 2.8928897380828857
Epoch: 9, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.086 Vali Acc: 0.981 Test Loss: 0.086 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.8655202388763428
Epoch: 10, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.086 Vali Acc: 0.981 Test Loss: 0.086 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.707493782043457
Epoch: 11, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.088 Vali Acc: 0.979 Test Loss: 0.088 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.881498098373413
Epoch: 12, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.981 Test Loss: 0.084 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.8045482635498047
Epoch: 13, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.981893 --> -0.983286).  Saving model ...
Epoch: 14 cost time: 2.9079744815826416
Epoch: 14, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.127 Vali Acc: 0.971 Test Loss: 0.127 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.4168777465820312
Epoch: 15, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.9050543308258057
Epoch: 16, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.103 Vali Acc: 0.981 Test Loss: 0.103 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.0175373554229736
Epoch: 17, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.239 Vali Acc: 0.949 Test Loss: 0.239 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.736640214920044
Epoch: 18, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.087 Vali Acc: 0.985 Test Loss: 0.087 Test Acc: 0.985
Validation loss decreased (-0.983286 --> -0.985375).  Saving model ...
Epoch: 19 cost time: 3.038741111755371
Epoch: 19, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.151 Vali Acc: 0.974 Test Loss: 0.151 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.9221818447113037
Epoch: 20, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.162 Vali Acc: 0.973 Test Loss: 0.162 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.8054449558258057
Epoch: 21, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.134 Vali Acc: 0.978 Test Loss: 0.134 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.7512266635894775
Epoch: 22, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.138 Vali Acc: 0.981 Test Loss: 0.138 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.7144532203674316
Epoch: 23, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.102 Vali Acc: 0.983 Test Loss: 0.102 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.507288932800293
Epoch: 24, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.145 Vali Acc: 0.981 Test Loss: 0.145 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.4809625148773193
Epoch: 25, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.114 Vali Acc: 0.985 Test Loss: 0.114 Test Acc: 0.985
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.715831756591797
Epoch: 26, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.102 Vali Acc: 0.986 Test Loss: 0.102 Test Acc: 0.986
Validation loss decreased (-0.985375 --> -0.986071).  Saving model ...
Epoch: 27 cost time: 2.905665159225464
Epoch: 27, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.141 Vali Acc: 0.985 Test Loss: 0.141 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.8848049640655518
Epoch: 28, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.127 Vali Acc: 0.985 Test Loss: 0.127 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.5755791664123535
Epoch: 29, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.137 Vali Acc: 0.985 Test Loss: 0.137 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.677351951599121
Epoch: 30, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.123 Vali Acc: 0.985 Test Loss: 0.123 Test Acc: 0.985
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 2.807302474975586
Epoch: 31, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.123 Vali Acc: 0.986 Test Loss: 0.123 Test Acc: 0.986
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 3.0827646255493164
Epoch: 32, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.122 Vali Acc: 0.986 Test Loss: 0.122 Test Acc: 0.986
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 2.848109722137451
Epoch: 33, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.987 Test Loss: 0.113 Test Acc: 0.987
Validation loss decreased (-0.986071 --> -0.986768).  Saving model ...
Epoch: 34 cost time: 2.8810362815856934
Epoch: 34, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.128 Vali Acc: 0.986 Test Loss: 0.128 Test Acc: 0.986
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.028433084487915
Epoch: 35, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.986 Test Loss: 0.112 Test Acc: 0.986
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 2.8190059661865234
Epoch: 36, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.987 Test Loss: 0.117 Test Acc: 0.987
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 2.8043715953826904
Epoch: 37, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.987 Test Loss: 0.117 Test Acc: 0.987
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 2.8343663215637207
Epoch: 38, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.129 Vali Acc: 0.986 Test Loss: 0.129 Test Acc: 0.986
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 2.7812891006469727
Epoch: 39, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.124 Vali Acc: 0.986 Test Loss: 0.124 Test Acc: 0.986
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 2.8021926879882812
Epoch: 40, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.123 Vali Acc: 0.986 Test Loss: 0.123 Test Acc: 0.986
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 2.863680601119995
Epoch: 41, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.126 Vali Acc: 0.987 Test Loss: 0.126 Test Acc: 0.987
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 2.81565260887146
Epoch: 42, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.122 Vali Acc: 0.987 Test Loss: 0.122 Test Acc: 0.987
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 2.504065990447998
Epoch: 43, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.127 Vali Acc: 0.987 Test Loss: 0.127 Test Acc: 0.987
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps14_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9867688022284122
model parameter : 639444
model size : 2.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps19_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.826268196105957
Epoch: 1, Steps: 89 | Train Loss: 2.004 Vali Loss: 0.761 Vali Acc: 0.838 Test Loss: 0.761 Test Acc: 0.838
Validation loss decreased (inf --> -0.838433).  Saving model ...
Epoch: 2 cost time: 3.315530300140381
Epoch: 2, Steps: 89 | Train Loss: 0.417 Vali Loss: 0.253 Vali Acc: 0.940 Test Loss: 0.253 Test Acc: 0.940
Validation loss decreased (-0.838433 --> -0.940109).  Saving model ...
Epoch: 3 cost time: 3.083569288253784
Epoch: 3, Steps: 89 | Train Loss: 0.143 Vali Loss: 0.131 Vali Acc: 0.972 Test Loss: 0.131 Test Acc: 0.972
Validation loss decreased (-0.940109 --> -0.972144).  Saving model ...
Epoch: 4 cost time: 3.009824752807617
Epoch: 4, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.151 Vali Acc: 0.951 Test Loss: 0.151 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.7654383182525635
Epoch: 5, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.081 Vali Acc: 0.981 Test Loss: 0.081 Test Acc: 0.981
Validation loss decreased (-0.972144 --> -0.981197).  Saving model ...
Epoch: 6 cost time: 3.1498727798461914
Epoch: 6, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.088 Vali Acc: 0.978 Test Loss: 0.088 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.646718740463257
Epoch: 7, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.076 Vali Acc: 0.976 Test Loss: 0.076 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.5439579486846924
Epoch: 8, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.086 Vali Acc: 0.981 Test Loss: 0.086 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.766246795654297
Epoch: 9, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.981197 --> -0.982590).  Saving model ...
Epoch: 10 cost time: 2.9180333614349365
Epoch: 10, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.072 Vali Acc: 0.981 Test Loss: 0.072 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.7514920234680176
Epoch: 11, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.063 Vali Acc: 0.981 Test Loss: 0.063 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.4301209449768066
Epoch: 12, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.067 Vali Acc: 0.984 Test Loss: 0.067 Test Acc: 0.984
Validation loss decreased (-0.982590 --> -0.983983).  Saving model ...
Epoch: 13 cost time: 2.620805025100708
Epoch: 13, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.065 Vali Acc: 0.985 Test Loss: 0.065 Test Acc: 0.985
Validation loss decreased (-0.983983 --> -0.984679).  Saving model ...
Epoch: 14 cost time: 2.840196132659912
Epoch: 14, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.985 Test Loss: 0.074 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.5140185356140137
Epoch: 15, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.126 Vali Acc: 0.969 Test Loss: 0.126 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.594129800796509
Epoch: 16, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.0765457153320312
Epoch: 17, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.133 Vali Acc: 0.978 Test Loss: 0.133 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.251447916030884
Epoch: 18, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.090 Vali Acc: 0.985 Test Loss: 0.090 Test Acc: 0.985
Validation loss decreased (-0.984679 --> -0.985375).  Saving model ...
Epoch: 19 cost time: 3.0774495601654053
Epoch: 19, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.080 Vali Acc: 0.987 Test Loss: 0.080 Test Acc: 0.987
Validation loss decreased (-0.985375 --> -0.986768).  Saving model ...
Epoch: 20 cost time: 2.6310722827911377
Epoch: 20, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.194 Vali Acc: 0.974 Test Loss: 0.194 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.9825360774993896
Epoch: 21, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.052518367767334
Epoch: 22, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.138 Vali Acc: 0.967 Test Loss: 0.138 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.0290186405181885
Epoch: 23, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.137 Vali Acc: 0.978 Test Loss: 0.137 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.4112534523010254
Epoch: 24, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.172 Vali Acc: 0.971 Test Loss: 0.172 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.9120776653289795
Epoch: 25, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.112 Vali Acc: 0.984 Test Loss: 0.112 Test Acc: 0.984
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.8800201416015625
Epoch: 26, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.086 Vali Acc: 0.986 Test Loss: 0.086 Test Acc: 0.986
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.6146492958068848
Epoch: 27, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.103 Vali Acc: 0.983 Test Loss: 0.103 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.946661949157715
Epoch: 28, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.115 Vali Acc: 0.981 Test Loss: 0.115 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 3.1812331676483154
Epoch: 29, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.176 Vali Acc: 0.976 Test Loss: 0.176 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps19_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9867688022284122
model parameter : 609044
model size : 2.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps28_str14_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.331383943557739
Epoch: 1, Steps: 89 | Train Loss: 2.128 Vali Loss: 0.935 Vali Acc: 0.836 Test Loss: 0.935 Test Acc: 0.836
Validation loss decreased (inf --> -0.836342).  Saving model ...
Epoch: 2 cost time: 2.7403721809387207
Epoch: 2, Steps: 89 | Train Loss: 0.502 Vali Loss: 0.310 Vali Acc: 0.912 Test Loss: 0.310 Test Acc: 0.912
Validation loss decreased (-0.836342 --> -0.912253).  Saving model ...
Epoch: 3 cost time: 2.945293664932251
Epoch: 3, Steps: 89 | Train Loss: 0.190 Vali Loss: 0.139 Vali Acc: 0.974 Test Loss: 0.139 Test Acc: 0.974
Validation loss decreased (-0.912253 --> -0.974233).  Saving model ...
Epoch: 4 cost time: 2.9300544261932373
Epoch: 4, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.104 Vali Acc: 0.974 Test Loss: 0.104 Test Acc: 0.974
Validation loss decreased (-0.974233 --> -0.974233).  Saving model ...
Epoch: 5 cost time: 3.097860336303711
Epoch: 5, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.167 Vali Acc: 0.945 Test Loss: 0.167 Test Acc: 0.945
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.737489700317383
Epoch: 6, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.974233 --> -0.982590).  Saving model ...
Epoch: 7 cost time: 3.196601629257202
Epoch: 7, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.1768224239349365
Epoch: 8, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.070 Vali Acc: 0.982 Test Loss: 0.070 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.490612745285034
Epoch: 9, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.062 Vali Acc: 0.987 Test Loss: 0.062 Test Acc: 0.987
Validation loss decreased (-0.982590 --> -0.987465).  Saving model ...
Epoch: 10 cost time: 2.80556058883667
Epoch: 10, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.100 Vali Acc: 0.969 Test Loss: 0.100 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.081695795059204
Epoch: 11, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.109 Vali Acc: 0.978 Test Loss: 0.109 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.188251495361328
Epoch: 12, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.087 Vali Acc: 0.979 Test Loss: 0.087 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.892301321029663
Epoch: 13, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.072 Vali Acc: 0.981 Test Loss: 0.072 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.8638131618499756
Epoch: 14, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.065 Vali Acc: 0.985 Test Loss: 0.065 Test Acc: 0.985
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.024461269378662
Epoch: 15, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.056 Vali Acc: 0.987 Test Loss: 0.056 Test Acc: 0.987
Validation loss decreased (-0.987465 --> -0.987465).  Saving model ...
Epoch: 16 cost time: 2.768799304962158
Epoch: 16, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.057 Vali Acc: 0.988 Test Loss: 0.057 Test Acc: 0.988
Validation loss decreased (-0.987465 --> -0.988161).  Saving model ...
Epoch: 17 cost time: 3.050624370574951
Epoch: 17, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.055 Vali Acc: 0.990 Test Loss: 0.055 Test Acc: 0.990
Validation loss decreased (-0.988161 --> -0.989554).  Saving model ...
Epoch: 18 cost time: 3.3508737087249756
Epoch: 18, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.056 Vali Acc: 0.989 Test Loss: 0.056 Test Acc: 0.989
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.8901326656341553
Epoch: 19, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.058 Vali Acc: 0.988 Test Loss: 0.058 Test Acc: 0.988
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.837390422821045
Epoch: 20, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.058 Vali Acc: 0.989 Test Loss: 0.058 Test Acc: 0.989
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.893005847930908
Epoch: 21, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.061 Vali Acc: 0.988 Test Loss: 0.061 Test Acc: 0.988
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.004240036010742
Epoch: 22, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.053 Vali Acc: 0.990 Test Loss: 0.053 Test Acc: 0.990
Validation loss decreased (-0.989554 --> -0.989554).  Saving model ...
Epoch: 23 cost time: 2.8275606632232666
Epoch: 23, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.058 Vali Acc: 0.988 Test Loss: 0.058 Test Acc: 0.988
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.068594217300415
Epoch: 24, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.061 Vali Acc: 0.989 Test Loss: 0.061 Test Acc: 0.989
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.0872855186462402
Epoch: 25, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.133 Vali Acc: 0.976 Test Loss: 0.133 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.6801247596740723
Epoch: 26, Steps: 89 | Train Loss: 0.142 Vali Loss: 0.336 Vali Acc: 0.931 Test Loss: 0.336 Test Acc: 0.931
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.0058624744415283
Epoch: 27, Steps: 89 | Train Loss: 0.113 Vali Loss: 0.158 Vali Acc: 0.971 Test Loss: 0.158 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 3.0818705558776855
Epoch: 28, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.134 Vali Acc: 0.977 Test Loss: 0.134 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 3.1024200916290283
Epoch: 29, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.076 Vali Acc: 0.985 Test Loss: 0.076 Test Acc: 0.985
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.7044615745544434
Epoch: 30, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.179 Vali Acc: 0.967 Test Loss: 0.179 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 2.379497766494751
Epoch: 31, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.091 Vali Acc: 0.981 Test Loss: 0.091 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 2.396501064300537
Epoch: 32, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.223 Vali Acc: 0.968 Test Loss: 0.223 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps28_str14_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9895543175487466
model parameter : 594260
model size : 2.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps37_str19_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.72712516784668
Epoch: 1, Steps: 89 | Train Loss: 2.313 Vali Loss: 1.209 Vali Acc: 0.744 Test Loss: 1.209 Test Acc: 0.744
Validation loss decreased (inf --> -0.743721).  Saving model ...
Epoch: 2 cost time: 3.275726318359375
Epoch: 2, Steps: 89 | Train Loss: 0.657 Vali Loss: 0.360 Vali Acc: 0.916 Test Loss: 0.360 Test Acc: 0.916
Validation loss decreased (-0.743721 --> -0.916431).  Saving model ...
Epoch: 3 cost time: 2.9629056453704834
Epoch: 3, Steps: 89 | Train Loss: 0.233 Vali Loss: 0.164 Vali Acc: 0.962 Test Loss: 0.164 Test Acc: 0.962
Validation loss decreased (-0.916431 --> -0.961698).  Saving model ...
Epoch: 4 cost time: 3.033421039581299
Epoch: 4, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.101 Vali Acc: 0.976 Test Loss: 0.101 Test Acc: 0.976
Validation loss decreased (-0.961698 --> -0.975626).  Saving model ...
Epoch: 5 cost time: 3.115185499191284
Epoch: 5, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.081 Vali Acc: 0.982 Test Loss: 0.081 Test Acc: 0.982
Validation loss decreased (-0.975626 --> -0.981893).  Saving model ...
Epoch: 6 cost time: 3.4079434871673584
Epoch: 6, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.083 Vali Acc: 0.979 Test Loss: 0.083 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.464182138442993
Epoch: 7, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.076 Vali Acc: 0.978 Test Loss: 0.076 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.4179370403289795
Epoch: 8, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.065 Vali Acc: 0.984 Test Loss: 0.065 Test Acc: 0.984
Validation loss decreased (-0.981893 --> -0.983983).  Saving model ...
Epoch: 9 cost time: 3.2505996227264404
Epoch: 9, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.056 Vali Acc: 0.984 Test Loss: 0.056 Test Acc: 0.984
Validation loss decreased (-0.983983 --> -0.983983).  Saving model ...
Epoch: 10 cost time: 3.1981825828552246
Epoch: 10, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.061 Vali Acc: 0.985 Test Loss: 0.061 Test Acc: 0.985
Validation loss decreased (-0.983983 --> -0.985375).  Saving model ...
Epoch: 11 cost time: 3.1588058471679688
Epoch: 11, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.1367292404174805
Epoch: 12, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.069 Vali Acc: 0.978 Test Loss: 0.069 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.1476941108703613
Epoch: 13, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.1219353675842285
Epoch: 14, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.061 Vali Acc: 0.986 Test Loss: 0.061 Test Acc: 0.986
Validation loss decreased (-0.985375 --> -0.986072).  Saving model ...
Epoch: 15 cost time: 3.2736563682556152
Epoch: 15, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.069 Vali Acc: 0.988 Test Loss: 0.069 Test Acc: 0.988
Validation loss decreased (-0.986072 --> -0.988161).  Saving model ...
Epoch: 16 cost time: 3.0879485607147217
Epoch: 16, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.066 Vali Acc: 0.987 Test Loss: 0.066 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.133204460144043
Epoch: 17, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.298654556274414
Epoch: 18, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.047 Vali Acc: 0.987 Test Loss: 0.047 Test Acc: 0.987
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.390584707260132
Epoch: 19, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.083 Vali Acc: 0.985 Test Loss: 0.083 Test Acc: 0.985
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.4076154232025146
Epoch: 20, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.141 Vali Acc: 0.972 Test Loss: 0.141 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.3124492168426514
Epoch: 21, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.089 Vali Acc: 0.981 Test Loss: 0.089 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.149646759033203
Epoch: 22, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.112 Vali Acc: 0.978 Test Loss: 0.112 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.850513219833374
Epoch: 23, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.127 Vali Acc: 0.976 Test Loss: 0.127 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 3.017948627471924
Epoch: 24, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 3.3607256412506104
Epoch: 25, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.160 Vali Acc: 0.973 Test Loss: 0.160 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps37_str19_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9881615598885793
model parameter : 579476
model size : 2.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps46_str23_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.501391649246216
Epoch: 1, Steps: 89 | Train Loss: 2.426 Vali Loss: 1.442 Vali Acc: 0.667 Test Loss: 1.442 Test Acc: 0.667
Validation loss decreased (inf --> -0.667116).  Saving model ...
Epoch: 2 cost time: 2.746569871902466
Epoch: 2, Steps: 89 | Train Loss: 0.797 Vali Loss: 0.448 Vali Acc: 0.893 Test Loss: 0.448 Test Acc: 0.893
Validation loss decreased (-0.667116 --> -0.892753).  Saving model ...
Epoch: 3 cost time: 3.0193285942077637
Epoch: 3, Steps: 89 | Train Loss: 0.295 Vali Loss: 0.209 Vali Acc: 0.950 Test Loss: 0.209 Test Acc: 0.950
Validation loss decreased (-0.892753 --> -0.949859).  Saving model ...
Epoch: 4 cost time: 2.8042104244232178
Epoch: 4, Steps: 89 | Train Loss: 0.134 Vali Loss: 0.140 Vali Acc: 0.962 Test Loss: 0.140 Test Acc: 0.962
Validation loss decreased (-0.949859 --> -0.962394).  Saving model ...
Epoch: 5 cost time: 3.040853261947632
Epoch: 5, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.087 Vali Acc: 0.982 Test Loss: 0.087 Test Acc: 0.982
Validation loss decreased (-0.962394 --> -0.981893).  Saving model ...
Epoch: 6 cost time: 3.2916693687438965
Epoch: 6, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.981893 --> -0.982590).  Saving model ...
Epoch: 7 cost time: 3.2946410179138184
Epoch: 7, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.074 Vali Acc: 0.978 Test Loss: 0.074 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.900468111038208
Epoch: 8, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.065 Vali Acc: 0.982 Test Loss: 0.065 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.2736430168151855
Epoch: 9, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.077 Vali Acc: 0.981 Test Loss: 0.077 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.329451084136963
Epoch: 10, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.982590 --> -0.983286).  Saving model ...
Epoch: 11 cost time: 3.3511979579925537
Epoch: 11, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.058 Vali Acc: 0.985 Test Loss: 0.058 Test Acc: 0.985
Validation loss decreased (-0.983286 --> -0.985375).  Saving model ...
Epoch: 12 cost time: 3.1025142669677734
Epoch: 12, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.056 Vali Acc: 0.988 Test Loss: 0.056 Test Acc: 0.988
Validation loss decreased (-0.985375 --> -0.988161).  Saving model ...
Epoch: 13 cost time: 3.23848819732666
Epoch: 13, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.071 Vali Acc: 0.985 Test Loss: 0.071 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.9828805923461914
Epoch: 14, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.065 Vali Acc: 0.984 Test Loss: 0.065 Test Acc: 0.984
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.0254738330841064
Epoch: 15, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.057 Vali Acc: 0.988 Test Loss: 0.057 Test Acc: 0.988
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.9605093002319336
Epoch: 16, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.099170446395874
Epoch: 17, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.072 Vali Acc: 0.985 Test Loss: 0.072 Test Acc: 0.985
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.2241835594177246
Epoch: 18, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.3126654624938965
Epoch: 19, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.065 Vali Acc: 0.984 Test Loss: 0.065 Test Acc: 0.984
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.93459415435791
Epoch: 20, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.9252350330352783
Epoch: 21, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.167 Vali Acc: 0.964 Test Loss: 0.167 Test Acc: 0.964
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.1741998195648193
Epoch: 22, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr4_ps46_str23_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9881615598885793
model parameter : 572372
model size : 2.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.878732919692993
Epoch: 1, Steps: 89 | Train Loss: 1.810 Vali Loss: 0.581 Vali Acc: 0.859 Test Loss: 0.581 Test Acc: 0.859
Validation loss decreased (inf --> -0.858629).  Saving model ...
Epoch: 2 cost time: 2.7484617233276367
Epoch: 2, Steps: 89 | Train Loss: 0.319 Vali Loss: 0.193 Vali Acc: 0.951 Test Loss: 0.193 Test Acc: 0.951
Validation loss decreased (-0.858629 --> -0.951252).  Saving model ...
Epoch: 3 cost time: 2.0741326808929443
Epoch: 3, Steps: 89 | Train Loss: 0.127 Vali Loss: 0.134 Vali Acc: 0.968 Test Loss: 0.134 Test Acc: 0.968
Validation loss decreased (-0.951252 --> -0.967965).  Saving model ...
Epoch: 4 cost time: 2.5024304389953613
Epoch: 4, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.139 Vali Acc: 0.955 Test Loss: 0.139 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.9505960941314697
Epoch: 5, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.092 Vali Acc: 0.979 Test Loss: 0.092 Test Acc: 0.979
Validation loss decreased (-0.967965 --> -0.979108).  Saving model ...
Epoch: 6 cost time: 2.9909238815307617
Epoch: 6, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.140 Vali Acc: 0.967 Test Loss: 0.140 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.904240608215332
Epoch: 7, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.113 Vali Acc: 0.974 Test Loss: 0.113 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.5182738304138184
Epoch: 8, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.137 Vali Acc: 0.974 Test Loss: 0.137 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.8512375354766846
Epoch: 9, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.088 Vali Acc: 0.981 Test Loss: 0.088 Test Acc: 0.981
Validation loss decreased (-0.979108 --> -0.980501).  Saving model ...
Epoch: 10 cost time: 2.7018470764160156
Epoch: 10, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.453754186630249
Epoch: 11, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.272 Vali Acc: 0.947 Test Loss: 0.272 Test Acc: 0.947
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.156031608581543
Epoch: 12, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.187 Vali Acc: 0.962 Test Loss: 0.187 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.7193291187286377
Epoch: 13, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.114 Vali Acc: 0.981 Test Loss: 0.114 Test Acc: 0.981
Validation loss decreased (-0.980501 --> -0.981197).  Saving model ...
Epoch: 14 cost time: 2.828923463821411
Epoch: 14, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.093 Vali Acc: 0.981 Test Loss: 0.093 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.066758155822754
Epoch: 15, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.187 Vali Acc: 0.969 Test Loss: 0.187 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.0666959285736084
Epoch: 16, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.210 Vali Acc: 0.965 Test Loss: 0.210 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.618007183074951
Epoch: 17, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.131 Vali Acc: 0.979 Test Loss: 0.131 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.8850362300872803
Epoch: 18, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.114 Vali Acc: 0.984 Test Loss: 0.114 Test Acc: 0.984
Validation loss decreased (-0.981197 --> -0.983982).  Saving model ...
Epoch: 19 cost time: 3.0953316688537598
Epoch: 19, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.118 Vali Acc: 0.983 Test Loss: 0.118 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.9607269763946533
Epoch: 20, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.273 Vali Acc: 0.948 Test Loss: 0.273 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.846796751022339
Epoch: 21, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.217 Vali Acc: 0.975 Test Loss: 0.217 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.8770601749420166
Epoch: 22, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.154 Vali Acc: 0.981 Test Loss: 0.154 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.638826847076416
Epoch: 23, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.116 Vali Acc: 0.983 Test Loss: 0.116 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.6444127559661865
Epoch: 24, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.218 Vali Acc: 0.970 Test Loss: 0.218 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.1691861152648926
Epoch: 25, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.194 Vali Acc: 0.967 Test Loss: 0.194 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.9198052883148193
Epoch: 26, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.146 Vali Acc: 0.976 Test Loss: 0.146 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.957273006439209
Epoch: 27, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.146 Vali Acc: 0.981 Test Loss: 0.146 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.8395063877105713
Epoch: 28, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.148 Vali Acc: 0.981 Test Loss: 0.148 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.983983286908078
model parameter : 257748
model size : 1.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.5628132820129395
Epoch: 1, Steps: 89 | Train Loss: 2.179 Vali Loss: 0.972 Vali Acc: 0.782 Test Loss: 0.972 Test Acc: 0.782
Validation loss decreased (inf --> -0.782024).  Saving model ...
Epoch: 2 cost time: 2.846428632736206
Epoch: 2, Steps: 89 | Train Loss: 0.517 Vali Loss: 0.315 Vali Acc: 0.925 Test Loss: 0.315 Test Acc: 0.925
Validation loss decreased (-0.782024 --> -0.925484).  Saving model ...
Epoch: 3 cost time: 2.958996057510376
Epoch: 3, Steps: 89 | Train Loss: 0.213 Vali Loss: 0.174 Vali Acc: 0.960 Test Loss: 0.174 Test Acc: 0.960
Validation loss decreased (-0.925484 --> -0.960305).  Saving model ...
Epoch: 4 cost time: 2.869907855987549
Epoch: 4, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
Validation loss decreased (-0.960305 --> -0.972840).  Saving model ...
Epoch: 5 cost time: 2.6802103519439697
Epoch: 5, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.120 Vali Acc: 0.970 Test Loss: 0.120 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.7965199947357178
Epoch: 6, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.084 Vali Acc: 0.982 Test Loss: 0.084 Test Acc: 0.982
Validation loss decreased (-0.972840 --> -0.981893).  Saving model ...
Epoch: 7 cost time: 2.5506179332733154
Epoch: 7, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.100 Vali Acc: 0.978 Test Loss: 0.100 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.5883102416992188
Epoch: 8, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.035356283187866
Epoch: 9, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.060 Vali Acc: 0.985 Test Loss: 0.060 Test Acc: 0.985
Validation loss decreased (-0.981893 --> -0.984679).  Saving model ...
Epoch: 10 cost time: 2.8563075065612793
Epoch: 10, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.095 Vali Acc: 0.978 Test Loss: 0.095 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.9960501194000244
Epoch: 11, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.064 Vali Acc: 0.990 Test Loss: 0.064 Test Acc: 0.990
Validation loss decreased (-0.984679 --> -0.989554).  Saving model ...
Epoch: 12 cost time: 2.931488513946533
Epoch: 12, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.824833869934082
Epoch: 13, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.068 Vali Acc: 0.984 Test Loss: 0.068 Test Acc: 0.984
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.887002944946289
Epoch: 14, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.063 Vali Acc: 0.986 Test Loss: 0.063 Test Acc: 0.986
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.2971463203430176
Epoch: 15, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.985 Test Loss: 0.079 Test Acc: 0.985
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.8067781925201416
Epoch: 16, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.94075608253479
Epoch: 17, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.111 Vali Acc: 0.978 Test Loss: 0.111 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.294278621673584
Epoch: 18, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.126 Vali Acc: 0.975 Test Loss: 0.126 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.3165857791900635
Epoch: 19, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.122 Vali Acc: 0.981 Test Loss: 0.122 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.3092565536499023
Epoch: 20, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.125 Vali Acc: 0.975 Test Loss: 0.125 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 3.180185556411743
Epoch: 21, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.103 Vali Acc: 0.985 Test Loss: 0.103 Test Acc: 0.985
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9895543175487466
model parameter : 211828
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps14_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.185730218887329
Epoch: 1, Steps: 89 | Train Loss: 2.278 Vali Loss: 1.111 Vali Acc: 0.774 Test Loss: 1.111 Test Acc: 0.774
Validation loss decreased (inf --> -0.773666).  Saving model ...
Epoch: 2 cost time: 3.1042323112487793
Epoch: 2, Steps: 89 | Train Loss: 0.583 Vali Loss: 0.324 Vali Acc: 0.920 Test Loss: 0.324 Test Acc: 0.920
Validation loss decreased (-0.773666 --> -0.919913).  Saving model ...
Epoch: 3 cost time: 3.1701765060424805
Epoch: 3, Steps: 89 | Train Loss: 0.222 Vali Loss: 0.170 Vali Acc: 0.961 Test Loss: 0.170 Test Acc: 0.961
Validation loss decreased (-0.919913 --> -0.961001).  Saving model ...
Epoch: 4 cost time: 3.2832493782043457
Epoch: 4, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.136 Vali Acc: 0.961 Test Loss: 0.136 Test Acc: 0.961
Validation loss decreased (-0.961001 --> -0.961001).  Saving model ...
Epoch: 5 cost time: 2.9929158687591553
Epoch: 5, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.103 Vali Acc: 0.971 Test Loss: 0.103 Test Acc: 0.971
Validation loss decreased (-0.961001 --> -0.971447).  Saving model ...
Epoch: 6 cost time: 2.6646974086761475
Epoch: 6, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.082 Vali Acc: 0.982 Test Loss: 0.082 Test Acc: 0.982
Validation loss decreased (-0.971447 --> -0.981893).  Saving model ...
Epoch: 7 cost time: 2.912139892578125
Epoch: 7, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.080 Vali Acc: 0.982 Test Loss: 0.080 Test Acc: 0.982
Validation loss decreased (-0.981893 --> -0.981893).  Saving model ...
Epoch: 8 cost time: 3.104982852935791
Epoch: 8, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.0884246826171875
Epoch: 9, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.083 Vali Acc: 0.978 Test Loss: 0.083 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.9098129272460938
Epoch: 10, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.070 Vali Acc: 0.982 Test Loss: 0.070 Test Acc: 0.982
Validation loss decreased (-0.981893 --> -0.981893).  Saving model ...
Epoch: 11 cost time: 2.725494384765625
Epoch: 11, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.077 Vali Acc: 0.981 Test Loss: 0.077 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.867858648300171
Epoch: 12, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.078 Vali Acc: 0.975 Test Loss: 0.078 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.882913589477539
Epoch: 13, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.071 Vali Acc: 0.982 Test Loss: 0.071 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.7441365718841553
Epoch: 14, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.059 Vali Acc: 0.987 Test Loss: 0.059 Test Acc: 0.987
Validation loss decreased (-0.981893 --> -0.987465).  Saving model ...
Epoch: 15 cost time: 2.8024396896362305
Epoch: 15, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.066 Vali Acc: 0.985 Test Loss: 0.066 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.1510303020477295
Epoch: 16, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.064 Vali Acc: 0.985 Test Loss: 0.064 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.1153523921966553
Epoch: 17, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.069 Vali Acc: 0.982 Test Loss: 0.069 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.084021806716919
Epoch: 18, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.069 Vali Acc: 0.984 Test Loss: 0.069 Test Acc: 0.984
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.159996509552002
Epoch: 19, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.8124876022338867
Epoch: 20, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.077 Vali Acc: 0.986 Test Loss: 0.077 Test Acc: 0.986
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.5038623809814453
Epoch: 21, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.100 Vali Acc: 0.982 Test Loss: 0.100 Test Acc: 0.982
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.794368028640747
Epoch: 22, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.161 Vali Acc: 0.962 Test Loss: 0.161 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.912032127380371
Epoch: 23, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.080 Vali Acc: 0.984 Test Loss: 0.080 Test Acc: 0.984
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.092893123626709
Epoch: 24, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.126 Vali Acc: 0.977 Test Loss: 0.126 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps14_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9874651810584958
model parameter : 192756
model size : 0.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps19_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.106818199157715
Epoch: 1, Steps: 89 | Train Loss: 2.520 Vali Loss: 1.562 Vali Acc: 0.706 Test Loss: 1.562 Test Acc: 0.706
Validation loss decreased (inf --> -0.706113).  Saving model ...
Epoch: 2 cost time: 2.199089288711548
Epoch: 2, Steps: 89 | Train Loss: 0.847 Vali Loss: 0.443 Vali Acc: 0.891 Test Loss: 0.443 Test Acc: 0.891
Validation loss decreased (-0.706113 --> -0.890664).  Saving model ...
Epoch: 3 cost time: 2.338585615158081
Epoch: 3, Steps: 89 | Train Loss: 0.305 Vali Loss: 0.228 Vali Acc: 0.942 Test Loss: 0.228 Test Acc: 0.942
Validation loss decreased (-0.890664 --> -0.941502).  Saving model ...
Epoch: 4 cost time: 2.9694714546203613
Epoch: 4, Steps: 89 | Train Loss: 0.159 Vali Loss: 0.138 Vali Acc: 0.971 Test Loss: 0.138 Test Acc: 0.971
Validation loss decreased (-0.941502 --> -0.971447).  Saving model ...
Epoch: 5 cost time: 2.912936210632324
Epoch: 5, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.090 Vali Acc: 0.981 Test Loss: 0.090 Test Acc: 0.981
Validation loss decreased (-0.971447 --> -0.981197).  Saving model ...
Epoch: 6 cost time: 2.635709524154663
Epoch: 6, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.082 Vali Acc: 0.981 Test Loss: 0.082 Test Acc: 0.981
Validation loss decreased (-0.981197 --> -0.981197).  Saving model ...
Epoch: 7 cost time: 2.5445032119750977
Epoch: 7, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.981197 --> -0.983286).  Saving model ...
Epoch: 8 cost time: 2.6635332107543945
Epoch: 8, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.9897096157073975
Epoch: 9, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.058 Vali Acc: 0.987 Test Loss: 0.058 Test Acc: 0.987
Validation loss decreased (-0.983286 --> -0.987465).  Saving model ...
Epoch: 10 cost time: 2.218303918838501
Epoch: 10, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.054 Vali Acc: 0.986 Test Loss: 0.054 Test Acc: 0.986
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.4599130153656006
Epoch: 11, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.054 Vali Acc: 0.987 Test Loss: 0.054 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.865165948867798
Epoch: 12, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.063 Vali Acc: 0.984 Test Loss: 0.063 Test Acc: 0.984
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.8034963607788086
Epoch: 13, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.073 Vali Acc: 0.984 Test Loss: 0.073 Test Acc: 0.984
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.840579032897949
Epoch: 14, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.997694492340088
Epoch: 15, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.058 Vali Acc: 0.985 Test Loss: 0.058 Test Acc: 0.985
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.9615190029144287
Epoch: 16, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.051 Vali Acc: 0.987 Test Loss: 0.051 Test Acc: 0.987
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.610653877258301
Epoch: 17, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.055 Vali Acc: 0.981 Test Loss: 0.055 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.3332605361938477
Epoch: 18, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.053 Vali Acc: 0.985 Test Loss: 0.053 Test Acc: 0.985
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.5906128883361816
Epoch: 19, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.050 Vali Acc: 0.988 Test Loss: 0.050 Test Acc: 0.988
Validation loss decreased (-0.987465 --> -0.988161).  Saving model ...
Epoch: 20 cost time: 2.6059374809265137
Epoch: 20, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.7218143939971924
Epoch: 21, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.062 Vali Acc: 0.983 Test Loss: 0.062 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.890134334564209
Epoch: 22, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.051 Vali Acc: 0.988 Test Loss: 0.051 Test Acc: 0.988
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.90150785446167
Epoch: 23, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.061 Vali Acc: 0.986 Test Loss: 0.061 Test Acc: 0.986
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.78291654586792
Epoch: 24, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.055 Vali Acc: 0.986 Test Loss: 0.055 Test Acc: 0.986
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.2118959426879883
Epoch: 25, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.083 Vali Acc: 0.986 Test Loss: 0.083 Test Acc: 0.986
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.5996341705322266
Epoch: 26, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.063 Vali Acc: 0.987 Test Loss: 0.063 Test Acc: 0.987
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.913242816925049
Epoch: 27, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.058 Vali Acc: 0.986 Test Loss: 0.058 Test Acc: 0.986
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.763455390930176
Epoch: 28, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.057 Vali Acc: 0.986 Test Loss: 0.057 Test Acc: 0.986
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.574113130569458
Epoch: 29, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps19_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9881615598885793
model parameter : 177556
model size : 0.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps28_str14_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.7130684852600098
Epoch: 1, Steps: 89 | Train Loss: 2.592 Vali Loss: 1.858 Vali Acc: 0.692 Test Loss: 1.858 Test Acc: 0.692
Validation loss decreased (inf --> -0.691486).  Saving model ...
Epoch: 2 cost time: 2.4739205837249756
Epoch: 2, Steps: 89 | Train Loss: 1.061 Vali Loss: 0.566 Vali Acc: 0.877 Test Loss: 0.566 Test Acc: 0.877
Validation loss decreased (-0.691486 --> -0.876735).  Saving model ...
Epoch: 3 cost time: 2.719334602355957
Epoch: 3, Steps: 89 | Train Loss: 0.383 Vali Loss: 0.260 Vali Acc: 0.942 Test Loss: 0.260 Test Acc: 0.942
Validation loss decreased (-0.876735 --> -0.942198).  Saving model ...
Epoch: 4 cost time: 2.5419163703918457
Epoch: 4, Steps: 89 | Train Loss: 0.181 Vali Loss: 0.151 Vali Acc: 0.969 Test Loss: 0.151 Test Acc: 0.969
Validation loss decreased (-0.942198 --> -0.969358).  Saving model ...
Epoch: 5 cost time: 2.754337787628174
Epoch: 5, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.116 Vali Acc: 0.970 Test Loss: 0.116 Test Acc: 0.970
Validation loss decreased (-0.969358 --> -0.970055).  Saving model ...
Epoch: 6 cost time: 2.735059976577759
Epoch: 6, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.095 Vali Acc: 0.978 Test Loss: 0.095 Test Acc: 0.978
Validation loss decreased (-0.970055 --> -0.977715).  Saving model ...
Epoch: 7 cost time: 2.816122531890869
Epoch: 7, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.079 Vali Acc: 0.982 Test Loss: 0.079 Test Acc: 0.982
Validation loss decreased (-0.977715 --> -0.981893).  Saving model ...
Epoch: 8 cost time: 2.6244091987609863
Epoch: 8, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.071 Vali Acc: 0.977 Test Loss: 0.071 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.021711826324463
Epoch: 9, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.061 Vali Acc: 0.982 Test Loss: 0.061 Test Acc: 0.982
Validation loss decreased (-0.981893 --> -0.981894).  Saving model ...
Epoch: 10 cost time: 2.529862403869629
Epoch: 10, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.067 Vali Acc: 0.978 Test Loss: 0.067 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.6460764408111572
Epoch: 11, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
Validation loss decreased (-0.981894 --> -0.982590).  Saving model ...
Epoch: 12 cost time: 2.5606141090393066
Epoch: 12, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.053 Vali Acc: 0.985 Test Loss: 0.053 Test Acc: 0.985
Validation loss decreased (-0.982590 --> -0.985376).  Saving model ...
Epoch: 13 cost time: 2.869478464126587
Epoch: 13, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.061 Vali Acc: 0.981 Test Loss: 0.061 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.910517454147339
Epoch: 14, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.048 Vali Acc: 0.984 Test Loss: 0.048 Test Acc: 0.984
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.20823335647583
Epoch: 15, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.047 Vali Acc: 0.988 Test Loss: 0.047 Test Acc: 0.988
Validation loss decreased (-0.985376 --> -0.988161).  Saving model ...
Epoch: 16 cost time: 2.675539016723633
Epoch: 16, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.070 Vali Acc: 0.977 Test Loss: 0.070 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.7307024002075195
Epoch: 17, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.062 Vali Acc: 0.982 Test Loss: 0.062 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.829847574234009
Epoch: 18, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.059 Vali Acc: 0.984 Test Loss: 0.059 Test Acc: 0.984
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.997382402420044
Epoch: 19, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.051 Vali Acc: 0.987 Test Loss: 0.051 Test Acc: 0.987
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.8685498237609863
Epoch: 20, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.9423747062683105
Epoch: 21, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.0043511390686035
Epoch: 22, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.051 Vali Acc: 0.987 Test Loss: 0.051 Test Acc: 0.987
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.5111632347106934
Epoch: 23, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.053 Vali Acc: 0.986 Test Loss: 0.053 Test Acc: 0.986
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.9975497722625732
Epoch: 24, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.984 Test Loss: 0.077 Test Acc: 0.984
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.8997323513031006
Epoch: 25, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps28_str14_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9881615598885793
model parameter : 170164
model size : 0.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps37_str19_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.0016257762908936
Epoch: 1, Steps: 89 | Train Loss: 2.728 Vali Loss: 2.131 Vali Acc: 0.613 Test Loss: 2.131 Test Acc: 0.613
Validation loss decreased (inf --> -0.612792).  Saving model ...
Epoch: 2 cost time: 2.6574673652648926
Epoch: 2, Steps: 89 | Train Loss: 1.366 Vali Loss: 0.772 Vali Acc: 0.832 Test Loss: 0.772 Test Acc: 0.832
Validation loss decreased (-0.612792 --> -0.832165).  Saving model ...
Epoch: 3 cost time: 2.1803011894226074
Epoch: 3, Steps: 89 | Train Loss: 0.515 Vali Loss: 0.380 Vali Acc: 0.900 Test Loss: 0.380 Test Acc: 0.900
Validation loss decreased (-0.832165 --> -0.899718).  Saving model ...
Epoch: 4 cost time: 2.9298932552337646
Epoch: 4, Steps: 89 | Train Loss: 0.266 Vali Loss: 0.206 Vali Acc: 0.955 Test Loss: 0.206 Test Acc: 0.955
Validation loss decreased (-0.899718 --> -0.955430).  Saving model ...
Epoch: 5 cost time: 3.228768825531006
Epoch: 5, Steps: 89 | Train Loss: 0.139 Vali Loss: 0.143 Vali Acc: 0.969 Test Loss: 0.143 Test Acc: 0.969
Validation loss decreased (-0.955430 --> -0.969358).  Saving model ...
Epoch: 6 cost time: 3.2326624393463135
Epoch: 6, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.115 Vali Acc: 0.975 Test Loss: 0.115 Test Acc: 0.975
Validation loss decreased (-0.969358 --> -0.974929).  Saving model ...
Epoch: 7 cost time: 3.2647194862365723
Epoch: 7, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.090 Vali Acc: 0.978 Test Loss: 0.090 Test Acc: 0.978
Validation loss decreased (-0.974929 --> -0.977715).  Saving model ...
Epoch: 8 cost time: 3.0471889972686768
Epoch: 8, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.085 Vali Acc: 0.978 Test Loss: 0.085 Test Acc: 0.978
Validation loss decreased (-0.977715 --> -0.978411).  Saving model ...
Epoch: 9 cost time: 3.249511957168579
Epoch: 9, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.2500014305114746
Epoch: 10, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.058 Vali Acc: 0.985 Test Loss: 0.058 Test Acc: 0.985
Validation loss decreased (-0.978411 --> -0.985375).  Saving model ...
Epoch: 11 cost time: 2.186149835586548
Epoch: 11, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.062 Vali Acc: 0.981 Test Loss: 0.062 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.541792154312134
Epoch: 12, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.057 Vali Acc: 0.985 Test Loss: 0.057 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.8268868923187256
Epoch: 13, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.059 Vali Acc: 0.983 Test Loss: 0.059 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.9760656356811523
Epoch: 14, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.055 Vali Acc: 0.986 Test Loss: 0.055 Test Acc: 0.986
Validation loss decreased (-0.985375 --> -0.986072).  Saving model ...
Epoch: 15 cost time: 2.6765925884246826
Epoch: 15, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.063 Vali Acc: 0.984 Test Loss: 0.063 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.047187328338623
Epoch: 16, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.941485643386841
Epoch: 17, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.059 Vali Acc: 0.986 Test Loss: 0.059 Test Acc: 0.986
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.8481645584106445
Epoch: 18, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.8993372917175293
Epoch: 19, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.059 Vali Acc: 0.987 Test Loss: 0.059 Test Acc: 0.987
Validation loss decreased (-0.986072 --> -0.986768).  Saving model ...
Epoch: 20 cost time: 2.8374946117401123
Epoch: 20, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.087 Vali Acc: 0.984 Test Loss: 0.087 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.477240800857544
Epoch: 21, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.075 Vali Acc: 0.981 Test Loss: 0.075 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.7130415439605713
Epoch: 22, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.059 Vali Acc: 0.985 Test Loss: 0.059 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.9772250652313232
Epoch: 23, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.054 Vali Acc: 0.987 Test Loss: 0.054 Test Acc: 0.987
Validation loss decreased (-0.986768 --> -0.986768).  Saving model ...
Epoch: 24 cost time: 2.9147281646728516
Epoch: 24, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.056 Vali Acc: 0.988 Test Loss: 0.056 Test Acc: 0.988
Validation loss decreased (-0.986768 --> -0.988161).  Saving model ...
Epoch: 25 cost time: 2.9014854431152344
Epoch: 25, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.123 Vali Acc: 0.975 Test Loss: 0.123 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.5501933097839355
Epoch: 26, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.062 Vali Acc: 0.985 Test Loss: 0.062 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.3418209552764893
Epoch: 27, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.052 Vali Acc: 0.987 Test Loss: 0.052 Test Acc: 0.987
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.2254221439361572
Epoch: 28, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.063 Vali Acc: 0.986 Test Loss: 0.063 Test Acc: 0.986
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.0662992000579834
Epoch: 29, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.055 Vali Acc: 0.986 Test Loss: 0.055 Test Acc: 0.986
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.8922312259674072
Epoch: 30, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.052 Vali Acc: 0.988 Test Loss: 0.052 Test Acc: 0.988
Validation loss decreased (-0.988161 --> -0.988161).  Saving model ...
Epoch: 31 cost time: 3.0335683822631836
Epoch: 31, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.062 Vali Acc: 0.985 Test Loss: 0.062 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.043168783187866
Epoch: 32, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.052 Vali Acc: 0.989 Test Loss: 0.052 Test Acc: 0.989
Validation loss decreased (-0.988161 --> -0.988857).  Saving model ...
Epoch: 33 cost time: 3.0880167484283447
Epoch: 33, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.062 Vali Acc: 0.990 Test Loss: 0.062 Test Acc: 0.990
Validation loss decreased (-0.988857 --> -0.989554).  Saving model ...
Epoch: 34 cost time: 2.5846333503723145
Epoch: 34, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.086 Vali Acc: 0.986 Test Loss: 0.086 Test Acc: 0.986
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.397364377975464
Epoch: 35, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 2.825833797454834
Epoch: 36, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 2.914820432662964
Epoch: 37, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.073 Vali Acc: 0.985 Test Loss: 0.073 Test Acc: 0.985
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 2.9138495922088623
Epoch: 38, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.086 Vali Acc: 0.985 Test Loss: 0.086 Test Acc: 0.985
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 2.396408796310425
Epoch: 39, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 2.3249387741088867
Epoch: 40, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.071 Vali Acc: 0.987 Test Loss: 0.071 Test Acc: 0.987
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 2.6071221828460693
Epoch: 41, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.069 Vali Acc: 0.989 Test Loss: 0.069 Test Acc: 0.989
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 2.7738747596740723
Epoch: 42, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.987 Test Loss: 0.076 Test Acc: 0.987
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 2.756105422973633
Epoch: 43, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.987 Test Loss: 0.067 Test Acc: 0.987
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps37_str19_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9895543175487466
model parameter : 162772
model size : 0.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps46_str23_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.846998453140259
Epoch: 1, Steps: 89 | Train Loss: 2.729 Vali Loss: 2.228 Vali Acc: 0.542 Test Loss: 2.228 Test Acc: 0.542
Validation loss decreased (inf --> -0.541760).  Saving model ...
Epoch: 2 cost time: 2.725569486618042
Epoch: 2, Steps: 89 | Train Loss: 1.475 Vali Loss: 0.808 Vali Acc: 0.841 Test Loss: 0.808 Test Acc: 0.841
Validation loss decreased (-0.541760 --> -0.840521).  Saving model ...
Epoch: 3 cost time: 2.6237144470214844
Epoch: 3, Steps: 89 | Train Loss: 0.566 Vali Loss: 0.379 Vali Acc: 0.909 Test Loss: 0.379 Test Acc: 0.909
Validation loss decreased (-0.840521 --> -0.908771).  Saving model ...
Epoch: 4 cost time: 2.6679747104644775
Epoch: 4, Steps: 89 | Train Loss: 0.282 Vali Loss: 0.221 Vali Acc: 0.945 Test Loss: 0.221 Test Acc: 0.945
Validation loss decreased (-0.908771 --> -0.944984).  Saving model ...
Epoch: 5 cost time: 2.550384521484375
Epoch: 5, Steps: 89 | Train Loss: 0.160 Vali Loss: 0.129 Vali Acc: 0.969 Test Loss: 0.129 Test Acc: 0.969
Validation loss decreased (-0.944984 --> -0.968662).  Saving model ...
Epoch: 6 cost time: 2.4682140350341797
Epoch: 6, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.107 Vali Acc: 0.975 Test Loss: 0.107 Test Acc: 0.975
Validation loss decreased (-0.968662 --> -0.974929).  Saving model ...
Epoch: 7 cost time: 2.192610740661621
Epoch: 7, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.086 Vali Acc: 0.982 Test Loss: 0.086 Test Acc: 0.982
Validation loss decreased (-0.974929 --> -0.981893).  Saving model ...
Epoch: 8 cost time: 2.4379775524139404
Epoch: 8, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.6779303550720215
Epoch: 9, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.068 Vali Acc: 0.985 Test Loss: 0.068 Test Acc: 0.985
Validation loss decreased (-0.981893 --> -0.985375).  Saving model ...
Epoch: 10 cost time: 2.7757012844085693
Epoch: 10, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.060 Vali Acc: 0.985 Test Loss: 0.060 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.537553310394287
Epoch: 11, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.067 Vali Acc: 0.982 Test Loss: 0.067 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.466587543487549
Epoch: 12, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.064 Vali Acc: 0.985 Test Loss: 0.064 Test Acc: 0.985
Validation loss decreased (-0.985375 --> -0.985375).  Saving model ...
Epoch: 13 cost time: 2.694370746612549
Epoch: 13, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.057 Vali Acc: 0.987 Test Loss: 0.057 Test Acc: 0.987
Validation loss decreased (-0.985375 --> -0.986768).  Saving model ...
Epoch: 14 cost time: 2.8973164558410645
Epoch: 14, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.062 Vali Acc: 0.985 Test Loss: 0.062 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.805924415588379
Epoch: 15, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.059 Vali Acc: 0.987 Test Loss: 0.059 Test Acc: 0.987
Validation loss decreased (-0.986768 --> -0.987465).  Saving model ...
Epoch: 16 cost time: 2.8123438358306885
Epoch: 16, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.058 Vali Acc: 0.983 Test Loss: 0.058 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.9017958641052246
Epoch: 17, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.057 Vali Acc: 0.985 Test Loss: 0.057 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.570462226867676
Epoch: 18, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.060 Vali Acc: 0.985 Test Loss: 0.060 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.7200987339019775
Epoch: 19, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.054 Vali Acc: 0.986 Test Loss: 0.054 Test Acc: 0.986
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.5613913536071777
Epoch: 20, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.052 Vali Acc: 0.986 Test Loss: 0.052 Test Acc: 0.986
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.7626633644104004
Epoch: 21, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.051 Vali Acc: 0.987 Test Loss: 0.051 Test Acc: 0.987
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.4546172618865967
Epoch: 22, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.059 Vali Acc: 0.987 Test Loss: 0.059 Test Acc: 0.987
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.339812994003296
Epoch: 23, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.057 Vali Acc: 0.987 Test Loss: 0.057 Test Acc: 0.987
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.491945743560791
Epoch: 24, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.057 Vali Acc: 0.987 Test Loss: 0.057 Test Acc: 0.987
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.8135974407196045
Epoch: 25, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.073 Vali Acc: 0.985 Test Loss: 0.073 Test Acc: 0.985
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr4_ps46_str23_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9874651810584958
model parameter : 159220
model size : 0.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.420981407165527
Epoch: 1, Steps: 89 | Train Loss: 0.867 Vali Loss: 0.249 Vali Acc: 0.931 Test Loss: 0.249 Test Acc: 0.931
Validation loss decreased (inf --> -0.931056).  Saving model ...
Epoch: 2 cost time: 5.494494915008545
Epoch: 2, Steps: 89 | Train Loss: 0.237 Vali Loss: 0.212 Vali Acc: 0.955 Test Loss: 0.212 Test Acc: 0.955
Validation loss decreased (-0.931056 --> -0.954733).  Saving model ...
Epoch: 3 cost time: 5.831144094467163
Epoch: 3, Steps: 89 | Train Loss: 0.160 Vali Loss: 0.405 Vali Acc: 0.917 Test Loss: 0.405 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.965829849243164
Epoch: 4, Steps: 89 | Train Loss: 0.166 Vali Loss: 0.339 Vali Acc: 0.962 Test Loss: 0.339 Test Acc: 0.962
Validation loss decreased (-0.954733 --> -0.961696).  Saving model ...
Epoch: 5 cost time: 7.077748537063599
Epoch: 5, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.314 Vali Acc: 0.950 Test Loss: 0.314 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.181894540786743
Epoch: 6, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.319 Vali Acc: 0.957 Test Loss: 0.319 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.928981065750122
Epoch: 7, Steps: 89 | Train Loss: 0.144 Vali Loss: 0.336 Vali Acc: 0.961 Test Loss: 0.336 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 7.171080589294434
Epoch: 8, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.412 Vali Acc: 0.956 Test Loss: 0.412 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 6.871238708496094
Epoch: 9, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.397 Vali Acc: 0.960 Test Loss: 0.397 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 6.923354148864746
Epoch: 10, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.346 Vali Acc: 0.962 Test Loss: 0.346 Test Acc: 0.962
Validation loss decreased (-0.961696 --> -0.962392).  Saving model ...
Epoch: 11 cost time: 5.438613176345825
Epoch: 11, Steps: 89 | Train Loss: 0.141 Vali Loss: 0.317 Vali Acc: 0.961 Test Loss: 0.317 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.495809078216553
Epoch: 12, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.427 Vali Acc: 0.949 Test Loss: 0.427 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.790058374404907
Epoch: 13, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.371 Vali Acc: 0.966 Test Loss: 0.371 Test Acc: 0.966
Validation loss decreased (-0.962392 --> -0.965874).  Saving model ...
Epoch: 14 cost time: 7.301913738250732
Epoch: 14, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.558 Vali Acc: 0.962 Test Loss: 0.558 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.07530665397644
Epoch: 15, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.339 Vali Acc: 0.970 Test Loss: 0.339 Test Acc: 0.970
Validation loss decreased (-0.965874 --> -0.970052).  Saving model ...
Epoch: 16 cost time: 5.7166736125946045
Epoch: 16, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.362 Vali Acc: 0.970 Test Loss: 0.362 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.471241235733032
Epoch: 17, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.570 Vali Acc: 0.948 Test Loss: 0.570 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 6.23961329460144
Epoch: 18, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.400 Vali Acc: 0.963 Test Loss: 0.400 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 5.800801038742065
Epoch: 19, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.324 Vali Acc: 0.966 Test Loss: 0.324 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 4.702430248260498
Epoch: 20, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.292 Vali Acc: 0.974 Test Loss: 0.292 Test Acc: 0.974
Validation loss decreased (-0.970052 --> -0.973535).  Saving model ...
Epoch: 21 cost time: 6.577226161956787
Epoch: 21, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.303 Vali Acc: 0.977 Test Loss: 0.303 Test Acc: 0.977
Validation loss decreased (-0.973535 --> -0.977016).  Saving model ...
Epoch: 22 cost time: 6.670892715454102
Epoch: 22, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.477 Vali Acc: 0.967 Test Loss: 0.477 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 5.8110339641571045
Epoch: 23, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.546 Vali Acc: 0.971 Test Loss: 0.546 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 4.434833765029907
Epoch: 24, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.414 Vali Acc: 0.962 Test Loss: 0.414 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 5.6684064865112305
Epoch: 25, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.395 Vali Acc: 0.964 Test Loss: 0.395 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 6.058833360671997
Epoch: 26, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.495 Vali Acc: 0.967 Test Loss: 0.495 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 5.910729646682739
Epoch: 27, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.455 Vali Acc: 0.956 Test Loss: 0.455 Test Acc: 0.956
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 4.5118327140808105
Epoch: 28, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.453 Vali Acc: 0.966 Test Loss: 0.453 Test Acc: 0.966
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 5.549064636230469
Epoch: 29, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.361 Vali Acc: 0.971 Test Loss: 0.361 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 6.082553863525391
Epoch: 30, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.333 Vali Acc: 0.976 Test Loss: 0.333 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 6.181032657623291
Epoch: 31, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.473 Vali Acc: 0.967 Test Loss: 0.473 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9770194986072424
model parameter : 2540052
model size : 9.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.9823482036590576
Epoch: 1, Steps: 89 | Train Loss: 0.931 Vali Loss: 0.289 Vali Acc: 0.928 Test Loss: 0.289 Test Acc: 0.928
Validation loss decreased (inf --> -0.928270).  Saving model ...
Epoch: 2 cost time: 3.66621470451355
Epoch: 2, Steps: 89 | Train Loss: 0.188 Vali Loss: 0.254 Vali Acc: 0.931 Test Loss: 0.254 Test Acc: 0.931
Validation loss decreased (-0.928270 --> -0.931056).  Saving model ...
Epoch: 3 cost time: 3.833150863647461
Epoch: 3, Steps: 89 | Train Loss: 0.185 Vali Loss: 0.212 Vali Acc: 0.949 Test Loss: 0.212 Test Acc: 0.949
Validation loss decreased (-0.931056 --> -0.949162).  Saving model ...
Epoch: 4 cost time: 2.9979193210601807
Epoch: 4, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.203 Vali Acc: 0.961 Test Loss: 0.203 Test Acc: 0.961
Validation loss decreased (-0.949162 --> -0.961001).  Saving model ...
Epoch: 5 cost time: 3.247750759124756
Epoch: 5, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.190 Vali Acc: 0.968 Test Loss: 0.190 Test Acc: 0.968
Validation loss decreased (-0.961001 --> -0.967965).  Saving model ...
Epoch: 6 cost time: 3.477236032485962
Epoch: 6, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.184 Vali Acc: 0.961 Test Loss: 0.184 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.488430976867676
Epoch: 7, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.180 Vali Acc: 0.976 Test Loss: 0.180 Test Acc: 0.976
Validation loss decreased (-0.967965 --> -0.975625).  Saving model ...
Epoch: 8 cost time: 3.620711088180542
Epoch: 8, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.209 Vali Acc: 0.971 Test Loss: 0.209 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.9708688259124756
Epoch: 9, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.198 Vali Acc: 0.967 Test Loss: 0.198 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.804312229156494
Epoch: 10, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.244 Vali Acc: 0.968 Test Loss: 0.244 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.6290528774261475
Epoch: 11, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.182 Vali Acc: 0.975 Test Loss: 0.182 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.541285991668701
Epoch: 12, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.233 Vali Acc: 0.976 Test Loss: 0.233 Test Acc: 0.976
Validation loss decreased (-0.975625 --> -0.976321).  Saving model ...
Epoch: 13 cost time: 3.0430967807769775
Epoch: 13, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.265 Vali Acc: 0.963 Test Loss: 0.265 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.9170608520507812
Epoch: 14, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.349 Vali Acc: 0.958 Test Loss: 0.349 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.023881673812866
Epoch: 15, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.281 Vali Acc: 0.975 Test Loss: 0.281 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.4767630100250244
Epoch: 16, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.243 Vali Acc: 0.978 Test Loss: 0.243 Test Acc: 0.978
Validation loss decreased (-0.976321 --> -0.978410).  Saving model ...
Epoch: 17 cost time: 3.4705581665039062
Epoch: 17, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.308 Vali Acc: 0.966 Test Loss: 0.308 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.371197462081909
Epoch: 18, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.630 Vali Acc: 0.946 Test Loss: 0.630 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.5921287536621094
Epoch: 19, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.197 Vali Acc: 0.982 Test Loss: 0.197 Test Acc: 0.982
Validation loss decreased (-0.978410 --> -0.981892).  Saving model ...
Epoch: 20 cost time: 2.988084316253662
Epoch: 20, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.177 Vali Acc: 0.983 Test Loss: 0.177 Test Acc: 0.983
Validation loss decreased (-0.981892 --> -0.983285).  Saving model ...
Epoch: 21 cost time: 3.8152620792388916
Epoch: 21, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.236 Vali Acc: 0.978 Test Loss: 0.236 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.9738004207611084
Epoch: 22, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.321 Vali Acc: 0.966 Test Loss: 0.321 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.5472772121429443
Epoch: 23, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.257 Vali Acc: 0.974 Test Loss: 0.257 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.512030839920044
Epoch: 24, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.277 Vali Acc: 0.971 Test Loss: 0.277 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.7540957927703857
Epoch: 25, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.218 Vali Acc: 0.980 Test Loss: 0.218 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.801539182662964
Epoch: 26, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.286 Vali Acc: 0.978 Test Loss: 0.286 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.805274724960327
Epoch: 27, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.285 Vali Acc: 0.978 Test Loss: 0.285 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 3.7317161560058594
Epoch: 28, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.287 Vali Acc: 0.973 Test Loss: 0.287 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 3.7562546730041504
Epoch: 29, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.520 Vali Acc: 0.961 Test Loss: 0.520 Test Acc: 0.961
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.9940011501312256
Epoch: 30, Steps: 89 | Train Loss: 0.123 Vali Loss: 0.297 Vali Acc: 0.977 Test Loss: 0.297 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9832869080779945
model parameter : 2172692
model size : 8.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps14_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.454360723495483
Epoch: 1, Steps: 89 | Train Loss: 1.011 Vali Loss: 0.322 Vali Acc: 0.914 Test Loss: 0.322 Test Acc: 0.914
Validation loss decreased (inf --> -0.914342).  Saving model ...
Epoch: 2 cost time: 3.7480194568634033
Epoch: 2, Steps: 89 | Train Loss: 0.199 Vali Loss: 0.243 Vali Acc: 0.928 Test Loss: 0.243 Test Acc: 0.928
Validation loss decreased (-0.914342 --> -0.928271).  Saving model ...
Epoch: 3 cost time: 3.8929715156555176
Epoch: 3, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.159 Vali Acc: 0.962 Test Loss: 0.159 Test Acc: 0.962
Validation loss decreased (-0.928271 --> -0.962394).  Saving model ...
Epoch: 4 cost time: 4.071656942367554
Epoch: 4, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.179 Vali Acc: 0.954 Test Loss: 0.179 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.118759870529175
Epoch: 5, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.135 Vali Acc: 0.975 Test Loss: 0.135 Test Acc: 0.975
Validation loss decreased (-0.962394 --> -0.974929).  Saving model ...
Epoch: 6 cost time: 3.691676616668701
Epoch: 6, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.138 Vali Acc: 0.971 Test Loss: 0.138 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.150343179702759
Epoch: 7, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.170 Vali Acc: 0.969 Test Loss: 0.170 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.557189702987671
Epoch: 8, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.179 Vali Acc: 0.974 Test Loss: 0.179 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.919665813446045
Epoch: 9, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.158 Vali Acc: 0.974 Test Loss: 0.158 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.787660837173462
Epoch: 10, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.179 Vali Acc: 0.971 Test Loss: 0.179 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.8176698684692383
Epoch: 11, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.176 Vali Acc: 0.974 Test Loss: 0.176 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.689997434616089
Epoch: 12, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.224 Vali Acc: 0.967 Test Loss: 0.224 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.4991772174835205
Epoch: 13, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.221 Vali Acc: 0.971 Test Loss: 0.221 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.6770737171173096
Epoch: 14, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.215 Vali Acc: 0.970 Test Loss: 0.215 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.668114423751831
Epoch: 15, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.311 Vali Acc: 0.955 Test Loss: 0.311 Test Acc: 0.955
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps14_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9749303621169917
model parameter : 2020116
model size : 7.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps19_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.8528997898101807
Epoch: 1, Steps: 89 | Train Loss: 1.178 Vali Loss: 0.299 Vali Acc: 0.937 Test Loss: 0.299 Test Acc: 0.937
Validation loss decreased (inf --> -0.936627).  Saving model ...
Epoch: 2 cost time: 3.5003907680511475
Epoch: 2, Steps: 89 | Train Loss: 0.193 Vali Loss: 0.161 Vali Acc: 0.960 Test Loss: 0.161 Test Acc: 0.960
Validation loss decreased (-0.936627 --> -0.959608).  Saving model ...
Epoch: 3 cost time: 3.6010570526123047
Epoch: 3, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.149 Vali Acc: 0.964 Test Loss: 0.149 Test Acc: 0.964
Validation loss decreased (-0.959608 --> -0.964483).  Saving model ...
Epoch: 4 cost time: 3.5245468616485596
Epoch: 4, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
Validation loss decreased (-0.964483 --> -0.977018).  Saving model ...
Epoch: 5 cost time: 3.0304672718048096
Epoch: 5, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.122 Vali Acc: 0.974 Test Loss: 0.122 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.6786131858825684
Epoch: 6, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.110 Vali Acc: 0.974 Test Loss: 0.110 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.7028186321258545
Epoch: 7, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.135 Vali Acc: 0.974 Test Loss: 0.135 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.649275779724121
Epoch: 8, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.114 Vali Acc: 0.981 Test Loss: 0.114 Test Acc: 0.981
Validation loss decreased (-0.977018 --> -0.981197).  Saving model ...
Epoch: 9 cost time: 3.2528915405273438
Epoch: 9, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.113 Vali Acc: 0.978 Test Loss: 0.113 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.4530885219573975
Epoch: 10, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.135 Vali Acc: 0.978 Test Loss: 0.135 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.8226535320281982
Epoch: 11, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.160 Vali Acc: 0.977 Test Loss: 0.160 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.4685676097869873
Epoch: 12, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.121 Vali Acc: 0.981 Test Loss: 0.121 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.7017524242401123
Epoch: 13, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.168 Vali Acc: 0.976 Test Loss: 0.168 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.861567258834839
Epoch: 14, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.176 Vali Acc: 0.970 Test Loss: 0.176 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.3340539932250977
Epoch: 15, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.240 Vali Acc: 0.962 Test Loss: 0.240 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.537034034729004
Epoch: 16, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.202 Vali Acc: 0.967 Test Loss: 0.202 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.754150390625
Epoch: 17, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.155 Vali Acc: 0.975 Test Loss: 0.155 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.437587261199951
Epoch: 18, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.127 Vali Acc: 0.983 Test Loss: 0.127 Test Acc: 0.983
Validation loss decreased (-0.981197 --> -0.983286).  Saving model ...
Epoch: 19 cost time: 2.7307636737823486
Epoch: 19, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.144 Vali Acc: 0.981 Test Loss: 0.144 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.588947296142578
Epoch: 20, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.259 Vali Acc: 0.971 Test Loss: 0.259 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.5640628337860107
Epoch: 21, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.127 Vali Acc: 0.983 Test Loss: 0.127 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.616053342819214
Epoch: 22, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.169 Vali Acc: 0.977 Test Loss: 0.169 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.308990716934204
Epoch: 23, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.178 Vali Acc: 0.976 Test Loss: 0.178 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.13793683052063
Epoch: 24, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.224 Vali Acc: 0.970 Test Loss: 0.224 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.539977550506592
Epoch: 25, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.161 Vali Acc: 0.983 Test Loss: 0.161 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 3.6332967281341553
Epoch: 26, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.199 Vali Acc: 0.976 Test Loss: 0.199 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 3.7384305000305176
Epoch: 27, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.157 Vali Acc: 0.983 Test Loss: 0.157 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.7917163372039795
Epoch: 28, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.166 Vali Acc: 0.983 Test Loss: 0.166 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps19_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9832869080779945
model parameter : 1898516
model size : 7.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps28_str14_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.323785781860352
Epoch: 1, Steps: 89 | Train Loss: 1.288 Vali Loss: 0.368 Vali Acc: 0.905 Test Loss: 0.368 Test Acc: 0.905
Validation loss decreased (inf --> -0.905289).  Saving model ...
Epoch: 2 cost time: 2.7080435752868652
Epoch: 2, Steps: 89 | Train Loss: 0.207 Vali Loss: 0.181 Vali Acc: 0.956 Test Loss: 0.181 Test Acc: 0.956
Validation loss decreased (-0.905289 --> -0.956126).  Saving model ...
Epoch: 3 cost time: 3.373800039291382
Epoch: 3, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.141 Vali Acc: 0.962 Test Loss: 0.141 Test Acc: 0.962
Validation loss decreased (-0.956126 --> -0.962394).  Saving model ...
Epoch: 4 cost time: 3.2765729427337646
Epoch: 4, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.099 Vali Acc: 0.978 Test Loss: 0.099 Test Acc: 0.978
Validation loss decreased (-0.962394 --> -0.977715).  Saving model ...
Epoch: 5 cost time: 3.213583469390869
Epoch: 5, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.145 Vali Acc: 0.962 Test Loss: 0.145 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.840977668762207
Epoch: 6, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.4156577587127686
Epoch: 7, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.977715 --> -0.983286).  Saving model ...
Epoch: 8 cost time: 3.181722402572632
Epoch: 8, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.081 Vali Acc: 0.981 Test Loss: 0.081 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.3932392597198486
Epoch: 9, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.084 Vali Acc: 0.981 Test Loss: 0.084 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.3370401859283447
Epoch: 10, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.184 Vali Acc: 0.961 Test Loss: 0.184 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.7699270248413086
Epoch: 11, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.119 Vali Acc: 0.976 Test Loss: 0.119 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.250514268875122
Epoch: 12, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.112 Vali Acc: 0.978 Test Loss: 0.112 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.8810653686523438
Epoch: 13, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.143 Vali Acc: 0.971 Test Loss: 0.143 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.9676144123077393
Epoch: 14, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.193 Vali Acc: 0.961 Test Loss: 0.193 Test Acc: 0.961
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.1820755004882812
Epoch: 15, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.268 Vali Acc: 0.951 Test Loss: 0.268 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.555889844894409
Epoch: 16, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.135 Vali Acc: 0.976 Test Loss: 0.135 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.4105820655822754
Epoch: 17, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.153 Vali Acc: 0.973 Test Loss: 0.153 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps28_str14_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9832869080779945
model parameter : 1824020
model size : 6.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps37_str19_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.5270862579345703
Epoch: 1, Steps: 89 | Train Loss: 1.419 Vali Loss: 0.464 Vali Acc: 0.876 Test Loss: 0.464 Test Acc: 0.876
Validation loss decreased (inf --> -0.876040).  Saving model ...
Epoch: 2 cost time: 2.946564197540283
Epoch: 2, Steps: 89 | Train Loss: 0.263 Vali Loss: 0.208 Vali Acc: 0.952 Test Loss: 0.208 Test Acc: 0.952
Validation loss decreased (-0.876040 --> -0.951948).  Saving model ...
Epoch: 3 cost time: 3.0162880420684814
Epoch: 3, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.130 Vali Acc: 0.964 Test Loss: 0.130 Test Acc: 0.964
Validation loss decreased (-0.951948 --> -0.964483).  Saving model ...
Epoch: 4 cost time: 3.0112905502319336
Epoch: 4, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.092 Vali Acc: 0.975 Test Loss: 0.092 Test Acc: 0.975
Validation loss decreased (-0.964483 --> -0.974929).  Saving model ...
Epoch: 5 cost time: 2.5266659259796143
Epoch: 5, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.103 Vali Acc: 0.976 Test Loss: 0.103 Test Acc: 0.976
Validation loss decreased (-0.974929 --> -0.975626).  Saving model ...
Epoch: 6 cost time: 2.416701078414917
Epoch: 6, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.975626 --> -0.977019).  Saving model ...
Epoch: 7 cost time: 2.847034454345703
Epoch: 7, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.088 Vali Acc: 0.975 Test Loss: 0.088 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.813596248626709
Epoch: 8, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.195 Vali Acc: 0.952 Test Loss: 0.195 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.816241502761841
Epoch: 9, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.101 Vali Acc: 0.983 Test Loss: 0.101 Test Acc: 0.983
Validation loss decreased (-0.977019 --> -0.983286).  Saving model ...
Epoch: 10 cost time: 2.745354175567627
Epoch: 10, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.092 Vali Acc: 0.976 Test Loss: 0.092 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.299631118774414
Epoch: 11, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.119 Vali Acc: 0.975 Test Loss: 0.119 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.3989806175231934
Epoch: 12, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.112 Vali Acc: 0.978 Test Loss: 0.112 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.39139723777771
Epoch: 13, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.151 Vali Acc: 0.971 Test Loss: 0.151 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.960611343383789
Epoch: 14, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.066 Vali Acc: 0.984 Test Loss: 0.066 Test Acc: 0.984
Validation loss decreased (-0.983286 --> -0.983983).  Saving model ...
Epoch: 15 cost time: 2.524955987930298
Epoch: 15, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.075 Vali Acc: 0.981 Test Loss: 0.075 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.408607244491577
Epoch: 16, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.108203649520874
Epoch: 17, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.090 Vali Acc: 0.983 Test Loss: 0.090 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.166881799697876
Epoch: 18, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.119 Vali Acc: 0.977 Test Loss: 0.119 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.4732375144958496
Epoch: 19, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.131 Vali Acc: 0.978 Test Loss: 0.131 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.809382438659668
Epoch: 20, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.093 Vali Acc: 0.981 Test Loss: 0.093 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.711857557296753
Epoch: 21, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.782892942428589
Epoch: 22, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.091 Vali Acc: 0.984 Test Loss: 0.091 Test Acc: 0.984
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.2288777828216553
Epoch: 23, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.128 Vali Acc: 0.978 Test Loss: 0.128 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.508167266845703
Epoch: 24, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.106 Vali Acc: 0.984 Test Loss: 0.106 Test Acc: 0.984
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps37_str19_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.983983286908078
model parameter : 1764884
model size : 6.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps46_str23_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.544629335403442
Epoch: 1, Steps: 89 | Train Loss: 1.510 Vali Loss: 0.527 Vali Acc: 0.867 Test Loss: 0.527 Test Acc: 0.867
Validation loss decreased (inf --> -0.866986).  Saving model ...
Epoch: 2 cost time: 2.9758920669555664
Epoch: 2, Steps: 89 | Train Loss: 0.297 Vali Loss: 0.201 Vali Acc: 0.954 Test Loss: 0.201 Test Acc: 0.954
Validation loss decreased (-0.866986 --> -0.954037).  Saving model ...
Epoch: 3 cost time: 2.515432357788086
Epoch: 3, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
Validation loss decreased (-0.954037 --> -0.972840).  Saving model ...
Epoch: 4 cost time: 3.1203620433807373
Epoch: 4, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.106 Vali Acc: 0.967 Test Loss: 0.106 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.1053831577301025
Epoch: 5, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.108 Vali Acc: 0.969 Test Loss: 0.108 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.3171260356903076
Epoch: 6, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
Validation loss decreased (-0.972840 --> -0.972840).  Saving model ...
Epoch: 7 cost time: 2.6857731342315674
Epoch: 7, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.090 Vali Acc: 0.978 Test Loss: 0.090 Test Acc: 0.978
Validation loss decreased (-0.972840 --> -0.978411).  Saving model ...
Epoch: 8 cost time: 3.4221973419189453
Epoch: 8, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.084 Vali Acc: 0.981 Test Loss: 0.084 Test Acc: 0.981
Validation loss decreased (-0.978411 --> -0.980501).  Saving model ...
Epoch: 9 cost time: 3.3682801723480225
Epoch: 9, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.063 Vali Acc: 0.985 Test Loss: 0.063 Test Acc: 0.985
Validation loss decreased (-0.980501 --> -0.985375).  Saving model ...
Epoch: 10 cost time: 3.0290069580078125
Epoch: 10, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.1714818477630615
Epoch: 11, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.103 Vali Acc: 0.974 Test Loss: 0.103 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.5664515495300293
Epoch: 12, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.110 Vali Acc: 0.972 Test Loss: 0.110 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.3192038536071777
Epoch: 13, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.082 Vali Acc: 0.978 Test Loss: 0.082 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.499448299407959
Epoch: 14, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.078 Vali Acc: 0.981 Test Loss: 0.078 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.3712947368621826
Epoch: 15, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.063 Vali Acc: 0.988 Test Loss: 0.063 Test Acc: 0.988
Validation loss decreased (-0.985375 --> -0.988161).  Saving model ...
Epoch: 16 cost time: 2.6960415840148926
Epoch: 16, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.082 Vali Acc: 0.981 Test Loss: 0.082 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.6508169174194336
Epoch: 17, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.120 Vali Acc: 0.979 Test Loss: 0.120 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.934446334838867
Epoch: 18, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.908421516418457
Epoch: 19, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.300 Vali Acc: 0.945 Test Loss: 0.300 Test Acc: 0.945
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.2974355220794678
Epoch: 20, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.168 Vali Acc: 0.969 Test Loss: 0.168 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.772970676422119
Epoch: 21, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.140 Vali Acc: 0.978 Test Loss: 0.140 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.2483277320861816
Epoch: 22, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.213 Vali Acc: 0.965 Test Loss: 0.213 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.244774103164673
Epoch: 23, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.114 Vali Acc: 0.976 Test Loss: 0.114 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 3.257549285888672
Epoch: 24, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.094 Vali Acc: 0.983 Test Loss: 0.094 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 3.2966127395629883
Epoch: 25, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.114 Vali Acc: 0.982 Test Loss: 0.114 Test Acc: 0.982
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim256_nb1_lk13_sk5_ffr4_ps46_str23_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9881615598885793
model parameter : 1736468
model size : 6.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.5871198177337646
Epoch: 1, Steps: 89 | Train Loss: 1.012 Vali Loss: 0.268 Vali Acc: 0.938 Test Loss: 0.268 Test Acc: 0.938
Validation loss decreased (inf --> -0.938020).  Saving model ...
Epoch: 2 cost time: 2.7895452976226807
Epoch: 2, Steps: 89 | Train Loss: 0.200 Vali Loss: 0.166 Vali Acc: 0.962 Test Loss: 0.166 Test Acc: 0.962
Validation loss decreased (-0.938020 --> -0.961698).  Saving model ...
Epoch: 3 cost time: 3.0125951766967773
Epoch: 3, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.159 Vali Acc: 0.963 Test Loss: 0.159 Test Acc: 0.963
Validation loss decreased (-0.961698 --> -0.963090).  Saving model ...
Epoch: 4 cost time: 2.3470380306243896
Epoch: 4, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.225 Vali Acc: 0.946 Test Loss: 0.225 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.2469663619995117
Epoch: 5, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.150 Vali Acc: 0.971 Test Loss: 0.150 Test Acc: 0.971
Validation loss decreased (-0.963090 --> -0.971447).  Saving model ...
Epoch: 6 cost time: 3.267174482345581
Epoch: 6, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.208 Vali Acc: 0.964 Test Loss: 0.208 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.2184364795684814
Epoch: 7, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.179 Vali Acc: 0.962 Test Loss: 0.179 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.098036050796509
Epoch: 8, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.168 Vali Acc: 0.974 Test Loss: 0.168 Test Acc: 0.974
Validation loss decreased (-0.971447 --> -0.973536).  Saving model ...
Epoch: 9 cost time: 2.378257989883423
Epoch: 9, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.277 Vali Acc: 0.956 Test Loss: 0.277 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.80088472366333
Epoch: 10, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.206 Vali Acc: 0.969 Test Loss: 0.206 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.8599302768707275
Epoch: 11, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.233 Vali Acc: 0.965 Test Loss: 0.233 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.0816571712493896
Epoch: 12, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.258 Vali Acc: 0.967 Test Loss: 0.258 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.1746180057525635
Epoch: 13, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.229 Vali Acc: 0.974 Test Loss: 0.229 Test Acc: 0.974
Validation loss decreased (-0.973536 --> -0.974232).  Saving model ...
Epoch: 14 cost time: 2.3703386783599854
Epoch: 14, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.233 Vali Acc: 0.973 Test Loss: 0.233 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.4234132766723633
Epoch: 15, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.263 Vali Acc: 0.971 Test Loss: 0.263 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.3759963512420654
Epoch: 16, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.329 Vali Acc: 0.962 Test Loss: 0.329 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.049182176589966
Epoch: 17, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.305 Vali Acc: 0.963 Test Loss: 0.305 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.972820520401001
Epoch: 18, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.240 Vali Acc: 0.964 Test Loss: 0.240 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.952347755432129
Epoch: 19, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.326 Vali Acc: 0.968 Test Loss: 0.326 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.467214822769165
Epoch: 20, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.271 Vali Acc: 0.967 Test Loss: 0.271 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.8705344200134277
Epoch: 21, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.277 Vali Acc: 0.971 Test Loss: 0.277 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.840822696685791
Epoch: 22, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.240 Vali Acc: 0.977 Test Loss: 0.240 Test Acc: 0.977
Validation loss decreased (-0.974232 --> -0.977017).  Saving model ...
Epoch: 23 cost time: 2.762773275375366
Epoch: 23, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.277 Vali Acc: 0.974 Test Loss: 0.277 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.2701504230499268
Epoch: 24, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.268 Vali Acc: 0.974 Test Loss: 0.268 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.389763832092285
Epoch: 25, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.268 Vali Acc: 0.977 Test Loss: 0.268 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.353422164916992
Epoch: 26, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.801 Vali Acc: 0.924 Test Loss: 0.801 Test Acc: 0.924
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.2228894233703613
Epoch: 27, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.240 Vali Acc: 0.977 Test Loss: 0.240 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 3.2826621532440186
Epoch: 28, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.395 Vali Acc: 0.952 Test Loss: 0.395 Test Acc: 0.952
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 3.1519181728363037
Epoch: 29, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.335 Vali Acc: 0.964 Test Loss: 0.335 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.9941213130950928
Epoch: 30, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.372 Vali Acc: 0.969 Test Loss: 0.372 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 2.4590723514556885
Epoch: 31, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.380 Vali Acc: 0.970 Test Loss: 0.380 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 3.193751335144043
Epoch: 32, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.331 Vali Acc: 0.978 Test Loss: 0.331 Test Acc: 0.978
Validation loss decreased (-0.977017 --> -0.978409).  Saving model ...
Epoch: 33 cost time: 2.8841869831085205
Epoch: 33, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.414 Vali Acc: 0.965 Test Loss: 0.414 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.608880043029785
Epoch: 34, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.378 Vali Acc: 0.972 Test Loss: 0.378 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 3.051521062850952
Epoch: 35, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.437 Vali Acc: 0.961 Test Loss: 0.437 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 2.365800619125366
Epoch: 36, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.500 Vali Acc: 0.962 Test Loss: 0.500 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 2.3746566772460938
Epoch: 37, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.304 Vali Acc: 0.976 Test Loss: 0.304 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.7310810089111328
Epoch: 38, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.310 Vali Acc: 0.976 Test Loss: 0.310 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.7046027183532715
Epoch: 39, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.314 Vali Acc: 0.980 Test Loss: 0.314 Test Acc: 0.980
Validation loss decreased (-0.978409 --> -0.979802).  Saving model ...
Epoch: 40 cost time: 1.5525031089782715
Epoch: 40, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.470 Vali Acc: 0.953 Test Loss: 0.470 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 2.6066792011260986
Epoch: 41, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.424 Vali Acc: 0.972 Test Loss: 0.424 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 3.7197673320770264
Epoch: 42, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.350 Vali Acc: 0.971 Test Loss: 0.350 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 4.022130250930786
Epoch: 43, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.407 Vali Acc: 0.961 Test Loss: 0.407 Test Acc: 0.961
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 3.132767915725708
Epoch: 44, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.333 Vali Acc: 0.974 Test Loss: 0.333 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 3.466862678527832
Epoch: 45, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.303 Vali Acc: 0.975 Test Loss: 0.303 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 4.01067852973938
Epoch: 46, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.266 Vali Acc: 0.978 Test Loss: 0.266 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 3.742363452911377
Epoch: 47, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.304 Vali Acc: 0.978 Test Loss: 0.304 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 3.551105499267578
Epoch: 48, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.280 Vali Acc: 0.980 Test Loss: 0.280 Test Acc: 0.980
Validation loss decreased (-0.979802 --> -0.979802).  Saving model ...
Epoch: 49 cost time: 2.772101640701294
Epoch: 49, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.348 Vali Acc: 0.970 Test Loss: 0.348 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 4.067461729049683
Epoch: 50, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.407 Vali Acc: 0.968 Test Loss: 0.407 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9798050139275766
model parameter : 876820
model size : 3.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.386303424835205
Epoch: 1, Steps: 89 | Train Loss: 1.213 Vali Loss: 0.349 Vali Acc: 0.909 Test Loss: 0.349 Test Acc: 0.909
Validation loss decreased (inf --> -0.908771).  Saving model ...
Epoch: 2 cost time: 2.2891108989715576
Epoch: 2, Steps: 89 | Train Loss: 0.224 Vali Loss: 0.162 Vali Acc: 0.959 Test Loss: 0.162 Test Acc: 0.959
Validation loss decreased (-0.908771 --> -0.958912).  Saving model ...
Epoch: 3 cost time: 2.3279666900634766
Epoch: 3, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.131 Vali Acc: 0.961 Test Loss: 0.131 Test Acc: 0.961
Validation loss decreased (-0.958912 --> -0.961001).  Saving model ...
Epoch: 4 cost time: 2.6893625259399414
Epoch: 4, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.129 Vali Acc: 0.969 Test Loss: 0.129 Test Acc: 0.969
Validation loss decreased (-0.961001 --> -0.968662).  Saving model ...
Epoch: 5 cost time: 2.921398162841797
Epoch: 5, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.137 Vali Acc: 0.976 Test Loss: 0.137 Test Acc: 0.976
Validation loss decreased (-0.968662 --> -0.975625).  Saving model ...
Epoch: 6 cost time: 2.621638059616089
Epoch: 6, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.174 Vali Acc: 0.969 Test Loss: 0.174 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.644289970397949
Epoch: 7, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.182 Vali Acc: 0.971 Test Loss: 0.182 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.5128228664398193
Epoch: 8, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.169 Vali Acc: 0.969 Test Loss: 0.169 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.5502688884735107
Epoch: 9, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.141 Vali Acc: 0.976 Test Loss: 0.141 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.093841791152954
Epoch: 10, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.208 Vali Acc: 0.963 Test Loss: 0.208 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.7650461196899414
Epoch: 11, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.129 Vali Acc: 0.975 Test Loss: 0.129 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.4802563190460205
Epoch: 12, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.117 Vali Acc: 0.981 Test Loss: 0.117 Test Acc: 0.981
Validation loss decreased (-0.975625 --> -0.981197).  Saving model ...
Epoch: 13 cost time: 2.5579347610473633
Epoch: 13, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.165 Vali Acc: 0.969 Test Loss: 0.165 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.555405378341675
Epoch: 14, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.136 Vali Acc: 0.978 Test Loss: 0.136 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.564751386642456
Epoch: 15, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.164 Vali Acc: 0.971 Test Loss: 0.164 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.024871349334717
Epoch: 16, Steps: 89 | Train Loss: 0.132 Vali Loss: 0.177 Vali Acc: 0.966 Test Loss: 0.177 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.9218451976776123
Epoch: 17, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.173 Vali Acc: 0.972 Test Loss: 0.173 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.0895915031433105
Epoch: 18, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.146 Vali Acc: 0.981 Test Loss: 0.146 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.5641605854034424
Epoch: 19, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.188 Vali Acc: 0.972 Test Loss: 0.188 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.014636278152466
Epoch: 20, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.165 Vali Acc: 0.975 Test Loss: 0.165 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.848085403442383
Epoch: 21, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.185 Vali Acc: 0.981 Test Loss: 0.185 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.8053200244903564
Epoch: 22, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.182 Vali Acc: 0.977 Test Loss: 0.182 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9811977715877437
model parameter : 693140
model size : 2.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps14_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.5975444316864014
Epoch: 1, Steps: 89 | Train Loss: 1.305 Vali Loss: 0.438 Vali Acc: 0.877 Test Loss: 0.438 Test Acc: 0.877
Validation loss decreased (inf --> -0.877433).  Saving model ...
Epoch: 2 cost time: 2.4653353691101074
Epoch: 2, Steps: 89 | Train Loss: 0.244 Vali Loss: 0.222 Vali Acc: 0.935 Test Loss: 0.222 Test Acc: 0.935
Validation loss decreased (-0.877433 --> -0.934538).  Saving model ...
Epoch: 3 cost time: 2.3361597061157227
Epoch: 3, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.138 Vali Acc: 0.962 Test Loss: 0.138 Test Acc: 0.962
Validation loss decreased (-0.934538 --> -0.961698).  Saving model ...
Epoch: 4 cost time: 2.3202338218688965
Epoch: 4, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.118 Vali Acc: 0.970 Test Loss: 0.118 Test Acc: 0.970
Validation loss decreased (-0.961698 --> -0.970055).  Saving model ...
Epoch: 5 cost time: 2.191141128540039
Epoch: 5, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.091 Vali Acc: 0.978 Test Loss: 0.091 Test Acc: 0.978
Validation loss decreased (-0.970055 --> -0.977715).  Saving model ...
Epoch: 6 cost time: 2.5661308765411377
Epoch: 6, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.084 Vali Acc: 0.979 Test Loss: 0.084 Test Acc: 0.979
Validation loss decreased (-0.977715 --> -0.979108).  Saving model ...
Epoch: 7 cost time: 2.6834261417388916
Epoch: 7, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.979108 --> -0.979804).  Saving model ...
Epoch: 8 cost time: 2.31864333152771
Epoch: 8, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.097 Vali Acc: 0.976 Test Loss: 0.097 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.321294069290161
Epoch: 9, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.185 Vali Acc: 0.962 Test Loss: 0.185 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.0798327922821045
Epoch: 10, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.236 Vali Acc: 0.949 Test Loss: 0.236 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.4510843753814697
Epoch: 11, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.149 Vali Acc: 0.969 Test Loss: 0.149 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.516319990158081
Epoch: 12, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.163 Vali Acc: 0.964 Test Loss: 0.163 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.7278339862823486
Epoch: 13, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.140 Vali Acc: 0.973 Test Loss: 0.140 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.0635018348693848
Epoch: 14, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.162 Vali Acc: 0.971 Test Loss: 0.162 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.7391455173492432
Epoch: 15, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.244 Vali Acc: 0.958 Test Loss: 0.244 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.476924180984497
Epoch: 16, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.117 Vali Acc: 0.984 Test Loss: 0.117 Test Acc: 0.984
Validation loss decreased (-0.979804 --> -0.983982).  Saving model ...
Epoch: 17 cost time: 2.4536147117614746
Epoch: 17, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.201 Vali Acc: 0.969 Test Loss: 0.201 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.4645028114318848
Epoch: 18, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.136 Vali Acc: 0.975 Test Loss: 0.136 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.454744815826416
Epoch: 19, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.120 Vali Acc: 0.981 Test Loss: 0.120 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.219494104385376
Epoch: 20, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.128 Vali Acc: 0.975 Test Loss: 0.128 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.1620919704437256
Epoch: 21, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.122 Vali Acc: 0.980 Test Loss: 0.122 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.336226224899292
Epoch: 22, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.110 Vali Acc: 0.983 Test Loss: 0.110 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.2841415405273438
Epoch: 23, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.127 Vali Acc: 0.978 Test Loss: 0.127 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.672628164291382
Epoch: 24, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.157 Vali Acc: 0.981 Test Loss: 0.157 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.012854814529419
Epoch: 25, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.218 Vali Acc: 0.962 Test Loss: 0.218 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.0010955333709717
Epoch: 26, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.148 Vali Acc: 0.980 Test Loss: 0.148 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps14_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.983983286908078
model parameter : 616852
model size : 2.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps19_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.713468074798584
Epoch: 1, Steps: 89 | Train Loss: 1.460 Vali Loss: 0.469 Vali Acc: 0.869 Test Loss: 0.469 Test Acc: 0.869
Validation loss decreased (inf --> -0.869076).  Saving model ...
Epoch: 2 cost time: 2.032102346420288
Epoch: 2, Steps: 89 | Train Loss: 0.291 Vali Loss: 0.187 Vali Acc: 0.959 Test Loss: 0.187 Test Acc: 0.959
Validation loss decreased (-0.869076 --> -0.958912).  Saving model ...
Epoch: 3 cost time: 1.9444918632507324
Epoch: 3, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.166 Vali Acc: 0.954 Test Loss: 0.166 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.3021814823150635
Epoch: 4, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.091 Vali Acc: 0.978 Test Loss: 0.091 Test Acc: 0.978
Validation loss decreased (-0.958912 --> -0.978411).  Saving model ...
Epoch: 5 cost time: 2.4460363388061523
Epoch: 5, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.080 Vali Acc: 0.978 Test Loss: 0.080 Test Acc: 0.978
Validation loss decreased (-0.978411 --> -0.978411).  Saving model ...
Epoch: 6 cost time: 1.9909532070159912
Epoch: 6, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.085 Vali Acc: 0.981 Test Loss: 0.085 Test Acc: 0.981
Validation loss decreased (-0.978411 --> -0.980501).  Saving model ...
Epoch: 7 cost time: 1.8235394954681396
Epoch: 7, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.094 Vali Acc: 0.981 Test Loss: 0.094 Test Acc: 0.981
Validation loss decreased (-0.980501 --> -0.981197).  Saving model ...
Epoch: 8 cost time: 1.7456817626953125
Epoch: 8, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.076 Vali Acc: 0.981 Test Loss: 0.076 Test Acc: 0.981
Validation loss decreased (-0.981197 --> -0.981197).  Saving model ...
Epoch: 9 cost time: 2.5002658367156982
Epoch: 9, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.4034640789031982
Epoch: 10, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.981197 --> -0.982590).  Saving model ...
Epoch: 11 cost time: 2.221014976501465
Epoch: 11, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.982590 --> -0.983286).  Saving model ...
Epoch: 12 cost time: 2.281883955001831
Epoch: 12, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.140 Vali Acc: 0.956 Test Loss: 0.140 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.1970632076263428
Epoch: 13, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.176 Vali Acc: 0.971 Test Loss: 0.176 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.431788444519043
Epoch: 14, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.136 Vali Acc: 0.976 Test Loss: 0.136 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.4868292808532715
Epoch: 15, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.094 Vali Acc: 0.981 Test Loss: 0.094 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.4498019218444824
Epoch: 16, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.121 Vali Acc: 0.981 Test Loss: 0.121 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.3143768310546875
Epoch: 17, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.111 Vali Acc: 0.985 Test Loss: 0.111 Test Acc: 0.985
Validation loss decreased (-0.983286 --> -0.984679).  Saving model ...
Epoch: 18 cost time: 1.8952224254608154
Epoch: 18, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.102 Vali Acc: 0.983 Test Loss: 0.102 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.9800097942352295
Epoch: 19, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.104 Vali Acc: 0.985 Test Loss: 0.104 Test Acc: 0.985
Validation loss decreased (-0.984679 --> -0.985375).  Saving model ...
Epoch: 20 cost time: 2.3077950477600098
Epoch: 20, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.985 Test Loss: 0.098 Test Acc: 0.985
Validation loss decreased (-0.985375 --> -0.985375).  Saving model ...
Epoch: 21 cost time: 2.407442808151245
Epoch: 21, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.987 Test Loss: 0.100 Test Acc: 0.987
Validation loss decreased (-0.985375 --> -0.986768).  Saving model ...
Epoch: 22 cost time: 1.970780849456787
Epoch: 22, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.987 Test Loss: 0.097 Test Acc: 0.987
Validation loss decreased (-0.986768 --> -0.986768).  Saving model ...
Epoch: 23 cost time: 1.9048969745635986
Epoch: 23, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.986 Test Loss: 0.099 Test Acc: 0.986
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.9523751735687256
Epoch: 24, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.987 Test Loss: 0.100 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.7623488903045654
Epoch: 25, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.987 Test Loss: 0.095 Test Acc: 0.987
Validation loss decreased (-0.986768 --> -0.986768).  Saving model ...
Epoch: 26 cost time: 1.4109406471252441
Epoch: 26, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.986 Test Loss: 0.104 Test Acc: 0.986
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.4301958084106445
Epoch: 27, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.986 Test Loss: 0.099 Test Acc: 0.986
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.4623034000396729
Epoch: 28, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.987 Test Loss: 0.099 Test Acc: 0.987
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.066171884536743
Epoch: 29, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.987 Test Loss: 0.097 Test Acc: 0.987
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.26371693611145
Epoch: 30, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.987 Test Loss: 0.101 Test Acc: 0.987
Validation loss decreased (-0.986768 --> -0.987464).  Saving model ...
Epoch: 31 cost time: 2.308514356613159
Epoch: 31, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.985 Test Loss: 0.101 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.304481267929077
Epoch: 32, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.987 Test Loss: 0.097 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.9547159671783447
Epoch: 33, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.987 Test Loss: 0.100 Test Acc: 0.987
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.8111462593078613
Epoch: 34, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.987 Test Loss: 0.099 Test Acc: 0.987
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 2.2883572578430176
Epoch: 35, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.987 Test Loss: 0.096 Test Acc: 0.987
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 2.329824686050415
Epoch: 36, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.986 Test Loss: 0.100 Test Acc: 0.986
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 2.2464826107025146
Epoch: 37, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.986 Test Loss: 0.098 Test Acc: 0.986
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 2.1700327396392822
Epoch: 38, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.986 Test Loss: 0.096 Test Acc: 0.986
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 2.0213677883148193
Epoch: 39, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.986 Test Loss: 0.098 Test Acc: 0.986
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 2.344747543334961
Epoch: 40, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.987 Test Loss: 0.103 Test Acc: 0.987
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps19_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9874651810584958
model parameter : 556052
model size : 2.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps28_str14_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.1411266326904297
Epoch: 1, Steps: 89 | Train Loss: 1.613 Vali Loss: 0.584 Vali Acc: 0.855 Test Loss: 0.584 Test Acc: 0.855
Validation loss decreased (inf --> -0.855147).  Saving model ...
Epoch: 2 cost time: 1.9122734069824219
Epoch: 2, Steps: 89 | Train Loss: 0.356 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
Validation loss decreased (-0.855147 --> -0.944287).  Saving model ...
Epoch: 3 cost time: 2.2114968299865723
Epoch: 3, Steps: 89 | Train Loss: 0.144 Vali Loss: 0.122 Vali Acc: 0.971 Test Loss: 0.122 Test Acc: 0.971
Validation loss decreased (-0.944287 --> -0.970751).  Saving model ...
Epoch: 4 cost time: 2.2209722995758057
Epoch: 4, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.104 Vali Acc: 0.978 Test Loss: 0.104 Test Acc: 0.978
Validation loss decreased (-0.970751 --> -0.978411).  Saving model ...
Epoch: 5 cost time: 2.290790319442749
Epoch: 5, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8103322982788086
Epoch: 6, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.079 Vali Acc: 0.982 Test Loss: 0.079 Test Acc: 0.982
Validation loss decreased (-0.978411 --> -0.981893).  Saving model ...
Epoch: 7 cost time: 1.525982141494751
Epoch: 7, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.075 Vali Acc: 0.979 Test Loss: 0.075 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5864324569702148
Epoch: 8, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.173 Vali Acc: 0.960 Test Loss: 0.173 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.2259278297424316
Epoch: 9, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.981893 --> -0.983286).  Saving model ...
Epoch: 10 cost time: 2.1779534816741943
Epoch: 10, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.3292531967163086
Epoch: 11, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.403657913208008
Epoch: 12, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.077 Vali Acc: 0.981 Test Loss: 0.077 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.1655662059783936
Epoch: 13, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.068 Vali Acc: 0.984 Test Loss: 0.068 Test Acc: 0.984
Validation loss decreased (-0.983286 --> -0.983983).  Saving model ...
Epoch: 14 cost time: 2.361940860748291
Epoch: 14, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.087 Vali Acc: 0.981 Test Loss: 0.087 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.31196665763855
Epoch: 15, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.107 Vali Acc: 0.978 Test Loss: 0.107 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.1149401664733887
Epoch: 16, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.105 Vali Acc: 0.979 Test Loss: 0.105 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.2369744777679443
Epoch: 17, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.01886248588562
Epoch: 18, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.5362982749938965
Epoch: 19, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.096 Vali Acc: 0.979 Test Loss: 0.096 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.4119324684143066
Epoch: 20, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.138 Vali Acc: 0.974 Test Loss: 0.138 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.306195020675659
Epoch: 21, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.141 Vali Acc: 0.973 Test Loss: 0.141 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.3204052448272705
Epoch: 22, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.117 Vali Acc: 0.984 Test Loss: 0.117 Test Acc: 0.984
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.0147886276245117
Epoch: 23, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.098 Vali Acc: 0.983 Test Loss: 0.098 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps28_str14_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.983983286908078
model parameter : 518804
model size : 2.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps37_str19_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.0988988876342773
Epoch: 1, Steps: 89 | Train Loss: 1.862 Vali Loss: 0.778 Vali Acc: 0.816 Test Loss: 0.778 Test Acc: 0.816
Validation loss decreased (inf --> -0.816148).  Saving model ...
Epoch: 2 cost time: 1.9837441444396973
Epoch: 2, Steps: 89 | Train Loss: 0.461 Vali Loss: 0.303 Vali Acc: 0.923 Test Loss: 0.303 Test Acc: 0.923
Validation loss decreased (-0.816148 --> -0.922699).  Saving model ...
Epoch: 3 cost time: 2.0129222869873047
Epoch: 3, Steps: 89 | Train Loss: 0.191 Vali Loss: 0.164 Vali Acc: 0.951 Test Loss: 0.164 Test Acc: 0.951
Validation loss decreased (-0.922699 --> -0.950555).  Saving model ...
Epoch: 4 cost time: 2.4016213417053223
Epoch: 4, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.131 Vali Acc: 0.959 Test Loss: 0.131 Test Acc: 0.959
Validation loss decreased (-0.950555 --> -0.958912).  Saving model ...
Epoch: 5 cost time: 2.503782272338867
Epoch: 5, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.118 Vali Acc: 0.970 Test Loss: 0.118 Test Acc: 0.970
Validation loss decreased (-0.958912 --> -0.970055).  Saving model ...
Epoch: 6 cost time: 2.322788953781128
Epoch: 6, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
Validation loss decreased (-0.970055 --> -0.977019).  Saving model ...
Epoch: 7 cost time: 2.243227481842041
Epoch: 7, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.071 Vali Acc: 0.985 Test Loss: 0.071 Test Acc: 0.985
Validation loss decreased (-0.977019 --> -0.985375).  Saving model ...
Epoch: 8 cost time: 2.222134590148926
Epoch: 8, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.539553165435791
Epoch: 9, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.086 Vali Acc: 0.974 Test Loss: 0.086 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.4513134956359863
Epoch: 10, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.482414960861206
Epoch: 11, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.063 Vali Acc: 0.985 Test Loss: 0.063 Test Acc: 0.985
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.505730628967285
Epoch: 12, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.0150468349456787
Epoch: 13, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.068 Vali Acc: 0.981 Test Loss: 0.068 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.9163808822631836
Epoch: 14, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.3090004920959473
Epoch: 15, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.067 Vali Acc: 0.986 Test Loss: 0.067 Test Acc: 0.986
Validation loss decreased (-0.985375 --> -0.986072).  Saving model ...
Epoch: 16 cost time: 2.5665056705474854
Epoch: 16, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.156 Vali Acc: 0.961 Test Loss: 0.156 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.4013938903808594
Epoch: 17, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.066 Vali Acc: 0.986 Test Loss: 0.066 Test Acc: 0.986
Validation loss decreased (-0.986072 --> -0.986072).  Saving model ...
Epoch: 18 cost time: 1.9658234119415283
Epoch: 18, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.95967435836792
Epoch: 19, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.129 Vali Acc: 0.976 Test Loss: 0.129 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.40334153175354
Epoch: 20, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.072 Vali Acc: 0.985 Test Loss: 0.072 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.2802460193634033
Epoch: 21, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.156 Vali Acc: 0.962 Test Loss: 0.156 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.335627794265747
Epoch: 22, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.112 Vali Acc: 0.978 Test Loss: 0.112 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.3956408500671387
Epoch: 23, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.094 Vali Acc: 0.983 Test Loss: 0.094 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.9369935989379883
Epoch: 24, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.164 Vali Acc: 0.967 Test Loss: 0.164 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.207183837890625
Epoch: 25, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.140 Vali Acc: 0.972 Test Loss: 0.140 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.4554522037506104
Epoch: 26, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.9836249351501465
Epoch: 27, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.123 Vali Acc: 0.976 Test Loss: 0.123 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps37_str19_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9860724233983287
model parameter : 489236
model size : 1.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps46_str23_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.218500852584839
Epoch: 1, Steps: 89 | Train Loss: 1.948 Vali Loss: 0.875 Vali Acc: 0.812 Test Loss: 0.875 Test Acc: 0.812
Validation loss decreased (inf --> -0.811969).  Saving model ...
Epoch: 2 cost time: 2.191098690032959
Epoch: 2, Steps: 89 | Train Loss: 0.523 Vali Loss: 0.320 Vali Acc: 0.923 Test Loss: 0.320 Test Acc: 0.923
Validation loss decreased (-0.811969 --> -0.922699).  Saving model ...
Epoch: 3 cost time: 2.2564868927001953
Epoch: 3, Steps: 89 | Train Loss: 0.213 Vali Loss: 0.171 Vali Acc: 0.963 Test Loss: 0.171 Test Acc: 0.963
Validation loss decreased (-0.922699 --> -0.963090).  Saving model ...
Epoch: 4 cost time: 1.9128897190093994
Epoch: 4, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.115 Vali Acc: 0.970 Test Loss: 0.115 Test Acc: 0.970
Validation loss decreased (-0.963090 --> -0.970055).  Saving model ...
Epoch: 5 cost time: 1.7592756748199463
Epoch: 5, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.109 Vali Acc: 0.975 Test Loss: 0.109 Test Acc: 0.975
Validation loss decreased (-0.970055 --> -0.974929).  Saving model ...
Epoch: 6 cost time: 2.126227617263794
Epoch: 6, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.974929 --> -0.982590).  Saving model ...
Epoch: 7 cost time: 2.2737746238708496
Epoch: 7, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.072 Vali Acc: 0.982 Test Loss: 0.072 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.3706412315368652
Epoch: 8, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.061 Vali Acc: 0.982 Test Loss: 0.061 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.1948530673980713
Epoch: 9, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.084 Vali Acc: 0.974 Test Loss: 0.084 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.8057467937469482
Epoch: 10, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.0411040782928467
Epoch: 11, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.058 Vali Acc: 0.986 Test Loss: 0.058 Test Acc: 0.986
Validation loss decreased (-0.982590 --> -0.986072).  Saving model ...
Epoch: 12 cost time: 2.3672828674316406
Epoch: 12, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.067 Vali Acc: 0.981 Test Loss: 0.067 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.4254062175750732
Epoch: 13, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.922715187072754
Epoch: 14, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.060 Vali Acc: 0.987 Test Loss: 0.060 Test Acc: 0.987
Validation loss decreased (-0.986072 --> -0.987465).  Saving model ...
Epoch: 15 cost time: 2.002972364425659
Epoch: 15, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.9599878787994385
Epoch: 16, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.6993651390075684
Epoch: 17, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.073 Vali Acc: 0.982 Test Loss: 0.073 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.0469772815704346
Epoch: 18, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.074 Vali Acc: 0.981 Test Loss: 0.074 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.0157694816589355
Epoch: 19, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.164 Vali Acc: 0.963 Test Loss: 0.164 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.8182098865509033
Epoch: 20, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.083 Vali Acc: 0.981 Test Loss: 0.083 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.0733883380889893
Epoch: 21, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.070 Vali Acc: 0.984 Test Loss: 0.070 Test Acc: 0.984
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.387244701385498
Epoch: 22, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.359686851501465
Epoch: 23, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.077 Vali Acc: 0.981 Test Loss: 0.077 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.219801425933838
Epoch: 24, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.069 Vali Acc: 0.985 Test Loss: 0.069 Test Acc: 0.985
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128_nb1_lk13_sk5_ffr4_ps46_str23_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9874651810584958
model parameter : 475028
model size : 1.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.305915594100952
Epoch: 1, Steps: 89 | Train Loss: 1.281 Vali Loss: 0.397 Vali Acc: 0.898 Test Loss: 0.397 Test Acc: 0.898
Validation loss decreased (inf --> -0.897628).  Saving model ...
Epoch: 2 cost time: 2.192128896713257
Epoch: 2, Steps: 89 | Train Loss: 0.237 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
Validation loss decreased (-0.897628 --> -0.943591).  Saving model ...
Epoch: 3 cost time: 1.7561562061309814
Epoch: 3, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.143 Vali Acc: 0.969 Test Loss: 0.143 Test Acc: 0.969
Validation loss decreased (-0.943591 --> -0.968662).  Saving model ...
Epoch: 4 cost time: 2.0646724700927734
Epoch: 4, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.157 Vali Acc: 0.968 Test Loss: 0.157 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.192990303039551
Epoch: 5, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.136 Vali Acc: 0.976 Test Loss: 0.136 Test Acc: 0.976
Validation loss decreased (-0.968662 --> -0.976322).  Saving model ...
Epoch: 6 cost time: 2.1564040184020996
Epoch: 6, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.145 Vali Acc: 0.969 Test Loss: 0.145 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.704477310180664
Epoch: 7, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.147 Vali Acc: 0.964 Test Loss: 0.147 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.5669810771942139
Epoch: 8, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.131 Vali Acc: 0.969 Test Loss: 0.131 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.5108463764190674
Epoch: 9, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.162 Vali Acc: 0.969 Test Loss: 0.162 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.1231276988983154
Epoch: 10, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.210 Vali Acc: 0.968 Test Loss: 0.210 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.0857932567596436
Epoch: 11, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.166 Vali Acc: 0.974 Test Loss: 0.166 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.1363229751586914
Epoch: 12, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.161 Vali Acc: 0.974 Test Loss: 0.161 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.164562702178955
Epoch: 13, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.157 Vali Acc: 0.974 Test Loss: 0.157 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.9007153511047363
Epoch: 14, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.155 Vali Acc: 0.974 Test Loss: 0.155 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.7933108806610107
Epoch: 15, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.179 Vali Acc: 0.970 Test Loss: 0.179 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9763231197771588
model parameter : 340116
model size : 1.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.023956298828125
Epoch: 1, Steps: 89 | Train Loss: 1.452 Vali Loss: 0.512 Vali Acc: 0.889 Test Loss: 0.512 Test Acc: 0.889
Validation loss decreased (inf --> -0.889271).  Saving model ...
Epoch: 2 cost time: 1.5902595520019531
Epoch: 2, Steps: 89 | Train Loss: 0.320 Vali Loss: 0.222 Vali Acc: 0.946 Test Loss: 0.222 Test Acc: 0.946
Validation loss decreased (-0.889271 --> -0.946377).  Saving model ...
Epoch: 3 cost time: 1.529252290725708
Epoch: 3, Steps: 89 | Train Loss: 0.126 Vali Loss: 0.147 Vali Acc: 0.964 Test Loss: 0.147 Test Acc: 0.964
Validation loss decreased (-0.946377 --> -0.963787).  Saving model ...
Epoch: 4 cost time: 1.3460183143615723
Epoch: 4, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.127 Vali Acc: 0.972 Test Loss: 0.127 Test Acc: 0.972
Validation loss decreased (-0.963787 --> -0.972144).  Saving model ...
Epoch: 5 cost time: 1.3809316158294678
Epoch: 5, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
Validation loss decreased (-0.972144 --> -0.976322).  Saving model ...
Epoch: 6 cost time: 1.2299683094024658
Epoch: 6, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
Validation loss decreased (-0.976322 --> -0.976322).  Saving model ...
Epoch: 7 cost time: 1.3155722618103027
Epoch: 7, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.976322 --> -0.979804).  Saving model ...
Epoch: 8 cost time: 1.9186158180236816
Epoch: 8, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.117 Vali Acc: 0.966 Test Loss: 0.117 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9217989444732666
Epoch: 9, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.082 Vali Acc: 0.981 Test Loss: 0.082 Test Acc: 0.981
Validation loss decreased (-0.979804 --> -0.980501).  Saving model ...
Epoch: 10 cost time: 1.8416314125061035
Epoch: 10, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8489062786102295
Epoch: 11, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
Validation loss decreased (-0.980501 --> -0.983286).  Saving model ...
Epoch: 12 cost time: 1.4644830226898193
Epoch: 12, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.109 Vali Acc: 0.978 Test Loss: 0.109 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.8052139282226562
Epoch: 13, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.142 Vali Acc: 0.976 Test Loss: 0.142 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.9455382823944092
Epoch: 14, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.151 Vali Acc: 0.963 Test Loss: 0.151 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.9844520092010498
Epoch: 15, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.081 Vali Acc: 0.984 Test Loss: 0.081 Test Acc: 0.984
Validation loss decreased (-0.983286 --> -0.983982).  Saving model ...
Epoch: 16 cost time: 1.7457013130187988
Epoch: 16, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.129 Vali Acc: 0.972 Test Loss: 0.129 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.587183952331543
Epoch: 17, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.098 Vali Acc: 0.981 Test Loss: 0.098 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3155591487884521
Epoch: 18, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.120 Vali Acc: 0.976 Test Loss: 0.120 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.7137632369995117
Epoch: 19, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.100 Vali Acc: 0.983 Test Loss: 0.100 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.8152751922607422
Epoch: 20, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.096 Vali Acc: 0.983 Test Loss: 0.096 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.8163681030273438
Epoch: 21, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.983 Test Loss: 0.095 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.0355706214904785
Epoch: 22, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.983 Test Loss: 0.097 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.8366374969482422
Epoch: 23, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.983 Test Loss: 0.095 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.5454316139221191
Epoch: 24, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.983 Test Loss: 0.094 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.513556718826294
Epoch: 25, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.983 Test Loss: 0.094 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.983983286908078
model parameter : 248276
model size : 0.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps14_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.0003061294555664
Epoch: 1, Steps: 89 | Train Loss: 1.714 Vali Loss: 0.657 Vali Acc: 0.845 Test Loss: 0.657 Test Acc: 0.845
Validation loss decreased (inf --> -0.845397).  Saving model ...
Epoch: 2 cost time: 1.7480103969573975
Epoch: 2, Steps: 89 | Train Loss: 0.388 Vali Loss: 0.286 Vali Acc: 0.932 Test Loss: 0.286 Test Acc: 0.932
Validation loss decreased (-0.845397 --> -0.932448).  Saving model ...
Epoch: 3 cost time: 1.5679426193237305
Epoch: 3, Steps: 89 | Train Loss: 0.159 Vali Loss: 0.155 Vali Acc: 0.962 Test Loss: 0.155 Test Acc: 0.962
Validation loss decreased (-0.932448 --> -0.961698).  Saving model ...
Epoch: 4 cost time: 1.8992671966552734
Epoch: 4, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
Validation loss decreased (-0.961698 --> -0.972840).  Saving model ...
Epoch: 5 cost time: 1.8700571060180664
Epoch: 5, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.090 Vali Acc: 0.981 Test Loss: 0.090 Test Acc: 0.981
Validation loss decreased (-0.972840 --> -0.980500).  Saving model ...
Epoch: 6 cost time: 1.6967995166778564
Epoch: 6, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.980500 --> -0.982590).  Saving model ...
Epoch: 7 cost time: 1.6360080242156982
Epoch: 7, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.096 Vali Acc: 0.979 Test Loss: 0.096 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4678568840026855
Epoch: 8, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.093 Vali Acc: 0.983 Test Loss: 0.093 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.7193706035614014
Epoch: 9, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.073 Vali Acc: 0.982 Test Loss: 0.073 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.8134257793426514
Epoch: 10, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.074 Vali Acc: 0.981 Test Loss: 0.074 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.7684075832366943
Epoch: 11, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.982590 --> -0.982590).  Saving model ...
Epoch: 12 cost time: 2.0702755451202393
Epoch: 12, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.102 Vali Acc: 0.978 Test Loss: 0.102 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.0288679599761963
Epoch: 13, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.124 Vali Acc: 0.969 Test Loss: 0.124 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.6694974899291992
Epoch: 14, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.068 Vali Acc: 0.985 Test Loss: 0.068 Test Acc: 0.985
Validation loss decreased (-0.982590 --> -0.985375).  Saving model ...
Epoch: 15 cost time: 1.9301271438598633
Epoch: 15, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.9656383991241455
Epoch: 16, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.086 Vali Acc: 0.981 Test Loss: 0.086 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.820357084274292
Epoch: 17, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.8391900062561035
Epoch: 18, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.9591174125671387
Epoch: 19, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.092 Vali Acc: 0.981 Test Loss: 0.092 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.6533167362213135
Epoch: 20, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.117 Vali Acc: 0.982 Test Loss: 0.117 Test Acc: 0.982
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.9302170276641846
Epoch: 21, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.126 Vali Acc: 0.978 Test Loss: 0.126 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.9746654033660889
Epoch: 22, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.092 Vali Acc: 0.983 Test Loss: 0.092 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.0412285327911377
Epoch: 23, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.108 Vali Acc: 0.981 Test Loss: 0.108 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.8995811939239502
Epoch: 24, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.107 Vali Acc: 0.981 Test Loss: 0.107 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps14_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9853760445682451
model parameter : 210132
model size : 0.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps19_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.988316535949707
Epoch: 1, Steps: 89 | Train Loss: 1.920 Vali Loss: 0.801 Vali Acc: 0.838 Test Loss: 0.801 Test Acc: 0.838
Validation loss decreased (inf --> -0.838432).  Saving model ...
Epoch: 2 cost time: 1.8988676071166992
Epoch: 2, Steps: 89 | Train Loss: 0.487 Vali Loss: 0.336 Vali Acc: 0.913 Test Loss: 0.336 Test Acc: 0.913
Validation loss decreased (-0.838432 --> -0.912949).  Saving model ...
Epoch: 3 cost time: 1.6772677898406982
Epoch: 3, Steps: 89 | Train Loss: 0.196 Vali Loss: 0.182 Vali Acc: 0.952 Test Loss: 0.182 Test Acc: 0.952
Validation loss decreased (-0.912949 --> -0.951948).  Saving model ...
Epoch: 4 cost time: 1.5720820426940918
Epoch: 4, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.126 Vali Acc: 0.966 Test Loss: 0.126 Test Acc: 0.966
Validation loss decreased (-0.951948 --> -0.965876).  Saving model ...
Epoch: 5 cost time: 1.4605283737182617
Epoch: 5, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.092 Vali Acc: 0.981 Test Loss: 0.092 Test Acc: 0.981
Validation loss decreased (-0.965876 --> -0.980500).  Saving model ...
Epoch: 6 cost time: 1.8663599491119385
Epoch: 6, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.846829891204834
Epoch: 7, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.076 Vali Acc: 0.978 Test Loss: 0.076 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.8081963062286377
Epoch: 8, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.067 Vali Acc: 0.980 Test Loss: 0.067 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.8581275939941406
Epoch: 9, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.088 Vali Acc: 0.978 Test Loss: 0.088 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.760274887084961
Epoch: 10, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.146 Vali Acc: 0.963 Test Loss: 0.146 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.5826597213745117
Epoch: 11, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.980500 --> -0.982590).  Saving model ...
Epoch: 12 cost time: 1.8405189514160156
Epoch: 12, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
Validation loss decreased (-0.982590 --> -0.982590).  Saving model ...
Epoch: 13 cost time: 1.7777698040008545
Epoch: 13, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.8980698585510254
Epoch: 14, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.125 Vali Acc: 0.974 Test Loss: 0.125 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.8350720405578613
Epoch: 15, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.096 Vali Acc: 0.983 Test Loss: 0.096 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.8978710174560547
Epoch: 16, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.136 Vali Acc: 0.969 Test Loss: 0.136 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.5945520401000977
Epoch: 17, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.6529347896575928
Epoch: 18, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.982590 --> -0.983286).  Saving model ...
Epoch: 19 cost time: 1.6916084289550781
Epoch: 19, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.823061227798462
Epoch: 20, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.095 Vali Acc: 0.983 Test Loss: 0.095 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.7507493495941162
Epoch: 21, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.690622091293335
Epoch: 22, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.119 Vali Acc: 0.976 Test Loss: 0.119 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.4702870845794678
Epoch: 23, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.122 Vali Acc: 0.970 Test Loss: 0.122 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.3956656455993652
Epoch: 24, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.070 Vali Acc: 0.984 Test Loss: 0.070 Test Acc: 0.984
Validation loss decreased (-0.983286 --> -0.983983).  Saving model ...
Epoch: 25 cost time: 1.68691086769104
Epoch: 25, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.076 Vali Acc: 0.981 Test Loss: 0.076 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.8587608337402344
Epoch: 26, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.985 Test Loss: 0.076 Test Acc: 0.985
Validation loss decreased (-0.983983 --> -0.984679).  Saving model ...
Epoch: 27 cost time: 1.8523352146148682
Epoch: 27, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.072 Vali Acc: 0.984 Test Loss: 0.072 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.876295566558838
Epoch: 28, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.096 Vali Acc: 0.981 Test Loss: 0.096 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.7471683025360107
Epoch: 29, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.094 Vali Acc: 0.982 Test Loss: 0.094 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.7009847164154053
Epoch: 30, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.128 Vali Acc: 0.980 Test Loss: 0.128 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.8173186779022217
Epoch: 31, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.112 Vali Acc: 0.983 Test Loss: 0.112 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.7778065204620361
Epoch: 32, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.982 Test Loss: 0.098 Test Acc: 0.982
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.7794291973114014
Epoch: 33, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.7826323509216309
Epoch: 34, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.102 Vali Acc: 0.981 Test Loss: 0.102 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.6148455142974854
Epoch: 35, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.120 Vali Acc: 0.978 Test Loss: 0.120 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.6432082653045654
Epoch: 36, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.192 Vali Acc: 0.967 Test Loss: 0.192 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps19_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9846796657381616
model parameter : 179732
model size : 0.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps28_str14_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.749709367752075
Epoch: 1, Steps: 89 | Train Loss: 2.075 Vali Loss: 1.011 Vali Acc: 0.839 Test Loss: 1.011 Test Acc: 0.839
Validation loss decreased (inf --> -0.839126).  Saving model ...
Epoch: 2 cost time: 1.450293779373169
Epoch: 2, Steps: 89 | Train Loss: 0.621 Vali Loss: 0.385 Vali Acc: 0.925 Test Loss: 0.385 Test Acc: 0.925
Validation loss decreased (-0.839126 --> -0.925484).  Saving model ...
Epoch: 3 cost time: 1.4991612434387207
Epoch: 3, Steps: 89 | Train Loss: 0.257 Vali Loss: 0.208 Vali Acc: 0.939 Test Loss: 0.208 Test Acc: 0.939
Validation loss decreased (-0.925484 --> -0.939413).  Saving model ...
Epoch: 4 cost time: 1.8905656337738037
Epoch: 4, Steps: 89 | Train Loss: 0.126 Vali Loss: 0.123 Vali Acc: 0.972 Test Loss: 0.123 Test Acc: 0.972
Validation loss decreased (-0.939413 --> -0.972144).  Saving model ...
Epoch: 5 cost time: 1.6983752250671387
Epoch: 5, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.101 Vali Acc: 0.972 Test Loss: 0.101 Test Acc: 0.972
Validation loss decreased (-0.972144 --> -0.972144).  Saving model ...
Epoch: 6 cost time: 1.7018163204193115
Epoch: 6, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.074 Vali Acc: 0.985 Test Loss: 0.074 Test Acc: 0.985
Validation loss decreased (-0.972144 --> -0.985375).  Saving model ...
Epoch: 7 cost time: 1.701592206954956
Epoch: 7, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.079 Vali Acc: 0.976 Test Loss: 0.079 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6492409706115723
Epoch: 8, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.065 Vali Acc: 0.982 Test Loss: 0.065 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.6007063388824463
Epoch: 9, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.064 Vali Acc: 0.985 Test Loss: 0.064 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.8211188316345215
Epoch: 10, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.066 Vali Acc: 0.984 Test Loss: 0.066 Test Acc: 0.984
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.793832778930664
Epoch: 11, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.7938263416290283
Epoch: 12, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.070 Vali Acc: 0.984 Test Loss: 0.070 Test Acc: 0.984
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.857053518295288
Epoch: 13, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.076 Vali Acc: 0.982 Test Loss: 0.076 Test Acc: 0.982
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.5463080406188965
Epoch: 14, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.4593555927276611
Epoch: 15, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.071 Vali Acc: 0.982 Test Loss: 0.071 Test Acc: 0.982
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.6440489292144775
Epoch: 16, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps28_str14_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9853760445682451
model parameter : 161108
model size : 0.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps37_str19_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.642141819000244
Epoch: 1, Steps: 89 | Train Loss: 2.181 Vali Loss: 1.236 Vali Acc: 0.762 Test Loss: 1.236 Test Acc: 0.762
Validation loss decreased (inf --> -0.761826).  Saving model ...
Epoch: 2 cost time: 1.4335486888885498
Epoch: 2, Steps: 89 | Train Loss: 0.802 Vali Loss: 0.514 Vali Acc: 0.888 Test Loss: 0.514 Test Acc: 0.888
Validation loss decreased (-0.761826 --> -0.887878).  Saving model ...
Epoch: 3 cost time: 1.6559779644012451
Epoch: 3, Steps: 89 | Train Loss: 0.360 Vali Loss: 0.262 Vali Acc: 0.935 Test Loss: 0.262 Test Acc: 0.935
Validation loss decreased (-0.887878 --> -0.935234).  Saving model ...
Epoch: 4 cost time: 1.7814579010009766
Epoch: 4, Steps: 89 | Train Loss: 0.184 Vali Loss: 0.158 Vali Acc: 0.958 Test Loss: 0.158 Test Acc: 0.958
Validation loss decreased (-0.935234 --> -0.958216).  Saving model ...
Epoch: 5 cost time: 1.6332473754882812
Epoch: 5, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.111 Vali Acc: 0.978 Test Loss: 0.111 Test Acc: 0.978
Validation loss decreased (-0.958216 --> -0.978411).  Saving model ...
Epoch: 6 cost time: 1.636408805847168
Epoch: 6, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.110 Vali Acc: 0.966 Test Loss: 0.110 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4179458618164062
Epoch: 7, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.105 Vali Acc: 0.967 Test Loss: 0.105 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.542175054550171
Epoch: 8, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.084 Vali Acc: 0.978 Test Loss: 0.084 Test Acc: 0.978
Validation loss decreased (-0.978411 --> -0.978411).  Saving model ...
Epoch: 9 cost time: 1.786738395690918
Epoch: 9, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.080 Vali Acc: 0.978 Test Loss: 0.080 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7999327182769775
Epoch: 10, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.071 Vali Acc: 0.982 Test Loss: 0.071 Test Acc: 0.982
Validation loss decreased (-0.978411 --> -0.981893).  Saving model ...
Epoch: 11 cost time: 1.767756700515747
Epoch: 11, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.072 Vali Acc: 0.979 Test Loss: 0.072 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.78165864944458
Epoch: 12, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.072 Vali Acc: 0.978 Test Loss: 0.072 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.4410390853881836
Epoch: 13, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.981893 --> -0.983286).  Saving model ...
Epoch: 14 cost time: 1.4139559268951416
Epoch: 14, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6371557712554932
Epoch: 15, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.085 Vali Acc: 0.981 Test Loss: 0.085 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.5680546760559082
Epoch: 16, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.058 Vali Acc: 0.985 Test Loss: 0.058 Test Acc: 0.985
Validation loss decreased (-0.983286 --> -0.985375).  Saving model ...
Epoch: 17 cost time: 1.5657472610473633
Epoch: 17, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.080 Vali Acc: 0.981 Test Loss: 0.080 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.6086738109588623
Epoch: 18, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.099 Vali Acc: 0.971 Test Loss: 0.099 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.6426475048065186
Epoch: 19, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.057 Vali Acc: 0.984 Test Loss: 0.057 Test Acc: 0.984
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.4923620223999023
Epoch: 20, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.066 Vali Acc: 0.984 Test Loss: 0.066 Test Acc: 0.984
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.7461564540863037
Epoch: 21, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.095 Vali Acc: 0.975 Test Loss: 0.095 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.6696193218231201
Epoch: 22, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.695605993270874
Epoch: 23, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.109 Vali Acc: 0.968 Test Loss: 0.109 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.7572472095489502
Epoch: 24, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.118 Vali Acc: 0.973 Test Loss: 0.118 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.5949161052703857
Epoch: 25, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.071 Vali Acc: 0.981 Test Loss: 0.071 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.4232916831970215
Epoch: 26, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.108 Vali Acc: 0.976 Test Loss: 0.108 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps37_str19_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9853760445682451
model parameter : 146324
model size : 0.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps46_str23_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.7835562229156494
Epoch: 1, Steps: 89 | Train Loss: 2.321 Vali Loss: 1.431 Vali Acc: 0.724 Test Loss: 1.431 Test Acc: 0.724
Validation loss decreased (inf --> -0.724220).  Saving model ...
Epoch: 2 cost time: 1.697779893875122
Epoch: 2, Steps: 89 | Train Loss: 0.912 Vali Loss: 0.580 Vali Acc: 0.874 Test Loss: 0.580 Test Acc: 0.874
Validation loss decreased (-0.724220 --> -0.873950).  Saving model ...
Epoch: 3 cost time: 1.4780876636505127
Epoch: 3, Steps: 89 | Train Loss: 0.396 Vali Loss: 0.288 Vali Acc: 0.932 Test Loss: 0.288 Test Acc: 0.932
Validation loss decreased (-0.873950 --> -0.931752).  Saving model ...
Epoch: 4 cost time: 1.6532783508300781
Epoch: 4, Steps: 89 | Train Loss: 0.198 Vali Loss: 0.168 Vali Acc: 0.962 Test Loss: 0.168 Test Acc: 0.962
Validation loss decreased (-0.931752 --> -0.961697).  Saving model ...
Epoch: 5 cost time: 1.5686583518981934
Epoch: 5, Steps: 89 | Train Loss: 0.135 Vali Loss: 0.128 Vali Acc: 0.970 Test Loss: 0.128 Test Acc: 0.970
Validation loss decreased (-0.961697 --> -0.970054).  Saving model ...
Epoch: 6 cost time: 1.5094056129455566
Epoch: 6, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.111 Vali Acc: 0.976 Test Loss: 0.111 Test Acc: 0.976
Validation loss decreased (-0.970054 --> -0.975626).  Saving model ...
Epoch: 7 cost time: 1.5152454376220703
Epoch: 7, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.975626 --> -0.977019).  Saving model ...
Epoch: 8 cost time: 1.7021918296813965
Epoch: 8, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.089 Vali Acc: 0.978 Test Loss: 0.089 Test Acc: 0.978
Validation loss decreased (-0.977019 --> -0.978411).  Saving model ...
Epoch: 9 cost time: 1.5277462005615234
Epoch: 9, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.089 Vali Acc: 0.978 Test Loss: 0.089 Test Acc: 0.978
Validation loss decreased (-0.978411 --> -0.978411).  Saving model ...
Epoch: 10 cost time: 1.310929298400879
Epoch: 10, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.069 Vali Acc: 0.982 Test Loss: 0.069 Test Acc: 0.982
Validation loss decreased (-0.978411 --> -0.981893).  Saving model ...
Epoch: 11 cost time: 1.68149733543396
Epoch: 11, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
Validation loss decreased (-0.981893 --> -0.982590).  Saving model ...
Epoch: 12 cost time: 1.586745023727417
Epoch: 12, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.078 Vali Acc: 0.976 Test Loss: 0.078 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5809338092803955
Epoch: 13, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.066 Vali Acc: 0.981 Test Loss: 0.066 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.613058090209961
Epoch: 14, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.3584566116333008
Epoch: 15, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
Validation loss decreased (-0.982590 --> -0.983286).  Saving model ...
Epoch: 16 cost time: 1.328369379043579
Epoch: 16, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.052 Vali Acc: 0.987 Test Loss: 0.052 Test Acc: 0.987
Validation loss decreased (-0.983286 --> -0.987465).  Saving model ...
Epoch: 17 cost time: 1.74699068069458
Epoch: 17, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.777756929397583
Epoch: 18, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.7302978038787842
Epoch: 19, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.063 Vali Acc: 0.985 Test Loss: 0.063 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.716139554977417
Epoch: 20, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.063 Vali Acc: 0.984 Test Loss: 0.063 Test Acc: 0.984
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.532083511352539
Epoch: 21, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.063 Vali Acc: 0.982 Test Loss: 0.063 Test Acc: 0.982
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.4691929817199707
Epoch: 22, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.056 Vali Acc: 0.985 Test Loss: 0.056 Test Acc: 0.985
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.6634209156036377
Epoch: 23, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.066 Vali Acc: 0.986 Test Loss: 0.066 Test Acc: 0.986
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.6358685493469238
Epoch: 24, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.143 Vali Acc: 0.966 Test Loss: 0.143 Test Acc: 0.966
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.7067797183990479
Epoch: 25, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.070 Vali Acc: 0.984 Test Loss: 0.070 Test Acc: 0.984
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.6537420749664307
Epoch: 26, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.072 Vali Acc: 0.987 Test Loss: 0.072 Test Acc: 0.987
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64_nb1_lk13_sk5_ffr4_ps46_str23_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9874651810584958
model parameter : 139220
model size : 0.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.523608684539795
Epoch: 1, Steps: 89 | Train Loss: 1.569 Vali Loss: 0.559 Vali Acc: 0.876 Test Loss: 0.559 Test Acc: 0.876
Validation loss decreased (inf --> -0.876039).  Saving model ...
Epoch: 2 cost time: 1.4868288040161133
Epoch: 2, Steps: 89 | Train Loss: 0.338 Vali Loss: 0.271 Vali Acc: 0.935 Test Loss: 0.271 Test Acc: 0.935
Validation loss decreased (-0.876039 --> -0.934538).  Saving model ...
Epoch: 3 cost time: 1.5689573287963867
Epoch: 3, Steps: 89 | Train Loss: 0.152 Vali Loss: 0.163 Vali Acc: 0.955 Test Loss: 0.163 Test Acc: 0.955
Validation loss decreased (-0.934538 --> -0.955430).  Saving model ...
Epoch: 4 cost time: 1.2746260166168213
Epoch: 4, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.112 Vali Acc: 0.967 Test Loss: 0.112 Test Acc: 0.967
Validation loss decreased (-0.955430 --> -0.967269).  Saving model ...
Epoch: 5 cost time: 1.1749458312988281
Epoch: 5, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.113 Vali Acc: 0.975 Test Loss: 0.113 Test Acc: 0.975
Validation loss decreased (-0.967269 --> -0.974929).  Saving model ...
Epoch: 6 cost time: 1.3929567337036133
Epoch: 6, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.105 Vali Acc: 0.974 Test Loss: 0.105 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3689906597137451
Epoch: 7, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.110 Vali Acc: 0.976 Test Loss: 0.110 Test Acc: 0.976
Validation loss decreased (-0.974929 --> -0.975626).  Saving model ...
Epoch: 8 cost time: 1.4009451866149902
Epoch: 8, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.101 Vali Acc: 0.979 Test Loss: 0.101 Test Acc: 0.979
Validation loss decreased (-0.975626 --> -0.979108).  Saving model ...
Epoch: 9 cost time: 1.482454538345337
Epoch: 9, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.094 Vali Acc: 0.978 Test Loss: 0.094 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4285869598388672
Epoch: 10, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.098 Vali Acc: 0.981 Test Loss: 0.098 Test Acc: 0.981
Validation loss decreased (-0.979108 --> -0.980500).  Saving model ...
Epoch: 11 cost time: 1.3407106399536133
Epoch: 11, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2962987422943115
Epoch: 12, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.122 Vali Acc: 0.978 Test Loss: 0.122 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.5168094635009766
Epoch: 13, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.105 Vali Acc: 0.979 Test Loss: 0.105 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.5705642700195312
Epoch: 14, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.125 Vali Acc: 0.976 Test Loss: 0.125 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.5546042919158936
Epoch: 15, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.109 Vali Acc: 0.972 Test Loss: 0.109 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.4648807048797607
Epoch: 16, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.105 Vali Acc: 0.982 Test Loss: 0.105 Test Acc: 0.982
Validation loss decreased (-0.980500 --> -0.981893).  Saving model ...
Epoch: 17 cost time: 1.2615902423858643
Epoch: 17, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.133 Vali Acc: 0.975 Test Loss: 0.133 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3299245834350586
Epoch: 18, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.112 Vali Acc: 0.981 Test Loss: 0.112 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.4252209663391113
Epoch: 19, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.131 Vali Acc: 0.976 Test Loss: 0.131 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.46382474899292
Epoch: 20, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.158 Vali Acc: 0.976 Test Loss: 0.158 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.4446017742156982
Epoch: 21, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.159 Vali Acc: 0.973 Test Loss: 0.159 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.4758539199829102
Epoch: 22, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.158 Vali Acc: 0.976 Test Loss: 0.158 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.568755865097046
Epoch: 23, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.153 Vali Acc: 0.980 Test Loss: 0.153 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.3829107284545898
Epoch: 24, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.150 Vali Acc: 0.981 Test Loss: 0.150 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.3212027549743652
Epoch: 25, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.146 Vali Acc: 0.981 Test Loss: 0.146 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.5306031703948975
Epoch: 26, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.146 Vali Acc: 0.981 Test Loss: 0.146 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9818941504178273
model parameter : 145492
model size : 0.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.215583086013794
Epoch: 1, Steps: 89 | Train Loss: 1.960 Vali Loss: 0.837 Vali Acc: 0.838 Test Loss: 0.837 Test Acc: 0.838
Validation loss decreased (inf --> -0.838432).  Saving model ...
Epoch: 2 cost time: 1.2676925659179688
Epoch: 2, Steps: 89 | Train Loss: 0.507 Vali Loss: 0.355 Vali Acc: 0.917 Test Loss: 0.355 Test Acc: 0.917
Validation loss decreased (-0.838432 --> -0.917127).  Saving model ...
Epoch: 3 cost time: 1.4447047710418701
Epoch: 3, Steps: 89 | Train Loss: 0.228 Vali Loss: 0.187 Vali Acc: 0.960 Test Loss: 0.187 Test Acc: 0.960
Validation loss decreased (-0.917127 --> -0.959608).  Saving model ...
Epoch: 4 cost time: 1.4863831996917725
Epoch: 4, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.133 Vali Acc: 0.969 Test Loss: 0.133 Test Acc: 0.969
Validation loss decreased (-0.959608 --> -0.968662).  Saving model ...
Epoch: 5 cost time: 1.4737975597381592
Epoch: 5, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.115 Vali Acc: 0.969 Test Loss: 0.115 Test Acc: 0.969
Validation loss decreased (-0.968662 --> -0.968662).  Saving model ...
Epoch: 6 cost time: 1.3238706588745117
Epoch: 6, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.092 Vali Acc: 0.981 Test Loss: 0.092 Test Acc: 0.981
Validation loss decreased (-0.968662 --> -0.981197).  Saving model ...
Epoch: 7 cost time: 1.3289093971252441
Epoch: 7, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.100 Vali Acc: 0.979 Test Loss: 0.100 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2206647396087646
Epoch: 8, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.079 Vali Acc: 0.981 Test Loss: 0.079 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2435297966003418
Epoch: 9, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.079 Vali Acc: 0.982 Test Loss: 0.079 Test Acc: 0.982
Validation loss decreased (-0.981197 --> -0.981893).  Saving model ...
Epoch: 10 cost time: 1.4844028949737549
Epoch: 10, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.077 Vali Acc: 0.978 Test Loss: 0.077 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.310025930404663
Epoch: 11, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.3847529888153076
Epoch: 12, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.077 Vali Acc: 0.984 Test Loss: 0.077 Test Acc: 0.984
Validation loss decreased (-0.981893 --> -0.983983).  Saving model ...
Epoch: 13 cost time: 1.4113490581512451
Epoch: 13, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.069 Vali Acc: 0.985 Test Loss: 0.069 Test Acc: 0.985
Validation loss decreased (-0.983983 --> -0.984679).  Saving model ...
Epoch: 14 cost time: 1.316593885421753
Epoch: 14, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.180985689163208
Epoch: 15, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.074 Vali Acc: 0.982 Test Loss: 0.074 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2915496826171875
Epoch: 16, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.1514863967895508
Epoch: 17, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.123 Vali Acc: 0.976 Test Loss: 0.123 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.1078228950500488
Epoch: 18, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.9766128063201904
Epoch: 19, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.079 Vali Acc: 0.984 Test Loss: 0.079 Test Acc: 0.984
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.9627370834350586
Epoch: 20, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.094 Vali Acc: 0.981 Test Loss: 0.094 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.9488604068756104
Epoch: 21, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.113 Vali Acc: 0.983 Test Loss: 0.113 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.1277990341186523
Epoch: 22, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.098 Vali Acc: 0.979 Test Loss: 0.098 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.4453606605529785
Epoch: 23, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.987 Test Loss: 0.075 Test Acc: 0.987
Validation loss decreased (-0.984679 --> -0.986768).  Saving model ...
Epoch: 24 cost time: 1.3673815727233887
Epoch: 24, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.985 Test Loss: 0.085 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.3452329635620117
Epoch: 25, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.096 Vali Acc: 0.978 Test Loss: 0.096 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.4696271419525146
Epoch: 26, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.333 Vali Acc: 0.945 Test Loss: 0.333 Test Acc: 0.945
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.410923957824707
Epoch: 27, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.110 Vali Acc: 0.981 Test Loss: 0.110 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.154289722442627
Epoch: 28, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.122 Vali Acc: 0.982 Test Loss: 0.122 Test Acc: 0.982
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.1678588390350342
Epoch: 29, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.115 Vali Acc: 0.985 Test Loss: 0.115 Test Acc: 0.985
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.3789236545562744
Epoch: 30, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.109 Vali Acc: 0.987 Test Loss: 0.109 Test Acc: 0.987
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.4481713771820068
Epoch: 31, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.100 Vali Acc: 0.986 Test Loss: 0.100 Test Acc: 0.986
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.3668873310089111
Epoch: 32, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.985 Test Loss: 0.103 Test Acc: 0.985
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.4371349811553955
Epoch: 33, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.985 Test Loss: 0.104 Test Acc: 0.985
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9867688022284122
model parameter : 99572
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps14_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.430459976196289
Epoch: 1, Steps: 89 | Train Loss: 2.090 Vali Loss: 1.063 Vali Acc: 0.828 Test Loss: 1.063 Test Acc: 0.828
Validation loss decreased (inf --> -0.827984).  Saving model ...
Epoch: 2 cost time: 1.4033668041229248
Epoch: 2, Steps: 89 | Train Loss: 0.655 Vali Loss: 0.429 Vali Acc: 0.910 Test Loss: 0.429 Test Acc: 0.910
Validation loss decreased (-0.827984 --> -0.910163).  Saving model ...
Epoch: 3 cost time: 1.2758684158325195
Epoch: 3, Steps: 89 | Train Loss: 0.293 Vali Loss: 0.231 Vali Acc: 0.948 Test Loss: 0.231 Test Acc: 0.948
Validation loss decreased (-0.910163 --> -0.947769).  Saving model ...
Epoch: 4 cost time: 1.326507806777954
Epoch: 4, Steps: 89 | Train Loss: 0.155 Vali Loss: 0.157 Vali Acc: 0.965 Test Loss: 0.157 Test Acc: 0.965
Validation loss decreased (-0.947769 --> -0.965179).  Saving model ...
Epoch: 5 cost time: 1.173142910003662
Epoch: 5, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.123 Vali Acc: 0.972 Test Loss: 0.123 Test Acc: 0.972
Validation loss decreased (-0.965179 --> -0.972144).  Saving model ...
Epoch: 6 cost time: 1.4336762428283691
Epoch: 6, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.972144 --> -0.979804).  Saving model ...
Epoch: 7 cost time: 1.4938976764678955
Epoch: 7, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.082 Vali Acc: 0.982 Test Loss: 0.082 Test Acc: 0.982
Validation loss decreased (-0.979804 --> -0.981893).  Saving model ...
Epoch: 8 cost time: 1.4347455501556396
Epoch: 8, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.093 Vali Acc: 0.978 Test Loss: 0.093 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4613580703735352
Epoch: 9, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.089 Vali Acc: 0.982 Test Loss: 0.089 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.4872627258300781
Epoch: 10, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.981893 --> -0.983286).  Saving model ...
Epoch: 11 cost time: 1.2723519802093506
Epoch: 11, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.076 Vali Acc: 0.981 Test Loss: 0.076 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3252735137939453
Epoch: 12, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.116 Vali Acc: 0.974 Test Loss: 0.116 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3495464324951172
Epoch: 13, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.081 Vali Acc: 0.984 Test Loss: 0.081 Test Acc: 0.984
Validation loss decreased (-0.983286 --> -0.983982).  Saving model ...
Epoch: 14 cost time: 1.4375410079956055
Epoch: 14, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.090 Vali Acc: 0.981 Test Loss: 0.090 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4186475276947021
Epoch: 15, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.072 Vali Acc: 0.985 Test Loss: 0.072 Test Acc: 0.985
Validation loss decreased (-0.983982 --> -0.984679).  Saving model ...
Epoch: 16 cost time: 1.43975830078125
Epoch: 16, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.068 Vali Acc: 0.987 Test Loss: 0.068 Test Acc: 0.987
Validation loss decreased (-0.984679 --> -0.986768).  Saving model ...
Epoch: 17 cost time: 1.4545636177062988
Epoch: 17, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.087 Vali Acc: 0.981 Test Loss: 0.087 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3590304851531982
Epoch: 18, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.073 Vali Acc: 0.984 Test Loss: 0.073 Test Acc: 0.984
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.2762770652770996
Epoch: 19, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.099 Vali Acc: 0.981 Test Loss: 0.099 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.31746244430542
Epoch: 20, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.108 Vali Acc: 0.980 Test Loss: 0.108 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.2664785385131836
Epoch: 21, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.070 Vali Acc: 0.985 Test Loss: 0.070 Test Acc: 0.985
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.3051972389221191
Epoch: 22, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.069 Vali Acc: 0.977 Test Loss: 0.069 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.6347179412841797
Epoch: 23, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.078 Vali Acc: 0.981 Test Loss: 0.078 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.0278801918029785
Epoch: 24, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.116 Vali Acc: 0.970 Test Loss: 0.116 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.363295078277588
Epoch: 25, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.109 Vali Acc: 0.981 Test Loss: 0.109 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.4241902828216553
Epoch: 26, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.101 Vali Acc: 0.978 Test Loss: 0.101 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps14_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9867688022284122
model parameter : 80500
model size : 0.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps19_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.9971089363098145
Epoch: 1, Steps: 89 | Train Loss: 2.307 Vali Loss: 1.349 Vali Acc: 0.781 Test Loss: 1.349 Test Acc: 0.781
Validation loss decreased (inf --> -0.781324).  Saving model ...
Epoch: 2 cost time: 1.7142009735107422
Epoch: 2, Steps: 89 | Train Loss: 0.851 Vali Loss: 0.540 Vali Acc: 0.878 Test Loss: 0.540 Test Acc: 0.878
Validation loss decreased (-0.781324 --> -0.878128).  Saving model ...
Epoch: 3 cost time: 1.1558325290679932
Epoch: 3, Steps: 89 | Train Loss: 0.384 Vali Loss: 0.288 Vali Acc: 0.930 Test Loss: 0.288 Test Acc: 0.930
Validation loss decreased (-0.878128 --> -0.930359).  Saving model ...
Epoch: 4 cost time: 1.1311731338500977
Epoch: 4, Steps: 89 | Train Loss: 0.202 Vali Loss: 0.202 Vali Acc: 0.948 Test Loss: 0.202 Test Acc: 0.948
Validation loss decreased (-0.930359 --> -0.947770).  Saving model ...
Epoch: 5 cost time: 1.326096773147583
Epoch: 5, Steps: 89 | Train Loss: 0.126 Vali Loss: 0.145 Vali Acc: 0.960 Test Loss: 0.145 Test Acc: 0.960
Validation loss decreased (-0.947770 --> -0.960305).  Saving model ...
Epoch: 6 cost time: 1.314380168914795
Epoch: 6, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.116 Vali Acc: 0.972 Test Loss: 0.116 Test Acc: 0.972
Validation loss decreased (-0.960305 --> -0.972144).  Saving model ...
Epoch: 7 cost time: 1.767972469329834
Epoch: 7, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.101 Vali Acc: 0.976 Test Loss: 0.101 Test Acc: 0.976
Validation loss decreased (-0.972144 --> -0.976322).  Saving model ...
Epoch: 8 cost time: 1.765850305557251
Epoch: 8, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
Validation loss decreased (-0.976322 --> -0.976322).  Saving model ...
Epoch: 9 cost time: 1.5258355140686035
Epoch: 9, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
Validation loss decreased (-0.976322 --> -0.979804).  Saving model ...
Epoch: 10 cost time: 1.4862332344055176
Epoch: 10, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4998724460601807
Epoch: 11, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.979804 --> -0.983286).  Saving model ...
Epoch: 12 cost time: 1.5460832118988037
Epoch: 12, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.506948471069336
Epoch: 13, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.070 Vali Acc: 0.985 Test Loss: 0.070 Test Acc: 0.985
Validation loss decreased (-0.983286 --> -0.984679).  Saving model ...
Epoch: 14 cost time: 1.6226835250854492
Epoch: 14, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.077 Vali Acc: 0.984 Test Loss: 0.077 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.746300220489502
Epoch: 15, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2960264682769775
Epoch: 16, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.070 Vali Acc: 0.985 Test Loss: 0.070 Test Acc: 0.985
Validation loss decreased (-0.984679 --> -0.985375).  Saving model ...
Epoch: 17 cost time: 1.2804594039916992
Epoch: 17, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.079 Vali Acc: 0.984 Test Loss: 0.079 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1795599460601807
Epoch: 18, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.085 Vali Acc: 0.981 Test Loss: 0.085 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.2888922691345215
Epoch: 19, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.075 Vali Acc: 0.984 Test Loss: 0.075 Test Acc: 0.984
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.7016651630401611
Epoch: 20, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.438270092010498
Epoch: 21, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.086 Vali Acc: 0.974 Test Loss: 0.086 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.6628682613372803
Epoch: 22, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.083 Vali Acc: 0.985 Test Loss: 0.083 Test Acc: 0.985
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.7281064987182617
Epoch: 23, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.1275715827941895
Epoch: 24, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.3039424419403076
Epoch: 25, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.075 Vali Acc: 0.984 Test Loss: 0.075 Test Acc: 0.984
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.6791720390319824
Epoch: 26, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.071 Vali Acc: 0.985 Test Loss: 0.071 Test Acc: 0.985
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps19_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9853760445682451
model parameter : 65300
model size : 0.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps28_str14_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.214423656463623
Epoch: 1, Steps: 89 | Train Loss: 2.514 Vali Loss: 1.738 Vali Acc: 0.673 Test Loss: 1.738 Test Acc: 0.673
Validation loss decreased (inf --> -0.672685).  Saving model ...
Epoch: 2 cost time: 1.2013850212097168
Epoch: 2, Steps: 89 | Train Loss: 1.136 Vali Loss: 0.742 Vali Acc: 0.856 Test Loss: 0.742 Test Acc: 0.856
Validation loss decreased (-0.672685 --> -0.855842).  Saving model ...
Epoch: 3 cost time: 1.1963753700256348
Epoch: 3, Steps: 89 | Train Loss: 0.517 Vali Loss: 0.393 Vali Acc: 0.919 Test Loss: 0.393 Test Acc: 0.919
Validation loss decreased (-0.855842 --> -0.918520).  Saving model ...
Epoch: 4 cost time: 1.4486935138702393
Epoch: 4, Steps: 89 | Train Loss: 0.278 Vali Loss: 0.230 Vali Acc: 0.946 Test Loss: 0.230 Test Acc: 0.946
Validation loss decreased (-0.918520 --> -0.946377).  Saving model ...
Epoch: 5 cost time: 1.5283029079437256
Epoch: 5, Steps: 89 | Train Loss: 0.172 Vali Loss: 0.155 Vali Acc: 0.962 Test Loss: 0.155 Test Acc: 0.962
Validation loss decreased (-0.946377 --> -0.962394).  Saving model ...
Epoch: 6 cost time: 1.7218561172485352
Epoch: 6, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.115 Vali Acc: 0.971 Test Loss: 0.115 Test Acc: 0.971
Validation loss decreased (-0.962394 --> -0.970751).  Saving model ...
Epoch: 7 cost time: 1.7023534774780273
Epoch: 7, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.098 Vali Acc: 0.976 Test Loss: 0.098 Test Acc: 0.976
Validation loss decreased (-0.970751 --> -0.976322).  Saving model ...
Epoch: 8 cost time: 1.4429924488067627
Epoch: 8, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.088 Vali Acc: 0.978 Test Loss: 0.088 Test Acc: 0.978
Validation loss decreased (-0.976322 --> -0.977715).  Saving model ...
Epoch: 9 cost time: 1.2813656330108643
Epoch: 9, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5581724643707275
Epoch: 10, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.073 Vali Acc: 0.981 Test Loss: 0.073 Test Acc: 0.981
Validation loss decreased (-0.977715 --> -0.981197).  Saving model ...
Epoch: 11 cost time: 1.3318986892700195
Epoch: 11, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.071 Vali Acc: 0.981 Test Loss: 0.071 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3691930770874023
Epoch: 12, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.078 Vali Acc: 0.976 Test Loss: 0.078 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3054850101470947
Epoch: 13, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.064 Vali Acc: 0.982 Test Loss: 0.064 Test Acc: 0.982
Validation loss decreased (-0.981197 --> -0.981894).  Saving model ...
Epoch: 14 cost time: 1.2812583446502686
Epoch: 14, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.071 Vali Acc: 0.979 Test Loss: 0.071 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6522948741912842
Epoch: 15, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.088 Vali Acc: 0.975 Test Loss: 0.088 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.1354854106903076
Epoch: 16, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.074 Vali Acc: 0.981 Test Loss: 0.074 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.7610342502593994
Epoch: 17, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.057 Vali Acc: 0.985 Test Loss: 0.057 Test Acc: 0.985
Validation loss decreased (-0.981894 --> -0.984679).  Saving model ...
Epoch: 18 cost time: 1.4443929195404053
Epoch: 18, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.6919331550598145
Epoch: 19, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.069 Vali Acc: 0.979 Test Loss: 0.069 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.6237788200378418
Epoch: 20, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.45792555809021
Epoch: 21, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.6584949493408203
Epoch: 22, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.074 Vali Acc: 0.982 Test Loss: 0.074 Test Acc: 0.982
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.1107172966003418
Epoch: 23, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.059 Vali Acc: 0.985 Test Loss: 0.059 Test Acc: 0.985
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.673269510269165
Epoch: 24, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.086 Vali Acc: 0.975 Test Loss: 0.086 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.5289733409881592
Epoch: 25, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.075 Vali Acc: 0.978 Test Loss: 0.075 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.5998764038085938
Epoch: 26, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.072 Vali Acc: 0.981 Test Loss: 0.072 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.6773617267608643
Epoch: 27, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.067 Vali Acc: 0.987 Test Loss: 0.067 Test Acc: 0.987
Validation loss decreased (-0.984679 --> -0.986768).  Saving model ...
Epoch: 28 cost time: 1.4641609191894531
Epoch: 28, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.440122127532959
Epoch: 29, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.2974345684051514
Epoch: 30, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.092 Vali Acc: 0.983 Test Loss: 0.092 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.5732533931732178
Epoch: 31, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.6787757873535156
Epoch: 32, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.086 Vali Acc: 0.984 Test Loss: 0.086 Test Acc: 0.984
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.51914381980896
Epoch: 33, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.118 Vali Acc: 0.976 Test Loss: 0.118 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.5878257751464844
Epoch: 34, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.112 Vali Acc: 0.975 Test Loss: 0.112 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.643179178237915
Epoch: 35, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.068 Vali Acc: 0.984 Test Loss: 0.068 Test Acc: 0.984
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.324659824371338
Epoch: 36, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.086 Vali Acc: 0.984 Test Loss: 0.086 Test Acc: 0.984
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.4287428855895996
Epoch: 37, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.072 Vali Acc: 0.982 Test Loss: 0.072 Test Acc: 0.982
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps28_str14_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9867688022284122
model parameter : 55988
model size : 0.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps37_str19_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.657313823699951
Epoch: 1, Steps: 89 | Train Loss: 2.645 Vali Loss: 1.947 Vali Acc: 0.648 Test Loss: 1.947 Test Acc: 0.648
Validation loss decreased (inf --> -0.647613).  Saving model ...
Epoch: 2 cost time: 1.5716028213500977
Epoch: 2, Steps: 89 | Train Loss: 1.356 Vali Loss: 0.909 Vali Acc: 0.820 Test Loss: 0.909 Test Acc: 0.820
Validation loss decreased (-0.647613 --> -0.820325).  Saving model ...
Epoch: 3 cost time: 1.3898065090179443
Epoch: 3, Steps: 89 | Train Loss: 0.658 Vali Loss: 0.499 Vali Acc: 0.891 Test Loss: 0.499 Test Acc: 0.891
Validation loss decreased (-0.820325 --> -0.891360).  Saving model ...
Epoch: 4 cost time: 1.1657977104187012
Epoch: 4, Steps: 89 | Train Loss: 0.379 Vali Loss: 0.304 Vali Acc: 0.927 Test Loss: 0.304 Test Acc: 0.927
Validation loss decreased (-0.891360 --> -0.926877).  Saving model ...
Epoch: 5 cost time: 1.0543317794799805
Epoch: 5, Steps: 89 | Train Loss: 0.229 Vali Loss: 0.209 Vali Acc: 0.958 Test Loss: 0.209 Test Acc: 0.958
Validation loss decreased (-0.926877 --> -0.958215).  Saving model ...
Epoch: 6 cost time: 1.1229033470153809
Epoch: 6, Steps: 89 | Train Loss: 0.152 Vali Loss: 0.152 Vali Acc: 0.966 Test Loss: 0.152 Test Acc: 0.966
Validation loss decreased (-0.958215 --> -0.965876).  Saving model ...
Epoch: 7 cost time: 1.0553205013275146
Epoch: 7, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.125 Vali Acc: 0.975 Test Loss: 0.125 Test Acc: 0.975
Validation loss decreased (-0.965876 --> -0.974929).  Saving model ...
Epoch: 8 cost time: 1.1160669326782227
Epoch: 8, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
Validation loss decreased (-0.974929 --> -0.977018).  Saving model ...
Epoch: 9 cost time: 1.2720396518707275
Epoch: 9, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.089 Vali Acc: 0.978 Test Loss: 0.089 Test Acc: 0.978
Validation loss decreased (-0.977018 --> -0.977715).  Saving model ...
Epoch: 10 cost time: 1.5599374771118164
Epoch: 10, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5161192417144775
Epoch: 11, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.083 Vali Acc: 0.978 Test Loss: 0.083 Test Acc: 0.978
Validation loss decreased (-0.977715 --> -0.977715).  Saving model ...
Epoch: 12 cost time: 1.64784574508667
Epoch: 12, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.977715 --> -0.982590).  Saving model ...
Epoch: 13 cost time: 1.6176326274871826
Epoch: 13, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.070 Vali Acc: 0.981 Test Loss: 0.070 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2053077220916748
Epoch: 14, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.069 Vali Acc: 0.985 Test Loss: 0.069 Test Acc: 0.985
Validation loss decreased (-0.982590 --> -0.985375).  Saving model ...
Epoch: 15 cost time: 1.6062908172607422
Epoch: 15, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.069 Vali Acc: 0.982 Test Loss: 0.069 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.6018474102020264
Epoch: 16, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.069 Vali Acc: 0.982 Test Loss: 0.069 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.5587687492370605
Epoch: 17, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.5268816947937012
Epoch: 18, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.077 Vali Acc: 0.978 Test Loss: 0.077 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.263972282409668
Epoch: 19, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.5739245414733887
Epoch: 20, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.083 Vali Acc: 0.985 Test Loss: 0.083 Test Acc: 0.985
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.4795193672180176
Epoch: 21, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.6682863235473633
Epoch: 22, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.064 Vali Acc: 0.985 Test Loss: 0.064 Test Acc: 0.985
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.5401005744934082
Epoch: 23, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.071 Vali Acc: 0.984 Test Loss: 0.071 Test Acc: 0.984
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.3628759384155273
Epoch: 24, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.062 Vali Acc: 0.985 Test Loss: 0.062 Test Acc: 0.985
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps37_str19_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9853760445682451
model parameter : 48596
model size : 0.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps46_str23_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.5544209480285645
Epoch: 1, Steps: 89 | Train Loss: 2.656 Vali Loss: 2.059 Vali Acc: 0.536 Test Loss: 2.059 Test Acc: 0.536
Validation loss decreased (inf --> -0.536191).  Saving model ...
Epoch: 2 cost time: 1.3175909519195557
Epoch: 2, Steps: 89 | Train Loss: 1.516 Vali Loss: 1.063 Vali Acc: 0.806 Test Loss: 1.063 Test Acc: 0.806
Validation loss decreased (-0.536191 --> -0.805700).  Saving model ...
Epoch: 3 cost time: 1.3254058361053467
Epoch: 3, Steps: 89 | Train Loss: 0.765 Vali Loss: 0.563 Vali Acc: 0.870 Test Loss: 0.563 Test Acc: 0.870
Validation loss decreased (-0.805700 --> -0.870468).  Saving model ...
Epoch: 4 cost time: 1.4951286315917969
Epoch: 4, Steps: 89 | Train Loss: 0.416 Vali Loss: 0.320 Vali Acc: 0.923 Test Loss: 0.320 Test Acc: 0.923
Validation loss decreased (-0.870468 --> -0.922699).  Saving model ...
Epoch: 5 cost time: 1.4958109855651855
Epoch: 5, Steps: 89 | Train Loss: 0.249 Vali Loss: 0.199 Vali Acc: 0.953 Test Loss: 0.199 Test Acc: 0.953
Validation loss decreased (-0.922699 --> -0.952644).  Saving model ...
Epoch: 6 cost time: 1.5088613033294678
Epoch: 6, Steps: 89 | Train Loss: 0.166 Vali Loss: 0.147 Vali Acc: 0.964 Test Loss: 0.147 Test Acc: 0.964
Validation loss decreased (-0.952644 --> -0.963787).  Saving model ...
Epoch: 7 cost time: 1.5091888904571533
Epoch: 7, Steps: 89 | Train Loss: 0.129 Vali Loss: 0.118 Vali Acc: 0.971 Test Loss: 0.118 Test Acc: 0.971
Validation loss decreased (-0.963787 --> -0.971447).  Saving model ...
Epoch: 8 cost time: 1.3295087814331055
Epoch: 8, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
Validation loss decreased (-0.971447 --> -0.972840).  Saving model ...
Epoch: 9 cost time: 1.581054449081421
Epoch: 9, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.099 Vali Acc: 0.971 Test Loss: 0.099 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.529362678527832
Epoch: 10, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.089 Vali Acc: 0.978 Test Loss: 0.089 Test Acc: 0.978
Validation loss decreased (-0.972840 --> -0.977715).  Saving model ...
Epoch: 11 cost time: 1.217679500579834
Epoch: 11, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.095 Vali Acc: 0.975 Test Loss: 0.095 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.517348289489746
Epoch: 12, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.077 Vali Acc: 0.981 Test Loss: 0.077 Test Acc: 0.981
Validation loss decreased (-0.977715 --> -0.980501).  Saving model ...
Epoch: 13 cost time: 1.3290629386901855
Epoch: 13, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1069145202636719
Epoch: 14, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.068 Vali Acc: 0.984 Test Loss: 0.068 Test Acc: 0.984
Validation loss decreased (-0.980501 --> -0.983983).  Saving model ...
Epoch: 15 cost time: 1.720254898071289
Epoch: 15, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.069 Vali Acc: 0.985 Test Loss: 0.069 Test Acc: 0.985
Validation loss decreased (-0.983983 --> -0.984679).  Saving model ...
Epoch: 16 cost time: 1.73563814163208
Epoch: 16, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.069 Vali Acc: 0.981 Test Loss: 0.069 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.6123721599578857
Epoch: 17, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.455080509185791
Epoch: 18, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.074 Vali Acc: 0.981 Test Loss: 0.074 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.4305527210235596
Epoch: 19, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.6853618621826172
Epoch: 20, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.056 Vali Acc: 0.987 Test Loss: 0.056 Test Acc: 0.987
Validation loss decreased (-0.984679 --> -0.986768).  Saving model ...
Epoch: 21 cost time: 1.7176101207733154
Epoch: 21, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.066 Vali Acc: 0.984 Test Loss: 0.066 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.5880789756774902
Epoch: 22, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.760190725326538
Epoch: 23, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.054 Vali Acc: 0.986 Test Loss: 0.054 Test Acc: 0.986
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.301661729812622
Epoch: 24, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.3131260871887207
Epoch: 25, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.061 Vali Acc: 0.984 Test Loss: 0.061 Test Acc: 0.984
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.6010692119598389
Epoch: 26, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.090 Vali Acc: 0.978 Test Loss: 0.090 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.6674003601074219
Epoch: 27, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.068 Vali Acc: 0.979 Test Loss: 0.068 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.6635611057281494
Epoch: 28, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.072 Vali Acc: 0.981 Test Loss: 0.072 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.7345936298370361
Epoch: 29, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.055 Vali Acc: 0.987 Test Loss: 0.055 Test Acc: 0.987
Validation loss decreased (-0.986768 --> -0.986768).  Saving model ...
Epoch: 30 cost time: 1.2746739387512207
Epoch: 30, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.060 Vali Acc: 0.987 Test Loss: 0.060 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.5193002223968506
Epoch: 31, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.061 Vali Acc: 0.985 Test Loss: 0.061 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.556922435760498
Epoch: 32, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.687880039215088
Epoch: 33, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.069 Vali Acc: 0.984 Test Loss: 0.069 Test Acc: 0.984
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.338987112045288
Epoch: 34, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.062 Vali Acc: 0.983 Test Loss: 0.062 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.3900973796844482
Epoch: 35, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.1140587329864502
Epoch: 36, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.068 Vali Acc: 0.981 Test Loss: 0.068 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.619035243988037
Epoch: 37, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.070 Vali Acc: 0.979 Test Loss: 0.070 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.5582513809204102
Epoch: 38, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.054 Vali Acc: 0.987 Test Loss: 0.054 Test Acc: 0.987
Validation loss decreased (-0.986768 --> -0.986768).  Saving model ...
Epoch: 39 cost time: 1.4251761436462402
Epoch: 39, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.055 Vali Acc: 0.985 Test Loss: 0.055 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.474386215209961
Epoch: 40, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.059 Vali Acc: 0.986 Test Loss: 0.059 Test Acc: 0.986
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.3336796760559082
Epoch: 41, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.062 Vali Acc: 0.985 Test Loss: 0.062 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.1154956817626953
Epoch: 42, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.5976345539093018
Epoch: 43, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.086 Vali Acc: 0.978 Test Loss: 0.086 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.380051612854004
Epoch: 44, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.065 Vali Acc: 0.985 Test Loss: 0.065 Test Acc: 0.985
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.3880324363708496
Epoch: 45, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.063 Vali Acc: 0.985 Test Loss: 0.063 Test Acc: 0.985
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.4147322177886963
Epoch: 46, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.089 Vali Acc: 0.982 Test Loss: 0.089 Test Acc: 0.982
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 1.1924231052398682
Epoch: 47, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.097 Vali Acc: 0.980 Test Loss: 0.097 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 1.3633308410644531
Epoch: 48, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32_nb1_lk13_sk5_ffr4_ps46_str23_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9867688022284122
model parameter : 45044
model size : 0.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.5018160343170166
Epoch: 1, Steps: 89 | Train Loss: 1.883 Vali Loss: 0.607 Vali Acc: 0.847 Test Loss: 0.607 Test Acc: 0.847
Validation loss decreased (inf --> -0.847487).  Saving model ...
Epoch: 2 cost time: 2.4681379795074463
Epoch: 2, Steps: 89 | Train Loss: 0.344 Vali Loss: 0.188 Vali Acc: 0.953 Test Loss: 0.188 Test Acc: 0.953
Validation loss decreased (-0.847487 --> -0.953341).  Saving model ...
Epoch: 3 cost time: 2.785844087600708
Epoch: 3, Steps: 89 | Train Loss: 0.153 Vali Loss: 0.174 Vali Acc: 0.946 Test Loss: 0.174 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.1474382877349854
Epoch: 4, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
Validation loss decreased (-0.953341 --> -0.972840).  Saving model ...
Epoch: 5 cost time: 2.24420166015625
Epoch: 5, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.102 Vali Acc: 0.972 Test Loss: 0.102 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.631054639816284
Epoch: 6, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.116 Vali Acc: 0.971 Test Loss: 0.116 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.6581625938415527
Epoch: 7, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.091 Vali Acc: 0.978 Test Loss: 0.091 Test Acc: 0.978
Validation loss decreased (-0.972840 --> -0.978411).  Saving model ...
Epoch: 8 cost time: 2.678220748901367
Epoch: 8, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.978411 --> -0.979804).  Saving model ...
Epoch: 9 cost time: 2.4782469272613525
Epoch: 9, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.108 Vali Acc: 0.976 Test Loss: 0.108 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.8662564754486084
Epoch: 10, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.132 Vali Acc: 0.974 Test Loss: 0.132 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.6771302223205566
Epoch: 11, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.102 Vali Acc: 0.983 Test Loss: 0.102 Test Acc: 0.983
Validation loss decreased (-0.979804 --> -0.982590).  Saving model ...
Epoch: 12 cost time: 2.3246026039123535
Epoch: 12, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.250 Vali Acc: 0.944 Test Loss: 0.250 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.6586713790893555
Epoch: 13, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.124 Vali Acc: 0.977 Test Loss: 0.124 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.7492830753326416
Epoch: 14, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.142 Vali Acc: 0.977 Test Loss: 0.142 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.7391538619995117
Epoch: 15, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.148 Vali Acc: 0.976 Test Loss: 0.148 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.4928855895996094
Epoch: 16, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.148 Vali Acc: 0.976 Test Loss: 0.148 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.7134106159210205
Epoch: 17, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.212 Vali Acc: 0.971 Test Loss: 0.212 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.950901985168457
Epoch: 18, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.240 Vali Acc: 0.964 Test Loss: 0.240 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.5389082431793213
Epoch: 19, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.182 Vali Acc: 0.975 Test Loss: 0.182 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.7801756858825684
Epoch: 20, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.150 Vali Acc: 0.981 Test Loss: 0.150 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.8188934326171875
Epoch: 21, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.162 Vali Acc: 0.971 Test Loss: 0.162 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9825905292479109
model parameter : 421716
model size : 1.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.6101112365722656
Epoch: 1, Steps: 89 | Train Loss: 2.207 Vali Loss: 0.916 Vali Acc: 0.802 Test Loss: 0.916 Test Acc: 0.802
Validation loss decreased (inf --> -0.801523).  Saving model ...
Epoch: 2 cost time: 2.5385005474090576
Epoch: 2, Steps: 89 | Train Loss: 0.511 Vali Loss: 0.287 Vali Acc: 0.933 Test Loss: 0.287 Test Acc: 0.933
Validation loss decreased (-0.801523 --> -0.933145).  Saving model ...
Epoch: 3 cost time: 2.1464877128601074
Epoch: 3, Steps: 89 | Train Loss: 0.195 Vali Loss: 0.165 Vali Acc: 0.962 Test Loss: 0.165 Test Acc: 0.962
Validation loss decreased (-0.933145 --> -0.961698).  Saving model ...
Epoch: 4 cost time: 2.638578176498413
Epoch: 4, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.133 Vali Acc: 0.962 Test Loss: 0.133 Test Acc: 0.962
Validation loss decreased (-0.961698 --> -0.961698).  Saving model ...
Epoch: 5 cost time: 2.6625869274139404
Epoch: 5, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.100 Vali Acc: 0.976 Test Loss: 0.100 Test Acc: 0.976
Validation loss decreased (-0.961698 --> -0.976322).  Saving model ...
Epoch: 6 cost time: 2.1824443340301514
Epoch: 6, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.096 Vali Acc: 0.974 Test Loss: 0.096 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.5297255516052246
Epoch: 7, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.080 Vali Acc: 0.981 Test Loss: 0.080 Test Acc: 0.981
Validation loss decreased (-0.976322 --> -0.980501).  Saving model ...
Epoch: 8 cost time: 2.712524175643921
Epoch: 8, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.980501 --> -0.983286).  Saving model ...
Epoch: 9 cost time: 2.8474981784820557
Epoch: 9, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.5727977752685547
Epoch: 10, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.091 Vali Acc: 0.978 Test Loss: 0.091 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.961517572402954
Epoch: 11, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.078 Vali Acc: 0.981 Test Loss: 0.078 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.7531328201293945
Epoch: 12, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.133 Vali Acc: 0.966 Test Loss: 0.133 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.3547441959381104
Epoch: 13, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.116 Vali Acc: 0.976 Test Loss: 0.116 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.6444597244262695
Epoch: 14, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.671344041824341
Epoch: 15, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.116 Vali Acc: 0.978 Test Loss: 0.116 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.5968523025512695
Epoch: 16, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.103 Vali Acc: 0.981 Test Loss: 0.103 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.0599844455718994
Epoch: 17, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.125 Vali Acc: 0.980 Test Loss: 0.125 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.5438284873962402
Epoch: 18, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.142 Vali Acc: 0.980 Test Loss: 0.142 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9832869080779945
model parameter : 375796
model size : 1.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps14_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.4384422302246094
Epoch: 1, Steps: 89 | Train Loss: 2.228 Vali Loss: 0.998 Vali Acc: 0.810 Test Loss: 0.998 Test Acc: 0.810
Validation loss decreased (inf --> -0.809879).  Saving model ...
Epoch: 2 cost time: 2.83831787109375
Epoch: 2, Steps: 89 | Train Loss: 0.552 Vali Loss: 0.307 Vali Acc: 0.928 Test Loss: 0.307 Test Acc: 0.928
Validation loss decreased (-0.809879 --> -0.927574).  Saving model ...
Epoch: 3 cost time: 2.4976534843444824
Epoch: 3, Steps: 89 | Train Loss: 0.208 Vali Loss: 0.164 Vali Acc: 0.959 Test Loss: 0.164 Test Acc: 0.959
Validation loss decreased (-0.927574 --> -0.958912).  Saving model ...
Epoch: 4 cost time: 2.579122543334961
Epoch: 4, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.139 Vali Acc: 0.958 Test Loss: 0.139 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.9210305213928223
Epoch: 5, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.089 Vali Acc: 0.975 Test Loss: 0.089 Test Acc: 0.975
Validation loss decreased (-0.958912 --> -0.974929).  Saving model ...
Epoch: 6 cost time: 2.815744161605835
Epoch: 6, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.974929 --> -0.979804).  Saving model ...
Epoch: 7 cost time: 2.528806447982788
Epoch: 7, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.064 Vali Acc: 0.984 Test Loss: 0.064 Test Acc: 0.984
Validation loss decreased (-0.979804 --> -0.983983).  Saving model ...
Epoch: 8 cost time: 2.756594657897949
Epoch: 8, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.7383928298950195
Epoch: 9, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.3958897590637207
Epoch: 10, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.257 Vali Acc: 0.945 Test Loss: 0.257 Test Acc: 0.945
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.9379546642303467
Epoch: 11, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.069 Vali Acc: 0.981 Test Loss: 0.069 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.9246206283569336
Epoch: 12, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.107 Vali Acc: 0.974 Test Loss: 0.107 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.5234031677246094
Epoch: 13, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.332641363143921
Epoch: 14, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.075 Vali Acc: 0.984 Test Loss: 0.075 Test Acc: 0.984
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.0396065711975098
Epoch: 15, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.088 Vali Acc: 0.981 Test Loss: 0.088 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.548367977142334
Epoch: 16, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.081 Vali Acc: 0.981 Test Loss: 0.081 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.6819796562194824
Epoch: 17, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps14_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.983983286908078
model parameter : 360564
model size : 1.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps19_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.5206470489501953
Epoch: 1, Steps: 89 | Train Loss: 2.435 Vali Loss: 1.467 Vali Acc: 0.690 Test Loss: 1.467 Test Acc: 0.690
Validation loss decreased (inf --> -0.690097).  Saving model ...
Epoch: 2 cost time: 2.4961647987365723
Epoch: 2, Steps: 89 | Train Loss: 0.798 Vali Loss: 0.439 Vali Acc: 0.898 Test Loss: 0.439 Test Acc: 0.898
Validation loss decreased (-0.690097 --> -0.897628).  Saving model ...
Epoch: 3 cost time: 2.621859550476074
Epoch: 3, Steps: 89 | Train Loss: 0.289 Vali Loss: 0.205 Vali Acc: 0.955 Test Loss: 0.205 Test Acc: 0.955
Validation loss decreased (-0.897628 --> -0.954733).  Saving model ...
Epoch: 4 cost time: 2.6155037879943848
Epoch: 4, Steps: 89 | Train Loss: 0.141 Vali Loss: 0.131 Vali Acc: 0.969 Test Loss: 0.131 Test Acc: 0.969
Validation loss decreased (-0.954733 --> -0.968662).  Saving model ...
Epoch: 5 cost time: 2.2949469089508057
Epoch: 5, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.112 Vali Acc: 0.971 Test Loss: 0.112 Test Acc: 0.971
Validation loss decreased (-0.968662 --> -0.970751).  Saving model ...
Epoch: 6 cost time: 2.5993285179138184
Epoch: 6, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.970751 --> -0.979804).  Saving model ...
Epoch: 7 cost time: 2.6496384143829346
Epoch: 7, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.3883872032165527
Epoch: 8, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.059 Vali Acc: 0.987 Test Loss: 0.059 Test Acc: 0.987
Validation loss decreased (-0.979804 --> -0.986768).  Saving model ...
Epoch: 9 cost time: 2.601365804672241
Epoch: 9, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.838397741317749
Epoch: 10, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.077 Vali Acc: 0.977 Test Loss: 0.077 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.4110524654388428
Epoch: 11, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.067 Vali Acc: 0.985 Test Loss: 0.067 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.7949726581573486
Epoch: 12, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.060 Vali Acc: 0.988 Test Loss: 0.060 Test Acc: 0.988
Validation loss decreased (-0.986768 --> -0.988161).  Saving model ...
Epoch: 13 cost time: 2.5418779850006104
Epoch: 13, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.059 Vali Acc: 0.987 Test Loss: 0.059 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.5956838130950928
Epoch: 14, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.055 Vali Acc: 0.987 Test Loss: 0.055 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.63712477684021
Epoch: 15, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.057 Vali Acc: 0.985 Test Loss: 0.057 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.3850491046905518
Epoch: 16, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.074 Vali Acc: 0.982 Test Loss: 0.074 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.3857510089874268
Epoch: 17, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.060 Vali Acc: 0.985 Test Loss: 0.060 Test Acc: 0.985
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.583169937133789
Epoch: 18, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.072 Vali Acc: 0.985 Test Loss: 0.072 Test Acc: 0.985
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.4322357177734375
Epoch: 19, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.7195253372192383
Epoch: 20, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.069 Vali Acc: 0.985 Test Loss: 0.069 Test Acc: 0.985
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.6423752307891846
Epoch: 21, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.4237797260284424
Epoch: 22, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.116 Vali Acc: 0.975 Test Loss: 0.116 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps19_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9881615598885793
model parameter : 345364
model size : 1.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps28_str14_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.691610813140869
Epoch: 1, Steps: 89 | Train Loss: 2.505 Vali Loss: 1.640 Vali Acc: 0.712 Test Loss: 1.640 Test Acc: 0.712
Validation loss decreased (inf --> -0.711683).  Saving model ...
Epoch: 2 cost time: 2.5974812507629395
Epoch: 2, Steps: 89 | Train Loss: 0.927 Vali Loss: 0.481 Vali Acc: 0.892 Test Loss: 0.481 Test Acc: 0.892
Validation loss decreased (-0.711683 --> -0.892056).  Saving model ...
Epoch: 3 cost time: 2.511812686920166
Epoch: 3, Steps: 89 | Train Loss: 0.325 Vali Loss: 0.240 Vali Acc: 0.944 Test Loss: 0.240 Test Acc: 0.944
Validation loss decreased (-0.892056 --> -0.943591).  Saving model ...
Epoch: 4 cost time: 2.6180503368377686
Epoch: 4, Steps: 89 | Train Loss: 0.168 Vali Loss: 0.155 Vali Acc: 0.963 Test Loss: 0.155 Test Acc: 0.963
Validation loss decreased (-0.943591 --> -0.963090).  Saving model ...
Epoch: 5 cost time: 2.5372891426086426
Epoch: 5, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.103 Vali Acc: 0.976 Test Loss: 0.103 Test Acc: 0.976
Validation loss decreased (-0.963090 --> -0.975626).  Saving model ...
Epoch: 6 cost time: 2.4161226749420166
Epoch: 6, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.082 Vali Acc: 0.979 Test Loss: 0.082 Test Acc: 0.979
Validation loss decreased (-0.975626 --> -0.979108).  Saving model ...
Epoch: 7 cost time: 2.5752787590026855
Epoch: 7, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.093 Vali Acc: 0.971 Test Loss: 0.093 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.648874044418335
Epoch: 8, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.082 Vali Acc: 0.975 Test Loss: 0.082 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.3827497959136963
Epoch: 9, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.5795702934265137
Epoch: 10, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.093 Vali Acc: 0.969 Test Loss: 0.093 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.7175140380859375
Epoch: 11, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.057 Vali Acc: 0.985 Test Loss: 0.057 Test Acc: 0.985
Validation loss decreased (-0.979108 --> -0.985375).  Saving model ...
Epoch: 12 cost time: 2.448575496673584
Epoch: 12, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.073 Vali Acc: 0.985 Test Loss: 0.073 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.467578887939453
Epoch: 13, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.4961204528808594
Epoch: 14, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.054 Vali Acc: 0.985 Test Loss: 0.054 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.469789981842041
Epoch: 15, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.049 Vali Acc: 0.989 Test Loss: 0.049 Test Acc: 0.989
Validation loss decreased (-0.985375 --> -0.988857).  Saving model ...
Epoch: 16 cost time: 2.5620524883270264
Epoch: 16, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.073 Vali Acc: 0.981 Test Loss: 0.073 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.2583706378936768
Epoch: 17, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.073 Vali Acc: 0.986 Test Loss: 0.073 Test Acc: 0.986
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.600255012512207
Epoch: 18, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.5998713970184326
Epoch: 19, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.3627922534942627
Epoch: 20, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.143 Vali Acc: 0.969 Test Loss: 0.143 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.528540849685669
Epoch: 21, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.556990146636963
Epoch: 22, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.083 Vali Acc: 0.985 Test Loss: 0.083 Test Acc: 0.985
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.4368627071380615
Epoch: 23, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.065 Vali Acc: 0.986 Test Loss: 0.065 Test Acc: 0.986
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.382563591003418
Epoch: 24, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.698793411254883
Epoch: 25, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.080 Vali Acc: 0.985 Test Loss: 0.080 Test Acc: 0.985
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps28_str14_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9888579387186629
model parameter : 337972
model size : 1.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps37_str19_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.327448606491089
Epoch: 1, Steps: 89 | Train Loss: 2.613 Vali Loss: 1.866 Vali Acc: 0.647 Test Loss: 1.866 Test Acc: 0.647
Validation loss decreased (inf --> -0.646917).  Saving model ...
Epoch: 2 cost time: 2.453885793685913
Epoch: 2, Steps: 89 | Train Loss: 1.134 Vali Loss: 0.598 Vali Acc: 0.870 Test Loss: 0.598 Test Acc: 0.870
Validation loss decreased (-0.646917 --> -0.869771).  Saving model ...
Epoch: 3 cost time: 2.617838144302368
Epoch: 3, Steps: 89 | Train Loss: 0.416 Vali Loss: 0.283 Vali Acc: 0.932 Test Loss: 0.283 Test Acc: 0.932
Validation loss decreased (-0.869771 --> -0.931752).  Saving model ...
Epoch: 4 cost time: 2.225158929824829
Epoch: 4, Steps: 89 | Train Loss: 0.201 Vali Loss: 0.174 Vali Acc: 0.957 Test Loss: 0.174 Test Acc: 0.957
Validation loss decreased (-0.931752 --> -0.956823).  Saving model ...
Epoch: 5 cost time: 2.7882144451141357
Epoch: 5, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.125 Vali Acc: 0.970 Test Loss: 0.125 Test Acc: 0.970
Validation loss decreased (-0.956823 --> -0.970054).  Saving model ...
Epoch: 6 cost time: 2.7265636920928955
Epoch: 6, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.099 Vali Acc: 0.976 Test Loss: 0.099 Test Acc: 0.976
Validation loss decreased (-0.970054 --> -0.975626).  Saving model ...
Epoch: 7 cost time: 2.453866720199585
Epoch: 7, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.090 Vali Acc: 0.978 Test Loss: 0.090 Test Acc: 0.978
Validation loss decreased (-0.975626 --> -0.978411).  Saving model ...
Epoch: 8 cost time: 2.472731590270996
Epoch: 8, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.978411 --> -0.982590).  Saving model ...
Epoch: 9 cost time: 2.356980562210083
Epoch: 9, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.077 Vali Acc: 0.985 Test Loss: 0.077 Test Acc: 0.985
Validation loss decreased (-0.982590 --> -0.984679).  Saving model ...
Epoch: 10 cost time: 2.464728593826294
Epoch: 10, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.5731914043426514
Epoch: 11, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.066 Vali Acc: 0.984 Test Loss: 0.066 Test Acc: 0.984
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.389047384262085
Epoch: 12, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.081 Vali Acc: 0.978 Test Loss: 0.081 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.4917237758636475
Epoch: 13, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.6250498294830322
Epoch: 14, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.069 Vali Acc: 0.985 Test Loss: 0.069 Test Acc: 0.985
Validation loss decreased (-0.984679 --> -0.984679).  Saving model ...
Epoch: 15 cost time: 2.448153495788574
Epoch: 15, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.082 Vali Acc: 0.976 Test Loss: 0.082 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.529127836227417
Epoch: 16, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.857675313949585
Epoch: 17, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.089 Vali Acc: 0.978 Test Loss: 0.089 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.494626998901367
Epoch: 18, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.079 Vali Acc: 0.982 Test Loss: 0.079 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.514671802520752
Epoch: 19, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.090 Vali Acc: 0.981 Test Loss: 0.090 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.5276803970336914
Epoch: 20, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.4426255226135254
Epoch: 21, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.090 Vali Acc: 0.979 Test Loss: 0.090 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.187041997909546
Epoch: 22, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.095 Vali Acc: 0.983 Test Loss: 0.095 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.1775734424591064
Epoch: 23, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.086 Vali Acc: 0.984 Test Loss: 0.086 Test Acc: 0.984
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.6095526218414307
Epoch: 24, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.074 Vali Acc: 0.982 Test Loss: 0.074 Test Acc: 0.982
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps37_str19_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9846796657381616
model parameter : 330580
model size : 1.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps46_str23_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.6146867275238037
Epoch: 1, Steps: 89 | Train Loss: 2.659 Vali Loss: 1.979 Vali Acc: 0.638 Test Loss: 1.979 Test Acc: 0.638
Validation loss decreased (inf --> -0.637863).  Saving model ...
Epoch: 2 cost time: 2.310795307159424
Epoch: 2, Steps: 89 | Train Loss: 1.256 Vali Loss: 0.698 Vali Acc: 0.860 Test Loss: 0.698 Test Acc: 0.860
Validation loss decreased (-0.637863 --> -0.860021).  Saving model ...
Epoch: 3 cost time: 2.4357306957244873
Epoch: 3, Steps: 89 | Train Loss: 0.485 Vali Loss: 0.344 Vali Acc: 0.907 Test Loss: 0.344 Test Acc: 0.907
Validation loss decreased (-0.860021 --> -0.907378).  Saving model ...
Epoch: 4 cost time: 2.5304172039031982
Epoch: 4, Steps: 89 | Train Loss: 0.252 Vali Loss: 0.204 Vali Acc: 0.950 Test Loss: 0.204 Test Acc: 0.950
Validation loss decreased (-0.907378 --> -0.949859).  Saving model ...
Epoch: 5 cost time: 2.302727699279785
Epoch: 5, Steps: 89 | Train Loss: 0.150 Vali Loss: 0.158 Vali Acc: 0.953 Test Loss: 0.158 Test Acc: 0.953
Validation loss decreased (-0.949859 --> -0.953341).  Saving model ...
Epoch: 6 cost time: 2.528687000274658
Epoch: 6, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.113 Vali Acc: 0.978 Test Loss: 0.113 Test Acc: 0.978
Validation loss decreased (-0.953341 --> -0.977715).  Saving model ...
Epoch: 7 cost time: 2.5424506664276123
Epoch: 7, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.482968330383301
Epoch: 8, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.081 Vali Acc: 0.982 Test Loss: 0.081 Test Acc: 0.982
Validation loss decreased (-0.977715 --> -0.981893).  Saving model ...
Epoch: 9 cost time: 2.4696853160858154
Epoch: 9, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.3466591835021973
Epoch: 10, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.104 Vali Acc: 0.971 Test Loss: 0.104 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.3277268409729004
Epoch: 11, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.073 Vali Acc: 0.981 Test Loss: 0.073 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.4421041011810303
Epoch: 12, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.075 Vali Acc: 0.978 Test Loss: 0.075 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.3237922191619873
Epoch: 13, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
Validation loss decreased (-0.981893 --> -0.982590).  Saving model ...
Epoch: 14 cost time: 2.3011839389801025
Epoch: 14, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.085 Vali Acc: 0.978 Test Loss: 0.085 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.4140236377716064
Epoch: 15, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.067 Vali Acc: 0.984 Test Loss: 0.067 Test Acc: 0.984
Validation loss decreased (-0.982590 --> -0.983983).  Saving model ...
Epoch: 16 cost time: 2.2421929836273193
Epoch: 16, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.084 Vali Acc: 0.976 Test Loss: 0.084 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.548248767852783
Epoch: 17, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.3546340465545654
Epoch: 18, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.067 Vali Acc: 0.985 Test Loss: 0.067 Test Acc: 0.985
Validation loss decreased (-0.983983 --> -0.985375).  Saving model ...
Epoch: 19 cost time: 2.450453758239746
Epoch: 19, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.079 Vali Acc: 0.979 Test Loss: 0.079 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.458425283432007
Epoch: 20, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.062 Vali Acc: 0.984 Test Loss: 0.062 Test Acc: 0.984
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.0968379974365234
Epoch: 21, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.074 Vali Acc: 0.981 Test Loss: 0.074 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.3113644123077393
Epoch: 22, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.062 Vali Acc: 0.985 Test Loss: 0.062 Test Acc: 0.985
Validation loss decreased (-0.985375 --> -0.985375).  Saving model ...
Epoch: 23 cost time: 2.4238059520721436
Epoch: 23, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.108 Vali Acc: 0.979 Test Loss: 0.108 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.1273891925811768
Epoch: 24, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.080 Vali Acc: 0.981 Test Loss: 0.080 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.2792158126831055
Epoch: 25, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.100 Vali Acc: 0.979 Test Loss: 0.100 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.417714834213257
Epoch: 26, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.132 Vali Acc: 0.967 Test Loss: 0.132 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.271967649459839
Epoch: 27, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.316128969192505
Epoch: 28, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 2.324129343032837
Epoch: 29, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.074 Vali Acc: 0.984 Test Loss: 0.074 Test Acc: 0.984
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.3115146160125732
Epoch: 30, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.076 Vali Acc: 0.986 Test Loss: 0.076 Test Acc: 0.986
Validation loss decreased (-0.985375 --> -0.986072).  Saving model ...
Epoch: 31 cost time: 2.578794002532959
Epoch: 31, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.093 Vali Acc: 0.978 Test Loss: 0.093 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.435471296310425
Epoch: 32, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.3549978733062744
Epoch: 33, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.113 Vali Acc: 0.975 Test Loss: 0.113 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 2.5697145462036133
Epoch: 34, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.102 Vali Acc: 0.983 Test Loss: 0.102 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 2.3812832832336426
Epoch: 35, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.116 Vali Acc: 0.981 Test Loss: 0.116 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 2.3209116458892822
Epoch: 36, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.127 Vali Acc: 0.974 Test Loss: 0.127 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 2.3694663047790527
Epoch: 37, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.142 Vali Acc: 0.974 Test Loss: 0.142 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 2.2899954319000244
Epoch: 38, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.082 Vali Acc: 0.985 Test Loss: 0.082 Test Acc: 0.985
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 2.331345319747925
Epoch: 39, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.139 Vali Acc: 0.972 Test Loss: 0.139 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 2.462090015411377
Epoch: 40, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.138 Vali Acc: 0.977 Test Loss: 0.138 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr2_ps46_str23_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9860724233983287
model parameter : 323188
model size : 1.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.4167661666870117
Epoch: 1, Steps: 89 | Train Loss: 1.928 Vali Loss: 0.630 Vali Acc: 0.825 Test Loss: 0.630 Test Acc: 0.825
Validation loss decreased (inf --> -0.825203).  Saving model ...
Epoch: 2 cost time: 2.5064430236816406
Epoch: 2, Steps: 89 | Train Loss: 0.360 Vali Loss: 0.213 Vali Acc: 0.946 Test Loss: 0.213 Test Acc: 0.946
Validation loss decreased (-0.825203 --> -0.945680).  Saving model ...
Epoch: 3 cost time: 2.382112979888916
Epoch: 3, Steps: 89 | Train Loss: 0.148 Vali Loss: 0.152 Vali Acc: 0.962 Test Loss: 0.152 Test Acc: 0.962
Validation loss decreased (-0.945680 --> -0.962394).  Saving model ...
Epoch: 4 cost time: 2.28027606010437
Epoch: 4, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.106 Vali Acc: 0.974 Test Loss: 0.106 Test Acc: 0.974
Validation loss decreased (-0.962394 --> -0.973537).  Saving model ...
Epoch: 5 cost time: 2.41017746925354
Epoch: 5, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.142 Vali Acc: 0.959 Test Loss: 0.142 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.4318485260009766
Epoch: 6, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.216 Vali Acc: 0.944 Test Loss: 0.216 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.161179780960083
Epoch: 7, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.097 Vali Acc: 0.981 Test Loss: 0.097 Test Acc: 0.981
Validation loss decreased (-0.973537 --> -0.980500).  Saving model ...
Epoch: 8 cost time: 2.3941493034362793
Epoch: 8, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.085 Vali Acc: 0.984 Test Loss: 0.085 Test Acc: 0.984
Validation loss decreased (-0.980500 --> -0.983982).  Saving model ...
Epoch: 9 cost time: 2.2952640056610107
Epoch: 9, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.090 Vali Acc: 0.982 Test Loss: 0.090 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.308286190032959
Epoch: 10, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.380220890045166
Epoch: 11, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.125 Vali Acc: 0.978 Test Loss: 0.125 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.3197743892669678
Epoch: 12, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.206 Vali Acc: 0.963 Test Loss: 0.206 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.306421995162964
Epoch: 13, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.320 Vali Acc: 0.935 Test Loss: 0.320 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.4446194171905518
Epoch: 14, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.185 Vali Acc: 0.973 Test Loss: 0.185 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.255739450454712
Epoch: 15, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.147 Vali Acc: 0.978 Test Loss: 0.147 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.263129949569702
Epoch: 16, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.136 Vali Acc: 0.978 Test Loss: 0.136 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.382429838180542
Epoch: 17, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.160 Vali Acc: 0.977 Test Loss: 0.160 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.1427178382873535
Epoch: 18, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.221 Vali Acc: 0.958 Test Loss: 0.221 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.983983286908078
model parameter : 419028
model size : 1.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.4827609062194824
Epoch: 1, Steps: 89 | Train Loss: 2.212 Vali Loss: 0.901 Vali Acc: 0.800 Test Loss: 0.901 Test Acc: 0.800
Validation loss decreased (inf --> -0.800130).  Saving model ...
Epoch: 2 cost time: 2.2972095012664795
Epoch: 2, Steps: 89 | Train Loss: 0.496 Vali Loss: 0.282 Vali Acc: 0.928 Test Loss: 0.282 Test Acc: 0.928
Validation loss decreased (-0.800130 --> -0.927574).  Saving model ...
Epoch: 3 cost time: 2.379932165145874
Epoch: 3, Steps: 89 | Train Loss: 0.190 Vali Loss: 0.158 Vali Acc: 0.962 Test Loss: 0.158 Test Acc: 0.962
Validation loss decreased (-0.927574 --> -0.961698).  Saving model ...
Epoch: 4 cost time: 2.3846077919006348
Epoch: 4, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.109 Vali Acc: 0.971 Test Loss: 0.109 Test Acc: 0.971
Validation loss decreased (-0.961698 --> -0.971447).  Saving model ...
Epoch: 5 cost time: 2.5126302242279053
Epoch: 5, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.082 Vali Acc: 0.979 Test Loss: 0.082 Test Acc: 0.979
Validation loss decreased (-0.971447 --> -0.979108).  Saving model ...
Epoch: 6 cost time: 2.357586622238159
Epoch: 6, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.124 Vali Acc: 0.960 Test Loss: 0.124 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.572446346282959
Epoch: 7, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.086 Vali Acc: 0.979 Test Loss: 0.086 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.500056028366089
Epoch: 8, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.067 Vali Acc: 0.979 Test Loss: 0.067 Test Acc: 0.979
Validation loss decreased (-0.979108 --> -0.979108).  Saving model ...
Epoch: 9 cost time: 2.35141921043396
Epoch: 9, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.109 Vali Acc: 0.979 Test Loss: 0.109 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.4876604080200195
Epoch: 10, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.115 Vali Acc: 0.969 Test Loss: 0.115 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.341980457305908
Epoch: 11, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
Validation loss decreased (-0.979108 --> -0.982590).  Saving model ...
Epoch: 12 cost time: 2.6906583309173584
Epoch: 12, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.094 Vali Acc: 0.979 Test Loss: 0.094 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.5413320064544678
Epoch: 13, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.109 Vali Acc: 0.972 Test Loss: 0.109 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.326277017593384
Epoch: 14, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.103 Vali Acc: 0.982 Test Loss: 0.103 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.518099784851074
Epoch: 15, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.109 Vali Acc: 0.980 Test Loss: 0.109 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.4620213508605957
Epoch: 16, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.094 Vali Acc: 0.984 Test Loss: 0.094 Test Acc: 0.984
Validation loss decreased (-0.982590 --> -0.983982).  Saving model ...
Epoch: 17 cost time: 2.3920435905456543
Epoch: 17, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.083 Vali Acc: 0.985 Test Loss: 0.083 Test Acc: 0.985
Validation loss decreased (-0.983982 --> -0.985375).  Saving model ...
Epoch: 18 cost time: 2.406395673751831
Epoch: 18, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.148 Vali Acc: 0.976 Test Loss: 0.148 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.345935583114624
Epoch: 19, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.123 Vali Acc: 0.978 Test Loss: 0.123 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.35176944732666
Epoch: 20, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.224 Vali Acc: 0.951 Test Loss: 0.224 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.5128395557403564
Epoch: 21, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.163 Vali Acc: 0.973 Test Loss: 0.163 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.3509459495544434
Epoch: 22, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.125 Vali Acc: 0.978 Test Loss: 0.125 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.5287911891937256
Epoch: 23, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.120 Vali Acc: 0.979 Test Loss: 0.120 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.4361095428466797
Epoch: 24, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.121 Vali Acc: 0.978 Test Loss: 0.121 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.055359125137329
Epoch: 25, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.116 Vali Acc: 0.982 Test Loss: 0.116 Test Acc: 0.982
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.1025283336639404
Epoch: 26, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.121 Vali Acc: 0.983 Test Loss: 0.121 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.1461105346679688
Epoch: 27, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.108 Vali Acc: 0.981 Test Loss: 0.108 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9853760445682451
model parameter : 373108
model size : 1.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps14_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.5889828205108643
Epoch: 1, Steps: 89 | Train Loss: 2.229 Vali Loss: 0.995 Vali Acc: 0.813 Test Loss: 0.995 Test Acc: 0.813
Validation loss decreased (inf --> -0.813361).  Saving model ...
Epoch: 2 cost time: 2.3624556064605713
Epoch: 2, Steps: 89 | Train Loss: 0.544 Vali Loss: 0.324 Vali Acc: 0.914 Test Loss: 0.324 Test Acc: 0.914
Validation loss decreased (-0.813361 --> -0.913646).  Saving model ...
Epoch: 3 cost time: 2.4099321365356445
Epoch: 3, Steps: 89 | Train Loss: 0.208 Vali Loss: 0.177 Vali Acc: 0.960 Test Loss: 0.177 Test Acc: 0.960
Validation loss decreased (-0.913646 --> -0.959608).  Saving model ...
Epoch: 4 cost time: 2.3450634479522705
Epoch: 4, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.121 Vali Acc: 0.972 Test Loss: 0.121 Test Acc: 0.972
Validation loss decreased (-0.959608 --> -0.972144).  Saving model ...
Epoch: 5 cost time: 2.1488072872161865
Epoch: 5, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.092 Vali Acc: 0.976 Test Loss: 0.092 Test Acc: 0.976
Validation loss decreased (-0.972144 --> -0.976322).  Saving model ...
Epoch: 6 cost time: 2.4156363010406494
Epoch: 6, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.072 Vali Acc: 0.985 Test Loss: 0.072 Test Acc: 0.985
Validation loss decreased (-0.976322 --> -0.984679).  Saving model ...
Epoch: 7 cost time: 2.4526731967926025
Epoch: 7, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.096 Vali Acc: 0.979 Test Loss: 0.096 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.2850546836853027
Epoch: 8, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.067 Vali Acc: 0.985 Test Loss: 0.067 Test Acc: 0.985
Validation loss decreased (-0.984679 --> -0.985375).  Saving model ...
Epoch: 9 cost time: 2.2743804454803467
Epoch: 9, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.066 Vali Acc: 0.985 Test Loss: 0.066 Test Acc: 0.985
Validation loss decreased (-0.985375 --> -0.985375).  Saving model ...
Epoch: 10 cost time: 2.3615059852600098
Epoch: 10, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.066 Vali Acc: 0.982 Test Loss: 0.066 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.253308057785034
Epoch: 11, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.051 Vali Acc: 0.985 Test Loss: 0.051 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.2642829418182373
Epoch: 12, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.078 Vali Acc: 0.981 Test Loss: 0.078 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.309372663497925
Epoch: 13, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.068 Vali Acc: 0.988 Test Loss: 0.068 Test Acc: 0.988
Validation loss decreased (-0.985375 --> -0.988161).  Saving model ...
Epoch: 14 cost time: 2.283076763153076
Epoch: 14, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.071 Vali Acc: 0.988 Test Loss: 0.071 Test Acc: 0.988
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.240797996520996
Epoch: 15, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.167 Vali Acc: 0.963 Test Loss: 0.167 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.4516441822052
Epoch: 16, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.204 Vali Acc: 0.962 Test Loss: 0.204 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.469341278076172
Epoch: 17, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.113 Vali Acc: 0.978 Test Loss: 0.113 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.34553599357605
Epoch: 18, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.090 Vali Acc: 0.984 Test Loss: 0.090 Test Acc: 0.984
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.166112184524536
Epoch: 19, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.078 Vali Acc: 0.987 Test Loss: 0.078 Test Acc: 0.987
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.3343474864959717
Epoch: 20, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.059 Vali Acc: 0.993 Test Loss: 0.059 Test Acc: 0.993
Validation loss decreased (-0.988161 --> -0.993036).  Saving model ...
Epoch: 21 cost time: 2.234384536743164
Epoch: 21, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.078 Vali Acc: 0.988 Test Loss: 0.078 Test Acc: 0.988
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.343731164932251
Epoch: 22, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.100 Vali Acc: 0.985 Test Loss: 0.100 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.3742897510528564
Epoch: 23, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.987 Test Loss: 0.086 Test Acc: 0.987
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.2158498764038086
Epoch: 24, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.119 Vali Acc: 0.982 Test Loss: 0.119 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.351095676422119
Epoch: 25, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.989 Test Loss: 0.084 Test Acc: 0.989
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.321115016937256
Epoch: 26, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.087 Vali Acc: 0.987 Test Loss: 0.087 Test Acc: 0.987
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.2296321392059326
Epoch: 27, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.988 Test Loss: 0.086 Test Acc: 0.988
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.3891794681549072
Epoch: 28, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.989 Test Loss: 0.072 Test Acc: 0.989
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.1682872772216797
Epoch: 29, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.071 Vali Acc: 0.990 Test Loss: 0.071 Test Acc: 0.990
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.3353779315948486
Epoch: 30, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.989 Test Loss: 0.092 Test Acc: 0.989
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps14_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9930362116991643
model parameter : 357876
model size : 1.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps19_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.287461042404175
Epoch: 1, Steps: 89 | Train Loss: 2.423 Vali Loss: 1.405 Vali Acc: 0.728 Test Loss: 1.405 Test Acc: 0.728
Validation loss decreased (inf --> -0.727702).  Saving model ...
Epoch: 2 cost time: 2.284315586090088
Epoch: 2, Steps: 89 | Train Loss: 0.750 Vali Loss: 0.430 Vali Acc: 0.875 Test Loss: 0.430 Test Acc: 0.875
Validation loss decreased (-0.727702 --> -0.874648).  Saving model ...
Epoch: 3 cost time: 2.314239025115967
Epoch: 3, Steps: 89 | Train Loss: 0.269 Vali Loss: 0.196 Vali Acc: 0.955 Test Loss: 0.196 Test Acc: 0.955
Validation loss decreased (-0.874648 --> -0.954733).  Saving model ...
Epoch: 4 cost time: 2.381883382797241
Epoch: 4, Steps: 89 | Train Loss: 0.140 Vali Loss: 0.121 Vali Acc: 0.977 Test Loss: 0.121 Test Acc: 0.977
Validation loss decreased (-0.954733 --> -0.977018).  Saving model ...
Epoch: 5 cost time: 2.1945011615753174
Epoch: 5, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.092 Vali Acc: 0.975 Test Loss: 0.092 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.2628438472747803
Epoch: 6, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
Validation loss decreased (-0.977018 --> -0.979804).  Saving model ...
Epoch: 7 cost time: 2.2620956897735596
Epoch: 7, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.083 Vali Acc: 0.979 Test Loss: 0.083 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.0881121158599854
Epoch: 8, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.079 Vali Acc: 0.981 Test Loss: 0.079 Test Acc: 0.981
Validation loss decreased (-0.979804 --> -0.980501).  Saving model ...
Epoch: 9 cost time: 2.469223976135254
Epoch: 9, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.980501 --> -0.982590).  Saving model ...
Epoch: 10 cost time: 2.411068916320801
Epoch: 10, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.982590 --> -0.983286).  Saving model ...
Epoch: 11 cost time: 2.2464640140533447
Epoch: 11, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.2049806118011475
Epoch: 12, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.075 Vali Acc: 0.982 Test Loss: 0.075 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.195997953414917
Epoch: 13, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.058 Vali Acc: 0.988 Test Loss: 0.058 Test Acc: 0.988
Validation loss decreased (-0.983286 --> -0.988161).  Saving model ...
Epoch: 14 cost time: 2.1785664558410645
Epoch: 14, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.063 Vali Acc: 0.984 Test Loss: 0.063 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.4336771965026855
Epoch: 15, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.063 Vali Acc: 0.987 Test Loss: 0.063 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.1631691455841064
Epoch: 16, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.063 Vali Acc: 0.988 Test Loss: 0.063 Test Acc: 0.988
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.2732772827148438
Epoch: 17, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.055 Vali Acc: 0.988 Test Loss: 0.055 Test Acc: 0.988
Validation loss decreased (-0.988161 --> -0.988161).  Saving model ...
Epoch: 18 cost time: 2.285865068435669
Epoch: 18, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.062 Vali Acc: 0.985 Test Loss: 0.062 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.0792040824890137
Epoch: 19, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.063 Vali Acc: 0.988 Test Loss: 0.063 Test Acc: 0.988
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.3491172790527344
Epoch: 20, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.082 Vali Acc: 0.987 Test Loss: 0.082 Test Acc: 0.987
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.4979190826416016
Epoch: 21, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.100 Vali Acc: 0.978 Test Loss: 0.100 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.312772274017334
Epoch: 22, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.071 Vali Acc: 0.984 Test Loss: 0.071 Test Acc: 0.984
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.5953290462493896
Epoch: 23, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.560070514678955
Epoch: 24, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.084 Vali Acc: 0.985 Test Loss: 0.084 Test Acc: 0.985
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.4561450481414795
Epoch: 25, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.076 Vali Acc: 0.985 Test Loss: 0.076 Test Acc: 0.985
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.6292765140533447
Epoch: 26, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.107 Vali Acc: 0.976 Test Loss: 0.107 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.3227896690368652
Epoch: 27, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.076 Vali Acc: 0.985 Test Loss: 0.076 Test Acc: 0.985
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps19_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9881615598885793
model parameter : 342676
model size : 1.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps28_str14_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.4871745109558105
Epoch: 1, Steps: 89 | Train Loss: 2.520 Vali Loss: 1.633 Vali Acc: 0.694 Test Loss: 1.633 Test Acc: 0.694
Validation loss decreased (inf --> -0.693577).  Saving model ...
Epoch: 2 cost time: 2.5160019397735596
Epoch: 2, Steps: 89 | Train Loss: 0.927 Vali Loss: 0.527 Vali Acc: 0.877 Test Loss: 0.527 Test Acc: 0.877
Validation loss decreased (-0.693577 --> -0.876736).  Saving model ...
Epoch: 3 cost time: 2.7232518196105957
Epoch: 3, Steps: 89 | Train Loss: 0.338 Vali Loss: 0.232 Vali Acc: 0.947 Test Loss: 0.232 Test Acc: 0.947
Validation loss decreased (-0.876736 --> -0.947073).  Saving model ...
Epoch: 4 cost time: 2.623918056488037
Epoch: 4, Steps: 89 | Train Loss: 0.173 Vali Loss: 0.134 Vali Acc: 0.971 Test Loss: 0.134 Test Acc: 0.971
Validation loss decreased (-0.947073 --> -0.971447).  Saving model ...
Epoch: 5 cost time: 2.3595194816589355
Epoch: 5, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.132 Vali Acc: 0.959 Test Loss: 0.132 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.1282424926757812
Epoch: 6, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.077 Vali Acc: 0.981 Test Loss: 0.077 Test Acc: 0.981
Validation loss decreased (-0.971447 --> -0.980501).  Saving model ...
Epoch: 7 cost time: 2.529318332672119
Epoch: 7, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.064 Vali Acc: 0.985 Test Loss: 0.064 Test Acc: 0.985
Validation loss decreased (-0.980501 --> -0.984679).  Saving model ...
Epoch: 8 cost time: 2.67755389213562
Epoch: 8, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.068 Vali Acc: 0.980 Test Loss: 0.068 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.4623138904571533
Epoch: 9, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.055 Vali Acc: 0.981 Test Loss: 0.055 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.430560350418091
Epoch: 10, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.071 Vali Acc: 0.982 Test Loss: 0.071 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.4843943119049072
Epoch: 11, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.069 Vali Acc: 0.981 Test Loss: 0.069 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.5734150409698486
Epoch: 12, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.102 Vali Acc: 0.974 Test Loss: 0.102 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.4806833267211914
Epoch: 13, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.050 Vali Acc: 0.983 Test Loss: 0.050 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.4812607765197754
Epoch: 14, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.3839681148529053
Epoch: 15, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.070 Vali Acc: 0.984 Test Loss: 0.070 Test Acc: 0.984
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.703953742980957
Epoch: 16, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.065 Vali Acc: 0.981 Test Loss: 0.065 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.3696630001068115
Epoch: 17, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.071 Vali Acc: 0.981 Test Loss: 0.071 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps28_str14_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9846796657381616
model parameter : 335284
model size : 1.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps37_str19_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.6759133338928223
Epoch: 1, Steps: 89 | Train Loss: 2.575 Vali Loss: 1.797 Vali Acc: 0.654 Test Loss: 1.797 Test Acc: 0.654
Validation loss decreased (inf --> -0.653882).  Saving model ...
Epoch: 2 cost time: 2.760256052017212
Epoch: 2, Steps: 89 | Train Loss: 1.103 Vali Loss: 0.584 Vali Acc: 0.882 Test Loss: 0.584 Test Acc: 0.882
Validation loss decreased (-0.653882 --> -0.881610).  Saving model ...
Epoch: 3 cost time: 2.728376865386963
Epoch: 3, Steps: 89 | Train Loss: 0.422 Vali Loss: 0.290 Vali Acc: 0.934 Test Loss: 0.290 Test Acc: 0.934
Validation loss decreased (-0.881610 --> -0.933841).  Saving model ...
Epoch: 4 cost time: 2.5941216945648193
Epoch: 4, Steps: 89 | Train Loss: 0.210 Vali Loss: 0.170 Vali Acc: 0.968 Test Loss: 0.170 Test Acc: 0.968
Validation loss decreased (-0.933841 --> -0.967965).  Saving model ...
Epoch: 5 cost time: 2.638106346130371
Epoch: 5, Steps: 89 | Train Loss: 0.122 Vali Loss: 0.133 Vali Acc: 0.962 Test Loss: 0.133 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.552018880844116
Epoch: 6, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.118 Vali Acc: 0.965 Test Loss: 0.118 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.484968900680542
Epoch: 7, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.090 Vali Acc: 0.981 Test Loss: 0.090 Test Acc: 0.981
Validation loss decreased (-0.967965 --> -0.980500).  Saving model ...
Epoch: 8 cost time: 2.7009124755859375
Epoch: 8, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.083 Vali Acc: 0.981 Test Loss: 0.083 Test Acc: 0.981
Validation loss decreased (-0.980500 --> -0.980501).  Saving model ...
Epoch: 9 cost time: 2.6420223712921143
Epoch: 9, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.080 Vali Acc: 0.978 Test Loss: 0.080 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.544403076171875
Epoch: 10, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.6716573238372803
Epoch: 11, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.079 Vali Acc: 0.979 Test Loss: 0.079 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.536947250366211
Epoch: 12, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.067 Vali Acc: 0.982 Test Loss: 0.067 Test Acc: 0.982
Validation loss decreased (-0.980501 --> -0.981893).  Saving model ...
Epoch: 13 cost time: 2.541469097137451
Epoch: 13, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.084 Vali Acc: 0.982 Test Loss: 0.084 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.6423122882843018
Epoch: 14, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.071 Vali Acc: 0.984 Test Loss: 0.071 Test Acc: 0.984
Validation loss decreased (-0.981893 --> -0.983983).  Saving model ...
Epoch: 15 cost time: 2.5850088596343994
Epoch: 15, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.6676671504974365
Epoch: 16, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.7663958072662354
Epoch: 17, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.093 Vali Acc: 0.979 Test Loss: 0.093 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.5689644813537598
Epoch: 18, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.089 Vali Acc: 0.979 Test Loss: 0.089 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.8317031860351562
Epoch: 19, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.073 Vali Acc: 0.982 Test Loss: 0.073 Test Acc: 0.982
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.559487819671631
Epoch: 20, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.133 Vali Acc: 0.974 Test Loss: 0.133 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.5316803455352783
Epoch: 21, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.115 Vali Acc: 0.974 Test Loss: 0.115 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.611281156539917
Epoch: 22, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.4613513946533203
Epoch: 23, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.071 Vali Acc: 0.986 Test Loss: 0.071 Test Acc: 0.986
Validation loss decreased (-0.983983 --> -0.986072).  Saving model ...
Epoch: 24 cost time: 2.64992356300354
Epoch: 24, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.078 Vali Acc: 0.985 Test Loss: 0.078 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.561518669128418
Epoch: 25, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.075 Vali Acc: 0.986 Test Loss: 0.075 Test Acc: 0.986
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.766437292098999
Epoch: 26, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.077 Vali Acc: 0.985 Test Loss: 0.077 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.7816057205200195
Epoch: 27, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.113 Vali Acc: 0.976 Test Loss: 0.113 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.6462748050689697
Epoch: 28, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.092 Vali Acc: 0.985 Test Loss: 0.092 Test Acc: 0.985
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.6617157459259033
Epoch: 29, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.108 Vali Acc: 0.976 Test Loss: 0.108 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.739687919616699
Epoch: 30, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.110 Vali Acc: 0.983 Test Loss: 0.110 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 2.8150136470794678
Epoch: 31, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.096 Vali Acc: 0.981 Test Loss: 0.096 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 2.5510571002960205
Epoch: 32, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 2.6588470935821533
Epoch: 33, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.131 Vali Acc: 0.981 Test Loss: 0.131 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps37_str19_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9860724233983287
model parameter : 327892
model size : 1.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps46_str23_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.37593412399292
Epoch: 1, Steps: 89 | Train Loss: 2.552 Vali Loss: 1.815 Vali Acc: 0.636 Test Loss: 1.815 Test Acc: 0.636
Validation loss decreased (inf --> -0.636472).  Saving model ...
Epoch: 2 cost time: 2.612966299057007
Epoch: 2, Steps: 89 | Train Loss: 1.137 Vali Loss: 0.618 Vali Acc: 0.862 Test Loss: 0.618 Test Acc: 0.862
Validation loss decreased (-0.636472 --> -0.862111).  Saving model ...
Epoch: 3 cost time: 2.338987112045288
Epoch: 3, Steps: 89 | Train Loss: 0.425 Vali Loss: 0.284 Vali Acc: 0.939 Test Loss: 0.284 Test Acc: 0.939
Validation loss decreased (-0.862111 --> -0.938716).  Saving model ...
Epoch: 4 cost time: 2.5117785930633545
Epoch: 4, Steps: 89 | Train Loss: 0.215 Vali Loss: 0.171 Vali Acc: 0.960 Test Loss: 0.171 Test Acc: 0.960
Validation loss decreased (-0.938716 --> -0.960305).  Saving model ...
Epoch: 5 cost time: 2.3356475830078125
Epoch: 5, Steps: 89 | Train Loss: 0.141 Vali Loss: 0.132 Vali Acc: 0.968 Test Loss: 0.132 Test Acc: 0.968
Validation loss decreased (-0.960305 --> -0.967965).  Saving model ...
Epoch: 6 cost time: 2.3388137817382812
Epoch: 6, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.124 Vali Acc: 0.964 Test Loss: 0.124 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.3724873065948486
Epoch: 7, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.084 Vali Acc: 0.978 Test Loss: 0.084 Test Acc: 0.978
Validation loss decreased (-0.967965 --> -0.978411).  Saving model ...
Epoch: 8 cost time: 2.4281225204467773
Epoch: 8, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.107 Vali Acc: 0.967 Test Loss: 0.107 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.5208396911621094
Epoch: 9, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.978411 --> -0.979804).  Saving model ...
Epoch: 10 cost time: 2.3264071941375732
Epoch: 10, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.081 Vali Acc: 0.978 Test Loss: 0.081 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.4514288902282715
Epoch: 11, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.060 Vali Acc: 0.983 Test Loss: 0.060 Test Acc: 0.983
Validation loss decreased (-0.979804 --> -0.982590).  Saving model ...
Epoch: 12 cost time: 2.571157455444336
Epoch: 12, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.084 Vali Acc: 0.974 Test Loss: 0.084 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.5135862827301025
Epoch: 13, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.066 Vali Acc: 0.979 Test Loss: 0.066 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.3834805488586426
Epoch: 14, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.078 Vali Acc: 0.978 Test Loss: 0.078 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.518927812576294
Epoch: 15, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.116 Vali Acc: 0.964 Test Loss: 0.116 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.205487012863159
Epoch: 16, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.062 Vali Acc: 0.982 Test Loss: 0.062 Test Acc: 0.982
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.3243343830108643
Epoch: 17, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.064 Vali Acc: 0.984 Test Loss: 0.064 Test Acc: 0.984
Validation loss decreased (-0.982590 --> -0.983983).  Saving model ...
Epoch: 18 cost time: 2.536771297454834
Epoch: 18, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.079 Vali Acc: 0.979 Test Loss: 0.079 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.1795718669891357
Epoch: 19, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.162 Vali Acc: 0.961 Test Loss: 0.162 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.314650297164917
Epoch: 20, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.059 Vali Acc: 0.982 Test Loss: 0.059 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.4962480068206787
Epoch: 21, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.066 Vali Acc: 0.986 Test Loss: 0.066 Test Acc: 0.986
Validation loss decreased (-0.983983 --> -0.986072).  Saving model ...
Epoch: 22 cost time: 2.529390811920166
Epoch: 22, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.4948437213897705
Epoch: 23, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.5312490463256836
Epoch: 24, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.072 Vali Acc: 0.985 Test Loss: 0.072 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.33893084526062
Epoch: 25, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.5248217582702637
Epoch: 26, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.082 Vali Acc: 0.981 Test Loss: 0.082 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.502368688583374
Epoch: 27, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.42928409576416
Epoch: 28, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.109 Vali Acc: 0.976 Test Loss: 0.109 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.3688228130340576
Epoch: 29, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 2.435919761657715
Epoch: 30, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.067 Vali Acc: 0.981 Test Loss: 0.067 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 2.656863212585449
Epoch: 31, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.059 Vali Acc: 0.985 Test Loss: 0.059 Test Acc: 0.985
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr2_ps46_str23_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9860724233983287
model parameter : 320500
model size : 1.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.2434322834014893
Epoch: 1, Steps: 89 | Train Loss: 1.119 Vali Loss: 0.295 Vali Acc: 0.920 Test Loss: 0.295 Test Acc: 0.920
Validation loss decreased (inf --> -0.919913).  Saving model ...
Epoch: 2 cost time: 2.555708408355713
Epoch: 2, Steps: 89 | Train Loss: 0.223 Vali Loss: 0.170 Vali Acc: 0.954 Test Loss: 0.170 Test Acc: 0.954
Validation loss decreased (-0.919913 --> -0.954037).  Saving model ...
Epoch: 3 cost time: 2.549952268600464
Epoch: 3, Steps: 89 | Train Loss: 0.140 Vali Loss: 0.339 Vali Acc: 0.928 Test Loss: 0.339 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.4536075592041016
Epoch: 4, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.214 Vali Acc: 0.957 Test Loss: 0.214 Test Acc: 0.957
Validation loss decreased (-0.954037 --> -0.956822).  Saving model ...
Epoch: 5 cost time: 2.6986539363861084
Epoch: 5, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.176 Vali Acc: 0.971 Test Loss: 0.176 Test Acc: 0.971
Validation loss decreased (-0.956822 --> -0.970750).  Saving model ...
Epoch: 6 cost time: 2.7239456176757812
Epoch: 6, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.232 Vali Acc: 0.962 Test Loss: 0.232 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.491670846939087
Epoch: 7, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.203 Vali Acc: 0.961 Test Loss: 0.203 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.6845340728759766
Epoch: 8, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.254 Vali Acc: 0.959 Test Loss: 0.254 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.542611598968506
Epoch: 9, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.289 Vali Acc: 0.955 Test Loss: 0.289 Test Acc: 0.955
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.420478343963623
Epoch: 10, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.209 Vali Acc: 0.977 Test Loss: 0.209 Test Acc: 0.977
Validation loss decreased (-0.970750 --> -0.977017).  Saving model ...
Epoch: 11 cost time: 2.640238046646118
Epoch: 11, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.193 Vali Acc: 0.972 Test Loss: 0.193 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.6116747856140137
Epoch: 12, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.231 Vali Acc: 0.978 Test Loss: 0.231 Test Acc: 0.978
Validation loss decreased (-0.977017 --> -0.977714).  Saving model ...
Epoch: 13 cost time: 2.388765811920166
Epoch: 13, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.263 Vali Acc: 0.974 Test Loss: 0.263 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.6379950046539307
Epoch: 14, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.368 Vali Acc: 0.957 Test Loss: 0.368 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.639314651489258
Epoch: 15, Steps: 89 | Train Loss: 0.172 Vali Loss: 0.317 Vali Acc: 0.972 Test Loss: 0.317 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.4826157093048096
Epoch: 16, Steps: 89 | Train Loss: 0.133 Vali Loss: 0.469 Vali Acc: 0.954 Test Loss: 0.469 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.2509512901306152
Epoch: 17, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.404 Vali Acc: 0.958 Test Loss: 0.404 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.1346018314361572
Epoch: 18, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.256 Vali Acc: 0.982 Test Loss: 0.256 Test Acc: 0.982
Validation loss decreased (-0.977714 --> -0.981892).  Saving model ...
Epoch: 19 cost time: 2.192532777786255
Epoch: 19, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.302 Vali Acc: 0.974 Test Loss: 0.302 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.6592047214508057
Epoch: 20, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.277 Vali Acc: 0.976 Test Loss: 0.277 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.62825345993042
Epoch: 21, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.372 Vali Acc: 0.973 Test Loss: 0.372 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.640402317047119
Epoch: 22, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.310 Vali Acc: 0.983 Test Loss: 0.310 Test Acc: 0.983
Validation loss decreased (-0.981892 --> -0.982587).  Saving model ...
Epoch: 23 cost time: 2.712939977645874
Epoch: 23, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.342 Vali Acc: 0.972 Test Loss: 0.342 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.4548702239990234
Epoch: 24, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.469 Vali Acc: 0.963 Test Loss: 0.469 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.722456216812134
Epoch: 25, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.577 Vali Acc: 0.967 Test Loss: 0.577 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.682321071624756
Epoch: 26, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.498 Vali Acc: 0.971 Test Loss: 0.498 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.4944026470184326
Epoch: 27, Steps: 89 | Train Loss: 0.139 Vali Loss: 0.560 Vali Acc: 0.974 Test Loss: 0.560 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.375095844268799
Epoch: 28, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.633 Vali Acc: 0.964 Test Loss: 0.633 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 2.471803665161133
Epoch: 29, Steps: 89 | Train Loss: 0.135 Vali Loss: 0.285 Vali Acc: 0.984 Test Loss: 0.285 Test Acc: 0.984
Validation loss decreased (-0.982587 --> -0.983980).  Saving model ...
Epoch: 30 cost time: 2.557959794998169
Epoch: 30, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.324 Vali Acc: 0.980 Test Loss: 0.324 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.8533425331115723
Epoch: 31, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.278 Vali Acc: 0.984 Test Loss: 0.278 Test Acc: 0.984
Validation loss decreased (-0.983980 --> -0.983981).  Saving model ...
Epoch: 32 cost time: 2.622049331665039
Epoch: 32, Steps: 89 | Train Loss: 0.073 Vali Loss: 1.001 Vali Acc: 0.951 Test Loss: 1.001 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.7325520515441895
Epoch: 33, Steps: 89 | Train Loss: 0.159 Vali Loss: 0.382 Vali Acc: 0.980 Test Loss: 0.382 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 2.5547962188720703
Epoch: 34, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.595 Vali Acc: 0.966 Test Loss: 0.595 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 2.622333288192749
Epoch: 35, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.516 Vali Acc: 0.975 Test Loss: 0.516 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 2.751113176345825
Epoch: 36, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.861 Vali Acc: 0.962 Test Loss: 0.861 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 2.738253593444824
Epoch: 37, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.627 Vali Acc: 0.976 Test Loss: 0.627 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 2.3647050857543945
Epoch: 38, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.621 Vali Acc: 0.976 Test Loss: 0.621 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 2.5898680686950684
Epoch: 39, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.592 Vali Acc: 0.973 Test Loss: 0.592 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 2.6241533756256104
Epoch: 40, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.541 Vali Acc: 0.978 Test Loss: 0.541 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 2.441652536392212
Epoch: 41, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.514 Vali Acc: 0.981 Test Loss: 0.514 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.983983286908078
model parameter : 1557780
model size : 5.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.1425576210021973
Epoch: 1, Steps: 89 | Train Loss: 1.319 Vali Loss: 0.294 Vali Acc: 0.921 Test Loss: 0.294 Test Acc: 0.921
Validation loss decreased (inf --> -0.921306).  Saving model ...
Epoch: 2 cost time: 2.1766116619110107
Epoch: 2, Steps: 89 | Train Loss: 0.225 Vali Loss: 0.164 Vali Acc: 0.955 Test Loss: 0.164 Test Acc: 0.955
Validation loss decreased (-0.921306 --> -0.954734).  Saving model ...
Epoch: 3 cost time: 2.444272756576538
Epoch: 3, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.164 Vali Acc: 0.963 Test Loss: 0.164 Test Acc: 0.963
Validation loss decreased (-0.954734 --> -0.963090).  Saving model ...
Epoch: 4 cost time: 2.3935141563415527
Epoch: 4, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.204 Vali Acc: 0.963 Test Loss: 0.204 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.329638957977295
Epoch: 5, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.140 Vali Acc: 0.971 Test Loss: 0.140 Test Acc: 0.971
Validation loss decreased (-0.963090 --> -0.970751).  Saving model ...
Epoch: 6 cost time: 2.2257471084594727
Epoch: 6, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.143 Vali Acc: 0.971 Test Loss: 0.143 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.652510404586792
Epoch: 7, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.153 Vali Acc: 0.976 Test Loss: 0.153 Test Acc: 0.976
Validation loss decreased (-0.970751 --> -0.975625).  Saving model ...
Epoch: 8 cost time: 2.16876482963562
Epoch: 8, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.172 Vali Acc: 0.970 Test Loss: 0.172 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.3075103759765625
Epoch: 9, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.179 Vali Acc: 0.967 Test Loss: 0.179 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.151163101196289
Epoch: 10, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.143 Vali Acc: 0.980 Test Loss: 0.143 Test Acc: 0.980
Validation loss decreased (-0.975625 --> -0.979804).  Saving model ...
Epoch: 11 cost time: 2.3827292919158936
Epoch: 11, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.168 Vali Acc: 0.977 Test Loss: 0.168 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.240976095199585
Epoch: 12, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.194 Vali Acc: 0.972 Test Loss: 0.194 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.3275234699249268
Epoch: 13, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.298 Vali Acc: 0.966 Test Loss: 0.298 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.4396934509277344
Epoch: 14, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.330 Vali Acc: 0.956 Test Loss: 0.330 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.3381519317626953
Epoch: 15, Steps: 89 | Train Loss: 0.157 Vali Loss: 0.304 Vali Acc: 0.974 Test Loss: 0.304 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.608520030975342
Epoch: 16, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.205 Vali Acc: 0.981 Test Loss: 0.205 Test Acc: 0.981
Validation loss decreased (-0.979804 --> -0.981196).  Saving model ...
Epoch: 17 cost time: 2.472315549850464
Epoch: 17, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.345 Vali Acc: 0.972 Test Loss: 0.345 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.255186080932617
Epoch: 18, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.212 Vali Acc: 0.981 Test Loss: 0.212 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.4464118480682373
Epoch: 19, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.259 Vali Acc: 0.980 Test Loss: 0.259 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.4849154949188232
Epoch: 20, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.199 Vali Acc: 0.985 Test Loss: 0.199 Test Acc: 0.985
Validation loss decreased (-0.981196 --> -0.984678).  Saving model ...
Epoch: 21 cost time: 2.4233431816101074
Epoch: 21, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.267 Vali Acc: 0.980 Test Loss: 0.267 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.525700092315674
Epoch: 22, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.372 Vali Acc: 0.967 Test Loss: 0.372 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.4839253425598145
Epoch: 23, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.245 Vali Acc: 0.982 Test Loss: 0.245 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.5435800552368164
Epoch: 24, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.293 Vali Acc: 0.981 Test Loss: 0.293 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.582656145095825
Epoch: 25, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.450 Vali Acc: 0.981 Test Loss: 0.450 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.3422093391418457
Epoch: 26, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.256 Vali Acc: 0.981 Test Loss: 0.256 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.5818400382995605
Epoch: 27, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.373 Vali Acc: 0.978 Test Loss: 0.373 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.5820939540863037
Epoch: 28, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.246 Vali Acc: 0.984 Test Loss: 0.246 Test Acc: 0.984
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.339826822280884
Epoch: 29, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.336 Vali Acc: 0.973 Test Loss: 0.336 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.75103759765625
Epoch: 30, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.330 Vali Acc: 0.976 Test Loss: 0.330 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9846796657381616
model parameter : 1374100
model size : 5.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps14_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.7994470596313477
Epoch: 1, Steps: 89 | Train Loss: 1.460 Vali Loss: 0.343 Vali Acc: 0.916 Test Loss: 0.343 Test Acc: 0.916
Validation loss decreased (inf --> -0.915735).  Saving model ...
Epoch: 2 cost time: 1.9084677696228027
Epoch: 2, Steps: 89 | Train Loss: 0.251 Vali Loss: 0.234 Vali Acc: 0.938 Test Loss: 0.234 Test Acc: 0.938
Validation loss decreased (-0.915735 --> -0.938020).  Saving model ...
Epoch: 3 cost time: 2.1473724842071533
Epoch: 3, Steps: 89 | Train Loss: 0.140 Vali Loss: 0.164 Vali Acc: 0.960 Test Loss: 0.164 Test Acc: 0.960
Validation loss decreased (-0.938020 --> -0.960305).  Saving model ...
Epoch: 4 cost time: 2.2763466835021973
Epoch: 4, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.106 Vali Acc: 0.976 Test Loss: 0.106 Test Acc: 0.976
Validation loss decreased (-0.960305 --> -0.976322).  Saving model ...
Epoch: 5 cost time: 2.244320869445801
Epoch: 5, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.168 Vali Acc: 0.966 Test Loss: 0.168 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.176086187362671
Epoch: 6, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.106 Vali Acc: 0.979 Test Loss: 0.106 Test Acc: 0.979
Validation loss decreased (-0.976322 --> -0.979108).  Saving model ...
Epoch: 7 cost time: 2.100017547607422
Epoch: 7, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.133 Vali Acc: 0.976 Test Loss: 0.133 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.2897329330444336
Epoch: 8, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.313 Vali Acc: 0.949 Test Loss: 0.313 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.181743860244751
Epoch: 9, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.133 Vali Acc: 0.971 Test Loss: 0.133 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.1877834796905518
Epoch: 10, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.306 Vali Acc: 0.955 Test Loss: 0.306 Test Acc: 0.955
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.279245138168335
Epoch: 11, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.180 Vali Acc: 0.965 Test Loss: 0.180 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.192488670349121
Epoch: 12, Steps: 89 | Train Loss: 0.113 Vali Loss: 0.281 Vali Acc: 0.957 Test Loss: 0.281 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.9022197723388672
Epoch: 13, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.198 Vali Acc: 0.977 Test Loss: 0.198 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.8947935104370117
Epoch: 14, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.240 Vali Acc: 0.964 Test Loss: 0.240 Test Acc: 0.964
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.33525013923645
Epoch: 15, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.197 Vali Acc: 0.971 Test Loss: 0.197 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.334162712097168
Epoch: 16, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.120 Vali Acc: 0.983 Test Loss: 0.120 Test Acc: 0.983
Validation loss decreased (-0.979108 --> -0.982589).  Saving model ...
Epoch: 17 cost time: 2.042304039001465
Epoch: 17, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.180 Vali Acc: 0.977 Test Loss: 0.180 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.393312692642212
Epoch: 18, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.168 Vali Acc: 0.979 Test Loss: 0.168 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.355834484100342
Epoch: 19, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.163 Vali Acc: 0.982 Test Loss: 0.163 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.2258076667785645
Epoch: 20, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.245 Vali Acc: 0.974 Test Loss: 0.245 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.2612645626068115
Epoch: 21, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.342 Vali Acc: 0.969 Test Loss: 0.342 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.109614133834839
Epoch: 22, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.230 Vali Acc: 0.971 Test Loss: 0.230 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.2074010372161865
Epoch: 23, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.292 Vali Acc: 0.979 Test Loss: 0.292 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.2723889350891113
Epoch: 24, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.427 Vali Acc: 0.964 Test Loss: 0.427 Test Acc: 0.964
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.316187858581543
Epoch: 25, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.187 Vali Acc: 0.981 Test Loss: 0.187 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.4307854175567627
Epoch: 26, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.198 Vali Acc: 0.977 Test Loss: 0.198 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps14_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9825905292479109
model parameter : 1297812
model size : 5.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps19_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.5043444633483887
Epoch: 1, Steps: 89 | Train Loss: 1.594 Vali Loss: 0.508 Vali Acc: 0.850 Test Loss: 0.508 Test Acc: 0.850
Validation loss decreased (inf --> -0.849577).  Saving model ...
Epoch: 2 cost time: 2.277596950531006
Epoch: 2, Steps: 89 | Train Loss: 0.266 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
Validation loss decreased (-0.849577 --> -0.944288).  Saving model ...
Epoch: 3 cost time: 2.467414140701294
Epoch: 3, Steps: 89 | Train Loss: 0.113 Vali Loss: 0.119 Vali Acc: 0.969 Test Loss: 0.119 Test Acc: 0.969
Validation loss decreased (-0.944288 --> -0.968662).  Saving model ...
Epoch: 4 cost time: 2.3211987018585205
Epoch: 4, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.101 Vali Acc: 0.971 Test Loss: 0.101 Test Acc: 0.971
Validation loss decreased (-0.968662 --> -0.971447).  Saving model ...
Epoch: 5 cost time: 2.641335964202881
Epoch: 5, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
Validation loss decreased (-0.971447 --> -0.977019).  Saving model ...
Epoch: 6 cost time: 2.541167974472046
Epoch: 6, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.151 Vali Acc: 0.960 Test Loss: 0.151 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.542207717895508
Epoch: 7, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.121 Vali Acc: 0.970 Test Loss: 0.121 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.564743757247925
Epoch: 8, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.977019 --> -0.983286).  Saving model ...
Epoch: 9 cost time: 2.2771315574645996
Epoch: 9, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.147 Vali Acc: 0.965 Test Loss: 0.147 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.5049030780792236
Epoch: 10, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.192 Vali Acc: 0.966 Test Loss: 0.192 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.4242939949035645
Epoch: 11, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.186 Vali Acc: 0.973 Test Loss: 0.186 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.539515256881714
Epoch: 12, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.212 Vali Acc: 0.965 Test Loss: 0.212 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.4143853187561035
Epoch: 13, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.165 Vali Acc: 0.969 Test Loss: 0.165 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.30973482131958
Epoch: 14, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.165 Vali Acc: 0.980 Test Loss: 0.165 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.1622273921966553
Epoch: 15, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.235 Vali Acc: 0.966 Test Loss: 0.235 Test Acc: 0.966
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.177588701248169
Epoch: 16, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.235 Vali Acc: 0.962 Test Loss: 0.235 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.4457433223724365
Epoch: 17, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.218 Vali Acc: 0.971 Test Loss: 0.218 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.4942824840545654
Epoch: 18, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.169 Vali Acc: 0.981 Test Loss: 0.169 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps19_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9832869080779945
model parameter : 1237012
model size : 4.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps28_str14_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.0829737186431885
Epoch: 1, Steps: 89 | Train Loss: 1.711 Vali Loss: 0.478 Vali Acc: 0.880 Test Loss: 0.478 Test Acc: 0.880
Validation loss decreased (inf --> -0.880218).  Saving model ...
Epoch: 2 cost time: 2.3708643913269043
Epoch: 2, Steps: 89 | Train Loss: 0.280 Vali Loss: 0.166 Vali Acc: 0.960 Test Loss: 0.166 Test Acc: 0.960
Validation loss decreased (-0.880218 --> -0.960305).  Saving model ...
Epoch: 3 cost time: 2.1793341636657715
Epoch: 3, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.129 Vali Acc: 0.967 Test Loss: 0.129 Test Acc: 0.967
Validation loss decreased (-0.960305 --> -0.967269).  Saving model ...
Epoch: 4 cost time: 2.374664545059204
Epoch: 4, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.102 Vali Acc: 0.974 Test Loss: 0.102 Test Acc: 0.974
Validation loss decreased (-0.967269 --> -0.973537).  Saving model ...
Epoch: 5 cost time: 2.254636526107788
Epoch: 5, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.089 Vali Acc: 0.975 Test Loss: 0.089 Test Acc: 0.975
Validation loss decreased (-0.973537 --> -0.974929).  Saving model ...
Epoch: 6 cost time: 2.390254020690918
Epoch: 6, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.072 Vali Acc: 0.981 Test Loss: 0.072 Test Acc: 0.981
Validation loss decreased (-0.974929 --> -0.981197).  Saving model ...
Epoch: 7 cost time: 2.3366854190826416
Epoch: 7, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.059 Vali Acc: 0.987 Test Loss: 0.059 Test Acc: 0.987
Validation loss decreased (-0.981197 --> -0.987465).  Saving model ...
Epoch: 8 cost time: 2.3756535053253174
Epoch: 8, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.097 Vali Acc: 0.979 Test Loss: 0.097 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.3808419704437256
Epoch: 9, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.100 Vali Acc: 0.978 Test Loss: 0.100 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.241913318634033
Epoch: 10, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.145 Vali Acc: 0.962 Test Loss: 0.145 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.510146379470825
Epoch: 11, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.123 Vali Acc: 0.978 Test Loss: 0.123 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.3587639331817627
Epoch: 12, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.193 Vali Acc: 0.959 Test Loss: 0.193 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.3794820308685303
Epoch: 13, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.178 Vali Acc: 0.968 Test Loss: 0.178 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.3440921306610107
Epoch: 14, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.122 Vali Acc: 0.979 Test Loss: 0.122 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.226478338241577
Epoch: 15, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.110 Vali Acc: 0.979 Test Loss: 0.110 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.6145851612091064
Epoch: 16, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.093 Vali Acc: 0.983 Test Loss: 0.093 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.5093958377838135
Epoch: 17, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.102 Vali Acc: 0.983 Test Loss: 0.102 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps28_str14_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9874651810584958
model parameter : 1207444
model size : 4.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps37_str19_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.6788601875305176
Epoch: 1, Steps: 89 | Train Loss: 1.850 Vali Loss: 0.706 Vali Acc: 0.815 Test Loss: 0.706 Test Acc: 0.815
Validation loss decreased (inf --> -0.814756).  Saving model ...
Epoch: 2 cost time: 2.6557116508483887
Epoch: 2, Steps: 89 | Train Loss: 0.394 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
Validation loss decreased (-0.814756 --> -0.943591).  Saving model ...
Epoch: 3 cost time: 2.296192169189453
Epoch: 3, Steps: 89 | Train Loss: 0.134 Vali Loss: 0.136 Vali Acc: 0.960 Test Loss: 0.136 Test Acc: 0.960
Validation loss decreased (-0.943591 --> -0.959609).  Saving model ...
Epoch: 4 cost time: 2.570164442062378
Epoch: 4, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.959609 --> -0.979804).  Saving model ...
Epoch: 5 cost time: 2.4488742351531982
Epoch: 5, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.7681221961975098
Epoch: 6, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.097 Vali Acc: 0.975 Test Loss: 0.097 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.7266507148742676
Epoch: 7, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.096 Vali Acc: 0.981 Test Loss: 0.096 Test Acc: 0.981
Validation loss decreased (-0.979804 --> -0.980500).  Saving model ...
Epoch: 8 cost time: 2.570352792739868
Epoch: 8, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.077 Vali Acc: 0.981 Test Loss: 0.077 Test Acc: 0.981
Validation loss decreased (-0.980500 --> -0.981197).  Saving model ...
Epoch: 9 cost time: 2.6704304218292236
Epoch: 9, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.079 Vali Acc: 0.985 Test Loss: 0.079 Test Acc: 0.985
Validation loss decreased (-0.981197 --> -0.984679).  Saving model ...
Epoch: 10 cost time: 2.443817138671875
Epoch: 10, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.4885056018829346
Epoch: 11, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.104 Vali Acc: 0.972 Test Loss: 0.104 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.658170700073242
Epoch: 12, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.6589012145996094
Epoch: 13, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.089 Vali Acc: 0.982 Test Loss: 0.089 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.6944074630737305
Epoch: 14, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.213 Vali Acc: 0.958 Test Loss: 0.213 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.467592477798462
Epoch: 15, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.170 Vali Acc: 0.969 Test Loss: 0.170 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.962057590484619
Epoch: 16, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.166 Vali Acc: 0.976 Test Loss: 0.166 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.595750570297241
Epoch: 17, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.185 Vali Acc: 0.964 Test Loss: 0.185 Test Acc: 0.964
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.380464553833008
Epoch: 18, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.123 Vali Acc: 0.978 Test Loss: 0.123 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.2217698097229004
Epoch: 19, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.192 Vali Acc: 0.963 Test Loss: 0.192 Test Acc: 0.963
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps37_str19_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9846796657381616
model parameter : 1177876
model size : 4.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps46_str23_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.3434035778045654
Epoch: 1, Steps: 89 | Train Loss: 1.986 Vali Loss: 0.757 Vali Acc: 0.837 Test Loss: 0.757 Test Acc: 0.837
Validation loss decreased (inf --> -0.837040).  Saving model ...
Epoch: 2 cost time: 2.585728883743286
Epoch: 2, Steps: 89 | Train Loss: 0.452 Vali Loss: 0.253 Vali Acc: 0.946 Test Loss: 0.253 Test Acc: 0.946
Validation loss decreased (-0.837040 --> -0.945680).  Saving model ...
Epoch: 3 cost time: 2.520479440689087
Epoch: 3, Steps: 89 | Train Loss: 0.165 Vali Loss: 0.131 Vali Acc: 0.967 Test Loss: 0.131 Test Acc: 0.967
Validation loss decreased (-0.945680 --> -0.967269).  Saving model ...
Epoch: 4 cost time: 2.4502720832824707
Epoch: 4, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.122 Vali Acc: 0.971 Test Loss: 0.122 Test Acc: 0.971
Validation loss decreased (-0.967269 --> -0.971447).  Saving model ...
Epoch: 5 cost time: 2.5914738178253174
Epoch: 5, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
Validation loss decreased (-0.971447 --> -0.976322).  Saving model ...
Epoch: 6 cost time: 2.43920636177063
Epoch: 6, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
Validation loss decreased (-0.976322 --> -0.976322).  Saving model ...
Epoch: 7 cost time: 2.5236730575561523
Epoch: 7, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.113 Vali Acc: 0.969 Test Loss: 0.113 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.6069884300231934
Epoch: 8, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.684135675430298
Epoch: 9, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.105 Vali Acc: 0.976 Test Loss: 0.105 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.631688356399536
Epoch: 10, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.976322 --> -0.983286).  Saving model ...
Epoch: 11 cost time: 2.4263041019439697
Epoch: 11, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.086 Vali Acc: 0.981 Test Loss: 0.086 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.600836753845215
Epoch: 12, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.150 Vali Acc: 0.967 Test Loss: 0.150 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.481358289718628
Epoch: 13, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.59301495552063
Epoch: 14, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.097 Vali Acc: 0.981 Test Loss: 0.097 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.5420517921447754
Epoch: 15, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.377558946609497
Epoch: 16, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.224 Vali Acc: 0.961 Test Loss: 0.224 Test Acc: 0.961
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.4536287784576416
Epoch: 17, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.121 Vali Acc: 0.974 Test Loss: 0.121 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.3672754764556885
Epoch: 18, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.102 Vali Acc: 0.979 Test Loss: 0.102 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.1294572353363037
Epoch: 19, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.209 Vali Acc: 0.963 Test Loss: 0.209 Test Acc: 0.963
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.3135457038879395
Epoch: 20, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.088 Vali Acc: 0.981 Test Loss: 0.088 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr2_ps46_str23_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9832869080779945
model parameter : 1163668
model size : 4.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.093989610671997
Epoch: 1, Steps: 89 | Train Loss: 1.410 Vali Loss: 0.414 Vali Acc: 0.884 Test Loss: 0.414 Test Acc: 0.884
Validation loss decreased (inf --> -0.883701).  Saving model ...
Epoch: 2 cost time: 1.8670918941497803
Epoch: 2, Steps: 89 | Train Loss: 0.236 Vali Loss: 0.179 Vali Acc: 0.954 Test Loss: 0.179 Test Acc: 0.954
Validation loss decreased (-0.883701 --> -0.954037).  Saving model ...
Epoch: 3 cost time: 2.1175308227539062
Epoch: 3, Steps: 89 | Train Loss: 0.123 Vali Loss: 0.145 Vali Acc: 0.962 Test Loss: 0.145 Test Acc: 0.962
Validation loss decreased (-0.954037 --> -0.962394).  Saving model ...
Epoch: 4 cost time: 2.0315959453582764
Epoch: 4, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.170 Vali Acc: 0.951 Test Loss: 0.170 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8699920177459717
Epoch: 5, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.155 Vali Acc: 0.967 Test Loss: 0.155 Test Acc: 0.967
Validation loss decreased (-0.962394 --> -0.967269).  Saving model ...
Epoch: 6 cost time: 1.8631000518798828
Epoch: 6, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.127 Vali Acc: 0.972 Test Loss: 0.127 Test Acc: 0.972
Validation loss decreased (-0.967269 --> -0.972144).  Saving model ...
Epoch: 7 cost time: 1.9572253227233887
Epoch: 7, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.143 Vali Acc: 0.969 Test Loss: 0.143 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.050687789916992
Epoch: 8, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.134 Vali Acc: 0.965 Test Loss: 0.134 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.9781408309936523
Epoch: 9, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.170 Vali Acc: 0.963 Test Loss: 0.170 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.063063859939575
Epoch: 10, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.181 Vali Acc: 0.969 Test Loss: 0.181 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.091710090637207
Epoch: 11, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.148 Vali Acc: 0.971 Test Loss: 0.148 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.160851240158081
Epoch: 12, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.182 Vali Acc: 0.975 Test Loss: 0.182 Test Acc: 0.975
Validation loss decreased (-0.972144 --> -0.974929).  Saving model ...
Epoch: 13 cost time: 2.0364129543304443
Epoch: 13, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.129 Vali Acc: 0.981 Test Loss: 0.129 Test Acc: 0.981
Validation loss decreased (-0.974929 --> -0.980500).  Saving model ...
Epoch: 14 cost time: 1.8878276348114014
Epoch: 14, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.172 Vali Acc: 0.969 Test Loss: 0.172 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.8453171253204346
Epoch: 15, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.329 Vali Acc: 0.956 Test Loss: 0.329 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.9963538646697998
Epoch: 16, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.247 Vali Acc: 0.972 Test Loss: 0.247 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.0153465270996094
Epoch: 17, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.149 Vali Acc: 0.972 Test Loss: 0.149 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.0413339138031006
Epoch: 18, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.233 Vali Acc: 0.976 Test Loss: 0.233 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.035592555999756
Epoch: 19, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.151 Vali Acc: 0.983 Test Loss: 0.151 Test Acc: 0.983
Validation loss decreased (-0.980500 --> -0.982589).  Saving model ...
Epoch: 20 cost time: 2.0497419834136963
Epoch: 20, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.180 Vali Acc: 0.982 Test Loss: 0.180 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.0169601440429688
Epoch: 21, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.162 Vali Acc: 0.983 Test Loss: 0.162 Test Acc: 0.983
Validation loss decreased (-0.982589 --> -0.983285).  Saving model ...
Epoch: 22 cost time: 1.9227697849273682
Epoch: 22, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.163 Vali Acc: 0.983 Test Loss: 0.163 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.9703383445739746
Epoch: 23, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.162 Vali Acc: 0.985 Test Loss: 0.162 Test Acc: 0.985
Validation loss decreased (-0.983285 --> -0.984678).  Saving model ...
Epoch: 24 cost time: 1.5476529598236084
Epoch: 24, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.249 Vali Acc: 0.967 Test Loss: 0.249 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.8941540718078613
Epoch: 25, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.280 Vali Acc: 0.971 Test Loss: 0.280 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.7343270778656006
Epoch: 26, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.298 Vali Acc: 0.966 Test Loss: 0.298 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.98530912399292
Epoch: 27, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.242 Vali Acc: 0.965 Test Loss: 0.242 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.7960755825042725
Epoch: 28, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.180 Vali Acc: 0.981 Test Loss: 0.180 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.0082480907440186
Epoch: 29, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.245 Vali Acc: 0.976 Test Loss: 0.245 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.0913798809051514
Epoch: 30, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.377 Vali Acc: 0.966 Test Loss: 0.377 Test Acc: 0.966
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.9095075130462646
Epoch: 31, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.269 Vali Acc: 0.974 Test Loss: 0.269 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.982954740524292
Epoch: 32, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.215 Vali Acc: 0.976 Test Loss: 0.215 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.8808536529541016
Epoch: 33, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.232 Vali Acc: 0.981 Test Loss: 0.232 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9846796657381616
model parameter : 516756
model size : 2.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.7818305492401123
Epoch: 1, Steps: 89 | Train Loss: 1.694 Vali Loss: 0.537 Vali Acc: 0.852 Test Loss: 0.537 Test Acc: 0.852
Validation loss decreased (inf --> -0.852362).  Saving model ...
Epoch: 2 cost time: 1.8222417831420898
Epoch: 2, Steps: 89 | Train Loss: 0.288 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
Validation loss decreased (-0.852362 --> -0.957519).  Saving model ...
Epoch: 3 cost time: 1.8037941455841064
Epoch: 3, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.166 Vali Acc: 0.954 Test Loss: 0.166 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8471992015838623
Epoch: 4, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.137 Vali Acc: 0.967 Test Loss: 0.137 Test Acc: 0.967
Validation loss decreased (-0.957519 --> -0.966572).  Saving model ...
Epoch: 5 cost time: 1.8805794715881348
Epoch: 5, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.110 Vali Acc: 0.974 Test Loss: 0.110 Test Acc: 0.974
Validation loss decreased (-0.966572 --> -0.973537).  Saving model ...
Epoch: 6 cost time: 1.9546658992767334
Epoch: 6, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.117 Vali Acc: 0.971 Test Loss: 0.117 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9485409259796143
Epoch: 7, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.116 Vali Acc: 0.975 Test Loss: 0.116 Test Acc: 0.975
Validation loss decreased (-0.973537 --> -0.974929).  Saving model ...
Epoch: 8 cost time: 1.8495945930480957
Epoch: 8, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.102 Vali Acc: 0.982 Test Loss: 0.102 Test Acc: 0.982
Validation loss decreased (-0.974929 --> -0.981893).  Saving model ...
Epoch: 9 cost time: 1.902132272720337
Epoch: 9, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.132 Vali Acc: 0.976 Test Loss: 0.132 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.973437786102295
Epoch: 10, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.120 Vali Acc: 0.974 Test Loss: 0.120 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.8306407928466797
Epoch: 11, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.144 Vali Acc: 0.967 Test Loss: 0.144 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.871227741241455
Epoch: 12, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.303 Vali Acc: 0.948 Test Loss: 0.303 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.9958527088165283
Epoch: 13, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.115 Vali Acc: 0.979 Test Loss: 0.115 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.9089739322662354
Epoch: 14, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.7724802494049072
Epoch: 15, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.154 Vali Acc: 0.976 Test Loss: 0.154 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.605004072189331
Epoch: 16, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.110 Vali Acc: 0.983 Test Loss: 0.110 Test Acc: 0.983
Validation loss decreased (-0.981893 --> -0.983286).  Saving model ...
Epoch: 17 cost time: 1.9064693450927734
Epoch: 17, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.126 Vali Acc: 0.982 Test Loss: 0.126 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.9657189846038818
Epoch: 18, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.110 Vali Acc: 0.985 Test Loss: 0.110 Test Acc: 0.985
Validation loss decreased (-0.983286 --> -0.985375).  Saving model ...
Epoch: 19 cost time: 2.0239899158477783
Epoch: 19, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.129 Vali Acc: 0.982 Test Loss: 0.129 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.991239070892334
Epoch: 20, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.105 Vali Acc: 0.983 Test Loss: 0.105 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.2981014251708984
Epoch: 21, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.107 Vali Acc: 0.983 Test Loss: 0.107 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.0061745643615723
Epoch: 22, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.176 Vali Acc: 0.971 Test Loss: 0.176 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.030904531478882
Epoch: 23, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.229 Vali Acc: 0.969 Test Loss: 0.229 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.0698015689849854
Epoch: 24, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.196 Vali Acc: 0.972 Test Loss: 0.196 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.8496112823486328
Epoch: 25, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.228 Vali Acc: 0.968 Test Loss: 0.228 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.8426473140716553
Epoch: 26, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.155 Vali Acc: 0.976 Test Loss: 0.155 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.0760340690612793
Epoch: 27, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.162 Vali Acc: 0.983 Test Loss: 0.162 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.8977038860321045
Epoch: 28, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.229 Vali Acc: 0.969 Test Loss: 0.229 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9853760445682451
model parameter : 424916
model size : 1.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps14_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.078361988067627
Epoch: 1, Steps: 89 | Train Loss: 1.828 Vali Loss: 0.610 Vali Acc: 0.844 Test Loss: 0.610 Test Acc: 0.844
Validation loss decreased (inf --> -0.844005).  Saving model ...
Epoch: 2 cost time: 2.032871961593628
Epoch: 2, Steps: 89 | Train Loss: 0.359 Vali Loss: 0.200 Vali Acc: 0.951 Test Loss: 0.200 Test Acc: 0.951
Validation loss decreased (-0.844005 --> -0.950555).  Saving model ...
Epoch: 3 cost time: 1.8187124729156494
Epoch: 3, Steps: 89 | Train Loss: 0.158 Vali Loss: 0.156 Vali Acc: 0.958 Test Loss: 0.156 Test Acc: 0.958
Validation loss decreased (-0.950555 --> -0.957519).  Saving model ...
Epoch: 4 cost time: 1.9379994869232178
Epoch: 4, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.113 Vali Acc: 0.974 Test Loss: 0.113 Test Acc: 0.974
Validation loss decreased (-0.957519 --> -0.973536).  Saving model ...
Epoch: 5 cost time: 1.9517905712127686
Epoch: 5, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.973536 --> -0.979804).  Saving model ...
Epoch: 6 cost time: 1.7156703472137451
Epoch: 6, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.101 Vali Acc: 0.979 Test Loss: 0.101 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.8909080028533936
Epoch: 7, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.090 Vali Acc: 0.978 Test Loss: 0.090 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.9734899997711182
Epoch: 8, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.106 Vali Acc: 0.979 Test Loss: 0.106 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.9551963806152344
Epoch: 9, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.109 Vali Acc: 0.975 Test Loss: 0.109 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.0126640796661377
Epoch: 10, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.130 Vali Acc: 0.970 Test Loss: 0.130 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.8784377574920654
Epoch: 11, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.101 Vali Acc: 0.981 Test Loss: 0.101 Test Acc: 0.981
Validation loss decreased (-0.979804 --> -0.981197).  Saving model ...
Epoch: 12 cost time: 1.995910406112671
Epoch: 12, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.064 Vali Acc: 0.985 Test Loss: 0.064 Test Acc: 0.985
Validation loss decreased (-0.981197 --> -0.984679).  Saving model ...
Epoch: 13 cost time: 2.1073246002197266
Epoch: 13, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.091 Vali Acc: 0.982 Test Loss: 0.091 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.087862968444824
Epoch: 14, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.126 Vali Acc: 0.971 Test Loss: 0.126 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.9339234828948975
Epoch: 15, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.069 Vali Acc: 0.985 Test Loss: 0.069 Test Acc: 0.985
Validation loss decreased (-0.984679 --> -0.985375).  Saving model ...
Epoch: 16 cost time: 2.1167242527008057
Epoch: 16, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.096 Vali Acc: 0.979 Test Loss: 0.096 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.842883825302124
Epoch: 17, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.168 Vali Acc: 0.973 Test Loss: 0.168 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.006113052368164
Epoch: 18, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.177 Vali Acc: 0.969 Test Loss: 0.177 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.6881029605865479
Epoch: 19, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.140 Vali Acc: 0.976 Test Loss: 0.140 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.7086894512176514
Epoch: 20, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.138 Vali Acc: 0.977 Test Loss: 0.138 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.8896102905273438
Epoch: 21, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.142 Vali Acc: 0.973 Test Loss: 0.142 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.8758184909820557
Epoch: 22, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.128 Vali Acc: 0.978 Test Loss: 0.128 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.9765093326568604
Epoch: 23, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.107 Vali Acc: 0.987 Test Loss: 0.107 Test Acc: 0.987
Validation loss decreased (-0.985375 --> -0.986768).  Saving model ...
Epoch: 24 cost time: 1.8356540203094482
Epoch: 24, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.144 Vali Acc: 0.980 Test Loss: 0.144 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.8981833457946777
Epoch: 25, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.113 Vali Acc: 0.978 Test Loss: 0.113 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.8157520294189453
Epoch: 26, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.127 Vali Acc: 0.978 Test Loss: 0.127 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.6457085609436035
Epoch: 27, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.120 Vali Acc: 0.985 Test Loss: 0.120 Test Acc: 0.985
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.948237419128418
Epoch: 28, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.158 Vali Acc: 0.982 Test Loss: 0.158 Test Acc: 0.982
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.177272081375122
Epoch: 29, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.115 Vali Acc: 0.989 Test Loss: 0.115 Test Acc: 0.989
Validation loss decreased (-0.986768 --> -0.988857).  Saving model ...
Epoch: 30 cost time: 1.7538282871246338
Epoch: 30, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.115 Vali Acc: 0.986 Test Loss: 0.115 Test Acc: 0.986
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.086115598678589
Epoch: 31, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.122 Vali Acc: 0.986 Test Loss: 0.122 Test Acc: 0.986
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.7662627696990967
Epoch: 32, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.180 Vali Acc: 0.973 Test Loss: 0.180 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.790374994277954
Epoch: 33, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.177 Vali Acc: 0.976 Test Loss: 0.177 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.9215459823608398
Epoch: 34, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.150 Vali Acc: 0.981 Test Loss: 0.150 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.9463937282562256
Epoch: 35, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.175 Vali Acc: 0.978 Test Loss: 0.175 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.833831548690796
Epoch: 36, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.168 Vali Acc: 0.984 Test Loss: 0.168 Test Acc: 0.984
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.8052113056182861
Epoch: 37, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.153 Vali Acc: 0.985 Test Loss: 0.153 Test Acc: 0.985
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.911384105682373
Epoch: 38, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.156 Vali Acc: 0.983 Test Loss: 0.156 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.8329436779022217
Epoch: 39, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.155 Vali Acc: 0.983 Test Loss: 0.155 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps14_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9888579387186629
model parameter : 386772
model size : 1.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps19_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.874837636947632
Epoch: 1, Steps: 89 | Train Loss: 2.085 Vali Loss: 0.819 Vali Acc: 0.815 Test Loss: 0.819 Test Acc: 0.815
Validation loss decreased (inf --> -0.815451).  Saving model ...
Epoch: 2 cost time: 1.931096076965332
Epoch: 2, Steps: 89 | Train Loss: 0.446 Vali Loss: 0.314 Vali Acc: 0.908 Test Loss: 0.314 Test Acc: 0.908
Validation loss decreased (-0.815451 --> -0.908075).  Saving model ...
Epoch: 3 cost time: 1.8544223308563232
Epoch: 3, Steps: 89 | Train Loss: 0.179 Vali Loss: 0.152 Vali Acc: 0.965 Test Loss: 0.152 Test Acc: 0.965
Validation loss decreased (-0.908075 --> -0.965180).  Saving model ...
Epoch: 4 cost time: 1.9969265460968018
Epoch: 4, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.113 Vali Acc: 0.974 Test Loss: 0.113 Test Acc: 0.974
Validation loss decreased (-0.965180 --> -0.973536).  Saving model ...
Epoch: 5 cost time: 1.9956254959106445
Epoch: 5, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.096 Vali Acc: 0.974 Test Loss: 0.096 Test Acc: 0.974
Validation loss decreased (-0.973536 --> -0.974233).  Saving model ...
Epoch: 6 cost time: 1.8990540504455566
Epoch: 6, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.123 Vali Acc: 0.966 Test Loss: 0.123 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9700312614440918
Epoch: 7, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
Validation loss decreased (-0.974233 --> -0.977715).  Saving model ...
Epoch: 8 cost time: 1.929610013961792
Epoch: 8, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.075 Vali Acc: 0.981 Test Loss: 0.075 Test Acc: 0.981
Validation loss decreased (-0.977715 --> -0.980501).  Saving model ...
Epoch: 9 cost time: 1.964432954788208
Epoch: 9, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.066 Vali Acc: 0.984 Test Loss: 0.066 Test Acc: 0.984
Validation loss decreased (-0.980501 --> -0.983983).  Saving model ...
Epoch: 10 cost time: 1.863316535949707
Epoch: 10, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.801748514175415
Epoch: 11, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.070 Vali Acc: 0.984 Test Loss: 0.070 Test Acc: 0.984
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.9113807678222656
Epoch: 12, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.098 Vali Acc: 0.979 Test Loss: 0.098 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.9033770561218262
Epoch: 13, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.109 Vali Acc: 0.974 Test Loss: 0.109 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.8463268280029297
Epoch: 14, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.011032819747925
Epoch: 15, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.104 Vali Acc: 0.974 Test Loss: 0.104 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.8984014987945557
Epoch: 16, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.131 Vali Acc: 0.971 Test Loss: 0.131 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.8647327423095703
Epoch: 17, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.155 Vali Acc: 0.968 Test Loss: 0.155 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.9838602542877197
Epoch: 18, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.229 Vali Acc: 0.969 Test Loss: 0.229 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.0862345695495605
Epoch: 19, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.156 Vali Acc: 0.970 Test Loss: 0.156 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps19_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.983983286908078
model parameter : 356372
model size : 1.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps28_str14_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.7538692951202393
Epoch: 1, Steps: 89 | Train Loss: 2.170 Vali Loss: 0.984 Vali Acc: 0.791 Test Loss: 0.984 Test Acc: 0.791
Validation loss decreased (inf --> -0.791077).  Saving model ...
Epoch: 2 cost time: 1.7879912853240967
Epoch: 2, Steps: 89 | Train Loss: 0.544 Vali Loss: 0.323 Vali Acc: 0.916 Test Loss: 0.323 Test Acc: 0.916
Validation loss decreased (-0.791077 --> -0.915735).  Saving model ...
Epoch: 3 cost time: 1.8423519134521484
Epoch: 3, Steps: 89 | Train Loss: 0.212 Vali Loss: 0.167 Vali Acc: 0.964 Test Loss: 0.167 Test Acc: 0.964
Validation loss decreased (-0.915735 --> -0.963787).  Saving model ...
Epoch: 4 cost time: 1.8786098957061768
Epoch: 4, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.108 Vali Acc: 0.974 Test Loss: 0.108 Test Acc: 0.974
Validation loss decreased (-0.963787 --> -0.974233).  Saving model ...
Epoch: 5 cost time: 1.8169395923614502
Epoch: 5, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.098 Vali Acc: 0.976 Test Loss: 0.098 Test Acc: 0.976
Validation loss decreased (-0.974233 --> -0.976322).  Saving model ...
Epoch: 6 cost time: 1.817159652709961
Epoch: 6, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.078 Vali Acc: 0.981 Test Loss: 0.078 Test Acc: 0.981
Validation loss decreased (-0.976322 --> -0.980501).  Saving model ...
Epoch: 7 cost time: 1.8299429416656494
Epoch: 7, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.068 Vali Acc: 0.981 Test Loss: 0.068 Test Acc: 0.981
Validation loss decreased (-0.980501 --> -0.980501).  Saving model ...
Epoch: 8 cost time: 1.9743695259094238
Epoch: 8, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6480000019073486
Epoch: 9, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.091 Vali Acc: 0.978 Test Loss: 0.091 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.9259817600250244
Epoch: 10, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.076 Vali Acc: 0.976 Test Loss: 0.076 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.9098107814788818
Epoch: 11, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.081 Vali Acc: 0.979 Test Loss: 0.081 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.9548051357269287
Epoch: 12, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.075 Vali Acc: 0.982 Test Loss: 0.075 Test Acc: 0.982
Validation loss decreased (-0.980501 --> -0.981893).  Saving model ...
Epoch: 13 cost time: 1.929417610168457
Epoch: 13, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.055 Vali Acc: 0.987 Test Loss: 0.055 Test Acc: 0.987
Validation loss decreased (-0.981893 --> -0.986768).  Saving model ...
Epoch: 14 cost time: 1.9704174995422363
Epoch: 14, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.0147101879119873
Epoch: 15, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.060 Vali Acc: 0.986 Test Loss: 0.060 Test Acc: 0.986
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.9319558143615723
Epoch: 16, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.084 Vali Acc: 0.981 Test Loss: 0.084 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.9090566635131836
Epoch: 17, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.156 Vali Acc: 0.968 Test Loss: 0.156 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.991014003753662
Epoch: 18, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.109 Vali Acc: 0.975 Test Loss: 0.109 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.0664758682250977
Epoch: 19, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.148 Vali Acc: 0.969 Test Loss: 0.148 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.8950786590576172
Epoch: 20, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.136 Vali Acc: 0.972 Test Loss: 0.136 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.015348196029663
Epoch: 21, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.101 Vali Acc: 0.981 Test Loss: 0.101 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.9947383403778076
Epoch: 22, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.079 Vali Acc: 0.985 Test Loss: 0.079 Test Acc: 0.985
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.928666353225708
Epoch: 23, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.097 Vali Acc: 0.983 Test Loss: 0.097 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps28_str14_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9867688022284122
model parameter : 341588
model size : 1.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps37_str19_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.7156848907470703
Epoch: 1, Steps: 89 | Train Loss: 2.306 Vali Loss: 1.263 Vali Acc: 0.750 Test Loss: 1.263 Test Acc: 0.750
Validation loss decreased (inf --> -0.749987).  Saving model ...
Epoch: 2 cost time: 1.8011023998260498
Epoch: 2, Steps: 89 | Train Loss: 0.698 Vali Loss: 0.390 Vali Acc: 0.903 Test Loss: 0.390 Test Acc: 0.903
Validation loss decreased (-0.749987 --> -0.902503).  Saving model ...
Epoch: 3 cost time: 1.913780927658081
Epoch: 3, Steps: 89 | Train Loss: 0.261 Vali Loss: 0.212 Vali Acc: 0.945 Test Loss: 0.212 Test Acc: 0.945
Validation loss decreased (-0.902503 --> -0.944984).  Saving model ...
Epoch: 4 cost time: 1.7364459037780762
Epoch: 4, Steps: 89 | Train Loss: 0.129 Vali Loss: 0.133 Vali Acc: 0.969 Test Loss: 0.133 Test Acc: 0.969
Validation loss decreased (-0.944984 --> -0.968662).  Saving model ...
Epoch: 5 cost time: 1.9103357791900635
Epoch: 5, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.968662 --> -0.977019).  Saving model ...
Epoch: 6 cost time: 2.062375545501709
Epoch: 6, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.100 Vali Acc: 0.979 Test Loss: 0.100 Test Acc: 0.979
Validation loss decreased (-0.977019 --> -0.979108).  Saving model ...
Epoch: 7 cost time: 1.885852336883545
Epoch: 7, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.979108 --> -0.982590).  Saving model ...
Epoch: 8 cost time: 1.7955679893493652
Epoch: 8, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.030824899673462
Epoch: 9, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.080 Vali Acc: 0.982 Test Loss: 0.080 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.9922783374786377
Epoch: 10, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.063 Vali Acc: 0.984 Test Loss: 0.063 Test Acc: 0.984
Validation loss decreased (-0.982590 --> -0.983983).  Saving model ...
Epoch: 11 cost time: 1.9028522968292236
Epoch: 11, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.086 Vali Acc: 0.979 Test Loss: 0.086 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.972301721572876
Epoch: 12, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.8807201385498047
Epoch: 13, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.027362108230591
Epoch: 14, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.9464929103851318
Epoch: 15, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.099 Vali Acc: 0.979 Test Loss: 0.099 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.7883987426757812
Epoch: 16, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.8131663799285889
Epoch: 17, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.852501630783081
Epoch: 18, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.8074212074279785
Epoch: 19, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.055 Vali Acc: 0.988 Test Loss: 0.055 Test Acc: 0.988
Validation loss decreased (-0.983983 --> -0.988161).  Saving model ...
Epoch: 20 cost time: 2.03048038482666
Epoch: 20, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.064 Vali Acc: 0.985 Test Loss: 0.064 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.0331366062164307
Epoch: 21, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.057 Vali Acc: 0.988 Test Loss: 0.057 Test Acc: 0.988
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.8774018287658691
Epoch: 22, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.055 Vali Acc: 0.990 Test Loss: 0.055 Test Acc: 0.990
Validation loss decreased (-0.988161 --> -0.989554).  Saving model ...
Epoch: 23 cost time: 1.8671343326568604
Epoch: 23, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.059 Vali Acc: 0.990 Test Loss: 0.059 Test Acc: 0.990
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.9409854412078857
Epoch: 24, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.986 Test Loss: 0.083 Test Acc: 0.986
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.7947242259979248
Epoch: 25, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.086 Vali Acc: 0.979 Test Loss: 0.086 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.0206942558288574
Epoch: 26, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.145 Vali Acc: 0.973 Test Loss: 0.145 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.8108539581298828
Epoch: 27, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.105 Vali Acc: 0.979 Test Loss: 0.105 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.903975486755371
Epoch: 28, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.108 Vali Acc: 0.975 Test Loss: 0.108 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.849905014038086
Epoch: 29, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.135 Vali Acc: 0.978 Test Loss: 0.135 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.8223989009857178
Epoch: 30, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.256 Vali Acc: 0.958 Test Loss: 0.256 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.725829839706421
Epoch: 31, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.105 Vali Acc: 0.983 Test Loss: 0.105 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.9365966320037842
Epoch: 32, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.290 Vali Acc: 0.954 Test Loss: 0.290 Test Acc: 0.954
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps37_str19_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9895543175487466
model parameter : 326804
model size : 1.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps46_str23_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.808865547180176
Epoch: 1, Steps: 89 | Train Loss: 2.482 Vali Loss: 1.522 Vali Acc: 0.733 Test Loss: 1.522 Test Acc: 0.733
Validation loss decreased (inf --> -0.732575).  Saving model ...
Epoch: 2 cost time: 1.8181145191192627
Epoch: 2, Steps: 89 | Train Loss: 0.844 Vali Loss: 0.484 Vali Acc: 0.885 Test Loss: 0.484 Test Acc: 0.885
Validation loss decreased (-0.732575 --> -0.885093).  Saving model ...
Epoch: 3 cost time: 1.842085361480713
Epoch: 3, Steps: 89 | Train Loss: 0.318 Vali Loss: 0.236 Vali Acc: 0.946 Test Loss: 0.236 Test Acc: 0.946
Validation loss decreased (-0.885093 --> -0.945680).  Saving model ...
Epoch: 4 cost time: 2.0013058185577393
Epoch: 4, Steps: 89 | Train Loss: 0.157 Vali Loss: 0.164 Vali Acc: 0.962 Test Loss: 0.164 Test Acc: 0.962
Validation loss decreased (-0.945680 --> -0.962394).  Saving model ...
Epoch: 5 cost time: 1.881620168685913
Epoch: 5, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.115 Vali Acc: 0.974 Test Loss: 0.115 Test Acc: 0.974
Validation loss decreased (-0.962394 --> -0.974233).  Saving model ...
Epoch: 6 cost time: 1.877425193786621
Epoch: 6, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.101 Vali Acc: 0.976 Test Loss: 0.101 Test Acc: 0.976
Validation loss decreased (-0.974233 --> -0.975626).  Saving model ...
Epoch: 7 cost time: 1.90287446975708
Epoch: 7, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.095 Vali Acc: 0.976 Test Loss: 0.095 Test Acc: 0.976
Validation loss decreased (-0.975626 --> -0.975626).  Saving model ...
Epoch: 8 cost time: 1.730851650238037
Epoch: 8, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.069 Vali Acc: 0.982 Test Loss: 0.069 Test Acc: 0.982
Validation loss decreased (-0.975626 --> -0.981893).  Saving model ...
Epoch: 9 cost time: 1.8826942443847656
Epoch: 9, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.981893 --> -0.982590).  Saving model ...
Epoch: 10 cost time: 1.8570282459259033
Epoch: 10, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.070 Vali Acc: 0.981 Test Loss: 0.070 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9096887111663818
Epoch: 11, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.9311602115631104
Epoch: 12, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
Validation loss decreased (-0.982590 --> -0.982590).  Saving model ...
Epoch: 13 cost time: 1.8970258235931396
Epoch: 13, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.820399522781372
Epoch: 14, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.084 Vali Acc: 0.981 Test Loss: 0.084 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.796161413192749
Epoch: 15, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.942293643951416
Epoch: 16, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.086 Vali Acc: 0.975 Test Loss: 0.086 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.8052058219909668
Epoch: 17, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.092 Vali Acc: 0.976 Test Loss: 0.092 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.8902320861816406
Epoch: 18, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.8599882125854492
Epoch: 19, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.095 Vali Acc: 0.978 Test Loss: 0.095 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.017381191253662
Epoch: 20, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.093 Vali Acc: 0.975 Test Loss: 0.093 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.954369068145752
Epoch: 21, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.078 Vali Acc: 0.981 Test Loss: 0.078 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.9060394763946533
Epoch: 22, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.096 Vali Acc: 0.975 Test Loss: 0.096 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr2_ps46_str23_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9825905292479109
model parameter : 319700
model size : 1.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.519289970397949
Epoch: 1, Steps: 89 | Train Loss: 1.831 Vali Loss: 0.564 Vali Acc: 0.866 Test Loss: 0.564 Test Acc: 0.866
Validation loss decreased (inf --> -0.865593).  Saving model ...
Epoch: 2 cost time: 1.6885108947753906
Epoch: 2, Steps: 89 | Train Loss: 0.346 Vali Loss: 0.243 Vali Acc: 0.927 Test Loss: 0.243 Test Acc: 0.927
Validation loss decreased (-0.865593 --> -0.926878).  Saving model ...
Epoch: 3 cost time: 1.5929124355316162
Epoch: 3, Steps: 89 | Train Loss: 0.145 Vali Loss: 0.153 Vali Acc: 0.958 Test Loss: 0.153 Test Acc: 0.958
Validation loss decreased (-0.926878 --> -0.958216).  Saving model ...
Epoch: 4 cost time: 1.6077136993408203
Epoch: 4, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.118 Vali Acc: 0.973 Test Loss: 0.118 Test Acc: 0.973
Validation loss decreased (-0.958216 --> -0.972840).  Saving model ...
Epoch: 5 cost time: 1.5911433696746826
Epoch: 5, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.125 Vali Acc: 0.961 Test Loss: 0.125 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6390271186828613
Epoch: 6, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.182 Vali Acc: 0.949 Test Loss: 0.182 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.6339328289031982
Epoch: 7, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.122 Vali Acc: 0.969 Test Loss: 0.122 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.7829480171203613
Epoch: 8, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.096 Vali Acc: 0.981 Test Loss: 0.096 Test Acc: 0.981
Validation loss decreased (-0.972840 --> -0.981197).  Saving model ...
Epoch: 9 cost time: 1.6057376861572266
Epoch: 9, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.110 Vali Acc: 0.979 Test Loss: 0.110 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5415363311767578
Epoch: 10, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.104 Vali Acc: 0.978 Test Loss: 0.104 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6207962036132812
Epoch: 11, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.128 Vali Acc: 0.976 Test Loss: 0.128 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.645822286605835
Epoch: 12, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.148 Vali Acc: 0.966 Test Loss: 0.148 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.5965871810913086
Epoch: 13, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.158 Vali Acc: 0.972 Test Loss: 0.158 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.6013851165771484
Epoch: 14, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.160 Vali Acc: 0.971 Test Loss: 0.160 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.7016844749450684
Epoch: 15, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.217 Vali Acc: 0.973 Test Loss: 0.217 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.497563123703003
Epoch: 16, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.164 Vali Acc: 0.974 Test Loss: 0.164 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.513944149017334
Epoch: 17, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.161 Vali Acc: 0.977 Test Loss: 0.161 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.664363145828247
Epoch: 18, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.175 Vali Acc: 0.976 Test Loss: 0.175 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9811977715877437
model parameter : 192852
model size : 0.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.727400779724121
Epoch: 1, Steps: 89 | Train Loss: 2.223 Vali Loss: 0.991 Vali Acc: 0.806 Test Loss: 0.991 Test Acc: 0.806
Validation loss decreased (inf --> -0.806397).  Saving model ...
Epoch: 2 cost time: 1.7334403991699219
Epoch: 2, Steps: 89 | Train Loss: 0.540 Vali Loss: 0.346 Vali Acc: 0.911 Test Loss: 0.346 Test Acc: 0.911
Validation loss decreased (-0.806397 --> -0.910860).  Saving model ...
Epoch: 3 cost time: 1.6197216510772705
Epoch: 3, Steps: 89 | Train Loss: 0.204 Vali Loss: 0.180 Vali Acc: 0.961 Test Loss: 0.180 Test Acc: 0.961
Validation loss decreased (-0.910860 --> -0.961001).  Saving model ...
Epoch: 4 cost time: 1.6480584144592285
Epoch: 4, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.116 Vali Acc: 0.971 Test Loss: 0.116 Test Acc: 0.971
Validation loss decreased (-0.961001 --> -0.971447).  Saving model ...
Epoch: 5 cost time: 1.5487465858459473
Epoch: 5, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.120 Vali Acc: 0.966 Test Loss: 0.120 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.600672721862793
Epoch: 6, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.110 Vali Acc: 0.975 Test Loss: 0.110 Test Acc: 0.975
Validation loss decreased (-0.971447 --> -0.974929).  Saving model ...
Epoch: 7 cost time: 1.6842713356018066
Epoch: 7, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
Validation loss decreased (-0.974929 --> -0.977019).  Saving model ...
Epoch: 8 cost time: 1.5503239631652832
Epoch: 8, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.101 Vali Acc: 0.975 Test Loss: 0.101 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5592851638793945
Epoch: 9, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.094 Vali Acc: 0.979 Test Loss: 0.094 Test Acc: 0.979
Validation loss decreased (-0.977019 --> -0.979108).  Saving model ...
Epoch: 10 cost time: 1.6717910766601562
Epoch: 10, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.106 Vali Acc: 0.978 Test Loss: 0.106 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6088154315948486
Epoch: 11, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
Validation loss decreased (-0.979108 --> -0.983286).  Saving model ...
Epoch: 12 cost time: 1.6525251865386963
Epoch: 12, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.095 Vali Acc: 0.983 Test Loss: 0.095 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6879360675811768
Epoch: 13, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.092 Vali Acc: 0.979 Test Loss: 0.092 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.5978808403015137
Epoch: 14, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.185 Vali Acc: 0.961 Test Loss: 0.185 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.5854742527008057
Epoch: 15, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.084 Vali Acc: 0.982 Test Loss: 0.084 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.7090508937835693
Epoch: 16, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.144 Vali Acc: 0.971 Test Loss: 0.144 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.5910038948059082
Epoch: 17, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.330 Vali Acc: 0.940 Test Loss: 0.330 Test Acc: 0.940
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.8024394512176514
Epoch: 18, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.154 Vali Acc: 0.976 Test Loss: 0.154 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.7254948616027832
Epoch: 19, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.176 Vali Acc: 0.971 Test Loss: 0.176 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.696092128753662
Epoch: 20, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.143 Vali Acc: 0.982 Test Loss: 0.143 Test Acc: 0.982
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.649756669998169
Epoch: 21, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.117 Vali Acc: 0.983 Test Loss: 0.117 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9832869080779945
model parameter : 146932
model size : 0.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps14_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.5800182819366455
Epoch: 1, Steps: 89 | Train Loss: 2.311 Vali Loss: 1.166 Vali Acc: 0.822 Test Loss: 1.166 Test Acc: 0.822
Validation loss decreased (inf --> -0.821715).  Saving model ...
Epoch: 2 cost time: 1.640779972076416
Epoch: 2, Steps: 89 | Train Loss: 0.615 Vali Loss: 0.342 Vali Acc: 0.921 Test Loss: 0.342 Test Acc: 0.921
Validation loss decreased (-0.821715 --> -0.921306).  Saving model ...
Epoch: 3 cost time: 1.5333716869354248
Epoch: 3, Steps: 89 | Train Loss: 0.243 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
Validation loss decreased (-0.921306 --> -0.944288).  Saving model ...
Epoch: 4 cost time: 1.6797897815704346
Epoch: 4, Steps: 89 | Train Loss: 0.123 Vali Loss: 0.141 Vali Acc: 0.967 Test Loss: 0.141 Test Acc: 0.967
Validation loss decreased (-0.944288 --> -0.966572).  Saving model ...
Epoch: 5 cost time: 1.627755880355835
Epoch: 5, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.102 Vali Acc: 0.975 Test Loss: 0.102 Test Acc: 0.975
Validation loss decreased (-0.966572 --> -0.974929).  Saving model ...
Epoch: 6 cost time: 1.628591537475586
Epoch: 6, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.090 Vali Acc: 0.981 Test Loss: 0.090 Test Acc: 0.981
Validation loss decreased (-0.974929 --> -0.981197).  Saving model ...
Epoch: 7 cost time: 1.541550636291504
Epoch: 7, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.981197 --> -0.982590).  Saving model ...
Epoch: 8 cost time: 1.7461919784545898
Epoch: 8, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
Validation loss decreased (-0.982590 --> -0.983286).  Saving model ...
Epoch: 9 cost time: 1.6389143466949463
Epoch: 9, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.750558614730835
Epoch: 10, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6721618175506592
Epoch: 11, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.084 Vali Acc: 0.982 Test Loss: 0.084 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.6470310688018799
Epoch: 12, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.8037612438201904
Epoch: 13, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.485107660293579
Epoch: 14, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.090 Vali Acc: 0.981 Test Loss: 0.090 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.6097629070281982
Epoch: 15, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.074 Vali Acc: 0.985 Test Loss: 0.074 Test Acc: 0.985
Validation loss decreased (-0.983286 --> -0.985375).  Saving model ...
Epoch: 16 cost time: 1.7083063125610352
Epoch: 16, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.707587480545044
Epoch: 17, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.088 Vali Acc: 0.979 Test Loss: 0.088 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.6047048568725586
Epoch: 18, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.553513526916504
Epoch: 19, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.082 Vali Acc: 0.985 Test Loss: 0.082 Test Acc: 0.985
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.6015610694885254
Epoch: 20, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.072 Vali Acc: 0.986 Test Loss: 0.072 Test Acc: 0.986
Validation loss decreased (-0.985375 --> -0.986072).  Saving model ...
Epoch: 21 cost time: 1.7040445804595947
Epoch: 21, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.768641710281372
Epoch: 22, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.101 Vali Acc: 0.982 Test Loss: 0.101 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.4659786224365234
Epoch: 23, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.138 Vali Acc: 0.969 Test Loss: 0.138 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.7549381256103516
Epoch: 24, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.167 Vali Acc: 0.973 Test Loss: 0.167 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.630295753479004
Epoch: 25, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.130 Vali Acc: 0.985 Test Loss: 0.130 Test Acc: 0.985
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.556917667388916
Epoch: 26, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.129 Vali Acc: 0.981 Test Loss: 0.129 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.6144781112670898
Epoch: 27, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.095 Vali Acc: 0.983 Test Loss: 0.095 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.666987419128418
Epoch: 28, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.087 Vali Acc: 0.986 Test Loss: 0.087 Test Acc: 0.986
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.5167419910430908
Epoch: 29, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.987 Test Loss: 0.090 Test Acc: 0.987
Validation loss decreased (-0.986072 --> -0.986768).  Saving model ...
Epoch: 30 cost time: 1.6476764678955078
Epoch: 30, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.987 Test Loss: 0.086 Test Acc: 0.987
Validation loss decreased (-0.986768 --> -0.986768).  Saving model ...
Epoch: 31 cost time: 1.4290306568145752
Epoch: 31, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.988 Test Loss: 0.087 Test Acc: 0.988
Validation loss decreased (-0.986768 --> -0.988161).  Saving model ...
Epoch: 32 cost time: 1.5675079822540283
Epoch: 32, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.988 Test Loss: 0.085 Test Acc: 0.988
Validation loss decreased (-0.988161 --> -0.988161).  Saving model ...
Epoch: 33 cost time: 1.5962450504302979
Epoch: 33, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.987 Test Loss: 0.092 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.6512179374694824
Epoch: 34, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.987 Test Loss: 0.085 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.5540838241577148
Epoch: 35, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.987 Test Loss: 0.088 Test Acc: 0.987
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.4911308288574219
Epoch: 36, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.987 Test Loss: 0.088 Test Acc: 0.987
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.7345061302185059
Epoch: 37, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.988 Test Loss: 0.086 Test Acc: 0.988
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.671919345855713
Epoch: 38, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.987 Test Loss: 0.093 Test Acc: 0.987
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.7895355224609375
Epoch: 39, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.987 Test Loss: 0.098 Test Acc: 0.987
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.7382330894470215
Epoch: 40, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.099 Vali Acc: 0.985 Test Loss: 0.099 Test Acc: 0.985
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.720548152923584
Epoch: 41, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.110 Vali Acc: 0.984 Test Loss: 0.110 Test Acc: 0.984
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.6157479286193848
Epoch: 42, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.858 Vali Acc: 0.921 Test Loss: 0.858 Test Acc: 0.921
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps14_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9881615598885793
model parameter : 127860
model size : 0.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps19_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.6565074920654297
Epoch: 1, Steps: 89 | Train Loss: 2.541 Vali Loss: 1.669 Vali Acc: 0.722 Test Loss: 1.669 Test Acc: 0.722
Validation loss decreased (inf --> -0.722128).  Saving model ...
Epoch: 2 cost time: 1.6384718418121338
Epoch: 2, Steps: 89 | Train Loss: 0.908 Vali Loss: 0.482 Vali Acc: 0.880 Test Loss: 0.482 Test Acc: 0.880
Validation loss decreased (-0.722128 --> -0.879522).  Saving model ...
Epoch: 3 cost time: 1.5242335796356201
Epoch: 3, Steps: 89 | Train Loss: 0.345 Vali Loss: 0.252 Vali Acc: 0.932 Test Loss: 0.252 Test Acc: 0.932
Validation loss decreased (-0.879522 --> -0.932449).  Saving model ...
Epoch: 4 cost time: 1.6113054752349854
Epoch: 4, Steps: 89 | Train Loss: 0.188 Vali Loss: 0.164 Vali Acc: 0.955 Test Loss: 0.164 Test Acc: 0.955
Validation loss decreased (-0.932449 --> -0.954734).  Saving model ...
Epoch: 5 cost time: 1.6863634586334229
Epoch: 5, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.114 Vali Acc: 0.974 Test Loss: 0.114 Test Acc: 0.974
Validation loss decreased (-0.954734 --> -0.974233).  Saving model ...
Epoch: 6 cost time: 1.7365696430206299
Epoch: 6, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.105 Vali Acc: 0.971 Test Loss: 0.105 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4775760173797607
Epoch: 7, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.085 Vali Acc: 0.982 Test Loss: 0.085 Test Acc: 0.982
Validation loss decreased (-0.974233 --> -0.981893).  Saving model ...
Epoch: 8 cost time: 1.642181396484375
Epoch: 8, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.078 Vali Acc: 0.978 Test Loss: 0.078 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.453618049621582
Epoch: 9, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.065 Vali Acc: 0.985 Test Loss: 0.065 Test Acc: 0.985
Validation loss decreased (-0.981893 --> -0.985375).  Saving model ...
Epoch: 10 cost time: 1.5934867858886719
Epoch: 10, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5444469451904297
Epoch: 11, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.069 Vali Acc: 0.979 Test Loss: 0.069 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.4867627620697021
Epoch: 12, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.060 Vali Acc: 0.985 Test Loss: 0.060 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.5383436679840088
Epoch: 13, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.067 Vali Acc: 0.984 Test Loss: 0.067 Test Acc: 0.984
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.6106276512145996
Epoch: 14, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.054 Vali Acc: 0.983 Test Loss: 0.054 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.8353135585784912
Epoch: 15, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.055 Vali Acc: 0.986 Test Loss: 0.055 Test Acc: 0.986
Validation loss decreased (-0.985375 --> -0.986072).  Saving model ...
Epoch: 16 cost time: 1.8241991996765137
Epoch: 16, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.061 Vali Acc: 0.983 Test Loss: 0.061 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.5866529941558838
Epoch: 17, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.079 Vali Acc: 0.981 Test Loss: 0.079 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.6754837036132812
Epoch: 18, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.065 Vali Acc: 0.985 Test Loss: 0.065 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.6469087600708008
Epoch: 19, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.4998431205749512
Epoch: 20, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.062 Vali Acc: 0.985 Test Loss: 0.062 Test Acc: 0.985
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.560114860534668
Epoch: 21, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.069 Vali Acc: 0.984 Test Loss: 0.069 Test Acc: 0.984
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.6946616172790527
Epoch: 22, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.078 Vali Acc: 0.974 Test Loss: 0.078 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.670165777206421
Epoch: 23, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.100 Vali Acc: 0.979 Test Loss: 0.100 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.789095163345337
Epoch: 24, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.087 Vali Acc: 0.981 Test Loss: 0.087 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.5553250312805176
Epoch: 25, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.078 Vali Acc: 0.984 Test Loss: 0.078 Test Acc: 0.984
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps19_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9860724233983287
model parameter : 112660
model size : 0.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps28_str14_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.536078453063965
Epoch: 1, Steps: 89 | Train Loss: 2.610 Vali Loss: 1.900 Vali Acc: 0.609 Test Loss: 1.900 Test Acc: 0.609
Validation loss decreased (inf --> -0.609312).  Saving model ...
Epoch: 2 cost time: 1.5429465770721436
Epoch: 2, Steps: 89 | Train Loss: 1.158 Vali Loss: 0.630 Vali Acc: 0.846 Test Loss: 0.630 Test Acc: 0.846
Validation loss decreased (-0.609312 --> -0.846094).  Saving model ...
Epoch: 3 cost time: 1.6028659343719482
Epoch: 3, Steps: 89 | Train Loss: 0.437 Vali Loss: 0.334 Vali Acc: 0.923 Test Loss: 0.334 Test Acc: 0.923
Validation loss decreased (-0.846094 --> -0.923395).  Saving model ...
Epoch: 4 cost time: 1.4588935375213623
Epoch: 4, Steps: 89 | Train Loss: 0.230 Vali Loss: 0.196 Vali Acc: 0.962 Test Loss: 0.196 Test Acc: 0.962
Validation loss decreased (-0.923395 --> -0.962394).  Saving model ...
Epoch: 5 cost time: 1.7123363018035889
Epoch: 5, Steps: 89 | Train Loss: 0.142 Vali Loss: 0.147 Vali Acc: 0.964 Test Loss: 0.147 Test Acc: 0.964
Validation loss decreased (-0.962394 --> -0.963787).  Saving model ...
Epoch: 6 cost time: 1.585160493850708
Epoch: 6, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.105 Vali Acc: 0.978 Test Loss: 0.105 Test Acc: 0.978
Validation loss decreased (-0.963787 --> -0.977715).  Saving model ...
Epoch: 7 cost time: 1.6772360801696777
Epoch: 7, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.519827127456665
Epoch: 8, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.977715 --> -0.979804).  Saving model ...
Epoch: 9 cost time: 1.6070423126220703
Epoch: 9, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.079 Vali Acc: 0.974 Test Loss: 0.079 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7232427597045898
Epoch: 10, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.081 Vali Acc: 0.978 Test Loss: 0.081 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.5950231552124023
Epoch: 11, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
Validation loss decreased (-0.979804 --> -0.983286).  Saving model ...
Epoch: 12 cost time: 1.731522798538208
Epoch: 12, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.059 Vali Acc: 0.984 Test Loss: 0.059 Test Acc: 0.984
Validation loss decreased (-0.983286 --> -0.983983).  Saving model ...
Epoch: 13 cost time: 1.5415592193603516
Epoch: 13, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.064 Vali Acc: 0.985 Test Loss: 0.064 Test Acc: 0.985
Validation loss decreased (-0.983983 --> -0.985375).  Saving model ...
Epoch: 14 cost time: 1.849231243133545
Epoch: 14, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.3800806999206543
Epoch: 15, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.3770244121551514
Epoch: 16, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.061 Vali Acc: 0.986 Test Loss: 0.061 Test Acc: 0.986
Validation loss decreased (-0.985375 --> -0.986072).  Saving model ...
Epoch: 17 cost time: 2.3824079036712646
Epoch: 17, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.208850383758545
Epoch: 18, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.064 Vali Acc: 0.985 Test Loss: 0.064 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.3234453201293945
Epoch: 19, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.064 Vali Acc: 0.985 Test Loss: 0.064 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.1531858444213867
Epoch: 20, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.069 Vali Acc: 0.985 Test Loss: 0.069 Test Acc: 0.985
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.204036235809326
Epoch: 21, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.062 Vali Acc: 0.985 Test Loss: 0.062 Test Acc: 0.985
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.0356478691101074
Epoch: 22, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.068 Vali Acc: 0.984 Test Loss: 0.068 Test Acc: 0.984
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.9568040370941162
Epoch: 23, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.066 Vali Acc: 0.985 Test Loss: 0.066 Test Acc: 0.985
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.2687363624572754
Epoch: 24, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.065 Vali Acc: 0.987 Test Loss: 0.065 Test Acc: 0.987
Validation loss decreased (-0.986072 --> -0.987465).  Saving model ...
Epoch: 25 cost time: 2.342752456665039
Epoch: 25, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.080 Vali Acc: 0.984 Test Loss: 0.080 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.4439446926116943
Epoch: 26, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.070 Vali Acc: 0.985 Test Loss: 0.070 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.3984808921813965
Epoch: 27, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.2092325687408447
Epoch: 28, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.086 Vali Acc: 0.981 Test Loss: 0.086 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.49174165725708
Epoch: 29, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.3320446014404297
Epoch: 30, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 2.344550132751465
Epoch: 31, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.985 Test Loss: 0.074 Test Acc: 0.985
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 2.41025447845459
Epoch: 32, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.071 Vali Acc: 0.985 Test Loss: 0.071 Test Acc: 0.985
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 2.3411004543304443
Epoch: 33, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 2.344163656234741
Epoch: 34, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.987 Test Loss: 0.079 Test Acc: 0.987
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps28_str14_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9874651810584958
model parameter : 105268
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps37_str19_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.549257278442383
Epoch: 1, Steps: 89 | Train Loss: 2.700 Vali Loss: 2.099 Vali Acc: 0.595 Test Loss: 2.099 Test Acc: 0.595
Validation loss decreased (inf --> -0.594687).  Saving model ...
Epoch: 2 cost time: 2.4324686527252197
Epoch: 2, Steps: 89 | Train Loss: 1.356 Vali Loss: 0.762 Vali Acc: 0.852 Test Loss: 0.762 Test Acc: 0.852
Validation loss decreased (-0.594687 --> -0.852360).  Saving model ...
Epoch: 3 cost time: 2.2640511989593506
Epoch: 3, Steps: 89 | Train Loss: 0.526 Vali Loss: 0.363 Vali Acc: 0.916 Test Loss: 0.363 Test Acc: 0.916
Validation loss decreased (-0.852360 --> -0.915735).  Saving model ...
Epoch: 4 cost time: 2.1031546592712402
Epoch: 4, Steps: 89 | Train Loss: 0.270 Vali Loss: 0.225 Vali Acc: 0.944 Test Loss: 0.225 Test Acc: 0.944
Validation loss decreased (-0.915735 --> -0.943591).  Saving model ...
Epoch: 5 cost time: 2.426541566848755
Epoch: 5, Steps: 89 | Train Loss: 0.164 Vali Loss: 0.143 Vali Acc: 0.969 Test Loss: 0.143 Test Acc: 0.969
Validation loss decreased (-0.943591 --> -0.968662).  Saving model ...
Epoch: 6 cost time: 2.3170957565307617
Epoch: 6, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.126 Vali Acc: 0.967 Test Loss: 0.126 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.4783074855804443
Epoch: 7, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.968662 --> -0.977019).  Saving model ...
Epoch: 8 cost time: 2.3956592082977295
Epoch: 8, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.084 Vali Acc: 0.978 Test Loss: 0.084 Test Acc: 0.978
Validation loss decreased (-0.977019 --> -0.978411).  Saving model ...
Epoch: 9 cost time: 2.3683016300201416
Epoch: 9, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.094 Vali Acc: 0.976 Test Loss: 0.094 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.4183483123779297
Epoch: 10, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.978411 --> -0.983286).  Saving model ...
Epoch: 11 cost time: 2.4511678218841553
Epoch: 11, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
Validation loss decreased (-0.983286 --> -0.983286).  Saving model ...
Epoch: 12 cost time: 2.431688070297241
Epoch: 12, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
Validation loss decreased (-0.983286 --> -0.983286).  Saving model ...
Epoch: 13 cost time: 2.0767078399658203
Epoch: 13, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.063 Vali Acc: 0.985 Test Loss: 0.063 Test Acc: 0.985
Validation loss decreased (-0.983286 --> -0.985375).  Saving model ...
Epoch: 14 cost time: 2.3383641242980957
Epoch: 14, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.072 Vali Acc: 0.981 Test Loss: 0.072 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.39689040184021
Epoch: 15, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.061 Vali Acc: 0.982 Test Loss: 0.061 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.309263229370117
Epoch: 16, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.055 Vali Acc: 0.988 Test Loss: 0.055 Test Acc: 0.988
Validation loss decreased (-0.985375 --> -0.988161).  Saving model ...
Epoch: 17 cost time: 2.490478754043579
Epoch: 17, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.057 Vali Acc: 0.987 Test Loss: 0.057 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.517453908920288
Epoch: 18, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.056 Vali Acc: 0.986 Test Loss: 0.056 Test Acc: 0.986
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.523282289505005
Epoch: 19, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.063 Vali Acc: 0.985 Test Loss: 0.063 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.098511219024658
Epoch: 20, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.059 Vali Acc: 0.985 Test Loss: 0.059 Test Acc: 0.985
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.1621010303497314
Epoch: 21, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.067 Vali Acc: 0.986 Test Loss: 0.067 Test Acc: 0.986
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.0501081943511963
Epoch: 22, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.067 Vali Acc: 0.984 Test Loss: 0.067 Test Acc: 0.984
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.4952216148376465
Epoch: 23, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.080 Vali Acc: 0.978 Test Loss: 0.080 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.42043399810791
Epoch: 24, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.064 Vali Acc: 0.981 Test Loss: 0.064 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.4086966514587402
Epoch: 25, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.068 Vali Acc: 0.985 Test Loss: 0.068 Test Acc: 0.985
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.412325620651245
Epoch: 26, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.053 Vali Acc: 0.985 Test Loss: 0.053 Test Acc: 0.985
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps37_str19_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9881615598885793
model parameter : 97876
model size : 0.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps46_str23_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.4905879497528076
Epoch: 1, Steps: 89 | Train Loss: 2.770 Vali Loss: 2.251 Vali Acc: 0.608 Test Loss: 2.251 Test Acc: 0.608
Validation loss decreased (inf --> -0.607916).  Saving model ...
Epoch: 2 cost time: 2.2342913150787354
Epoch: 2, Steps: 89 | Train Loss: 1.508 Vali Loss: 0.884 Vali Acc: 0.827 Test Loss: 0.884 Test Acc: 0.827
Validation loss decreased (-0.607916 --> -0.827289).  Saving model ...
Epoch: 3 cost time: 2.4286186695098877
Epoch: 3, Steps: 89 | Train Loss: 0.616 Vali Loss: 0.439 Vali Acc: 0.897 Test Loss: 0.439 Test Acc: 0.897
Validation loss decreased (-0.827289 --> -0.896932).  Saving model ...
Epoch: 4 cost time: 2.478606700897217
Epoch: 4, Steps: 89 | Train Loss: 0.321 Vali Loss: 0.258 Vali Acc: 0.934 Test Loss: 0.258 Test Acc: 0.934
Validation loss decreased (-0.896932 --> -0.933841).  Saving model ...
Epoch: 5 cost time: 2.0945568084716797
Epoch: 5, Steps: 89 | Train Loss: 0.179 Vali Loss: 0.164 Vali Acc: 0.962 Test Loss: 0.164 Test Acc: 0.962
Validation loss decreased (-0.933841 --> -0.961698).  Saving model ...
Epoch: 6 cost time: 2.0690104961395264
Epoch: 6, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.127 Vali Acc: 0.974 Test Loss: 0.127 Test Acc: 0.974
Validation loss decreased (-0.961698 --> -0.973536).  Saving model ...
Epoch: 7 cost time: 2.0381195545196533
Epoch: 7, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.110 Vali Acc: 0.976 Test Loss: 0.110 Test Acc: 0.976
Validation loss decreased (-0.973536 --> -0.975626).  Saving model ...
Epoch: 8 cost time: 2.489483118057251
Epoch: 8, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.118 Vali Acc: 0.971 Test Loss: 0.118 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.4308478832244873
Epoch: 9, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.081 Vali Acc: 0.978 Test Loss: 0.081 Test Acc: 0.978
Validation loss decreased (-0.975626 --> -0.978411).  Saving model ...
Epoch: 10 cost time: 2.4297304153442383
Epoch: 10, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.070 Vali Acc: 0.987 Test Loss: 0.070 Test Acc: 0.987
Validation loss decreased (-0.978411 --> -0.986768).  Saving model ...
Epoch: 11 cost time: 2.3642489910125732
Epoch: 11, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.076 Vali Acc: 0.980 Test Loss: 0.076 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.319817066192627
Epoch: 12, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.070 Vali Acc: 0.984 Test Loss: 0.070 Test Acc: 0.984
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.5506646633148193
Epoch: 13, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.075 Vali Acc: 0.985 Test Loss: 0.075 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.219058036804199
Epoch: 14, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.096 Vali Acc: 0.969 Test Loss: 0.096 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.4799370765686035
Epoch: 15, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.071 Vali Acc: 0.984 Test Loss: 0.071 Test Acc: 0.984
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.403761625289917
Epoch: 16, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.068 Vali Acc: 0.981 Test Loss: 0.068 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.464202642440796
Epoch: 17, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.054 Vali Acc: 0.989 Test Loss: 0.054 Test Acc: 0.989
Validation loss decreased (-0.986768 --> -0.988857).  Saving model ...
Epoch: 18 cost time: 2.3877227306365967
Epoch: 18, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.058 Vali Acc: 0.989 Test Loss: 0.058 Test Acc: 0.989
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.1521084308624268
Epoch: 19, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.062 Vali Acc: 0.985 Test Loss: 0.062 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.064481735229492
Epoch: 20, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.052 Vali Acc: 0.989 Test Loss: 0.052 Test Acc: 0.989
Validation loss decreased (-0.988857 --> -0.988857).  Saving model ...
Epoch: 21 cost time: 2.4202473163604736
Epoch: 21, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.3148131370544434
Epoch: 22, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.066 Vali Acc: 0.987 Test Loss: 0.066 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.4366700649261475
Epoch: 23, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.058 Vali Acc: 0.986 Test Loss: 0.058 Test Acc: 0.986
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.383084535598755
Epoch: 24, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.338127851486206
Epoch: 25, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.062 Vali Acc: 0.984 Test Loss: 0.062 Test Acc: 0.984
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.0797390937805176
Epoch: 26, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.1665232181549072
Epoch: 27, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.070 Vali Acc: 0.985 Test Loss: 0.070 Test Acc: 0.985
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.226405382156372
Epoch: 28, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.067 Vali Acc: 0.985 Test Loss: 0.067 Test Acc: 0.985
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.3000285625457764
Epoch: 29, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.069 Vali Acc: 0.985 Test Loss: 0.069 Test Acc: 0.985
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.3270509243011475
Epoch: 30, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr2_ps46_str23_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9888579387186629
model parameter : 94324
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.150718450546265
Epoch: 1, Steps: 89 | Train Loss: 1.169 Vali Loss: 0.334 Vali Acc: 0.888 Test Loss: 0.334 Test Acc: 0.888
Validation loss decreased (inf --> -0.887880).  Saving model ...
Epoch: 2 cost time: 2.9718050956726074
Epoch: 2, Steps: 89 | Train Loss: 0.267 Vali Loss: 0.198 Vali Acc: 0.948 Test Loss: 0.198 Test Acc: 0.948
Validation loss decreased (-0.887880 --> -0.948466).  Saving model ...
Epoch: 3 cost time: 3.577420711517334
Epoch: 3, Steps: 89 | Train Loss: 0.123 Vali Loss: 0.234 Vali Acc: 0.944 Test Loss: 0.234 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.5685856342315674
Epoch: 4, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.183 Vali Acc: 0.970 Test Loss: 0.183 Test Acc: 0.970
Validation loss decreased (-0.948466 --> -0.970054).  Saving model ...
Epoch: 5 cost time: 3.5966014862060547
Epoch: 5, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.193 Vali Acc: 0.967 Test Loss: 0.193 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.5568578243255615
Epoch: 6, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.245 Vali Acc: 0.964 Test Loss: 0.245 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.044485569000244
Epoch: 7, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.229 Vali Acc: 0.965 Test Loss: 0.229 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.6516313552856445
Epoch: 8, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.251 Vali Acc: 0.960 Test Loss: 0.251 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.634413957595825
Epoch: 9, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.383 Vali Acc: 0.942 Test Loss: 0.383 Test Acc: 0.942
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.5769619941711426
Epoch: 10, Steps: 89 | Train Loss: 0.132 Vali Loss: 0.286 Vali Acc: 0.968 Test Loss: 0.286 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.767163038253784
Epoch: 11, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.248 Vali Acc: 0.973 Test Loss: 0.248 Test Acc: 0.973
Validation loss decreased (-0.970054 --> -0.972839).  Saving model ...
Epoch: 12 cost time: 3.7086894512176514
Epoch: 12, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.212 Vali Acc: 0.975 Test Loss: 0.212 Test Acc: 0.975
Validation loss decreased (-0.972839 --> -0.974928).  Saving model ...
Epoch: 13 cost time: 3.229677438735962
Epoch: 13, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.309 Vali Acc: 0.967 Test Loss: 0.309 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.6052193641662598
Epoch: 14, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.308 Vali Acc: 0.965 Test Loss: 0.308 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.662625551223755
Epoch: 15, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.498 Vali Acc: 0.955 Test Loss: 0.498 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.7106056213378906
Epoch: 16, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.312 Vali Acc: 0.973 Test Loss: 0.312 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.7041406631469727
Epoch: 17, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.346 Vali Acc: 0.968 Test Loss: 0.346 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.0766589641571045
Epoch: 18, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.463 Vali Acc: 0.962 Test Loss: 0.463 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.7192130088806152
Epoch: 19, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.446 Vali Acc: 0.975 Test Loss: 0.446 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.455038547515869
Epoch: 20, Steps: 89 | Train Loss: 0.129 Vali Loss: 0.400 Vali Acc: 0.976 Test Loss: 0.400 Test Acc: 0.976
Validation loss decreased (-0.974928 --> -0.976319).  Saving model ...
Epoch: 21 cost time: 3.4679136276245117
Epoch: 21, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.394 Vali Acc: 0.974 Test Loss: 0.394 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.420971155166626
Epoch: 22, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.636 Vali Acc: 0.970 Test Loss: 0.636 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.504646062850952
Epoch: 23, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.746 Vali Acc: 0.955 Test Loss: 0.746 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.8432767391204834
Epoch: 24, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.566 Vali Acc: 0.967 Test Loss: 0.566 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.4263229370117188
Epoch: 25, Steps: 89 | Train Loss: 0.130 Vali Loss: 0.682 Vali Acc: 0.958 Test Loss: 0.682 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.5190322399139404
Epoch: 26, Steps: 89 | Train Loss: 0.179 Vali Loss: 1.489 Vali Acc: 0.932 Test Loss: 1.489 Test Acc: 0.932
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.4741013050079346
Epoch: 27, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.517 Vali Acc: 0.973 Test Loss: 0.517 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 3.406153917312622
Epoch: 28, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.625 Vali Acc: 0.971 Test Loss: 0.625 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 3.5411911010742188
Epoch: 29, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.742 Vali Acc: 0.970 Test Loss: 0.742 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 3.0116055011749268
Epoch: 30, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.898 Vali Acc: 0.967 Test Loss: 0.898 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9763231197771588
model parameter : 1553172
model size : 5.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.744844436645508
Epoch: 1, Steps: 89 | Train Loss: 1.313 Vali Loss: 0.324 Vali Acc: 0.917 Test Loss: 0.324 Test Acc: 0.917
Validation loss decreased (inf --> -0.917128).  Saving model ...
Epoch: 2 cost time: 3.114401340484619
Epoch: 2, Steps: 89 | Train Loss: 0.200 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
Validation loss decreased (-0.917128 --> -0.944288).  Saving model ...
Epoch: 3 cost time: 2.82454514503479
Epoch: 3, Steps: 89 | Train Loss: 0.130 Vali Loss: 0.160 Vali Acc: 0.957 Test Loss: 0.160 Test Acc: 0.957
Validation loss decreased (-0.944288 --> -0.956823).  Saving model ...
Epoch: 4 cost time: 3.154125452041626
Epoch: 4, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.130 Vali Acc: 0.967 Test Loss: 0.130 Test Acc: 0.967
Validation loss decreased (-0.956823 --> -0.967269).  Saving model ...
Epoch: 5 cost time: 3.1163272857666016
Epoch: 5, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.150 Vali Acc: 0.975 Test Loss: 0.150 Test Acc: 0.975
Validation loss decreased (-0.967269 --> -0.974929).  Saving model ...
Epoch: 6 cost time: 3.076894521713257
Epoch: 6, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.273 Vali Acc: 0.949 Test Loss: 0.273 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.2784595489501953
Epoch: 7, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.137 Vali Acc: 0.968 Test Loss: 0.137 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.2490978240966797
Epoch: 8, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.173 Vali Acc: 0.963 Test Loss: 0.173 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.9044151306152344
Epoch: 9, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.153 Vali Acc: 0.974 Test Loss: 0.153 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.20628023147583
Epoch: 10, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.168 Vali Acc: 0.974 Test Loss: 0.168 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.233607769012451
Epoch: 11, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.186 Vali Acc: 0.975 Test Loss: 0.186 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.14296817779541
Epoch: 12, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.234 Vali Acc: 0.972 Test Loss: 0.234 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.9790773391723633
Epoch: 13, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.151 Vali Acc: 0.981 Test Loss: 0.151 Test Acc: 0.981
Validation loss decreased (-0.974929 --> -0.981196).  Saving model ...
Epoch: 14 cost time: 2.7209157943725586
Epoch: 14, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.281 Vali Acc: 0.967 Test Loss: 0.281 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.008662462234497
Epoch: 15, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.191 Vali Acc: 0.975 Test Loss: 0.191 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.1891283988952637
Epoch: 16, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.274 Vali Acc: 0.975 Test Loss: 0.274 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.157564163208008
Epoch: 17, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.254 Vali Acc: 0.969 Test Loss: 0.254 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.220593214035034
Epoch: 18, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.205 Vali Acc: 0.977 Test Loss: 0.205 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.1915996074676514
Epoch: 19, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.382 Vali Acc: 0.966 Test Loss: 0.382 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.845170259475708
Epoch: 20, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.227 Vali Acc: 0.976 Test Loss: 0.227 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.1357622146606445
Epoch: 21, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.236 Vali Acc: 0.981 Test Loss: 0.236 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.078420639038086
Epoch: 22, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.286 Vali Acc: 0.970 Test Loss: 0.286 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.1344666481018066
Epoch: 23, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.259 Vali Acc: 0.985 Test Loss: 0.259 Test Acc: 0.985
Validation loss decreased (-0.981196 --> -0.985373).  Saving model ...
Epoch: 24 cost time: 3.2337305545806885
Epoch: 24, Steps: 89 | Train Loss: 0.131 Vali Loss: 0.325 Vali Acc: 0.969 Test Loss: 0.325 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.160902738571167
Epoch: 25, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.219 Vali Acc: 0.981 Test Loss: 0.219 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.614485502243042
Epoch: 26, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.158 Vali Acc: 0.983 Test Loss: 0.158 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.047619104385376
Epoch: 27, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.192 Vali Acc: 0.985 Test Loss: 0.192 Test Acc: 0.985
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.005704164505005
Epoch: 28, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.239 Vali Acc: 0.976 Test Loss: 0.239 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 3.1169023513793945
Epoch: 29, Steps: 89 | Train Loss: 0.133 Vali Loss: 0.217 Vali Acc: 0.971 Test Loss: 0.217 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 3.072697401046753
Epoch: 30, Steps: 89 | Train Loss: 0.132 Vali Loss: 0.325 Vali Acc: 0.981 Test Loss: 0.325 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 2.946225643157959
Epoch: 31, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.286 Vali Acc: 0.978 Test Loss: 0.286 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 2.6857597827911377
Epoch: 32, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.202 Vali Acc: 0.985 Test Loss: 0.202 Test Acc: 0.985
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 3.141583204269409
Epoch: 33, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.420 Vali Acc: 0.972 Test Loss: 0.420 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9853760445682451
model parameter : 1369492
model size : 5.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps14_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.111388921737671
Epoch: 1, Steps: 89 | Train Loss: 1.463 Vali Loss: 0.407 Vali Acc: 0.884 Test Loss: 0.407 Test Acc: 0.884
Validation loss decreased (inf --> -0.884397).  Saving model ...
Epoch: 2 cost time: 3.0258498191833496
Epoch: 2, Steps: 89 | Train Loss: 0.241 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
Validation loss decreased (-0.884397 --> -0.944288).  Saving model ...
Epoch: 3 cost time: 2.6724960803985596
Epoch: 3, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.164 Vali Acc: 0.961 Test Loss: 0.164 Test Acc: 0.961
Validation loss decreased (-0.944288 --> -0.961001).  Saving model ...
Epoch: 4 cost time: 2.1571502685546875
Epoch: 4, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.123 Vali Acc: 0.978 Test Loss: 0.123 Test Acc: 0.978
Validation loss decreased (-0.961001 --> -0.977715).  Saving model ...
Epoch: 5 cost time: 2.3044016361236572
Epoch: 5, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.139 Vali Acc: 0.962 Test Loss: 0.139 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.9201858043670654
Epoch: 6, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.183 Vali Acc: 0.967 Test Loss: 0.183 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.8924641609191895
Epoch: 7, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.108 Vali Acc: 0.983 Test Loss: 0.108 Test Acc: 0.983
Validation loss decreased (-0.977715 --> -0.982589).  Saving model ...
Epoch: 8 cost time: 2.493563652038574
Epoch: 8, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.207 Vali Acc: 0.957 Test Loss: 0.207 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.5117084980010986
Epoch: 9, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.153 Vali Acc: 0.974 Test Loss: 0.153 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.8297533988952637
Epoch: 10, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.217 Vali Acc: 0.967 Test Loss: 0.217 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.8666086196899414
Epoch: 11, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.372 Vali Acc: 0.951 Test Loss: 0.372 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.943406581878662
Epoch: 12, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.141 Vali Acc: 0.975 Test Loss: 0.141 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.7670786380767822
Epoch: 13, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.153 Vali Acc: 0.983 Test Loss: 0.153 Test Acc: 0.983
Validation loss decreased (-0.982589 --> -0.983285).  Saving model ...
Epoch: 14 cost time: 2.6435272693634033
Epoch: 14, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.162 Vali Acc: 0.978 Test Loss: 0.162 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.8903794288635254
Epoch: 15, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.122 Vali Acc: 0.984 Test Loss: 0.122 Test Acc: 0.984
Validation loss decreased (-0.983285 --> -0.983982).  Saving model ...
Epoch: 16 cost time: 3.017435312271118
Epoch: 16, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.336 Vali Acc: 0.962 Test Loss: 0.336 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.7907183170318604
Epoch: 17, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.231 Vali Acc: 0.974 Test Loss: 0.231 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.548198938369751
Epoch: 18, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.183 Vali Acc: 0.983 Test Loss: 0.183 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.7822134494781494
Epoch: 19, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.185 Vali Acc: 0.981 Test Loss: 0.185 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.828726053237915
Epoch: 20, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.248 Vali Acc: 0.978 Test Loss: 0.248 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.9409914016723633
Epoch: 21, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.307 Vali Acc: 0.969 Test Loss: 0.307 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.02325177192688
Epoch: 22, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.173 Vali Acc: 0.980 Test Loss: 0.173 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.7536723613739014
Epoch: 23, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.265 Vali Acc: 0.977 Test Loss: 0.265 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.611341714859009
Epoch: 24, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.319 Vali Acc: 0.978 Test Loss: 0.319 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.943981647491455
Epoch: 25, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.197 Vali Acc: 0.980 Test Loss: 0.197 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps14_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.983983286908078
model parameter : 1293204
model size : 4.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps19_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.005143880844116
Epoch: 1, Steps: 89 | Train Loss: 1.578 Vali Loss: 0.439 Vali Acc: 0.882 Test Loss: 0.439 Test Acc: 0.882
Validation loss decreased (inf --> -0.882308).  Saving model ...
Epoch: 2 cost time: 2.8656976222991943
Epoch: 2, Steps: 89 | Train Loss: 0.259 Vali Loss: 0.176 Vali Acc: 0.958 Test Loss: 0.176 Test Acc: 0.958
Validation loss decreased (-0.882308 --> -0.958216).  Saving model ...
Epoch: 3 cost time: 2.8643922805786133
Epoch: 3, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.132 Vali Acc: 0.965 Test Loss: 0.132 Test Acc: 0.965
Validation loss decreased (-0.958216 --> -0.965180).  Saving model ...
Epoch: 4 cost time: 2.8032069206237793
Epoch: 4, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.123 Vali Acc: 0.969 Test Loss: 0.123 Test Acc: 0.969
Validation loss decreased (-0.965180 --> -0.969358).  Saving model ...
Epoch: 5 cost time: 2.7889022827148438
Epoch: 5, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.100 Vali Acc: 0.971 Test Loss: 0.100 Test Acc: 0.971
Validation loss decreased (-0.969358 --> -0.971447).  Saving model ...
Epoch: 6 cost time: 2.898883104324341
Epoch: 6, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.087 Vali Acc: 0.981 Test Loss: 0.087 Test Acc: 0.981
Validation loss decreased (-0.971447 --> -0.981197).  Saving model ...
Epoch: 7 cost time: 2.9133574962615967
Epoch: 7, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.0288848876953125
Epoch: 8, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.085 Vali Acc: 0.981 Test Loss: 0.085 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.689605951309204
Epoch: 9, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.113 Vali Acc: 0.975 Test Loss: 0.113 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.8792648315429688
Epoch: 10, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.114 Vali Acc: 0.978 Test Loss: 0.114 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.8004627227783203
Epoch: 11, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.124 Vali Acc: 0.974 Test Loss: 0.124 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.898043155670166
Epoch: 12, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.242 Vali Acc: 0.952 Test Loss: 0.242 Test Acc: 0.952
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.773050308227539
Epoch: 13, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.118 Vali Acc: 0.979 Test Loss: 0.118 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.5456767082214355
Epoch: 14, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.155 Vali Acc: 0.971 Test Loss: 0.155 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.45825457572937
Epoch: 15, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.243 Vali Acc: 0.966 Test Loss: 0.243 Test Acc: 0.966
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.799978256225586
Epoch: 16, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.191 Vali Acc: 0.968 Test Loss: 0.191 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps19_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9811977715877437
model parameter : 1232404
model size : 4.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps28_str14_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.7409188747406006
Epoch: 1, Steps: 89 | Train Loss: 1.715 Vali Loss: 0.518 Vali Acc: 0.870 Test Loss: 0.518 Test Acc: 0.870
Validation loss decreased (inf --> -0.869772).  Saving model ...
Epoch: 2 cost time: 2.7688238620758057
Epoch: 2, Steps: 89 | Train Loss: 0.299 Vali Loss: 0.159 Vali Acc: 0.961 Test Loss: 0.159 Test Acc: 0.961
Validation loss decreased (-0.869772 --> -0.961001).  Saving model ...
Epoch: 3 cost time: 2.6585309505462646
Epoch: 3, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.102 Vali Acc: 0.979 Test Loss: 0.102 Test Acc: 0.979
Validation loss decreased (-0.961001 --> -0.979108).  Saving model ...
Epoch: 4 cost time: 2.461590051651001
Epoch: 4, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.085 Vali Acc: 0.978 Test Loss: 0.085 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.3668622970581055
Epoch: 5, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.057 Vali Acc: 0.985 Test Loss: 0.057 Test Acc: 0.985
Validation loss decreased (-0.979108 --> -0.984679).  Saving model ...
Epoch: 6 cost time: 2.738779067993164
Epoch: 6, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.099 Vali Acc: 0.976 Test Loss: 0.099 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.4662275314331055
Epoch: 7, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.162 Vali Acc: 0.960 Test Loss: 0.162 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.578795909881592
Epoch: 8, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.079 Vali Acc: 0.981 Test Loss: 0.079 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.396043300628662
Epoch: 9, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.092 Vali Acc: 0.981 Test Loss: 0.092 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.112769603729248
Epoch: 10, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.131 Vali Acc: 0.976 Test Loss: 0.131 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.3174169063568115
Epoch: 11, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.205 Vali Acc: 0.955 Test Loss: 0.205 Test Acc: 0.955
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.5224790573120117
Epoch: 12, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.126 Vali Acc: 0.974 Test Loss: 0.126 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.54864239692688
Epoch: 13, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.183 Vali Acc: 0.962 Test Loss: 0.183 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.53961443901062
Epoch: 14, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.115 Vali Acc: 0.978 Test Loss: 0.115 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.5368518829345703
Epoch: 15, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.136 Vali Acc: 0.970 Test Loss: 0.136 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps28_str14_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9846796657381616
model parameter : 1202836
model size : 4.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps37_str19_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.6797935962677
Epoch: 1, Steps: 89 | Train Loss: 1.866 Vali Loss: 0.670 Vali Acc: 0.832 Test Loss: 0.670 Test Acc: 0.832
Validation loss decreased (inf --> -0.832166).  Saving model ...
Epoch: 2 cost time: 2.555964946746826
Epoch: 2, Steps: 89 | Train Loss: 0.371 Vali Loss: 0.224 Vali Acc: 0.942 Test Loss: 0.224 Test Acc: 0.942
Validation loss decreased (-0.832166 --> -0.941502).  Saving model ...
Epoch: 3 cost time: 2.7636666297912598
Epoch: 3, Steps: 89 | Train Loss: 0.139 Vali Loss: 0.130 Vali Acc: 0.968 Test Loss: 0.130 Test Acc: 0.968
Validation loss decreased (-0.941502 --> -0.967965).  Saving model ...
Epoch: 4 cost time: 2.672109365463257
Epoch: 4, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.110 Vali Acc: 0.976 Test Loss: 0.110 Test Acc: 0.976
Validation loss decreased (-0.967965 --> -0.976322).  Saving model ...
Epoch: 5 cost time: 2.8911948204040527
Epoch: 5, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.085 Vali Acc: 0.981 Test Loss: 0.085 Test Acc: 0.981
Validation loss decreased (-0.976322 --> -0.980501).  Saving model ...
Epoch: 6 cost time: 2.7237842082977295
Epoch: 6, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.745192289352417
Epoch: 7, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.071 Vali Acc: 0.985 Test Loss: 0.071 Test Acc: 0.985
Validation loss decreased (-0.980501 --> -0.984679).  Saving model ...
Epoch: 8 cost time: 2.6603987216949463
Epoch: 8, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.096 Vali Acc: 0.972 Test Loss: 0.096 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.5796172618865967
Epoch: 9, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.088 Vali Acc: 0.978 Test Loss: 0.088 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.5260860919952393
Epoch: 10, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.157 Vali Acc: 0.965 Test Loss: 0.157 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.516261577606201
Epoch: 11, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.119 Vali Acc: 0.974 Test Loss: 0.119 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.702697277069092
Epoch: 12, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.166 Vali Acc: 0.964 Test Loss: 0.166 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.815725564956665
Epoch: 13, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.106 Vali Acc: 0.974 Test Loss: 0.106 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.6742873191833496
Epoch: 14, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.174 Vali Acc: 0.956 Test Loss: 0.174 Test Acc: 0.956
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.6799795627593994
Epoch: 15, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.148 Vali Acc: 0.974 Test Loss: 0.148 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.80088472366333
Epoch: 16, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.167 Vali Acc: 0.969 Test Loss: 0.167 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.7368059158325195
Epoch: 17, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.123 Vali Acc: 0.975 Test Loss: 0.123 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps37_str19_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9846796657381616
model parameter : 1173268
model size : 4.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps46_str23_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.6820743083953857
Epoch: 1, Steps: 89 | Train Loss: 1.950 Vali Loss: 0.724 Vali Acc: 0.838 Test Loss: 0.724 Test Acc: 0.838
Validation loss decreased (inf --> -0.838433).  Saving model ...
Epoch: 2 cost time: 2.7732579708099365
Epoch: 2, Steps: 89 | Train Loss: 0.424 Vali Loss: 0.243 Vali Acc: 0.944 Test Loss: 0.243 Test Acc: 0.944
Validation loss decreased (-0.838433 --> -0.943591).  Saving model ...
Epoch: 3 cost time: 2.738581895828247
Epoch: 3, Steps: 89 | Train Loss: 0.150 Vali Loss: 0.135 Vali Acc: 0.966 Test Loss: 0.135 Test Acc: 0.966
Validation loss decreased (-0.943591 --> -0.965876).  Saving model ...
Epoch: 4 cost time: 2.570366382598877
Epoch: 4, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.102 Vali Acc: 0.975 Test Loss: 0.102 Test Acc: 0.975
Validation loss decreased (-0.965876 --> -0.974929).  Saving model ...
Epoch: 5 cost time: 2.526294708251953
Epoch: 5, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.974929 --> -0.977019).  Saving model ...
Epoch: 6 cost time: 2.593168020248413
Epoch: 6, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
Validation loss decreased (-0.977019 --> -0.982590).  Saving model ...
Epoch: 7 cost time: 2.4241108894348145
Epoch: 7, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.106 Vali Acc: 0.979 Test Loss: 0.106 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.7228593826293945
Epoch: 8, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.091 Vali Acc: 0.979 Test Loss: 0.091 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.649503469467163
Epoch: 9, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.066 Vali Acc: 0.981 Test Loss: 0.066 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.6143205165863037
Epoch: 10, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.078 Vali Acc: 0.976 Test Loss: 0.078 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.756121873855591
Epoch: 11, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.722795009613037
Epoch: 12, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.123 Vali Acc: 0.969 Test Loss: 0.123 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.6759305000305176
Epoch: 13, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.5402016639709473
Epoch: 14, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.069 Vali Acc: 0.985 Test Loss: 0.069 Test Acc: 0.985
Validation loss decreased (-0.982590 --> -0.985375).  Saving model ...
Epoch: 15 cost time: 2.7223148345947266
Epoch: 15, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.108 Vali Acc: 0.979 Test Loss: 0.108 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.8148934841156006
Epoch: 16, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.333 Vali Acc: 0.942 Test Loss: 0.333 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.808683395385742
Epoch: 17, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.147 Vali Acc: 0.971 Test Loss: 0.147 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.89699125289917
Epoch: 18, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.152 Vali Acc: 0.970 Test Loss: 0.152 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.710662364959717
Epoch: 19, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.168 Vali Acc: 0.962 Test Loss: 0.168 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.680042028427124
Epoch: 20, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.074 Vali Acc: 0.981 Test Loss: 0.074 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.785109519958496
Epoch: 21, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.155 Vali Acc: 0.979 Test Loss: 0.155 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.663466691970825
Epoch: 22, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.157 Vali Acc: 0.978 Test Loss: 0.157 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.6044797897338867
Epoch: 23, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.130 Vali Acc: 0.976 Test Loss: 0.130 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.7540180683135986
Epoch: 24, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.188 Vali Acc: 0.976 Test Loss: 0.188 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr2_ps46_str23_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9853760445682451
model parameter : 1159060
model size : 4.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.2707390785217285
Epoch: 1, Steps: 89 | Train Loss: 1.463 Vali Loss: 0.416 Vali Acc: 0.892 Test Loss: 0.416 Test Acc: 0.892
Validation loss decreased (inf --> -0.892057).  Saving model ...
Epoch: 2 cost time: 2.0108752250671387
Epoch: 2, Steps: 89 | Train Loss: 0.244 Vali Loss: 0.229 Vali Acc: 0.940 Test Loss: 0.229 Test Acc: 0.940
Validation loss decreased (-0.892057 --> -0.940109).  Saving model ...
Epoch: 3 cost time: 2.3290038108825684
Epoch: 3, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.188 Vali Acc: 0.949 Test Loss: 0.188 Test Acc: 0.949
Validation loss decreased (-0.940109 --> -0.949162).  Saving model ...
Epoch: 4 cost time: 2.3333442211151123
Epoch: 4, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.201 Vali Acc: 0.953 Test Loss: 0.201 Test Acc: 0.953
Validation loss decreased (-0.949162 --> -0.952644).  Saving model ...
Epoch: 5 cost time: 2.3175852298736572
Epoch: 5, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.204 Vali Acc: 0.962 Test Loss: 0.204 Test Acc: 0.962
Validation loss decreased (-0.952644 --> -0.962394).  Saving model ...
Epoch: 6 cost time: 2.3992316722869873
Epoch: 6, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.139 Vali Acc: 0.969 Test Loss: 0.139 Test Acc: 0.969
Validation loss decreased (-0.962394 --> -0.969358).  Saving model ...
Epoch: 7 cost time: 2.0508201122283936
Epoch: 7, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.128 Vali Acc: 0.975 Test Loss: 0.128 Test Acc: 0.975
Validation loss decreased (-0.969358 --> -0.974929).  Saving model ...
Epoch: 8 cost time: 2.2215089797973633
Epoch: 8, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.280 Vali Acc: 0.953 Test Loss: 0.280 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.5027916431427
Epoch: 9, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.182 Vali Acc: 0.970 Test Loss: 0.182 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.443089723587036
Epoch: 10, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.202 Vali Acc: 0.963 Test Loss: 0.202 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.4091904163360596
Epoch: 11, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.218 Vali Acc: 0.968 Test Loss: 0.218 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.227792263031006
Epoch: 12, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.170 Vali Acc: 0.977 Test Loss: 0.170 Test Acc: 0.977
Validation loss decreased (-0.974929 --> -0.977018).  Saving model ...
Epoch: 13 cost time: 2.4762895107269287
Epoch: 13, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.218 Vali Acc: 0.970 Test Loss: 0.218 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.456455945968628
Epoch: 14, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.151 Vali Acc: 0.981 Test Loss: 0.151 Test Acc: 0.981
Validation loss decreased (-0.977018 --> -0.980500).  Saving model ...
Epoch: 15 cost time: 2.298452854156494
Epoch: 15, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.227 Vali Acc: 0.969 Test Loss: 0.227 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.2264652252197266
Epoch: 16, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.211 Vali Acc: 0.969 Test Loss: 0.211 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.2819931507110596
Epoch: 17, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.201 Vali Acc: 0.969 Test Loss: 0.201 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.3563899993896484
Epoch: 18, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.307 Vali Acc: 0.964 Test Loss: 0.307 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.0680887699127197
Epoch: 19, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.423 Vali Acc: 0.948 Test Loss: 0.423 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.3270249366760254
Epoch: 20, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.224 Vali Acc: 0.977 Test Loss: 0.224 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.187211751937866
Epoch: 21, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.242 Vali Acc: 0.973 Test Loss: 0.242 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.286517858505249
Epoch: 22, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.249 Vali Acc: 0.979 Test Loss: 0.249 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.254239082336426
Epoch: 23, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.237 Vali Acc: 0.977 Test Loss: 0.237 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.167067766189575
Epoch: 24, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.267 Vali Acc: 0.971 Test Loss: 0.267 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9805013927576601
model parameter : 514452
model size : 2.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.6523685455322266
Epoch: 1, Steps: 89 | Train Loss: 1.732 Vali Loss: 0.527 Vali Acc: 0.853 Test Loss: 0.527 Test Acc: 0.853
Validation loss decreased (inf --> -0.853059).  Saving model ...
Epoch: 2 cost time: 1.775780439376831
Epoch: 2, Steps: 89 | Train Loss: 0.303 Vali Loss: 0.201 Vali Acc: 0.948 Test Loss: 0.201 Test Acc: 0.948
Validation loss decreased (-0.853059 --> -0.947770).  Saving model ...
Epoch: 3 cost time: 1.6503658294677734
Epoch: 3, Steps: 89 | Train Loss: 0.131 Vali Loss: 0.130 Vali Acc: 0.964 Test Loss: 0.130 Test Acc: 0.964
Validation loss decreased (-0.947770 --> -0.963787).  Saving model ...
Epoch: 4 cost time: 2.091390371322632
Epoch: 4, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.122 Vali Acc: 0.971 Test Loss: 0.122 Test Acc: 0.971
Validation loss decreased (-0.963787 --> -0.971447).  Saving model ...
Epoch: 5 cost time: 2.107966423034668
Epoch: 5, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.105 Vali Acc: 0.976 Test Loss: 0.105 Test Acc: 0.976
Validation loss decreased (-0.971447 --> -0.976322).  Saving model ...
Epoch: 6 cost time: 2.0776569843292236
Epoch: 6, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.207 Vali Acc: 0.953 Test Loss: 0.207 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.0405142307281494
Epoch: 7, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.113 Vali Acc: 0.975 Test Loss: 0.113 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.8532345294952393
Epoch: 8, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.136 Vali Acc: 0.969 Test Loss: 0.136 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.006401538848877
Epoch: 9, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.129 Vali Acc: 0.978 Test Loss: 0.129 Test Acc: 0.978
Validation loss decreased (-0.976322 --> -0.977715).  Saving model ...
Epoch: 10 cost time: 1.8547358512878418
Epoch: 10, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.151 Vali Acc: 0.969 Test Loss: 0.151 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.4949848651885986
Epoch: 11, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.181 Vali Acc: 0.966 Test Loss: 0.181 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.4505324363708496
Epoch: 12, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.166 Vali Acc: 0.976 Test Loss: 0.166 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.2672934532165527
Epoch: 13, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.134 Vali Acc: 0.980 Test Loss: 0.134 Test Acc: 0.980
Validation loss decreased (-0.977715 --> -0.979804).  Saving model ...
Epoch: 14 cost time: 2.154951810836792
Epoch: 14, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.215 Vali Acc: 0.969 Test Loss: 0.215 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.437765598297119
Epoch: 15, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.144 Vali Acc: 0.976 Test Loss: 0.144 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.1976475715637207
Epoch: 16, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.190 Vali Acc: 0.971 Test Loss: 0.190 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.044316291809082
Epoch: 17, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.156 Vali Acc: 0.976 Test Loss: 0.156 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.9674468040466309
Epoch: 18, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.217 Vali Acc: 0.962 Test Loss: 0.217 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.301694631576538
Epoch: 19, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.153 Vali Acc: 0.981 Test Loss: 0.153 Test Acc: 0.981
Validation loss decreased (-0.979804 --> -0.980500).  Saving model ...
Epoch: 20 cost time: 2.261246919631958
Epoch: 20, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.133 Vali Acc: 0.983 Test Loss: 0.133 Test Acc: 0.983
Validation loss decreased (-0.980500 --> -0.982589).  Saving model ...
Epoch: 21 cost time: 2.321135997772217
Epoch: 21, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.127 Vali Acc: 0.984 Test Loss: 0.127 Test Acc: 0.984
Validation loss decreased (-0.982589 --> -0.983982).  Saving model ...
Epoch: 22 cost time: 2.284411668777466
Epoch: 22, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.128 Vali Acc: 0.984 Test Loss: 0.128 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.2667906284332275
Epoch: 23, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.134 Vali Acc: 0.983 Test Loss: 0.134 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.2672908306121826
Epoch: 24, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.132 Vali Acc: 0.984 Test Loss: 0.132 Test Acc: 0.984
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.8593556880950928
Epoch: 25, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.142 Vali Acc: 0.985 Test Loss: 0.142 Test Acc: 0.985
Validation loss decreased (-0.983982 --> -0.984678).  Saving model ...
Epoch: 26 cost time: 1.879568338394165
Epoch: 26, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.137 Vali Acc: 0.985 Test Loss: 0.137 Test Acc: 0.985
Validation loss decreased (-0.984678 --> -0.985375).  Saving model ...
Epoch: 27 cost time: 2.2792632579803467
Epoch: 27, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.134 Vali Acc: 0.985 Test Loss: 0.134 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.4011030197143555
Epoch: 28, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.134 Vali Acc: 0.985 Test Loss: 0.134 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.336003303527832
Epoch: 29, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.130 Vali Acc: 0.986 Test Loss: 0.130 Test Acc: 0.986
Validation loss decreased (-0.985375 --> -0.986071).  Saving model ...
Epoch: 30 cost time: 2.075843095779419
Epoch: 30, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.137 Vali Acc: 0.985 Test Loss: 0.137 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.444305181503296
Epoch: 31, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.133 Vali Acc: 0.985 Test Loss: 0.133 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.3581526279449463
Epoch: 32, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.134 Vali Acc: 0.985 Test Loss: 0.134 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 2.2961032390594482
Epoch: 33, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.135 Vali Acc: 0.986 Test Loss: 0.135 Test Acc: 0.986
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 2.3206801414489746
Epoch: 34, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.137 Vali Acc: 0.986 Test Loss: 0.137 Test Acc: 0.986
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.8981096744537354
Epoch: 35, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.136 Vali Acc: 0.986 Test Loss: 0.136 Test Acc: 0.986
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 2.43190598487854
Epoch: 36, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.137 Vali Acc: 0.986 Test Loss: 0.137 Test Acc: 0.986
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 2.4252045154571533
Epoch: 37, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.135 Vali Acc: 0.986 Test Loss: 0.135 Test Acc: 0.986
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 2.4301884174346924
Epoch: 38, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.136 Vali Acc: 0.986 Test Loss: 0.136 Test Acc: 0.986
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 2.4004290103912354
Epoch: 39, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.137 Vali Acc: 0.985 Test Loss: 0.137 Test Acc: 0.985
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9860724233983287
model parameter : 422612
model size : 1.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps14_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.293794631958008
Epoch: 1, Steps: 89 | Train Loss: 1.836 Vali Loss: 0.606 Vali Acc: 0.847 Test Loss: 0.606 Test Acc: 0.847
Validation loss decreased (inf --> -0.846791).  Saving model ...
Epoch: 2 cost time: 2.308837890625
Epoch: 2, Steps: 89 | Train Loss: 0.355 Vali Loss: 0.238 Vali Acc: 0.937 Test Loss: 0.238 Test Acc: 0.937
Validation loss decreased (-0.846791 --> -0.937324).  Saving model ...
Epoch: 3 cost time: 2.2871150970458984
Epoch: 3, Steps: 89 | Train Loss: 0.149 Vali Loss: 0.131 Vali Acc: 0.969 Test Loss: 0.131 Test Acc: 0.969
Validation loss decreased (-0.937324 --> -0.969358).  Saving model ...
Epoch: 4 cost time: 1.9675281047821045
Epoch: 4, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.126 Vali Acc: 0.969 Test Loss: 0.126 Test Acc: 0.969
Validation loss decreased (-0.969358 --> -0.969358).  Saving model ...
Epoch: 5 cost time: 1.939178466796875
Epoch: 5, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.108 Vali Acc: 0.975 Test Loss: 0.108 Test Acc: 0.975
Validation loss decreased (-0.969358 --> -0.974929).  Saving model ...
Epoch: 6 cost time: 2.291858673095703
Epoch: 6, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.097 Vali Acc: 0.976 Test Loss: 0.097 Test Acc: 0.976
Validation loss decreased (-0.974929 --> -0.976322).  Saving model ...
Epoch: 7 cost time: 2.4101169109344482
Epoch: 7, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.337179660797119
Epoch: 8, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.088 Vali Acc: 0.978 Test Loss: 0.088 Test Acc: 0.978
Validation loss decreased (-0.976322 --> -0.977715).  Saving model ...
Epoch: 9 cost time: 2.1338562965393066
Epoch: 9, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.089 Vali Acc: 0.978 Test Loss: 0.089 Test Acc: 0.978
Validation loss decreased (-0.977715 --> -0.978411).  Saving model ...
Epoch: 10 cost time: 2.0751748085021973
Epoch: 10, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.094 Vali Acc: 0.985 Test Loss: 0.094 Test Acc: 0.985
Validation loss decreased (-0.978411 --> -0.984679).  Saving model ...
Epoch: 11 cost time: 2.3079981803894043
Epoch: 11, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.086 Vali Acc: 0.981 Test Loss: 0.086 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.282432794570923
Epoch: 12, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.068 Vali Acc: 0.985 Test Loss: 0.068 Test Acc: 0.985
Validation loss decreased (-0.984679 --> -0.985375).  Saving model ...
Epoch: 13 cost time: 2.456294298171997
Epoch: 13, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.217 Vali Acc: 0.953 Test Loss: 0.217 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.2117247581481934
Epoch: 14, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.184 Vali Acc: 0.978 Test Loss: 0.184 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.0419936180114746
Epoch: 15, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.207 Vali Acc: 0.959 Test Loss: 0.207 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.4428651332855225
Epoch: 16, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.117 Vali Acc: 0.980 Test Loss: 0.117 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.4782848358154297
Epoch: 17, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.219 Vali Acc: 0.972 Test Loss: 0.219 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.455934524536133
Epoch: 18, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.526486396789551
Epoch: 19, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.126 Vali Acc: 0.982 Test Loss: 0.126 Test Acc: 0.982
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.095646858215332
Epoch: 20, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.093 Vali Acc: 0.985 Test Loss: 0.093 Test Acc: 0.985
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.4228944778442383
Epoch: 21, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.124 Vali Acc: 0.981 Test Loss: 0.124 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.5241761207580566
Epoch: 22, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.159 Vali Acc: 0.974 Test Loss: 0.159 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps14_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9853760445682451
model parameter : 384468
model size : 1.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps19_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.19265079498291
Epoch: 1, Steps: 89 | Train Loss: 2.087 Vali Loss: 0.811 Vali Acc: 0.828 Test Loss: 0.811 Test Acc: 0.828
Validation loss decreased (inf --> -0.827986).  Saving model ...
Epoch: 2 cost time: 2.0983495712280273
Epoch: 2, Steps: 89 | Train Loss: 0.448 Vali Loss: 0.258 Vali Acc: 0.940 Test Loss: 0.258 Test Acc: 0.940
Validation loss decreased (-0.827986 --> -0.940109).  Saving model ...
Epoch: 3 cost time: 2.086820125579834
Epoch: 3, Steps: 89 | Train Loss: 0.156 Vali Loss: 0.142 Vali Acc: 0.972 Test Loss: 0.142 Test Acc: 0.972
Validation loss decreased (-0.940109 --> -0.972143).  Saving model ...
Epoch: 4 cost time: 2.466608762741089
Epoch: 4, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.104 Vali Acc: 0.976 Test Loss: 0.104 Test Acc: 0.976
Validation loss decreased (-0.972143 --> -0.975626).  Saving model ...
Epoch: 5 cost time: 2.0693862438201904
Epoch: 5, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.975626 --> -0.979804).  Saving model ...
Epoch: 6 cost time: 2.1561670303344727
Epoch: 6, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.076 Vali Acc: 0.981 Test Loss: 0.076 Test Acc: 0.981
Validation loss decreased (-0.979804 --> -0.980501).  Saving model ...
Epoch: 7 cost time: 2.289700746536255
Epoch: 7, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.083 Vali Acc: 0.981 Test Loss: 0.083 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.4339284896850586
Epoch: 8, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.087 Vali Acc: 0.979 Test Loss: 0.087 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.3811347484588623
Epoch: 9, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.2320046424865723
Epoch: 10, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.073 Vali Acc: 0.984 Test Loss: 0.073 Test Acc: 0.984
Validation loss decreased (-0.980501 --> -0.983983).  Saving model ...
Epoch: 11 cost time: 2.505227565765381
Epoch: 11, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.110 Vali Acc: 0.976 Test Loss: 0.110 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.439336061477661
Epoch: 12, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.092 Vali Acc: 0.978 Test Loss: 0.092 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.528197765350342
Epoch: 13, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.148 Vali Acc: 0.964 Test Loss: 0.148 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.5960426330566406
Epoch: 14, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.105 Vali Acc: 0.979 Test Loss: 0.105 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.27997088432312
Epoch: 15, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.096 Vali Acc: 0.981 Test Loss: 0.096 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.539618730545044
Epoch: 16, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.125 Vali Acc: 0.982 Test Loss: 0.125 Test Acc: 0.982
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.470766067504883
Epoch: 17, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.098 Vali Acc: 0.984 Test Loss: 0.098 Test Acc: 0.984
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.5586910247802734
Epoch: 18, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.083 Vali Acc: 0.984 Test Loss: 0.083 Test Acc: 0.984
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.449594259262085
Epoch: 19, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.112 Vali Acc: 0.985 Test Loss: 0.112 Test Acc: 0.985
Validation loss decreased (-0.983983 --> -0.984679).  Saving model ...
Epoch: 20 cost time: 2.210115432739258
Epoch: 20, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.128 Vali Acc: 0.979 Test Loss: 0.128 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.0949366092681885
Epoch: 21, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.100 Vali Acc: 0.985 Test Loss: 0.100 Test Acc: 0.985
Validation loss decreased (-0.984679 --> -0.985375).  Saving model ...
Epoch: 22 cost time: 2.2489559650421143
Epoch: 22, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.093 Vali Acc: 0.983 Test Loss: 0.093 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.5769243240356445
Epoch: 23, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.121 Vali Acc: 0.981 Test Loss: 0.121 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.3603310585021973
Epoch: 24, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.106 Vali Acc: 0.981 Test Loss: 0.106 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.219298839569092
Epoch: 25, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.154 Vali Acc: 0.978 Test Loss: 0.154 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.8782992362976074
Epoch: 26, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.223 Vali Acc: 0.958 Test Loss: 0.223 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.783815860748291
Epoch: 27, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.150 Vali Acc: 0.978 Test Loss: 0.150 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.8174903392791748
Epoch: 28, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.122 Vali Acc: 0.983 Test Loss: 0.122 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.338397741317749
Epoch: 29, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.164 Vali Acc: 0.983 Test Loss: 0.164 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 2.539261817932129
Epoch: 30, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.131 Vali Acc: 0.982 Test Loss: 0.131 Test Acc: 0.982
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 2.4450414180755615
Epoch: 31, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.147 Vali Acc: 0.983 Test Loss: 0.147 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps19_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9853760445682451
model parameter : 354068
model size : 1.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps28_str14_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.1908926963806152
Epoch: 1, Steps: 89 | Train Loss: 2.238 Vali Loss: 0.983 Vali Acc: 0.816 Test Loss: 0.983 Test Acc: 0.816
Validation loss decreased (inf --> -0.816146).  Saving model ...
Epoch: 2 cost time: 2.2024075984954834
Epoch: 2, Steps: 89 | Train Loss: 0.545 Vali Loss: 0.320 Vali Acc: 0.919 Test Loss: 0.320 Test Acc: 0.919
Validation loss decreased (-0.816146 --> -0.919217).  Saving model ...
Epoch: 3 cost time: 2.5205557346343994
Epoch: 3, Steps: 89 | Train Loss: 0.210 Vali Loss: 0.174 Vali Acc: 0.955 Test Loss: 0.174 Test Acc: 0.955
Validation loss decreased (-0.919217 --> -0.954734).  Saving model ...
Epoch: 4 cost time: 2.105408191680908
Epoch: 4, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.112 Vali Acc: 0.972 Test Loss: 0.112 Test Acc: 0.972
Validation loss decreased (-0.954734 --> -0.972144).  Saving model ...
Epoch: 5 cost time: 2.198838233947754
Epoch: 5, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.101 Vali Acc: 0.974 Test Loss: 0.101 Test Acc: 0.974
Validation loss decreased (-0.972144 --> -0.973537).  Saving model ...
Epoch: 6 cost time: 2.2685067653656006
Epoch: 6, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.069 Vali Acc: 0.985 Test Loss: 0.069 Test Acc: 0.985
Validation loss decreased (-0.973537 --> -0.984679).  Saving model ...
Epoch: 7 cost time: 2.277848482131958
Epoch: 7, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.065 Vali Acc: 0.985 Test Loss: 0.065 Test Acc: 0.985
Validation loss decreased (-0.984679 --> -0.984679).  Saving model ...
Epoch: 8 cost time: 2.0400421619415283
Epoch: 8, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8821475505828857
Epoch: 9, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.057 Vali Acc: 0.985 Test Loss: 0.057 Test Acc: 0.985
Validation loss decreased (-0.984679 --> -0.984679).  Saving model ...
Epoch: 10 cost time: 1.9436910152435303
Epoch: 10, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.056 Vali Acc: 0.984 Test Loss: 0.056 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.909844160079956
Epoch: 11, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.077 Vali Acc: 0.981 Test Loss: 0.077 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.215721607208252
Epoch: 12, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.3107151985168457
Epoch: 13, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.9766101837158203
Epoch: 14, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.3865644931793213
Epoch: 15, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.091 Vali Acc: 0.982 Test Loss: 0.091 Test Acc: 0.982
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.330404758453369
Epoch: 16, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.4300482273101807
Epoch: 17, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.165 Vali Acc: 0.966 Test Loss: 0.165 Test Acc: 0.966
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.150364637374878
Epoch: 18, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.088 Vali Acc: 0.985 Test Loss: 0.088 Test Acc: 0.985
Validation loss decreased (-0.984679 --> -0.985375).  Saving model ...
Epoch: 19 cost time: 2.121572256088257
Epoch: 19, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.137 Vali Acc: 0.980 Test Loss: 0.137 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.2650563716888428
Epoch: 20, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.117 Vali Acc: 0.978 Test Loss: 0.117 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.1862945556640625
Epoch: 21, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.092 Vali Acc: 0.983 Test Loss: 0.092 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.2835354804992676
Epoch: 22, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.095 Vali Acc: 0.975 Test Loss: 0.095 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.1507980823516846
Epoch: 23, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.087 Vali Acc: 0.987 Test Loss: 0.087 Test Acc: 0.987
Validation loss decreased (-0.985375 --> -0.987464).  Saving model ...
Epoch: 24 cost time: 2.2584502696990967
Epoch: 24, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.083 Vali Acc: 0.986 Test Loss: 0.083 Test Acc: 0.986
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.2271676063537598
Epoch: 25, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.076 Vali Acc: 0.987 Test Loss: 0.076 Test Acc: 0.987
Validation loss decreased (-0.987464 --> -0.987464).  Saving model ...
Epoch: 26 cost time: 2.3218257427215576
Epoch: 26, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.156 Vali Acc: 0.967 Test Loss: 0.156 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.240278482437134
Epoch: 27, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.182 Vali Acc: 0.977 Test Loss: 0.182 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.9749372005462646
Epoch: 28, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.110 Vali Acc: 0.981 Test Loss: 0.110 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.3114516735076904
Epoch: 29, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.099 Vali Acc: 0.985 Test Loss: 0.099 Test Acc: 0.985
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.0465664863586426
Epoch: 30, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.115 Vali Acc: 0.984 Test Loss: 0.115 Test Acc: 0.984
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 2.0023560523986816
Epoch: 31, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.175 Vali Acc: 0.973 Test Loss: 0.175 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 2.26200008392334
Epoch: 32, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.121 Vali Acc: 0.985 Test Loss: 0.121 Test Acc: 0.985
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.9994697570800781
Epoch: 33, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.169 Vali Acc: 0.974 Test Loss: 0.169 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 2.2979652881622314
Epoch: 34, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.118 Vali Acc: 0.982 Test Loss: 0.118 Test Acc: 0.982
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 2.238027334213257
Epoch: 35, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.193 Vali Acc: 0.978 Test Loss: 0.193 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps28_str14_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9874651810584958
model parameter : 339284
model size : 1.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps37_str19_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.2923929691314697
Epoch: 1, Steps: 89 | Train Loss: 2.305 Vali Loss: 1.253 Vali Acc: 0.792 Test Loss: 1.253 Test Acc: 0.792
Validation loss decreased (inf --> -0.792467).  Saving model ...
Epoch: 2 cost time: 2.3696742057800293
Epoch: 2, Steps: 89 | Train Loss: 0.675 Vali Loss: 0.393 Vali Acc: 0.905 Test Loss: 0.393 Test Acc: 0.905
Validation loss decreased (-0.792467 --> -0.905289).  Saving model ...
Epoch: 3 cost time: 2.2453975677490234
Epoch: 3, Steps: 89 | Train Loss: 0.249 Vali Loss: 0.224 Vali Acc: 0.934 Test Loss: 0.224 Test Acc: 0.934
Validation loss decreased (-0.905289 --> -0.933842).  Saving model ...
Epoch: 4 cost time: 2.574437379837036
Epoch: 4, Steps: 89 | Train Loss: 0.123 Vali Loss: 0.115 Vali Acc: 0.975 Test Loss: 0.115 Test Acc: 0.975
Validation loss decreased (-0.933842 --> -0.974929).  Saving model ...
Epoch: 5 cost time: 2.071836471557617
Epoch: 5, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.126 Vali Acc: 0.965 Test Loss: 0.126 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.4016058444976807
Epoch: 6, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.974929 --> -0.979804).  Saving model ...
Epoch: 7 cost time: 1.9740560054779053
Epoch: 7, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.080 Vali Acc: 0.981 Test Loss: 0.080 Test Acc: 0.981
Validation loss decreased (-0.979804 --> -0.981197).  Saving model ...
Epoch: 8 cost time: 1.9844965934753418
Epoch: 8, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.061 Vali Acc: 0.983 Test Loss: 0.061 Test Acc: 0.983
Validation loss decreased (-0.981197 --> -0.983286).  Saving model ...
Epoch: 9 cost time: 2.240349531173706
Epoch: 9, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.057 Vali Acc: 0.987 Test Loss: 0.057 Test Acc: 0.987
Validation loss decreased (-0.983286 --> -0.986768).  Saving model ...
Epoch: 10 cost time: 2.110241413116455
Epoch: 10, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.2134809494018555
Epoch: 11, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.082 Vali Acc: 0.978 Test Loss: 0.082 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.4100253582000732
Epoch: 12, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.217148542404175
Epoch: 13, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.136409044265747
Epoch: 14, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.071 Vali Acc: 0.985 Test Loss: 0.071 Test Acc: 0.985
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.2359399795532227
Epoch: 15, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.050 Vali Acc: 0.985 Test Loss: 0.050 Test Acc: 0.985
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.372205972671509
Epoch: 16, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.056 Vali Acc: 0.988 Test Loss: 0.056 Test Acc: 0.988
Validation loss decreased (-0.986768 --> -0.988161).  Saving model ...
Epoch: 17 cost time: 2.2682321071624756
Epoch: 17, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.056 Vali Acc: 0.988 Test Loss: 0.056 Test Acc: 0.988
Validation loss decreased (-0.988161 --> -0.988161).  Saving model ...
Epoch: 18 cost time: 2.088866710662842
Epoch: 18, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.059 Vali Acc: 0.984 Test Loss: 0.059 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.109363555908203
Epoch: 19, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.097 Vali Acc: 0.981 Test Loss: 0.097 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.31600022315979
Epoch: 20, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.079 Vali Acc: 0.981 Test Loss: 0.079 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.3149077892303467
Epoch: 21, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.056 Vali Acc: 0.987 Test Loss: 0.056 Test Acc: 0.987
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.2703168392181396
Epoch: 22, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.059 Vali Acc: 0.987 Test Loss: 0.059 Test Acc: 0.987
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.127772569656372
Epoch: 23, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.1785247325897217
Epoch: 24, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.063 Vali Acc: 0.989 Test Loss: 0.063 Test Acc: 0.989
Validation loss decreased (-0.988161 --> -0.988857).  Saving model ...
Epoch: 25 cost time: 1.9889357089996338
Epoch: 25, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.062 Vali Acc: 0.987 Test Loss: 0.062 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.157047748565674
Epoch: 26, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.059 Vali Acc: 0.990 Test Loss: 0.059 Test Acc: 0.990
Validation loss decreased (-0.988857 --> -0.989554).  Saving model ...
Epoch: 27 cost time: 2.341519355773926
Epoch: 27, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.060 Vali Acc: 0.987 Test Loss: 0.060 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.217630386352539
Epoch: 28, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.061 Vali Acc: 0.987 Test Loss: 0.061 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.3157567977905273
Epoch: 29, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.134 Vali Acc: 0.964 Test Loss: 0.134 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.2369444370269775
Epoch: 30, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.179 Vali Acc: 0.962 Test Loss: 0.179 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 2.3591296672821045
Epoch: 31, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.138 Vali Acc: 0.971 Test Loss: 0.138 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 2.171198844909668
Epoch: 32, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.149 Vali Acc: 0.964 Test Loss: 0.149 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 2.358765125274658
Epoch: 33, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.115 Vali Acc: 0.983 Test Loss: 0.115 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 2.2732949256896973
Epoch: 34, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.114 Vali Acc: 0.985 Test Loss: 0.114 Test Acc: 0.985
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 2.2157537937164307
Epoch: 35, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.102 Vali Acc: 0.978 Test Loss: 0.102 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 2.388646125793457
Epoch: 36, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.085 Vali Acc: 0.987 Test Loss: 0.085 Test Acc: 0.987
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps37_str19_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9895543175487466
model parameter : 324500
model size : 1.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps46_str23_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.2190821170806885
Epoch: 1, Steps: 89 | Train Loss: 2.382 Vali Loss: 1.402 Vali Acc: 0.754 Test Loss: 1.402 Test Acc: 0.754
Validation loss decreased (inf --> -0.754164).  Saving model ...
Epoch: 2 cost time: 2.2214224338531494
Epoch: 2, Steps: 89 | Train Loss: 0.790 Vali Loss: 0.459 Vali Acc: 0.895 Test Loss: 0.459 Test Acc: 0.895
Validation loss decreased (-0.754164 --> -0.894842).  Saving model ...
Epoch: 3 cost time: 2.0495166778564453
Epoch: 3, Steps: 89 | Train Loss: 0.308 Vali Loss: 0.239 Vali Acc: 0.942 Test Loss: 0.239 Test Acc: 0.942
Validation loss decreased (-0.894842 --> -0.941502).  Saving model ...
Epoch: 4 cost time: 2.2982234954833984
Epoch: 4, Steps: 89 | Train Loss: 0.150 Vali Loss: 0.143 Vali Acc: 0.962 Test Loss: 0.143 Test Acc: 0.962
Validation loss decreased (-0.941502 --> -0.962394).  Saving model ...
Epoch: 5 cost time: 2.171895742416382
Epoch: 5, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.122 Vali Acc: 0.966 Test Loss: 0.122 Test Acc: 0.966
Validation loss decreased (-0.962394 --> -0.965876).  Saving model ...
Epoch: 6 cost time: 2.1404521465301514
Epoch: 6, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.084 Vali Acc: 0.978 Test Loss: 0.084 Test Acc: 0.978
Validation loss decreased (-0.965876 --> -0.978411).  Saving model ...
Epoch: 7 cost time: 1.9361004829406738
Epoch: 7, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.101 Vali Acc: 0.973 Test Loss: 0.101 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.042577028274536
Epoch: 8, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.978411 --> -0.982590).  Saving model ...
Epoch: 9 cost time: 2.1319189071655273
Epoch: 9, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.109 Vali Acc: 0.971 Test Loss: 0.109 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.260941743850708
Epoch: 10, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.063 Vali Acc: 0.985 Test Loss: 0.063 Test Acc: 0.985
Validation loss decreased (-0.982590 --> -0.984679).  Saving model ...
Epoch: 11 cost time: 2.1031494140625
Epoch: 11, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.053 Vali Acc: 0.987 Test Loss: 0.053 Test Acc: 0.987
Validation loss decreased (-0.984679 --> -0.987465).  Saving model ...
Epoch: 12 cost time: 1.9684226512908936
Epoch: 12, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.062 Vali Acc: 0.985 Test Loss: 0.062 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.2085371017456055
Epoch: 13, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.055 Vali Acc: 0.986 Test Loss: 0.055 Test Acc: 0.986
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.224429130554199
Epoch: 14, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.102 Vali Acc: 0.972 Test Loss: 0.102 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.2634706497192383
Epoch: 15, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.106 Vali Acc: 0.976 Test Loss: 0.106 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.258470296859741
Epoch: 16, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.060 Vali Acc: 0.987 Test Loss: 0.060 Test Acc: 0.987
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.023543119430542
Epoch: 17, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.061 Vali Acc: 0.988 Test Loss: 0.061 Test Acc: 0.988
Validation loss decreased (-0.987465 --> -0.988161).  Saving model ...
Epoch: 18 cost time: 2.244818687438965
Epoch: 18, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.055 Vali Acc: 0.988 Test Loss: 0.055 Test Acc: 0.988
Validation loss decreased (-0.988161 --> -0.988161).  Saving model ...
Epoch: 19 cost time: 2.14172625541687
Epoch: 19, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.1548049449920654
Epoch: 20, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.073 Vali Acc: 0.985 Test Loss: 0.073 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.104238986968994
Epoch: 21, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.095 Vali Acc: 0.981 Test Loss: 0.095 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.129312515258789
Epoch: 22, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.116 Vali Acc: 0.969 Test Loss: 0.116 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.1594226360321045
Epoch: 23, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.2694284915924072
Epoch: 24, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.084 Vali Acc: 0.985 Test Loss: 0.084 Test Acc: 0.985
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.2015416622161865
Epoch: 25, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.067 Vali Acc: 0.987 Test Loss: 0.067 Test Acc: 0.987
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.0365781784057617
Epoch: 26, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.073 Vali Acc: 0.985 Test Loss: 0.073 Test Acc: 0.985
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.1245341300964355
Epoch: 27, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.067 Vali Acc: 0.987 Test Loss: 0.067 Test Acc: 0.987
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.133209705352783
Epoch: 28, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.984 Test Loss: 0.073 Test Acc: 0.984
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr2_ps46_str23_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9881615598885793
model parameter : 317396
model size : 1.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.692157745361328
Epoch: 1, Steps: 89 | Train Loss: 1.801 Vali Loss: 0.581 Vali Acc: 0.865 Test Loss: 0.581 Test Acc: 0.865
Validation loss decreased (inf --> -0.864897).  Saving model ...
Epoch: 2 cost time: 1.74760103225708
Epoch: 2, Steps: 89 | Train Loss: 0.324 Vali Loss: 0.197 Vali Acc: 0.955 Test Loss: 0.197 Test Acc: 0.955
Validation loss decreased (-0.864897 --> -0.955430).  Saving model ...
Epoch: 3 cost time: 1.7693073749542236
Epoch: 3, Steps: 89 | Train Loss: 0.140 Vali Loss: 0.151 Vali Acc: 0.960 Test Loss: 0.151 Test Acc: 0.960
Validation loss decreased (-0.955430 --> -0.959609).  Saving model ...
Epoch: 4 cost time: 1.9921252727508545
Epoch: 4, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.115 Vali Acc: 0.974 Test Loss: 0.115 Test Acc: 0.974
Validation loss decreased (-0.959609 --> -0.973536).  Saving model ...
Epoch: 5 cost time: 1.8726770877838135
Epoch: 5, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.148 Vali Acc: 0.965 Test Loss: 0.148 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6430764198303223
Epoch: 6, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.116 Vali Acc: 0.971 Test Loss: 0.116 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.7652034759521484
Epoch: 7, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.147 Vali Acc: 0.971 Test Loss: 0.147 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.6042580604553223
Epoch: 8, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.131 Vali Acc: 0.971 Test Loss: 0.131 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.480252742767334
Epoch: 9, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.101 Vali Acc: 0.982 Test Loss: 0.101 Test Acc: 0.982
Validation loss decreased (-0.973536 --> -0.981893).  Saving model ...
Epoch: 10 cost time: 1.5788254737854004
Epoch: 10, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.234 Vali Acc: 0.944 Test Loss: 0.234 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7311279773712158
Epoch: 11, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.138 Vali Acc: 0.979 Test Loss: 0.138 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.899209976196289
Epoch: 12, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.129 Vali Acc: 0.978 Test Loss: 0.129 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.9280989170074463
Epoch: 13, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.129 Vali Acc: 0.981 Test Loss: 0.129 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.9457190036773682
Epoch: 14, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.137 Vali Acc: 0.981 Test Loss: 0.137 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.694955587387085
Epoch: 15, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.165 Vali Acc: 0.974 Test Loss: 0.165 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.793867588043213
Epoch: 16, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.176 Vali Acc: 0.971 Test Loss: 0.176 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.9908537864685059
Epoch: 17, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.140 Vali Acc: 0.978 Test Loss: 0.140 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.8299946784973145
Epoch: 18, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.186 Vali Acc: 0.967 Test Loss: 0.186 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.852677822113037
Epoch: 19, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.167 Vali Acc: 0.976 Test Loss: 0.167 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9818941504178273
model parameter : 191700
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.035801887512207
Epoch: 1, Steps: 89 | Train Loss: 2.213 Vali Loss: 0.974 Vali Acc: 0.800 Test Loss: 0.974 Test Acc: 0.800
Validation loss decreased (inf --> -0.800130).  Saving model ...
Epoch: 2 cost time: 2.07124662399292
Epoch: 2, Steps: 89 | Train Loss: 0.519 Vali Loss: 0.300 Vali Acc: 0.921 Test Loss: 0.300 Test Acc: 0.921
Validation loss decreased (-0.800130 --> -0.920610).  Saving model ...
Epoch: 3 cost time: 1.7549364566802979
Epoch: 3, Steps: 89 | Train Loss: 0.204 Vali Loss: 0.172 Vali Acc: 0.958 Test Loss: 0.172 Test Acc: 0.958
Validation loss decreased (-0.920610 --> -0.958216).  Saving model ...
Epoch: 4 cost time: 1.8123719692230225
Epoch: 4, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.120 Vali Acc: 0.974 Test Loss: 0.120 Test Acc: 0.974
Validation loss decreased (-0.958216 --> -0.973536).  Saving model ...
Epoch: 5 cost time: 1.8500335216522217
Epoch: 5, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.112 Vali Acc: 0.969 Test Loss: 0.112 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8632733821868896
Epoch: 6, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.089 Vali Acc: 0.978 Test Loss: 0.089 Test Acc: 0.978
Validation loss decreased (-0.973536 --> -0.978411).  Saving model ...
Epoch: 7 cost time: 1.9745032787322998
Epoch: 7, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.120 Vali Acc: 0.965 Test Loss: 0.120 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.073976993560791
Epoch: 8, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.102 Vali Acc: 0.978 Test Loss: 0.102 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.865393877029419
Epoch: 9, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.032431125640869
Epoch: 10, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.090 Vali Acc: 0.978 Test Loss: 0.090 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.200662851333618
Epoch: 11, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.089 Vali Acc: 0.981 Test Loss: 0.089 Test Acc: 0.981
Validation loss decreased (-0.978411 --> -0.980501).  Saving model ...
Epoch: 12 cost time: 2.104370355606079
Epoch: 12, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
Validation loss decreased (-0.980501 --> -0.982590).  Saving model ...
Epoch: 13 cost time: 1.9935648441314697
Epoch: 13, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.7312819957733154
Epoch: 14, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.162 Vali Acc: 0.967 Test Loss: 0.162 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.1322693824768066
Epoch: 15, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.125 Vali Acc: 0.976 Test Loss: 0.125 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.9725852012634277
Epoch: 16, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.115 Vali Acc: 0.976 Test Loss: 0.115 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.0679476261138916
Epoch: 17, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.122 Vali Acc: 0.981 Test Loss: 0.122 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.067831039428711
Epoch: 18, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.117 Vali Acc: 0.978 Test Loss: 0.117 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.8657276630401611
Epoch: 19, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.147 Vali Acc: 0.976 Test Loss: 0.147 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.982588291168213
Epoch: 20, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.143 Vali Acc: 0.971 Test Loss: 0.143 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.8212401866912842
Epoch: 21, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.113 Vali Acc: 0.979 Test Loss: 0.113 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.8350064754486084
Epoch: 22, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.132 Vali Acc: 0.982 Test Loss: 0.132 Test Acc: 0.982
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9825905292479109
model parameter : 145780
model size : 0.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps14_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.753467082977295
Epoch: 1, Steps: 89 | Train Loss: 2.285 Vali Loss: 1.189 Vali Acc: 0.754 Test Loss: 1.189 Test Acc: 0.754
Validation loss decreased (inf --> -0.754166).  Saving model ...
Epoch: 2 cost time: 1.8861567974090576
Epoch: 2, Steps: 89 | Train Loss: 0.623 Vali Loss: 0.349 Vali Acc: 0.923 Test Loss: 0.349 Test Acc: 0.923
Validation loss decreased (-0.754166 --> -0.923395).  Saving model ...
Epoch: 3 cost time: 1.8989171981811523
Epoch: 3, Steps: 89 | Train Loss: 0.245 Vali Loss: 0.179 Vali Acc: 0.953 Test Loss: 0.179 Test Acc: 0.953
Validation loss decreased (-0.923395 --> -0.952644).  Saving model ...
Epoch: 4 cost time: 1.9184901714324951
Epoch: 4, Steps: 89 | Train Loss: 0.122 Vali Loss: 0.132 Vali Acc: 0.962 Test Loss: 0.132 Test Acc: 0.962
Validation loss decreased (-0.952644 --> -0.961698).  Saving model ...
Epoch: 5 cost time: 1.8937671184539795
Epoch: 5, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.107 Vali Acc: 0.974 Test Loss: 0.107 Test Acc: 0.974
Validation loss decreased (-0.961698 --> -0.974233).  Saving model ...
Epoch: 6 cost time: 1.870168685913086
Epoch: 6, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.974233 --> -0.979804).  Saving model ...
Epoch: 7 cost time: 1.7500357627868652
Epoch: 7, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.083 Vali Acc: 0.978 Test Loss: 0.083 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.042450189590454
Epoch: 8, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.072 Vali Acc: 0.981 Test Loss: 0.072 Test Acc: 0.981
Validation loss decreased (-0.979804 --> -0.981197).  Saving model ...
Epoch: 9 cost time: 1.9391899108886719
Epoch: 9, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.073 Vali Acc: 0.985 Test Loss: 0.073 Test Acc: 0.985
Validation loss decreased (-0.981197 --> -0.984679).  Saving model ...
Epoch: 10 cost time: 1.9534201622009277
Epoch: 10, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.1374690532684326
Epoch: 11, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.9413995742797852
Epoch: 12, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.078 Vali Acc: 0.981 Test Loss: 0.078 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.0150675773620605
Epoch: 13, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.074 Vali Acc: 0.984 Test Loss: 0.074 Test Acc: 0.984
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.8300971984863281
Epoch: 14, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.9911682605743408
Epoch: 15, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.065 Vali Acc: 0.986 Test Loss: 0.065 Test Acc: 0.986
Validation loss decreased (-0.984679 --> -0.986072).  Saving model ...
Epoch: 16 cost time: 1.9605381488800049
Epoch: 16, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.1344525814056396
Epoch: 17, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.105 Vali Acc: 0.978 Test Loss: 0.105 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.1419453620910645
Epoch: 18, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.076 Vali Acc: 0.985 Test Loss: 0.076 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.7804691791534424
Epoch: 19, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.072 Vali Acc: 0.985 Test Loss: 0.072 Test Acc: 0.985
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.0506038665771484
Epoch: 20, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.077 Vali Acc: 0.987 Test Loss: 0.077 Test Acc: 0.987
Validation loss decreased (-0.986072 --> -0.986768).  Saving model ...
Epoch: 21 cost time: 2.162961483001709
Epoch: 21, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.0407650470733643
Epoch: 22, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.294 Vali Acc: 0.934 Test Loss: 0.294 Test Acc: 0.934
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.8949964046478271
Epoch: 23, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.141 Vali Acc: 0.972 Test Loss: 0.141 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.7609705924987793
Epoch: 24, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.155 Vali Acc: 0.973 Test Loss: 0.155 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.8831112384796143
Epoch: 25, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.116 Vali Acc: 0.985 Test Loss: 0.116 Test Acc: 0.985
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.0930733680725098
Epoch: 26, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.173 Vali Acc: 0.966 Test Loss: 0.173 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.0826499462127686
Epoch: 27, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.136 Vali Acc: 0.978 Test Loss: 0.136 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.075974225997925
Epoch: 28, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.102 Vali Acc: 0.981 Test Loss: 0.102 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.8081154823303223
Epoch: 29, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.102 Vali Acc: 0.985 Test Loss: 0.102 Test Acc: 0.985
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.9716041088104248
Epoch: 30, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.102 Vali Acc: 0.987 Test Loss: 0.102 Test Acc: 0.987
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps14_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9867688022284122
model parameter : 126708
model size : 0.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps19_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.434027910232544
Epoch: 1, Steps: 89 | Train Loss: 2.600 Vali Loss: 1.766 Vali Acc: 0.714 Test Loss: 1.766 Test Acc: 0.714
Validation loss decreased (inf --> -0.714467).  Saving model ...
Epoch: 2 cost time: 1.7390022277832031
Epoch: 2, Steps: 89 | Train Loss: 0.962 Vali Loss: 0.534 Vali Acc: 0.870 Test Loss: 0.534 Test Acc: 0.870
Validation loss decreased (-0.714467 --> -0.870468).  Saving model ...
Epoch: 3 cost time: 1.8326218128204346
Epoch: 3, Steps: 89 | Train Loss: 0.368 Vali Loss: 0.283 Vali Acc: 0.937 Test Loss: 0.283 Test Acc: 0.937
Validation loss decreased (-0.870468 --> -0.937323).  Saving model ...
Epoch: 4 cost time: 1.786902904510498
Epoch: 4, Steps: 89 | Train Loss: 0.190 Vali Loss: 0.187 Vali Acc: 0.955 Test Loss: 0.187 Test Acc: 0.955
Validation loss decreased (-0.937323 --> -0.954734).  Saving model ...
Epoch: 5 cost time: 1.774155616760254
Epoch: 5, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.131 Vali Acc: 0.964 Test Loss: 0.131 Test Acc: 0.964
Validation loss decreased (-0.954734 --> -0.963787).  Saving model ...
Epoch: 6 cost time: 1.6786236763000488
Epoch: 6, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.105 Vali Acc: 0.972 Test Loss: 0.105 Test Acc: 0.972
Validation loss decreased (-0.963787 --> -0.972144).  Saving model ...
Epoch: 7 cost time: 1.659599781036377
Epoch: 7, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
Validation loss decreased (-0.972144 --> -0.976322).  Saving model ...
Epoch: 8 cost time: 1.8711950778961182
Epoch: 8, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.114 Vali Acc: 0.966 Test Loss: 0.114 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7726523876190186
Epoch: 9, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.067 Vali Acc: 0.985 Test Loss: 0.067 Test Acc: 0.985
Validation loss decreased (-0.976322 --> -0.985375).  Saving model ...
Epoch: 10 cost time: 1.8451018333435059
Epoch: 10, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.824782133102417
Epoch: 11, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.061 Vali Acc: 0.985 Test Loss: 0.061 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.8015615940093994
Epoch: 12, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.060 Vali Acc: 0.986 Test Loss: 0.060 Test Acc: 0.986
Validation loss decreased (-0.985375 --> -0.986072).  Saving model ...
Epoch: 13 cost time: 1.8366403579711914
Epoch: 13, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.055 Vali Acc: 0.987 Test Loss: 0.055 Test Acc: 0.987
Validation loss decreased (-0.986072 --> -0.986768).  Saving model ...
Epoch: 14 cost time: 1.9519031047821045
Epoch: 14, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.060 Vali Acc: 0.984 Test Loss: 0.060 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.837285041809082
Epoch: 15, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.081 Vali Acc: 0.978 Test Loss: 0.081 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.9264137744903564
Epoch: 16, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.100 Vali Acc: 0.971 Test Loss: 0.100 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.688096284866333
Epoch: 17, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.5912599563598633
Epoch: 18, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.931403636932373
Epoch: 19, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.125 Vali Acc: 0.968 Test Loss: 0.125 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.8571035861968994
Epoch: 20, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.076 Vali Acc: 0.984 Test Loss: 0.076 Test Acc: 0.984
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.7871427536010742
Epoch: 21, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.078 Vali Acc: 0.982 Test Loss: 0.078 Test Acc: 0.982
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.7792797088623047
Epoch: 22, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.129 Vali Acc: 0.969 Test Loss: 0.129 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.7035300731658936
Epoch: 23, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.088 Vali Acc: 0.980 Test Loss: 0.088 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps19_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9867688022284122
model parameter : 111508
model size : 0.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps28_str14_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.005962610244751
Epoch: 1, Steps: 89 | Train Loss: 2.624 Vali Loss: 1.928 Vali Acc: 0.705 Test Loss: 1.928 Test Acc: 0.705
Validation loss decreased (inf --> -0.705412).  Saving model ...
Epoch: 2 cost time: 1.6994149684906006
Epoch: 2, Steps: 89 | Train Loss: 1.161 Vali Loss: 0.625 Vali Acc: 0.856 Test Loss: 0.625 Test Acc: 0.856
Validation loss decreased (-0.705412 --> -0.855843).  Saving model ...
Epoch: 3 cost time: 1.7576251029968262
Epoch: 3, Steps: 89 | Train Loss: 0.438 Vali Loss: 0.319 Vali Acc: 0.917 Test Loss: 0.319 Test Acc: 0.917
Validation loss decreased (-0.855843 --> -0.917128).  Saving model ...
Epoch: 4 cost time: 1.641587734222412
Epoch: 4, Steps: 89 | Train Loss: 0.232 Vali Loss: 0.195 Vali Acc: 0.958 Test Loss: 0.195 Test Acc: 0.958
Validation loss decreased (-0.917128 --> -0.957519).  Saving model ...
Epoch: 5 cost time: 1.645256519317627
Epoch: 5, Steps: 89 | Train Loss: 0.139 Vali Loss: 0.143 Vali Acc: 0.959 Test Loss: 0.143 Test Acc: 0.959
Validation loss decreased (-0.957519 --> -0.958912).  Saving model ...
Epoch: 6 cost time: 1.4389076232910156
Epoch: 6, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.129 Vali Acc: 0.962 Test Loss: 0.129 Test Acc: 0.962
Validation loss decreased (-0.958912 --> -0.962394).  Saving model ...
Epoch: 7 cost time: 1.8533737659454346
Epoch: 7, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.090 Vali Acc: 0.971 Test Loss: 0.090 Test Acc: 0.971
Validation loss decreased (-0.962394 --> -0.971448).  Saving model ...
Epoch: 8 cost time: 1.860830307006836
Epoch: 8, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.075 Vali Acc: 0.981 Test Loss: 0.075 Test Acc: 0.981
Validation loss decreased (-0.971448 --> -0.981197).  Saving model ...
Epoch: 9 cost time: 1.8948333263397217
Epoch: 9, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.830179214477539
Epoch: 10, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.981197 --> -0.983286).  Saving model ...
Epoch: 11 cost time: 1.6779758930206299
Epoch: 11, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.062 Vali Acc: 0.982 Test Loss: 0.062 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9330329895019531
Epoch: 12, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.068 Vali Acc: 0.982 Test Loss: 0.068 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.792011022567749
Epoch: 13, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.067 Vali Acc: 0.985 Test Loss: 0.067 Test Acc: 0.985
Validation loss decreased (-0.983286 --> -0.985375).  Saving model ...
Epoch: 14 cost time: 1.9379603862762451
Epoch: 14, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.069 Vali Acc: 0.981 Test Loss: 0.069 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.8758511543273926
Epoch: 15, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.693971872329712
Epoch: 16, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.028090715408325
Epoch: 17, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.062 Vali Acc: 0.987 Test Loss: 0.062 Test Acc: 0.987
Validation loss decreased (-0.985375 --> -0.986768).  Saving model ...
Epoch: 18 cost time: 1.7917413711547852
Epoch: 18, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.064 Vali Acc: 0.986 Test Loss: 0.064 Test Acc: 0.986
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.9685544967651367
Epoch: 19, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.886850118637085
Epoch: 20, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.059 Vali Acc: 0.984 Test Loss: 0.059 Test Acc: 0.984
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.8140957355499268
Epoch: 21, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.060 Vali Acc: 0.985 Test Loss: 0.060 Test Acc: 0.985
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.00065016746521
Epoch: 22, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.075 Vali Acc: 0.982 Test Loss: 0.075 Test Acc: 0.982
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.9239935874938965
Epoch: 23, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.9165542125701904
Epoch: 24, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.092 Vali Acc: 0.978 Test Loss: 0.092 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.8617780208587646
Epoch: 25, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.943526029586792
Epoch: 26, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.074 Vali Acc: 0.985 Test Loss: 0.074 Test Acc: 0.985
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.9505114555358887
Epoch: 27, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.089 Vali Acc: 0.984 Test Loss: 0.089 Test Acc: 0.984
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps28_str14_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9867688022284122
model parameter : 104116
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps37_str19_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.7583212852478027
Epoch: 1, Steps: 89 | Train Loss: 2.697 Vali Loss: 2.088 Vali Acc: 0.615 Test Loss: 2.088 Test Acc: 0.615
Validation loss decreased (inf --> -0.614882).  Saving model ...
Epoch: 2 cost time: 1.914222240447998
Epoch: 2, Steps: 89 | Train Loss: 1.334 Vali Loss: 0.750 Vali Acc: 0.826 Test Loss: 0.750 Test Acc: 0.826
Validation loss decreased (-0.614882 --> -0.825898).  Saving model ...
Epoch: 3 cost time: 1.8342225551605225
Epoch: 3, Steps: 89 | Train Loss: 0.516 Vali Loss: 0.369 Vali Acc: 0.920 Test Loss: 0.369 Test Acc: 0.920
Validation loss decreased (-0.825898 --> -0.919913).  Saving model ...
Epoch: 4 cost time: 1.8432011604309082
Epoch: 4, Steps: 89 | Train Loss: 0.279 Vali Loss: 0.224 Vali Acc: 0.953 Test Loss: 0.224 Test Acc: 0.953
Validation loss decreased (-0.919913 --> -0.953340).  Saving model ...
Epoch: 5 cost time: 1.8695738315582275
Epoch: 5, Steps: 89 | Train Loss: 0.163 Vali Loss: 0.171 Vali Acc: 0.952 Test Loss: 0.171 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6034295558929443
Epoch: 6, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.128 Vali Acc: 0.969 Test Loss: 0.128 Test Acc: 0.969
Validation loss decreased (-0.953340 --> -0.969358).  Saving model ...
Epoch: 7 cost time: 1.803879737854004
Epoch: 7, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.107 Vali Acc: 0.974 Test Loss: 0.107 Test Acc: 0.974
Validation loss decreased (-0.969358 --> -0.974233).  Saving model ...
Epoch: 8 cost time: 1.8885729312896729
Epoch: 8, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.083 Vali Acc: 0.978 Test Loss: 0.083 Test Acc: 0.978
Validation loss decreased (-0.974233 --> -0.977715).  Saving model ...
Epoch: 9 cost time: 1.8097877502441406
Epoch: 9, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.089 Vali Acc: 0.978 Test Loss: 0.089 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.913830280303955
Epoch: 10, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.071 Vali Acc: 0.984 Test Loss: 0.071 Test Acc: 0.984
Validation loss decreased (-0.977715 --> -0.983983).  Saving model ...
Epoch: 11 cost time: 1.6644020080566406
Epoch: 11, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.615823745727539
Epoch: 12, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.061 Vali Acc: 0.984 Test Loss: 0.061 Test Acc: 0.984
Validation loss decreased (-0.983983 --> -0.983983).  Saving model ...
Epoch: 13 cost time: 1.8266839981079102
Epoch: 13, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.8435845375061035
Epoch: 14, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.061 Vali Acc: 0.981 Test Loss: 0.061 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.8898348808288574
Epoch: 15, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.059 Vali Acc: 0.985 Test Loss: 0.059 Test Acc: 0.985
Validation loss decreased (-0.983983 --> -0.985375).  Saving model ...
Epoch: 16 cost time: 1.8938541412353516
Epoch: 16, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.062 Vali Acc: 0.985 Test Loss: 0.062 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.680248737335205
Epoch: 17, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.057 Vali Acc: 0.987 Test Loss: 0.057 Test Acc: 0.987
Validation loss decreased (-0.985375 --> -0.987465).  Saving model ...
Epoch: 18 cost time: 1.6346380710601807
Epoch: 18, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.065 Vali Acc: 0.984 Test Loss: 0.065 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.6655631065368652
Epoch: 19, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.058 Vali Acc: 0.985 Test Loss: 0.058 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.7528011798858643
Epoch: 20, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.111 Vali Acc: 0.969 Test Loss: 0.111 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.7840063571929932
Epoch: 21, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.058 Vali Acc: 0.987 Test Loss: 0.058 Test Acc: 0.987
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.8597838878631592
Epoch: 22, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.082 Vali Acc: 0.976 Test Loss: 0.082 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.5121698379516602
Epoch: 23, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.054 Vali Acc: 0.986 Test Loss: 0.054 Test Acc: 0.986
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.8472847938537598
Epoch: 24, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.077 Vali Acc: 0.978 Test Loss: 0.077 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.8616797924041748
Epoch: 25, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.062 Vali Acc: 0.984 Test Loss: 0.062 Test Acc: 0.984
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.7631309032440186
Epoch: 26, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.060 Vali Acc: 0.985 Test Loss: 0.060 Test Acc: 0.985
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.8782885074615479
Epoch: 27, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.053 Vali Acc: 0.987 Test Loss: 0.053 Test Acc: 0.987
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps37_str19_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9874651810584958
model parameter : 96724
model size : 0.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps46_str23_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.6648805141448975
Epoch: 1, Steps: 89 | Train Loss: 2.671 Vali Loss: 2.137 Vali Acc: 0.617 Test Loss: 2.137 Test Acc: 0.617
Validation loss decreased (inf --> -0.616970).  Saving model ...
Epoch: 2 cost time: 1.8695592880249023
Epoch: 2, Steps: 89 | Train Loss: 1.409 Vali Loss: 0.784 Vali Acc: 0.855 Test Loss: 0.784 Test Acc: 0.855
Validation loss decreased (-0.616970 --> -0.855145).  Saving model ...
Epoch: 3 cost time: 1.762021541595459
Epoch: 3, Steps: 89 | Train Loss: 0.536 Vali Loss: 0.372 Vali Acc: 0.909 Test Loss: 0.372 Test Acc: 0.909
Validation loss decreased (-0.855145 --> -0.908771).  Saving model ...
Epoch: 4 cost time: 1.672398567199707
Epoch: 4, Steps: 89 | Train Loss: 0.286 Vali Loss: 0.232 Vali Acc: 0.941 Test Loss: 0.232 Test Acc: 0.941
Validation loss decreased (-0.908771 --> -0.940805).  Saving model ...
Epoch: 5 cost time: 1.845435380935669
Epoch: 5, Steps: 89 | Train Loss: 0.171 Vali Loss: 0.160 Vali Acc: 0.962 Test Loss: 0.160 Test Acc: 0.962
Validation loss decreased (-0.940805 --> -0.961698).  Saving model ...
Epoch: 6 cost time: 1.7664813995361328
Epoch: 6, Steps: 89 | Train Loss: 0.121 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
Validation loss decreased (-0.961698 --> -0.972840).  Saving model ...
Epoch: 7 cost time: 1.8430001735687256
Epoch: 7, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.108 Vali Acc: 0.978 Test Loss: 0.108 Test Acc: 0.978
Validation loss decreased (-0.972840 --> -0.978411).  Saving model ...
Epoch: 8 cost time: 1.901496410369873
Epoch: 8, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.599311351776123
Epoch: 9, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.091 Vali Acc: 0.979 Test Loss: 0.091 Test Acc: 0.979
Validation loss decreased (-0.978411 --> -0.979108).  Saving model ...
Epoch: 10 cost time: 1.7545967102050781
Epoch: 10, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.071 Vali Acc: 0.982 Test Loss: 0.071 Test Acc: 0.982
Validation loss decreased (-0.979108 --> -0.981893).  Saving model ...
Epoch: 11 cost time: 1.498978614807129
Epoch: 11, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.7675344944000244
Epoch: 12, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.081 Vali Acc: 0.978 Test Loss: 0.081 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.9366471767425537
Epoch: 13, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.981893 --> -0.983286).  Saving model ...
Epoch: 14 cost time: 1.700591802597046
Epoch: 14, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.061 Vali Acc: 0.984 Test Loss: 0.061 Test Acc: 0.984
Validation loss decreased (-0.983286 --> -0.983983).  Saving model ...
Epoch: 15 cost time: 1.68902587890625
Epoch: 15, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.061 Vali Acc: 0.985 Test Loss: 0.061 Test Acc: 0.985
Validation loss decreased (-0.983983 --> -0.985375).  Saving model ...
Epoch: 16 cost time: 1.9132230281829834
Epoch: 16, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.059 Vali Acc: 0.987 Test Loss: 0.059 Test Acc: 0.987
Validation loss decreased (-0.985375 --> -0.986768).  Saving model ...
Epoch: 17 cost time: 1.9155752658843994
Epoch: 17, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.059 Vali Acc: 0.985 Test Loss: 0.059 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.8581671714782715
Epoch: 18, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.057 Vali Acc: 0.985 Test Loss: 0.057 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.8520457744598389
Epoch: 19, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.6256189346313477
Epoch: 20, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.059 Vali Acc: 0.986 Test Loss: 0.059 Test Acc: 0.986
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.9915001392364502
Epoch: 21, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.064 Vali Acc: 0.987 Test Loss: 0.064 Test Acc: 0.987
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.770545482635498
Epoch: 22, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.060 Vali Acc: 0.985 Test Loss: 0.060 Test Acc: 0.985
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.937265157699585
Epoch: 23, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.056 Vali Acc: 0.987 Test Loss: 0.056 Test Acc: 0.987
Validation loss decreased (-0.986768 --> -0.987465).  Saving model ...
Epoch: 24 cost time: 1.8254008293151855
Epoch: 24, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.057 Vali Acc: 0.985 Test Loss: 0.057 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.899183988571167
Epoch: 25, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.061 Vali Acc: 0.984 Test Loss: 0.061 Test Acc: 0.984
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.9460151195526123
Epoch: 26, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.069 Vali Acc: 0.981 Test Loss: 0.069 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.9166779518127441
Epoch: 27, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.054 Vali Acc: 0.987 Test Loss: 0.054 Test Acc: 0.987
Validation loss decreased (-0.987465 --> -0.987465).  Saving model ...
Epoch: 28 cost time: 1.8644859790802002
Epoch: 28, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.062 Vali Acc: 0.987 Test Loss: 0.062 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.9101250171661377
Epoch: 29, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.063 Vali Acc: 0.987 Test Loss: 0.063 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.6465342044830322
Epoch: 30, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.078 Vali Acc: 0.984 Test Loss: 0.078 Test Acc: 0.984
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.8134727478027344
Epoch: 31, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.119 Vali Acc: 0.969 Test Loss: 0.119 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.680549144744873
Epoch: 32, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.058 Vali Acc: 0.986 Test Loss: 0.058 Test Acc: 0.986
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.875765323638916
Epoch: 33, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.8550200462341309
Epoch: 34, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.818694829940796
Epoch: 35, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.057 Vali Acc: 0.987 Test Loss: 0.057 Test Acc: 0.987
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.7829053401947021
Epoch: 36, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.101 Vali Acc: 0.981 Test Loss: 0.101 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.9243097305297852
Epoch: 37, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.075 Vali Acc: 0.987 Test Loss: 0.075 Test Acc: 0.987
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr2_ps46_str23_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9874651810584958
model parameter : 93172
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.0937132835388184
Epoch: 1, Steps: 89 | Train Loss: 0.931 Vali Loss: 0.403 Vali Acc: 0.901 Test Loss: 0.403 Test Acc: 0.901
Validation loss decreased (inf --> -0.901110).  Saving model ...
Epoch: 2 cost time: 2.658388614654541
Epoch: 2, Steps: 89 | Train Loss: 0.261 Vali Loss: 0.152 Vali Acc: 0.964 Test Loss: 0.152 Test Acc: 0.964
Validation loss decreased (-0.901110 --> -0.963787).  Saving model ...
Epoch: 3 cost time: 2.705325126647949
Epoch: 3, Steps: 89 | Train Loss: 0.135 Vali Loss: 0.216 Vali Acc: 0.955 Test Loss: 0.216 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.783795118331909
Epoch: 4, Steps: 89 | Train Loss: 0.144 Vali Loss: 0.421 Vali Acc: 0.931 Test Loss: 0.421 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.5066404342651367
Epoch: 5, Steps: 89 | Train Loss: 0.146 Vali Loss: 0.277 Vali Acc: 0.961 Test Loss: 0.277 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.2148022651672363
Epoch: 6, Steps: 89 | Train Loss: 0.181 Vali Loss: 0.496 Vali Acc: 0.919 Test Loss: 0.496 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.7573680877685547
Epoch: 7, Steps: 89 | Train Loss: 0.120 Vali Loss: 0.418 Vali Acc: 0.963 Test Loss: 0.418 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.728149175643921
Epoch: 8, Steps: 89 | Train Loss: 0.143 Vali Loss: 0.560 Vali Acc: 0.954 Test Loss: 0.560 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.785703420639038
Epoch: 9, Steps: 89 | Train Loss: 0.137 Vali Loss: 0.569 Vali Acc: 0.917 Test Loss: 0.569 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.04532790184021
Epoch: 10, Steps: 89 | Train Loss: 0.181 Vali Loss: 0.389 Vali Acc: 0.961 Test Loss: 0.389 Test Acc: 0.961
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.270399808883667
Epoch: 11, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.277 Vali Acc: 0.974 Test Loss: 0.277 Test Acc: 0.974
Validation loss decreased (-0.963787 --> -0.973535).  Saving model ...
Epoch: 12 cost time: 2.7963030338287354
Epoch: 12, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.609 Vali Acc: 0.942 Test Loss: 0.609 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.7045302391052246
Epoch: 13, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.365 Vali Acc: 0.970 Test Loss: 0.365 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.7873711585998535
Epoch: 14, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.340 Vali Acc: 0.967 Test Loss: 0.340 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.9732365608215332
Epoch: 15, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.329 Vali Acc: 0.974 Test Loss: 0.329 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.713073492050171
Epoch: 16, Steps: 89 | Train Loss: 0.113 Vali Loss: 0.405 Vali Acc: 0.969 Test Loss: 0.405 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.6754233837127686
Epoch: 17, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.553 Vali Acc: 0.954 Test Loss: 0.553 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.7219626903533936
Epoch: 18, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.605 Vali Acc: 0.958 Test Loss: 0.605 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.506591558456421
Epoch: 19, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.427 Vali Acc: 0.976 Test Loss: 0.427 Test Acc: 0.976
Validation loss decreased (-0.973535 --> -0.976319).  Saving model ...
Epoch: 20 cost time: 2.0973880290985107
Epoch: 20, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.455 Vali Acc: 0.967 Test Loss: 0.455 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.6482160091400146
Epoch: 21, Steps: 89 | Train Loss: 0.219 Vali Loss: 0.771 Vali Acc: 0.948 Test Loss: 0.771 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.6920361518859863
Epoch: 22, Steps: 89 | Train Loss: 0.159 Vali Loss: 0.662 Vali Acc: 0.958 Test Loss: 0.662 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.7430787086486816
Epoch: 23, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.429 Vali Acc: 0.975 Test Loss: 0.429 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.1348788738250732
Epoch: 24, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.554 Vali Acc: 0.965 Test Loss: 0.554 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.33898663520813
Epoch: 25, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.912 Vali Acc: 0.939 Test Loss: 0.912 Test Acc: 0.939
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.6401841640472412
Epoch: 26, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.683 Vali Acc: 0.965 Test Loss: 0.683 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.6008946895599365
Epoch: 27, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.549 Vali Acc: 0.965 Test Loss: 0.549 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.4682955741882324
Epoch: 28, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.614 Vali Acc: 0.967 Test Loss: 0.614 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.436671018600464
Epoch: 29, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.422 Vali Acc: 0.979 Test Loss: 0.422 Test Acc: 0.979
Validation loss decreased (-0.976319 --> -0.979104).  Saving model ...
Epoch: 30 cost time: 2.6887831687927246
Epoch: 30, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.478 Vali Acc: 0.976 Test Loss: 0.478 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.7943553924560547
Epoch: 31, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.376 Vali Acc: 0.978 Test Loss: 0.376 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.2198715209960938
Epoch: 32, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.393 Vali Acc: 0.979 Test Loss: 0.393 Test Acc: 0.979
Validation loss decreased (-0.979104 --> -0.979105).  Saving model ...
Epoch: 33 cost time: 2.7696993350982666
Epoch: 33, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.328 Vali Acc: 0.981 Test Loss: 0.328 Test Acc: 0.981
Validation loss decreased (-0.979105 --> -0.981194).  Saving model ...
Epoch: 34 cost time: 2.7892863750457764
Epoch: 34, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.330 Vali Acc: 0.982 Test Loss: 0.330 Test Acc: 0.982
Validation loss decreased (-0.981194 --> -0.981891).  Saving model ...
Epoch: 35 cost time: 2.756452798843384
Epoch: 35, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.485 Vali Acc: 0.976 Test Loss: 0.485 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.715420961380005
Epoch: 36, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.571 Vali Acc: 0.975 Test Loss: 0.571 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 2.197645664215088
Epoch: 37, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.645 Vali Acc: 0.970 Test Loss: 0.645 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 2.7474193572998047
Epoch: 38, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.473 Vali Acc: 0.978 Test Loss: 0.473 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 2.7162652015686035
Epoch: 39, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.701 Vali Acc: 0.960 Test Loss: 0.701 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 2.8137824535369873
Epoch: 40, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.536 Vali Acc: 0.969 Test Loss: 0.536 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 2.1626341342926025
Epoch: 41, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.563 Vali Acc: 0.972 Test Loss: 0.563 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 2.606593370437622
Epoch: 42, Steps: 89 | Train Loss: 0.138 Vali Loss: 0.655 Vali Acc: 0.947 Test Loss: 0.655 Test Acc: 0.947
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 2.7580249309539795
Epoch: 43, Steps: 89 | Train Loss: 0.218 Vali Loss: 0.437 Vali Acc: 0.978 Test Loss: 0.437 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 2.4719364643096924
Epoch: 44, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.868 Vali Acc: 0.951 Test Loss: 0.868 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9818941504178273
model parameter : 1741332
model size : 6.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.767206907272339
Epoch: 1, Steps: 89 | Train Loss: 0.937 Vali Loss: 0.258 Vali Acc: 0.942 Test Loss: 0.258 Test Acc: 0.942
Validation loss decreased (inf --> -0.941502).  Saving model ...
Epoch: 2 cost time: 1.9025259017944336
Epoch: 2, Steps: 89 | Train Loss: 0.251 Vali Loss: 0.274 Vali Acc: 0.936 Test Loss: 0.274 Test Acc: 0.936
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8036680221557617
Epoch: 3, Steps: 89 | Train Loss: 0.156 Vali Loss: 0.186 Vali Acc: 0.956 Test Loss: 0.186 Test Acc: 0.956
Validation loss decreased (-0.941502 --> -0.956126).  Saving model ...
Epoch: 4 cost time: 1.6463186740875244
Epoch: 4, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.159 Vali Acc: 0.971 Test Loss: 0.159 Test Acc: 0.971
Validation loss decreased (-0.956126 --> -0.971447).  Saving model ...
Epoch: 5 cost time: 1.5311260223388672
Epoch: 5, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.159 Vali Acc: 0.974 Test Loss: 0.159 Test Acc: 0.974
Validation loss decreased (-0.971447 --> -0.973536).  Saving model ...
Epoch: 6 cost time: 1.8332598209381104
Epoch: 6, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.225 Vali Acc: 0.966 Test Loss: 0.225 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.8054392337799072
Epoch: 7, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.219 Vali Acc: 0.964 Test Loss: 0.219 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.9168815612792969
Epoch: 8, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.220 Vali Acc: 0.967 Test Loss: 0.220 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.590421438217163
Epoch: 9, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.278 Vali Acc: 0.966 Test Loss: 0.278 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.7356600761413574
Epoch: 10, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.329 Vali Acc: 0.955 Test Loss: 0.329 Test Acc: 0.955
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.8149807453155518
Epoch: 11, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.247 Vali Acc: 0.968 Test Loss: 0.247 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.9142560958862305
Epoch: 12, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.328 Vali Acc: 0.964 Test Loss: 0.328 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.8900482654571533
Epoch: 13, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.254 Vali Acc: 0.971 Test Loss: 0.254 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.7743008136749268
Epoch: 14, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.320 Vali Acc: 0.960 Test Loss: 0.320 Test Acc: 0.960
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.8220040798187256
Epoch: 15, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.294 Vali Acc: 0.958 Test Loss: 0.294 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9735376044568245
model parameter : 1373972
model size : 5.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps14_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.800241231918335
Epoch: 1, Steps: 89 | Train Loss: 1.037 Vali Loss: 0.360 Vali Acc: 0.892 Test Loss: 0.360 Test Acc: 0.892
Validation loss decreased (inf --> -0.892058).  Saving model ...
Epoch: 2 cost time: 1.6677937507629395
Epoch: 2, Steps: 89 | Train Loss: 0.187 Vali Loss: 0.155 Vali Acc: 0.960 Test Loss: 0.155 Test Acc: 0.960
Validation loss decreased (-0.892058 --> -0.960305).  Saving model ...
Epoch: 3 cost time: 1.8038241863250732
Epoch: 3, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.183 Vali Acc: 0.948 Test Loss: 0.183 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7701280117034912
Epoch: 4, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.207 Vali Acc: 0.955 Test Loss: 0.207 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.8509459495544434
Epoch: 5, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.160 Vali Acc: 0.962 Test Loss: 0.160 Test Acc: 0.962
Validation loss decreased (-0.960305 --> -0.961698).  Saving model ...
Epoch: 6 cost time: 1.894364833831787
Epoch: 6, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.294 Vali Acc: 0.948 Test Loss: 0.294 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.642578125
Epoch: 7, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.263 Vali Acc: 0.957 Test Loss: 0.263 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.585946798324585
Epoch: 8, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.203 Vali Acc: 0.971 Test Loss: 0.203 Test Acc: 0.971
Validation loss decreased (-0.961698 --> -0.970750).  Saving model ...
Epoch: 9 cost time: 1.8722519874572754
Epoch: 9, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.201 Vali Acc: 0.972 Test Loss: 0.201 Test Acc: 0.972
Validation loss decreased (-0.970750 --> -0.972143).  Saving model ...
Epoch: 10 cost time: 1.78653883934021
Epoch: 10, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.278 Vali Acc: 0.960 Test Loss: 0.278 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8321340084075928
Epoch: 11, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.166 Vali Acc: 0.976 Test Loss: 0.166 Test Acc: 0.976
Validation loss decreased (-0.972143 --> -0.976321).  Saving model ...
Epoch: 12 cost time: 1.5462117195129395
Epoch: 12, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.160 Vali Acc: 0.975 Test Loss: 0.160 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5841517448425293
Epoch: 13, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.193 Vali Acc: 0.974 Test Loss: 0.193 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.7390637397766113
Epoch: 14, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.152 Vali Acc: 0.982 Test Loss: 0.152 Test Acc: 0.982
Validation loss decreased (-0.976321 --> -0.981893).  Saving model ...
Epoch: 15 cost time: 1.8194708824157715
Epoch: 15, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.132 Vali Acc: 0.980 Test Loss: 0.132 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.7943673133850098
Epoch: 16, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.129 Vali Acc: 0.982 Test Loss: 0.129 Test Acc: 0.982
Validation loss decreased (-0.981893 --> -0.981893).  Saving model ...
Epoch: 17 cost time: 1.5328021049499512
Epoch: 17, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.489 Vali Acc: 0.939 Test Loss: 0.489 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.6098763942718506
Epoch: 18, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.254 Vali Acc: 0.962 Test Loss: 0.254 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.739090919494629
Epoch: 19, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.420 Vali Acc: 0.949 Test Loss: 0.420 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.786881923675537
Epoch: 20, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.249 Vali Acc: 0.969 Test Loss: 0.249 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.863239049911499
Epoch: 21, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.287 Vali Acc: 0.970 Test Loss: 0.287 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.8101897239685059
Epoch: 22, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.295 Vali Acc: 0.973 Test Loss: 0.295 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.645219326019287
Epoch: 23, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.277 Vali Acc: 0.976 Test Loss: 0.277 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.7716684341430664
Epoch: 24, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.263 Vali Acc: 0.976 Test Loss: 0.263 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.816216230392456
Epoch: 25, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.209 Vali Acc: 0.981 Test Loss: 0.209 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.869297742843628
Epoch: 26, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.978 Test Loss: 0.220 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps14_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9818941504178273
model parameter : 1221396
model size : 4.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps19_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.7793664932250977
Epoch: 1, Steps: 89 | Train Loss: 1.186 Vali Loss: 0.330 Vali Acc: 0.914 Test Loss: 0.330 Test Acc: 0.914
Validation loss decreased (inf --> -0.914342).  Saving model ...
Epoch: 2 cost time: 1.8869025707244873
Epoch: 2, Steps: 89 | Train Loss: 0.237 Vali Loss: 0.164 Vali Acc: 0.961 Test Loss: 0.164 Test Acc: 0.961
Validation loss decreased (-0.914342 --> -0.961001).  Saving model ...
Epoch: 3 cost time: 1.7654883861541748
Epoch: 3, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.166 Vali Acc: 0.959 Test Loss: 0.166 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.647454023361206
Epoch: 4, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
Validation loss decreased (-0.961001 --> -0.975626).  Saving model ...
Epoch: 5 cost time: 1.8566975593566895
Epoch: 5, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.131 Vali Acc: 0.972 Test Loss: 0.131 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6579952239990234
Epoch: 6, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.159 Vali Acc: 0.965 Test Loss: 0.159 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.8279178142547607
Epoch: 7, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.134 Vali Acc: 0.973 Test Loss: 0.134 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.7160508632659912
Epoch: 8, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.171 Vali Acc: 0.965 Test Loss: 0.171 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.5622718334197998
Epoch: 9, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.101 Vali Acc: 0.983 Test Loss: 0.101 Test Acc: 0.983
Validation loss decreased (-0.975626 --> -0.982590).  Saving model ...
Epoch: 10 cost time: 1.8495683670043945
Epoch: 10, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.190 Vali Acc: 0.962 Test Loss: 0.190 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7895803451538086
Epoch: 11, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.222 Vali Acc: 0.952 Test Loss: 0.222 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.7813305854797363
Epoch: 12, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.101 Vali Acc: 0.984 Test Loss: 0.101 Test Acc: 0.984
Validation loss decreased (-0.982590 --> -0.983982).  Saving model ...
Epoch: 13 cost time: 1.9229295253753662
Epoch: 13, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.298 Vali Acc: 0.960 Test Loss: 0.298 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5812153816223145
Epoch: 14, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.132 Vali Acc: 0.981 Test Loss: 0.132 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.8536672592163086
Epoch: 15, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.158 Vali Acc: 0.974 Test Loss: 0.158 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.8627655506134033
Epoch: 16, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.119 Vali Acc: 0.982 Test Loss: 0.119 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.8323743343353271
Epoch: 17, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.168 Vali Acc: 0.978 Test Loss: 0.168 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.8903799057006836
Epoch: 18, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.153 Vali Acc: 0.976 Test Loss: 0.153 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.755035161972046
Epoch: 19, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.275 Vali Acc: 0.967 Test Loss: 0.275 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.840348720550537
Epoch: 20, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.140 Vali Acc: 0.981 Test Loss: 0.140 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.945807695388794
Epoch: 21, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.245 Vali Acc: 0.966 Test Loss: 0.245 Test Acc: 0.966
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.001068353652954
Epoch: 22, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.176 Vali Acc: 0.976 Test Loss: 0.176 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps19_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.983983286908078
model parameter : 1099796
model size : 4.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps28_str14_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.3746862411499023
Epoch: 1, Steps: 89 | Train Loss: 1.224 Vali Loss: 0.378 Vali Acc: 0.919 Test Loss: 0.378 Test Acc: 0.919
Validation loss decreased (inf --> -0.918520).  Saving model ...
Epoch: 2 cost time: 1.5468499660491943
Epoch: 2, Steps: 89 | Train Loss: 0.275 Vali Loss: 0.181 Vali Acc: 0.956 Test Loss: 0.181 Test Acc: 0.956
Validation loss decreased (-0.918520 --> -0.956126).  Saving model ...
Epoch: 3 cost time: 1.5312507152557373
Epoch: 3, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.115 Vali Acc: 0.971 Test Loss: 0.115 Test Acc: 0.971
Validation loss decreased (-0.956126 --> -0.970751).  Saving model ...
Epoch: 4 cost time: 1.6197090148925781
Epoch: 4, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.097 Vali Acc: 0.971 Test Loss: 0.097 Test Acc: 0.971
Validation loss decreased (-0.970751 --> -0.970751).  Saving model ...
Epoch: 5 cost time: 1.4546771049499512
Epoch: 5, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.970751 --> -0.979804).  Saving model ...
Epoch: 6 cost time: 1.5104479789733887
Epoch: 6, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.092 Vali Acc: 0.979 Test Loss: 0.092 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6743733882904053
Epoch: 7, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.148 Vali Acc: 0.961 Test Loss: 0.148 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.4962162971496582
Epoch: 8, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.092 Vali Acc: 0.982 Test Loss: 0.092 Test Acc: 0.982
Validation loss decreased (-0.979804 --> -0.981893).  Saving model ...
Epoch: 9 cost time: 1.6634323596954346
Epoch: 9, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.089 Vali Acc: 0.978 Test Loss: 0.089 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5911037921905518
Epoch: 10, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.159 Vali Acc: 0.958 Test Loss: 0.159 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.615657091140747
Epoch: 11, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.163 Vali Acc: 0.960 Test Loss: 0.163 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.3877356052398682
Epoch: 12, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.171 Vali Acc: 0.969 Test Loss: 0.171 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.638923168182373
Epoch: 13, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.175 Vali Acc: 0.972 Test Loss: 0.175 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.6408119201660156
Epoch: 14, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.146 Vali Acc: 0.976 Test Loss: 0.146 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.5645544528961182
Epoch: 15, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.200 Vali Acc: 0.958 Test Loss: 0.200 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.587665319442749
Epoch: 16, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.153 Vali Acc: 0.976 Test Loss: 0.153 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.620403528213501
Epoch: 17, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.104 Vali Acc: 0.983 Test Loss: 0.104 Test Acc: 0.983
Validation loss decreased (-0.981893 --> -0.983286).  Saving model ...
Epoch: 18 cost time: 1.583357572555542
Epoch: 18, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.115 Vali Acc: 0.978 Test Loss: 0.115 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.601546049118042
Epoch: 19, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.132 Vali Acc: 0.982 Test Loss: 0.132 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.5355615615844727
Epoch: 20, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.107 Vali Acc: 0.981 Test Loss: 0.107 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.616098165512085
Epoch: 21, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.101 Vali Acc: 0.984 Test Loss: 0.101 Test Acc: 0.984
Validation loss decreased (-0.983286 --> -0.983982).  Saving model ...
Epoch: 22 cost time: 1.6946783065795898
Epoch: 22, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.983 Test Loss: 0.091 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.6288912296295166
Epoch: 23, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.083 Vali Acc: 0.984 Test Loss: 0.083 Test Acc: 0.984
Validation loss decreased (-0.983982 --> -0.983982).  Saving model ...
Epoch: 24 cost time: 1.3346350193023682
Epoch: 24, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.131 Vali Acc: 0.978 Test Loss: 0.131 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.4748420715332031
Epoch: 25, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.211 Vali Acc: 0.961 Test Loss: 0.211 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.3374292850494385
Epoch: 26, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.221 Vali Acc: 0.967 Test Loss: 0.221 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.5671982765197754
Epoch: 27, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.456 Vali Acc: 0.939 Test Loss: 0.456 Test Acc: 0.939
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.8116157054901123
Epoch: 28, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.211 Vali Acc: 0.967 Test Loss: 0.211 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.6873812675476074
Epoch: 29, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.134 Vali Acc: 0.976 Test Loss: 0.134 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.701035976409912
Epoch: 30, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.198 Vali Acc: 0.966 Test Loss: 0.198 Test Acc: 0.966
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.6127536296844482
Epoch: 31, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.271 Vali Acc: 0.970 Test Loss: 0.271 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.7613072395324707
Epoch: 32, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.183 Vali Acc: 0.976 Test Loss: 0.183 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.757319688796997
Epoch: 33, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.167 Vali Acc: 0.973 Test Loss: 0.167 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps28_str14_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.983983286908078
model parameter : 1025300
model size : 3.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps37_str19_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.781142473220825
Epoch: 1, Steps: 89 | Train Loss: 1.429 Vali Loss: 0.500 Vali Acc: 0.870 Test Loss: 0.500 Test Acc: 0.870
Validation loss decreased (inf --> -0.869772).  Saving model ...
Epoch: 2 cost time: 1.682600498199463
Epoch: 2, Steps: 89 | Train Loss: 0.294 Vali Loss: 0.216 Vali Acc: 0.944 Test Loss: 0.216 Test Acc: 0.944
Validation loss decreased (-0.869772 --> -0.943591).  Saving model ...
Epoch: 3 cost time: 1.7056348323822021
Epoch: 3, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.121 Vali Acc: 0.971 Test Loss: 0.121 Test Acc: 0.971
Validation loss decreased (-0.943591 --> -0.970751).  Saving model ...
Epoch: 4 cost time: 1.5503003597259521
Epoch: 4, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.141 Vali Acc: 0.959 Test Loss: 0.141 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6866035461425781
Epoch: 5, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.095 Vali Acc: 0.974 Test Loss: 0.095 Test Acc: 0.974
Validation loss decreased (-0.970751 --> -0.974233).  Saving model ...
Epoch: 6 cost time: 1.680427074432373
Epoch: 6, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
Validation loss decreased (-0.974233 --> -0.977019).  Saving model ...
Epoch: 7 cost time: 1.6790580749511719
Epoch: 7, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.067 Vali Acc: 0.982 Test Loss: 0.067 Test Acc: 0.982
Validation loss decreased (-0.977019 --> -0.981893).  Saving model ...
Epoch: 8 cost time: 1.5996472835540771
Epoch: 8, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.067 Vali Acc: 0.985 Test Loss: 0.067 Test Acc: 0.985
Validation loss decreased (-0.981893 --> -0.984679).  Saving model ...
Epoch: 9 cost time: 1.693943977355957
Epoch: 9, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7443902492523193
Epoch: 10, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.286 Vali Acc: 0.923 Test Loss: 0.286 Test Acc: 0.923
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6282083988189697
Epoch: 11, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.6493737697601318
Epoch: 12, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.155 Vali Acc: 0.967 Test Loss: 0.155 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.3900785446166992
Epoch: 13, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.150 Vali Acc: 0.975 Test Loss: 0.150 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.7141456604003906
Epoch: 14, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.109 Vali Acc: 0.979 Test Loss: 0.109 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.6138029098510742
Epoch: 15, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.594543218612671
Epoch: 16, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.720139503479004
Epoch: 17, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.089 Vali Acc: 0.985 Test Loss: 0.089 Test Acc: 0.985
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.606079339981079
Epoch: 18, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.082 Vali Acc: 0.981 Test Loss: 0.082 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps37_str19_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9846796657381616
model parameter : 966164
model size : 3.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps46_str23_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.489438772201538
Epoch: 1, Steps: 89 | Train Loss: 1.559 Vali Loss: 0.562 Vali Acc: 0.870 Test Loss: 0.562 Test Acc: 0.870
Validation loss decreased (inf --> -0.870468).  Saving model ...
Epoch: 2 cost time: 1.492656946182251
Epoch: 2, Steps: 89 | Train Loss: 0.336 Vali Loss: 0.223 Vali Acc: 0.944 Test Loss: 0.223 Test Acc: 0.944
Validation loss decreased (-0.870468 --> -0.943591).  Saving model ...
Epoch: 3 cost time: 1.5403287410736084
Epoch: 3, Steps: 89 | Train Loss: 0.129 Vali Loss: 0.113 Vali Acc: 0.974 Test Loss: 0.113 Test Acc: 0.974
Validation loss decreased (-0.943591 --> -0.973536).  Saving model ...
Epoch: 4 cost time: 1.7598094940185547
Epoch: 4, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.105 Vali Acc: 0.974 Test Loss: 0.105 Test Acc: 0.974
Validation loss decreased (-0.973536 --> -0.973537).  Saving model ...
Epoch: 5 cost time: 1.6377537250518799
Epoch: 5, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.074 Vali Acc: 0.982 Test Loss: 0.074 Test Acc: 0.982
Validation loss decreased (-0.973537 --> -0.981893).  Saving model ...
Epoch: 6 cost time: 1.7061598300933838
Epoch: 6, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.141 Vali Acc: 0.966 Test Loss: 0.141 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4979994297027588
Epoch: 7, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.068 Vali Acc: 0.984 Test Loss: 0.068 Test Acc: 0.984
Validation loss decreased (-0.981893 --> -0.983983).  Saving model ...
Epoch: 8 cost time: 1.6395866870880127
Epoch: 8, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.085 Vali Acc: 0.977 Test Loss: 0.085 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.659928321838379
Epoch: 9, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.062 Vali Acc: 0.985 Test Loss: 0.062 Test Acc: 0.985
Validation loss decreased (-0.983983 --> -0.985375).  Saving model ...
Epoch: 10 cost time: 1.630140781402588
Epoch: 10, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.616508960723877
Epoch: 11, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.073 Vali Acc: 0.981 Test Loss: 0.073 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.5599830150604248
Epoch: 12, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.057 Vali Acc: 0.987 Test Loss: 0.057 Test Acc: 0.987
Validation loss decreased (-0.985375 --> -0.986768).  Saving model ...
Epoch: 13 cost time: 1.644571304321289
Epoch: 13, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.7570149898529053
Epoch: 14, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.6681358814239502
Epoch: 15, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.137 Vali Acc: 0.975 Test Loss: 0.137 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.6936256885528564
Epoch: 16, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.093 Vali Acc: 0.979 Test Loss: 0.093 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.5204272270202637
Epoch: 17, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.6703040599822998
Epoch: 18, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.066 Vali Acc: 0.984 Test Loss: 0.066 Test Acc: 0.984
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.5898840427398682
Epoch: 19, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.7505476474761963
Epoch: 20, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.107 Vali Acc: 0.975 Test Loss: 0.107 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.633847951889038
Epoch: 21, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.6109261512756348
Epoch: 22, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.143 Vali Acc: 0.971 Test Loss: 0.143 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim256_nb1_lk13_sk5_ffr2_ps46_str23_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9867688022284122
model parameter : 937748
model size : 3.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.236358880996704
Epoch: 1, Steps: 89 | Train Loss: 1.001 Vali Loss: 0.279 Vali Acc: 0.933 Test Loss: 0.279 Test Acc: 0.933
Validation loss decreased (inf --> -0.933145).  Saving model ...
Epoch: 2 cost time: 1.3697483539581299
Epoch: 2, Steps: 89 | Train Loss: 0.211 Vali Loss: 0.222 Vali Acc: 0.939 Test Loss: 0.222 Test Acc: 0.939
Validation loss decreased (-0.933145 --> -0.939413).  Saving model ...
Epoch: 3 cost time: 1.647817850112915
Epoch: 3, Steps: 89 | Train Loss: 0.128 Vali Loss: 0.196 Vali Acc: 0.951 Test Loss: 0.196 Test Acc: 0.951
Validation loss decreased (-0.939413 --> -0.950555).  Saving model ...
Epoch: 4 cost time: 1.599074125289917
Epoch: 4, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.199 Vali Acc: 0.960 Test Loss: 0.199 Test Acc: 0.960
Validation loss decreased (-0.950555 --> -0.960304).  Saving model ...
Epoch: 5 cost time: 1.728402853012085
Epoch: 5, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.163 Vali Acc: 0.967 Test Loss: 0.163 Test Acc: 0.967
Validation loss decreased (-0.960304 --> -0.966572).  Saving model ...
Epoch: 6 cost time: 1.4591777324676514
Epoch: 6, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.303 Vali Acc: 0.946 Test Loss: 0.303 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3555753231048584
Epoch: 7, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.199 Vali Acc: 0.959 Test Loss: 0.199 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.6442220211029053
Epoch: 8, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.195 Vali Acc: 0.969 Test Loss: 0.195 Test Acc: 0.969
Validation loss decreased (-0.966572 --> -0.969357).  Saving model ...
Epoch: 9 cost time: 1.5802576541900635
Epoch: 9, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.220 Vali Acc: 0.966 Test Loss: 0.220 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6107823848724365
Epoch: 10, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.217 Vali Acc: 0.969 Test Loss: 0.217 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.451228380203247
Epoch: 11, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.201 Vali Acc: 0.975 Test Loss: 0.201 Test Acc: 0.975
Validation loss decreased (-0.969357 --> -0.974928).  Saving model ...
Epoch: 12 cost time: 1.6224291324615479
Epoch: 12, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.350 Vali Acc: 0.950 Test Loss: 0.350 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.714970588684082
Epoch: 13, Steps: 89 | Train Loss: 0.137 Vali Loss: 0.377 Vali Acc: 0.951 Test Loss: 0.377 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.8086755275726318
Epoch: 14, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.318 Vali Acc: 0.967 Test Loss: 0.318 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.637939691543579
Epoch: 15, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.261 Vali Acc: 0.974 Test Loss: 0.261 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.3956553936004639
Epoch: 16, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.238 Vali Acc: 0.974 Test Loss: 0.238 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.7730133533477783
Epoch: 17, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.261 Vali Acc: 0.972 Test Loss: 0.261 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.7586240768432617
Epoch: 18, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.241 Vali Acc: 0.976 Test Loss: 0.241 Test Acc: 0.976
Validation loss decreased (-0.974928 --> -0.976321).  Saving model ...
Epoch: 19 cost time: 1.7136294841766357
Epoch: 19, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.280 Vali Acc: 0.967 Test Loss: 0.280 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.5256850719451904
Epoch: 20, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.272 Vali Acc: 0.974 Test Loss: 0.272 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.553269863128662
Epoch: 21, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.256 Vali Acc: 0.978 Test Loss: 0.256 Test Acc: 0.978
Validation loss decreased (-0.976321 --> -0.977713).  Saving model ...
Epoch: 22 cost time: 1.7265465259552002
Epoch: 22, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.268 Vali Acc: 0.978 Test Loss: 0.268 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.6206152439117432
Epoch: 23, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.305 Vali Acc: 0.974 Test Loss: 0.305 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.580155372619629
Epoch: 24, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.346 Vali Acc: 0.972 Test Loss: 0.346 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.4367785453796387
Epoch: 25, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.281 Vali Acc: 0.974 Test Loss: 0.281 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.681849718093872
Epoch: 26, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.291 Vali Acc: 0.975 Test Loss: 0.291 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.7674877643585205
Epoch: 27, Steps: 89 | Train Loss: 0.148 Vali Loss: 0.484 Vali Acc: 0.946 Test Loss: 0.484 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.673997163772583
Epoch: 28, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.340 Vali Acc: 0.977 Test Loss: 0.340 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.6077797412872314
Epoch: 29, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.323 Vali Acc: 0.971 Test Loss: 0.323 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.4117457866668701
Epoch: 30, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.312 Vali Acc: 0.976 Test Loss: 0.312 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.5886363983154297
Epoch: 31, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.335 Vali Acc: 0.974 Test Loss: 0.335 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9777158774373259
model parameter : 674068
model size : 2.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.2385165691375732
Epoch: 1, Steps: 89 | Train Loss: 1.190 Vali Loss: 0.372 Vali Acc: 0.895 Test Loss: 0.372 Test Acc: 0.895
Validation loss decreased (inf --> -0.894843).  Saving model ...
Epoch: 2 cost time: 1.3332040309906006
Epoch: 2, Steps: 89 | Train Loss: 0.225 Vali Loss: 0.281 Vali Acc: 0.923 Test Loss: 0.281 Test Acc: 0.923
Validation loss decreased (-0.894843 --> -0.922699).  Saving model ...
Epoch: 3 cost time: 1.4519834518432617
Epoch: 3, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.168 Vali Acc: 0.956 Test Loss: 0.168 Test Acc: 0.956
Validation loss decreased (-0.922699 --> -0.956126).  Saving model ...
Epoch: 4 cost time: 1.4218082427978516
Epoch: 4, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.127 Vali Acc: 0.964 Test Loss: 0.127 Test Acc: 0.964
Validation loss decreased (-0.956126 --> -0.964483).  Saving model ...
Epoch: 5 cost time: 1.4099962711334229
Epoch: 5, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.116 Vali Acc: 0.975 Test Loss: 0.116 Test Acc: 0.975
Validation loss decreased (-0.964483 --> -0.974929).  Saving model ...
Epoch: 6 cost time: 1.4310753345489502
Epoch: 6, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.114 Vali Acc: 0.974 Test Loss: 0.114 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2837092876434326
Epoch: 7, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.110 Vali Acc: 0.978 Test Loss: 0.110 Test Acc: 0.978
Validation loss decreased (-0.974929 --> -0.977715).  Saving model ...
Epoch: 8 cost time: 1.418360948562622
Epoch: 8, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.149 Vali Acc: 0.964 Test Loss: 0.149 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5230584144592285
Epoch: 9, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.123 Vali Acc: 0.975 Test Loss: 0.123 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.4748694896697998
Epoch: 10, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.178 Vali Acc: 0.964 Test Loss: 0.178 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.5244231224060059
Epoch: 11, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.289 Vali Acc: 0.940 Test Loss: 0.289 Test Acc: 0.940
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.5059785842895508
Epoch: 12, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.206 Vali Acc: 0.969 Test Loss: 0.206 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.3200390338897705
Epoch: 13, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.168 Vali Acc: 0.976 Test Loss: 0.168 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.5226020812988281
Epoch: 14, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.129 Vali Acc: 0.983 Test Loss: 0.129 Test Acc: 0.983
Validation loss decreased (-0.977715 --> -0.982589).  Saving model ...
Epoch: 15 cost time: 1.6516809463500977
Epoch: 15, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.188 Vali Acc: 0.969 Test Loss: 0.188 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4428362846374512
Epoch: 16, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.171 Vali Acc: 0.977 Test Loss: 0.171 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.3868849277496338
Epoch: 17, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.299 Vali Acc: 0.961 Test Loss: 0.299 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.268275499343872
Epoch: 18, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.184 Vali Acc: 0.976 Test Loss: 0.184 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.5614781379699707
Epoch: 19, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.649 Vali Acc: 0.933 Test Loss: 0.649 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.4780094623565674
Epoch: 20, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.276 Vali Acc: 0.971 Test Loss: 0.276 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.547361135482788
Epoch: 21, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.269 Vali Acc: 0.966 Test Loss: 0.269 Test Acc: 0.966
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.4595563411712646
Epoch: 22, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.172 Vali Acc: 0.974 Test Loss: 0.172 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.4250969886779785
Epoch: 23, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.201 Vali Acc: 0.977 Test Loss: 0.201 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.5374228954315186
Epoch: 24, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.200 Vali Acc: 0.978 Test Loss: 0.200 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9825905292479109
model parameter : 490388
model size : 1.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps14_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.164557456970215
Epoch: 1, Steps: 89 | Train Loss: 1.321 Vali Loss: 0.424 Vali Acc: 0.899 Test Loss: 0.424 Test Acc: 0.899
Validation loss decreased (inf --> -0.899021).  Saving model ...
Epoch: 2 cost time: 1.3187968730926514
Epoch: 2, Steps: 89 | Train Loss: 0.243 Vali Loss: 0.254 Vali Acc: 0.924 Test Loss: 0.254 Test Acc: 0.924
Validation loss decreased (-0.899021 --> -0.924092).  Saving model ...
Epoch: 3 cost time: 1.4081459045410156
Epoch: 3, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.121 Vali Acc: 0.969 Test Loss: 0.121 Test Acc: 0.969
Validation loss decreased (-0.924092 --> -0.969358).  Saving model ...
Epoch: 4 cost time: 1.5278115272521973
Epoch: 4, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.099 Vali Acc: 0.976 Test Loss: 0.099 Test Acc: 0.976
Validation loss decreased (-0.969358 --> -0.975626).  Saving model ...
Epoch: 5 cost time: 1.451725721359253
Epoch: 5, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.119 Vali Acc: 0.968 Test Loss: 0.119 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5198628902435303
Epoch: 6, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.105 Vali Acc: 0.971 Test Loss: 0.105 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.3739063739776611
Epoch: 7, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.152 Vali Acc: 0.962 Test Loss: 0.152 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.5122435092926025
Epoch: 8, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.117 Vali Acc: 0.969 Test Loss: 0.117 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.5455992221832275
Epoch: 9, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.113 Vali Acc: 0.975 Test Loss: 0.113 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.52081298828125
Epoch: 10, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.125 Vali Acc: 0.974 Test Loss: 0.125 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.595738172531128
Epoch: 11, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.134 Vali Acc: 0.969 Test Loss: 0.134 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.4159660339355469
Epoch: 12, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.123 Vali Acc: 0.975 Test Loss: 0.123 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.3249537944793701
Epoch: 13, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.111 Vali Acc: 0.979 Test Loss: 0.111 Test Acc: 0.979
Validation loss decreased (-0.975626 --> -0.979108).  Saving model ...
Epoch: 14 cost time: 1.2475786209106445
Epoch: 14, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.090 Vali Acc: 0.985 Test Loss: 0.090 Test Acc: 0.985
Validation loss decreased (-0.979108 --> -0.984679).  Saving model ...
Epoch: 15 cost time: 1.3287653923034668
Epoch: 15, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.129 Vali Acc: 0.976 Test Loss: 0.129 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.279775619506836
Epoch: 16, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.151 Vali Acc: 0.974 Test Loss: 0.151 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.4763977527618408
Epoch: 17, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.171 Vali Acc: 0.971 Test Loss: 0.171 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.5030429363250732
Epoch: 18, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.144 Vali Acc: 0.975 Test Loss: 0.144 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.5346910953521729
Epoch: 19, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.148 Vali Acc: 0.977 Test Loss: 0.148 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.4105801582336426
Epoch: 20, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.113 Vali Acc: 0.984 Test Loss: 0.113 Test Acc: 0.984
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.3520917892456055
Epoch: 21, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.103 Vali Acc: 0.983 Test Loss: 0.103 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.5741372108459473
Epoch: 22, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.130 Vali Acc: 0.979 Test Loss: 0.130 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.5017311573028564
Epoch: 23, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.271 Vali Acc: 0.963 Test Loss: 0.271 Test Acc: 0.963
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.417957067489624
Epoch: 24, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.129 Vali Acc: 0.979 Test Loss: 0.129 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps14_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9846796657381616
model parameter : 414100
model size : 1.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps19_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.213385820388794
Epoch: 1, Steps: 89 | Train Loss: 1.484 Vali Loss: 0.520 Vali Acc: 0.864 Test Loss: 0.520 Test Acc: 0.864
Validation loss decreased (inf --> -0.863505).  Saving model ...
Epoch: 2 cost time: 1.3057703971862793
Epoch: 2, Steps: 89 | Train Loss: 0.307 Vali Loss: 0.232 Vali Acc: 0.937 Test Loss: 0.232 Test Acc: 0.937
Validation loss decreased (-0.863505 --> -0.937324).  Saving model ...
Epoch: 3 cost time: 1.3876850605010986
Epoch: 3, Steps: 89 | Train Loss: 0.133 Vali Loss: 0.132 Vali Acc: 0.964 Test Loss: 0.132 Test Acc: 0.964
Validation loss decreased (-0.937324 --> -0.964483).  Saving model ...
Epoch: 4 cost time: 1.3869245052337646
Epoch: 4, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.102 Vali Acc: 0.975 Test Loss: 0.102 Test Acc: 0.975
Validation loss decreased (-0.964483 --> -0.974929).  Saving model ...
Epoch: 5 cost time: 1.4690628051757812
Epoch: 5, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.974929 --> -0.977019).  Saving model ...
Epoch: 6 cost time: 1.3604645729064941
Epoch: 6, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.977019 --> -0.983286).  Saving model ...
Epoch: 7 cost time: 1.413330316543579
Epoch: 7, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.083 Vali Acc: 0.979 Test Loss: 0.083 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.342789888381958
Epoch: 8, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.3989450931549072
Epoch: 9, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.119 Vali Acc: 0.963 Test Loss: 0.119 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.3749911785125732
Epoch: 10, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.4141559600830078
Epoch: 11, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.115 Vali Acc: 0.978 Test Loss: 0.115 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.365429162979126
Epoch: 12, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.377457618713379
Epoch: 13, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.341200590133667
Epoch: 14, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.153 Vali Acc: 0.964 Test Loss: 0.153 Test Acc: 0.964
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.3144199848175049
Epoch: 15, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.105 Vali Acc: 0.979 Test Loss: 0.105 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.3186359405517578
Epoch: 16, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.133 Vali Acc: 0.978 Test Loss: 0.133 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps19_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9832869080779945
model parameter : 353300
model size : 1.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps28_str14_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.1335926055908203
Epoch: 1, Steps: 89 | Train Loss: 1.645 Vali Loss: 0.615 Vali Acc: 0.859 Test Loss: 0.615 Test Acc: 0.859
Validation loss decreased (inf --> -0.859325).  Saving model ...
Epoch: 2 cost time: 1.3409860134124756
Epoch: 2, Steps: 89 | Train Loss: 0.382 Vali Loss: 0.314 Vali Acc: 0.912 Test Loss: 0.314 Test Acc: 0.912
Validation loss decreased (-0.859325 --> -0.911557).  Saving model ...
Epoch: 3 cost time: 1.4684269428253174
Epoch: 3, Steps: 89 | Train Loss: 0.157 Vali Loss: 0.155 Vali Acc: 0.964 Test Loss: 0.155 Test Acc: 0.964
Validation loss decreased (-0.911557 --> -0.964483).  Saving model ...
Epoch: 4 cost time: 1.3351798057556152
Epoch: 4, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.114 Vali Acc: 0.974 Test Loss: 0.114 Test Acc: 0.974
Validation loss decreased (-0.964483 --> -0.973536).  Saving model ...
Epoch: 5 cost time: 1.2857112884521484
Epoch: 5, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.086 Vali Acc: 0.978 Test Loss: 0.086 Test Acc: 0.978
Validation loss decreased (-0.973536 --> -0.978411).  Saving model ...
Epoch: 6 cost time: 1.1975114345550537
Epoch: 6, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.082 Vali Acc: 0.974 Test Loss: 0.082 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4760627746582031
Epoch: 7, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.086 Vali Acc: 0.978 Test Loss: 0.086 Test Acc: 0.978
Validation loss decreased (-0.978411 --> -0.978411).  Saving model ...
Epoch: 8 cost time: 1.2442853450775146
Epoch: 8, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.070 Vali Acc: 0.985 Test Loss: 0.070 Test Acc: 0.985
Validation loss decreased (-0.978411 --> -0.984679).  Saving model ...
Epoch: 9 cost time: 1.4876153469085693
Epoch: 9, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.075 Vali Acc: 0.981 Test Loss: 0.075 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2447702884674072
Epoch: 10, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.075 Vali Acc: 0.979 Test Loss: 0.075 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.319944143295288
Epoch: 11, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.067 Vali Acc: 0.984 Test Loss: 0.067 Test Acc: 0.984
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.3361120223999023
Epoch: 12, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.072 Vali Acc: 0.981 Test Loss: 0.072 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.3190484046936035
Epoch: 13, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.072 Vali Acc: 0.985 Test Loss: 0.072 Test Acc: 0.985
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.3271405696868896
Epoch: 14, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.4433672428131104
Epoch: 15, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.062 Vali Acc: 0.984 Test Loss: 0.062 Test Acc: 0.984
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.314460277557373
Epoch: 16, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.985 Test Loss: 0.074 Test Acc: 0.985
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.3740630149841309
Epoch: 17, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.2870123386383057
Epoch: 18, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.094 Vali Acc: 0.976 Test Loss: 0.094 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps28_str14_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9846796657381616
model parameter : 316052
model size : 1.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps37_str19_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.3585352897644043
Epoch: 1, Steps: 89 | Train Loss: 1.790 Vali Loss: 0.758 Vali Acc: 0.838 Test Loss: 0.758 Test Acc: 0.838
Validation loss decreased (inf --> -0.837736).  Saving model ...
Epoch: 2 cost time: 1.225984811782837
Epoch: 2, Steps: 89 | Train Loss: 0.481 Vali Loss: 0.305 Vali Acc: 0.934 Test Loss: 0.305 Test Acc: 0.934
Validation loss decreased (-0.837736 --> -0.933841).  Saving model ...
Epoch: 3 cost time: 1.3279507160186768
Epoch: 3, Steps: 89 | Train Loss: 0.203 Vali Loss: 0.159 Vali Acc: 0.965 Test Loss: 0.159 Test Acc: 0.965
Validation loss decreased (-0.933841 --> -0.965179).  Saving model ...
Epoch: 4 cost time: 1.3710815906524658
Epoch: 4, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.126 Vali Acc: 0.969 Test Loss: 0.126 Test Acc: 0.969
Validation loss decreased (-0.965179 --> -0.969358).  Saving model ...
Epoch: 5 cost time: 1.270921230316162
Epoch: 5, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.097 Vali Acc: 0.976 Test Loss: 0.097 Test Acc: 0.976
Validation loss decreased (-0.969358 --> -0.975626).  Saving model ...
Epoch: 6 cost time: 1.3345980644226074
Epoch: 6, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.086 Vali Acc: 0.979 Test Loss: 0.086 Test Acc: 0.979
Validation loss decreased (-0.975626 --> -0.979108).  Saving model ...
Epoch: 7 cost time: 1.3582022190093994
Epoch: 7, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.106 Vali Acc: 0.969 Test Loss: 0.106 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3443844318389893
Epoch: 8, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.104 Vali Acc: 0.978 Test Loss: 0.104 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4382731914520264
Epoch: 9, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.099 Vali Acc: 0.978 Test Loss: 0.099 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.3446314334869385
Epoch: 10, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.072 Vali Acc: 0.985 Test Loss: 0.072 Test Acc: 0.985
Validation loss decreased (-0.979108 --> -0.984679).  Saving model ...
Epoch: 11 cost time: 1.2722716331481934
Epoch: 11, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.074 Vali Acc: 0.984 Test Loss: 0.074 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3836686611175537
Epoch: 12, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.339378833770752
Epoch: 13, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.110 Vali Acc: 0.967 Test Loss: 0.110 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.264080286026001
Epoch: 14, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.105 Vali Acc: 0.971 Test Loss: 0.105 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.234910249710083
Epoch: 15, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.074 Vali Acc: 0.985 Test Loss: 0.074 Test Acc: 0.985
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.4336233139038086
Epoch: 16, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.2313477993011475
Epoch: 17, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.069 Vali Acc: 0.981 Test Loss: 0.069 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.3557875156402588
Epoch: 18, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.4419870376586914
Epoch: 19, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.065 Vali Acc: 0.985 Test Loss: 0.065 Test Acc: 0.985
Validation loss decreased (-0.984679 --> -0.985375).  Saving model ...
Epoch: 20 cost time: 1.344736099243164
Epoch: 20, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.064 Vali Acc: 0.984 Test Loss: 0.064 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.4633560180664062
Epoch: 21, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.066 Vali Acc: 0.987 Test Loss: 0.066 Test Acc: 0.987
Validation loss decreased (-0.985375 --> -0.986768).  Saving model ...
Epoch: 22 cost time: 1.3011085987091064
Epoch: 22, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.4113430976867676
Epoch: 23, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.985 Test Loss: 0.070 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.3421838283538818
Epoch: 24, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.985 Test Loss: 0.068 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.2910077571868896
Epoch: 25, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.987 Test Loss: 0.068 Test Acc: 0.987
Validation loss decreased (-0.986768 --> -0.987465).  Saving model ...
Epoch: 26 cost time: 1.3890409469604492
Epoch: 26, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.987 Test Loss: 0.068 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.2419497966766357
Epoch: 27, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.985 Test Loss: 0.069 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.472080945968628
Epoch: 28, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.063 Vali Acc: 0.988 Test Loss: 0.063 Test Acc: 0.988
Validation loss decreased (-0.987465 --> -0.988161).  Saving model ...
Epoch: 29 cost time: 1.3728861808776855
Epoch: 29, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.987 Test Loss: 0.064 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.4328999519348145
Epoch: 30, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.157 Vali Acc: 0.967 Test Loss: 0.157 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.3258979320526123
Epoch: 31, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.439 Vali Acc: 0.928 Test Loss: 0.439 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.3548858165740967
Epoch: 32, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.193 Vali Acc: 0.965 Test Loss: 0.193 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.4302306175231934
Epoch: 33, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.182 Vali Acc: 0.965 Test Loss: 0.182 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.4498255252838135
Epoch: 34, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.138 Vali Acc: 0.976 Test Loss: 0.138 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.3896644115447998
Epoch: 35, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.147 Vali Acc: 0.970 Test Loss: 0.147 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.32450270652771
Epoch: 36, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.157 Vali Acc: 0.969 Test Loss: 0.157 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.2331554889678955
Epoch: 37, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.097 Vali Acc: 0.981 Test Loss: 0.097 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.5054619312286377
Epoch: 38, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.091 Vali Acc: 0.982 Test Loss: 0.091 Test Acc: 0.982
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps37_str19_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9881615598885793
model parameter : 286484
model size : 1.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps46_str23_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.265306234359741
Epoch: 1, Steps: 89 | Train Loss: 1.946 Vali Loss: 0.883 Vali Acc: 0.825 Test Loss: 0.883 Test Acc: 0.825
Validation loss decreased (inf --> -0.824504).  Saving model ...
Epoch: 2 cost time: 1.4198806285858154
Epoch: 2, Steps: 89 | Train Loss: 0.544 Vali Loss: 0.336 Vali Acc: 0.925 Test Loss: 0.336 Test Acc: 0.925
Validation loss decreased (-0.824504 --> -0.925484).  Saving model ...
Epoch: 3 cost time: 1.473325252532959
Epoch: 3, Steps: 89 | Train Loss: 0.239 Vali Loss: 0.186 Vali Acc: 0.961 Test Loss: 0.186 Test Acc: 0.961
Validation loss decreased (-0.925484 --> -0.961001).  Saving model ...
Epoch: 4 cost time: 1.5173685550689697
Epoch: 4, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.126 Vali Acc: 0.968 Test Loss: 0.126 Test Acc: 0.968
Validation loss decreased (-0.961001 --> -0.967965).  Saving model ...
Epoch: 5 cost time: 1.3717408180236816
Epoch: 5, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.109 Vali Acc: 0.974 Test Loss: 0.109 Test Acc: 0.974
Validation loss decreased (-0.967965 --> -0.974233).  Saving model ...
Epoch: 6 cost time: 1.2966251373291016
Epoch: 6, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.086 Vali Acc: 0.981 Test Loss: 0.086 Test Acc: 0.981
Validation loss decreased (-0.974233 --> -0.980501).  Saving model ...
Epoch: 7 cost time: 1.3810482025146484
Epoch: 7, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
Validation loss decreased (-0.980501 --> -0.982590).  Saving model ...
Epoch: 8 cost time: 1.3064887523651123
Epoch: 8, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.155 Vali Acc: 0.955 Test Loss: 0.155 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5341126918792725
Epoch: 9, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.982590 --> -0.983286).  Saving model ...
Epoch: 10 cost time: 1.2921538352966309
Epoch: 10, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.071 Vali Acc: 0.984 Test Loss: 0.071 Test Acc: 0.984
Validation loss decreased (-0.983286 --> -0.983983).  Saving model ...
Epoch: 11 cost time: 1.319105625152588
Epoch: 11, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.054 Vali Acc: 0.986 Test Loss: 0.054 Test Acc: 0.986
Validation loss decreased (-0.983983 --> -0.986072).  Saving model ...
Epoch: 12 cost time: 1.300661325454712
Epoch: 12, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.310246467590332
Epoch: 13, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.056 Vali Acc: 0.984 Test Loss: 0.056 Test Acc: 0.984
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.3376307487487793
Epoch: 14, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.064 Vali Acc: 0.978 Test Loss: 0.064 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.406510591506958
Epoch: 15, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.079 Vali Acc: 0.976 Test Loss: 0.079 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.2619059085845947
Epoch: 16, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.065 Vali Acc: 0.985 Test Loss: 0.065 Test Acc: 0.985
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.3607959747314453
Epoch: 17, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.059 Vali Acc: 0.985 Test Loss: 0.059 Test Acc: 0.985
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.3581724166870117
Epoch: 18, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.3193359375
Epoch: 19, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.059 Vali Acc: 0.986 Test Loss: 0.059 Test Acc: 0.986
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.3079216480255127
Epoch: 20, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.059 Vali Acc: 0.985 Test Loss: 0.059 Test Acc: 0.985
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.3798120021820068
Epoch: 21, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.080 Vali Acc: 0.979 Test Loss: 0.080 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128_nb1_lk13_sk5_ffr2_ps46_str23_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9860724233983287
model parameter : 272276
model size : 1.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.11708402633667
Epoch: 1, Steps: 89 | Train Loss: 1.227 Vali Loss: 0.407 Vali Acc: 0.887 Test Loss: 0.407 Test Acc: 0.887
Validation loss decreased (inf --> -0.887183).  Saving model ...
Epoch: 2 cost time: 1.160050630569458
Epoch: 2, Steps: 89 | Train Loss: 0.242 Vali Loss: 0.252 Vali Acc: 0.934 Test Loss: 0.252 Test Acc: 0.934
Validation loss decreased (-0.887183 --> -0.933841).  Saving model ...
Epoch: 3 cost time: 1.1955437660217285
Epoch: 3, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.146 Vali Acc: 0.964 Test Loss: 0.146 Test Acc: 0.964
Validation loss decreased (-0.933841 --> -0.964483).  Saving model ...
Epoch: 4 cost time: 1.3046369552612305
Epoch: 4, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.144 Vali Acc: 0.960 Test Loss: 0.144 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2429499626159668
Epoch: 5, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.150 Vali Acc: 0.961 Test Loss: 0.150 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2858412265777588
Epoch: 6, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.141 Vali Acc: 0.964 Test Loss: 0.141 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.2366948127746582
Epoch: 7, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.126 Vali Acc: 0.975 Test Loss: 0.126 Test Acc: 0.975
Validation loss decreased (-0.964483 --> -0.974929).  Saving model ...
Epoch: 8 cost time: 1.2598350048065186
Epoch: 8, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.118 Vali Acc: 0.978 Test Loss: 0.118 Test Acc: 0.978
Validation loss decreased (-0.974929 --> -0.978411).  Saving model ...
Epoch: 9 cost time: 1.1940538883209229
Epoch: 9, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2205333709716797
Epoch: 10, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.156 Vali Acc: 0.969 Test Loss: 0.156 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.273468017578125
Epoch: 11, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.190 Vali Acc: 0.963 Test Loss: 0.190 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.3329548835754395
Epoch: 12, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.317 Vali Acc: 0.961 Test Loss: 0.317 Test Acc: 0.961
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.3407299518585205
Epoch: 13, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.217 Vali Acc: 0.964 Test Loss: 0.217 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.3460755348205566
Epoch: 14, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.231 Vali Acc: 0.962 Test Loss: 0.231 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.2454712390899658
Epoch: 15, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.200 Vali Acc: 0.969 Test Loss: 0.200 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.2399678230285645
Epoch: 16, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.242 Vali Acc: 0.964 Test Loss: 0.242 Test Acc: 0.964
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.3352129459381104
Epoch: 17, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.189 Vali Acc: 0.975 Test Loss: 0.189 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.2880501747131348
Epoch: 18, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.207 Vali Acc: 0.976 Test Loss: 0.207 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9784122562674095
model parameter : 287892
model size : 1.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.1551711559295654
Epoch: 1, Steps: 89 | Train Loss: 1.497 Vali Loss: 0.552 Vali Acc: 0.854 Test Loss: 0.552 Test Acc: 0.854
Validation loss decreased (inf --> -0.854451).  Saving model ...
Epoch: 2 cost time: 1.3112082481384277
Epoch: 2, Steps: 89 | Train Loss: 0.324 Vali Loss: 0.232 Vali Acc: 0.949 Test Loss: 0.232 Test Acc: 0.949
Validation loss decreased (-0.854451 --> -0.949162).  Saving model ...
Epoch: 3 cost time: 1.1953752040863037
Epoch: 3, Steps: 89 | Train Loss: 0.146 Vali Loss: 0.188 Vali Acc: 0.942 Test Loss: 0.188 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.232679843902588
Epoch: 4, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.126 Vali Acc: 0.969 Test Loss: 0.126 Test Acc: 0.969
Validation loss decreased (-0.949162 --> -0.968662).  Saving model ...
Epoch: 5 cost time: 1.3671588897705078
Epoch: 5, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.107 Vali Acc: 0.971 Test Loss: 0.107 Test Acc: 0.971
Validation loss decreased (-0.968662 --> -0.971447).  Saving model ...
Epoch: 6 cost time: 1.295074701309204
Epoch: 6, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.090 Vali Acc: 0.974 Test Loss: 0.090 Test Acc: 0.974
Validation loss decreased (-0.971447 --> -0.974233).  Saving model ...
Epoch: 7 cost time: 1.1712007522583008
Epoch: 7, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.121 Vali Acc: 0.971 Test Loss: 0.121 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2768549919128418
Epoch: 8, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.118 Vali Acc: 0.976 Test Loss: 0.118 Test Acc: 0.976
Validation loss decreased (-0.974233 --> -0.975626).  Saving model ...
Epoch: 9 cost time: 1.2282769680023193
Epoch: 9, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.106 Vali Acc: 0.978 Test Loss: 0.106 Test Acc: 0.978
Validation loss decreased (-0.975626 --> -0.977715).  Saving model ...
Epoch: 10 cost time: 1.1788904666900635
Epoch: 10, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.089 Vali Acc: 0.981 Test Loss: 0.089 Test Acc: 0.981
Validation loss decreased (-0.977715 --> -0.981197).  Saving model ...
Epoch: 11 cost time: 1.2557179927825928
Epoch: 11, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.127 Vali Acc: 0.974 Test Loss: 0.127 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.365065574645996
Epoch: 12, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.102 Vali Acc: 0.978 Test Loss: 0.102 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2399542331695557
Epoch: 13, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.2748074531555176
Epoch: 14, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.981197 --> -0.982590).  Saving model ...
Epoch: 15 cost time: 1.2128829956054688
Epoch: 15, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.091 Vali Acc: 0.978 Test Loss: 0.091 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2700517177581787
Epoch: 16, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.978 Test Loss: 0.088 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.347198724746704
Epoch: 17, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.982590 --> -0.983286).  Saving model ...
Epoch: 18 cost time: 1.2861874103546143
Epoch: 18, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.114 Vali Acc: 0.976 Test Loss: 0.114 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.336925745010376
Epoch: 19, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.121 Vali Acc: 0.979 Test Loss: 0.121 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1499137878417969
Epoch: 20, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.140 Vali Acc: 0.975 Test Loss: 0.140 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.2525579929351807
Epoch: 21, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.145 Vali Acc: 0.968 Test Loss: 0.145 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.2999272346496582
Epoch: 22, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.152 Vali Acc: 0.965 Test Loss: 0.152 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.2509019374847412
Epoch: 23, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.180 Vali Acc: 0.965 Test Loss: 0.180 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.353208303451538
Epoch: 24, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.128 Vali Acc: 0.980 Test Loss: 0.128 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.2370522022247314
Epoch: 25, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.124 Vali Acc: 0.983 Test Loss: 0.124 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.227586269378662
Epoch: 26, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.121 Vali Acc: 0.983 Test Loss: 0.121 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.3406803607940674
Epoch: 27, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.156 Vali Acc: 0.977 Test Loss: 0.156 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9832869080779945
model parameter : 196052
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps14_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.301865339279175
Epoch: 1, Steps: 89 | Train Loss: 1.713 Vali Loss: 0.674 Vali Acc: 0.843 Test Loss: 0.674 Test Acc: 0.843
Validation loss decreased (inf --> -0.842612).  Saving model ...
Epoch: 2 cost time: 1.3090205192565918
Epoch: 2, Steps: 89 | Train Loss: 0.413 Vali Loss: 0.309 Vali Acc: 0.929 Test Loss: 0.309 Test Acc: 0.929
Validation loss decreased (-0.842612 --> -0.928966).  Saving model ...
Epoch: 3 cost time: 1.3225924968719482
Epoch: 3, Steps: 89 | Train Loss: 0.182 Vali Loss: 0.168 Vali Acc: 0.955 Test Loss: 0.168 Test Acc: 0.955
Validation loss decreased (-0.928966 --> -0.955430).  Saving model ...
Epoch: 4 cost time: 1.3370082378387451
Epoch: 4, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.124 Vali Acc: 0.970 Test Loss: 0.124 Test Acc: 0.970
Validation loss decreased (-0.955430 --> -0.970054).  Saving model ...
Epoch: 5 cost time: 1.2262775897979736
Epoch: 5, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
Validation loss decreased (-0.970054 --> -0.979804).  Saving model ...
Epoch: 6 cost time: 1.1540040969848633
Epoch: 6, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.126 Vali Acc: 0.965 Test Loss: 0.126 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.351930856704712
Epoch: 7, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.105 Vali Acc: 0.973 Test Loss: 0.105 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.3526551723480225
Epoch: 8, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.092 Vali Acc: 0.978 Test Loss: 0.092 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.278573751449585
Epoch: 9, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.3302788734436035
Epoch: 10, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.077 Vali Acc: 0.981 Test Loss: 0.077 Test Acc: 0.981
Validation loss decreased (-0.979804 --> -0.980501).  Saving model ...
Epoch: 11 cost time: 1.1528401374816895
Epoch: 11, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2587401866912842
Epoch: 12, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.37457275390625
Epoch: 13, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.095 Vali Acc: 0.978 Test Loss: 0.095 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.2928364276885986
Epoch: 14, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.122 Vali Acc: 0.975 Test Loss: 0.122 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.3407135009765625
Epoch: 15, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
Validation loss decreased (-0.980501 --> -0.983286).  Saving model ...
Epoch: 16 cost time: 1.1686387062072754
Epoch: 16, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.085 Vali Acc: 0.985 Test Loss: 0.085 Test Acc: 0.985
Validation loss decreased (-0.983286 --> -0.984679).  Saving model ...
Epoch: 17 cost time: 1.2357921600341797
Epoch: 17, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3323872089385986
Epoch: 18, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.099 Vali Acc: 0.981 Test Loss: 0.099 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.3405280113220215
Epoch: 19, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.984 Test Loss: 0.082 Test Acc: 0.984
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.3305683135986328
Epoch: 20, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.2347502708435059
Epoch: 21, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.985 Test Loss: 0.083 Test Acc: 0.985
Validation loss decreased (-0.984679 --> -0.984679).  Saving model ...
Epoch: 22 cost time: 1.189805507659912
Epoch: 22, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.286501169204712
Epoch: 23, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.984 Test Loss: 0.082 Test Acc: 0.984
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.3098905086517334
Epoch: 24, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.984 Test Loss: 0.083 Test Acc: 0.984
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.3183012008666992
Epoch: 25, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.984 Test Loss: 0.081 Test Acc: 0.984
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.1689717769622803
Epoch: 26, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.985 Test Loss: 0.086 Test Acc: 0.985
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.1150753498077393
Epoch: 27, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.983 Test Loss: 0.087 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.1968164443969727
Epoch: 28, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.164 Vali Acc: 0.967 Test Loss: 0.164 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.2259485721588135
Epoch: 29, Steps: 89 | Train Loss: 0.130 Vali Loss: 0.129 Vali Acc: 0.971 Test Loss: 0.129 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.2063345909118652
Epoch: 30, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.162 Vali Acc: 0.970 Test Loss: 0.162 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.2627747058868408
Epoch: 31, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.145 Vali Acc: 0.979 Test Loss: 0.145 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps14_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9846796657381616
model parameter : 157908
model size : 0.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps19_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 1.92987060546875
Epoch: 1, Steps: 89 | Train Loss: 1.884 Vali Loss: 0.836 Vali Acc: 0.831 Test Loss: 0.836 Test Acc: 0.831
Validation loss decreased (inf --> -0.830772).  Saving model ...
Epoch: 2 cost time: 1.1932826042175293
Epoch: 2, Steps: 89 | Train Loss: 0.515 Vali Loss: 0.358 Vali Acc: 0.919 Test Loss: 0.358 Test Acc: 0.919
Validation loss decreased (-0.830772 --> -0.919216).  Saving model ...
Epoch: 3 cost time: 1.1621944904327393
Epoch: 3, Steps: 89 | Train Loss: 0.234 Vali Loss: 0.194 Vali Acc: 0.958 Test Loss: 0.194 Test Acc: 0.958
Validation loss decreased (-0.919216 --> -0.958215).  Saving model ...
Epoch: 4 cost time: 1.2301390171051025
Epoch: 4, Steps: 89 | Train Loss: 0.120 Vali Loss: 0.126 Vali Acc: 0.971 Test Loss: 0.126 Test Acc: 0.971
Validation loss decreased (-0.958215 --> -0.970751).  Saving model ...
Epoch: 5 cost time: 1.0963046550750732
Epoch: 5, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.102 Vali Acc: 0.974 Test Loss: 0.102 Test Acc: 0.974
Validation loss decreased (-0.970751 --> -0.973537).  Saving model ...
Epoch: 6 cost time: 1.1009564399719238
Epoch: 6, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.973537 --> -0.979804).  Saving model ...
Epoch: 7 cost time: 1.3090615272521973
Epoch: 7, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.074 Vali Acc: 0.982 Test Loss: 0.074 Test Acc: 0.982
Validation loss decreased (-0.979804 --> -0.981893).  Saving model ...
Epoch: 8 cost time: 1.3311538696289062
Epoch: 8, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
Validation loss decreased (-0.981893 --> -0.982590).  Saving model ...
Epoch: 9 cost time: 1.1678802967071533
Epoch: 9, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.080 Vali Acc: 0.982 Test Loss: 0.080 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2821125984191895
Epoch: 10, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.067 Vali Acc: 0.985 Test Loss: 0.067 Test Acc: 0.985
Validation loss decreased (-0.982590 --> -0.984679).  Saving model ...
Epoch: 11 cost time: 1.204146385192871
Epoch: 11, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.055 Vali Acc: 0.986 Test Loss: 0.055 Test Acc: 0.986
Validation loss decreased (-0.984679 --> -0.986072).  Saving model ...
Epoch: 12 cost time: 1.06673002243042
Epoch: 12, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2340800762176514
Epoch: 13, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.090 Vali Acc: 0.978 Test Loss: 0.090 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.291090965270996
Epoch: 14, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.086 Vali Acc: 0.981 Test Loss: 0.086 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.1723778247833252
Epoch: 15, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.072 Vali Acc: 0.985 Test Loss: 0.072 Test Acc: 0.985
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.1285247802734375
Epoch: 16, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.090 Vali Acc: 0.974 Test Loss: 0.090 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.175746202468872
Epoch: 17, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.0905303955078125
Epoch: 18, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.2684721946716309
Epoch: 19, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.111 Vali Acc: 0.978 Test Loss: 0.111 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.2789020538330078
Epoch: 20, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.112 Vali Acc: 0.972 Test Loss: 0.112 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.2623062133789062
Epoch: 21, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.093 Vali Acc: 0.983 Test Loss: 0.093 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps19_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9860724233983287
model parameter : 127508
model size : 0.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps28_str14_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 1.9232771396636963
Epoch: 1, Steps: 89 | Train Loss: 2.047 Vali Loss: 1.021 Vali Acc: 0.805 Test Loss: 1.021 Test Acc: 0.805
Validation loss decreased (inf --> -0.805004).  Saving model ...
Epoch: 2 cost time: 1.2480523586273193
Epoch: 2, Steps: 89 | Train Loss: 0.642 Vali Loss: 0.423 Vali Acc: 0.913 Test Loss: 0.423 Test Acc: 0.913
Validation loss decreased (-0.805004 --> -0.912948).  Saving model ...
Epoch: 3 cost time: 1.2585012912750244
Epoch: 3, Steps: 89 | Train Loss: 0.284 Vali Loss: 0.218 Vali Acc: 0.948 Test Loss: 0.218 Test Acc: 0.948
Validation loss decreased (-0.912948 --> -0.948466).  Saving model ...
Epoch: 4 cost time: 1.3251011371612549
Epoch: 4, Steps: 89 | Train Loss: 0.147 Vali Loss: 0.132 Vali Acc: 0.971 Test Loss: 0.132 Test Acc: 0.971
Validation loss decreased (-0.948466 --> -0.970751).  Saving model ...
Epoch: 5 cost time: 1.2578685283660889
Epoch: 5, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.109 Vali Acc: 0.972 Test Loss: 0.109 Test Acc: 0.972
Validation loss decreased (-0.970751 --> -0.972144).  Saving model ...
Epoch: 6 cost time: 1.227480173110962
Epoch: 6, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.099 Vali Acc: 0.978 Test Loss: 0.099 Test Acc: 0.978
Validation loss decreased (-0.972144 --> -0.978411).  Saving model ...
Epoch: 7 cost time: 1.1865170001983643
Epoch: 7, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.082 Vali Acc: 0.974 Test Loss: 0.082 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.160186767578125
Epoch: 8, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.088 Vali Acc: 0.975 Test Loss: 0.088 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.25185227394104
Epoch: 9, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.068 Vali Acc: 0.981 Test Loss: 0.068 Test Acc: 0.981
Validation loss decreased (-0.978411 --> -0.981197).  Saving model ...
Epoch: 10 cost time: 1.2668063640594482
Epoch: 10, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2486283779144287
Epoch: 11, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.068 Vali Acc: 0.980 Test Loss: 0.068 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.3107359409332275
Epoch: 12, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.057 Vali Acc: 0.985 Test Loss: 0.057 Test Acc: 0.985
Validation loss decreased (-0.981197 --> -0.985375).  Saving model ...
Epoch: 13 cost time: 1.22147536277771
Epoch: 13, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.056 Vali Acc: 0.983 Test Loss: 0.056 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1110973358154297
Epoch: 14, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.2263808250427246
Epoch: 15, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.100 Vali Acc: 0.975 Test Loss: 0.100 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.323225736618042
Epoch: 16, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.060 Vali Acc: 0.985 Test Loss: 0.060 Test Acc: 0.985
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.214454174041748
Epoch: 17, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.070 Vali Acc: 0.981 Test Loss: 0.070 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.3793833255767822
Epoch: 18, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.066 Vali Acc: 0.985 Test Loss: 0.066 Test Acc: 0.985
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.2748754024505615
Epoch: 19, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.065 Vali Acc: 0.985 Test Loss: 0.065 Test Acc: 0.985
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.264620304107666
Epoch: 20, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.062 Vali Acc: 0.985 Test Loss: 0.062 Test Acc: 0.985
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.1807780265808105
Epoch: 21, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.062 Vali Acc: 0.985 Test Loss: 0.062 Test Acc: 0.985
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.2573931217193604
Epoch: 22, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.075 Vali Acc: 0.981 Test Loss: 0.075 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps28_str14_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9853760445682451
model parameter : 108884
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps37_str19_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.3485827445983887
Epoch: 1, Steps: 89 | Train Loss: 2.210 Vali Loss: 1.288 Vali Acc: 0.776 Test Loss: 1.288 Test Acc: 0.776
Validation loss decreased (inf --> -0.775753).  Saving model ...
Epoch: 2 cost time: 1.1991534233093262
Epoch: 2, Steps: 89 | Train Loss: 0.821 Vali Loss: 0.537 Vali Acc: 0.891 Test Loss: 0.537 Test Acc: 0.891
Validation loss decreased (-0.775753 --> -0.891360).  Saving model ...
Epoch: 3 cost time: 1.1255016326904297
Epoch: 3, Steps: 89 | Train Loss: 0.389 Vali Loss: 0.305 Vali Acc: 0.918 Test Loss: 0.305 Test Acc: 0.918
Validation loss decreased (-0.891360 --> -0.917824).  Saving model ...
Epoch: 4 cost time: 1.0338492393493652
Epoch: 4, Steps: 89 | Train Loss: 0.209 Vali Loss: 0.183 Vali Acc: 0.960 Test Loss: 0.183 Test Acc: 0.960
Validation loss decreased (-0.917824 --> -0.959608).  Saving model ...
Epoch: 5 cost time: 1.192445993423462
Epoch: 5, Steps: 89 | Train Loss: 0.123 Vali Loss: 0.123 Vali Acc: 0.974 Test Loss: 0.123 Test Acc: 0.974
Validation loss decreased (-0.959608 --> -0.973536).  Saving model ...
Epoch: 6 cost time: 1.1727354526519775
Epoch: 6, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.121 Vali Acc: 0.965 Test Loss: 0.121 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3557825088500977
Epoch: 7, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.095 Vali Acc: 0.971 Test Loss: 0.095 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.3052818775177002
Epoch: 8, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
Validation loss decreased (-0.973536 --> -0.979804).  Saving model ...
Epoch: 9 cost time: 1.132707118988037
Epoch: 9, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.068 Vali Acc: 0.985 Test Loss: 0.068 Test Acc: 0.985
Validation loss decreased (-0.979804 --> -0.984679).  Saving model ...
Epoch: 10 cost time: 1.228996753692627
Epoch: 10, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1573505401611328
Epoch: 11, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.061 Vali Acc: 0.983 Test Loss: 0.061 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2172949314117432
Epoch: 12, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.060 Vali Acc: 0.983 Test Loss: 0.060 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.2019824981689453
Epoch: 13, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.073 Vali Acc: 0.979 Test Loss: 0.073 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.2747642993927002
Epoch: 14, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.061 Vali Acc: 0.985 Test Loss: 0.061 Test Acc: 0.985
Validation loss decreased (-0.984679 --> -0.984679).  Saving model ...
Epoch: 15 cost time: 1.1253793239593506
Epoch: 15, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.189910888671875
Epoch: 16, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.064 Vali Acc: 0.984 Test Loss: 0.064 Test Acc: 0.984
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0701918601989746
Epoch: 17, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.057 Vali Acc: 0.987 Test Loss: 0.057 Test Acc: 0.987
Validation loss decreased (-0.984679 --> -0.986768).  Saving model ...
Epoch: 18 cost time: 1.199918270111084
Epoch: 18, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.053 Vali Acc: 0.990 Test Loss: 0.053 Test Acc: 0.990
Validation loss decreased (-0.986768 --> -0.989554).  Saving model ...
Epoch: 19 cost time: 1.2165777683258057
Epoch: 19, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.061 Vali Acc: 0.985 Test Loss: 0.061 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.148268222808838
Epoch: 20, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.2380876541137695
Epoch: 21, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.2816390991210938
Epoch: 22, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.086 Vali Acc: 0.974 Test Loss: 0.086 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.1538338661193848
Epoch: 23, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.116 Vali Acc: 0.974 Test Loss: 0.116 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.283820629119873
Epoch: 24, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.130 Vali Acc: 0.968 Test Loss: 0.130 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.202871561050415
Epoch: 25, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.2295811176300049
Epoch: 26, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.055 Vali Acc: 0.985 Test Loss: 0.055 Test Acc: 0.985
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.2408528327941895
Epoch: 27, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.068 Vali Acc: 0.986 Test Loss: 0.068 Test Acc: 0.986
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.1609916687011719
Epoch: 28, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.102 Vali Acc: 0.979 Test Loss: 0.102 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps37_str19_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9895543175487466
model parameter : 94100
model size : 0.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps46_str23_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.23166823387146
Epoch: 1, Steps: 89 | Train Loss: 2.364 Vali Loss: 1.460 Vali Acc: 0.760 Test Loss: 1.460 Test Acc: 0.760
Validation loss decreased (inf --> -0.760431).  Saving model ...
Epoch: 2 cost time: 1.2417547702789307
Epoch: 2, Steps: 89 | Train Loss: 0.962 Vali Loss: 0.645 Vali Acc: 0.870 Test Loss: 0.645 Test Acc: 0.870
Validation loss decreased (-0.760431 --> -0.869771).  Saving model ...
Epoch: 3 cost time: 1.1797387599945068
Epoch: 3, Steps: 89 | Train Loss: 0.466 Vali Loss: 0.360 Vali Acc: 0.922 Test Loss: 0.360 Test Acc: 0.922
Validation loss decreased (-0.869771 --> -0.922002).  Saving model ...
Epoch: 4 cost time: 1.2828729152679443
Epoch: 4, Steps: 89 | Train Loss: 0.253 Vali Loss: 0.219 Vali Acc: 0.951 Test Loss: 0.219 Test Acc: 0.951
Validation loss decreased (-0.922002 --> -0.951251).  Saving model ...
Epoch: 5 cost time: 1.2841956615447998
Epoch: 5, Steps: 89 | Train Loss: 0.151 Vali Loss: 0.155 Vali Acc: 0.961 Test Loss: 0.155 Test Acc: 0.961
Validation loss decreased (-0.951251 --> -0.961001).  Saving model ...
Epoch: 6 cost time: 1.1536221504211426
Epoch: 6, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.113 Vali Acc: 0.978 Test Loss: 0.113 Test Acc: 0.978
Validation loss decreased (-0.961001 --> -0.978411).  Saving model ...
Epoch: 7 cost time: 1.1827094554901123
Epoch: 7, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.090 Vali Acc: 0.979 Test Loss: 0.090 Test Acc: 0.979
Validation loss decreased (-0.978411 --> -0.979108).  Saving model ...
Epoch: 8 cost time: 1.2213208675384521
Epoch: 8, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.098 Vali Acc: 0.971 Test Loss: 0.098 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.211148738861084
Epoch: 9, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2019329071044922
Epoch: 10, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.080 Vali Acc: 0.981 Test Loss: 0.080 Test Acc: 0.981
Validation loss decreased (-0.979108 --> -0.980501).  Saving model ...
Epoch: 11 cost time: 1.3426613807678223
Epoch: 11, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.097 Vali Acc: 0.971 Test Loss: 0.097 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.180701494216919
Epoch: 12, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.259636640548706
Epoch: 13, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.061 Vali Acc: 0.987 Test Loss: 0.061 Test Acc: 0.987
Validation loss decreased (-0.980501 --> -0.986768).  Saving model ...
Epoch: 14 cost time: 1.26841139793396
Epoch: 14, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.065 Vali Acc: 0.985 Test Loss: 0.065 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.334998369216919
Epoch: 15, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.062 Vali Acc: 0.983 Test Loss: 0.062 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.209111213684082
Epoch: 16, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.3184876441955566
Epoch: 17, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.076 Vali Acc: 0.985 Test Loss: 0.076 Test Acc: 0.985
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.1863775253295898
Epoch: 18, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.1940765380859375
Epoch: 19, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.085263729095459
Epoch: 20, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.2228589057922363
Epoch: 21, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.084 Vali Acc: 0.981 Test Loss: 0.084 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.255263090133667
Epoch: 22, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.066 Vali Acc: 0.985 Test Loss: 0.066 Test Acc: 0.985
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.1403093338012695
Epoch: 23, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.065 Vali Acc: 0.987 Test Loss: 0.065 Test Acc: 0.987
Validation loss decreased (-0.986768 --> -0.987465).  Saving model ...
Epoch: 24 cost time: 1.1259222030639648
Epoch: 24, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.278226613998413
Epoch: 25, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.081 Vali Acc: 0.981 Test Loss: 0.081 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.2414064407348633
Epoch: 26, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.1628139019012451
Epoch: 27, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.2850713729858398
Epoch: 28, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.078 Vali Acc: 0.985 Test Loss: 0.078 Test Acc: 0.985
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.176379680633545
Epoch: 29, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.073 Vali Acc: 0.985 Test Loss: 0.073 Test Acc: 0.985
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.3320949077606201
Epoch: 30, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.3007488250732422
Epoch: 31, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.985 Test Loss: 0.076 Test Acc: 0.985
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.2755424976348877
Epoch: 32, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.083 Vali Acc: 0.985 Test Loss: 0.083 Test Acc: 0.985
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.2272241115570068
Epoch: 33, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.089 Vali Acc: 0.985 Test Loss: 0.089 Test Acc: 0.985
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64_nb1_lk13_sk5_ffr2_ps46_str23_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9874651810584958
model parameter : 86996
model size : 0.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 1.9648339748382568
Epoch: 1, Steps: 89 | Train Loss: 1.605 Vali Loss: 0.574 Vali Acc: 0.881 Test Loss: 0.574 Test Acc: 0.881
Validation loss decreased (inf --> -0.880913).  Saving model ...
Epoch: 2 cost time: 1.2103140354156494
Epoch: 2, Steps: 89 | Train Loss: 0.360 Vali Loss: 0.254 Vali Acc: 0.940 Test Loss: 0.254 Test Acc: 0.940
Validation loss decreased (-0.880913 --> -0.940109).  Saving model ...
Epoch: 3 cost time: 1.2073051929473877
Epoch: 3, Steps: 89 | Train Loss: 0.154 Vali Loss: 0.153 Vali Acc: 0.965 Test Loss: 0.153 Test Acc: 0.965
Validation loss decreased (-0.940109 --> -0.965180).  Saving model ...
Epoch: 4 cost time: 1.221203088760376
Epoch: 4, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.121 Vali Acc: 0.970 Test Loss: 0.121 Test Acc: 0.970
Validation loss decreased (-0.965180 --> -0.970055).  Saving model ...
Epoch: 5 cost time: 1.1230742931365967
Epoch: 5, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.103 Vali Acc: 0.972 Test Loss: 0.103 Test Acc: 0.972
Validation loss decreased (-0.970055 --> -0.972144).  Saving model ...
Epoch: 6 cost time: 1.2482006549835205
Epoch: 6, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.972144 --> -0.977019).  Saving model ...
Epoch: 7 cost time: 1.1398367881774902
Epoch: 7, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.130 Vali Acc: 0.961 Test Loss: 0.130 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.173445463180542
Epoch: 8, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.106 Vali Acc: 0.976 Test Loss: 0.106 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2833778858184814
Epoch: 9, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.090 Vali Acc: 0.981 Test Loss: 0.090 Test Acc: 0.981
Validation loss decreased (-0.977019 --> -0.980500).  Saving model ...
Epoch: 10 cost time: 1.170907735824585
Epoch: 10, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.096 Vali Acc: 0.978 Test Loss: 0.096 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1279010772705078
Epoch: 11, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.28912353515625
Epoch: 12, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.087 Vali Acc: 0.981 Test Loss: 0.087 Test Acc: 0.981
Validation loss decreased (-0.980500 --> -0.981197).  Saving model ...
Epoch: 13 cost time: 1.0708322525024414
Epoch: 13, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.086 Vali Acc: 0.982 Test Loss: 0.086 Test Acc: 0.982
Validation loss decreased (-0.981197 --> -0.981893).  Saving model ...
Epoch: 14 cost time: 1.1468863487243652
Epoch: 14, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.085 Vali Acc: 0.979 Test Loss: 0.085 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1547071933746338
Epoch: 15, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
Validation loss decreased (-0.981893 --> -0.982590).  Saving model ...
Epoch: 16 cost time: 1.0998637676239014
Epoch: 16, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.099 Vali Acc: 0.982 Test Loss: 0.099 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1269185543060303
Epoch: 17, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.098 Vali Acc: 0.981 Test Loss: 0.098 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.215869665145874
Epoch: 18, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.141 Vali Acc: 0.975 Test Loss: 0.141 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.2035961151123047
Epoch: 19, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.125 Vali Acc: 0.975 Test Loss: 0.125 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.2550804615020752
Epoch: 20, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.200 Vali Acc: 0.961 Test Loss: 0.200 Test Acc: 0.961
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.158886194229126
Epoch: 21, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.179 Vali Acc: 0.964 Test Loss: 0.179 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.085477590560913
Epoch: 22, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.153 Vali Acc: 0.973 Test Loss: 0.153 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.2421674728393555
Epoch: 23, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.193 Vali Acc: 0.967 Test Loss: 0.193 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.3926982879638672
Epoch: 24, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.152 Vali Acc: 0.976 Test Loss: 0.152 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.265408992767334
Epoch: 25, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.182 Vali Acc: 0.971 Test Loss: 0.182 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9825905292479109
model parameter : 131668
model size : 0.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.167577028274536
Epoch: 1, Steps: 89 | Train Loss: 1.916 Vali Loss: 0.854 Vali Acc: 0.847 Test Loss: 0.854 Test Acc: 0.847
Validation loss decreased (inf --> -0.847484).  Saving model ...
Epoch: 2 cost time: 1.1198585033416748
Epoch: 2, Steps: 89 | Train Loss: 0.530 Vali Loss: 0.352 Vali Acc: 0.920 Test Loss: 0.352 Test Acc: 0.920
Validation loss decreased (-0.847484 --> -0.919913).  Saving model ...
Epoch: 3 cost time: 1.205082654953003
Epoch: 3, Steps: 89 | Train Loss: 0.246 Vali Loss: 0.226 Vali Acc: 0.950 Test Loss: 0.226 Test Acc: 0.950
Validation loss decreased (-0.919913 --> -0.949858).  Saving model ...
Epoch: 4 cost time: 1.115497350692749
Epoch: 4, Steps: 89 | Train Loss: 0.132 Vali Loss: 0.156 Vali Acc: 0.965 Test Loss: 0.156 Test Acc: 0.965
Validation loss decreased (-0.949858 --> -0.965180).  Saving model ...
Epoch: 5 cost time: 1.1411700248718262
Epoch: 5, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.113 Vali Acc: 0.974 Test Loss: 0.113 Test Acc: 0.974
Validation loss decreased (-0.965180 --> -0.973536).  Saving model ...
Epoch: 6 cost time: 1.2221448421478271
Epoch: 6, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.093 Vali Acc: 0.975 Test Loss: 0.093 Test Acc: 0.975
Validation loss decreased (-0.973536 --> -0.974929).  Saving model ...
Epoch: 7 cost time: 1.2536606788635254
Epoch: 7, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.084 Vali Acc: 0.981 Test Loss: 0.084 Test Acc: 0.981
Validation loss decreased (-0.974929 --> -0.981197).  Saving model ...
Epoch: 8 cost time: 1.188575267791748
Epoch: 8, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.096 Vali Acc: 0.979 Test Loss: 0.096 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2099735736846924
Epoch: 9, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.098 Vali Acc: 0.978 Test Loss: 0.098 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.137303352355957
Epoch: 10, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.081 Vali Acc: 0.981 Test Loss: 0.081 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.1533565521240234
Epoch: 11, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.1859147548675537
Epoch: 12, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.077 Vali Acc: 0.981 Test Loss: 0.077 Test Acc: 0.981
Validation loss decreased (-0.981197 --> -0.981197).  Saving model ...
Epoch: 13 cost time: 1.0924720764160156
Epoch: 13, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.095 Vali Acc: 0.978 Test Loss: 0.095 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2119159698486328
Epoch: 14, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.071 Vali Acc: 0.984 Test Loss: 0.071 Test Acc: 0.984
Validation loss decreased (-0.981197 --> -0.983983).  Saving model ...
Epoch: 15 cost time: 1.2458877563476562
Epoch: 15, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1056315898895264
Epoch: 16, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.083 Vali Acc: 0.985 Test Loss: 0.083 Test Acc: 0.985
Validation loss decreased (-0.983983 --> -0.985375).  Saving model ...
Epoch: 17 cost time: 1.2057783603668213
Epoch: 17, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1425881385803223
Epoch: 18, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.2209875583648682
Epoch: 19, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.984 Test Loss: 0.080 Test Acc: 0.984
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.2025554180145264
Epoch: 20, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.078 Vali Acc: 0.984 Test Loss: 0.078 Test Acc: 0.984
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.2054924964904785
Epoch: 21, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.071 Vali Acc: 0.985 Test Loss: 0.071 Test Acc: 0.985
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.148909091949463
Epoch: 22, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.074 Vali Acc: 0.985 Test Loss: 0.074 Test Acc: 0.985
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.157820463180542
Epoch: 23, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.085 Vali Acc: 0.981 Test Loss: 0.085 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.1914782524108887
Epoch: 24, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.085 Vali Acc: 0.985 Test Loss: 0.085 Test Acc: 0.985
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.2119643688201904
Epoch: 25, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.102 Vali Acc: 0.981 Test Loss: 0.102 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.1612184047698975
Epoch: 26, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.123 Vali Acc: 0.973 Test Loss: 0.123 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9853760445682451
model parameter : 85748
model size : 0.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps14_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 1.9478116035461426
Epoch: 1, Steps: 89 | Train Loss: 2.111 Vali Loss: 1.080 Vali Acc: 0.808 Test Loss: 1.080 Test Acc: 0.808
Validation loss decreased (inf --> -0.807789).  Saving model ...
Epoch: 2 cost time: 1.1750614643096924
Epoch: 2, Steps: 89 | Train Loss: 0.684 Vali Loss: 0.444 Vali Acc: 0.908 Test Loss: 0.444 Test Acc: 0.908
Validation loss decreased (-0.807789 --> -0.908074).  Saving model ...
Epoch: 3 cost time: 1.3281466960906982
Epoch: 3, Steps: 89 | Train Loss: 0.318 Vali Loss: 0.270 Vali Acc: 0.944 Test Loss: 0.270 Test Acc: 0.944
Validation loss decreased (-0.908074 --> -0.944287).  Saving model ...
Epoch: 4 cost time: 1.0849049091339111
Epoch: 4, Steps: 89 | Train Loss: 0.180 Vali Loss: 0.168 Vali Acc: 0.962 Test Loss: 0.168 Test Acc: 0.962
Validation loss decreased (-0.944287 --> -0.962394).  Saving model ...
Epoch: 5 cost time: 1.2277052402496338
Epoch: 5, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.140 Vali Acc: 0.969 Test Loss: 0.140 Test Acc: 0.969
Validation loss decreased (-0.962394 --> -0.969358).  Saving model ...
Epoch: 6 cost time: 1.216264009475708
Epoch: 6, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.099 Vali Acc: 0.974 Test Loss: 0.099 Test Acc: 0.974
Validation loss decreased (-0.969358 --> -0.973537).  Saving model ...
Epoch: 7 cost time: 1.2473273277282715
Epoch: 7, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.098 Vali Acc: 0.976 Test Loss: 0.098 Test Acc: 0.976
Validation loss decreased (-0.973537 --> -0.976322).  Saving model ...
Epoch: 8 cost time: 1.143561840057373
Epoch: 8, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976322 --> -0.977019).  Saving model ...
Epoch: 9 cost time: 1.2248899936676025
Epoch: 9, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.080 Vali Acc: 0.981 Test Loss: 0.080 Test Acc: 0.981
Validation loss decreased (-0.977019 --> -0.980501).  Saving model ...
Epoch: 10 cost time: 1.1221628189086914
Epoch: 10, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.980501 --> -0.982590).  Saving model ...
Epoch: 11 cost time: 1.163590908050537
Epoch: 11, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.071 Vali Acc: 0.984 Test Loss: 0.071 Test Acc: 0.984
Validation loss decreased (-0.982590 --> -0.983983).  Saving model ...
Epoch: 12 cost time: 1.1765329837799072
Epoch: 12, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.111 Vali Acc: 0.971 Test Loss: 0.111 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.177173137664795
Epoch: 13, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.082 Vali Acc: 0.982 Test Loss: 0.082 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2125203609466553
Epoch: 14, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.070 Vali Acc: 0.985 Test Loss: 0.070 Test Acc: 0.985
Validation loss decreased (-0.983983 --> -0.984679).  Saving model ...
Epoch: 15 cost time: 1.1582486629486084
Epoch: 15, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.129856824874878
Epoch: 16, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.2141125202178955
Epoch: 17, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.075 Vali Acc: 0.981 Test Loss: 0.075 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.165384292602539
Epoch: 18, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.104 Vali Acc: 0.976 Test Loss: 0.104 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.2044992446899414
Epoch: 19, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.097 Vali Acc: 0.979 Test Loss: 0.097 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.1509768962860107
Epoch: 20, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.075 Vali Acc: 0.984 Test Loss: 0.075 Test Acc: 0.984
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.1788396835327148
Epoch: 21, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.091 Vali Acc: 0.979 Test Loss: 0.091 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.1865170001983643
Epoch: 22, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.171581506729126
Epoch: 23, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.085 Vali Acc: 0.981 Test Loss: 0.085 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.1011314392089844
Epoch: 24, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps14_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9846796657381616
model parameter : 66676
model size : 0.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps19_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 1.9378910064697266
Epoch: 1, Steps: 89 | Train Loss: 2.372 Vali Loss: 1.406 Vali Acc: 0.732 Test Loss: 1.406 Test Acc: 0.732
Validation loss decreased (inf --> -0.731880).  Saving model ...
Epoch: 2 cost time: 1.267474889755249
Epoch: 2, Steps: 89 | Train Loss: 0.886 Vali Loss: 0.588 Vali Acc: 0.877 Test Loss: 0.588 Test Acc: 0.877
Validation loss decreased (-0.731880 --> -0.877431).  Saving model ...
Epoch: 3 cost time: 1.1607391834259033
Epoch: 3, Steps: 89 | Train Loss: 0.402 Vali Loss: 0.317 Vali Acc: 0.925 Test Loss: 0.317 Test Acc: 0.925
Validation loss decreased (-0.877431 --> -0.924788).  Saving model ...
Epoch: 4 cost time: 1.137676477432251
Epoch: 4, Steps: 89 | Train Loss: 0.228 Vali Loss: 0.202 Vali Acc: 0.952 Test Loss: 0.202 Test Acc: 0.952
Validation loss decreased (-0.924788 --> -0.951948).  Saving model ...
Epoch: 5 cost time: 1.0799362659454346
Epoch: 5, Steps: 89 | Train Loss: 0.141 Vali Loss: 0.161 Vali Acc: 0.963 Test Loss: 0.161 Test Acc: 0.963
Validation loss decreased (-0.951948 --> -0.963090).  Saving model ...
Epoch: 6 cost time: 1.1410911083221436
Epoch: 6, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.106 Vali Acc: 0.974 Test Loss: 0.106 Test Acc: 0.974
Validation loss decreased (-0.963090 --> -0.973537).  Saving model ...
Epoch: 7 cost time: 1.1126537322998047
Epoch: 7, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.104 Vali Acc: 0.975 Test Loss: 0.104 Test Acc: 0.975
Validation loss decreased (-0.973537 --> -0.974929).  Saving model ...
Epoch: 8 cost time: 1.2353949546813965
Epoch: 8, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.080 Vali Acc: 0.981 Test Loss: 0.080 Test Acc: 0.981
Validation loss decreased (-0.974929 --> -0.981197).  Saving model ...
Epoch: 9 cost time: 1.1389729976654053
Epoch: 9, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.091 Vali Acc: 0.978 Test Loss: 0.091 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1380019187927246
Epoch: 10, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.981197 --> -0.982590).  Saving model ...
Epoch: 11 cost time: 1.0914068222045898
Epoch: 11, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.982590 --> -0.983286).  Saving model ...
Epoch: 12 cost time: 1.1601660251617432
Epoch: 12, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1920526027679443
Epoch: 13, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.073 Vali Acc: 0.981 Test Loss: 0.073 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.147975206375122
Epoch: 14, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.078 Vali Acc: 0.984 Test Loss: 0.078 Test Acc: 0.984
Validation loss decreased (-0.983286 --> -0.983983).  Saving model ...
Epoch: 15 cost time: 1.1975631713867188
Epoch: 15, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.103 Vali Acc: 0.969 Test Loss: 0.103 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0862271785736084
Epoch: 16, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.063 Vali Acc: 0.985 Test Loss: 0.063 Test Acc: 0.985
Validation loss decreased (-0.983983 --> -0.984679).  Saving model ...
Epoch: 17 cost time: 1.2164955139160156
Epoch: 17, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.081 Vali Acc: 0.975 Test Loss: 0.081 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1937229633331299
Epoch: 18, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.070 Vali Acc: 0.984 Test Loss: 0.070 Test Acc: 0.984
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.231673240661621
Epoch: 19, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.057 Vali Acc: 0.986 Test Loss: 0.057 Test Acc: 0.986
Validation loss decreased (-0.984679 --> -0.986072).  Saving model ...
Epoch: 20 cost time: 1.246274471282959
Epoch: 20, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.078 Vali Acc: 0.981 Test Loss: 0.078 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.086381435394287
Epoch: 21, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.068 Vali Acc: 0.984 Test Loss: 0.068 Test Acc: 0.984
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.2092616558074951
Epoch: 22, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.172731637954712
Epoch: 23, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.2082366943359375
Epoch: 24, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.067 Vali Acc: 0.986 Test Loss: 0.067 Test Acc: 0.986
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.2585937976837158
Epoch: 25, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.075 Vali Acc: 0.985 Test Loss: 0.075 Test Acc: 0.985
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.2093250751495361
Epoch: 26, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.079 Vali Acc: 0.981 Test Loss: 0.079 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.0988836288452148
Epoch: 27, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.1820461750030518
Epoch: 28, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.066 Vali Acc: 0.985 Test Loss: 0.066 Test Acc: 0.985
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.218540906906128
Epoch: 29, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.095 Vali Acc: 0.981 Test Loss: 0.095 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps19_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9860724233983287
model parameter : 51476
model size : 0.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps28_str14_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.0152575969696045
Epoch: 1, Steps: 89 | Train Loss: 2.516 Vali Loss: 1.685 Vali Acc: 0.680 Test Loss: 1.685 Test Acc: 0.680
Validation loss decreased (inf --> -0.679649).  Saving model ...
Epoch: 2 cost time: 1.2505981922149658
Epoch: 2, Steps: 89 | Train Loss: 1.141 Vali Loss: 0.736 Vali Acc: 0.872 Test Loss: 0.736 Test Acc: 0.872
Validation loss decreased (-0.679649 --> -0.871859).  Saving model ...
Epoch: 3 cost time: 1.1886975765228271
Epoch: 3, Steps: 89 | Train Loss: 0.555 Vali Loss: 0.429 Vali Acc: 0.919 Test Loss: 0.429 Test Acc: 0.919
Validation loss decreased (-0.871859 --> -0.919216).  Saving model ...
Epoch: 4 cost time: 1.2035768032073975
Epoch: 4, Steps: 89 | Train Loss: 0.322 Vali Loss: 0.269 Vali Acc: 0.944 Test Loss: 0.269 Test Acc: 0.944
Validation loss decreased (-0.919216 --> -0.943591).  Saving model ...
Epoch: 5 cost time: 1.155543565750122
Epoch: 5, Steps: 89 | Train Loss: 0.190 Vali Loss: 0.179 Vali Acc: 0.963 Test Loss: 0.179 Test Acc: 0.963
Validation loss decreased (-0.943591 --> -0.963090).  Saving model ...
Epoch: 6 cost time: 1.1016244888305664
Epoch: 6, Steps: 89 | Train Loss: 0.134 Vali Loss: 0.133 Vali Acc: 0.971 Test Loss: 0.133 Test Acc: 0.971
Validation loss decreased (-0.963090 --> -0.971447).  Saving model ...
Epoch: 7 cost time: 1.2331092357635498
Epoch: 7, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.115 Vali Acc: 0.975 Test Loss: 0.115 Test Acc: 0.975
Validation loss decreased (-0.971447 --> -0.974929).  Saving model ...
Epoch: 8 cost time: 1.1789050102233887
Epoch: 8, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.105 Vali Acc: 0.971 Test Loss: 0.105 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0348286628723145
Epoch: 9, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
Validation loss decreased (-0.974929 --> -0.979804).  Saving model ...
Epoch: 10 cost time: 1.1822993755340576
Epoch: 10, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.084 Vali Acc: 0.978 Test Loss: 0.084 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0752840042114258
Epoch: 11, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
Validation loss decreased (-0.979804 --> -0.979804).  Saving model ...
Epoch: 12 cost time: 1.1350500583648682
Epoch: 12, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.979804 --> -0.982590).  Saving model ...
Epoch: 13 cost time: 1.154083013534546
Epoch: 13, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.068 Vali Acc: 0.982 Test Loss: 0.068 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2234244346618652
Epoch: 14, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.074 Vali Acc: 0.985 Test Loss: 0.074 Test Acc: 0.985
Validation loss decreased (-0.982590 --> -0.984679).  Saving model ...
Epoch: 15 cost time: 1.1133544445037842
Epoch: 15, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.061 Vali Acc: 0.981 Test Loss: 0.061 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1627528667449951
Epoch: 16, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.070674180984497
Epoch: 17, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.0831501483917236
Epoch: 18, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.080 Vali Acc: 0.982 Test Loss: 0.080 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.1272525787353516
Epoch: 19, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.071 Vali Acc: 0.981 Test Loss: 0.071 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.08847975730896
Epoch: 20, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.067 Vali Acc: 0.982 Test Loss: 0.067 Test Acc: 0.982
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.1868727207183838
Epoch: 21, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.1410346031188965
Epoch: 22, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.072 Vali Acc: 0.979 Test Loss: 0.072 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.1439483165740967
Epoch: 23, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.057 Vali Acc: 0.983 Test Loss: 0.057 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.1026132106781006
Epoch: 24, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.059 Vali Acc: 0.985 Test Loss: 0.059 Test Acc: 0.985
Validation loss decreased (-0.984679 --> -0.985375).  Saving model ...
Epoch: 25 cost time: 1.190584421157837
Epoch: 25, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.056 Vali Acc: 0.983 Test Loss: 0.056 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.1549713611602783
Epoch: 26, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.055 Vali Acc: 0.987 Test Loss: 0.055 Test Acc: 0.987
Validation loss decreased (-0.985375 --> -0.986768).  Saving model ...
Epoch: 27 cost time: 1.147085428237915
Epoch: 27, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.071 Vali Acc: 0.981 Test Loss: 0.071 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.1994361877441406
Epoch: 28, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.1285231113433838
Epoch: 29, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.070 Vali Acc: 0.985 Test Loss: 0.070 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.148900032043457
Epoch: 30, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.096 Vali Acc: 0.981 Test Loss: 0.096 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.1759061813354492
Epoch: 31, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.130 Vali Acc: 0.971 Test Loss: 0.130 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.1598408222198486
Epoch: 32, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.066 Vali Acc: 0.985 Test Loss: 0.066 Test Acc: 0.985
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.0924072265625
Epoch: 33, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.062 Vali Acc: 0.987 Test Loss: 0.062 Test Acc: 0.987
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.1867961883544922
Epoch: 34, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.068 Vali Acc: 0.985 Test Loss: 0.068 Test Acc: 0.985
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.1322197914123535
Epoch: 35, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.079 Vali Acc: 0.985 Test Loss: 0.079 Test Acc: 0.985
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.2344305515289307
Epoch: 36, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.986 Test Loss: 0.069 Test Acc: 0.986
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps28_str14_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9867688022284122
model parameter : 42164
model size : 0.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps37_str19_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.067749261856079
Epoch: 1, Steps: 89 | Train Loss: 2.585 Vali Loss: 1.932 Vali Acc: 0.630 Test Loss: 1.932 Test Acc: 0.630
Validation loss decreased (inf --> -0.629507).  Saving model ...
Epoch: 2 cost time: 1.196540355682373
Epoch: 2, Steps: 89 | Train Loss: 1.363 Vali Loss: 0.947 Vali Acc: 0.815 Test Loss: 0.947 Test Acc: 0.815
Validation loss decreased (-0.629507 --> -0.815450).  Saving model ...
Epoch: 3 cost time: 1.2080414295196533
Epoch: 3, Steps: 89 | Train Loss: 0.697 Vali Loss: 0.532 Vali Acc: 0.895 Test Loss: 0.532 Test Acc: 0.895
Validation loss decreased (-0.815450 --> -0.894841).  Saving model ...
Epoch: 4 cost time: 1.1605415344238281
Epoch: 4, Steps: 89 | Train Loss: 0.407 Vali Loss: 0.323 Vali Acc: 0.925 Test Loss: 0.323 Test Acc: 0.925
Validation loss decreased (-0.894841 --> -0.924788).  Saving model ...
Epoch: 5 cost time: 1.1150853633880615
Epoch: 5, Steps: 89 | Train Loss: 0.253 Vali Loss: 0.218 Vali Acc: 0.950 Test Loss: 0.218 Test Acc: 0.950
Validation loss decreased (-0.924788 --> -0.949859).  Saving model ...
Epoch: 6 cost time: 1.080963373184204
Epoch: 6, Steps: 89 | Train Loss: 0.179 Vali Loss: 0.171 Vali Acc: 0.963 Test Loss: 0.171 Test Acc: 0.963
Validation loss decreased (-0.949859 --> -0.963090).  Saving model ...
Epoch: 7 cost time: 1.1017184257507324
Epoch: 7, Steps: 89 | Train Loss: 0.129 Vali Loss: 0.140 Vali Acc: 0.969 Test Loss: 0.140 Test Acc: 0.969
Validation loss decreased (-0.963090 --> -0.969358).  Saving model ...
Epoch: 8 cost time: 1.1715879440307617
Epoch: 8, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.121 Vali Acc: 0.974 Test Loss: 0.121 Test Acc: 0.974
Validation loss decreased (-0.969358 --> -0.974233).  Saving model ...
Epoch: 9 cost time: 1.1728487014770508
Epoch: 9, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.098 Vali Acc: 0.983 Test Loss: 0.098 Test Acc: 0.983
Validation loss decreased (-0.974233 --> -0.982590).  Saving model ...
Epoch: 10 cost time: 1.0895447731018066
Epoch: 10, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.094 Vali Acc: 0.979 Test Loss: 0.094 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2414546012878418
Epoch: 11, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.097 Vali Acc: 0.974 Test Loss: 0.097 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2061553001403809
Epoch: 12, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.075 Vali Acc: 0.979 Test Loss: 0.075 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.1953301429748535
Epoch: 13, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
Validation loss decreased (-0.982590 --> -0.982590).  Saving model ...
Epoch: 14 cost time: 1.1104090213775635
Epoch: 14, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.073 Vali Acc: 0.978 Test Loss: 0.073 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2088024616241455
Epoch: 15, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.064 Vali Acc: 0.984 Test Loss: 0.064 Test Acc: 0.984
Validation loss decreased (-0.982590 --> -0.983983).  Saving model ...
Epoch: 16 cost time: 1.2321012020111084
Epoch: 16, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.063 Vali Acc: 0.986 Test Loss: 0.063 Test Acc: 0.986
Validation loss decreased (-0.983983 --> -0.986072).  Saving model ...
Epoch: 17 cost time: 1.1495063304901123
Epoch: 17, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.067 Vali Acc: 0.985 Test Loss: 0.067 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1816823482513428
Epoch: 18, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.082 Vali Acc: 0.979 Test Loss: 0.082 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.123487949371338
Epoch: 19, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.068 Vali Acc: 0.985 Test Loss: 0.068 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.202878713607788
Epoch: 20, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.063 Vali Acc: 0.984 Test Loss: 0.063 Test Acc: 0.984
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.1335477828979492
Epoch: 21, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.1044690608978271
Epoch: 22, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.076 Vali Acc: 0.978 Test Loss: 0.076 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.0385355949401855
Epoch: 23, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.057 Vali Acc: 0.987 Test Loss: 0.057 Test Acc: 0.987
Validation loss decreased (-0.986072 --> -0.986768).  Saving model ...
Epoch: 24 cost time: 1.2199809551239014
Epoch: 24, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.067 Vali Acc: 0.987 Test Loss: 0.067 Test Acc: 0.987
Validation loss decreased (-0.986768 --> -0.987465).  Saving model ...
Epoch: 25 cost time: 1.2129981517791748
Epoch: 25, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.1899378299713135
Epoch: 26, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.057 Vali Acc: 0.986 Test Loss: 0.057 Test Acc: 0.986
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.1634936332702637
Epoch: 27, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.060 Vali Acc: 0.987 Test Loss: 0.060 Test Acc: 0.987
Validation loss decreased (-0.987465 --> -0.987465).  Saving model ...
Epoch: 28 cost time: 1.0849366188049316
Epoch: 28, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.064 Vali Acc: 0.987 Test Loss: 0.064 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.0329699516296387
Epoch: 29, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.094 Vali Acc: 0.975 Test Loss: 0.094 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.1424987316131592
Epoch: 30, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.069 Vali Acc: 0.982 Test Loss: 0.069 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.3278284072875977
Epoch: 31, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.055 Vali Acc: 0.987 Test Loss: 0.055 Test Acc: 0.987
Validation loss decreased (-0.987465 --> -0.987465).  Saving model ...
Epoch: 32 cost time: 1.1305317878723145
Epoch: 32, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.066 Vali Acc: 0.980 Test Loss: 0.066 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.1783862113952637
Epoch: 33, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.057 Vali Acc: 0.990 Test Loss: 0.057 Test Acc: 0.990
Validation loss decreased (-0.987465 --> -0.989554).  Saving model ...
Epoch: 34 cost time: 1.077859878540039
Epoch: 34, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.083 Vali Acc: 0.978 Test Loss: 0.083 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.0843913555145264
Epoch: 35, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.073 Vali Acc: 0.982 Test Loss: 0.073 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.2729263305664062
Epoch: 36, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.067 Vali Acc: 0.981 Test Loss: 0.067 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.1226849555969238
Epoch: 37, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.053 Vali Acc: 0.984 Test Loss: 0.053 Test Acc: 0.984
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.2119934558868408
Epoch: 38, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.064 Vali Acc: 0.985 Test Loss: 0.064 Test Acc: 0.985
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.0432817935943604
Epoch: 39, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.054 Vali Acc: 0.989 Test Loss: 0.054 Test Acc: 0.989
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.0986976623535156
Epoch: 40, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.053 Vali Acc: 0.990 Test Loss: 0.053 Test Acc: 0.990
Validation loss decreased (-0.989554 --> -0.989554).  Saving model ...
Epoch: 41 cost time: 1.1755621433258057
Epoch: 41, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.058 Vali Acc: 0.987 Test Loss: 0.058 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.1844704151153564
Epoch: 42, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.080 Vali Acc: 0.979 Test Loss: 0.080 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.1218030452728271
Epoch: 43, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.057 Vali Acc: 0.988 Test Loss: 0.057 Test Acc: 0.988
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.1710786819458008
Epoch: 44, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.211592674255371
Epoch: 45, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.060 Vali Acc: 0.986 Test Loss: 0.060 Test Acc: 0.986
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.235029697418213
Epoch: 46, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.054 Vali Acc: 0.988 Test Loss: 0.054 Test Acc: 0.988
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.2575716972351074
Epoch: 47, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.058 Vali Acc: 0.987 Test Loss: 0.058 Test Acc: 0.987
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.1793439388275146
Epoch: 48, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.063 Vali Acc: 0.985 Test Loss: 0.063 Test Acc: 0.985
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.1760969161987305
Epoch: 49, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.052 Vali Acc: 0.990 Test Loss: 0.052 Test Acc: 0.990
Validation loss decreased (-0.989554 --> -0.989554).  Saving model ...
Epoch: 50 cost time: 1.1129202842712402
Epoch: 50, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.056 Vali Acc: 0.985 Test Loss: 0.056 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps37_str19_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9895543175487466
model parameter : 34772
model size : 0.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps46_str23_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.0716075897216797
Epoch: 1, Steps: 89 | Train Loss: 2.715 Vali Loss: 2.092 Vali Acc: 0.541 Test Loss: 2.092 Test Acc: 0.541
Validation loss decreased (inf --> -0.541065).  Saving model ...
Epoch: 2 cost time: 1.0568289756774902
Epoch: 2, Steps: 89 | Train Loss: 1.563 Vali Loss: 1.111 Vali Acc: 0.813 Test Loss: 1.111 Test Acc: 0.813
Validation loss decreased (-0.541065 --> -0.813359).  Saving model ...
Epoch: 3 cost time: 1.090442419052124
Epoch: 3, Steps: 89 | Train Loss: 0.837 Vali Loss: 0.642 Vali Acc: 0.868 Test Loss: 0.642 Test Acc: 0.868
Validation loss decreased (-0.813359 --> -0.867682).  Saving model ...
Epoch: 4 cost time: 1.1790506839752197
Epoch: 4, Steps: 89 | Train Loss: 0.502 Vali Loss: 0.399 Vali Acc: 0.909 Test Loss: 0.399 Test Acc: 0.909
Validation loss decreased (-0.867682 --> -0.908770).  Saving model ...
Epoch: 5 cost time: 1.1462700366973877
Epoch: 5, Steps: 89 | Train Loss: 0.334 Vali Loss: 0.285 Vali Acc: 0.939 Test Loss: 0.285 Test Acc: 0.939
Validation loss decreased (-0.908770 --> -0.938716).  Saving model ...
Epoch: 6 cost time: 1.1076858043670654
Epoch: 6, Steps: 89 | Train Loss: 0.232 Vali Loss: 0.212 Vali Acc: 0.953 Test Loss: 0.212 Test Acc: 0.953
Validation loss decreased (-0.938716 --> -0.952644).  Saving model ...
Epoch: 7 cost time: 1.0541460514068604
Epoch: 7, Steps: 89 | Train Loss: 0.181 Vali Loss: 0.158 Vali Acc: 0.968 Test Loss: 0.158 Test Acc: 0.968
Validation loss decreased (-0.952644 --> -0.967965).  Saving model ...
Epoch: 8 cost time: 1.081660270690918
Epoch: 8, Steps: 89 | Train Loss: 0.135 Vali Loss: 0.138 Vali Acc: 0.970 Test Loss: 0.138 Test Acc: 0.970
Validation loss decreased (-0.967965 --> -0.970054).  Saving model ...
Epoch: 9 cost time: 1.1327183246612549
Epoch: 9, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
Validation loss decreased (-0.970054 --> -0.979804).  Saving model ...
Epoch: 10 cost time: 1.2693777084350586
Epoch: 10, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.098 Vali Acc: 0.979 Test Loss: 0.098 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2059900760650635
Epoch: 11, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.091 Vali Acc: 0.979 Test Loss: 0.091 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2572715282440186
Epoch: 12, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.077 Vali Acc: 0.981 Test Loss: 0.077 Test Acc: 0.981
Validation loss decreased (-0.979804 --> -0.980501).  Saving model ...
Epoch: 13 cost time: 1.1989178657531738
Epoch: 13, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.107 Vali Acc: 0.969 Test Loss: 0.107 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2360343933105469
Epoch: 14, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.092 Vali Acc: 0.971 Test Loss: 0.092 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.114255428314209
Epoch: 15, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.2284753322601318
Epoch: 16, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.079 Vali Acc: 0.979 Test Loss: 0.079 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.1400208473205566
Epoch: 17, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.061 Vali Acc: 0.985 Test Loss: 0.061 Test Acc: 0.985
Validation loss decreased (-0.980501 --> -0.984679).  Saving model ...
Epoch: 18 cost time: 1.0802834033966064
Epoch: 18, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.075 Vali Acc: 0.978 Test Loss: 0.075 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0387678146362305
Epoch: 19, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.071 Vali Acc: 0.982 Test Loss: 0.071 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1460778713226318
Epoch: 20, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.075 Vali Acc: 0.978 Test Loss: 0.075 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.1344985961914062
Epoch: 21, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.065 Vali Acc: 0.981 Test Loss: 0.065 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.1869738101959229
Epoch: 22, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.1266560554504395
Epoch: 23, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.070 Vali Acc: 0.982 Test Loss: 0.070 Test Acc: 0.982
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.2734148502349854
Epoch: 24, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.077 Vali Acc: 0.978 Test Loss: 0.077 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.187558889389038
Epoch: 25, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.066 Vali Acc: 0.980 Test Loss: 0.066 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.1235246658325195
Epoch: 26, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.070 Vali Acc: 0.981 Test Loss: 0.070 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.1383099555969238
Epoch: 27, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.059 Vali Acc: 0.984 Test Loss: 0.059 Test Acc: 0.984
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32_nb1_lk13_sk5_ffr2_ps46_str23_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9846796657381616
model parameter : 31220
model size : 0.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.237361192703247
Epoch: 1, Steps: 89 | Train Loss: 2.018 Vali Loss: 0.628 Vali Acc: 0.842 Test Loss: 0.628 Test Acc: 0.842
Validation loss decreased (inf --> -0.841916).  Saving model ...
Epoch: 2 cost time: 2.6613988876342773
Epoch: 2, Steps: 89 | Train Loss: 0.363 Vali Loss: 0.214 Vali Acc: 0.944 Test Loss: 0.214 Test Acc: 0.944
Validation loss decreased (-0.841916 --> -0.944288).  Saving model ...
Epoch: 3 cost time: 2.6140432357788086
Epoch: 3, Steps: 89 | Train Loss: 0.153 Vali Loss: 0.131 Vali Acc: 0.969 Test Loss: 0.131 Test Acc: 0.969
Validation loss decreased (-0.944288 --> -0.968662).  Saving model ...
Epoch: 4 cost time: 2.5883283615112305
Epoch: 4, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.142 Vali Acc: 0.964 Test Loss: 0.142 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.524859666824341
Epoch: 5, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.108 Vali Acc: 0.976 Test Loss: 0.108 Test Acc: 0.976
Validation loss decreased (-0.968662 --> -0.976322).  Saving model ...
Epoch: 6 cost time: 2.5637269020080566
Epoch: 6, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.109 Vali Acc: 0.975 Test Loss: 0.109 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.4299979209899902
Epoch: 7, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.146 Vali Acc: 0.969 Test Loss: 0.146 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.5863142013549805
Epoch: 8, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.092 Vali Acc: 0.978 Test Loss: 0.092 Test Acc: 0.978
Validation loss decreased (-0.976322 --> -0.978411).  Saving model ...
Epoch: 9 cost time: 2.236250877380371
Epoch: 9, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.153 Vali Acc: 0.979 Test Loss: 0.153 Test Acc: 0.979
Validation loss decreased (-0.978411 --> -0.979107).  Saving model ...
Epoch: 10 cost time: 2.422870635986328
Epoch: 10, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.130 Vali Acc: 0.969 Test Loss: 0.130 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.627279758453369
Epoch: 11, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.979107 --> -0.979804).  Saving model ...
Epoch: 12 cost time: 2.5909459590911865
Epoch: 12, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.177 Vali Acc: 0.964 Test Loss: 0.177 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.605945587158203
Epoch: 13, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.120 Vali Acc: 0.978 Test Loss: 0.120 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.893413543701172
Epoch: 14, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.179 Vali Acc: 0.967 Test Loss: 0.179 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.398550033569336
Epoch: 15, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.187 Vali Acc: 0.970 Test Loss: 0.187 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.529690980911255
Epoch: 16, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.146 Vali Acc: 0.977 Test Loss: 0.146 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.503124952316284
Epoch: 17, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.146 Vali Acc: 0.980 Test Loss: 0.146 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.6253299713134766
Epoch: 18, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.174 Vali Acc: 0.975 Test Loss: 0.174 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.39908504486084
Epoch: 19, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.078 Vali Acc: 0.985 Test Loss: 0.078 Test Acc: 0.985
Validation loss decreased (-0.979804 --> -0.984679).  Saving model ...
Epoch: 20 cost time: 2.59981632232666
Epoch: 20, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.192 Vali Acc: 0.971 Test Loss: 0.192 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.774703025817871
Epoch: 21, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.191 Vali Acc: 0.975 Test Loss: 0.191 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.9543519020080566
Epoch: 22, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.097 Vali Acc: 0.984 Test Loss: 0.097 Test Acc: 0.984
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.5608184337615967
Epoch: 23, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.985 Test Loss: 0.098 Test Acc: 0.985
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.569255828857422
Epoch: 24, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.102 Vali Acc: 0.985 Test Loss: 0.102 Test Acc: 0.985
Validation loss decreased (-0.984679 --> -0.985375).  Saving model ...
Epoch: 25 cost time: 2.4314422607421875
Epoch: 25, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.986 Test Loss: 0.103 Test Acc: 0.986
Validation loss decreased (-0.985375 --> -0.986071).  Saving model ...
Epoch: 26 cost time: 2.5660526752471924
Epoch: 26, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.085 Vali Acc: 0.986 Test Loss: 0.085 Test Acc: 0.986
Validation loss decreased (-0.986071 --> -0.986072).  Saving model ...
Epoch: 27 cost time: 2.5485851764678955
Epoch: 27, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.146 Vali Acc: 0.980 Test Loss: 0.146 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.545565366744995
Epoch: 28, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.192 Vali Acc: 0.983 Test Loss: 0.192 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.6360340118408203
Epoch: 29, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.162 Vali Acc: 0.983 Test Loss: 0.162 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.5203874111175537
Epoch: 30, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.191 Vali Acc: 0.976 Test Loss: 0.191 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 2.568894624710083
Epoch: 31, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.216 Vali Acc: 0.975 Test Loss: 0.216 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 2.4820823669433594
Epoch: 32, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.165 Vali Acc: 0.977 Test Loss: 0.165 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 2.6147255897521973
Epoch: 33, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.229 Vali Acc: 0.970 Test Loss: 0.229 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 2.4260966777801514
Epoch: 34, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.285 Vali Acc: 0.973 Test Loss: 0.285 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 2.4723875522613525
Epoch: 35, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.221 Vali Acc: 0.974 Test Loss: 0.221 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 2.6309609413146973
Epoch: 36, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.169 Vali Acc: 0.976 Test Loss: 0.169 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9860724233983287
model parameter : 287316
model size : 1.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.5602805614471436
Epoch: 1, Steps: 89 | Train Loss: 2.385 Vali Loss: 1.093 Vali Acc: 0.798 Test Loss: 1.093 Test Acc: 0.798
Validation loss decreased (inf --> -0.798039).  Saving model ...
Epoch: 2 cost time: 1.9486021995544434
Epoch: 2, Steps: 89 | Train Loss: 0.591 Vali Loss: 0.322 Vali Acc: 0.923 Test Loss: 0.322 Test Acc: 0.923
Validation loss decreased (-0.798039 --> -0.923395).  Saving model ...
Epoch: 3 cost time: 2.4949424266815186
Epoch: 3, Steps: 89 | Train Loss: 0.222 Vali Loss: 0.185 Vali Acc: 0.955 Test Loss: 0.185 Test Acc: 0.955
Validation loss decreased (-0.923395 --> -0.955430).  Saving model ...
Epoch: 4 cost time: 2.4362826347351074
Epoch: 4, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.141 Vali Acc: 0.964 Test Loss: 0.141 Test Acc: 0.964
Validation loss decreased (-0.955430 --> -0.963787).  Saving model ...
Epoch: 5 cost time: 2.3981192111968994
Epoch: 5, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.119 Vali Acc: 0.971 Test Loss: 0.119 Test Acc: 0.971
Validation loss decreased (-0.963787 --> -0.971447).  Saving model ...
Epoch: 6 cost time: 2.3668200969696045
Epoch: 6, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.155 Vali Acc: 0.957 Test Loss: 0.155 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.7166426181793213
Epoch: 7, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.072 Vali Acc: 0.984 Test Loss: 0.072 Test Acc: 0.984
Validation loss decreased (-0.971447 --> -0.983983).  Saving model ...
Epoch: 8 cost time: 2.6173079013824463
Epoch: 8, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.088 Vali Acc: 0.979 Test Loss: 0.088 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.419980049133301
Epoch: 9, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.091 Vali Acc: 0.982 Test Loss: 0.091 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.5957388877868652
Epoch: 10, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.120 Vali Acc: 0.972 Test Loss: 0.120 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.4975392818450928
Epoch: 11, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.477198600769043
Epoch: 12, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.4250128269195557
Epoch: 13, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.091 Vali Acc: 0.984 Test Loss: 0.091 Test Acc: 0.984
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.574983835220337
Epoch: 14, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.120 Vali Acc: 0.976 Test Loss: 0.120 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.5163612365722656
Epoch: 15, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.103 Vali Acc: 0.983 Test Loss: 0.103 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.5249626636505127
Epoch: 16, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.088 Vali Acc: 0.984 Test Loss: 0.088 Test Acc: 0.984
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.504018545150757
Epoch: 17, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.140 Vali Acc: 0.975 Test Loss: 0.140 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.983983286908078
model parameter : 241396
model size : 0.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps14_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.333954095840454
Epoch: 1, Steps: 89 | Train Loss: 2.313 Vali Loss: 1.107 Vali Acc: 0.797 Test Loss: 1.107 Test Acc: 0.797
Validation loss decreased (inf --> -0.797343).  Saving model ...
Epoch: 2 cost time: 2.261087417602539
Epoch: 2, Steps: 89 | Train Loss: 0.581 Vali Loss: 0.329 Vali Acc: 0.912 Test Loss: 0.329 Test Acc: 0.912
Validation loss decreased (-0.797343 --> -0.912253).  Saving model ...
Epoch: 3 cost time: 2.5930097103118896
Epoch: 3, Steps: 89 | Train Loss: 0.217 Vali Loss: 0.146 Vali Acc: 0.969 Test Loss: 0.146 Test Acc: 0.969
Validation loss decreased (-0.912253 --> -0.969358).  Saving model ...
Epoch: 4 cost time: 2.6123247146606445
Epoch: 4, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.109 Vali Acc: 0.975 Test Loss: 0.109 Test Acc: 0.975
Validation loss decreased (-0.969358 --> -0.974929).  Saving model ...
Epoch: 5 cost time: 2.4780349731445312
Epoch: 5, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.118 Vali Acc: 0.962 Test Loss: 0.118 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.466139316558838
Epoch: 6, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.101 Vali Acc: 0.979 Test Loss: 0.101 Test Acc: 0.979
Validation loss decreased (-0.974929 --> -0.979108).  Saving model ...
Epoch: 7 cost time: 2.288724184036255
Epoch: 7, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.080 Vali Acc: 0.978 Test Loss: 0.080 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.4820609092712402
Epoch: 8, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.074 Vali Acc: 0.981 Test Loss: 0.074 Test Acc: 0.981
Validation loss decreased (-0.979108 --> -0.981197).  Saving model ...
Epoch: 9 cost time: 2.2381742000579834
Epoch: 9, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.098 Vali Acc: 0.978 Test Loss: 0.098 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.571113109588623
Epoch: 10, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.098 Vali Acc: 0.976 Test Loss: 0.098 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.5934395790100098
Epoch: 11, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.5107271671295166
Epoch: 12, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.981197 --> -0.983286).  Saving model ...
Epoch: 13 cost time: 2.3759279251098633
Epoch: 13, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.088 Vali Acc: 0.978 Test Loss: 0.088 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.5433948040008545
Epoch: 14, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.105 Vali Acc: 0.975 Test Loss: 0.105 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.9872047901153564
Epoch: 15, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.4500269889831543
Epoch: 16, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.060 Vali Acc: 0.987 Test Loss: 0.060 Test Acc: 0.987
Validation loss decreased (-0.983286 --> -0.987465).  Saving model ...
Epoch: 17 cost time: 2.912254571914673
Epoch: 17, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.109 Vali Acc: 0.980 Test Loss: 0.109 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.6323232650756836
Epoch: 18, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.578665018081665
Epoch: 19, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.125 Vali Acc: 0.974 Test Loss: 0.125 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.3208682537078857
Epoch: 20, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.121 Vali Acc: 0.977 Test Loss: 0.121 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.711759328842163
Epoch: 21, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.141 Vali Acc: 0.978 Test Loss: 0.141 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.5114738941192627
Epoch: 22, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.125 Vali Acc: 0.974 Test Loss: 0.125 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.6477913856506348
Epoch: 23, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.103 Vali Acc: 0.982 Test Loss: 0.103 Test Acc: 0.982
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.483393907546997
Epoch: 24, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.090 Vali Acc: 0.983 Test Loss: 0.090 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.3092007637023926
Epoch: 25, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.108 Vali Acc: 0.981 Test Loss: 0.108 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.690561294555664
Epoch: 26, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.160 Vali Acc: 0.967 Test Loss: 0.160 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps14_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9874651810584958
model parameter : 226164
model size : 0.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps19_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.3762366771698
Epoch: 1, Steps: 89 | Train Loss: 2.520 Vali Loss: 1.590 Vali Acc: 0.730 Test Loss: 1.590 Test Acc: 0.730
Validation loss decreased (inf --> -0.729789).  Saving model ...
Epoch: 2 cost time: 2.6273744106292725
Epoch: 2, Steps: 89 | Train Loss: 0.885 Vali Loss: 0.484 Vali Acc: 0.886 Test Loss: 0.484 Test Acc: 0.886
Validation loss decreased (-0.729789 --> -0.886485).  Saving model ...
Epoch: 3 cost time: 1.7965192794799805
Epoch: 3, Steps: 89 | Train Loss: 0.325 Vali Loss: 0.236 Vali Acc: 0.942 Test Loss: 0.236 Test Acc: 0.942
Validation loss decreased (-0.886485 --> -0.941502).  Saving model ...
Epoch: 4 cost time: 2.349928140640259
Epoch: 4, Steps: 89 | Train Loss: 0.168 Vali Loss: 0.167 Vali Acc: 0.954 Test Loss: 0.167 Test Acc: 0.954
Validation loss decreased (-0.941502 --> -0.954037).  Saving model ...
Epoch: 5 cost time: 2.3115289211273193
Epoch: 5, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.126 Vali Acc: 0.969 Test Loss: 0.126 Test Acc: 0.969
Validation loss decreased (-0.954037 --> -0.969358).  Saving model ...
Epoch: 6 cost time: 2.526719570159912
Epoch: 6, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
Validation loss decreased (-0.969358 --> -0.977019).  Saving model ...
Epoch: 7 cost time: 2.5232443809509277
Epoch: 7, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.104 Vali Acc: 0.975 Test Loss: 0.104 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.4900434017181396
Epoch: 8, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.089 Vali Acc: 0.975 Test Loss: 0.089 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.4637551307678223
Epoch: 9, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.076 Vali Acc: 0.978 Test Loss: 0.076 Test Acc: 0.978
Validation loss decreased (-0.977019 --> -0.977715).  Saving model ...
Epoch: 10 cost time: 1.8901457786560059
Epoch: 10, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.075 Vali Acc: 0.984 Test Loss: 0.075 Test Acc: 0.984
Validation loss decreased (-0.977715 --> -0.983983).  Saving model ...
Epoch: 11 cost time: 2.6510009765625
Epoch: 11, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.085 Vali Acc: 0.982 Test Loss: 0.085 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.2093307971954346
Epoch: 12, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.107 Vali Acc: 0.966 Test Loss: 0.107 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.1685233116149902
Epoch: 13, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.061 Vali Acc: 0.985 Test Loss: 0.061 Test Acc: 0.985
Validation loss decreased (-0.983983 --> -0.985375).  Saving model ...
Epoch: 14 cost time: 2.17897367477417
Epoch: 14, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.070 Vali Acc: 0.985 Test Loss: 0.070 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.254563093185425
Epoch: 15, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.058 Vali Acc: 0.986 Test Loss: 0.058 Test Acc: 0.986
Validation loss decreased (-0.985375 --> -0.986072).  Saving model ...
Epoch: 16 cost time: 2.5647406578063965
Epoch: 16, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.061 Vali Acc: 0.986 Test Loss: 0.061 Test Acc: 0.986
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.418332815170288
Epoch: 17, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.059 Vali Acc: 0.986 Test Loss: 0.059 Test Acc: 0.986
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.373506784439087
Epoch: 18, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.113 Vali Acc: 0.978 Test Loss: 0.113 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.492600917816162
Epoch: 19, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.47784161567688
Epoch: 20, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.116 Vali Acc: 0.975 Test Loss: 0.116 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.30768084526062
Epoch: 21, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.100 Vali Acc: 0.982 Test Loss: 0.100 Test Acc: 0.982
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.442075729370117
Epoch: 22, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.096 Vali Acc: 0.982 Test Loss: 0.096 Test Acc: 0.982
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.4283480644226074
Epoch: 23, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.102 Vali Acc: 0.976 Test Loss: 0.102 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.3858888149261475
Epoch: 24, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.161 Vali Acc: 0.964 Test Loss: 0.161 Test Acc: 0.964
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.4761900901794434
Epoch: 25, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.096 Vali Acc: 0.981 Test Loss: 0.096 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps19_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9860724233983287
model parameter : 210964
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps28_str14_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.2453067302703857
Epoch: 1, Steps: 89 | Train Loss: 2.615 Vali Loss: 1.838 Vali Acc: 0.639 Test Loss: 1.838 Test Acc: 0.639
Validation loss decreased (inf --> -0.638561).  Saving model ...
Epoch: 2 cost time: 2.494448661804199
Epoch: 2, Steps: 89 | Train Loss: 1.051 Vali Loss: 0.556 Vali Acc: 0.877 Test Loss: 0.556 Test Acc: 0.877
Validation loss decreased (-0.638561 --> -0.876735).  Saving model ...
Epoch: 3 cost time: 2.592135429382324
Epoch: 3, Steps: 89 | Train Loss: 0.373 Vali Loss: 0.310 Vali Acc: 0.921 Test Loss: 0.310 Test Acc: 0.921
Validation loss decreased (-0.876735 --> -0.920610).  Saving model ...
Epoch: 4 cost time: 2.607682704925537
Epoch: 4, Steps: 89 | Train Loss: 0.213 Vali Loss: 0.157 Vali Acc: 0.966 Test Loss: 0.157 Test Acc: 0.966
Validation loss decreased (-0.920610 --> -0.965876).  Saving model ...
Epoch: 5 cost time: 2.296276330947876
Epoch: 5, Steps: 89 | Train Loss: 0.121 Vali Loss: 0.117 Vali Acc: 0.972 Test Loss: 0.117 Test Acc: 0.972
Validation loss decreased (-0.965876 --> -0.972144).  Saving model ...
Epoch: 6 cost time: 2.59808349609375
Epoch: 6, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.088 Vali Acc: 0.975 Test Loss: 0.088 Test Acc: 0.975
Validation loss decreased (-0.972144 --> -0.974929).  Saving model ...
Epoch: 7 cost time: 2.6425998210906982
Epoch: 7, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.097 Vali Acc: 0.975 Test Loss: 0.097 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.526759147644043
Epoch: 8, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.066 Vali Acc: 0.982 Test Loss: 0.066 Test Acc: 0.982
Validation loss decreased (-0.974929 --> -0.981893).  Saving model ...
Epoch: 9 cost time: 2.2773962020874023
Epoch: 9, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.062 Vali Acc: 0.985 Test Loss: 0.062 Test Acc: 0.985
Validation loss decreased (-0.981893 --> -0.984679).  Saving model ...
Epoch: 10 cost time: 2.4135642051696777
Epoch: 10, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.055 Vali Acc: 0.988 Test Loss: 0.055 Test Acc: 0.988
Validation loss decreased (-0.984679 --> -0.988161).  Saving model ...
Epoch: 11 cost time: 2.6728949546813965
Epoch: 11, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.064 Vali Acc: 0.982 Test Loss: 0.064 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.668165445327759
Epoch: 12, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.066 Vali Acc: 0.986 Test Loss: 0.066 Test Acc: 0.986
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.643777370452881
Epoch: 13, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.107 Vali Acc: 0.974 Test Loss: 0.107 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.5581140518188477
Epoch: 14, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.094 Vali Acc: 0.975 Test Loss: 0.094 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.6417441368103027
Epoch: 15, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.082 Vali Acc: 0.981 Test Loss: 0.082 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.6473090648651123
Epoch: 16, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.6054916381835938
Epoch: 17, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.080 Vali Acc: 0.981 Test Loss: 0.080 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.3259501457214355
Epoch: 18, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.080 Vali Acc: 0.985 Test Loss: 0.080 Test Acc: 0.985
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.4588212966918945
Epoch: 19, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.064 Vali Acc: 0.988 Test Loss: 0.064 Test Acc: 0.988
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.2767298221588135
Epoch: 20, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.077 Vali Acc: 0.978 Test Loss: 0.077 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps28_str14_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9881615598885793
model parameter : 203572
model size : 0.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps37_str19_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.6121666431427
Epoch: 1, Steps: 89 | Train Loss: 2.661 Vali Loss: 1.999 Vali Acc: 0.605 Test Loss: 1.999 Test Acc: 0.605
Validation loss decreased (inf --> -0.605133).  Saving model ...
Epoch: 2 cost time: 2.368427276611328
Epoch: 2, Steps: 89 | Train Loss: 1.260 Vali Loss: 0.679 Vali Acc: 0.838 Test Loss: 0.679 Test Acc: 0.838
Validation loss decreased (-0.605133 --> -0.838433).  Saving model ...
Epoch: 3 cost time: 2.6976780891418457
Epoch: 3, Steps: 89 | Train Loss: 0.480 Vali Loss: 0.322 Vali Acc: 0.920 Test Loss: 0.322 Test Acc: 0.920
Validation loss decreased (-0.838433 --> -0.919913).  Saving model ...
Epoch: 4 cost time: 2.457406520843506
Epoch: 4, Steps: 89 | Train Loss: 0.238 Vali Loss: 0.183 Vali Acc: 0.958 Test Loss: 0.183 Test Acc: 0.958
Validation loss decreased (-0.919913 --> -0.958215).  Saving model ...
Epoch: 5 cost time: 2.318528413772583
Epoch: 5, Steps: 89 | Train Loss: 0.151 Vali Loss: 0.154 Vali Acc: 0.964 Test Loss: 0.154 Test Acc: 0.964
Validation loss decreased (-0.958215 --> -0.964483).  Saving model ...
Epoch: 6 cost time: 2.4444305896759033
Epoch: 6, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.117 Vali Acc: 0.973 Test Loss: 0.117 Test Acc: 0.973
Validation loss decreased (-0.964483 --> -0.972840).  Saving model ...
Epoch: 7 cost time: 2.088871955871582
Epoch: 7, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
Validation loss decreased (-0.972840 --> -0.978411).  Saving model ...
Epoch: 8 cost time: 2.564817428588867
Epoch: 8, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.094 Vali Acc: 0.976 Test Loss: 0.094 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.6007893085479736
Epoch: 9, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.100 Vali Acc: 0.976 Test Loss: 0.100 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.0129916667938232
Epoch: 10, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.072 Vali Acc: 0.982 Test Loss: 0.072 Test Acc: 0.982
Validation loss decreased (-0.978411 --> -0.981893).  Saving model ...
Epoch: 11 cost time: 2.9106411933898926
Epoch: 11, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
Validation loss decreased (-0.981893 --> -0.982590).  Saving model ...
Epoch: 12 cost time: 2.746434450149536
Epoch: 12, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.074 Vali Acc: 0.982 Test Loss: 0.074 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.520724058151245
Epoch: 13, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.075 Vali Acc: 0.981 Test Loss: 0.075 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.7131221294403076
Epoch: 14, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.073 Vali Acc: 0.977 Test Loss: 0.073 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.8364486694335938
Epoch: 15, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.644047260284424
Epoch: 16, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.4436569213867188
Epoch: 17, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.093 Vali Acc: 0.972 Test Loss: 0.093 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.3727385997772217
Epoch: 18, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.107 Vali Acc: 0.973 Test Loss: 0.107 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.7498412132263184
Epoch: 19, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.077 Vali Acc: 0.981 Test Loss: 0.077 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.0781939029693604
Epoch: 20, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.070 Vali Acc: 0.984 Test Loss: 0.070 Test Acc: 0.984
Validation loss decreased (-0.982590 --> -0.983983).  Saving model ...
Epoch: 21 cost time: 2.608705759048462
Epoch: 21, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.102 Vali Acc: 0.979 Test Loss: 0.102 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.772581100463867
Epoch: 22, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.635899066925049
Epoch: 23, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.061 Vali Acc: 0.985 Test Loss: 0.061 Test Acc: 0.985
Validation loss decreased (-0.983983 --> -0.985375).  Saving model ...
Epoch: 24 cost time: 2.588913679122925
Epoch: 24, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.982 Test Loss: 0.087 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.721947431564331
Epoch: 25, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.102 Vali Acc: 0.979 Test Loss: 0.102 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.3404734134674072
Epoch: 26, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.122 Vali Acc: 0.972 Test Loss: 0.122 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.6944615840911865
Epoch: 27, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.114 Vali Acc: 0.976 Test Loss: 0.114 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.739259958267212
Epoch: 28, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.099 Vali Acc: 0.981 Test Loss: 0.099 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.712003707885742
Epoch: 29, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.123 Vali Acc: 0.976 Test Loss: 0.123 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.7118661403656006
Epoch: 30, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.099 Vali Acc: 0.981 Test Loss: 0.099 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 2.583103895187378
Epoch: 31, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.100 Vali Acc: 0.981 Test Loss: 0.100 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 2.440835475921631
Epoch: 32, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 2.603590965270996
Epoch: 33, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.118 Vali Acc: 0.980 Test Loss: 0.118 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps37_str19_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9853760445682451
model parameter : 196180
model size : 0.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps46_str23_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.2782764434814453
Epoch: 1, Steps: 89 | Train Loss: 2.648 Vali Loss: 1.987 Vali Acc: 0.637 Test Loss: 1.987 Test Acc: 0.637
Validation loss decreased (inf --> -0.637167).  Saving model ...
Epoch: 2 cost time: 2.523132562637329
Epoch: 2, Steps: 89 | Train Loss: 1.301 Vali Loss: 0.739 Vali Acc: 0.853 Test Loss: 0.739 Test Acc: 0.853
Validation loss decreased (-0.637167 --> -0.853057).  Saving model ...
Epoch: 3 cost time: 2.617053747177124
Epoch: 3, Steps: 89 | Train Loss: 0.520 Vali Loss: 0.365 Vali Acc: 0.907 Test Loss: 0.365 Test Acc: 0.907
Validation loss decreased (-0.853057 --> -0.907378).  Saving model ...
Epoch: 4 cost time: 2.565647602081299
Epoch: 4, Steps: 89 | Train Loss: 0.268 Vali Loss: 0.221 Vali Acc: 0.945 Test Loss: 0.221 Test Acc: 0.945
Validation loss decreased (-0.907378 --> -0.944984).  Saving model ...
Epoch: 5 cost time: 2.2881205081939697
Epoch: 5, Steps: 89 | Train Loss: 0.163 Vali Loss: 0.161 Vali Acc: 0.962 Test Loss: 0.161 Test Acc: 0.962
Validation loss decreased (-0.944984 --> -0.962394).  Saving model ...
Epoch: 6 cost time: 2.453815460205078
Epoch: 6, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.122 Vali Acc: 0.971 Test Loss: 0.122 Test Acc: 0.971
Validation loss decreased (-0.962394 --> -0.971447).  Saving model ...
Epoch: 7 cost time: 2.6585466861724854
Epoch: 7, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.124 Vali Acc: 0.965 Test Loss: 0.124 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.620821952819824
Epoch: 8, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.095 Vali Acc: 0.979 Test Loss: 0.095 Test Acc: 0.979
Validation loss decreased (-0.971447 --> -0.979108).  Saving model ...
Epoch: 9 cost time: 2.647385835647583
Epoch: 9, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.086 Vali Acc: 0.978 Test Loss: 0.086 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.6260335445404053
Epoch: 10, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.095 Vali Acc: 0.975 Test Loss: 0.095 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.7375824451446533
Epoch: 11, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.077 Vali Acc: 0.979 Test Loss: 0.077 Test Acc: 0.979
Validation loss decreased (-0.979108 --> -0.979108).  Saving model ...
Epoch: 12 cost time: 2.701965093612671
Epoch: 12, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.071 Vali Acc: 0.980 Test Loss: 0.071 Test Acc: 0.980
Validation loss decreased (-0.979108 --> -0.979804).  Saving model ...
Epoch: 13 cost time: 2.439133405685425
Epoch: 13, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.108 Vali Acc: 0.976 Test Loss: 0.108 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.7058839797973633
Epoch: 14, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.077 Vali Acc: 0.979 Test Loss: 0.077 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.633007526397705
Epoch: 15, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.094 Vali Acc: 0.974 Test Loss: 0.094 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.4034035205841064
Epoch: 16, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.074 Vali Acc: 0.979 Test Loss: 0.074 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.6631624698638916
Epoch: 17, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.096 Vali Acc: 0.975 Test Loss: 0.096 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.323293685913086
Epoch: 18, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.061 Vali Acc: 0.984 Test Loss: 0.061 Test Acc: 0.984
Validation loss decreased (-0.979804 --> -0.983983).  Saving model ...
Epoch: 19 cost time: 2.3576533794403076
Epoch: 19, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.072 Vali Acc: 0.981 Test Loss: 0.072 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.309803009033203
Epoch: 20, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.073 Vali Acc: 0.985 Test Loss: 0.073 Test Acc: 0.985
Validation loss decreased (-0.983983 --> -0.985375).  Saving model ...
Epoch: 21 cost time: 2.481354236602783
Epoch: 21, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.077 Vali Acc: 0.984 Test Loss: 0.077 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.3241779804229736
Epoch: 22, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.479588508605957
Epoch: 23, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.6526248455047607
Epoch: 24, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.123 Vali Acc: 0.974 Test Loss: 0.123 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.231201410293579
Epoch: 25, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.086 Vali Acc: 0.978 Test Loss: 0.086 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.4827232360839844
Epoch: 26, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.100 Vali Acc: 0.978 Test Loss: 0.100 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.6414599418640137
Epoch: 27, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.127 Vali Acc: 0.978 Test Loss: 0.127 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.525714874267578
Epoch: 28, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.167 Vali Acc: 0.963 Test Loss: 0.167 Test Acc: 0.963
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.5179710388183594
Epoch: 29, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.105 Vali Acc: 0.976 Test Loss: 0.105 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.3060624599456787
Epoch: 30, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.164 Vali Acc: 0.969 Test Loss: 0.164 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64-128_nb1-1-1_lk13-13-13_sk5-5-5_ffr1_ps46_str23_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9853760445682451
model parameter : 188788
model size : 0.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.2449278831481934
Epoch: 1, Steps: 89 | Train Loss: 1.981 Vali Loss: 0.675 Vali Acc: 0.801 Test Loss: 0.675 Test Acc: 0.801
Validation loss decreased (inf --> -0.800829).  Saving model ...
Epoch: 2 cost time: 3.0471878051757812
Epoch: 2, Steps: 89 | Train Loss: 0.357 Vali Loss: 0.212 Vali Acc: 0.951 Test Loss: 0.212 Test Acc: 0.951
Validation loss decreased (-0.800829 --> -0.951251).  Saving model ...
Epoch: 3 cost time: 2.6088361740112305
Epoch: 3, Steps: 89 | Train Loss: 0.146 Vali Loss: 0.130 Vali Acc: 0.962 Test Loss: 0.130 Test Acc: 0.962
Validation loss decreased (-0.951251 --> -0.962394).  Saving model ...
Epoch: 4 cost time: 2.718156576156616
Epoch: 4, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
Validation loss decreased (-0.962394 --> -0.970055).  Saving model ...
Epoch: 5 cost time: 2.614159345626831
Epoch: 5, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.127 Vali Acc: 0.971 Test Loss: 0.127 Test Acc: 0.971
Validation loss decreased (-0.970055 --> -0.971447).  Saving model ...
Epoch: 6 cost time: 2.698779582977295
Epoch: 6, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
Validation loss decreased (-0.971447 --> -0.977018).  Saving model ...
Epoch: 7 cost time: 2.693049192428589
Epoch: 7, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.096 Vali Acc: 0.978 Test Loss: 0.096 Test Acc: 0.978
Validation loss decreased (-0.977018 --> -0.977715).  Saving model ...
Epoch: 8 cost time: 2.3589017391204834
Epoch: 8, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.104 Vali Acc: 0.974 Test Loss: 0.104 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.6681504249572754
Epoch: 9, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.125 Vali Acc: 0.979 Test Loss: 0.125 Test Acc: 0.979
Validation loss decreased (-0.977715 --> -0.979107).  Saving model ...
Epoch: 10 cost time: 2.543848991394043
Epoch: 10, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
Validation loss decreased (-0.979107 --> -0.979804).  Saving model ...
Epoch: 11 cost time: 2.4722983837127686
Epoch: 11, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.115 Vali Acc: 0.976 Test Loss: 0.115 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.6145031452178955
Epoch: 12, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.130 Vali Acc: 0.968 Test Loss: 0.130 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.38047194480896
Epoch: 13, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.165 Vali Acc: 0.971 Test Loss: 0.165 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.694720983505249
Epoch: 14, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.120 Vali Acc: 0.981 Test Loss: 0.120 Test Acc: 0.981
Validation loss decreased (-0.979804 --> -0.981197).  Saving model ...
Epoch: 15 cost time: 2.5042972564697266
Epoch: 15, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.157 Vali Acc: 0.972 Test Loss: 0.157 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.4391403198242188
Epoch: 16, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.167 Vali Acc: 0.975 Test Loss: 0.167 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.6317858695983887
Epoch: 17, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.168 Vali Acc: 0.980 Test Loss: 0.168 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.6881980895996094
Epoch: 18, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.175 Vali Acc: 0.973 Test Loss: 0.175 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.539731979370117
Epoch: 19, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.193 Vali Acc: 0.970 Test Loss: 0.193 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.223747491836548
Epoch: 20, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.177 Vali Acc: 0.983 Test Loss: 0.177 Test Acc: 0.983
Validation loss decreased (-0.981197 --> -0.982589).  Saving model ...
Epoch: 21 cost time: 2.6584386825561523
Epoch: 21, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.186 Vali Acc: 0.979 Test Loss: 0.186 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.399324893951416
Epoch: 22, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.171 Vali Acc: 0.982 Test Loss: 0.171 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.6395480632781982
Epoch: 23, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.129 Vali Acc: 0.981 Test Loss: 0.129 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.1511244773864746
Epoch: 24, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.220 Vali Acc: 0.976 Test Loss: 0.220 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.5714151859283447
Epoch: 25, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.230 Vali Acc: 0.976 Test Loss: 0.230 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.602487802505493
Epoch: 26, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.193 Vali Acc: 0.975 Test Loss: 0.193 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.6249589920043945
Epoch: 27, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.190 Vali Acc: 0.979 Test Loss: 0.190 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.567115068435669
Epoch: 28, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.230 Vali Acc: 0.973 Test Loss: 0.230 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.2448439598083496
Epoch: 29, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.179 Vali Acc: 0.984 Test Loss: 0.179 Test Acc: 0.984
Validation loss decreased (-0.982589 --> -0.983981).  Saving model ...
Epoch: 30 cost time: 2.801809787750244
Epoch: 30, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.243 Vali Acc: 0.967 Test Loss: 0.243 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.5228028297424316
Epoch: 31, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.226 Vali Acc: 0.972 Test Loss: 0.226 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.8142199516296387
Epoch: 32, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.209 Vali Acc: 0.981 Test Loss: 0.209 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 2.5863237380981445
Epoch: 33, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.194 Vali Acc: 0.981 Test Loss: 0.194 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 2.4620161056518555
Epoch: 34, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.247 Vali Acc: 0.982 Test Loss: 0.247 Test Acc: 0.982
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 2.4723799228668213
Epoch: 35, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.272 Vali Acc: 0.981 Test Loss: 0.272 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 2.556550979614258
Epoch: 36, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.253 Vali Acc: 0.980 Test Loss: 0.253 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 2.3228607177734375
Epoch: 37, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.227 Vali Acc: 0.980 Test Loss: 0.227 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 2.527602434158325
Epoch: 38, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.156 Vali Acc: 0.980 Test Loss: 0.156 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 2.4719293117523193
Epoch: 39, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.368 Vali Acc: 0.969 Test Loss: 0.368 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.983983286908078
model parameter : 284628
model size : 1.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.3714983463287354
Epoch: 1, Steps: 89 | Train Loss: 2.297 Vali Loss: 1.007 Vali Acc: 0.790 Test Loss: 1.007 Test Acc: 0.790
Validation loss decreased (inf --> -0.789684).  Saving model ...
Epoch: 2 cost time: 2.495055913925171
Epoch: 2, Steps: 89 | Train Loss: 0.535 Vali Loss: 0.291 Vali Acc: 0.928 Test Loss: 0.291 Test Acc: 0.928
Validation loss decreased (-0.789684 --> -0.928270).  Saving model ...
Epoch: 3 cost time: 2.3670990467071533
Epoch: 3, Steps: 89 | Train Loss: 0.188 Vali Loss: 0.148 Vali Acc: 0.971 Test Loss: 0.148 Test Acc: 0.971
Validation loss decreased (-0.928270 --> -0.970751).  Saving model ...
Epoch: 4 cost time: 2.441737413406372
Epoch: 4, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.142 Vali Acc: 0.961 Test Loss: 0.142 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.2933716773986816
Epoch: 5, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.103 Vali Acc: 0.972 Test Loss: 0.103 Test Acc: 0.972
Validation loss decreased (-0.970751 --> -0.972144).  Saving model ...
Epoch: 6 cost time: 2.441807985305786
Epoch: 6, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.082 Vali Acc: 0.978 Test Loss: 0.082 Test Acc: 0.978
Validation loss decreased (-0.972144 --> -0.977715).  Saving model ...
Epoch: 7 cost time: 2.2531063556671143
Epoch: 7, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.075 Vali Acc: 0.978 Test Loss: 0.075 Test Acc: 0.978
Validation loss decreased (-0.977715 --> -0.978412).  Saving model ...
Epoch: 8 cost time: 2.601820468902588
Epoch: 8, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.084 Vali Acc: 0.982 Test Loss: 0.084 Test Acc: 0.982
Validation loss decreased (-0.978412 --> -0.981893).  Saving model ...
Epoch: 9 cost time: 2.9443199634552
Epoch: 9, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.092 Vali Acc: 0.978 Test Loss: 0.092 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.309180498123169
Epoch: 10, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.477518320083618
Epoch: 11, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.102 Vali Acc: 0.968 Test Loss: 0.102 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.449071168899536
Epoch: 12, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.609182357788086
Epoch: 13, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.143 Vali Acc: 0.965 Test Loss: 0.143 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.5249245166778564
Epoch: 14, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.105 Vali Acc: 0.976 Test Loss: 0.105 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.590276002883911
Epoch: 15, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.088 Vali Acc: 0.984 Test Loss: 0.088 Test Acc: 0.984
Validation loss decreased (-0.981893 --> -0.983982).  Saving model ...
Epoch: 16 cost time: 2.2430787086486816
Epoch: 16, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.141 Vali Acc: 0.971 Test Loss: 0.141 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.9584455490112305
Epoch: 17, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.087 Vali Acc: 0.987 Test Loss: 0.087 Test Acc: 0.987
Validation loss decreased (-0.983982 --> -0.986768).  Saving model ...
Epoch: 18 cost time: 3.0911877155303955
Epoch: 18, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.138 Vali Acc: 0.975 Test Loss: 0.138 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.4930341243743896
Epoch: 19, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.169 Vali Acc: 0.977 Test Loss: 0.169 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.561307191848755
Epoch: 20, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.128 Vali Acc: 0.978 Test Loss: 0.128 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.5489416122436523
Epoch: 21, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.082 Vali Acc: 0.989 Test Loss: 0.082 Test Acc: 0.989
Validation loss decreased (-0.986768 --> -0.988857).  Saving model ...
Epoch: 22 cost time: 2.452765464782715
Epoch: 22, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.107 Vali Acc: 0.983 Test Loss: 0.107 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.6180355548858643
Epoch: 23, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.123 Vali Acc: 0.977 Test Loss: 0.123 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.5246143341064453
Epoch: 24, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.128 Vali Acc: 0.978 Test Loss: 0.128 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.747525453567505
Epoch: 25, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.169 Vali Acc: 0.978 Test Loss: 0.169 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.5647530555725098
Epoch: 26, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.117 Vali Acc: 0.985 Test Loss: 0.117 Test Acc: 0.985
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.4441328048706055
Epoch: 27, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.109 Vali Acc: 0.986 Test Loss: 0.109 Test Acc: 0.986
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.516592502593994
Epoch: 28, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.095 Vali Acc: 0.984 Test Loss: 0.095 Test Acc: 0.984
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.694387197494507
Epoch: 29, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.169 Vali Acc: 0.976 Test Loss: 0.169 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 2.4930012226104736
Epoch: 30, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.133 Vali Acc: 0.983 Test Loss: 0.133 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 2.57053279876709
Epoch: 31, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.119 Vali Acc: 0.982 Test Loss: 0.119 Test Acc: 0.982
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9888579387186629
model parameter : 238708
model size : 0.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps14_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.9243004322052
Epoch: 1, Steps: 89 | Train Loss: 2.290 Vali Loss: 1.079 Vali Acc: 0.771 Test Loss: 1.079 Test Acc: 0.771
Validation loss decreased (inf --> -0.770881).  Saving model ...
Epoch: 2 cost time: 2.513162136077881
Epoch: 2, Steps: 89 | Train Loss: 0.567 Vali Loss: 0.335 Vali Acc: 0.916 Test Loss: 0.335 Test Acc: 0.916
Validation loss decreased (-0.770881 --> -0.915735).  Saving model ...
Epoch: 3 cost time: 2.7782814502716064
Epoch: 3, Steps: 89 | Train Loss: 0.222 Vali Loss: 0.184 Vali Acc: 0.958 Test Loss: 0.184 Test Acc: 0.958
Validation loss decreased (-0.915735 --> -0.958215).  Saving model ...
Epoch: 4 cost time: 2.4466028213500977
Epoch: 4, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.120 Vali Acc: 0.971 Test Loss: 0.120 Test Acc: 0.971
Validation loss decreased (-0.958215 --> -0.971447).  Saving model ...
Epoch: 5 cost time: 2.5525429248809814
Epoch: 5, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.135 Vali Acc: 0.961 Test Loss: 0.135 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.700737476348877
Epoch: 6, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.098 Vali Acc: 0.980 Test Loss: 0.098 Test Acc: 0.980
Validation loss decreased (-0.971447 --> -0.979804).  Saving model ...
Epoch: 7 cost time: 2.5675790309906006
Epoch: 7, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.066 Vali Acc: 0.985 Test Loss: 0.066 Test Acc: 0.985
Validation loss decreased (-0.979804 --> -0.984679).  Saving model ...
Epoch: 8 cost time: 2.6837284564971924
Epoch: 8, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.065 Vali Acc: 0.985 Test Loss: 0.065 Test Acc: 0.985
Validation loss decreased (-0.984679 --> -0.985375).  Saving model ...
Epoch: 9 cost time: 2.7009265422821045
Epoch: 9, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.7427914142608643
Epoch: 10, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.068 Vali Acc: 0.981 Test Loss: 0.068 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.3109943866729736
Epoch: 11, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.086 Vali Acc: 0.981 Test Loss: 0.086 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.6532015800476074
Epoch: 12, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.4162979125976562
Epoch: 13, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.088 Vali Acc: 0.975 Test Loss: 0.088 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.6113646030426025
Epoch: 14, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.496288537979126
Epoch: 15, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.155 Vali Acc: 0.962 Test Loss: 0.155 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.301682233810425
Epoch: 16, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.093 Vali Acc: 0.978 Test Loss: 0.093 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.5651028156280518
Epoch: 17, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.093 Vali Acc: 0.975 Test Loss: 0.093 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.5557539463043213
Epoch: 18, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.159 Vali Acc: 0.974 Test Loss: 0.159 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps14_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9853760445682451
model parameter : 223476
model size : 0.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps19_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.5908777713775635
Epoch: 1, Steps: 89 | Train Loss: 2.504 Vali Loss: 1.598 Vali Acc: 0.699 Test Loss: 1.598 Test Acc: 0.699
Validation loss decreased (inf --> -0.699148).  Saving model ...
Epoch: 2 cost time: 2.4544382095336914
Epoch: 2, Steps: 89 | Train Loss: 0.873 Vali Loss: 0.466 Vali Acc: 0.892 Test Loss: 0.466 Test Acc: 0.892
Validation loss decreased (-0.699148 --> -0.892057).  Saving model ...
Epoch: 3 cost time: 3.123013973236084
Epoch: 3, Steps: 89 | Train Loss: 0.323 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
Validation loss decreased (-0.892057 --> -0.943591).  Saving model ...
Epoch: 4 cost time: 2.49202823638916
Epoch: 4, Steps: 89 | Train Loss: 0.168 Vali Loss: 0.138 Vali Acc: 0.967 Test Loss: 0.138 Test Acc: 0.967
Validation loss decreased (-0.943591 --> -0.966572).  Saving model ...
Epoch: 5 cost time: 2.528348684310913
Epoch: 5, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.115 Vali Acc: 0.970 Test Loss: 0.115 Test Acc: 0.970
Validation loss decreased (-0.966572 --> -0.970055).  Saving model ...
Epoch: 6 cost time: 2.3283517360687256
Epoch: 6, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.101 Vali Acc: 0.979 Test Loss: 0.101 Test Acc: 0.979
Validation loss decreased (-0.970055 --> -0.979108).  Saving model ...
Epoch: 7 cost time: 2.289356231689453
Epoch: 7, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.083 Vali Acc: 0.979 Test Loss: 0.083 Test Acc: 0.979
Validation loss decreased (-0.979108 --> -0.979108).  Saving model ...
Epoch: 8 cost time: 2.2201433181762695
Epoch: 8, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.153 Vali Acc: 0.958 Test Loss: 0.153 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.4937808513641357
Epoch: 9, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.070 Vali Acc: 0.982 Test Loss: 0.070 Test Acc: 0.982
Validation loss decreased (-0.979108 --> -0.981893).  Saving model ...
Epoch: 10 cost time: 2.4775381088256836
Epoch: 10, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.5970287322998047
Epoch: 11, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.073 Vali Acc: 0.981 Test Loss: 0.073 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.270195960998535
Epoch: 12, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.074 Vali Acc: 0.980 Test Loss: 0.074 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.070465087890625
Epoch: 13, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.105 Vali Acc: 0.978 Test Loss: 0.105 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.270291566848755
Epoch: 14, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.120 Vali Acc: 0.971 Test Loss: 0.120 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.3822021484375
Epoch: 15, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.981893 --> -0.982590).  Saving model ...
Epoch: 16 cost time: 1.9705190658569336
Epoch: 16, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.098 Vali Acc: 0.978 Test Loss: 0.098 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.5890183448791504
Epoch: 17, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.065 Vali Acc: 0.985 Test Loss: 0.065 Test Acc: 0.985
Validation loss decreased (-0.982590 --> -0.984679).  Saving model ...
Epoch: 18 cost time: 2.2871479988098145
Epoch: 18, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.054 Vali Acc: 0.986 Test Loss: 0.054 Test Acc: 0.986
Validation loss decreased (-0.984679 --> -0.986072).  Saving model ...
Epoch: 19 cost time: 2.7179269790649414
Epoch: 19, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.561732053756714
Epoch: 20, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.4257984161376953
Epoch: 21, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.104 Vali Acc: 0.978 Test Loss: 0.104 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.418647050857544
Epoch: 22, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.074 Vali Acc: 0.985 Test Loss: 0.074 Test Acc: 0.985
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.444951295852661
Epoch: 23, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.111 Vali Acc: 0.974 Test Loss: 0.111 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.542485237121582
Epoch: 24, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.097 Vali Acc: 0.976 Test Loss: 0.097 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.6237282752990723
Epoch: 25, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.097 Vali Acc: 0.976 Test Loss: 0.097 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.3034567832946777
Epoch: 26, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.083 Vali Acc: 0.981 Test Loss: 0.083 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.286436080932617
Epoch: 27, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.7024619579315186
Epoch: 28, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.082 Vali Acc: 0.987 Test Loss: 0.082 Test Acc: 0.987
Validation loss decreased (-0.986072 --> -0.987464).  Saving model ...
Epoch: 29 cost time: 2.256622314453125
Epoch: 29, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.075 Vali Acc: 0.985 Test Loss: 0.075 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.6904358863830566
Epoch: 30, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.984 Test Loss: 0.080 Test Acc: 0.984
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 2.3066532611846924
Epoch: 31, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.984 Test Loss: 0.080 Test Acc: 0.984
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 2.395855665206909
Epoch: 32, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.106 Vali Acc: 0.981 Test Loss: 0.106 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 2.5281903743743896
Epoch: 33, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.204 Vali Acc: 0.962 Test Loss: 0.204 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 2.3359758853912354
Epoch: 34, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.187 Vali Acc: 0.972 Test Loss: 0.187 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 2.413999557495117
Epoch: 35, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.094 Vali Acc: 0.981 Test Loss: 0.094 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 2.3933207988739014
Epoch: 36, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.118 Vali Acc: 0.975 Test Loss: 0.118 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 2.5967907905578613
Epoch: 37, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.113 Vali Acc: 0.978 Test Loss: 0.113 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 2.6040539741516113
Epoch: 38, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.114 Vali Acc: 0.981 Test Loss: 0.114 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps19_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9874651810584958
model parameter : 208276
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps28_str14_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.0969183444976807
Epoch: 1, Steps: 89 | Train Loss: 2.614 Vali Loss: 1.819 Vali Acc: 0.648 Test Loss: 1.819 Test Acc: 0.648
Validation loss decreased (inf --> -0.647614).  Saving model ...
Epoch: 2 cost time: 2.3996028900146484
Epoch: 2, Steps: 89 | Train Loss: 1.042 Vali Loss: 0.520 Vali Acc: 0.889 Test Loss: 0.520 Test Acc: 0.889
Validation loss decreased (-0.647614 --> -0.888574).  Saving model ...
Epoch: 3 cost time: 2.5523507595062256
Epoch: 3, Steps: 89 | Train Loss: 0.364 Vali Loss: 0.245 Vali Acc: 0.944 Test Loss: 0.245 Test Acc: 0.944
Validation loss decreased (-0.888574 --> -0.943591).  Saving model ...
Epoch: 4 cost time: 2.5219311714172363
Epoch: 4, Steps: 89 | Train Loss: 0.184 Vali Loss: 0.154 Vali Acc: 0.969 Test Loss: 0.154 Test Acc: 0.969
Validation loss decreased (-0.943591 --> -0.968661).  Saving model ...
Epoch: 5 cost time: 2.430103063583374
Epoch: 5, Steps: 89 | Train Loss: 0.113 Vali Loss: 0.119 Vali Acc: 0.974 Test Loss: 0.119 Test Acc: 0.974
Validation loss decreased (-0.968661 --> -0.973536).  Saving model ...
Epoch: 6 cost time: 2.4319496154785156
Epoch: 6, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.094 Vali Acc: 0.976 Test Loss: 0.094 Test Acc: 0.976
Validation loss decreased (-0.973536 --> -0.976322).  Saving model ...
Epoch: 7 cost time: 2.5863771438598633
Epoch: 7, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.092 Vali Acc: 0.976 Test Loss: 0.092 Test Acc: 0.976
Validation loss decreased (-0.976322 --> -0.976322).  Saving model ...
Epoch: 8 cost time: 2.8962039947509766
Epoch: 8, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.060 Vali Acc: 0.985 Test Loss: 0.060 Test Acc: 0.985
Validation loss decreased (-0.976322 --> -0.984679).  Saving model ...
Epoch: 9 cost time: 2.170193910598755
Epoch: 9, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.066 Vali Acc: 0.985 Test Loss: 0.066 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.467466354370117
Epoch: 10, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.093 Vali Acc: 0.969 Test Loss: 0.093 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.4838428497314453
Epoch: 11, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.061 Vali Acc: 0.983 Test Loss: 0.061 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.6153321266174316
Epoch: 12, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.057 Vali Acc: 0.985 Test Loss: 0.057 Test Acc: 0.985
Validation loss decreased (-0.984679 --> -0.985375).  Saving model ...
Epoch: 13 cost time: 2.651654005050659
Epoch: 13, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.077 Vali Acc: 0.985 Test Loss: 0.077 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.680450677871704
Epoch: 14, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.061 Vali Acc: 0.987 Test Loss: 0.061 Test Acc: 0.987
Validation loss decreased (-0.985375 --> -0.986768).  Saving model ...
Epoch: 15 cost time: 2.54333233833313
Epoch: 15, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.062 Vali Acc: 0.984 Test Loss: 0.062 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.4960808753967285
Epoch: 16, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.065 Vali Acc: 0.984 Test Loss: 0.065 Test Acc: 0.984
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.4665236473083496
Epoch: 17, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.062 Vali Acc: 0.989 Test Loss: 0.062 Test Acc: 0.989
Validation loss decreased (-0.986768 --> -0.988857).  Saving model ...
Epoch: 18 cost time: 2.5507009029388428
Epoch: 18, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.080 Vali Acc: 0.979 Test Loss: 0.080 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.568575382232666
Epoch: 19, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.073 Vali Acc: 0.982 Test Loss: 0.073 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.074244737625122
Epoch: 20, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.0663442611694336
Epoch: 21, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.108 Vali Acc: 0.976 Test Loss: 0.108 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.6715285778045654
Epoch: 22, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.073 Vali Acc: 0.985 Test Loss: 0.073 Test Acc: 0.985
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.6769559383392334
Epoch: 23, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.128 Vali Acc: 0.974 Test Loss: 0.128 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.655773162841797
Epoch: 24, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.124 Vali Acc: 0.978 Test Loss: 0.124 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.5507001876831055
Epoch: 25, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.073 Vali Acc: 0.989 Test Loss: 0.073 Test Acc: 0.989
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.3923871517181396
Epoch: 26, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.070 Vali Acc: 0.985 Test Loss: 0.070 Test Acc: 0.985
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.6872034072875977
Epoch: 27, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.086 Vali Acc: 0.986 Test Loss: 0.086 Test Acc: 0.986
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps28_str14_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9888579387186629
model parameter : 200884
model size : 0.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps37_str19_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.2233259677886963
Epoch: 1, Steps: 89 | Train Loss: 2.637 Vali Loss: 1.939 Vali Acc: 0.625 Test Loss: 1.939 Test Acc: 0.625
Validation loss decreased (inf --> -0.624632).  Saving model ...
Epoch: 2 cost time: 2.3855326175689697
Epoch: 2, Steps: 89 | Train Loss: 1.198 Vali Loss: 0.629 Vali Acc: 0.864 Test Loss: 0.629 Test Acc: 0.864
Validation loss decreased (-0.624632 --> -0.863503).  Saving model ...
Epoch: 3 cost time: 2.8068532943725586
Epoch: 3, Steps: 89 | Train Loss: 0.436 Vali Loss: 0.302 Vali Acc: 0.935 Test Loss: 0.302 Test Acc: 0.935
Validation loss decreased (-0.863503 --> -0.934537).  Saving model ...
Epoch: 4 cost time: 2.564037322998047
Epoch: 4, Steps: 89 | Train Loss: 0.225 Vali Loss: 0.186 Vali Acc: 0.959 Test Loss: 0.186 Test Acc: 0.959
Validation loss decreased (-0.934537 --> -0.958912).  Saving model ...
Epoch: 5 cost time: 2.284184455871582
Epoch: 5, Steps: 89 | Train Loss: 0.137 Vali Loss: 0.129 Vali Acc: 0.970 Test Loss: 0.129 Test Acc: 0.970
Validation loss decreased (-0.958912 --> -0.970054).  Saving model ...
Epoch: 6 cost time: 2.5583386421203613
Epoch: 6, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
Validation loss decreased (-0.970054 --> -0.977018).  Saving model ...
Epoch: 7 cost time: 2.4767003059387207
Epoch: 7, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.119 Vali Acc: 0.968 Test Loss: 0.119 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.7061655521392822
Epoch: 8, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.5320918560028076
Epoch: 9, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.077 Vali Acc: 0.981 Test Loss: 0.077 Test Acc: 0.981
Validation loss decreased (-0.977018 --> -0.980501).  Saving model ...
Epoch: 10 cost time: 2.458052158355713
Epoch: 10, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.449808120727539
Epoch: 11, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.070 Vali Acc: 0.984 Test Loss: 0.070 Test Acc: 0.984
Validation loss decreased (-0.980501 --> -0.983983).  Saving model ...
Epoch: 12 cost time: 2.303327798843384
Epoch: 12, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.070 Vali Acc: 0.978 Test Loss: 0.070 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.308215856552124
Epoch: 13, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.080 Vali Acc: 0.977 Test Loss: 0.080 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.2933826446533203
Epoch: 14, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.070 Vali Acc: 0.981 Test Loss: 0.070 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.944749355316162
Epoch: 15, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.079 Vali Acc: 0.981 Test Loss: 0.079 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.7150094509124756
Epoch: 16, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.7886016368865967
Epoch: 17, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.2866339683532715
Epoch: 18, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.061 Vali Acc: 0.984 Test Loss: 0.061 Test Acc: 0.984
Validation loss decreased (-0.983983 --> -0.983983).  Saving model ...
Epoch: 19 cost time: 2.5805370807647705
Epoch: 19, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.101 Vali Acc: 0.975 Test Loss: 0.101 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.8062994480133057
Epoch: 20, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.071 Vali Acc: 0.984 Test Loss: 0.071 Test Acc: 0.984
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.5771729946136475
Epoch: 21, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.094 Vali Acc: 0.981 Test Loss: 0.094 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.7934231758117676
Epoch: 22, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.490298271179199
Epoch: 23, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.085 Vali Acc: 0.981 Test Loss: 0.085 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.5349559783935547
Epoch: 24, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.108 Vali Acc: 0.979 Test Loss: 0.108 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.0418238639831543
Epoch: 25, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.095 Vali Acc: 0.978 Test Loss: 0.095 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 3.1080713272094727
Epoch: 26, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.7716710567474365
Epoch: 27, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.115 Vali Acc: 0.976 Test Loss: 0.115 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.824014663696289
Epoch: 28, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps37_str19_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.983983286908078
model parameter : 193492
model size : 0.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps46_str23_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.1844701766967773
Epoch: 1, Steps: 89 | Train Loss: 2.668 Vali Loss: 2.038 Vali Acc: 0.564 Test Loss: 2.038 Test Acc: 0.564
Validation loss decreased (inf --> -0.564046).  Saving model ...
Epoch: 2 cost time: 2.3409204483032227
Epoch: 2, Steps: 89 | Train Loss: 1.357 Vali Loss: 0.775 Vali Acc: 0.813 Test Loss: 0.775 Test Acc: 0.813
Validation loss decreased (-0.564046 --> -0.813363).  Saving model ...
Epoch: 3 cost time: 1.746126413345337
Epoch: 3, Steps: 89 | Train Loss: 0.571 Vali Loss: 0.403 Vali Acc: 0.893 Test Loss: 0.403 Test Acc: 0.893
Validation loss decreased (-0.813363 --> -0.893450).  Saving model ...
Epoch: 4 cost time: 2.4725937843322754
Epoch: 4, Steps: 89 | Train Loss: 0.307 Vali Loss: 0.250 Vali Acc: 0.932 Test Loss: 0.250 Test Acc: 0.932
Validation loss decreased (-0.893450 --> -0.932449).  Saving model ...
Epoch: 5 cost time: 2.4211244583129883
Epoch: 5, Steps: 89 | Train Loss: 0.193 Vali Loss: 0.171 Vali Acc: 0.958 Test Loss: 0.171 Test Acc: 0.958
Validation loss decreased (-0.932449 --> -0.957519).  Saving model ...
Epoch: 6 cost time: 2.5712339878082275
Epoch: 6, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.127 Vali Acc: 0.974 Test Loss: 0.127 Test Acc: 0.974
Validation loss decreased (-0.957519 --> -0.973536).  Saving model ...
Epoch: 7 cost time: 2.472470760345459
Epoch: 7, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.4194188117980957
Epoch: 8, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.088 Vali Acc: 0.982 Test Loss: 0.088 Test Acc: 0.982
Validation loss decreased (-0.973536 --> -0.981893).  Saving model ...
Epoch: 9 cost time: 2.5689713954925537
Epoch: 9, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.6880760192871094
Epoch: 10, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.086 Vali Acc: 0.979 Test Loss: 0.086 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.5946741104125977
Epoch: 11, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.061 Vali Acc: 0.985 Test Loss: 0.061 Test Acc: 0.985
Validation loss decreased (-0.981893 --> -0.984679).  Saving model ...
Epoch: 12 cost time: 2.4199211597442627
Epoch: 12, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.068 Vali Acc: 0.984 Test Loss: 0.068 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.5380074977874756
Epoch: 13, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.083 Vali Acc: 0.976 Test Loss: 0.083 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.5509955883026123
Epoch: 14, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.081 Vali Acc: 0.979 Test Loss: 0.081 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.45607852935791
Epoch: 15, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.067 Vali Acc: 0.985 Test Loss: 0.067 Test Acc: 0.985
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.605515956878662
Epoch: 16, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.079 Vali Acc: 0.981 Test Loss: 0.079 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.3991482257843018
Epoch: 17, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.071 Vali Acc: 0.984 Test Loss: 0.071 Test Acc: 0.984
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.3917808532714844
Epoch: 18, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.060 Vali Acc: 0.983 Test Loss: 0.060 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.5557785034179688
Epoch: 19, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.4604103565216064
Epoch: 20, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.091 Vali Acc: 0.981 Test Loss: 0.091 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.6094980239868164
Epoch: 21, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.082 Vali Acc: 0.985 Test Loss: 0.082 Test Acc: 0.985
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64-128_nb1-1-1_lk9-9-9_sk5-5-5_ffr1_ps46_str23_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9846796657381616
model parameter : 186100
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.9892470836639404
Epoch: 1, Steps: 89 | Train Loss: 1.167 Vali Loss: 0.282 Vali Acc: 0.926 Test Loss: 0.282 Test Acc: 0.926
Validation loss decreased (inf --> -0.926181).  Saving model ...
Epoch: 2 cost time: 2.235924005508423
Epoch: 2, Steps: 89 | Train Loss: 0.220 Vali Loss: 0.159 Vali Acc: 0.958 Test Loss: 0.159 Test Acc: 0.958
Validation loss decreased (-0.926181 --> -0.958216).  Saving model ...
Epoch: 3 cost time: 2.164022207260132
Epoch: 3, Steps: 89 | Train Loss: 0.145 Vali Loss: 0.208 Vali Acc: 0.954 Test Loss: 0.208 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.013787031173706
Epoch: 4, Steps: 89 | Train Loss: 0.141 Vali Loss: 0.226 Vali Acc: 0.962 Test Loss: 0.226 Test Acc: 0.962
Validation loss decreased (-0.958216 --> -0.962393).  Saving model ...
Epoch: 5 cost time: 2.0798697471618652
Epoch: 5, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.173 Vali Acc: 0.970 Test Loss: 0.173 Test Acc: 0.970
Validation loss decreased (-0.962393 --> -0.970054).  Saving model ...
Epoch: 6 cost time: 2.0347158908843994
Epoch: 6, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.255 Vali Acc: 0.954 Test Loss: 0.255 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.122985601425171
Epoch: 7, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.158 Vali Acc: 0.974 Test Loss: 0.158 Test Acc: 0.974
Validation loss decreased (-0.970054 --> -0.974232).  Saving model ...
Epoch: 8 cost time: 2.0873606204986572
Epoch: 8, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.199 Vali Acc: 0.967 Test Loss: 0.199 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.0637269020080566
Epoch: 9, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.222 Vali Acc: 0.971 Test Loss: 0.222 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.1055614948272705
Epoch: 10, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.198 Vali Acc: 0.971 Test Loss: 0.198 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.1203689575195312
Epoch: 11, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.311 Vali Acc: 0.972 Test Loss: 0.311 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.195377826690674
Epoch: 12, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.394 Vali Acc: 0.944 Test Loss: 0.394 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.9549357891082764
Epoch: 13, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.231 Vali Acc: 0.971 Test Loss: 0.231 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.9601795673370361
Epoch: 14, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.397 Vali Acc: 0.958 Test Loss: 0.397 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.043450355529785
Epoch: 15, Steps: 89 | Train Loss: 0.134 Vali Loss: 0.477 Vali Acc: 0.960 Test Loss: 0.477 Test Acc: 0.960
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.9555277824401855
Epoch: 16, Steps: 89 | Train Loss: 0.164 Vali Loss: 0.343 Vali Acc: 0.953 Test Loss: 0.343 Test Acc: 0.953
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.6709465980529785
Epoch: 17, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.275 Vali Acc: 0.969 Test Loss: 0.275 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.974233983286908
model parameter : 1057044
model size : 4.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.8315396308898926
Epoch: 1, Steps: 89 | Train Loss: 1.385 Vali Loss: 0.377 Vali Acc: 0.895 Test Loss: 0.377 Test Acc: 0.895
Validation loss decreased (inf --> -0.894843).  Saving model ...
Epoch: 2 cost time: 2.0556278228759766
Epoch: 2, Steps: 89 | Train Loss: 0.247 Vali Loss: 0.168 Vali Acc: 0.961 Test Loss: 0.168 Test Acc: 0.961
Validation loss decreased (-0.894843 --> -0.961001).  Saving model ...
Epoch: 3 cost time: 2.026001453399658
Epoch: 3, Steps: 89 | Train Loss: 0.143 Vali Loss: 0.223 Vali Acc: 0.947 Test Loss: 0.223 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.0516390800476074
Epoch: 4, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.235 Vali Acc: 0.944 Test Loss: 0.235 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.89369535446167
Epoch: 5, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.207 Vali Acc: 0.963 Test Loss: 0.207 Test Acc: 0.963
Validation loss decreased (-0.961001 --> -0.963090).  Saving model ...
Epoch: 6 cost time: 1.9428224563598633
Epoch: 6, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.184 Vali Acc: 0.960 Test Loss: 0.184 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.026550531387329
Epoch: 7, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.169 Vali Acc: 0.968 Test Loss: 0.169 Test Acc: 0.968
Validation loss decreased (-0.963090 --> -0.967965).  Saving model ...
Epoch: 8 cost time: 1.999213457107544
Epoch: 8, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.129 Vali Acc: 0.978 Test Loss: 0.129 Test Acc: 0.978
Validation loss decreased (-0.967965 --> -0.978411).  Saving model ...
Epoch: 9 cost time: 1.8872604370117188
Epoch: 9, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.174 Vali Acc: 0.969 Test Loss: 0.174 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.2039241790771484
Epoch: 10, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.157 Vali Acc: 0.970 Test Loss: 0.157 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.9734253883361816
Epoch: 11, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.243 Vali Acc: 0.967 Test Loss: 0.243 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.1143929958343506
Epoch: 12, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.197 Vali Acc: 0.973 Test Loss: 0.197 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.3151538372039795
Epoch: 13, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.273 Vali Acc: 0.958 Test Loss: 0.273 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.0025954246520996
Epoch: 14, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.214 Vali Acc: 0.975 Test Loss: 0.214 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.045283317565918
Epoch: 15, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.328 Vali Acc: 0.951 Test Loss: 0.328 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.4116508960723877
Epoch: 16, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.287 Vali Acc: 0.972 Test Loss: 0.287 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.137833833694458
Epoch: 17, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.222 Vali Acc: 0.983 Test Loss: 0.222 Test Acc: 0.983
Validation loss decreased (-0.978411 --> -0.983285).  Saving model ...
Epoch: 18 cost time: 2.2833216190338135
Epoch: 18, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.308 Vali Acc: 0.970 Test Loss: 0.308 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.4523162841796875
Epoch: 19, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.249 Vali Acc: 0.975 Test Loss: 0.249 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.346658945083618
Epoch: 20, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.218 Vali Acc: 0.982 Test Loss: 0.218 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.059630870819092
Epoch: 21, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.267 Vali Acc: 0.978 Test Loss: 0.267 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.9702386856079102
Epoch: 22, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.414 Vali Acc: 0.960 Test Loss: 0.414 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.9298863410949707
Epoch: 23, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.302 Vali Acc: 0.975 Test Loss: 0.302 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.0244429111480713
Epoch: 24, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.291 Vali Acc: 0.973 Test Loss: 0.291 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.942613124847412
Epoch: 25, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.225 Vali Acc: 0.985 Test Loss: 0.225 Test Acc: 0.985
Validation loss decreased (-0.983285 --> -0.984677).  Saving model ...
Epoch: 26 cost time: 1.9931590557098389
Epoch: 26, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.219 Vali Acc: 0.980 Test Loss: 0.219 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.9829506874084473
Epoch: 27, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.231 Vali Acc: 0.976 Test Loss: 0.231 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.897965669631958
Epoch: 28, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.264 Vali Acc: 0.983 Test Loss: 0.264 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.06205153465271
Epoch: 29, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.198 Vali Acc: 0.982 Test Loss: 0.198 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.2710607051849365
Epoch: 30, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.260 Vali Acc: 0.983 Test Loss: 0.260 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 2.2329695224761963
Epoch: 31, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.348 Vali Acc: 0.978 Test Loss: 0.348 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 2.1240901947021484
Epoch: 32, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.371 Vali Acc: 0.964 Test Loss: 0.371 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 2.185256242752075
Epoch: 33, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.224 Vali Acc: 0.981 Test Loss: 0.224 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.8204002380371094
Epoch: 34, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.269 Vali Acc: 0.976 Test Loss: 0.269 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 2.2224276065826416
Epoch: 35, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.561 Vali Acc: 0.970 Test Loss: 0.561 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9846796657381616
model parameter : 873364
model size : 3.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps14_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.9817121028900146
Epoch: 1, Steps: 89 | Train Loss: 1.460 Vali Loss: 0.394 Vali Acc: 0.905 Test Loss: 0.394 Test Acc: 0.905
Validation loss decreased (inf --> -0.904592).  Saving model ...
Epoch: 2 cost time: 2.09394907951355
Epoch: 2, Steps: 89 | Train Loss: 0.239 Vali Loss: 0.191 Vali Acc: 0.952 Test Loss: 0.191 Test Acc: 0.952
Validation loss decreased (-0.904592 --> -0.951948).  Saving model ...
Epoch: 3 cost time: 2.152561664581299
Epoch: 3, Steps: 89 | Train Loss: 0.133 Vali Loss: 0.128 Vali Acc: 0.965 Test Loss: 0.128 Test Acc: 0.965
Validation loss decreased (-0.951948 --> -0.965180).  Saving model ...
Epoch: 4 cost time: 1.9118590354919434
Epoch: 4, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.179 Vali Acc: 0.958 Test Loss: 0.179 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.2047650814056396
Epoch: 5, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.131 Vali Acc: 0.972 Test Loss: 0.131 Test Acc: 0.972
Validation loss decreased (-0.965180 --> -0.972144).  Saving model ...
Epoch: 6 cost time: 1.611867904663086
Epoch: 6, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.129 Vali Acc: 0.967 Test Loss: 0.129 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.978994607925415
Epoch: 7, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.114 Vali Acc: 0.976 Test Loss: 0.114 Test Acc: 0.976
Validation loss decreased (-0.972144 --> -0.975626).  Saving model ...
Epoch: 8 cost time: 2.2052645683288574
Epoch: 8, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.161 Vali Acc: 0.972 Test Loss: 0.161 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9862287044525146
Epoch: 9, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.214 Vali Acc: 0.968 Test Loss: 0.214 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.1176841259002686
Epoch: 10, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.233 Vali Acc: 0.960 Test Loss: 0.233 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.0695033073425293
Epoch: 11, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.474 Vali Acc: 0.921 Test Loss: 0.474 Test Acc: 0.921
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.9406046867370605
Epoch: 12, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.335 Vali Acc: 0.959 Test Loss: 0.335 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.0864408016204834
Epoch: 13, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.284 Vali Acc: 0.969 Test Loss: 0.284 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.141634225845337
Epoch: 14, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.225 Vali Acc: 0.971 Test Loss: 0.225 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.235637903213501
Epoch: 15, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.245 Vali Acc: 0.974 Test Loss: 0.245 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.0730950832366943
Epoch: 16, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.208 Vali Acc: 0.975 Test Loss: 0.208 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.342400074005127
Epoch: 17, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.169 Vali Acc: 0.985 Test Loss: 0.169 Test Acc: 0.985
Validation loss decreased (-0.975626 --> -0.984678).  Saving model ...
Epoch: 18 cost time: 1.9002594947814941
Epoch: 18, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.170 Vali Acc: 0.984 Test Loss: 0.170 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.940169095993042
Epoch: 19, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.153 Vali Acc: 0.985 Test Loss: 0.153 Test Acc: 0.985
Validation loss decreased (-0.984678 --> -0.985375).  Saving model ...
Epoch: 20 cost time: 2.1300313472747803
Epoch: 20, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.222 Vali Acc: 0.984 Test Loss: 0.222 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.9947736263275146
Epoch: 21, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.235 Vali Acc: 0.976 Test Loss: 0.235 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.989013433456421
Epoch: 22, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.315 Vali Acc: 0.976 Test Loss: 0.315 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.079162359237671
Epoch: 23, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.229 Vali Acc: 0.979 Test Loss: 0.229 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.0249040126800537
Epoch: 24, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.276 Vali Acc: 0.977 Test Loss: 0.276 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.0225489139556885
Epoch: 25, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.256 Vali Acc: 0.983 Test Loss: 0.256 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.2515602111816406
Epoch: 26, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.262 Vali Acc: 0.982 Test Loss: 0.262 Test Acc: 0.982
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.9654746055603027
Epoch: 27, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.429 Vali Acc: 0.958 Test Loss: 0.429 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.8757376670837402
Epoch: 28, Steps: 89 | Train Loss: 0.113 Vali Loss: 0.277 Vali Acc: 0.969 Test Loss: 0.277 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.97910737991333
Epoch: 29, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.296 Vali Acc: 0.971 Test Loss: 0.296 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps14_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9853760445682451
model parameter : 797076
model size : 3.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps19_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.619940996170044
Epoch: 1, Steps: 89 | Train Loss: 1.617 Vali Loss: 0.439 Vali Acc: 0.882 Test Loss: 0.439 Test Acc: 0.882
Validation loss decreased (inf --> -0.881611).  Saving model ...
Epoch: 2 cost time: 1.86848783493042
Epoch: 2, Steps: 89 | Train Loss: 0.296 Vali Loss: 0.188 Vali Acc: 0.946 Test Loss: 0.188 Test Acc: 0.946
Validation loss decreased (-0.881611 --> -0.946377).  Saving model ...
Epoch: 3 cost time: 2.053842067718506
Epoch: 3, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.130 Vali Acc: 0.969 Test Loss: 0.130 Test Acc: 0.969
Validation loss decreased (-0.946377 --> -0.968662).  Saving model ...
Epoch: 4 cost time: 1.5902125835418701
Epoch: 4, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.146 Vali Acc: 0.960 Test Loss: 0.146 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8476145267486572
Epoch: 5, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
Validation loss decreased (-0.968662 --> -0.972840).  Saving model ...
Epoch: 6 cost time: 1.8427891731262207
Epoch: 6, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.087 Vali Acc: 0.975 Test Loss: 0.087 Test Acc: 0.975
Validation loss decreased (-0.972840 --> -0.974929).  Saving model ...
Epoch: 7 cost time: 1.907362461090088
Epoch: 7, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.089 Vali Acc: 0.978 Test Loss: 0.089 Test Acc: 0.978
Validation loss decreased (-0.974929 --> -0.977715).  Saving model ...
Epoch: 8 cost time: 1.947840929031372
Epoch: 8, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.081 Vali Acc: 0.982 Test Loss: 0.081 Test Acc: 0.982
Validation loss decreased (-0.977715 --> -0.981893).  Saving model ...
Epoch: 9 cost time: 1.9983711242675781
Epoch: 9, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.088 Vali Acc: 0.978 Test Loss: 0.088 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.9727919101715088
Epoch: 10, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.097 Vali Acc: 0.984 Test Loss: 0.097 Test Acc: 0.984
Validation loss decreased (-0.981893 --> -0.983982).  Saving model ...
Epoch: 11 cost time: 2.406733751296997
Epoch: 11, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.070 Vali Acc: 0.986 Test Loss: 0.070 Test Acc: 0.986
Validation loss decreased (-0.983982 --> -0.986072).  Saving model ...
Epoch: 12 cost time: 2.128948926925659
Epoch: 12, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.081 Vali Acc: 0.986 Test Loss: 0.081 Test Acc: 0.986
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.1313531398773193
Epoch: 13, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.091 Vali Acc: 0.985 Test Loss: 0.091 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.125865936279297
Epoch: 14, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.130 Vali Acc: 0.980 Test Loss: 0.130 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.092869281768799
Epoch: 15, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.180 Vali Acc: 0.969 Test Loss: 0.180 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.053048610687256
Epoch: 16, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.216 Vali Acc: 0.964 Test Loss: 0.216 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.0993130207061768
Epoch: 17, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.143 Vali Acc: 0.981 Test Loss: 0.143 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.35589337348938
Epoch: 18, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.276 Vali Acc: 0.960 Test Loss: 0.276 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.262655258178711
Epoch: 19, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.108 Vali Acc: 0.978 Test Loss: 0.108 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.079796075820923
Epoch: 20, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.117 Vali Acc: 0.982 Test Loss: 0.117 Test Acc: 0.982
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.16605281829834
Epoch: 21, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.225 Vali Acc: 0.969 Test Loss: 0.225 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps19_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9860724233983287
model parameter : 736276
model size : 2.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps28_str14_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.1092381477355957
Epoch: 1, Steps: 89 | Train Loss: 1.744 Vali Loss: 0.574 Vali Acc: 0.822 Test Loss: 0.574 Test Acc: 0.822
Validation loss decreased (inf --> -0.821721).  Saving model ...
Epoch: 2 cost time: 2.117051362991333
Epoch: 2, Steps: 89 | Train Loss: 0.313 Vali Loss: 0.199 Vali Acc: 0.955 Test Loss: 0.199 Test Acc: 0.955
Validation loss decreased (-0.821721 --> -0.954733).  Saving model ...
Epoch: 3 cost time: 1.9544646739959717
Epoch: 3, Steps: 89 | Train Loss: 0.123 Vali Loss: 0.147 Vali Acc: 0.968 Test Loss: 0.147 Test Acc: 0.968
Validation loss decreased (-0.954733 --> -0.967965).  Saving model ...
Epoch: 4 cost time: 2.0200142860412598
Epoch: 4, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.112 Vali Acc: 0.971 Test Loss: 0.112 Test Acc: 0.971
Validation loss decreased (-0.967965 --> -0.971447).  Saving model ...
Epoch: 5 cost time: 2.1411800384521484
Epoch: 5, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.084 Vali Acc: 0.978 Test Loss: 0.084 Test Acc: 0.978
Validation loss decreased (-0.971447 --> -0.978411).  Saving model ...
Epoch: 6 cost time: 1.9171142578125
Epoch: 6, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.071 Vali Acc: 0.981 Test Loss: 0.071 Test Acc: 0.981
Validation loss decreased (-0.978411 --> -0.980501).  Saving model ...
Epoch: 7 cost time: 2.0368521213531494
Epoch: 7, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.101 Vali Acc: 0.978 Test Loss: 0.101 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.012573480606079
Epoch: 8, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.082 Vali Acc: 0.982 Test Loss: 0.082 Test Acc: 0.982
Validation loss decreased (-0.980501 --> -0.981893).  Saving model ...
Epoch: 9 cost time: 2.0343220233917236
Epoch: 9, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.0616002082824707
Epoch: 10, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.134672164916992
Epoch: 11, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.112 Vali Acc: 0.972 Test Loss: 0.112 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.1274607181549072
Epoch: 12, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.152 Vali Acc: 0.972 Test Loss: 0.152 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.9158744812011719
Epoch: 13, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.182 Vali Acc: 0.962 Test Loss: 0.182 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.0019092559814453
Epoch: 14, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.199 Vali Acc: 0.974 Test Loss: 0.199 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.125431537628174
Epoch: 15, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.157 Vali Acc: 0.978 Test Loss: 0.157 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.129138469696045
Epoch: 16, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.146 Vali Acc: 0.978 Test Loss: 0.146 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.076685905456543
Epoch: 17, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.171 Vali Acc: 0.972 Test Loss: 0.171 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.106567621231079
Epoch: 18, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.171 Vali Acc: 0.972 Test Loss: 0.171 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps28_str14_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9818941504178273
model parameter : 706708
model size : 2.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps37_str19_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.9106876850128174
Epoch: 1, Steps: 89 | Train Loss: 1.940 Vali Loss: 0.778 Vali Acc: 0.816 Test Loss: 0.778 Test Acc: 0.816
Validation loss decreased (inf --> -0.816148).  Saving model ...
Epoch: 2 cost time: 2.2046494483947754
Epoch: 2, Steps: 89 | Train Loss: 0.411 Vali Loss: 0.242 Vali Acc: 0.940 Test Loss: 0.242 Test Acc: 0.940
Validation loss decreased (-0.816148 --> -0.940109).  Saving model ...
Epoch: 3 cost time: 2.0901601314544678
Epoch: 3, Steps: 89 | Train Loss: 0.146 Vali Loss: 0.173 Vali Acc: 0.952 Test Loss: 0.173 Test Acc: 0.952
Validation loss decreased (-0.940109 --> -0.951948).  Saving model ...
Epoch: 4 cost time: 2.1251320838928223
Epoch: 4, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.116 Vali Acc: 0.976 Test Loss: 0.116 Test Acc: 0.976
Validation loss decreased (-0.951948 --> -0.975626).  Saving model ...
Epoch: 5 cost time: 2.143444299697876
Epoch: 5, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.083 Vali Acc: 0.982 Test Loss: 0.083 Test Acc: 0.982
Validation loss decreased (-0.975626 --> -0.981893).  Saving model ...
Epoch: 6 cost time: 1.792801856994629
Epoch: 6, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
Validation loss decreased (-0.981893 --> -0.982590).  Saving model ...
Epoch: 7 cost time: 2.0668838024139404
Epoch: 7, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.0691630840301514
Epoch: 8, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.098 Vali Acc: 0.975 Test Loss: 0.098 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.8852052688598633
Epoch: 9, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.108 Vali Acc: 0.974 Test Loss: 0.108 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.368920087814331
Epoch: 10, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.073 Vali Acc: 0.985 Test Loss: 0.073 Test Acc: 0.985
Validation loss decreased (-0.982590 --> -0.985375).  Saving model ...
Epoch: 11 cost time: 2.266732931137085
Epoch: 11, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.109 Vali Acc: 0.971 Test Loss: 0.109 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9114398956298828
Epoch: 12, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.292 Vali Acc: 0.942 Test Loss: 0.292 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.008211612701416
Epoch: 13, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.1312124729156494
Epoch: 14, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.142 Vali Acc: 0.966 Test Loss: 0.142 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.0672664642333984
Epoch: 15, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.145 Vali Acc: 0.971 Test Loss: 0.145 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.184995651245117
Epoch: 16, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.134 Vali Acc: 0.980 Test Loss: 0.134 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.1204564571380615
Epoch: 17, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.115 Vali Acc: 0.982 Test Loss: 0.115 Test Acc: 0.982
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.124159097671509
Epoch: 18, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.2934272289276123
Epoch: 19, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.332 Vali Acc: 0.957 Test Loss: 0.332 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.14333176612854
Epoch: 20, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.111 Vali Acc: 0.981 Test Loss: 0.111 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps37_str19_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9853760445682451
model parameter : 677140
model size : 2.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps46_str23_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.9832146167755127
Epoch: 1, Steps: 89 | Train Loss: 1.992 Vali Loss: 0.797 Vali Acc: 0.819 Test Loss: 0.797 Test Acc: 0.819
Validation loss decreased (inf --> -0.818934).  Saving model ...
Epoch: 2 cost time: 1.8353862762451172
Epoch: 2, Steps: 89 | Train Loss: 0.440 Vali Loss: 0.238 Vali Acc: 0.948 Test Loss: 0.238 Test Acc: 0.948
Validation loss decreased (-0.818934 --> -0.948466).  Saving model ...
Epoch: 3 cost time: 2.0446996688842773
Epoch: 3, Steps: 89 | Train Loss: 0.162 Vali Loss: 0.129 Vali Acc: 0.965 Test Loss: 0.129 Test Acc: 0.965
Validation loss decreased (-0.948466 --> -0.965180).  Saving model ...
Epoch: 4 cost time: 2.183701276779175
Epoch: 4, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.096 Vali Acc: 0.975 Test Loss: 0.096 Test Acc: 0.975
Validation loss decreased (-0.965180 --> -0.974929).  Saving model ...
Epoch: 5 cost time: 2.1038191318511963
Epoch: 5, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.103 Vali Acc: 0.974 Test Loss: 0.103 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.183521270751953
Epoch: 6, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.974929 --> -0.977019).  Saving model ...
Epoch: 7 cost time: 2.205535411834717
Epoch: 7, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.069 Vali Acc: 0.982 Test Loss: 0.069 Test Acc: 0.982
Validation loss decreased (-0.977019 --> -0.981893).  Saving model ...
Epoch: 8 cost time: 2.234384059906006
Epoch: 8, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.250180721282959
Epoch: 9, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.1708972454071045
Epoch: 10, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.076695442199707
Epoch: 11, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.9602735042572021
Epoch: 12, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.128 Vali Acc: 0.965 Test Loss: 0.128 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.7768549919128418
Epoch: 13, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.202 Vali Acc: 0.959 Test Loss: 0.202 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.1265199184417725
Epoch: 14, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.144 Vali Acc: 0.969 Test Loss: 0.144 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.619558095932007
Epoch: 15, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.105 Vali Acc: 0.982 Test Loss: 0.105 Test Acc: 0.982
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.607792377471924
Epoch: 16, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.099 Vali Acc: 0.985 Test Loss: 0.099 Test Acc: 0.985
Validation loss decreased (-0.981893 --> -0.984679).  Saving model ...
Epoch: 17 cost time: 2.7832257747650146
Epoch: 17, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.099 Vali Acc: 0.981 Test Loss: 0.099 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.647209644317627
Epoch: 18, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.983 Test Loss: 0.098 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.494738817214966
Epoch: 19, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.101 Vali Acc: 0.981 Test Loss: 0.101 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.686753034591675
Epoch: 20, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.091 Vali Acc: 0.984 Test Loss: 0.091 Test Acc: 0.984
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.614408493041992
Epoch: 21, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.105 Vali Acc: 0.981 Test Loss: 0.105 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.6676111221313477
Epoch: 22, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.212 Vali Acc: 0.964 Test Loss: 0.212 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.620007038116455
Epoch: 23, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.229 Vali Acc: 0.960 Test Loss: 0.229 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.5635433197021484
Epoch: 24, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.142 Vali Acc: 0.975 Test Loss: 0.142 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.6709930896759033
Epoch: 25, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.140 Vali Acc: 0.978 Test Loss: 0.140 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.7596659660339355
Epoch: 26, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.148 Vali Acc: 0.980 Test Loss: 0.148 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128-256_nb1-1_lk13-13_sk5-5_ffr1_ps46_str23_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9846796657381616
model parameter : 662932
model size : 2.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.145420789718628
Epoch: 1, Steps: 89 | Train Loss: 1.485 Vali Loss: 0.404 Vali Acc: 0.873 Test Loss: 0.404 Test Acc: 0.873
Validation loss decreased (inf --> -0.873255).  Saving model ...
Epoch: 2 cost time: 2.3339624404907227
Epoch: 2, Steps: 89 | Train Loss: 0.252 Vali Loss: 0.171 Vali Acc: 0.953 Test Loss: 0.171 Test Acc: 0.953
Validation loss decreased (-0.873255 --> -0.952645).  Saving model ...
Epoch: 3 cost time: 2.3136842250823975
Epoch: 3, Steps: 89 | Train Loss: 0.135 Vali Loss: 0.205 Vali Acc: 0.939 Test Loss: 0.205 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.364020824432373
Epoch: 4, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.141 Vali Acc: 0.969 Test Loss: 0.141 Test Acc: 0.969
Validation loss decreased (-0.952645 --> -0.969358).  Saving model ...
Epoch: 5 cost time: 2.2383878231048584
Epoch: 5, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.188 Vali Acc: 0.966 Test Loss: 0.188 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.1489222049713135
Epoch: 6, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.157 Vali Acc: 0.964 Test Loss: 0.157 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.0866737365722656
Epoch: 7, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.168 Vali Acc: 0.971 Test Loss: 0.168 Test Acc: 0.971
Validation loss decreased (-0.969358 --> -0.971447).  Saving model ...
Epoch: 8 cost time: 2.1969010829925537
Epoch: 8, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.123 Vali Acc: 0.977 Test Loss: 0.123 Test Acc: 0.977
Validation loss decreased (-0.971447 --> -0.977018).  Saving model ...
Epoch: 9 cost time: 2.322556495666504
Epoch: 9, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.154 Vali Acc: 0.974 Test Loss: 0.154 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.272947311401367
Epoch: 10, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.162 Vali Acc: 0.976 Test Loss: 0.162 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.3139705657958984
Epoch: 11, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.183 Vali Acc: 0.974 Test Loss: 0.183 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.18936824798584
Epoch: 12, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.183 Vali Acc: 0.972 Test Loss: 0.183 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.309556007385254
Epoch: 13, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.288 Vali Acc: 0.962 Test Loss: 0.288 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.348087787628174
Epoch: 14, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.123 Vali Acc: 0.977 Test Loss: 0.123 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.299804925918579
Epoch: 15, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.281 Vali Acc: 0.964 Test Loss: 0.281 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.3732709884643555
Epoch: 16, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.216 Vali Acc: 0.962 Test Loss: 0.216 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.277712821960449
Epoch: 17, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.201 Vali Acc: 0.975 Test Loss: 0.201 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.1515884399414062
Epoch: 18, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.198 Vali Acc: 0.975 Test Loss: 0.198 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9770194986072424
model parameter : 389268
model size : 1.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.164947271347046
Epoch: 1, Steps: 89 | Train Loss: 1.732 Vali Loss: 0.566 Vali Acc: 0.847 Test Loss: 0.566 Test Acc: 0.847
Validation loss decreased (inf --> -0.847487).  Saving model ...
Epoch: 2 cost time: 2.391542673110962
Epoch: 2, Steps: 89 | Train Loss: 0.308 Vali Loss: 0.225 Vali Acc: 0.943 Test Loss: 0.225 Test Acc: 0.943
Validation loss decreased (-0.847487 --> -0.942895).  Saving model ...
Epoch: 3 cost time: 2.062044858932495
Epoch: 3, Steps: 89 | Train Loss: 0.139 Vali Loss: 0.155 Vali Acc: 0.962 Test Loss: 0.155 Test Acc: 0.962
Validation loss decreased (-0.942895 --> -0.962394).  Saving model ...
Epoch: 4 cost time: 1.9971001148223877
Epoch: 4, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.131 Vali Acc: 0.967 Test Loss: 0.131 Test Acc: 0.967
Validation loss decreased (-0.962394 --> -0.967269).  Saving model ...
Epoch: 5 cost time: 2.18052077293396
Epoch: 5, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.156 Vali Acc: 0.959 Test Loss: 0.156 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.842944622039795
Epoch: 6, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.118 Vali Acc: 0.976 Test Loss: 0.118 Test Acc: 0.976
Validation loss decreased (-0.967269 --> -0.975626).  Saving model ...
Epoch: 7 cost time: 2.1289937496185303
Epoch: 7, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.144 Vali Acc: 0.970 Test Loss: 0.144 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.13456654548645
Epoch: 8, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.130 Vali Acc: 0.975 Test Loss: 0.130 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.0005910396575928
Epoch: 9, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.143 Vali Acc: 0.970 Test Loss: 0.143 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.116123914718628
Epoch: 10, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.119 Vali Acc: 0.976 Test Loss: 0.119 Test Acc: 0.976
Validation loss decreased (-0.975626 --> -0.976322).  Saving model ...
Epoch: 11 cost time: 2.216334104537964
Epoch: 11, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.153 Vali Acc: 0.974 Test Loss: 0.153 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.107142686843872
Epoch: 12, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.154 Vali Acc: 0.974 Test Loss: 0.154 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.0759270191192627
Epoch: 13, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.182 Vali Acc: 0.965 Test Loss: 0.182 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.2139835357666016
Epoch: 14, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.157 Vali Acc: 0.974 Test Loss: 0.157 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.160695791244507
Epoch: 15, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.158 Vali Acc: 0.971 Test Loss: 0.158 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.1968650817871094
Epoch: 16, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.186 Vali Acc: 0.974 Test Loss: 0.186 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.2207565307617188
Epoch: 17, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.139 Vali Acc: 0.978 Test Loss: 0.139 Test Acc: 0.978
Validation loss decreased (-0.976322 --> -0.977714).  Saving model ...
Epoch: 18 cost time: 2.207017183303833
Epoch: 18, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.150 Vali Acc: 0.980 Test Loss: 0.150 Test Acc: 0.980
Validation loss decreased (-0.977714 --> -0.979804).  Saving model ...
Epoch: 19 cost time: 2.2197351455688477
Epoch: 19, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.126 Vali Acc: 0.984 Test Loss: 0.126 Test Acc: 0.984
Validation loss decreased (-0.979804 --> -0.983982).  Saving model ...
Epoch: 20 cost time: 2.1320297718048096
Epoch: 20, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.202 Vali Acc: 0.972 Test Loss: 0.202 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.2220146656036377
Epoch: 21, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.149 Vali Acc: 0.979 Test Loss: 0.149 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.1864492893218994
Epoch: 22, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.201 Vali Acc: 0.971 Test Loss: 0.201 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.267766237258911
Epoch: 23, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.146 Vali Acc: 0.978 Test Loss: 0.146 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.1962053775787354
Epoch: 24, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.220 Vali Acc: 0.964 Test Loss: 0.220 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.227022171020508
Epoch: 25, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.215 Vali Acc: 0.971 Test Loss: 0.215 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.1886024475097656
Epoch: 26, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.231 Vali Acc: 0.969 Test Loss: 0.231 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.997649908065796
Epoch: 27, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.253 Vali Acc: 0.965 Test Loss: 0.253 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.2210490703582764
Epoch: 28, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.204 Vali Acc: 0.980 Test Loss: 0.204 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.1988046169281006
Epoch: 29, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.215 Vali Acc: 0.977 Test Loss: 0.215 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.983983286908078
model parameter : 297428
model size : 1.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps14_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.8560328483581543
Epoch: 1, Steps: 89 | Train Loss: 1.831 Vali Loss: 0.632 Vali Acc: 0.822 Test Loss: 0.632 Test Acc: 0.822
Validation loss decreased (inf --> -0.822417).  Saving model ...
Epoch: 2 cost time: 2.267507791519165
Epoch: 2, Steps: 89 | Train Loss: 0.371 Vali Loss: 0.246 Vali Acc: 0.931 Test Loss: 0.246 Test Acc: 0.931
Validation loss decreased (-0.822417 --> -0.931056).  Saving model ...
Epoch: 3 cost time: 2.3418242931365967
Epoch: 3, Steps: 89 | Train Loss: 0.157 Vali Loss: 0.245 Vali Acc: 0.928 Test Loss: 0.245 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.2425379753112793
Epoch: 4, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.134 Vali Acc: 0.967 Test Loss: 0.134 Test Acc: 0.967
Validation loss decreased (-0.931056 --> -0.966572).  Saving model ...
Epoch: 5 cost time: 2.4106316566467285
Epoch: 5, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.132 Vali Acc: 0.964 Test Loss: 0.132 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.1836650371551514
Epoch: 6, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.111 Vali Acc: 0.972 Test Loss: 0.111 Test Acc: 0.972
Validation loss decreased (-0.966572 --> -0.972144).  Saving model ...
Epoch: 7 cost time: 2.29702091217041
Epoch: 7, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.088 Vali Acc: 0.978 Test Loss: 0.088 Test Acc: 0.978
Validation loss decreased (-0.972144 --> -0.977715).  Saving model ...
Epoch: 8 cost time: 2.37532377243042
Epoch: 8, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.126 Vali Acc: 0.971 Test Loss: 0.126 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.2996132373809814
Epoch: 9, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.115 Vali Acc: 0.971 Test Loss: 0.115 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.382833957672119
Epoch: 10, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.137 Vali Acc: 0.964 Test Loss: 0.137 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.3335251808166504
Epoch: 11, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.183 Vali Acc: 0.961 Test Loss: 0.183 Test Acc: 0.961
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.2363946437835693
Epoch: 12, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.101 Vali Acc: 0.983 Test Loss: 0.101 Test Acc: 0.983
Validation loss decreased (-0.977715 --> -0.983286).  Saving model ...
Epoch: 13 cost time: 2.316164970397949
Epoch: 13, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.114 Vali Acc: 0.981 Test Loss: 0.114 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.422929525375366
Epoch: 14, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.118 Vali Acc: 0.983 Test Loss: 0.118 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.2895522117614746
Epoch: 15, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.123 Vali Acc: 0.979 Test Loss: 0.123 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.3482859134674072
Epoch: 16, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.183 Vali Acc: 0.969 Test Loss: 0.183 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.4448583126068115
Epoch: 17, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.188 Vali Acc: 0.967 Test Loss: 0.188 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.184034824371338
Epoch: 18, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.170 Vali Acc: 0.969 Test Loss: 0.170 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.171921730041504
Epoch: 19, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.133 Vali Acc: 0.983 Test Loss: 0.133 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.3272385597229004
Epoch: 20, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.177 Vali Acc: 0.974 Test Loss: 0.177 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.2796266078948975
Epoch: 21, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.116 Vali Acc: 0.983 Test Loss: 0.116 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.234628200531006
Epoch: 22, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.172 Vali Acc: 0.973 Test Loss: 0.172 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps14_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9832869080779945
model parameter : 259284
model size : 1.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps19_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.347226619720459
Epoch: 1, Steps: 89 | Train Loss: 2.096 Vali Loss: 0.816 Vali Acc: 0.833 Test Loss: 0.816 Test Acc: 0.833
Validation loss decreased (inf --> -0.832861).  Saving model ...
Epoch: 2 cost time: 5.288598537445068
Epoch: 2, Steps: 89 | Train Loss: 0.441 Vali Loss: 0.277 Vali Acc: 0.929 Test Loss: 0.277 Test Acc: 0.929
Validation loss decreased (-0.832861 --> -0.928967).  Saving model ...
Epoch: 3 cost time: 5.235832452774048
Epoch: 3, Steps: 89 | Train Loss: 0.181 Vali Loss: 0.152 Vali Acc: 0.965 Test Loss: 0.152 Test Acc: 0.965
Validation loss decreased (-0.928967 --> -0.965180).  Saving model ...
Epoch: 4 cost time: 5.083622932434082
Epoch: 4, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.115 Vali Acc: 0.976 Test Loss: 0.115 Test Acc: 0.976
Validation loss decreased (-0.965180 --> -0.975626).  Saving model ...
Epoch: 5 cost time: 5.015787363052368
Epoch: 5, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.093 Vali Acc: 0.976 Test Loss: 0.093 Test Acc: 0.976
Validation loss decreased (-0.975626 --> -0.976322).  Saving model ...
Epoch: 6 cost time: 5.204570531845093
Epoch: 6, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.109 Vali Acc: 0.970 Test Loss: 0.109 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.664269924163818
Epoch: 7, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.123 Vali Acc: 0.971 Test Loss: 0.123 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.237367153167725
Epoch: 8, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.097 Vali Acc: 0.975 Test Loss: 0.097 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.182580947875977
Epoch: 9, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.073 Vali Acc: 0.981 Test Loss: 0.073 Test Acc: 0.981
Validation loss decreased (-0.976322 --> -0.980501).  Saving model ...
Epoch: 10 cost time: 5.1194167137146
Epoch: 10, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.080 Vali Acc: 0.984 Test Loss: 0.080 Test Acc: 0.984
Validation loss decreased (-0.980501 --> -0.983982).  Saving model ...
Epoch: 11 cost time: 5.117684364318848
Epoch: 11, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.071 Vali Acc: 0.985 Test Loss: 0.071 Test Acc: 0.985
Validation loss decreased (-0.983982 --> -0.985375).  Saving model ...
Epoch: 12 cost time: 5.143834114074707
Epoch: 12, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.046217203140259
Epoch: 13, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.091 Vali Acc: 0.983 Test Loss: 0.091 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.137303113937378
Epoch: 14, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.831006288528442
Epoch: 15, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.140 Vali Acc: 0.976 Test Loss: 0.140 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.8548524379730225
Epoch: 16, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.146 Vali Acc: 0.967 Test Loss: 0.146 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 5.160222053527832
Epoch: 17, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.095 Vali Acc: 0.983 Test Loss: 0.095 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 5.082836151123047
Epoch: 18, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.166 Vali Acc: 0.965 Test Loss: 0.166 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 4.485844373703003
Epoch: 19, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.082 Vali Acc: 0.985 Test Loss: 0.082 Test Acc: 0.985
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 4.919686317443848
Epoch: 20, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.089 Vali Acc: 0.979 Test Loss: 0.089 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 5.0511555671691895
Epoch: 21, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.062 Vali Acc: 0.988 Test Loss: 0.062 Test Acc: 0.988
Validation loss decreased (-0.985375 --> -0.988161).  Saving model ...
Epoch: 22 cost time: 4.724521636962891
Epoch: 22, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.086 Vali Acc: 0.987 Test Loss: 0.086 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 4.67362117767334
Epoch: 23, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.152 Vali Acc: 0.973 Test Loss: 0.152 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 4.721578598022461
Epoch: 24, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.097 Vali Acc: 0.981 Test Loss: 0.097 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 5.213097095489502
Epoch: 25, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.118 Vali Acc: 0.975 Test Loss: 0.118 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 5.006021499633789
Epoch: 26, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.090 Vali Acc: 0.987 Test Loss: 0.090 Test Acc: 0.987
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 4.612706899642944
Epoch: 27, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.986 Test Loss: 0.093 Test Acc: 0.986
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 5.124070167541504
Epoch: 28, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.987 Test Loss: 0.094 Test Acc: 0.987
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 5.243030071258545
Epoch: 29, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.987 Test Loss: 0.091 Test Acc: 0.987
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 4.2201244831085205
Epoch: 30, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.988 Test Loss: 0.092 Test Acc: 0.988
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 3.954040288925171
Epoch: 31, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.985 Test Loss: 0.097 Test Acc: 0.985
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps19_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9881615598885793
model parameter : 228884
model size : 0.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps28_str14_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.2060487270355225
Epoch: 1, Steps: 89 | Train Loss: 2.237 Vali Loss: 1.010 Vali Acc: 0.834 Test Loss: 1.010 Test Acc: 0.834
Validation loss decreased (inf --> -0.833555).  Saving model ...
Epoch: 2 cost time: 4.35957932472229
Epoch: 2, Steps: 89 | Train Loss: 0.547 Vali Loss: 0.355 Vali Acc: 0.893 Test Loss: 0.355 Test Acc: 0.893
Validation loss decreased (-0.833555 --> -0.893450).  Saving model ...
Epoch: 3 cost time: 4.902063846588135
Epoch: 3, Steps: 89 | Train Loss: 0.225 Vali Loss: 0.182 Vali Acc: 0.960 Test Loss: 0.182 Test Acc: 0.960
Validation loss decreased (-0.893450 --> -0.960305).  Saving model ...
Epoch: 4 cost time: 4.99755072593689
Epoch: 4, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.133 Vali Acc: 0.967 Test Loss: 0.133 Test Acc: 0.967
Validation loss decreased (-0.960305 --> -0.966572).  Saving model ...
Epoch: 5 cost time: 4.56536078453064
Epoch: 5, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.103 Vali Acc: 0.972 Test Loss: 0.103 Test Acc: 0.972
Validation loss decreased (-0.966572 --> -0.972144).  Saving model ...
Epoch: 6 cost time: 5.087271451950073
Epoch: 6, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.084 Vali Acc: 0.981 Test Loss: 0.084 Test Acc: 0.981
Validation loss decreased (-0.972144 --> -0.980501).  Saving model ...
Epoch: 7 cost time: 4.715196371078491
Epoch: 7, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.079 Vali Acc: 0.985 Test Loss: 0.079 Test Acc: 0.985
Validation loss decreased (-0.980501 --> -0.984679).  Saving model ...
Epoch: 8 cost time: 5.074634790420532
Epoch: 8, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.076 Vali Acc: 0.981 Test Loss: 0.076 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.2716639041900635
Epoch: 9, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.074 Vali Acc: 0.981 Test Loss: 0.074 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.417735576629639
Epoch: 10, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.544475317001343
Epoch: 11, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.073 Vali Acc: 0.984 Test Loss: 0.073 Test Acc: 0.984
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.9984753131866455
Epoch: 12, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.89411187171936
Epoch: 13, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.066 Vali Acc: 0.985 Test Loss: 0.066 Test Acc: 0.985
Validation loss decreased (-0.984679 --> -0.985375).  Saving model ...
Epoch: 14 cost time: 4.942227602005005
Epoch: 14, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.059 Vali Acc: 0.987 Test Loss: 0.059 Test Acc: 0.987
Validation loss decreased (-0.985375 --> -0.986768).  Saving model ...
Epoch: 15 cost time: 4.439361810684204
Epoch: 15, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.7274415493011475
Epoch: 16, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.091 Vali Acc: 0.983 Test Loss: 0.091 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.196656703948975
Epoch: 17, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.099 Vali Acc: 0.974 Test Loss: 0.099 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.976053476333618
Epoch: 18, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.067 Vali Acc: 0.985 Test Loss: 0.067 Test Acc: 0.985
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 5.0116705894470215
Epoch: 19, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.109 Vali Acc: 0.971 Test Loss: 0.109 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 5.054733991622925
Epoch: 20, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.126 Vali Acc: 0.977 Test Loss: 0.126 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 5.112266778945923
Epoch: 21, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.101 Vali Acc: 0.978 Test Loss: 0.101 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 4.100198030471802
Epoch: 22, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.108 Vali Acc: 0.981 Test Loss: 0.108 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 4.826007604598999
Epoch: 23, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.081 Vali Acc: 0.982 Test Loss: 0.081 Test Acc: 0.982
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 4.949511528015137
Epoch: 24, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.111 Vali Acc: 0.982 Test Loss: 0.111 Test Acc: 0.982
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps28_str14_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9867688022284122
model parameter : 214100
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps37_str19_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.0557169914245605
Epoch: 1, Steps: 89 | Train Loss: 2.408 Vali Loss: 1.384 Vali Acc: 0.715 Test Loss: 1.384 Test Acc: 0.715
Validation loss decreased (inf --> -0.715167).  Saving model ...
Epoch: 2 cost time: 3.78663969039917
Epoch: 2, Steps: 89 | Train Loss: 0.737 Vali Loss: 0.395 Vali Acc: 0.901 Test Loss: 0.395 Test Acc: 0.901
Validation loss decreased (-0.715167 --> -0.901110).  Saving model ...
Epoch: 3 cost time: 4.170823812484741
Epoch: 3, Steps: 89 | Train Loss: 0.280 Vali Loss: 0.195 Vali Acc: 0.957 Test Loss: 0.195 Test Acc: 0.957
Validation loss decreased (-0.901110 --> -0.956823).  Saving model ...
Epoch: 4 cost time: 4.926430702209473
Epoch: 4, Steps: 89 | Train Loss: 0.150 Vali Loss: 0.140 Vali Acc: 0.964 Test Loss: 0.140 Test Acc: 0.964
Validation loss decreased (-0.956823 --> -0.964483).  Saving model ...
Epoch: 5 cost time: 4.848418951034546
Epoch: 5, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.103 Vali Acc: 0.978 Test Loss: 0.103 Test Acc: 0.978
Validation loss decreased (-0.964483 --> -0.977715).  Saving model ...
Epoch: 6 cost time: 5.04404091835022
Epoch: 6, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.085 Vali Acc: 0.979 Test Loss: 0.085 Test Acc: 0.979
Validation loss decreased (-0.977715 --> -0.979108).  Saving model ...
Epoch: 7 cost time: 5.087167501449585
Epoch: 7, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.643447160720825
Epoch: 8, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.086 Vali Acc: 0.982 Test Loss: 0.086 Test Acc: 0.982
Validation loss decreased (-0.979108 --> -0.981893).  Saving model ...
Epoch: 9 cost time: 5.233703374862671
Epoch: 9, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.084 Vali Acc: 0.982 Test Loss: 0.084 Test Acc: 0.982
Validation loss decreased (-0.981893 --> -0.981893).  Saving model ...
Epoch: 10 cost time: 4.659279108047485
Epoch: 10, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.060 Vali Acc: 0.985 Test Loss: 0.060 Test Acc: 0.985
Validation loss decreased (-0.981893 --> -0.985375).  Saving model ...
Epoch: 11 cost time: 4.790246963500977
Epoch: 11, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.196792840957642
Epoch: 12, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.074 Vali Acc: 0.982 Test Loss: 0.074 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.659479141235352
Epoch: 13, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.976567029953003
Epoch: 14, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.074 Vali Acc: 0.979 Test Loss: 0.074 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.640232563018799
Epoch: 15, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.065 Vali Acc: 0.985 Test Loss: 0.065 Test Acc: 0.985
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.972648859024048
Epoch: 16, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.258752822875977
Epoch: 17, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.072 Vali Acc: 0.984 Test Loss: 0.072 Test Acc: 0.984
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 4.783187389373779
Epoch: 18, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.100 Vali Acc: 0.982 Test Loss: 0.100 Test Acc: 0.982
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 4.743923187255859
Epoch: 19, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.097 Vali Acc: 0.982 Test Loss: 0.097 Test Acc: 0.982
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 4.678241729736328
Epoch: 20, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.148 Vali Acc: 0.966 Test Loss: 0.148 Test Acc: 0.966
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps37_str19_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9853760445682451
model parameter : 199316
model size : 0.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps46_str23_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.45243763923645
Epoch: 1, Steps: 89 | Train Loss: 2.499 Vali Loss: 1.594 Vali Acc: 0.683 Test Loss: 1.594 Test Acc: 0.683
Validation loss decreased (inf --> -0.683132).  Saving model ...
Epoch: 2 cost time: 4.741610765457153
Epoch: 2, Steps: 89 | Train Loss: 0.889 Vali Loss: 0.496 Vali Acc: 0.880 Test Loss: 0.496 Test Acc: 0.880
Validation loss decreased (-0.683132 --> -0.879522).  Saving model ...
Epoch: 3 cost time: 4.650429010391235
Epoch: 3, Steps: 89 | Train Loss: 0.335 Vali Loss: 0.240 Vali Acc: 0.942 Test Loss: 0.240 Test Acc: 0.942
Validation loss decreased (-0.879522 --> -0.941502).  Saving model ...
Epoch: 4 cost time: 4.866363763809204
Epoch: 4, Steps: 89 | Train Loss: 0.160 Vali Loss: 0.141 Vali Acc: 0.970 Test Loss: 0.141 Test Acc: 0.970
Validation loss decreased (-0.941502 --> -0.970054).  Saving model ...
Epoch: 5 cost time: 5.514832496643066
Epoch: 5, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.125 Vali Acc: 0.965 Test Loss: 0.125 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.5851874351501465
Epoch: 6, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.091 Vali Acc: 0.978 Test Loss: 0.091 Test Acc: 0.978
Validation loss decreased (-0.970054 --> -0.977715).  Saving model ...
Epoch: 7 cost time: 5.450794219970703
Epoch: 7, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.084 Vali Acc: 0.980 Test Loss: 0.084 Test Acc: 0.980
Validation loss decreased (-0.977715 --> -0.979804).  Saving model ...
Epoch: 8 cost time: 5.122644901275635
Epoch: 8, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.091 Vali Acc: 0.974 Test Loss: 0.091 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.395691156387329
Epoch: 9, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.346118450164795
Epoch: 10, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.070 Vali Acc: 0.982 Test Loss: 0.070 Test Acc: 0.982
Validation loss decreased (-0.979804 --> -0.981893).  Saving model ...
Epoch: 11 cost time: 5.328886270523071
Epoch: 11, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.060 Vali Acc: 0.983 Test Loss: 0.060 Test Acc: 0.983
Validation loss decreased (-0.981893 --> -0.983286).  Saving model ...
Epoch: 12 cost time: 5.061199426651001
Epoch: 12, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.084 Vali Acc: 0.981 Test Loss: 0.084 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.272604703903198
Epoch: 13, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.842043399810791
Epoch: 14, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.094 Vali Acc: 0.976 Test Loss: 0.094 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.056158065795898
Epoch: 15, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.084 Vali Acc: 0.982 Test Loss: 0.084 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.291252374649048
Epoch: 16, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.120 Vali Acc: 0.975 Test Loss: 0.120 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.5525476932525635
Epoch: 17, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.071 Vali Acc: 0.984 Test Loss: 0.071 Test Acc: 0.984
Validation loss decreased (-0.983286 --> -0.983983).  Saving model ...
Epoch: 18 cost time: 5.336893081665039
Epoch: 18, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.065 Vali Acc: 0.985 Test Loss: 0.065 Test Acc: 0.985
Validation loss decreased (-0.983983 --> -0.984679).  Saving model ...
Epoch: 19 cost time: 4.693979024887085
Epoch: 19, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.076 Vali Acc: 0.984 Test Loss: 0.076 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 5.26430869102478
Epoch: 20, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 5.311632871627808
Epoch: 21, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.082 Vali Acc: 0.982 Test Loss: 0.082 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 5.002254009246826
Epoch: 22, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 5.255901575088501
Epoch: 23, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 4.535032272338867
Epoch: 24, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.073 Vali Acc: 0.987 Test Loss: 0.073 Test Acc: 0.987
Validation loss decreased (-0.984679 --> -0.986768).  Saving model ...
Epoch: 25 cost time: 4.843041181564331
Epoch: 25, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 5.188576698303223
Epoch: 26, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.100 Vali Acc: 0.982 Test Loss: 0.100 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 5.32437801361084
Epoch: 27, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 5.24678897857666
Epoch: 28, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.087 Vali Acc: 0.982 Test Loss: 0.087 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 4.579001188278198
Epoch: 29, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 4.214482545852661
Epoch: 30, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.111 Vali Acc: 0.974 Test Loss: 0.111 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 4.895054817199707
Epoch: 31, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.144 Vali Acc: 0.972 Test Loss: 0.144 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 4.873675346374512
Epoch: 32, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.148 Vali Acc: 0.974 Test Loss: 0.148 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 4.401882886886597
Epoch: 33, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.149 Vali Acc: 0.978 Test Loss: 0.149 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 5.039135694503784
Epoch: 34, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.162 Vali Acc: 0.979 Test Loss: 0.162 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64-128_nb1-1_lk13-13_sk5-5_ffr1_ps46_str23_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9867688022284122
model parameter : 192212
model size : 0.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.544159889221191
Epoch: 1, Steps: 89 | Train Loss: 1.884 Vali Loss: 0.631 Vali Acc: 0.845 Test Loss: 0.631 Test Acc: 0.845
Validation loss decreased (inf --> -0.844701).  Saving model ...
Epoch: 2 cost time: 4.3560874462127686
Epoch: 2, Steps: 89 | Train Loss: 0.346 Vali Loss: 0.231 Vali Acc: 0.939 Test Loss: 0.231 Test Acc: 0.939
Validation loss decreased (-0.844701 --> -0.939413).  Saving model ...
Epoch: 3 cost time: 3.900831460952759
Epoch: 3, Steps: 89 | Train Loss: 0.144 Vali Loss: 0.138 Vali Acc: 0.964 Test Loss: 0.138 Test Acc: 0.964
Validation loss decreased (-0.939413 --> -0.963787).  Saving model ...
Epoch: 4 cost time: 3.235142707824707
Epoch: 4, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.112 Vali Acc: 0.971 Test Loss: 0.112 Test Acc: 0.971
Validation loss decreased (-0.963787 --> -0.970751).  Saving model ...
Epoch: 5 cost time: 3.554252862930298
Epoch: 5, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.106 Vali Acc: 0.972 Test Loss: 0.106 Test Acc: 0.972
Validation loss decreased (-0.970751 --> -0.972144).  Saving model ...
Epoch: 6 cost time: 3.8491969108581543
Epoch: 6, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.122 Vali Acc: 0.973 Test Loss: 0.122 Test Acc: 0.973
Validation loss decreased (-0.972144 --> -0.972840).  Saving model ...
Epoch: 7 cost time: 3.929180145263672
Epoch: 7, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.085 Vali Acc: 0.984 Test Loss: 0.085 Test Acc: 0.984
Validation loss decreased (-0.972840 --> -0.983982).  Saving model ...
Epoch: 8 cost time: 4.187088489532471
Epoch: 8, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.097 Vali Acc: 0.978 Test Loss: 0.097 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.9440529346466064
Epoch: 9, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.116 Vali Acc: 0.974 Test Loss: 0.116 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.221277475357056
Epoch: 10, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.104 Vali Acc: 0.978 Test Loss: 0.104 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.571584463119507
Epoch: 11, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.127 Vali Acc: 0.978 Test Loss: 0.127 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.0552613735198975
Epoch: 12, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.125 Vali Acc: 0.972 Test Loss: 0.125 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.843116044998169
Epoch: 13, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.146 Vali Acc: 0.975 Test Loss: 0.146 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.5978758335113525
Epoch: 14, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.177 Vali Acc: 0.974 Test Loss: 0.177 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.7523105144500732
Epoch: 15, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.181 Vali Acc: 0.971 Test Loss: 0.181 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.76839542388916
Epoch: 16, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.170 Vali Acc: 0.978 Test Loss: 0.170 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.962031841278076
Epoch: 17, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.131 Vali Acc: 0.981 Test Loss: 0.131 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.983983286908078
model parameter : 159828
model size : 0.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.848881006240845
Epoch: 1, Steps: 89 | Train Loss: 2.270 Vali Loss: 1.064 Vali Acc: 0.816 Test Loss: 1.064 Test Acc: 0.816
Validation loss decreased (inf --> -0.816145).  Saving model ...
Epoch: 2 cost time: 4.384806394577026
Epoch: 2, Steps: 89 | Train Loss: 0.557 Vali Loss: 0.347 Vali Acc: 0.903 Test Loss: 0.347 Test Acc: 0.903
Validation loss decreased (-0.816145 --> -0.902503).  Saving model ...
Epoch: 3 cost time: 4.276318550109863
Epoch: 3, Steps: 89 | Train Loss: 0.228 Vali Loss: 0.183 Vali Acc: 0.952 Test Loss: 0.183 Test Acc: 0.952
Validation loss decreased (-0.902503 --> -0.951948).  Saving model ...
Epoch: 4 cost time: 4.425418138504028
Epoch: 4, Steps: 89 | Train Loss: 0.120 Vali Loss: 0.127 Vali Acc: 0.971 Test Loss: 0.127 Test Acc: 0.971
Validation loss decreased (-0.951948 --> -0.970751).  Saving model ...
Epoch: 5 cost time: 4.313804626464844
Epoch: 5, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.107 Vali Acc: 0.971 Test Loss: 0.107 Test Acc: 0.971
Validation loss decreased (-0.970751 --> -0.970751).  Saving model ...
Epoch: 6 cost time: 3.817511558532715
Epoch: 6, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.108 Vali Acc: 0.971 Test Loss: 0.108 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.9612536430358887
Epoch: 7, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.089 Vali Acc: 0.979 Test Loss: 0.089 Test Acc: 0.979
Validation loss decreased (-0.970751 --> -0.979108).  Saving model ...
Epoch: 8 cost time: 3.4886558055877686
Epoch: 8, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.087 Vali Acc: 0.981 Test Loss: 0.087 Test Acc: 0.981
Validation loss decreased (-0.979108 --> -0.981197).  Saving model ...
Epoch: 9 cost time: 4.395824670791626
Epoch: 9, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.086 Vali Acc: 0.981 Test Loss: 0.086 Test Acc: 0.981
Validation loss decreased (-0.981197 --> -0.981197).  Saving model ...
Epoch: 10 cost time: 4.0564351081848145
Epoch: 10, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
Validation loss decreased (-0.981197 --> -0.982590).  Saving model ...
Epoch: 11 cost time: 4.000328779220581
Epoch: 11, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.249 Vali Acc: 0.942 Test Loss: 0.249 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.442029237747192
Epoch: 12, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.110 Vali Acc: 0.974 Test Loss: 0.110 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.920344591140747
Epoch: 13, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.125 Vali Acc: 0.979 Test Loss: 0.125 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.218306064605713
Epoch: 14, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.135 Vali Acc: 0.978 Test Loss: 0.135 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.668152332305908
Epoch: 15, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.189 Vali Acc: 0.960 Test Loss: 0.189 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.975831985473633
Epoch: 16, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.113 Vali Acc: 0.980 Test Loss: 0.113 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.9884860515594482
Epoch: 17, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 4.266051292419434
Epoch: 18, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.134 Vali Acc: 0.980 Test Loss: 0.134 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.770463466644287
Epoch: 19, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.146 Vali Acc: 0.979 Test Loss: 0.146 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.1846890449523926
Epoch: 20, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.115 Vali Acc: 0.984 Test Loss: 0.115 Test Acc: 0.984
Validation loss decreased (-0.982590 --> -0.983982).  Saving model ...
Epoch: 21 cost time: 4.5312464237213135
Epoch: 21, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.110 Vali Acc: 0.983 Test Loss: 0.110 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.881392240524292
Epoch: 22, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.136 Vali Acc: 0.975 Test Loss: 0.136 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 4.424189805984497
Epoch: 23, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.116 Vali Acc: 0.984 Test Loss: 0.116 Test Acc: 0.984
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 4.172695159912109
Epoch: 24, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.114 Vali Acc: 0.982 Test Loss: 0.114 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 4.12001371383667
Epoch: 25, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.136 Vali Acc: 0.976 Test Loss: 0.136 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 4.345771551132202
Epoch: 26, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.263 Vali Acc: 0.958 Test Loss: 0.263 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.8459057807922363
Epoch: 27, Steps: 89 | Train Loss: 0.140 Vali Loss: 0.343 Vali Acc: 0.945 Test Loss: 0.343 Test Acc: 0.945
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 3.5750341415405273
Epoch: 28, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.167 Vali Acc: 0.971 Test Loss: 0.167 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 4.2135539054870605
Epoch: 29, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.150 Vali Acc: 0.978 Test Loss: 0.150 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 4.111098051071167
Epoch: 30, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.163 Vali Acc: 0.976 Test Loss: 0.163 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.983983286908078
model parameter : 113908
model size : 0.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps14_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.11969256401062
Epoch: 1, Steps: 89 | Train Loss: 2.297 Vali Loss: 1.191 Vali Acc: 0.787 Test Loss: 1.191 Test Acc: 0.787
Validation loss decreased (inf --> -0.786896).  Saving model ...
Epoch: 2 cost time: 3.864229917526245
Epoch: 2, Steps: 89 | Train Loss: 0.638 Vali Loss: 0.398 Vali Acc: 0.886 Test Loss: 0.398 Test Acc: 0.886
Validation loss decreased (-0.786896 --> -0.885790).  Saving model ...
Epoch: 3 cost time: 3.3764665126800537
Epoch: 3, Steps: 89 | Train Loss: 0.249 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
Validation loss decreased (-0.885790 --> -0.944288).  Saving model ...
Epoch: 4 cost time: 4.440239667892456
Epoch: 4, Steps: 89 | Train Loss: 0.133 Vali Loss: 0.140 Vali Acc: 0.969 Test Loss: 0.140 Test Acc: 0.969
Validation loss decreased (-0.944288 --> -0.968662).  Saving model ...
Epoch: 5 cost time: 4.431180000305176
Epoch: 5, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.104 Vali Acc: 0.976 Test Loss: 0.104 Test Acc: 0.976
Validation loss decreased (-0.968662 --> -0.975626).  Saving model ...
Epoch: 6 cost time: 4.318732023239136
Epoch: 6, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.110 Vali Acc: 0.971 Test Loss: 0.110 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.6758997440338135
Epoch: 7, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
Validation loss decreased (-0.975626 --> -0.978411).  Saving model ...
Epoch: 8 cost time: 4.361516952514648
Epoch: 8, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.077 Vali Acc: 0.981 Test Loss: 0.077 Test Acc: 0.981
Validation loss decreased (-0.978411 --> -0.980501).  Saving model ...
Epoch: 9 cost time: 4.15185546875
Epoch: 9, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.101 Vali Acc: 0.975 Test Loss: 0.101 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.230093002319336
Epoch: 10, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.427061319351196
Epoch: 11, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.078 Vali Acc: 0.981 Test Loss: 0.078 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.116978406906128
Epoch: 12, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.087 Vali Acc: 0.981 Test Loss: 0.087 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.27437162399292
Epoch: 13, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.084 Vali Acc: 0.984 Test Loss: 0.084 Test Acc: 0.984
Validation loss decreased (-0.980501 --> -0.983982).  Saving model ...
Epoch: 14 cost time: 4.38748574256897
Epoch: 14, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.125 Vali Acc: 0.975 Test Loss: 0.125 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.8025572299957275
Epoch: 15, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.087 Vali Acc: 0.984 Test Loss: 0.087 Test Acc: 0.984
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.287883043289185
Epoch: 16, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.203434228897095
Epoch: 17, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 4.2385334968566895
Epoch: 18, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.122 Vali Acc: 0.977 Test Loss: 0.122 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 4.046723365783691
Epoch: 19, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.140 Vali Acc: 0.973 Test Loss: 0.140 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 4.453982830047607
Epoch: 20, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.133 Vali Acc: 0.974 Test Loss: 0.133 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 4.644184589385986
Epoch: 21, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.147 Vali Acc: 0.973 Test Loss: 0.147 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 4.422929763793945
Epoch: 22, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.102 Vali Acc: 0.984 Test Loss: 0.102 Test Acc: 0.984
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.964341878890991
Epoch: 23, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.098 Vali Acc: 0.983 Test Loss: 0.098 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps14_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.983983286908078
model parameter : 94836
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps19_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.776491403579712
Epoch: 1, Steps: 89 | Train Loss: 2.654 Vali Loss: 1.831 Vali Acc: 0.703 Test Loss: 1.831 Test Acc: 0.703
Validation loss decreased (inf --> -0.703324).  Saving model ...
Epoch: 2 cost time: 3.6101553440093994
Epoch: 2, Steps: 89 | Train Loss: 0.993 Vali Loss: 0.535 Vali Acc: 0.866 Test Loss: 0.535 Test Acc: 0.866
Validation loss decreased (-0.703324 --> -0.865594).  Saving model ...
Epoch: 3 cost time: 4.186343669891357
Epoch: 3, Steps: 89 | Train Loss: 0.379 Vali Loss: 0.275 Vali Acc: 0.935 Test Loss: 0.275 Test Acc: 0.935
Validation loss decreased (-0.865594 --> -0.935234).  Saving model ...
Epoch: 4 cost time: 4.2795093059539795
Epoch: 4, Steps: 89 | Train Loss: 0.204 Vali Loss: 0.178 Vali Acc: 0.960 Test Loss: 0.178 Test Acc: 0.960
Validation loss decreased (-0.935234 --> -0.959608).  Saving model ...
Epoch: 5 cost time: 4.946383237838745
Epoch: 5, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.127 Vali Acc: 0.971 Test Loss: 0.127 Test Acc: 0.971
Validation loss decreased (-0.959608 --> -0.970751).  Saving model ...
Epoch: 6 cost time: 4.51804780960083
Epoch: 6, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.096 Vali Acc: 0.979 Test Loss: 0.096 Test Acc: 0.979
Validation loss decreased (-0.970751 --> -0.979108).  Saving model ...
Epoch: 7 cost time: 4.693142890930176
Epoch: 7, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.740863561630249
Epoch: 8, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.080 Vali Acc: 0.978 Test Loss: 0.080 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.911215543746948
Epoch: 9, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.079 Vali Acc: 0.979 Test Loss: 0.079 Test Acc: 0.979
Validation loss decreased (-0.979108 --> -0.979108).  Saving model ...
Epoch: 10 cost time: 4.177684545516968
Epoch: 10, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
Validation loss decreased (-0.979108 --> -0.979804).  Saving model ...
Epoch: 11 cost time: 4.551789999008179
Epoch: 11, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.979804 --> -0.982590).  Saving model ...
Epoch: 12 cost time: 4.533923864364624
Epoch: 12, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.062 Vali Acc: 0.984 Test Loss: 0.062 Test Acc: 0.984
Validation loss decreased (-0.982590 --> -0.983983).  Saving model ...
Epoch: 13 cost time: 4.477263689041138
Epoch: 13, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.066 Vali Acc: 0.982 Test Loss: 0.066 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.631728649139404
Epoch: 14, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.068 Vali Acc: 0.984 Test Loss: 0.068 Test Acc: 0.984
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.19155740737915
Epoch: 15, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.695969581604004
Epoch: 16, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.077 Vali Acc: 0.981 Test Loss: 0.077 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.131325721740723
Epoch: 17, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.586656808853149
Epoch: 18, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.072 Vali Acc: 0.982 Test Loss: 0.072 Test Acc: 0.982
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.551587343215942
Epoch: 19, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 4.2523603439331055
Epoch: 20, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.083 Vali Acc: 0.981 Test Loss: 0.083 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 4.586561441421509
Epoch: 21, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.096 Vali Acc: 0.981 Test Loss: 0.096 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 4.494048595428467
Epoch: 22, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps19_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.983983286908078
model parameter : 79636
model size : 0.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps28_str14_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.82083797454834
Epoch: 1, Steps: 89 | Train Loss: 2.621 Vali Loss: 1.950 Vali Acc: 0.669 Test Loss: 1.950 Test Acc: 0.669
Validation loss decreased (inf --> -0.669201).  Saving model ...
Epoch: 2 cost time: 4.414062023162842
Epoch: 2, Steps: 89 | Train Loss: 1.134 Vali Loss: 0.601 Vali Acc: 0.861 Test Loss: 0.601 Test Acc: 0.861
Validation loss decreased (-0.669201 --> -0.861415).  Saving model ...
Epoch: 3 cost time: 4.595672607421875
Epoch: 3, Steps: 89 | Train Loss: 0.420 Vali Loss: 0.324 Vali Acc: 0.927 Test Loss: 0.324 Test Acc: 0.927
Validation loss decreased (-0.861415 --> -0.926877).  Saving model ...
Epoch: 4 cost time: 3.5908093452453613
Epoch: 4, Steps: 89 | Train Loss: 0.230 Vali Loss: 0.195 Vali Acc: 0.962 Test Loss: 0.195 Test Acc: 0.962
Validation loss decreased (-0.926877 --> -0.962394).  Saving model ...
Epoch: 5 cost time: 4.637660980224609
Epoch: 5, Steps: 89 | Train Loss: 0.142 Vali Loss: 0.140 Vali Acc: 0.969 Test Loss: 0.140 Test Acc: 0.969
Validation loss decreased (-0.962394 --> -0.968662).  Saving model ...
Epoch: 6 cost time: 4.1647443771362305
Epoch: 6, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.112 Vali Acc: 0.974 Test Loss: 0.112 Test Acc: 0.974
Validation loss decreased (-0.968662 --> -0.973536).  Saving model ...
Epoch: 7 cost time: 4.542775869369507
Epoch: 7, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.103 Vali Acc: 0.969 Test Loss: 0.103 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.617736577987671
Epoch: 8, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.092 Vali Acc: 0.977 Test Loss: 0.092 Test Acc: 0.977
Validation loss decreased (-0.973536 --> -0.977019).  Saving model ...
Epoch: 9 cost time: 4.581812381744385
Epoch: 9, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.078 Vali Acc: 0.978 Test Loss: 0.078 Test Acc: 0.978
Validation loss decreased (-0.977019 --> -0.978411).  Saving model ...
Epoch: 10 cost time: 4.678138017654419
Epoch: 10, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.070 Vali Acc: 0.982 Test Loss: 0.070 Test Acc: 0.982
Validation loss decreased (-0.978411 --> -0.981893).  Saving model ...
Epoch: 11 cost time: 4.121100187301636
Epoch: 11, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.067 Vali Acc: 0.981 Test Loss: 0.067 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.514012098312378
Epoch: 12, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.061 Vali Acc: 0.983 Test Loss: 0.061 Test Acc: 0.983
Validation loss decreased (-0.981893 --> -0.982590).  Saving model ...
Epoch: 13 cost time: 3.884263277053833
Epoch: 13, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.009252309799194
Epoch: 14, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.069 Vali Acc: 0.981 Test Loss: 0.069 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.29408073425293
Epoch: 15, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.074 Vali Acc: 0.978 Test Loss: 0.074 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.655873775482178
Epoch: 16, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.068 Vali Acc: 0.984 Test Loss: 0.068 Test Acc: 0.984
Validation loss decreased (-0.982590 --> -0.983983).  Saving model ...
Epoch: 17 cost time: 4.398121356964111
Epoch: 17, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.230988025665283
Epoch: 18, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.052 Vali Acc: 0.985 Test Loss: 0.052 Test Acc: 0.985
Validation loss decreased (-0.983983 --> -0.985376).  Saving model ...
Epoch: 19 cost time: 3.583369493484497
Epoch: 19, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.060 Vali Acc: 0.983 Test Loss: 0.060 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.572649002075195
Epoch: 20, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.055 Vali Acc: 0.984 Test Loss: 0.055 Test Acc: 0.984
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 4.524958610534668
Epoch: 21, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.054 Vali Acc: 0.987 Test Loss: 0.054 Test Acc: 0.987
Validation loss decreased (-0.985376 --> -0.986768).  Saving model ...
Epoch: 22 cost time: 4.5594165325164795
Epoch: 22, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.059 Vali Acc: 0.985 Test Loss: 0.059 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 4.587355375289917
Epoch: 23, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 4.408508777618408
Epoch: 24, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.071 Vali Acc: 0.987 Test Loss: 0.071 Test Acc: 0.987
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.876081705093384
Epoch: 25, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.085 Vali Acc: 0.984 Test Loss: 0.085 Test Acc: 0.984
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.605886220932007
Epoch: 26, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.057 Vali Acc: 0.989 Test Loss: 0.057 Test Acc: 0.989
Validation loss decreased (-0.986768 --> -0.988857).  Saving model ...
Epoch: 27 cost time: 3.401374578475952
Epoch: 27, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.059 Vali Acc: 0.987 Test Loss: 0.059 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 4.5637640953063965
Epoch: 28, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.080 Vali Acc: 0.984 Test Loss: 0.080 Test Acc: 0.984
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 4.576835870742798
Epoch: 29, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.060 Vali Acc: 0.987 Test Loss: 0.060 Test Acc: 0.987
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 4.369269609451294
Epoch: 30, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.064 Vali Acc: 0.987 Test Loss: 0.064 Test Acc: 0.987
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 4.3817338943481445
Epoch: 31, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.059 Vali Acc: 0.987 Test Loss: 0.059 Test Acc: 0.987
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 4.560860633850098
Epoch: 32, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.064 Vali Acc: 0.987 Test Loss: 0.064 Test Acc: 0.987
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 3.8124351501464844
Epoch: 33, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.061 Vali Acc: 0.987 Test Loss: 0.061 Test Acc: 0.987
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 4.452744007110596
Epoch: 34, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.064 Vali Acc: 0.987 Test Loss: 0.064 Test Acc: 0.987
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 3.979257583618164
Epoch: 35, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.080 Vali Acc: 0.985 Test Loss: 0.080 Test Acc: 0.985
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 4.527261257171631
Epoch: 36, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.105 Vali Acc: 0.984 Test Loss: 0.105 Test Acc: 0.984
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps28_str14_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9888579387186629
model parameter : 72244
model size : 0.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps37_str19_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.518618583679199
Epoch: 1, Steps: 89 | Train Loss: 2.707 Vali Loss: 2.168 Vali Acc: 0.569 Test Loss: 2.168 Test Acc: 0.569
Validation loss decreased (inf --> -0.568920).  Saving model ...
Epoch: 2 cost time: 4.0643205642700195
Epoch: 2, Steps: 89 | Train Loss: 1.455 Vali Loss: 0.847 Vali Acc: 0.829 Test Loss: 0.847 Test Acc: 0.829
Validation loss decreased (-0.568920 --> -0.828682).  Saving model ...
Epoch: 3 cost time: 3.717632293701172
Epoch: 3, Steps: 89 | Train Loss: 0.585 Vali Loss: 0.407 Vali Acc: 0.909 Test Loss: 0.407 Test Acc: 0.909
Validation loss decreased (-0.828682 --> -0.908770).  Saving model ...
Epoch: 4 cost time: 3.938253402709961
Epoch: 4, Steps: 89 | Train Loss: 0.309 Vali Loss: 0.258 Vali Acc: 0.933 Test Loss: 0.258 Test Acc: 0.933
Validation loss decreased (-0.908770 --> -0.933145).  Saving model ...
Epoch: 5 cost time: 4.229489326477051
Epoch: 5, Steps: 89 | Train Loss: 0.188 Vali Loss: 0.181 Vali Acc: 0.956 Test Loss: 0.181 Test Acc: 0.956
Validation loss decreased (-0.933145 --> -0.956126).  Saving model ...
Epoch: 6 cost time: 4.318815469741821
Epoch: 6, Steps: 89 | Train Loss: 0.130 Vali Loss: 0.134 Vali Acc: 0.972 Test Loss: 0.134 Test Acc: 0.972
Validation loss decreased (-0.956126 --> -0.972144).  Saving model ...
Epoch: 7 cost time: 4.1717610359191895
Epoch: 7, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.113 Vali Acc: 0.976 Test Loss: 0.113 Test Acc: 0.976
Validation loss decreased (-0.972144 --> -0.976322).  Saving model ...
Epoch: 8 cost time: 3.9271204471588135
Epoch: 8, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.088 Vali Acc: 0.983 Test Loss: 0.088 Test Acc: 0.983
Validation loss decreased (-0.976322 --> -0.983286).  Saving model ...
Epoch: 9 cost time: 3.9419915676116943
Epoch: 9, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.093 Vali Acc: 0.978 Test Loss: 0.093 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.357646942138672
Epoch: 10, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.091 Vali Acc: 0.979 Test Loss: 0.091 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.1346824169158936
Epoch: 11, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.075 Vali Acc: 0.984 Test Loss: 0.075 Test Acc: 0.984
Validation loss decreased (-0.983286 --> -0.983983).  Saving model ...
Epoch: 12 cost time: 3.878614902496338
Epoch: 12, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.072 Vali Acc: 0.985 Test Loss: 0.072 Test Acc: 0.985
Validation loss decreased (-0.983983 --> -0.985375).  Saving model ...
Epoch: 13 cost time: 4.2729878425598145
Epoch: 13, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.071 Vali Acc: 0.984 Test Loss: 0.071 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.154127836227417
Epoch: 14, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.216065168380737
Epoch: 15, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.729069948196411
Epoch: 16, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.023812294006348
Epoch: 17, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.076 Vali Acc: 0.981 Test Loss: 0.076 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.824348211288452
Epoch: 18, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.067 Vali Acc: 0.985 Test Loss: 0.067 Test Acc: 0.985
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.09707498550415
Epoch: 19, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.084 Vali Acc: 0.979 Test Loss: 0.084 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 4.201052904129028
Epoch: 20, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.075 Vali Acc: 0.981 Test Loss: 0.075 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.9485909938812256
Epoch: 21, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 4.171495199203491
Epoch: 22, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps37_str19_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9853760445682451
model parameter : 64852
model size : 0.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps46_str23_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.182210445404053
Epoch: 1, Steps: 89 | Train Loss: 2.734 Vali Loss: 2.243 Vali Acc: 0.553 Test Loss: 2.243 Test Acc: 0.553
Validation loss decreased (inf --> -0.552902).  Saving model ...
Epoch: 2 cost time: 4.081736087799072
Epoch: 2, Steps: 89 | Train Loss: 1.573 Vali Loss: 0.941 Vali Acc: 0.811 Test Loss: 0.941 Test Acc: 0.811
Validation loss decreased (-0.552902 --> -0.811272).  Saving model ...
Epoch: 3 cost time: 3.8884570598602295
Epoch: 3, Steps: 89 | Train Loss: 0.658 Vali Loss: 0.478 Vali Acc: 0.889 Test Loss: 0.478 Test Acc: 0.889
Validation loss decreased (-0.811272 --> -0.889271).  Saving model ...
Epoch: 4 cost time: 3.9823427200317383
Epoch: 4, Steps: 89 | Train Loss: 0.349 Vali Loss: 0.287 Vali Acc: 0.929 Test Loss: 0.287 Test Acc: 0.929
Validation loss decreased (-0.889271 --> -0.928966).  Saving model ...
Epoch: 5 cost time: 3.3690593242645264
Epoch: 5, Steps: 89 | Train Loss: 0.203 Vali Loss: 0.182 Vali Acc: 0.962 Test Loss: 0.182 Test Acc: 0.962
Validation loss decreased (-0.928966 --> -0.962394).  Saving model ...
Epoch: 6 cost time: 3.207925319671631
Epoch: 6, Steps: 89 | Train Loss: 0.135 Vali Loss: 0.134 Vali Acc: 0.974 Test Loss: 0.134 Test Acc: 0.974
Validation loss decreased (-0.962394 --> -0.973536).  Saving model ...
Epoch: 7 cost time: 3.7424521446228027
Epoch: 7, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.834914207458496
Epoch: 8, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.129 Vali Acc: 0.970 Test Loss: 0.129 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.151038646697998
Epoch: 9, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.090 Vali Acc: 0.979 Test Loss: 0.090 Test Acc: 0.979
Validation loss decreased (-0.973536 --> -0.979108).  Saving model ...
Epoch: 10 cost time: 4.174623250961304
Epoch: 10, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.080 Vali Acc: 0.981 Test Loss: 0.080 Test Acc: 0.981
Validation loss decreased (-0.979108 --> -0.980501).  Saving model ...
Epoch: 11 cost time: 4.086232423782349
Epoch: 11, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.107 Vali Acc: 0.968 Test Loss: 0.107 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.958799123764038
Epoch: 12, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.079 Vali Acc: 0.979 Test Loss: 0.079 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.756652593612671
Epoch: 13, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.980501 --> -0.983286).  Saving model ...
Epoch: 14 cost time: 4.1573731899261475
Epoch: 14, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.069 Vali Acc: 0.984 Test Loss: 0.069 Test Acc: 0.984
Validation loss decreased (-0.983286 --> -0.983983).  Saving model ...
Epoch: 15 cost time: 3.6887500286102295
Epoch: 15, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.068 Vali Acc: 0.985 Test Loss: 0.068 Test Acc: 0.985
Validation loss decreased (-0.983983 --> -0.984679).  Saving model ...
Epoch: 16 cost time: 4.061597585678101
Epoch: 16, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.066 Vali Acc: 0.982 Test Loss: 0.066 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.96885347366333
Epoch: 17, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.062 Vali Acc: 0.986 Test Loss: 0.062 Test Acc: 0.986
Validation loss decreased (-0.984679 --> -0.986072).  Saving model ...
Epoch: 18 cost time: 3.9689481258392334
Epoch: 18, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.7919437885284424
Epoch: 19, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.088 Vali Acc: 0.979 Test Loss: 0.088 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.9553098678588867
Epoch: 20, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.060 Vali Acc: 0.987 Test Loss: 0.060 Test Acc: 0.987
Validation loss decreased (-0.986072 --> -0.986768).  Saving model ...
Epoch: 21 cost time: 3.6429648399353027
Epoch: 21, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.067 Vali Acc: 0.985 Test Loss: 0.067 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.084789276123047
Epoch: 22, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.068 Vali Acc: 0.985 Test Loss: 0.068 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 4.125997304916382
Epoch: 23, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.067 Vali Acc: 0.987 Test Loss: 0.067 Test Acc: 0.987
Validation loss decreased (-0.986768 --> -0.987465).  Saving model ...
Epoch: 24 cost time: 3.9354238510131836
Epoch: 24, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.073 Vali Acc: 0.982 Test Loss: 0.073 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.892751455307007
Epoch: 25, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.060 Vali Acc: 0.987 Test Loss: 0.060 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.9259841442108154
Epoch: 26, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.064 Vali Acc: 0.983 Test Loss: 0.064 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.8916070461273193
Epoch: 27, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.062 Vali Acc: 0.989 Test Loss: 0.062 Test Acc: 0.989
Validation loss decreased (-0.987465 --> -0.988857).  Saving model ...
Epoch: 28 cost time: 3.777204751968384
Epoch: 28, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.100 Vali Acc: 0.981 Test Loss: 0.100 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 4.057427167892456
Epoch: 29, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.079 Vali Acc: 0.981 Test Loss: 0.079 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.6906421184539795
Epoch: 30, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.121 Vali Acc: 0.964 Test Loss: 0.121 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 3.4019546508789062
Epoch: 31, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 4.069867134094238
Epoch: 32, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.071 Vali Acc: 0.982 Test Loss: 0.071 Test Acc: 0.982
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 3.8731343746185303
Epoch: 33, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 4.006529092788696
Epoch: 34, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.071 Vali Acc: 0.985 Test Loss: 0.071 Test Acc: 0.985
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 3.985431671142578
Epoch: 35, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.060 Vali Acc: 0.985 Test Loss: 0.060 Test Acc: 0.985
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 3.6905224323272705
Epoch: 36, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.069 Vali Acc: 0.987 Test Loss: 0.069 Test Acc: 0.987
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 3.8190393447875977
Epoch: 37, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.062 Vali Acc: 0.987 Test Loss: 0.062 Test Acc: 0.987
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64_nb1-1_lk13-13_sk5-5_ffr1_ps46_str23_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9888579387186629
model parameter : 61300
model size : 0.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.446465253829956
Epoch: 1, Steps: 89 | Train Loss: 1.144 Vali Loss: 0.337 Vali Acc: 0.909 Test Loss: 0.337 Test Acc: 0.909
Validation loss decreased (inf --> -0.909467).  Saving model ...
Epoch: 2 cost time: 6.563755989074707
Epoch: 2, Steps: 89 | Train Loss: 0.233 Vali Loss: 0.271 Vali Acc: 0.938 Test Loss: 0.271 Test Acc: 0.938
Validation loss decreased (-0.909467 --> -0.938020).  Saving model ...
Epoch: 3 cost time: 8.027724027633667
Epoch: 3, Steps: 89 | Train Loss: 0.170 Vali Loss: 0.228 Vali Acc: 0.959 Test Loss: 0.228 Test Acc: 0.959
Validation loss decreased (-0.938020 --> -0.958911).  Saving model ...
Epoch: 4 cost time: 7.447983741760254
Epoch: 4, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.204 Vali Acc: 0.960 Test Loss: 0.204 Test Acc: 0.960
Validation loss decreased (-0.958911 --> -0.959608).  Saving model ...
Epoch: 5 cost time: 7.673596143722534
Epoch: 5, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.381 Vali Acc: 0.941 Test Loss: 0.381 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 7.659360408782959
Epoch: 6, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.190 Vali Acc: 0.974 Test Loss: 0.190 Test Acc: 0.974
Validation loss decreased (-0.959608 --> -0.973536).  Saving model ...
Epoch: 7 cost time: 8.379766941070557
Epoch: 7, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.185 Vali Acc: 0.975 Test Loss: 0.185 Test Acc: 0.975
Validation loss decreased (-0.973536 --> -0.974929).  Saving model ...
Epoch: 8 cost time: 8.443284749984741
Epoch: 8, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.400 Vali Acc: 0.943 Test Loss: 0.400 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 7.89645791053772
Epoch: 9, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.257 Vali Acc: 0.966 Test Loss: 0.257 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 7.647172927856445
Epoch: 10, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.265 Vali Acc: 0.969 Test Loss: 0.265 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 7.778533458709717
Epoch: 11, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.312 Vali Acc: 0.962 Test Loss: 0.312 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 7.936831712722778
Epoch: 12, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.313 Vali Acc: 0.958 Test Loss: 0.313 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 8.216081857681274
Epoch: 13, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.280 Vali Acc: 0.972 Test Loss: 0.280 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 6.519020318984985
Epoch: 14, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.371 Vali Acc: 0.962 Test Loss: 0.371 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 6.01438570022583
Epoch: 15, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.309 Vali Acc: 0.971 Test Loss: 0.309 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 7.972500324249268
Epoch: 16, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.258 Vali Acc: 0.978 Test Loss: 0.258 Test Acc: 0.978
Validation loss decreased (-0.974929 --> -0.977713).  Saving model ...
Epoch: 17 cost time: 8.237749099731445
Epoch: 17, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.689 Vali Acc: 0.949 Test Loss: 0.689 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 7.623959064483643
Epoch: 18, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.454 Vali Acc: 0.969 Test Loss: 0.454 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 7.441848516464233
Epoch: 19, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.630 Vali Acc: 0.955 Test Loss: 0.630 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 8.046255826950073
Epoch: 20, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.542 Vali Acc: 0.944 Test Loss: 0.542 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 7.430314540863037
Epoch: 21, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.376 Vali Acc: 0.967 Test Loss: 0.376 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 8.310150861740112
Epoch: 22, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.431 Vali Acc: 0.966 Test Loss: 0.431 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 7.49596095085144
Epoch: 23, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.342 Vali Acc: 0.974 Test Loss: 0.342 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 7.6552910804748535
Epoch: 24, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.286 Vali Acc: 0.979 Test Loss: 0.286 Test Acc: 0.979
Validation loss decreased (-0.977713 --> -0.979106).  Saving model ...
Epoch: 25 cost time: 6.954826354980469
Epoch: 25, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.537 Vali Acc: 0.969 Test Loss: 0.537 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 8.737192630767822
Epoch: 26, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.520 Vali Acc: 0.967 Test Loss: 0.520 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 8.651962041854858
Epoch: 27, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.603 Vali Acc: 0.960 Test Loss: 0.603 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 5.786958932876587
Epoch: 28, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.475 Vali Acc: 0.975 Test Loss: 0.475 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 8.29761266708374
Epoch: 29, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.565 Vali Acc: 0.969 Test Loss: 0.565 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 7.754867792129517
Epoch: 30, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.649 Vali Acc: 0.969 Test Loss: 0.649 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 8.209568500518799
Epoch: 31, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.510 Vali Acc: 0.979 Test Loss: 0.510 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 7.492859363555908
Epoch: 32, Steps: 89 | Train Loss: 0.279 Vali Loss: 0.592 Vali Acc: 0.967 Test Loss: 0.592 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 8.202955961227417
Epoch: 33, Steps: 89 | Train Loss: 0.134 Vali Loss: 0.621 Vali Acc: 0.970 Test Loss: 0.621 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 8.540686130523682
Epoch: 34, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.621 Vali Acc: 0.974 Test Loss: 0.621 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.979108635097493
model parameter : 1052436
model size : 4.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.863369464874268
Epoch: 1, Steps: 89 | Train Loss: 1.348 Vali Loss: 0.339 Vali Acc: 0.909 Test Loss: 0.339 Test Acc: 0.909
Validation loss decreased (inf --> -0.908771).  Saving model ...
Epoch: 2 cost time: 6.027715682983398
Epoch: 2, Steps: 89 | Train Loss: 0.219 Vali Loss: 0.202 Vali Acc: 0.953 Test Loss: 0.202 Test Acc: 0.953
Validation loss decreased (-0.908771 --> -0.953341).  Saving model ...
Epoch: 3 cost time: 6.192354440689087
Epoch: 3, Steps: 89 | Train Loss: 0.137 Vali Loss: 0.153 Vali Acc: 0.965 Test Loss: 0.153 Test Acc: 0.965
Validation loss decreased (-0.953341 --> -0.965180).  Saving model ...
Epoch: 4 cost time: 6.408680438995361
Epoch: 4, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.177 Vali Acc: 0.962 Test Loss: 0.177 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.981694221496582
Epoch: 5, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.115 Vali Acc: 0.974 Test Loss: 0.115 Test Acc: 0.974
Validation loss decreased (-0.965180 --> -0.974233).  Saving model ...
Epoch: 6 cost time: 5.735314130783081
Epoch: 6, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.198 Vali Acc: 0.955 Test Loss: 0.198 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.5409770011901855
Epoch: 7, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.168 Vali Acc: 0.964 Test Loss: 0.168 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.234914064407349
Epoch: 8, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.251 Vali Acc: 0.953 Test Loss: 0.251 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.984375715255737
Epoch: 9, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.191 Vali Acc: 0.969 Test Loss: 0.191 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.835773468017578
Epoch: 10, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.255 Vali Acc: 0.967 Test Loss: 0.255 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 6.401740550994873
Epoch: 11, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.286 Vali Acc: 0.967 Test Loss: 0.286 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 5.2680158615112305
Epoch: 12, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.188 Vali Acc: 0.974 Test Loss: 0.188 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 6.2931928634643555
Epoch: 13, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.233 Vali Acc: 0.970 Test Loss: 0.233 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 5.5059685707092285
Epoch: 14, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.188 Vali Acc: 0.978 Test Loss: 0.188 Test Acc: 0.978
Validation loss decreased (-0.974233 --> -0.977714).  Saving model ...
Epoch: 15 cost time: 5.9793860912323
Epoch: 15, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.235 Vali Acc: 0.978 Test Loss: 0.235 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.908402442932129
Epoch: 16, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.301 Vali Acc: 0.972 Test Loss: 0.301 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.823378562927246
Epoch: 17, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.313 Vali Acc: 0.971 Test Loss: 0.313 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 5.577824592590332
Epoch: 18, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.217 Vali Acc: 0.979 Test Loss: 0.217 Test Acc: 0.979
Validation loss decreased (-0.977714 --> -0.979106).  Saving model ...
Epoch: 19 cost time: 5.944798707962036
Epoch: 19, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.305 Vali Acc: 0.979 Test Loss: 0.305 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 6.06580662727356
Epoch: 20, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.269 Vali Acc: 0.977 Test Loss: 0.269 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 5.769719123840332
Epoch: 21, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.229 Vali Acc: 0.981 Test Loss: 0.229 Test Acc: 0.981
Validation loss decreased (-0.979106 --> -0.981195).  Saving model ...
Epoch: 22 cost time: 5.629778146743774
Epoch: 22, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.224 Vali Acc: 0.980 Test Loss: 0.224 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 5.0496156215667725
Epoch: 23, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.474 Vali Acc: 0.962 Test Loss: 0.474 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 5.079326868057251
Epoch: 24, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.313 Vali Acc: 0.976 Test Loss: 0.313 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 5.849996089935303
Epoch: 25, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.350 Vali Acc: 0.974 Test Loss: 0.350 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 5.952438592910767
Epoch: 26, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.345 Vali Acc: 0.977 Test Loss: 0.345 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 5.332932472229004
Epoch: 27, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.623 Vali Acc: 0.957 Test Loss: 0.623 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 5.638992547988892
Epoch: 28, Steps: 89 | Train Loss: 0.150 Vali Loss: 0.434 Vali Acc: 0.967 Test Loss: 0.434 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 5.194856405258179
Epoch: 29, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.452 Vali Acc: 0.962 Test Loss: 0.452 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 5.731538534164429
Epoch: 30, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.341 Vali Acc: 0.978 Test Loss: 0.341 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 4.759125709533691
Epoch: 31, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.324 Vali Acc: 0.977 Test Loss: 0.324 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9811977715877437
model parameter : 868756
model size : 3.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps14_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.521460056304932
Epoch: 1, Steps: 89 | Train Loss: 1.485 Vali Loss: 0.381 Vali Acc: 0.902 Test Loss: 0.381 Test Acc: 0.902
Validation loss decreased (inf --> -0.901807).  Saving model ...
Epoch: 2 cost time: 6.2118847370147705
Epoch: 2, Steps: 89 | Train Loss: 0.251 Vali Loss: 0.188 Vali Acc: 0.951 Test Loss: 0.188 Test Acc: 0.951
Validation loss decreased (-0.901807 --> -0.950555).  Saving model ...
Epoch: 3 cost time: 6.065459966659546
Epoch: 3, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.202 Vali Acc: 0.953 Test Loss: 0.202 Test Acc: 0.953
Validation loss decreased (-0.950555 --> -0.952644).  Saving model ...
Epoch: 4 cost time: 6.147864818572998
Epoch: 4, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.177 Vali Acc: 0.951 Test Loss: 0.177 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.723422050476074
Epoch: 5, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.129 Vali Acc: 0.969 Test Loss: 0.129 Test Acc: 0.969
Validation loss decreased (-0.952644 --> -0.968662).  Saving model ...
Epoch: 6 cost time: 5.374183654785156
Epoch: 6, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.108 Vali Acc: 0.979 Test Loss: 0.108 Test Acc: 0.979
Validation loss decreased (-0.968662 --> -0.979108).  Saving model ...
Epoch: 7 cost time: 6.083218812942505
Epoch: 7, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.255 Vali Acc: 0.944 Test Loss: 0.255 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.172856092453003
Epoch: 8, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.178 Vali Acc: 0.969 Test Loss: 0.178 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.538239240646362
Epoch: 9, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.145 Vali Acc: 0.976 Test Loss: 0.145 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.199475526809692
Epoch: 10, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.129 Vali Acc: 0.979 Test Loss: 0.129 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.801981449127197
Epoch: 11, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.297 Vali Acc: 0.961 Test Loss: 0.297 Test Acc: 0.961
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 5.813104867935181
Epoch: 12, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.180 Vali Acc: 0.970 Test Loss: 0.180 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 5.702808141708374
Epoch: 13, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.139 Vali Acc: 0.978 Test Loss: 0.139 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 5.147730827331543
Epoch: 14, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.153 Vali Acc: 0.975 Test Loss: 0.153 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 5.229094982147217
Epoch: 15, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.136 Vali Acc: 0.983 Test Loss: 0.136 Test Acc: 0.983
Validation loss decreased (-0.979108 --> -0.983286).  Saving model ...
Epoch: 16 cost time: 4.065206050872803
Epoch: 16, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.615 Vali Acc: 0.939 Test Loss: 0.615 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.556109666824341
Epoch: 17, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.203 Vali Acc: 0.981 Test Loss: 0.203 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.947917938232422
Epoch: 18, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.218 Vali Acc: 0.969 Test Loss: 0.218 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 5.813267469406128
Epoch: 19, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.164 Vali Acc: 0.978 Test Loss: 0.164 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 5.237896203994751
Epoch: 20, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.272 Vali Acc: 0.967 Test Loss: 0.272 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 5.741779327392578
Epoch: 21, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.267 Vali Acc: 0.971 Test Loss: 0.267 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 5.519910097122192
Epoch: 22, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.278 Vali Acc: 0.978 Test Loss: 0.278 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 5.611644744873047
Epoch: 23, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.206 Vali Acc: 0.981 Test Loss: 0.206 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 5.36618447303772
Epoch: 24, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.241 Vali Acc: 0.979 Test Loss: 0.241 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 5.595712184906006
Epoch: 25, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.243 Vali Acc: 0.977 Test Loss: 0.243 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps14_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9832869080779945
model parameter : 792468
model size : 3.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps19_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.244539022445679
Epoch: 1, Steps: 89 | Train Loss: 1.635 Vali Loss: 0.460 Vali Acc: 0.880 Test Loss: 0.460 Test Acc: 0.880
Validation loss decreased (inf --> -0.880218).  Saving model ...
Epoch: 2 cost time: 5.577324151992798
Epoch: 2, Steps: 89 | Train Loss: 0.281 Vali Loss: 0.194 Vali Acc: 0.955 Test Loss: 0.194 Test Acc: 0.955
Validation loss decreased (-0.880218 --> -0.954733).  Saving model ...
Epoch: 3 cost time: 4.9060680866241455
Epoch: 3, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.163 Vali Acc: 0.954 Test Loss: 0.163 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.707433223724365
Epoch: 4, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.092 Vali Acc: 0.978 Test Loss: 0.092 Test Acc: 0.978
Validation loss decreased (-0.954733 --> -0.978411).  Saving model ...
Epoch: 5 cost time: 5.814297437667847
Epoch: 5, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.107 Vali Acc: 0.976 Test Loss: 0.107 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.460870027542114
Epoch: 6, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.076 Vali Acc: 0.981 Test Loss: 0.076 Test Acc: 0.981
Validation loss decreased (-0.978411 --> -0.981197).  Saving model ...
Epoch: 7 cost time: 5.029533386230469
Epoch: 7, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.101 Vali Acc: 0.976 Test Loss: 0.101 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.909436225891113
Epoch: 8, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.150 Vali Acc: 0.972 Test Loss: 0.150 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.525301456451416
Epoch: 9, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.179 Vali Acc: 0.953 Test Loss: 0.179 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.7107627391815186
Epoch: 10, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.165 Vali Acc: 0.972 Test Loss: 0.165 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.613900899887085
Epoch: 11, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.215 Vali Acc: 0.969 Test Loss: 0.215 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 5.087033033370972
Epoch: 12, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.146 Vali Acc: 0.978 Test Loss: 0.146 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 5.5299670696258545
Epoch: 13, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.294 Vali Acc: 0.959 Test Loss: 0.294 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.74459981918335
Epoch: 14, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.122 Vali Acc: 0.978 Test Loss: 0.122 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 5.585382699966431
Epoch: 15, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.135 Vali Acc: 0.977 Test Loss: 0.135 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 5.107090950012207
Epoch: 16, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.222 Vali Acc: 0.970 Test Loss: 0.222 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps19_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9811977715877437
model parameter : 731668
model size : 2.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps28_str14_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.327898979187012
Epoch: 1, Steps: 89 | Train Loss: 1.759 Vali Loss: 0.542 Vali Acc: 0.863 Test Loss: 0.542 Test Acc: 0.863
Validation loss decreased (inf --> -0.862808).  Saving model ...
Epoch: 2 cost time: 5.170058488845825
Epoch: 2, Steps: 89 | Train Loss: 0.325 Vali Loss: 0.194 Vali Acc: 0.956 Test Loss: 0.194 Test Acc: 0.956
Validation loss decreased (-0.862808 --> -0.956126).  Saving model ...
Epoch: 3 cost time: 5.294229507446289
Epoch: 3, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.133 Vali Acc: 0.964 Test Loss: 0.133 Test Acc: 0.964
Validation loss decreased (-0.956126 --> -0.963787).  Saving model ...
Epoch: 4 cost time: 5.252181768417358
Epoch: 4, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.119 Vali Acc: 0.970 Test Loss: 0.119 Test Acc: 0.970
Validation loss decreased (-0.963787 --> -0.970055).  Saving model ...
Epoch: 5 cost time: 5.311596870422363
Epoch: 5, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.083 Vali Acc: 0.976 Test Loss: 0.083 Test Acc: 0.976
Validation loss decreased (-0.970055 --> -0.976322).  Saving model ...
Epoch: 6 cost time: 4.8664796352386475
Epoch: 6, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.072 Vali Acc: 0.985 Test Loss: 0.072 Test Acc: 0.985
Validation loss decreased (-0.976322 --> -0.984679).  Saving model ...
Epoch: 7 cost time: 4.740407228469849
Epoch: 7, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.105 Vali Acc: 0.976 Test Loss: 0.105 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.006737470626831
Epoch: 8, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.111 Vali Acc: 0.969 Test Loss: 0.111 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.029797554016113
Epoch: 9, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.089 Vali Acc: 0.981 Test Loss: 0.089 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.960635662078857
Epoch: 10, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.124 Vali Acc: 0.970 Test Loss: 0.124 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.361358404159546
Epoch: 11, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.199 Vali Acc: 0.953 Test Loss: 0.199 Test Acc: 0.953
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 5.009557485580444
Epoch: 12, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.112 Vali Acc: 0.982 Test Loss: 0.112 Test Acc: 0.982
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.7245378494262695
Epoch: 13, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.123 Vali Acc: 0.981 Test Loss: 0.123 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.595149755477905
Epoch: 14, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.131 Vali Acc: 0.982 Test Loss: 0.131 Test Acc: 0.982
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 5.270552396774292
Epoch: 15, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.094 Vali Acc: 0.984 Test Loss: 0.094 Test Acc: 0.984
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 4.625918865203857
Epoch: 16, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.088 Vali Acc: 0.987 Test Loss: 0.088 Test Acc: 0.987
Validation loss decreased (-0.984679 --> -0.986768).  Saving model ...
Epoch: 17 cost time: 5.220922946929932
Epoch: 17, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.988 Test Loss: 0.085 Test Acc: 0.988
Validation loss decreased (-0.986768 --> -0.988161).  Saving model ...
Epoch: 18 cost time: 4.976347923278809
Epoch: 18, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.086 Vali Acc: 0.989 Test Loss: 0.086 Test Acc: 0.989
Validation loss decreased (-0.988161 --> -0.988857).  Saving model ...
Epoch: 19 cost time: 4.4696996212005615
Epoch: 19, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.988 Test Loss: 0.088 Test Acc: 0.988
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 5.322102069854736
Epoch: 20, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.989 Test Loss: 0.091 Test Acc: 0.989
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 4.93019700050354
Epoch: 21, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.988 Test Loss: 0.088 Test Acc: 0.988
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 4.502436399459839
Epoch: 22, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.279 Vali Acc: 0.962 Test Loss: 0.279 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 5.334655523300171
Epoch: 23, Steps: 89 | Train Loss: 0.246 Vali Loss: 0.337 Vali Acc: 0.947 Test Loss: 0.337 Test Acc: 0.947
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 5.307466745376587
Epoch: 24, Steps: 89 | Train Loss: 0.237 Vali Loss: 0.168 Vali Acc: 0.974 Test Loss: 0.168 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 5.255883455276489
Epoch: 25, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.153 Vali Acc: 0.978 Test Loss: 0.153 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 5.272030353546143
Epoch: 26, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.210 Vali Acc: 0.981 Test Loss: 0.210 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 5.212411880493164
Epoch: 27, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.187 Vali Acc: 0.978 Test Loss: 0.187 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 6.0377256870269775
Epoch: 28, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.114 Vali Acc: 0.987 Test Loss: 0.114 Test Acc: 0.987
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps28_str14_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9888579387186629
model parameter : 702100
model size : 2.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps37_str19_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.71583104133606
Epoch: 1, Steps: 89 | Train Loss: 1.897 Vali Loss: 0.687 Vali Acc: 0.850 Test Loss: 0.687 Test Acc: 0.850
Validation loss decreased (inf --> -0.849575).  Saving model ...
Epoch: 2 cost time: 5.632187128067017
Epoch: 2, Steps: 89 | Train Loss: 0.397 Vali Loss: 0.243 Vali Acc: 0.944 Test Loss: 0.243 Test Acc: 0.944
Validation loss decreased (-0.849575 --> -0.944287).  Saving model ...
Epoch: 3 cost time: 6.110162258148193
Epoch: 3, Steps: 89 | Train Loss: 0.158 Vali Loss: 0.131 Vali Acc: 0.974 Test Loss: 0.131 Test Acc: 0.974
Validation loss decreased (-0.944287 --> -0.974233).  Saving model ...
Epoch: 4 cost time: 6.189863681793213
Epoch: 4, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.121 Vali Acc: 0.971 Test Loss: 0.121 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.441884994506836
Epoch: 5, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.090 Vali Acc: 0.980 Test Loss: 0.090 Test Acc: 0.980
Validation loss decreased (-0.974233 --> -0.979804).  Saving model ...
Epoch: 6 cost time: 6.765502452850342
Epoch: 6, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
Validation loss decreased (-0.979804 --> -0.983286).  Saving model ...
Epoch: 7 cost time: 7.066600799560547
Epoch: 7, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.148 Vali Acc: 0.964 Test Loss: 0.148 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.956340312957764
Epoch: 8, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.8474462032318115
Epoch: 9, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.074 Vali Acc: 0.981 Test Loss: 0.074 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.817570447921753
Epoch: 10, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.159 Vali Acc: 0.971 Test Loss: 0.159 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 6.499680280685425
Epoch: 11, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.188 Vali Acc: 0.946 Test Loss: 0.188 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 6.432010889053345
Epoch: 12, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.128 Vali Acc: 0.973 Test Loss: 0.128 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 6.388095140457153
Epoch: 13, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.090 Vali Acc: 0.981 Test Loss: 0.090 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 5.705161094665527
Epoch: 14, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.985 Test Loss: 0.076 Test Acc: 0.985
Validation loss decreased (-0.983286 --> -0.984679).  Saving model ...
Epoch: 15 cost time: 7.091290235519409
Epoch: 15, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.073 Vali Acc: 0.985 Test Loss: 0.073 Test Acc: 0.985
Validation loss decreased (-0.984679 --> -0.985375).  Saving model ...
Epoch: 16 cost time: 6.25618577003479
Epoch: 16, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.87225341796875
Epoch: 17, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 6.407366037368774
Epoch: 18, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.142 Vali Acc: 0.980 Test Loss: 0.142 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 6.439594984054565
Epoch: 19, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.146 Vali Acc: 0.973 Test Loss: 0.146 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 7.050419569015503
Epoch: 20, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.168 Vali Acc: 0.970 Test Loss: 0.168 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 6.871288537979126
Epoch: 21, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.164 Vali Acc: 0.976 Test Loss: 0.164 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 6.956741809844971
Epoch: 22, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.154 Vali Acc: 0.971 Test Loss: 0.154 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 6.117019414901733
Epoch: 23, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.169 Vali Acc: 0.976 Test Loss: 0.169 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 5.601677656173706
Epoch: 24, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.164 Vali Acc: 0.976 Test Loss: 0.164 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 6.580350637435913
Epoch: 25, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.226 Vali Acc: 0.967 Test Loss: 0.226 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps37_str19_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9853760445682451
model parameter : 672532
model size : 2.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps46_str23_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.6237123012542725
Epoch: 1, Steps: 89 | Train Loss: 2.008 Vali Loss: 0.794 Vali Acc: 0.822 Test Loss: 0.794 Test Acc: 0.822
Validation loss decreased (inf --> -0.821719).  Saving model ...
Epoch: 2 cost time: 6.220649480819702
Epoch: 2, Steps: 89 | Train Loss: 0.443 Vali Loss: 0.261 Vali Acc: 0.925 Test Loss: 0.261 Test Acc: 0.925
Validation loss decreased (-0.821719 --> -0.925485).  Saving model ...
Epoch: 3 cost time: 4.916077613830566
Epoch: 3, Steps: 89 | Train Loss: 0.169 Vali Loss: 0.135 Vali Acc: 0.971 Test Loss: 0.135 Test Acc: 0.971
Validation loss decreased (-0.925485 --> -0.970751).  Saving model ...
Epoch: 4 cost time: 6.592881917953491
Epoch: 4, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.116 Vali Acc: 0.974 Test Loss: 0.116 Test Acc: 0.974
Validation loss decreased (-0.970751 --> -0.974233).  Saving model ...
Epoch: 5 cost time: 6.534375429153442
Epoch: 5, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.076 Vali Acc: 0.985 Test Loss: 0.076 Test Acc: 0.985
Validation loss decreased (-0.974233 --> -0.984679).  Saving model ...
Epoch: 6 cost time: 6.06179404258728
Epoch: 6, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.071 Vali Acc: 0.981 Test Loss: 0.071 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.919568061828613
Epoch: 7, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.078 Vali Acc: 0.979 Test Loss: 0.078 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.994882106781006
Epoch: 8, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.067 Vali Acc: 0.981 Test Loss: 0.067 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 6.549635648727417
Epoch: 9, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.086 Vali Acc: 0.981 Test Loss: 0.086 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 6.184812784194946
Epoch: 10, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.058 Vali Acc: 0.985 Test Loss: 0.058 Test Acc: 0.985
Validation loss decreased (-0.984679 --> -0.985375).  Saving model ...
Epoch: 11 cost time: 5.921854019165039
Epoch: 11, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.059 Vali Acc: 0.985 Test Loss: 0.059 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.6952996253967285
Epoch: 12, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.123 Vali Acc: 0.969 Test Loss: 0.123 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.6935343742370605
Epoch: 13, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.080 Vali Acc: 0.981 Test Loss: 0.080 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.146418333053589
Epoch: 14, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.135 Vali Acc: 0.972 Test Loss: 0.135 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 6.535452842712402
Epoch: 15, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.153 Vali Acc: 0.965 Test Loss: 0.153 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 6.738823890686035
Epoch: 16, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.158 Vali Acc: 0.967 Test Loss: 0.158 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 6.835025072097778
Epoch: 17, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.072 Vali Acc: 0.985 Test Loss: 0.072 Test Acc: 0.985
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 6.2558019161224365
Epoch: 18, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.092 Vali Acc: 0.982 Test Loss: 0.092 Test Acc: 0.982
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 6.736989259719849
Epoch: 19, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.090 Vali Acc: 0.981 Test Loss: 0.090 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 6.709526777267456
Epoch: 20, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.163 Vali Acc: 0.969 Test Loss: 0.163 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128-256_nb1-1_lk9-9_sk5-5_ffr1_ps46_str23_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9853760445682451
model parameter : 658324
model size : 2.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.4529502391815186
Epoch: 1, Steps: 89 | Train Loss: 1.435 Vali Loss: 0.400 Vali Acc: 0.882 Test Loss: 0.400 Test Acc: 0.882
Validation loss decreased (inf --> -0.881612).  Saving model ...
Epoch: 2 cost time: 5.295323133468628
Epoch: 2, Steps: 89 | Train Loss: 0.230 Vali Loss: 0.205 Vali Acc: 0.950 Test Loss: 0.205 Test Acc: 0.950
Validation loss decreased (-0.881612 --> -0.949859).  Saving model ...
Epoch: 3 cost time: 5.392148733139038
Epoch: 3, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.180 Vali Acc: 0.958 Test Loss: 0.180 Test Acc: 0.958
Validation loss decreased (-0.949859 --> -0.958215).  Saving model ...
Epoch: 4 cost time: 4.941375494003296
Epoch: 4, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.163 Vali Acc: 0.966 Test Loss: 0.163 Test Acc: 0.966
Validation loss decreased (-0.958215 --> -0.965876).  Saving model ...
Epoch: 5 cost time: 5.252729654312134
Epoch: 5, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.161 Vali Acc: 0.968 Test Loss: 0.161 Test Acc: 0.968
Validation loss decreased (-0.965876 --> -0.967965).  Saving model ...
Epoch: 6 cost time: 4.976830244064331
Epoch: 6, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.142 Vali Acc: 0.976 Test Loss: 0.142 Test Acc: 0.976
Validation loss decreased (-0.967965 --> -0.976322).  Saving model ...
Epoch: 7 cost time: 5.4757161140441895
Epoch: 7, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.240 Vali Acc: 0.964 Test Loss: 0.240 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.934946775436401
Epoch: 8, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.151 Vali Acc: 0.976 Test Loss: 0.151 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.355640649795532
Epoch: 9, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.164 Vali Acc: 0.971 Test Loss: 0.164 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.048380613327026
Epoch: 10, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.121 Vali Acc: 0.978 Test Loss: 0.121 Test Acc: 0.978
Validation loss decreased (-0.976322 --> -0.977715).  Saving model ...
Epoch: 11 cost time: 5.080507278442383
Epoch: 11, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.272 Vali Acc: 0.963 Test Loss: 0.272 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.1311256885528564
Epoch: 12, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.215 Vali Acc: 0.977 Test Loss: 0.215 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.32717752456665
Epoch: 13, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.229 Vali Acc: 0.974 Test Loss: 0.229 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.186680316925049
Epoch: 14, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.232 Vali Acc: 0.972 Test Loss: 0.232 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 5.113072633743286
Epoch: 15, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.194 Vali Acc: 0.977 Test Loss: 0.194 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 5.0999755859375
Epoch: 16, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.312 Vali Acc: 0.960 Test Loss: 0.312 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.968631267547607
Epoch: 17, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.417 Vali Acc: 0.953 Test Loss: 0.417 Test Acc: 0.953
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 5.1556620597839355
Epoch: 18, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.200 Vali Acc: 0.978 Test Loss: 0.200 Test Acc: 0.978
Validation loss decreased (-0.977715 --> -0.978410).  Saving model ...
Epoch: 19 cost time: 5.045937776565552
Epoch: 19, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.320 Vali Acc: 0.964 Test Loss: 0.320 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.772375822067261
Epoch: 20, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.290 Vali Acc: 0.970 Test Loss: 0.290 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 4.718377113342285
Epoch: 21, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.424 Vali Acc: 0.957 Test Loss: 0.424 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 4.904238939285278
Epoch: 22, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.246 Vali Acc: 0.978 Test Loss: 0.246 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 4.9755847454071045
Epoch: 23, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.279 Vali Acc: 0.976 Test Loss: 0.279 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 4.894313097000122
Epoch: 24, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.299 Vali Acc: 0.976 Test Loss: 0.299 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 4.774351358413696
Epoch: 25, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.312 Vali Acc: 0.974 Test Loss: 0.312 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 3.6439526081085205
Epoch: 26, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.326 Vali Acc: 0.974 Test Loss: 0.326 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 5.077221870422363
Epoch: 27, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.367 Vali Acc: 0.972 Test Loss: 0.367 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 4.428439140319824
Epoch: 28, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.305 Vali Acc: 0.973 Test Loss: 0.305 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9784122562674095
model parameter : 386964
model size : 1.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.09998345375061
Epoch: 1, Steps: 89 | Train Loss: 1.738 Vali Loss: 0.566 Vali Acc: 0.846 Test Loss: 0.566 Test Acc: 0.846
Validation loss decreased (inf --> -0.846095).  Saving model ...
Epoch: 2 cost time: 4.4700493812561035
Epoch: 2, Steps: 89 | Train Loss: 0.325 Vali Loss: 0.209 Vali Acc: 0.941 Test Loss: 0.209 Test Acc: 0.941
Validation loss decreased (-0.846095 --> -0.940806).  Saving model ...
Epoch: 3 cost time: 4.694734811782837
Epoch: 3, Steps: 89 | Train Loss: 0.134 Vali Loss: 0.129 Vali Acc: 0.963 Test Loss: 0.129 Test Acc: 0.963
Validation loss decreased (-0.940806 --> -0.963091).  Saving model ...
Epoch: 4 cost time: 4.055543422698975
Epoch: 4, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.181 Vali Acc: 0.948 Test Loss: 0.181 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.57965874671936
Epoch: 5, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.126 Vali Acc: 0.964 Test Loss: 0.126 Test Acc: 0.964
Validation loss decreased (-0.963091 --> -0.964483).  Saving model ...
Epoch: 6 cost time: 4.413271188735962
Epoch: 6, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.106 Vali Acc: 0.979 Test Loss: 0.106 Test Acc: 0.979
Validation loss decreased (-0.964483 --> -0.979108).  Saving model ...
Epoch: 7 cost time: 4.734980821609497
Epoch: 7, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.155 Vali Acc: 0.956 Test Loss: 0.155 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.689843654632568
Epoch: 8, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.135 Vali Acc: 0.971 Test Loss: 0.135 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.882411479949951
Epoch: 9, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.132 Vali Acc: 0.975 Test Loss: 0.132 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.649247407913208
Epoch: 10, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.158 Vali Acc: 0.977 Test Loss: 0.158 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.608325958251953
Epoch: 11, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.130 Vali Acc: 0.980 Test Loss: 0.130 Test Acc: 0.980
Validation loss decreased (-0.979108 --> -0.979804).  Saving model ...
Epoch: 12 cost time: 4.810550212860107
Epoch: 12, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.135 Vali Acc: 0.981 Test Loss: 0.135 Test Acc: 0.981
Validation loss decreased (-0.979804 --> -0.980500).  Saving model ...
Epoch: 13 cost time: 4.575345754623413
Epoch: 13, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.145 Vali Acc: 0.976 Test Loss: 0.145 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.926298379898071
Epoch: 14, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.150 Vali Acc: 0.976 Test Loss: 0.150 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.628058433532715
Epoch: 15, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.973 Test Loss: 0.182 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.5833740234375
Epoch: 16, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.134 Vali Acc: 0.981 Test Loss: 0.134 Test Acc: 0.981
Validation loss decreased (-0.980500 --> -0.981196).  Saving model ...
Epoch: 17 cost time: 4.377025604248047
Epoch: 17, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.187 Vali Acc: 0.979 Test Loss: 0.187 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.395683526992798
Epoch: 18, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.244 Vali Acc: 0.959 Test Loss: 0.244 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.735092401504517
Epoch: 19, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.140 Vali Acc: 0.982 Test Loss: 0.140 Test Acc: 0.982
Validation loss decreased (-0.981196 --> -0.981893).  Saving model ...
Epoch: 20 cost time: 4.4651572704315186
Epoch: 20, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.327 Vali Acc: 0.939 Test Loss: 0.327 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.166960716247559
Epoch: 21, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.150 Vali Acc: 0.984 Test Loss: 0.150 Test Acc: 0.984
Validation loss decreased (-0.981893 --> -0.983982).  Saving model ...
Epoch: 22 cost time: 4.4485838413238525
Epoch: 22, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.175 Vali Acc: 0.978 Test Loss: 0.175 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 4.627586126327515
Epoch: 23, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.269 Vali Acc: 0.970 Test Loss: 0.269 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 4.5804173946380615
Epoch: 24, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.148 Vali Acc: 0.982 Test Loss: 0.148 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 4.584993600845337
Epoch: 25, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.406 Vali Acc: 0.942 Test Loss: 0.406 Test Acc: 0.942
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 4.569528341293335
Epoch: 26, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.133 Vali Acc: 0.983 Test Loss: 0.133 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.8396379947662354
Epoch: 27, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.242 Vali Acc: 0.963 Test Loss: 0.242 Test Acc: 0.963
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 4.037241697311401
Epoch: 28, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.243 Vali Acc: 0.979 Test Loss: 0.243 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 3.8377745151519775
Epoch: 29, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.175 Vali Acc: 0.981 Test Loss: 0.175 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 4.427506446838379
Epoch: 30, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.185 Vali Acc: 0.979 Test Loss: 0.185 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 4.324605464935303
Epoch: 31, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.242 Vali Acc: 0.979 Test Loss: 0.242 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.983983286908078
model parameter : 295124
model size : 1.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps14_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.776863098144531
Epoch: 1, Steps: 89 | Train Loss: 1.904 Vali Loss: 0.640 Vali Acc: 0.866 Test Loss: 0.640 Test Acc: 0.866
Validation loss decreased (inf --> -0.865592).  Saving model ...
Epoch: 2 cost time: 3.6856489181518555
Epoch: 2, Steps: 89 | Train Loss: 0.379 Vali Loss: 0.242 Vali Acc: 0.929 Test Loss: 0.242 Test Acc: 0.929
Validation loss decreased (-0.865592 --> -0.928967).  Saving model ...
Epoch: 3 cost time: 4.067183494567871
Epoch: 3, Steps: 89 | Train Loss: 0.154 Vali Loss: 0.147 Vali Acc: 0.963 Test Loss: 0.147 Test Acc: 0.963
Validation loss decreased (-0.928967 --> -0.963090).  Saving model ...
Epoch: 4 cost time: 4.775491714477539
Epoch: 4, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.119 Vali Acc: 0.968 Test Loss: 0.119 Test Acc: 0.968
Validation loss decreased (-0.963090 --> -0.967965).  Saving model ...
Epoch: 5 cost time: 4.125873327255249
Epoch: 5, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.122 Vali Acc: 0.974 Test Loss: 0.122 Test Acc: 0.974
Validation loss decreased (-0.967965 --> -0.974233).  Saving model ...
Epoch: 6 cost time: 4.762915849685669
Epoch: 6, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.114 Vali Acc: 0.972 Test Loss: 0.114 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.993173122406006
Epoch: 7, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.076 Vali Acc: 0.985 Test Loss: 0.076 Test Acc: 0.985
Validation loss decreased (-0.974233 --> -0.984679).  Saving model ...
Epoch: 8 cost time: 4.401921987533569
Epoch: 8, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.098 Vali Acc: 0.975 Test Loss: 0.098 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.5299882888793945
Epoch: 9, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.110 Vali Acc: 0.976 Test Loss: 0.110 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.739308595657349
Epoch: 10, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.119 Vali Acc: 0.975 Test Loss: 0.119 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.896765232086182
Epoch: 11, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.129 Vali Acc: 0.978 Test Loss: 0.129 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.197993278503418
Epoch: 12, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.166 Vali Acc: 0.971 Test Loss: 0.166 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 5.089630126953125
Epoch: 13, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.180 Vali Acc: 0.967 Test Loss: 0.180 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.697107553482056
Epoch: 14, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.134 Vali Acc: 0.975 Test Loss: 0.134 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 5.098636150360107
Epoch: 15, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.142 Vali Acc: 0.978 Test Loss: 0.142 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 4.728506326675415
Epoch: 16, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.145 Vali Acc: 0.975 Test Loss: 0.145 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.9067580699920654
Epoch: 17, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.133 Vali Acc: 0.976 Test Loss: 0.133 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps14_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9846796657381616
model parameter : 256980
model size : 1.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps19_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.55045223236084
Epoch: 1, Steps: 89 | Train Loss: 2.062 Vali Loss: 0.828 Vali Acc: 0.786 Test Loss: 0.828 Test Acc: 0.786
Validation loss decreased (inf --> -0.785507).  Saving model ...
Epoch: 2 cost time: 4.200631380081177
Epoch: 2, Steps: 89 | Train Loss: 0.459 Vali Loss: 0.263 Vali Acc: 0.939 Test Loss: 0.263 Test Acc: 0.939
Validation loss decreased (-0.785507 --> -0.938716).  Saving model ...
Epoch: 3 cost time: 4.217494249343872
Epoch: 3, Steps: 89 | Train Loss: 0.181 Vali Loss: 0.159 Vali Acc: 0.962 Test Loss: 0.159 Test Acc: 0.962
Validation loss decreased (-0.938716 --> -0.961698).  Saving model ...
Epoch: 4 cost time: 4.419512033462524
Epoch: 4, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.119 Vali Acc: 0.967 Test Loss: 0.119 Test Acc: 0.967
Validation loss decreased (-0.961698 --> -0.967269).  Saving model ...
Epoch: 5 cost time: 4.748492479324341
Epoch: 5, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.107 Vali Acc: 0.974 Test Loss: 0.107 Test Acc: 0.974
Validation loss decreased (-0.967269 --> -0.974233).  Saving model ...
Epoch: 6 cost time: 4.581127405166626
Epoch: 6, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.097 Vali Acc: 0.978 Test Loss: 0.097 Test Acc: 0.978
Validation loss decreased (-0.974233 --> -0.977715).  Saving model ...
Epoch: 7 cost time: 4.724529266357422
Epoch: 7, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.080 Vali Acc: 0.979 Test Loss: 0.080 Test Acc: 0.979
Validation loss decreased (-0.977715 --> -0.979108).  Saving model ...
Epoch: 8 cost time: 3.764860153198242
Epoch: 8, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.093 Vali Acc: 0.975 Test Loss: 0.093 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.337524890899658
Epoch: 9, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.090 Vali Acc: 0.978 Test Loss: 0.090 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.652363538742065
Epoch: 10, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.099 Vali Acc: 0.978 Test Loss: 0.099 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.5909507274627686
Epoch: 11, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.979108 --> -0.982590).  Saving model ...
Epoch: 12 cost time: 3.849452495574951
Epoch: 12, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.079 Vali Acc: 0.984 Test Loss: 0.079 Test Acc: 0.984
Validation loss decreased (-0.982590 --> -0.983982).  Saving model ...
Epoch: 13 cost time: 3.462966203689575
Epoch: 13, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.095 Vali Acc: 0.979 Test Loss: 0.095 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.040173530578613
Epoch: 14, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.135 Vali Acc: 0.976 Test Loss: 0.135 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.579646348953247
Epoch: 15, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.172 Vali Acc: 0.960 Test Loss: 0.172 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.569003582000732
Epoch: 16, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.167 Vali Acc: 0.958 Test Loss: 0.167 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.6230406761169434
Epoch: 17, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.099 Vali Acc: 0.981 Test Loss: 0.099 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.669991731643677
Epoch: 18, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.108 Vali Acc: 0.979 Test Loss: 0.108 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.5305492877960205
Epoch: 19, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.109 Vali Acc: 0.981 Test Loss: 0.109 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.9541563987731934
Epoch: 20, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.189 Vali Acc: 0.973 Test Loss: 0.189 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 4.4735071659088135
Epoch: 21, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.162 Vali Acc: 0.979 Test Loss: 0.162 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.5071983337402344
Epoch: 22, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.139 Vali Acc: 0.981 Test Loss: 0.139 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps19_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.983983286908078
model parameter : 226580
model size : 0.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps28_str14_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.724653720855713
Epoch: 1, Steps: 89 | Train Loss: 2.210 Vali Loss: 1.072 Vali Acc: 0.788 Test Loss: 1.072 Test Acc: 0.788
Validation loss decreased (inf --> -0.787594).  Saving model ...
Epoch: 2 cost time: 3.934823513031006
Epoch: 2, Steps: 89 | Train Loss: 0.574 Vali Loss: 0.350 Vali Acc: 0.901 Test Loss: 0.350 Test Acc: 0.901
Validation loss decreased (-0.787594 --> -0.901111).  Saving model ...
Epoch: 3 cost time: 4.006822347640991
Epoch: 3, Steps: 89 | Train Loss: 0.209 Vali Loss: 0.161 Vali Acc: 0.967 Test Loss: 0.161 Test Acc: 0.967
Validation loss decreased (-0.901111 --> -0.967269).  Saving model ...
Epoch: 4 cost time: 3.6330318450927734
Epoch: 4, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.118 Vali Acc: 0.976 Test Loss: 0.118 Test Acc: 0.976
Validation loss decreased (-0.967269 --> -0.976322).  Saving model ...
Epoch: 5 cost time: 4.071428537368774
Epoch: 5, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.102 Vali Acc: 0.975 Test Loss: 0.102 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.009973764419556
Epoch: 6, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.080 Vali Acc: 0.981 Test Loss: 0.080 Test Acc: 0.981
Validation loss decreased (-0.976322 --> -0.980501).  Saving model ...
Epoch: 7 cost time: 4.032526731491089
Epoch: 7, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.083 Vali Acc: 0.978 Test Loss: 0.083 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.171309471130371
Epoch: 8, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.071 Vali Acc: 0.981 Test Loss: 0.071 Test Acc: 0.981
Validation loss decreased (-0.980501 --> -0.981197).  Saving model ...
Epoch: 9 cost time: 3.879625082015991
Epoch: 9, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.089 Vali Acc: 0.976 Test Loss: 0.089 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.439061403274536
Epoch: 10, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.067 Vali Acc: 0.982 Test Loss: 0.067 Test Acc: 0.982
Validation loss decreased (-0.981197 --> -0.981893).  Saving model ...
Epoch: 11 cost time: 4.2581048011779785
Epoch: 11, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.080 Vali Acc: 0.978 Test Loss: 0.080 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.086093187332153
Epoch: 12, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.072 Vali Acc: 0.981 Test Loss: 0.072 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.7926056385040283
Epoch: 13, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.065 Vali Acc: 0.982 Test Loss: 0.065 Test Acc: 0.982
Validation loss decreased (-0.981893 --> -0.981893).  Saving model ...
Epoch: 14 cost time: 4.361553192138672
Epoch: 14, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.084 Vali Acc: 0.981 Test Loss: 0.084 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.415818691253662
Epoch: 15, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.065 Vali Acc: 0.985 Test Loss: 0.065 Test Acc: 0.985
Validation loss decreased (-0.981893 --> -0.984679).  Saving model ...
Epoch: 16 cost time: 3.182802200317383
Epoch: 16, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.061 Vali Acc: 0.986 Test Loss: 0.061 Test Acc: 0.986
Validation loss decreased (-0.984679 --> -0.986072).  Saving model ...
Epoch: 17 cost time: 3.392247438430786
Epoch: 17, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.115 Vali Acc: 0.972 Test Loss: 0.115 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.401989459991455
Epoch: 18, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.102 Vali Acc: 0.976 Test Loss: 0.102 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.309440851211548
Epoch: 19, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.076 Vali Acc: 0.981 Test Loss: 0.076 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 4.149332046508789
Epoch: 20, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.086 Vali Acc: 0.982 Test Loss: 0.086 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 4.104103088378906
Epoch: 21, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.114 Vali Acc: 0.981 Test Loss: 0.114 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 4.059952020645142
Epoch: 22, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.154 Vali Acc: 0.969 Test Loss: 0.154 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 4.881266355514526
Epoch: 23, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.121 Vali Acc: 0.978 Test Loss: 0.121 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 4.750074625015259
Epoch: 24, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.163 Vali Acc: 0.978 Test Loss: 0.163 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 4.676904201507568
Epoch: 25, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.128 Vali Acc: 0.978 Test Loss: 0.128 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 4.426634788513184
Epoch: 26, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.097 Vali Acc: 0.981 Test Loss: 0.097 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps28_str14_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9860724233983287
model parameter : 211796
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps37_str19_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.864227294921875
Epoch: 1, Steps: 89 | Train Loss: 2.431 Vali Loss: 1.351 Vali Acc: 0.792 Test Loss: 1.351 Test Acc: 0.792
Validation loss decreased (inf --> -0.792466).  Saving model ...
Epoch: 2 cost time: 4.113248825073242
Epoch: 2, Steps: 89 | Train Loss: 0.748 Vali Loss: 0.399 Vali Acc: 0.900 Test Loss: 0.399 Test Acc: 0.900
Validation loss decreased (-0.792466 --> -0.900414).  Saving model ...
Epoch: 3 cost time: 4.044739484786987
Epoch: 3, Steps: 89 | Train Loss: 0.275 Vali Loss: 0.192 Vali Acc: 0.961 Test Loss: 0.192 Test Acc: 0.961
Validation loss decreased (-0.900414 --> -0.961001).  Saving model ...
Epoch: 4 cost time: 4.612239122390747
Epoch: 4, Steps: 89 | Train Loss: 0.149 Vali Loss: 0.136 Vali Acc: 0.971 Test Loss: 0.136 Test Acc: 0.971
Validation loss decreased (-0.961001 --> -0.971447).  Saving model ...
Epoch: 5 cost time: 4.668424606323242
Epoch: 5, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.126 Vali Acc: 0.967 Test Loss: 0.126 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.670770168304443
Epoch: 6, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.090 Vali Acc: 0.978 Test Loss: 0.090 Test Acc: 0.978
Validation loss decreased (-0.971447 --> -0.977715).  Saving model ...
Epoch: 7 cost time: 4.005330801010132
Epoch: 7, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.081 Vali Acc: 0.982 Test Loss: 0.081 Test Acc: 0.982
Validation loss decreased (-0.977715 --> -0.981893).  Saving model ...
Epoch: 8 cost time: 4.268312454223633
Epoch: 8, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.094 Vali Acc: 0.976 Test Loss: 0.094 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.435244560241699
Epoch: 9, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.077 Vali Acc: 0.981 Test Loss: 0.077 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.859217643737793
Epoch: 10, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.094 Vali Acc: 0.978 Test Loss: 0.094 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.725931406021118
Epoch: 11, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.064 Vali Acc: 0.985 Test Loss: 0.064 Test Acc: 0.985
Validation loss decreased (-0.981893 --> -0.984679).  Saving model ...
Epoch: 12 cost time: 4.101937770843506
Epoch: 12, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.067 Vali Acc: 0.987 Test Loss: 0.067 Test Acc: 0.987
Validation loss decreased (-0.984679 --> -0.987465).  Saving model ...
Epoch: 13 cost time: 4.291263580322266
Epoch: 13, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.066 Vali Acc: 0.984 Test Loss: 0.066 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.647987604141235
Epoch: 14, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.070 Vali Acc: 0.985 Test Loss: 0.070 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.5025875568389893
Epoch: 15, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.071 Vali Acc: 0.985 Test Loss: 0.071 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.6674280166625977
Epoch: 16, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.379371404647827
Epoch: 17, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.087 Vali Acc: 0.977 Test Loss: 0.087 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.45119833946228
Epoch: 18, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.062 Vali Acc: 0.986 Test Loss: 0.062 Test Acc: 0.986
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.431433200836182
Epoch: 19, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.066 Vali Acc: 0.985 Test Loss: 0.066 Test Acc: 0.985
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.994128704071045
Epoch: 20, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.096 Vali Acc: 0.983 Test Loss: 0.096 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 4.491741418838501
Epoch: 21, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.100 Vali Acc: 0.978 Test Loss: 0.100 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 4.0372583866119385
Epoch: 22, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps37_str19_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9874651810584958
model parameter : 197012
model size : 0.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps46_str23_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.31330943107605
Epoch: 1, Steps: 89 | Train Loss: 2.543 Vali Loss: 1.623 Vali Acc: 0.714 Test Loss: 1.623 Test Acc: 0.714
Validation loss decreased (inf --> -0.713772).  Saving model ...
Epoch: 2 cost time: 4.347694396972656
Epoch: 2, Steps: 89 | Train Loss: 0.899 Vali Loss: 0.487 Vali Acc: 0.890 Test Loss: 0.487 Test Acc: 0.890
Validation loss decreased (-0.713772 --> -0.889967).  Saving model ...
Epoch: 3 cost time: 4.3674280643463135
Epoch: 3, Steps: 89 | Train Loss: 0.322 Vali Loss: 0.254 Vali Acc: 0.938 Test Loss: 0.254 Test Acc: 0.938
Validation loss decreased (-0.889967 --> -0.938020).  Saving model ...
Epoch: 4 cost time: 3.6139252185821533
Epoch: 4, Steps: 89 | Train Loss: 0.169 Vali Loss: 0.150 Vali Acc: 0.967 Test Loss: 0.150 Test Acc: 0.967
Validation loss decreased (-0.938020 --> -0.966572).  Saving model ...
Epoch: 5 cost time: 3.667877197265625
Epoch: 5, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.122 Vali Acc: 0.968 Test Loss: 0.122 Test Acc: 0.968
Validation loss decreased (-0.966572 --> -0.967965).  Saving model ...
Epoch: 6 cost time: 4.316118955612183
Epoch: 6, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.088 Vali Acc: 0.978 Test Loss: 0.088 Test Acc: 0.978
Validation loss decreased (-0.967965 --> -0.977715).  Saving model ...
Epoch: 7 cost time: 4.603255271911621
Epoch: 7, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.488984823226929
Epoch: 8, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.078 Vali Acc: 0.978 Test Loss: 0.078 Test Acc: 0.978
Validation loss decreased (-0.977715 --> -0.977715).  Saving model ...
Epoch: 9 cost time: 4.074083089828491
Epoch: 9, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
Validation loss decreased (-0.977715 --> -0.982590).  Saving model ...
Epoch: 10 cost time: 4.32394003868103
Epoch: 10, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.100 Vali Acc: 0.971 Test Loss: 0.100 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.583108425140381
Epoch: 11, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.523859977722168
Epoch: 12, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.064 Vali Acc: 0.985 Test Loss: 0.064 Test Acc: 0.985
Validation loss decreased (-0.982590 --> -0.984679).  Saving model ...
Epoch: 13 cost time: 4.477853059768677
Epoch: 13, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.069 Vali Acc: 0.981 Test Loss: 0.069 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.344090461730957
Epoch: 14, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.057 Vali Acc: 0.985 Test Loss: 0.057 Test Acc: 0.985
Validation loss decreased (-0.984679 --> -0.985375).  Saving model ...
Epoch: 15 cost time: 4.212934970855713
Epoch: 15, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.693103313446045
Epoch: 16, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.082 Vali Acc: 0.982 Test Loss: 0.082 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.085859537124634
Epoch: 17, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.067 Vali Acc: 0.987 Test Loss: 0.067 Test Acc: 0.987
Validation loss decreased (-0.985375 --> -0.986768).  Saving model ...
Epoch: 18 cost time: 5.0430686473846436
Epoch: 18, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.055 Vali Acc: 0.986 Test Loss: 0.055 Test Acc: 0.986
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.121602535247803
Epoch: 19, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.065 Vali Acc: 0.987 Test Loss: 0.065 Test Acc: 0.987
Validation loss decreased (-0.986768 --> -0.987465).  Saving model ...
Epoch: 20 cost time: 3.420348882675171
Epoch: 20, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.054 Vali Acc: 0.989 Test Loss: 0.054 Test Acc: 0.989
Validation loss decreased (-0.987465 --> -0.988857).  Saving model ...
Epoch: 21 cost time: 4.47476601600647
Epoch: 21, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.069 Vali Acc: 0.982 Test Loss: 0.069 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.896630525588989
Epoch: 22, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.060 Vali Acc: 0.986 Test Loss: 0.060 Test Acc: 0.986
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 4.4254841804504395
Epoch: 23, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.085 Vali Acc: 0.982 Test Loss: 0.085 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.502964496612549
Epoch: 24, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.104 Vali Acc: 0.982 Test Loss: 0.104 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 4.5963218212127686
Epoch: 25, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.066 Vali Acc: 0.986 Test Loss: 0.066 Test Acc: 0.986
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 4.792076826095581
Epoch: 26, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.091 Vali Acc: 0.982 Test Loss: 0.091 Test Acc: 0.982
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 4.825584888458252
Epoch: 27, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.099 Vali Acc: 0.978 Test Loss: 0.099 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 4.372492074966431
Epoch: 28, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 3.928422689437866
Epoch: 29, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.078 Vali Acc: 0.985 Test Loss: 0.078 Test Acc: 0.985
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 4.730368137359619
Epoch: 30, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.094 Vali Acc: 0.985 Test Loss: 0.094 Test Acc: 0.985
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64-128_nb1-1_lk9-9_sk5-5_ffr1_ps46_str23_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9888579387186629
model parameter : 189908
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.09544563293457
Epoch: 1, Steps: 89 | Train Loss: 1.829 Vali Loss: 0.605 Vali Acc: 0.842 Test Loss: 0.605 Test Acc: 0.842
Validation loss decreased (inf --> -0.841916).  Saving model ...
Epoch: 2 cost time: 3.7865872383117676
Epoch: 2, Steps: 89 | Train Loss: 0.346 Vali Loss: 0.234 Vali Acc: 0.945 Test Loss: 0.234 Test Acc: 0.945
Validation loss decreased (-0.841916 --> -0.944984).  Saving model ...
Epoch: 3 cost time: 3.301363706588745
Epoch: 3, Steps: 89 | Train Loss: 0.148 Vali Loss: 0.161 Vali Acc: 0.955 Test Loss: 0.161 Test Acc: 0.955
Validation loss decreased (-0.944984 --> -0.955430).  Saving model ...
Epoch: 4 cost time: 3.6485424041748047
Epoch: 4, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.130 Vali Acc: 0.968 Test Loss: 0.130 Test Acc: 0.968
Validation loss decreased (-0.955430 --> -0.967965).  Saving model ...
Epoch: 5 cost time: 3.5574445724487305
Epoch: 5, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.110 Vali Acc: 0.967 Test Loss: 0.110 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.9339706897735596
Epoch: 6, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.180 Vali Acc: 0.954 Test Loss: 0.180 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.614250659942627
Epoch: 7, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.115 Vali Acc: 0.976 Test Loss: 0.115 Test Acc: 0.976
Validation loss decreased (-0.967965 --> -0.976322).  Saving model ...
Epoch: 8 cost time: 3.669185161590576
Epoch: 8, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.976322 --> -0.979804).  Saving model ...
Epoch: 9 cost time: 3.619619846343994
Epoch: 9, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.9381625652313232
Epoch: 10, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.156 Vali Acc: 0.968 Test Loss: 0.156 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.4975359439849854
Epoch: 11, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.159 Vali Acc: 0.973 Test Loss: 0.159 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.941848039627075
Epoch: 12, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.176 Vali Acc: 0.967 Test Loss: 0.176 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.600484609603882
Epoch: 13, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.222 Vali Acc: 0.968 Test Loss: 0.222 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.2800822257995605
Epoch: 14, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.157 Vali Acc: 0.974 Test Loss: 0.157 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.6185784339904785
Epoch: 15, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.250 Vali Acc: 0.964 Test Loss: 0.250 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.9164974689483643
Epoch: 16, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.245 Vali Acc: 0.974 Test Loss: 0.245 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.514655828475952
Epoch: 17, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.168 Vali Acc: 0.978 Test Loss: 0.168 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.3003554344177246
Epoch: 18, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.187 Vali Acc: 0.977 Test Loss: 0.187 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9798050139275766
model parameter : 158676
model size : 0.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.2276551723480225
Epoch: 1, Steps: 89 | Train Loss: 2.264 Vali Loss: 1.030 Vali Acc: 0.777 Test Loss: 1.030 Test Acc: 0.777
Validation loss decreased (inf --> -0.777148).  Saving model ...
Epoch: 2 cost time: 3.73862624168396
Epoch: 2, Steps: 89 | Train Loss: 0.536 Vali Loss: 0.309 Vali Acc: 0.921 Test Loss: 0.309 Test Acc: 0.921
Validation loss decreased (-0.777148 --> -0.920610).  Saving model ...
Epoch: 3 cost time: 3.716580867767334
Epoch: 3, Steps: 89 | Train Loss: 0.205 Vali Loss: 0.189 Vali Acc: 0.951 Test Loss: 0.189 Test Acc: 0.951
Validation loss decreased (-0.920610 --> -0.951252).  Saving model ...
Epoch: 4 cost time: 3.939561605453491
Epoch: 4, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.124 Vali Acc: 0.969 Test Loss: 0.124 Test Acc: 0.969
Validation loss decreased (-0.951252 --> -0.969358).  Saving model ...
Epoch: 5 cost time: 3.5237574577331543
Epoch: 5, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.120 Vali Acc: 0.969 Test Loss: 0.120 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.922718048095703
Epoch: 6, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.108 Vali Acc: 0.969 Test Loss: 0.108 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.670868158340454
Epoch: 7, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
Validation loss decreased (-0.969358 --> -0.972840).  Saving model ...
Epoch: 8 cost time: 3.4548099040985107
Epoch: 8, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.118 Vali Acc: 0.978 Test Loss: 0.118 Test Acc: 0.978
Validation loss decreased (-0.972840 --> -0.977715).  Saving model ...
Epoch: 9 cost time: 3.4126811027526855
Epoch: 9, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.108 Vali Acc: 0.975 Test Loss: 0.108 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.666407823562622
Epoch: 10, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.094 Vali Acc: 0.981 Test Loss: 0.094 Test Acc: 0.981
Validation loss decreased (-0.977715 --> -0.981197).  Saving model ...
Epoch: 11 cost time: 3.278545618057251
Epoch: 11, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.105 Vali Acc: 0.976 Test Loss: 0.105 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.560702323913574
Epoch: 12, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.101 Vali Acc: 0.978 Test Loss: 0.101 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.855790853500366
Epoch: 13, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.7234561443328857
Epoch: 14, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.106 Vali Acc: 0.983 Test Loss: 0.106 Test Acc: 0.983
Validation loss decreased (-0.981197 --> -0.983286).  Saving model ...
Epoch: 15 cost time: 3.693740129470825
Epoch: 15, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.100 Vali Acc: 0.980 Test Loss: 0.100 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.744213819503784
Epoch: 16, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.123 Vali Acc: 0.978 Test Loss: 0.123 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.974404811859131
Epoch: 17, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.115 Vali Acc: 0.981 Test Loss: 0.115 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.8894832134246826
Epoch: 18, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.121 Vali Acc: 0.978 Test Loss: 0.121 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.532193899154663
Epoch: 19, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.122 Vali Acc: 0.974 Test Loss: 0.122 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.7519290447235107
Epoch: 20, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.169 Vali Acc: 0.969 Test Loss: 0.169 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.6800694465637207
Epoch: 21, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.124 Vali Acc: 0.984 Test Loss: 0.124 Test Acc: 0.984
Validation loss decreased (-0.983286 --> -0.983982).  Saving model ...
Epoch: 22 cost time: 3.1805920600891113
Epoch: 22, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.135 Vali Acc: 0.981 Test Loss: 0.135 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.6369807720184326
Epoch: 23, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.174 Vali Acc: 0.975 Test Loss: 0.174 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.7428793907165527
Epoch: 24, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.159 Vali Acc: 0.980 Test Loss: 0.159 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.73992657661438
Epoch: 25, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.145 Vali Acc: 0.982 Test Loss: 0.145 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.5470244884490967
Epoch: 26, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.135 Vali Acc: 0.981 Test Loss: 0.135 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.1708812713623047
Epoch: 27, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.123 Vali Acc: 0.982 Test Loss: 0.123 Test Acc: 0.982
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 3.251826524734497
Epoch: 28, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.102 Vali Acc: 0.984 Test Loss: 0.102 Test Acc: 0.984
Validation loss decreased (-0.983982 --> -0.983982).  Saving model ...
Epoch: 29 cost time: 3.974996328353882
Epoch: 29, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.093 Vali Acc: 0.984 Test Loss: 0.093 Test Acc: 0.984
Validation loss decreased (-0.983982 --> -0.983982).  Saving model ...
Epoch: 30 cost time: 3.133057117462158
Epoch: 30, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.105 Vali Acc: 0.987 Test Loss: 0.105 Test Acc: 0.987
Validation loss decreased (-0.983982 --> -0.987464).  Saving model ...
Epoch: 31 cost time: 4.113367319107056
Epoch: 31, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.987 Test Loss: 0.112 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.9317245483398438
Epoch: 32, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.151 Vali Acc: 0.980 Test Loss: 0.151 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.809645175933838
Epoch: 33, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.114 Vali Acc: 0.985 Test Loss: 0.114 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 3.728407859802246
Epoch: 34, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.123 Vali Acc: 0.985 Test Loss: 0.123 Test Acc: 0.985
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 4.055743217468262
Epoch: 35, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.131 Vali Acc: 0.978 Test Loss: 0.131 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 3.9434003829956055
Epoch: 36, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.204 Vali Acc: 0.972 Test Loss: 0.204 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 3.6335339546203613
Epoch: 37, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.136 Vali Acc: 0.983 Test Loss: 0.136 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 3.0939419269561768
Epoch: 38, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.155 Vali Acc: 0.981 Test Loss: 0.155 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 3.412536859512329
Epoch: 39, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.254 Vali Acc: 0.965 Test Loss: 0.254 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 2.9834177494049072
Epoch: 40, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.144 Vali Acc: 0.982 Test Loss: 0.144 Test Acc: 0.982
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9874651810584958
model parameter : 112756
model size : 0.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps14_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.156477451324463
Epoch: 1, Steps: 89 | Train Loss: 2.333 Vali Loss: 1.246 Vali Acc: 0.783 Test Loss: 1.246 Test Acc: 0.783
Validation loss decreased (inf --> -0.782717).  Saving model ...
Epoch: 2 cost time: 3.420776605606079
Epoch: 2, Steps: 89 | Train Loss: 0.646 Vali Loss: 0.402 Vali Acc: 0.895 Test Loss: 0.402 Test Acc: 0.895
Validation loss decreased (-0.782717 --> -0.894843).  Saving model ...
Epoch: 3 cost time: 3.7438032627105713
Epoch: 3, Steps: 89 | Train Loss: 0.256 Vali Loss: 0.193 Vali Acc: 0.955 Test Loss: 0.193 Test Acc: 0.955
Validation loss decreased (-0.894843 --> -0.954733).  Saving model ...
Epoch: 4 cost time: 3.721497058868408
Epoch: 4, Steps: 89 | Train Loss: 0.131 Vali Loss: 0.143 Vali Acc: 0.968 Test Loss: 0.143 Test Acc: 0.968
Validation loss decreased (-0.954733 --> -0.967965).  Saving model ...
Epoch: 5 cost time: 4.188677787780762
Epoch: 5, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.117 Vali Acc: 0.971 Test Loss: 0.117 Test Acc: 0.971
Validation loss decreased (-0.967965 --> -0.970751).  Saving model ...
Epoch: 6 cost time: 3.6411406993865967
Epoch: 6, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.094 Vali Acc: 0.975 Test Loss: 0.094 Test Acc: 0.975
Validation loss decreased (-0.970751 --> -0.974929).  Saving model ...
Epoch: 7 cost time: 3.648123264312744
Epoch: 7, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.091 Vali Acc: 0.978 Test Loss: 0.091 Test Acc: 0.978
Validation loss decreased (-0.974929 --> -0.977715).  Saving model ...
Epoch: 8 cost time: 3.234912157058716
Epoch: 8, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.715290069580078
Epoch: 9, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.977715 --> -0.979804).  Saving model ...
Epoch: 10 cost time: 3.9569334983825684
Epoch: 10, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.075 Vali Acc: 0.984 Test Loss: 0.075 Test Acc: 0.984
Validation loss decreased (-0.979804 --> -0.983983).  Saving model ...
Epoch: 11 cost time: 4.012411594390869
Epoch: 11, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.071 Vali Acc: 0.985 Test Loss: 0.071 Test Acc: 0.985
Validation loss decreased (-0.983983 --> -0.984679).  Saving model ...
Epoch: 12 cost time: 3.6976771354675293
Epoch: 12, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.081 Vali Acc: 0.981 Test Loss: 0.081 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.3986051082611084
Epoch: 13, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.4265193939208984
Epoch: 14, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.083 Vali Acc: 0.984 Test Loss: 0.083 Test Acc: 0.984
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.993776798248291
Epoch: 15, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.118 Vali Acc: 0.978 Test Loss: 0.118 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.7248036861419678
Epoch: 16, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.496918201446533
Epoch: 17, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.088 Vali Acc: 0.981 Test Loss: 0.088 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.7652029991149902
Epoch: 18, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.084 Vali Acc: 0.987 Test Loss: 0.084 Test Acc: 0.987
Validation loss decreased (-0.984679 --> -0.986768).  Saving model ...
Epoch: 19 cost time: 3.268514394760132
Epoch: 19, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.089 Vali Acc: 0.981 Test Loss: 0.089 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.7729997634887695
Epoch: 20, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.093 Vali Acc: 0.983 Test Loss: 0.093 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.4411704540252686
Epoch: 21, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.078 Vali Acc: 0.985 Test Loss: 0.078 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.430802345275879
Epoch: 22, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.106 Vali Acc: 0.976 Test Loss: 0.106 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.6926732063293457
Epoch: 23, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.185 Vali Acc: 0.976 Test Loss: 0.185 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.1412763595581055
Epoch: 24, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.101 Vali Acc: 0.982 Test Loss: 0.101 Test Acc: 0.982
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.819129705429077
Epoch: 25, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.120 Vali Acc: 0.976 Test Loss: 0.120 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 3.786299705505371
Epoch: 26, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.155 Vali Acc: 0.970 Test Loss: 0.155 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 4.041109561920166
Epoch: 27, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.119 Vali Acc: 0.983 Test Loss: 0.119 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 4.009075164794922
Epoch: 28, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.214 Vali Acc: 0.964 Test Loss: 0.214 Test Acc: 0.964
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps14_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9867688022284122
model parameter : 93684
model size : 0.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps19_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.018290281295776
Epoch: 1, Steps: 89 | Train Loss: 2.547 Vali Loss: 1.737 Vali Acc: 0.684 Test Loss: 1.737 Test Acc: 0.684
Validation loss decreased (inf --> -0.683827).  Saving model ...
Epoch: 2 cost time: 3.681670665740967
Epoch: 2, Steps: 89 | Train Loss: 0.966 Vali Loss: 0.513 Vali Acc: 0.867 Test Loss: 0.513 Test Acc: 0.867
Validation loss decreased (-0.683827 --> -0.866987).  Saving model ...
Epoch: 3 cost time: 3.2687337398529053
Epoch: 3, Steps: 89 | Train Loss: 0.363 Vali Loss: 0.271 Vali Acc: 0.937 Test Loss: 0.271 Test Acc: 0.937
Validation loss decreased (-0.866987 --> -0.936627).  Saving model ...
Epoch: 4 cost time: 3.811708927154541
Epoch: 4, Steps: 89 | Train Loss: 0.190 Vali Loss: 0.181 Vali Acc: 0.953 Test Loss: 0.181 Test Acc: 0.953
Validation loss decreased (-0.936627 --> -0.953341).  Saving model ...
Epoch: 5 cost time: 3.2937371730804443
Epoch: 5, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.130 Vali Acc: 0.966 Test Loss: 0.130 Test Acc: 0.966
Validation loss decreased (-0.953341 --> -0.965876).  Saving model ...
Epoch: 6 cost time: 3.7222952842712402
Epoch: 6, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.093 Vali Acc: 0.978 Test Loss: 0.093 Test Acc: 0.978
Validation loss decreased (-0.965876 --> -0.977715).  Saving model ...
Epoch: 7 cost time: 3.8105621337890625
Epoch: 7, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.081 Vali Acc: 0.978 Test Loss: 0.081 Test Acc: 0.978
Validation loss decreased (-0.977715 --> -0.977715).  Saving model ...
Epoch: 8 cost time: 3.616804599761963
Epoch: 8, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.65055775642395
Epoch: 9, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.074 Vali Acc: 0.981 Test Loss: 0.074 Test Acc: 0.981
Validation loss decreased (-0.977715 --> -0.980501).  Saving model ...
Epoch: 10 cost time: 3.423278570175171
Epoch: 10, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
Validation loss decreased (-0.980501 --> -0.983286).  Saving model ...
Epoch: 11 cost time: 2.926525592803955
Epoch: 11, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.6602303981781006
Epoch: 12, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.061 Vali Acc: 0.982 Test Loss: 0.061 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.134720087051392
Epoch: 13, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.059 Vali Acc: 0.983 Test Loss: 0.059 Test Acc: 0.983
Validation loss decreased (-0.983286 --> -0.983286).  Saving model ...
Epoch: 14 cost time: 4.244176864624023
Epoch: 14, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.065 Vali Acc: 0.984 Test Loss: 0.065 Test Acc: 0.984
Validation loss decreased (-0.983286 --> -0.983983).  Saving model ...
Epoch: 15 cost time: 4.055594205856323
Epoch: 15, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.944044351577759
Epoch: 16, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.061 Vali Acc: 0.985 Test Loss: 0.061 Test Acc: 0.985
Validation loss decreased (-0.983983 --> -0.985375).  Saving model ...
Epoch: 17 cost time: 3.844905138015747
Epoch: 17, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.078 Vali Acc: 0.976 Test Loss: 0.078 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.9965322017669678
Epoch: 18, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.072 Vali Acc: 0.982 Test Loss: 0.072 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.134343862533569
Epoch: 19, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.081 Vali Acc: 0.977 Test Loss: 0.081 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 4.220257997512817
Epoch: 20, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.083 Vali Acc: 0.979 Test Loss: 0.083 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 4.161420822143555
Epoch: 21, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.071 Vali Acc: 0.985 Test Loss: 0.071 Test Acc: 0.985
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 3.1612071990966797
Epoch: 22, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.125 Vali Acc: 0.971 Test Loss: 0.125 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 4.119868040084839
Epoch: 23, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 3.912228584289551
Epoch: 24, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.086 Vali Acc: 0.981 Test Loss: 0.086 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 3.7935526371002197
Epoch: 25, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.118 Vali Acc: 0.971 Test Loss: 0.118 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 3.9573724269866943
Epoch: 26, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.111 Vali Acc: 0.976 Test Loss: 0.111 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps19_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9853760445682451
model parameter : 78484
model size : 0.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps28_str14_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.116851568222046
Epoch: 1, Steps: 89 | Train Loss: 2.655 Vali Loss: 1.970 Vali Acc: 0.687 Test Loss: 1.970 Test Acc: 0.687
Validation loss decreased (inf --> -0.687306).  Saving model ...
Epoch: 2 cost time: 3.58893084526062
Epoch: 2, Steps: 89 | Train Loss: 1.172 Vali Loss: 0.597 Vali Acc: 0.879 Test Loss: 0.597 Test Acc: 0.879
Validation loss decreased (-0.687306 --> -0.878824).  Saving model ...
Epoch: 3 cost time: 3.731109619140625
Epoch: 3, Steps: 89 | Train Loss: 0.417 Vali Loss: 0.306 Vali Acc: 0.929 Test Loss: 0.306 Test Acc: 0.929
Validation loss decreased (-0.878824 --> -0.928966).  Saving model ...
Epoch: 4 cost time: 4.0101306438446045
Epoch: 4, Steps: 89 | Train Loss: 0.220 Vali Loss: 0.174 Vali Acc: 0.968 Test Loss: 0.174 Test Acc: 0.968
Validation loss decreased (-0.928966 --> -0.967965).  Saving model ...
Epoch: 5 cost time: 4.3812689781188965
Epoch: 5, Steps: 89 | Train Loss: 0.135 Vali Loss: 0.131 Vali Acc: 0.975 Test Loss: 0.131 Test Acc: 0.975
Validation loss decreased (-0.967965 --> -0.974929).  Saving model ...
Epoch: 6 cost time: 4.116092205047607
Epoch: 6, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.104 Vali Acc: 0.979 Test Loss: 0.104 Test Acc: 0.979
Validation loss decreased (-0.974929 --> -0.979108).  Saving model ...
Epoch: 7 cost time: 4.3798887729644775
Epoch: 7, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.346795320510864
Epoch: 8, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.076 Vali Acc: 0.981 Test Loss: 0.076 Test Acc: 0.981
Validation loss decreased (-0.979108 --> -0.981197).  Saving model ...
Epoch: 9 cost time: 4.321283340454102
Epoch: 9, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.080 Vali Acc: 0.979 Test Loss: 0.080 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.3899102210998535
Epoch: 10, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.072 Vali Acc: 0.981 Test Loss: 0.072 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.041470766067505
Epoch: 11, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.067 Vali Acc: 0.985 Test Loss: 0.067 Test Acc: 0.985
Validation loss decreased (-0.981197 --> -0.984679).  Saving model ...
Epoch: 12 cost time: 4.204902410507202
Epoch: 12, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.061 Vali Acc: 0.982 Test Loss: 0.061 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.23132848739624
Epoch: 13, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.066 Vali Acc: 0.985 Test Loss: 0.066 Test Acc: 0.985
Validation loss decreased (-0.984679 --> -0.984679).  Saving model ...
Epoch: 14 cost time: 4.010553359985352
Epoch: 14, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.058 Vali Acc: 0.983 Test Loss: 0.058 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.014992952346802
Epoch: 15, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.067 Vali Acc: 0.980 Test Loss: 0.067 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.687243700027466
Epoch: 16, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.056 Vali Acc: 0.987 Test Loss: 0.056 Test Acc: 0.987
Validation loss decreased (-0.984679 --> -0.986768).  Saving model ...
Epoch: 17 cost time: 4.3709752559661865
Epoch: 17, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.062 Vali Acc: 0.985 Test Loss: 0.062 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.038896083831787
Epoch: 18, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.065 Vali Acc: 0.984 Test Loss: 0.065 Test Acc: 0.984
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.684828042984009
Epoch: 19, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.065 Vali Acc: 0.987 Test Loss: 0.065 Test Acc: 0.987
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 4.349047899246216
Epoch: 20, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.079 Vali Acc: 0.981 Test Loss: 0.079 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 4.121669769287109
Epoch: 21, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.070 Vali Acc: 0.985 Test Loss: 0.070 Test Acc: 0.985
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 4.077143907546997
Epoch: 22, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.056 Vali Acc: 0.984 Test Loss: 0.056 Test Acc: 0.984
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 3.548520565032959
Epoch: 23, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.059 Vali Acc: 0.984 Test Loss: 0.059 Test Acc: 0.984
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 4.00905704498291
Epoch: 24, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.069 Vali Acc: 0.985 Test Loss: 0.069 Test Acc: 0.985
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 3.353947401046753
Epoch: 25, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.075 Vali Acc: 0.984 Test Loss: 0.075 Test Acc: 0.984
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 3.8786282539367676
Epoch: 26, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.077 Vali Acc: 0.981 Test Loss: 0.077 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps28_str14_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9867688022284122
model parameter : 71092
model size : 0.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps37_str19_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.205422401428223
Epoch: 1, Steps: 89 | Train Loss: 2.738 Vali Loss: 2.198 Vali Acc: 0.570 Test Loss: 2.198 Test Acc: 0.570
Validation loss decreased (inf --> -0.569616).  Saving model ...
Epoch: 2 cost time: 4.075605630874634
Epoch: 2, Steps: 89 | Train Loss: 1.450 Vali Loss: 0.841 Vali Acc: 0.834 Test Loss: 0.841 Test Acc: 0.834
Validation loss decreased (-0.569616 --> -0.834253).  Saving model ...
Epoch: 3 cost time: 3.798290729522705
Epoch: 3, Steps: 89 | Train Loss: 0.574 Vali Loss: 0.416 Vali Acc: 0.904 Test Loss: 0.416 Test Acc: 0.904
Validation loss decreased (-0.834253 --> -0.903896).  Saving model ...
Epoch: 4 cost time: 3.9981162548065186
Epoch: 4, Steps: 89 | Train Loss: 0.314 Vali Loss: 0.255 Vali Acc: 0.937 Test Loss: 0.255 Test Acc: 0.937
Validation loss decreased (-0.903896 --> -0.936627).  Saving model ...
Epoch: 5 cost time: 3.928062915802002
Epoch: 5, Steps: 89 | Train Loss: 0.186 Vali Loss: 0.172 Vali Acc: 0.964 Test Loss: 0.172 Test Acc: 0.964
Validation loss decreased (-0.936627 --> -0.963787).  Saving model ...
Epoch: 6 cost time: 4.058519601821899
Epoch: 6, Steps: 89 | Train Loss: 0.127 Vali Loss: 0.142 Vali Acc: 0.970 Test Loss: 0.142 Test Acc: 0.970
Validation loss decreased (-0.963787 --> -0.970054).  Saving model ...
Epoch: 7 cost time: 3.8045732975006104
Epoch: 7, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.120 Vali Acc: 0.973 Test Loss: 0.120 Test Acc: 0.973
Validation loss decreased (-0.970054 --> -0.972840).  Saving model ...
Epoch: 8 cost time: 3.7779266834259033
Epoch: 8, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.099 Vali Acc: 0.978 Test Loss: 0.099 Test Acc: 0.978
Validation loss decreased (-0.972840 --> -0.978411).  Saving model ...
Epoch: 9 cost time: 4.091686725616455
Epoch: 9, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.087 Vali Acc: 0.980 Test Loss: 0.087 Test Acc: 0.980
Validation loss decreased (-0.978411 --> -0.979804).  Saving model ...
Epoch: 10 cost time: 3.8035879135131836
Epoch: 10, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.079 Vali Acc: 0.981 Test Loss: 0.079 Test Acc: 0.981
Validation loss decreased (-0.979804 --> -0.981197).  Saving model ...
Epoch: 11 cost time: 3.7736001014709473
Epoch: 11, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.079 Vali Acc: 0.981 Test Loss: 0.079 Test Acc: 0.981
Validation loss decreased (-0.981197 --> -0.981197).  Saving model ...
Epoch: 12 cost time: 4.14021110534668
Epoch: 12, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
Validation loss decreased (-0.981197 --> -0.982590).  Saving model ...
Epoch: 13 cost time: 4.320295810699463
Epoch: 13, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.069 Vali Acc: 0.984 Test Loss: 0.069 Test Acc: 0.984
Validation loss decreased (-0.982590 --> -0.983983).  Saving model ...
Epoch: 14 cost time: 4.042339563369751
Epoch: 14, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.403505325317383
Epoch: 15, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.067 Vali Acc: 0.981 Test Loss: 0.067 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.6412723064422607
Epoch: 16, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.081 Vali Acc: 0.978 Test Loss: 0.081 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.1874425411224365
Epoch: 17, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.086 Vali Acc: 0.975 Test Loss: 0.086 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 4.153483629226685
Epoch: 18, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.860720634460449
Epoch: 19, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.081 Vali Acc: 0.981 Test Loss: 0.081 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 4.023113965988159
Epoch: 20, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.070 Vali Acc: 0.984 Test Loss: 0.070 Test Acc: 0.984
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.5040459632873535
Epoch: 21, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.070 Vali Acc: 0.984 Test Loss: 0.070 Test Acc: 0.984
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 4.178427696228027
Epoch: 22, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.8532183170318604
Epoch: 23, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps37_str19_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.983983286908078
model parameter : 63700
model size : 0.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps46_str23_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.9967145919799805
Epoch: 1, Steps: 89 | Train Loss: 2.745 Vali Loss: 2.283 Vali Acc: 0.558 Test Loss: 2.283 Test Acc: 0.558
Validation loss decreased (inf --> -0.558473).  Saving model ...
Epoch: 2 cost time: 3.670473337173462
Epoch: 2, Steps: 89 | Train Loss: 1.588 Vali Loss: 0.956 Vali Acc: 0.824 Test Loss: 0.956 Test Acc: 0.824
Validation loss decreased (-0.558473 --> -0.823807).  Saving model ...
Epoch: 3 cost time: 3.564270496368408
Epoch: 3, Steps: 89 | Train Loss: 0.650 Vali Loss: 0.473 Vali Acc: 0.891 Test Loss: 0.473 Test Acc: 0.891
Validation loss decreased (-0.823807 --> -0.890664).  Saving model ...
Epoch: 4 cost time: 4.0616843700408936
Epoch: 4, Steps: 89 | Train Loss: 0.347 Vali Loss: 0.275 Vali Acc: 0.937 Test Loss: 0.275 Test Acc: 0.937
Validation loss decreased (-0.890664 --> -0.937323).  Saving model ...
Epoch: 5 cost time: 4.116493225097656
Epoch: 5, Steps: 89 | Train Loss: 0.211 Vali Loss: 0.189 Vali Acc: 0.955 Test Loss: 0.189 Test Acc: 0.955
Validation loss decreased (-0.937323 --> -0.955430).  Saving model ...
Epoch: 6 cost time: 3.92397141456604
Epoch: 6, Steps: 89 | Train Loss: 0.135 Vali Loss: 0.154 Vali Acc: 0.964 Test Loss: 0.154 Test Acc: 0.964
Validation loss decreased (-0.955430 --> -0.964483).  Saving model ...
Epoch: 7 cost time: 3.6961991786956787
Epoch: 7, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.124 Vali Acc: 0.969 Test Loss: 0.124 Test Acc: 0.969
Validation loss decreased (-0.964483 --> -0.968662).  Saving model ...
Epoch: 8 cost time: 4.056617021560669
Epoch: 8, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.104 Vali Acc: 0.972 Test Loss: 0.104 Test Acc: 0.972
Validation loss decreased (-0.968662 --> -0.972144).  Saving model ...
Epoch: 9 cost time: 3.982651472091675
Epoch: 9, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.093 Vali Acc: 0.981 Test Loss: 0.093 Test Acc: 0.981
Validation loss decreased (-0.972144 --> -0.981197).  Saving model ...
Epoch: 10 cost time: 4.030534744262695
Epoch: 10, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.091 Vali Acc: 0.977 Test Loss: 0.091 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.827772855758667
Epoch: 11, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.094 Vali Acc: 0.978 Test Loss: 0.094 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.6144161224365234
Epoch: 12, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.073 Vali Acc: 0.980 Test Loss: 0.073 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.183935642242432
Epoch: 13, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.073 Vali Acc: 0.981 Test Loss: 0.073 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.870964765548706
Epoch: 14, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.079 Vali Acc: 0.979 Test Loss: 0.079 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.596285343170166
Epoch: 15, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.981197 --> -0.983286).  Saving model ...
Epoch: 16 cost time: 3.9198083877563477
Epoch: 16, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.062 Vali Acc: 0.984 Test Loss: 0.062 Test Acc: 0.984
Validation loss decreased (-0.983286 --> -0.983983).  Saving model ...
Epoch: 17 cost time: 3.249006748199463
Epoch: 17, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.7054333686828613
Epoch: 18, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.074 Vali Acc: 0.985 Test Loss: 0.074 Test Acc: 0.985
Validation loss decreased (-0.983983 --> -0.984679).  Saving model ...
Epoch: 19 cost time: 3.7450194358825684
Epoch: 19, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.084 Vali Acc: 0.982 Test Loss: 0.084 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.0730249881744385
Epoch: 20, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 4.0917017459869385
Epoch: 21, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.6681771278381348
Epoch: 22, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.075 Vali Acc: 0.984 Test Loss: 0.075 Test Acc: 0.984
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.754352331161499
Epoch: 23, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.064 Vali Acc: 0.987 Test Loss: 0.064 Test Acc: 0.987
Validation loss decreased (-0.984679 --> -0.986768).  Saving model ...
Epoch: 24 cost time: 3.970600128173828
Epoch: 24, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.075 Vali Acc: 0.981 Test Loss: 0.075 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 4.229166269302368
Epoch: 25, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.086 Vali Acc: 0.978 Test Loss: 0.086 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.6577484607696533
Epoch: 26, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.107 Vali Acc: 0.971 Test Loss: 0.107 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 4.173904895782471
Epoch: 27, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.067 Vali Acc: 0.987 Test Loss: 0.067 Test Acc: 0.987
Validation loss decreased (-0.986768 --> -0.987465).  Saving model ...
Epoch: 28 cost time: 4.161754131317139
Epoch: 28, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.076 Vali Acc: 0.983 Test Loss: 0.076 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.46968412399292
Epoch: 29, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.061 Vali Acc: 0.987 Test Loss: 0.061 Test Acc: 0.987
Validation loss decreased (-0.987465 --> -0.987465).  Saving model ...
Epoch: 30 cost time: 3.096405506134033
Epoch: 30, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.064 Vali Acc: 0.985 Test Loss: 0.064 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.4777886867523193
Epoch: 31, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.062 Vali Acc: 0.987 Test Loss: 0.062 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.674562454223633
Epoch: 32, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.063 Vali Acc: 0.987 Test Loss: 0.063 Test Acc: 0.987
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 3.8878533840179443
Epoch: 33, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.070 Vali Acc: 0.985 Test Loss: 0.070 Test Acc: 0.985
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 3.9754953384399414
Epoch: 34, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.072 Vali Acc: 0.987 Test Loss: 0.072 Test Acc: 0.987
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 3.763791084289551
Epoch: 35, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.076 Vali Acc: 0.985 Test Loss: 0.076 Test Acc: 0.985
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 3.8846349716186523
Epoch: 36, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.070 Vali Acc: 0.986 Test Loss: 0.070 Test Acc: 0.986
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 3.5553085803985596
Epoch: 37, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.986 Test Loss: 0.074 Test Acc: 0.986
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 4.051191568374634
Epoch: 38, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.987 Test Loss: 0.075 Test Acc: 0.987
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 3.7036218643188477
Epoch: 39, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32-64_nb1-1_lk9-9_sk5-5_ffr1_ps46_str23_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9874651810584958
model parameter : 60148
model size : 0.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 8.22760558128357
Epoch: 1, Steps: 89 | Train Loss: 0.935 Vali Loss: 0.300 Vali Acc: 0.917 Test Loss: 0.300 Test Acc: 0.917
Validation loss decreased (inf --> -0.917128).  Saving model ...
Epoch: 2 cost time: 3.7542946338653564
Epoch: 2, Steps: 89 | Train Loss: 0.341 Vali Loss: 0.265 Vali Acc: 0.939 Test Loss: 0.265 Test Acc: 0.939
Validation loss decreased (-0.917128 --> -0.938716).  Saving model ...
Epoch: 3 cost time: 7.1053900718688965
Epoch: 3, Steps: 89 | Train Loss: 0.185 Vali Loss: 0.457 Vali Acc: 0.930 Test Loss: 0.457 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.2995641231536865
Epoch: 4, Steps: 89 | Train Loss: 0.266 Vali Loss: 0.419 Vali Acc: 0.915 Test Loss: 0.419 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.404393196105957
Epoch: 5, Steps: 89 | Train Loss: 0.128 Vali Loss: 0.276 Vali Acc: 0.964 Test Loss: 0.276 Test Acc: 0.964
Validation loss decreased (-0.938716 --> -0.964482).  Saving model ...
Epoch: 6 cost time: 6.947909593582153
Epoch: 6, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.319 Vali Acc: 0.967 Test Loss: 0.319 Test Acc: 0.967
Validation loss decreased (-0.964482 --> -0.966571).  Saving model ...
Epoch: 7 cost time: 6.892110824584961
Epoch: 7, Steps: 89 | Train Loss: 0.173 Vali Loss: 0.333 Vali Acc: 0.970 Test Loss: 0.333 Test Acc: 0.970
Validation loss decreased (-0.966571 --> -0.970052).  Saving model ...
Epoch: 8 cost time: 6.595086574554443
Epoch: 8, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.360 Vali Acc: 0.972 Test Loss: 0.360 Test Acc: 0.972
Validation loss decreased (-0.970052 --> -0.972141).  Saving model ...
Epoch: 9 cost time: 7.479479074478149
Epoch: 9, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.300 Vali Acc: 0.972 Test Loss: 0.300 Test Acc: 0.972
Validation loss decreased (-0.972141 --> -0.972142).  Saving model ...
Epoch: 10 cost time: 6.7954747676849365
Epoch: 10, Steps: 89 | Train Loss: 0.113 Vali Loss: 0.323 Vali Acc: 0.974 Test Loss: 0.323 Test Acc: 0.974
Validation loss decreased (-0.972142 --> -0.973534).  Saving model ...
Epoch: 11 cost time: 6.782565355300903
Epoch: 11, Steps: 89 | Train Loss: 0.133 Vali Loss: 0.434 Vali Acc: 0.962 Test Loss: 0.434 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.692762851715088
Epoch: 12, Steps: 89 | Train Loss: 0.126 Vali Loss: 0.622 Vali Acc: 0.938 Test Loss: 0.622 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.842583894729614
Epoch: 13, Steps: 89 | Train Loss: 0.151 Vali Loss: 0.518 Vali Acc: 0.958 Test Loss: 0.518 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 7.804737091064453
Epoch: 14, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.436 Vali Acc: 0.969 Test Loss: 0.436 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 6.542928457260132
Epoch: 15, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.339 Vali Acc: 0.971 Test Loss: 0.339 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 7.597553730010986
Epoch: 16, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.385 Vali Acc: 0.975 Test Loss: 0.385 Test Acc: 0.975
Validation loss decreased (-0.973534 --> -0.974927).  Saving model ...
Epoch: 17 cost time: 8.059243202209473
Epoch: 17, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.539 Vali Acc: 0.958 Test Loss: 0.539 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.2516303062438965
Epoch: 18, Steps: 89 | Train Loss: 0.135 Vali Loss: 0.577 Vali Acc: 0.964 Test Loss: 0.577 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 8.201903581619263
Epoch: 19, Steps: 89 | Train Loss: 0.181 Vali Loss: 0.606 Vali Acc: 0.962 Test Loss: 0.606 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 8.015974521636963
Epoch: 20, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.576 Vali Acc: 0.969 Test Loss: 0.576 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 6.400433778762817
Epoch: 21, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.405 Vali Acc: 0.978 Test Loss: 0.405 Test Acc: 0.978
Validation loss decreased (-0.974927 --> -0.977712).  Saving model ...
Epoch: 22 cost time: 6.760181665420532
Epoch: 22, Steps: 89 | Train Loss: 0.111 Vali Loss: 1.148 Vali Acc: 0.939 Test Loss: 1.148 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 7.415221929550171
Epoch: 23, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.512 Vali Acc: 0.973 Test Loss: 0.512 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 7.112853765487671
Epoch: 24, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.486 Vali Acc: 0.974 Test Loss: 0.486 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 6.366968870162964
Epoch: 25, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.563 Vali Acc: 0.973 Test Loss: 0.563 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 6.953404664993286
Epoch: 26, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.540 Vali Acc: 0.972 Test Loss: 0.540 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 6.126460075378418
Epoch: 27, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.563 Vali Acc: 0.971 Test Loss: 0.563 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 7.801020622253418
Epoch: 28, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.631 Vali Acc: 0.963 Test Loss: 0.631 Test Acc: 0.963
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 7.472536325454712
Epoch: 29, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.746 Vali Acc: 0.971 Test Loss: 0.746 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 7.5608811378479
Epoch: 30, Steps: 89 | Train Loss: 0.081 Vali Loss: 1.064 Vali Acc: 0.946 Test Loss: 1.064 Test Acc: 0.946
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 7.778792142868042
Epoch: 31, Steps: 89 | Train Loss: 0.129 Vali Loss: 0.674 Vali Acc: 0.973 Test Loss: 0.674 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9777158774373259
model parameter : 1341972
model size : 5.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.196365833282471
Epoch: 1, Steps: 89 | Train Loss: 0.990 Vali Loss: 0.316 Vali Acc: 0.935 Test Loss: 0.316 Test Acc: 0.935
Validation loss decreased (inf --> -0.934537).  Saving model ...
Epoch: 2 cost time: 5.077877044677734
Epoch: 2, Steps: 89 | Train Loss: 0.211 Vali Loss: 0.257 Vali Acc: 0.941 Test Loss: 0.257 Test Acc: 0.941
Validation loss decreased (-0.934537 --> -0.940805).  Saving model ...
Epoch: 3 cost time: 4.845170259475708
Epoch: 3, Steps: 89 | Train Loss: 0.120 Vali Loss: 0.336 Vali Acc: 0.926 Test Loss: 0.336 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.17697548866272
Epoch: 4, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.192 Vali Acc: 0.962 Test Loss: 0.192 Test Acc: 0.962
Validation loss decreased (-0.940805 --> -0.961697).  Saving model ...
Epoch: 5 cost time: 4.880205392837524
Epoch: 5, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.560 Vali Acc: 0.919 Test Loss: 0.560 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.751971244812012
Epoch: 6, Steps: 89 | Train Loss: 0.120 Vali Loss: 0.338 Vali Acc: 0.940 Test Loss: 0.338 Test Acc: 0.940
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.670696020126343
Epoch: 7, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.301 Vali Acc: 0.954 Test Loss: 0.301 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.222286701202393
Epoch: 8, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.228 Vali Acc: 0.965 Test Loss: 0.228 Test Acc: 0.965
Validation loss decreased (-0.961697 --> -0.965179).  Saving model ...
Epoch: 9 cost time: 4.976673603057861
Epoch: 9, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.244 Vali Acc: 0.969 Test Loss: 0.244 Test Acc: 0.969
Validation loss decreased (-0.965179 --> -0.969357).  Saving model ...
Epoch: 10 cost time: 4.707679510116577
Epoch: 10, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.253 Vali Acc: 0.967 Test Loss: 0.253 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.111991882324219
Epoch: 11, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.232 Vali Acc: 0.972 Test Loss: 0.232 Test Acc: 0.972
Validation loss decreased (-0.969357 --> -0.972143).  Saving model ...
Epoch: 12 cost time: 5.194139003753662
Epoch: 12, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.234 Vali Acc: 0.975 Test Loss: 0.234 Test Acc: 0.975
Validation loss decreased (-0.972143 --> -0.974928).  Saving model ...
Epoch: 13 cost time: 3.6439692974090576
Epoch: 13, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.257 Vali Acc: 0.979 Test Loss: 0.257 Test Acc: 0.979
Validation loss decreased (-0.974928 --> -0.979106).  Saving model ...
Epoch: 14 cost time: 4.476067304611206
Epoch: 14, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.300 Vali Acc: 0.969 Test Loss: 0.300 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.726235628128052
Epoch: 15, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.554 Vali Acc: 0.958 Test Loss: 0.554 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.723450422286987
Epoch: 16, Steps: 89 | Train Loss: 0.135 Vali Loss: 0.343 Vali Acc: 0.967 Test Loss: 0.343 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.327677011489868
Epoch: 17, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.328 Vali Acc: 0.974 Test Loss: 0.328 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 4.952331304550171
Epoch: 18, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.405 Vali Acc: 0.964 Test Loss: 0.405 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 4.454624652862549
Epoch: 19, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.387 Vali Acc: 0.969 Test Loss: 0.387 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.7065577507019043
Epoch: 20, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.322 Vali Acc: 0.974 Test Loss: 0.322 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 4.839285135269165
Epoch: 21, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.443 Vali Acc: 0.968 Test Loss: 0.443 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 4.99882435798645
Epoch: 22, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.338 Vali Acc: 0.974 Test Loss: 0.338 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 4.697548151016235
Epoch: 23, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.572 Vali Acc: 0.962 Test Loss: 0.572 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.979108635097493
model parameter : 974612
model size : 3.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps14_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.430992603302002
Epoch: 1, Steps: 89 | Train Loss: 1.036 Vali Loss: 0.332 Vali Acc: 0.913 Test Loss: 0.332 Test Acc: 0.913
Validation loss decreased (inf --> -0.912949).  Saving model ...
Epoch: 2 cost time: 5.436215877532959
Epoch: 2, Steps: 89 | Train Loss: 0.192 Vali Loss: 0.173 Vali Acc: 0.952 Test Loss: 0.173 Test Acc: 0.952
Validation loss decreased (-0.912949 --> -0.951948).  Saving model ...
Epoch: 3 cost time: 4.667767763137817
Epoch: 3, Steps: 89 | Train Loss: 0.126 Vali Loss: 0.173 Vali Acc: 0.962 Test Loss: 0.173 Test Acc: 0.962
Validation loss decreased (-0.951948 --> -0.962394).  Saving model ...
Epoch: 4 cost time: 5.177962779998779
Epoch: 4, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.137 Vali Acc: 0.969 Test Loss: 0.137 Test Acc: 0.969
Validation loss decreased (-0.962394 --> -0.969358).  Saving model ...
Epoch: 5 cost time: 5.09230375289917
Epoch: 5, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.149 Vali Acc: 0.969 Test Loss: 0.149 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.3287436962127686
Epoch: 6, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.367 Vali Acc: 0.933 Test Loss: 0.367 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.5867764949798584
Epoch: 7, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.232 Vali Acc: 0.954 Test Loss: 0.232 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.379265069961548
Epoch: 8, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.175 Vali Acc: 0.967 Test Loss: 0.175 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.5796754360198975
Epoch: 9, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.160 Vali Acc: 0.976 Test Loss: 0.160 Test Acc: 0.976
Validation loss decreased (-0.969358 --> -0.975625).  Saving model ...
Epoch: 10 cost time: 4.65665078163147
Epoch: 10, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.172 Vali Acc: 0.976 Test Loss: 0.172 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.894654035568237
Epoch: 11, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.301 Vali Acc: 0.951 Test Loss: 0.301 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.601044178009033
Epoch: 12, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.146 Vali Acc: 0.974 Test Loss: 0.146 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.618239641189575
Epoch: 13, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.465 Vali Acc: 0.944 Test Loss: 0.465 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.789261341094971
Epoch: 14, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.264 Vali Acc: 0.964 Test Loss: 0.264 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.589336156845093
Epoch: 15, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.300 Vali Acc: 0.967 Test Loss: 0.300 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.39775824546814
Epoch: 16, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.195 Vali Acc: 0.977 Test Loss: 0.195 Test Acc: 0.977
Validation loss decreased (-0.975625 --> -0.977018).  Saving model ...
Epoch: 17 cost time: 3.6712076663970947
Epoch: 17, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.193 Vali Acc: 0.981 Test Loss: 0.193 Test Acc: 0.981
Validation loss decreased (-0.977018 --> -0.981196).  Saving model ...
Epoch: 18 cost time: 4.344785451889038
Epoch: 18, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.227 Vali Acc: 0.976 Test Loss: 0.227 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.469347715377808
Epoch: 19, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.275 Vali Acc: 0.976 Test Loss: 0.275 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.178187370300293
Epoch: 20, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.280 Vali Acc: 0.972 Test Loss: 0.280 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 4.384583473205566
Epoch: 21, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.225 Vali Acc: 0.982 Test Loss: 0.225 Test Acc: 0.982
Validation loss decreased (-0.981196 --> -0.981892).  Saving model ...
Epoch: 22 cost time: 4.458029270172119
Epoch: 22, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.478 Vali Acc: 0.954 Test Loss: 0.478 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 4.5238120555877686
Epoch: 23, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.269 Vali Acc: 0.974 Test Loss: 0.269 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.959108829498291
Epoch: 24, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.212 Vali Acc: 0.981 Test Loss: 0.212 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.5239248275756836
Epoch: 25, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.248 Vali Acc: 0.978 Test Loss: 0.248 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.9589638710021973
Epoch: 26, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.473 Vali Acc: 0.965 Test Loss: 0.473 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 4.1774585247039795
Epoch: 27, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.238 Vali Acc: 0.985 Test Loss: 0.238 Test Acc: 0.985
Validation loss decreased (-0.981892 --> -0.984677).  Saving model ...
Epoch: 28 cost time: 4.725313901901245
Epoch: 28, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.982 Test Loss: 0.206 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 4.650619268417358
Epoch: 29, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.985 Test Loss: 0.194 Test Acc: 0.985
Validation loss decreased (-0.984677 --> -0.984678).  Saving model ...
Epoch: 30 cost time: 4.467326641082764
Epoch: 30, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.985 Test Loss: 0.190 Test Acc: 0.985
Validation loss decreased (-0.984678 --> -0.985374).  Saving model ...
Epoch: 31 cost time: 4.807381629943848
Epoch: 31, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.985 Test Loss: 0.191 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 4.834998846054077
Epoch: 32, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.985 Test Loss: 0.193 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 3.557629108428955
Epoch: 33, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.986 Test Loss: 0.187 Test Acc: 0.986
Validation loss decreased (-0.985374 --> -0.986071).  Saving model ...
Epoch: 34 cost time: 4.551097869873047
Epoch: 34, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.986 Test Loss: 0.184 Test Acc: 0.986
Validation loss decreased (-0.986071 --> -0.986071).  Saving model ...
Epoch: 35 cost time: 3.9595775604248047
Epoch: 35, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.986 Test Loss: 0.189 Test Acc: 0.986
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 4.346827745437622
Epoch: 36, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.987 Test Loss: 0.190 Test Acc: 0.987
Validation loss decreased (-0.986071 --> -0.987463).  Saving model ...
Epoch: 37 cost time: 5.004100561141968
Epoch: 37, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.987 Test Loss: 0.188 Test Acc: 0.987
Validation loss decreased (-0.987463 --> -0.987463).  Saving model ...
Epoch: 38 cost time: 4.696699380874634
Epoch: 38, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.987 Test Loss: 0.190 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 4.313613414764404
Epoch: 39, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.987 Test Loss: 0.193 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 4.088886022567749
Epoch: 40, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.987 Test Loss: 0.191 Test Acc: 0.987
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 4.307278871536255
Epoch: 41, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.987 Test Loss: 0.190 Test Acc: 0.987
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 4.452235698699951
Epoch: 42, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.987 Test Loss: 0.186 Test Acc: 0.987
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 4.750481367111206
Epoch: 43, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.987 Test Loss: 0.180 Test Acc: 0.987
Validation loss decreased (-0.987463 --> -0.987463).  Saving model ...
Epoch: 44 cost time: 4.308492183685303
Epoch: 44, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.987 Test Loss: 0.184 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 4.503896951675415
Epoch: 45, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.987 Test Loss: 0.180 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 3.5962347984313965
Epoch: 46, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.987 Test Loss: 0.182 Test Acc: 0.987
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 3.9726171493530273
Epoch: 47, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.987 Test Loss: 0.179 Test Acc: 0.987
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 4.271430730819702
Epoch: 48, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.987 Test Loss: 0.184 Test Acc: 0.987
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 4.979521989822388
Epoch: 49, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.987 Test Loss: 0.183 Test Acc: 0.987
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 4.806548833847046
Epoch: 50, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.986 Test Loss: 0.182 Test Acc: 0.986
EarlyStopping counter: 7 out of 10
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps14_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9874651810584958
model parameter : 822036
model size : 3.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps19_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.498623847961426
Epoch: 1, Steps: 89 | Train Loss: 1.203 Vali Loss: 0.338 Vali Acc: 0.921 Test Loss: 0.338 Test Acc: 0.921
Validation loss decreased (inf --> -0.921306).  Saving model ...
Epoch: 2 cost time: 4.600537538528442
Epoch: 2, Steps: 89 | Train Loss: 0.228 Vali Loss: 0.225 Vali Acc: 0.944 Test Loss: 0.225 Test Acc: 0.944
Validation loss decreased (-0.921306 --> -0.944287).  Saving model ...
Epoch: 3 cost time: 3.968082904815674
Epoch: 3, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.146 Vali Acc: 0.964 Test Loss: 0.146 Test Acc: 0.964
Validation loss decreased (-0.944287 --> -0.963787).  Saving model ...
Epoch: 4 cost time: 3.842907428741455
Epoch: 4, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.963787 --> -0.979804).  Saving model ...
Epoch: 5 cost time: 3.841447353363037
Epoch: 5, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.090 Vali Acc: 0.981 Test Loss: 0.090 Test Acc: 0.981
Validation loss decreased (-0.979804 --> -0.980500).  Saving model ...
Epoch: 6 cost time: 4.3799028396606445
Epoch: 6, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.090 Vali Acc: 0.978 Test Loss: 0.090 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.9643778800964355
Epoch: 7, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.930866003036499
Epoch: 8, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.109 Vali Acc: 0.974 Test Loss: 0.109 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.327288866043091
Epoch: 9, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.193 Vali Acc: 0.954 Test Loss: 0.193 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.5747768878936768
Epoch: 10, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.130 Vali Acc: 0.974 Test Loss: 0.130 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.13979172706604
Epoch: 11, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.130 Vali Acc: 0.978 Test Loss: 0.130 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.3558623790740967
Epoch: 12, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.211 Vali Acc: 0.966 Test Loss: 0.211 Test Acc: 0.966
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 4.004714250564575
Epoch: 13, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.308 Vali Acc: 0.960 Test Loss: 0.308 Test Acc: 0.960
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 4.524695634841919
Epoch: 14, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.129 Vali Acc: 0.979 Test Loss: 0.129 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 4.451838254928589
Epoch: 15, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.144 Vali Acc: 0.981 Test Loss: 0.144 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps19_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9805013927576601
model parameter : 700436
model size : 2.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps28_str14_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.157585859298706
Epoch: 1, Steps: 89 | Train Loss: 1.316 Vali Loss: 0.433 Vali Acc: 0.873 Test Loss: 0.433 Test Acc: 0.873
Validation loss decreased (inf --> -0.872558).  Saving model ...
Epoch: 2 cost time: 2.957878828048706
Epoch: 2, Steps: 89 | Train Loss: 0.257 Vali Loss: 0.201 Vali Acc: 0.946 Test Loss: 0.201 Test Acc: 0.946
Validation loss decreased (-0.872558 --> -0.945680).  Saving model ...
Epoch: 3 cost time: 3.8671815395355225
Epoch: 3, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.123 Vali Acc: 0.967 Test Loss: 0.123 Test Acc: 0.967
Validation loss decreased (-0.945680 --> -0.967269).  Saving model ...
Epoch: 4 cost time: 4.304633140563965
Epoch: 4, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
Validation loss decreased (-0.967269 --> -0.977019).  Saving model ...
Epoch: 5 cost time: 3.8427984714508057
Epoch: 5, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.115 Vali Acc: 0.972 Test Loss: 0.115 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.918534755706787
Epoch: 6, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.095 Vali Acc: 0.981 Test Loss: 0.095 Test Acc: 0.981
Validation loss decreased (-0.977019 --> -0.980500).  Saving model ...
Epoch: 7 cost time: 3.565534830093384
Epoch: 7, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.094 Vali Acc: 0.974 Test Loss: 0.094 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.2109737396240234
Epoch: 8, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.081 Vali Acc: 0.979 Test Loss: 0.081 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.5556395053863525
Epoch: 9, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.183 Vali Acc: 0.963 Test Loss: 0.183 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.9544734954833984
Epoch: 10, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.103 Vali Acc: 0.976 Test Loss: 0.103 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.4142963886260986
Epoch: 11, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.091 Vali Acc: 0.984 Test Loss: 0.091 Test Acc: 0.984
Validation loss decreased (-0.980500 --> -0.983982).  Saving model ...
Epoch: 12 cost time: 3.970977783203125
Epoch: 12, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.267 Vali Acc: 0.955 Test Loss: 0.267 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.996461868286133
Epoch: 13, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.109 Vali Acc: 0.972 Test Loss: 0.109 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.641941785812378
Epoch: 14, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.154 Vali Acc: 0.971 Test Loss: 0.154 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.204867839813232
Epoch: 15, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.122 Vali Acc: 0.974 Test Loss: 0.122 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.3092358112335205
Epoch: 16, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.150 Vali Acc: 0.970 Test Loss: 0.150 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.7235772609710693
Epoch: 17, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.197 Vali Acc: 0.964 Test Loss: 0.197 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.662137269973755
Epoch: 18, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.149 Vali Acc: 0.975 Test Loss: 0.149 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.867185354232788
Epoch: 19, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.170 Vali Acc: 0.969 Test Loss: 0.170 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.9055798053741455
Epoch: 20, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.131 Vali Acc: 0.979 Test Loss: 0.131 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 4.137485027313232
Epoch: 21, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.129 Vali Acc: 0.979 Test Loss: 0.129 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps28_str14_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.983983286908078
model parameter : 625940
model size : 2.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps37_str19_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.129140615463257
Epoch: 1, Steps: 89 | Train Loss: 1.477 Vali Loss: 0.503 Vali Acc: 0.881 Test Loss: 0.503 Test Acc: 0.881
Validation loss decreased (inf --> -0.880914).  Saving model ...
Epoch: 2 cost time: 3.8050618171691895
Epoch: 2, Steps: 89 | Train Loss: 0.322 Vali Loss: 0.218 Vali Acc: 0.953 Test Loss: 0.218 Test Acc: 0.953
Validation loss decreased (-0.880914 --> -0.952644).  Saving model ...
Epoch: 3 cost time: 3.3628475666046143
Epoch: 3, Steps: 89 | Train Loss: 0.134 Vali Loss: 0.126 Vali Acc: 0.967 Test Loss: 0.126 Test Acc: 0.967
Validation loss decreased (-0.952644 --> -0.967269).  Saving model ...
Epoch: 4 cost time: 3.9148993492126465
Epoch: 4, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.107 Vali Acc: 0.976 Test Loss: 0.107 Test Acc: 0.976
Validation loss decreased (-0.967269 --> -0.976322).  Saving model ...
Epoch: 5 cost time: 3.6438851356506348
Epoch: 5, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.090 Vali Acc: 0.978 Test Loss: 0.090 Test Acc: 0.978
Validation loss decreased (-0.976322 --> -0.977715).  Saving model ...
Epoch: 6 cost time: 3.8177196979522705
Epoch: 6, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.732041120529175
Epoch: 7, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.115 Vali Acc: 0.974 Test Loss: 0.115 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.4206223487854004
Epoch: 8, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.088 Vali Acc: 0.981 Test Loss: 0.088 Test Acc: 0.981
Validation loss decreased (-0.977715 --> -0.981197).  Saving model ...
Epoch: 9 cost time: 2.950695514678955
Epoch: 9, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.125 Vali Acc: 0.971 Test Loss: 0.125 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.5572643280029297
Epoch: 10, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.160 Vali Acc: 0.959 Test Loss: 0.160 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.302001476287842
Epoch: 11, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.100 Vali Acc: 0.975 Test Loss: 0.100 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.8081748485565186
Epoch: 12, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.4680521488189697
Epoch: 13, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.191 Vali Acc: 0.957 Test Loss: 0.191 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.0700409412384033
Epoch: 14, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.132 Vali Acc: 0.974 Test Loss: 0.132 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.623265027999878
Epoch: 15, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.151 Vali Acc: 0.978 Test Loss: 0.151 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.622499942779541
Epoch: 16, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.145 Vali Acc: 0.981 Test Loss: 0.145 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.723086357116699
Epoch: 17, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.220 Vali Acc: 0.964 Test Loss: 0.220 Test Acc: 0.964
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.3317556381225586
Epoch: 18, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.110 Vali Acc: 0.982 Test Loss: 0.110 Test Acc: 0.982
Validation loss decreased (-0.981197 --> -0.981893).  Saving model ...
Epoch: 19 cost time: 3.7207517623901367
Epoch: 19, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.103 Vali Acc: 0.979 Test Loss: 0.103 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.3924829959869385
Epoch: 20, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.128 Vali Acc: 0.977 Test Loss: 0.128 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.6031112670898438
Epoch: 21, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.123 Vali Acc: 0.978 Test Loss: 0.123 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.6128804683685303
Epoch: 22, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.126 Vali Acc: 0.983 Test Loss: 0.126 Test Acc: 0.983
Validation loss decreased (-0.981893 --> -0.982589).  Saving model ...
Epoch: 23 cost time: 2.766897201538086
Epoch: 23, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.130 Vali Acc: 0.979 Test Loss: 0.130 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.5073728561401367
Epoch: 24, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.103 Vali Acc: 0.985 Test Loss: 0.103 Test Acc: 0.985
Validation loss decreased (-0.982589 --> -0.984679).  Saving model ...
Epoch: 25 cost time: 4.052430629730225
Epoch: 25, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.104 Vali Acc: 0.987 Test Loss: 0.104 Test Acc: 0.987
Validation loss decreased (-0.984679 --> -0.986768).  Saving model ...
Epoch: 26 cost time: 4.14702582359314
Epoch: 26, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.191 Vali Acc: 0.969 Test Loss: 0.191 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.2664504051208496
Epoch: 27, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.105 Vali Acc: 0.983 Test Loss: 0.105 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 4.296794176101685
Epoch: 28, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.118 Vali Acc: 0.976 Test Loss: 0.118 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.985980987548828
Epoch: 29, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.207 Vali Acc: 0.966 Test Loss: 0.207 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.493758201599121
Epoch: 30, Steps: 89 | Train Loss: 0.131 Vali Loss: 0.181 Vali Acc: 0.974 Test Loss: 0.181 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 3.6961333751678467
Epoch: 31, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.253 Vali Acc: 0.968 Test Loss: 0.253 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 4.248887062072754
Epoch: 32, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.130 Vali Acc: 0.983 Test Loss: 0.130 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 3.4998514652252197
Epoch: 33, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.127 Vali Acc: 0.980 Test Loss: 0.127 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 4.184716463088989
Epoch: 34, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.121 Vali Acc: 0.984 Test Loss: 0.121 Test Acc: 0.984
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 3.873166561126709
Epoch: 35, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.189 Vali Acc: 0.978 Test Loss: 0.189 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps37_str19_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9867688022284122
model parameter : 566804
model size : 2.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps46_str23_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.570233345031738
Epoch: 1, Steps: 89 | Train Loss: 1.557 Vali Loss: 0.549 Vali Acc: 0.877 Test Loss: 0.549 Test Acc: 0.877
Validation loss decreased (inf --> -0.876735).  Saving model ...
Epoch: 2 cost time: 3.297248363494873
Epoch: 2, Steps: 89 | Train Loss: 0.358 Vali Loss: 0.252 Vali Acc: 0.940 Test Loss: 0.252 Test Acc: 0.940
Validation loss decreased (-0.876735 --> -0.940109).  Saving model ...
Epoch: 3 cost time: 3.69364595413208
Epoch: 3, Steps: 89 | Train Loss: 0.159 Vali Loss: 0.126 Vali Acc: 0.971 Test Loss: 0.126 Test Acc: 0.971
Validation loss decreased (-0.940109 --> -0.971447).  Saving model ...
Epoch: 4 cost time: 3.6132194995880127
Epoch: 4, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.104 Vali Acc: 0.974 Test Loss: 0.104 Test Acc: 0.974
Validation loss decreased (-0.971447 --> -0.973537).  Saving model ...
Epoch: 5 cost time: 2.9889326095581055
Epoch: 5, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.129 Vali Acc: 0.964 Test Loss: 0.129 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.8906962871551514
Epoch: 6, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.072 Vali Acc: 0.981 Test Loss: 0.072 Test Acc: 0.981
Validation loss decreased (-0.973537 --> -0.981197).  Saving model ...
Epoch: 7 cost time: 3.546438694000244
Epoch: 7, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.069 Vali Acc: 0.981 Test Loss: 0.069 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.3817644119262695
Epoch: 8, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.102 Vali Acc: 0.975 Test Loss: 0.102 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.8319694995880127
Epoch: 9, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.780087947845459
Epoch: 10, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.147 Vali Acc: 0.962 Test Loss: 0.147 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.53467869758606
Epoch: 11, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
Validation loss decreased (-0.981197 --> -0.982590).  Saving model ...
Epoch: 12 cost time: 4.209037780761719
Epoch: 12, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.100 Vali Acc: 0.976 Test Loss: 0.100 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.2675182819366455
Epoch: 13, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.293749094009399
Epoch: 14, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.100 Vali Acc: 0.976 Test Loss: 0.100 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.51744532585144
Epoch: 15, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.063 Vali Acc: 0.986 Test Loss: 0.063 Test Acc: 0.986
Validation loss decreased (-0.982590 --> -0.986072).  Saving model ...
Epoch: 16 cost time: 4.0591442584991455
Epoch: 16, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.092 Vali Acc: 0.984 Test Loss: 0.092 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.811265230178833
Epoch: 17, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.137 Vali Acc: 0.968 Test Loss: 0.137 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.919516086578369
Epoch: 18, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.214 Vali Acc: 0.953 Test Loss: 0.214 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.0280683040618896
Epoch: 19, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.088 Vali Acc: 0.979 Test Loss: 0.088 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.6040961742401123
Epoch: 20, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.150 Vali Acc: 0.970 Test Loss: 0.150 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 4.152688026428223
Epoch: 21, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.092 Vali Acc: 0.981 Test Loss: 0.092 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.8828206062316895
Epoch: 22, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.077 Vali Acc: 0.984 Test Loss: 0.077 Test Acc: 0.984
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 4.170837879180908
Epoch: 23, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 4.546141862869263
Epoch: 24, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.188 Vali Acc: 0.962 Test Loss: 0.188 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 4.436931133270264
Epoch: 25, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.216 Vali Acc: 0.958 Test Loss: 0.216 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim256_nb1_lk13_sk5_ffr1_ps46_str23_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9860724233983287
model parameter : 538388
model size : 2.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.541810512542725
Epoch: 1, Steps: 89 | Train Loss: 1.024 Vali Loss: 0.304 Vali Acc: 0.916 Test Loss: 0.304 Test Acc: 0.916
Validation loss decreased (inf --> -0.916432).  Saving model ...
Epoch: 2 cost time: 2.8656084537506104
Epoch: 2, Steps: 89 | Train Loss: 0.209 Vali Loss: 0.241 Vali Acc: 0.939 Test Loss: 0.241 Test Acc: 0.939
Validation loss decreased (-0.916432 --> -0.939413).  Saving model ...
Epoch: 3 cost time: 4.589432239532471
Epoch: 3, Steps: 89 | Train Loss: 0.129 Vali Loss: 0.163 Vali Acc: 0.964 Test Loss: 0.163 Test Acc: 0.964
Validation loss decreased (-0.939413 --> -0.964483).  Saving model ...
Epoch: 4 cost time: 4.402684211730957
Epoch: 4, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.254 Vali Acc: 0.946 Test Loss: 0.254 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.4878623485565186
Epoch: 5, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.185 Vali Acc: 0.965 Test Loss: 0.185 Test Acc: 0.965
Validation loss decreased (-0.964483 --> -0.965179).  Saving model ...
Epoch: 6 cost time: 4.031558275222778
Epoch: 6, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.162 Vali Acc: 0.976 Test Loss: 0.162 Test Acc: 0.976
Validation loss decreased (-0.965179 --> -0.976321).  Saving model ...
Epoch: 7 cost time: 4.3204755783081055
Epoch: 7, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.212 Vali Acc: 0.967 Test Loss: 0.212 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.9218032360076904
Epoch: 8, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.351 Vali Acc: 0.955 Test Loss: 0.351 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.628868818283081
Epoch: 9, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.435 Vali Acc: 0.928 Test Loss: 0.435 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.731451988220215
Epoch: 10, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.346 Vali Acc: 0.961 Test Loss: 0.346 Test Acc: 0.961
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.2906835079193115
Epoch: 11, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.281 Vali Acc: 0.964 Test Loss: 0.281 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.266145944595337
Epoch: 12, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.329 Vali Acc: 0.957 Test Loss: 0.329 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.2067179679870605
Epoch: 13, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.282 Vali Acc: 0.975 Test Loss: 0.282 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.045725345611572
Epoch: 14, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.312 Vali Acc: 0.971 Test Loss: 0.312 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.3784921169281006
Epoch: 15, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.311 Vali Acc: 0.973 Test Loss: 0.311 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 4.0643556118011475
Epoch: 16, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.265 Vali Acc: 0.981 Test Loss: 0.265 Test Acc: 0.981
Validation loss decreased (-0.976321 --> -0.980499).  Saving model ...
Epoch: 17 cost time: 4.3291826248168945
Epoch: 17, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.981 Test Loss: 0.275 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.348762512207031
Epoch: 18, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.273 Vali Acc: 0.979 Test Loss: 0.273 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.3231139183044434
Epoch: 19, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.978 Test Loss: 0.270 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.453540325164795
Epoch: 20, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.274 Vali Acc: 0.978 Test Loss: 0.274 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.6735517978668213
Epoch: 21, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.275 Vali Acc: 0.979 Test Loss: 0.275 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 4.009480714797974
Epoch: 22, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.321 Vali Acc: 0.972 Test Loss: 0.321 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 4.1710076332092285
Epoch: 23, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.440 Vali Acc: 0.961 Test Loss: 0.440 Test Acc: 0.961
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 3.9145102500915527
Epoch: 24, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.390 Vali Acc: 0.965 Test Loss: 0.390 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 3.6441102027893066
Epoch: 25, Steps: 89 | Train Loss: 0.189 Vali Loss: 0.358 Vali Acc: 0.962 Test Loss: 0.358 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 4.149844646453857
Epoch: 26, Steps: 89 | Train Loss: 0.177 Vali Loss: 0.425 Vali Acc: 0.964 Test Loss: 0.425 Test Acc: 0.964
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9805013927576601
model parameter : 572692
model size : 2.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.867218494415283
Epoch: 1, Steps: 89 | Train Loss: 1.232 Vali Loss: 0.385 Vali Acc: 0.892 Test Loss: 0.385 Test Acc: 0.892
Validation loss decreased (inf --> -0.892057).  Saving model ...
Epoch: 2 cost time: 2.216339349746704
Epoch: 2, Steps: 89 | Train Loss: 0.225 Vali Loss: 0.212 Vali Acc: 0.941 Test Loss: 0.212 Test Acc: 0.941
Validation loss decreased (-0.892057 --> -0.940806).  Saving model ...
Epoch: 3 cost time: 3.0573501586914062
Epoch: 3, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.141 Vali Acc: 0.964 Test Loss: 0.141 Test Acc: 0.964
Validation loss decreased (-0.940806 --> -0.964483).  Saving model ...
Epoch: 4 cost time: 3.781895399093628
Epoch: 4, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.131 Vali Acc: 0.969 Test Loss: 0.131 Test Acc: 0.969
Validation loss decreased (-0.964483 --> -0.968662).  Saving model ...
Epoch: 5 cost time: 3.6425325870513916
Epoch: 5, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.134 Vali Acc: 0.972 Test Loss: 0.134 Test Acc: 0.972
Validation loss decreased (-0.968662 --> -0.972144).  Saving model ...
Epoch: 6 cost time: 3.43164324760437
Epoch: 6, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.162 Vali Acc: 0.970 Test Loss: 0.162 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.65299654006958
Epoch: 7, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.149 Vali Acc: 0.965 Test Loss: 0.149 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.238075017929077
Epoch: 8, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.158 Vali Acc: 0.974 Test Loss: 0.158 Test Acc: 0.974
Validation loss decreased (-0.972144 --> -0.973536).  Saving model ...
Epoch: 9 cost time: 2.55985426902771
Epoch: 9, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.263 Vali Acc: 0.942 Test Loss: 0.263 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.884286880493164
Epoch: 10, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.186 Vali Acc: 0.973 Test Loss: 0.186 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.807634115219116
Epoch: 11, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.144 Vali Acc: 0.980 Test Loss: 0.144 Test Acc: 0.980
Validation loss decreased (-0.973536 --> -0.979804).  Saving model ...
Epoch: 12 cost time: 3.374277114868164
Epoch: 12, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.209 Vali Acc: 0.971 Test Loss: 0.209 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.838660955429077
Epoch: 13, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.169 Vali Acc: 0.975 Test Loss: 0.169 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.6138076782226562
Epoch: 14, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.133 Vali Acc: 0.981 Test Loss: 0.133 Test Acc: 0.981
Validation loss decreased (-0.979804 --> -0.980500).  Saving model ...
Epoch: 15 cost time: 1.8222618103027344
Epoch: 15, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.154 Vali Acc: 0.981 Test Loss: 0.154 Test Acc: 0.981
Validation loss decreased (-0.980500 --> -0.981196).  Saving model ...
Epoch: 16 cost time: 2.1449177265167236
Epoch: 16, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.157 Vali Acc: 0.979 Test Loss: 0.157 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.8757154941558838
Epoch: 17, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.134 Vali Acc: 0.983 Test Loss: 0.134 Test Acc: 0.983
Validation loss decreased (-0.981196 --> -0.983286).  Saving model ...
Epoch: 18 cost time: 3.8620686531066895
Epoch: 18, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.135 Vali Acc: 0.981 Test Loss: 0.135 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.013674974441528
Epoch: 19, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.147 Vali Acc: 0.978 Test Loss: 0.147 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.243520975112915
Epoch: 20, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.164 Vali Acc: 0.978 Test Loss: 0.164 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.2625091075897217
Epoch: 21, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.215 Vali Acc: 0.978 Test Loss: 0.215 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.5432162284851074
Epoch: 22, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.316 Vali Acc: 0.956 Test Loss: 0.316 Test Acc: 0.956
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.520599365234375
Epoch: 23, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.238 Vali Acc: 0.974 Test Loss: 0.238 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.836008310317993
Epoch: 24, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.297 Vali Acc: 0.953 Test Loss: 0.297 Test Acc: 0.953
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 3.8317482471466064
Epoch: 25, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.249 Vali Acc: 0.969 Test Loss: 0.249 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 3.1755757331848145
Epoch: 26, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.200 Vali Acc: 0.981 Test Loss: 0.200 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 3.229281187057495
Epoch: 27, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.981 Test Loss: 0.180 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9832869080779945
model parameter : 389012
model size : 1.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps14_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.946660041809082
Epoch: 1, Steps: 89 | Train Loss: 1.338 Vali Loss: 0.460 Vali Acc: 0.893 Test Loss: 0.460 Test Acc: 0.893
Validation loss decreased (inf --> -0.893449).  Saving model ...
Epoch: 2 cost time: 3.847452163696289
Epoch: 2, Steps: 89 | Train Loss: 0.288 Vali Loss: 0.202 Vali Acc: 0.950 Test Loss: 0.202 Test Acc: 0.950
Validation loss decreased (-0.893449 --> -0.949859).  Saving model ...
Epoch: 3 cost time: 3.2723729610443115
Epoch: 3, Steps: 89 | Train Loss: 0.134 Vali Loss: 0.166 Vali Acc: 0.960 Test Loss: 0.166 Test Acc: 0.960
Validation loss decreased (-0.949859 --> -0.959608).  Saving model ...
Epoch: 4 cost time: 3.6362805366516113
Epoch: 4, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.134 Vali Acc: 0.965 Test Loss: 0.134 Test Acc: 0.965
Validation loss decreased (-0.959608 --> -0.965180).  Saving model ...
Epoch: 5 cost time: 3.8342559337615967
Epoch: 5, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.114 Vali Acc: 0.964 Test Loss: 0.114 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.1985604763031006
Epoch: 6, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.097 Vali Acc: 0.973 Test Loss: 0.097 Test Acc: 0.973
Validation loss decreased (-0.965180 --> -0.972840).  Saving model ...
Epoch: 7 cost time: 3.0942704677581787
Epoch: 7, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.081 Vali Acc: 0.980 Test Loss: 0.081 Test Acc: 0.980
Validation loss decreased (-0.972840 --> -0.979804).  Saving model ...
Epoch: 8 cost time: 3.78583025932312
Epoch: 8, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.103 Vali Acc: 0.974 Test Loss: 0.103 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.6437811851501465
Epoch: 9, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.081 Vali Acc: 0.979 Test Loss: 0.081 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.7499992847442627
Epoch: 10, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.088 Vali Acc: 0.981 Test Loss: 0.088 Test Acc: 0.981
Validation loss decreased (-0.979804 --> -0.981197).  Saving model ...
Epoch: 11 cost time: 3.311685562133789
Epoch: 11, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.102 Vali Acc: 0.978 Test Loss: 0.102 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.0810089111328125
Epoch: 12, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.092 Vali Acc: 0.978 Test Loss: 0.092 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.5734288692474365
Epoch: 13, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.189 Vali Acc: 0.969 Test Loss: 0.189 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.1585702896118164
Epoch: 14, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.481 Vali Acc: 0.935 Test Loss: 0.481 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.0789549350738525
Epoch: 15, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.326 Vali Acc: 0.951 Test Loss: 0.326 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.7370288372039795
Epoch: 16, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.183 Vali Acc: 0.969 Test Loss: 0.183 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.517550230026245
Epoch: 17, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.149 Vali Acc: 0.973 Test Loss: 0.149 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.4389402866363525
Epoch: 18, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.141 Vali Acc: 0.981 Test Loss: 0.141 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.540487051010132
Epoch: 19, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.200 Vali Acc: 0.971 Test Loss: 0.200 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.6290512084960938
Epoch: 20, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.150 Vali Acc: 0.980 Test Loss: 0.150 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps14_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9811977715877437
model parameter : 312724
model size : 1.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps19_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.478539705276489
Epoch: 1, Steps: 89 | Train Loss: 1.464 Vali Loss: 0.501 Vali Acc: 0.865 Test Loss: 0.501 Test Acc: 0.865
Validation loss decreased (inf --> -0.864897).  Saving model ...
Epoch: 2 cost time: 3.157590389251709
Epoch: 2, Steps: 89 | Train Loss: 0.319 Vali Loss: 0.253 Vali Acc: 0.932 Test Loss: 0.253 Test Acc: 0.932
Validation loss decreased (-0.864897 --> -0.932449).  Saving model ...
Epoch: 3 cost time: 3.2500834465026855
Epoch: 3, Steps: 89 | Train Loss: 0.136 Vali Loss: 0.148 Vali Acc: 0.958 Test Loss: 0.148 Test Acc: 0.958
Validation loss decreased (-0.932449 --> -0.958216).  Saving model ...
Epoch: 4 cost time: 3.2357375621795654
Epoch: 4, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.100 Vali Acc: 0.978 Test Loss: 0.100 Test Acc: 0.978
Validation loss decreased (-0.958216 --> -0.978411).  Saving model ...
Epoch: 5 cost time: 2.8944284915924072
Epoch: 5, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.090 Vali Acc: 0.978 Test Loss: 0.090 Test Acc: 0.978
Validation loss decreased (-0.978411 --> -0.978411).  Saving model ...
Epoch: 6 cost time: 3.2190213203430176
Epoch: 6, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.981172800064087
Epoch: 7, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.072 Vali Acc: 0.979 Test Loss: 0.072 Test Acc: 0.979
Validation loss decreased (-0.978411 --> -0.979108).  Saving model ...
Epoch: 8 cost time: 3.3438327312469482
Epoch: 8, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.083 Vali Acc: 0.981 Test Loss: 0.083 Test Acc: 0.981
Validation loss decreased (-0.979108 --> -0.981197).  Saving model ...
Epoch: 9 cost time: 2.8106322288513184
Epoch: 9, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.079 Vali Acc: 0.978 Test Loss: 0.079 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.65545392036438
Epoch: 10, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.76326847076416
Epoch: 11, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.093 Vali Acc: 0.981 Test Loss: 0.093 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.938272476196289
Epoch: 12, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.075 Vali Acc: 0.987 Test Loss: 0.075 Test Acc: 0.987
Validation loss decreased (-0.981197 --> -0.987464).  Saving model ...
Epoch: 13 cost time: 3.136996269226074
Epoch: 13, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.131 Vali Acc: 0.971 Test Loss: 0.131 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.9134161472320557
Epoch: 14, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.110 Vali Acc: 0.979 Test Loss: 0.110 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.8537991046905518
Epoch: 15, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.133 Vali Acc: 0.974 Test Loss: 0.133 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.9338343143463135
Epoch: 16, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.108 Vali Acc: 0.980 Test Loss: 0.108 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.2608935832977295
Epoch: 17, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.198 Vali Acc: 0.958 Test Loss: 0.198 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.1347768306732178
Epoch: 18, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.120 Vali Acc: 0.981 Test Loss: 0.120 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.447652816772461
Epoch: 19, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.143 Vali Acc: 0.971 Test Loss: 0.143 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.5124120712280273
Epoch: 20, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.187 Vali Acc: 0.971 Test Loss: 0.187 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.1476364135742188
Epoch: 21, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.191 Vali Acc: 0.974 Test Loss: 0.191 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.572303056716919
Epoch: 22, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.160 Vali Acc: 0.977 Test Loss: 0.160 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps19_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9874651810584958
model parameter : 251924
model size : 0.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps28_str14_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.796672821044922
Epoch: 1, Steps: 89 | Train Loss: 1.692 Vali Loss: 0.626 Vali Acc: 0.873 Test Loss: 0.626 Test Acc: 0.873
Validation loss decreased (inf --> -0.873253).  Saving model ...
Epoch: 2 cost time: 3.6001105308532715
Epoch: 2, Steps: 89 | Train Loss: 0.399 Vali Loss: 0.272 Vali Acc: 0.932 Test Loss: 0.272 Test Acc: 0.932
Validation loss decreased (-0.873253 --> -0.931752).  Saving model ...
Epoch: 3 cost time: 3.2670369148254395
Epoch: 3, Steps: 89 | Train Loss: 0.167 Vali Loss: 0.158 Vali Acc: 0.969 Test Loss: 0.158 Test Acc: 0.969
Validation loss decreased (-0.931752 --> -0.969358).  Saving model ...
Epoch: 4 cost time: 3.5030863285064697
Epoch: 4, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.117 Vali Acc: 0.971 Test Loss: 0.117 Test Acc: 0.971
Validation loss decreased (-0.969358 --> -0.971447).  Saving model ...
Epoch: 5 cost time: 3.761854887008667
Epoch: 5, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.120 Vali Acc: 0.963 Test Loss: 0.120 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.2405831813812256
Epoch: 6, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.093 Vali Acc: 0.971 Test Loss: 0.093 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.0845751762390137
Epoch: 7, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.093 Vali Acc: 0.975 Test Loss: 0.093 Test Acc: 0.975
Validation loss decreased (-0.971447 --> -0.974929).  Saving model ...
Epoch: 8 cost time: 2.907700538635254
Epoch: 8, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
Validation loss decreased (-0.974929 --> -0.977019).  Saving model ...
Epoch: 9 cost time: 3.4122188091278076
Epoch: 9, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.071 Vali Acc: 0.981 Test Loss: 0.071 Test Acc: 0.981
Validation loss decreased (-0.977019 --> -0.981197).  Saving model ...
Epoch: 10 cost time: 3.91089129447937
Epoch: 10, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
Validation loss decreased (-0.981197 --> -0.983286).  Saving model ...
Epoch: 11 cost time: 3.9360342025756836
Epoch: 11, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.062 Vali Acc: 0.984 Test Loss: 0.062 Test Acc: 0.984
Validation loss decreased (-0.983286 --> -0.983983).  Saving model ...
Epoch: 12 cost time: 3.8458733558654785
Epoch: 12, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.094 Vali Acc: 0.981 Test Loss: 0.094 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.244007110595703
Epoch: 13, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.097 Vali Acc: 0.976 Test Loss: 0.097 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.715853214263916
Epoch: 14, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.065 Vali Acc: 0.981 Test Loss: 0.065 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.257394313812256
Epoch: 15, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.078 Vali Acc: 0.979 Test Loss: 0.078 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.9960741996765137
Epoch: 16, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.068 Vali Acc: 0.984 Test Loss: 0.068 Test Acc: 0.984
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.2845945358276367
Epoch: 17, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.072 Vali Acc: 0.982 Test Loss: 0.072 Test Acc: 0.982
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.8713927268981934
Epoch: 18, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.067 Vali Acc: 0.982 Test Loss: 0.067 Test Acc: 0.982
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.8837733268737793
Epoch: 19, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.062 Vali Acc: 0.984 Test Loss: 0.062 Test Acc: 0.984
Validation loss decreased (-0.983983 --> -0.983983).  Saving model ...
Epoch: 20 cost time: 3.5784270763397217
Epoch: 20, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.482292413711548
Epoch: 21, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.888033151626587
Epoch: 22, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.5306179523468018
Epoch: 23, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.8432843685150146
Epoch: 24, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.5711874961853027
Epoch: 25, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.124 Vali Acc: 0.969 Test Loss: 0.124 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 3.792440891265869
Epoch: 26, Steps: 89 | Train Loss: 0.113 Vali Loss: 0.250 Vali Acc: 0.948 Test Loss: 0.250 Test Acc: 0.948
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 3.4449872970581055
Epoch: 27, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.158 Vali Acc: 0.969 Test Loss: 0.158 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 3.135586977005005
Epoch: 28, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.131 Vali Acc: 0.975 Test Loss: 0.131 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 4.146343469619751
Epoch: 29, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.155 Vali Acc: 0.976 Test Loss: 0.155 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps28_str14_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.983983286908078
model parameter : 214676
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps37_str19_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.528383731842041
Epoch: 1, Steps: 89 | Train Loss: 1.844 Vali Loss: 0.778 Vali Acc: 0.830 Test Loss: 0.778 Test Acc: 0.830
Validation loss decreased (inf --> -0.830076).  Saving model ...
Epoch: 2 cost time: 3.1216652393341064
Epoch: 2, Steps: 89 | Train Loss: 0.502 Vali Loss: 0.336 Vali Acc: 0.921 Test Loss: 0.336 Test Acc: 0.921
Validation loss decreased (-0.830076 --> -0.920609).  Saving model ...
Epoch: 3 cost time: 3.7657387256622314
Epoch: 3, Steps: 89 | Train Loss: 0.224 Vali Loss: 0.204 Vali Acc: 0.953 Test Loss: 0.204 Test Acc: 0.953
Validation loss decreased (-0.920609 --> -0.953341).  Saving model ...
Epoch: 4 cost time: 3.5226478576660156
Epoch: 4, Steps: 89 | Train Loss: 0.128 Vali Loss: 0.139 Vali Acc: 0.967 Test Loss: 0.139 Test Acc: 0.967
Validation loss decreased (-0.953341 --> -0.966572).  Saving model ...
Epoch: 5 cost time: 3.2741196155548096
Epoch: 5, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
Validation loss decreased (-0.966572 --> -0.979804).  Saving model ...
Epoch: 6 cost time: 3.6614620685577393
Epoch: 6, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.092 Vali Acc: 0.978 Test Loss: 0.092 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.7805263996124268
Epoch: 7, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.092 Vali Acc: 0.975 Test Loss: 0.092 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.4063024520874023
Epoch: 8, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.102 Vali Acc: 0.974 Test Loss: 0.102 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.7736217975616455
Epoch: 9, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.075 Vali Acc: 0.980 Test Loss: 0.075 Test Acc: 0.980
Validation loss decreased (-0.979804 --> -0.979804).  Saving model ...
Epoch: 10 cost time: 2.839912176132202
Epoch: 10, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.979804 --> -0.982590).  Saving model ...
Epoch: 11 cost time: 4.039738416671753
Epoch: 11, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.071 Vali Acc: 0.981 Test Loss: 0.071 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.9113645553588867
Epoch: 12, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.076 Vali Acc: 0.985 Test Loss: 0.076 Test Acc: 0.985
Validation loss decreased (-0.982590 --> -0.984679).  Saving model ...
Epoch: 13 cost time: 3.493288278579712
Epoch: 13, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.082 Vali Acc: 0.981 Test Loss: 0.082 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.796598196029663
Epoch: 14, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.065 Vali Acc: 0.984 Test Loss: 0.065 Test Acc: 0.984
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.629255771636963
Epoch: 15, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.080 Vali Acc: 0.982 Test Loss: 0.080 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.7045392990112305
Epoch: 16, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.080 Vali Acc: 0.981 Test Loss: 0.080 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.545915126800537
Epoch: 17, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.128 Vali Acc: 0.975 Test Loss: 0.128 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.382408380508423
Epoch: 18, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.097 Vali Acc: 0.978 Test Loss: 0.097 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.446967601776123
Epoch: 19, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.100 Vali Acc: 0.976 Test Loss: 0.100 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.476491689682007
Epoch: 20, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.100 Vali Acc: 0.976 Test Loss: 0.100 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.4291961193084717
Epoch: 21, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.145 Vali Acc: 0.970 Test Loss: 0.145 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.44685697555542
Epoch: 22, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps37_str19_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9846796657381616
model parameter : 185108
model size : 0.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps46_str23_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.654127359390259
Epoch: 1, Steps: 89 | Train Loss: 1.942 Vali Loss: 0.925 Vali Acc: 0.801 Test Loss: 0.925 Test Acc: 0.801
Validation loss decreased (inf --> -0.800826).  Saving model ...
Epoch: 2 cost time: 3.857179641723633
Epoch: 2, Steps: 89 | Train Loss: 0.586 Vali Loss: 0.400 Vali Acc: 0.917 Test Loss: 0.400 Test Acc: 0.917
Validation loss decreased (-0.800826 --> -0.917127).  Saving model ...
Epoch: 3 cost time: 3.793818473815918
Epoch: 3, Steps: 89 | Train Loss: 0.265 Vali Loss: 0.219 Vali Acc: 0.949 Test Loss: 0.219 Test Acc: 0.949
Validation loss decreased (-0.917127 --> -0.949162).  Saving model ...
Epoch: 4 cost time: 3.796175241470337
Epoch: 4, Steps: 89 | Train Loss: 0.146 Vali Loss: 0.136 Vali Acc: 0.976 Test Loss: 0.136 Test Acc: 0.976
Validation loss decreased (-0.949162 --> -0.975625).  Saving model ...
Epoch: 5 cost time: 3.8396334648132324
Epoch: 5, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.114 Vali Acc: 0.974 Test Loss: 0.114 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.533238172531128
Epoch: 6, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
Validation loss decreased (-0.975625 --> -0.976322).  Saving model ...
Epoch: 7 cost time: 3.6727182865142822
Epoch: 7, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.976322 --> -0.983286).  Saving model ...
Epoch: 8 cost time: 3.684795379638672
Epoch: 8, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.070 Vali Acc: 0.984 Test Loss: 0.070 Test Acc: 0.984
Validation loss decreased (-0.983286 --> -0.983983).  Saving model ...
Epoch: 9 cost time: 3.6846485137939453
Epoch: 9, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.545513153076172
Epoch: 10, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.069 Vali Acc: 0.981 Test Loss: 0.069 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.319492340087891
Epoch: 11, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.069 Vali Acc: 0.987 Test Loss: 0.069 Test Acc: 0.987
Validation loss decreased (-0.983983 --> -0.986768).  Saving model ...
Epoch: 12 cost time: 4.21416974067688
Epoch: 12, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.058 Vali Acc: 0.987 Test Loss: 0.058 Test Acc: 0.987
Validation loss decreased (-0.986768 --> -0.987465).  Saving model ...
Epoch: 13 cost time: 4.661734104156494
Epoch: 13, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.092 Vali Acc: 0.981 Test Loss: 0.092 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.685426712036133
Epoch: 14, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.067 Vali Acc: 0.983 Test Loss: 0.067 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.381869077682495
Epoch: 15, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.866750717163086
Epoch: 16, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.144 Vali Acc: 0.967 Test Loss: 0.144 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.628319263458252
Epoch: 17, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.072 Vali Acc: 0.980 Test Loss: 0.072 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.432888984680176
Epoch: 18, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.064 Vali Acc: 0.981 Test Loss: 0.064 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.0008485317230225
Epoch: 19, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.566216230392456
Epoch: 20, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 4.4966654777526855
Epoch: 21, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 4.072953939437866
Epoch: 22, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.098 Vali Acc: 0.974 Test Loss: 0.098 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim128_nb1_lk13_sk5_ffr1_ps46_str23_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9874651810584958
model parameter : 170900
model size : 0.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.114621162414551
Epoch: 1, Steps: 89 | Train Loss: 1.250 Vali Loss: 0.364 Vali Acc: 0.916 Test Loss: 0.364 Test Acc: 0.916
Validation loss decreased (inf --> -0.916431).  Saving model ...
Epoch: 2 cost time: 3.7209107875823975
Epoch: 2, Steps: 89 | Train Loss: 0.242 Vali Loss: 0.183 Vali Acc: 0.960 Test Loss: 0.183 Test Acc: 0.960
Validation loss decreased (-0.916431 --> -0.959608).  Saving model ...
Epoch: 3 cost time: 3.4982657432556152
Epoch: 3, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.138 Vali Acc: 0.958 Test Loss: 0.138 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.0084619522094727
Epoch: 4, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.136 Vali Acc: 0.966 Test Loss: 0.136 Test Acc: 0.966
Validation loss decreased (-0.959608 --> -0.965876).  Saving model ...
Epoch: 5 cost time: 3.105983018875122
Epoch: 5, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.110 Vali Acc: 0.972 Test Loss: 0.110 Test Acc: 0.972
Validation loss decreased (-0.965876 --> -0.972144).  Saving model ...
Epoch: 6 cost time: 3.3714194297790527
Epoch: 6, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.133 Vali Acc: 0.974 Test Loss: 0.133 Test Acc: 0.974
Validation loss decreased (-0.972144 --> -0.973536).  Saving model ...
Epoch: 7 cost time: 3.463249921798706
Epoch: 7, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.180 Vali Acc: 0.962 Test Loss: 0.180 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.8638036251068115
Epoch: 8, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.128 Vali Acc: 0.979 Test Loss: 0.128 Test Acc: 0.979
Validation loss decreased (-0.973536 --> -0.979107).  Saving model ...
Epoch: 9 cost time: 3.2643184661865234
Epoch: 9, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.161 Vali Acc: 0.971 Test Loss: 0.161 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.259927988052368
Epoch: 10, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.165 Vali Acc: 0.975 Test Loss: 0.165 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.5143001079559326
Epoch: 11, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.168 Vali Acc: 0.974 Test Loss: 0.168 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.4761877059936523
Epoch: 12, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.157 Vali Acc: 0.974 Test Loss: 0.157 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.07640266418457
Epoch: 13, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.270 Vali Acc: 0.944 Test Loss: 0.270 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.47762393951416
Epoch: 14, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.275 Vali Acc: 0.961 Test Loss: 0.275 Test Acc: 0.961
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.736281394958496
Epoch: 15, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.217 Vali Acc: 0.974 Test Loss: 0.217 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.7087485790252686
Epoch: 16, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.213 Vali Acc: 0.969 Test Loss: 0.213 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.701448440551758
Epoch: 17, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.197 Vali Acc: 0.976 Test Loss: 0.197 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.6204330921173096
Epoch: 18, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.208 Vali Acc: 0.971 Test Loss: 0.208 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.979108635097493
model parameter : 261780
model size : 1.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.683606863021851
Epoch: 1, Steps: 89 | Train Loss: 1.494 Vali Loss: 0.566 Vali Acc: 0.849 Test Loss: 0.566 Test Acc: 0.849
Validation loss decreased (inf --> -0.848880).  Saving model ...
Epoch: 2 cost time: 2.5142853260040283
Epoch: 2, Steps: 89 | Train Loss: 0.356 Vali Loss: 0.233 Vali Acc: 0.950 Test Loss: 0.233 Test Acc: 0.950
Validation loss decreased (-0.848880 --> -0.949858).  Saving model ...
Epoch: 3 cost time: 3.5015482902526855
Epoch: 3, Steps: 89 | Train Loss: 0.149 Vali Loss: 0.152 Vali Acc: 0.964 Test Loss: 0.152 Test Acc: 0.964
Validation loss decreased (-0.949858 --> -0.963787).  Saving model ...
Epoch: 4 cost time: 3.2924509048461914
Epoch: 4, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.125 Vali Acc: 0.969 Test Loss: 0.125 Test Acc: 0.969
Validation loss decreased (-0.963787 --> -0.969358).  Saving model ...
Epoch: 5 cost time: 3.284135341644287
Epoch: 5, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.127 Vali Acc: 0.971 Test Loss: 0.127 Test Acc: 0.971
Validation loss decreased (-0.969358 --> -0.970751).  Saving model ...
Epoch: 6 cost time: 3.119450092315674
Epoch: 6, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
Validation loss decreased (-0.970751 --> -0.972840).  Saving model ...
Epoch: 7 cost time: 2.9607512950897217
Epoch: 7, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.953751564025879
Epoch: 8, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.115 Vali Acc: 0.969 Test Loss: 0.115 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.1091060638427734
Epoch: 9, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.090 Vali Acc: 0.983 Test Loss: 0.090 Test Acc: 0.983
Validation loss decreased (-0.972840 --> -0.983286).  Saving model ...
Epoch: 10 cost time: 2.869201898574829
Epoch: 10, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.099 Vali Acc: 0.978 Test Loss: 0.099 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.2959749698638916
Epoch: 11, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.124 Vali Acc: 0.976 Test Loss: 0.124 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.6717591285705566
Epoch: 12, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.117 Vali Acc: 0.979 Test Loss: 0.117 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.1904056072235107
Epoch: 13, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.145 Vali Acc: 0.978 Test Loss: 0.145 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.273616313934326
Epoch: 14, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.145 Vali Acc: 0.969 Test Loss: 0.145 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.959890365600586
Epoch: 15, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.152 Vali Acc: 0.968 Test Loss: 0.152 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.95676851272583
Epoch: 16, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.160 Vali Acc: 0.967 Test Loss: 0.160 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.1966071128845215
Epoch: 17, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.093 Vali Acc: 0.981 Test Loss: 0.093 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.999232769012451
Epoch: 18, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.108 Vali Acc: 0.981 Test Loss: 0.108 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.5439364910125732
Epoch: 19, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9832869080779945
model parameter : 169940
model size : 0.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps14_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.817226409912109
Epoch: 1, Steps: 89 | Train Loss: 1.654 Vali Loss: 0.652 Vali Acc: 0.861 Test Loss: 0.652 Test Acc: 0.861
Validation loss decreased (inf --> -0.861414).  Saving model ...
Epoch: 2 cost time: 3.3075735569000244
Epoch: 2, Steps: 89 | Train Loss: 0.421 Vali Loss: 0.300 Vali Acc: 0.937 Test Loss: 0.300 Test Acc: 0.937
Validation loss decreased (-0.861414 --> -0.937323).  Saving model ...
Epoch: 3 cost time: 3.44167160987854
Epoch: 3, Steps: 89 | Train Loss: 0.192 Vali Loss: 0.195 Vali Acc: 0.953 Test Loss: 0.195 Test Acc: 0.953
Validation loss decreased (-0.937323 --> -0.952644).  Saving model ...
Epoch: 4 cost time: 3.403212547302246
Epoch: 4, Steps: 89 | Train Loss: 0.121 Vali Loss: 0.155 Vali Acc: 0.960 Test Loss: 0.155 Test Acc: 0.960
Validation loss decreased (-0.952644 --> -0.960305).  Saving model ...
Epoch: 5 cost time: 3.362492084503174
Epoch: 5, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.116 Vali Acc: 0.974 Test Loss: 0.116 Test Acc: 0.974
Validation loss decreased (-0.960305 --> -0.973536).  Saving model ...
Epoch: 6 cost time: 2.9937329292297363
Epoch: 6, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.113 Vali Acc: 0.974 Test Loss: 0.113 Test Acc: 0.974
Validation loss decreased (-0.973536 --> -0.973536).  Saving model ...
Epoch: 7 cost time: 2.5419728755950928
Epoch: 7, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.084 Vali Acc: 0.981 Test Loss: 0.084 Test Acc: 0.981
Validation loss decreased (-0.973536 --> -0.980501).  Saving model ...
Epoch: 8 cost time: 3.115506172180176
Epoch: 8, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.100 Vali Acc: 0.975 Test Loss: 0.100 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.8555548191070557
Epoch: 9, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.677968978881836
Epoch: 10, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.090 Vali Acc: 0.978 Test Loss: 0.090 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.098999261856079
Epoch: 11, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.084 Vali Acc: 0.979 Test Loss: 0.084 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.6805965900421143
Epoch: 12, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.107 Vali Acc: 0.978 Test Loss: 0.107 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.4819929599761963
Epoch: 13, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.098 Vali Acc: 0.976 Test Loss: 0.098 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.359149217605591
Epoch: 14, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.138 Vali Acc: 0.964 Test Loss: 0.138 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.3933544158935547
Epoch: 15, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.128 Vali Acc: 0.971 Test Loss: 0.128 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.7056713104248047
Epoch: 16, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.100 Vali Acc: 0.981 Test Loss: 0.100 Test Acc: 0.981
Validation loss decreased (-0.980501 --> -0.981197).  Saving model ...
Epoch: 17 cost time: 3.5608768463134766
Epoch: 17, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
Validation loss decreased (-0.981197 --> -0.982590).  Saving model ...
Epoch: 18 cost time: 3.4801411628723145
Epoch: 18, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.092 Vali Acc: 0.982 Test Loss: 0.092 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.424043655395508
Epoch: 19, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.098 Vali Acc: 0.976 Test Loss: 0.098 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.533066749572754
Epoch: 20, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.086 Vali Acc: 0.983 Test Loss: 0.086 Test Acc: 0.983
Validation loss decreased (-0.982590 --> -0.983286).  Saving model ...
Epoch: 21 cost time: 3.4823532104492188
Epoch: 21, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.984 Test Loss: 0.082 Test Acc: 0.984
Validation loss decreased (-0.983286 --> -0.983982).  Saving model ...
Epoch: 22 cost time: 3.4811530113220215
Epoch: 22, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.984 Test Loss: 0.081 Test Acc: 0.984
Validation loss decreased (-0.983982 --> -0.983982).  Saving model ...
Epoch: 23 cost time: 3.6687047481536865
Epoch: 23, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.986 Test Loss: 0.078 Test Acc: 0.986
Validation loss decreased (-0.983982 --> -0.986072).  Saving model ...
Epoch: 24 cost time: 2.8737683296203613
Epoch: 24, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.986 Test Loss: 0.079 Test Acc: 0.986
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.1721150875091553
Epoch: 25, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.080 Vali Acc: 0.986 Test Loss: 0.080 Test Acc: 0.986
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.615173101425171
Epoch: 26, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.987 Test Loss: 0.082 Test Acc: 0.987
Validation loss decreased (-0.986072 --> -0.987464).  Saving model ...
Epoch: 27 cost time: 3.5655691623687744
Epoch: 27, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.985 Test Loss: 0.083 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.4964704513549805
Epoch: 28, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.985 Test Loss: 0.080 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.2022643089294434
Epoch: 29, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.985 Test Loss: 0.080 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.5610387325286865
Epoch: 30, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.985 Test Loss: 0.077 Test Acc: 0.985
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 3.05041241645813
Epoch: 31, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.985 Test Loss: 0.081 Test Acc: 0.985
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 3.3508520126342773
Epoch: 32, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 3.659262180328369
Epoch: 33, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.149 Vali Acc: 0.969 Test Loss: 0.149 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 2.92490553855896
Epoch: 34, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.261 Vali Acc: 0.942 Test Loss: 0.261 Test Acc: 0.942
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 3.5174527168273926
Epoch: 35, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.157 Vali Acc: 0.971 Test Loss: 0.157 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 3.836909294128418
Epoch: 36, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.290 Vali Acc: 0.961 Test Loss: 0.290 Test Acc: 0.961
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps14_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9874651810584958
model parameter : 131796
model size : 0.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps19_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.133699417114258
Epoch: 1, Steps: 89 | Train Loss: 1.834 Vali Loss: 0.823 Vali Acc: 0.808 Test Loss: 0.823 Test Acc: 0.808
Validation loss decreased (inf --> -0.807791).  Saving model ...
Epoch: 2 cost time: 3.391542911529541
Epoch: 2, Steps: 89 | Train Loss: 0.512 Vali Loss: 0.373 Vali Acc: 0.908 Test Loss: 0.373 Test Acc: 0.908
Validation loss decreased (-0.807791 --> -0.908074).  Saving model ...
Epoch: 3 cost time: 3.2115235328674316
Epoch: 3, Steps: 89 | Train Loss: 0.234 Vali Loss: 0.192 Vali Acc: 0.959 Test Loss: 0.192 Test Acc: 0.959
Validation loss decreased (-0.908074 --> -0.958912).  Saving model ...
Epoch: 4 cost time: 3.3302273750305176
Epoch: 4, Steps: 89 | Train Loss: 0.127 Vali Loss: 0.148 Vali Acc: 0.961 Test Loss: 0.148 Test Acc: 0.961
Validation loss decreased (-0.958912 --> -0.961001).  Saving model ...
Epoch: 5 cost time: 2.530533790588379
Epoch: 5, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
Validation loss decreased (-0.961001 --> -0.977018).  Saving model ...
Epoch: 6 cost time: 3.0711512565612793
Epoch: 6, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.097 Vali Acc: 0.981 Test Loss: 0.097 Test Acc: 0.981
Validation loss decreased (-0.977018 --> -0.980500).  Saving model ...
Epoch: 7 cost time: 3.464667320251465
Epoch: 7, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.076 Vali Acc: 0.978 Test Loss: 0.076 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.8509252071380615
Epoch: 8, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
Validation loss decreased (-0.980500 --> -0.982590).  Saving model ...
Epoch: 9 cost time: 3.327852725982666
Epoch: 9, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.078 Vali Acc: 0.981 Test Loss: 0.078 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.3574836254119873
Epoch: 10, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.9033052921295166
Epoch: 11, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.070 Vali Acc: 0.982 Test Loss: 0.070 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.443450927734375
Epoch: 12, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.096 Vali Acc: 0.978 Test Loss: 0.096 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.0256693363189697
Epoch: 13, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.081 Vali Acc: 0.978 Test Loss: 0.081 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.699256658554077
Epoch: 14, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.087 Vali Acc: 0.981 Test Loss: 0.087 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.607424736022949
Epoch: 15, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.079 Vali Acc: 0.981 Test Loss: 0.079 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.894693613052368
Epoch: 16, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.070 Vali Acc: 0.984 Test Loss: 0.070 Test Acc: 0.984
Validation loss decreased (-0.982590 --> -0.983983).  Saving model ...
Epoch: 17 cost time: 3.241208791732788
Epoch: 17, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.4952633380889893
Epoch: 18, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.066 Vali Acc: 0.985 Test Loss: 0.066 Test Acc: 0.985
Validation loss decreased (-0.983983 --> -0.984679).  Saving model ...
Epoch: 19 cost time: 3.186666250228882
Epoch: 19, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.3805041313171387
Epoch: 20, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.069 Vali Acc: 0.983 Test Loss: 0.069 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.538825273513794
Epoch: 21, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.069 Vali Acc: 0.985 Test Loss: 0.069 Test Acc: 0.985
Validation loss decreased (-0.984679 --> -0.985375).  Saving model ...
Epoch: 22 cost time: 2.9761903285980225
Epoch: 22, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.099 Vali Acc: 0.976 Test Loss: 0.099 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.3524575233459473
Epoch: 23, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.101 Vali Acc: 0.978 Test Loss: 0.101 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.68967866897583
Epoch: 24, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.165 Vali Acc: 0.964 Test Loss: 0.165 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.5064802169799805
Epoch: 25, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.136 Vali Acc: 0.971 Test Loss: 0.136 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.2869069576263428
Epoch: 26, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.115 Vali Acc: 0.979 Test Loss: 0.115 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.153179407119751
Epoch: 27, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.094 Vali Acc: 0.983 Test Loss: 0.094 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.977102041244507
Epoch: 28, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.092 Vali Acc: 0.983 Test Loss: 0.092 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 3.3382036685943604
Epoch: 29, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.983 Test Loss: 0.096 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 3.23710298538208
Epoch: 30, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.176 Vali Acc: 0.963 Test Loss: 0.176 Test Acc: 0.963
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 3.035301685333252
Epoch: 31, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.118 Vali Acc: 0.973 Test Loss: 0.118 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps19_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9853760445682451
model parameter : 101396
model size : 0.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps28_str14_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.954752683639526
Epoch: 1, Steps: 89 | Train Loss: 2.093 Vali Loss: 1.031 Vali Acc: 0.796 Test Loss: 1.031 Test Acc: 0.796
Validation loss decreased (inf --> -0.795951).  Saving model ...
Epoch: 2 cost time: 2.678148031234741
Epoch: 2, Steps: 89 | Train Loss: 0.652 Vali Loss: 0.442 Vali Acc: 0.906 Test Loss: 0.442 Test Acc: 0.906
Validation loss decreased (-0.795951 --> -0.905984).  Saving model ...
Epoch: 3 cost time: 2.8902790546417236
Epoch: 3, Steps: 89 | Train Loss: 0.314 Vali Loss: 0.251 Vali Acc: 0.947 Test Loss: 0.251 Test Acc: 0.947
Validation loss decreased (-0.905984 --> -0.947073).  Saving model ...
Epoch: 4 cost time: 3.367833375930786
Epoch: 4, Steps: 89 | Train Loss: 0.170 Vali Loss: 0.202 Vali Acc: 0.940 Test Loss: 0.202 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.2359182834625244
Epoch: 5, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.152 Vali Acc: 0.955 Test Loss: 0.152 Test Acc: 0.955
Validation loss decreased (-0.947073 --> -0.954734).  Saving model ...
Epoch: 6 cost time: 3.0288217067718506
Epoch: 6, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.103 Vali Acc: 0.976 Test Loss: 0.103 Test Acc: 0.976
Validation loss decreased (-0.954734 --> -0.976322).  Saving model ...
Epoch: 7 cost time: 3.3980867862701416
Epoch: 7, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.089 Vali Acc: 0.973 Test Loss: 0.089 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.1593434810638428
Epoch: 8, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.976322 --> -0.977019).  Saving model ...
Epoch: 9 cost time: 3.3043596744537354
Epoch: 9, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.078 Vali Acc: 0.978 Test Loss: 0.078 Test Acc: 0.978
Validation loss decreased (-0.977019 --> -0.978411).  Saving model ...
Epoch: 10 cost time: 2.8088483810424805
Epoch: 10, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.076 Vali Acc: 0.982 Test Loss: 0.076 Test Acc: 0.982
Validation loss decreased (-0.978411 --> -0.981893).  Saving model ...
Epoch: 11 cost time: 2.6909055709838867
Epoch: 11, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.066 Vali Acc: 0.982 Test Loss: 0.066 Test Acc: 0.982
Validation loss decreased (-0.981893 --> -0.981893).  Saving model ...
Epoch: 12 cost time: 3.178759813308716
Epoch: 12, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.079 Vali Acc: 0.976 Test Loss: 0.079 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.220801591873169
Epoch: 13, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.083 Vali Acc: 0.976 Test Loss: 0.083 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.0442330837249756
Epoch: 14, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.075 Vali Acc: 0.982 Test Loss: 0.075 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.2880570888519287
Epoch: 15, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.105 Vali Acc: 0.969 Test Loss: 0.105 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.8121767044067383
Epoch: 16, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.3005292415618896
Epoch: 17, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.082 Vali Acc: 0.981 Test Loss: 0.082 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.487574338912964
Epoch: 18, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.085 Vali Acc: 0.981 Test Loss: 0.085 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.868360757827759
Epoch: 19, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.981893 --> -0.983286).  Saving model ...
Epoch: 20 cost time: 2.6249680519104004
Epoch: 20, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.068 Vali Acc: 0.985 Test Loss: 0.068 Test Acc: 0.985
Validation loss decreased (-0.983286 --> -0.984679).  Saving model ...
Epoch: 21 cost time: 2.999004364013672
Epoch: 21, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.071 Vali Acc: 0.981 Test Loss: 0.071 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.658665418624878
Epoch: 22, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.919919013977051
Epoch: 23, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.076 Vali Acc: 0.978 Test Loss: 0.076 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.635579824447632
Epoch: 24, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.083 Vali Acc: 0.982 Test Loss: 0.083 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.1960251331329346
Epoch: 25, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.081 Vali Acc: 0.978 Test Loss: 0.081 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.1850616931915283
Epoch: 26, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.0397679805755615
Epoch: 27, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.071 Vali Acc: 0.985 Test Loss: 0.071 Test Acc: 0.985
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 3.71502947807312
Epoch: 28, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 3.595351219177246
Epoch: 29, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 3.3877251148223877
Epoch: 30, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.984 Test Loss: 0.069 Test Acc: 0.984
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps28_str14_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9846796657381616
model parameter : 82772
model size : 0.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps37_str19_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.962506055831909
Epoch: 1, Steps: 89 | Train Loss: 2.286 Vali Loss: 1.351 Vali Acc: 0.735 Test Loss: 1.351 Test Acc: 0.735
Validation loss decreased (inf --> -0.734666).  Saving model ...
Epoch: 2 cost time: 2.741791248321533
Epoch: 2, Steps: 89 | Train Loss: 0.867 Vali Loss: 0.574 Vali Acc: 0.878 Test Loss: 0.574 Test Acc: 0.878
Validation loss decreased (-0.734666 --> -0.878128).  Saving model ...
Epoch: 3 cost time: 2.625715732574463
Epoch: 3, Steps: 89 | Train Loss: 0.420 Vali Loss: 0.326 Vali Acc: 0.922 Test Loss: 0.326 Test Acc: 0.922
Validation loss decreased (-0.878128 --> -0.922002).  Saving model ...
Epoch: 4 cost time: 3.5584733486175537
Epoch: 4, Steps: 89 | Train Loss: 0.239 Vali Loss: 0.221 Vali Acc: 0.948 Test Loss: 0.221 Test Acc: 0.948
Validation loss decreased (-0.922002 --> -0.948466).  Saving model ...
Epoch: 5 cost time: 3.617354393005371
Epoch: 5, Steps: 89 | Train Loss: 0.153 Vali Loss: 0.153 Vali Acc: 0.958 Test Loss: 0.153 Test Acc: 0.958
Validation loss decreased (-0.948466 --> -0.957519).  Saving model ...
Epoch: 6 cost time: 3.2886202335357666
Epoch: 6, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.120 Vali Acc: 0.975 Test Loss: 0.120 Test Acc: 0.975
Validation loss decreased (-0.957519 --> -0.974929).  Saving model ...
Epoch: 7 cost time: 3.3427486419677734
Epoch: 7, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.098 Vali Acc: 0.975 Test Loss: 0.098 Test Acc: 0.975
Validation loss decreased (-0.974929 --> -0.974929).  Saving model ...
Epoch: 8 cost time: 3.4475018978118896
Epoch: 8, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.096 Vali Acc: 0.975 Test Loss: 0.096 Test Acc: 0.975
Validation loss decreased (-0.974929 --> -0.974929).  Saving model ...
Epoch: 9 cost time: 3.0179576873779297
Epoch: 9, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.084 Vali Acc: 0.978 Test Loss: 0.084 Test Acc: 0.978
Validation loss decreased (-0.974929 --> -0.978411).  Saving model ...
Epoch: 10 cost time: 2.8237531185150146
Epoch: 10, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.978411 --> -0.983286).  Saving model ...
Epoch: 11 cost time: 2.9333908557891846
Epoch: 11, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.082 Vali Acc: 0.976 Test Loss: 0.082 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.292418956756592
Epoch: 12, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.5513854026794434
Epoch: 13, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.073 Vali Acc: 0.982 Test Loss: 0.073 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.21040940284729
Epoch: 14, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.068 Vali Acc: 0.985 Test Loss: 0.068 Test Acc: 0.985
Validation loss decreased (-0.983286 --> -0.985375).  Saving model ...
Epoch: 15 cost time: 3.3995132446289062
Epoch: 15, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.070 Vali Acc: 0.986 Test Loss: 0.070 Test Acc: 0.986
Validation loss decreased (-0.985375 --> -0.986072).  Saving model ...
Epoch: 16 cost time: 2.9599063396453857
Epoch: 16, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.112504005432129
Epoch: 17, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.069 Vali Acc: 0.984 Test Loss: 0.069 Test Acc: 0.984
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.126880168914795
Epoch: 18, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.9873852729797363
Epoch: 19, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.071 Vali Acc: 0.984 Test Loss: 0.071 Test Acc: 0.984
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.2058560848236084
Epoch: 20, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.071 Vali Acc: 0.981 Test Loss: 0.071 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.0040640830993652
Epoch: 21, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.069 Vali Acc: 0.985 Test Loss: 0.069 Test Acc: 0.985
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.1818149089813232
Epoch: 22, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.073 Vali Acc: 0.982 Test Loss: 0.073 Test Acc: 0.982
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.5434398651123047
Epoch: 23, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 3.1962218284606934
Epoch: 24, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.082 Vali Acc: 0.982 Test Loss: 0.082 Test Acc: 0.982
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 3.2506043910980225
Epoch: 25, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.066 Vali Acc: 0.984 Test Loss: 0.066 Test Acc: 0.984
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps37_str19_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9860724233983287
model parameter : 67988
model size : 0.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps46_str23_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.928750991821289
Epoch: 1, Steps: 89 | Train Loss: 2.416 Vali Loss: 1.472 Vali Acc: 0.776 Test Loss: 1.472 Test Acc: 0.776
Validation loss decreased (inf --> -0.775751).  Saving model ...
Epoch: 2 cost time: 2.9440741539001465
Epoch: 2, Steps: 89 | Train Loss: 0.952 Vali Loss: 0.623 Vali Acc: 0.870 Test Loss: 0.623 Test Acc: 0.870
Validation loss decreased (-0.775751 --> -0.870467).  Saving model ...
Epoch: 3 cost time: 2.7587509155273438
Epoch: 3, Steps: 89 | Train Loss: 0.457 Vali Loss: 0.369 Vali Acc: 0.915 Test Loss: 0.369 Test Acc: 0.915
Validation loss decreased (-0.870467 --> -0.915038).  Saving model ...
Epoch: 4 cost time: 3.0865416526794434
Epoch: 4, Steps: 89 | Train Loss: 0.271 Vali Loss: 0.252 Vali Acc: 0.941 Test Loss: 0.252 Test Acc: 0.941
Validation loss decreased (-0.915038 --> -0.940805).  Saving model ...
Epoch: 5 cost time: 3.0045034885406494
Epoch: 5, Steps: 89 | Train Loss: 0.177 Vali Loss: 0.161 Vali Acc: 0.965 Test Loss: 0.161 Test Acc: 0.965
Validation loss decreased (-0.940805 --> -0.965179).  Saving model ...
Epoch: 6 cost time: 3.277941942214966
Epoch: 6, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.126 Vali Acc: 0.967 Test Loss: 0.126 Test Acc: 0.967
Validation loss decreased (-0.965179 --> -0.966573).  Saving model ...
Epoch: 7 cost time: 3.068845510482788
Epoch: 7, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.117 Vali Acc: 0.974 Test Loss: 0.117 Test Acc: 0.974
Validation loss decreased (-0.966573 --> -0.974233).  Saving model ...
Epoch: 8 cost time: 3.0801384449005127
Epoch: 8, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.092 Vali Acc: 0.979 Test Loss: 0.092 Test Acc: 0.979
Validation loss decreased (-0.974233 --> -0.979108).  Saving model ...
Epoch: 9 cost time: 3.1010069847106934
Epoch: 9, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.080 Vali Acc: 0.978 Test Loss: 0.080 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.4664106369018555
Epoch: 10, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.078 Vali Acc: 0.980 Test Loss: 0.078 Test Acc: 0.980
Validation loss decreased (-0.979108 --> -0.979804).  Saving model ...
Epoch: 11 cost time: 2.7106781005859375
Epoch: 11, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.8922653198242188
Epoch: 12, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.076 Vali Acc: 0.984 Test Loss: 0.076 Test Acc: 0.984
Validation loss decreased (-0.979804 --> -0.983983).  Saving model ...
Epoch: 13 cost time: 3.546520233154297
Epoch: 13, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.070 Vali Acc: 0.982 Test Loss: 0.070 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.3567006587982178
Epoch: 14, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.070 Vali Acc: 0.985 Test Loss: 0.070 Test Acc: 0.985
Validation loss decreased (-0.983983 --> -0.984679).  Saving model ...
Epoch: 15 cost time: 3.0535929203033447
Epoch: 15, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.1817009449005127
Epoch: 16, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.086 Vali Acc: 0.974 Test Loss: 0.086 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.0637454986572266
Epoch: 17, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.071 Vali Acc: 0.985 Test Loss: 0.071 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.067098379135132
Epoch: 18, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.078 Vali Acc: 0.981 Test Loss: 0.078 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.0507664680480957
Epoch: 19, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.1686947345733643
Epoch: 20, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.063 Vali Acc: 0.985 Test Loss: 0.063 Test Acc: 0.985
Validation loss decreased (-0.984679 --> -0.984679).  Saving model ...
Epoch: 21 cost time: 3.104426622390747
Epoch: 21, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.063 Vali Acc: 0.985 Test Loss: 0.063 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.784851312637329
Epoch: 22, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.067 Vali Acc: 0.988 Test Loss: 0.067 Test Acc: 0.988
Validation loss decreased (-0.984679 --> -0.988161).  Saving model ...
Epoch: 23 cost time: 3.3102636337280273
Epoch: 23, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.070 Vali Acc: 0.982 Test Loss: 0.070 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.3153419494628906
Epoch: 24, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.093827962875366
Epoch: 25, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.086 Vali Acc: 0.981 Test Loss: 0.086 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.779550075531006
Epoch: 26, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.059 Vali Acc: 0.988 Test Loss: 0.059 Test Acc: 0.988
Validation loss decreased (-0.988161 --> -0.988161).  Saving model ...
Epoch: 27 cost time: 3.0323400497436523
Epoch: 27, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.121258497238159
Epoch: 28, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.065 Vali Acc: 0.983 Test Loss: 0.065 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.8364620208740234
Epoch: 29, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.068 Vali Acc: 0.983 Test Loss: 0.068 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.2819809913635254
Epoch: 30, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.061 Vali Acc: 0.987 Test Loss: 0.061 Test Acc: 0.987
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 2.8578248023986816
Epoch: 31, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.058 Vali Acc: 0.989 Test Loss: 0.058 Test Acc: 0.989
Validation loss decreased (-0.988161 --> -0.988857).  Saving model ...
Epoch: 32 cost time: 3.1734304428100586
Epoch: 32, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.067 Vali Acc: 0.984 Test Loss: 0.067 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.1142160892486572
Epoch: 33, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.068 Vali Acc: 0.985 Test Loss: 0.068 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 2.7765471935272217
Epoch: 34, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 2.7464864253997803
Epoch: 35, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.066 Vali Acc: 0.986 Test Loss: 0.066 Test Acc: 0.986
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 2.874401330947876
Epoch: 36, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.064 Vali Acc: 0.985 Test Loss: 0.064 Test Acc: 0.985
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 3.1218087673187256
Epoch: 37, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.069 Vali Acc: 0.986 Test Loss: 0.069 Test Acc: 0.986
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 3.015300750732422
Epoch: 38, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.080 Vali Acc: 0.985 Test Loss: 0.080 Test Acc: 0.985
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 3.11957049369812
Epoch: 39, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.168 Vali Acc: 0.968 Test Loss: 0.168 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 3.913137435913086
Epoch: 40, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.077 Vali Acc: 0.985 Test Loss: 0.077 Test Acc: 0.985
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 3.6196601390838623
Epoch: 41, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim64_nb1_lk13_sk5_ffr1_ps46_str23_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9888579387186629
model parameter : 60884
model size : 0.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.903435468673706
Epoch: 1, Steps: 89 | Train Loss: 1.627 Vali Loss: 0.569 Vali Acc: 0.867 Test Loss: 0.569 Test Acc: 0.867
Validation loss decreased (inf --> -0.866986).  Saving model ...
Epoch: 2 cost time: 3.7072982788085938
Epoch: 2, Steps: 89 | Train Loss: 0.358 Vali Loss: 0.265 Vali Acc: 0.942 Test Loss: 0.265 Test Acc: 0.942
Validation loss decreased (-0.866986 --> -0.942198).  Saving model ...
Epoch: 3 cost time: 2.8262341022491455
Epoch: 3, Steps: 89 | Train Loss: 0.181 Vali Loss: 0.192 Vali Acc: 0.955 Test Loss: 0.192 Test Acc: 0.955
Validation loss decreased (-0.942198 --> -0.954733).  Saving model ...
Epoch: 4 cost time: 2.8624205589294434
Epoch: 4, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.148 Vali Acc: 0.962 Test Loss: 0.148 Test Acc: 0.962
Validation loss decreased (-0.954733 --> -0.962394).  Saving model ...
Epoch: 5 cost time: 3.059204578399658
Epoch: 5, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.134 Vali Acc: 0.960 Test Loss: 0.134 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.382984161376953
Epoch: 6, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.115 Vali Acc: 0.972 Test Loss: 0.115 Test Acc: 0.972
Validation loss decreased (-0.962394 --> -0.972144).  Saving model ...
Epoch: 7 cost time: 3.3184497356414795
Epoch: 7, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.131 Vali Acc: 0.968 Test Loss: 0.131 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.407443046569824
Epoch: 8, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.120 Vali Acc: 0.971 Test Loss: 0.120 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.1600515842437744
Epoch: 9, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.156 Vali Acc: 0.948 Test Loss: 0.156 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.493619918823242
Epoch: 10, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.105 Vali Acc: 0.976 Test Loss: 0.105 Test Acc: 0.976
Validation loss decreased (-0.972144 --> -0.976322).  Saving model ...
Epoch: 11 cost time: 3.250443935394287
Epoch: 11, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.110 Vali Acc: 0.976 Test Loss: 0.110 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.3212287425994873
Epoch: 12, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.165 Vali Acc: 0.965 Test Loss: 0.165 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.171221971511841
Epoch: 13, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
Validation loss decreased (-0.976322 --> -0.977018).  Saving model ...
Epoch: 14 cost time: 3.0243239402770996
Epoch: 14, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.136 Vali Acc: 0.966 Test Loss: 0.136 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.560554265975952
Epoch: 15, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.115 Vali Acc: 0.974 Test Loss: 0.115 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.541620969772339
Epoch: 16, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.127 Vali Acc: 0.975 Test Loss: 0.127 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.72121000289917
Epoch: 17, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.118 Vali Acc: 0.978 Test Loss: 0.118 Test Acc: 0.978
Validation loss decreased (-0.977018 --> -0.978411).  Saving model ...
Epoch: 18 cost time: 2.775324583053589
Epoch: 18, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.107 Vali Acc: 0.981 Test Loss: 0.107 Test Acc: 0.981
Validation loss decreased (-0.978411 --> -0.980500).  Saving model ...
Epoch: 19 cost time: 3.2431247234344482
Epoch: 19, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.146 Vali Acc: 0.976 Test Loss: 0.146 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.963242769241333
Epoch: 20, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.134 Vali Acc: 0.975 Test Loss: 0.134 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.991513967514038
Epoch: 21, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.123 Vali Acc: 0.980 Test Loss: 0.123 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.6861424446105957
Epoch: 22, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.150 Vali Acc: 0.971 Test Loss: 0.150 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.3461217880249023
Epoch: 23, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.129 Vali Acc: 0.978 Test Loss: 0.129 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.050499677658081
Epoch: 24, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.123 Vali Acc: 0.976 Test Loss: 0.123 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.278137445449829
Epoch: 25, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.123 Vali Acc: 0.977 Test Loss: 0.123 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 3.1476099491119385
Epoch: 26, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.130 Vali Acc: 0.981 Test Loss: 0.130 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 3.0486855506896973
Epoch: 27, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.131 Vali Acc: 0.978 Test Loss: 0.131 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 3.0968260765075684
Epoch: 28, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.126 Vali Acc: 0.980 Test Loss: 0.126 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps5_str3_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9805013927576601
model parameter : 124756
model size : 0.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.116528749465942
Epoch: 1, Steps: 89 | Train Loss: 1.935 Vali Loss: 0.858 Vali Acc: 0.836 Test Loss: 0.858 Test Acc: 0.836
Validation loss decreased (inf --> -0.835646).  Saving model ...
Epoch: 2 cost time: 2.7612788677215576
Epoch: 2, Steps: 89 | Train Loss: 0.532 Vali Loss: 0.362 Vali Acc: 0.922 Test Loss: 0.362 Test Acc: 0.922
Validation loss decreased (-0.835646 --> -0.922002).  Saving model ...
Epoch: 3 cost time: 2.7558486461639404
Epoch: 3, Steps: 89 | Train Loss: 0.261 Vali Loss: 0.233 Vali Acc: 0.948 Test Loss: 0.233 Test Acc: 0.948
Validation loss decreased (-0.922002 --> -0.948466).  Saving model ...
Epoch: 4 cost time: 3.5539448261260986
Epoch: 4, Steps: 89 | Train Loss: 0.148 Vali Loss: 0.159 Vali Acc: 0.966 Test Loss: 0.159 Test Acc: 0.966
Validation loss decreased (-0.948466 --> -0.965876).  Saving model ...
Epoch: 5 cost time: 3.211937665939331
Epoch: 5, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.142 Vali Acc: 0.964 Test Loss: 0.142 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.4983675479888916
Epoch: 6, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.113 Vali Acc: 0.971 Test Loss: 0.113 Test Acc: 0.971
Validation loss decreased (-0.965876 --> -0.970751).  Saving model ...
Epoch: 7 cost time: 3.0695724487304688
Epoch: 7, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.094 Vali Acc: 0.978 Test Loss: 0.094 Test Acc: 0.978
Validation loss decreased (-0.970751 --> -0.978411).  Saving model ...
Epoch: 8 cost time: 3.1941275596618652
Epoch: 8, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.093 Vali Acc: 0.974 Test Loss: 0.093 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.351607084274292
Epoch: 9, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.086 Vali Acc: 0.982 Test Loss: 0.086 Test Acc: 0.982
Validation loss decreased (-0.978411 --> -0.981893).  Saving model ...
Epoch: 10 cost time: 3.2864935398101807
Epoch: 10, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.089 Vali Acc: 0.979 Test Loss: 0.089 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.20219087600708
Epoch: 11, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
Validation loss decreased (-0.981893 --> -0.983286).  Saving model ...
Epoch: 12 cost time: 3.0846455097198486
Epoch: 12, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.104 Vali Acc: 0.978 Test Loss: 0.104 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.367482900619507
Epoch: 13, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.108 Vali Acc: 0.981 Test Loss: 0.108 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.304208993911743
Epoch: 14, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.088 Vali Acc: 0.981 Test Loss: 0.088 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.9730770587921143
Epoch: 15, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.151066541671753
Epoch: 16, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.088 Vali Acc: 0.979 Test Loss: 0.088 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.703993082046509
Epoch: 17, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.104 Vali Acc: 0.976 Test Loss: 0.104 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.5635061264038086
Epoch: 18, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.2767856121063232
Epoch: 19, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.103 Vali Acc: 0.979 Test Loss: 0.103 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.1163337230682373
Epoch: 20, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.093 Vali Acc: 0.980 Test Loss: 0.093 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 3.1614344120025635
Epoch: 21, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.091 Vali Acc: 0.979 Test Loss: 0.091 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps10_str5_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9832869080779945
model parameter : 78836
model size : 0.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps14_str7_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.560883045196533
Epoch: 1, Steps: 89 | Train Loss: 2.102 Vali Loss: 1.085 Vali Acc: 0.813 Test Loss: 1.085 Test Acc: 0.813
Validation loss decreased (inf --> -0.812663).  Saving model ...
Epoch: 2 cost time: 3.2585291862487793
Epoch: 2, Steps: 89 | Train Loss: 0.693 Vali Loss: 0.459 Vali Acc: 0.911 Test Loss: 0.459 Test Acc: 0.911
Validation loss decreased (-0.812663 --> -0.910859).  Saving model ...
Epoch: 3 cost time: 2.780484676361084
Epoch: 3, Steps: 89 | Train Loss: 0.330 Vali Loss: 0.287 Vali Acc: 0.944 Test Loss: 0.287 Test Acc: 0.944
Validation loss decreased (-0.910859 --> -0.943590).  Saving model ...
Epoch: 4 cost time: 3.38374924659729
Epoch: 4, Steps: 89 | Train Loss: 0.194 Vali Loss: 0.180 Vali Acc: 0.960 Test Loss: 0.180 Test Acc: 0.960
Validation loss decreased (-0.943590 --> -0.959608).  Saving model ...
Epoch: 5 cost time: 3.5279221534729004
Epoch: 5, Steps: 89 | Train Loss: 0.126 Vali Loss: 0.137 Vali Acc: 0.971 Test Loss: 0.137 Test Acc: 0.971
Validation loss decreased (-0.959608 --> -0.971447).  Saving model ...
Epoch: 6 cost time: 3.223459482192993
Epoch: 6, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.116 Vali Acc: 0.976 Test Loss: 0.116 Test Acc: 0.976
Validation loss decreased (-0.971447 --> -0.975626).  Saving model ...
Epoch: 7 cost time: 2.974205493927002
Epoch: 7, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.109 Vali Acc: 0.971 Test Loss: 0.109 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.233891487121582
Epoch: 8, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.082 Vali Acc: 0.981 Test Loss: 0.082 Test Acc: 0.981
Validation loss decreased (-0.975626 --> -0.980501).  Saving model ...
Epoch: 9 cost time: 3.0441739559173584
Epoch: 9, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.088 Vali Acc: 0.981 Test Loss: 0.088 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.2803544998168945
Epoch: 10, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.099 Vali Acc: 0.975 Test Loss: 0.099 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.4446353912353516
Epoch: 11, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.088 Vali Acc: 0.978 Test Loss: 0.088 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.11649227142334
Epoch: 12, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.079 Vali Acc: 0.981 Test Loss: 0.079 Test Acc: 0.981
Validation loss decreased (-0.980501 --> -0.980501).  Saving model ...
Epoch: 13 cost time: 3.2824666500091553
Epoch: 13, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.092 Vali Acc: 0.979 Test Loss: 0.092 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.9714877605438232
Epoch: 14, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.980501 --> -0.983286).  Saving model ...
Epoch: 15 cost time: 2.773000478744507
Epoch: 15, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.094 Vali Acc: 0.979 Test Loss: 0.094 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.7719008922576904
Epoch: 16, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.094 Vali Acc: 0.976 Test Loss: 0.094 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.4588894844055176
Epoch: 17, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.081 Vali Acc: 0.981 Test Loss: 0.081 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.5886878967285156
Epoch: 18, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.380013942718506
Epoch: 19, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.076 Vali Acc: 0.984 Test Loss: 0.076 Test Acc: 0.984
Validation loss decreased (-0.983286 --> -0.983983).  Saving model ...
Epoch: 20 cost time: 2.400585651397705
Epoch: 20, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.519385576248169
Epoch: 21, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.073 Vali Acc: 0.986 Test Loss: 0.073 Test Acc: 0.986
Validation loss decreased (-0.983983 --> -0.986072).  Saving model ...
Epoch: 22 cost time: 2.8555150032043457
Epoch: 22, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.072 Vali Acc: 0.986 Test Loss: 0.072 Test Acc: 0.986
Validation loss decreased (-0.986072 --> -0.986072).  Saving model ...
Epoch: 23 cost time: 3.236133575439453
Epoch: 23, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.9545984268188477
Epoch: 24, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.093 Vali Acc: 0.984 Test Loss: 0.093 Test Acc: 0.984
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.344491481781006
Epoch: 25, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.090 Vali Acc: 0.981 Test Loss: 0.090 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.169790506362915
Epoch: 26, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.105 Vali Acc: 0.974 Test Loss: 0.105 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.149834156036377
Epoch: 27, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.929230213165283
Epoch: 28, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.095 Vali Acc: 0.983 Test Loss: 0.095 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 2.9565625190734863
Epoch: 29, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.075 Vali Acc: 0.985 Test Loss: 0.075 Test Acc: 0.985
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.8341798782348633
Epoch: 30, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.078 Vali Acc: 0.987 Test Loss: 0.078 Test Acc: 0.987
Validation loss decreased (-0.986072 --> -0.986768).  Saving model ...
Epoch: 31 cost time: 2.8250572681427
Epoch: 31, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.987 Test Loss: 0.072 Test Acc: 0.987
Validation loss decreased (-0.986768 --> -0.987464).  Saving model ...
Epoch: 32 cost time: 3.007841110229492
Epoch: 32, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.087 Vali Acc: 0.985 Test Loss: 0.087 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.579012632369995
Epoch: 33, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.985 Test Loss: 0.076 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 2.686873435974121
Epoch: 34, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.985 Test Loss: 0.075 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 3.2051239013671875
Epoch: 35, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.081 Vali Acc: 0.985 Test Loss: 0.081 Test Acc: 0.985
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 2.7155182361602783
Epoch: 36, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.081 Vali Acc: 0.985 Test Loss: 0.081 Test Acc: 0.985
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 2.817387819290161
Epoch: 37, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.136 Vali Acc: 0.971 Test Loss: 0.136 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 2.9837143421173096
Epoch: 38, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.212 Vali Acc: 0.960 Test Loss: 0.212 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 3.1839852333068848
Epoch: 39, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.125 Vali Acc: 0.978 Test Loss: 0.125 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 2.775374412536621
Epoch: 40, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.103 Vali Acc: 0.982 Test Loss: 0.103 Test Acc: 0.982
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 3.2448976039886475
Epoch: 41, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.093 Vali Acc: 0.981 Test Loss: 0.093 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps14_str7_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9874651810584958
model parameter : 59764
model size : 0.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps19_str10_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.505595684051514
Epoch: 1, Steps: 89 | Train Loss: 2.323 Vali Loss: 1.387 Vali Acc: 0.749 Test Loss: 1.387 Test Acc: 0.749
Validation loss decreased (inf --> -0.749290).  Saving model ...
Epoch: 2 cost time: 2.6560728549957275
Epoch: 2, Steps: 89 | Train Loss: 0.889 Vali Loss: 0.587 Vali Acc: 0.868 Test Loss: 0.587 Test Acc: 0.868
Validation loss decreased (-0.749290 --> -0.867682).  Saving model ...
Epoch: 3 cost time: 2.5162012577056885
Epoch: 3, Steps: 89 | Train Loss: 0.439 Vali Loss: 0.355 Vali Acc: 0.925 Test Loss: 0.355 Test Acc: 0.925
Validation loss decreased (-0.867682 --> -0.924788).  Saving model ...
Epoch: 4 cost time: 3.066828966140747
Epoch: 4, Steps: 89 | Train Loss: 0.261 Vali Loss: 0.227 Vali Acc: 0.953 Test Loss: 0.227 Test Acc: 0.953
Validation loss decreased (-0.924788 --> -0.953340).  Saving model ...
Epoch: 5 cost time: 3.1789214611053467
Epoch: 5, Steps: 89 | Train Loss: 0.158 Vali Loss: 0.166 Vali Acc: 0.961 Test Loss: 0.166 Test Acc: 0.961
Validation loss decreased (-0.953340 --> -0.961001).  Saving model ...
Epoch: 6 cost time: 2.704164743423462
Epoch: 6, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.142 Vali Acc: 0.960 Test Loss: 0.142 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.0651097297668457
Epoch: 7, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
Validation loss decreased (-0.961001 --> -0.972840).  Saving model ...
Epoch: 8 cost time: 2.760559320449829
Epoch: 8, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
Validation loss decreased (-0.972840 --> -0.976322).  Saving model ...
Epoch: 9 cost time: 2.885484457015991
Epoch: 9, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
Validation loss decreased (-0.976322 --> -0.976322).  Saving model ...
Epoch: 10 cost time: 2.772336483001709
Epoch: 10, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.074 Vali Acc: 0.979 Test Loss: 0.074 Test Acc: 0.979
Validation loss decreased (-0.976322 --> -0.979108).  Saving model ...
Epoch: 11 cost time: 2.7161717414855957
Epoch: 11, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.075 Vali Acc: 0.985 Test Loss: 0.075 Test Acc: 0.985
Validation loss decreased (-0.979108 --> -0.984679).  Saving model ...
Epoch: 12 cost time: 2.8032844066619873
Epoch: 12, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.073 Vali Acc: 0.982 Test Loss: 0.073 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.821336269378662
Epoch: 13, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.073 Vali Acc: 0.981 Test Loss: 0.073 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.627420425415039
Epoch: 14, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.067 Vali Acc: 0.982 Test Loss: 0.067 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.574091672897339
Epoch: 15, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.5596835613250732
Epoch: 16, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.069 Vali Acc: 0.985 Test Loss: 0.069 Test Acc: 0.985
Validation loss decreased (-0.984679 --> -0.985375).  Saving model ...
Epoch: 17 cost time: 3.142500162124634
Epoch: 17, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.067 Vali Acc: 0.985 Test Loss: 0.067 Test Acc: 0.985
Validation loss decreased (-0.985375 --> -0.985375).  Saving model ...
Epoch: 18 cost time: 3.271397829055786
Epoch: 18, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.2484869956970215
Epoch: 19, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.085 Vali Acc: 0.978 Test Loss: 0.085 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.9879679679870605
Epoch: 20, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.087 Vali Acc: 0.981 Test Loss: 0.087 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.916344404220581
Epoch: 21, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.069 Vali Acc: 0.985 Test Loss: 0.069 Test Acc: 0.985
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.0283637046813965
Epoch: 22, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.065 Vali Acc: 0.985 Test Loss: 0.065 Test Acc: 0.985
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.878556728363037
Epoch: 23, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.068 Vali Acc: 0.985 Test Loss: 0.068 Test Acc: 0.985
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.0787363052368164
Epoch: 24, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 3.0660014152526855
Epoch: 25, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.072 Vali Acc: 0.985 Test Loss: 0.072 Test Acc: 0.985
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 3.0147125720977783
Epoch: 26, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.067 Vali Acc: 0.986 Test Loss: 0.067 Test Acc: 0.986
Validation loss decreased (-0.985375 --> -0.986072).  Saving model ...
Epoch: 27 cost time: 3.3212435245513916
Epoch: 27, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.075 Vali Acc: 0.986 Test Loss: 0.075 Test Acc: 0.986
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.9752299785614014
Epoch: 28, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.087 Vali Acc: 0.981 Test Loss: 0.087 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.2233407497406006
Epoch: 29, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.131 Vali Acc: 0.974 Test Loss: 0.131 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.125321865081787
Epoch: 30, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.078 Vali Acc: 0.983 Test Loss: 0.078 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 2.7344369888305664
Epoch: 31, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 2.8604543209075928
Epoch: 32, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 2.7018439769744873
Epoch: 33, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.064 Vali Acc: 0.987 Test Loss: 0.064 Test Acc: 0.987
Validation loss decreased (-0.986072 --> -0.986768).  Saving model ...
Epoch: 34 cost time: 2.880762815475464
Epoch: 34, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.072 Vali Acc: 0.985 Test Loss: 0.072 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.9203526973724365
Epoch: 35, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.066 Vali Acc: 0.985 Test Loss: 0.066 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 3.1375067234039307
Epoch: 36, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.081 Vali Acc: 0.985 Test Loss: 0.081 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 3.010812997817993
Epoch: 37, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.089 Vali Acc: 0.984 Test Loss: 0.089 Test Acc: 0.984
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 2.7099204063415527
Epoch: 38, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.091 Vali Acc: 0.982 Test Loss: 0.091 Test Acc: 0.982
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 3.308795213699341
Epoch: 39, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.081 Vali Acc: 0.984 Test Loss: 0.081 Test Acc: 0.984
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 3.2503087520599365
Epoch: 40, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.067 Vali Acc: 0.986 Test Loss: 0.067 Test Acc: 0.986
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 3.0239038467407227
Epoch: 41, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.062 Vali Acc: 0.987 Test Loss: 0.062 Test Acc: 0.987
Validation loss decreased (-0.986768 --> -0.986768).  Saving model ...
Epoch: 42 cost time: 3.0102226734161377
Epoch: 42, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.070 Vali Acc: 0.987 Test Loss: 0.070 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 3.3522744178771973
Epoch: 43, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.066 Vali Acc: 0.987 Test Loss: 0.066 Test Acc: 0.987
Validation loss decreased (-0.986768 --> -0.987465).  Saving model ...
Epoch: 44 cost time: 3.2626407146453857
Epoch: 44, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.070 Vali Acc: 0.986 Test Loss: 0.070 Test Acc: 0.986
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 3.3060851097106934
Epoch: 45, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.066 Vali Acc: 0.988 Test Loss: 0.066 Test Acc: 0.988
Validation loss decreased (-0.987465 --> -0.988161).  Saving model ...
Epoch: 46 cost time: 3.098079204559326
Epoch: 46, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.061 Vali Acc: 0.988 Test Loss: 0.061 Test Acc: 0.988
Validation loss decreased (-0.988161 --> -0.988161).  Saving model ...
Epoch: 47 cost time: 2.8170762062072754
Epoch: 47, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.075 Vali Acc: 0.986 Test Loss: 0.075 Test Acc: 0.986
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 3.3492417335510254
Epoch: 48, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.984 Test Loss: 0.078 Test Acc: 0.984
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 3.03560471534729
Epoch: 49, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.078 Vali Acc: 0.985 Test Loss: 0.078 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 2.9992103576660156
Epoch: 50, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.062 Vali Acc: 0.987 Test Loss: 0.062 Test Acc: 0.987
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps19_str10_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9881615598885793
model parameter : 44564
model size : 0.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps28_str14_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.664231300354004
Epoch: 1, Steps: 89 | Train Loss: 2.487 Vali Loss: 1.687 Vali Acc: 0.712 Test Loss: 1.687 Test Acc: 0.712
Validation loss decreased (inf --> -0.711682).  Saving model ...
Epoch: 2 cost time: 2.4328110218048096
Epoch: 2, Steps: 89 | Train Loss: 1.153 Vali Loss: 0.775 Vali Acc: 0.849 Test Loss: 0.775 Test Acc: 0.849
Validation loss decreased (-0.711682 --> -0.848878).  Saving model ...
Epoch: 3 cost time: 2.3614230155944824
Epoch: 3, Steps: 89 | Train Loss: 0.566 Vali Loss: 0.452 Vali Acc: 0.903 Test Loss: 0.452 Test Acc: 0.903
Validation loss decreased (-0.848878 --> -0.903199).  Saving model ...
Epoch: 4 cost time: 2.620793104171753
Epoch: 4, Steps: 89 | Train Loss: 0.345 Vali Loss: 0.312 Vali Acc: 0.923 Test Loss: 0.312 Test Acc: 0.923
Validation loss decreased (-0.903199 --> -0.922699).  Saving model ...
Epoch: 5 cost time: 2.7306642532348633
Epoch: 5, Steps: 89 | Train Loss: 0.231 Vali Loss: 0.200 Vali Acc: 0.960 Test Loss: 0.200 Test Acc: 0.960
Validation loss decreased (-0.922699 --> -0.959608).  Saving model ...
Epoch: 6 cost time: 2.9076545238494873
Epoch: 6, Steps: 89 | Train Loss: 0.153 Vali Loss: 0.163 Vali Acc: 0.957 Test Loss: 0.163 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.9094133377075195
Epoch: 7, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.120 Vali Acc: 0.970 Test Loss: 0.120 Test Acc: 0.970
Validation loss decreased (-0.959608 --> -0.970055).  Saving model ...
Epoch: 8 cost time: 2.823582410812378
Epoch: 8, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
Validation loss decreased (-0.970055 --> -0.977018).  Saving model ...
Epoch: 9 cost time: 2.962066888809204
Epoch: 9, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.096 Vali Acc: 0.975 Test Loss: 0.096 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.590106964111328
Epoch: 10, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.102 Vali Acc: 0.969 Test Loss: 0.102 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.0777082443237305
Epoch: 11, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.084 Vali Acc: 0.978 Test Loss: 0.084 Test Acc: 0.978
Validation loss decreased (-0.977018 --> -0.977715).  Saving model ...
Epoch: 12 cost time: 2.842658758163452
Epoch: 12, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.077 Vali Acc: 0.979 Test Loss: 0.077 Test Acc: 0.979
Validation loss decreased (-0.977715 --> -0.979108).  Saving model ...
Epoch: 13 cost time: 2.7932045459747314
Epoch: 13, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
Validation loss decreased (-0.979108 --> -0.982590).  Saving model ...
Epoch: 14 cost time: 2.7553441524505615
Epoch: 14, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.064 Vali Acc: 0.982 Test Loss: 0.064 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.7565674781799316
Epoch: 15, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.064 Vali Acc: 0.982 Test Loss: 0.064 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.1724894046783447
Epoch: 16, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.066 Vali Acc: 0.983 Test Loss: 0.066 Test Acc: 0.983
Validation loss decreased (-0.982590 --> -0.982590).  Saving model ...
Epoch: 17 cost time: 2.605562210083008
Epoch: 17, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.069 Vali Acc: 0.979 Test Loss: 0.069 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.91278076171875
Epoch: 18, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.085 Vali Acc: 0.975 Test Loss: 0.085 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.8727622032165527
Epoch: 19, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.061 Vali Acc: 0.982 Test Loss: 0.061 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.938859701156616
Epoch: 20, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.067 Vali Acc: 0.981 Test Loss: 0.067 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.053231954574585
Epoch: 21, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.065 Vali Acc: 0.979 Test Loss: 0.065 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.8468575477600098
Epoch: 22, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.061 Vali Acc: 0.981 Test Loss: 0.061 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 3.121631622314453
Epoch: 23, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.058 Vali Acc: 0.983 Test Loss: 0.058 Test Acc: 0.983
Validation loss decreased (-0.982590 --> -0.982590).  Saving model ...
Epoch: 24 cost time: 2.7837629318237305
Epoch: 24, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.062 Vali Acc: 0.984 Test Loss: 0.062 Test Acc: 0.984
Validation loss decreased (-0.982590 --> -0.983983).  Saving model ...
Epoch: 25 cost time: 2.324692487716675
Epoch: 25, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.081 Vali Acc: 0.979 Test Loss: 0.081 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.777522325515747
Epoch: 26, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.064 Vali Acc: 0.984 Test Loss: 0.064 Test Acc: 0.984
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.4304471015930176
Epoch: 27, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.059 Vali Acc: 0.984 Test Loss: 0.059 Test Acc: 0.984
Validation loss decreased (-0.983983 --> -0.983983).  Saving model ...
Epoch: 28 cost time: 2.8677139282226562
Epoch: 28, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.069 Vali Acc: 0.982 Test Loss: 0.069 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.7871220111846924
Epoch: 29, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.6071927547454834
Epoch: 30, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.084 Vali Acc: 0.983 Test Loss: 0.084 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 2.986515760421753
Epoch: 31, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.071 Vali Acc: 0.984 Test Loss: 0.071 Test Acc: 0.984
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 3.1307811737060547
Epoch: 32, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.069 Vali Acc: 0.982 Test Loss: 0.069 Test Acc: 0.982
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 2.837189197540283
Epoch: 33, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.065 Vali Acc: 0.984 Test Loss: 0.065 Test Acc: 0.984
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 2.8303427696228027
Epoch: 34, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.075 Vali Acc: 0.978 Test Loss: 0.075 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 2.8713579177856445
Epoch: 35, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.067 Vali Acc: 0.981 Test Loss: 0.067 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 2.760939359664917
Epoch: 36, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.059 Vali Acc: 0.984 Test Loss: 0.059 Test Acc: 0.984
Validation loss decreased (-0.983983 --> -0.983983).  Saving model ...
Epoch: 37 cost time: 2.7193660736083984
Epoch: 37, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.060 Vali Acc: 0.986 Test Loss: 0.060 Test Acc: 0.986
Validation loss decreased (-0.983983 --> -0.986072).  Saving model ...
Epoch: 38 cost time: 2.794813871383667
Epoch: 38, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 2.6252636909484863
Epoch: 39, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.073 Vali Acc: 0.984 Test Loss: 0.073 Test Acc: 0.984
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 2.865238666534424
Epoch: 40, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.074 Vali Acc: 0.984 Test Loss: 0.074 Test Acc: 0.984
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 2.61782169342041
Epoch: 41, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 2.461298942565918
Epoch: 42, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.069 Vali Acc: 0.982 Test Loss: 0.069 Test Acc: 0.982
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 2.5108156204223633
Epoch: 43, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 2.8354897499084473
Epoch: 44, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 2.8376214504241943
Epoch: 45, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 3.1594574451446533
Epoch: 46, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.985 Test Loss: 0.071 Test Acc: 0.985
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 2.602268934249878
Epoch: 47, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps28_str14_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9860724233983287
model parameter : 35252
model size : 0.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps37_str19_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.582847833633423
Epoch: 1, Steps: 89 | Train Loss: 2.609 Vali Loss: 1.940 Vali Acc: 0.650 Test Loss: 1.940 Test Acc: 0.650
Validation loss decreased (inf --> -0.649702).  Saving model ...
Epoch: 2 cost time: 3.0244405269622803
Epoch: 2, Steps: 89 | Train Loss: 1.391 Vali Loss: 0.959 Vali Acc: 0.822 Test Loss: 0.959 Test Acc: 0.822
Validation loss decreased (-0.649702 --> -0.821717).  Saving model ...
Epoch: 3 cost time: 2.7158756256103516
Epoch: 3, Steps: 89 | Train Loss: 0.735 Vali Loss: 0.580 Vali Acc: 0.879 Test Loss: 0.580 Test Acc: 0.879
Validation loss decreased (-0.821717 --> -0.878824).  Saving model ...
Epoch: 4 cost time: 2.449596643447876
Epoch: 4, Steps: 89 | Train Loss: 0.466 Vali Loss: 0.382 Vali Acc: 0.919 Test Loss: 0.382 Test Acc: 0.919
Validation loss decreased (-0.878824 --> -0.918520).  Saving model ...
Epoch: 5 cost time: 2.5705301761627197
Epoch: 5, Steps: 89 | Train Loss: 0.310 Vali Loss: 0.267 Vali Acc: 0.943 Test Loss: 0.267 Test Acc: 0.943
Validation loss decreased (-0.918520 --> -0.942894).  Saving model ...
Epoch: 6 cost time: 2.745628833770752
Epoch: 6, Steps: 89 | Train Loss: 0.213 Vali Loss: 0.192 Vali Acc: 0.957 Test Loss: 0.192 Test Acc: 0.957
Validation loss decreased (-0.942894 --> -0.956823).  Saving model ...
Epoch: 7 cost time: 3.0376715660095215
Epoch: 7, Steps: 89 | Train Loss: 0.151 Vali Loss: 0.151 Vali Acc: 0.965 Test Loss: 0.151 Test Acc: 0.965
Validation loss decreased (-0.956823 --> -0.965180).  Saving model ...
Epoch: 8 cost time: 2.9494073390960693
Epoch: 8, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.130 Vali Acc: 0.967 Test Loss: 0.130 Test Acc: 0.967
Validation loss decreased (-0.965180 --> -0.967269).  Saving model ...
Epoch: 9 cost time: 2.722604990005493
Epoch: 9, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
Validation loss decreased (-0.967269 --> -0.979804).  Saving model ...
Epoch: 10 cost time: 2.9929280281066895
Epoch: 10, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.096 Vali Acc: 0.981 Test Loss: 0.096 Test Acc: 0.981
Validation loss decreased (-0.979804 --> -0.980500).  Saving model ...
Epoch: 11 cost time: 2.617946147918701
Epoch: 11, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.091 Vali Acc: 0.981 Test Loss: 0.091 Test Acc: 0.981
Validation loss decreased (-0.980500 --> -0.981197).  Saving model ...
Epoch: 12 cost time: 2.4229302406311035
Epoch: 12, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.124 Vali Acc: 0.957 Test Loss: 0.124 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.4375641345977783
Epoch: 13, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
Validation loss decreased (-0.981197 --> -0.982590).  Saving model ...
Epoch: 14 cost time: 2.8569209575653076
Epoch: 14, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.082 Vali Acc: 0.983 Test Loss: 0.082 Test Acc: 0.983
Validation loss decreased (-0.982590 --> -0.982590).  Saving model ...
Epoch: 15 cost time: 2.254514694213867
Epoch: 15, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.081 Vali Acc: 0.983 Test Loss: 0.081 Test Acc: 0.983
Validation loss decreased (-0.982590 --> -0.983286).  Saving model ...
Epoch: 16 cost time: 2.8807384967803955
Epoch: 16, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.8196699619293213
Epoch: 17, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.070 Vali Acc: 0.985 Test Loss: 0.070 Test Acc: 0.985
Validation loss decreased (-0.983286 --> -0.984679).  Saving model ...
Epoch: 18 cost time: 2.730895757675171
Epoch: 18, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.063 Vali Acc: 0.985 Test Loss: 0.063 Test Acc: 0.985
Validation loss decreased (-0.984679 --> -0.984679).  Saving model ...
Epoch: 19 cost time: 2.973475933074951
Epoch: 19, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.069 Vali Acc: 0.986 Test Loss: 0.069 Test Acc: 0.986
Validation loss decreased (-0.984679 --> -0.986072).  Saving model ...
Epoch: 20 cost time: 2.7065844535827637
Epoch: 20, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.067 Vali Acc: 0.984 Test Loss: 0.067 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.49161958694458
Epoch: 21, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.060 Vali Acc: 0.985 Test Loss: 0.060 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.17425274848938
Epoch: 22, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.5822958946228027
Epoch: 23, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.9032387733459473
Epoch: 24, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.073 Vali Acc: 0.985 Test Loss: 0.073 Test Acc: 0.985
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.7795329093933105
Epoch: 25, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.078 Vali Acc: 0.984 Test Loss: 0.078 Test Acc: 0.984
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.74470853805542
Epoch: 26, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 3.035212755203247
Epoch: 27, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.072 Vali Acc: 0.983 Test Loss: 0.072 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.8344950675964355
Epoch: 28, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.077 Vali Acc: 0.980 Test Loss: 0.077 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.6622982025146484
Epoch: 29, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.066 Vali Acc: 0.987 Test Loss: 0.066 Test Acc: 0.987
Validation loss decreased (-0.986072 --> -0.986768).  Saving model ...
Epoch: 30 cost time: 2.8385508060455322
Epoch: 30, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.073 Vali Acc: 0.982 Test Loss: 0.073 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.6225955486297607
Epoch: 31, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.5212409496307373
Epoch: 32, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.075 Vali Acc: 0.985 Test Loss: 0.075 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 3.0956826210021973
Epoch: 33, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.071 Vali Acc: 0.981 Test Loss: 0.071 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 2.770721673965454
Epoch: 34, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.084 Vali Acc: 0.977 Test Loss: 0.084 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 2.612600088119507
Epoch: 35, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.075 Vali Acc: 0.981 Test Loss: 0.075 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 2.768155574798584
Epoch: 36, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.071 Vali Acc: 0.985 Test Loss: 0.071 Test Acc: 0.985
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 2.386953830718994
Epoch: 37, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.082 Vali Acc: 0.981 Test Loss: 0.082 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 2.4653027057647705
Epoch: 38, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.069 Vali Acc: 0.985 Test Loss: 0.069 Test Acc: 0.985
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 2.488011360168457
Epoch: 39, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.085 Vali Acc: 0.984 Test Loss: 0.085 Test Acc: 0.984
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps37_str19_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9867688022284122
model parameter : 27860
model size : 0.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ModernTCN           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       50                  Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                0                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps46_str23_multiFalse_mergedFalse_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.623001337051392
Epoch: 1, Steps: 89 | Train Loss: 2.708 Vali Loss: 2.112 Vali Acc: 0.591 Test Loss: 2.112 Test Acc: 0.591
Validation loss decreased (inf --> -0.590508).  Saving model ...
Epoch: 2 cost time: 2.8323254585266113
Epoch: 2, Steps: 89 | Train Loss: 1.567 Vali Loss: 1.122 Vali Acc: 0.831 Test Loss: 1.122 Test Acc: 0.831
Validation loss decreased (-0.590508 --> -0.831465).  Saving model ...
Epoch: 3 cost time: 2.6679489612579346
Epoch: 3, Steps: 89 | Train Loss: 0.831 Vali Loss: 0.655 Vali Acc: 0.862 Test Loss: 0.655 Test Acc: 0.862
Validation loss decreased (-0.831465 --> -0.862110).  Saving model ...
Epoch: 4 cost time: 2.8812036514282227
Epoch: 4, Steps: 89 | Train Loss: 0.500 Vali Loss: 0.399 Vali Acc: 0.912 Test Loss: 0.399 Test Acc: 0.912
Validation loss decreased (-0.862110 --> -0.911556).  Saving model ...
Epoch: 5 cost time: 2.944950580596924
Epoch: 5, Steps: 89 | Train Loss: 0.327 Vali Loss: 0.270 Vali Acc: 0.941 Test Loss: 0.270 Test Acc: 0.941
Validation loss decreased (-0.911556 --> -0.940805).  Saving model ...
Epoch: 6 cost time: 2.84660005569458
Epoch: 6, Steps: 89 | Train Loss: 0.217 Vali Loss: 0.199 Vali Acc: 0.961 Test Loss: 0.199 Test Acc: 0.961
Validation loss decreased (-0.940805 --> -0.961001).  Saving model ...
Epoch: 7 cost time: 2.985133409500122
Epoch: 7, Steps: 89 | Train Loss: 0.158 Vali Loss: 0.154 Vali Acc: 0.964 Test Loss: 0.154 Test Acc: 0.964
Validation loss decreased (-0.961001 --> -0.964483).  Saving model ...
Epoch: 8 cost time: 2.5908524990081787
Epoch: 8, Steps: 89 | Train Loss: 0.140 Vali Loss: 0.134 Vali Acc: 0.972 Test Loss: 0.134 Test Acc: 0.972
Validation loss decreased (-0.964483 --> -0.972144).  Saving model ...
Epoch: 9 cost time: 2.640377998352051
Epoch: 9, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.112 Vali Acc: 0.978 Test Loss: 0.112 Test Acc: 0.978
Validation loss decreased (-0.972144 --> -0.977715).  Saving model ...
Epoch: 10 cost time: 2.7641990184783936
Epoch: 10, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.105 Vali Acc: 0.975 Test Loss: 0.105 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.779372453689575
Epoch: 11, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.101 Vali Acc: 0.979 Test Loss: 0.101 Test Acc: 0.979
Validation loss decreased (-0.977715 --> -0.979108).  Saving model ...
Epoch: 12 cost time: 2.9118762016296387
Epoch: 12, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.093 Vali Acc: 0.978 Test Loss: 0.093 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.759517192840576
Epoch: 13, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
Validation loss decreased (-0.979108 --> -0.982590).  Saving model ...
Epoch: 14 cost time: 2.057215690612793
Epoch: 14, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.086 Vali Acc: 0.981 Test Loss: 0.086 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.1797759532928467
Epoch: 15, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.074 Vali Acc: 0.981 Test Loss: 0.074 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.820899724960327
Epoch: 16, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.982590 --> -0.982590).  Saving model ...
Epoch: 17 cost time: 2.2905468940734863
Epoch: 17, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
Validation loss decreased (-0.982590 --> -0.983286).  Saving model ...
Epoch: 18 cost time: 2.5971460342407227
Epoch: 18, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.6019673347473145
Epoch: 19, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.063 Vali Acc: 0.983 Test Loss: 0.063 Test Acc: 0.983
Validation loss decreased (-0.983286 --> -0.983286).  Saving model ...
Epoch: 20 cost time: 2.346863269805908
Epoch: 20, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.071 Vali Acc: 0.983 Test Loss: 0.071 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.3494839668273926
Epoch: 21, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.087 Vali Acc: 0.982 Test Loss: 0.087 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.8353464603424072
Epoch: 22, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.060 Vali Acc: 0.984 Test Loss: 0.060 Test Acc: 0.984
Validation loss decreased (-0.983286 --> -0.983983).  Saving model ...
Epoch: 23 cost time: 2.560220956802368
Epoch: 23, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.066 Vali Acc: 0.981 Test Loss: 0.066 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.784602642059326
Epoch: 24, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.061 Vali Acc: 0.983 Test Loss: 0.061 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.067349672317505
Epoch: 25, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.2865021228790283
Epoch: 26, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.069 Vali Acc: 0.982 Test Loss: 0.069 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.4261600971221924
Epoch: 27, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 3.0579679012298584
Epoch: 28, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.071 Vali Acc: 0.985 Test Loss: 0.071 Test Acc: 0.985
Validation loss decreased (-0.983983 --> -0.984679).  Saving model ...
Epoch: 29 cost time: 3.3834445476531982
Epoch: 29, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.5296578407287598
Epoch: 30, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.062 Vali Acc: 0.987 Test Loss: 0.062 Test Acc: 0.987
Validation loss decreased (-0.984679 --> -0.986768).  Saving model ...
Epoch: 31 cost time: 3.4090945720672607
Epoch: 31, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.063 Vali Acc: 0.985 Test Loss: 0.063 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.471261978149414
Epoch: 32, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.070 Vali Acc: 0.977 Test Loss: 0.070 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 3.383974075317383
Epoch: 33, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.066 Vali Acc: 0.984 Test Loss: 0.066 Test Acc: 0.984
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 3.377819299697876
Epoch: 34, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 3.11226224899292
Epoch: 35, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.066 Vali Acc: 0.982 Test Loss: 0.066 Test Acc: 0.982
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 3.4389052391052246
Epoch: 36, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.065 Vali Acc: 0.985 Test Loss: 0.065 Test Acc: 0.985
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 3.398144245147705
Epoch: 37, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.071 Vali Acc: 0.987 Test Loss: 0.071 Test Acc: 0.987
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 3.1284408569335938
Epoch: 38, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.069 Vali Acc: 0.984 Test Loss: 0.069 Test Acc: 0.984
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 2.737894296646118
Epoch: 39, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.070 Vali Acc: 0.983 Test Loss: 0.070 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 2.6235733032226562
Epoch: 40, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.061 Vali Acc: 0.984 Test Loss: 0.061 Test Acc: 0.984
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ModernTCN_UEA_ftM_sl182_ll0_pl0_dim32_nb1_lk13_sk5_ffr1_ps46_str23_multiFalse_mergedFalse_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9867688022284122
model parameter : 24308
model size : 0.11MB
